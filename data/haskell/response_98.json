[{"tags": ["haskell", "idris", "gadt", "morte"], "comments": [{"owner": {"reputation": 2115, "user_id": 1934349, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/LyNoA.jpg?s=128&g=1", "display_name": "paulotorrens", "link": "https://stackoverflow.com/users/1934349/paulotorrens"}, "edited": false, "score": 0, "creation_date": 1481442584, "post_id": 40773570, "comment_id": 69373779, "body": "Second that on dependent products."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 2115, "user_id": 1934349, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/LyNoA.jpg?s=128&g=1", "display_name": "paulotorrens", "link": "https://stackoverflow.com/users/1934349/paulotorrens"}, "edited": false, "score": 1, "creation_date": 1481467056, "post_id": 40773570, "comment_id": 69379566, "body": "@paulotorrens it is on the Sol repository, I called it <a href=\"https://github.com/MaiaVictor/Sol/blob/master/book/Some.sol\" rel=\"nofollow noreferrer\">Some</a> and <a href=\"https://github.com/MaiaVictor/Sol/blob/master/book/Some.like.sol\" rel=\"nofollow noreferrer\">Some.like</a>."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 1, "creation_date": 1487598174, "post_id": 40773570, "comment_id": 71843530, "body": "See <a href=\"http://stackoverflow.com/a/36182693/1172541\">stackoverflow.com/a/36182693/1172541</a> for an example."}], "answers": [{"comments": [{"owner": {"reputation": 2115, "user_id": 1934349, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/LyNoA.jpg?s=128&g=1", "display_name": "paulotorrens", "link": "https://stackoverflow.com/users/1934349/paulotorrens"}, "edited": false, "score": 0, "creation_date": 1481442844, "post_id": 40774013, "comment_id": 69373821, "body": "By the discussion on the other answer, should I assume that, in fact, GADTs <i>can</i> be represented?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 2115, "user_id": 1934349, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/LyNoA.jpg?s=128&g=1", "display_name": "paulotorrens", "link": "https://stackoverflow.com/users/1934349/paulotorrens"}, "edited": false, "score": 1, "creation_date": 1481443897, "post_id": 40774013, "comment_id": 69374004, "body": "@paulotorrens Yes."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 4, "last_activity_date": 1481443855, "last_edit_date": 1481443855, "creation_date": 1479934548, "answer_id": 40774013, "question_id": 40773570, "link": "https://stackoverflow.com/questions/40773570/how-to-represent-arbitrary-gadts-on-morte/40774013#40774013", "title": "How to represent arbitrary GADTs on Morte?", "body": "<p>Everything that is representable is documented in the <a href=\"https://hackage.haskell.org/package/morte-1.6.4/docs/Morte-Tutorial.html\" rel=\"nofollow noreferrer\">Morte tutorial</a>. GADTs and (more generally) indexed types aren't there, and indeed they aren't possible.</p>\n\n<p>(EDIT: GADTs can be in fact represented; see other answer by user3237465)</p>\n\n<p>The <code>Vector</code> type itself can be encoded, but its values aren't usable for much. A <code>Vector n A</code> is an <code>n</code>-nested pair of <code>A</code>-s:</p>\n\n<pre><code>Unit   = \\(A : *) -&gt; A -&gt; A\nPair   = \\(A B : *) -&gt; (P : *) -&gt; (A -&gt; B -&gt; P) -&gt; P\nNat    = (N : *) -&gt; (N -&gt; N) -&gt; N -&gt; N\nVector = \\(n : Nat)(A : *) -&gt; n * (\\(t : *) -&gt; Pair A t) Unit\n</code></pre>\n\n<p>But writing any useful function for <code>Vector n A</code> would require induction on its <code>n</code> length, but Morte has no inductive types.</p>\n\n<p>To be clear, by induction I mean that for a certain type a function corresponding to the principle of structural induction is derivable. These are generalizations of folds where the output type may depend on the input value. For some natural number type <code>Nat : *</code> with <code>suc : Nat -&gt; Nat</code> and <code>zero : Nat</code> induction has the following type:</p>\n\n<pre><code>natInd : \n      (N : Nat -&gt; *)                   -- a predicate,\n   -&gt; ((n : Nat) -&gt; N n -&gt; N (suc n))  -- if it's preserved by suc\n   -&gt; N zero                           -- and holds for zero,\n   -&gt; (n : Nat) -&gt; N n                 -- holds for every Nat\n</code></pre>\n\n<p>While folding over a <code>Vector</code>, the type changes along with the length (since the former depends on the latter). However, with Church <code>Nat</code> we only have non-dependent fold (aka \"recursion\") instead of possibly type-changing fold (aka \"induction\"). </p>\n"}, {"comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 2, "creation_date": 1479976059, "post_id": 40780735, "comment_id": 68785588, "body": "Wow, does this mean that Haskell GADTs are in fact representable?"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1479976934, "post_id": 40780735, "comment_id": 68786062, "body": "@Andr&#225;s Kov&#225;cs, it seems so. I&#39;m a bit surprised too, so can&#39;t make strong claims. And not just GADTs, but also GADTs with DataKinds."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1479980649, "post_id": 40780735, "comment_id": 68788405, "body": "@Andr&#225;sKov&#225;cs I think the main difference between GADTs and this encoding is that pattern matching with GADTs will add a type equality constraint <code>T ~ S</code> to the environment, and the type checker then automatically does its job up-to <code>~</code>. Instead, with dependent types, even if you have a hypothesis <code>T=S</code>, you have to eliminate it manually in the &quot;right&quot; way to to make the rest of your term to type check. The Hasochism paper shows this on a few cases. Because of this, I wouldn&#39;t say GADTs are exactly represented, since the representations don&#39;t really eliminate like true GADTs."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1479981428, "post_id": 40780735, "comment_id": 68788987, "body": "@chi, when you pattern match in a dependently typed setting (at the top level), you don&#39;t get <code>T = S </code>, instead the context is silently rewritten by <code>T ~ S</code> just like in Haskell. The difference is that in Haskell <code>(~)</code> is a first-class thing, so you can write <code>a ~ b =&gt; c</code>, while in Agda/Morte/whatever, there are no explicit equality constraints, but they are still presented implicitly. In the encoding above everything is already rewritten and there is nothing to &quot;reveal by pattern matching&quot;."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1479981802, "post_id": 40780735, "comment_id": 68789253, "body": "@chi, also see the answer to <a href=\"https://stackoverflow.com/questions/38957229/pattern-matching-in-observational-type-theory\">Pattern matching in Observational Type Theory</a>."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 3, "creation_date": 1479982189, "post_id": 40780735, "comment_id": 68789527, "body": "I fiddled around a bit and I&#39;m quite sure all GHC 7.8 GADTs are representable. Type-indexed GADTs can be rewritten to type-code indexed ones. The GADT propositional equality becomes Leibniz equality, and we also have all the GHC 7.8 singletons with <code>toSing</code> and <code>fromSing</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1479982822, "post_id": 40780735, "comment_id": 68790029, "body": "Yes, probably I was still thinking about Coq, where equality must be handled in a different way. E.g. <code>Definition f (A: Type) (h: A=nat) (g: nat-&gt;bool) (x: A): bool := match h with eq_refl =&gt; g x end</code> does not type check. In Agda (with pattern matching at the definition level) it would."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1479983328, "post_id": 40780735, "comment_id": 68790411, "body": "I still don&#39;t quite understand exactly what inductive types mean, but I spent half of my dreams this night puzzled about @Andr&#225;sKov&#225;cs&#39;s answer lol. Turns out all I had missing was the <code>n:Nat</code> argument inside the Cons constructor, I was using the outer <code>n</code> and it didn&#39;t work. Still not obvious to me how to translate arbitrary GADTs to Morte, though, but Vector and other types from Idris are working fine and I&#39;m starting to see the pattern. Thank you all :)"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1479983482, "post_id": 40780735, "comment_id": 68790534, "body": "@Andr&#225;sKov&#225;cs do you know of any particular GADT that shouldn&#39;t be representable?"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1479983691, "post_id": 40780735, "comment_id": 68790714, "body": "@chi do you still recommend the paper from Lindley &amp; McBride?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1479983702, "post_id": 40780735, "comment_id": 68790721, "body": "@MaiaVictor: Currently I think all GHC 7.8 GADTs are representable, and also some extra, because we can index by GADTs as well, so we can iterate singleton construction. In about a day when I&#39;ll have time I&#39;ll rewrite my answer to include more detailed explanation on how to encode arbitrary GHC 7.8 GADTs."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1479984480, "post_id": 40780735, "comment_id": 68791292, "body": "@Andr&#225;s Kov&#225;cs, I think <a href=\"https://github.com/effectfully/random-stuff/blob/master/Lists/ChurchVector.agda\" rel=\"nofollow noreferrer\">direct encoding</a> of equality is not Leibniz equality, but is isomorphic to it. Though, this is perhaps the usual parameters vs indices dichotomy."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 1, "creation_date": 1479984864, "post_id": 40780735, "comment_id": 68791573, "body": "@MaiaVictor After the discussion, I am no longer sure if that&#39;s relevant to the actual question at hand."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1479987010, "post_id": 40780735, "comment_id": 68793061, "body": "@user3237465 yes, we get Leibniz eq. from the Paulin-Mohring definition with one parameter and one index."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1551624454, "post_id": 40780735, "comment_id": 96699606, "body": "I&#39;m accepting this answer instead as the other didn&#39;t age very well. Indeed any datatype can be represented with Church encodings. But you still can&#39;t have the induction principle, just plain iteration."}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": true, "score": 6, "last_activity_date": 1479974930, "last_edit_date": 1479974930, "creation_date": 1479974032, "answer_id": 40780735, "question_id": 40773570, "link": "https://stackoverflow.com/questions/40773570/how-to-represent-arbitrary-gadts-on-morte/40780735#40780735", "title": "How to represent arbitrary GADTs on Morte?", "body": "<p>You can't get eliminators that depend on elements of data types, but you can define eliminators that depend on indices of elements of data types. Hence, <code>Vector</code>s are representable (the code is in Agda):</p>\n\n<pre><code>Nat = (P : Set) -&gt; (P -&gt; P) -&gt; P -&gt; P\n\nzero : Nat\nzero = \u03bb P f z -&gt; z\n\nsuc : Nat -&gt; Nat\nsuc = \u03bb n P f z -&gt; f (n P f z) \n\nplus : Nat -&gt; Nat -&gt; Nat\nplus = \u03bb n m P f z -&gt; n P f (m P f z)\n\nVec = \u03bb (A : Set) (n : Nat) -&gt;\n  (P : Nat -&gt; Set) -&gt; (\u2200 n -&gt; A -&gt; P n -&gt; P (suc n)) -&gt; P zero -&gt; P n\n\nnil : \u2200 A -&gt; Vec A zero\nnil = \u03bb A P f z -&gt; z\n\ncons : \u2200 A n -&gt; A -&gt; Vec A n -&gt; Vec A (suc n)\ncons = \u03bb A n x xs P f z -&gt; f n x (xs P f z)\n\nconcat : \u2200 A n m -&gt; Vec A n -&gt; Vec A m -&gt; Vec A (plus n m)\nconcat = \u03bb A n m xs ys P f z -&gt; xs (\u03bb n -&gt; P (plus n m)) (\u03bb n -&gt; f (plus n m)) (ys P f z)\n</code></pre>\n\n<p>These are very similar to Church-encoded lists, you just make a type, that you eliminate into, dependent on the indices of a data type being defined and change induction hypotheses to reflect the structure of the constructors of the data type. I.e. you have</p>\n\n<pre><code>cons : \u2200 A n -&gt; A -&gt; Vec A n -&gt; Vec A (suc n)\n</code></pre>\n\n<p>so the corresponding induction hypothesis is</p>\n\n<pre><code>\u2200 n -&gt; A -&gt; P n -&gt; P (suc n)\n</code></pre>\n\n<p>In order to define dependent pairs without inductive types, you need very/<a href=\"https://github.com/UlfNorell/insane\" rel=\"nofollow noreferrer\">insanely dependent types</a> (sigmas are <a href=\"https://github.com/UlfNorell/insane/blob/master/Sigma.agda\" rel=\"nofollow noreferrer\">here</a>), which allow the result of a function depend on this same function being defined. Morte doesn't have this, of course.</p>\n"}, {"tags": [], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "is_accepted": false, "score": 1, "last_activity_date": 1551559725, "creation_date": 1551559725, "answer_id": 54962844, "question_id": 40773570, "link": "https://stackoverflow.com/questions/40773570/how-to-represent-arbitrary-gadts-on-morte/54962844#54962844", "title": "How to represent arbitrary GADTs on Morte?", "body": "<p>Yes. As an example, <a href=\"https://stackoverflow.com/a/36182693/1172541\">this answer</a> shows how to write the <code>Refl</code> type.</p>\n\n<p>Let's say we want to build a simple DSL. Here's how to do ti:</p>\n\n<pre><code>Expr t = forall (E :: * -&gt; *). forall\n    (IntLit :: Integer -&gt; E Integer),\n    (IntVar :: Char -&gt; E Integer),\n    (Add :: E Integer -&gt; E Integer -&gt; E Integer),\n    (Mult :: E Integer -&gt; E Integer -&gt; E Integer),\n    (Neg :: E Integer -&gt; E Integer),\n    (IntEq :: E Integer -&gt; E Integer -&gt; E Bool),\n    (Lt :: E Integer -&gt; E Integer -&gt; E Bool),\n    (And :: E Bool -&gt; E Bool -&gt; E Bool),\n    (Or :: E Bool -&gt; E Bool -&gt; E Bool),\n    (Not :: E Bool -&gt; E Bool),\n    (If :: (forall x :: *. E Bool -&gt; E x -&gt; E x -&gt; E x)).\n    E t\n</code></pre>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 1, "accepted_answer_id": 40780735, "answer_count": 3, "score": 3, "last_activity_date": 1551559739, "creation_date": 1479932655, "last_edit_date": 1551559739, "question_id": 40773570, "link": "https://stackoverflow.com/questions/40773570/how-to-represent-arbitrary-gadts-on-morte", "title": "How to represent arbitrary GADTs on Morte?", "body": "<p>Expressing normal data types such as lists and nats is straightforward and there are many examples around. What is the generic procedure to translate GADTs, though? Some examples translating typical types such as Vector and dependent products from Idris to Morte would be very illustrative.</p>\n"}, {"tags": ["haskell", "polymorphism", "typeclass", "conduit"], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479934577, "post_id": 40773777, "comment_id": 68771852, "body": "Thanks for reminding me of <code>TypeApplications</code>. I lifted that for my answer."}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": false, "score": 2, "last_activity_date": 1479933544, "creation_date": 1479933544, "answer_id": 40773777, "question_id": 40772028, "link": "https://stackoverflow.com/questions/40772028/typeclass-constraints-polymorphism-and-cassava-conduit/40773777#40773777", "title": "Typeclass constraints, polymorphism and cassava-conduit", "body": "<p><code>pipeline3</code> is a conduit typed like <code>ConduitM a [a] m ()</code> (ignoring the constraints for now). So when you map <code>length</code> over it you get <code>ConduitM a Int m ()</code>; the <code>a</code> is still there in the first type parameter, and so the <code>FromField a</code> constraint can remain, waiting to be instantiated at usage sites.</p>\n\n<p><code>pipeline2</code> is a conduit typed like <code>ConduitM BS.ByteString [a] m ()</code>. Now if you map <code>length</code> over it you would get <code>ConduitM BS.ByteString Int m ()</code>. There's no <code>a</code> anywhere that type, so the <code>FromField a</code> instance can't be chosen at usage sites. Instead it has to be chosen immediately. But nothing in <code>pipeline2 .| mapC length</code> says what <code>a</code> should be. That's why it's complaining that <code>a</code> is ambiguous.</p>\n\n<p>As far as I can tell (not intimately familiar with conduits), that should be the only problem with your first definition as well. <code>FromRecord</code> doesn't guarantee <code>Foldable</code>, but it has instances that are <code>Foldable</code>; you just need to pin down the type being used because <code>length</code> won't do it. You could use an expression signature on <code>pipeline</code> when you use it, the <code>TypeApplication</code> extension, a less polymorphic definition (which doesn't need to be a reimplement like <code>pipeline2</code>; you could have <code>pipeline' = pipeline</code> if you had the right signature on <code>pipeline'</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 2, "last_activity_date": 1479934648, "last_edit_date": 1479934648, "creation_date": 1479933738, "answer_id": 40773819, "question_id": 40772028, "link": "https://stackoverflow.com/questions/40772028/typeclass-constraints-polymorphism-and-cassava-conduit/40773819#40773819", "title": "Typeclass constraints, polymorphism and cassava-conduit", "body": "<p>The error you got...</p>\n\n<pre><code> \u2022 Could not deduce (FromField a0) arising from a use of \u2018pipeline2\u2019\n  from the context: MonadError CsvParseError m\n    bound by the inferred type of\n             it :: MonadError CsvParseError m =&gt; ConduitM BS.ByteString Int m ()\n    at &lt;interactive&gt;:1:1\n  The type variable \u2018a0\u2019 is ambiguous\n</code></pre>\n\n<p>... says that <code>a0</code> is ambiguous, which makes it impossible to figure out which instance of <code>FromField</code> should be used. What makes it ambiguous? The error message also mentions the inferred type of your expression:</p>\n\n<pre><code>it :: MonadError CsvParseError m =&gt; ConduitM BS.ByteString Int m ()\n</code></pre>\n\n<p>There is no <code>a0</code> in this type. That leads to ambiguity, because there is no specialisation of this type that can specify the <code>FromField</code> instance -- there isn't enough material for the type checker to work with. In your third example, on the other hand...</p>\n\n<pre><code>pipeline3 .| mapC length\n  :: (FromField a, MonadError CsvParseError m) =&gt; ConduitM a Int m ()\n</code></pre>\n\n<p>... the type of the field does show up in the overall type, and so the ambiguity is averted.</p>\n\n<p>It is worth emphasising that there is nothing wrong with <code>pipeline2</code> per se. The problem only arises because <code>length</code> eliminates useful information from the overall type. In contrast, this, for instance, works just fine:</p>\n\n<pre><code>GHCi&gt; :t pipeline2 .| mapC id\npipeline2 .| mapC id\n  :: (MonadError CsvParseError m, FromField a) =&gt;\n     ConduitM BS.ByteString [a] m ()\n</code></pre>\n\n<p>In order to use <code>pipeline2</code> with <code>length</code>, you need to specify the type of the field through a type annotation:</p>\n\n<pre><code>GHCi&gt; -- Arbitrary example.\nGHCi&gt; :t (pipeline2 :: MonadError CsvParseError m =&gt; ConduitM BS.ByteString [Int] m ()) .| mapC length\n(pipeline2 :: MonadError CsvParseError m =&gt; ConduitM BS.ByteString [Int] m ()) .| mapC length\n  :: MonadError CsvParseError m =&gt; ConduitM BS.ByteString Int m ()\n</code></pre>\n\n<p>Alternatives to the annotation include using the <code>TypeApplications</code> extension (credit to ben's answer for reminding me of that)...</p>\n\n<pre><code>GHCi&gt; :set -XTypeApplications \nGHCi&gt; :t pipeline2 @_ @Int .| mapC length\npipeline2 @_ @Int .| mapC length\n  :: MonadError CsvParseError m =&gt; ConduitM BS.ByteString Int m ()\n</code></pre>\n\n<p>... and specifying the field type through a proxy argument.</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE FlexibleContexts  #-}\n\nimport Data.Proxy\n-- etc.\n\nrowLength :: forall m a. (MonadError CsvParseError m, FromField a)\n    =&gt; Proxy a -&gt; ConduitM BS.ByteString Int m ()\nrowLength _ = p2 .| mapC length\n    where\n    p2 :: (MonadError CsvParseError m, FromField a)\n        =&gt; ConduitM BS.ByteString [a] m ()\n    p2 = pipeline2\n</code></pre>\n\n\n\n<pre><code>GHCi&gt; :t rowLength (Proxy :: Proxy Int)\nrowLength (Proxy :: Proxy Int)\n  :: MonadError CsvParseError m =&gt; ConduitM BS.ByteString Int m ()\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 4641312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89ea862e7d1f25d7bfbde034deef3c7c?s=128&d=identicon&r=PG&f=1", "display_name": "Antoine Genton", "link": "https://stackoverflow.com/users/4641312/antoine-genton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 40773819, "answer_count": 2, "score": 2, "last_activity_date": 1479946101, "creation_date": 1479926546, "last_edit_date": 1479946101, "question_id": 40772028, "link": "https://stackoverflow.com/questions/40772028/typeclass-constraints-polymorphism-and-cassava-conduit", "title": "Typeclass constraints, polymorphism and cassava-conduit", "body": "<p>While playing with Haskell and <em>conduit</em>, I came across a behavior that I have a hard time explaining. First let me list all the modules and language extensions that need to be loaded to reproduce my problem:</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts  #-}\n\nimport Conduit                         -- conduit-combinators\nimport Data.Csv                        -- cassava\nimport Data.Csv.Conduit                -- cassava-conduit\nimport qualified Data.ByteString as BS -- bytestring\nimport Data.Text (Text)                -- text\nimport Control.Monad.Except            -- mtl\nimport Data.Foldable\n</code></pre>\n\n<p>First I created the most general CSV parsing conduit:</p>\n\n<pre><code>pipeline :: (MonadError CsvParseError m, FromRecord a)\n         =&gt; ConduitM BS.ByteString a m ()\npipeline = fromCsv defaultDecodeOptions NoHeader\n</code></pre>\n\n<p>Then, I wanted to output the number of elements in each row of my csv file - I know this is kind of silly and useless and that there are a billion other ways of doing this kind of things, but that was just a toy test.</p>\n\n<p>So I opened GHCi and tried this:</p>\n\n<pre><code>ghci&gt; :t pipeline .| mapC length\n</code></pre>\n\n<p>As expected, this did not work because the constraint <code>FromRecord a</code> doesn't guarantee that <code>a</code> is <code>Foldable</code>. So I defined the following conduit:</p>\n\n<pre><code>pipeline2 :: (MonadError CsvParseError m, FromField a)\n          =&gt; ConduitM BS.ByteString [a] m ()\npipeline2 = fromCsv defaultDecodeOptions NoHeader\n</code></pre>\n\n<p>This is a legal definition because <code>FromField a =&gt; FromField [a]</code> is an instance of <code>FromRecord</code> according to the <em>cassava</em> documentation.</p>\n\n<p>At this point, I am happy and hopeful because <code>[]</code> is an instance of <code>Foldable</code>. So, once again, I open GHCi, and I try:</p>\n\n<pre><code>ghci&gt; :t pipeline2 .| mapC length\n</code></pre>\n\n<p>But I get:</p>\n\n<pre><code>&lt;interactive&gt;:1:1: error:\n    \u2022 Could not deduce (FromField a0) arising from a use of \u2018pipeline2\u2019\n      from the context: MonadError CsvParseError m\n        bound by the inferred type of\n                 it :: MonadError CsvParseError m =&gt; ConduitM BS.ByteString Int m ()\n        at &lt;interactive&gt;:1:1\n      The type variable \u2018a0\u2019 is ambiguous\n      These potential instances exist:\n        instance FromField a =&gt; FromField (Either Field a)\n          -- Defined in \u2018cassava-0.4.5.0:Data.Csv.Conversion\u2019\n        instance FromField BS.ByteString\n          -- Defined in \u2018cassava-0.4.5.0:Data.Csv.Conversion\u2019\n        instance FromField Integer\n          -- Defined in \u2018cassava-0.4.5.0:Data.Csv.Conversion\u2019\n        ...plus 9 others\n        ...plus 11 instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    \u2022 In the first argument of \u2018(.|)\u2019, namely \u2018pipeline2\u2019\n      In the expression: pipeline2 .| mapC length\n</code></pre>\n\n<p>So my understanding is that my <code>pipeline2</code> is not enough specified.</p>\n\n<p>But now if I try to forge a trivial conduit with an (almost) identical type:</p>\n\n<pre><code>pipeline3 :: (MonadError CsvParseError m, FromField a)\n          =&gt; ConduitM a [a] m ()\npipeline3 = awaitForever $ \\x -&gt; yield [x]\n</code></pre>\n\n<p>Again I open up GHCi and try:</p>\n\n<pre><code>ghci&gt; :t pipeline3 .| mapC length\n</code></pre>\n\n<p>This time I get:</p>\n\n<pre><code>pipeline3 .| mapC length\n  :: (FromField a, MonadError CsvParseError m) =&gt; ConduitM a Int m ()\n</code></pre>\n\n<p>So this time, GHCi understands that I don't have to specify even further the definition of <code>pipeline3</code>.</p>\n\n<p>So my question: why is there a problem with <code>pipeline2</code>? is there a way to define the most generic \"pipeline\" without further specifying the type of the output of the conduit?\nI thought that a list of <code>FromField</code> objects would be enough.</p>\n\n<p>It feels like I am missing an important point about typeclasses and how to compose functions, or here Conduit objects, in a polymorphic manner.</p>\n\n<p>Thank you very much for your answers!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1479923357, "post_id": 40771062, "comment_id": 68766081, "body": "I think you&#39;d be hard pushed to find someone who&#39;d argue that functions using <code>error</code> are ever total."}, {"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1479923484, "post_id": 40771062, "comment_id": 68766168, "body": "So, a function cannot be called total if, upon execution, it may throw a non-fatal exception?"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1479923695, "post_id": 40771062, "comment_id": 68766300, "body": "If to be considered total a function must return a value, a function that throws along any execution path can&#39;t be considered total, since it won&#39;t return in that case."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 7, "creation_date": 1479923826, "post_id": 40771062, "comment_id": 68766383, "body": "@BenjaminHodgson Well, what about <code>g x = const 3 (error &quot;44&quot;)</code>? I&#39;d say nearly everyone would consider it total. (I know, I&#39;m being stubborn here :-P) I would also be picky about what total means in a lazy context. Sometimes, one simply requires that the result is non bottom, with puzzling consequences like <code>h x = (undefined,undefined)</code> being total. Or <code>h x = 1:2:3:undefined</code> being total. Or the OP&#39;s <code>f</code> since e.g. <code>f undefined `seq` ()</code> returns <code>()</code>, hence by monotonicity <code>f</code> never returns bottom. Sometimes &quot;total&quot; means &quot;no bottoms, no matter how far you dig inside&quot;."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1479924483, "post_id": 40771062, "comment_id": 68766770, "body": "@chi you&#39;re right, the issue is a little more complex than I made out; the word &quot;total&quot; has some subtly different meanings. Perhaps we should be talking about &quot;strongly normalising&quot; rather than &quot;total&quot;? Under a strict evaluation strategy <code>const 3 undefined</code> would throw."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1479926499, "post_id": 40771062, "comment_id": 68767851, "body": "If you regard the term <code>return undefined :: IO ()</code> as denoting the program which does nothing and yields the value <code>undefined</code>, then this is a total program - it always runs to completion, without error (e.g. <code>return undefined &gt;&gt; print ()</code>) - it is only by inspecting the value that one discovers that there is a bottom there. But, of course, one can only inspect the value with <code>&gt;&gt;=</code> - which produces a <i>new</i> <code>IO</code> program, which again, only represents a <i>computation</i> - not something containing a value (&quot;There is no String \u201cinside\u201d an IO String&quot;)."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 6, "creation_date": 1479927682, "post_id": 40771062, "comment_id": 68768470, "body": "This is a bit pedantic, but I would say <code>f</code> itself is total since it just gives back the same IO action for all inputs. That IO action, when run, gives back bottom. Note, though, that the error does <i>not</i> occur when the action is <i>just</i> run. The value given back must be inspected in some way. So this is a little different than an error occurring &quot;in&quot; an IO action (as it would if you ran an IO action that threw an error because, say, a handle was closed). It gives you back a &quot;pure&quot; value that is bottom. This leads to the error occurring (potentially, at least) in the non-IO portion of the code."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 2, "creation_date": 1479927974, "post_id": 40771062, "comment_id": 68768607, "body": "So, I&#39;d say: 1) <code>f</code> is total since it just gives back the same IO action for every input 2) The value produced by running that IO action is always a bottom value, so the IO action always gives back a value that&#39;s not total when the action is run (and the value inspected)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1479929684, "post_id": 40771062, "comment_id": 68769449, "body": "@BenjaminHodgson I think it&#39;s tricky as well. About &quot;strongly normalizing&quot;.. I don&#39;t know. I wouldn&#39;t consider <code>fix (\\f x -&gt; if x&lt;0 then 1 else f(x-1)) 24</code> as SN since I can unfold the fixed point infinitely many times, yet the resulting function always returns <code>1</code> (on any nonbottom input), so I&#39;d say that is total. Ditto for <code>const 42 (fix id)</code> which has an infinite reduction but has a totally defined result. SN usually means that there are no infinite reductions. Maybe the &quot;right&quot; notion is something like: for any &quot;good&quot;(?) input, the function applied on that input is weakly normalizing."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 4, "creation_date": 1479934488, "post_id": 40771062, "comment_id": 68771817, "body": "As a matter of theory, it depends in exactly how we define &quot;total&quot; as the comments so far show. As a matter of practice, what we <i>want</i> from totality is that we can always use values together in the way we &quot;expect&quot; from their types without encountering errors. In real programs if you had an <code>f x :: IO Int</code> you would expect to be able to use it as an <code>IO</code> action producing an <code>Int</code>, but if you do your program will fail at runtime."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1479955770, "post_id": 40771062, "comment_id": 68778217, "body": "Looks like you figured out how to troll haskellers"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1480032412, "post_id": 40771062, "comment_id": 68813945, "body": "@Ben You can never trust an IO type. Consider <code>fmap read getLine :: IO Int</code> The trouble is that <code>read</code> is not total. But can we demand that a total function must not mention a non-total one in its result? Then what about <code>f n = (n+) . read</code> Clearly, <code>f a</code> is not total, for any argument a. But does this mean <code>f</code> itself is also not total?"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 1, "creation_date": 1480033699, "post_id": 40771062, "comment_id": 68814203, "body": "@Ingo I don&#39;t think IO or higher-order functions are really related to the heart of the issue. Is <code>f n = [undefined]</code> total? It always returns a non-bottom value, and I can write other total functions that inspect this value (with <code>length</code> or <code>null</code>). It really comes down to: are functions that can return non-bottom things containing bottom total or not? That&#39;s largely a matter of which definition we choose to assign &quot;total&quot;."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 1, "creation_date": 1480033934, "post_id": 40771062, "comment_id": 68814242, "body": "@Ingo My point was that from a practical programmer&#39;s point of view a function that produces <code>return $ error 44</code> is clearly the <b>kind</b> of thing we&#39;re trying to avoid when we prefer total functions, because I have to know more than its type to know what I can safely do with it. The compiler won&#39;t help me catch mistakes as I change things around, I can&#39;t reliably pass it to other operations that take black-box functions unless I know <i>their</i> implementation, etc; all the usual pitfalls of partial functions apply to it, regardless of which theoretical definition of &quot;total&quot; we choose to adopt."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1480081973, "post_id": 40771062, "comment_id": 68833885, "body": "@Ben I absolutely agree with you that <code>return undefined</code> or any other values that contain bottom are undesirable. I tried to show that there are expressions that do not contain bottom themselves, but may be undefined when used in certain ways, so as not to fulfill the promise their type gives. Unfortunately, this is a general Haskell &quot;feature&quot;. Hence I come to the conclusion that it would be unreasonable to demand that a total (Haskell) function would only return values that will keep their type&#39;s promise in any case."}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1479955861, "post_id": 40774957, "comment_id": 68778244, "body": "What if we used the <code>IO</code> representation: <code>data IO a = Return a | PutChar Char (IO a) | GetChar (Char -&gt; IO a) | ...</code> .  Still total?"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1480010994, "post_id": 40774957, "comment_id": 68807220, "body": "@luqui Sure, how would it be not total then? I&#39;d say it would not be total if <code>Return</code> was strict, but it isn&#39;t as it stands."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1480030384, "post_id": 40774957, "comment_id": 68813544, "body": "Just checking your definition. To you total means not exactly bottom for any non-bottom argument. Or maybe for any fully defined argument?  Is <code>last . (0:)</code> total? (we can give it [1,2,undefined]` and it will be undefined)."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1480031662, "post_id": 40774957, "comment_id": 68813797, "body": "@luqui The former. I guess you want to point out that the function in question introduces a &quot;new&quot; bottom that wasn&#39;t passed to it in the first place, so that it is not safe to use the result according to its type. I find that view legitimate, but still prefer the &quot;minimalistic&quot; view for systematic reasons. Consider <code>fmap read getLine :: IO Int</code> No bottom in it, and yet it may produce an undefined value depending of the input. This is to say, it is almost never guaranteed that a value of type <code>IO X</code>  will indeed produce an <code>X</code> when executed."}], "tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 2, "last_activity_date": 1479946773, "last_edit_date": 1479946773, "creation_date": 1479938957, "answer_id": 40774957, "question_id": 40771062, "link": "https://stackoverflow.com/questions/40771062/function-totality-with-io/40774957#40774957", "title": "Function Totality with IO", "body": "<p>The function <code>f</code> is indeed total.\nIt returns, for any input, a value. Specifically, it produces every time the same value.</p>\n\n<p>The value happens to be an IO action, that, when executed, will probably terminate the program, unless run in a context that can deal with the error. But this doesn't play a role, since merely applying <code>f</code> does not run the IO action.</p>\n\n<p>Here is an example program that uses <code>f</code> :</p>\n\n<pre><code>main = putStrLn $ show $ length $ map (f$) [1,2,3]\n</code></pre>\n\n<p>and it should print </p>\n\n<pre><code>3\n</code></pre>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1479946773, "creation_date": 1479922971, "question_id": 40771062, "link": "https://stackoverflow.com/questions/40771062/function-totality-with-io", "title": "Function Totality with IO", "body": "<p>After reading over Prof. Yorgey's <a href=\"http://cis.upenn.edu/~cis194/spring13/lectures/08-IO.html\" rel=\"noreferrer\">lecture</a> on IO, is the following function considered to be total?</p>\n\n<p><code>Prelude&gt; let f x = return $ error \"44\" :: IO Int</code></p>\n\n<p>I understand that a total function terminates and returns a value for every input.</p>\n\n<p>However, since Haskell separates the evaluation and execution of <code>IO</code>, I'm not sure how totality applies to <code>f</code>.</p>\n"}, {"tags": ["haskell", "ghc", "cabal"], "answers": [{"tags": [], "owner": {"reputation": 689, "user_id": 6217179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633461a7b7bd893feebbc9285d0fb049?s=128&d=identicon&r=PG&f=1", "display_name": "sapanoia", "link": "https://stackoverflow.com/users/6217179/sapanoia"}, "is_accepted": true, "score": 1, "last_activity_date": 1479929612, "creation_date": 1479929612, "answer_id": 40772778, "question_id": 40769107, "link": "https://stackoverflow.com/questions/40769107/compiling-haskell-source-as-dynamic-library/40772778#40772778", "title": "Compiling haskell source as dynamic library", "body": "<p>If you generally want to have shared libraries, you can permanently enable it in your <code>.cabal/config</code>:</p>\n\n<pre><code>shared: True\n</code></pre>\n\n<p>However, it will only affect libraries installed after that, so you may want to purge all libraries and start over again.</p>\n\n<p>If this is just a one-shot, you may create a cabal sandbox just for that purpose:</p>\n\n<pre><code>cd yourlib\ncabal sandbox init\ncabal install --enable-shared\n</code></pre>\n\n<p>The result will be in the directory <code>.cabal-sandbox</code>.</p>\n"}], "owner": {"reputation": 313, "user_id": 3703378, "user_type": "registered", "accept_rate": 61, "profile_image": "https://graph.facebook.com/100001130222980/picture?type=large", "display_name": "Kapil", "link": "https://stackoverflow.com/users/3703378/kapil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 40772778, "answer_count": 1, "score": 0, "last_activity_date": 1479929612, "creation_date": 1479917038, "question_id": 40769107, "link": "https://stackoverflow.com/questions/40769107/compiling-haskell-source-as-dynamic-library", "title": "Compiling haskell source as dynamic library", "body": "<p>I'm trying to compile a Haskell source package as a dynamic library to be used with OCaml code. I tried using the <code>--enable-shared</code> option with <code>cabal install</code> on the .cabal file of the source, I got a <code>Perhaps you haven't installed the \"dyn\" libraries for package 'zeromq4-haskell-0.6.5'</code> error. After a little googling, I realised that the dependencies must also be compiled as dynamic libraries. I downloaded the source package for zeromq and tried installing the zeromq package with the <code>--enable-shared</code> option. This time I got a similar error with one of zeromq's dependencies. I tried doing this 4-5 times and get an error with a different dependency at each level.</p>\n\n<p>Am I making a mistake here? How can I get all of the dependencies to install as dynamic libraries?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "edited": false, "score": 0, "creation_date": 1479918644, "post_id": 40769610, "comment_id": 68763249, "body": "Thanks. Hadn&#39;t thought of that."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1479927898, "post_id": 40769610, "comment_id": 68768578, "body": "Might be worth mentioning <code>TypeApplications</code>?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1479928962, "post_id": 40769610, "comment_id": 68769108, "body": "@Alec Yes, that would actually be my first choice. However, in such simple case a type annotation suffices and requires no extensions. Further, here we would need <code>fromIntegral @ _ @ Integer int</code> which isn&#39;t as convenient, since we need to make explicit the second type argument."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1479918516, "creation_date": 1479918516, "answer_id": 40769610, "question_id": 40769023, "link": "https://stackoverflow.com/questions/40769023/how-to-tell-ghc-what-fromintegral-should-do/40769610#40769610", "title": "How to tell GHC what fromIntegral should do", "body": "<p>You can provide a type annotation to the <code>fromIntegral</code> call, so to make it non ambiguous.</p>\n\n<pre><code>instance N_aryAble Int where\n  int ~&gt; base = (fromIntegral int :: Integer) ~&gt; base\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1479919623, "last_edit_date": 1495539958, "creation_date": 1479919165, "answer_id": 40769855, "question_id": 40769023, "link": "https://stackoverflow.com/questions/40769023/how-to-tell-ghc-what-fromintegral-should-do/40769855#40769855", "title": "How to tell GHC what fromIntegral should do", "body": "<p>The problem is not that the compiler can't deduce <em>what <strong>from</strong></em> to convert the type from. That could be fixed with a signature for that particular instance method, which BTW you could write like</p>\n\n<pre><code>instance N_aryAble Int where\n  (~&gt;) = (~~&gt;)\n   where (~~&gt;) :: Int -&gt; Int -&gt; N_ary\n         int ~~&gt; base = fromIntegral int ~&gt; base\n</code></pre>\n\n<p>But that information is already clear from the class method signature, so it won't help you.</p>\n\n<p>No, the problem is that you don't specify what type <em>to convert <strong>to</strong></em>, and because the argument to <code>~&gt;</code> is again polymorphic the compiler has nothing else to infer it from. This could as well convert <code>Int</code> to <code>Int</code>, causing an infinite recursion loop because you end up with the same <code>~&gt;</code> instantiation you're trying to define!</p>\n\n<p>You can either clarify this with a signature to the result of <code>fromIntegral</code> as <a href=\"https://stackoverflow.com/a/40769610/745903\">shown by chi</a>, or you can simply use the <code>to-</code>-version of the conversion function that's monomorphic with an <code>Integer</code> result:</p>\n\n<pre><code>instance N_aryAble Int where\n  int ~&gt; base = toInteger int ~&gt; base\n</code></pre>\n"}], "owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 40769610, "answer_count": 2, "score": 0, "last_activity_date": 1479919623, "creation_date": 1479916823, "question_id": 40769023, "link": "https://stackoverflow.com/questions/40769023/how-to-tell-ghc-what-fromintegral-should-do", "title": "How to tell GHC what fromIntegral should do", "body": "<pre><code>data N_ary = N_ary Int String Int deriving Eq\n</code></pre>\n\n<p>stores numbers to various bases. For example 15 to the bases 2, 10, and 16 are <code>N_ary 1 \"1111\" 2</code>, <code>N_ary 1 \"15\" 10</code>, and <code>N_ary 1 \"F\" 16</code> respectively. (The first field is -1, 0, or 1 as a sign.)</p>\n\n<p>I defined an operator <code>infixl 5 ~&gt;</code> for converting things into <code>N_ary</code> objects and a class for convertible types.  </p>\n\n<pre><code>class N_aryAble a where\n  (~&gt;) :: a -&gt; Int -&gt; N_ary\n</code></pre>\n\n<p>I had no problems with <code>instance N_aryAble Integer</code> or <code>instance N_aryAble N_ary</code> (to change one base to another), but I ran into a problem with</p>\n\n<pre><code>instance N_aryAble Int where\n  int ~&gt; base = fromIntegral int ~&gt; base\n\nAmbiguous type variable \u2018a0\u2019 arising from a use of \u2018fromIntegral\u2019\nprevents the constraint \u2018(Num a0)\u2019 from being solved.\n...\n\nAmbiguous type variable \u2018a0\u2019 arising from a use of \u2018~&gt;\u2019\nprevents the constraint \u2018(N_aryAble a0)\u2019 from being solved.\n...\n</code></pre>\n\n<p>Type signatures within instance declarations are not allowed without a special setting.</p>\n\n<pre><code>instance N_aryAble Int where\n  (~&gt;) :: Int -&gt; Int -&gt; N_ary\n  int ~&gt; base = fromIntegral int ~&gt; base\n\n Illegal type signature in instance declaration:\n    (~&gt;) :: Int -&gt; Int -&gt; N_ary\n  (Use InstanceSigs to allow this)\n</code></pre>\n\n<p>The following works.</p>\n\n<pre><code>instance N_aryAble Int where\n  int ~&gt; base = fromIntegral int + (0::Integer) ~&gt; base\n\n&gt; (5::Int) ~&gt; 2  ==&gt; N_ary 1 \"101\" 2\n</code></pre>\n\n<p>But that seems ugly and <em>ad hoc</em>. Is there a better way?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell", "cabal", "ghci", "bnfc"], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 4161187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55a2a55ce149b8044cb26061ecbc4156?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/4161187/will"}, "edited": false, "score": 0, "creation_date": 1480076209, "post_id": 40770367, "comment_id": 68830465, "body": "How do I go about adding that to my PATH?"}, {"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "reply_to_user": {"reputation": 139, "user_id": 4161187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55a2a55ce149b8044cb26061ecbc4156?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/4161187/will"}, "edited": false, "score": 0, "creation_date": 1480088720, "post_id": 40770367, "comment_id": 68837632, "body": "Depends on the shell you use. For bash, you&#39;d normally add a line such as <code>export PATH=&quot;~&#47;.cabal&#47;bin:$PATH&quot;</code> to the end of your <code>.bashrc</code>."}], "tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": false, "score": 2, "last_activity_date": 1479920704, "creation_date": 1479920704, "answer_id": 40770367, "question_id": 40768967, "link": "https://stackoverflow.com/questions/40768967/bnfc-install-error/40770367#40770367", "title": "BNFC install error", "body": "<p>The Haskell Platform should already come with alex and happy. cabal installs binaries to <code>~/.cabal/bin</code> by default, which may not be on your <code>PATH</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 139, "user_id": 4161187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55a2a55ce149b8044cb26061ecbc4156?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/4161187/will"}, "is_accepted": true, "score": 0, "last_activity_date": 1480113078, "creation_date": 1480113078, "answer_id": 40812972, "question_id": 40768967, "link": "https://stackoverflow.com/questions/40768967/bnfc-install-error/40812972#40812972", "title": "BNFC install error", "body": "<p>Ended up copying across the files (alex, bnfc and happy) from </p>\n\n<blockquote>\n  <p>/Users/<em>username</em>/Library/Haskell/bin</p>\n</blockquote>\n\n<p>to </p>\n\n<blockquote>\n  <p>/usr/local/bin/</p>\n</blockquote>\n\n<p>and all working now</p>\n"}], "owner": {"reputation": 139, "user_id": 4161187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55a2a55ce149b8044cb26061ecbc4156?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/4161187/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 448, "favorite_count": 0, "accepted_answer_id": 40812972, "answer_count": 2, "score": 1, "last_activity_date": 1480113078, "creation_date": 1479916686, "question_id": 40768967, "link": "https://stackoverflow.com/questions/40768967/bnfc-install-error", "title": "BNFC install error", "body": "<p>I am trying to install BNFC on my Mac (Running OS Sierra). I have already installed the Haskell Platform for Mac (v.8.0.1)\nI have installed cabal then used that to install alex (v 3.2.1) and happy (v 1.19.5). I then ran the cabal install bnfc and that installs properly. The problem is as soon as I type bnfc or try using any bnfc commands I get:</p>\n\n<blockquote>\n  <p><em>-bash: bnfc: command not found</em></p>\n</blockquote>\n\n<p>Is there something I am missing here? \nWhen I try installing BNFC again I get:</p>\n\n<blockquote>\n  <p><em>All the requested packages are already installed: BNFC-2.8.1</em></p>\n</blockquote>\n\n<p>Any ideas? Thanks!</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 3, "creation_date": 1479933454, "post_id": 40767618, "comment_id": 68771344, "body": "There&#39;s not any straightforward way to do this. You&#39;d have to get at the internals of the <code>HandlerT</code> value and then replace its rendering function. It&#39;s probably easier to do something like <code>Data.Text.replace</code> on the domain name (though please don&#39;t do something that brash...)."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 2, "creation_date": 1479939711, "post_id": 40767618, "comment_id": 68774047, "body": "I found a workaround using <code>renderRoute</code>, it&#39;s just annoying to not be able modify temporarily the app settings."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 3, "creation_date": 1479958256, "post_id": 40767618, "comment_id": 68778825, "body": "Can you add your solution as an answer?"}], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1479912698, "creation_date": 1479912698, "question_id": 40767618, "link": "https://stackoverflow.com/questions/40767618/how-to-update-localy-a-yesod-monad", "title": "How to update localy a Yesod monad", "body": "<p>I'm using Yesod and need to modify temporarily <code>approot</code> so that <code>renderUrl</code> generate local routes (ie starting with <code>/</code>) instead of global ones (include the host).</p>\n\n<p>One way to do so would be to override <code>approot</code> with <code>ApprootRelative</code> and call <code>renderUrl</code>. However, I'm inside a <a href=\"https://hackage.haskell.org/package/yesod-core-1.4.26/docs/Yesod-Core.html\" rel=\"nofollow noreferrer\">Yesod monad</a> monad, so I'm not sure how can get a yesod \"object\", modify it's <code>approot</code> and call <code>renderUrl</code> to it.</p>\n"}, {"tags": ["sql", "haskell", "yesod", "haskell-persistent"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1479911164, "post_id": 40766755, "comment_id": 68758112, "body": "Can you show how the persistent models is defined ?"}, {"owner": {"reputation": 1169, "user_id": 876225, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4d5xY.jpg?s=128&g=1", "display_name": "Alebon", "link": "https://stackoverflow.com/users/876225/alebon"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1479918636, "post_id": 40766755, "comment_id": 68763240, "body": "Sure, added model description"}], "answers": [{"comments": [{"owner": {"reputation": 1169, "user_id": 876225, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4d5xY.jpg?s=128&g=1", "display_name": "Alebon", "link": "https://stackoverflow.com/users/876225/alebon"}, "edited": false, "score": 0, "creation_date": 1526977594, "post_id": 50278582, "comment_id": 87939103, "body": "Actually it is not what I meant. I know how to access the URL parts for year, month and day. I want to have it in the Persistent query, so I don&#39;t need to check this myself :)"}, {"owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "reply_to_user": {"reputation": 1169, "user_id": 876225, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4d5xY.jpg?s=128&g=1", "display_name": "Alebon", "link": "https://stackoverflow.com/users/876225/alebon"}, "edited": false, "score": 0, "creation_date": 1526984060, "post_id": 50278582, "comment_id": 87943454, "body": "@Alebon Understood. I can help you with that. You should think of <code>UTCTime</code> as a time stamp or a number. The best way to do that would be to check for a <code>UTCTime</code> stamp that exists in a range like beginning of <code>2016&#47;11&#47;23</code> to the end of <code>2016&#47;11&#47;23</code>. The only problem is that you might have to adjust it for a particular time zone, or does that matter for you?"}, {"owner": {"reputation": 1169, "user_id": 876225, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4d5xY.jpg?s=128&g=1", "display_name": "Alebon", "link": "https://stackoverflow.com/users/876225/alebon"}, "edited": false, "score": 0, "creation_date": 1527151990, "post_id": 50278582, "comment_id": 88022052, "body": "No, time zone is not of an interest here. Incoming params are aligned to the createdAt date in db. I don&#39;t use specific time zone changes. Thanks a lot for the quick response."}], "tags": [], "owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "is_accepted": false, "score": 0, "last_activity_date": 1525974169, "creation_date": 1525974169, "answer_id": 50278582, "question_id": 40766755, "link": "https://stackoverflow.com/questions/40766755/haskell-persistent-query-on-dates-yesod/50278582#50278582", "title": "Haskell Persistent query on dates (Yesod)", "body": "<pre><code>getBlogPostR :: Slug -&gt; Handler Html\ngetBlogPostR pathSlug = do\n  Entity _ BlogPost {..} &lt;- runDB $ getBy404 $ UniqueBlogPostSlug pathSlug\n  mYear &lt;- lookupGetParam \"year\"\n  mMonth &lt;- lookupGetParam \"month\"\n  mDay &lt;- lookupGetParam \"day\"\n  case (,,) &lt;$&gt; mYear &lt;*&gt; mMonth &lt;*&gt; mDay of\n    Just (queryYear, queryMonth, queryDay) -&gt; do \n      let (year, month, day) = toGregorian $ utctDay blogPostCreatedAt\n      if (fromIntegral year /= queryYear &amp;&amp; month /= queryMonth &amp;&amp; day /= queryDay)\n        then notFound\n        else\n          defaultLayout $ do\n            setTitleI blogPostTitle\n            $(widgetFile \"blog/post\")\n    Nothing -&gt; notFound\n</code></pre>\n"}], "owner": {"reputation": 1169, "user_id": 876225, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4d5xY.jpg?s=128&g=1", "display_name": "Alebon", "link": "https://stackoverflow.com/users/876225/alebon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 251, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1525974169, "creation_date": 1479910339, "last_edit_date": 1479918619, "question_id": 40766755, "link": "https://stackoverflow.com/questions/40766755/haskell-persistent-query-on-dates-yesod", "title": "Haskell Persistent query on dates (Yesod)", "body": "<p>I am trying to add date parts into an URL for a blog post, lets say</p>\n\n<pre><code>/blog/2016/11/23/my-blog-post-slug\n</code></pre>\n\n<p>I want to check not only for the slug but the date parts as well. This is what I got so far:</p>\n\n<pre><code>getBlogPostR :: Int -&gt; Int -&gt; Int -&gt; Slug -&gt; Handler Html\ngetBlogPostR pathYear pathMonth pathDay pathSlug = do\n  Entity _ BlogPost {..} &lt;- runDB $ getBy404 $ UniqueBlogPostSlug pathSlug\n  let (year, month, day) = toGregorian $ utctDay blogPostCreatedAt\n  if (fromIntegral year /= pathYear &amp;&amp; month /= pathMonth &amp;&amp; day /= pathDay)\n    then notFound\n    else\n      defaultLayout $ do\n        setTitleI blogPostTitle\n        $(widgetFile \"blog/post\")\n</code></pre>\n\n<p>Seems to be a bit clunky. Is there a way to add this year, month, day parts as query filtering params? (I know I could execute a raw query, but this is not what I am looking for)</p>\n\n<p>[Additional Info]</p>\n\n<p>My models are defined as follows:</p>\n\n<pre><code>BlogPost\n  uuid Text\n  title Text\n  slug Text\n  markdownContent Text\n  createdAt UTCTime\n  UniqueBlogPostUuid uuid\n  UniqueBlogPostSlug slug\n  Primary uuid\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1479896307, "post_id": 40761424, "comment_id": 68747782, "body": "Why is this tagged with &quot;multithreading&quot;? The question has nothing to do with multithreading."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1479908721, "post_id": 40761424, "comment_id": 68756454, "body": "Wait. Aren&#39;t you the same user that asked two question about Haskell and concurrency? Your user name is <a href=\"https://stackoverflow.com/questions/40726052/how-to-create-threads-in-haskell\">eerily familiar</a>\u2026"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1479942705, "post_id": 40761424, "comment_id": 68775029, "body": "It says <b>in the first argument</b> of &#39;funct&#39;. Not in the return type!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7199330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33f119934032df79736b3ea90e0f549?s=128&d=identicon&r=PG&f=1", "display_name": "i1892700", "link": "https://stackoverflow.com/users/7199330/i1892700"}, "edited": false, "score": 0, "creation_date": 1479897760, "post_id": 40761609, "comment_id": 68748793, "body": "Thanks, it works! But after I changes this function a little it gives another error. Please, see update"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 3, "user_id": 7199330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33f119934032df79736b3ea90e0f549?s=128&d=identicon&r=PG&f=1", "display_name": "i1892700", "link": "https://stackoverflow.com/users/7199330/i1892700"}, "edited": false, "score": 7, "creation_date": 1479905962, "post_id": 40761609, "comment_id": 68754544, "body": "@i1892700 please don&#39;t edit your questions once the original problem is solved. If you run into new problems, you may (after you&#39;ve tried and failed to solve them yourself!) ask <i>a new question</i> about them."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 3, "user_id": 7199330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33f119934032df79736b3ea90e0f549?s=128&d=identicon&r=PG&f=1", "display_name": "i1892700", "link": "https://stackoverflow.com/users/7199330/i1892700"}, "edited": false, "score": 1, "creation_date": 1479928783, "post_id": 40761609, "comment_id": 68769022, "body": "@i1892700 If my suspicion is right, you might also want to consider not making a new user for every question... You can just post new questions with the same account."}], "tags": [], "owner": {"reputation": 52258, "user_id": 375232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/h3OwD.png?s=128&g=1", "display_name": "Landei", "link": "https://stackoverflow.com/users/375232/landei"}, "is_accepted": true, "score": 4, "last_activity_date": 1479896314, "creation_date": 1479896314, "answer_id": 40761609, "question_id": 40761424, "link": "https://stackoverflow.com/questions/40761424/haskell-couldnt-match-expected-type-double-with-actual-type-int/40761609#40761609", "title": "Haskell Couldn&#39;t match expected type \u2018Double\u2019 with actual type \u2018Int\u2019", "body": "<p>You need to convert the <code>Int</code> <code>n</code> to a <code>Double</code>:</p>\n\n<pre><code>zetaRange (x,y) = [ 0.01 * funct (fromIntegral n) | n &lt;- [x..y] ]\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7199330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33f119934032df79736b3ea90e0f549?s=128&d=identicon&r=PG&f=1", "display_name": "i1892700", "link": "https://stackoverflow.com/users/7199330/i1892700"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4230, "favorite_count": 0, "accepted_answer_id": 40761609, "answer_count": 1, "score": 0, "last_activity_date": 1479904029, "creation_date": 1479895838, "last_edit_date": 1592644375, "question_id": 40761424, "link": "https://stackoverflow.com/questions/40761424/haskell-couldnt-match-expected-type-double-with-actual-type-int", "title": "Haskell Couldn&#39;t match expected type \u2018Double\u2019 with actual type \u2018Int\u2019", "body": "<p>This is the  code of my program:</p>\n<pre><code>funct :: Double -&gt; Double\nfunct x = 3/(x^2+1)\n\nzetaRange :: (Int, Int) -&gt; [Double]\nzetaRange (x,y) = [ 0.01 * funct n | n &lt;- [x..y] ]\n</code></pre>\n<p>and error, which I'm getting:</p>\n<blockquote>\n<p>Couldn't match expected type \u2018Double\u2019 with actual type \u2018Int\u2019</p>\n<p>In the first argument of \u2018funct\u2019, namely \u2018n\u2019</p>\n<p>In the second argument of \u2018(*)\u2019, namely \u2018funct n\u2019</p>\n</blockquote>\n<p>I really newbie to haskell, so trying to fix this error wasn't successful. funct is returning Double, so I can't understand why error says that it's actual type is Int. Please, help!</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 724, "user_id": 697106, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4beb647561097f27f25a0a217bb3b301?s=128&d=identicon&r=PG", "display_name": "Samuel Breese", "link": "https://stackoverflow.com/users/697106/samuel-breese"}, "is_accepted": false, "score": 1, "last_activity_date": 1480441949, "last_edit_date": 1480441949, "creation_date": 1479907682, "answer_id": 40765832, "question_id": 40760929, "link": "https://stackoverflow.com/questions/40760929/how-to-fix-the-errorvariable-not-in-scope-md5-c8-bytestring-a0/40765832#40765832", "title": "how to fix the error:&quot;Variable not in scope: md5 :: C8.ByteString -&gt; a0&quot;?", "body": "<p>The code you are attempting to compile depends upon a number of packages (these are listed under <code>build-depends</code> in <code>blog/blog.cabal</code>). Typically, one would use a tool such as <code>cabal-install</code> or Stack to ensure that the build environment is properly configured and that all dependencies are installed.</p>\n"}], "owner": {"reputation": 10341, "user_id": 2309581, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/10436db746e1d57fbdb861fc4a155481?s=128&d=identicon&r=PG", "display_name": "fisherman", "link": "https://stackoverflow.com/users/2309581/fisherman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1480441949, "creation_date": 1479894557, "question_id": 40760929, "link": "https://stackoverflow.com/questions/40760929/how-to-fix-the-errorvariable-not-in-scope-md5-c8-bytestring-a0", "title": "how to fix the error:&quot;Variable not in scope: md5 :: C8.ByteString -&gt; a0&quot;?", "body": "<p>git clone <a href=\"https://github.com/ian-ross/blog\" rel=\"nofollow noreferrer\">https://github.com/ian-ross/blog</a> ian-ross-blog</p>\n\n<p>cd ian-ross-blog</p>\n\n<p>cd build</p>\n\n<p>i modified blog.hs:</p>\n\n<p>delete \"import System.Locale (defaultTimeLocale)\"</p>\n\n<p>change \"import Data.Time.Format (formatTime)\" to be</p>\n\n<p>\"import Data.Time.Format (formatTime, defaultTimeLocale)\"</p>\n\n<p>then i ran \"ghc --make blog.hs\",</p>\n\n<p>root@AR:/usr/local/ian-ross-blog/build# ghc --make blog.hs</p>\n\n<p>[1 of 2] Compiling TikZ ( TikZ.hs, TikZ.o )</p>\n\n<p>TikZ.hs:148:23: error:</p>\n\n<p>Variable not in scope: md5 :: C8.ByteString -> a0</p>\n\n<p>root@AR:/usr/local/ian-ross-blog/build#</p>\n\n<p>so,how to fix the error:\"Variable not in scope: md5 :: C8.ByteString -> </p>\n\n<p>a0\"?</p>\n"}, {"tags": ["haskell", "type-level-computation"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1479928941, "post_id": 40758738, "comment_id": 68769097, "body": "I don&#39;t think that&#39;s supposed to work. However, it&#39;s perfectly harmless because the synonyms are expanded in type checking."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1479929067, "post_id": 40758738, "comment_id": 68769156, "body": "I believe you&#39;re really supposed to provide a defunctionalization symbol for <code>Flip</code> with its own <code>Apply</code> instance. <code>TyCon1</code> is intended to be applied to type constructors. By the way, what version of GHC is this?"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1479931254, "post_id": 40758738, "comment_id": 68770226, "body": "@dfeuer I&#39;m using GHC 8.0.1. Apparently, the thing works when using <code>:kind!</code> in ghci, but if I try to add something like <code>type Boo = Map (TyCon1 Flip) &#39;[Char,Int]</code> to the script, it gives me a compilation error."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1479931566, "post_id": 40758738, "comment_id": 68770397, "body": "@dfeuer When you say &quot;you&#39;re really supposed to provide a defunctionalization symbol for Flip&quot; do yo mean something like <code>data FlipSym :: TyFun * * -&gt; *</code>, <code>type instance Apply FlipSym x = Flip x</code>? This way seems to work."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1479933279, "post_id": 40758738, "comment_id": 68771273, "body": "Yes, that sounds right. I don&#39;t know why <code>kind!</code> behaves like that."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1479933761, "post_id": 40758738, "comment_id": 68771486, "body": "@dfeuer You could put those comments in an answer so that I could accept it."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1479937665, "post_id": 40758738, "comment_id": 68773245, "body": "@dfeuer <code>kind!</code> behaves like so because <code>:kind! SomeTypeFamily</code> is supposed to work, even when the type family isn&#39;t fully applied - but clearly this rule shouldn&#39;t be applied to sub-expressions, only to the outer application, in the thing occurring to the right of <code>:kind!</code>. It would seem this is a bug in GHCi."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1480028619, "post_id": 40794384, "comment_id": 68813150, "body": "Sorry I didn&#39;t get around to putting up an answer myself. Yours is at least as good as what I&#39;d have written. One nit I&#39;d like to pick: I don&#39;t like the name <code>Flip</code> for that family. In my mind, that name is always defined <code>newtype Flip (f :: j -&gt; k -&gt; *) (y :: k) (x :: j) = Flip { unFlip :: f x y }</code>. The resulting type-level version of <code>flip</code> comes up fairly often, and generally in contexts where the type synonym version (<code>type Flip f y x = f x y</code>) would not be useful."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 2, "last_activity_date": 1480027411, "last_edit_date": 1480027411, "creation_date": 1480021028, "answer_id": 40794384, "question_id": 40758738, "link": "https://stackoverflow.com/questions/40758738/why-doesnt-this-code-infringe-the-saturation-requirement-of-type-families/40794384#40794384", "title": "Why doesn&#39;t this code infringe the &quot;saturation requirement of type families&quot;?", "body": "<p>I'm answering my own question with information culled from dfeuer and user2407038's comments.</p>\n\n<p>Turns out that my code <em>did</em> infringe the saturation requirement. I didn't find the error because of a strange behaviour (bug?) of <code>:kind!</code> in ghci. But writing the type in the <em>hs</em> file itself gives a compilation error.</p>\n\n<p><code>TyCon1</code> is not for type families, but for wrapping regular type constructors like <code>Maybe</code>, that have no problem unifying with type variables. <code>type Foo = Map (TyCon1 Maybe) '[Char,Int]</code> works fine, for example.</p>\n\n<p>For type families, we need to define a special auxiliary type for each of them, and then define an <code>Apply</code> instance for the type. Like this:</p>\n\n<pre><code>data FlipSym :: TyFun * * -&gt; *\ntype instance Apply FlipSym x = Flip x\n\ntype Boo = Map FlipSym '[Char,Int]\n</code></pre>\n\n<p>Notice that this way the <code>Flip</code> type family is not unifying with any type variable.</p>\n"}], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 1, "accepted_answer_id": 40794384, "answer_count": 1, "score": 8, "last_activity_date": 1480027411, "creation_date": 1479887390, "question_id": 40758738, "link": "https://stackoverflow.com/questions/40758738/why-doesnt-this-code-infringe-the-saturation-requirement-of-type-families", "title": "Why doesn&#39;t this code infringe the &quot;saturation requirement of type families&quot;?", "body": "<p>I have this minimal working example (culled from the <a href=\"http://hackage.haskell.org/package/singletons\" rel=\"nofollow noreferrer\">singletons</a> library) of mapping a type family over a type-level list:</p>\n\n<pre><code>{-# language PolyKinds #-}\n{-# language DataKinds #-}\n{-# language TypeFamilies #-}\n{-# language TypeOperators #-}\n\ndata TyFun :: * -&gt; * -&gt; *\n\ndata TyCon1 :: (k1 -&gt; k2) -&gt; (TyFun k1 k2 -&gt; *)\n\ntype family Apply (f :: TyFun k1 k2 -&gt; *) (x :: k1) :: k2\ntype instance Apply (TyCon1 f) x = f x\n\ntype family Map (f :: TyFun a b -&gt; *) (as :: [a]) :: [b] where\n    Map f '[] = '[]\n    Map f (x ': xs) = Apply f x ': Map f xs\n\ntype family Flip t :: * where\n    Flip Int = Char\n    Flip Char = Int    \n</code></pre>\n\n<p>It seems to work:</p>\n\n<pre><code>ghci&gt; :set -XDataKinds\nghci&gt; :kind! Map (TyCon1 Flip) '[Char,Int]\nMap (TyCon1 Flip) '[Char,Int] :: [*]\n= '[Int, Char]\n</code></pre>\n\n<p>The code is explained in the post <a href=\"https://typesandkinds.wordpress.com/2013/04/01/defunctionalization-for-the-win/\" rel=\"nofollow noreferrer\">Defunctionalization for the win</a>. It is a workaround for the fact that \"GHC will not let a type variable unify with a type family\". This is called the \"saturation requirement of type families\".</p>\n\n<p>My doubt is: when we \"run\" <code>:kind! Map (TyCon1 Flip) '[Char,Int]</code> it seems that , in the line <code>type instance Apply (TyCon1 f) x = f x</code>, <code>f</code> will be matched with our <code>Flip</code> type family. Why doesn't this infringe the saturation requirement?</p>\n"}, {"tags": ["parsing", "haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1479914087, "post_id": 40758487, "comment_id": 68760152, "body": "&quot;PEMDAS&quot; isn&#39;t a real word. Do you mean &quot;the order of operations&quot;?"}, {"owner": {"reputation": 175, "user_id": 7136164, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7058f7625f65cc7249d5150d99e43b5d?s=128&d=identicon&r=PG", "display_name": "Harambe17", "link": "https://stackoverflow.com/users/7136164/harambe17"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1479916850, "post_id": 40758487, "comment_id": 68762021, "body": "Yes, order of operations."}, {"owner": {"reputation": 8014, "user_id": 418591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d04c8f3f8e6496c35813dcb6b742e8ed?s=128&d=identicon&r=PG", "display_name": "Brian Hempel", "link": "https://stackoverflow.com/users/418591/brian-hempel"}, "edited": false, "score": 0, "creation_date": 1512511239, "post_id": 40758487, "comment_id": 82289973, "body": "Hello CS 161 Students Who Found This Page By Searching, 1. Don&#39;t post homework online. 2. Don&#39;t rely on SO contributors to do your homework for you. If you are having trouble, post on Piazza. That&#39;s why we use it. And familiarize yourselves with the collaboration policy: <a href=\"http://cmsc-16100.cs.uchicago.edu/2017/policies.php\" rel=\"nofollow noreferrer\">cmsc-16100.cs.uchicago.edu/2017/policies.php</a> We will expect any solution you turn in to demonstrate original interaction with the assignment. Email us if you have any questions. Peace, Your Instructors"}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 7136164, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7058f7625f65cc7249d5150d99e43b5d?s=128&d=identicon&r=PG", "display_name": "Harambe17", "link": "https://stackoverflow.com/users/7136164/harambe17"}, "edited": false, "score": 0, "creation_date": 1479922489, "post_id": 40765612, "comment_id": 68765564, "body": "One more question: If I also wanted to implement a parser that could read the following string: &quot;put (x,y,zee) = (1,2,3) for x+y*zee&quot; with the words &quot;put&quot; and &quot;for&quot; indicating I&#39;m declaring/using variables, and I want this to parse to <code>[&quot;x&quot;, &quot;y&quot;, &quot;zee&quot;] [Number 1, Number 2, Number 3] (Plus (Var &quot;x) (Mult (Var &quot;y) (Var &quot;zee&quot;)))</code> how would I go about doing this?"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "reply_to_user": {"reputation": 175, "user_id": 7136164, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7058f7625f65cc7249d5150d99e43b5d?s=128&d=identicon&r=PG", "display_name": "Harambe17", "link": "https://stackoverflow.com/users/7136164/harambe17"}, "edited": false, "score": 0, "creation_date": 1479923600, "post_id": 40765612, "comment_id": 68766237, "body": "First of all, you have to design Abstract Syntax Tree (AST) for your task with respect to your syntax. Then, you can think about parse of AST. I don&#39;t understand syntax and semantic of your example, that&#39;s why I can&#39;t help you more."}], "tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": true, "score": 3, "last_activity_date": 1479910653, "last_edit_date": 1479910653, "creation_date": 1479907091, "answer_id": 40765612, "question_id": 40758487, "link": "https://stackoverflow.com/questions/40758487/reading-parentheses-and-negation/40765612#40765612", "title": "Reading Parentheses and Negation", "body": "<p>You can do like this:</p>\n\n<pre><code>import Control.Applicative\nimport Data.Char\nimport Text.ParserCombinators.ReadP\n\ntype Name = String\ntype Number = Int\n\ndata MathExp\n    = Number Number\n    | Neg    MathExp\n    | Plus   MathExp MathExp\n    | Minus  MathExp MathExp\n    | Mult   MathExp MathExp\n    | Div    MathExp MathExp\n    | Pow    MathExp MathExp\n    | Var    Name\n    deriving (Eq, Show)\n\nrunParser :: ReadP a -&gt; String -&gt; Maybe a\nrunParser p s =\n    case readP_to_S p s of\n        [(x, [])] -&gt; Just x\n        _         -&gt; Nothing\n\nmathExp  = mathExp' &lt;* skipSpaces &lt;* eof\nmathExp' = term   `chainl1` addop\nterm     = factor `chainl1` mulop\nfactor   = expo   `chainr1` expop\nexpo     = number &lt;|&gt; var &lt;|&gt; parens mathExp' &lt;|&gt; neg expo\n\nnumber = skipSpaces *&gt; (Number . read &lt;$&gt; munch1 isDigit)\nvar    = skipSpaces *&gt; (Var &lt;$&gt; munch1 isAlpha)\naddop  = skipSpaces *&gt; (Plus &lt;$ char '+' &lt;|&gt; Minus &lt;$ char '-')\nmulop  = skipSpaces *&gt; (Mult &lt;$ char '*' &lt;|&gt; Div &lt;$ char '/')\nexpop  = skipSpaces *&gt; (Pow &lt;$ char '^')\nneg p  = skipSpaces *&gt; (Neg &lt;$&gt; (char '-' *&gt; p))\n\nparens = between (skipSpaces *&gt; char '(') (skipSpaces *&gt; char ')')\n\nmain = print $ runParser mathExp \"1+2* - 3\"\n</code></pre>\n\n<p>Output will be:</p>\n\n<pre><code>Just (Plus (Number 1) (Mult (Number 2) (Neg (Number 3))))\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 7136164, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7058f7625f65cc7249d5150d99e43b5d?s=128&d=identicon&r=PG", "display_name": "Harambe17", "link": "https://stackoverflow.com/users/7136164/harambe17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "accepted_answer_id": 40765612, "answer_count": 1, "score": 1, "last_activity_date": 1512511239, "creation_date": 1479886403, "last_edit_date": 1480390414, "question_id": 40758487, "link": "https://stackoverflow.com/questions/40758487/reading-parentheses-and-negation", "title": "Reading Parentheses and Negation", "body": "<p>My goal is to build a calculator in Haskell using Text.ParserCombinators.ReadP, which implements +,-,*,/,^, as well as negation, and follows PEMDAS. First, I have to parse a string input to a mathematical expression (<code>MathExp</code>). Part of the code I have is as follows: </p>\n\n<pre><code>import Control.Applicative hiding (many)\nimport Control.Monad\nimport Data.Char\nimport Data.List\nimport Data.Ord\nimport Text.ParserCombinators.Readp\ntype Name   = String  \ntype Number = Int    \n\ndata MathExp\n  = Number Number\n  | Neg    MathExp\n  | Plus   MathExp MathExp\n  | Minus  MathExp MathExp\n  | Mult   MathExp MathExp\n  | Div    MathExp MathExp\n  | Pow    MathExp MathExp\n  | Var    String\n  deriving (Eq, Show)\n\nparseNumber :: ReadP MathExp\nparseNumber = do\n  skipSpaces\n  x &lt;- munch1 isDigit\n  return (Number (read x :: Int))\n\nparsePlus :: ReadP (MathExp -&gt; MathExp -&gt; MathExp)\nparsePlus = do\n  x &lt;- char '+'\n  return Plus\n\nparseMinus :: ReadP (MathExp -&gt; MathExp -&gt; MathExp)\nparseMinus = do\n  skipSpaces\n  x &lt;- char '-'\n  return Minus\n\nparsePlusMinus = choice [parsePlus, parseMinus] --parse both--\n\nparseMult :: ReadP (MathExp -&gt; MathExp -&gt; MathExp)\nparseMult = do\n  x &lt;- char '*'\n  return Mult\n\nparseDiv :: ReadP (MathExp -&gt; MathExp -&gt; MathExp)\nparseDiv = do\n  x &lt;- char '/'\n  return Div\n\nparseMultDiv = choice [parseMult, parseDiv] --parse both M,D--\nparsePow :: ReadP (MathExp -&gt; MathExp -&gt; MathExp)\nparsePow = do\n  x &lt;- char '^'\n  return Pow\n\nparseNeg :: ReadP MathExp\nparseNeg = undefined\nparseParens = undefined\n</code></pre>\n\n<p>I have no problem combining the parsers I currently have, using <code>chainl1</code> and <code>chainr1</code>, to implement associativity and precedence in the right order, but I have no clue how to implement negation and parentheses properly.</p>\n\n<p>What I do know if that negation is also a <code>-</code> sign, and it can come before either an integer, parentheses, or a variable (letter string). The variables are another part of the calculator (I'm not having trouble with). Furthermore, a negation can include white-space ; for instance <code>1+2* -  3</code> is a valid string input to this calculator. </p>\n"}, {"tags": ["haskell", "monads", "servant"], "answers": [{"tags": [], "owner": {"reputation": 1372, "user_id": 1363247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16cb83c68adc584b883fe0a794c461a6?s=128&d=identicon&r=PG", "display_name": "Chance Snow", "link": "https://stackoverflow.com/users/1363247/chance-snow"}, "is_accepted": true, "score": 1, "last_activity_date": 1479881259, "last_edit_date": 1495535383, "creation_date": 1479881259, "answer_id": 40757211, "question_id": 40756327, "link": "https://stackoverflow.com/questions/40756327/how-to-resolve-type-mismatch-between-sqlbackend-and-persistentitybackend/40757211#40757211", "title": "How to resolve type mismatch between SqlBackend and PersistEntityBackend?", "body": "<p>I was able to figure it out with the help of <a href=\"https://stackoverflow.com/questions/39055829/use-of-get-and-tosqlkey-in-persistent\">this answer</a>.</p>\n\n<p>Like <code>get</code> and others, <code>insertUnique</code> in this context returns a plain <code>User</code> not an <code>Entity User</code>.</p>\n\n<pre><code>createUser :: User -&gt; App Int64\ncreateUser p = do\n    user &lt;- (User (userUsername $ entityVal p) (userSpotifyUser $ entityVal p))\n    let insertUser = insertUnique user :: SqlPersistT IO (Maybe (Key User))\n    maybeNewUserKey &lt;- runDb insertUser\n    case maybeNewUserKey of\n        Nothing -&gt; throwError err400\n        Just newUserKey -&gt;\n            return $ fromSqlKey newUserKey\n</code></pre>\n\n<p>Makes much more sense in hindsight since <code>runDb</code> accepts a <code>SqlPersistT</code> transformed monad.</p>\n"}], "owner": {"reputation": 1372, "user_id": 1363247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16cb83c68adc584b883fe0a794c461a6?s=128&d=identicon&r=PG", "display_name": "Chance Snow", "link": "https://stackoverflow.com/users/1363247/chance-snow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 40757211, "answer_count": 1, "score": 1, "last_activity_date": 1479881259, "creation_date": 1479876894, "last_edit_date": 1479877630, "question_id": 40756327, "link": "https://stackoverflow.com/questions/40756327/how-to-resolve-type-mismatch-between-sqlbackend-and-persistentitybackend", "title": "How to resolve type mismatch between SqlBackend and PersistEntityBackend?", "body": "<p>Using both the <code>servant</code> and <code>persistent</code> libraries to create a REST API and I'm running into a type mismatch error using <code>insertUnique</code> to create a new Entity.</p>\n\n<p>Here's the offending function:</p>\n\n<pre><code>createUser :: Entity User -&gt; App Int64\ncreateUser p = do\n    maybeNewUser &lt;- runDb (insertUnique (User (userUsername $ entityVal p) (userSpotifyUser $ entityVal p)))\n    case maybeNewUser of\n        Nothing -&gt; throwError err400\n        Just newUser -&gt; return $ fromSqlKey newUser\n</code></pre>\n\n<p>With the following error:</p>\n\n<pre><code>Couldn't match expected type \u2018persistent-2.2.4.1:Database.Persist.Sql.Types.SqlBackend\u2019\n        with actual type \u2018persistent-2.2.4.1:Database.Persist.Class.PersistEntity.PersistEntityBackend\n                            (String\n                             -&gt; String\n                             -&gt; time-1.5.0.1:Data.Time.Clock.UTC.UTCTime\n                             -&gt; time-1.5.0.1:Data.Time.Clock.UTC.UTCTime\n                             -&gt; User)\u2019\nIn the first argument of \u2018runDb\u2019, namely\n[snip]\n</code></pre>\n\n<p>And for reference, the <code>runDb</code> function:</p>\n\n<pre><code>runDb :: (MonadReader Config m, MonadIO m) =&gt; SqlPersistT IO b -&gt; m b\nrunDb query = do\n    pool &lt;- asks getPool\n    liftIO $ runSqlPool query pool\n</code></pre>\n\n<p>And the <code>App</code> newtype:</p>\n\n<pre><code>newtype App a = App\n    { runApp :: ReaderT Config (ExceptT ServantErr IO) a } deriving\n        (Functor, Applicative, Monad, MonadReader Config, MonadError ServantErr, MonadIO)\n</code></pre>\n\n<p>I've tried type hinting the result of <code>insertUnique</code> as <code>SqlBackend</code>, but that causes an equally confusing error. Are the <code>SqlBackend</code> and <code>PersistentEntityBackend</code> types not interchangeable?</p>\n\n<p>Or perhaps the monad is malformed?</p>\n\n<p>Any assistance is greatly appreciated.</p>\n"}, {"tags": ["haskell", "lambda", "xor"], "comments": [{"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 5, "creation_date": 1479874210, "post_id": 40755853, "comment_id": 68737322, "body": "I believe <code>bnot</code> ought to be <code>\\b -&gt; b false true</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1479876896, "post_id": 40755853, "comment_id": 68738091, "body": "What error do you get? I don&#39;t get one."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1479887199, "post_id": 40755853, "comment_id": 68742205, "body": "I guess the issue is that <code>bnot</code> has a complicated type <code>((t -&gt; t1 -&gt; t1) -&gt; (t3 -&gt; t4 -&gt; t3) -&gt; t2) -&gt; t2</code> which makes the type of <code>bxor</code> even worse. This question should clarify what is the actual issue here. Compare it with <code>bnot = \\b x y -&gt; b y x</code> for instance."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1479896357, "post_id": 40755853, "comment_id": 68747816, "body": "<a href=\"http://ideone.com/KfaInH\" rel=\"nofollow noreferrer\">ideone.com/KfaInH</a>"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1479894185, "last_edit_date": 1479894185, "creation_date": 1479893635, "answer_id": 40760592, "question_id": 40755853, "link": "https://stackoverflow.com/questions/40755853/xor-of-church-encoded-booleans-in-haskell/40760592#40760592", "title": "xor of Church-encoded booleans in Haskell", "body": "<p>In a typed environment, one needs to be careful. Your lambda-terms work fine in an untyped setting, but need some tweaks in a typed one.</p>\n\n<p>We need to define a type for Church booleans. Let's choose the following parametric monomorphic type.</p>\n\n<pre><code>type B a = a -&gt; a -&gt; a\n</code></pre>\n\n<p>Then, let's add type annotations to check what's wrong:</p>\n\n<pre><code>true :: B a\ntrue  = \\t f -&gt; t\n\nfalse :: B a\nfalse = \\t f -&gt; f\n\ntoBool :: B Bool -&gt; Bool\ntoBool = \\b -&gt; b True False\n</code></pre>\n\n<p>So far, so good. However:</p>\n\n<pre><code>bnot :: B a -&gt; B a\nbnot = \\b -&gt; b false true\n</code></pre>\n\n<p>yields a type error, since e.g. <code>false</code> has type <code>B a</code>, not <code>a</code>, so the application <code>b false</code> is ill-typed. We can work around this by adding a couple of <code>a</code> arguments <code>x y</code>, and simplifying the function accordingly.</p>\n\n<pre><code>bnot = \\b x y -&gt; b (false x y) (true x y)\n-- or, more simply:\nbnot = \\b x y -&gt; b y x\n-- or even\nbnot = flip\n</code></pre>\n\n<p>This type checks. Similarly, we can rework <code>bxor</code> to make it type check:</p>\n\n<pre><code>bxor :: B a -&gt; B a -&gt; B a       \nbxor = \\b1 b2 x y -&gt; b1 (bnot b2 x y) (b2 x y)\n</code></pre>\n\n<hr>\n\n<p>Alternatively, using the <em>impredicative</em> Church encoding of booleans, we can make your original code to type check as it is, except for adding the relevant type signatures. This requires higher-rank types.</p>\n\n<pre><code>{-# LANGUAGE Rank2Types #-}\n\ntype BI = forall a. a -&gt; a -&gt; a\n\ntrueI :: BI\ntrueI = true\n\nfalseI :: BI\nfalseI = false\n\ntoBoolI :: BI -&gt; Bool\ntoBoolI = \\b -&gt; b True False\n\nbnotI :: BI -&gt; BI\nbnotI = \\b -&gt; b falseI trueI\n\nbxorI :: BI -&gt; BI -&gt; BI\nbxorI = \\b x -&gt; b (bnotI x) x\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7196166, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462912180390179/picture?type=large", "display_name": "Sean Paterson", "link": "https://stackoverflow.com/users/7196166/sean-paterson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 557, "favorite_count": 0, "accepted_answer_id": 40760592, "answer_count": 1, "score": 1, "last_activity_date": 1479894185, "creation_date": 1479873951, "last_edit_date": 1479874107, "question_id": 40755853, "link": "https://stackoverflow.com/questions/40755853/xor-of-church-encoded-booleans-in-haskell", "title": "xor of Church-encoded booleans in Haskell", "body": "<p>I'm currently trying to implement a lambda expression for xor. However, I feel like I'm missing something because I am getting errors from by bxor expression. What am I doing wrong?</p>\n\n<pre><code>true  = \\t f -&gt; t    -- always pick the first argument\nfalse = \\t f -&gt; f    -- always pick the second argument\n\ntoBool = \\b -&gt; b True False\n\nbnot = \\b -&gt; b true false\n\nbxor = \\b x -&gt; b (bnot x) x\n</code></pre>\n"}, {"tags": ["haskell", "time"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 4, "creation_date": 1479873919, "post_id": 40754881, "comment_id": 68737247, "body": "Do you have a good reason to be manipulating time as a <code>Double</code>? Why not leave it in a nice format? <a href=\"https://hackage.haskell.org/package/time-1.7\" rel=\"nofollow noreferrer\"><code>time</code></a> can parse a <code>TimeOfDay</code> from your format: <code>parseTimeM False defaultTimeLocale &quot;%Mm%Ss&quot; &quot;34m30s&quot;</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1479905327, "post_id": 40754881, "comment_id": 68754117, "body": "If you need to convert it to a single numerical value, convert to an integer number of seconds, not a <code>Double</code> of minutes."}], "answers": [{"tags": [], "owner": {"reputation": 4614, "user_id": 1378868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84a42920594ee2a0cc33012c407fd9d5?s=128&d=identicon&r=PG", "display_name": "snak", "link": "https://stackoverflow.com/users/1378868/snak"}, "is_accepted": false, "score": 2, "last_activity_date": 1479874118, "creation_date": 1479874118, "answer_id": 40755880, "question_id": 40754881, "link": "https://stackoverflow.com/questions/40754881/converting-strings-of-form-nummnums-to-maybe-double-representing-total-m/40755880#40755880", "title": "Converting strings of form `&lt;num&gt;m&lt;num&gt;s` to `Maybe Double` Representing Total Minutes", "body": "<p>You can use <a href=\"http://hackage.haskell.org/package/time-1.7/docs/Data-Time-Format.html#v:parseTimeM\" rel=\"nofollow noreferrer\"><code>Data.Time.Format.parseTimeM</code></a> to convert <code>String</code> to <a href=\"http://hackage.haskell.org/package/time-1.7/docs/Data-Time-LocalTime.html#t:TimeOfDay\" rel=\"nofollow noreferrer\"><code>TimeOfDay</code></a>, then convert it to <a href=\"http://hackage.haskell.org/package/time-1.7/docs/Data-Time-Clock.html#t:DiffTime\" rel=\"nofollow noreferrer\"><code>DiffTime</code></a> and <code>Double</code>.</p>\n\n<pre><code>import Data.Time\n\nparseMS :: String -&gt; Maybe Double\nparseMS = fmap (realToFrac . (/ 60) . timeOfDayToTime) . parseTimeM False defaultTimeLocale \"%Mm%Ss\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1479961672, "post_id": 40778016, "comment_id": 68779634, "body": "I guess I should have pointed out that you can add &quot;guards&quot; / conditions to the monad or comprehension to refuset, say, negative values or seconds  values &gt;= 60.  For monads, you&#39;d add:"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1479961870, "post_id": 40778016, "comment_id": 68779695, "body": "Ugh..  hit Enter too early.  For the monad, you&#39;d add <code>guard $ mins &gt;=0</code> and <code>guard $ secs &gt;=0 &amp;&amp; secs &lt;= 59</code> in the appropriate places.  In the list comprehension, you just write <code>mins &gt;= 0</code> and <code>secs &gt;= 0 &amp;&amp; secs &lt;= 59</code> clauses, without writing &quot;guard&quot;."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 2, "last_activity_date": 1479961396, "creation_date": 1479961396, "answer_id": 40778016, "question_id": 40754881, "link": "https://stackoverflow.com/questions/40754881/converting-strings-of-form-nummnums-to-maybe-double-representing-total-m/40778016#40778016", "title": "Converting strings of form `&lt;num&gt;m&lt;num&gt;s` to `Maybe Double` Representing Total Minutes", "body": "<p>The answers based on <code>parseTimeM</code> seem to work only if the minutes and seconds are exactly two digits, so <code>parseMS \"1m30s\"</code> and <code>parseMS \"12m0s\"</code> both yield <code>Nothing</code>.</p>\n\n<p>You really need a simple parser here.  Here's one that uses <code>reads</code> calls in a List monad.  Note that it will require both a minutes and seconds part with \"m\" and \"s\" suffixes, so \"10m\" and \"10m30\" and \"15s\" will all yield <code>Nothing</code>.  Also, it will accept negative numbers and leading spaces, so <code>\"  10m -30s\"</code> returns <code>Just 9.5</code>.</p>\n\n<pre><code>import Data.Maybe (listToMaybe)\n\nreadMS :: String -&gt; Maybe Double\nreadMS str = listToMaybe $ do\n  (mins, 'm':rest1) &lt;- reads str\n  (secs, \"s\")       &lt;- reads rest1\n  return (fromIntegral (mins :: Int) + fromIntegral (secs :: Int) / 60)\n</code></pre>\n\n<p>Some people find this easier to understand when it's written using the equivalent list comprehension, like so:</p>\n\n<pre><code>readMS1 :: String -&gt; Maybe Double\nreadMS1 str = listToMaybe\n  [ fromIntegral (mins :: Int) + fromIntegral (secs :: Int) / 60\n  | (mins, 'm':rest1) &lt;- reads str\n  , (secs, \"s\")       &lt;- reads rest1\n  ]\n</code></pre>\n\n<p>A note of explanation, if you haven't seen this style before:  We're using the List monad, and each <code>reads</code> call returns a list of possible parses as <code>(value,rest_of_string)</code> pairs.  The first line of the do-block gets each possible parse of an integer <code>mins</code> followed by the letter \"m\" plus the <code>rest1</code> of the string.  The second line gets each possible parse of <code>rest1</code> as an integer <code>secs</code> followed by the letter \"s\" and nothing else.</p>\n\n<p>If a match fails (e.g., no \"s\" at end of string), the monad/comprehension returns the empty list.  Otherwise, it returns a list of calculated Doubles from all possible parses (in this case, there will be at most one).  The <code>listToMaybe</code> function turns the empty list into <code>Nothing</code> and grabs the head of any other list to get a unique answer.</p>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 40778016, "answer_count": 2, "score": 1, "last_activity_date": 1479961396, "creation_date": 1479866853, "question_id": 40754881, "link": "https://stackoverflow.com/questions/40754881/converting-strings-of-form-nummnums-to-maybe-double-representing-total-m", "title": "Converting strings of form `&lt;num&gt;m&lt;num&gt;s` to `Maybe Double` Representing Total Minutes", "body": "<p>In Haskell, is there some standard function to convert a string which might contain a minutes and seconds (i.e., something like this <code>34m30s</code>) to its appropriate <code>Maybe Double</code> of minutes? So in this case, we would convert <code>34m30s</code> to <code>Just 34.5</code>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1479853569, "post_id": 40752538, "comment_id": 68731658, "body": "Don&#39;t export the <code>newtype</code>s&#39; constructors."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1479856691, "last_edit_date": 1479856691, "creation_date": 1479856334, "answer_id": 40753341, "question_id": 40752538, "link": "https://stackoverflow.com/questions/40752538/preventing-operation-on-a-value-of-custom-data-type/40753341#40753341", "title": "Preventing operation on a value of custom data type", "body": "<p>By unwrapping the newtypes using the constructors <code>Person</code> and <code>Height</code>, you essentially instruct the compiler to forget the type distinction. That of course makes it legal to write <code>age + height</code>, but that's not to blame on the <code>newtype</code>s, like it's not to blame on the train driver if you smash the window, jump out and get injured!<sup>\u2020</sup></p>\n\n<p>The way to prevent such incorrect operation is to not unwrap the newtypes. The following <em>will</em> cause an error, if <code>Age</code> and <code>Height</code> are newtypes:</p>\n\n<pre><code>stupid (Person age height) = age + height\n</code></pre>\n\n<p>...not just because <code>age</code> and <code>height</code> are different types, also because neither actually supports an addition operation (they aren't <code>Num</code> instances). Now that's fine, as long as you don't really need to perform <em>any</em> operations on these values.</p>\n\n<p>Chances are however that at some point you <em>will</em> need to perform some operation on those values. This should <em>not</em> require the user to unwrap the actual <code>newtype</code> constructors.</p>\n\n<p>For such physical quantities like age and height, there are a few options to do it type-safely:</p>\n\n<ul>\n<li><p>Add <a href=\"http://hackage.haskell.org/package/vector-space-0.10.4/docs/Data-VectorSpace.html\" rel=\"nofollow noreferrer\"><code>VectorSpace</code></a> instances. That will allow you to add one height to another, and scale heights by fractions, but not add a height to something entirely different.</p>\n\n<pre><code>import Data.AdditiveGroup\nimport Data.VectorSpace\n\ninstance Additive Height where\n  Height h\u2080 ^+^ Height h\u2081 = Height $ h\u2080+h\u2081\n  zeroV = Height 0\ninstance VectorSpace Height where\n  type Scalar Height = Double\n  \u03bc *^ Height h = Height . round $ \u03bc * fromIntegral h\n</code></pre>\n\n<p>This simple instance is mighty handy for some science use cases, though probably not that useful for your application.</p></li>\n<li><p>Add meaningful unit-specific accessors. In modern Haskell, those would be <a href=\"http://hackage.haskell.org/package/lens\" rel=\"nofollow noreferrer\">lenses</a>:</p>\n\n<pre><code>import Control.Lens\n\nheightInCentimetres :: Lens' Height Int\nheightInCentimetres = lens (\\(Height h)-&gt;h) (\\(Height _) h-&gt;Height h)\nageInYears :: Lens' Age Int\nageInYears = lens (\\(Age a)-&gt;a) (\\(Age _) a-&gt;Age a)\n</code></pre>\n\n<p>This way, if someone needs to work with an actual number of years of someone's age or modify it, they can do so, but they need to be explicit that these are years they're talking about. Of course, accessing the years and height as an integer number again makes it possible to circumvent the type distinction and intermingle ages with height, but this can hardly happen by accident.</p></li>\n<li><p>Go all the way to a <a href=\"http://hackage.haskell.org/package/units-defs\" rel=\"nofollow noreferrer\">library for physical quantities</a>.</p>\n\n<pre><code>import Data.Metrology.SI\n\ntype Height = Length\ntype Age = Time\n</code></pre>\n\n<p>This allows you to perform <a href=\"http://hackage.haskell.org/package/units-2.4/docs/Data-Metrology-Poly.html\" rel=\"nofollow noreferrer\">all kinds of physically legit operations</a> while preventing nonsensical ones.</p></li>\n</ul>\n\n<hr>\n\n<p><sup>\u2020</sup><sub>Jumping out of a train is actually more dangerous. Rather like <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Unsafe-Coerce.html#v:unsafeCoerce\" rel=\"nofollow noreferrer\"><code>unsafeCoerce</code></a>, which really instructs the compiler to throw all type-safety out of the window and can easily cause crashes or <a href=\"http://www.catb.org/jargon/html/N/nasal-demons.html\" rel=\"nofollow noreferrer\">demons flying out of your nose</a>.</sub></p>\n"}, {"tags": [], "owner": {"reputation": 689, "user_id": 6217179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633461a7b7bd893feebbc9285d0fb049?s=128&d=identicon&r=PG&f=1", "display_name": "sapanoia", "link": "https://stackoverflow.com/users/6217179/sapanoia"}, "is_accepted": false, "score": 0, "last_activity_date": 1479931216, "creation_date": 1479931216, "answer_id": 40773184, "question_id": 40752538, "link": "https://stackoverflow.com/questions/40752538/preventing-operation-on-a-value-of-custom-data-type/40773184#40773184", "title": "Preventing operation on a value of custom data type", "body": "<p>This is actually a common pattern. Put the data type you want to protect into a module of its own:</p>\n\n<pre><code>module Quantities (\n    Age, Height,   -- NOTE: constructors not exported\n    prettyHeight   -- ...\n) where\n\nnewtype Age = Age Int\nnewtype Height = Height Int\n\n-- any operations that need to see the int, e.g.:\nprettyHeight :: Height -&gt; String\nprettyHeight (Height h) = show h ++ \"cm\"\n</code></pre>\n\n<p>If you do not add an explicit export list to the module, everything will be exported, including the constructors <code>Age</code> and <code>Height</code>. In the above code, they are <em>not</em> exported, thus you can only access the <code>Int</code> values from within this module. All operations which actually have to work with the wrapped <code>Int</code> have to be in this module.</p>\n\n<p>Now, import this module wherever you need it:</p>\n\n<pre><code>module Person where\n\nimport Quantities\n\ndata Person = Person Age Height\n\ntest (Height h) = ()  -- This will not compile, Height not in scope.\n</code></pre>\n\n<p>Any other module except <code>Quantities</code> can no longer deconstruct <code>Height</code> or <code>Age</code>.</p>\n"}], "owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1479931216, "creation_date": 1479852515, "question_id": 40752538, "link": "https://stackoverflow.com/questions/40752538/preventing-operation-on-a-value-of-custom-data-type", "title": "Preventing operation on a value of custom data type", "body": "<p>Let's say I create a <code>Person</code> type:</p>\n\n<pre><code>type Age = Int\ntype Height = Int\ndata Person = Person Age Height\n</code></pre>\n\n<p>This is all well, but I'd like to make sure that <code>Age</code> and <code>Height</code> cannot be added, because that makes no sense. I'd like a compile error when trying to do so.</p>\n\n<p>In it's current form, this does not cause a compile error:</p>\n\n<pre><code>stupid (Person age height) = age + height\n</code></pre>\n\n<p>So I think about using <code>newtype</code> or even <code>data</code> for <code>Age</code> and <code>Height</code>:</p>\n\n<pre><code>newtype Age = Age Int\nnewtype Height = Height Int\ndata Person = Person Age Height\n</code></pre>\n\n<p>but still:</p>\n\n<pre><code>stupid (Person (Age age) (Height height)) = age + height\n</code></pre>\n\n<p>Is there a way of preventing age and height from being added? Or is what I'm asking for unreasonable?</p>\n"}, {"tags": ["haskell", "monads", "aeson"], "comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 2, "creation_date": 1479854606, "post_id": 40752365, "comment_id": 68732098, "body": "It looks like you\u2019re trying to bind the result of <code>fromJust &lt;$&gt; response .: &quot;name&quot;</code> in <code>IO</code>, but it\u2019s just a <code>Parser</code> value. I\u2019m not very familiar with Aeson, but I think you need to run the parser (purely) with <code>Data.Aeson.Types.parse</code> or <code>parseMaybe</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1698, "user_id": 4050510, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f3123195051caa2f71674df0798284b0?s=128&d=identicon&r=PG", "display_name": "LudvigH", "link": "https://stackoverflow.com/users/4050510/ludvigh"}, "edited": false, "score": 0, "creation_date": 1499783447, "post_id": 40754814, "comment_id": 77048813, "body": "Now I&#39;m a little confused. wouldn&#39;t it be <code>(.: &quot;name&quot;) :: Value -&gt; Parser String</code> ? The type of <code>Object</code> is <code>Value</code>? Sorry for being confused about the Aeson library..."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 1698, "user_id": 4050510, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f3123195051caa2f71674df0798284b0?s=128&d=identicon&r=PG", "display_name": "LudvigH", "link": "https://stackoverflow.com/users/4050510/ludvigh"}, "edited": false, "score": 0, "creation_date": 1499830646, "post_id": 40754814, "comment_id": 77069791, "body": "Yes, that is correct. The whole expression <code>fromJust $ parseMaybe (.: &quot;name&quot;) response</code> is what we annotate as having type <code>String</code>: <code>(.: &quot;name&quot;) :: Value -&gt; Parser String</code>, and <code>response :: Value</code>, so we can apply <code>parseMaybe :: (a -&gt; Parser b) -&gt; a -&gt; Maybe b</code> with <code>a ~ Value</code> and <code>b ~ String</code>."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 1698, "user_id": 4050510, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f3123195051caa2f71674df0798284b0?s=128&d=identicon&r=PG", "display_name": "LudvigH", "link": "https://stackoverflow.com/users/4050510/ludvigh"}, "edited": false, "score": 1, "creation_date": 1499830698, "post_id": 40754814, "comment_id": 77069810, "body": "Of course, if we just used <code>name</code> for anything at all (like changing the last line from <code>print &quot;hi&quot;</code> to <code>putStrLn $ unwords [&quot;Hi,&quot;, name]</code>) that prescribes its type, then we don&#39;t need the type annotation in the <code>let name = ...</code> line."}, {"owner": {"reputation": 1698, "user_id": 4050510, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f3123195051caa2f71674df0798284b0?s=128&d=identicon&r=PG", "display_name": "LudvigH", "link": "https://stackoverflow.com/users/4050510/ludvigh"}, "edited": false, "score": 0, "creation_date": 1499836871, "post_id": 40754814, "comment_id": 77071688, "body": "I see. I&#39;m new to polymorphism, so the explanation helps. :) thanks a lot!"}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 5, "last_activity_date": 1479866945, "last_edit_date": 1479866945, "creation_date": 1479866458, "answer_id": 40754814, "question_id": 40752365, "link": "https://stackoverflow.com/questions/40752365/haskell-aeson-how-to-get-value-out-of-parser-in-io-monad/40754814#40754814", "title": "Haskell Aeson: How to get value out of Parser in IO monad", "body": "<p>Aeson has a bunch of functions to go from <code>Parser a</code> to <code>a</code>:</p>\n\n<pre><code>parse       :: (a -&gt; Parser b) -&gt; a -&gt; Result b\nparseEither :: (a -&gt; Parser b) -&gt; a -&gt; Either String b\nparseMaybe  :: (a -&gt; Parser b) -&gt; a -&gt; Maybe b\n</code></pre>\n\n<p>so if you have e.g.</p>\n\n<pre><code>(.: \"name\") :: Object -&gt; Parser String\n</code></pre>\n\n<p>then you have</p>\n\n<pre><code>parseMaybe (.: \"name\") :: Object -&gt; Maybe String\n</code></pre>\n\n<p>so you can do</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport Network.HTTP.Simple\nimport Data.Aeson\nimport Data.Maybe (fromJust)\nimport Data.Aeson.Types -- new import for parseMaybe\n\nmain :: IO ()\nmain = do\n    response &lt;- getResponseBody &lt;$&gt; httpJSON \"http://localhost:9200\"\n    let name = fromJust $ parseMaybe (.: \"name\") response :: String\n    print \"hi\"\n</code></pre>\n"}], "owner": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 550, "favorite_count": 0, "accepted_answer_id": 40754814, "answer_count": 1, "score": 4, "last_activity_date": 1479866945, "creation_date": 1479851771, "last_edit_date": 1479866910, "question_id": 40752365, "link": "https://stackoverflow.com/questions/40752365/haskell-aeson-how-to-get-value-out-of-parser-in-io-monad", "title": "Haskell Aeson: How to get value out of Parser in IO monad", "body": "<p>I'm trying to do JSON parsing in IO:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport Network.HTTP.Simple\nimport Data.Aeson\nimport Data.Maybe (fromJust)\n\nmain :: IO ()\nmain = do\n  response &lt;- getResponseBody &lt;$&gt; httpJSON \"http://localhost:9200\" :: IO Object\n  name &lt;- fromJust &lt;$&gt; response .: \"name\" :: Parser String\n  print \"hi\"\n</code></pre>\n\n<p>I get the error:</p>\n\n<pre><code>/home/nut/dev/haskell/elastic/app/Main.hs:39:11: error:\n    \u2022 Couldn't match type \u2018Parser\u2019 with \u2018IO\u2019\n      Expected type: IO String\n        Actual type: Parser String\n    \u2022 In a stmt of a 'do' block:\n</code></pre>\n\n<p>So how do I get that <code>name</code> out of the json result?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": true, "score": 13, "last_activity_date": 1479852791, "last_edit_date": 1479852791, "creation_date": 1479849851, "answer_id": 40751906, "question_id": 40751749, "link": "https://stackoverflow.com/questions/40751749/how-does-fromintegral-work/40751906#40751906", "title": "How does fromIntegral work?", "body": "<p>Because <code>fromInteger</code> is part of the <code>Num</code> class, every instance will have its own implementation. <em>Neither</em> of the two implementations (for <code>Int</code> and <code>Integer</code>) knows how to make a <code>Float</code>, but they aren't called when you're using <code>fromInteger</code> (or <code>fromIntegral</code>) to make a <code>Float</code>; that's what the <code>Float</code> instance of <code>Num</code> is for.</p>\n\n<p>And so on for all other types. There is no one place that knows how to turn integers into any <code>Num</code> type; that would be impossible, since it would have to support user-defined <code>Num</code> instances that don't exist yet. Instead when each individual type is declared to be an instance of <code>Num</code> a way of doing that <em>for that particular type</em> must be provided (by implementing <code>fromInteger</code>).</p>\n\n<blockquote>\n  <p><code>fromInteger</code> will be embedded in an expression which requires that it produce a certain type. It can't know what the required type will be? So what happens?</p>\n</blockquote>\n\n<p>Actually, knowing what type it's expected to return from the expression the call is embedded in is <em>exactly</em> how it works.</p>\n\n<p>Type checking/inference in Haskell works in two \"directions\" at once. It goes top-down, figuring out what types each expression <em>should</em> have, in order to fit into the bigger expression it's being used in. And it also goes \"bottom-up\", figuring out what type each expression should have from the smaller sub-expressions it's built out of. When it finds a place where those don't match, you get a type error (that's exactly where the \"expected type\" and \"actual type\" you see in type error messages cone from).</p>\n\n<p>But because the compiler has that top-down knowledge (the \"expected type\") for every expression, it's perfectly able to figure out that a call of <code>fromInteger</code> is being used where a <code>Float</code> is expected, and so use the <code>Float</code> instance for <code>Num</code> in that call.</p>\n"}, {"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 4, "last_activity_date": 1479850452, "creation_date": 1479850452, "answer_id": 40752047, "question_id": 40751749, "link": "https://stackoverflow.com/questions/40751749/how-does-fromintegral-work/40752047#40752047", "title": "How does fromIntegral work?", "body": "<p>One aspect that distinguishes type classes from OOP interfaces is that type classes can dispatch on the <em>result</em> type of a method, not only on the type of its parameters. The classic example is the <code>read :: Read a =&gt; String -&gt; a</code> function.</p>\n\n<hr>\n\n<p><code>fromInteger</code> has type <code>fromInteger :: Num a =&gt; Integer -&gt; a</code>. The implementation is selected depending on the type of <code>a</code>. If the typechecker knows that <code>a</code> is a <code>Float</code>, the <code>Num</code> instance of <code>Float</code> will be used, not the one of <code>Int</code> or <code>Integer</code>.</p>\n"}], "owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2584, "favorite_count": 0, "accepted_answer_id": 40751906, "answer_count": 2, "score": 9, "last_activity_date": 1479852791, "creation_date": 1479849268, "question_id": 40751749, "link": "https://stackoverflow.com/questions/40751749/how-does-fromintegral-work", "title": "How does fromIntegral work?", "body": "<p>The type of <code>fromIntegral</code> is <code>(Num b, Integral a) =&gt; a -&gt; b</code>. I'd like to understand how that's possible, what the code is that can convert any Integral number to any number type as needed. </p>\n\n<p>The <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/src/GHC.Real.html#fromIntegral\" rel=\"noreferrer\">actual code</a> for <code>fromIntegral</code> is listed as </p>\n\n<pre><code>fromIntegral = fromInteger . toInteger\n</code></pre>\n\n<p>The <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/src/GHC.Num.html#fromInteger\" rel=\"noreferrer\">code</a> for <code>fromInteger</code> is under <code>instance Num Int</code> and <code>instance Num Integer</code> They are respectively: </p>\n\n<pre><code>instance  Num Int  where\n  ...\n  fromInteger i = I# (integerToInt i)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>instance  Num Integer  where\n  ...\n  fromInteger x  =  x\n</code></pre>\n\n<p>Assuming <code>I#</code> calls a C program that converts an <code>Integer</code> to an <code>Int</code> I don't see how either of these generate results that could be, say, added to a <code>Float</code>. How do they go from <code>Int</code> or <code>Integer</code> to something else?</p>\n\n<p><code>fromInteger</code> will be embedded in an expression which requires that it produce a certain type. It can't know what the required type will be? So what happens?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1479850334, "post_id": 40751714, "comment_id": 68730150, "body": "I think your implementation is a reasonable for a function named <code>singleton</code>. But since I don&#39;t know the assignment, that&#39;s all I can say."}, {"owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "reply_to_user": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1479850527, "post_id": 40751714, "comment_id": 68730243, "body": "@jpath, well is just like the signature says, receiving an element it returns an empty List of that element..."}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1479850683, "post_id": 40751714, "comment_id": 68730317, "body": "&quot;returning an empty list of that element&quot;. That doesn&#39;t make sense. Do you mean returning a singleton list with just the pair of that element and the empty list?"}, {"owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "reply_to_user": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1479850973, "post_id": 40751714, "comment_id": 68730453, "body": "@jpath, yes that."}, {"owner": {"reputation": 2116, "user_id": 63513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/172563332d62ea121cbb10ac55e0e6b3?s=128&d=identicon&r=PG", "display_name": "Mr. Putty", "link": "https://stackoverflow.com/users/63513/mr-putty"}, "edited": false, "score": 0, "creation_date": 1479853868, "post_id": 40751714, "comment_id": 68731790, "body": "I don&#39;t think the &quot;singleton&quot; tag is really appropriate here.  That tag is for the Gang of Four Singleton pattern, which implies that there is a single application-wide instance of something, and generally also that there is mutable state shared through that instance.  Here we&#39;re talking about a simple pure function that just returns a one element list, which is definitely not a GoF singleton."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2116, "user_id": 63513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/172563332d62ea121cbb10ac55e0e6b3?s=128&d=identicon&r=PG", "display_name": "Mr. Putty", "link": "https://stackoverflow.com/users/63513/mr-putty"}, "edited": false, "score": 0, "creation_date": 1479866262, "post_id": 40751714, "comment_id": 68735383, "body": "@Mr.Putty, I agree that the tag doesn&#39;t fit here. In the context of Haskell, I&#39;d expect the tag to relate to the <code>singletons</code> package, or more generally to  the technique of using a singleton GADT to bring type-level structures down to the term level."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 4, "last_activity_date": 1479856071, "last_edit_date": 1479856071, "creation_date": 1479850930, "answer_id": 40752174, "question_id": 40751714, "link": "https://stackoverflow.com/questions/40751714/how-to-create-singleton-function-in-haskell/40752174#40752174", "title": "How to create singleton function in Haskell", "body": "<p>Since <code>x</code> is an unrestricted type variable, <code>singleton</code> cannot generate a valid value of type <code>x</code> by itself. It can only do one of two things:</p>\n\n<ol>\n<li>Use the argument of type <code>x</code> that it receives.</li>\n<li>Use <code>undefined</code>.</li>\n</ol>\n\n<p>Your definition is certainly the most <em>reasonable</em> definition for the function; however, with no other information to go on, the following\nare also <em>valid</em> definitions of <code>singleton :: x -&gt; List x</code>:</p>\n\n<ol>\n<li><code>singleton elem = LT [(undefined,[])]</code></li>\n<li><code>singleton elem = LT []</code></li>\n<li><code>singleton elem = LT [(elem,[]), (elem,[])]</code></li>\n<li><code>singleton elem = LT [(elem,[\"foo\"])]</code></li>\n<li><code>singleton elem = LT [(elem,[\"foo\", \"bar\"])]</code></li>\n</ol>\n\n<p>The first uses <code>undefined</code> as the value of type <code>x</code>. The second and third take advantage of the fact that the <em>length</em> of list to return is unspecified. The fourth and fifth take advantage of the fact that neither the length nor the contents of the value with concrete type <code>[String]</code> is specified.</p>\n"}], "owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 0, "accepted_answer_id": 40752174, "answer_count": 1, "score": 0, "last_activity_date": 1479916328, "creation_date": 1479849152, "last_edit_date": 1479916328, "question_id": 40751714, "link": "https://stackoverflow.com/questions/40751714/how-to-create-singleton-function-in-haskell", "title": "How to create singleton function in Haskell", "body": "<p>So I need to create a module in Haskell where we should use this data type</p>\n\n<p><code>data List x = LT [(x,[String])]</code> </p>\n\n<p>and implement this function <code>singleton :: x -&gt; List x</code>.</p>\n\n<p>I've been searching to find if my solution <code>singleton elem = LT [(elem,[])]</code> is correct, but couldn't find any.</p>\n\n<p>Is there anywhere I can find examples that are simple and well explained?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 756, "user_id": 3710751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c92104b92f86f29098c11fa44b6cdd?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Pickering", "link": "https://stackoverflow.com/users/3710751/matthew-pickering"}, "edited": false, "score": 2, "creation_date": 1479865112, "post_id": 40750759, "comment_id": 68735096, "body": "The problem is that <code>bound-1.0.7</code> requires an older version of binary than is in the snapshot you are trying to use. I guess either use an earlier snapshot or specify <code>binary-0.7.6.1</code> and so on in your extra-deps as well."}, {"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 1, "creation_date": 1479922123, "post_id": 40750759, "comment_id": 68765368, "body": "To use the current development version of bound which appears to be largely compatible with GHC-8.0, you can add edit the <code>packages</code> field of your <code>stack.yaml</code> similarly to <a href=\"https://gist.github.com/sjakobi/9e54af86655c58acd0e5e3772320e321\" rel=\"nofollow noreferrer\">this Gist</a>."}], "owner": {"reputation": 1795, "user_id": 1839343, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b26d97dd045ce61904e7c6d1a9775e0c?s=128&d=identicon&r=PG", "display_name": "jules", "link": "https://stackoverflow.com/users/1839343/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 388, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1479845485, "creation_date": 1479845485, "question_id": 40750759, "link": "https://stackoverflow.com/questions/40750759/haskell-stack-exception-missing-dependencies", "title": "haskell stack exception missing dependencies", "body": "<p>I want to add the <code>bound</code> library to my package dependencies;\nThe project is completely fresh initialized with <code>stack new</code>.\nThe entry in the <code>cabal</code> file looks like this:</p>\n\n<pre><code>executable DependendLambda-exe\n  hs-source-dirs:      app\n  main-is:             Main.hs\n  ghc-options:         -threaded -rtsopts -with-rtsopts=-N\n  build-depends:       base\n                     , DependendLambda\n                     , bound\n  default-language:    Haskell2010\n</code></pre>\n\n<p>I get the following error message:</p>\n\n<pre><code>While constructing the build plan, the following exceptions were encountered:\n\nIn the dependencies for DependendLambda-0.1.0.0:\nbound must match -any, but the stack configuration has no specified\nversion (latest applicable is 1.0.7)\n\nRecommended action: \ntry adding the following to your extra-deps in /home/MyProject/stack.yaml:\n- bound-1.0.7\n\nYou may also want to try the 'stack solver' command\nPlan construction failed.\nWarning: build failed, but optimistically launching GHCi anyway\nThe following GHC options are incompatible with GHCi and have not been passed to it: -threaded\nUsing main module: 1. Package `DependendLambda' component exe:DependendLambda-exe with main-is file: /home/MyProject/app/Main.hs\nConfiguring GHCi with the following packages: DependendLambda\nGHCi, version 8.0.1: http://www.haskell.org/ghc/  :? for help\n&lt;command line&gt;: cannot satisfy -package bound\n    (use -v for more information)\n</code></pre>\n\n<p>When I add the dependency to <code>extra-deps</code> it is still failing:</p>\n\n<pre><code>While constructing the build plan, the following exceptions were encountered:\n\nIn the dependencies for bound-1.0.7:\n    binary-0.8.3.0 must match &gt;=0.5 &amp;&amp; &lt;0.8 (latest applicable is 0.7.6.1)\n    comonad-5 must match &gt;=3 &amp;&amp; &lt;5 (latest applicable is 4.3)\n    transformers-0.5.2.0 must match &gt;=0.2 &amp;&amp; &lt;0.5 (latest applicable is 0.4.3.0)\nneeded due to DependendLambda-0.1.0.0 -&gt; bound-1.0.7\n\nPlan construction failed.\nWarning: build failed, but optimistically launching GHCi anyway\nThe following GHC options are incompatible with GHCi and have not been passed to it: -threaded\nUsing main module: 1. Package `DependendLambda' component  \nexe:DependendLambda-exe with main-is file: /home/MyProject/app/Main.hs\nConfiguring GHCi with the following packages: DependendLambda\nGHCi, version 8.0.1: http://www.haskell.org/ghc/  :? for help\n&lt;command line&gt;: cannot satisfy -package bound-1.0.7\n    (use -v for more information)\n</code></pre>\n\n<p>The <code>stack solver</code> command didn't help either ... what am I missing?\nThanks for your help!</p>\n"}, {"tags": ["haskell", "ghc", "cabal"], "answers": [{"comments": [{"owner": {"reputation": 1029, "user_id": 1907302, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9aa3bf71191e28fc361547dc8457a083?s=128&d=identicon&r=PG", "display_name": "Carson", "link": "https://stackoverflow.com/users/1907302/carson"}, "edited": false, "score": 0, "creation_date": 1479849524, "post_id": 40748647, "comment_id": 68729750, "body": "Thanks, it was hard finding any resources on a &quot;Date&quot; type and now I know why."}], "tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": true, "score": 1, "last_activity_date": 1479837652, "creation_date": 1479837652, "answer_id": 40748647, "question_id": 40745983, "link": "https://stackoverflow.com/questions/40745983/cannot-find-date-type-when-building-swagger-generated-api/40748647#40748647", "title": "Cannot find &#39;Date&#39; type when building Swagger generated API", "body": "<p><code>Date</code> is not a standard type in Haskell. You can either define your own or you can use <code>Day</code> from the <a href=\"https://hackage.haskell.org/package/time-1.7\" rel=\"nofollow noreferrer\">time library</a>. Either way you will need to define the Aeson instances for it yourself. The time library has a <code>parseTimeM</code> function which can do the work for you, but you still need the instance declarations.</p>\n\n<p><strong>Correction</strong>: it turns out that Aeson already has instances for both <code>Day</code> and <code>UTCTime</code> types.</p>\n"}], "owner": {"reputation": 1029, "user_id": 1907302, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9aa3bf71191e28fc361547dc8457a083?s=128&d=identicon&r=PG", "display_name": "Carson", "link": "https://stackoverflow.com/users/1907302/carson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 40748647, "answer_count": 1, "score": 0, "last_activity_date": 1479924898, "creation_date": 1479829180, "last_edit_date": 1479924898, "question_id": 40745983, "link": "https://stackoverflow.com/questions/40745983/cannot-find-date-type-when-building-swagger-generated-api", "title": "Cannot find &#39;Date&#39; type when building Swagger generated API", "body": "<p>I am not sure if there is a built in Date type in Haskell or not, it is hard to tell and I can find no documentation. </p>\n\n<p>Here are my import statements</p>\n\n<pre><code>import           Data.Aeson         (FromJSON (..), ToJSON (..), Value, genericParseJSON, genericToJSON)\nimport           Data.Aeson.Types   (Options (..), defaultOptions)\nimport           Data.Function      ((&amp;))\nimport           Data.List          (stripPrefix)\nimport qualified Data.Map           as Map\nimport           Data.Maybe         (fromMaybe)\nimport           Data.Text          (Text)\nimport qualified Data.Text          as T\nimport           GHC.Generics       (Generic)\n</code></pre>\n\n<p>Here is the line in question</p>\n\n<pre><code>productionEntryProductionDate :: Date\n</code></pre>\n\n<p>And here is the error I get when trying to run <code>stack build</code></p>\n\n<p><code>Not in scope: type constructor or class `Date'</code></p>\n\n<p>The code I have was from a Web API I generated from some Swagger 2.0 YAML.</p>\n\n<p>I am fairly new to Haskell, so if you need more info please let me know.</p>\n"}, {"tags": ["haskell", "dictionary", "char", "show", "chr"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7194672, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154713050527552/picture?type=large", "display_name": "Jonathan Wahlgren", "link": "https://stackoverflow.com/users/7194672/jonathan-wahlgren"}, "edited": false, "score": 0, "creation_date": 1479831739, "post_id": 40743865, "comment_id": 68719411, "body": "Thank you so much! Yep.. Got confused  with map &amp; recursion tried to combine them from two previous functions. Reached for something not fully understanding the principles behind the two... Big thanks! Very well explained!"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1479823258, "creation_date": 1479823258, "answer_id": 40743865, "question_id": 40743427, "link": "https://stackoverflow.com/questions/40743427/haskell-problems-with-turning-chars-and-int-to-string/40743865#40743865", "title": "Haskell | Problems with turning Chars and Int to string.", "body": "<p>I will comment your code.</p>\n\n<pre><code>fromStringToList :: String -&gt; [Int]\nfromStringToList \"\" = []\nfromStringToList myString = map ord myString\n</code></pre>\n\n<p>The second line is redundant: when <code>myString</code> is empty, <code>map</code> returns <code>[]</code> anyway. You should remove it.</p>\n\n<pre><code>changeB3 :: [Int] -&gt; String\nchangeB3 [] = \"\"\nchangeB3 (x:xs)\n          | x `mod ` 3 == 0 = show map (x * 2 ) ++ changeB3 xs\n          |otherwise = map chr x ++ changeB3 xs\n</code></pre>\n\n<p>You seem to be confused here. You use a recursive function, but want to use <code>map</code>. You use either recursion or <code>map</code> here, not both.</p>\n\n<p>Assuming you want to use <code>map</code>, you should start by defining how to handle a single <code>Int</code>.</p>\n\n<pre><code>changeB3Single :: Int -&gt; String\nchangeB3Single x | x `mod` 3 == 0 = ...\n                 | otherwise      = ...\n</code></pre>\n\n<p>Then you <code>map</code> that over the whole list. A first attempt might be</p>\n\n<pre><code>changeB3 :: [Int] -&gt; String\nchangeB3 xs = map changeB3Single xs  -- type error!\n</code></pre>\n\n<p>but this won't work, since <code>map</code> here returns a list of strings, rather than a single string. We just need to concatenate them.</p>\n\n<pre><code>changeB3 xs = concat (map changeB3Single xs)\n</code></pre>\n\n<p>Indeed, <code>concat (map ...)</code> is so commonly found that it has its own function in the libraries:</p>\n\n<pre><code>changeB3 xs = concatMap changeB3Single xs\n</code></pre>\n\n<p>(One could make that pointfree, but there's no need to -- especially for a beginner.)</p>\n"}], "owner": {"reputation": 1, "user_id": 7194672, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154713050527552/picture?type=large", "display_name": "Jonathan Wahlgren", "link": "https://stackoverflow.com/users/7194672/jonathan-wahlgren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479823258, "creation_date": 1479822173, "question_id": 40743427, "link": "https://stackoverflow.com/questions/40743427/haskell-problems-with-turning-chars-and-int-to-string", "title": "Haskell | Problems with turning Chars and Int to string.", "body": "<p>New to Haskell:</p>\n\n<p>Hi can't seem to figure this out. </p>\n\n<p>What I am trying to do is take a string, turn it in to a [Int] (with map ord)</p>\n\n<p>Change some numbers that fulfils something (in this case x <code>mod</code> 3 == 0).</p>\n\n<p>afterwards I'd like to turn the unchanged numbers back to char, and changed numbers still numbers. Combine this into a string again..</p>\n\n<p>This is my problem: </p>\n\n<pre><code>*Main&gt; fromStringToList \"hihello\"\n[104,105,104,101,108,108,111]\n*Main&gt; changeB3 [104,105,104,101,108,108,111]\n\"'h'210'h''e'216216222\"\n</code></pre>\n\n<p>What I want is:</p>\n\n<pre><code>\"h210he216216222\"\n</code></pre>\n\n<p>I'm stuck figuring out how to use show and map to get this to work without the '_' from Char. Thanks.</p>\n\n<p>My Code:</p>\n\n<pre><code>import Data.Char\n\nfromStringToList :: String -&gt; [Int]\nfromStringToList \"\" = []\nfromStringToList myString = map ord myString\n\n{-\n    changeB3\n    PRE: True\n    POST: every Int that can be divided by 3 is multiplied by 2 and\nkept as int, otherwise transformed to char\n\n-}\nchangeB3 :: [Int] -&gt; String\nchangeB3 [] = \"\"\nchangeB3 (x:xs)\n          | x `mod ` 3 == 0 = show map (x * 2 ) ++ changeB3 xs\n          |otherwise = map chr x ++ changeB3 xs\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1479822171, "post_id": 40743263, "comment_id": 68712394, "body": "<code>(print $ map (flip (!!) 0))</code> is a compilation error."}, {"owner": {"reputation": 1, "user_id": 7194588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f700a806acf0cabe6807ec3dbdbc9f17?s=128&d=identicon&r=PG&f=1", "display_name": "MRJ", "link": "https://stackoverflow.com/users/7194588/mrj"}, "reply_to_user": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1479822925, "post_id": 40743263, "comment_id": 68712943, "body": "Ah, right.  What I mean to say is: <code>print $ map (flip (!!) 0) xs</code>, where <code>xs</code> is the array of type <code>[[Float]]</code>."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1479835381, "post_id": 40743263, "comment_id": 68721668, "body": "lists aren&#39;t arrays. Are you asking how to convert those lists into an hmatrix matrix? Did you read the hmatrix docs?"}, {"owner": {"reputation": 1, "user_id": 7194588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f700a806acf0cabe6807ec3dbdbc9f17?s=128&d=identicon&r=PG&f=1", "display_name": "MRJ", "link": "https://stackoverflow.com/users/7194588/mrj"}, "edited": false, "score": 0, "creation_date": 1479893022, "post_id": 40743263, "comment_id": 68745558, "body": "No, I am not asking about how to convert those to hMatrix right now.  What I would like to know is how to better interact with the object <code>IO [[Float]]</code>.  For example, how do I go about getting the zeroth element of <code>[[1.23, 4.0], [23.7, 23.1], [60.4, 4.2]] :: IO [[Float]]</code> -- by which I mean <code>[1.23, 4.0] :: IO [Float]</code>?"}], "owner": {"reputation": 1, "user_id": 7194588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f700a806acf0cabe6807ec3dbdbc9f17?s=128&d=identicon&r=PG&f=1", "display_name": "MRJ", "link": "https://stackoverflow.com/users/7194588/mrj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 210, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479895435, "creation_date": 1479821744, "last_edit_date": 1479895435, "question_id": 40743263, "link": "https://stackoverflow.com/questions/40743263/haskell-read-a-data-file-as-array-for-computations", "title": "Haskell: Read a data file as array for computations", "body": "<h1>Set-up</h1>\n\n<p>I have a data file in the following format: 2D coordinates separated by a space on each line,</p>\n\n<pre><code>1.23 4.0\n23.7 23.1\n60.4 4.2\n</code></pre>\n\n<p>To parse this, I made the following function (which I would not mind feedback on): it takes the file's path as string, parses the lines and columns as doubles,</p>\n\n<pre><code>fileData :: String -&gt; IO [[Float]]\nfileData str = readFile str &gt;&gt;=\n               \\file -&gt; return $ map ((map $ \\x -&gt; read x::Float) . words $) $ lines file\n</code></pre>\n\n<p>The ouput given the example file above is an <code>IO [[Float]]</code>:</p>\n\n<pre><code>[[1.23, 4.0],\n[23.7, 23.1],\n[60.4, 4.2]]\n</code></pre>\n\n<h1>Questions</h1>\n\n<p>What is the best way to handle this array, the output of <code>fileData</code>?  For example, how should one go about doing computations with values in this array?  Eventually, I will want to manipulate these values using hMatrix.</p>\n\n<p><strike>To obtain the zeroth element of the array <code>[1.23, 4.0]</code>, I tried running</p>\n\n<pre><code>main :: IO ()\nmain = fileData \"file.txt\" &gt;&gt;=\n       \\file -&gt; print $ (flip (!!) 0) &lt;$&gt; file\n</code></pre>\n\n<p>but it returns the zeroth elements of each sub-array <code>[1.23, 23.7, 60.4]</code>, which matches with the value of <strike><code>(print $ map (flip (!!) 0))</code> on the array as if was <code>[[Float]]</code></strike> <code>print $ map (flip (!!) 0) xs</code>, where <code>xs</code> is the array as if it was <code>[[Float]]</code>.</strike></p>\n\n<h1>Update</h1>\n\n<p>I thought using fmap, as <code>(flip (!!) 0) &lt;$&gt; file</code> in <code>main</code> was necessary because of the type of <code>file</code> there, but it turns out that <code>file !! 0</code> works as intended; this makes <code>main</code> revised as:</p>\n\n<pre><code>main :: IO ()\nmain = fileData \"file.txt\" &gt;&gt;=\n       \\file -&gt; print $ file !! 0\n</code></pre>\n\n<p>However, now I am confused as to what the type of <code>file</code> in <code>fileData \"file.txt\" &gt;&gt;= \\file -&gt; print $ file !! 0</code>.  I thought it was of type <code>IO [[Float]]</code> so applying <code>(!!)</code> would not work directly, because of the <code>IO</code> monad.  Is there a better way to think about this?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1479817611, "post_id": 40741662, "comment_id": 68709348, "body": "Do you have to write a function that takes a list of lists? Usually, you would write <code>merge :: Ord a =&gt; [a] -&gt; [a] -&gt; [a]</code>."}, {"owner": {"reputation": 141, "user_id": 7091266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4c7265b02e328b183b28bdaf2d77ecb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rad", "link": "https://stackoverflow.com/users/7091266/rad"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1479817698, "post_id": 40741662, "comment_id": 68709421, "body": "Yes, that&#39;s the problem  I&#39;m having. I can&#39;t think of a way to make it work for a list of lists."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1479817758, "post_id": 40741662, "comment_id": 68709453, "body": "Do you know <code>foldr</code> or <code>foldl</code>? Homework questions are always tricky to answer, since you don&#39;t necessarily know what the pupil must not use."}, {"owner": {"reputation": 141, "user_id": 7091266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4c7265b02e328b183b28bdaf2d77ecb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rad", "link": "https://stackoverflow.com/users/7091266/rad"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1479817899, "post_id": 40741662, "comment_id": 68709561, "body": "Unfortunately not, the highest we&#39;ve reached is high order functions and search/sort algorithms."}, {"owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "edited": false, "score": 0, "creation_date": 1479818108, "post_id": 40741662, "comment_id": 68709708, "body": "A fold is a higher-order function. :) But I guess these means that folds are off-limits for the purpose of your homework."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1479838048, "post_id": 40741662, "comment_id": 68723197, "body": "<code>doBoth :: Ord a =&gt; [[a]] -&gt; [a]; doBoth xss = isort (merge_ xss)</code>?"}, {"owner": {"reputation": 141, "user_id": 7091266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4c7265b02e328b183b28bdaf2d77ecb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rad", "link": "https://stackoverflow.com/users/7091266/rad"}, "edited": false, "score": 0, "creation_date": 1479838578, "post_id": 40741662, "comment_id": 68723504, "body": "Man, I feel a little dumb right now. Yes, that was actually all I needed to do (with my pre-existing code). Thanks a lot!"}, {"owner": {"reputation": 42360, "user_id": 389146, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/zGYUq.jpg?s=128&g=1", "display_name": "Karl Bielefeldt", "link": "https://stackoverflow.com/users/389146/karl-bielefeldt"}, "edited": false, "score": 0, "creation_date": 1479855630, "post_id": 40741662, "comment_id": 68732469, "body": "FYI, this whole problem done properly is <code>sort . concat</code>.  I swear one day I&#39;m going to start a hall of shame website for teachers who foist this hobbled, bastardized form of functional programming on students instead of making the problems a little more interesting."}, {"owner": {"reputation": 141, "user_id": 7091266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4c7265b02e328b183b28bdaf2d77ecb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rad", "link": "https://stackoverflow.com/users/7091266/rad"}, "edited": false, "score": 0, "creation_date": 1479864620, "post_id": 40741662, "comment_id": 68734976, "body": "I don&#39;t know, we are often asked to redefine functions from the prelude, perhaps to understand how they work? I&#39;m not really in a position to judge because I&#39;m just a beginner, but it does get tedious at times."}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1479817642, "post_id": 40741813, "comment_id": 68709376, "body": "That doesn&#39;t have the same type as OP&#39;s <code>merge</code>."}, {"owner": {"reputation": 25, "user_id": 4642017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81a64df5938ab8e21c24c3a5a4f73131?s=128&d=identicon&r=PG&f=1", "display_name": "dotnetdeveloperboi", "link": "https://stackoverflow.com/users/4642017/dotnetdeveloperboi"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1479817849, "post_id": 40741813, "comment_id": 68709526, "body": "You&#39;re right, this takes two lists, and merges into one."}], "tags": [], "owner": {"reputation": 25, "user_id": 4642017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81a64df5938ab8e21c24c3a5a4f73131?s=128&d=identicon&r=PG&f=1", "display_name": "dotnetdeveloperboi", "link": "https://stackoverflow.com/users/4642017/dotnetdeveloperboi"}, "is_accepted": false, "score": 0, "last_activity_date": 1479817551, "last_edit_date": 1479817551, "creation_date": 1479817490, "answer_id": 40741813, "question_id": 40741662, "link": "https://stackoverflow.com/questions/40741662/sorting-a-list-of-lists-in-haskell/40741813#40741813", "title": "Sorting a list of lists in Haskell", "body": "<p>Try this (not tested):</p>\n\n<pre><code>merge :: Ord a =&gt; [a] -&gt; [a] -&gt; [a]\nmerge [] l1 = l1\nmerge l1 [] = l1\nmerge (e1:l1) (e2:l2)\n    | e1&lt;e2 = e1:merge l1 (e2:l2)\n    | otherwise = e2:merge (e1:l1) l2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 141, "user_id": 7091266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4c7265b02e328b183b28bdaf2d77ecb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rad", "link": "https://stackoverflow.com/users/7091266/rad"}, "edited": false, "score": 0, "creation_date": 1479818444, "post_id": 40742021, "comment_id": 68709958, "body": "Question: what difference does it make whether the given list is pre-sorted or not? Aren&#39;t they gonna get re-sorted anyway?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 141, "user_id": 7091266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4c7265b02e328b183b28bdaf2d77ecb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rad", "link": "https://stackoverflow.com/users/7091266/rad"}, "edited": false, "score": 1, "creation_date": 1479818520, "post_id": 40742021, "comment_id": 68710021, "body": "@Rad huh? The lists for <code>mergeTwo</code> have to be sorted, if that&#39;s what you&#39;re asking about. After all, a proper merge will only look at the &quot;start&quot; of the (unprocessed) list/array. The list for <code>isort</code> does not (obviously)."}, {"owner": {"reputation": 141, "user_id": 7091266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4c7265b02e328b183b28bdaf2d77ecb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rad", "link": "https://stackoverflow.com/users/7091266/rad"}, "edited": false, "score": 0, "creation_date": 1479818596, "post_id": 40742021, "comment_id": 68710082, "body": "Okay, I get it. I&#39;ll start working on those. Thanks!"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 5, "last_activity_date": 1479818147, "creation_date": 1479818147, "answer_id": 40742021, "question_id": 40741662, "link": "https://stackoverflow.com/questions/40741662/sorting-a-list-of-lists-in-haskell/40742021#40742021", "title": "Sorting a list of lists in Haskell", "body": "<p>We start simple. How do we merge <em>two</em> sorted lists?</p>\n\n<pre><code>mergeTwo :: Ord a =&gt; [a] -&gt; [a] -&gt; [a]\nmergeTwo [] ys         = ys\nmergeTwo xs []         = xs\nmergeTwo (x:xs) (y:ys)\n  | x &lt;= y    = x : mergeTwo    xs  (y:ys)\n  | otherwise = y : mergeTwo (x:xs)    ys\n</code></pre>\n\n<p>How do we merge multiple? Well, we start with the first and the second and merge them together. Then we merge the new one and the third together:</p>\n\n<pre><code>mergeAll :: Ord a =&gt; [[a]] -&gt; [a]\nmergeAll (x:y:xs) = mergeAll ((mergeTwo x y) : xs)\nmergeAll [x]      = x\nmergeAll _        = []\n</code></pre>\n\n<p>Allright. Now, to sort all elements, we need to create a list from every element, and then merge them back. Let's write a function that creates a list for a single item:</p>\n\n<pre><code>toList :: a -&gt; [a]\ntoList x = -- exercise \n</code></pre>\n\n<p>And now a function to wrap all elements in lists:</p>\n\n<pre><code>allToList :: [a] -&gt; [[a]]\nallToList = -- exercise\n</code></pre>\n\n<p>And now we're done. We simply need to use <code>allToList</code> and then <code>mergeAll</code>:</p>\n\n<pre><code>isort :: Ord a =&gt; [a] -&gt; [a]\nisort xs = mergeAll (allToList xs)\n</code></pre>\n\n<p>Note that this exercise got a lot easier since we've split it into four functions.</p>\n\n<h3>Exercises (which might not be possible for you(r homework))</h3>\n\n<ul>\n<li>Write <code>toList</code> and <code>allToList</code>.</li>\n<li>Try a list comprehension for <code>allToList</code>. Try a higher order function for <code>allToList</code>.</li>\n<li>Write <code>isort</code> point-free (with <code>(.)</code>).</li>\n<li>Check whether there is already a <code>toList</code> function with the same type. Use that one.</li>\n<li>Rewrite <code>mergeAll</code> using <code>foldr</code></li>\n</ul>\n"}], "owner": {"reputation": 141, "user_id": 7091266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4c7265b02e328b183b28bdaf2d77ecb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rad", "link": "https://stackoverflow.com/users/7091266/rad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1092, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1479818147, "creation_date": 1479817043, "question_id": 40741662, "link": "https://stackoverflow.com/questions/40741662/sorting-a-list-of-lists-in-haskell", "title": "Sorting a list of lists in Haskell", "body": "<p>I want to write a function that takes a list of sorted lists, then merges everything together and sorts them again.</p>\n\n<p>I managed to write this so far:</p>\n\n<pre><code>merge_:: Ord a =&gt; [[a]] -&gt; [a] --takes in the list and merges it\nmerge_ [] = []\nmerge_ (x:xs) = x ++ merge_ xs\n\nisort:: Ord a =&gt; [a] -&gt; [a] --Sorts a list\nisort [] = []\nisort (a:x) = ins a (isort x)\n        where\n            ins a []                = [a]\n            ins a (b:y) | a&lt;= b     = a:(b:y)\n                        | otherwise = b: (ins a y)\n</code></pre>\n\n<p>I haven't been able to find a way to combine these two in one function in a way that makes sense. Note that I'm not allowed to use things such as ('.', '$'..etc) (homework)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1479817067, "post_id": 40741555, "comment_id": 68708989, "body": "Which compiler/interpreter do you use? That being said, every <code>then</code> needs an <code>else</code>. Also, Haskell is case-sensitive."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1479838128, "post_id": 40741808, "comment_id": 68723246, "body": "I think the desired outcome is <code>minimum [x,y,z] + maximum [x,y,z]</code>."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 3, "last_activity_date": 1479817470, "creation_date": 1479817470, "answer_id": 40741808, "question_id": 40741555, "link": "https://stackoverflow.com/questions/40741555/syntax-error-in-expression-unexpected-in-haskell/40741808#40741808", "title": "Syntax error in expression (unexpected &#39;}&#39;) in Haskell", "body": "<p>You're missing <code>else</code>. Every <code>if</code> needs both <code>then</code> and <code>else</code>, otherwise the return value wouldn't be determined, e.g. what should happen if <code>x</code> isn't even here?</p>\n\n<pre><code>add3IfEven x = if even x then x + 3\n</code></pre>\n\n<p>However, your compiler (Hugs) doesn't use your actual code, instead it transforms it into something else with curly braces:</p>\n\n<pre><code>{if \u2026 then \u2026 else \u2026 }\n</code></pre>\n\n<p>Since you're missing that last <code>else</code>, the <code>}</code> is unexpected. So make sure to add the correct <code>else</code> case. By the way, you can simply solve this exercise with <code>maximum [x + y, x + z, y + z]</code>.</p>\n"}], "owner": {"reputation": 148, "user_id": 6357057, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a0320816e0566f6c49d885db4e40d089?s=128&d=identicon&r=PG&f=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/6357057/pete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 703, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479817470, "creation_date": 1479816763, "question_id": 40741555, "link": "https://stackoverflow.com/questions/40741555/syntax-error-in-expression-unexpected-in-haskell", "title": "Syntax error in expression (unexpected &#39;}&#39;) in Haskell", "body": "<p>I am trying to write a simple function that takes three Int values and returns the sum of the minimum and maximum integers out of these three.</p>\n\n<p>My code:</p>\n\n<pre><code>summinmax3 :: Int -&gt; Int -&gt; Int -&gt; Int\nsumminmax3 x y z = \n  if (x &gt; y &amp;&amp; z &lt; y) \n    then (x + z)\n  else if (y &gt; x &amp;&amp; z &lt; x) \n    then (y + x)\n  else if (z &gt; x &amp;&amp; y &lt; X) \n    then (y + z)\n</code></pre>\n\n<p>The code returns the error <code>syntax error in expression (unexpected '}'), possibly due to bad layout</code></p>\n\n<p>Any help would be appreciated</p>\n"}, {"tags": ["python", "haskell", "recursion", "functional-programming", "monads"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1479814930, "post_id": 40740323, "comment_id": 68707674, "body": "Could you add a link to the exercise, if possible?"}, {"owner": {"reputation": 46858, "user_id": 967492, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/526ea226101e199d029049dda22a4e58?s=128&d=identicon&r=PG", "display_name": "potong", "link": "https://stackoverflow.com/users/967492/potong"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1479827307, "post_id": 40740323, "comment_id": 68716229, "body": "@Zeta <a href=\"https://www.udacity.com/course/programming-languages--cs262\" rel=\"nofollow noreferrer\">programming languages</a>"}], "answers": [{"comments": [{"owner": {"reputation": 46858, "user_id": 967492, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/526ea226101e199d029049dda22a4e58?s=128&d=identicon&r=PG", "display_name": "potong", "link": "https://stackoverflow.com/users/967492/potong"}, "edited": false, "score": 0, "creation_date": 1479829985, "post_id": 40741401, "comment_id": 68718271, "body": "Thank you for your solution(s). You&#39;ve pitched the answer just right at my lowly ability and I&#39;ve learnt a lot from your data approach. BTW when I copied your first solution and ran it in my haskell repl I got <code>Couldn&#39;t match type </code>Integer&#39; with <code>Int&#39;; Expected type: [State];Actual type: [Integer]</code>. I replaced <code>Int</code> by <code>Integer</code> everywhere and it compiled. Any reason why?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 46858, "user_id": 967492, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/526ea226101e199d029049dda22a4e58?s=128&d=identicon&r=PG", "display_name": "potong", "link": "https://stackoverflow.com/users/967492/potong"}, "edited": false, "score": 0, "creation_date": 1479889250, "post_id": 40741401, "comment_id": 68743245, "body": "@potong Did you use an <code>Integer</code> somewhere?"}, {"owner": {"reputation": 46858, "user_id": 967492, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/526ea226101e199d029049dda22a4e58?s=128&d=identicon&r=PG", "display_name": "potong", "link": "https://stackoverflow.com/users/967492/potong"}, "edited": false, "score": 0, "creation_date": 1479890040, "post_id": 40741401, "comment_id": 68743694, "body": "I copied the solution as is. Perhaps the version (7.6.3) of Haskell has something to do with it? The final solution also objected until I replaced <code>b</code> with <code>Char</code>. I realise that type system is there to help and clarify my mudded thinking but sometimes it seems to be a little obtuse in its error messages. I guess I must study the messages more deeply  or perhaps there is a switch that can give a more verbose explanation?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 46858, "user_id": 967492, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/526ea226101e199d029049dda22a4e58?s=128&d=identicon&r=PG", "display_name": "potong", "link": "https://stackoverflow.com/users/967492/potong"}, "edited": false, "score": 0, "creation_date": 1479890212, "post_id": 40741401, "comment_id": 68743777, "body": "@potong hm. That&#39;s out of scope of this question, but could you post your complete code as a gist or pastebin or similar? Without your surrounding code, it&#39;s hard to see where the error might be."}, {"owner": {"reputation": 46858, "user_id": 967492, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/526ea226101e199d029049dda22a4e58?s=128&d=identicon&r=PG", "display_name": "potong", "link": "https://stackoverflow.com/users/967492/potong"}, "edited": false, "score": 0, "creation_date": 1479891278, "post_id": 40741401, "comment_id": 68744421, "body": "With a bit of tinkering I realised I had included <code>edges</code> and <code>accepting</code> in the compiled code without providing a type for either. I believe the compiler assigned <code>Integer</code> to both. By specifiying a type up front for both the problem went away. Thank  you for your patience, everyday I&#39;m learning to think a little slower but clearer."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 46858, "user_id": 967492, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/526ea226101e199d029049dda22a4e58?s=128&d=identicon&r=PG", "display_name": "potong", "link": "https://stackoverflow.com/users/967492/potong"}, "edited": false, "score": 0, "creation_date": 1479891614, "post_id": 40741401, "comment_id": 68744644, "body": "@potong: Hurr durr. Of course you had to replace <code>b</code> with <code>Char</code> if I use <code>&quot;&quot;</code> for the empty list. After all, <code>&quot;&quot;</code> is an <code>String</code>, not a <code>[a]</code>. Fixed that one. Sorry."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 2, "last_activity_date": 1479891554, "last_edit_date": 1479891554, "creation_date": 1479816351, "answer_id": 40741401, "question_id": 40740323, "link": "https://stackoverflow.com/questions/40740323/represent-nondeterministic-finite-state-machine-simulator-in-haskell/40741401#40741401", "title": "Represent Nondeterministic Finite State Machine Simulator in Haskell", "body": "<p>Let us think about the type first. Your Python function has the following type, more or less:</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>type State   = Int\ntype Map k v = [(k,v)]\n\nnfsmSim :: String -&gt; State -&gt; Map (Int, Char) [State] -&gt; [State] -&gt; Bool\nnfsmSim string current edges accepting = \u2026\n</code></pre>\n\n<p>We can use pattern matching for the empty string case:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>nfsmSim :: String -&gt; State -&gt; Map (Int, Char) [State] -&gt; [State] -&gt; Bool\nnfsmSim \"\" current _ accepting = current `elem` accepting\n</code></pre>\n\n<p>For the non-empty case, we do the same as your Python code:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>nfsmSim (x:xs) current edges accepting =\n    let rest   = xs\n        states = [s | (k,v) &lt;- edges, k == (current,x), s &lt;- v]\n    in or [nfsmSim rest state edges accepting | state &lt;- states]\n</code></pre>\n\n<p>However, that's not really easy to work with. Instead, let us write <code>nfsmSim</code> as higher order function and change the order of arguments:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>nfsmSim :: (State -&gt; Char -&gt; [State])\n        -&gt; (State -&gt; Bool)\n        -&gt; String\n        -&gt; State\n        -&gt; Bool\n</code></pre>\n\n<p>Now, instead of a list of edges, we have to provide a function that returns a (possible empty) list of states for a given state and character, and instead of a list of accepting states, we provide a function that returns <code>True</code> on those states. </p>\n\n<p>For the empty string case, not too much changes:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>nfsmSim advance accept \"\" current = accept current\n</code></pre>\n\n<p>We simply use our <code>State -&gt; Bool</code> to check whether our current state is acceptable.</p>\n\n<p>However, now that our <code>State</code> is the last parameter of <code>nfsmSim</code>, we can use currying to use your <code>any</code> approach:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>nfsmSim advance accept (x:xs) current = \n    any (nfsmSim advance accept xs) (advance current x)\n</code></pre>\n\n<p>Note that it's kind of clunky to carry all arguments along. You would usually write a worker for that:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>nfsmSim :: (a -&gt; b -&gt; [a]) -&gt; (a -&gt; Bool) -&gt; [b] -&gt; a -&gt; Bool\nnfsmSim advance accept string current = go string current\n  where\n    go []     c = accept c\n    go (x:xs) c = any (go xs) (advance c x)\n</code></pre>\n\n<p>By the way, you can still use \"edges\" and \"accepting\" with the last variant,</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>nfsmSimAccept string current edges accepting =\n   let accept  c   = c `elem` accepting\n       advance c x = [s | (k,v) &lt;- edges, k == (c,x), s &lt;- v]\n   in nfsmSim advance accept string current\n</code></pre>\n\n<p>which shows that the higher order function is more flexible.</p>\n"}, {"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1479819135, "post_id": 40741683, "comment_id": 68710465, "body": "The <code>Set</code> is an overkill. There&#39;s no need for the &quot;end&quot; states to be in a sorted set."}, {"owner": {"reputation": 46858, "user_id": 967492, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/526ea226101e199d029049dda22a4e58?s=128&d=identicon&r=PG", "display_name": "potong", "link": "https://stackoverflow.com/users/967492/potong"}, "edited": false, "score": 0, "creation_date": 1479828667, "post_id": 40741683, "comment_id": 68717345, "body": "Thanks for your solution. I&#39;m at a low level of Haskell understanding, so many of the concepts you introduce will hopefully make more sense further down the line."}], "tags": [], "owner": {"reputation": 1212, "user_id": 2455145, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kazBZ.jpg?s=128&g=1", "display_name": "AlexJ136", "link": "https://stackoverflow.com/users/2455145/alexj136"}, "is_accepted": false, "score": 2, "last_activity_date": 1479817085, "creation_date": 1479817085, "answer_id": 40741683, "question_id": 40740323, "link": "https://stackoverflow.com/questions/40740323/represent-nondeterministic-finite-state-machine-simulator-in-haskell/40741683#40741683", "title": "Represent Nondeterministic Finite State Machine Simulator in Haskell", "body": "<p>Here's my Haskell-ish method:</p>\n\n<p>We can use haskell's Data.Set and Data.Map libraries to represent our state machine.</p>\n\n<pre><code>import qualified Data.Map as M\nimport qualified Data.Set as S\n</code></pre>\n\n<p>Let's define some datatypes for our state machine:</p>\n\n<pre><code>type State = Int\ntype Edge = (State, Char)\ntype Machine = (M.Map Edge (S.Set State), S.Set State)\n</code></pre>\n\n<p>We define the machine thusly:</p>\n\n<pre><code>myMachine :: Machine\nmyMachine = (M.fromList\n    [ ((1, 'a'), S.fromList [2, 3])\n    , ((2, 'a'), S.fromList [2   ])\n    , ((3, 'b'), S.fromList [3, 4])\n    , ((4, 'c'), S.fromList [5   ])\n    ] , S.fromList [2, 5])\n</code></pre>\n\n<p>we can run the machine like this:</p>\n\n<pre><code>runMachine :: String -&gt; Machine -&gt; State -&gt; Bool\nrunMachine \"\" (_, acceptingStates) currentState =\n    S.member currentState acceptingStates\nrunMachine (ch:rest) machine@(edges, _) currentState =\n    case M.lookup (currentState, ch) edges of\n        Nothing -&gt; False\n        Just nextStates -&gt;\n            or $ S.map (runMachine rest machine) nextStates\n</code></pre>\n\n<p>Since the function returns a <code>Bool</code>, there is no great reason to use a monad or do-notation. However such a solution is possible if we use the type <code>Maybe ()</code> in place of <code>Bool</code>, where <code>Just ()</code> represents <code>True</code> and <code>Nothing</code> represents <code>False</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 46858, "user_id": 967492, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/526ea226101e199d029049dda22a4e58?s=128&d=identicon&r=PG", "display_name": "potong", "link": "https://stackoverflow.com/users/967492/potong"}, "edited": false, "score": 0, "creation_date": 1479828496, "post_id": 40741961, "comment_id": 68717207, "body": "Thanks for correcting my sloppy question! I&#39;ve edited the title. Am I right in thinking <code>Just states &lt;- lookup (cur, c) edges</code> is monadic? but with no <code>do</code> or <code>return</code>?"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "reply_to_user": {"reputation": 46858, "user_id": 967492, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/526ea226101e199d029049dda22a4e58?s=128&d=identicon&r=PG", "display_name": "potong", "link": "https://stackoverflow.com/users/967492/potong"}, "edited": false, "score": 0, "creation_date": 1479830474, "post_id": 40741961, "comment_id": 68718608, "body": "No, it&#39;s just Haskell 2010 syntax &quot;Patter guard&quot; (<a href=\"https://wiki.haskell.org/Pattern_guard\" rel=\"nofollow noreferrer\">wiki.haskell.org/Pattern_guard</a>)"}], "tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": false, "score": 4, "last_activity_date": 1479817963, "creation_date": 1479817963, "answer_id": 40741961, "question_id": 40740323, "link": "https://stackoverflow.com/questions/40740323/represent-nondeterministic-finite-state-machine-simulator-in-haskell/40741961#40741961", "title": "Represent Nondeterministic Finite State Machine Simulator in Haskell", "body": "<p>First of all, as I know, no such thing as \"Non Finite State Machine\". Judging from what you wrote, I realized that it is about \"Nondeterministic finite automaton (NFA)\".</p>\n\n<p>First variant.</p>\n\n<pre><code>nfa :: String -&gt; Int -&gt; [((Int, Char), [Int])] -&gt; [Int] -&gt; Bool\nnfa       [] cur     _ acc = cur `elem` acc\nnfa (c:rest) cur edges acc\n    | Just states &lt;- lookup (cur, c) edges = any (\\state -&gt; nfa rest state edges acc) states\n    | otherwise                            = False\n\nedges =\n    [ ((1, 'a'), [2, 3])\n    , ((2, 'a'), [2])\n    , ((3, 'b'), [3, 4])\n    , ((4, 'c'), [5])\n    ]\n\naccepting = [2, 5]\n\nmain = do\n    print $ nfa \"aaa\" 1 edges accepting\n    print $ nfa \"abc\" 1 edges accepting\n    print $ nfa \"abb\" 1 edges accepting\n    print $ nfa \"aabc\" 1 edges accepting\n</code></pre>\n\n<p>Output will be:</p>\n\n<pre><code>True\nTrue\nFalse\nFalse\n</code></pre>\n\n<p>Second variant:</p>\n\n<pre><code>import Control.Monad\nimport Data.Maybe\n\nnfa2 :: String -&gt; Int -&gt; [((Int, Char), [Int])] -&gt; [Int] -&gt; [Int]\nnfa2       [] cur     _ acc = guard (cur `elem` acc) &gt;&gt; return cur\nnfa2 (c:rest) cur edges acc = do\n    state &lt;- fromMaybe mzero $ lookup (cur, c) edges\n    nfa2 rest state edges acc\n\nedges =\n    [ ((1, 'a'), [2, 3])\n    , ((2, 'a'), [2])\n    , ((3, 'b'), [3, 4])\n    , ((4, 'c'), [5])\n    ]\n\naccepting = [2, 5]\n\nmain = do\n    print $ nfa2 \"aaa\" 1 edges accepting\n    print $ nfa2 \"abc\" 1 edges accepting\n    print $ nfa2 \"abb\" 1 edges accepting\n    print $ nfa2 \"aabc\" 1 edges accepting\n</code></pre>\n\n<p>Output will be:</p>\n\n<pre><code>[2]\n[5]\n[]\n[]\n</code></pre>\n"}], "owner": {"reputation": 46858, "user_id": 967492, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/526ea226101e199d029049dda22a4e58?s=128&d=identicon&r=PG", "display_name": "potong", "link": "https://stackoverflow.com/users/967492/potong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "accepted_answer_id": 40741401, "answer_count": 3, "score": 0, "last_activity_date": 1479891554, "creation_date": 1479813074, "last_edit_date": 1479827187, "question_id": 40740323, "link": "https://stackoverflow.com/questions/40740323/represent-nondeterministic-finite-state-machine-simulator-in-haskell", "title": "Represent Nondeterministic Finite State Machine Simulator in Haskell", "body": "<p>I am following \"programming languages\" on Udacity and trying to represent the problem sets in Haskell. The answers are written in Python:</p>\n\n<pre><code>edges = {(1,\"a\") : [2,3]\n        ,(2,\"a\") : [2]\n        ,(3,\"b\") : [3,4]\n        ,(4,\"c\") : [5]}\n\naccepting = [2,5]\n\ndef nfsmSim(string, current, edges, accepting):\n    if string == \"\":\n        return current in accepting\n    else:\n        letter = string[0]\n        key = (current, letter)\n        if key in edges:\n            rest = string[1:]\n            states = edges[key]\n            for state in states:\n                if nfsmSim(rest, state, edges, accepting):\n                    return True\n         return False\n</code></pre>\n\n<p>The starting state is always the first state i.e. <code>current = 1</code>. </p>\n\n<p>Strings such as <code>\"aaa\"</code> or <code>\"abc\"</code> are accepted whilst <code>\"abb\"</code> or <code>\"aabc\"</code> or rejected.</p>\n\n<p>My attempt at rewriting using Haskell:</p>\n\n<pre><code>nfsmSim [] c _  = [c]\nnfsmSim xs c es = [concat $ nfsmSim (tail xs) s es | (k,ss) &lt;- es, s &lt;- ss, x &lt;- xs, k==(c,x)]\n</code></pre>\n\n<p>I want to return a list of integers which represent the last state at the end of the input string and then <code>filter</code> these against the accepting states and use <code>any</code> to get a final <code>True</code> or <code>False</code>.</p>\n\n<p>I realise this is not probably the Haskell way to do this and that there is probably a better <code>wholemeal</code> solution. However as a beginner I am struggling with mondadic mechanism and most likely the recursive nature of this problem.</p>\n\n<p>Please point me in the right direction possibly using the <code>do</code> notation rather than the list comprehension. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479812825, "post_id": 40739071, "comment_id": 68706302, "body": "I adjusted some of the syntax in your data type definition. Please check whether I changed anything that I wasn&#39;t supposed to."}, {"owner": {"reputation": 5352, "user_id": 4896150, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/74d0c938f3f71d6ee14db4f6b9d222c2?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Harald", "link": "https://stackoverflow.com/users/4896150/anton-harald"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479816001, "post_id": 40739071, "comment_id": 68708337, "body": "Your initial edits were needed. However, it seems that you reverted them in another edit."}, {"owner": {"reputation": 5352, "user_id": 4896150, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/74d0c938f3f71d6ee14db4f6b9d222c2?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Harald", "link": "https://stackoverflow.com/users/4896150/anton-harald"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479816108, "post_id": 40739071, "comment_id": 68708382, "body": "it definitely should be DrawingElement, hence should we rollback to revision 2?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479816134, "post_id": 40739071, "comment_id": 68708393, "body": "I reverted them because I wasn&#39;t 100% sure that you intended <code>DrawingElem</code> and <code>Shape</code> to be the same thing (which would imply a group would be able to contain other groups, and a drawing other drawings). Given that that is the case, I will re-revert them."}, {"owner": {"reputation": 5352, "user_id": 4896150, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/74d0c938f3f71d6ee14db4f6b9d222c2?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Harald", "link": "https://stackoverflow.com/users/4896150/anton-harald"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479816401, "post_id": 40739071, "comment_id": 68708569, "body": "the post looks like it was intended right now. However, it might be open to discuss if the introduction of another type Shape would make sense."}], "answers": [{"comments": [{"owner": {"reputation": 5352, "user_id": 4896150, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/74d0c938f3f71d6ee14db4f6b9d222c2?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Harald", "link": "https://stackoverflow.com/users/4896150/anton-harald"}, "edited": false, "score": 0, "creation_date": 1479827967, "post_id": 40742925, "comment_id": 68716764, "body": "the example I gave was maybe not the best. For the scaling I think your approach is reasonable. However, there will be other properties which will differ much more in the shapes. For instance some of the shapes can be filled with a color, others not."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 5352, "user_id": 4896150, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/74d0c938f3f71d6ee14db4f6b9d222c2?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Harald", "link": "https://stackoverflow.com/users/4896150/anton-harald"}, "edited": false, "score": 0, "creation_date": 1479866232, "post_id": 40742925, "comment_id": 68735373, "body": "@AntonHarald Alternatives in that case might include using an indirection layer, as in chi&#39;s answer, and introducing a few different types to cover the insurmountable differences plus a common, &quot;lower-level&quot; intermediate representation supporting a minimal set of operations that you can convert the &quot;higher-level&quot; elements to when necessary (e.g. for grouping them)."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 2, "last_activity_date": 1479820732, "creation_date": 1479820732, "answer_id": 40742925, "question_id": 40739071, "link": "https://stackoverflow.com/questions/40739071/single-type-with-several-data-constructors-vs-several-types/40742925#40742925", "title": "Single Type With Several Data Constructors vs. Several Types", "body": "<blockquote>\n  <p>However writing <code>setSize someSize someCircle</code> without getting a type error looks problematic to me.</p>\n</blockquote>\n\n<p>That would be problematic indeed. To avoid that, I will suggest a third option: perhaps you don't actually need a rectangle-specific <code>setSize</code> function at all. An alternative approach would be keeping a single <code>DrawingElem</code> type, setting an initial size on rectangle construction (and the initial radius on circle construction, etc.) and using functions that can be implemented for all kinds of elements to adjust the size after construction, such as:</p>\n\n<pre><code>scale :: Double -&gt; DrawingElem -&gt; DrawingElem\n\nscaleX :: Double -&gt; DrawingElem -&gt; DrawingElem\n\nscaleY :: Double -&gt; DrawingElem -&gt; DrawingElem\n</code></pre>\n\n<p>That is very similar to how <em>gloss</em> handles shapes (cf. <a href=\"https://hackage.haskell.org/package/gloss-rendering-1.9.3.1/docs/Graphics-Gloss-Rendering.html\" rel=\"nofollow noreferrer\">the relevant type definition</a> and some <a href=\"https://hackage.haskell.org/package/gloss-1.10.2.3/docs/Graphics-Gloss-Data-Picture.html#g:1\" rel=\"nofollow noreferrer\">picture manipulation functions</a>). Another example worth mentioning is <a href=\"http://projects.haskell.org/diagrams/doc/manual.html\" rel=\"nofollow noreferrer\"><em>diagrams</em></a>, which uses a very sophisticated model for pictures, with a plethora of types and classes involved, and yet handles operations such as scaling in a similar manner. </p>\n"}, {"comments": [{"owner": {"reputation": 5352, "user_id": 4896150, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/74d0c938f3f71d6ee14db4f6b9d222c2?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Harald", "link": "https://stackoverflow.com/users/4896150/anton-harald"}, "edited": false, "score": 0, "creation_date": 1479828500, "post_id": 40743550, "comment_id": 68717210, "body": "for the first approach there could be even a default constructor function like this: <code>rect f = toSvg . f $ (Rect (Vec 1 1) (Pos 0 0))</code>, which could then be used like this: <code>rect (fill Red . size 4 4 . pos 7 5)</code> . Or would you know another way to conveniently create shapes in such a system? The second approach, I&#39;ll keep in the pocket for further projects."}, {"owner": {"reputation": 5352, "user_id": 4896150, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/74d0c938f3f71d6ee14db4f6b9d222c2?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Harald", "link": "https://stackoverflow.com/users/4896150/anton-harald"}, "edited": false, "score": 0, "creation_date": 1479830356, "post_id": 40743550, "comment_id": 68718529, "body": "Just realizing that the <code>rect</code> constructor must be a bit more complex, e.g. setting a default color. However it should show the point."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 5352, "user_id": 4896150, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/74d0c938f3f71d6ee14db4f6b9d222c2?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Harald", "link": "https://stackoverflow.com/users/4896150/anton-harald"}, "edited": false, "score": 0, "creation_date": 1479834738, "post_id": 40743550, "comment_id": 68721267, "body": "@AntonHarald Yes, you can do that if you want. Sometimes record updates are used for a similar goal e.g. <code>defaultRect { pos = ... , size = .. }</code> where all unset fields are given by the default rectangle value."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1479822500, "creation_date": 1479822500, "answer_id": 40743550, "question_id": 40739071, "link": "https://stackoverflow.com/questions/40739071/single-type-with-several-data-constructors-vs-several-types/40743550#40743550", "title": "Single Type With Several Data Constructors vs. Several Types", "body": "<p>One option is to use another indirection layer, and have a precise type for each element:</p>\n\n<pre><code>data DrawingElem\n    = DERect     Rect\n    | DECircle   Circle\n    ...\n\ndata Rect   = Rect Pos Size\ndata Circle = Circle Pos Radius\n\ntoSvg :: DrawingElem -&gt; String\n...\n\nsetSize :: Size -&gt; Rect -&gt; Rect\n...\n</code></pre>\n\n<p>As a minor downside here we need to pattern match <em>both</em> layers, e.g.</p>\n\n<pre><code>toSvg (DERect (Rect pos size)) = ...\n</code></pre>\n\n<p>A more advanced alternative could be using a GADT. This might be overkill for your task, though.</p>\n\n<pre><code>{-# LANGUAGE GADTs, DataKinds #-}\n\ndata ElemType = Rect | Circle | ...\n\ndata DrawingElem (t :: ElemType) where\n   DERect   :: Pos -&gt; Size   -&gt; DrawingElem Rect\n   DECircle :: Pos -&gt; Radius -&gt; DrawingElem Circle\n   ...\n\n-- this works on all element types t\ntoSvg :: DrawingElem t -&gt; String\n...\n\n-- this works only on a rectangle element\nsetSize :: Size -&gt; DrawingElem Rect -&gt; DrawingElem Rect\nsetSize size (DERect pos _) = DERect pos size\n</code></pre>\n\n<p>I am unconvinced about whether you actually need this. If in doubt, stick with the simpler alternative.</p>\n"}], "owner": {"reputation": 5352, "user_id": 4896150, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/74d0c938f3f71d6ee14db4f6b9d222c2?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Harald", "link": "https://stackoverflow.com/users/4896150/anton-harald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1479822500, "creation_date": 1479809517, "last_edit_date": 1479816143, "question_id": 40739071, "link": "https://stackoverflow.com/questions/40739071/single-type-with-several-data-constructors-vs-several-types", "title": "Single Type With Several Data Constructors vs. Several Types", "body": "<p>Consider the following type which describes the structure of some 2-dimensional shapes:</p>\n\n<pre><code>data DrawingElem\n    = Rect     Pos Size\n    | Circle   Pos Radius\n    | Ellipse  Pos Radius Radius\n    | Line     Pos Pos\n    | Polygon  [Pos]\n    | Polyline [Pos]\n\n    | Group    [DrawingElem]\n    | Drawing  [DrawingElem]\n</code></pre>\n\n<p>which make use of these definitions:</p>\n\n<pre><code>data Vec    = Vec Double Double\n\ntype Pos    = Vec\ntype Size   = Vec\ntype Radius = Double\n</code></pre>\n\n<p>The last two data constructors of <code>DrawingElem</code> are somehow special, because they make tree-like arrangements of the other types possible.</p>\n\n<pre><code>mydrawing = Drawing [Rect (Vec 0 0) (Vec 10 10),\n                     Group (Vec 30 40) [Circle (Vec 0 0) 90,\n                                        Line (Vec 0 0) (Vec 50 50)]]\n</code></pre>\n\n<p>Such a data structure should finally being transformed into a renderable SVG-String:</p>\n\n<pre><code>toSvg :: DrawingElem -&gt; String\ntoSvg (Drawing xs)               = \"&lt;svg&gt;\" ++ concatMap toSvg xs ++ \"&lt;/svg&gt;\"\ntoSvg (Group xs)                 = \"&lt;g&gt;\" ++ concatMap toSvg xs ++ \"&lt;/g&gt;\"\ntoSvg (Rect (Vec x y) (Vec w h)) = \"&lt;rect x='\" ++ x ... \"&lt;/rect&gt;\"\n</code></pre>\n\n<p>For this purpose, it looks to me it was necessary to wrap the different shapes inside the <code>DrawingElem</code> type. They must have the same type in order to be nested and finally rendered.</p>\n\n<p>In some other occasions, I'd like them being different types however: Say for a function which sets the size of a rectangle (and this only makes sense for rectangles, the others don't have the notion of a size):</p>\n\n<pre><code>setSize :: Size -&gt; Rect -&gt; Rect\n</code></pre>\n\n<p>This of course does not work with the above definitions and must be:</p>\n\n<pre><code>setSize :: Size -&gt; DrawingElem -&gt; DrawingElem\nsetSize (Rect p s) = ..\nsetSize x          = x\n</code></pre>\n\n<p>So I'd have to implement a wildcard that makes the function complete. However writing <code>setSize someSize someCircle</code> without getting a type error looks problematic to me.</p>\n\n<p>So finally I'm struggling with wrapping the drawing Elements inside a type VS. letting them being different types. Both properties are needed in different situations as described above.\nDoes someone have an advice for this? Is is an either-or, or is there maybe a way to model it which takes advantage of both ways?</p>\n"}, {"tags": ["debugging", "haskell", "ghc"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1479792726, "post_id": 40734253, "comment_id": 68695240, "body": "I&#39;m always on the fence about answering questions like these. &quot;I don&#39;t know of a way&quot; isn&#39;t really an answer -- but if nobody&#39;s willing to say it, then you just get no response at all..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1479795500, "post_id": 40734253, "comment_id": 68696166, "body": "GHC does some separate compilation. If the defining module doesn&#39;t expose an unfolding, the calling module is stuck with object code."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 3, "creation_date": 1479797518, "post_id": 40734253, "comment_id": 68696976, "body": "Not at my computer right now, but what about putting a call to trace inside assert, and let the entire assert be optimized away?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1479821912, "post_id": 40734253, "comment_id": 68712240, "body": "If everything fails, there&#39;s always the option of using CPP macros. Not very elegant, but at least handling compiler flags is simple."}], "answers": [{"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 6, "last_activity_date": 1479794615, "creation_date": 1479794615, "answer_id": 40734838, "question_id": 40734253, "link": "https://stackoverflow.com/questions/40734253/making-trace-optimise-away-like-assert/40734838#40734838", "title": "Making &quot;trace&quot; optimise away like &quot;assert&quot;?", "body": "<p>No, at least not based on <code>assert</code>. The magic for <code>assert</code> works the other direction and replaces the identity function with an assertion.</p>\n\n<p>Here's <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/src/GHC.Base.html#assert\" rel=\"nofollow noreferrer\"><code>assert</code> from base 4.9</a>:</p>\n\n<blockquote>\n<pre><code>-- Assertion function.  This simply ignores its boolean argument.\n-- The compiler may rewrite it to @('assertError' line)@.\n\n-- | If the first argument evaluates to 'True', then the result is the\n-- second argument.  Otherwise an 'AssertionFailed' exception is raised,\n-- containing a 'String' with the source file and line number of the\n-- call to 'assert'.\n--\n-- Assertions can normally be turned on or off with a compiler flag\n-- (for GHC, assertions are normally on unless optimisation is turned on\n-- with @-O@ or the @-fignore-asserts@\n-- option is given).  When assertions are turned off, the first\n-- argument to 'assert' is ignored, and the second argument is\n-- returned as the result.\n\n--      SLPJ: in 5.04 etc 'assert' is in GHC.Prim,\n--      but from Template Haskell onwards it's simply\n--      defined here in Base.lhs\nassert :: Bool -&gt; a -&gt; a\nassert _pred r = r\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 9, "last_activity_date": 1479796918, "last_edit_date": 1479796918, "creation_date": 1479796548, "answer_id": 40735280, "question_id": 40734253, "link": "https://stackoverflow.com/questions/40734253/making-trace-optimise-away-like-assert/40735280#40735280", "title": "Making &quot;trace&quot; optimise away like &quot;assert&quot;?", "body": "<p>Warning: I haven't tried this ...</p>\n\n<p>You can replace the <code>Debug.Trace</code> module completely with compiler flags. Make another module with trivial implementations of the functions in <code>Debug.Trace</code>:</p>\n\n<pre><code>module NoTrace (trace) where:\n\ntrace :: String -&gt; a -&gt; a\n{-# INLINE trace #-}\ntrace _message = id\n\n...\n</code></pre>\n\n<p>Put this module in another package named <code>no-trace</code>.</p>\n\n<p>Hide the <code>Debug.Trace</code> module in the arguments to ghc by <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/packages.html#package-thinning-and-renaming\" rel=\"nofollow noreferrer\">including every module</a> from the base package except <code>Debug.Trace</code>. Replace <code>Debug.Trace</code> with <code>NoTrace</code> from the <code>no-trace</code> package.</p>\n\n<pre><code>ghc -package=\"base (Control, Control.Applicative, ..., Data.Word, Foreign, ...)\" \\\n    -package=\"no-trace (NoTrace as Debug.Trace)\" \\\n    ...\n</code></pre>\n\n<hr>\n\n<p>This came from the crazy idea of using the compiler flag that changes the prelude to replace the prelude with one that had <a href=\"https://downloads.haskell.org/~ghc/7.0.1/docs/html/users_guide/rewrite-rules.html\" rel=\"nofollow noreferrer\">rewrite rules</a> to remove <code>trace</code>s, but those rewrite rules would taint anything that imported a module compiled with them, even if a downstream importer still wanted to use traces. When looking up how to replace the prelude I found that ghc can replace any module instead.</p>\n"}, {"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": false, "score": 5, "last_activity_date": 1479822632, "creation_date": 1479822632, "answer_id": 40743594, "question_id": 40734253, "link": "https://stackoverflow.com/questions/40734253/making-trace-optimise-away-like-assert/40743594#40743594", "title": "Making &quot;trace&quot; optimise away like &quot;assert&quot;?", "body": "<p>OK, back at my computer and finally remembered I wanted to demonstrate this. Here goes:</p>\n\n<pre><code>import Control.Exception\nimport Debug.Trace\nimport Control.Monad\n\ntraceDebug :: String -&gt; a -&gt; a\ntraceDebug msg = assert (trace msg True)\n\nmain :: IO ()\nmain = replicateM_ 2 $ do\n    print $ traceDebug \"here1\" ()\n    print $ traceDebug \"here2\" ()\n    print $ traceDebug \"here3\" ()\n</code></pre>\n\n<p>When compiled without optimizations, the output is:</p>\n\n<pre><code>here1\n()\nhere2\n()\nhere3\n()\n()\n()\n()\n</code></pre>\n\n<p>With optimizations:</p>\n\n<pre><code>()\n()\n()\n()\n()\n()\n</code></pre>\n\n<p>So I think this addresses the request, with the standard caveat around <code>trace</code> that once the thunk has been evaluated, it won't be evaluated a second time (which is why the messages only happen the first time through the <code>do</code>-block).</p>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 3, "score": 5, "last_activity_date": 1479822632, "creation_date": 1479791795, "question_id": 40734253, "link": "https://stackoverflow.com/questions/40734253/making-trace-optimise-away-like-assert", "title": "Making &quot;trace&quot; optimise away like &quot;assert&quot;?", "body": "<p>GHC rewrites <code>assert</code>s when optimising as just <code>id</code>. Or alternatively, it's behaviour can be changed with a compiler flag. However, I noticed the same doesn't happen with <code>trace</code>. Is there a version of <code>trace</code> which just ends up as <code>id</code> if a flag isn't or is set? </p>\n\n<p>More generally speaking, is there a way to alter the behaviour of a function based on the compiler flags used to compile the calling module (not the flags used to compile itself). Much like <code>assert</code> does. Or is this GHC magic that can only happen with <code>assert</code>?</p>\n"}, {"tags": ["list", "haskell", "aeson", "newtype"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 4556560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qBezV.jpg?s=128&g=1", "display_name": "Kurt Wurthrop", "link": "https://stackoverflow.com/users/4556560/kurt-wurthrop"}, "edited": false, "score": 0, "creation_date": 1479872245, "post_id": 40734250, "comment_id": 68736833, "body": "This answer was tremendously helpful (as was the later &quot;Just&quot; edit to help it compile) and I have marked it as the accepted answer.  Thank you kind Haskellers!"}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 3, "last_activity_date": 1479822420, "last_edit_date": 1479822420, "creation_date": 1479791789, "answer_id": 40734250, "question_id": 40733681, "link": "https://stackoverflow.com/questions/40733681/map-function-to-newtype-defined-as-a-list-of-data-structures/40734250#40734250", "title": "map function to newtype defined as a List of Data structures", "body": "<p>It should be enough to define a function...</p>\n\n<pre><code>processWeatherPoint :: WeatherPoint -&gt; ProcessedWeatherPoint\n</code></pre>\n\n<p>... extract the field with the <code>[WeatherPoint]</code> from the newtype and map the function over the list:</p>\n\n<pre><code>adjustTemp :: Maybe ForecastPointCollection -&gt; [ProcessedWeatherPoint]\nadjustTemp Nothing = []\nadjustTemp (Just (ForecastPointCollection points)) = processWeatherPoint &lt;$&gt; points\n</code></pre>\n\n<p>An alternative to pattern matching on the <code>ForecastPointCollection</code> is using the record accessor for the field. That would be specially useful if you didn't intend to export the constructor:</p>\n\n<pre><code>adjustTemp :: Maybe ForecastPointCollection -&gt; [ProcessedWeatherPoint]\nadjustTemp Nothing = []\nadjustTemp (Just forecast) = processWeatherPoint &lt;$&gt; forecastpointcollection forecast\n</code></pre>\n\n<p>An arguably more convenient way of writing the definition just above involves using the <code>maybe</code> function instead of doing explicit case analysis on <code>Maybe</code>:</p>\n\n<pre><code>adjustTemp :: Maybe ForecastPointCollection -&gt; [ProcessedWeatherPoint]\nadjustTemp = maybe [] (fmap processWeatherPoint . forecastpointcollection)\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 4556560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qBezV.jpg?s=128&g=1", "display_name": "Kurt Wurthrop", "link": "https://stackoverflow.com/users/4556560/kurt-wurthrop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 40734250, "answer_count": 1, "score": 1, "last_activity_date": 1479952118, "creation_date": 1479788187, "last_edit_date": 1479952118, "question_id": 40733681, "link": "https://stackoverflow.com/questions/40733681/map-function-to-newtype-defined-as-a-list-of-data-structures", "title": "map function to newtype defined as a List of Data structures", "body": "<p>I'm new to Haskell and FP and am working my way through LYAH and other sources, but to \"learn by doing\" I'm trying to write a small program involving JSON parsing. However, I've coded myself into a corner and can't get out. My code is cobbled together from various tutorials and I can sense I'm still \"thinking procedurally\" about how to put it together nicely, but I haven't gotten to the needed breakthrough to make it work.</p>\n\n<p>First, here is a chopped-down version of the multi-level JSON file, it's a weather forecast from the Weather Underground API, reduced to three hours.</p>\n\n<pre><code>{\n    \"response\": {\n        \"version\": \"0.1\",\n        \"termsofService\": \"http://www.wunderground.com/weather/api/d/terms.html\",\n        \"features\": {\n            \"hourly\": 1\n        }\n    },\n    \"hourly_forecast\": [{\n        \"FCTTIME\": {\n            \"hour\": \"8\",\n            \"epoch\": \"1479736800\",\n            \"pretty\": \"8:00 AM CST on November 21, 2016\"\n        },\n        \"temp\": {\n            \"english\": \"27\",\n            \"metric\": \"-3\"\n        },\n        \"condition\": \"Partly Cloudy\"\n    }, {\n        \"FCTTIME\": {\n            \"hour\": \"9\",\n            \"epoch\": \"1479740400\",\n            \"pretty\": \"9:00 AM CST on November 21, 2016\"\n        },\n        \"temp\": {\n            \"english\": \"32\",\n            \"metric\": \"0\"\n        },\n        \"condition\": \"Partly Cloudy\"\n    }, {\n        \"FCTTIME\": {\n            \"hour\": \"10\",\n            \"epoch\": \"1479744000\",\n            \"pretty\": \"10:00 AM CST on November 21, 2016\"\n        },\n        \"temp\": {\n            \"english\": \"35\",\n            \"metric\": \"2\"\n        },\n        \"condition\": \"Clear\"\n    }]\n}\n</code></pre>\n\n<p>Next, here is my Haskell program. I'm <strong>successfully</strong> parsing the JSON into a <code>newtype</code> called <code>ForecastPointCollection</code> which is defined as a <code>List</code> of <code>WeatherPoint</code>, which is a <code>data</code> structure of various things that came from the JSON file. But then, I can't figure out how to get the <code>[WeatherPoint]</code> list back out (see code comments). As a test of \"something to do\" with the list, I want to convert the Celcius temperature to Kelvin and get a new <code>List</code> that I can work with (output to JSON, do a <code>show</code> on, whatever).</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings   #-}\n-- {-# LANGUAGE RecordWildCards #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n\nmodule Main where\n\nimport           Data.Aeson\nimport           Data.Aeson.Types\n\nimport           Control.Applicative  ((&lt;$&gt;), (&lt;*&gt;))\nimport           Control.Monad        (mzero)\n\nimport qualified Data.ByteString.Lazy as BSL\nimport qualified Data.Text            as T\nimport qualified Data.Vector          as V\n\ntype MetricTemperature = Int\ntype KelvinTemperature = Int\n\nnewtype ForecastPointCollection = ForecastPointCollection\n  {forecastpointcollection :: [WeatherPoint]} deriving Show\n\ndata WeatherPoint = WeatherPoint\n  { epoch      :: T.Text\n  , prettyTime :: T.Text\n  , tempMetric :: MetricTemperature\n  , condition  :: T.Text\n  } deriving Show\n\ninstance FromJSON ForecastPointCollection where\n  parseJSON (Object o) =\n    ForecastPointCollection &lt;$&gt; o .: \"hourly_forecast\"\n  parseJSON _ = mzero\n\ndata ProcessedWeatherPoint = ProcessedWeatherPoint\n  { newEpoch      :: T.Text\n  , newPrettyTime :: T.Text\n  , newTempKelvin :: KelvinTemperature\n  , newCondition  :: T.Text\n  } deriving Show\n\ninstance FromJSON WeatherPoint where\n  parseJSON =\n    withObject \"Root Object Arbitrary Name\" $ \\o -&gt; do\n    fctO &lt;- o .: \"FCTTIME\"\n    epoch &lt;- fctO .: \"epoch\" -- contained within FCTTIME\n    pretty &lt;- fctO .: \"pretty\" -- contained within FCTTIME\n    tempO &lt;- o .: \"temp\"\n    metric &lt;- tempO .: \"metric\" -- contained within temp\n    condition &lt;- o .: \"condition\" -- at top level under hourly_forecast\n    return $ WeatherPoint epoch pretty (read metric) condition\n  -- parseJSON _ = mzero\n\nkelvinizeTemp :: MetricTemperature -&gt; KelvinTemperature\nkelvinizeTemp x = x + 273 -- hey, close enough\n\nadjustTemp :: Maybe ForecastPointCollection -&gt; [ProcessedWeatherPoint]\nadjustTemp Nothing = []\nadjustTemp x = [] -- HERE IS WHERE I AM LOSING MY WAY!\n                  -- HOW CAN I WALK THROUGH THE LIST INSIDE ForecastPointCollection\n                  -- TO map kelvinizeTemp ACROSS THAT LIST AND\n                  -- GET A [ProcessedWeatherPoint] LIST BACK TO PLAY WITH?\n\ngetSampleForecast = BSL.readFile \"/home/mypath/test/forecastsubmit.json\"\n\nmain = do\n  textOfJson &lt;- getSampleForecast\n  let (forecasts2 :: Maybe ForecastPointCollection) = decode textOfJson\n  case forecasts2 of\n    Just (ForecastPointCollection forecasts2) -&gt; do\n         putStrLn (\"Success!\")\n         putStrLn . show  $ forecasts2\n    _ -&gt; putStrLn \"Could not parse ForecastPointCollection JSON correctly.\"\n  -- So far so good, we've extracted data from the JSON and stored it in memory.\n  -- But now, how can we manipulate that data and start doing stuff with it?\n  -- Currently, the \"adjustTemp\" function returns an empty list no matter what.\n  let (processed2 :: [ProcessedWeatherPoint]) = adjustTemp forecasts2\n  putStrLn (\"More success (OK, not really, yet)!\")\n  putStrLn . show  $ processed2\n</code></pre>\n\n<p>Any advice appreciated. Should I not make <code>ForecastPointCollection</code> a <code>newtype</code>? Where am I being idiomatic and where am I just idiotic? :-p</p>\n\n<p>Update based on answer: For posterity, here is a possible (working) implementation of the newly-defined processWeatherPoint function. The pieces of a <code>data</code> structure should be thought of as a function!</p>\n\n<pre><code>processWeatherPoint :: WeatherPoint -&gt; ProcessedWeatherPoint\nprocessWeatherPoint x = ProcessedWeatherPoint\n  (epoch x)\n  (prettyTime x)\n  (kelvinizeTemp (tempMetric x))\n  (condition x)\n\nkelvinizeTemp :: MetricTemperature -&gt; KelvinTemperature\nkelvinizeTemp x = x + 273 -- this works OK because both types are type of Int\n</code></pre>\n"}, {"tags": ["if-statement", "haskell", "tuples"], "comments": [{"owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "edited": false, "score": 1, "creation_date": 1479778639, "post_id": 40732404, "comment_id": 68691705, "body": "Too much manual work. Try something more like <code>counts xs = (length $ filter (==0) xs, length $ filter (==1) xs)</code>. Sorry, I know I&#39;m not really answering your question."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1479779065, "post_id": 40732404, "comment_id": 68691793, "body": "<code>inc (fst c)</code> does nothing when sequenced, since it doesn&#39;t carry out side effects. Remeber, in Haskell, nearly everything is immutable. You can&#39;t modify <code>c</code>. Use a fold if you insist of doing this manually, or take @zorans suggestion, since it&#39;s probably the simplest way to achieve this."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1479803156, "post_id": 40732529, "comment_id": 68699719, "body": "I would curry the <code>c</code> argument into two arguments, making <code>first</code> unneeded."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 59, "user_id": 4501633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/62a9f530c8d8dc1ec09f6c442d0d74f9?s=128&d=identicon&r=PG&f=1", "display_name": "USERSFU", "link": "https://stackoverflow.com/users/4501633/usersfu"}, "edited": false, "score": 0, "creation_date": 1479813017, "post_id": 40732529, "comment_id": 68706419, "body": "@USERSFU: I&#39;ve added some explanation."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1479876084, "post_id": 40732529, "comment_id": 68737856, "body": "Unfortunately for the <code>Bifunctor</code> laws, <code>first</code> and <code>second</code> are actually lazier than your definitions suggest. This is because they&#39;re used to tie weird <code>Arrow</code>y knots. But it means that they have nasty potential performance gotchas in other situations. As a result, I virtually never use them."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1479894081, "post_id": 40732529, "comment_id": 68746269, "body": "@dfeuer: that&#39;s good to know and a pity. Do you have a reference for why this is necessary and how it affects performance?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1479913908, "post_id": 40732529, "comment_id": 68760024, "body": "@leftaroundabout, I don&#39;t. I think Edward Kmett told me it&#39;s necessary to support the <code>ArrowLoop</code> stuff. I suspect <code>Data.Bifunctor</code> followed the semantics of <code>Control.Arrow</code> to avoid confusion. As for performance, lazy pairs can definitely lead to space leaks, and if strictness analysis doesn&#39;t erase them will lead to thunk creation. It should generally work to use <code>first f $! p</code>. You just have to remember it all the time."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 9, "last_activity_date": 1479813295, "last_edit_date": 1479813295, "creation_date": 1479779298, "answer_id": 40732529, "question_id": 40732404, "link": "https://stackoverflow.com/questions/40732404/how-can-write-two-statement-within-then-statement/40732529#40732529", "title": "How can write two statement within then statement?", "body": "<p>You're thinking all imperatively. Something like <code>do { inc (fst c); count (tail x) }</code> would only make sense if <code>c</code> was some kind of mutable state variable. Haskell variables are not mutable, so <code>inc</code> can't <em>modify</em> the <code>fst</code> of <code>c</code>, it can only give you <em>a modified copy</em>. This might become clearer if you rewrite <code>inc</code> to the completely equivalent simpler form:</p>\n\n<pre><code>inc x = x + 1\n</code></pre>\n\n<p>(In fact, <code>inc = (+1)</code> would also do.)</p>\n\n<p>Now, in <code>count</code>, you're trying to carry on and increment a single accumulator variable through the recursion loop. You can do that, but you need to be explicit about passing the <em>modified</em> version to the recursive call:</p>\n\n<pre><code>count = go (0,0)\n where go :: (Int,Int) -&gt; [Int] -&gt; (Int,Int)\n       go c x\n        | null x       = c\n        | head x == 0  = go (first inc c) (tail x)\n        | head x == 1  = go (second inc c) (tail x)\n</code></pre>\n\n<p>This pattern of defining a small local helper function (<code>go</code> is just an arbitrary name, I could have also called it <code>getTheCountingDone</code>) and using it as the <a href=\"https://en.wikipedia.org/wiki/Tail_call\" rel=\"nofollow noreferrer\">\u201cloop body\u201d of the recursion</a> is quite common in Haskell. Basically <code>go (0,0)</code> \u201cinitialises\u201d <code>c</code> to the value <code>(0,0)</code>, then starts the first loop iteration. For the second iteration, you recurse to e.g. <code>go (first inc c)</code>, i.e. you start the loop again with the updated <code>c</code> variable.</p>\n\n<p>I've used <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Arrow.html#v:first\" rel=\"nofollow noreferrer\"><code>first</code> and <code>second</code></a> for incrementing the respective tuple field. <code>fst</code> only <em>reads</em> the first field, i.e. gives you its value, whereas <code>first</code> makes a tuple-update function from an element-update function. Instead of <code>import Control.Arrow</code> you could also define this yourself:</p>\n\n<pre><code>first :: (a-&gt;b) -&gt; (a,y) -&gt; (b,y)\nfirst f (a, y) = (f a, y)\nsecond :: (a-&gt;b) -&gt; (x,a) -&gt; (x,b)\nsecond f (x, a) = (x, f a)\n</code></pre>\n\n<p>(The <code>Control.Arrow</code> version is actually more general, but you don't need to worry about that \u2013 you can use it in just the same way.)</p>\n\n<p>Note that deconstructing lists with <code>head</code> and <code>tail</code> is heavily eschewed in Haskell: it's easy to get wrong \u2013 you may forget to check the list is nonempty before accessing an element, which will throw a nasty runtime error. Better use <em>pattern matching</em>:</p>\n\n<pre><code>count = go (0,0)\n where go c []      = c\n       go c (0:xs)  = go (first inc c) xs\n       go c (1:xs)  = go (second inc c) xs\n</code></pre>\n\n<p>Actually this is still not safe: you don't have exhaustive cases; the function fails if the list contains anything but zeroes or ones. Perhaps you'd like to count all zero and <em>nonzero</em> elements?</p>\n\n<pre><code>count = go (0,0)\n where go c []      = c\n       go c (0:xs)  = go (first inc c) xs\n       go c (_:xs)  = go (second inc c) xs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 3, "creation_date": 1479798992, "post_id": 40733434, "comment_id": 68697589, "body": "<code>both length . partition (== 0)</code>, where <code>both f (a,b) = (f a, f b)</code> would have O(n), compared to the O(n log n) sort."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1479917184, "post_id": 40733434, "comment_id": 68762248, "body": "I don&#39;t like the unnecessary partial function."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 1, "last_activity_date": 1479786378, "creation_date": 1479786378, "answer_id": 40733434, "question_id": 40732404, "link": "https://stackoverflow.com/questions/40732404/how-can-write-two-statement-within-then-statement/40733434#40733434", "title": "How can write two statement within then statement?", "body": "<p>another alternative</p>\n\n<pre><code>&gt; import Data.List(group,sort)\n&gt; count = tuplify . map length . group . sort\n       where tuplify [x,y] = (x,y)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1212, "user_id": 2455145, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kazBZ.jpg?s=128&g=1", "display_name": "AlexJ136", "link": "https://stackoverflow.com/users/2455145/alexj136"}, "is_accepted": false, "score": 0, "last_activity_date": 1479813400, "creation_date": 1479813400, "answer_id": 40740431, "question_id": 40732404, "link": "https://stackoverflow.com/questions/40732404/how-can-write-two-statement-within-then-statement/40740431#40740431", "title": "How can write two statement within then statement?", "body": "<p>One option would be to have a second parameter for your <code>count</code> function which keeps track of what you have already counted:</p>\n\n<pre><code>count :: [Int] -&gt; (Int, Int) -&gt; (Int, Int)\n\n-- if the list is empty, return the ones and zeroes already counted\ncount [] (zeroes, ones) = (zeroes, ones)\n\n-- if first element is a 0, increment the existing count for zeroes\n-- and count the rest\ncount (0:more) (zeroes, ones) = count more (zeroes + 1, ones)\n\n-- as before, but the first element is a 1\ncount (1:more) (zeroes, ones) = count more (zeroes, ones + 1)\n</code></pre>\n\n<p>When we call count, we have to give it a 'starting count' of <code>(0,0)</code>:</p>\n\n<pre><code>count [1,0,1,1,1,0,0,1] (0,0)\n</code></pre>\n\n<p>which returns <code>(3,5)</code> as the first 0 in the initial pair is incremented 3 times by the zeroes in the list, and the second 0 in the initial pair is incremented 5 times by the ones in the list.</p>\n\n<p>This solution is a common functional programming style called 'accumulating parameter'.</p>\n"}, {"tags": [], "owner": {"reputation": 1212, "user_id": 2455145, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kazBZ.jpg?s=128&g=1", "display_name": "AlexJ136", "link": "https://stackoverflow.com/users/2455145/alexj136"}, "is_accepted": false, "score": 1, "last_activity_date": 1479813857, "creation_date": 1479813857, "answer_id": 40740607, "question_id": 40732404, "link": "https://stackoverflow.com/questions/40732404/how-can-write-two-statement-within-then-statement/40740607#40740607", "title": "How can write two statement within then statement?", "body": "<p>One solution would be to filter the list twice, once keeping the zeroes, and once keeping the ones:</p>\n\n<pre><code>count :: [Int] -&gt; (Int, Int)\ncount nums = (length (filter (0 ==) nums), length (filter (1 ==) nums))\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 4501633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/62a9f530c8d8dc1ec09f6c442d0d74f9?s=128&d=identicon&r=PG&f=1", "display_name": "USERSFU", "link": "https://stackoverflow.com/users/4501633/usersfu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 40732529, "answer_count": 4, "score": 0, "last_activity_date": 1550862773, "creation_date": 1479778422, "last_edit_date": 1550862773, "question_id": 40732404, "link": "https://stackoverflow.com/questions/40732404/how-can-write-two-statement-within-then-statement", "title": "How can write two statement within then statement?", "body": "<p>I am writing a code in Haskell which take a list of 0's and 1's like [1,1,0,0,1,0,1] return a Pair(tuple) of the number occurrence of 0 and 1 in a list like (3,4).</p>\n\n<p>Here is my code: </p>\n\n<pre><code>inc :: Int -&gt; Int\ninc x = (\\x -&gt; x + 1) x\n\ncount :: [Int] -&gt; (Int,Int)\nc = (0,0)\ncount x = \n        if null x\n            then c\n        else if head x == 0\n            then do\n                inc (fst c)\n                count (tail x)\n        else if head x == 1\n            then do\n                inc (snd c) \n                count (tail x)\n</code></pre>\n\n<p>I have also tried doing it in a guarded form:</p>\n\n<pre><code>count :: [Int] -&gt; (Int,Int)\nc = (0,0)\ncount x \n          | null x =  c\n          | head x == 0 = inc (fst c) &gt;&gt; count (tail x)\n          | head x == 1 = inc (snd c) &gt;&gt; count (tail x)\n</code></pre>\n\n<p>The main problem is that I am not sure how to implement two function in one then statement.</p>\n"}, {"tags": ["haskell", "functional-programming", "agda", "idris", "morte"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1479777719, "post_id": 40731827, "comment_id": 68691469, "body": "Perhaps it is just my unfamiliarity with the syntax (what is <code>type : #Data</code>? What is <code>Data</code> vs. <code>#Data</code>. etc.) but it seems you want a function which produces a type whose terms are the inhabitants of that datatype, according to some encoding - such a function would simply have type <code>Data -&gt; *</code>. Anyways, the term you wrote for <code>List Nat</code> can&#39;t possibly mean what you think it means - you have both <code>mul (\u03bb(list : D) ..</code> and <code>mul (\u03bb(nat : D) ..</code> - you can&#39;t possible distinguish such uses of a lambda bound variable. Then it must be that <code>List</code> and <code>Nat</code> are identical types?"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1479779170, "post_id": 40731827, "comment_id": 68691823, "body": "@user2407038 #Data just inlines the <code>Data</code> type I defined earlier."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1479779362, "post_id": 40731827, "comment_id": 68691862, "body": "@user2407038 no, that function is used to mark the transition between different datatypes... <code>\u03bb (self:D) -&gt; self</code>, aka <code>id</code>, means it is a direct recursive field (both cases here, Nat and List)... <code>\u03bb (self:D) -&gt; parent</code>, aka <code>const parent</code>, means it is a recursive field, but it jumps back to a parent type, not to itself (think of <code>Tree (List Int)</code>)... <code>\u03bb (x:D) -&gt; data ...</code> means it isn&#39;t a recursive field, but the beginning of another instead. It is useful for generics, you call that function with the recursive bits and it puts them in the right places on the derived generic normal form."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1479842445, "post_id": 40731827, "comment_id": 68725831, "body": "The two terms <code>mul (\u03bb(nat : D) \u2192 nat) one</code> and <code>mul (\u03bb(list : D) \u2192 list) one</code> are identical. You can&#39;t supply a function <code>mul</code> which makes identical applications of it into different outputs - this is literally the definition of a function (equal inputs to equal outputs). The fact that the two terms are used in different contexts in a larger term doesn&#39;t matter. I think you wan&#39;t something like <code>mul (\\nat -&gt; add one nat)</code>, similarly for lists."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1479843314, "post_id": 40731827, "comment_id": 68726259, "body": "@user2407038 you don&#39;t get it. You supply it with the recursive constructors of the currently parsed type. So the first receives nat, because it is on the context of nat, and the second receives list, because it is on the context of list. The function is supposed to return the argument it received, <b>except</b> if it isn&#39;t a recursive field. I know it is correct since I&#39;ve been using it on the untyped lambda calculus for months and it is the simplest way I found to derive all kinds of generic functions based on descriptions, which ranges from constructors to functor, foldable and even zipWith..."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1479855878, "post_id": 40731827, "comment_id": 68732560, "body": "You say all of this as if <code>mul</code>, <code>data</code>, etc. are already algebraic constructors of some type, with an elimination principle. The only way for you to eliminate a <code>Data</code> (i.e. write a function <code>Data -&gt; Anything</code>) is to apply the <code>x : Data</code> to a <i>specific</i> <code>D : *</code> and give functions for that specific type - but terms of type <code>Data</code> must (clearly) be parametric in <code>D</code>. None of those functions consume a <code>D</code> so a function <code>D -&gt; D</code> is either <code>id</code> or <code>const e</code> for some <code>e : D</code>. ...."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1479856015, "post_id": 40731827, "comment_id": 68732614, "body": "... I think this is what you mean by &quot;The function is supposed to return the argument it received, except if it isn&#39;t a recursive field.&quot; But clearly you cannot distinguish between the functions <code>\\x -&gt; x</code> and <code>\\_ -&gt; e</code> and I don&#39;t even think it is possible to prove (in the host language) that these are the only two functions which can be passed to <code>mul</code> inside <code>d : Data</code>. And finally, I agree that &quot;I don&#39;t get it&quot; - could you include a formal semantics (in the metatheory) for such a type <code>Data</code>? What precisely does every &#39;field&#39; indicate? How precisely can they be used? Can that be enforced?"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1479856582, "post_id": 40731827, "comment_id": 68732818, "body": "I&#39;m not sure I understand what you&#39;re saying... that is exactly what I said, though, it is either <code>id</code> or <code>const k</code>... that is what it is for. I think it is really hard to explain with words, so take a look on the <a href=\"http://lpaste.net/344938\" rel=\"nofollow noreferrer\">implementation</a> of a generic constructor deriver for a similar encoding on the untyped \u03bb-calculus. It works for arbitrary ADTs and needs that <code>d:Data</code> thing. I was trying to replicate that on Morte, but I&#39;m having trouble figuring out the types... and that is all that the question was about. Sorry if I don&#39;t get what you&#39;re trying to say."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1479857126, "post_id": 40731827, "comment_id": 68733011, "body": "Just think about it, you want to derive a generic constructor function from an arbitrary datatype specification... take the church encoding for Nat, the first ctor is <code>(\u03bb x . \u03bb s . \u03bb n . (s (x s z)))</code>... notice that the first field of the first ctor is <code>x s z</code>... in order to achieve that, you must apply to <code>x</code> to <code>s z</code>... so you call that function we&#39;re debating with <code>(x -&gt; (x s z))</code>. What if that field isn&#39;t a recursive field, but &quot;something else&quot; (<code>const somethingElse</code>)? Then you still apply it to <code>(x -&gt; (x s z))</code>, but it will overwrite <code>s z</code> with the proper constructors of &quot;something else&quot;."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1479859640, "post_id": 40731827, "comment_id": 68733775, "body": "Oh wait, if you are talking specifically about the type <code>D -&gt; D</code>, I have no idea if that is right... the question is exactly whether it is possible to type those previously untyped terms correctly... I didn&#39;t think much about the types..."}, {"owner": {"reputation": 34015, "user_id": 1026598, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e4cf2da845e7862bd0b0e4edd405f77d?s=128&d=identicon&r=PG", "display_name": "Gabriel Gonzalez", "link": "https://stackoverflow.com/users/1026598/gabriel-gonzalez"}, "edited": false, "score": 0, "creation_date": 1479915012, "post_id": 40731827, "comment_id": 68760769, "body": "Are the <code>\u2200(a : ?) \u2192 a</code> arguments supposed to be <code>\u03bb(a : ?) \u2192 a</code> instead?"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 34015, "user_id": 1026598, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e4cf2da845e7862bd0b0e4edd405f77d?s=128&d=identicon&r=PG", "display_name": "Gabriel Gonzalez", "link": "https://stackoverflow.com/users/1026598/gabriel-gonzalez"}, "edited": false, "score": 0, "creation_date": 1479915497, "post_id": 40731827, "comment_id": 68761086, "body": "@GabrielGonzalez now that you pointed it, probably..."}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1479774833, "creation_date": 1479774092, "last_edit_date": 1479774833, "question_id": 40731827, "link": "https://stackoverflow.com/questions/40731827/is-it-possible-to-derive-the-type-and-constructors-of-an-adt-using-a-first-class", "title": "Is it possible to derive the type and constructors of an ADT using a first-class description?", "body": "<p>Suppose that, to describe tree-like algebraic data types, we use the following type, <code>Data</code>:</p>\n\n<pre><code>\u2200(D : *) \u2192\n\u2200(S : *) \u2192\n\u2200(P : *) \u2192\n\u2200(data : S \u2192 D) \u2192\n\u2200(add : P \u2192 S \u2192 S) \u2192\n\u2200(zer : S) \u2192\n\u2200(mul : (D \u2192 D) \u2192 P \u2192 P) \u2192\n\u2200(one : P) \u2192\nD\n</code></pre>\n\n<p>This is, for example, the type <code>List Nat</code>:</p>\n\n<pre><code>\u03bb(D : *) \u2192\n\u03bb(S : *) \u2192\n\u03bb(P : *) \u2192\n\u03bb(data : S \u2192 D) \u2192\n\u03bb(add : P \u2192 S \u2192 S) \u2192\n\u03bb(zer : S) \u2192\n\u03bb(mul : (D \u2192 D) \u2192 P \u2192 P) \u2192\n\u03bb(one : P) \u2192\n-- data List Nat =\ndata \n  -- Cons\n  (add\n    -- Nat\n    (mul (\u03bb(list : D) \u2192 \n      -- data Nat =\n      data \n        -- Succ Nat\n        (add (mul (\u03bb(nat : D) \u2192 nat) one)\n        -- Zero\n        (add one zer)))\n    -- List Nat\n    (mul (\u03bb(list : D) \u2192 list) one))\n  -- Nil\n  (add one zer))\n</code></pre>\n\n<p>Now, if we define <code>Data.type</code> as:</p>\n\n<pre><code>\u03bb (type : #Data ) -&gt;\ntype ? ? ?\n(\u03bb (data:?) -&gt; \u2200 (a:?) -&gt; (data a))\n(\u03bb (ctorType: ?) -&gt; \u03bb (rest:?) -&gt; \u2200 (a:?) -&gt; \u2200 (ctor:(ctorType a)) -&gt; (rest a))\n(\u2200 (a:?) -&gt; a)\n(\u03bb (fieldType: ?) -&gt; \u03bb (rest:?) -&gt; \u2200 (a:?) -&gt; \u2200 (field:(fieldType a)) -&gt; (rest a))\n(\u2200 (a:?) -&gt; a)\n</code></pre>\n\n<p>And we apply it to <code>List Nat</code>, ignoring type errors, that normalizes to the type of church-encoded lists of nats, which is <code>\u2200(a:*) -&gt; (((\u2200 (a:*) -&gt; ((a -&gt; a) -&gt; a -&gt; a)) -&gt; a -&gt; a) -&gt; a -&gt; a</code>. I'd like to know:</p>\n\n<ol>\n<li><p>Is it possible to type the <code>Data.type</code> term?</p></li>\n<li><p>If not, is there any way to achieve similar effect, using a different strategy? </p></li>\n</ol>\n"}, {"tags": ["haskell", "types", "data-kinds"], "comments": [{"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 1, "creation_date": 1479773436, "post_id": 40731220, "comment_id": 68690332, "body": "Side remark: by turning on the <code>PolyKinds</code> extension, ghc is more lenient with the idea of a poly-kinded <code>Proxy</code> and the error message becomes different and makes it a lot clearer that it&#39;s a typical <code>ScopedTypeVariables</code> issue."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 9, "last_activity_date": 1479771028, "creation_date": 1479771028, "answer_id": 40731356, "question_id": 40731220, "link": "https://stackoverflow.com/questions/40731220/couldnt-match-kind-with-nat/40731356#40731356", "title": "Couldn&#39;t match kind &#39;*&#39; with &#39;Nat&#39;", "body": "<p>You need an explicit <code>forall</code> in the signature of <code>textMax</code>, so that <code>ScopedTypeVariables</code> kicks in and the <code>n</code> in the <code>Proxy n</code> annotation becomes the same <code>n</code> in the <code>KnownNat n</code> constraint:</p>\n\n<pre><code>textMax :: forall n. KnownNat n =&gt; Text -&gt; Maybe (TextMax n)\ntextMax t\n  | Text.length t &lt;= (fromIntegral $ natVal (Proxy :: Proxy n)) = Just (TextMax t)\n  | otherwise = Nothing\n</code></pre>\n"}], "owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 557, "favorite_count": 0, "accepted_answer_id": 40731356, "answer_count": 1, "score": 7, "last_activity_date": 1479771028, "creation_date": 1479770372, "last_edit_date": 1495535417, "question_id": 40731220, "link": "https://stackoverflow.com/questions/40731220/couldnt-match-kind-with-nat", "title": "Couldn&#39;t match kind &#39;*&#39; with &#39;Nat&#39;", "body": "<p>I'm trying to create a type that guarantees that a string is less than N characters long. </p>\n\n<pre><code>{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE DataKinds #-}\n\nimport GHC.TypeLits (Symbol, Nat, KnownNat, natVal, KnownSymbol, symbolVal)\nimport Data.Text (Text)\nimport qualified Data.Text as Text\nimport Data.Proxy (Proxy(..))\n\ndata TextMax (n :: Nat) = TextMax Text\n  deriving (Show)\n\ntextMax :: KnownNat n =&gt; Text -&gt; Maybe (TextMax n)\ntextMax t\n  | Text.length t &lt;= (fromIntegral $ natVal (Proxy :: Proxy n)) = Just (TextMax t)\n  | otherwise = Nothing\n</code></pre>\n\n<p>This gives the error: </p>\n\n<pre><code>src/Simple/Reporting/Metro2/TextMax.hs:18:50: error:\n\u2022 Couldn't match kind \u2018*\u2019 with \u2018Nat\u2019\n  When matching the kind of \u2018Proxy\u2019\n\u2022 In the first argument of \u2018natVal\u2019, namely \u2018(Proxy :: Proxy n)\u2019\n  In the second argument of \u2018($)\u2019, namely \u2018natVal (Proxy :: Proxy n)\u2019\n  In the second argument of \u2018(&lt;=)\u2019, namely\n    \u2018(fromIntegral $ natVal (Proxy :: Proxy n))\u2019\n</code></pre>\n\n<p>I don't understand this error. Why doesn't it work? <a href=\"https://stackoverflow.com/questions/40667682/model-a-serial-format-in-the-type-system-like-servant\">I've used almost this exact same code to get the natVal of n in other places and it works</a>. </p>\n\n<p>Is there a better way to do this?</p>\n"}, {"tags": ["haskell", "higher-kinded-types", "data-kinds"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1479822887, "post_id": 40730196, "comment_id": 68712907, "body": "The reason you have to do it manually is partiality. Given a type-level <code>b :: Bool</code> you don&#39;t know for certain that it&#39;s either <code>True</code> or <code>False</code>. It could be a <a href=\"https://typesandkinds.wordpress.com/2015/09/09/what-are-type-families/\" rel=\"nofollow noreferrer\">stuck type</a>. A singleton proves that its type isn&#39;t stuck. Dependent Haskell will help a bit for this particular case, because <code>True</code> and <code>&#39;True</code> will be the same thing, but there are still unavoidable problems with partiality."}, {"owner": {"reputation": 28662, "user_id": 10311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ee697b9dc2411d50fb66a4f330ba4df?s=128&d=identicon&r=PG", "display_name": "porges", "link": "https://stackoverflow.com/users/10311/porges"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1499232487, "post_id": 40730196, "comment_id": 76811170, "body": "@BenjaminHodgson does the existing <code>TypeInType</code> help at all here, or is that unrelated?"}, {"owner": {"reputation": 28662, "user_id": 10311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ee697b9dc2411d50fb66a4f330ba4df?s=128&d=identicon&r=PG", "display_name": "porges", "link": "https://stackoverflow.com/users/10311/porges"}, "edited": false, "score": 0, "creation_date": 1499235441, "post_id": 40730196, "comment_id": 76812503, "body": "It would be fun if strict fields when lifted could not contain stuck types, much like a strict field cannot contain bottom. I just want to be able to scope over <code>a :: !Bool</code> and use it in the code :)"}], "answers": [{"tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": false, "score": 12, "last_activity_date": 1479771533, "creation_date": 1479771533, "answer_id": 40731437, "question_id": 40730196, "link": "https://stackoverflow.com/questions/40730196/kind-demotion-as-opposed-to-kind-promotion/40731437#40731437", "title": "Kind Demotion (as opposed to Kind Promotion)", "body": "<p>That is one of the uses of <a href=\"http://hackage.haskell.org/package/singletons\" rel=\"noreferrer\"><code>singletons</code></a>, in particular <a href=\"http://hackage.haskell.org/package/singletons-2.2/docs/Data-Singletons.html#v:fromSing\" rel=\"noreferrer\"><code>fromSing</code></a>:</p>\n\n<pre><code>ghci&gt; :m +Data.Singletons.Prelude\nghci&gt; :set -XDataKinds\nghci&gt; fromSing (sing :: Sing 'True)\nTrue\n</code></pre>\n\n<p>It still involves a lot of boilerplate, but the package has a lot of it already defined and I believe it provides Template Haskell to let you generate your own more easily (and with less code).</p>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 2, "answer_count": 1, "score": 15, "last_activity_date": 1479771533, "creation_date": 1479765664, "last_edit_date": 1479766584, "question_id": 40730196, "link": "https://stackoverflow.com/questions/40730196/kind-demotion-as-opposed-to-kind-promotion", "title": "Kind Demotion (as opposed to Kind Promotion)", "body": "<p>The <a href=\"http://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#datatype-promotion\" rel=\"noreferrer\">DataKinds</a> extension promotes \"values\" (i.e. constructors) into types. For example <code>True</code> and <code>False</code> become distinct types of kind <code>Bool</code>.  </p>\n\n<p>What I'd like to do is the opposite, i.e. demote types into values. A function with this signature would be fine:</p>\n\n<pre><code>demote :: Proxy (a :: t) -&gt; t\n</code></pre>\n\n<p>I can actually do this, for example for <code>Bool</code>:</p>\n\n<pre><code>class DemoteBool (a :: Bool) where\n  demoteBool :: Proxy (a :: Bool) -&gt; Bool\n\ninstance DemoteBool True where\n  demoteBool _ = True\n\ninstance DemoteBool False where\n  demoteBool _ = False\n</code></pre>\n\n<p>However, I'd have to write up instances for any type I want to demote back to it's value. Is there a nicer way of doing this that doesn't involve so much boilerplate?</p>\n"}, {"tags": ["haskell", "singleton", "dependent-type"], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 6, "last_activity_date": 1479761130, "last_edit_date": 1479761130, "creation_date": 1479760065, "answer_id": 40728752, "question_id": 40728578, "link": "https://stackoverflow.com/questions/40728578/bringing-the-singletons-paper-up-to-date-how-can-i-implement-the-achar-dataty/40728752#40728752", "title": "Bringing &quot;The Singletons Paper&quot; up to date. How can I implement the AChar datatype using singleton library", "body": "<p>I believe type-level \"strings\" already exist - they go by the name <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:Symbol\" rel=\"nofollow noreferrer\"><code>Symbol</code></a>.</p>\n\n<pre><code>ghci&gt; :set +t -XTypeInType\nghci&gt; import GHC.TypeLits\nghci&gt; import Data.Proxy\nghci&gt; Proxy :: Proxy \"I'm a type level string!\"\nProxy\nit :: Proxy \"I'm a type level string!\"\n</code></pre>\n\n<p>That said, I think <code>singleton</code> still doesn't play well with these. The problem is that they lack string-like behaviour (like being able to extract characters or make a string from characters). I believe the best solution is still the ugly one of redeclaring characters.</p>\n"}], "owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 1, "accepted_answer_id": 40728752, "answer_count": 1, "score": 2, "last_activity_date": 1479761130, "creation_date": 1479759371, "last_edit_date": 1495542270, "question_id": 40728578, "link": "https://stackoverflow.com/questions/40728578/bringing-the-singletons-paper-up-to-date-how-can-i-implement-the-achar-dataty", "title": "Bringing &quot;The Singletons Paper&quot; up to date. How can I implement the AChar datatype using singleton library", "body": "<p>Thanks to <a href=\"https://stackoverflow.com/users/1523776/benjamin-hodgson\">Benjamin Hodgson</a>, I have started to implement a type-safe SQL-Interface, begun in <a href=\"https://stackoverflow.com/questions/40683737/is-it-possible-to-have-different-behaviors-for-the-same-constructor\">this</a> stackoverflow question.</p>\n\n<p>As advised, I have started to read <a href=\"http://cs.brynmawr.edu/~rae/papers/2012/singletons/paper.pdf\" rel=\"nofollow noreferrer\">the singleton paper</a>. I find that seeing working code helps a lot, and endeavored to see the supplied <a href=\"http://www.cis.upenn.edu/~eir/papers/2012/singletons/code.tar.gz\" rel=\"nofollow noreferrer\">code</a> work. However, the code is three years old, and needs some updating. Great! Now I get to learn something. Here's step one, removing the promoted type AChar with type-literal strings.</p>\n\n<p>from the original code in <code>singletons-examples/DatabaseStar.hs</code></p>\n\n<pre><code>{-# OPTIONS_GHC -fwarn-incomplete-patterns #-}\n{-# Language PolyKinds, DataKinds, TemplateHaskell, TypeFamilies,\n    GADTs, TypeOperators, RankNTypes, FlexibleContexts, UndecidableInstances,\n    FlexibleInstances, ScopedTypeVariables, MultiParamTypeClasses #-}\n\nmodule DatabaseStar where\n\nimport Data.Singletons\nimport Data.Singletons.CustomStar\nimport Data.Singletons.TH\n\n$(singletons [d|\n-- A re-definition of Char as an algebraic data type.\n-- This is necessary to allow for promotion and type-level Strings.\n  data AChar = CA | CB | CC | CD | CE | CF | CG | CH | CI\n             | CJ | CK | CL | CM | CN | CO | CP | CQ | CR\n             | CS | CT | CU | CV | CW | CX | CY | CZ\n             deriving (Read, Show, Eq)\n\n-- A named attribute in our database\n  data Attribute a = Attr [AChar] a\n\n-- A schema is an ordered list of named attributes\n  data Schema a = Sch [Attribute a]\n  |]\n</code></pre>\n\n<p>I found <code>AChar</code> to be unsatisfying, and soon realized it was no longer needed.</p>\n\n<p>But I am not sure how to implement type-level <code>Strings</code> for this use case. Could someone provide links for me to investigate, and/or hints.</p>\n"}, {"tags": ["haskell", "monad-transformers"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1479754929, "post_id": 40727067, "comment_id": 68682027, "body": "I reckon this comments <a href=\"https://hackage.haskell.org/package/transformers-0.5.2.0/docs/Control-Monad-Trans-Cont.html#t:ContT\" rel=\"nofollow noreferrer\">at the definition of <code>ContT</code></a> is relevant: &quot;<code>ContT</code> is not a functor on the category of monads, and many operations cannot be lifted through it&quot;. You don&#39;t even need <code>m</code> to be a <code>Monad</code> to have <code>Monad (ContT k r m)</code>!"}, {"owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1479756666, "post_id": 40727067, "comment_id": 68682913, "body": "@Alec That definitely makes it weird, but it doesn&#39;t connect it with <code>MonadTransControl</code>"}], "answers": [{"tags": [], "owner": {"reputation": 448, "user_id": 4416280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c4e7c5ba681838526fb520fc8f36dec?s=128&d=identicon&r=PG&f=1", "display_name": "Zemyla", "link": "https://stackoverflow.com/users/4416280/zemyla"}, "is_accepted": true, "score": 2, "last_activity_date": 1488680540, "creation_date": 1488680540, "answer_id": 42603759, "question_id": 40727067, "link": "https://stackoverflow.com/questions/40727067/why-is-there-no-monadtranscontrol-instance-for-contt/42603759#42603759", "title": "Why is there no `MonadTransControl` instance for `ContT`", "body": "<p>The only thing you can, in general, get out of a <code>ContT r m</code> is a value of type <code>m r</code>. The type signature of <code>Run (ContT r)</code> would be</p>\n\n<pre><code>Run (ContT r) = forall n b. Monad n =&gt; ContT r n b -&gt; n (StT (ContT r) b)\n</code></pre>\n\n<p>which is equivalent to</p>\n\n<pre><code>forall n b. ((b -&gt; n r) -&gt; n r) -&gt; n (StT (ContT r) b)\n</code></pre>\n\n<p>The only possible type for <code>StT (ContT r) b</code> is <code>r</code>, but even then, there is no possible defined function of type <code>b -&gt; n r</code> to pass to the <code>ContT</code>. And since <code>liftWith</code> is given a function that requires a value of type <code>Run (ContT r)</code>, it can't be implemented.</p>\n\n<p><code>restoreT</code> makes it even worse, because any value that could possibly be extracted from a general <code>ContT r m a</code> can't be turned back into a <code>ContT r m a</code>. So you lose both coming and going.</p>\n\n<p>Incidentally, this is also the reason you can't make <code>ContT</code> a <code>MonadFix</code>. You can't turn an arbitrary <code>a</code> into an arbitrary <code>r</code>, and vice versa.</p>\n"}], "owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 42603759, "answer_count": 1, "score": 5, "last_activity_date": 1488680540, "creation_date": 1479753126, "question_id": 40727067, "link": "https://stackoverflow.com/questions/40727067/why-is-there-no-monadtranscontrol-instance-for-contt", "title": "Why is there no `MonadTransControl` instance for `ContT`", "body": "<p>I have no idea how I'd implement it and I'm assuming that there might not be a way to do it. Is there a proof or a convincing argument that it can't be done?</p>\n\n<p>What makes <code>ContT</code> special?</p>\n"}, {"tags": ["multithreading", "haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1479751693, "post_id": 40726052, "comment_id": 68680507, "body": "A question identical to this one was asked <a href=\"http://stackoverflow.com/q/40722552/2751851\">three hours ago</a>, and there was at least another one over the last few days."}, {"owner": {"reputation": 9, "user_id": 7190645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfface1e25342f4fef645a7d935b4446?s=128&d=identicon&r=PG&f=1", "display_name": "i1698011", "link": "https://stackoverflow.com/users/7190645/i1698011"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479751833, "post_id": 40726052, "comment_id": 68680570, "body": "@duplode it is, because I didn&#39;t get answer yet."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1479752135, "post_id": 40726052, "comment_id": 68680708, "body": "Please don&#39;t ask the same question repeatedly just because you didn&#39;t get the answer you wanted. That just wastes everyone&#39;s time."}, {"owner": {"reputation": 1281, "user_id": 4638818, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-_GNq2cgiDYQ/AAAAAAAAAAI/AAAAAAAAAPE/iIK-vvwAA-M/photo.jpg?sz=128", "display_name": "Duane Lortie", "link": "https://stackoverflow.com/users/4638818/duane-lortie"}, "edited": false, "score": 0, "creation_date": 1479752215, "post_id": 40726052, "comment_id": 68680737, "body": "so.. instead of helping us to answer that question you just create a new account and re-post the same question ?.. that&#39;s rhetorical, I don&#39;t actually want an answer to that."}, {"owner": {"reputation": 9, "user_id": 7190645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfface1e25342f4fef645a7d935b4446?s=128&d=identicon&r=PG&f=1", "display_name": "i1698011", "link": "https://stackoverflow.com/users/7190645/i1698011"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479752221, "post_id": 40726052, "comment_id": 68680739, "body": "@duplode if you would write this code for me, I won&#39;t"}, {"owner": {"reputation": 9, "user_id": 7190645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfface1e25342f4fef645a7d935b4446?s=128&d=identicon&r=PG&f=1", "display_name": "i1698011", "link": "https://stackoverflow.com/users/7190645/i1698011"}, "reply_to_user": {"reputation": 1281, "user_id": 4638818, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-_GNq2cgiDYQ/AAAAAAAAAAI/AAAAAAAAAPE/iIK-vvwAA-M/photo.jpg?sz=128", "display_name": "Duane Lortie", "link": "https://stackoverflow.com/users/4638818/duane-lortie"}, "edited": false, "score": 0, "creation_date": 1479752315, "post_id": 40726052, "comment_id": 68680784, "body": "@DuaneLortie nobody wants! that&#39;s why i every time try to rephrase it"}, {"owner": {"reputation": 9, "user_id": 7190645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfface1e25342f4fef645a7d935b4446?s=128&d=identicon&r=PG&f=1", "display_name": "i1698011", "link": "https://stackoverflow.com/users/7190645/i1698011"}, "reply_to_user": {"reputation": 1281, "user_id": 4638818, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-_GNq2cgiDYQ/AAAAAAAAAAI/AAAAAAAAAPE/iIK-vvwAA-M/photo.jpg?sz=128", "display_name": "Duane Lortie", "link": "https://stackoverflow.com/users/4638818/duane-lortie"}, "edited": false, "score": 0, "creation_date": 1479752387, "post_id": 40726052, "comment_id": 68680824, "body": "@DuaneLortie that&#39;s not about Python, it&#39;s about Haskell"}, {"owner": {"reputation": 1281, "user_id": 4638818, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-_GNq2cgiDYQ/AAAAAAAAAAI/AAAAAAAAAPE/iIK-vvwAA-M/photo.jpg?sz=128", "display_name": "Duane Lortie", "link": "https://stackoverflow.com/users/4638818/duane-lortie"}, "edited": false, "score": 0, "creation_date": 1479752710, "post_id": 40726052, "comment_id": 68680987, "body": "yes, I inked to the wrong one..  Point is, plenty of info and examples if you just search for &quot;haskell multithread&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7190645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfface1e25342f4fef645a7d935b4446?s=128&d=identicon&r=PG&f=1", "display_name": "i1698011", "link": "https://stackoverflow.com/users/7190645/i1698011"}, "edited": false, "score": 0, "creation_date": 1479750422, "post_id": 40726142, "comment_id": 68679812, "body": "thanks! I&#39;ve already read it and even tried some examples. Problem is that I can&#39;t rewrite this parallel example using threads, not &#39;par&#39; and &#39;pseq&#39;. <a href=\"http://www.stolaf.edu/people/rab/pub/PDC/I15/Pi_Integration_SharedMemory_html/Haskell/Haskell.html\" rel=\"nofollow noreferrer\">stolaf.edu/people/rab/pub/PDC/I15/&hellip;</a> That&#39;s what I need: to create N threads and assign different parts of list to them."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 9, "user_id": 7190645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfface1e25342f4fef645a7d935b4446?s=128&d=identicon&r=PG&f=1", "display_name": "i1698011", "link": "https://stackoverflow.com/users/7190645/i1698011"}, "edited": false, "score": 4, "creation_date": 1479751387, "post_id": 40726142, "comment_id": 68680337, "body": "@i1698011 What did you try? Where did it go wrong? I encourage you to open a fresh question with an <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1479749900, "creation_date": 1479749900, "answer_id": 40726142, "question_id": 40726052, "link": "https://stackoverflow.com/questions/40726052/how-to-create-threads-in-haskell/40726142#40726142", "title": "How to create threads in haskell?", "body": "<p>Haskell threads can be spawned using <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Concurrent.html#v:forkIO\" rel=\"noreferrer\"><code>forkIO</code></a>.</p>\n\n<p>I recommend also reading the <a href=\"https://wiki.haskell.org/Concurrency\" rel=\"noreferrer\">GHC concurrency guide</a>, since it has all the relevant pointers.</p>\n"}], "owner": {"reputation": 9, "user_id": 7190645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfface1e25342f4fef645a7d935b4446?s=128&d=identicon&r=PG&f=1", "display_name": "i1698011", "link": "https://stackoverflow.com/users/7190645/i1698011"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 881, "favorite_count": 0, "closed_date": 1479766480, "answer_count": 1, "score": -7, "last_activity_date": 1479749900, "creation_date": 1479749512, "question_id": 40726052, "link": "https://stackoverflow.com/questions/40726052/how-to-create-threads-in-haskell", "closed_reason": "Needs details or clarity", "title": "How to create threads in haskell?", "body": "<p>How to create threads and assign tasks to them? Is there any way to do it, like usage of </p>\n\n<pre><code>thread.start_new_thread ( function, args[, kwargs] )\n</code></pre>\n\n<p>in Python?\nthanks in advance</p>\n"}, {"tags": ["haskell", "overloading"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1479743953, "post_id": 40724139, "comment_id": 68675685, "body": "<a href=\"http://ideone.com/jdnPpO\" rel=\"nofollow noreferrer\">Not reproducible</a>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1479743954, "post_id": 40724139, "comment_id": 68675686, "body": "This code does not cause a <i>duplicate type signatures</i> error."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1479744152, "post_id": 40724139, "comment_id": 68675822, "body": "Aside: this has nothing to do with overloading. <code>exampleFunction</code> is a single function. <code>TypeA (2,3)</code> and <code>TypeB (4,5,6)</code> are different values of the same type, exactly like 2 and 3."}, {"owner": {"reputation": 502, "user_id": 1731195, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/05863adbed3a673ae6a94a9e10527687?s=128&d=identicon&r=PG", "display_name": "Overt_Agent", "link": "https://stackoverflow.com/users/1731195/overt-agent"}, "edited": false, "score": 0, "creation_date": 1479744955, "post_id": 40724139, "comment_id": 68676331, "body": "And now it&#39;s not producing that error. <i>sigh</i> Thanks for the help."}], "answers": [{"comments": [{"owner": {"reputation": 502, "user_id": 1731195, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/05863adbed3a673ae6a94a9e10527687?s=128&d=identicon&r=PG", "display_name": "Overt_Agent", "link": "https://stackoverflow.com/users/1731195/overt-agent"}, "edited": false, "score": 0, "creation_date": 1479744918, "post_id": 40724362, "comment_id": 68676311, "body": "You&#39;re... quite right. It does compile. But it wasn&#39;t compiling half an hour ago... Your advice on data types is good though, thanks you."}], "tags": [], "owner": {"reputation": 52258, "user_id": 375232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/h3OwD.png?s=128&g=1", "display_name": "Landei", "link": "https://stackoverflow.com/users/375232/landei"}, "is_accepted": true, "score": 4, "last_activity_date": 1479744146, "creation_date": 1479744146, "answer_id": 40724362, "question_id": 40724139, "link": "https://stackoverflow.com/questions/40724139/overloading-a-function-with-a-data-type-in-haskell/40724362#40724362", "title": "Overloading a function with a data type in Haskell", "body": "<p>Works for me: </p>\n\n<pre><code>data ExampleType = TypeA (Int, Int) | TypeB (Int, Int, Int)\n\nexampleFunction :: ExampleType -&gt; Int\nexampleFunction (TypeA (a,b)) = a + b\nexampleFunction (TypeB (a,b,c)) = a + c + c\n\nmain = print $ exampleFunction (TypeA (2,3))\n</code></pre>\n\n<p><a href=\"http://ideone.com/jsIBVF\" rel=\"nofollow noreferrer\">http://ideone.com/jsIBVF</a></p>\n\n<p>Note that you typically wouldn't use tuples as components of your type, as this makes it quite hard to get to the data. If you have not a very good reason, simply use \n<code>data ExampleType = TypeA Int Int | TypeB Int Int Int</code></p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1479745236, "post_id": 40724389, "comment_id": 68676521, "body": "Right, though technically nothing is <i>wrong</i> with putting tuples in <code>data</code>. It&#39;s just unnecessary. It may also be slower, especially slower than the strict version <code>DataA !Int !Int | DataB !Int !Int !Int</code>."}], "tags": [], "owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "is_accepted": false, "score": 2, "last_activity_date": 1479745508, "last_edit_date": 1479745508, "creation_date": 1479744224, "answer_id": 40724389, "question_id": 40724139, "link": "https://stackoverflow.com/questions/40724139/overloading-a-function-with-a-data-type-in-haskell/40724389#40724389", "title": "Overloading a function with a data type in Haskell", "body": "<p>Your code should not cause such an error. However there some things wrong with your question. First the use of a tuple is unsusual for a Product type (<code>TypeA (Int, Int)</code>). Instead you would just declare <code>TypeA</code> as a data constructor that takes two arguments of type <code>Int</code> instead of one of type <code>(Int, Int)</code>. Furthermore <code>TypeA</code> and <code>TypeB</code> are not two different types but two different data constructors of the same sum type <code>ExampleType</code>. To reflect that I renamed them to <code>DataA</code> and <code>DataB</code> in the below code.</p>\n\n<pre><code>data ExampleType = DataA Int Int | DataB Int Int Int\nexampleFunction :: ExampleType -&gt; Int\nexampleFunction (DataA x y) = x + y\nexampleFunction (DataB x y z) = x + y + z\n</code></pre>\n"}], "owner": {"reputation": 502, "user_id": 1731195, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/05863adbed3a673ae6a94a9e10527687?s=128&d=identicon&r=PG", "display_name": "Overt_Agent", "link": "https://stackoverflow.com/users/1731195/overt-agent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 40724362, "answer_count": 2, "score": 0, "last_activity_date": 1594748991, "creation_date": 1479743460, "last_edit_date": 1594748991, "question_id": 40724139, "link": "https://stackoverflow.com/questions/40724139/overloading-a-function-with-a-data-type-in-haskell", "title": "Overloading a function with a data type in Haskell", "body": "<p>If I've declared a data type thus:</p>\n<p><code>data ExampleType = TypeA (Int, Int) | TypeB (Int, Int, Int)</code></p>\n<p>How can I declare a function that takes either TypeA or TypeB and performs different operations on that basis? My current attempt is:</p>\n<pre><code>exampleFunction :: ExampleType -&gt; Int\nexampleFunction (TypeA(firstInt, secondInt)) = --Fn body\nexampleFunction (TypeB(firstInt, secondInt, thirdInt)) = --Fn body\n</code></pre>\n<p>But I'm getting a <code>Duplicate type signatures</code> error, so I'm clearly missing something.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1479737113, "post_id": 40721422, "comment_id": 68671006, "body": "You <i>can</i> install stack in the user home directory, without super user privileges. I just added <a href=\"http://stackoverflow.com/a/40721992/745903\">an according answer to the linked question</a>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1479746271, "post_id": 40721422, "comment_id": 68677239, "body": "The question was closed as a duplicate, but I think it&#39;s not. It asks not \u201chow to install stack in <code>&#47;home&#47;username</code>\u201d, but how to install stack on a multi-user system in general."}, {"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 1, "creation_date": 1479919957, "post_id": 40721422, "comment_id": 68764134, "body": "Related issue: <a href=\"https://github.com/commercialhaskell/stack/issues/2205\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/2205</a>"}, {"owner": {"reputation": 445, "user_id": 3834375, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3262d94a862e25fc09204d0511481ce3?s=128&d=identicon&r=PG&f=1", "display_name": "Karl Marklund", "link": "https://stackoverflow.com/users/3834375/karl-marklund"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1480006972, "post_id": 40721422, "comment_id": 68805468, "body": "Exactly @leftaroundabout, my question is: 1) How to install stack on a multi-user system in general and 2) on a multi-user system, are snapshots shared among users?"}], "owner": {"reputation": 445, "user_id": 3834375, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3262d94a862e25fc09204d0511481ce3?s=128&d=identicon&r=PG&f=1", "display_name": "Karl Marklund", "link": "https://stackoverflow.com/users/3834375/karl-marklund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 2, "answer_count": 0, "score": 3, "last_activity_date": 1509983923, "creation_date": 1479735083, "last_edit_date": 1509983923, "question_id": 40721422, "link": "https://stackoverflow.com/questions/40721422/stack-on-a-multi-user-linux-unix-system", "title": "Stack on a multi user Linux/Unix system", "body": "<p>How does stack function when installed on a multi user Linux/Unix system? Will stack share snapshot packages among the users? Any other issues of concerns?</p>\n\n<p>I also found this related question interesting: <a href=\"https://stackoverflow.com/questions/40206135/how-do-i-install-haskell-stack-locally\">How do I install Haskell Stack locally?</a> Is it not possible to install and use stack as a non-root user?</p>\n\n<p><strong>Edit</strong> (2017-11-06): My system admin don't want to install Haskell stack since this will save a lot of data in <code>~/.stack</code> for each user running Haskell stack. This is a real concern since each year we teach Haskell on a course with 130-150 students. To clarify (as in the comments of this question):</p>\n\n<ul>\n<li>Can Haskell stack be installed/used in such a way that snapshots are shared among users?</li>\n</ul>\n"}, {"tags": ["string", "haskell", "integer", "converter"], "comments": [{"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "edited": false, "score": 0, "creation_date": 1479731277, "post_id": 40719997, "comment_id": 68666994, "body": "Take a look at <a href=\"http://stackoverflow.com/questions/919937/convert-string-list-to-int-list\">this</a> which do the inverse (string to int)"}, {"owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 0, "creation_date": 1479735121, "post_id": 40719997, "comment_id": 68669624, "body": "If you have a <a href=\"https://www.haskell.org/hoogle/?hoogle=a+-%3E+String\" rel=\"nofollow noreferrer\">function</a> <code>Int -&gt; String</code> you could make a function <code>[Int] -&gt; [String]</code> using <a href=\"https://www.haskell.org/hoogle/?hoogle=%28a+-%3E+b%29+-%3E+%5Ba%5D+-%3E+%5Bb%5D\" rel=\"nofollow noreferrer\">map</a>` map :: (a -&gt; b) -&gt; [a] -&gt; [b]`"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1479730806, "creation_date": 1479730806, "answer_id": 40720057, "question_id": 40719997, "link": "https://stackoverflow.com/questions/40719997/how-to-convert-list-of-numbers-to-list-of-strings-in-haskell/40720057#40720057", "title": "How to convert list of numbers to list of strings in Haskell", "body": "<p>If you have a function <code>f :: a -&gt; b</code>, then <code>map f :: [a] -&gt; [b]</code> applies <code>f</code> on all the list elements.</p>\n\n<p>The function <code>show</code> can convert \"printable\" types in their string representation. In particular, one of the possible types for <code>show</code> is <code>Int -&gt; String</code>.</p>\n\n<p>Use both tools.</p>\n"}, {"tags": [], "owner": {"reputation": 410, "user_id": 3927886, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/689a75ec29af93dcc938fdbd5f039b54?s=128&d=identicon&r=PG&f=1", "display_name": "RamiroPastor", "link": "https://stackoverflow.com/users/3927886/ramiropastor"}, "is_accepted": false, "score": 0, "last_activity_date": 1479766528, "creation_date": 1479766528, "answer_id": 40730395, "question_id": 40719997, "link": "https://stackoverflow.com/questions/40719997/how-to-convert-list-of-numbers-to-list-of-strings-in-haskell/40730395#40730395", "title": "How to convert list of numbers to list of strings in Haskell", "body": "<p>Using the list monad:</p>\n\n<pre><code>f :: [Int] -&gt; String\nf xs = do \n         x &lt;- xs\n         return $ show x \n</code></pre>\n\n<p>or equivalently:</p>\n\n<pre><code>f' :: [Int] -&gt; [String]\nf' = (&gt;&gt;= return.show)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 575, "user_id": 7183235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84f2c8cde2744e6701f3ec708bf7f737?s=128&d=identicon&r=PG&f=1", "display_name": "madbird", "link": "https://stackoverflow.com/users/7183235/madbird"}, "edited": false, "score": 0, "creation_date": 1618199137, "post_id": 67045803, "comment_id": 118520629, "body": "All the TS was needed is simple <code>map show</code>. What you came up with is a rough equivalent of <code>intercalate &quot;,&quot; . map show</code>. So your answer doesn&#39;t answers the question, and is excessively complicated at the same time. Please pay attention to what was the question about next time :)"}, {"owner": {"reputation": 63, "user_id": 14933807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abss9.png?s=128&g=1", "display_name": "macros", "link": "https://stackoverflow.com/users/14933807/macros"}, "reply_to_user": {"reputation": 575, "user_id": 7183235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84f2c8cde2744e6701f3ec708bf7f737?s=128&d=identicon&r=PG&f=1", "display_name": "madbird", "link": "https://stackoverflow.com/users/7183235/madbird"}, "edited": false, "score": 1, "creation_date": 1618232127, "post_id": 67045803, "comment_id": 118532117, "body": "ops, I&#39;m sorry :) I try only to post a craft approach, but you have right"}, {"owner": {"reputation": 575, "user_id": 7183235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84f2c8cde2744e6701f3ec708bf7f737?s=128&d=identicon&r=PG&f=1", "display_name": "madbird", "link": "https://stackoverflow.com/users/7183235/madbird"}, "edited": false, "score": 0, "creation_date": 1618299140, "post_id": 67045803, "comment_id": 118552697, "body": "There&#39;s nothing wrong with that, please accept my apologies. Your haskell is impressive, I think you could help somebody with their pending questions, let&#39;s forget about this ancient-one :)"}, {"owner": {"reputation": 63, "user_id": 14933807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abss9.png?s=128&g=1", "display_name": "macros", "link": "https://stackoverflow.com/users/14933807/macros"}, "reply_to_user": {"reputation": 575, "user_id": 7183235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84f2c8cde2744e6701f3ec708bf7f737?s=128&d=identicon&r=PG&f=1", "display_name": "madbird", "link": "https://stackoverflow.com/users/7183235/madbird"}, "edited": false, "score": 0, "creation_date": 1618829833, "post_id": 67045803, "comment_id": 118712522, "body": "don&#39;t worry @madbird, I will happy if you remove the downvote :)"}, {"owner": {"reputation": 575, "user_id": 7183235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84f2c8cde2744e6701f3ec708bf7f737?s=128&d=identicon&r=PG&f=1", "display_name": "madbird", "link": "https://stackoverflow.com/users/7183235/madbird"}, "edited": false, "score": 0, "creation_date": 1618829991, "post_id": 67045803, "comment_id": 118712599, "body": "Unfortunately, my downvote is locked until the answer is edited. Add a couple of lines, or, maybe, replace <code>let</code> with <code>where</code>, so I&#39;ll be able to remove my vote."}, {"owner": {"reputation": 63, "user_id": 14933807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abss9.png?s=128&g=1", "display_name": "macros", "link": "https://stackoverflow.com/users/14933807/macros"}, "reply_to_user": {"reputation": 575, "user_id": 7183235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84f2c8cde2744e6701f3ec708bf7f737?s=128&d=identicon&r=PG&f=1", "display_name": "madbird", "link": "https://stackoverflow.com/users/7183235/madbird"}, "edited": false, "score": 0, "creation_date": 1618831048, "post_id": 67045803, "comment_id": 118713025, "body": "Done @madbird :) I preferer to use the following code because I think is more readble"}], "tags": [], "owner": {"reputation": 63, "user_id": 14933807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abss9.png?s=128&g=1", "display_name": "macros", "link": "https://stackoverflow.com/users/14933807/macros"}, "is_accepted": false, "score": 1, "last_activity_date": 1618831008, "last_edit_date": 1618831008, "creation_date": 1618149295, "answer_id": 67045803, "question_id": 40719997, "link": "https://stackoverflow.com/questions/40719997/how-to-convert-list-of-numbers-to-list-of-strings-in-haskell/67045803#67045803", "title": "How to convert list of numbers to list of strings in Haskell", "body": "<p>If you need to write a function to print an element from 0, this could be another solution</p>\n<pre><code>cp_log :: (Show a) =&gt; [a] -&gt; String\n\ncp_log [] = &quot;&quot;\ncp_log [x] = (show x)\ncp_log (x:xs) = (show x) ++ &quot;, &quot; ++ cp_log xs\n</code></pre>\n<p>A complete example can be the following one</p>\n<pre><code>cp_log :: (Show a) =&gt; [a] -&gt; String\n    \ncp_log [] = &quot;&quot;\ncp_log [x] = (show x)\ncp_log (x:xs) = (show x) ++ &quot;, &quot; ++ cp_log xs\n\nquick_sort :: (Ord a) =&gt; [a] -&gt; [a]\nquick_sort [] = []\nquick_sort (x:xs) =\n  let smaller = quick_sort [a | a &lt;- xs, a &lt;= x]\n      bigger = quick_sort [a | a &lt;- xs, a &gt; x]\n  in smaller ++ [x] ++ bigger\n\nmain =\n  let sorted = (quick_sort [4, 5, 3, 2, 4, 3, 2])\n  in putStrLn (cp_log sorted)\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7189220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3fa71a23a35d122f6453012d5e7e320?s=128&d=identicon&r=PG&f=1", "display_name": "Philimon_kf", "link": "https://stackoverflow.com/users/7189220/philimon-kf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5900, "favorite_count": 1, "accepted_answer_id": 40720057, "answer_count": 3, "score": 2, "last_activity_date": 1618831008, "creation_date": 1479730602, "question_id": 40719997, "link": "https://stackoverflow.com/questions/40719997/how-to-convert-list-of-numbers-to-list-of-strings-in-haskell", "title": "How to convert list of numbers to list of strings in Haskell", "body": "<p>How to convert list of numbers to list of strings(one string = one number from list) in Haskell. </p>\n\n<p>[Int] -> [String]</p>\n\n<p>Examples: [1,2,3,4] -> [\"1\",\"2\",\"3\",\"4\"]</p>\n"}, {"tags": ["haskell", "io", "console", "readline"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1479728219, "post_id": 40717014, "comment_id": 68665217, "body": "@Bakuriu Yes, it should be the input buffering as you mention. Note that this buffer is not present in the Haskell application but rather in the terminal (either in the OS kernel or in a terminal emulator). By default, a terminal echoes each key and moves the cursor as usual, without any interaction with the application. An application can ask the terminal to change this default behavior, and indeed ncurses is a common way to do that."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1479752146, "post_id": 40717014, "comment_id": 68680713, "body": "@Bakuriu Buffering is only tangentially related: the real problem here is echoing. In my answer I <i>also</i> turn off buffering, but not to prevent the newline from appearing; rather, it is to allow everything else to appear at once rather than at buffer-sized chunks!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1479752401, "post_id": 40717014, "comment_id": 68680828, "body": "@Andrei If you&#39;re like me, this problem might have caused you to wonder exactly what&#39;s going on and what behaviors are configurable. You can read a lot more about it at <a href=\"http://www.linusakesson.net/programming/tty/\" rel=\"nofollow noreferrer\">The TTY demystified</a>, though I warn you: if you just want to Get Things Done, this is going to be way more information than you wanted!"}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1479751986, "post_id": 40726705, "comment_id": 68680637, "body": "N.B. Depending on what behavior you want, you may want to check for EOF in <code>myGetLine</code>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1479752594, "last_edit_date": 1479752594, "creation_date": 1479751890, "answer_id": 40726705, "question_id": 40717014, "link": "https://stackoverflow.com/questions/40717014/how-to-readline-in-haskell-without-transfer-to-the-next-line/40726705#40726705", "title": "How to readline in Haskell without transfer to the next line?", "body": "<p>When you press enter -- as when you press any other key -- it is printed to the screen. You can turn off this behavior with <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/System-IO.html#v:hSetEcho\" rel=\"nofollow noreferrer\"><code>hSetEcho</code></a>:</p>\n\n<pre><code>main = do\n    hSetEcho stdin False\n    readEvalPrintLoop\n</code></pre>\n\n<p>However, if you do so, you will find this has some collateral damage: the enter is no longer echoed, but neither is anything else you type, so it looks like everything you enter is invisible! You can fix this by implementing your modified echo strategy manually. You will need to do two things: set the input stream to an unbuffered mode with <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/System-IO.html#v:hSetBuffering\" rel=\"nofollow noreferrer\"><code>hSetBuffering</code></a> (so that you receive input immediately, rather than at end-of-line) and print each non-enter character you receive. So:</p>\n\n<pre><code>myGetLine :: IO String\nmyGetLine = do\n    c &lt;- getChar\n    case c of\n        '\\n' -&gt; return \"\" -- don't echo newlines\n        _ -&gt; do\n            putChar c -- do echo everything else\n            fmap (c:) myGetLine\n\nreadEvalPrintLoop :: IO()\nreadEvalPrintLoop = do\n    line &lt;- myGetLine -- getLine changed to myGetLine\n    case line of\n            \"bye\" -&gt; return ()\n            line   -&gt; do putStrLn $ interpret line\n                         readEvalPrintLoop\n\nmain = do\n    hSetEcho stdin False\n    hSetBuffering stdin NoBuffering\n    readEvalPrintLoop\n</code></pre>\n"}], "owner": {"reputation": 1135, "user_id": 5856795, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FBHGD.png?s=128&g=1", "display_name": "Andrei", "link": "https://stackoverflow.com/users/5856795/andrei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 613, "favorite_count": 2, "accepted_answer_id": 40726705, "answer_count": 1, "score": 2, "last_activity_date": 1525790935, "creation_date": 1479721272, "last_edit_date": 1525790935, "question_id": 40717014, "link": "https://stackoverflow.com/questions/40717014/how-to-readline-in-haskell-without-transfer-to-the-next-line", "title": "How to readline in Haskell without transfer to the next line?", "body": "<p>I am trying to use readline in Haskell without transfer cursor to the next line.</p>\n\n<p>For example, I wrote the following code:</p>\n\n<pre><code>readEvalPrintLoop :: IO()\nreadEvalPrintLoop = do\n    line &lt;- getLine\n    case line of\n            \"bye\" -&gt; return ()\n            line   -&gt; do putStrLn $ interpret line\n                         readEvalPrintLoop\n</code></pre>\n\n<p>After starting the program:</p>\n\n<pre><code>&gt; 1 2 + . &lt;enter&gt;\n3\n</code></pre>\n\n<p>But I want <strong>to find the easiest way to get follow</strong>:</p>\n\n<pre><code>&gt; 1 2 + . &lt;enter&gt; 3\n</code></pre>\n"}, {"tags": ["haskell", "monads", "typeclass", "category-theory"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1479720297, "post_id": 40716239, "comment_id": 68660450, "body": "Do you have some particular example type that permits an <code>Absorb</code> instance but no sufficiently powerful standard instances to implement <code>(&gt;&gt;~)</code> and <code>ajoin</code> with?"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1479720749, "post_id": 40716239, "comment_id": 68660706, "body": "@leftaroundabout, I need <code>Absorb</code> in order to implement generalized monadic folding that allows to keep an accumulator in the <code>f</code> functor, but return the result in the <code>m</code> monad. See e.g. <a href=\"https://github.com/effectfully/prefolds/blob/374257b12f9a2af752862addafe456cded9c0efb/test/Main.hs#L297\" rel=\"nofollow noreferrer\">this</a>."}], "answers": [{"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1479724873, "post_id": 40717464, "comment_id": 68663243, "body": "&quot;which category would have functions of type <code>f a -&gt; m b</code> as arrows&quot; \u2014 I don&#39;t know about arrows, but aren&#39;t these objects in the comma category of two endofunctors on <code>Hask</code>: <code>f</code> and <code>m</code>? No idea what it gives us, though. <code>compAbsorb</code> is very unsatisfying for me: for one, I don&#39;t want <code>f b -&gt; m c</code> to be a monad morphism as my <code>f</code> has a rather dummy monad instance, for two, my use case (see the comment under the question) doesn&#39;t require going from <code>m</code> to <code>f</code> and I don&#39;t want to impose that. Thanks for the answer, it has clarified some things to me."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1479731413, "post_id": 40717464, "comment_id": 68667078, "body": "@user3237465 Looking at your code seems to confirm your expectations. In particular, trying to do the &quot;obvious&quot; thing by trying <code>idAbsorb = slift</code> and <code>compAbsorb = g . runDriveT . f</code> falls at the first hurdle -- <code>compAbsorb idAbsorb f</code> is not <code>f</code> (it changes <code>Stop</code> into <code>More</code>), and so we don&#39;t even have a category. Going from <code>DriveT m</code> to <code>m</code> causes trouble, and, as you say, it makes little sense to do that during composition in your use case. By the way, note that your <code>(&gt;~&gt;)</code> is neither <code>(&gt;=&gt;)</code> nor <code>flip compAbsorb</code>, which seems to confirm that you want something else indeed."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 4, "last_activity_date": 1479728820, "last_edit_date": 1479728820, "creation_date": 1479722597, "answer_id": 40717464, "question_id": 40716239, "link": "https://stackoverflow.com/questions/40716239/what-is-this-thing-similar-to-kleislifunctor/40717464#40717464", "title": "What is this thing similar to KleisliFunctor?", "body": "<p><em>This is a speculative answer. Proceed with caution.</em></p>\n\n<p>Let's first consider <code>KleisliFunctor</code>, focusing on the bind-like arrow mapping:</p>\n\n<pre><code>class (Monad m, Functor f) =&gt; KleisliFunctor m f where\n  kmap :: (a -&gt; m b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>For this to actually be a functor from the Kleisli category of <code>m</code> to <strong>Hask</strong>, <code>kmap</code> has to follow the relevant functor laws:</p>\n\n<pre><code>-- Mapping the identity gives identity (in the other category).\nkmap return = id\n-- Mapping a composed arrow gives a composed arrow (in the other category).\nkmap (g &lt;=&lt; f) = kmap g . kmap f\n</code></pre>\n\n<p>The fact that there are two <code>Functor</code>s involved makes things a little unusual, but not unreasonable -- for instance, the laws do hold for <code>mapMaybe</code>, which is the first concrete example the <code>KleisliFunctor</code> post alludes to. </p>\n\n<p>As for <code>Absorb</code>, I will flip the bind-like method for the sake of clarity:</p>\n\n<pre><code>class (Functor f, Monad m) =&gt; Absorb f m where\n  (~&lt;&lt;) :: (a -&gt; m b) -&gt; f a -&gt; m b\n</code></pre>\n\n<p>If we are looking for something analogous to <code>KleisliFunctor</code>, a question that immediately arises is which category would have functions of type <code>f a -&gt; m b</code> as arrows. It certainly cannot be <strong>Hask</strong>, as its identity (of type <code>f a -&gt; m a</code>) cannot be <code>id</code>. We would have to figure out not only identity but also composition. For something that is not entirely unlike <code>Monad</code>...</p>\n\n<pre><code>idAbsorb :: f a -&gt; m a\ncompAbsorb :: (f b -&gt; m c) -&gt; (f a -&gt; m b) -&gt; (f a -&gt; m c)\n</code></pre>\n\n<p>... the only plausible thing I can think of right now is having a monad morphism as <code>idAbsorb</code> and using a second monad morphism in the opposite direction (that is, from <code>m</code> to <code>f</code>) so that <code>compAbsorb</code> can be implemented by applying the first function, then going back to <code>f</code> and finally applying the second function. We would need to work that out in order to see if my assumptions are appropriate, if this approach works, and if it leads to something useful for your purposes.</p>\n"}], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1479728820, "creation_date": 1479718966, "question_id": 40716239, "link": "https://stackoverflow.com/questions/40716239/what-is-this-thing-similar-to-kleislifunctor", "title": "What is this thing similar to KleisliFunctor?", "body": "<p>Here is how we can define <a href=\"https://elvishjerricco.github.io/2016/10/12/kleisli-functors.html\" rel=\"noreferrer\"><code>KleisliFunctor</code></a>:</p>\n\n<pre><code>class (Monad m, Functor f) =&gt; KleisliFunctor m f where\n  kmap :: (a -&gt; m b) -&gt; f a -&gt; f b\n  kmap f = kjoin . fmap f\n\n  kjoin :: f (m a) -&gt; f a\n  kjoin = kmap id\n</code></pre>\n\n<p>Does this type class</p>\n\n<pre><code>class (Functor f, Monad m) =&gt; Absorb f m where\n  (&gt;&gt;~) :: f a -&gt; (a -&gt; m b) -&gt; m b\n  a &gt;&gt;~ f = ajoin $ fmap f a\n\n  ajoin :: f (m a) -&gt; m a\n  ajoin a = a &gt;&gt;~ id\n</code></pre>\n\n<p>fit somewhere into category theory? What are the laws? Are they</p>\n\n<pre><code>a &gt;&gt;~ g . f     === fmap f a &gt;&gt;~ g\na &gt;&gt;~ (f &gt;=&gt; g) === a &gt;&gt;~ f &gt;&gt;= g\n</code></pre>\n\n<p>?</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1479716462, "post_id": 40715142, "comment_id": 68658486, "body": "Always include the <i>expected</i> output if the output isn&#39;t what you expect. Also, if possible, localize the problem. Aaaaaand don&#39;t use <code>Float</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479716549, "post_id": 40715142, "comment_id": 68658544, "body": "Speaking of output: the MacLaurin series formula is okay, but please paste the output of your program as text, and not as an image."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1479717986, "post_id": 40715142, "comment_id": 68659236, "body": "By the way, if you&#39;re able to fix your problem, I <b>strongly</b> suggest you to have your code reviewed at <a href=\"https://codereview.stackexchange.com\">Code Review</a> later on (as soon as it works)."}], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479717503, "post_id": 40715740, "comment_id": 68659018, "body": "&quot;Even better, don&#39;t recalculate the whole fraction in every step, instead update the nominator and denominator, then your values won&#39;t get too large for&quot; -- In support of this point, it is worth noting that not even <code>Double</code> is enough for the factorial of 261 (as in <code>fromIntegral (f (2*130+1))</code>). While that doesn&#39;t lead to an immediately visible error, it does make all terms with <code>k</code> larger than 16 zero, given that dividing by <code>Infinity</code> results in zero."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1479717941, "post_id": 40715740, "comment_id": 68659218, "body": "@duplode funny enough, this exact formula was the one we had to implement in our C programming crash course. And since C doesn&#39;t have arbitrary large integral numbers, we had to come up with that &quot;trick&quot; ourselves. Ah\u2026 Good times."}, {"owner": {"reputation": 60, "user_id": 4757047, "user_type": "registered", "profile_image": "https://graph.facebook.com/427029907464924/picture?type=large", "display_name": "Andr&#233;s Campos Hern&#225;ndez", "link": "https://stackoverflow.com/users/4757047/andr%c3%a9s-campos-hern%c3%a1ndez"}, "edited": false, "score": 0, "creation_date": 1479748833, "post_id": 40715740, "comment_id": 68678891, "body": "THANK YOU VERY MUCH! I just changed from Float to Double, now it&#39;s working perfectly."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 1, "last_activity_date": 1479717077, "creation_date": 1479717077, "answer_id": 40715740, "question_id": 40715142, "link": "https://stackoverflow.com/questions/40715142/recursive-calculus-of-sine-not-working/40715740#40715740", "title": "Recursive calculus of sine not working", "body": "<p>Single point arithmetic isn't accurate enough for to calculate a trigonometric function. The exponent doesn't have enough bits for the large, intermediate numbers in <code>sinusr</code>. Or, to be blunt, the following number doesn't fit a <code>Float</code>:</p>\n\n<pre><code>ghci&gt; 2 ^ 130 :: Float\nInfinity\n</code></pre>\n\n<p>As soon as you hit the boundaries of floating point numbers (<code>-Infinity</code>, <code>Infinity</code>) you usually end up with either those or <code>NaN</code>.</p>\n\n<p>Use <code>Double</code> instead. Your implementation of lisp <em>probably</em> uses double point precision floating point numbers too. Even better, don't recalculate the whole fraction in every step, instead update the nominator and denominator, then your values won't get too large for <code>Float</code>.</p>\n"}], "owner": {"reputation": 60, "user_id": 4757047, "user_type": "registered", "profile_image": "https://graph.facebook.com/427029907464924/picture?type=large", "display_name": "Andr&#233;s Campos Hern&#225;ndez", "link": "https://stackoverflow.com/users/4757047/andr%c3%a9s-campos-hern%c3%a1ndez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 40715740, "answer_count": 1, "score": 0, "last_activity_date": 1479718200, "creation_date": 1479714544, "last_edit_date": 1479718200, "question_id": 40715142, "link": "https://stackoverflow.com/questions/40715142/recursive-calculus-of-sine-not-working", "title": "Recursive calculus of sine not working", "body": "<p>I'm learning Haskell and I have been practising doing some functions by myself, in this functions are included the calculus of sine using recursion, but I get strange results.</p>\n\n<p>The formula I'm using to calculate the sine is this one:</p>\n\n<p><img src=\"https://i.stack.imgur.com/OrNZT.png\" alt=\"Maclaurin series\"></p>\n\n<p>And my code is this:</p>\n\n<pre><code>--Returns n to power p\npow :: Float-&gt;Integer-&gt;Float\npow n p = \n   if p == 0 then \n      1\n   else\n      if p == 1 then\n         n\n      else\n         n * (pow n (p-1))\n\n--Finds a number's factorial\nf :: Integer-&gt;Integer\nf n =\n   if n == 1 then\n      n\n   else \n      n * (f (n-1))\n\n--TODO: Trigonometric functions ( :v I'll do diz 2)\nsinus :: Float-&gt;Char-&gt;Float\nsinus n deg = \n   if(deg == 'd')then\n      sinusr 0 (normalize (torad n)) 0 \n   else\n      sinusr 0 (normalize n) 0 \n\n--Get the value equivalent to radians of the presented degrees\ntorad :: Float-&gt;Float\ntorad v = ( (v * pi) / 180 )\n\n--Recursive to get the value of the entering radians\nsinusr :: Integer-&gt;Float-&gt;Float-&gt;Float\nsinusr k x result = \n  if k == 130 then\n   result + ( ((pow (-1) k ) * ((pow x ((2*k)+1))) / (fromIntegral (f ((2*k)+1)))))\n  else\n   result + (sinusr (k+1) x ( ((pow (-1) k ) * ((pow x ((2*k)+1))) / (fromIntegral (f ((2*k)+1))))))\n\n--Subtracts pi/2 the necessary times to get a value minor or equals to pi/2 :v\nnormalize :: Float-&gt;Float\nnormalize a = a - (fromIntegral (truncate (a / (pi*2)))*(pi*2))\n</code></pre>\n\n<p>For example, the output it's this:</p>\n\n<pre><code>*Main&gt; sinus 1 'd'\n1.7452406e-2\n*Main&gt; sinus 1 's'\n0.84147096\n*Main&gt; sinus 2 's'\nNaN\n*Main&gt; sinus 2 'd'\n3.4899496e-2\n</code></pre>\n\n<p>Can someone tell me why it is showing me that?\nI have worked the same logic with Lisp, and it runs perfectly, I just had to figure out the Haskell syntax, but as you can see, it is not working as it must be.\nBeforehand, thank you very much.</p>\n"}, {"tags": ["macos", "haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 6152, "user_id": 53974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a676c96a88feb813010e67af012ca0?s=128&d=identicon&r=PG", "display_name": "Blaisorblade", "link": "https://stackoverflow.com/users/53974/blaisorblade"}, "edited": false, "score": 0, "creation_date": 1479767996, "post_id": 40713673, "comment_id": 68688649, "body": "Coming from the Stack bugtracker. Shared libraries on OS X have <code>.dylib</code> extension, not <code>.so</code>, so I&#39;d guess there&#39;s no way to do that. I assume this is enforced by GHC. So the first question is, why are you installing a <code>.so</code> file on OS X? Then, if that <code>.so</code> is a Haskell library this is a bad setup, if it&#39;s any other library it just has a non-portable build script."}, {"owner": {"reputation": 6152, "user_id": 53974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a676c96a88feb813010e67af012ca0?s=128&d=identicon&r=PG", "display_name": "Blaisorblade", "link": "https://stackoverflow.com/users/53974/blaisorblade"}, "edited": false, "score": 0, "creation_date": 1479768667, "post_id": 40713673, "comment_id": 68688891, "body": "Partial retraction: <a href=\"http://stackoverflow.com/a/2339910/53974\">stackoverflow.com/a/2339910/53974</a> suggests that <code>.so</code> is common (but non-standard) for <i>loadable modules/bundles</i>, which you can&#39;t link against (they&#39;re supposed to be loaded at runtime). But again, &quot;It is not possible to link against bundles as if they were shared libraries.&quot; So if <i>that&#39;s</i> the case, what you&#39;re trying to do isn&#39;t supposed to work, even though this might not be your doing."}], "answers": [{"comments": [{"owner": {"reputation": 410, "user_id": 2805751, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/22fc46808863bebbaf410616ea630332?s=128&d=identicon&r=PG&f=1", "display_name": "user2805751", "link": "https://stackoverflow.com/users/2805751/user2805751"}, "edited": false, "score": 1, "creation_date": 1479769096, "post_id": 40730768, "comment_id": 68689060, "body": "Thanks for the reply: &quot;might be simply using the wrong extension for shared libraries.&quot; Is likely the culprit, though it&#39;s not my package and it&#39;s not a simple package.  I&#39;ll see if renaming all of them gets any joy."}, {"owner": {"reputation": 6152, "user_id": 53974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a676c96a88feb813010e67af012ca0?s=128&d=identicon&r=PG", "display_name": "Blaisorblade", "link": "https://stackoverflow.com/users/53974/blaisorblade"}, "reply_to_user": {"reputation": 410, "user_id": 2805751, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/22fc46808863bebbaf410616ea630332?s=128&d=identicon&r=PG&f=1", "display_name": "user2805751", "link": "https://stackoverflow.com/users/2805751/user2805751"}, "edited": false, "score": 0, "creation_date": 1479822597, "post_id": 40730768, "comment_id": 68712709, "body": "I imagined. Please consider upvoting or accepting ;-)."}, {"owner": {"reputation": 410, "user_id": 2805751, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/22fc46808863bebbaf410616ea630332?s=128&d=identicon&r=PG&f=1", "display_name": "user2805751", "link": "https://stackoverflow.com/users/2805751/user2805751"}, "edited": false, "score": 1, "creation_date": 1480013004, "post_id": 40730768, "comment_id": 68808048, "body": "Changing all the names did not work because of some linking quirk I don&#39;t understand.  In the end, the maintainer changed the build script to generate <code>.so</code> and <code>.dylib</code> files on OSX.  This fixed it."}], "tags": [], "owner": {"reputation": 6152, "user_id": 53974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a676c96a88feb813010e67af012ca0?s=128&d=identicon&r=PG", "display_name": "Blaisorblade", "link": "https://stackoverflow.com/users/53974/blaisorblade"}, "is_accepted": false, "score": 1, "last_activity_date": 1479768264, "last_edit_date": 1495535418, "creation_date": 1479768264, "answer_id": 40730768, "question_id": 40713673, "link": "https://stackoverflow.com/questions/40713673/force-stack-to-look-for-so-files-instead-of-dylib-on-os-x/40730768#40730768", "title": "Force Stack to look for .so files instead of .dylib on OS X?", "body": "<blockquote>\n  <p>If I rename the root file to .dylib stack can find it but then fails to find the other linked files, all of which are expected to be .dylib.</p>\n</blockquote>\n\n<p>I'd suggest renaming all libraries to <code>.dylib</code>, using either <a href=\"https://stackoverflow.com/a/14887391/53974\">https://stackoverflow.com/a/14887391/53974</a> or maybe <a href=\"https://www.tekrevue.com/tip/batch-rename-files-os-x-yosemite/\" rel=\"nofollow noreferrer\">https://www.tekrevue.com/tip/batch-rename-files-os-x-yosemite/</a> or other google results. I can't tell whether it works because it depends on how buggy the build script producing the libraries is, but your result suggest the build script might be simply using the wrong extension for shared libraries.</p>\n"}], "owner": {"reputation": 410, "user_id": 2805751, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/22fc46808863bebbaf410616ea630332?s=128&d=identicon&r=PG&f=1", "display_name": "user2805751", "link": "https://stackoverflow.com/users/2805751/user2805751"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1479768264, "creation_date": 1479707984, "question_id": 40713673, "link": "https://stackoverflow.com/questions/40713673/force-stack-to-look-for-so-files-instead-of-dylib-on-os-x", "title": "Force Stack to look for .so files instead of .dylib on OS X?", "body": "<p>I have a locally built <code>stack</code> project that copies an <code>lib_.so</code> to a shared lib directory in El Capitan.  This shared object is itself linked to a number of others, all of which are <code>.so</code> files.  I have another <code>stack</code> project that references the first project as a local dependency and expects to find the shared library that it copies to the said directory, except that stack looks for <code>lib_.dylib</code> in the shared directory and not <code>lib_.so</code>. It predicably fails to find the file. </p>\n\n<p>Is there a way to tell stack that it should use the <code>.so</code> files?  If I rename the root file to <code>.dylib</code> stack can find it but then fails to find the other linked files, all of which are expected to be <code>.dylib</code>.</p>\n"}, {"tags": ["haskell", "hakyll"], "answers": [{"tags": [], "owner": {"reputation": 4630, "user_id": 160386, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b6044f355342bb055fbb03804d9673e3?s=128&d=identicon&r=PG", "display_name": "Jan Tojnar", "link": "https://stackoverflow.com/users/160386/jan-tojnar"}, "is_accepted": false, "score": 4, "last_activity_date": 1479705876, "creation_date": 1479705876, "answer_id": 40713294, "question_id": 40712920, "link": "https://stackoverflow.com/questions/40712920/how-to-use-partials-inside-markdown/40713294#40713294", "title": "How to use partials inside markdown?", "body": "<p>Partials are only recognised inside templates. You would need to compile the posts with <a href=\"https://www.stackage.org/haddock/nightly-2016-11-19/hakyll-4.9.1.0/Hakyll-Web-Template.html#v:templateCompiler\" rel=\"nofollow noreferrer\"><code>templateCompiler</code></a> or by using <a href=\"https://www.stackage.org/haddock/nightly-2016-11-19/hakyll-4.9.1.0/Hakyll-Web-Template.html#v:applyAsTemplate\" rel=\"nofollow noreferrer\"><code>applyAsTemplate</code></a>. You can see it in the example\u2019s <a href=\"https://github.com/jaspervdj/hakyll/blob/32e34f435c7911f36acdf4a62eec1f56faf0b269/data/example/site.hs#L55\" rel=\"nofollow noreferrer\"><code>index.html</code> compilation</a>.</p>\n\n<p><code>applyAsTemplate</code> is especially useful when you also want to transform the text some more, for example to process markdown:</p>\n\n<pre><code>compile $ do\n    getResourceString\n        &gt;&gt;= applyAsTemplate someContext -- e.g. defaultContext\n        &gt;&gt;= renderPandoc\n        &gt;&gt;= loadAndApplyTemplate \"templates/default.html\" indexCtx\n        &gt;&gt;= relativizeUrls\n</code></pre>\n"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1479705876, "creation_date": 1479703391, "question_id": 40712920, "link": "https://stackoverflow.com/questions/40712920/how-to-use-partials-inside-markdown", "title": "How to use partials inside markdown?", "body": "<p>I'm just starting out with Hakyll and am working with the default site that comes with <code>hakyll init</code>. I tried putting the following in <code>2015-08-12.spqr.markdown</code>:</p>\n\n<pre><code>$partial(\"includes/DB.hs\")$\n</code></pre>\n\n<p>It didn't work as expected - the post just showed the literal text <code>$partial(\"includes/DB.hs\")$</code>. It didn't pull in the content of <code>includes/DB.hs</code> into the post. Then I tried adding the following to <code>site.hs</code>, but even this didn't work:</p>\n\n<pre><code>match \"includes/*\" $ compile templateBodyCompiler\n</code></pre>\n\n<p>What am I missing?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 422, "user_id": 2365673, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/5vpMC.jpg?s=128&g=1", "display_name": "goromlagche", "link": "https://stackoverflow.com/users/2365673/goromlagche"}, "is_accepted": false, "score": 2, "last_activity_date": 1493709055, "creation_date": 1493709055, "answer_id": 43732128, "question_id": 40711548, "link": "https://stackoverflow.com/questions/40711548/websockets-and-redis-pubsub/43732128#43732128", "title": "Websockets and Redis pubsub", "body": "<p>In case anyone comes wondering to this post, I recently implemented a basic <a href=\"https://hackage.haskell.org/package/hedis\" rel=\"nofollow noreferrer\">hedis</a> and <a href=\"https://hackage.haskell.org/package/websockets\" rel=\"nofollow noreferrer\">websockets</a> app. A simple implementation would be run a hedis subscriber in a thread and a websocket in another thread and communicate via TChan.</p>\n\n<p>Some sample code</p>\n\n<pre><code>main = do\n  chan &lt;- atomically $ newTChan\n  a &lt;- forkIO (subscribeProc chan)\n  b &lt;- forkIO (webSock chan)\n  -- wait for a and b\n\n-- Hedis subscriber\nsubscribeProc :: TChan B.ByteString -&gt; IO ()\nsubscribeProc chan = do\n  conn &lt;- connect defaultConnectInfo\n  pubSubCtrl &lt;- newPubSubController [(\"redis-channel\", chanHandler chan)] []\n  forever $\n    pubSubForever conn pubSubCtrl onInitialComplete\n    `catch` (\\(e :: SomeException) -&gt; do\n                Prelude.putStrLn $ \"Got error: \" ++ show e\n                threadDelay $ 60*1000)\n\n\nchanHandler :: TChan B.ByteString -&gt; B.ByteString -&gt; IO ()\nchanHandler chan msg =\n  atomically $ writeTChan chan (msg)\n\nonInitialComplete :: IO ()\nonInitialComplete = putStrLn\n  \"Redis acknowledged that mychannel is now subscribed\"\n\n\n-- websocket\nwebSock :: TChan B.ByteString -&gt; IO ()\nwebSock chan = do\n  WS.runServer appHost appPort $ handleConnection chan\n\nhandleConnection :: TChan B.ByteString -&gt; WS.PendingConnection -&gt; IO ()\nhandleConnection chan pending = do\n  connection &lt;- WS.acceptRequest pending\n  loop chan connection\n  where\n    loop chan connection = do\n      msg &lt;- atomically $ readTChan chan\n      putStrLn $ \"got data \" ++ show msg\n      WS.sendTextData connection msg\n      loop chan connection\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6307701"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493709055, "creation_date": 1479691748, "question_id": 40711548, "link": "https://stackoverflow.com/questions/40711548/websockets-and-redis-pubsub", "title": "Websockets and Redis pubsub", "body": "<p>Does anybody know where I can find an example of using wai-websockets with Redis pub-sub to send real-time notifications to the clients?</p>\n\n<p>I have read the hacakge documentation for <a href=\"https://hackage.haskell.org/package/wai-websockets\" rel=\"nofollow noreferrer\">wai-websockets</a> and <a href=\"https://hackage.haskell.org/package/hedis\" rel=\"nofollow noreferrer\">hedis</a>, but I am still unclear how I can combine the two to achieve the desired result.</p>\n"}, {"tags": ["haskell", "big-o"], "answers": [{"comments": [{"owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "edited": false, "score": 0, "creation_date": 1479747541, "post_id": 40711984, "comment_id": 68678091, "body": "I like this answer! Do you know of any good resources that discuss techniques to identify and improve run-time performance? I&#39;ve gone over the basics of big o, but haven&#39;t found anything that discusses the strategies to maximizing run-time efficiency?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "edited": false, "score": 1, "creation_date": 1479755871, "post_id": 40711984, "comment_id": 68682487, "body": "@BabraCunningham [1/2] That can be a pretty broad topic. A good slice of it amounts to knowing your algorithms and, crucially, your data structures. Relevant sources range from the documentation of libraries and brief overviews of common choices of data structures (such as <a href=\"https://en.wikibooks.org/wiki/Haskell/Libraries/Data_structures_primer\" rel=\"nofollow noreferrer\">this</a> and <a href=\"http://stackoverflow.com/q/9611904/2751851\">this</a>), to <a href=\"http://stackoverflow.com/q/1990464/2751851\">in-depth discussion</a> of how said data structures are implemented."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "edited": false, "score": 1, "creation_date": 1479756140, "post_id": 40711984, "comment_id": 68682617, "body": "@BabraCunningham [2/2] Another related topic is the assortment of practical tricks you will want to use when, at some point in the future, you find yourself having to debug performance issues. <a href=\"http://book.realworldhaskell.org/read/profiling-and-optimization.html\" rel=\"nofollow noreferrer\">Chapter 25 of <i>Real World Haskell</i></a> and <a href=\"http://blog.ezyang.com/2011/05/anatomy-of-a-thunk-leak/\" rel=\"nofollow noreferrer\"><i>Anatomy of a thunk leak</i></a> (plus related posts in Edward Z. Yang&#39;s blog) are two links you will want to save for later."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 1, "last_activity_date": 1479696064, "creation_date": 1479696064, "answer_id": 40711984, "question_id": 40711064, "link": "https://stackoverflow.com/questions/40711064/identifying-run-time-complexity-big-o-of-frequency-function/40711984#40711984", "title": "Identifying run time complexity (big o) of frequency function?", "body": "<p>I will assume that you will pass <code>removeDuplicates</code> to <code>frequency</code> and work with this slightly modified version of your code:</p>\n\n<pre><code>frequency :: (Eq a) =&gt; [a] -&gt; [(a, Int)]\nfrequency li = removeDuplicates $ map (\\el -&gt; (el, indexes el)) li\n    where\n    indexes el = length $ findIndices (== el) li\n\nremoveDuplicates :: (Eq a) =&gt; [(a, Int)] -&gt; [(a, Int)]\nremoveDuplicates [] = []\nremoveDuplicates ((x1, x2) : xs) =\n    (x1, x2) : removeDuplicates (filter (\\(y1, y2) -&gt; x1 /= y1) xs)\n</code></pre>\n\n<p>Let's look at what each part of <code>frequency</code> is doing:</p>\n\n<blockquote>\n<pre><code>map (\\el -&gt; (el, indexes el)) li\n</code></pre>\n</blockquote>\n\n<p>As you allude to, <code>map f li</code> is, in principle, <em>O(n)</em> in the length of the list <code>li</code>. That, however, only holds if the complexity of <code>f</code> does not depend on <code>li</code>. For that reason, we need to double-check the function being mapped:</p>\n\n<blockquote>\n<pre><code>\\el -&gt; (el, indexes el)\n</code></pre>\n</blockquote>\n\n<p>Substituting the definition of <code>indexes</code>, we get:</p>\n\n<pre><code>\\el -&gt; (el, length $ findIndices (== el) li)\n</code></pre>\n\n<p><code>findIndices</code> is <em>O(n)</em> in the length of the list, as it needs to test each element, and so the complexity of this function is at least <em>O(n)</em> in the length of <code>li</code>. <code>length</code> is also linear in the length of the list, which means that in the worst case (that is, when all elements are equal to <code>el</code>) it will also be <em>O(n)</em> in the length of <code>li</code>. Given that <code>findIndices</code> is already <em>O(n)</em>, length doesn't affect the overall complexity. Finally, the creation of the pair, which is the final step, is constant time and unproblematic. </p>\n\n<p>We can thus conclude <code>\\el -&gt; (el, indexes el)</code> is <em>O(n)</em> in the length of <code>li</code>. That being so, <code>map (\\el -&gt; (el, indexes el)) li</code> is actually <em>O(n^2)</em> in the length of <code>li</code>, as it performs an <em>O(n)</em> operation <em>n</em> times.</p>\n\n<blockquote>\n<pre><code>removeDuplicates\n</code></pre>\n</blockquote>\n\n<p>Let's focus on the recursive case:</p>\n\n<pre><code>(x1, x2) : removeDuplicates (filter (\\(y1, y2) -&gt; x1 /= y1) xs)\n</code></pre>\n\n<p>The key operation here is the filtering, which is <em>O(n)</em> in the length of <code>xs</code>. The filtering is done once per element of <code>li</code>. Now, even though <code>xs</code> gets shorter as we move towards the end of the list, the average length of <code>xs</code> is proportional to the length of <code>li</code>. That being so, we are once more performing an <em>O(n)</em> operation (in the length of <code>li</code>) <em>n</em> times, which means <code>removeDuplicates</code> is <em>O(n^2)</em> -- just like <code>nub</code> from <code>Data.List</code>. (Another way of reaching the same conclusion would be noticing that <code>removeDuplicates</code> compares each element with every other element, resulting in <em>n*(n-1)/2</em> comparisons.)  </p>\n\n<blockquote>\n<pre><code>frequency li = removeDuplicates $ map (\\el -&gt; (el, indexes el)) li\n</code></pre>\n</blockquote>\n\n<p><code>frequency</code> consists of an <em>O(n^2)</em> operation followed by another <em>O(n^2)</em> operation; therefore, it is <em>O(n^2)</em> in the length of the list.</p>\n\n<hr>\n\n<blockquote>\n  <p>Is there a O(1) method of performing the same function?</p>\n</blockquote>\n\n<p><em>O(1)</em> is impossible, as there is no getting around the need to do <em>something</em> to <em>each</em> element of the list. It is certainly possible to do better than <em>O(n^2)</em>, though. For instance, by sorting the list you would avoid the need of comparing each element with all others (as happens both in <code>map (\\el -&gt; (el, indexes el)) li</code> and <code>removeDuplicates</code>), as in a sorted list only elements next to each other might possibly be equal. For a concrete example, this function...</p>\n\n<pre><code>group . sort\n</code></pre>\n\n<p>... is <em>O(n*log(n))</em> (<code>sort</code> from <code>Data.List</code> is <em>O(n*log(n))</em>, and <code>group</code> is <em>O(n)</em>, as it only needs to compare each element to the next one).</p>\n\n<p>P.S.: This is probably beside the point for what you are trying to do, but for something entirely different, you might want to experiment with using a <a href=\"https://hackage.haskell.org/package/unordered-containers-0.2.7.1/docs/Data-HashMap-Strict.html\" rel=\"nofollow noreferrer\">dictionary</a> to keep track of the tallies. That would make an effectively linear <code>frequency</code> possible, which should pay off performance-wise if you need to handle large input lists.</p>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 435, "favorite_count": 0, "accepted_answer_id": 40711984, "answer_count": 1, "score": 0, "last_activity_date": 1479696064, "creation_date": 1479687714, "last_edit_date": 1479692632, "question_id": 40711064, "link": "https://stackoverflow.com/questions/40711064/identifying-run-time-complexity-big-o-of-frequency-function", "title": "Identifying run time complexity (big o) of frequency function?", "body": "<p>I've written a very basic function that generates a freqency for a given list:</p>\n\n<pre><code>myList = ['hello', 'apply', 'big', 'apple', 'tall', 'apply'] --input\n\nmyList = [('hello', 1), ('apply', 2), ('big', 1), ('apple', 1), ('tall',1)] --output\n</code></pre>\n\n<p>My function:</p>\n\n<pre><code>frequency :: (Eq a) =&gt; [a] -&gt; ([(a, Int)] -&gt; [(a, Int)]) -&gt; [(a, Int)]\nfrequency li removeDup = removeDup $ map (\\el -&gt; (el, indexes el)) li\n   where\n      indexes el = length $ findIndices (== el) li\n\nremoveDuplicates :: (Eq a) =&gt; [(a, Int)] -&gt; [(a, Int)]\nremoveDuplicates [] = []\nremoveDuplicates ((x1, x2) : xs) = (x1, x2) : removeDuplicates (filter (\\(y1, y2) -&gt; x1 /= y1) xs)\n</code></pre>\n\n<p>I'm trying to figure out the run time complexity of my function. My initial thought was that its O(n) as I'm first getting the 'indexes' value, then mapping and finally filtering.</p>\n\n<ol>\n<li><p>Is this conclusion correct? </p></li>\n<li><p>Is there a O(1) method of performing the same function?</p></li>\n</ol>\n"}, {"tags": ["haskell", "generic-programming"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1479692142, "post_id": 40710801, "comment_id": 68651057, "body": "You&#39;re probably better off avoiding <code>Code</code> whenever possible. Does it matter, in context, that it&#39;s a code, or can you just leave it totally polymorphic?"}, {"owner": {"reputation": 1431, "user_id": 1553741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6daac35161547a75785e69de774334b8?s=128&d=identicon&r=PG", "display_name": "ajp", "link": "https://stackoverflow.com/users/1553741/ajp"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1479693499, "post_id": 40710801, "comment_id": 68651363, "body": "I think it&#39;s necessary, because <code>GTag t</code> fits into <code>DSum</code>, but <code>GTag_ t</code> (which doesn&#39;t have <code>Code</code> added) doesn&#39;t. I might be wrong though. For full context, I&#39;m working on this file <a href=\"https://github.com/anderspapitto/reflex-sumtype-render/blob/master/src/ReflexHelpers.hs\" rel=\"nofollow noreferrer\">github.com/anderspapitto/reflex-sumtype-render/blob/master/s&zwnj;&#8203;rc/&hellip;</a>, and this is the last missing piece of the puzzle."}], "answers": [{"comments": [{"owner": {"reputation": 1431, "user_id": 1553741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6daac35161547a75785e69de774334b8?s=128&d=identicon&r=PG", "display_name": "ajp", "link": "https://stackoverflow.com/users/1553741/ajp"}, "edited": false, "score": 1, "creation_date": 1479709668, "post_id": 40713511, "comment_id": 68655630, "body": "thanks! though I&#39;m just a little sad to see an answer after having painfully worked it out myself. I&#39;ll definitely read your commentary though"}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 3, "last_activity_date": 1479709113, "last_edit_date": 1495540796, "creation_date": 1479707086, "answer_id": 40713511, "question_id": 40710801, "link": "https://stackoverflow.com/questions/40710801/how-can-i-write-function-to-convert-generic-type-to-tag-shaped-type-for-use-with/40713511#40713511", "title": "How can I write function to convert generic type to Tag-shaped type for use with DSum?", "body": "<p>A version of this code was in my <a href=\"https://stackoverflow.com/questions/40593441/how-can-i-produce-a-tag-type-for-any-datatype-for-use-with-dsum-without-templat/40621740?noredirect=1#comment68627616_40621740\">other</a> answer, but the types are slightly different, which actually simplifies the code.</p>\n\n<p>As you have seen with <code>instance GEq (GTag_ t)</code>, when you want to write inductive functions on <code>NS</code> or <code>NP</code>, you need to keep the index parametric - you will see this general pattern quite a bit with 'dependant' programming (both real dependant programming and faking it in Haskell). </p>\n\n<p>This is precisely the issue with <code>bar</code>: </p>\n\n<pre><code>forall t1 . () =&gt; Proxy t1 -&gt; NS (NP I) (Code t1) -&gt; DSum (GTag t1) (NP I)\n                                        ^^^^^^^^^\n</code></pre>\n\n<p>There is no way for such a function to be recursive - simply because if <code>S rep :: NS (NP I) (Code t1)</code>, then it is not necessarily the case (indeed, it is never the case here) that <code>rep :: NS (NP I) (Code t2)</code> for some <code>t2</code> - and even if this fact <em>were</em> true, you would struggle to convince the compiler of it.</p>\n\n<p>You must make this function (renaming to <code>toTagValG</code>) parametric in the index:</p>\n\n<pre><code>type GTagVal_ t = DSum (GTag_ t) (NP I)\ntype GTagVal t = DSum (GTag t) (NP I)\n\ntoTagValG :: NS f xss -&gt; DSum (GTag_ xss) f \ntoTagValG (Z rep) = GTag (Z Refl) :=&gt; rep \ntoTagValG (S rep) = case toTagValG rep of GTag tg :=&gt; args -&gt; GTag (S tg) :=&gt; args\n</code></pre>\n\n<p>Then <code>xss</code> is instantiated with <code>Code t</code> when you use <code>to</code> or <code>from</code>, since <code>from :: a -&gt; Rep a</code> and <code>Rep a = SOP I (Code a)</code>: </p>\n\n<pre><code>toTagVal :: Generic a =&gt; a -&gt; GTagVal a\ntoTagVal = toTagValG . unSOP . from \n</code></pre>\n\n<p>Note this type is inferred (if you turn off the MonomorphismRestriction)</p>\n\n<p>The other direction is even simpler: </p>\n\n<pre><code>fromTagVal :: Generic a =&gt; GTagVal a -&gt; a \nfromTagVal = to . SOP . (\\(GTag tg :=&gt; args) -&gt; hmap (\\Refl -&gt; args) tg) \n</code></pre>\n\n<p>Although you can write the function in the lambda with induction as well: </p>\n\n<pre><code>fromTagValG :: DSum (GTag_ xss) f -&gt; NS f xss \nfromTagValG (GTag (Z Refl) :=&gt; rep) = Z rep \nfromTagValG (GTag (S tg) :=&gt; args) = S $ fromTagValG $ GTag tg :=&gt; args \n</code></pre>\n\n<p>Note that you can assign a very general type to this function, and <code>toTagValG</code> - indeed, it does not mention <code>NP I</code> at all. You should also be able to convince yourself that these functions are each others inverses, and so witness an isomorphism between <code>NS f xss</code> and <code>DSum (GTag_ xss) f</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1479710523, "post_id": 40714009, "comment_id": 68655952, "body": "Indeed, this function <code>foo</code> which I typically call <code>case_</code> basically says that <code>NS f xs</code> is the same as <code>exists x . (InList x xs, f x)</code> - since <code>NS ((:~:) a) xs</code> is an index into <code>xs</code> and a proof that <code>a</code> is the type at that index - this alternative encoding of <code>NS</code> allows you to write the function <code>mapNS :: (forall k . f k -&gt; g k) -&gt; NS f ks -&gt; NS g ks</code> in constant time (instead of linear in the length of <code>ks</code>)!"}], "tags": [], "owner": {"reputation": 1431, "user_id": 1553741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6daac35161547a75785e69de774334b8?s=128&d=identicon&r=PG", "display_name": "ajp", "link": "https://stackoverflow.com/users/1553741/ajp"}, "is_accepted": false, "score": 3, "last_activity_date": 1479709565, "creation_date": 1479709565, "answer_id": 40714009, "question_id": 40710801, "link": "https://stackoverflow.com/questions/40710801/how-can-i-write-function-to-convert-generic-type-to-tag-shaped-type-for-use-with/40714009#40714009", "title": "How can I write function to convert generic type to Tag-shaped type for use with DSum?", "body": "<p>although this is already answered, I'll add my own anyway since I spent several hours working it out.</p>\n\n<p>short and sweet</p>\n\n<pre><code>toDSum :: Generic t =&gt; t -&gt; DSum (GTag t) (NP I)\ntoDSum = foo (\\f b -&gt; GTag f :=&gt; b) . unSOP . from\n  where\n    foo :: (forall a . (NS ((:~:) a) xs) -&gt; NP I a -&gt; r)\n        -&gt; NS (NP I) xs\n        -&gt; r\n    foo k (Z x) =     (k . Z) Refl x\n    foo k (S w) = foo (k . S)      w\n</code></pre>\n"}], "owner": {"reputation": 1431, "user_id": 1553741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6daac35161547a75785e69de774334b8?s=128&d=identicon&r=PG", "display_name": "ajp", "link": "https://stackoverflow.com/users/1553741/ajp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 40713511, "answer_count": 2, "score": 2, "last_activity_date": 1479709565, "creation_date": 1479685502, "last_edit_date": 1495540417, "question_id": 40710801, "link": "https://stackoverflow.com/questions/40710801/how-can-i-write-function-to-convert-generic-type-to-tag-shaped-type-for-use-with", "title": "How can I write function to convert generic type to Tag-shaped type for use with DSum?", "body": "<p>How can I implement this <code>toDSum</code> function? I've managed to get the base case to compile, but I don't know how to carry all the type information across a recursive call. Do I have to strip off the <code>Code</code> from the type before trying to recurse?</p>\n\n<p>(this is a followup to <a href=\"https://stackoverflow.com/questions/40698207/how-can-i-write-this-geq-instance/40708395#40708395\">How can I write this GEq instance?</a>)</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE RankNTypes #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n\nmodule Foo where\n\nimport Data.Dependent.Sum\nimport Data.GADT.Compare\nimport Data.Proxy\nimport Generics.SOP\nimport qualified GHC.Generics as GHC\n\ntype GTag t = GTag_ (Code t)\nnewtype GTag_ t (as :: [*]) = GTag (NS ((:~:) as) t)\n\ninstance GEq (GTag_ t) where\n  geq (GTag (Z Refl)) (GTag (Z Refl)) = Just Refl\n  geq (GTag (S x))    (GTag (S y))    = GTag x `geq` GTag y\n  geq _               _               = Nothing\n\ntoDSum :: forall t . Generic t =&gt; t -&gt; DSum (GTag t) (NP I)\ntoDSum = foo . unSOP . from\n  where\n    foo :: ()\n        =&gt; NS (NP I) (Code t)\n        -&gt; DSum (GTag t) (NP I)\n    foo = bar (Proxy :: Proxy t)\n\n    bar :: forall t1 . ()\n        =&gt; Proxy t1 -&gt; NS (NP I) (Code t1)\n        -&gt; DSum (GTag t1) (NP I)\n    bar _ (Z x) = GTag (Z Refl) :=&gt; x\n    bar _ (S x) = undefined\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1479684341, "post_id": 40710600, "comment_id": 68649307, "body": "Are the parentheses in <code>&quot;(this, is, a, story, all, about, how)&quot;</code> part of your input?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479685108, "post_id": 40710600, "comment_id": 68649504, "body": "We also would need to see your definitions of <code>isAlphaOrDigit</code> and <code>skipComma</code>."}, {"owner": {"reputation": 115, "user_id": 5559919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/451e8782c71cf5804989bb2ad548984c?s=128&d=identicon&r=PG&f=1", "display_name": "jazaniac", "link": "https://stackoverflow.com/users/5559919/jazaniac"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1479694863, "post_id": 40710600, "comment_id": 68651641, "body": "the parentheses are a part of the input, and here are the definitions: <code>isAlphaOrDigit :: Char -&gt; Bool isAlphaOrDigit a = (isDigit a) || (isAlpha a)</code>  <code>skipComma = const () &lt;$&gt; some comma</code>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479697539, "post_id": 40710600, "comment_id": 68652268, "body": "<code>isAlphaOrDigit</code> and <code>skipComma</code> look fine. (I suggest you edit them into your question, for the sake of clarity.)"}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 5559919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/451e8782c71cf5804989bb2ad548984c?s=128&d=identicon&r=PG&f=1", "display_name": "jazaniac", "link": "https://stackoverflow.com/users/5559919/jazaniac"}, "edited": false, "score": 0, "creation_date": 1479695559, "post_id": 40710816, "comment_id": 68651795, "body": "Thanks for the answer! so I tried implementing your definition, but it ended up returning an empty list. I then tried to implement a new parseLet function using sepBy as :   <code>parseLet = do</code>   <code>skipOpen</code>    <code>a &lt;- sepBy parseStr comma</code>     <code>skipClose</code>   <code>return $ a</code>   but this also only returned an empty list."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 115, "user_id": 5559919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/451e8782c71cf5804989bb2ad548984c?s=128&d=identicon&r=PG&f=1", "display_name": "jazaniac", "link": "https://stackoverflow.com/users/5559919/jazaniac"}, "edited": false, "score": 0, "creation_date": 1479697489, "post_id": 40710816, "comment_id": 68652255, "body": "@jazaniac (1) You can use <code>between</code> from <code>Text.ParserCombinators.ReadP</code> to handle the parentheses. (2) A guess: have you removed the <code>skipComma</code> from <code>parseStr</code> before trying this <code>sepBy</code>-based version?"}, {"owner": {"reputation": 115, "user_id": 5559919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/451e8782c71cf5804989bb2ad548984c?s=128&d=identicon&r=PG&f=1", "display_name": "jazaniac", "link": "https://stackoverflow.com/users/5559919/jazaniac"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479699625, "post_id": 40710816, "comment_id": 68652719, "body": "@duplode okay, now it looks like <code>parseLet = between open close (sepBy parseStr comma)</code>, it&#39;s still returning the emptylist though, unfortunately. And skipComma wasn&#39;t removed before, but I just removed it and it still returns an emptylist, unfortunately. <code>open = satisfy (&#39;(&#39;==)</code>  <code>close = satisfy (&#39;)&#39;==)</code>"}, {"owner": {"reputation": 115, "user_id": 5559919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/451e8782c71cf5804989bb2ad548984c?s=128&d=identicon&r=PG&f=1", "display_name": "jazaniac", "link": "https://stackoverflow.com/users/5559919/jazaniac"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479700250, "post_id": 40710816, "comment_id": 68652841, "body": "@duplode wait nevermind! the problem was in my test case. Thanks!"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 115, "user_id": 5559919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/451e8782c71cf5804989bb2ad548984c?s=128&d=identicon&r=PG&f=1", "display_name": "jazaniac", "link": "https://stackoverflow.com/users/5559919/jazaniac"}, "edited": false, "score": 0, "creation_date": 1479700401, "post_id": 40710816, "comment_id": 68652861, "body": "@jazaniac You&#39;re welcome. A final note: you don&#39;t need <code>satisfy</code> for e.g. <code>satisfy (&#39;(&#39;==)</code> -- just use <code>char &#39;(&#39;</code> instead."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1479685687, "creation_date": 1479685687, "answer_id": 40710816, "question_id": 40710600, "link": "https://stackoverflow.com/questions/40710600/how-to-parse-a-string-of-comma-separated-values-into-a-list-of-strings-in-haskel/40710816#40710816", "title": "how to parse a string of comma-separated values into a list of strings in haskell?", "body": "<p>The parser <code>a +++ b</code> sends the entire input string to <code>a</code> and the entire input string to <code>b</code>, producing all the results that either parser produced. You instead want a parser that sends the first part of the string to <code>a</code> and the second part to <code>b</code>, then lets you combine the results. Try this instead:</p>\n\n<pre><code>parseLet = liftA2 (\\ss s -&gt; ss ++ [s]) (many parseStr) parseLast\n</code></pre>\n\n<p>Many parser libraries also offer a <code>manySepBy</code> combinator (perhaps with a slightly different name) for this exact use case; you might consider looking through the <code>ReadP</code> library for such a thing.</p>\n"}], "owner": {"reputation": 115, "user_id": 5559919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/451e8782c71cf5804989bb2ad548984c?s=128&d=identicon&r=PG&f=1", "display_name": "jazaniac", "link": "https://stackoverflow.com/users/5559919/jazaniac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 850, "favorite_count": 0, "accepted_answer_id": 40710816, "answer_count": 1, "score": 3, "last_activity_date": 1479699491, "creation_date": 1479683962, "last_edit_date": 1479699491, "question_id": 40710600, "link": "https://stackoverflow.com/questions/40710600/how-to-parse-a-string-of-comma-separated-values-into-a-list-of-strings-in-haskel", "title": "how to parse a string of comma-separated values into a list of strings in haskell?", "body": "<p>so if I have a string \"(this, is, a, story, all, about, how)\" into a list of the words inside it [\"this\", \"is\", \"a\", \"story\", \"all\", \"about\", \"how\"] as an instance of ReadP String? I've tried a bunch of different ways, one of which being this: </p>\n\n<pre><code>parseStr :: ReadP String\nparseStr = do\n  skipSpaces\n  n &lt;- munch1 isAlphaOrDigit\n  skipComma\n  return $ n\n</code></pre>\n\n<p>which parses all values but the last. I thought if I combined it with this parse: </p>\n\n<pre><code>parseLast :: ReadP String\nparseLast = do\n  skipSpaces\n  n &lt;- munch1 isAlphaOrDigit\n  return $ n\n</code></pre>\n\n<p>as </p>\n\n<pre><code>parseLet = (many parseStr) +++ parseLast\n</code></pre>\n\n<p>but that didn't work either. Any tips? </p>\n\n<p>edit: more definitions</p>\n\n<pre><code>isAlphaOrDigit :: Char -&gt; Bool \nisAlphaOrDigit a = (isDigit a) || (isAlpha a) \ncomma = satisfy (','==)\nskipComma = const () &lt;$&gt; some comma\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "is_accepted": false, "score": 1, "last_activity_date": 1479684587, "last_edit_date": 1479684587, "creation_date": 1479681610, "answer_id": 40710277, "question_id": 40710193, "link": "https://stackoverflow.com/questions/40710193/trouble-with-finding-part-of-a-word/40710277#40710277", "title": "Trouble with finding part of a word", "body": "<p>You can try this:</p>\n\n<ol>\n<li><p>First you return <code>False</code> from <code>moveone</code> in case the characters differ.</p></li>\n<li><p>Next, from <code>isPart</code> instead of simply calling <code>moveone</code> add an alternative:</p>\n\n<pre><code>    | x == y = (moveone xs ys) || isPart (x:xs) ys\n</code></pre></li>\n</ol>\n\n<p>Because matching can fail at any character, not only the first one.</p>\n\n<p>As a side note, add a pattern alias for the x-list in <code>isPart</code>: <code>xList@(x:xs)</code>; otherwise you reconstruct the list for each recursive call. (Though your compiler might optimize it out.)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7115782"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479684587, "creation_date": 1479681067, "last_edit_date": 1479681395, "question_id": 40710193, "link": "https://stackoverflow.com/questions/40710193/trouble-with-finding-part-of-a-word", "title": "Trouble with finding part of a word", "body": "<p>this was a 0 point question of our homework two weeks ago so please don't flip if it looks like homework.\nWhat it is supposed to do is to find a String (in it's order) within another string.</p>\n\n<pre><code>isPart:: Eq a =&gt; [a] -&gt; [a] -&gt; Bool\nisPart [] _ = True\nisPart _ [] = False\nisPart (x:xs) (y:ys)\n    | x == y = moveone xs ys\n    | otherwise = isPart (x:xs) ys\n\nmoveone:: Eq a =&gt; [a] -&gt; [a] -&gt; Bool\nmoveone [] _ = True\nmoveone (x:xs) (y:ys)\n    | x == y = moveone xs ys\n    | otherwise = isPart (x:xs) ys\n</code></pre>\n\n<p>so if I type isPart \"house\" \"Treehouse\" it should be true, but it shouldn't if I type    isPart \"house\" \"Treheouse\"</p>\n\n<p>I am having the problem that once a Char is found to be equal it is removed from the list in moveone, so once the h is found the function will only look for \"ouse\"</p>\n\n<p>I know I can't save a String, to return to it. Please don't solve it, simply give me ideas.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 3, "creation_date": 1479681806, "post_id": 40710055, "comment_id": 68648586, "body": "That code is written point-free-ish, which isn&#39;t very beginner friendly. Add <code>ys</code> on both sides of <code>=</code> and it might get easier, e.g. <code>concatMap f ys = cmap ys</code>. Also, the canonical definition of <code>concatMap f</code> is <code>concat . map f</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1479684736, "post_id": 40710055, "comment_id": 68649430, "body": "I&#39;d probably go a bit further and say the code is confusing. I don&#39;t see any good reason to write the weird <code>accum</code> function instead of just using <code>cmap (x : xs) = f x ++ cmap xs</code>."}], "answers": [{"comments": [{"owner": {"reputation": 376, "user_id": 4782402, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/yJy6f.png?s=128&g=1", "display_name": "TheCoolFrood", "link": "https://stackoverflow.com/users/4782402/thecoolfrood"}, "edited": false, "score": 0, "creation_date": 1479722847, "post_id": 40710438, "comment_id": 68661972, "body": "Thank you very much for the quick but very detailed answer @chi I have marked it as the answer."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1479682712, "creation_date": 1479682712, "answer_id": 40710438, "question_id": 40710055, "link": "https://stackoverflow.com/questions/40710055/concatmap-explanation/40710438#40710438", "title": "concatMap explanation", "body": "<p>The code you posted is not terribly easy for a beginner. Fortunately, we can rewrite it piece by piece:</p>\n\n<pre><code>accum [] = cmap xs\naccum (y : ys) = y : accum ys\n</code></pre>\n\n<p>The function above, when the input list is empty returns <code>cmap xs</code>, otherwise on <code>y:ys</code> emits <code>y</code> as the first output element and then proceeds to output <code>accum xs</code>, recursively.</p>\n\n<p>Hence, <code>accum zs</code> will simply output all the elements in <code>zs</code> and then, after that, continue with <code>cmap xs</code>. We can rewrite that as:</p>\n\n<pre><code>accum zs = zs ++ cmap xs\n</code></pre>\n\n<p>where <code>++</code> is list concatenation.</p>\n\n<p>We can then rewrite the whole code as follows, accordingly:</p>\n\n<pre><code>concatMap f = cmap where\n    cmap [] = []\n    cmap (x : xs) = f x ++ cmap xs\n</code></pre>\n\n<p>We can further rewrite is as</p>\n\n<pre><code>concatMap f [] = []\nconcatMap f (x : xs) = f x ++ concatMap f xs\n</code></pre>\n\n<p>which should be more accessible for a beginner. More informally the above definition satisfies the equation:</p>\n\n<pre><code>concatMap f [x1,x2,...,xn] =\n   f x1 ++ f x2 ++ ... ++ f xn ++ []\n</code></pre>\n\n<p>So, we can see what <code>concatMap</code> does. It applies <code>f</code> to every list element, and for every list element <code>f</code> must return a list. Then, all such lists are concatenated.</p>\n\n<p>For example:</p>\n\n<pre><code>concatMap (\\x -&gt; [1..x]) [3,1,2] =\n   [1,2,3] ++ [1] ++ [1,2] =\n   [1,2,3,1,1,2]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 376, "user_id": 4782402, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/yJy6f.png?s=128&g=1", "display_name": "TheCoolFrood", "link": "https://stackoverflow.com/users/4782402/thecoolfrood"}, "edited": false, "score": 0, "creation_date": 1479723093, "post_id": 40710508, "comment_id": 68662125, "body": "Thank you for your answer @duplode. I had to choose between chi&#39;s and your answer to mark as &quot;The answer&quot;. For me, I needed both yours and chi&#39;s answer to fully understand what was going on. But I marked Chi&#39;s answer, because it gives a broader overview of the functions of concatMap, which might be useful for others, seeking help in this matter. But I appriciate your effort, it helped me a lot !"}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 3, "last_activity_date": 1479684063, "last_edit_date": 1479684063, "creation_date": 1479683277, "answer_id": 40710508, "question_id": 40710055, "link": "https://stackoverflow.com/questions/40710055/concatmap-explanation/40710508#40710508", "title": "concatMap explanation", "body": "<p>chi's answer covers how <code>concatMap</code> works, so I will focus specifically on one of your doubts:</p>\n\n<blockquote>\n  <p>But how can we set a function equal to another one?</p>\n</blockquote>\n\n<p>A function in Haskell is a value, just like any other.</p>\n\n<pre><code>GHCi&gt; foo = \"foo\"\n</code></pre>\n\n<p>This is a definition of <code>foo</code>, which happens to be a string:</p>\n\n<pre><code>GHCi&gt; :t foo\nfoo :: [Char]\nGHCi&gt; putStrLn foo\nfoo\n</code></pre>\n\n<p>In the same way...</p>\n\n<pre><code>GHCi&gt; add = (+)\n</code></pre>\n\n<p>... this is a definition of <code>add</code>, which happens to be a function:</p>\n\n<pre><code>GHCi&gt; :t add\nadd :: Num a =&gt; a -&gt; a -&gt; a\nGHCi&gt; add 2 3\n5\n</code></pre>\n\n<p>In the definition above, in order to emphasise that I was just defining a value, I didn't write either of the parameters of <code>add</code> explicitly. It is perfectly fine to do that, though:</p>\n\n<pre><code>GHCi&gt; add x y = (+) x y\n</code></pre>\n\n<p>(Note that <code>x + y</code>, which is how we usually would write the right-hand side of the definition above, is simply convenient alternative syntax for <code>(+) x y</code>.)</p>\n\n<p>A different way of writing the definition takes advantage of <em>partial application</em> to mention only the first parameter:</p>\n\n<pre><code>GHCi&gt; add x = (+) x\n</code></pre>\n\n<p>We also can, just for the sake of it (and to perhaps clarify what is going on), move the <code>(+) x</code> to a separate definition in a where-clause...</p>\n\n<pre><code>GHCi&gt; :{\nGHCi| add x = plusX\nGHCi|     where\nGHCi|     plusX = (+) x\nGHCi| :}\n</code></pre>\n\n<p>... and write the second parameter explicitly again:</p>\n\n<pre><code>GHCi&gt; :{\nGHCi| add x = plusX\nGHCi|     where\nGHCi|     plusX y = (+) x y\nGHCi| :}\n</code></pre>\n\n<p><code>plusX</code> is a function which takes an argument and add it to <code>x</code>. <code>add</code> is a function which takes an argument, <code>x</code>, and gives back the <code>plusX</code> function corresponding to that <code>x</code>. It is this second function that takes the second argument to <code>add</code> when we do <code>add 2 3</code> (which, by the way, is equivalent to <code>(add 2) 3</code>).</p>\n\n<p>Now, compare the above with your <code>concatMap</code> definition:</p>\n\n<pre><code>concatMap f = cmap where\n    cmap [] = []\n    cmap (x : xs) = accum (f x) where\n        accum [] = cmap xs\n        accum (y : ys) = y : accum ys\n</code></pre>\n\n<p>The definitions are laid out in an analogous way. <code>cmap</code> is a function that takes a list and uses <code>f</code>, the argument to <code>concatMap</code>, to produce a result from it, much in the same way <code>plusX</code> used the <code>x</code> argument of <code>add</code>.</p>\n\n<p>So, to sum it up:</p>\n\n<blockquote>\n  <p>Are we setting the result of f equal to cmap, or are we using cmap as a parameter for f?</p>\n</blockquote>\n\n<p>Neither. We are using <code>f</code> to define <code>cmap</code>, which is then used to define <code>concatMap</code> as a whole.</p>\n"}], "owner": {"reputation": 376, "user_id": 4782402, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/yJy6f.png?s=128&g=1", "display_name": "TheCoolFrood", "link": "https://stackoverflow.com/users/4782402/thecoolfrood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 721, "favorite_count": 0, "accepted_answer_id": 40710438, "answer_count": 2, "score": 0, "last_activity_date": 1479689683, "creation_date": 1479680280, "last_edit_date": 1479689683, "question_id": 40710055, "link": "https://stackoverflow.com/questions/40710055/concatmap-explanation", "title": "concatMap explanation", "body": "<p>Hello people of StackOverflow!</p>\n\n<p>I've started working with Haskell, and have stumbled upon the <code>concatMap</code> function.\nSince I'm quite new to this language, I have some problems understanding the following code (<a href=\"http://wiki.cs.pdx.edu/forge/concatmap.html\" rel=\"nofollow noreferrer\">source</a>):</p>\n\n<pre><code>concatMap f = cmap where\n    cmap [] = []\n    cmap (x : xs) = accum (f x) where\n        accum [] = cmap xs\n        accum (y : ys) = y : accum ys\n</code></pre>\n\n<p>As far as I understand the function <code>concatMap</code> takes in an argument <code>f</code> which is a function. </p>\n\n<p>But how can we set a function equal to another one? Are we setting the result of <code>f</code> equal to <code>cmap</code>, or are we using <code>cmap</code> as a parameter for <code>f</code>?</p>\n\n<p>Any help would be much appreciated,</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1479709536, "post_id": 40709641, "comment_id": 68655581, "body": "Note that you can generalize the function <code>justOne</code> quite a bit: <code>foldr (\\a _ -&gt; pure a) empty :: (Alternative f, Foldable t) =&gt; t a -&gt; f a</code>, which intuitively produces the right-most element or fails if the container is empty."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1479717689, "post_id": 40709641, "comment_id": 68659107, "body": "@user2407038, left-most."}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1479719374, "post_id": 40709641, "comment_id": 68659951, "body": "@user2407038. Yes, the Foldable generalization is fine, however I&#39;m not sure the <code>pure</code> generalisation is terribly useful. Does it do something useful and expected for any applicative for example (e.g. <code>ZipList</code> or <code>(-&gt;)</code>)? Related: <a href=\"https://wiki.haskell.org/Why_not_Pointed%3F\" rel=\"nofollow noreferrer\">wiki.haskell.org/Why_not_Pointed%3F</a>"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1479724940, "post_id": 40709641, "comment_id": 68663279, "body": "@jpath It&#39;s using <code>Alternative</code>, not <code>Applicative</code>."}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 0, "creation_date": 1492522261, "post_id": 40709641, "comment_id": 74002116, "body": "<a href=\"https://www.stackage.org/haddock/lts-6.16/base-4.8.2.0/Data-Maybe.html#v:listToMaybe\" rel=\"nofollow noreferrer\">stackage.org/haddock/lts-6.16/base-4.8.2.0/&hellip;</a>"}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "reply_to_user": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 1, "creation_date": 1492538268, "post_id": 40709641, "comment_id": 74013592, "body": "@SwiftsNamesake <code>listToMaybe [1,2] = Just 1 \u2260 Nothing = justOne [1,2]</code>"}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 0, "creation_date": 1492584586, "post_id": 40709641, "comment_id": 74031785, "body": "@jpath Oh yeah. True."}], "tags": [], "owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "is_accepted": true, "score": 18, "last_activity_date": 1479682541, "last_edit_date": 1479682541, "creation_date": 1479677679, "answer_id": 40709641, "question_id": 40709577, "link": "https://stackoverflow.com/questions/40709577/are-there-better-ways-to-do-map-k-v-maybe-map-k-v/40709641#40709641", "title": "Are there better ways to do Map k [v] -&gt; Maybe (Map k v)?", "body": "<p>You are looking for <code>traverse :: (Traverseable t, Applicative f) =&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)</code> from <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Traversable.html\" rel=\"noreferrer\"><code>Data.Traversable</code></a> (but also in the Prelude).</p>\n\n<pre><code>justOne :: [a] -&gt; Maybe a\njustOne [x] = Just x\njustOne _ = Nothing\n\nallJustOne :: Map k [v] -&gt; Maybe (Map k v)\nallJustOne = traverse justOne\n</code></pre>\n\n<p><code>traverse f</code> is probably best understood as <code>sequenceA . fmap f</code>. <code>sequenceA :: (Traversable t, Applicative f) =&gt; t (f a) -&gt; f (t a)</code> on the other hand is a way of pulling the applicative \"effects\" out of a <code>Traversable</code> structure. For example one might execute a list of <code>IO</code> actions with <code>sequenceA :: [IO a] -&gt; IO [a]</code>. Or in the case of <code>Maybe</code> the result will be <code>Just</code> if all the elements in the <code>Traversable</code> structure are <code>Just</code> and if any of the elements is <code>Nothing</code> the result of <code>sequenceA</code> will also be <code>Nothing</code>.</p>\n\n<p>If you know <code>sequence</code> or <code>mapM</code>, <code>sequenceA</code> and <code>traverse</code> are just generalisations of those.</p>\n"}], "owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "accepted_answer_id": 40709641, "answer_count": 1, "score": 8, "last_activity_date": 1479682541, "creation_date": 1479677252, "question_id": 40709577, "link": "https://stackoverflow.com/questions/40709577/are-there-better-ways-to-do-map-k-v-maybe-map-k-v", "title": "Are there better ways to do Map k [v] -&gt; Maybe (Map k v)?", "body": "<p>I want to create a function that turns <code>Map k [v]</code> (<a href=\"http://hackage.haskell.org/package/containers-0.5.0.0/docs/Data-Map-Strict.html\" rel=\"nofollow noreferrer\">Data.Map.Strict</a>) into <code>Maybe (Map k v)</code>.</p>\n\n<p>What it does is this:</p>\n\n<ul>\n<li>If any of the lists doesn't have exactly one element, the function returns <code>Nothing</code>.</li>\n<li>If all of the lists have exactly one element, it returns the expected map wrapped in a <code>Just</code>.</li>\n</ul>\n\n<p>The only thing I can think of is to do this manually with <code>foldrWithKey'</code> or <code>foldlWithKey'</code>. Are there better ways?</p>\n"}, {"tags": ["haskell", "random", "monads"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479673010, "post_id": 40708583, "comment_id": 68645708, "body": "Tangential question: is there any specific reason why you are using <code>{-# LANGUAGE Strict #-}</code>?"}, {"owner": {"reputation": 3783, "user_id": 1731200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ee017760fb073022ed2dc2faaf506516?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/1731200/matthias"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1479673575, "post_id": 40708583, "comment_id": 68645886, "body": "@duplode Very performance critical code (practically only number crushing). I actually never need the pros of lazy evaluation."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479673866, "post_id": 40708583, "comment_id": 68645986, "body": "Okay, that sounds reasonable."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1479672189, "last_edit_date": 1479672189, "creation_date": 1479671835, "answer_id": 40708712, "question_id": 40708583, "link": "https://stackoverflow.com/questions/40708583/using-random-values-obtained-from-the-global-random-number-generator-in-haskell/40708712#40708712", "title": "Using random values obtained from the global random number generator in Haskell in arithmetic and logic operations", "body": "<p>In a monadic context, you can use <code>do</code> to actually run the computation:</p>\n\n<pre><code>test :: Double -&gt; Double -&gt; IO Double\ntest a b = do\n   u &lt;- uniform_float\n   if a &lt; u\n      then return (b + u)\n      else return 2.0\n</code></pre>\n\n<p>The general idea is: use <code>&lt;-</code> to temporarily extract a <code>Double</code> from a <code>IO Double</code>, and then put the result back inside <code>IO</code> using <code>return</code>.</p>\n\n<p>For instance, this sums two uniform numbers:</p>\n\n<pre><code>sumTwo :: IO Double\nsumTwo = do\n   x &lt;- uniform_float\n   y &lt;- uniform_float\n   return (x+y)\n</code></pre>\n\n<p>There are alternatives to <code>do</code>, but I'd recommend learning <code>do</code> first, since it's reasonably general and simple enough. When you get more accustomed to monadic computations, applicatives and functors, you'll probably also like compact alternatives like <code>sumTwo = (+) &lt;$&gt; uniform_float &lt;*&gt; uniform_float</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 3, "last_activity_date": 1479672092, "creation_date": 1479672092, "answer_id": 40708757, "question_id": 40708583, "link": "https://stackoverflow.com/questions/40708583/using-random-values-obtained-from-the-global-random-number-generator-in-haskell/40708757#40708757", "title": "Using random values obtained from the global random number generator in Haskell in arithmetic and logic operations", "body": "<p><code>(&gt;&gt;=)</code> can be used to chain a second monadic computation that uses the <code>Double</code> values.</p>\n\n<pre><code>test :: Double -&gt; Double -&gt; IO Double\ntest a b = uniform_float &gt;&gt;= \\u -&gt; return (if a &lt; u then b + u else 2.0)\n</code></pre>\n\n<p>An alternative way of writing the above is using a do-block:</p>\n\n<pre><code>test :: Double -&gt; Double -&gt; IO Double\ntest a b = do\n    u &lt;- uniform_float\n    return (if a &lt; u then b + u else 2.0)\n</code></pre>\n\n<p>Finally, in cases like this one, in which the second monadic computation is simply a non-monadic computation followed by a <code>return</code>, you don't even need <code>(&gt;&gt;=)</code> -- <code>fmap</code> is enough:</p>\n\n<pre><code>test :: Double -&gt; Double -&gt; IO Double\ntest a b = fmap (\\u -&gt; if a &lt; u then b + u else 2.0) uniform_float\n</code></pre>\n"}], "owner": {"reputation": 3783, "user_id": 1731200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ee017760fb073022ed2dc2faaf506516?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/1731200/matthias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 40708712, "answer_count": 2, "score": 1, "last_activity_date": 1479672189, "creation_date": 1479670987, "question_id": 40708583, "link": "https://stackoverflow.com/questions/40708583/using-random-values-obtained-from-the-global-random-number-generator-in-haskell", "title": "Using random values obtained from the global random number generator in Haskell in arithmetic and logic operations", "body": "<p>How do you use <code>IO Double</code> values obtained from the global random number generator in Haskell in arithmetic and logic operations? Most tutorials on the internet focus on obtaining random numbers, but somehow I seem not to be able to do something useful with them.</p>\n\n<p>The following code contains some function <code>test</code> containing some of the operations I want to perform. </p>\n\n<pre><code>{-# LANGUAGE Strict #-}\nmodule RNG where\nimport System.Random(setStdGen, mkStdGen, randomRIO)\n\nseed_rng :: Int -&gt; IO()\nseed_rng seed = (setStdGen (mkStdGen seed))\n\nuniform_float :: IO Double\nuniform_float = (randomRIO (0.0, 1.0))\n\ntest :: Double -&gt; Double -&gt; IO Double\ntest a b = let u = (uniform_float)\n              in if ((&lt;) (return a) u) then ((+) (return b) u) else (return 2.0)\n</code></pre>\n\n<p>The test function does not compile since there is no instance for <code>Ord (IO Double)</code> and <code>Num (IO Double)</code>.</p>\n\n<p>Note that I can avoid the <code>IO Monad</code> by implementing a random number generator and tracking+passing the state myself. But I rather learn to work with <code>Monads</code> instead of always trying to run away from them.</p>\n"}, {"tags": ["list", "haskell", "sum"], "comments": [{"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 1, "creation_date": 1479667402, "post_id": 40707884, "comment_id": 68643776, "body": "Assuming you know how to sum one list, take a look at <code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1479667718, "post_id": 40707884, "comment_id": 68643888, "body": "No clue at all, this sounds way to difficult, doubt anybody has ever done something like that. ...Seriously, what have you actually tried? Have you <a href=\"https://wiki.haskell.org/Books#Textbooks\" rel=\"nofollow noreferrer\">read</a> any bit of introduction? I always recommend <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow noreferrer\">Learn You a Haskell</a>, it&#39;s great for a light start."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 5, "creation_date": 1479668170, "post_id": 40707884, "comment_id": 68644036, "body": "(No offense intended \u2013 Haskell sure can seem confusing at first, but with a bit of introductory material I&#39;m sure you will get along. But asking for tiny examples like this is not effective, not for you and certainly not for StackOverflow.)"}, {"owner": {"reputation": 11, "user_id": 7186293, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f3dacaf6a900c79f2fca64a88f6a5fa4?s=128&d=identicon&r=PG&f=1", "display_name": "SilverA", "link": "https://stackoverflow.com/users/7186293/silvera"}, "edited": false, "score": 0, "creation_date": 1479671128, "post_id": 40707884, "comment_id": 68645097, "body": "I am used to imperative languages like java and it has been only a week since I first read through learn you a haskell... i have not seen map to be used like this before, so thanks for the tip"}, {"owner": {"reputation": 9485, "user_id": 20371, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/32c7a412ad0caf812ae974df5eb8ffcd?s=128&d=identicon&r=PG", "display_name": "Yawar", "link": "https://stackoverflow.com/users/20371/yawar"}, "edited": false, "score": 0, "creation_date": 1479671933, "post_id": 40707884, "comment_id": 68645341, "body": "Check out Haskell list comprehensions."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1479673825, "post_id": 40707884, "comment_id": 68645970, "body": "See <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "reply_to_user": {"reputation": 11, "user_id": 7186293, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f3dacaf6a900c79f2fca64a88f6a5fa4?s=128&d=identicon&r=PG&f=1", "display_name": "SilverA", "link": "https://stackoverflow.com/users/7186293/silvera"}, "edited": false, "score": 0, "creation_date": 1479714224, "post_id": 40708048, "comment_id": 68657523, "body": "if you are satisfied with the answer (or any other) please accept it to close this question"}], "tags": [], "owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "is_accepted": false, "score": 1, "last_activity_date": 1479668425, "last_edit_date": 1479668425, "creation_date": 1479668040, "answer_id": 40708048, "question_id": 40707884, "link": "https://stackoverflow.com/questions/40707884/how-can-i-sum-up-the-values-in-lists-within-lists-in-haskell/40708048#40708048", "title": "How can I sum up the values in lists within lists in Haskell?", "body": "<p>You can sum a list with <code>sum</code> and you can apply any function to each element of a list with <code>map</code> so the function you are looking for is:</p>\n\n<pre><code>map sum\n</code></pre>\n\n<p>when you apply the function:</p>\n\n<pre><code>map sum [[1,3],[4,7],[2,5]]\n</code></pre>\n\n<p>you get your <code>[4,11,7]</code>. What happens is that map <em>walks</em> over the outer list and keeps applying the function that it gets as its first argument (in this case it is the <code>sum</code> function) to every element. At the same time, <code>map</code> collects the results in an output list. So <code>sum</code> is applied to <code>[1,3]</code> with the result <code>4</code> to <code>[4,7]</code> with the result <code>11</code> and to <code>[2,5]</code> with the result <code>7</code>, all of which are placed in a list <code>[4,11,7]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "is_accepted": true, "score": 1, "last_activity_date": 1479792245, "creation_date": 1479792245, "answer_id": 40734337, "question_id": 40707884, "link": "https://stackoverflow.com/questions/40707884/how-can-i-sum-up-the-values-in-lists-within-lists-in-haskell/40734337#40734337", "title": "How can I sum up the values in lists within lists in Haskell?", "body": "<p>Think about function types, it may help. </p>\n\n<p>You have <code>[[Int]]</code> and you want a function <code>[[Int]] -&gt; [Int]</code> to get <code>[Int]</code></p>\n\n<p>The function you want is <code>map sum :: [[Int]] -&gt; [Int]</code></p>\n\n<p>The following codes was run in <code>ghci</code></p>\n\n<p>First you have list of list of ints. Note that in this example you need to guide <code>ghci</code> with <code>[[Int]]</code> to get the type you want instead of the confusing generic <code>[[1,3],[4,7],[2,5]] :: Num t =&gt; [[t]]</code> </p>\n\n<pre><code>Prelude&gt; let xs = [[1,3],[4,7],[2,5]] :: [[Int]]\n</code></pre>\n\n<p>Next, you might already know <code>sum</code>, let make one that specific for <code>[Int]</code> instead of generic <code>sum :: (Foldable t, Num a) =&gt; t a -&gt; a</code>, this will make the type easier to read</p>\n\n<pre><code>Prelude&gt; let sumInts = sum :: [Int] -&gt; Int\n</code></pre>\n\n<p>Next, let test the <code>sumInts</code> on some element of <code>xs = [[1,3],[4,7],[2,5]]</code> </p>\n\n<pre><code>Prelude&gt; :t sumInts [1,3]\nsumInts [1,3] :: Int\nPrelude&gt; sumInts [1,3]\n4\n</code></pre>\n\n<p>Now you can do <code>sum</code> on an element of a list, to do that to entire list you can use <code>map</code></p>\n\n<pre><code>Prelude&gt; :t map\nmap :: (a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>Let see if you pass <code>sumInts</code> to a map what type you will get?</p>\n\n<pre><code>Prelude&gt; :t map sumInts \nmap sumInts :: [[Int]] -&gt; [Int]\n</code></pre>\n\n<p>This should work with <code>xs :: [[Int]]</code> but let check type first to make sure</p>\n\n<pre><code>Prelude&gt; :t map sumInts xs\nmap sumInts xs :: [Int]\n</code></pre>\n\n<p>Now do the computation</p>\n\n<pre><code>Prelude&gt; map sumInts xs\n[4,11,7]\n</code></pre>\n\n<p>Since <code>sumInts = sum</code> , this also mean <code>sum</code> would work too</p>\n\n<pre><code>Prelude&gt; :t map sum xs\nmap sum xs :: [Int]\nPrelude&gt; map sum xs\n[4,11,7]\n</code></pre>\n\n<p>Note 1: <code>map sum</code> real type is <code>map sum :: (Foldable t, Num b) =&gt; [t b] -&gt; [b]</code>) in the last example it was inferred by type <code>[[Int]]</code> of xs to <code>[[Int]] -&gt; [Int]</code></p>\n"}], "owner": {"reputation": 11, "user_id": 7186293, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f3dacaf6a900c79f2fca64a88f6a5fa4?s=128&d=identicon&r=PG&f=1", "display_name": "SilverA", "link": "https://stackoverflow.com/users/7186293/silvera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1560, "favorite_count": 0, "accepted_answer_id": 40734337, "answer_count": 2, "score": 0, "last_activity_date": 1479792245, "creation_date": 1479667101, "question_id": 40707884, "link": "https://stackoverflow.com/questions/40707884/how-can-i-sum-up-the-values-in-lists-within-lists-in-haskell", "title": "How can I sum up the values in lists within lists in Haskell?", "body": "<p>As I try to learn Haskell just for fun and the experience I have no other possibility than to ask you the \"dumb\" questions of a total beginner ^^.\nI stumbled across the problem how it might be possible to find the sums of lists whithin lists e.g. [[1,3],[4,7],[2,5]] = [4,11,7] and I have found no solution so far. Does anybody have a clue how this might work in Haskell?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 1, "last_activity_date": 1479658491, "creation_date": 1479658491, "answer_id": 40706299, "question_id": 40706085, "link": "https://stackoverflow.com/questions/40706085/naming-strategies-for-describing-html-structure-in-haskell/40706299#40706299", "title": "Naming strategies for describing HTML structure in Haskell", "body": "<p>Reflecting the full hierarchy in the type names, as in your first example, seems excessive. As for the second example, <em>if</em> namespace pollution eventually turns out to be a problem, qualified imports are an easy workaround:</p>\n\n<pre><code>module FooBar where -- etc.\n\ndata HTML      = HTML HTML [Element]\ndata Element   = Element Tagname [Attribute]\ndata Tagname   = Tagname String\ndata Attribute = Attribute (Key, Value)\ndata Key       = Key String\ndata Value     = Value String\n</code></pre>\n\n\n\n<pre><code>import qualified FooBar as H\n\nsomeHtml :: H.HTML\nsomeHtml = -- etc.\n</code></pre>\n\n<p>Some relevant prior art: <a href=\"https://hackage.haskell.org/package/blaze-markup-0.7.1.0\" rel=\"nofollow noreferrer\"><em>blaze-markup</em></a>, <a href=\"https://hackage.haskell.org/package/threepenny-gui-0.7.0.0/docs/Graphics-UI-Threepenny.html\" rel=\"nofollow noreferrer\"><em>threepenny-gui</em></a>.</p>\n"}], "owner": {"reputation": 5352, "user_id": 4896150, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/74d0c938f3f71d6ee14db4f6b9d222c2?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Harald", "link": "https://stackoverflow.com/users/4896150/anton-harald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479658699, "creation_date": 1479657201, "last_edit_date": 1479658699, "question_id": 40706085, "link": "https://stackoverflow.com/questions/40706085/naming-strategies-for-describing-html-structure-in-haskell", "title": "Naming strategies for describing HTML structure in Haskell", "body": "<p>Consider the following haskell types, which describe the basic structure of a HTML document:</p>\n\n<pre><code>data HTML               = HTML HTMLElement [HTMLElement]\ndata HTMLElement        = HTMLElement HTMLElementTagname [HTMLAttribute]\ndata HTMLElementTagname = HTMLElementTagname String\ndata HTMLAttribute      = HTMLAttribute (HTMLAttributeKey, HTMLAttributeValue)\ndata HTMLAttributeKey   = HTMLAttributeKey String\ndata HTMLAttributeValue = HTMLAttributeValue String\n</code></pre>\n\n<p>My question is mainly about a proper naming strategy for this structure. Look for example at the last type <code>HTMLAttributeValue</code>, it shows clearly the hierarchy of the defined types, but just by the camel-case convention I'm using. Nothing would hold someone from calling it <code>value_of_html_attribute</code>, just to give an example. This could be regarded as problematic.</p>\n\n<p>Another naming could look like this:</p>\n\n<pre><code>data HTML      = HTML HTML [Element]\ndata Element   = Element Tagname [Attribute]\ndata Tagname   = Tagname String\ndata Attribute = Attribute (Key, Value)\ndata Key       = Key String\ndata Value     = Value String\n</code></pre>\n\n<p>This however would pollute the global namespace. Maybe the types <code>Key</code> or <code>Value</code> for instance would make sense to use somewhere else in the code for other data structures. However, the later example looks way more readable to me, whereas the first one seems to be quite pedantic.</p>\n\n<p>How would you implement this?</p>\n"}, {"tags": ["python", "haskell", "recursion"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1479660315, "post_id": 40705933, "comment_id": 68641047, "body": "You don&#39;t need an explicit loop or recursion. &quot;Compute something for each element in the list&#39;. There&#39;s a built-in fuction for that called <code>map</code>. &quot;Go over a list and update a value based on the previous value and the current list element&quot;. Another builtin, foldr."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1479660375, "post_id": 40705933, "comment_id": 68641076, "body": "@n.m. That <code>for</code> is not a <code>map</code>, because it keeps track of the best <code>maxchain</code> during the loop... It&#39;s more a <code>fold</code>."}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1479660685, "post_id": 40706681, "comment_id": 68641181, "body": "Err, <code>remaining = delete edge edges</code> would be the same behaviour as in Python/OPs code. Parallel edges <i>might</i> be allowed and thus shouldn&#39;t get removed."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1479660872, "post_id": 40706681, "comment_id": 68641245, "body": "@Zeta Noted, but it probably doesn&#39;t really matter that much."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1479661040, "post_id": 40706681, "comment_id": 68641308, "body": "Run-time will probably differ slightly, but yeah, there won&#39;t be that many parallel edges, I suppose."}], "tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": false, "score": 3, "last_activity_date": 1479660782, "last_edit_date": 1479660782, "creation_date": 1479660616, "answer_id": 40706681, "question_id": 40705933, "link": "https://stackoverflow.com/questions/40705933/cant-convert-simple-python-code-to-haskell/40706681#40706681", "title": "Can&#39;t convert simple python code to haskell", "body": "<p>That python code isn't really the best... I don't see the point of finding the index of <code>edge</code> and then <code>del</code>eting it... just use <code>edges.remove(edge)</code>.</p>\n\n<p>In the same way in Haskell you can just <code>filter</code> the edges:</p>\n\n<pre><code>remaining = filter (/= edge) edges\n</code></pre>\n\n<p>Now, your <code>for</code> loop is tracking the best result so far. This in Haskell could be done by a recursive function using an accumulator parameter. However the pattern here is that of a <code>fold</code>:</p>\n\n<pre><code>foldr f [] possibilities\n</code></pre>\n\n<p>Where:</p>\n\n<pre><code>f c maxchain = let l = longestPath c remaining\n               in\n                   if length l &gt; length maxchain then l else maxchain\n</code></pre>\n\n<p>You could modify <code>longestPath</code> to also return the length of the path and avoid the calls to <code>length</code>...</p>\n\n<hr>\n\n<p>The complete code would look like:</p>\n\n<pre><code>longestPath edge edges = foldr f [] possibilities\n  where\n    remaining = filter (/= edge) edges\n    possibilities = [opt | opt &lt;- remaining, (fst opt) == (snd edge)]\n    f c maxchain = if length l &gt; length maxchain then l else maxchain\n      where\n        l = longestPath c remaining\n</code></pre>\n\n<hr>\n\n<p>As pointed out in the comments instead of <code>filter</code> you could use <code>delete edge edges</code> to remove just <em>one</em> occurrence of <code>edge</code>. This shouldn't matter if you are dealing with standard graphs, though.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 7185748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f74ba51a9d42424999660bc7359297ec?s=128&d=identicon&r=PG&f=1", "display_name": "D.B.Cooper", "link": "https://stackoverflow.com/users/7185748/d-b-cooper"}, "edited": false, "score": 0, "creation_date": 1479661581, "post_id": 40706722, "comment_id": 68641522, "body": "This almost works, but it throws an Exception: List.maximumBy: empty list"}, {"owner": {"reputation": 23, "user_id": 7185748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f74ba51a9d42424999660bc7359297ec?s=128&d=identicon&r=PG&f=1", "display_name": "D.B.Cooper", "link": "https://stackoverflow.com/users/7185748/d-b-cooper"}, "edited": false, "score": 0, "creation_date": 1479662275, "post_id": 40706722, "comment_id": 68641801, "body": "*It prints the first few edges on the path but then fails giving the exception"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 23, "user_id": 7185748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f74ba51a9d42424999660bc7359297ec?s=128&d=identicon&r=PG&f=1", "display_name": "D.B.Cooper", "link": "https://stackoverflow.com/users/7185748/d-b-cooper"}, "edited": false, "score": 0, "creation_date": 1479662908, "post_id": 40706722, "comment_id": 68642045, "body": "@D.B.Cooper Err, sorry, forgot the empty case."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 4, "last_activity_date": 1479680059, "last_edit_date": 1479680059, "creation_date": 1479660862, "answer_id": 40706722, "question_id": 40705933, "link": "https://stackoverflow.com/questions/40705933/cant-convert-simple-python-code-to-haskell/40706722#40706722", "title": "Can&#39;t convert simple python code to haskell", "body": "\n\n<p><sup><strong>Note</strong>: This answer is written in literate Haskell. Save it as <code>*.lhs</code> and load it in GHCi.</sup></p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; import Data.Ord (comparing)\n&gt; import Data.List (delete, maximumBy)\n&gt; type Edge = (Int, Int)\n</code></pre>\n\n<p>Let us have a look at your Python code and think of how the Haskell function should look like:\n</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>def longest_path(edge, edges):\n</code></pre>\n\n<p>Allright. We start with a single edge and a list of edges. Therefore, we should write a function with that type:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; longestPath :: Edge -&gt; [Edge] -&gt; [Edge]\n&gt; longestPath edge edges =\n</code></pre>\n\n<p>Now, what do we do in our Python code? Apparently, we remove our current <code>edge</code> from the list of edges:\n</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>    remaining = list(edges)\n    del remaining[remaining.index(edge)]\n</code></pre>\n\n<p>Luckily, there is a function to remove the first occurence of an element in a list, namely <code>delete</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt;     let remaining = delete edge edges\n</code></pre>\n\n<p>So far so good. Now, <code>possibles</code> is just the list of edges with have the correct end-point:\n</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>    possibles = [x for x in remaining if x[0] == edge[1]]\n</code></pre>\n\n<p>That's easy too:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt;         possibles = filter (edge `connectedTo`) edges\n</code></pre>\n\n<p>And then we look for the longest chain for all the possible edges. \n</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>    maxchain = []\n    for c in possibles:\n        l = longest_path(c, remaining)\n        if len(l) &gt; len(maxchain):\n            maxchain = l\n</code></pre>\n\n<p>Since we cannot modify <code>maxchain</code> in Haskell, let's create all those intermediate paths instead:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt;         paths = [] : map (\\e -&gt; longestPath e remaining) possibles\n</code></pre>\n\n<p><strong>This</strong> is where the recursion happens. For every <code>Edge</code> in our possible edges, we create the <code>longestPath</code> of that edge and the remaining ones.</p>\n\n<p>Most of <code>for</code> loops can be expressed as <code>map</code> and a following fold. The fold we will use is <code>maximumBy</code>, where we compare the lists by their length with <code>comparing length</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt;     in edge : maximumBy (comparing length) paths\n</code></pre>\n\n<p>We've used a small helper though, <code>connectedTo</code>. But that's easy:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; connectedTo :: Edge -&gt; Edge -&gt; Bool\n&gt; connectedTo (_,b) (x,_) = b == x\n</code></pre>\n\n<p>All code at once:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.List (delete, maximumBy)\nimport Data.Ord (comparing)\n\ntype Edge = (Int, Int)\n\nlongestPath :: Edge -&gt; [Edge] -&gt; [Edge]\nlongestPath edge edges =\n    let remaining = delete edge edges\n        possibles = filter (edge `connectedTo`) edges\n        paths = [] : map (\\e -&gt; longestPath e remaining) possibles\n    in edge : maximumBy (comparing length) paths\n\nconnectedTo :: Edge -&gt; Edge -&gt; Bool\nconnectedTo (_,b) (x,_) = b == x\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7185748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f74ba51a9d42424999660bc7359297ec?s=128&d=identicon&r=PG&f=1", "display_name": "D.B.Cooper", "link": "https://stackoverflow.com/users/7185748/d-b-cooper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 1, "accepted_answer_id": 40706722, "answer_count": 2, "score": 2, "last_activity_date": 1479680059, "creation_date": 1479656430, "last_edit_date": 1479658735, "question_id": 40705933, "link": "https://stackoverflow.com/questions/40705933/cant-convert-simple-python-code-to-haskell", "title": "Can&#39;t convert simple python code to haskell", "body": "<p>I'm trying to convert this to Haskell,</p>\n\n<pre><code>def longest_path(edge, edges):\n    remaining = list(edges)\n    del remaining[remaining.index(edge)]\n    possibles = [x for x in remaining if x[0] == edge[1]]\n    maxchain = []\n    for c in possibles:\n        l = longest_path(c, remaining)\n        if len(l) &gt; len(maxchain):\n            maxchain = l\n    return [edge] + maxchain\n</code></pre>\n\n<p>This is as far as I got,</p>\n\n<pre><code>deleteN :: Int -&gt; [a] -&gt; [a]\ndeleteN _ []     = []\ndeleteN i (x:xs)\n   | i == 0    = xs\n   | otherwise = x : deleteN (i-1) xs\n\nlongestPath edge edges = let\n  remaining = deleteN (fromMaybe $ elemIndex edge edges) edges\n  possibiles = [opt | opt &lt;- remaining, (fst opt) == (snd edge)]\n</code></pre>\n\n<p>I can't figure out how to do the for loop with recursion. Anyone have an idea?</p>\n"}, {"tags": ["haskell", "haskell-persistent"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1479662097, "post_id": 40705554, "comment_id": 68641731, "body": "For what it&#39;s worth, there&#39;s no overhead to using the getter. <code>^. userName</code> generates the same code as <code>_userName</code>."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 2, "last_activity_date": 1479656884, "creation_date": 1479656884, "answer_id": 40706023, "question_id": 40705554, "link": "https://stackoverflow.com/questions/40705554/remove-underscore-from-fields-with-generated-lenses-in-persistent/40706023#40706023", "title": "Remove underscore from fields with generated lenses in Persistent", "body": "<blockquote>\n  <p>Firstly, how can I revert that to the default, <code>userName vals</code>, and add the underscore to use the lenses getter, <code>vals ^. _userName</code>?</p>\n</blockquote>\n\n<p><a href=\"https://www.stackage.org/haddock/lts-7.9/persistent-template-2.5.1.6/Database-Persist-TH.html#v:mkPersist\" rel=\"nofollow noreferrer\"><code>Database.Persist.TH</code></a> does not offer that option (to see what it might look like if it existed, cf. <a href=\"https://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-TH.html\" rel=\"nofollow noreferrer\"><code>Control.Lens.TH</code></a>), so, assuming that you won't fork the library over this, there doesn't seem to be a way. (By the way, looking for <code>mpsGenerateLenses</code> <a href=\"https://www.stackage.org/haddock/lts-7.9/persistent-template-2.5.1.6/src/Database.Persist.TH.html\" rel=\"nofollow noreferrer\">in the source</a> will show exactly where the underscores are added.)</p>\n\n<blockquote>\n  <p>Secondly, why is this this way and not the other way around?</p>\n</blockquote>\n\n<p>Presumably because the library assumes that if you generate the lenses you will use them everywhere instead of the record accessors/labels, including for getting the value of the field. The only cosmetic suggestion I have is that, if the change of writing order from <code>_userName vals</code> to <code>vals ^. userName</code> bothers you, you might prefer using <code>view</code> rather than <code>(^.)</code>, as in <code>view userName vals</code>.</p>\n"}], "owner": {"reputation": 590, "user_id": 3029543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100004855955180/picture?type=large", "display_name": "ptkato", "link": "https://stackoverflow.com/users/3029543/ptkato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 40706023, "answer_count": 1, "score": 1, "last_activity_date": 1479659188, "creation_date": 1479654092, "last_edit_date": 1479659188, "question_id": 40705554, "link": "https://stackoverflow.com/questions/40705554/remove-underscore-from-fields-with-generated-lenses-in-persistent", "title": "Remove underscore from fields with generated lenses in Persistent", "body": "<p>Let's suppose that I have a persistent type and want to project some value from this type:</p>\n\n<pre><code>share [mkPersist sqlSettings, mkMigrate \"migrateAll\"] [persistLowerCase|\n    User\n        name Text\n        email Text\n|]\n...\ngetName :: Entity User -&gt; Text\ngetName (Entity uid vals) = userName vals\n</code></pre>\n\n<p>The problem is, if I generate lenses for said type, using <code>mkPersist sqlSettings {mpsGenerateLenses = True}</code>, I'll need to add a underscore in the beginning of each projection function or use the lenses getter:</p>\n\n<pre><code>getName :: Entity User -&gt; Text\ngetName (Entity uid vals) = _userName vals\n\ngetName' :: Entity User -&gt; Text\ngetName (Entity uid vals) = vals ^. userName\n</code></pre>\n\n<ul>\n<li>Firstly, how can I revert that to the default, <code>userName vals</code>, and add the underscore to use the lenses getter, <code>vals ^. _userName</code>?</li>\n<li>Secondly, why is this this way and not the other way around?</li>\n</ul>\n"}, {"tags": ["haskell", "monads", "free-monad"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1479651414, "post_id": 40704181, "comment_id": 68637953, "body": "If I had to guess, I&#39;d say a lot of the ones you mention were based on the construction of the free group. Certainly the construction of free monoids and semigroups are simplifications thereof, and free semigroupoids and categories then extend those. Free monads are a bit more of a stretch."}], "answers": [{"comments": [{"owner": {"reputation": 448, "user_id": 4416280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c4e7c5ba681838526fb520fc8f36dec?s=128&d=identicon&r=PG&f=1", "display_name": "Zemyla", "link": "https://stackoverflow.com/users/4416280/zemyla"}, "edited": false, "score": 0, "creation_date": 1581280806, "post_id": 40710008, "comment_id": 106369376, "body": "&quot;But you can show that the resulting quotient type is isomorphic to lists.&quot; It really isn&#39;t. For instance, if \uff58 \uff1d \uff2d\uff55\uff4c \uff58 \uff08\uff36\uff41\uff52 \uff07\uff41\uff07\uff09, then there is no list that this is equivalent to. The issue is that the associative law isn&#39;t infinitely associative. See &quot;Free Monoids in Haskell&quot; <a href=\"http://comonad.com/reader/2015/free-monoids-in-haskell/\" rel=\"nofollow noreferrer\">comonad.com/reader/2015/free-monoids-in-haskell</a>"}], "tags": [], "owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "is_accepted": false, "score": 5, "last_activity_date": 1479679992, "creation_date": 1479679992, "answer_id": 40710008, "question_id": 40704181, "link": "https://stackoverflow.com/questions/40704181/how-are-free-objects-constructed/40710008#40710008", "title": "How are free objects constructed?", "body": "\n\n<p>I don't think the notion of \"free\" is as well-defined as you seem to believe.  While I do think the general consensus is that it is indeed a left adjoint of a forgetful functor, the issue lies in what <a href=\"https://ncatlab.org/nlab/show/forgetful+functor\" rel=\"noreferrer\">\"forgetful\"</a> means.  There are clear definitions in some broad-ranging cases, particularly for <a href=\"https://ncatlab.org/nlab/show/concrete+category\" rel=\"noreferrer\">concrete categories</a>.</p>\n\n<p>Universal algebra provides a broad ranging approach which covers almost all \"algebraic\" structures (over sets).  The upshot is given a \"signature\" which consists of sorts, operations, and equations, you build a term algebra (i.e. an AST) of the operations and then quotient it by the equivalence relation generated by the equations.  This is the free algebra generated from that signature.  For example, we usually talk about monoids as being a set equipped with an associative multiplication and unit.  In code, the free algebra before quotienting would be:</p>\n\n<pre><code>data PreFreeMonoid a\n  = Unit\n  | Var a\n  | Mul (PreFreeMonid a) (PreFreeMonoid a)\n</code></pre>\n\n<p>We would then quotient by the equivalence relation generated from the equations:</p>\n\n<pre><code>Mul Unit x = x\nMul x Unit = x\nMul (Mul x y) z = Mul x (Mul y z)\n</code></pre>\n\n<p>But you can show that the resulting quotient type is isomorphic to lists.  In the multi-sorted case, we'd have a family of term algebras, one for each sort.</p>\n\n<p>One way to recast this categorically is to use the notion of a (slightly generalized) <a href=\"https://ncatlab.org/nlab/show/Lawvere+theory\" rel=\"noreferrer\">Lawvere theory</a>.  Given a signature with a set of sorts, <em>S</em>, we can build a small category, call it <strong>T</strong>,  whose objects are lists of elements of <em>S</em>.  These small categories will be called <strong>theories</strong> in general.  Operations get mapped to arrows whose source and target correspond to the appropriate arities.  We freely add \"tupling\" and \"projection\" arrows so that e.g. [<em>A</em>,<em>B</em>,<em>A</em>] becomes the product [<em>A</em>]&times;[<em>B</em>]&times;[<em>A</em>].  Finally, we add commutative diagrams (i.e. equations between arrows) correspond to each equation in the signature.  At this point, <strong>T</strong> essentially represents the term algebra(s).  In fact, an actual interpretation or model of this term algebra is just a finite product preserving functor <strong>T</strong> &rarr; <strong>Set</strong>, write <strong>Mod</strong>(<strong>T</strong>) for the category of finite product preserving functors from <strong>T</strong> &rarr; <strong>Set</strong>.  In the single sorted case, we'd have an underlying set functor, but in general we get a <em>S</em>-indexed family of sets, i.e. we have a functor <em>U</em> : <strong>Mod</strong>(<strong>T</strong>) &rarr; <strong>Set</strong><sup><em>S</em></sup> where we're viewing <em>S</em> as a discrete category here. <em>U</em> is simply <em>U</em>(m)(s)&nbsp;=&nbsp;m([s]).  We can actually calculate the left adjoint.  First, we have a family of sets indexed by elements of <em>S</em>, call it <em>G</em>. Then we need to build a finite product preserving functor <strong>T</strong> &rarr; <strong>Set</strong>, but <em>any</em> functor into <strong>Set</strong> (i.e. <a href=\"https://ncatlab.org/nlab/show/presheaf\" rel=\"noreferrer\">copresheaf</a>) is <a href=\"https://ncatlab.org/nlab/show/co-Yoneda+lemma\" rel=\"noreferrer\">a colimit of representables</a> which, in this case, means it's a quotient of the following (dependent) sum type: </p>\n\n<blockquote>\n  <p>Free(<em>G</em>)(<em>s</em>) = &Sigma;<em>t</em>:<strong>T</strong>.<strong>T</strong>(<em>t</em>,<em>s</em>)&times;Free(<em>G</em>)(<em>t</em>)</p>\n</blockquote>\n\n<p><em>If</em> Free(<em>G</em>) is finite product preserving then in the <em>t</em> = [<em>A</em>,<em>B</em>] case, for example, we'd have:</p>\n\n<blockquote>\n  <p><strong>T</strong>([<em>A</em>,<em>B</em>],<em>s</em>)&times;Free(<em>G</em>)([<em>A</em>,<em>B</em>]) = <strong>T</strong>([<em>A</em>,<em>B</em>],<em>s</em>)&times;Free(<em>G</em>)([<em>A</em>])&times;Free(<em>G</em>)([<em>B</em>])</p>\n</blockquote>\n\n<p>and we simply define Free(<em>G</em>)([<em>A</em>]) = <em>G</em>(<em>A</em>) for each <em>A</em> in <em>S</em> producing:</p>\n\n<blockquote>\n  <p><strong>T</strong>([<em>A</em>,<em>B</em>],<em>s</em>)&times;Free(<em>G</em>)([<em>A</em>])&times;Free(<em>G</em>)([<em>B</em>]) = <strong>T</strong>([<em>A</em>,<em>B</em>],<em>s</em>)&times;<em>G</em>(<em>A</em>)&times;<em>G</em>(<em>B</em>)</p>\n</blockquote>\n\n<p>Altogether this says that, an element of Free(<em>G</em>)([<em>A</em>]) consists of an arrow of <strong>T</strong> into [<em>A</em>] and a list of elements of the appropriate sets corresponding to the source of that arrow, i.e. the arity of the term modulo equations that make it behave sensibly and obey the equations from the signature but which I'm not going to elaborate on.  For the multiplication of a monoid, we'd have an arrow m&nbsp;:&nbsp;[<em>A</em>,<em>A</em>] &rarr; [<em>A</em>] and this would lead to a tuples (m, <em>x</em>, <em>y</em>) where <em>x</em> and <em>y</em> are elements of <em>G</em>(<em>A</em>) corresponding to an term like <code>m(x, y)</code>.  Recasting this definition of as a recursive one takes looking at the equations we're quotienting by.</p>\n\n<p>There are other things to verify to show that Free &dashv; <em>U</em> but it isn't too hard.  Once that's done, <em>U</em>&compfn;Free is a monad on <strong>Set</strong><sup><em>S</em></sup>.</p>\n\n<p>The nice thing about the Lawvere theory approach is that it is easy to generalize in multiple ways.  One straightforward way is to replace <strong>Set</strong> by some other topos <strong>E</strong>.  It's actually the case that the category of directed multigraphs form a topos, but I don't believe you can (easily) view categories as theories over <strong>Graph</strong>.  A different direction to extend Lawvere theories is to consider <a href=\"https://ncatlab.org/nlab/show/doctrine\" rel=\"noreferrer\">doctrines</a> other than finite product preserving functors, in particular finite <em>limit</em> preserving functors aka <a href=\"https://ncatlab.org/nlab/show/exact+functor\" rel=\"noreferrer\">left exact or lex functors</a> is an interesting point.  Both small categories and directed multigraphs (which categorists sometimes call <a href=\"https://ncatlab.org/nlab/show/quiver\" rel=\"noreferrer\">quivers</a>) can be viewed as models of a category with finite limits. There's a straightforward inclusion of the theory of directed multigraphs into the theory of small categories.  This, contravariantly, induces a functor <strong>cat</strong> &rarr; <strong>Graph</strong> simply by precomposition.  The <a href=\"https://ncatlab.org/nlab/show/path+category#free_category_on_a_directed_graph\" rel=\"noreferrer\">left adjoint of this</a> is then (almost) the <a href=\"https://ncatlab.org/nlab/show/Kan+extension#GlobalKanExtensions\" rel=\"noreferrer\">left Kan extensions</a> along that inclusion.  These left Kan extensions will occur in <strong>Set</strong> so ultimately they are just colimits which are just quotients of (dependent) sum types.  (Technically, you need to verify that the resulting Kan extensions are finite limit preserving.  We're also helped by the fact that the models of the theory of graphs are essentially <em>arbitrary</em> functors from the theory of graphs.  This happens because the theory of graphs consists only of unary operations.)</p>\n\n<p>None of this helps for free monads though.  However, it turns out that <a href=\"https://ncatlab.org/nlab/show/transfinite+construction+of+free+algebras\" rel=\"noreferrer\">one construction</a> subsumes all of these including free monads.  Returning to universal algebra, it's the case that every signature with no equations gives rise to a (polynomial) functor whose <a href=\"https://ncatlab.org/nlab/show/initial+algebra+of+an+endofunctor\" rel=\"noreferrer\">initial algebra</a> is the free term algebra.  <a href=\"https://ncatlab.org/nlab/show/initial+algebra+of+an+endofunctor#LambeksTheorem\" rel=\"noreferrer\">Lambek's lemma</a> suggests and it's easy to prove that <a href=\"https://ncatlab.org/nlab/show/initial+algebra+of+an+endofunctor#AdameksTheorem\" rel=\"noreferrer\">the initial algebra is just colimit of repeated applications of the functor</a>.  The above general result is based on a similar approach and the relevant case for free monads is the <a href=\"https://ncatlab.org/nlab/show/transfinite+construction+of+free+algebras#free_algebras_for_unpointed_endofunctors\" rel=\"noreferrer\">unpointed endofunctor case</a>, in which you start to see the definition of <code>Free</code> that you gave, but actually working it out fully requires unfolding many constructions.</p>\n\n<p>Frankly, though, what I'm pretty sure actually happened in the FP world is the following.  If you look at <code>PreFreeMonoid</code>, it's actually a free monad.  <code>PreFreeMonoid Void</code> is the initial algebra for the functor the monoid signature (minus the equations) would give rise to.  If you are familiar with using functors for initial algebras and you even start thinking about universal algebra, you are almost certainly going to end up defining a type like <code>data Term f a = Var a | Op (f (Term f a))</code>.  It's easy to verify this is a monad once you think to ask the question.  If you're even vaguely familiar with the relationship monads have to algebraic structures or to term substitution, then you may ask the question quite quickly.  The same construction can be stumbled upon from a programming language implementation perspective.  If you just directly set your goal to be deriving the free monad construction in Haskell, there are several intuitive ways to arrive at the right definition especially combined with some equational/parametricity-driven reasoning.  In fact, the \"monoid object in the category of endofunctors\" one is quite suggestive.</p>\n\n<p><sub>('really wish this StackExchange had MathJax support.)</sub></p>\n"}], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 5, "answer_count": 1, "score": 8, "last_activity_date": 1479692443, "creation_date": 1479646084, "last_edit_date": 1479692443, "question_id": 40704181, "link": "https://stackoverflow.com/questions/40704181/how-are-free-objects-constructed", "title": "How are free objects constructed?", "body": "<p>So I understand that a free object is defined as being the left-hand side of an adjunction. But how does that lead you to the Haskell definition of such objects?</p>\n\n<p>More concretely: given a \"forgetful functor\" from the category of monads to the category of endofunctors,</p>\n\n<pre><code>newtype Forget m a = Forget (m a)\ninstance Monad m =&gt; Functor (Forget m) where\n    fmap f (Forget x) = Forget (liftM f x)\n</code></pre>\n\n<p>then the <em>free monad</em> <code>Free :: (* -&gt; *) -&gt; (* -&gt; *)</code> is a type admitting (a <code>Monad</code> instance and) the following isomorphism:</p>\n\n<pre><code>type f ~&gt; g = forall x. f x -&gt; g x\n\nfwd :: (Functor f, Monad m) =&gt; (f ~&gt; Forget m) -&gt; (Free f ~&gt; m)\nbwd :: (Functor f, Monad m) =&gt; (Free f ~&gt; m) -&gt; (f ~&gt; Forget m)\n\nfwd . bwd = id = bwd . fwd\n</code></pre>\n\n<p>If we drop the <code>Forget</code>s, for the free monad in <code>Control.Monad.Free</code> we have <code>fwd = foldFree</code> and <code>bwd = (. liftF)</code> (I think?)</p>\n\n<p>But how do these laws lead to the construction found in <code>Control.Monad.Free</code>? How do you come up with <code>data Free f a = Return a | Free (f (Free f a))</code>? Surely you don't just guess until you come up with something that satisfies the laws? Same question goes for the free category of a graph, the free monoid of a set, and any other free object you care to name.</p>\n"}, {"tags": ["haskell", "graph", "profiling", "lazy-evaluation"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1479644183, "post_id": 40703361, "comment_id": 68635783, "body": "A separate matter: <code>IntMap</code> tends to be much faster than <code>Map Int</code>, and <code>IntSet</code> much faster than <code>Set Int</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1479644269, "post_id": 40703361, "comment_id": 68635808, "body": "Please include your imports, by the way."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1479649675, "post_id": 40703361, "comment_id": 68637358, "body": "Also, include sample input and an expected output. Why do you have a hard-coded constant 1501?"}, {"owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1479653247, "post_id": 40703361, "comment_id": 68638527, "body": "@dfeuer i have included the full code link."}, {"owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1479653279, "post_id": 40703361, "comment_id": 68638536, "body": "@chepner i have included sample input/output. but this question is not about input/output as such."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1479655146, "post_id": 40703361, "comment_id": 68639198, "body": "You have a lot of code, some of which is redundant or just &quot;more&quot; than necessary. For example: calling <code>head</code> and <code>drop 1</code> on the same list, when you could simply pattern match: <code>([width, height] : data) = listofListOfInts</code>. Things like this call the efficiency of your overall code into question."}, {"owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1479656610, "post_id": 40703361, "comment_id": 68639689, "body": "@chepner thanks for these tips.. i would try to write it in more idiomatic way and present new changes."}, {"owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1479657707, "post_id": 40703361, "comment_id": 68640111, "body": "@chepner but also, that part of code is same in both situations.. the question is about <code>force</code> and its effects.. I have tried best to not call fns like <code>length</code> (0 calls for length) and always tried to gather data from bottom-up to not calculate things more than once.. But if there is some mistake/suggestions .. please do tell."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1479671179, "post_id": 40703361, "comment_id": 68645112, "body": "What is <code>makeEdge</code>? Honestly, the reason you&#39;re having trouble getting answers is probably that your code is a giant blob. If you break it up into multiple, meaningful, well-documented functions, and include them all, we will be much more willing and able to wade into it."}], "owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479652962, "creation_date": 1479640606, "last_edit_date": 1479652962, "question_id": 40703361, "link": "https://stackoverflow.com/questions/40703361/using-force-vs-time-space-efficiency", "title": "Using force vs time / space efficiency", "body": "<p>Hi I am generating a sparse DAG of 1000 X 1000 nodes each having ~4 edges (direction). Here is the relevant code : <a href=\"https://github.com/ashishnegi/hsalgos/blob/master/src/LongestEdgePathInDAG.hs\" rel=\"nofollow noreferrer\">Full Code with imports</a>\nThe problem i am solving has values between [0-1500]. I have hardcoded 1501 as upper value for now. I am trying to calculate longest path of edges in the DAG. However, these details are not direct part of my question :</p>\n\n<p>My question is related to how to judge the usage of <code>force</code> or similar constructs while writing algos in haskell :</p>\n\n<pre><code>type OutGoingEdges = Map.Map NodeId [ NodeId ]\ntype NodesData = Map.Map NodeId Node\ntype NodeId = Int\n\ndata DAG = AdjList\n           { outGoingEdges :: OutGoingEdges\n           , nodesData :: NodesData\n           } deriving (Eq, Show)\n\nmakeDAG :: DAGDataPath -&gt; IO (DAG, SourceNodes)\nmakeDAG filepath = do\n  listOfListOfInts &lt;- makeInteger &lt;$&gt; readLines filepath\n  let [width, height] = head listOfListOfInts\n      numNodes = width * height\n      rows = (replicate width 1501) : (drop 1 listOfListOfInts) ++ [(replicate width 1501)]\n      heightsWithNodeIdsRows = force . fmap (\\ (row, rowId) -&gt; fmap (\\ (height, colId) -&gt; (height, rowId * width + colId)) $ zip row [1..]) $ zip rows [1..]\n      emptyGraph = AdjList Map.empty $ Map.fromList (fmap (\\(h, nid) -&gt; (nid, Node h)) . concat . tail . init $ heightsWithNodeIdsRows)\n      emptyNodesWithEdges = Set.empty\n      threeRowsInOneGo = zip3 heightsWithNodeIdsRows (drop 1 heightsWithNodeIdsRows) (drop 2 heightsWithNodeIdsRows)\n      (graph, nodesWithInEdges) = DL.foldl' makeGraph (emptyGraph, emptyNodesWithEdges) threeRowsInOneGo\n      sourceNodes = Set.difference (Set.fromList . Map.keys . nodesData $ graph) nodesWithInEdges\n  -- traceShow [take 10 . Map.keys . nodesData $ graph] (return (Set.toList sourceNodes))\n  -- traceShow graph (return (Set.toList sourceNodes))\n  -- traceShow sourceNodes (return (Set.toList sourceNodes))\n  return (graph, force $ Set.toList sourceNodes)\n\n  where\n    makeGraph (graphTillNow, nodesWithInEdges) (prevRow, row, nextRow) =\n      let updownEdges = zip3 prevRow row nextRow\n          (graph', nodesInEdges') = addEdges (graphTillNow, nodesWithInEdges) updownEdges\n          leftRightEdges = zip3 ((1501, 0) : row) (drop 1 row) (drop 2 row)\n          (graph'', nodesInEdges'') = addEdges (graph', nodesInEdges') leftRightEdges\n</code></pre>\n\n<p>Next line is interesting... <code>graph''</code> is <code>DAG</code> and <code>nodesInEdges''</code> is a <code>Set NodeId</code></p>\n\n<pre><code>      in (graph'', nodesInEdges'')\n\n\n    addEdges (g, n) edges =\n      DL.foldl' (\\ (!g', !n') ((p, pId), (c, cId), (n, nId)) -&gt;\n                  let (g'', n'') = if c &gt; p\n                                   then (makeEdge cId pId g', Set.insert pId n')\n                                   else (g', n')\n                      (g''', n''') = if c &gt; n\n                                     then (makeEdge cId nId g'', Set.insert nId n'')\n                                     else (g'', n'')\n                  in (g''', n'''))\n                (g, n)\n                edges\n</code></pre>\n\n<p>While profiling i found that, if i use <code>(force graph'', force nodesInEdges'')</code> instead of <code>(graph'', nodesInEdges'')</code>, <strong>my memory usage reduces from 3 GB to 600 MB. But running time of program increases from 37 secs to 69 secs.</strong> These numbers are from <code>time</code> command and looking at activity monitor. I also checked with profiling and it was similar results.</p>\n\n<p>I am compiling profile builds with :\n<code>stack build --executable-profiling --library-profiling --ghc-options=\"-fprof-auto -auto-all -caf-all -fforce-recomp -rtsopts\" --file-watch</code></p>\n\n<p>I have ghc-7.10.3 and stack 1.1.2.</p>\n\n<p>I think that <code>force</code> goes over the data structure again and again.</p>\n\n<p>Can <code>force</code> be told to not go over the graph if it already fully evaluated ?</p>\n\n<p>Can i use some other strategy ?</p>\n\n<p>Sample Input:</p>\n\n<pre><code>2 2                    -- width height\n1 2\n3 4\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>3\n</code></pre>\n\n<p>Output is length of longest path in the graph. [4 -> 2 -> 1] i.e. [(1,1),(0,1), (0,0)]. Just to remind, correctness of program is not the question;\nspace/time efficiency is. Thanks</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1479635498, "post_id": 40702637, "comment_id": 68633583, "body": "What if you have <code>NumList Banana</code>? How do you average a list of bananas?"}, {"owner": {"reputation": 279, "user_id": 4132944, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7a7cf551c6c4126e231165cfbd254534?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Karmanovas", "link": "https://stackoverflow.com/users/4132944/lukas-karmanovas"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1479635874, "post_id": 40702637, "comment_id": 68633677, "body": "I understand that I should make some kind of instance constraint but don&#39;t really know how to make it. How to tell it that it can only be number list?"}], "answers": [{"comments": [{"owner": {"reputation": 279, "user_id": 4132944, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7a7cf551c6c4126e231165cfbd254534?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Karmanovas", "link": "https://stackoverflow.com/users/4132944/lukas-karmanovas"}, "edited": false, "score": 0, "creation_date": 1479635995, "post_id": 40702706, "comment_id": 68633694, "body": "Damn I am stupid... I was trying <code>Eq (NumList a) =&gt; (Real a)</code> Thanks a lot"}], "tags": [], "owner": {"reputation": 413, "user_id": 5683109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62c83659808b54d9596183ee00c4eb9b?s=128&d=identicon&r=PG&f=1", "display_name": "I3ck", "link": "https://stackoverflow.com/users/5683109/i3ck"}, "is_accepted": true, "score": 5, "last_activity_date": 1479635810, "creation_date": 1479635810, "answer_id": 40702706, "question_id": 40702637, "link": "https://stackoverflow.com/questions/40702637/trying-to-create-haskell-eq-instance/40702706#40702706", "title": "Trying to create Haskell Eq instance", "body": "<p>You need the same type constraints for your Eq instance :  </p>\n\n<pre><code>instance (Real a) =&gt; Eq (NumList a) where\n    (Nlist x) == (Nlist y) = (average x) == (average y)`\n</code></pre>\n"}], "owner": {"reputation": 279, "user_id": 4132944, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7a7cf551c6c4126e231165cfbd254534?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Karmanovas", "link": "https://stackoverflow.com/users/4132944/lukas-karmanovas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 40702706, "answer_count": 1, "score": 1, "last_activity_date": 1479635810, "creation_date": 1479635317, "question_id": 40702637, "link": "https://stackoverflow.com/questions/40702637/trying-to-create-haskell-eq-instance", "title": "Trying to create Haskell Eq instance", "body": "<p>I am trying to create an Eq instance for my created list type. The Eq should return true only if both list averages are equal.</p>\n\n<pre><code>average :: (Real a, Fractional b) =&gt; [a] -&gt; b\naverage xs \n     | xs == [] = 0\n     | otherwise = realToFrac (sum xs) / genericLength xs\n\ndata NumList a = Nlist [a]\n\ninstance Eq (NumList a) where\n    (Nlist x) == (Nlist y) = (average x) == (average y)`\n</code></pre>\n\n<p>But when I try to compile this I get error:</p>\n\n<pre><code>No instance for (Real a) arising from a use of \u2018average\u2019\n Possible fix:\n  add (Real a) to the context of the instance declaration\n In the first argument of \u2018(==)\u2019, namely \u2018(average x)\u2019\n In the expression: (average x) == (average y)\n In an equation for \u2018==\u2019:\n (Nlist x) == (Nlist y) = (average x) == (average y)\n</code></pre>\n\n<p>I am not good with haskell and trying to learn it, could some one help me with this error?</p>\n"}, {"tags": ["debugging", "haskell", "ghci"], "comments": [{"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1479695406, "post_id": 40702385, "comment_id": 68651764, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/21518584/sprint-for-polymorphic-values\">:sprint for polymorphic values?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "edited": false, "score": 0, "creation_date": 1479637359, "post_id": 40702508, "comment_id": 68634020, "body": "but when i did <code>seq y y</code>.. it printed value.. should not now the <code>thunk</code> of <code>y</code> be evaluated ? Is it that <code>:sprint</code> would still not show us that because of polymorphic nature of y ?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 2, "creation_date": 1479655383, "post_id": 40702508, "comment_id": 68639273, "body": "Actually <code>seq y ()</code> will specialize <code>y</code> to the default types, so it will evaluate <code>y&#39; NumInteger NumInteger OrdInteger</code> (to a <code>Bin</code> constructor). But that doesn&#39;t change the fact that <code>y</code> is internally a function so <code>:sprint</code> will always display it as <code>_</code>."}], "tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 4, "last_activity_date": 1479634348, "creation_date": 1479634348, "answer_id": 40702508, "question_id": 40702385, "link": "https://stackoverflow.com/questions/40702385/why-sprint-is-showing-whnf-even-when-i-evaluate-the-variable/40702508#40702508", "title": "Why :sprint is showing WHNF even when i evaluate the variable?", "body": "<p>The short answer is that <code>:sprint</code> is leaky.</p>\n\n<p>The long answer is because your <code>y</code> value is polymorphic:</p>\n\n<pre><code>\u03bb&gt; let y = insert 1 (1 + 1, \"str\") empty\n\u03bb&gt; :t y\ny :: (Num k, Num t, Ord k) =&gt; Map k (t, [Char])\n</code></pre>\n\n<p>In this case <code>seq y ()</code> will not be able to evaluate down to the map. Imagine the type of <code>y</code> as the runtime would represent it: <code>y' :: NumDict k -&gt; NumDict t -&gt; OrdDict k -&gt; Map k (t, String)</code>. <code>seq y' ()</code> would fail to evaluate <code>y'</code> down to the point where we could <code>:sprint</code> its <code>Data.Map.Map</code> data structure because still have yet to specify which <code>Num</code> and <code>Ord</code> instances we want.</p>\n\n<p>As a counter-example:</p>\n\n<pre><code>\u03bb&gt; let y = insert 1 (1 + 1, \"str\") empty :: Map Int (Int, String)\n\u03bb&gt; :t y\ny :: Map Int (Int, String)\n\u03bb&gt; :sprint y\ny = _\n\u03bb&gt; seq y ()\n()\n\u03bb&gt; :sprint y\ny = containers-0.5.6.2:Data.Map.Base.Bin\n      1 1 (_,_) containers-0.5.6.2:Data.Map.Base.Tip\n      containers-0.5.6.2:Data.Map.Base.Tip\n</code></pre>\n\n<p>Here we see that by eliminating the polymorphism we get the expected behavior. Which circles us back to <code>:sprint</code> as a leaky command: to correctly predict its output it requires us to know more about the runtime representation of values that we think we should; it surprises us by living at the intersection of polymorphic literals, type inference, and thunks.</p>\n"}], "owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 40702508, "answer_count": 1, "score": 2, "last_activity_date": 1479695420, "creation_date": 1479633214, "last_edit_date": 1479695420, "question_id": 40702385, "link": "https://stackoverflow.com/questions/40702385/why-sprint-is-showing-whnf-even-when-i-evaluate-the-variable", "title": "Why :sprint is showing WHNF even when i evaluate the variable?", "body": "<p>This is the code i am playing around with :</p>\n\n<pre><code>*Main DepthFirstSearch DivideAndConquer Fibonacci LongestEdgePathInDAG&gt; let x = Data.Map.empty\n*Main DepthFirstSearch DivideAndConquer Fibonacci LongestEdgePathInDAG&gt; let y = Data.Map.insert 1 (1+1,\"ashish\") x\n*Main DepthFirstSearch DivideAndConquer Fibonacci LongestEdgePathInDAG&gt; :sprint x\nx = containers-0.5.7.1:Data.Map.Base.Tip\n*Main DepthFirstSearch DivideAndConquer Fibonacci LongestEdgePathInDAG&gt; :sprint y\ny = _\n*Main DepthFirstSearch DivideAndConquer Fibonacci LongestEdgePathInDAG&gt; y == x\nFalse\n*Main DepthFirstSearch DivideAndConquer Fibonacci LongestEdgePathInDAG&gt; :sprint y\ny = _\n*Main DepthFirstSearch DivideAndConquer Fibonacci LongestEdgePathInDAG&gt; seq y y\nfromList [(1,(2,\"ashish\"))]\n*Main DepthFirstSearch DivideAndConquer Fibonacci LongestEdgePathInDAG&gt; :sprint y\ny = _\n*Main DepthFirstSearch DivideAndConquer Fibonacci LongestEdgePathInDAG&gt;\n</code></pre>\n\n<p>I can not understand why <code>:sprint y</code> is always showing <code>_</code> ?</p>\n\n<p>I have</p>\n\n<pre><code>\u279c  hsalgos git:(master) \u2717 stack --version\nVersion 1.1.2 x86_64 hpack-0.14.0\n\u279c  hsalgos git:(master) \u2717\n</code></pre>\n\n<p>and <code>ghc 7.10.3</code></p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5484032, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-CIzwVm-CRlE/AAAAAAAAAAI/AAAAAAAAAAw/MksXD0Na5f4/photo.jpg?sz=128", "display_name": "Shahzad", "link": "https://stackoverflow.com/users/5484032/shahzad"}, "edited": false, "score": 0, "creation_date": 1479627207, "post_id": 40701622, "comment_id": 68631863, "body": "Well you explain very technically . Thank you @mnoronha . You are kind :)"}], "tags": [], "owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "is_accepted": true, "score": 2, "last_activity_date": 1479627262, "last_edit_date": 1479627262, "creation_date": 1479626355, "answer_id": 40701622, "question_id": 40701595, "link": "https://stackoverflow.com/questions/40701595/map-function-is-not-working-properly/40701622#40701622", "title": "Map function is not working properly?", "body": "<p>Let's look at the definition of <code>map</code> in <code>Prelude</code>:</p>\n\n<pre><code>map _ []     = []\nmap f (x:xs) = f x : map f xs\n</code></pre>\n\n<p>Here, we see that <code>map</code> is defined to pass each value in a list to the function that's being applied. Further, we don't need a base case because <code>map</code> handles the recursion. Thus, you should rewrite <code>compPic</code> as:</p>\n\n<pre><code>compPic :: [String] -&gt; [String]\ncompPic as = map compL as\n</code></pre>\n\n<p>Or, eta-reduced:</p>\n\n<pre><code>compPic = map compL\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5484032, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-CIzwVm-CRlE/AAAAAAAAAAI/AAAAAAAAAAw/MksXD0Na5f4/photo.jpg?sz=128", "display_name": "Shahzad", "link": "https://stackoverflow.com/users/5484032/shahzad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 40701622, "answer_count": 1, "score": 0, "last_activity_date": 1479627262, "creation_date": 1479626051, "question_id": 40701595, "link": "https://stackoverflow.com/questions/40701595/map-function-is-not-working-properly", "title": "Map function is not working properly?", "body": "<p>Map functions is not working on this line </p>\n\n<p><code>compPic  (a:as) = map (compL a) as</code></p>\n\n<p>It just work on single string but not on a list of string can you find error.</p>\n\n<pre><code>compL  :: String -&gt; String\ncompL  bs = [a | b &lt;- bs, a &lt;- \n                if (b == ' ')\n                   then \"X\"\n                 else if (b=='X')\n                   then \" \"\n                   else [b]]\n\n\ncompPic :: [String] -&gt; [String]\ncompPic  [] = []\ncompPic  (a:as) = map (compL a) as\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1479614675, "post_id": 40700480, "comment_id": 68629932, "body": "What is the type of the function you&#39;re trying to write?"}, {"owner": {"reputation": 33, "user_id": 5484032, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-CIzwVm-CRlE/AAAAAAAAAAI/AAAAAAAAAAw/MksXD0Na5f4/photo.jpg?sz=128", "display_name": "Shahzad", "link": "https://stackoverflow.com/users/5484032/shahzad"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1479614876, "post_id": 40700480, "comment_id": 68629970, "body": "I am facing problem on <i>list</i> as <code>showMatDownAttach</code> get [String]  . I am not good in english to explain but the code I hope you will understand what actual problem is. I hope you will understand my problem in this line.  <code>list x ab = (showMatUpAttach x ((showMatDownAttach x ab)))</code>"}, {"owner": {"reputation": 33, "user_id": 5484032, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-CIzwVm-CRlE/AAAAAAAAAAI/AAAAAAAAAAw/MksXD0Na5f4/photo.jpg?sz=128", "display_name": "Shahzad", "link": "https://stackoverflow.com/users/5484032/shahzad"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1479615126, "post_id": 40700480, "comment_id": 68630015, "body": "@ChrisMartin can you tell me how to convert IO() -&gt; [String] this is my problem?"}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 2, "creation_date": 1479615229, "post_id": 40700480, "comment_id": 68630038, "body": "That&#39;s impossible. There is very little you can do with a value of type <code>IO ()</code>. I think your mistake is that <code>showMatDownAttach</code> should typed as <code>Char -&gt; [String] -&gt; String</code>, not <code>Char -&gt; [String] -&gt; IO()</code>, and it should not include <code>putStr</code>. In other words, you should return the String, not print it. Avoid involving <code>IO</code> for as long as possible."}, {"owner": {"reputation": 33, "user_id": 5484032, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-CIzwVm-CRlE/AAAAAAAAAAI/AAAAAAAAAAw/MksXD0Na5f4/photo.jpg?sz=128", "display_name": "Shahzad", "link": "https://stackoverflow.com/users/5484032/shahzad"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1479615347, "post_id": 40700480, "comment_id": 68630053, "body": "@ChrisMartin i checked the type of <code>putStr</code> this just return <code>IO()</code> then how I can write <code>String</code>."}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1479615504, "post_id": 40700480, "comment_id": 68630071, "body": "I mean you should do this: <code>showMatUpAttach :: Char -&gt; [String] -&gt; String</code>; <code>showMatUpAttach a strList = concat (stretch 1 1 (upattach a strList))</code>"}, {"owner": {"reputation": 33, "user_id": 5484032, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-CIzwVm-CRlE/AAAAAAAAAAI/AAAAAAAAAAw/MksXD0Na5f4/photo.jpg?sz=128", "display_name": "Shahzad", "link": "https://stackoverflow.com/users/5484032/shahzad"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1479615549, "post_id": 40700480, "comment_id": 68630081, "body": "I&#39;m using <code>putStr</code> a purpose. I think you will understand properly if you check my code on gist . Can you please view . <a href=\"https://gist.github.com/badarshahzad/3108ac7cffacaaa5d7781268f78ca88f\" rel=\"nofollow noreferrer\">gist.github.com/badarshahzad/3108ac7cffacaaa5d7781268f78ca88&zwnj;&#8203;f</a>"}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1479615586, "post_id": 40700480, "comment_id": 68630084, "body": "Please include all relevant code <i>here</i>. You can edit the question."}, {"owner": {"reputation": 33, "user_id": 5484032, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-CIzwVm-CRlE/AAAAAAAAAAI/AAAAAAAAAAw/MksXD0Na5f4/photo.jpg?sz=128", "display_name": "Shahzad", "link": "https://stackoverflow.com/users/5484032/shahzad"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1479615682, "post_id": 40700480, "comment_id": 68630098, "body": "@ChrisMartin then i will face another problem that will be <code>\\n</code> that I am using for attach with a list of string. This <code>putStr</code> actually helping me for <code>\\n</code> for new line."}, {"owner": {"reputation": 33, "user_id": 5484032, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-CIzwVm-CRlE/AAAAAAAAAAI/AAAAAAAAAAw/MksXD0Na5f4/photo.jpg?sz=128", "display_name": "Shahzad", "link": "https://stackoverflow.com/users/5484032/shahzad"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1479615714, "post_id": 40700480, "comment_id": 68630101, "body": "Ok I am editing again"}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1479616449, "post_id": 40700480, "comment_id": 68630215, "body": "<i>How</i> do you want to combine these Strings? What output do you want your program to produce?"}, {"owner": {"reputation": 33, "user_id": 5484032, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-CIzwVm-CRlE/AAAAAAAAAAI/AAAAAAAAAAw/MksXD0Na5f4/photo.jpg?sz=128", "display_name": "Shahzad", "link": "https://stackoverflow.com/users/5484032/shahzad"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1479616998, "post_id": 40700480, "comment_id": 68630289, "body": "I added the image for your view i want a frame like in picture mention."}], "answers": [{"tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": true, "score": 1, "last_activity_date": 1479624930, "last_edit_date": 1479624930, "creation_date": 1479622365, "answer_id": 40701235, "question_id": 40700480, "link": "https://stackoverflow.com/questions/40700480/how-to-change-io-into-string-in-haskell/40701235#40701235", "title": "How to change IO() into [String] in Haskell?", "body": "<p><code>IO ()</code> is a very opaque type; there isn't much you can do with it, and there isn't any meaningful way to convert it to <code>[String]</code>. Once you're in <code>IO</code>, you can't get out of it.</p>\n\n<p>Generally in Haskell you write most of your code without using <code>IO</code>. Here's a solution to the problem to demonstrate what I mean. Notice that all of the \"frame\" code is defined with pure functions, and <code>IO</code> doesn't get introduced until <code>main</code> at the very end.</p>\n\n<pre><code>import Data.Foldable (traverse_)\nimport Data.List (repeat)\n\nframe1 :: a -&gt; [a] -&gt; [a]\nframe1 f xs = [f] ++ xs ++ [f]\n\nframe2 :: a -&gt; [[a]] -&gt; [[a]]\nframe2 f grid = frame1 edge $ frame1 f &lt;$&gt; grid\n  where edge = take (width grid + 2) $ repeat f\n\nwidth :: [[a]] -&gt; Int\nwidth [] = 0\nwidth (x:_) = length x\n\na :: [[Char]]\na = [ \"  aaaaa  \"\n    , \" a     a \"\n    , \" a     a \"\n    , \" aaaaaaa \"\n    , \" a     a \"\n    , \" a     a \"\n    , \" a     a \"\n    ]\n\nmain :: IO ()\nmain = traverse_ putStrLn $ foldr frame2 a \"* &amp;\"\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>***************\n*             *\n* &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp; *\n* &amp;  aaaaa  &amp; *\n* &amp; a     a &amp; *\n* &amp; a     a &amp; *\n* &amp; aaaaaaa &amp; *\n* &amp; a     a &amp; *\n* &amp; a     a &amp; *\n* &amp; a     a &amp; *\n* &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp; *\n*             *\n***************\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 1, "creation_date": 1479623440, "post_id": 40701263, "comment_id": 68631246, "body": "The closest you could get with this approach would be to convert <code>IO ()</code> to <code>IO [String]</code>, right? Not <code>IO ()</code> to <code>[String]</code> as requested."}, {"owner": {"reputation": 17507, "user_id": 111021, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6b1a4aaa3c76925b2923327f9556a738?s=128&d=identicon&r=PG", "display_name": "kizzx2", "link": "https://stackoverflow.com/users/111021/kizzx2"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1479652214, "post_id": 40701263, "comment_id": 68638187, "body": "@ChrisMartin While I believe my answer &quot;more closely&quot; answered the actual question asked (i.e. &quot;what he probably actually wanted), what you said is totally true as well. The &quot;real&quot; answer to the literal question is basically, stated in your answer&#39;s starting sentence."}], "tags": [], "owner": {"reputation": 17507, "user_id": 111021, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6b1a4aaa3c76925b2923327f9556a738?s=128&d=identicon&r=PG", "display_name": "kizzx2", "link": "https://stackoverflow.com/users/111021/kizzx2"}, "is_accepted": false, "score": 0, "last_activity_date": 1479622636, "last_edit_date": 1495541233, "creation_date": 1479622636, "answer_id": 40701263, "question_id": 40700480, "link": "https://stackoverflow.com/questions/40700480/how-to-change-io-into-string-in-haskell/40701263#40701263", "title": "How to change IO() into [String] in Haskell?", "body": "<p>So, <code>IO ()</code> encapsulates all side-effects and is not just about console output. So pedantically there is no way to \"change <code>IO ()</code> to <code>[String]</code>\"</p>\n\n<p>With that said, I believe <a href=\"https://hackage.haskell.org/package/system-posix-redirect-1.1.0.1/docs/System-Posix-Redirect.html\" rel=\"nofollow noreferrer\"><code>System.Posix.Redirect</code></a> is what you are looking for. You just want to call <code>showMatDownAttach</code> to capture <code>stdout</code> to get the <code>[String]</code> you want.</p>\n\n<p>A quick Google search reveals a couple more packages to do this as well:</p>\n\n<ul>\n<li><a href=\"https://hackage.haskell.org/package/io-capture\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/io-capture</a></li>\n<li><a href=\"https://hackage.haskell.org/package/silently\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/silently</a></li>\n</ul>\n\n<p>Now doing this is not very idiomatic Haskell and if you have access to <code>showMatDownAttach</code> you'll want to change it to something like what <a href=\"https://stackoverflow.com/a/40701235/111021\">https://stackoverflow.com/a/40701235/111021</a> suggests. But since you ask this question I believe you already considered that and somehow that's not an option.</p>\n"}], "owner": {"reputation": 33, "user_id": 5484032, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-CIzwVm-CRlE/AAAAAAAAAAI/AAAAAAAAAAw/MksXD0Na5f4/photo.jpg?sz=128", "display_name": "Shahzad", "link": "https://stackoverflow.com/users/5484032/shahzad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 0, "accepted_answer_id": 40701235, "answer_count": 2, "score": -2, "last_activity_date": 1479624930, "creation_date": 1479613513, "last_edit_date": 1479617339, "question_id": 40700480, "link": "https://stackoverflow.com/questions/40700480/how-to-change-io-into-string-in-haskell", "title": "How to change IO() into [String] in Haskell?", "body": "<p>I am making a frame that print a character frame around a character as I show below. </p>\n\n<p>This is example of frame. Example to understand what I actual frame is and What i am want from all these function right, left, up and down:</p>\n\n<p><img src=\"https://i.stack.imgur.com/tceR4.png\" alt=\"\"></p>\n\n<p><code>a</code> is list of string that is <code>A</code>.</p>\n\n<pre><code>Main&gt; showMatDownAttach '@' a\n  aaaaa  \n a     a \n a     a \n aaaaaaa \n a     a \n a     a \n a     a \n@@@@@@@@@\n\nMain&gt; showMatDownAttach '@' a\n  aaaaa  \n a     a \n a     a \n aaaaaaa \n a     a \n a     a \n a     a \n@@@@@@@@@\n</code></pre>\n\n<p>I also have for right and left. Now I want to make a function that can combine all of them in one function. How I can do this?</p>\n\n<pre><code>a = [\"  aaaaa  \",\" a     a \",\" a     a \",\" aaaaaaa \",\" a     a \",\" a     a \",\" a     a \"] \n\n--badar = putStr( concat (map (++ \"\\n\")(letter 'a')))\n\n--showMat ::  Char -&gt; IO()\n--showMat ch = putStr (concat ( map(++ \"\\n\") (letter 'a')))\n\n\nreplicateIt :: Int -&gt; [Char] -&gt; [Char]\nreplicateIt x ls=take x (cycle ls)\n\n\n--repeatIt :: Int -&gt; [Char] -&gt; [[Char]]\nrepeatIt num []=[]\nrepeatIt num (x:sx)= replicateIt num [x]:(repeatIt num sx)\n\nhStretchChar :: Int  -&gt; Char  -&gt; String \nhStretchChar i ch = replicate i ch\n\nhStretchString :: Int -&gt; String -&gt; String \nhStretchString i sts = concat ( map ( hStretchChar i) sts)\n\nhStretchListOfString :: Int -&gt; [String] -&gt; [String]\nhStretchListOfString i stlist = map (hStretchString i ) stlist\n\nvStretchString :: Int -&gt; String -&gt; String\nvStretchString i str = concat (replicate i (str ++ \"\\n\"))\n\nvStretchListOfString :: Int -&gt; [String] -&gt; [String]\nvStretchListOfString  i strList = map (vStretchString i) strList\n\n\nstretch :: Int -&gt; Int -&gt; [String] -&gt; [String]\nstretch i j strList = vStretchListOfString i (hStretchListOfString  j strList)\n\nshowMat' :: [String] -&gt; IO()\nshowMat' strList = putStr (concat  (stretch 1 1 strList))\n\n--Left Attach Character\nleftattach :: Char -&gt; [String] -&gt; [String]\nleftattach a strlist =  map ( a: ) strlist \n\nshowMatCharAttachLeft :: Char -&gt; [String] -&gt; IO()\nshowMatCharAttachLeft a strList = putStr (concat  (stretch 1 1 ( leftattach a strList)))\n\n\ncharToString :: Char -&gt; String\ncharToString a = a:[]\n\n--Right Attach Character\nrightattach :: Char -&gt; [String] -&gt; [String]\nrightattach a strlist = map (++(charToString a)) strlist\n\nshowMatCharAttachRight :: Char -&gt; [String] -&gt; IO()\nshowMatCharAttachRight a strList = putStr (concat  (stretch 1 1 ( rightattach a strList)))\n\n--Up Attach Character\nupattach :: Char -&gt; [String] -&gt; [String]\nupattach a strList = take (length (head strList)) (cycle (charToString a)) : strList\n\nshowMatUpAttach :: Char -&gt; [String] -&gt; IO()\nshowMatUpAttach a strList = putStr (concat (stretch 1 1 (upattach a strList)))\n\n\n--Down Attach Character\ndownattach :: Char -&gt; [String] -&gt; [String]\ndownattach a strList = strList ++ listOfCharTolistOfString (take (length (head strList)) (cycle (charToString a)))\n\nshowMatDownAttach :: Char -&gt; [String] -&gt; IO()\nshowMatDownAttach a strList = putStr (concat (stretch 1 1 (downattach a strList))) \n--test0 a strList = listOfCharTolistOfString (take (length (head strList)) (cycle (charToString a)))\n\nlistOfCharTolistOfString :: [Char] -&gt; [String]\nlistOfCharTolistOfString a = a:[]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1479607123, "post_id": 40699872, "comment_id": 68628782, "body": "It&#39;s like saying <code>main = main</code>. You&#39;ve defined equality as a recursive call to itself."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1479631486, "post_id": 40699872, "comment_id": 68632712, "body": "In the future, please post the image text, not the image. Most terminals will let cut&amp;paste from them in some way. Images containing text are frowned upon here on SO."}], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 8, "last_activity_date": 1479607240, "last_edit_date": 1479607240, "creation_date": 1479607188, "answer_id": 40699919, "question_id": 40699872, "link": "https://stackoverflow.com/questions/40699872/brand-new-to-haskell-why-does-this-function-loop-forever/40699919#40699919", "title": "Brand new to Haskell, why does this function loop forever?", "body": "<p>You're defining the <code>==</code> operator by saying that <code>a</code> is equal to <code>a'</code> iff <code>a</code> is equal to <code>a'</code>. Logically this is a tautology.</p>\n\n<p>In terms of program logic it's an infinite loop, as applying the <code>==</code> function to two arguments will apply it again to those same arguments, infinitely.</p>\n\n<p>What you probably intended to do was to use <code>==</code> to compare the integers wrapped in your <code>AnInteger</code>s, rather than the <code>AnInteger</code>s themselves. To do this, you'll first need to use pattern matching to unwrap them like this:</p>\n\n<pre><code>(A a) == (A a') = a == a'\n</code></pre>\n"}], "owner": {"reputation": 1604, "user_id": 2877471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/caa140aba97cc5f1cf9d6688e1292d91?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/2877471/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 40699919, "answer_count": 1, "score": 1, "last_activity_date": 1479607240, "creation_date": 1479606810, "last_edit_date": 1479607217, "question_id": 40699872, "link": "https://stackoverflow.com/questions/40699872/brand-new-to-haskell-why-does-this-function-loop-forever", "title": "Brand new to Haskell, why does this function loop forever?", "body": "<p><strong>Context:</strong> I am less than a week into figuring Haskell out, I'm enjoying myself so far, but this one is stumping me. This seems the simplest example that demonstrates my problem:</p>\n\n<p>I have the following Type defined.</p>\n\n<pre><code>data AnInteger = A Integer\ninstance Eq AnInteger where\n  a == a' = a == a'\n</code></pre>\n\n<p>But when I try to use it </p>\n\n<p><a href=\"https://i.stack.imgur.com/5YIDz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5YIDz.png\" alt=\"Screenshot of ghci infinite looping\"></a></p>\n\n<p>I get what appears to be an infinite loop. What's going on here that I'm not getting? </p>\n\n<p>How can I correct the syntax to provide the desired output of <strong>True</strong>?</p>\n"}, {"tags": ["haskell", "functor", "category-theory"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1479601985, "post_id": 40699212, "comment_id": 68627866, "body": "Something makes me think you might appreciate the <code>MemoTrie</code> package."}, {"owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1479602639, "post_id": 40699212, "comment_id": 68627997, "body": "Should the question be moved elsewhere if it&#39;s not suitable here? E.g. to CodeReview SO?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1479611468, "post_id": 40699212, "comment_id": 68629491, "body": "Definitely not code review."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1479629510, "post_id": 40699212, "comment_id": 68632331, "body": "I&#39;m not sure this can fully work. How would you dump all key-value pairs of such a map? For example, how would <code>show</code> work?"}, {"owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "edited": false, "score": 0, "creation_date": 1479661500, "post_id": 40699212, "comment_id": 68641484, "body": "Updated the question. <code>MapPK</code> cannot fully work as we lose some old capabilities like showing/enumeration/traversals. We gain some new capabilities so the construction is not necessarily useless."}], "owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 164, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1479660855, "creation_date": 1479599653, "last_edit_date": 1479660855, "question_id": 40699212, "link": "https://stackoverflow.com/questions/40699212/making-data-map-a-contravariant-functor", "title": "Making Data.Map a contravariant functor", "body": "<p><code>Data.Map.Map</code> is not a contravariant functor because of <code>Ord key =&gt;</code> constraint. But we can pack it with a helper function into an existential:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\nimport qualified Data.Map as M\nimport Data.Profunctor\n\ndata MapPK k v where\n    MapPK :: Ord i =&gt; (k -&gt; i) -&gt; M.Map i v -&gt; MapPK k v\n\ninstance Profunctor MapPK where\n    dimap f g (MapPK ff mm) = MapPK (f `lmap` ff) (g `fmap` mm)\n</code></pre>\n\n<p>I used <code>Profunctor</code>, but it's a technical detail: <code>lmap f = dimap f id</code> is a <code>contramap</code>. I also used <code>lmap</code> instance of <code>(-&gt;) a b</code>, sorry if it is confusing.</p>\n\n<p><code>MapPK</code> is useful in practice - it's essentially a map with computed keys, so it wastes CPU cycles but may save space. We can implement <code>Data.Map.lookup</code> for it:</p>\n\n<pre><code>lookupPK k (MapPK f m) = M.lookup (f k) m\n</code></pre>\n\n<p>I want to turn this idea into a library. Any tips on modern key-value container interface? For <code>MapPK</code> to be generally useful more functions should be implemented (e.g. insertion-deletion). </p>\n\n<p>However reusing function names from <code>Data.Map</code> seems antique to me. Should I look at providing <code>Data.Lens.At</code> instances instead?</p>\n\n<p>Upd: <code>Data.Containers.IsMap</code> from <code>mono-traversable</code> cannot be implemented, as there is no way to get the list of keys. Also folds/traversals cannot. We cannot even <code>show</code> our \"map\".</p>\n\n<p>In a sense, <code>MapPK</code> is not a normal map any more, but falls into a category of weird map-like things along with <code>type FunctionalMap k v = k -&gt; Maybe v</code>.</p>\n\n<p>Enumeration of values while possible is not very useful. if <code>f = const 5</code>, the map contains at most one value, so most of the values in the internal <code>Data.Map</code> are garbage but we cannot know that.</p>\n\n<p>And even if we could magically invert <code>f</code> that won't help us much as the inverse does not always exist and even if it is there are problems with non-monotonic <code>f</code> that happen to have an inverse.</p>\n\n<p>Note that we also gain some capabilities. Unlike <code>FunctionalMap</code>, our <code>insert</code> can be implemented just as efficiently as it is in <code>Data.Map</code>. And unlike <code>Data.Map</code>, some exotic keys are possible - now we can have functions as keys. But not all - <code>IO Int</code> is possible to use as a \"key\" in <code>FunctionalMap</code>, but not in <code>MapPK</code>.</p>\n"}, {"tags": ["haskell", "types", "typeclass", "records"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1479595725, "post_id": 40698396, "comment_id": 68626644, "body": "A starting point for this would be to look up how GHC handles plugins and how Yi handles configuration. Both take a partial recompile approach I think..."}, {"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 1, "creation_date": 1479598607, "post_id": 40698396, "comment_id": 68627249, "body": "Sounds like a case for <a href=\"https://hackage.haskell.org/package/vault\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/vault</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "edited": false, "score": 0, "creation_date": 1479664763, "post_id": 40702135, "comment_id": 68642782, "body": "It&#39;s a bit awkward to work with when applying (I have to unpack the transition function, apply it, then repack the state AND the transition function back up into a new Plugin to be returned), but aside from that it works like a charm! Thanks!"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "edited": false, "score": 0, "creation_date": 1479672802, "post_id": 40702135, "comment_id": 68645632, "body": "@Chris Penner The packing-unpacking can be handled by a single function like <code>handleEvent</code>, though. Also, the <code>Plugin</code> type should have strict fields to avoid space leaks."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 2, "last_activity_date": 1479637516, "last_edit_date": 1479637516, "creation_date": 1479631102, "answer_id": 40702135, "question_id": 40698396, "link": "https://stackoverflow.com/questions/40698396/how-can-i-handle-user-plugins-in-my-types/40702135#40702135", "title": "How can I Handle user plugins in my types?", "body": "<blockquote>\n  <p>Of course each Plugin is going to have a different Type for the Plugin state, so I'm getting stuck on how I can integrate this into my system in a general way.</p>\n</blockquote>\n\n<p>Perhaps you could use an <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#existentially-quantified-data-constructors\" rel=\"nofollow noreferrer\">existential type</a> to hide the plugin state, something like</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\n\ndata Plugin = forall ps. Plugin { \n       currentState :: ps\n    ,  transition :: ps -&gt; EditorState -&gt; Event -&gt; (ps, EditorState) \n    }\n\nhandleEvent :: Plugin -&gt; EditorState -&gt; Event -&gt; (Plugin,EditorState)\nhandleEvent (Plugin ps t) es e =\n    let (ps',es') = t ps es e\n    in  (Plugin ps' t,es')\n</code></pre>\n\n<p>Now each plugin is of the same type, and yet different plugin values can have internal states of different types:</p>\n\n<pre><code>charPlugin :: Plugin\ncharPlugin = Plugin 'a' (\\ps es e -&gt; (succ ps,es))\n\nintPlugin :: Plugin\nintPlugin = Plugin (1::Int) (\\ps es e -&gt; (succ ps,es))\n</code></pre>\n\n<p>(I took inspiration from the <a href=\"http://hackage.haskell.org/package/foldl-1.2.1/docs/Control-Foldl.html#t:Fold\" rel=\"nofollow noreferrer\"><code>Fold</code></a> type from the <em>foldl</em> package, which uses existentials in a similar way.)</p>\n\n<p>You can now have a list of plugins:</p>\n\n<pre><code>plugins :: [Plugin]\nplugins = [charPlugin,intPlugin]\n</code></pre>\n\n<p>A possible evolution of the design would be to constrain the internal states to be instances of some typeclass:</p>\n\n<pre><code>data Plugin = forall ps. Show ps =&gt; Plugin { \n       currentState :: ps\n    ,  transition :: ps -&gt; EditorState -&gt; Event -&gt; (ps, EditorState) \n    }\n</code></pre>\n\n<hr>\n\n<p>I suspect a <code>Monoid</code> instance could be defined for the <code>Plugin</code> type.</p>\n\n<p>Also, we could think of explicitly parameterizing <code>Plugin</code> on the type of events it accepts, like </p>\n\n<pre><code>data Plugin e = ...\n</code></pre>\n\n<p>In that case Plugin could be made an instance of <a href=\"http://hackage.haskell.org/package/contravariant-1.4/docs/Data-Functor-Contravariant.html#t:Contravariant\" rel=\"nofollow noreferrer\"><code>Contravariant</code></a> and perhaps <a href=\"http://hackage.haskell.org/package/contravariant-1.4/docs/Data-Functor-Contravariant-Divisible.html#t:Divisible\" rel=\"nofollow noreferrer\"><code>Divisible</code></a> as well.</p>\n\n<p>And if we go wild and parameterize on the editor state</p>\n\n<pre><code>data Plugin es e = ...\n</code></pre>\n\n<p>then perhaps we could find a way to \"zoom\" a given plugin to work in a more general state than the one for which it was defined.</p>\n"}], "owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 2, "accepted_answer_id": 40702135, "answer_count": 1, "score": 2, "last_activity_date": 1479637516, "creation_date": 1479592944, "question_id": 40698396, "link": "https://stackoverflow.com/questions/40698396/how-can-i-handle-user-plugins-in-my-types", "title": "How can I Handle user plugins in my types?", "body": "<p>I'm writing a modular and extensible text editor in Haskell and I'd like to implement plugins in such a way: The writer of the plugin provides a single function that looks something like this:</p>\n\n<pre><code>handleEvent :: (PluginState, EditorState) -&gt; Event -&gt; (PluginState, EditorState)\n</code></pre>\n\n<p>As each event occurs the plugin can use the current editor state and customized chunk of its own state to calculate a new editor state and new plugin state. Of course each Plugin is going to have a different Type for the Plugin state, so I'm getting stuck on how I can integrate this into my system in a general way.</p>\n\n<p>How can I write something vaguely like this:</p>\n\n<pre><code>type Plugin = (PluginState, EditorState) -&gt; Event -&gt; (PluginState, EditorState)\ndata MyEditor = MyEditor EditorState [Plugin] [PluginState]\n</code></pre>\n\n<p>When PluginState isn't a concrete type?</p>\n\n<p>TLDR; How can I store a map of values with non-concrete types in an accessible way without baking in every plugin's state-type into my global state? I'm okay with re-compiling the editor when a new plugin is added.</p>\n\n<p>Thanks! I'm really stuck on this one :/ </p>\n\n<p>If you need any clarification please just ask!</p>\n"}, {"tags": ["haskell", "generic-programming"], "answers": [{"comments": [{"owner": {"reputation": 1431, "user_id": 1553741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6daac35161547a75785e69de774334b8?s=128&d=identicon&r=PG", "display_name": "ajp", "link": "https://stackoverflow.com/users/1553741/ajp"}, "edited": false, "score": 0, "creation_date": 1479682218, "post_id": 40708395, "comment_id": 68648715, "body": "awesome. And I was able to generalize out the &#39;[a] constraint without much trouble (the reasoning for that is that this code is meant to go into a library, and should work with arbitrary end-user types)."}, {"owner": {"reputation": 1431, "user_id": 1553741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6daac35161547a75785e69de774334b8?s=128&d=identicon&r=PG", "display_name": "ajp", "link": "https://stackoverflow.com/users/1553741/ajp"}, "edited": false, "score": 0, "creation_date": 1479685879, "post_id": 40708395, "comment_id": 68649670, "body": "I&#39;ve hit the next stumbling block - <a href=\"https://stackoverflow.com/questions/40710801/how-can-i-write-function-to-convert-generic-type-to-tag-shaped-type-for-use-with\" title=\"how can i write function to convert generic type to tag shaped type for use with\">stackoverflow.com/questions/40710801/&hellip;</a>"}], "tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": true, "score": 1, "last_activity_date": 1479669846, "creation_date": 1479669846, "answer_id": 40708395, "question_id": 40698207, "link": "https://stackoverflow.com/questions/40698207/how-can-i-write-this-geq-instance/40708395#40708395", "title": "How can I write this GEq instance?", "body": "<p>Here's my take on this. Personally, I don't see much point in allowing to derive a tag type for sum types which have 0 or more than one field, so I'm going to simplify <code>Tup2List</code> away. Its presence is orthogonal to the question at hand.</p>\n\n<p>So I'm going to define <code>GTag</code> as follows:</p>\n\n<pre><code>type GTag t = GTag_ (Code t)\nnewtype GTag_ t a = GTag { unGTag :: NS ((:~:) '[a]) t }\n\npattern P0 :: () =&gt; (ys ~ ('[t] ': xs)) =&gt; GTag_ ys t\npattern P0 = GTag (Z Refl)\n\npattern P1 :: () =&gt; (ys ~ (x0 ': '[t] ': xs)) =&gt; GTag_ ys t\npattern P1 = GTag (S (Z Refl))\n\npattern P2 :: () =&gt; (ys ~ (x0 ': x1 ': '[t] ': xs)) =&gt; GTag_ ys t\npattern P2 = GTag (S (S (Z Refl)))\n\npattern P3 :: () =&gt; (ys ~ (x0 ': x1 ': x2 ': '[t] ': xs)) =&gt; GTag_ ys t\npattern P3 = GTag (S (S (S (Z Refl))))\n\npattern P4 :: () =&gt; (ys ~ (x0 ': x1 ': x2 ': x3 ': '[t] ': xs)) =&gt; GTag_ ys t\npattern P4 = GTag (S (S (S (S (Z Refl)))))\n</code></pre>\n\n<p>The main difference is to define <code>GTag_</code> without an occurrence of <code>Code</code>. This will make recursion easier, because you don't get a requirement that the recursive case has to be expressible as an application of <code>Code</code> again.</p>\n\n<p>The secondary difference, as mentioned before, is the use of <code>(:~:) '[a]</code> to force single-argument constructors rather than the more complicated <code>Tup2List</code>.</p>\n\n<p>Here's a variant of your original example:</p>\n\n<pre><code>data SomeUserType = Foo Int | Bar Char | Baz (Bool, String)\n  deriving (GHC.Generic)\n\ninstance Generic SomeUserType\n</code></pre>\n\n<p>The argument of <code>Baz</code> is now written a a pair explicitly, to adhere to the \"single argument\" requirement.</p>\n\n<p>Example dependent sums:</p>\n\n<pre><code>ex1, ex2, ex3 :: DSum (GTag SomeUserType) Maybe\nex1 = P0 ==&gt; 3\nex2 = P1 ==&gt; 'x'\nex3 = P2 ==&gt; (True, \"foo\")\n</code></pre>\n\n<p>Now the instances:</p>\n\n<pre><code>instance GShow (GTag_ t) where\n  gshowsPrec _n = go 0\n    where\n      go :: Int -&gt; GTag_ t a -&gt; ShowS\n      go k (GTag (Z Refl)) = showString (\"P\" ++ show k)\n      go k (GTag (S i))    = go (k + 1) (GTag i)\n\ninstance All2 (Compose Show f) t =&gt; ShowTag (GTag_ t) f where\n  showTaggedPrec (GTag (Z Refl)) = showsPrec\n  showTaggedPrec (GTag (S i))    = showTaggedPrec (GTag i)\n\ninstance GEq (GTag_ t) where\n  geq (GTag (Z Refl)) (GTag (Z Refl)) = Just Refl\n  geq (GTag (S i))    (GTag (S j))    = geq (GTag i) (GTag j)\n  geq _               _               = Nothing\n\ninstance All2 (Compose Eq f) t =&gt; EqTag (GTag_ t) f where\n  eqTagged (GTag (Z Refl)) (GTag (Z Refl)) = (==)\n  eqTagged (GTag (S i))    (GTag (S j))    = eqTagged (GTag i) (GTag j)\n  eqTagged _               _               = \\ _ _ -&gt; False\n</code></pre>\n\n<p>And some examples of their use:</p>\n\n<pre><code>GHCi&gt; (ex1, ex2, ex3)\n(P0 :=&gt; Just 3,P1 :=&gt; Just 'x',P2 :=&gt; Just (True,\"foo\"))\nGHCi&gt; ex1 == ex1\nTrue\nGHCi&gt; ex1 == ex2\nFalse\n</code></pre>\n"}], "owner": {"reputation": 1431, "user_id": 1553741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6daac35161547a75785e69de774334b8?s=128&d=identicon&r=PG", "display_name": "ajp", "link": "https://stackoverflow.com/users/1553741/ajp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 40708395, "answer_count": 1, "score": 2, "last_activity_date": 1479669846, "creation_date": 1479591505, "last_edit_date": 1479622165, "question_id": 40698207, "link": "https://stackoverflow.com/questions/40698207/how-can-i-write-this-geq-instance", "title": "How can I write this GEq instance?", "body": "<p>I have datatypes <code>Tup2List</code> and <code>GTag</code> (from the answer to <a href=\"https://stackoverflow.com/questions/40593441/how-can-i-produce-a-tag-type-for-any-datatype-for-use-with-dsum-without-templat\">How can I produce a Tag type for any datatype for use with DSum, without Template Haskell?</a>)</p>\n\n<p>I want to write a <code>GEq</code> instance for <code>GTag t</code>, which I think requires also having one for <code>Tup2List</code>. How can I write this instance?</p>\n\n<p>My guess at why it doesn't work is because there's no such thing as a partial <code>Refl</code> - you need to match the whole structure all at once for the compiler to give you the Refl, whereas I'm trying to just unwrap the outermost constructor and then recurse.</p>\n\n<p>Here's my code, with <code>undefined</code> filling in for the parts I don't know how to write.</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE RankNTypes #-}\n\nmodule Foo where\n\nimport Data.GADT.Compare\nimport Generics.SOP\nimport qualified GHC.Generics as GHC\n\ndata Tup2List :: * -&gt; [*] -&gt; * where\n  Tup0 :: Tup2List () '[]\n  Tup1 :: Tup2List x '[ x ]\n  TupS :: Tup2List r (x ': xs) -&gt; Tup2List (a, r) (a ': x ': xs)\n\ninstance GEq (Tup2List t) where\n  geq Tup0     Tup0     = Just Refl\n  geq Tup1     Tup1     = Just Refl\n  geq (TupS x) (TupS y) = \n    case x `geq` y of\n      Just Refl -&gt; Just Refl\n      Nothing   -&gt; Nothing\n\nnewtype GTag t i = GTag { unTag :: NS (Tup2List i) (Code t) }\n\ninstance GEq (GTag t) where\n  geq (GTag (Z x)) (GTag (Z y)) = undefined -- x `geq` y\n  geq (GTag (S _)) (GTag (Z _)) = Nothing\n  geq (GTag (Z _)) (GTag (S _)) = Nothing\n  geq (GTag (S x)) (GTag (S y)) = undefined -- x `geq` y\n</code></pre>\n\n<p>EDIT: I've changed my datatypes around, but i'm still facing the same core problem. The current definitions are</p>\n\n<pre><code>data Quux i xs where Quux :: Quux (NP I xs) xs\n\nnewtype GTag t i = GTag { unTag :: NS (Quux i) (Code t) }\n\ninstance GEq (GTag t) where\n  -- I don't know how to do this\n  geq (GTag (S x)) (GTag (S y)) = undefined\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 2, "creation_date": 1479589610, "post_id": 40697810, "comment_id": 68625079, "body": "Are you using <code>DuplicateRecordFields</code>? Those two definitions are not legal together without it."}, {"owner": {"reputation": 5352, "user_id": 4896150, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/74d0c938f3f71d6ee14db4f6b9d222c2?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Harald", "link": "https://stackoverflow.com/users/4896150/anton-harald"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1479590280, "post_id": 40697810, "comment_id": 68625270, "body": "No, I just tried it in the ghci (which I think just overrides the previous definition in this case) . I&#39;m getting an error when using a source file."}, {"owner": {"reputation": 5352, "user_id": 4896150, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/74d0c938f3f71d6ee14db4f6b9d222c2?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Harald", "link": "https://stackoverflow.com/users/4896150/anton-harald"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1479590310, "post_id": 40697810, "comment_id": 68625277, "body": "If it&#39;s like this, I understand the behavior."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1479590396, "post_id": 40697810, "comment_id": 68625299, "body": "Yes, that sounds like it would explain what\u2019s going on here."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479590701, "post_id": 40697810, "comment_id": 68625379, "body": "Yup, it is just the definition being shadowed in GHCi. By the way, loading the data type definitions from a source file with <code>DuplicateRecordFields</code> enabled and trying to use them as shown here leads to <code>Record update is ambiguous, and requires a type signature</code>, <a href=\"https://downloads.haskell.org/~ghc/8.0.1/docs/html/users_guide/glasgow_exts.html#duplicate-record-fields\" rel=\"nofollow noreferrer\">which is also expected</a>."}], "owner": {"reputation": 5352, "user_id": 4896150, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/74d0c938f3f71d6ee14db4f6b9d222c2?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Harald", "link": "https://stackoverflow.com/users/4896150/anton-harald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479589057, "creation_date": 1479588906, "last_edit_date": 1479589057, "question_id": 40697810, "link": "https://stackoverflow.com/questions/40697810/record-update-syntax-equal-property-names-in-different-types", "title": "record update syntax, equal property names in different types", "body": "<p>say there are two different types of trees:</p>\n\n<pre><code>data Tree1 = Tree1 {name :: String, color :: String} deriving Show\ndata Tree2 = Tree2 {name :: String, age :: Integer} deriving Show\n</code></pre>\n\n<p>and consider the following default values for each type:</p>\n\n<pre><code>defaultTree1 = Tree1 \"No Name\" \"green\"\ndefaultTree2 = Tree2 \"No Name\" 10\n</code></pre>\n\n<p>By using record update syntax, now it's possible to create instances of both types as followed. E.g:</p>\n\n<pre><code>defaultTree1 {color = \"brown\"}\n-- &gt;\nTree1 {name = \"No Name\", color = \"brown\"}\n</code></pre>\n\n<p>When trying this with only the name \"property\", it we get an error:</p>\n\n<pre><code>defaultTree1 {name = \"My Tree\"}\n    Couldn't match expected type \u2018Tree2\u2019 with actual type \u2018Tree1\u2019\n    In the expression: defaultTree1\n    In the expression: defaultTree1 {name = \"My Tree\"}\n</code></pre>\n\n<p>However, it works with Tree2:</p>\n\n<pre><code>defaultTree2 {name = \"My Tree\"}\n-- &gt;\nTree2 {name = \"My Tree\", age = 10}\n</code></pre>\n\n<p>What's the reason for this? How could an instance of Tree1 being created by using some default values?</p>\n"}, {"tags": ["haskell", "ghc", "yesod", "haskell-stack"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1479592346, "post_id": 40697684, "comment_id": 68625832, "body": "Seeing the log you seem to have multiple version of <code>pkb</code>. Just a guess: remove <code>.stack-work</code> and try again to see if it works."}, {"owner": {"reputation": 1317, "user_id": 2496293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/00f8e804a4fc2e35e44f88aae73100d9?s=128&d=identicon&r=PG", "display_name": "Sam De Meyer", "link": "https://stackoverflow.com/users/2496293/sam-de-meyer"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1479592820, "post_id": 40697684, "comment_id": 68625943, "body": "Unfortunately this does not work. Now I get:     <code>app&#47;devel.hs:2:1: error:         Failed to load interface for \u2018Application\u2019         It is a member of the hidden package \u2018pkb-0.0.0\u2019.</code>"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1479594120, "post_id": 40697684, "comment_id": 68626255, "body": "I&#39;m not sure, what this package is. I&#39;m not able to see it in hackage: <a href=\"http://hackage.haskell.org/package/pkb\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/pkb</a>"}, {"owner": {"reputation": 1317, "user_id": 2496293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/00f8e804a4fc2e35e44f88aae73100d9?s=128&d=identicon&r=PG", "display_name": "Sam De Meyer", "link": "https://stackoverflow.com/users/2496293/sam-de-meyer"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1479594207, "post_id": 40697684, "comment_id": 68626278, "body": "It the name of the application I am developing (<code>stack new pkb yesod-simple</code>). By default, the scaffold site makes a file <code>app&#47;devel.hs</code> which imports the application you are developing."}], "answers": [{"comments": [{"owner": {"reputation": 1317, "user_id": 2496293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/00f8e804a4fc2e35e44f88aae73100d9?s=128&d=identicon&r=PG", "display_name": "Sam De Meyer", "link": "https://stackoverflow.com/users/2496293/sam-de-meyer"}, "edited": false, "score": 0, "creation_date": 1479712720, "post_id": 40712381, "comment_id": 68656870, "body": "Thank you for your reply, yes, I did rebuild yesod-bin after switching to lts-7.9. If I execute <code>stack exec -- yesod version</code> I see: <code>yesod-bin version: 1.4.18.7</code>. Is there any way of checking this the correct version (i.e. build against GHC 8.0.1)?"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 1317, "user_id": 2496293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/00f8e804a4fc2e35e44f88aae73100d9?s=128&d=identicon&r=PG", "display_name": "Sam De Meyer", "link": "https://stackoverflow.com/users/2496293/sam-de-meyer"}, "edited": false, "score": 0, "creation_date": 1479716505, "post_id": 40712381, "comment_id": 68658519, "body": "What does stack exec which yesod tell you?"}, {"owner": {"reputation": 1317, "user_id": 2496293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/00f8e804a4fc2e35e44f88aae73100d9?s=128&d=identicon&r=PG", "display_name": "Sam De Meyer", "link": "https://stackoverflow.com/users/2496293/sam-de-meyer"}, "edited": false, "score": 0, "creation_date": 1479717421, "post_id": 40712381, "comment_id": 68658986, "body": "It says: <code>&#47;home&#47;sam&#47;.stack&#47;snapshots&#47;x86_64-linux&#47;lts-7.9&#47;8.0.1&#47;bin&#47;ye&zwnj;&#8203;sod</code>. So I guess that&#39;s the correct version."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 1317, "user_id": 2496293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/00f8e804a4fc2e35e44f88aae73100d9?s=128&d=identicon&r=PG", "display_name": "Sam De Meyer", "link": "https://stackoverflow.com/users/2496293/sam-de-meyer"}, "edited": false, "score": 0, "creation_date": 1479725407, "post_id": 40712381, "comment_id": 68663564, "body": "It looks like there&#39;s actually a bug with yesod-bin, which isn&#39;t too surprising since very few people would be using Yesod with GHC 8.0.1 yet. Can I recommend opening up a Github issue to continue debugging this?"}, {"owner": {"reputation": 1317, "user_id": 2496293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/00f8e804a4fc2e35e44f88aae73100d9?s=128&d=identicon&r=PG", "display_name": "Sam De Meyer", "link": "https://stackoverflow.com/users/2496293/sam-de-meyer"}, "edited": false, "score": 0, "creation_date": 1479727033, "post_id": 40712381, "comment_id": 68664514, "body": "Sure, I&#39;ll create an issue this afternoon."}, {"owner": {"reputation": 1317, "user_id": 2496293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/00f8e804a4fc2e35e44f88aae73100d9?s=128&d=identicon&r=PG", "display_name": "Sam De Meyer", "link": "https://stackoverflow.com/users/2496293/sam-de-meyer"}, "edited": false, "score": 0, "creation_date": 1479739224, "post_id": 40712381, "comment_id": 68672404, "body": "I added the issue, see: <a href=\"https://github.com/yesodweb/yesod/issues/1304\" rel=\"nofollow noreferrer\">github.com/yesodweb/yesod/issues/1304</a>  I am a little busy at the moment. But I&#39;ll have time in a few hours in case you need anything else to work on the issue."}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": false, "score": 0, "last_activity_date": 1479699491, "creation_date": 1479699491, "answer_id": 40712381, "question_id": 40697684, "link": "https://stackoverflow.com/questions/40697684/scaffolded-yesod-application-with-lts-7-9-stack-build-works-stack-test-wor/40712381#40712381", "title": "Scaffolded Yesod application with lts-7.9: `stack build` works, `stack test` works `stack exec -- yesod devel` does not", "body": "<p>Just a guess: have you run <code>stack build yesod-bin</code> since changing your resolver? My guess is you're running a yesod executable compiled against the older GHC version.</p>\n"}, {"tags": [], "owner": {"reputation": 1317, "user_id": 2496293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/00f8e804a4fc2e35e44f88aae73100d9?s=128&d=identicon&r=PG", "display_name": "Sam De Meyer", "link": "https://stackoverflow.com/users/2496293/sam-de-meyer"}, "is_accepted": true, "score": 0, "last_activity_date": 1480007154, "creation_date": 1480007154, "answer_id": 40791705, "question_id": 40697684, "link": "https://stackoverflow.com/questions/40697684/scaffolded-yesod-application-with-lts-7-9-stack-build-works-stack-test-wor/40791705#40791705", "title": "Scaffolded Yesod application with lts-7.9: `stack build` works, `stack test` works `stack exec -- yesod devel` does not", "body": "<h1>Temporary workaround:</h1>\n\n<p>This issue has recently been solved in the yesod code base but it is not yet in the yesod master branch. To work with <code>yesod devel</code> and GHC 8, you can do the following (for now).</p>\n\n<ol>\n<li>Clone the yesod repository: <a href=\"https://github.com/yesodweb/yesod.git\" rel=\"nofollow noreferrer\">https://github.com/yesodweb/yesod.git</a></li>\n<li>Checkout the <code>1304-stack-based-devel</code> branch.</li>\n<li>Run <code>stack install yesod-bin</code> inside the yesod repo. This should install the <code>yesod</code> executable. Make sure this executable is on your <code>$PATH</code>.</li>\n<li><code>cd</code> to your project folder.\n\n<ol>\n<li>Run <code>yesod devel</code> inside your project (do not run <code>stack exec -- yesod devel</code>).   </li>\n<li>If something fails, try the following command in your project folder to make sure no traces are left from previous builds: <code>rm -rf yesod-devel dist .stack-work static/tmp &amp;&amp; stack clean &amp;&amp; stack build</code> (this might be overkill, but it doesn't cause any harm so why not).</li>\n</ol></li>\n</ol>\n\n<p>You should now be able to run the development server again.</p>\n\n<h1>Some random notes:</h1>\n\n<ul>\n<li>To launch the interactive interpreter, use <code>stack ghci</code> (not <code>stack exec cabal repl</code>).</li>\n<li><p><code>stack build</code> and <code>stack test</code> work as before.</p></li>\n<li><p>The issue is tracked on the <a href=\"https://github.com/yesodweb/yesod/issues/1304\" rel=\"nofollow noreferrer\">yesod issue tracker on GitHub</a>.</p></li>\n<li><p>Here is the <a href=\"https://github.com/yesodweb/yesod/pull/1305\" rel=\"nofollow noreferrer\">pull request</a> for this issue.</p></li>\n</ul>\n"}], "owner": {"reputation": 1317, "user_id": 2496293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/00f8e804a4fc2e35e44f88aae73100d9?s=128&d=identicon&r=PG", "display_name": "Sam De Meyer", "link": "https://stackoverflow.com/users/2496293/sam-de-meyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 40791705, "answer_count": 2, "score": 0, "last_activity_date": 1480007154, "creation_date": 1479587978, "question_id": 40697684, "link": "https://stackoverflow.com/questions/40697684/scaffolded-yesod-application-with-lts-7-9-stack-build-works-stack-test-wor", "title": "Scaffolded Yesod application with lts-7.9: `stack build` works, `stack test` works `stack exec -- yesod devel` does not", "body": "<p>I am building a simple web app (called <code>pkb</code>) with Yesod using the <code>yesod-simple</code> template. I need a bunch of libraries that don't have a recent enough version in lts-6.25 (the current default for <code>yesod-simple</code>) so I changed the resolver to lts-7.9 in <code>stack.yaml</code>. I also read <a href=\"https://ghc.haskell.org/trac/ghc/ticket/12130\" rel=\"nofollow noreferrer\">this issue with GHC 8.0.1</a> and successfully worked around it by adding</p>\n\n<pre><code>{-# LANGUAGE NoDisambiguateRecordFields #-}\n{-# LANGUAGE NoRecordWildCards          #-}\n</code></pre>\n\n<p>where necessary and changing any <code>X{..}</code> to explicit notation with records. Now my package builds successfully using <code>stack build</code> and the unit tests run without any problem using <code>stack test</code>. When I launch my application using <code>stack exec pkb</code> I can visit the website and everything functions fine. Loading the application in GHCi also works fine (using <code>stack exec cabal repl</code> and then typing <code>appMain</code> + [Enter] at the prompt).</p>\n\n<p>Now when I try to run the development server using <code>stack exec -- yesod devel</code> (which used to work before switching to lts-7.9) I get the following error:</p>\n\n<pre><code>app/devel.hs:2:1: error:\nFailed to load interface for \u2018Application\u2019\nIt is a member of the hidden package \u2018pkb-0.0.0@pkb-0.0.0-6TveDldRrhNJw1vO6l4VeJ\u2019.\nIt is a member of the hidden package \u2018pkb-0.0.0@pkb-0.0.0-AeggierDgKl46ITEmuA1C2\u2019.\n</code></pre>\n\n<p>Looking at the output of <code>stack exec -- yesod -v devel</code>, I can see that the <code>pkb</code> package is on the list of directories searched for. Also, all the files required to load the <code>pkb</code> package are present:</p>\n\n<pre><code>$ ls -l .stack-work/install/x86_64-linux/lts-7.9/8.0.1/pkgdb\ntotal 12\n-rw-r--r-- 1 sam sam 5738 Nov 19 20:26 package.cache\n-rw-r--r-- 1 sam sam 2536 Nov 19 20:26 pkb-0.0.0-AeggierDgKl46ITEmuA1C2.conf\n$ ls -l .stack-work/install/x86_64-linux/lts-7.9/8.0.1/lib/x86_64-linux-ghc-8.0.1\ntotal 4\ndrwxr-xr-x 6 sam sam 4096 Nov 19 20:26 pkb-0.0.0-AeggierDgKl46ITEmuA1C2\n$ ls -l .stack-work/install/x86_64-linux/lts-7.9/8.0.1/bin\ntotal 27440\n-rwxr-xr-x 1 sam sam 28094672 Nov 19 20:26 pkb\n</code></pre>\n\n<p>So why is the <code>pkb</code> package still 'hidden' according to this error message?</p>\n\n<p>I have the output of the aforementioned commands <a href=\"https://gist.github.com/SamDM/aa578351e7ee8abc810bc8e1b884a761\" rel=\"nofollow noreferrer\">here</a>. <br>\nIf you need more information, please let me know and I'll happily provide it.</p>\n"}, {"tags": ["haskell", "recursion", "types", "infinite", "fixpoint-combinators"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1479574538, "post_id": 40695515, "comment_id": 68620242, "body": "The type of <code>fix</code> is not <code>b -&gt; b -&gt; b</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1479574568, "post_id": 40695515, "comment_id": 68620249, "body": "no, it&#39;s <code>(b -&gt; b) -&gt; b</code>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1479574636, "post_id": 40695515, "comment_id": 68620276, "body": "I added a missing <code>then</code> to your <code>if</code>. Otherwise, your <code>remainder</code> function is not valid Haskell..."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1479574640, "post_id": 40695515, "comment_id": 68620279, "body": "Haskell uses lazy evaluation. <code>f (fix f)</code> calls the outer <code>f</code> first, not <code>fix</code>."}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 1, "creation_date": 1479574714, "post_id": 40695515, "comment_id": 68620307, "body": "For many functions <code>fix</code> will indeed go into infinite recursion without returning. However for many it wont. For example <code>fix (const 1)</code> or <code>fix (1:)</code>."}, {"owner": {"reputation": 1164, "user_id": 1491639, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/03dd48d2070f11eb8613a48f36d43bc2?s=128&d=identicon&r=PG", "display_name": "Abdul Rahman", "link": "https://stackoverflow.com/users/1491639/abdul-rahman"}, "edited": false, "score": 0, "creation_date": 1479574892, "post_id": 40695515, "comment_id": 68620390, "body": "How would it not go into infinite recursion for (const 1) and (1:)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1479574928, "post_id": 40695515, "comment_id": 68620405, "body": "<code>take 3 (fix (1:))</code> == <code>[1,1,1]</code>. <code>fix (const 1) = 1</code>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1479574953, "post_id": 40695515, "comment_id": 68620414, "body": "@AbdulRahman Try to evaluate it by hand with pen and paper."}, {"owner": {"reputation": 1164, "user_id": 1491639, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/03dd48d2070f11eb8613a48f36d43bc2?s=128&d=identicon&r=PG", "display_name": "Abdul Rahman", "link": "https://stackoverflow.com/users/1491639/abdul-rahman"}, "edited": false, "score": 1, "creation_date": 1479575017, "post_id": 40695515, "comment_id": 68620441, "body": "Nice I see it for (1:) and (const 1). Its haskell&#39;s lazy evaluation :)"}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 3, "last_activity_date": 1479575418, "last_edit_date": 1479575418, "creation_date": 1479575074, "answer_id": 40695606, "question_id": 40695515, "link": "https://stackoverflow.com/questions/40695515/haskell-school-of-expression-fix-function/40695606#40695606", "title": "Haskell school of expression fix function", "body": "<p>First of all the principal type of fix is actually <code>(b -&gt; b) -&gt; b</code> (remember that only <code>b -&gt; (b -&gt; b)</code> is the same as <code>b -&gt; b -&gt; b</code>). </p>\n\n<p>In a strict language, such a definition would go into infinite recursion, but because Haskell is lazy, the arguments to a function are evaluated only if they are at any point needed. For example you can define <code>factorial</code>.</p>\n\n<pre><code>-- with recursion\nfactorial :: Int -&gt; Int\nfactorial n = if n == 0 then 1 else n * factorial (n-1)\n\n-- with `fix`\nfactorial' :: Int -&gt; Int\nfactorial' = fix (\\f n -&gt; if n == 0 then 1 else n * f (n - 1))\n</code></pre>\n\n<p>Following the same pattern, you should be able to define <code>remainder</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1479583689, "creation_date": 1479583689, "answer_id": 40697023, "question_id": 40695515, "link": "https://stackoverflow.com/questions/40695515/haskell-school-of-expression-fix-function/40697023#40697023", "title": "Haskell school of expression fix function", "body": "<p>Playing with it a little gives us</p>\n\n<pre><code>fix f         = f (fix f)                                            -- definition\nfix f     a   = f (fix f) a                                          -- eta expansion\nfix f     a b = f (fix f) a b                                        -- eta expansion\nremainder a b = if a &lt; b then a else remainder (a - b) b             -- definition\n-- we want  remainder = fix f:                                       -- equation\nfix f     a b = if a &lt; b then a else (fix f)   (a - b) b             -- substitution\n       = (\\g -&gt; if a &lt; b then a else g         (a - b) b) (fix f)    -- abstraction\n   = fix (\\g -&gt; \\a b -&gt; if a &lt; b then a else g (a - b) b) a b        -- abstraction\n</code></pre>\n\n<p>thus</p>\n\n<pre><code>remainder = \n     fix (\\g     a b -&gt; if a &lt; b then a else g (a - b) b)            -- eta reduction\n</code></pre>\n"}], "owner": {"reputation": 1164, "user_id": 1491639, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/03dd48d2070f11eb8613a48f36d43bc2?s=128&d=identicon&r=PG", "display_name": "Abdul Rahman", "link": "https://stackoverflow.com/users/1491639/abdul-rahman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "closed_date": 1479582326, "accepted_answer_id": 40695606, "answer_count": 2, "score": 1, "last_activity_date": 1588138367, "creation_date": 1479574459, "last_edit_date": 1588138367, "question_id": 40695515, "link": "https://stackoverflow.com/questions/40695515/haskell-school-of-expression-fix-function", "closed_reason": "Duplicate", "title": "Haskell school of expression fix function", "body": "<p>So I am reading Paul Hudak's book \"The Haskell School of Expression\" and am stuck on an exercise in there. </p>\n\n<p>Here it goes</p>\n\n<p><em>Suppose function fix is defined as</em> </p>\n\n<pre><code>fix f = f (fix f)\n</code></pre>\n\n<p><em>What is the principal type of <code>fix</code>?</em> That one I know, it's <code>b -&gt; b -&gt; b</code></p>\n\n<p>But I don't understand the way <code>fix</code> is defined, won't it go into an infinite recursion? </p>\n\n<p>Also, <em>let the <code>remainder</code> function be defined as</em> </p>\n\n<pre><code>remainder :: Integer -&gt; Integer -&gt; Integer\nremainder a b = if a &lt; b then a \n                else remainder (a - b) b \n</code></pre>\n\n<p><em>Rewrite <code>remainder</code> using <code>fix</code> so that it is non-recursive.</em></p>\n"}, {"tags": ["haskell", "typeclass", "instances", "custom-type"], "comments": [{"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1479571856, "post_id": 40695023, "comment_id": 68619364, "body": "Either <code>(==) (Num (x,_)) (Num (y,_)) = x==y</code> or <code>Num (x,_) == Num (y,_) = x==y</code>."}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1479571966, "post_id": 40695023, "comment_id": 68619398, "body": "Also why do you use a <code>newtype</code> for <code>Numeral</code>. Why not <code>data Numeral = Num Sign Digits</code>?"}, {"owner": {"reputation": 99, "user_id": 7182698, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c7535b4155878bf61c46883d3d5df495?s=128&d=identicon&r=PG&f=1", "display_name": "Pegasus Thorn", "link": "https://stackoverflow.com/users/7182698/pegasus-thorn"}, "reply_to_user": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1479572175, "post_id": 40695023, "comment_id": 68619473, "body": "When I type the first case you wrote it says Ambiguous occurrence \u2018==\u2019 but before that it says it&#39;s multiple times declared ( I guess in previous instances), and the second case doesn&#39;t work as well"}, {"owner": {"reputation": 99, "user_id": 7182698, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c7535b4155878bf61c46883d3d5df495?s=128&d=identicon&r=PG&f=1", "display_name": "Pegasus Thorn", "link": "https://stackoverflow.com/users/7182698/pegasus-thorn"}, "reply_to_user": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1479572239, "post_id": 40695023, "comment_id": 68619495, "body": "because I&#39;m trying to solve problem from the book"}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1479572374, "post_id": 40695023, "comment_id": 68619543, "body": "You have to indent the definitions for the functions of the instances. In Haskell whitespace is significant."}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1479572524, "post_id": 40695023, "comment_id": 68619590, "body": "Furthermore it should just be <code>instance Eq Numeral where</code>. You don&#39;t have to say that this instance is only valid with a <code>Eq</code> instance for <code>Sign</code>, because <code>Sign</code> is a concrete type and therefore either always or never has an <code>Eq</code> instance. In this case always, because you defined one."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 7182698, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c7535b4155878bf61c46883d3d5df495?s=128&d=identicon&r=PG&f=1", "display_name": "Pegasus Thorn", "link": "https://stackoverflow.com/users/7182698/pegasus-thorn"}, "edited": false, "score": 0, "creation_date": 1479576608, "post_id": 40695460, "comment_id": 68621050, "body": "Very well explained. I have seen somewhere in tutorials that, for example, Eq a =&gt; Eq customType where is used. I understood it as including instance for comparing Signs into current instance. I know I compared just Signs, I wanted to make another instance of Eq for Numeral to compare Digits. I think I have tried what you wrote at the beginning but didn&#39;t work. Now I tried it again and it said &quot;ambiguous occurence ==&quot;. Anyway, well explained."}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "reply_to_user": {"reputation": 99, "user_id": 7182698, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c7535b4155878bf61c46883d3d5df495?s=128&d=identicon&r=PG&f=1", "display_name": "Pegasus Thorn", "link": "https://stackoverflow.com/users/7182698/pegasus-thorn"}, "edited": false, "score": 0, "creation_date": 1479577502, "post_id": 40695460, "comment_id": 68621363, "body": "@PegasusThorn Thank you. I added a short paragraph to the end of 2. about type constraints in instance declarations."}], "tags": [], "owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "is_accepted": true, "score": 6, "last_activity_date": 1479577428, "last_edit_date": 1479577428, "creation_date": 1479574236, "answer_id": 40695460, "question_id": 40695023, "link": "https://stackoverflow.com/questions/40695023/creating-instance-of-eq-for-custom-data-type-in-haskell/40695460#40695460", "title": "Creating Instance of Eq for custom data type in Haskell", "body": "<p>Mostly putting what I've already written in the comments in a more fleshed out form:</p>\n\n<p>There are a few problems with your code:</p>\n\n<ol>\n<li>You have to indent the code under the <code>instance</code> declarations. That way you tell the compiler what code belongs to the instance declaration.</li>\n<li><p>In the following line you are asking for a type class constraint on a concrete type (<code>Eq Sign =&gt;</code>). This is not possible in standard Haskell and even if you were to follow the compiler instructions and enable the <code>FlexibleInstances</code> language extension it wouldn't make sense.</p>\n\n<pre><code>instance (Eq Sign) =&gt; Eq (Numeral) where\n</code></pre>\n\n<p>Type class constraints are only used for type variables. For example:</p>\n\n<pre><code>double :: Num a =&gt; a -&gt; a\ndouble x = x + x\n</code></pre>\n\n<p>Here we say, that the function <code>double</code> only works for all types that implement <code>Num</code>. <code>double :: Num Int =&gt; Int -&gt; Int</code> on the other hand is redundant, because we already know, that <code>Int</code> has a <code>Num</code> instance. The same for <code>Eq Sign</code>.</p>\n\n<p>For instances such constraints only make sense, if the type you are writing an instance for contains another polymorphic type. Fox example <code>instance Ord a =&gt; Ord [a]</code>. Here we would use the <code>Ord</code> instance of the elements of the list to lexiographically order lists.</p></li>\n<li><p>You can define <code>(==)</code> either in infix or prefix form, but not both. So either <code>(==) (Num (x,_)) (Num (y,_)) = x == y</code> or <code>Num (x,_) == Num (y,_) = x == y</code>.</p></li>\n<li><p>Newtyping tuples to create a product type is rather strange. Newtypes are usually used if you want to use the functionality that is already present for the more complex underlying type. However here that is not the case, you just want a normal product of <code>Digits</code> and <code>Sign</code>.</p></li>\n<li><p>You are only comparing the <code>Sign</code> of the numbers. While technically a valid <code>Eq</code> instance, I think you also want to compare the digits of the number probably truncating leading zeros. In the code below I didn't truncate zeros though, to keep it simple.</p></li>\n</ol>\n\n\n\n<pre><code>data Digit = Zero | One | Two\ntype Digits = [Digit]\ndata Sign = Pos | Neg\ndata Numeral = Num Sign Digits\n\ninstance Eq Sign where\n  (==) Pos Pos = True\n  (==) Neg Neg = True\n  (==) _ _ = False\n\ninstance Eq Digit where\n  (==) Zero Zero = True\n  (==) One One = True\n  (==) Two Two = True\n  (==) _ _ = False\n\ninstance Eq Numeral where\n  Num s1 x1 == Num s2 x2 = s1 == s2 &amp;&amp; x1 == x2\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 7182698, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c7535b4155878bf61c46883d3d5df495?s=128&d=identicon&r=PG&f=1", "display_name": "Pegasus Thorn", "link": "https://stackoverflow.com/users/7182698/pegasus-thorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6224, "favorite_count": 0, "accepted_answer_id": 40695460, "answer_count": 1, "score": 3, "last_activity_date": 1479577428, "creation_date": 1479571629, "question_id": 40695023, "link": "https://stackoverflow.com/questions/40695023/creating-instance-of-eq-for-custom-data-type-in-haskell", "title": "Creating Instance of Eq for custom data type in Haskell", "body": "<p>I have made some custom Data types for number representation in Haskell, now I want to implement Eq instances for it, but I am somehow stuck. So I have already made: </p>\n\n<pre><code>data Digit = Zero | One | Two\ntype Digits = [Digit]\ndata Sign = Pos | Neg -- Pos fuer Positive, Neg fuer Negative\nnewtype Numeral = Num (Sign,Digits)\n\ninstance Eq Sign where\n(==) Pos Pos = True\n(==) Neg Neg = True\n(==) _ _ = False\n\ninstance Eq Digit where\n(==) Zero Zero = True\n(==) One One = True\n(==) Two Two = True\n(==) _ _ = False\n</code></pre>\n\n<p>Now I want to check out the Sign in my custom type Numeral so I tried this:</p>\n\n<pre><code>instance (Eq Sign) =&gt; Eq (Numeral) where\n(==) Num(x,_)== Num(y,_) = x==y\n</code></pre>\n\n<p>But I get this error: Parse error in pattern : (==)</p>\n"}, {"tags": ["haskell", "type-theory", "subtyping"], "comments": [{"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 4, "creation_date": 1479572981, "post_id": 40694960, "comment_id": 68619725, "body": "I would argue that Haskell doesn&#39;t have subtyping as it would be traditionally defined because every value has exactly <i>one</i> type. Typeclasses are simply a way of extending the language of types to allow for user-defined polymorphism. That is, it lets a value <code>x</code> have a type <code>C a =&gt; a</code> where <code>C</code> is a set of rules <code>a</code> must conform to; but still <code>x</code> has exactly one type. Contrast this with OOPy subtyping where a value <code>x</code> has multiple types: its base type, and any type that subclasses from the base type."}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 1, "creation_date": 1479573037, "post_id": 40694960, "comment_id": 68619740, "body": "Another, more pedantic argument: subtyping would inhibit the DHM-style principal-type type inference that Haskell compilers have, whereas typeclasses do not."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 3, "creation_date": 1479580866, "post_id": 40694960, "comment_id": 68622495, "body": "To elaborate on @haoformayor&#39;s point: don&#39;t confuse subtyping and ad-hoc polymorphism. Subtyping is one flavour of ad-hoc polymorphism, and type classes are a rather different one."}], "answers": [{"comments": [{"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1479574258, "post_id": 40695383, "comment_id": 68620148, "body": "This answer helps a lot, thank you. Nonetheless I have a feeling that the two concepts are at least related, as the <code>Pet</code> example can also be implemented via type classes. Phrased as a question: &quot;Are type class constraints as powerful as untagged unions?&quot; (Although this is probably more suited as a follow-up question)."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 3, "creation_date": 1479578493, "post_id": 40695383, "comment_id": 68621694, "body": "@ThreeFx We might say that, in this case, they would be two very different ways of achieving the same goal. By the way, it is worth noting that the untagged aspect is not essential to the discussion -- if we had, in the TypeScript example, an <code>Oviparous</code> interface with a <code>layEggs</code> method that <code>Fish</code> and <code>Bird</code> would extend, the fundamental difference would remain the same. A relevant, if somewhat tangential, question: <a href=\"http://stackoverflow.com/q/6730126/2751851\"><i>Parametric polymorphism vs Ad-hoc polymorphism</i></a>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1524702953, "post_id": 40695383, "comment_id": 87082445, "body": "The way subsumption interacts with subclasses has a very subtype-like feel. If a function expects an argument of type <code>forall f. Applicative f =&gt; f a -&gt; f b</code>, I can surely pass it one of type <code>forall f. Functor f =&gt; f a -&gt; f b</code>. Now that does go beyond standard Haskell, but higher-rank types have been a significant part of real Haskell for a long time."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1524705103, "post_id": 40695383, "comment_id": 87082909, "body": "@dfeuer Indeed -- it is not without reason we explicitly talk in terms of subtyping when considering <a href=\"https://hackage.haskell.org/package/lens-4.16.1\" rel=\"nofollow noreferrer\">the <i>lens</i> hierarchy</a>. A postscript on that would be a worthwhile addition to this answer."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1524707601, "post_id": 40695383, "comment_id": 87083514, "body": "@duplode, by the way, I ran into something very much related yesterday, which made me realize (perhaps for the first time) that removing and reapplying a <code>newtype</code> constructor is not always a no-op. See <a href=\"https://github.com/haskell/primitive/pull/146/files\" rel=\"nofollow noreferrer\">this PR</a>, which iteratively modifies functions by changing their constraints. In particular, <code>WonkP (runWonkP w)</code> is <i>not</i> <code>coerce w</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1524714317, "post_id": 40695383, "comment_id": 87085113, "body": "@dfeuer Ooh, nice! If I&#39;m reading it right, that&#39;s an impressively stealthy IfCxt-like trick."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1524714875, "post_id": 40695383, "comment_id": 87085238, "body": "@duplode, I prefer to think of the rule structure as a distant relative of the bundle trick in <code>vector</code>, but I guess the <code>IfCxt</code> thing is a translation to the world of overlapping instances."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 5, "last_activity_date": 1524692631, "last_edit_date": 1524692631, "creation_date": 1479573793, "answer_id": 40695383, "question_id": 40694960, "link": "https://stackoverflow.com/questions/40694960/is-allowing-untagged-unions-equivalent-to-allowing-type-classes/40695383#40695383", "title": "Is allowing untagged unions equivalent to allowing type classes?", "body": "<blockquote>\n  <p>Type classes are also a form of subtyping.</p>\n</blockquote>\n\n<p>They aren't. For the sake of illustration, let's return to the <a href=\"https://www.typescriptlang.org/docs/handbook/advanced-types.html\" rel=\"nofollow noreferrer\">TypeScript examples</a> I alluded to <a href=\"https://stackoverflow.com/a/40621884/2751851\">in that question</a>:</p>\n\n<blockquote>\n  <p>If we have a value that has a union type, we can only access members\n  that are common to all types in the union.</p>\n\n<pre><code>interface Bird {\n    fly();\n    layEggs();\n}\n\ninterface Fish {\n    swim();\n    layEggs();\n}\n\nfunction getSmallPet(): Fish | Bird {\n    // ...\n}\n\nlet pet = getSmallPet();\npet.layEggs(); // okay\npet.swim();    // errors\n</code></pre>\n</blockquote>\n\n<p>Here, the return type of <code>getSmallPet</code> is neither <code>Fish</code> nor <code>Bird</code>, but a supertype of both that has as members the members common to both <code>Fish</code> and <code>Bird</code>. A <code>Fish</code> is <em>also</em> a <code>Fish | Bird</code>, and so is a <code>Bird</code>.</p>\n\n<p>What happens with type classes is quite different:</p>\n\n<pre><code>foo :: Num a =&gt; a -&gt; a\nfoo x = (x * x) + x\n</code></pre>\n\n<p>While both <code>foo (3 :: Integer)</code> and <code>foo (7.7 :: Double)</code> work, that does not mean there is a supertype corresponding to <code>Num</code> that <code>(3 :: Integer)</code> and <code>(7.7 :: Double)</code> also have. Rather, all that <code>Num a =&gt; a -&gt; a</code> says is that your choice of <code>a</code> should have an instance of <code>Num</code> (and it is worth emphasising that <code>Num</code> is not a type), so that there are suitable implementations of <code>(*)</code> and <code>(+)</code> for your chosen type. Unlike OOP methods, <code>(*)</code> and <code>(+)</code> do not belong to any particular type, and so it is not necessary to introduce a supertype in order to use them with both <code>Integer</code> and <code>Double</code>.</p>\n"}], "owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "accepted_answer_id": 40695383, "answer_count": 1, "score": 1, "last_activity_date": 1524692631, "creation_date": 1479571282, "last_edit_date": 1495540892, "question_id": 40694960, "link": "https://stackoverflow.com/questions/40694960/is-allowing-untagged-unions-equivalent-to-allowing-type-classes", "title": "Is allowing untagged unions equivalent to allowing type classes?", "body": "<p>In <a href=\"https://stackoverflow.com/q/40620913/3032349\">this</a> question, untagged unions are described as a form of subtyping.</p>\n\n<p>Type classes are also a form of subtyping.</p>\n\n<p>Are they conceptually equivalent? Ih they are, how would I implement these in Haskell?</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1479571280, "post_id": 40694437, "comment_id": 68619179, "body": "That is explained more clearly <a href=\"https://wiki.haskell.org/GHC/FAQ#Does_GHC_do_common_subexpression_elimination.3F\" rel=\"nofollow noreferrer\">in this GHC FAQ</a>. The source for the answer there is <a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2006-February/014140.html\" rel=\"nofollow noreferrer\">this message by SPJ</a>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1479573906, "post_id": 40694437, "comment_id": 68620040, "body": "e.g. with <code>y g = g x where x = g x</code> we intend <code>g</code> to be actually invoked twice, but with CSE the <code>g x</code> common sub-expression might get recognized, and <code>y g = x where x = g x</code> will instead be in effect, with only one invocation of <code>g</code>.  So the problem arises when holding on to <code>g</code>&#39;s results is expensive, e.g. when it&#39;s a very large list; it may be cheaper overall to recalculate it so it can be garbage-collected. so, like the answer says, <i>space leaks</i>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1479629828, "post_id": 40694437, "comment_id": 68632396, "body": "(especially if the separate invocations of <code>g</code> are forced on different schedules, and the inner one would <a href=\"https://wiki.haskell.org/Prime_numbers#Linear_merging\" rel=\"nofollow noreferrer\">produce far less elements</a> of its result than the outer one, which is thus imperative to be garbage-collected asap). note that for this <code>y</code> (better called <code>y2</code> actually, the true <code>y</code> is <code>y g = g (y g)</code>) even the &quot;better&quot; CSE from the answer would still cause the same problem."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1479655516, "post_id": 40694437, "comment_id": 68639312, "body": "I think it&#39;s sloppy wording in the wiki. CSE affects the space usage of the program. I don&#39;t see why it would ever affect the strictness."}], "answers": [{"tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 13, "last_activity_date": 1479571672, "creation_date": 1479571672, "answer_id": 40695029, "question_id": 40694437, "link": "https://stackoverflow.com/questions/40694437/under-what-circumstances-could-common-subexpression-elimination-affect-the-lazin/40695029#40695029", "title": "Under what circumstances could Common Subexpression Elimination affect the laziness of a Haskell program?", "body": "<p>The naive CSE rule would be</p>\n\n<pre><code>e'[e, e]  ~&gt;  let x = e in e'[x, x].\n</code></pre>\n\n<p>That is, whenever a subexpression <code>e</code> occurs twice in the expression <code>e'</code>, we use a let-binding to compute <code>e</code> once. This however leads itself to some trivial space leaks. For example</p>\n\n<pre><code>sum [1..n] + prod [1..n]\n</code></pre>\n\n<p>is typically <code>O(1)</code> space usage in a lazy functional programming language like Haskell (as <code>sum</code> and <code>prod</code> would tail-recurse and blah blah blah), but would become <code>O(n)</code> when the naive CSE rule is enacted. This can be terrible for programs when <code>n</code> is high!</p>\n\n<p>The approach is then to make this rule more specific, restricting it to a small set of cases that we know <em>won't</em> have the problem. We can begin by more specifically enumerating the problems with the naive rule, which will form a set of priorities for us to develop a better CSE:</p>\n\n<ul>\n<li><p>The two occurrences of <code>e</code> might be <em>far apart</em> in <code>e'</code>, leading to a long lifetime for the <code>let x = e</code> binding.</p></li>\n<li><p>The let-binding must always allocate a closure where previously there might not have been one.</p></li>\n<li><p>This can create an unbound number of closures.</p></li>\n<li><p>There are cases where the closure might never deallocate.</p></li>\n</ul>\n\n<h2>Something better</h2>\n\n<pre><code>let x = e in e'[e]  ~&gt;  let x = e in e'[x]\n</code></pre>\n\n<p>This is a more conservative rule but is much safer. Here we recognize that <code>e</code> appears twice but the first occurrence <em>syntactically dominates</em> the second expression, meaning here that the programmer has already introduced a let-binding. We can safely just reuse that let-binding and replace the second occurrence of <code>e</code> with <code>x</code>. No new closures are allocated.</p>\n\n<p>Another example of syntactic domination:</p>\n\n<pre><code>case e of { x -&gt; e'[e] }  ~&gt; case e of { x -&gt; e'[x] }\n</code></pre>\n\n<p>And yet another:</p>\n\n<pre><code>case e of {\n   Constructor x0 x1 ... xn -&gt;\n     e'[e]\n}\n\n~&gt;\n\ncase e of {\n   Constructor x0 x1 ... xn -&gt;\n     e'[Constructor x0 x1 ... xn]\n}\n</code></pre>\n\n<p>These rules all take advantage of existing structure in the program to ensure that the kinetics of space usage remain the same before and after the transformation. They are much more conservative than the original CSE but they are also much safer.</p>\n\n<h2>See also</h2>\n\n<p>For a full discussion of CSE in a lazy FPL, read <a href=\"https://kar.kent.ac.uk/21455/1/Common_Subexpression_Elimination_in_a_Lazy.pdf\" rel=\"noreferrer\">Chitil's (very accessible) 1997 paper</a>. For a full treatment of how CSE works in a production compiler, see <a href=\"https://github.com/ghc/ghc/blob/876b00ba25a615423f48b0cf9d443a9fd5dbd6f4/compiler/simplCore/CSE.hs\" rel=\"noreferrer\">GHC's CSE.hs module</a>, which is documented very thoroughly thanks to GHC's tradition of writing long footnotes. The comment-to-code ratio in that module is off the charts. Also note how old that file is (1993)!</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 484, "favorite_count": 3, "accepted_answer_id": 40695029, "answer_count": 1, "score": 14, "last_activity_date": 1479575708, "creation_date": 1479568456, "last_edit_date": 1479575708, "question_id": 40694437, "link": "https://stackoverflow.com/questions/40694437/under-what-circumstances-could-common-subexpression-elimination-affect-the-lazin", "title": "Under what circumstances could Common Subexpression Elimination affect the laziness of a Haskell program?", "body": "<p>From <a href=\"https://wiki.haskell.org/GHC_optimisations#Common_subexpression_elimination\" rel=\"noreferrer\">wiki.haskell.org</a>:</p>\n\n<blockquote>\n  <p>First of all, common subexpression elimination (CSE) means that if an expression appears in several places, the code is rearranged so that the value of that expression is computed only once. For example:</p>\n\n<pre><code>foo x = (bar x) * (bar x)\n</code></pre>\n  \n  <p>might be transformed into</p>\n\n<pre><code>foo x = let x' = bar x in x' * x'\n</code></pre>\n  \n  <p>thus, the bar function is only called once. (And if bar is a particularly expensive function, this might save quite a lot of work.)\n  GHC doesn't actually perform CSE as often as you might expect. The trouble is, performing CSE can affect the strictness/laziness of the program. So GHC does do CSE, but only in specific circumstances --- see the GHC manual. (Section??)</p>\n  \n  <p>Long story short: \"If you care about CSE, do it by hand.\"</p>\n</blockquote>\n\n<p>I'm wondering under what circumstances CSE \"affects\" the strictness/laziness of the program and what kind of effect that could be.</p>\n"}, {"tags": ["string", "haskell", "recursion"], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 1, "last_activity_date": 1479566287, "last_edit_date": 1479566287, "creation_date": 1479563088, "answer_id": 40693603, "question_id": 40693520, "link": "https://stackoverflow.com/questions/40693520/haskell-use-recursion-to-compare-two-strings-and-write-out-position-length/40693603#40693603", "title": "Haskell : Use recursion to compare two strings and write out position + length", "body": "<p>Note that the comparison is independent of the reversal; that is, you can implement your function as the composition of two separate functions</p>\n\n<pre><code>compareReverseStrings str = compareStrings str (reverseString str)\n-- Using the Applicative instance of functions, \n-- compareReverseStrings = compareStrings &lt;*&gt; reverseString\n</code></pre>\n\n<p>Then you can implement the two functions separately. (<code>reverseString</code> should be trivial; it's already implemented as <code>reverse</code>, but you can write your own definition for practice if you like).</p>\n\n<pre><code>compareStrings :: String -&gt; String -&gt; [(Position, Length)]\ncompareStrings x y = ...\n-- Hint: consider what you might do with the result of zip3 [1..] x y\n-- What if the letters in the first element are the same?\n-- What if they are different?\n\nreverseString :: String -&gt; String\nreverseString str = ...\n</code></pre>\n\n<p>In general, this is how you solve <em>all</em> problems in programming: break your problem down into smaller pieces, solve the subproblems, then combine the results to get the solution to your original problem.</p>\n"}], "owner": {"reputation": 25, "user_id": 6948722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/519dd3a164419f844c6528d1be490972?s=128&d=identicon&r=PG&f=1", "display_name": "Aewend", "link": "https://stackoverflow.com/users/6948722/aewend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 40693603, "answer_count": 1, "score": 0, "last_activity_date": 1479566287, "creation_date": 1479562583, "question_id": 40693520, "link": "https://stackoverflow.com/questions/40693520/haskell-use-recursion-to-compare-two-strings-and-write-out-position-length", "title": "Haskell : Use recursion to compare two strings and write out position + length", "body": "<p>I'm new to programming and just started with recursive programming in Haskell. I could use some help getting started with a problem I want to solve.</p>\n\n<p>I'm looking for a simple way of solving following problem:</p>\n\n<p>compareReverseStrings :: String -> [(Position, Length)]</p>\n\n<p>Examples: </p>\n\n<pre><code>      compareReverseStrings \"ABCDEEEEEFG\" = [(5,3)]\n\n\n      compareReverseStrings \"1234444567444447\" = [(4,3), (11,3)]\n</code></pre>\n\n<p>(In this case the funtion compares \"ABCDEEEFG\" and \"GFEEEEEDCBA\" in example 1)</p>\n\n<p>(the function compares \"1234444567444447\" and \"7444447654444321\" in example 2)</p>\n\n<p>Let me know if I'm being unclear :) Thank you in advance!</p>\n"}, {"tags": ["haskell", "matrix-multiplication"], "answers": [{"comments": [{"owner": {"reputation": 2221, "user_id": 448591, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5520f21f2e367d78c29d08d3b30b954f?s=128&d=identicon&r=PG", "display_name": "Jakob Runge", "link": "https://stackoverflow.com/users/448591/jakob-runge"}, "edited": false, "score": 0, "creation_date": 1479563078, "post_id": 40693428, "comment_id": 68616624, "body": "Hey thanks - I&#39;ll investigate this a bit and than likely accept your answer. This possibility didn&#39;t even occur to me ^^"}], "tags": [], "owner": {"reputation": 178, "user_id": 4556658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176748782a450651ab1ef750943e5f35?s=128&d=identicon&r=PG&f=1", "display_name": "sdx23", "link": "https://stackoverflow.com/users/4556658/sdx23"}, "is_accepted": true, "score": 1, "last_activity_date": 1479561922, "creation_date": 1479561922, "answer_id": 40693428, "question_id": 40692658, "link": "https://stackoverflow.com/questions/40692658/how-to-multiply-sparse-matrices-using-hmatrix/40693428#40693428", "title": "How to multiply sparse matrices using hmatrix", "body": "<p>Sparse matrices are to my knowledge rather young in hmatrix. Looking through the docs it seems there is no product of sparse matrices. You must implement it yourself.</p>\n\n<p>Edit: And if you done so, comment here: <a href=\"https://github.com/albertoruiz/hmatrix/issues/162\" rel=\"nofollow noreferrer\">https://github.com/albertoruiz/hmatrix/issues/162</a> (also substantiates my statement above)</p>\n"}], "owner": {"reputation": 2221, "user_id": 448591, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5520f21f2e367d78c29d08d3b30b954f?s=128&d=identicon&r=PG", "display_name": "Jakob Runge", "link": "https://stackoverflow.com/users/448591/jakob-runge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 40693428, "answer_count": 1, "score": 2, "last_activity_date": 1479561922, "creation_date": 1479557105, "last_edit_date": 1479557492, "question_id": 40692658, "link": "https://stackoverflow.com/questions/40692658/how-to-multiply-sparse-matrices-using-hmatrix", "title": "How to multiply sparse matrices using hmatrix", "body": "<p>I've got a matrix <code>m</code> of dimension <code>3329\u00d73329</code> with lots of zero fields and I want to calculate <code>m^9</code>.\nAfter trying this with the <code>matrix</code> package (<code>Data.Matrix</code> is easy to use) I figured that a sparse matrix would make a better representation of this in terms of memory usage and possibly also computation speed. So I'm trying to figure out how to use the <code>hmatrix</code> package. I've already managed to create a sparse matrix:</p>\n\n<pre><code>module Example where\n\nimport Numeric.LinearAlgebra as LA\n\nassocExample :: AssocMatrix\nassocExample = [((0,0), 1),((3329,5),1)]\n\nsparseExample :: GMatrix\nsparseExample = LA.mkSparse assocExample\n</code></pre>\n\n<p>My problem at this point appears to be that I've got a <code>GMatrix</code>, but for the multiplication operator <code>(&lt;&gt;)</code> I need a <code>Matrix t</code> instead.\nBy looking trough the <a href=\"https://hackage.haskell.org/package/hmatrix\" rel=\"nofollow noreferrer\">hmatrix</a> documentation on hackage I didn't manage to figure out how to obtain a <code>Matrix t</code> here.</p>\n\n<p>I've also had a quick gaze at the <a href=\"http://dis.um.es/~alberto/material/hmatrix.pdf\" rel=\"nofollow noreferrer\">introduction to hmatrix</a> but the term <code>sparse</code> isn't even mentioned in it.</p>\n\n<p>My hunch is that this should be easy enough to do, but I'm missing something simple.</p>\n"}, {"tags": ["haskell", "haddock"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1479539296, "post_id": 40689529, "comment_id": 68610300, "body": "I believe <code>haddock</code> is for generating (not looking up) documentation."}, {"owner": {"reputation": 3382, "user_id": 4759361, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zu2kz.jpg?s=128&g=1", "display_name": "xrisk", "link": "https://stackoverflow.com/users/4759361/xrisk"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1479542892, "post_id": 40689529, "comment_id": 68611052, "body": "@Alec err, then how I access Haskell&#39;s documentation?"}], "answers": [{"comments": [{"owner": {"reputation": 3382, "user_id": 4759361, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zu2kz.jpg?s=128&g=1", "display_name": "xrisk", "link": "https://stackoverflow.com/users/4759361/xrisk"}, "edited": false, "score": 0, "creation_date": 1479553616, "post_id": 40691817, "comment_id": 68613771, "body": "So Haskell doesn&#39;t have any system/tool for viewing documentation in itself?"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "reply_to_user": {"reputation": 3382, "user_id": 4759361, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zu2kz.jpg?s=128&g=1", "display_name": "xrisk", "link": "https://stackoverflow.com/users/4759361/xrisk"}, "edited": false, "score": 1, "creation_date": 1479556724, "post_id": 40691817, "comment_id": 68614694, "body": "@Rishav: no. Just use your favorite web browser."}], "tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": true, "score": 2, "last_activity_date": 1606900910, "last_edit_date": 1606900910, "creation_date": 1479551509, "answer_id": 40691817, "question_id": 40689529, "link": "https://stackoverflow.com/questions/40689529/how-to-view-haskells-documentation-using-haddock/40691817#40691817", "title": "How to view Haskell&#39;s documentation using Haddock?", "body": "<p>The <code>haddock</code> command generates documentation in HTML. To view it you use any web browser by pointing it at the generated file. There should be an <code>index.html</code> file, so you can view it with:</p>\n<pre><code>firefox index.html\n</code></pre>\n<p><strong>Update:</strong> If you are using <a href=\"https://docs.haskellstack.org/en/stable/README/\" rel=\"nofollow noreferrer\">Stack</a> then <code>stack haddock</code> will generate the documentation for your project, and also for all the dependencies.</p>\n"}], "owner": {"reputation": 3382, "user_id": 4759361, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zu2kz.jpg?s=128&g=1", "display_name": "xrisk", "link": "https://stackoverflow.com/users/4759361/xrisk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 751, "favorite_count": 0, "accepted_answer_id": 40691817, "answer_count": 1, "score": 5, "last_activity_date": 1606900910, "creation_date": 1479533092, "question_id": 40689529, "link": "https://stackoverflow.com/questions/40689529/how-to-view-haskells-documentation-using-haddock", "title": "How to view Haskell&#39;s documentation using Haddock?", "body": "<p>For example, how would I view the docs for Data.List.group as I could on <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html\" rel=\"noreferrer\">hackage</a>?</p>\n\n<p>If I try to use Haddock as:</p>\n\n<pre><code>$ haddock Data.List                                   \n&lt;no location info&gt;: error: module \u2018Data.List\u2019 is a package module\n$ haddock Data.List.group                            \ntarget \u2018Data.List.group\u2019 is not a module name or a source file\n</code></pre>\n\n<p>On the other hand, I know that these html docs exist in my computer under the <code>/usr/local/share/doc</code> directory.</p>\n\n<p>Or am I mistaken and this is not what Haddock does?</p>\n"}, {"tags": ["haskell", "monads", "applicative"], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 11, "last_activity_date": 1479533749, "last_edit_date": 1495535431, "creation_date": 1479533749, "answer_id": 40689592, "question_id": 40689441, "link": "https://stackoverflow.com/questions/40689441/applicativedo-in-haskell/40689592#40689592", "title": "ApplicativeDo in Haskell", "body": "<blockquote>\n  <p>How does it decide whether the desugaring to <code>Applicative</code> methods is possible? From what I know, it does a dependency check (if the later depends on the result of former) to decide the eligibility. Are there any other criteria?</p>\n</blockquote>\n\n<p>The <a href=\"http://research.microsoft.com/en-us/um/people/simonpj/papers/list-comp/applicativedo.pdf\" rel=\"nofollow noreferrer\">paper</a> and <a href=\"https://ghc.haskell.org/trac/ghc/wiki/ApplicativeDo\" rel=\"nofollow noreferrer\">trac page</a> are the best sources of information. Some points:</p>\n\n<ul>\n<li><code>ApplicativeDo</code> uses applicatives wherever possible - including mixing them with <code>&gt;&gt;=</code> in some cases where only part of the <code>do</code> block is applicative</li>\n<li>A sort of directed graph of dependencies is constructed to see which parts can be \"parallelized\"</li>\n<li>Sometimes there is no obvious best translation of this graph! In this case, GHC chooses the translation that is (roughly speaking) locally smallest </li>\n</ul>\n\n<blockquote>\n  <p>Although this addition makes applicative code easier to read for classes that don't have any <code>Monad</code> instance (maybe ?). But for structures that both have a <code>Monad</code> and an <code>Applicative</code> instance: Is this a recommended practice (from the readability perspective)? Are there any other benefits?</p>\n</blockquote>\n\n<p><a href=\"https://stackoverflow.com/a/38719766/3072788\">Here is an answer</a> about the difference between <code>Applicative</code> and <code>Monad</code>. To quote directly:</p>\n\n<blockquote>\n  <p>To deploy <code>&lt;*&gt;</code>, you choose two computations, one of a function, the other of an argument, then their values are combined by application. To deploy <code>&gt;&gt;=</code>, you choose one computation, and you explain how you will make use of its resulting values to choose the next computation. It is the difference between \"batch mode\" and \"interactive\" operation.</p>\n</blockquote>\n\n<p>A prime example of this sort of thing is the <a href=\"https://hackage.haskell.org/package/haxl-0.4.0.1/docs/Haxl-Core.html#t:GenHaxl\" rel=\"nofollow noreferrer\"><code>Haxl</code></a> monad (designed by Facebook) which is all about fetching data from some external source. Using <code>Applicative</code>, these requests can happen in parallel while <code>Monad</code> forces the requests to be sequential. In fact, this example is what motivated Simon Marlow at Facebook to make the <code>ApplicativeDo</code> extension in the first place and write the quoted paper about it. </p>\n\n<p>In general, most <code>Monad</code> instances don't necessarily benefit from <code>Applicative</code>. From the same answer I quoted above:</p>\n\n<blockquote>\n  <p>I appreciate that <code>ApplicativeDo</code> is a great way to make more applicative (and in some cases that means faster) programs that were written in monadic style that you haven't the time to refactor. But otherwise, I'd argue applicative-when-you-can-but-monadic-when-you-must is also the better way to see what's going on.</p>\n</blockquote>\n\n<p>So: use <code>Applicative</code> over <code>Monad</code> when possible, and exploit <code>ApplicativeDo</code> when it really is nicer to write (like it must have been in some cases at Facebook) than the corresponding applicative expression.</p>\n"}], "owner": {"reputation": 2430, "user_id": 1525842, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/95abedfeb09f68271233421d1aafb3be?s=128&d=identicon&r=PG", "display_name": "zeronone", "link": "https://stackoverflow.com/users/1525842/zeronone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1141, "favorite_count": 1, "accepted_answer_id": 40689592, "answer_count": 1, "score": 4, "last_activity_date": 1479533749, "creation_date": 1479532205, "question_id": 40689441, "link": "https://stackoverflow.com/questions/40689441/applicativedo-in-haskell", "title": "ApplicativeDo in Haskell", "body": "<p>AFAIK one of the new additions to GHC8 is the <code>ApplicativeDo</code> language extension, which desugars the do-notation to the corresponding <code>Applicative</code> methods (<code>&lt;$&gt;</code>, <code>&lt;*&gt;</code>) if possible. I have the following questions.</p>\n\n<p>How does it decide whether the desugaring to <code>Applicative</code> methods is possible? From what I know, it does a dependency check (if the later depends on the result of former) to decide the eligibility. Are there any other criteria?</p>\n\n<p>Although this addition makes applicative code easier to read for classes that don't have any Monad instance (maybe ?). But for structures that both have a Monad and an Applicative instance: Is this a recommended practice (from the readability perspective)? Are there any other benefits?</p>\n"}, {"tags": ["haskell", "functional-programming", "category-theory"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1479524874, "post_id": 40688427, "comment_id": 68607857, "body": "It seems a bit sad that AMP didn&#39;t go so far as to insert some of Kmett&#39;s classes. Once you start talking about semigroups, you ultimately find yourself wanting <code>Apply</code>, <code>Alt</code>, <code>Bind</code>, <code>Semigroupoid</code>, <code>Foldable1</code>, and <code>Traversable1</code> (I think those names are right)."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1479554820, "post_id": 40688427, "comment_id": 68614124, "body": "@dfeuer Having messed around with PureScript a bit, which went all-in on the <code>Semigroupoid</code> family in the design of its library, I personally find those classes to not really be worth their weight for practical use. When you&#39;re smashing things together it&#39;s useful to have something to smash them into!"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 14, "last_activity_date": 1576198976, "last_edit_date": 1576198976, "creation_date": 1479520330, "answer_id": 40688427, "question_id": 40688352, "link": "https://stackoverflow.com/questions/40688352/why-prefer-monoids-over-semigroups-in-haskell-why-do-we-need-mempty/40688427#40688427", "title": "Why prefer monoids over semigroups in Haskell? Why do we need mempty?", "body": "<p>The <code>mempty</code> certainly is needed for some applications. For instance, what should be the result of <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#v:foldMap\" rel=\"nofollow noreferrer\"><code>foldMap</code>ping</a> over an empty list? There's no <code>a</code> value you could feed the mapped function to obtain an <code>m</code>. So, there needs to be a \u201cdefault\u201d. It's nice if this is an identity element of an associative operation \u2013 for example it allows arbitrary reordering/chunking the fold without changing the result. When folding over a tree, actually a lot of <code>mempty</code>s may show up in the middle but you always know they will get \u201csqueezed out\u201d in the end result, so you don't depend on the exact tree layout for reproducable results.</p>\n\n<p>That said, you're right with your concern: <code>Semigroup</code> would quite often be sufficient, and it would probably be better if this class were used wherever <code>mempty</code> isn't needed (since there are actually a few quite nifty types that are <code>Semigroup</code> but not <code>Monoid</code>). However, the early design of the standard library apparently did not consider this important enough to warrant the extra class, so lots of code came to rely on <code>Monoid</code> without really needing a monoid.</p>\n\n<p>So \u2013 much the same issue as we used to have with <code>Monad</code>: lots of code really only needed <code>Applicative</code> or even just <code>Functor</code>, but for historical reasons was stuck with <code>Monad</code> anyway until the AMP. Ultimately the problem is that Haskell class hierarchies can't really be <em>refined</em> after the fact, only extended <em>downwards</em>, not upwards.</p>\n"}, {"tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": false, "score": 3, "last_activity_date": 1576201177, "last_edit_date": 1576201177, "creation_date": 1479520527, "answer_id": 40688441, "question_id": 40688352, "link": "https://stackoverflow.com/questions/40688352/why-prefer-monoids-over-semigroups-in-haskell-why-do-we-need-mempty/40688441#40688441", "title": "Why prefer monoids over semigroups in Haskell? Why do we need mempty?", "body": "<p>It's the same as with all the other abstractions: the more operations you have at your disposal, the more complex things you can abstract over. Concerning <code>Monoid</code> specifically, here are a few most popular functions, which <code>Semigroup</code> is just not enough for:</p>\n\n<pre><code>foldMap :: (Foldable t, Monoid m) =&gt; (a -&gt; m) -&gt; t a -&gt; m\n\nfold :: (Foldable t, Monoid m) =&gt; t m -&gt; m\n\nmconcat :: Monoid a =&gt; [a] -&gt; a\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1479528938, "post_id": 40688800, "comment_id": 68608545, "body": "#2 isn&#39;t clear. It seems to imply that if <code>xs</code> and <code>ys</code> are only <code>Semigroup</code> values, we lose information that we would retain if they were <code>Monoid</code> values instead."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1479547546, "post_id": 40688800, "comment_id": 68612107, "body": "@chepner Let me try to rephrase that: I&#39;m trying to say that the semigroup operation <code>a -&gt; a -&gt; a</code> is imprecise when applied to certain types such as non-empty lists. The semigroup operation just makes more sense when the type with which it&#39;s used happens to have a zero. Appending lists to get a list is a more natural operation than appending non-empty lists to get a non-empty list"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 5, "last_activity_date": 1479524595, "creation_date": 1479524595, "answer_id": 40688800, "question_id": 40688352, "link": "https://stackoverflow.com/questions/40688352/why-prefer-monoids-over-semigroups-in-haskell-why-do-we-need-mempty/40688800#40688800", "title": "Why prefer monoids over semigroups in Haskell? Why do we need mempty?", "body": "<p>These days <code>base</code> features classes for both <code>Semigroup</code> and <code>Monoid</code> (and plans are afoot to make the latter imply the former), so you don't have to choose between the two abstractions - just use the weakest assumption suitable for your purpose.</p>\n\n<p>That said, <code>Monoid</code> does seem to be somewhat more useful in daily practice than <code>Semigroup</code>. Why is this? I can think of a couple of lines of argument:</p>\n\n<ol>\n<li>Things that are useful in programming, such as collections, tend to have zero-or-many semantics; <code>Monoid</code> naturally abstracts composable collections of things in a way that <code>Semigroup</code> doesn't. (For example, <code>[]</code>, the <em>free</em> <code>Monoid</code>, is a classic example of a collection.)</li>\n<li>Types that are <code>Semigroup</code>s but not <code>Monoid</code>s tend to lose precision when you start composing them. Given two non-empty lists <code>xs</code> and <code>ys</code>, we know that <code>xs &lt;&gt; ys</code> has at least two elements. But its type only promises that it has at least one; useful information has been discarded.</li>\n<li>From a social perspective, folks are scared enough of Cabal Hell to avoid pulling in extra dependencies just to deal with \"non-empty things\". When you want to work with monads-sans-<code>return</code> and categories-sans-<code>id</code>, installing the <a href=\"https://hackage.haskell.org/package/semigroupoids\" rel=\"noreferrer\"><code>semigroupoids</code></a> package requires a chunk of the \"Kmett Platform\".</li>\n</ol>\n"}], "owner": {"reputation": 1663, "user_id": 1239729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/B42R0.png?s=128&g=1", "display_name": "Alexander Reshytko", "link": "https://stackoverflow.com/users/1239729/alexander-reshytko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1099, "favorite_count": 2, "accepted_answer_id": 40688427, "answer_count": 3, "score": 8, "last_activity_date": 1576201177, "creation_date": 1479519417, "question_id": 40688352, "link": "https://stackoverflow.com/questions/40688352/why-prefer-monoids-over-semigroups-in-haskell-why-do-we-need-mempty", "title": "Why prefer monoids over semigroups in Haskell? Why do we need mempty?", "body": "<p>I can understand the reason for mappend and associativity requirement for it. But why do we need the identity element what is the pragmatic usefulness in it? Or maybe I've missed something important and without definition of it in instances the whole logic won't work. Thank you!</p>\n"}, {"tags": ["haskell", "emacs"], "comments": [{"owner": {"reputation": 27385, "user_id": 729907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HeXcc.png?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/729907/drew"}, "edited": false, "score": 2, "creation_date": 1479523477, "post_id": 40688286, "comment_id": 68607662, "body": "You need to first load the library that defines <code>haskell-mode-map</code>. And if loading it does not define the map (which it probably does not) then you need to evaluate the code that does. Typically, turning on the mode defines the map. A simple solution is typically to put your key binding definition inside an <code>eval-after-load</code> (or an <code>with-eval-after-load</code>), so that it is evaluated after the relevant code is loaded that defines the map."}, {"owner": {"reputation": 2051, "user_id": 4887726, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/381a9c57be405fa215c388f62ed7ddf7?s=128&d=identicon&r=PG&f=1", "display_name": "LoranceChen", "link": "https://stackoverflow.com/users/4887726/lorancechen"}, "reply_to_user": {"reputation": 27385, "user_id": 729907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HeXcc.png?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/729907/drew"}, "edited": false, "score": 0, "creation_date": 1479544204, "post_id": 40688286, "comment_id": 68611308, "body": "@Drew, I add <code>(eval-after-load &#39;haskell-mode (load-library &quot;haskell-mode&quot;))</code> refer form <a href=\"https://www.emacswiki.org/emacs/LoadingLispFiles\" rel=\"nofollow noreferrer\">LoadingLispFiles</a> and so happy it works.Thanks your tips!"}], "owner": {"reputation": 2051, "user_id": 4887726, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/381a9c57be405fa215c388f62ed7ddf7?s=128&d=identicon&r=PG&f=1", "display_name": "LoranceChen", "link": "https://stackoverflow.com/users/4887726/lorancechen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 431, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1479520996, "creation_date": 1479518824, "last_edit_date": 1479520996, "question_id": 40688286, "link": "https://stackoverflow.com/questions/40688286/why-symbols-value-as-variable-is-void-haskell-mode-map", "title": "Why Symbol&#39;s value as variable is void: haskell-mode-map?", "body": "<p>I am config a haskell environment with this <a href=\"https://github.com/haskell/haskell-mode#installation-from-git-repository\" rel=\"nofollow noreferrer\">installation-from-git-repository</a>:</p>\n\n<pre><code>(add-to-list 'load-path \"path/of/haskell-mode/\")\n(require 'haskell-mode-autoloads)\n(add-to-list 'Info-default-directory-list \"path/of/haskell-mode/\")\n</code></pre>\n\n<p>and add a key for navigate:</p>\n\n<pre><code>(define-key haskell-mode-map (kbd \"&lt;f8&gt;\") 'haskell-navigate-imports)\n</code></pre>\n\n<p>But when I open emacs, a error occurred :<br>\n<code>Symbol's value as variable is void: haskell-mode-map</code></p>\n\n<p>I can't download haskell-mode form package central because of network can't connected. So I build it form source code.</p>\n\n<p>Hope some help.</p>\n"}, {"tags": ["haskell", "dependent-type"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1479494125, "post_id": 40683737, "comment_id": 68598181, "body": "What would you actually <i>gain</i> by having some expressions return <code>Bool</code> instead of <code>IO Bool</code>?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1479566205, "post_id": 40683737, "comment_id": 68617491, "body": "Type-safe SQL interfaces? There&#39;s an example in <a href=\"https://cs.ru.nl/~wouters/Publications/ThePowerOfPi.pdf\" rel=\"nofollow noreferrer\"><i>The Power of Pi</i></a> and a Haskell translation in <a href=\"http://cs.brynmawr.edu/~rae/papers/2012/singletons/paper.pdf\" rel=\"nofollow noreferrer\">the <code>singletons</code> paper</a>. The big idea is to declare the schema upfront, and check it matches the actual schema upon opening the DB connection."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1479675049, "post_id": 40683737, "comment_id": 68646428, "body": "Thanks Benjamin, I&#39;m going down the rabbit hole. :)"}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 7, "last_activity_date": 1479496503, "last_edit_date": 1479496503, "creation_date": 1479494636, "answer_id": 40684036, "question_id": 40683737, "link": "https://stackoverflow.com/questions/40683737/is-it-possible-to-have-different-behaviors-for-the-same-constructor/40684036#40684036", "title": "is it possible to have different behaviors for the same constructor?", "body": "<blockquote>\n  <p>So I would want <code>Gte</code> to produce something like <code>IO Bool</code> (not minding exception handling for now).</p>\n  \n  <p>But I wouldn't always need <code>Gte</code> to produce an <code>IO Bool</code>.</p>\n</blockquote>\n\n<p>That is not possible (nor indeed desirable). <code>Gte</code> will have to always return the same type. Also, you probably want to separate the construction of your query from its execution...</p>\n\n<blockquote>\n  <p>or something like this: <code>(LiteralInt 40 `Gte` LiteralBool True)</code> needs to fail at compile time.</p>\n</blockquote>\n\n<p>Now <em>that</em> is much more reasonable. If you decide to go down that path, you can even customize the type errors GHC reports with the new <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:TypeError\" rel=\"nofollow noreferrer\"><code>TypeError</code></a> feature. However, sticking to a simple example involving just <code>LiteralInt</code>, <code>LiteralBool</code> and <code>Gte</code>, you could do something like the following with just GADTs:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n\ndata Expr a where\n  LiteralInt :: Int -&gt; Expr Int\n  LiteralBool :: Bool -&gt; Expr Bool\n  Gte :: Expr Int -&gt; Expr Int -&gt; Expr Bool\n  Add :: Expr Int -&gt; Expr Int -&gt; Expr Int\n  ColumnName :: String -&gt; Expr a\n</code></pre>\n\n<p>Then, the following would all compile:</p>\n\n<pre><code>ColumnName \"age\" `Gte` LiteralInt 40\nLiteralInt 40 `Gte` LiteralInt 10\n(LiteralInt 40 `Add` ColumnName \"age\") `Gte` LiteralInt 10\n</code></pre>\n\n<p>while the following would not:</p>\n\n<pre><code>LiteralInt 40 `Gte` LiteralBool True\nLiteralInt 40 `Add` LiteralBool True\n</code></pre>\n\n<blockquote>\n  <p>But, say \"age\" did not contain something that could be expressed as a <code>LiteralInt</code>.</p>\n</blockquote>\n\n<p>You <em>could</em> potentially make this also compile time if you knew your schema at compile time and you wanted to do lots of type-hackery. The simpler solution would be just to make the error handling happen when you execute your query. So you would have a function looking something like</p>\n\n<pre><code>evalExpr :: Expr a -&gt; ExceptT e IO a\n</code></pre>\n\n<p>And you would probably perform the appropriate checks concerning the types of columns here.</p>\n"}], "owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 1, "accepted_answer_id": 40684036, "answer_count": 1, "score": 2, "last_activity_date": 1479496503, "creation_date": 1479493483, "last_edit_date": 1479493756, "question_id": 40683737, "link": "https://stackoverflow.com/questions/40683737/is-it-possible-to-have-different-behaviors-for-the-same-constructor", "title": "is it possible to have different behaviors for the same constructor?", "body": "<p>I'm writing an SQL interpreter. I need to distinguish between ill-formed expressions at compile time, and run-time errors.</p>\n\n<p>I'll give you an example of something that should be well-formed, but possibly fails at run-time.</p>\n\n<pre><code>SELECT $ [ColumnName \"first_name\" `AS` \"name\"] `FROM` TABLE \"people.csv\" `WHERE` (ColumnName \"age\" `Gte` LiteralInt 40)\n</code></pre>\n\n<p>I'd like to focus in on the expression:</p>\n\n<pre><code>(ColumnName \"age\" `Gte` LiteralInt 40)\n</code></pre>\n\n<p>This should pass the type checker. But, say \"age\" did not contain something that could be expressed as a <code>LiteralInt</code>.</p>\n\n<p>So I would want <code>Gte</code> to produce something like <code>IO Bool</code> (not minding exception handling for now).</p>\n\n<p>But I wouldn't always need <code>Gte</code> to produce an <code>IO Bool</code>. In the event I had something like this:</p>\n\n<p><code>(LiteralInt 40 `Gte` LiteralInt 10)</code> I just need a Bool.\nor something like this:\n<code>(LiteralInt 40 `Gte` LiteralBool True)</code> needs to fail at compile time.</p>\n\n<p>So, I've been toying around with data families and  GADTs, and have gone down many dead ends that would just serve to confuse the situation if I explicated them. </p>\n\n<p>Does my problem make sense, and if so is there a path of inquiry I can traverse that will lead to a solution?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 3, "user_id": 7179018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7275770910d6a8ea56fc20a0bb6de601?s=128&d=identicon&r=PG&f=1", "display_name": "Grapengeter", "link": "https://stackoverflow.com/users/7179018/grapengeter"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479484656, "post_id": 40681162, "comment_id": 68592583, "body": "I want to implement it myself and it seems like tails for example would not return [1,2] when given [1,2,3]"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479484879, "post_id": 40681162, "comment_id": 68592760, "body": "If you didn&#39;t you want to implement it yourself as an exercise, you would be looking for <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html#v:inits\" rel=\"nofollow noreferrer\"><code>inits</code></a> from <code>Data.List</code>. (I miswrote <code>tails</code> instead of <code>inits</code> in my original comment.)"}, {"owner": {"reputation": 3, "user_id": 7179018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7275770910d6a8ea56fc20a0bb6de601?s=128&d=identicon&r=PG&f=1", "display_name": "Grapengeter", "link": "https://stackoverflow.com/users/7179018/grapengeter"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479485790, "post_id": 40681162, "comment_id": 68593401, "body": "inits does not return [2,3] when given [1,2,3].  combining both skips [2,3] in [1,2,3,4]"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1479486553, "post_id": 40681162, "comment_id": 68593866, "body": "<code>tails [1,2,3,4] &gt;&gt;= inits</code> is <i>almost</i> right; you just end up with too many empty lists in the output. Pass the result to <code>nub</code> and you&#39;re done (although that&#39;s probably not the most efficient solution)."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479486687, "post_id": 40681162, "comment_id": 68593949, "body": "I read your question as if getting <code>[2,3]</code> from <code>[1,2,3]</code> would count as skipping the first element. Perhaps a more precise way of stating your requirements would be &quot;all possible sublists generated by removing prefixes and suffixes&quot;, or something to that effect."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479487997, "post_id": 40681162, "comment_id": 68594742, "body": "The solution you added to the question is, in effect, an alternative answer. I suggest you post it as a separate answer (and not as a footnote to the question)."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1479495826, "post_id": 40681162, "comment_id": 68599040, "body": "@duplode &quot;All contiguous sublists&quot;."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1479514287, "post_id": 40681162, "comment_id": 68606074, "body": "@chepner, it&#39;s not even clear to me that there are too many empty lists in that solution.  There are four empty subsequences of <code>[1,2,3]</code>; the one at the beginning, the one between 1 and 2, etc."}], "answers": [{"tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": true, "score": 2, "last_activity_date": 1479489920, "last_edit_date": 1479489920, "creation_date": 1479487116, "answer_id": 40682054, "question_id": 40681162, "link": "https://stackoverflow.com/questions/40681162/create-a-list-of-sublists-of-a-given-list/40682054#40682054", "title": "Create a list of sublists of a given list", "body": "<p><code>Data.List</code> contains both <code>inits</code> and <code>tails</code>. What you want is the inits of each member of the tails list (or possibly vice-versa, but see later for the reason why this way round is better)</p>\n\n<pre><code>sublists = concatMap inits . tails\n\n&gt; sublists [1,2,3,4]\n[[],[1],[1,2],[1,2,3],[1,2,3,4],[],[2],[2,3],[2,3,4],[],[3],[3,4],[],[4],[]]\n</code></pre>\n\n<p>If you prefer, you might want to get rid of all the null lists:</p>\n\n<pre><code>sublists = filter (not . null) . concatMap inits . tails\n</code></pre>\n\n<p>Or if you prefer to avoid generating the null lists in the first place:</p>\n\n<pre><code>sublists = concatMap (tail . inits) . tails\n</code></pre>\n\n<p>The result of <code>inits</code> always starts with the empty list, while the result of <code>tails</code> always ends with the empty list. So <code>tail . inits</code> is safe because <code>tail</code> will never be applied to an empty list; it just returns the result without the leading empty list. <code>inits []</code> just returns <code>[[]]</code>, so the last empty list from <code>tails</code> gets dropped.</p>\n"}], "owner": {"reputation": 3, "user_id": 7179018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7275770910d6a8ea56fc20a0bb6de601?s=128&d=identicon&r=PG&f=1", "display_name": "Grapengeter", "link": "https://stackoverflow.com/users/7179018/grapengeter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 718, "favorite_count": 0, "accepted_answer_id": 40682054, "answer_count": 1, "score": 0, "last_activity_date": 1479489920, "creation_date": 1479484191, "last_edit_date": 1479487775, "question_id": 40681162, "link": "https://stackoverflow.com/questions/40681162/create-a-list-of-sublists-of-a-given-list", "title": "Create a list of sublists of a given list", "body": "<p>I need a function that returns a list of all possible sublists, without skipping elements, e.g. sublists [1,2,3,4] should return [[1,2,3,4],[1,2,3] etc.] but the list should NOT contain [1,2,4].\nMy current \"solution\" is</p>\n\n<pre><code>&gt;sublists :: [Integer] -&gt; [[Integer]]\n&gt;sublists [] = [[]]\n&gt;sublists (x:xs) = [x:ys | ys &lt;- sublists xs] ++ sublists xs\n</code></pre>\n\n<p>which does include [1,2,4]</p>\n\n<p>Thanks in advance</p>\n\n<p>EDIT: Found a solution (with a little help of my friend)</p>\n\n<p>Looks a bit clumsy but it works</p>\n\n<pre><code>&gt;sublists :: [Integer] -&gt; [[Integer]]\n&gt;sublists [] = [[]]\n&gt;sublists (x:xs) = subs [] (x:xs) ++ sublists xs\n&gt;    where\n&gt;        subs :: [Integer] -&gt; [Integer] -&gt; [[Integer]]\n&gt;        subs xs [] = [xs]\n&gt;        subs xs (a:as) =  (xs ++ [a]) : (subs (xs ++ [a]) as)\n</code></pre>\n"}, {"tags": ["class", "haskell", "polymorphism", "instance"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1479464155, "last_edit_date": 1479464155, "creation_date": 1479463829, "answer_id": 40674322, "question_id": 40674257, "link": "https://stackoverflow.com/questions/40674257/haskell-a-function-declaration-in-a-class/40674322#40674322", "title": "Haskell, a function declaration in a class", "body": "<p>Use a typeclass parameter <code>t</code> for the type constructor (like <code>BTree</code> or <code>TTree</code>, and unlike <code>BTree a</code> and <code>TTree a</code>):</p>\n\n<pre><code>class Tree t where\n    getName :: t a -&gt; a\n\ninstance Tree BTree where\n    getName (BLeaf name) = name\n    getName (BBranch name lhs rhs) = name\n</code></pre>\n\n<p>If you need the instances to vary depending on the element type <code>a</code>, you need multi-parameter classes:</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n\nclass Tree t a where\n    getName :: t a -&gt; a\n\ninstance Tree BTree Int where\n    getName (BLeaf name) = name+1\n    getName (BBranch name lhs rhs) = name*2\n\ninstance Tree BTree Char where\n    getName (BLeaf name) = name\n    getName (BBranch name lhs rhs) = name\n</code></pre>\n\n<p>Probably you don't need to make it so general.</p>\n"}], "owner": {"reputation": 115, "user_id": 3948777, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/100006189402274/picture?type=large", "display_name": "Niklas Scherden", "link": "https://stackoverflow.com/users/3948777/niklas-scherden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 40674322, "answer_count": 1, "score": 4, "last_activity_date": 1479464155, "creation_date": 1479463627, "question_id": 40674257, "link": "https://stackoverflow.com/questions/40674257/haskell-a-function-declaration-in-a-class", "title": "Haskell, a function declaration in a class", "body": "<p>i am trying to create some instances for a polymorph class Tree, but i dont get it,</p>\n\n<p>look, my code is:</p>\n\n<pre><code>data BTree a = BLeaf a | BBranch a (BTree a) (BTree a) deriving(Show)\ndata TTree a = TLeaf a | TBranch a (TTree a) (TTree a) (TTree a) deriving(Show)\n\nclass Tree a where\n\n    getName :: a -&gt; a -- How should i declare this function?\n\ninstance Tree (BTree a) where\n\n    getName (BLeaf name) = name\n    getName (BBranch name lhs rhs) = name\n\ninstance Tree (TTree a) where\n\n    getName (TLeaf name) = name\n    getName (TBranch name lhs mhs rhs) = name\n\ntest1 = getName (BLeaf 1)\ntest2 = getName (TLeaf 1)\n</code></pre>\n\n<p>GHCI says:</p>\n\n<pre><code>Couldn't match expected type `a' with actual type `BTree a'\n</code></pre>\n\n<p>So, How should i declare the getName-function?</p>\n"}, {"tags": ["haskell", "gtk3", "cairo", "gtk2hs"], "answers": [{"tags": [], "owner": {"reputation": 347, "user_id": 4022586, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Daniel Schmitz", "link": "https://stackoverflow.com/users/4022586/daniel-schmitz"}, "is_accepted": false, "score": 0, "last_activity_date": 1479560537, "creation_date": 1479560537, "answer_id": 40693210, "question_id": 40672750, "link": "https://stackoverflow.com/questions/40672750/how-do-i-render-into-a-gtk3-statusicon-using-cairo-in-a-haskell-application/40693210#40693210", "title": "How do I render into a gtk3 statusicon using cairo in a haskell application?", "body": "\n\n<p>Using a <code>Pixbuf</code> i need a way to render into it.</p>\n\n<p>The following solution takes a cairo Rendering <code>render :: Render a</code>\nand the desired X and Y dimension of the (square) <code>Pixbuf</code> (You can change this if you need to create non-square Pixbufs.)</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import qualified Foreign.Ptr as Pointer\nimport qualified ByteString as B\n\nrenderPixbuf :: Int -&gt; Render a -&gt; IO Pixbuf\nrenderPixbuf size render = withImageSurface FormatARGB32 size size $ \\surface -&gt; do\n    renderWith surface render\n    stride &lt;- imageSurfaceGetStride surface\n    surfaceData &lt;- swapRB stride &lt;$&gt; imageSurfaceGetData surface\n    B.useAsCStringLen surfaceData $ \\(pointer, _) -&gt; do \n      let pointer' = Pointer.castPtr pointer\n      pixbufNewFromData pointer' ColorspaceRgb True 8 size size stride\n</code></pre>\n\n<p>It uses the function <a href=\"https://hackage.haskell.org/package/cairo-0.13.3.1/docs/Graphics-Rendering-Cairo.html#v:withImageSurface\" rel=\"nofollow noreferrer\">withImageSurface</a> to create a surface for cairo to render to and then calls <a href=\"https://hackage.haskell.org/package/cairo-0.13.3.1/docs/Graphics-Rendering-Cairo.html#v:renderWith\" rel=\"nofollow noreferrer\">renderWith</a> to do the actual rendering specified by <code>render</code>.</p>\n\n<p>The next two lines extract the image stride, i.e. the number of bytes in a line and the actual image data as ByteString.</p>\n\n<p><code>swapRB</code> is a function that transforms the ByteString because somehow the red and blue channel are in the wrong order. See below for how this is done.</p>\n\n<p>In <a href=\"https://hackage.haskell.org/package/bytestring-0.10.8.1/docs/Data-ByteString.html\" rel=\"nofollow noreferrer\">B.useAsCStringLen</a> it gets low-level: It taks the ByteString returned by <a href=\"https://hackage.haskell.org/package/cairo-0.13.3.1/docs/Graphics-Rendering-Cairo.html#v:imageSurfaceGetData\" rel=\"nofollow noreferrer\">imageSurfaceGetData</a> and converts it to a <code>Ptr CUChar</code> to create a new Pixbuf using <a href=\"https://hackage.haskell.org/package/gtk-0.14.6/docs/Graphics-UI-Gtk-Gdk-Pixbuf.html#v:pixbufNewFromData\" rel=\"nofollow noreferrer\">pixbufNewFromData</a>.</p>\n\n<p>That's it.</p>\n\n<p><code>swapRB</code> is defined as follows:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Word (Word8)\nimport Data.List (unfoldr)\n\nsplitAtIfNotNull :: Int -&gt; B.ByteString -&gt; Maybe (B.ByteString,B.ByteString)\nsplitAtIfNotNull i string \n  | B.null string = Nothing\n  | otherwise = Just $ B.splitAt i string \n\nmapChunks :: (B.ByteString -&gt; B.ByteString) -&gt; Int -&gt; B.ByteString -&gt; B.ByteString\nmapChunks mapper chunkSize = B.concat . map mapper . unfoldr (splitAtIfNotNull chunkSize)\n\nswapRB :: Int -&gt; B.ByteString -&gt; B.ByteString\nswapRB = mapChunks swapRBforLine\n  where swapRBforLine :: B.ByteString -&gt; B.ByteString\n        swapRBforLine = mapChunks (B.pack . swapRBforPixel . B.unpack) 4 \n        swapRBforPixel :: [Word8] -&gt; [Word8]\n        swapRBforPixel [b,g,r,a] = [r,g,b,a]\n        swapRBforPixel other = other\n</code></pre>\n\n<p>It splits the ByteString of pixeldata into lines, then splits the lines into pixels each consisting of 4 bytes: one byte each for the channels red, green, blue, alpha. Innermost is the actual swapping:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>swapRBforPixel [b,g,r,a] = [r,g,b,a]\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 4022586, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Daniel Schmitz", "link": "https://stackoverflow.com/users/4022586/daniel-schmitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1479560537, "creation_date": 1479458908, "last_edit_date": 1479465212, "question_id": 40672750, "link": "https://stackoverflow.com/questions/40672750/how-do-i-render-into-a-gtk3-statusicon-using-cairo-in-a-haskell-application", "title": "How do I render into a gtk3 statusicon using cairo in a haskell application?", "body": "<p>I would like render into the <a href=\"https://hackage.haskell.org/package/gtk-0.14.6/docs/Graphics-UI-Gtk-Display-StatusIcon.html\" rel=\"nofollow noreferrer\">statusicon</a> of my application.</p>\n\n<p>I know I can make the statusicon display a pixbuf by setting <a href=\"https://hackage.haskell.org/package/gtk-0.14.6/docs/Graphics-UI-Gtk-Display-StatusIcon.html#v:statusIconPixbuf\" rel=\"nofollow noreferrer\">statusIconPixbuf</a>.</p>\n\n<p>And I can create an empty pixbuf via <a href=\"https://hackage.haskell.org/package/gtk-0.14.6/docs/Graphics-UI-Gtk-Gdk-Pixbuf.html#v:pixbufNew\" rel=\"nofollow noreferrer\">pixbufNew</a>  and do things like filling it with a single color.</p>\n\n<p>But how do render into that pixbuf using cairo?</p>\n\n<p>Or is pixbuf not the right thing to use? Is there a better way to render into the statusicon?</p>\n"}, {"tags": ["haskell", "overloading", "type-families", "associated-types"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1479457880, "post_id": 40672219, "comment_id": 68575073, "body": "<code>sum</code> returns an <code>e</code> (since <code>x</code> and <code>y</code> have type <code>[e]</code>) but <code>dot</code> should be returning a <code>HT e = Double</code>. Somehow, you&#39;ll need to convert <code>e</code> to a <code>Double</code>."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1479461349, "post_id": 40673391, "comment_id": 68577113, "body": "Interesting. Can you elaborate on what&#39;s wrong with <code>linear</code> and parametricity? I just quickly looked at it, and can&#39;t spot the issue you hint at."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1479463897, "post_id": 40673391, "comment_id": 68578792, "body": "@chi: the most practical problem is that it prevents you from using unboxed vector types, which really is a big issue for serious linear algebra. On a more mathematical level: a vector space should be basis-agnostic \u2013 it&#39;s something abstract geometric, and any array-of-numbers representation just arises from an arbitrary choice of basis, which should not influence any end results. But if you fmap a nonlinear operation over a <code>*-&gt;*</code> vector, you&#39;ll get a different result depending on which basis the representation refers to."}, {"owner": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "edited": false, "score": 0, "creation_date": 1479481895, "post_id": 40673391, "comment_id": 68590593, "body": "@leftaroundabout thank you for your input; could you suggest an improvement for the class design? E.g. how to solve the overlapping instances problem. On the other hand, I need the &quot;container&quot; idea (<code>* -&gt; *</code>) to make certain optimizations possible (sparse computations)."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "edited": false, "score": 0, "creation_date": 1479483970, "post_id": 40673391, "comment_id": 68592087, "body": "@ocramz there is no overlapping instances problem if you define the instances individually, which is what I&#39;d suggest. (Of course that&#39;s not to encourage code duplication in general, but for class instances like this it&#39;s generally very little code, or else you can define all instances in terms of just two different helper functions.)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1479483976, "post_id": 40673391, "comment_id": 68592092, "body": "It eludes me why you think a <code>*-&gt;*</code> type would give you any edge in sparse optimisation. Any <code>*-&gt;*</code> structure can also be used in a <code>*</code> class be applying it to an arbitrary particular type; OTOH if you need to support full parametricity you can&#39;t make the sparseness dependent on the contained values."}, {"owner": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "edited": false, "score": 0, "creation_date": 1479649357, "post_id": 40673391, "comment_id": 68637270, "body": "@leftaroundabout I understood my error with <code>* -&gt; *</code> by studying more closely <code>vector-space</code>. Can you expand on your last remark? &quot; if you need to support full parametricity you can&#39;t make the sparseness dependent on the contained values&quot;"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "edited": false, "score": 0, "creation_date": 1479660526, "post_id": 40673391, "comment_id": 68641125, "body": "@ocramz: example \u2014 if your sparse structure is, say, <code>Map Int Double</code>, you can eliminate zeroes created in a vector addition by cancelling. That&#39;s not possible if the addition operation has the signature <code>(^+^) :: Num a =&gt; f a -&gt; f a -&gt; f a</code>, because you can&#39;t zero-check those general-number elements. Ok, now you say you could just add an <code>Eq</code> constraint. But in practice that wouldn&#39;t be much use because floating-point addition makes it rather unlikely to obtain exact zeroes. You&#39;d need some sort of uncertainty handling. This gets very fiddly if you don&#39;t have access to the concrete type."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 3, "last_activity_date": 1479461056, "creation_date": 1479461056, "answer_id": 40673391, "question_id": 40672219, "link": "https://stackoverflow.com/questions/40672219/typeclass-instances-with-constrained-return-type/40673391#40673391", "title": "Typeclass instances with constrained return type", "body": "<p>Well, that particular instance doesn't work because the <code>sum</code> only yields an <code>e</code>, but you want the result to be <code>Double</code>. As <code>e</code> <em>is</em> constrained to <code>RealFrac</code>, this is easy to fix though, as any <code>Real</code> (questionable though is is mathematically) can be converted to a <code>Fractional</code>:</p>\n\n<pre><code>  dot x y = realToFrac . sum $ zipWith (*) x y\n</code></pre>\n\n<p>However, that generic instance prevents you from also defining complex instances: with <code>instance RealFloat e =&gt; Hilbert [] e where</code> you cover <em>all</em> types, even if they aren't really real numbers. You could still instantiate <code>Complex</code> as an overlapping instance, but I'd rather stay away from those if I could help it.</p>\n\n<p>It's also questionable if such vectorspace classes should be defined on <code>* -&gt; *</code> at all. Yes, <a href=\"http://hackage.haskell.org/package/linear\" rel=\"nofollow noreferrer\"><code>linear</code></a> also does it this way, but IMO parametricity doesn't work in our favour in this application. Have you checked out the <a href=\"http://hackage.haskell.org/package/vector-space\" rel=\"nofollow noreferrer\"><code>vector-space</code> package</a>? Mind, it isn't exactly complete for doing serious linear algebra; that's a gap I hope to fill with my <a href=\"http://hackage.haskell.org/package/linearmap-category/docs/Math-LinearMap-Category.html\" rel=\"nofollow noreferrer\"><code>linearmap-category</code> package</a>.</p>\n"}], "owner": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 40673391, "answer_count": 1, "score": 0, "last_activity_date": 1479461056, "creation_date": 1479456823, "question_id": 40672219, "link": "https://stackoverflow.com/questions/40672219/typeclass-instances-with-constrained-return-type", "title": "Typeclass instances with constrained return type", "body": "<p>I'm implementing a notion of inner product that's general over the container and numerical types. The definition states that the return type of this operation is a (non-negative) real number.\nOne option (shown below) is to write all instances by hand, for each numerical type (Float, Double, Complex Float, Complex Double, Complex CFloat, Complex CDouble, etc.). The primitive types aren't many, but I dislike the repetition.\nAnother option, or so I thought, is to have a parametric instance with a constraint such as <code>RealFloat</code> (which represents <code>Float</code> and <code>Double</code>).</p>\n\n<pre><code>{-# language MultiParamTypeClasses, TypeFamilies, FlexibleInstances #-}\nmodule Test where\n\nimport Data.Complex\n\nclass Hilbert c e where\n  type HT e :: *\n  dot :: c e -&gt; c e -&gt; HT e\n\n\ninstance Hilbert [] Double where\n  type HT Double = Double\n  dot x y = sum $ zipWith (*) x y\n\ninstance Hilbert [] (Complex Double) where\n  type HT (Complex Double) = Double\n  a `dot` b = realPart $ sum $ zipWith (*) (conjugate &lt;$&gt; a) b\n</code></pre>\n\n<h2>Question</h2>\n\n<p>Why does the instance below not work (\"Couldn't match type <code>e</code> with <code>Double</code>.. expected type <code>HT e</code>, actual type <code>e</code>\")? </p>\n\n<pre><code>instance RealFloat e =&gt; Hilbert [] e where\n  type HT e = Double\n  dot x y = sum $ zipWith (*) x y\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 486, "user_id": 184911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/powhQ.jpg?s=128&g=1", "display_name": "mgryszko", "link": "https://stackoverflow.com/users/184911/mgryszko"}, "edited": false, "score": 0, "creation_date": 1479629422, "post_id": 40686884, "comment_id": 68632316, "body": "In the list monad example, reduction part. Should the partial lists be <code>[subtract 5 a, a + 5]</code>?"}], "tags": [], "owner": {"reputation": 589, "user_id": 1486400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b6c720fd6b86fdf2293eefb5188d46b?s=128&d=identicon&r=PG", "display_name": "int_index", "link": "https://stackoverflow.com/users/1486400/int-index"}, "is_accepted": true, "score": 9, "last_activity_date": 1479633343, "last_edit_date": 1479633343, "creation_date": 1479507880, "answer_id": 40686884, "question_id": 40670478, "link": "https://stackoverflow.com/questions/40670478/writert-transforming-a-list-monad-how-do-inner-and-outer-monad-work-together/40686884#40686884", "title": "WriterT transforming a list monad - how do inner and outer monad work together?", "body": "<p>Remember that a <code>Monad</code> in Haskell is a type <code>m :: * -&gt; *</code> that supports two operations:</p>\n\n<ol>\n<li><code>return :: a -&gt; m a</code></li>\n<li><code>(&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b</code></li>\n</ol>\n\n<p>Although it is often useful to think about a sequence of actions in <code>do</code>-notation as a computation, when you're interested in what's going on under the hood, you should think about values of type <code>m a</code> and what happens to them when <code>return</code> and <code>(&gt;&gt;=)</code> are involved.</p>\n\n<p>The monad in question is <code>WriterT [Vertex] []</code>. And this is how <code>WriterT</code> is defined:</p>\n\n<pre><code>newtype WriterT w m a = WriterT { runWriterT :: m (a, w) }\n</code></pre>\n\n<p>Substitute <code>[Vertex]</code> for <code>w</code> and <code>[]</code> for <code>m</code>. We get this:</p>\n\n<pre><code>[(a, [Vertex])]\n</code></pre>\n\n<p>so it's a list of values of type <code>a</code>, each value has a list of vertices associated with it. Those types are <em>equivalent</em> modulo newtype wrapping/unwrapping. Now we need to understand how <code>return</code> and <code>(&gt;&gt;=)</code> work for this type.</p>\n\n<p><code>return</code> for <code>[]</code> creates a singleton list. So <code>return 'x' :: [Char]</code> is <code>['x']</code>. <code>return</code> for <code>WriterT</code> sets the accumulator to <code>mempty</code> and delegates the rest of the job to the <code>return</code> of the inner monad.</p>\n\n<p>In our case, the accumulator has type <code>[Vertex]</code> and <code>mempty :: [Vertex]</code> is <code>[]</code>. This means that <code>return 'x' :: WriterT [Vertex] [] Char</code> is represented as <code>[('x', [])]</code> \u2014 the <code>'x'</code> character with an empty list of vertices. That's pretty straightforward: the <code>return</code> method of our monad creates a singleton list with no vertices associated with the only value in this list.</p>\n\n<p>The tricky part is, of course, the <code>(&gt;&gt;=)</code> operator (pronounced \"bind\", in case you didn't know). For lists it has type <code>[a] -&gt; (a -&gt; [b]) -&gt; [b]</code>. Its semantics are that the function <code>a -&gt; [b]</code> will be applied to each element in <code>[a]</code>, and the resulting <code>[[b]]</code> will be concatenated.</p>\n\n<p><code>[a, b, c] &gt;&gt;= f</code> will become <code>f a ++ f b ++ f c</code>. A simple example to demonstrate:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>[10, 20, 30] &gt;&gt;= \\a -&gt; [a - 5, a + 5]\n</code></pre>\n\n<p>Can you figure out what the resulting list will be? (Run the example in GHCi, if not).</p>\n\n<p>Nothing prevents you from using <code>(&gt;&gt;=)</code> within the function supplied to another <code>(&gt;&gt;=)</code>:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>[10, 20, 30] &gt;&gt;= \\a -&gt;\n  [subtract 5, (+5)] &gt;&gt;= \\f -&gt;\n    [f a]\n</code></pre>\n\n<p>Indeed, this is how the <code>do</code>-notation works. The above example is equivalent to:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>do\n  a &lt;- [10, 20, 30]\n  f &lt;- [subtract 5, (+5)]\n  return (f a)\n</code></pre>\n\n<p>So it's like building a tree of values and then flattening it into a single list. Initial tree:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>a &lt;-               (10)-----------------(20)------------------(30)\n                    |                     |                     |\n                    |                     |                     |\n                    v                     v                     v\nf &lt;-   (subtract 5)----(+5)  (subtract 5)----(+5)  (subtract 5)----(+5)\n               |        |            |        |            |        |\n               |        |            |        |            |        |\n               v        v            v        v            v        v\n             [f a]    [f a]        [f a]    [f a]        [f a]    [f a] \n</code></pre>\n\n<p>Step 1 (substitute <code>f</code>):</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>a &lt;-       (10)-----------------(20)-------------------(30)\n            |                     |                     |\n            |                     |                     |\n            v                     v                     v\n    [subtract 5 a, a + 5]  [subtract 5 a, a + 5] [subtract 5 a, a + 5]\n</code></pre>\n\n<p>Step 2 (substitute <code>a</code>):</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>[subtract 5 10, 10 + 5, subtract 5 20, 20 + 5, subtract 5 30, 30 + 5]\n</code></pre>\n\n<p>And then, of course, it reduces to <code>[5, 10, 15, 20, 25, 30, 35]</code>.</p>\n\n<p>Now, as you can remember, <code>WriterT</code> adds an accumulator to each of your values. So at each step of flattening the tree, it will use <code>mappend</code> to merge those accumulators.</p>\n\n<p>Let's get back to your example, <code>pathWriterT'</code>. To ease the understanding, I will modify it a little bit to remove the handling of self-loops and to make binding units explicit:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>pathsWriterT' :: [Edge] -&gt; Vertex -&gt; Vertex -&gt; WriterT [Vertex] [] ()\npathsWriterT' edges start end\n  | start == end = tell [end]\n  | otherwise    = do\n    (e_start, e_end) &lt;- lift edges\n    () &lt;- guard $ e_start == start\n    () &lt;- tell [start]\n    pathsWriterT' edges e_end end\n</code></pre>\n\n<p>Consider an invocation of <code>pathsWriterT'</code> where</p>\n\n<ul>\n<li><code>edges</code> = <code>[(1,2), (2,3), (2,4)]</code></li>\n<li><code>start</code> = <code>1</code></li>\n<li><code>end</code> = <code>4</code></li>\n</ul>\n\n<p>Once again, we can draw a tree, but it will be quite more complex, so let's do it line-by-line:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>{- Line 1 -} (e_start, e_end) &lt;- lift edges\n{- Line 2 -} () &lt;- guard $ e_start == start\n{- Line 3 -} () &lt;- tell [start]\n{- Line 4 -} pathsWriterT' edges e_end end\n</code></pre>\n\n<p>Line 1. The type of <code>edges</code> is <code>[Edge]</code>. When you apply <code>lift</code> from <code>MonadTrans</code> to them, it becomes <code>WriterT [Vertex] [] Edge</code>. Remember that under the hood this is simply <code>[(Edge, [Vertex])]</code>. The implementation of <code>lift</code> for <code>WriterT</code> is straightforward: set accumulator to <code>mempty</code> for each value. Thus now we have <code>lift edges</code> equal to:</p>\n\n<pre><code>[ ((1,2), []) ,\n  ((2,3), []) ,\n  ((2,4), []) ]\n</code></pre>\n\n<p>And our tree is:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>(e_start, e_end) &lt;-    ((1,2), [])------((2,3), [])-----((2,4), [])\n</code></pre>\n\n<p>For each of those <code>(e_start, e_end)</code> values, the following happens...</p>\n\n<p>Line 2. The source vertex of an edge is bound to <code>e_start</code> and the target vertex is bound to <code>e_end</code>. <code>guard</code> expands to <code>return ()</code> when its argument is <code>True</code> and to <code>empty</code> when it's <code>False</code>. For lists, <code>return ()</code> is <code>[()]</code> and <code>empty</code> is <code>[]</code>. For our monad, we have the same but with accumulators: <code>return ()</code> is <code>[((), [])]</code> and <code>empty</code> is still <code>[]</code> (because there's no values to attach an accumulator to). Since we decided that <code>start</code> = <code>1</code>, the results of evaluating <code>guard</code> are:</p>\n\n<ul>\n<li>for <code>(1,2)</code>, <code>[((), [])]</code></li>\n<li>for <code>(2,3)</code>, <code>[]</code></li>\n<li>for <code>(2,4)</code>, <code>[]</code></li>\n</ul>\n\n<p>There are three results because we're working with <em>each</em> element. Let's add them to our tree:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>(e_start, e_end) &lt;-    ((1,2), [])------((2,3), [])-----((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                             v                none            none\n()               &lt;-      ((), [])\n</code></pre>\n\n<p>As you see, I wrote <code>none</code> in place of children nodes for <code>(2,3)</code> and <code>(2,4)</code>. That's because <code>guard</code> didn't provide them with children nodes, it returned an empty list. And now we proceed...</p>\n\n<p>Line 3. Now we use <code>tell</code> to expand the accumulator. <code>tell</code> returns the unit value, <code>()</code>, but with an accumulator attached to it. Since <code>start</code> equals to <code>1</code>, the accumulator will be <code>[1]</code>. So let's adjust our tree:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>(e_start, e_end) &lt;-    ((1,2), [])------((2,3), [])-----((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                             v                none            none\n()               &lt;-      ((), [])\n                             |\n                             |\n                             v\n()               &lt;-      ((), [1])\n</code></pre>\n\n<p>Line 4. Now we call <code>pathsWriterT' edges e_end end</code> to recursively continue building the tree! Cool. Inside this recursive invocation: we have:</p>\n\n<ul>\n<li><code>edges</code> = old <code>edges</code></li>\n<li><code>start</code> = old <code>e_end</code> = <code>2</code></li>\n<li><code>end</code> = old <code>end</code> = <code>4</code></li>\n</ul>\n\n<p>We're back at line 1. Our tree now looks like this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>(e_start, e_end) &lt;-    ((1,2), [])------((2,3), [])-----((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                             v                none            none\n()               &lt;-      ((), [])\n                             |\n                             |\n                             v\n()               &lt;-      ((), [1])\n                             |\n                             |\\_________________________________\n                             |                 |               |\n                             v                 v               v\n(e_start, e_end) &lt;-    ((1,2), [])      ((2,3), [])     ((2,4), [])\n</code></pre>\n\n<p>And line 2 again... only this time, it will leave us with different nodes (as <code>start</code> has changed)!</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>(e_start, e_end) &lt;-    ((1,2), [])------((2,3), [])-----((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                             v                none            none\n()               &lt;-      ((), [])\n                             |\n                             |\n                             v\n()               &lt;-      ((), [1])\n                             |\n                             |\\_________________________________\n                             |                 |               |\n                             v                 v               v\n(e_start, e_end) &lt;-    ((1,2), [])      ((2,3), [])     ((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                           none                v               v\n()               &lt;-                        ((), [])        ((), [])\n</code></pre>\n\n<p>And line 3 again, now it will add <code>[2]</code> as accumulator.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>(e_start, e_end) &lt;-    ((1,2), [])------((2,3), [])-----((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                             v                none            none\n()               &lt;-      ((), [])\n                             |\n                             |\n                             v\n()               &lt;-      ((), [1])\n                             |\n                             |\\_________________________________\n                             |                 |               |\n                             v                 v               v\n(e_start, e_end) &lt;-    ((1,2), [])      ((2,3), [])      ((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                           none                v               v\n()               &lt;-                        ((), [])        ((), [])\n                                               |               |\n                                               |               |\n                                               v               v\n()               &lt;-                       ((), [2])       ((), [2])\n</code></pre>\n\n<p>At line 4 we recurse into <code>pathsWriterT'</code>.</p>\n\n<ul>\n<li><code>edges</code> = old <code>edges</code></li>\n<li><code>start</code> = old <code>e_end</code> = <code>3</code>, <code>4</code></li>\n<li><code>end</code> = old <code>end</code> = <code>4</code></li>\n</ul>\n\n<p>Notice that I wrote both <code>3</code> and <code>4</code> as values of <code>e_end</code>. That's because recursion happens in both branches:</p>\n\n<ol>\n<li>In branch <code>(2,3)</code> we will once again go create a child per edge.</li>\n<li>In branch <code>(2,4)</code>, however, notice that <code>start == end</code> holds, bringing the end to recursion. We create a child <code>[((), [4])]</code> because that's the result of <code>tell [4]</code> for our monad.</li>\n</ol>\n\n<pre class=\"lang-none prettyprint-override\"><code>(e_start, e_end) &lt;-    ((1,2), [])------((2,3), [])-----((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                             v                none            none\n()               &lt;-      ((), [])\n                             |\n                             |\n                             v\n()               &lt;-      ((), [1])\n                             |\n                             |\\_________________________________\n                             |                 |               |\n                             v                 v               v\n(e_start, e_end) &lt;-    ((1,2), [])      ((2,3), [])     ((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                           none                v               v\n()               &lt;-                        ((), [])        ((), [])\n                                               |               |\n                                               |               |\n                                               v               v\n()               &lt;-                       ((), [2])       ((), [2])\n                                               |               |\n                           ____________________|____           v\n                           |            |          |      [((), [4])]\n                           v            v          v\n(e_start, e_end) &lt;- ((1,2), [])  ((2,3), [])  ((2,4), [])\n</code></pre>\n\n<p>At line 2, the guard won't let any new children to appear here, because there's no node to satisfy <code>e_start == 4</code>.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>(e_start, e_end) &lt;-    ((1,2), [])------((2,3), [])-----((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                             v                none            none\n()               &lt;-      ((), [])\n                             |\n                             |\n                             v\n()               &lt;-      ((), [1])\n                             |\n                             |\\_________________________________\n                             |                 |               |\n                             v                 v               v\n(e_start, e_end) &lt;-    ((1,2), [])      ((2,3), [])     ((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                           none                v               v\n()               &lt;-                        ((), [])        ((), [])\n                                               |               |\n                                               |               |\n                                               v               v\n()               &lt;-                       ((), [2])       ((), [2])\n                                               |               |\n                           ____________________|____           v\n                           |            |          |      [((), [4])]\n                           v            v          v\n(e_start, e_end) &lt;- ((1,2), [])  ((2,3), [])  ((2,4), [])\n                           |            |          |\n                           |            |          |\n                          none         none       none\n()               &lt;-\n</code></pre>\n\n<p>Whew! Our tree is built. Now it's time to reduce it. I will decrease the depth of our tree by 1 at each reduction step, going bottom-up. At each reduction step I will replace the parent with the concatenated list of its children, and <code>mappend</code> the parent's accumulator to the accumulators of its children. Why this exact logic? Well, that's just how <code>(&gt;&gt;=)</code> is defined for our monad.</p>\n\n<p>Notice that the leafs of our tree have type <code>[((), [Vertex])]</code> \u2014 that's the return type of <code>pathsWriterT'</code>. Remember that <code>none</code> stands for empty list <code>[]</code>, so it has this type as well. And inner nodes have type <code>(a, [Vertex])</code>, where <code>a</code> is the type of the bound variable (I've drawn variable bindings to the left of the tree).</p>\n\n<p>Step 1.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>(e_start, e_end) &lt;-    ((1,2), [])------((2,3), [])-----((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                             v                none            none\n()               &lt;-      ((), [])\n                             |\n                             |\n                             v\n()               &lt;-      ((), [1])\n                             |\n                             |\\_________________________________\n                             |                 |               |\n                             v                 v               v\n(e_start, e_end) &lt;-    ((1,2), [])      ((2,3), [])     ((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                           none                v               v\n()               &lt;-                        ((), [])        ((), [])\n                                               |               |\n                                               |               |\n                                               v               v\n()               &lt;-                       ((), [2])       ((), [2])\n                                               |               |\n                           ____________________|____           v\n                           |            |          |      [((), [4])]\n                          none         none       none\n</code></pre>\n\n<p>Step 2.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>(e_start, e_end) &lt;-    ((1,2), [])------((2,3), [])-----((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                             v                none            none\n()               &lt;-      ((), [])\n                             |\n                             |\n                             v\n()               &lt;-      ((), [1])\n                             |\n                             |\\_________________________________\n                             |                 |               |\n                             v                 v               v\n(e_start, e_end) &lt;-    ((1,2), [])      ((2,3), [])     ((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                           none                v               v\n()               &lt;-                        ((), [])        ((), [])\n                                               |               |\n                                               |               |\n                                               v               v\n()               &lt;-                       ((), [2])       ((), [2])\n                                               |               |\n                                              none             v\n                                                          [((), [4])]\n</code></pre>\n\n<p>Step 3.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>(e_start, e_end) &lt;-    ((1,2), [])------((2,3), [])-----((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                             v                none            none\n()               &lt;-      ((), [])\n                             |\n                             |\n                             v\n()               &lt;-      ((), [1])\n                             |\n                             |\\_________________________________\n                             |                 |               |\n                             v                 v               v\n(e_start, e_end) &lt;-    ((1,2), [])      ((2,3), [])     ((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                           none                v               v\n()               &lt;-                        ((), [])        ((), [])\n                                               |               |\n                                               |               |\n                                              none             v\n                                                         [((), [2,4])]\n</code></pre>\n\n<p>Step 4.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>(e_start, e_end) &lt;-    ((1,2), [])------((2,3), [])-----((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                             v                none            none\n()               &lt;-      ((), [])\n                             |\n                             |\n                             v\n()               &lt;-      ((), [1])\n                             |\n                             |\\_________________________________\n                             |                 |               |\n                             v                 v               v\n(e_start, e_end) &lt;-    ((1,2), [])      ((2,3), [])     ((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                           none               none             v\n                                                         [((), [2,4])]\n</code></pre>\n\n<p>Step 5.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>(e_start, e_end) &lt;-    ((1,2), [])------((2,3), [])-----((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                             v                none            none\n()               &lt;-      ((), [])\n                             |\n                             |\n                             v\n()               &lt;-      ((), [1])\n                             |\n                             |\\_________________________________\n                             |                 |               |\n                           none               none             v\n                                                         [((), [2,4])]\n</code></pre>\n\n<p>Step 6.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>(e_start, e_end) &lt;-    ((1,2), [])------((2,3), [])-----((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                             v                none            none\n()               &lt;-      ((), [])\n                             |\n                             |\n                             v\n                       [((), [1,2,4])]\n</code></pre>\n\n<p>Step 7.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>(e_start, e_end) &lt;-    ((1,2), [])------((2,3), [])-----((2,4), [])\n                             |                 |               |\n                             |                 |               |\n                             v                none            none\n                       [((), [1,2,4])]\n</code></pre>\n\n<p>Step 8.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>                       [((), [1,2,4])]\n</code></pre>\n\n<p><code>execWriterT</code> will discard the values and leave only the accumulators, and now we're left with <code>[[1,2,4]]</code>, which means that there's only one path from <code>1</code> to <code>4</code>: <code>[1,2,4]</code>.</p>\n\n<p>Exercise: do the same (with pen and paper) but for <code>edges</code> = <code>[(1,2), (1,3), (2,4), (3,4)]</code>. You should get <code>[[1,2,4], [1,3,4]]</code>.</p>\n"}], "owner": {"reputation": 486, "user_id": 184911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/powhQ.jpg?s=128&g=1", "display_name": "mgryszko", "link": "https://stackoverflow.com/users/184911/mgryszko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 2, "accepted_answer_id": 40686884, "answer_count": 1, "score": 2, "last_activity_date": 1479633343, "creation_date": 1479449731, "question_id": 40670478, "link": "https://stackoverflow.com/questions/40670478/writert-transforming-a-list-monad-how-do-inner-and-outer-monad-work-together", "title": "WriterT transforming a list monad - how do inner and outer monad work together?", "body": "<p>In the <em>Beginning Haskell</em> book on page 181, there is an example of using <code>WriterT</code> to wrap a <code>List</code> monad. The code below computes paths in a graph. Note that this is a very trivial algorithm not taking loops into account).</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>type Vertex = Int\ntype Edge = (Vertex, Vertex)\n\npathsWriterT :: [Edge] -&gt; Vertex -&gt; Vertex -&gt; [[Vertex]]\npathsWriterT edges start end = execWriterT (pathsWriterT' edges start end)\n\npathsWriterT' :: [Edge] -&gt; Vertex -&gt; Vertex -&gt; WriterT [Vertex] [] ()\npathsWriterT' edges start end =\n  let e_paths = do (e_start, e_end) &lt;- lift edges\n                   guard $ e_start == start\n                   tell [start]\n                   pathsWriterT' edges e_end end\n   in if start == end\n      then tell [start] `mplus` e_paths\n      else e_paths\n</code></pre>\n\n<p>In both <code>let</code> and <code>in</code> blocks of <code>pathsWriterT'</code> I'm <em>telling</em> the writer to add the current vertex to the path. But later in the <code>pathsWriterT</code> by <em>executing</em> the writer I'm getting the list of possible paths.</p>\n\n<p>How the Writer combines all computed paths into the list of paths? How are different paths \"stored\" independently in a single computation represented by <code>WriterT</code>? (pardon my imperative language)</p>\n"}, {"tags": ["haskell", "haskell-lens", "isomorphism"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 4, "creation_date": 1479449701, "post_id": 40669531, "comment_id": 68571253, "body": "I think the most efficient way to do this is actually to at all times keep track of <i>both</i> the row/col pair and absolute offset. Trying to get the one from the other is going to involve traversing the whole text."}, {"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1479450182, "post_id": 40669531, "comment_id": 68571438, "body": "That&#39;s likely true, but I&#39;d love to learn how to do this regardless  ;)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1479455799, "post_id": 40669531, "comment_id": 68574049, "body": "Why don&#39;t you just manually define <code>cursor[From,To]Tup :: Buffer Offset \u2190\u2192 Buffer (Int, Int)</code> and use <code>iso cursorFromTup cursorToTup</code>? No type classes needed."}, {"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "edited": false, "score": 0, "creation_date": 1479483720, "post_id": 40669531, "comment_id": 68591896, "body": "That sounds good, but what do I put as a type restraint on &#39;c&#39; in the Buffer in the appendText function signature  then?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 3, "creation_date": 1479486612, "post_id": 40669531, "comment_id": 68593898, "body": "@ChrisPenner The point of isomorphisms is not that you remain entirely polymorphic, but that you can easily interconvert between forms. For <code>appendText</code> you should choose whichever of the two forms is most convenient. Then, if you need the other form, you can easily convert to it."}, {"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "edited": false, "score": 0, "creation_date": 1479488946, "post_id": 40669531, "comment_id": 68595281, "body": "After a bit more looking around it seems that with a similar instance to the <code>Injective</code> from that lib I think I can maintain polymorphism with   <code>appendText ::  Injective c Offset =&gt; T.Text -&gt; Buffer c -&gt; Buffer Offset</code>  or  <code>appendText ::  Iso c Offset =&gt; T.Text -&gt; Buffer c -&gt; Buffer c</code> However if you think it&#39;s better to just pick one and use the iso lens I suppose that makes sense, I&#39;ll just have to convert on the way in with a lens I suppose."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1479526221, "post_id": 40669531, "comment_id": 68608079, "body": "It seems to me all of these potential solutions are overly complicated.. what is wrong with <code>cursor :: Either Offset RowCol</code>? If you want to distinguish between the two on the type level, it isn&#39;t much harder: <code>data CursorType t where Offset :: CursorType Int; RowCol :: CursorType (Int, Int)</code> and <code>Buffer :: Text -&gt; c -&gt; CursorType c -&gt; Buffer c</code>. With such an encoding you can freely write &#39;parametric&#39; functions which, in fact, can perform case analysis on the type of the cursor."}], "owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1479453017, "creation_date": 1479444227, "last_edit_date": 1479453017, "question_id": 40669531, "link": "https://stackoverflow.com/questions/40669531/how-do-i-generalize-over-an-isomorphism", "title": "How do I generalize over an Isomorphism?", "body": "<p>So I'm just trying to get a handle on isomorphisms and could use a hand.</p>\n\n<p>I'm writing a text editor and I'd like to think about the cursor's position in two different ways depending on the task, either as a tuple of (row, column) or as a single integer offset into the text object.</p>\n\n<p>I'm building the whole thing using lenses, so this seemed like a good place to learn about Isos.</p>\n\n<p>Originally I had a <code>Buffer</code> object:</p>\n\n<pre><code>data Buffer = Buffer {\n    _text :: T.Text\n, _cursor :: Int\n} deriving (Show, Eq)\nmakeLenses ''Buffer\n</code></pre>\n\n<p>But now that the cursor could be a (row, col) tuple I've changed it to:</p>\n\n<pre><code>data Buffer c = Buffer {\n    _text :: T.Text\n, _cursor :: c\n} deriving (Show, Eq)\nmakeLenses ''Buffer\n</code></pre>\n\n<p>Since within the context of a buffer I have an isomorphism from <code>Buffer Int</code> to <code>Buffer (Int, Int)</code> (this restraint is because I need the text AND the offset in order to do a transformation), I'd love to have all my functions that take a buffer act over either and 'just work'.</p>\n\n<p>Right now I'm stuck on how to make it polymorphic in my definitions,</p>\n\n<p>I can do:</p>\n\n<pre><code>appendText :: T.Text -&gt; Buffer c -&gt; Buffer c\n</code></pre>\n\n<p>But then of course I can't actually use the cursor at all because it's completely untyped.</p>\n\n<p>The only roughly related lib I could find was this <a href=\"https://hackage.haskell.org/package/type-iso-0.1.0.0\" rel=\"nofollow noreferrer\">type-iso</a> library,\nand it doesn't look very popular. That, with the notion that I couldn't find any blog posts has me wondering whether this is a thing people do?</p>\n\n<p>If this is a good library to use,\nI'm thinking I need to write an instance for <a href=\"https://hackage.haskell.org/package/type-iso-0.1.0.0/candidate/docs/Data-Types-Isomorphic.html\" rel=\"nofollow noreferrer\">Isomorphic</a>, and it seems like I get this for free if I write each instance for <a href=\"https://hackage.haskell.org/package/type-iso-0.1.0.0/candidate/docs/Data-Types-Injective.html\" rel=\"nofollow noreferrer\">Injective</a>, but I can't find any docs or examples that I can readily understand so I wanted to check if this is the idiomatic way. If this IS right, do I use the Isomorphic constraint or the Injective one?</p>\n\n<p><strong>Edit</strong>: I fiddled with it a bit and it seems indeed as though I can implement Injective and get the Iso for free, but again, this lib doesn't seem popular, so I'm looking for the idiomatic approach.</p>\n\n<p>Lastly, for my lens isos do I have to write:</p>\n\n<pre><code>toRowColumn :: Iso' (Buffer Offset) (Buffer (Int, Int))\ntoRowColumn = iso to to\n\ntoOffset :: Iso' (Buffer (Int, Int)) (Buffer Offset)\ntoOffset = iso to to\n</code></pre>\n\n<p>Or is there a better/easier way? Could these be derived from my instances?</p>\n\n<p>Does anyone know of some good lens isomorphism examples or tutorials? Google's not much help :/</p>\n\n<p>Thanks for the help! Just want to check in to make sure I'm doing everything idiomatically.</p>\n"}, {"tags": ["function", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 3672848, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7285b6155b16c0476f29bf73bacb0fc8?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Marley", "link": "https://stackoverflow.com/users/3672848/bob-marley"}, "edited": false, "score": 0, "creation_date": 1479436052, "post_id": 40668366, "comment_id": 68567660, "body": "Ok, so I was testing, and it seems the main issue I was having was brackets around &#39;n-1&#39;. Do you perhaps have a reason why that screws up the function?"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 103, "user_id": 3672848, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7285b6155b16c0476f29bf73bacb0fc8?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Marley", "link": "https://stackoverflow.com/users/3672848/bob-marley"}, "edited": false, "score": 2, "creation_date": 1479436109, "post_id": 40668366, "comment_id": 68567670, "body": "Yes, because then it gets parsed as <code>((compose f n) - 1)</code> i.e. it&#39;s trying to subtract 1 from <code>compose f n</code> which is not a number."}, {"owner": {"reputation": 103, "user_id": 3672848, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7285b6155b16c0476f29bf73bacb0fc8?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Marley", "link": "https://stackoverflow.com/users/3672848/bob-marley"}, "edited": false, "score": 1, "creation_date": 1479436253, "post_id": 40668366, "comment_id": 68567711, "body": "Ok, thank you very much. That actually clarified a bunch."}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 7, "last_activity_date": 1479436575, "last_edit_date": 1479436575, "creation_date": 1479435627, "answer_id": 40668366, "question_id": 40668325, "link": "https://stackoverflow.com/questions/40668325/haskell-writing-my-own-function-to-compose-functions/40668366#40668366", "title": "Haskell writing my own function to compose functions", "body": "<p>In the second case, you are trying to refer to <code>a</code> which I think you meant as <code>f</code>, since then</p>\n\n<pre><code>compose f n = (compose f (n-1)) . f\n</code></pre>\n\n<p>(note also that <code>compose f n - 1</code> is parsed as <code>(compose f n) - 1</code> in your code)</p>\n\n<p>which means you have</p>\n\n<pre><code>compose f 3 = (compose (+1) 2)             . f\n            = ((compose (+1) 1)       . f) . f\n            = (((compose (+1) 0) . f) . f) . f\n            = ((((*1)            . f) . f) . f\n</code></pre>\n\n<p>Oh and by the way, you can write</p>\n\n<pre><code>compose f 0 = id\n</code></pre>\n\n<p>which expresses the idea that <code>compose f 0</code> should do \"nothing\".</p>\n"}], "owner": {"reputation": 103, "user_id": 3672848, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7285b6155b16c0476f29bf73bacb0fc8?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Marley", "link": "https://stackoverflow.com/users/3672848/bob-marley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 40668366, "answer_count": 1, "score": 3, "last_activity_date": 1479436575, "creation_date": 1479435312, "last_edit_date": 1479435407, "question_id": 40668325, "link": "https://stackoverflow.com/questions/40668325/haskell-writing-my-own-function-to-compose-functions", "title": "Haskell writing my own function to compose functions", "body": "<p>so I am trying to write my own function to compose a function n times in Haskell. </p>\n\n<p>so for example, the input</p>\n\n<pre><code>compose (+1) 3 \n</code></pre>\n\n<p>would return <code>f(x) = x+3</code>;</p>\n\n<p>Now my attempt is as follows, but is actually quite naive and currently doesn't work.</p>\n\n<pre><code>compose f 0 = (*1)\ncompose f n = (compose f n-1).a\n</code></pre>\n"}, {"tags": ["haskell", "serialization", "type-level-computation", "servant"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1479434039, "post_id": 40667682, "comment_id": 68567160, "body": "Can you give an example of a function that you want to get more static guarantees out of? Like the left-hand side and type signature at least"}, {"owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1479442116, "post_id": 40667682, "comment_id": 68568950, "body": "Just added an example. Does that help?"}], "answers": [{"comments": [{"owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "edited": false, "score": 0, "creation_date": 1479442335, "post_id": 40668310, "comment_id": 68569003, "body": "This is sweet, and super helpful, thanks! To be clear, I don&#39;t need to deserialize this format, only serialize it."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "edited": false, "score": 0, "creation_date": 1479445037, "post_id": 40668310, "comment_id": 68569696, "body": "@SeanClarkHess yeah maybe I should try reading questions next time before answering them ;)"}, {"owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "edited": false, "score": 0, "creation_date": 1479482857, "post_id": 40668310, "comment_id": 68591312, "body": "So I see how to use the Nat values at runtime. Is there any way to use them to statically check that the offsets line up? (See in my question, above)"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "edited": false, "score": 0, "creation_date": 1479696410, "post_id": 40668310, "comment_id": 68651988, "body": "The trick I use here is to store the offsets implicitly in the type: the width of every part is static and knowable from the type alone; and the offset is simply the sum of the width of all previous parts."}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 3, "last_activity_date": 1479445023, "last_edit_date": 1479445023, "creation_date": 1479435239, "answer_id": 40668310, "question_id": 40667682, "link": "https://stackoverflow.com/questions/40667682/model-a-serial-format-in-the-type-system-like-servant/40668310#40668310", "title": "Model a serial format in the type system, like Servant", "body": "<p>Just to give you some inspiration, just do what Servant does and have different types for the different combinators you support:</p>\n\n<pre><code>{-# LANGUAGE GADTs, DataKinds, KindSignatures, TypeOperators, ScopedTypeVariables #-}\n\nmodule Seriavant where\n\nimport GHC.TypeLits\nimport Data.Proxy\nimport Data.List (stripPrefix)\n\ndata Skip (n :: Nat) = Skip deriving Show\ndata Token (n :: Nat) = Token String deriving Show\ndata Lit (s :: Symbol) = Lit deriving Show\n\ndata (:&gt;&gt;) a b = a :&gt;&gt; b deriving Show\ninfixr :&gt;&gt;\n\nclass Deserialize a where\n    deserialize :: String -&gt; Maybe (a, String)\n\ninstance (KnownNat n) =&gt; Deserialize (Skip n) where\n    deserialize s = do\n        (_, s') &lt;- trySplit (natVal (Proxy :: Proxy n)) s\n        return (Skip, s')\n\ninstance (KnownNat n) =&gt; Deserialize (Token n) where\n    deserialize s = do\n        (t, s') &lt;- trySplit (natVal (Proxy :: Proxy n)) s\n        return (Token t, s')\n\ninstance (KnownSymbol lit) =&gt; Deserialize (Lit lit) where\n    deserialize s = do\n        s' &lt;- stripPrefix (symbolVal (Proxy :: Proxy lit)) s\n        return (Lit, s')\n\ninstance (Deserialize a, Deserialize b) =&gt; Deserialize (a :&gt;&gt; b) where\n    deserialize s = do\n        (x, s') &lt;- deserialize s\n        (y, s'') &lt;- deserialize s'\n        return (x :&gt;&gt; y, s'')\n\ntrySplit :: Integer -&gt; [a] -&gt; Maybe ([a], [a])\ntrySplit 0 xs = return ([], xs)\ntrySplit n (x:xs) = do\n    (xs', ys) &lt;- trySplit (n-1) xs\n    return (x:xs', ys)\ntrySplit _ _ = Nothing\n</code></pre>\n\n<p>Yeah so this is quite spartan, but it already allows you to do</p>\n\n<pre><code>type MyFormat = Token 4 :&gt;&gt; Lit \"PERSON\" :&gt;&gt; Skip 1 :&gt;&gt; Token 4\n\ntestDeserialize :: String -&gt; Maybe MyFormat\ntestDeserialize = fmap fst . deserialize\n</code></pre>\n\n<p>which works like this:</p>\n\n<blockquote>\n<pre><code>*Seriavant&gt; testDeserialize \"1\"\nNothing\n*Seriavant&gt; testDeserialize \"1234PERSON Foo \"\nJust (Token \"1234\" :&gt;&gt; (Lit :&gt;&gt; (Skip :&gt;&gt; Token \"Foo \")))\n</code></pre>\n</blockquote>\n\n<p><strong>EDIT</strong>: Turns out I completely misread the question, and Sean is asking for serialization, not deserialization... But of course we can do that as well:</p>\n\n<pre><code>class Serialize a where\n    serialize :: a -&gt; String\n\ninstance (KnownNat n) =&gt; Serialize (Skip n) where\n    serialize Skip = replicate (fromIntegral $ natVal (Proxy :: Proxy n)) ' '\n\ninstance (KnownNat n) =&gt; Serialize (Token n) where\n    serialize (Token t) = pad (fromIntegral $ natVal (Proxy :: Proxy n)) ' ' t\n\ninstance (KnownSymbol lit) =&gt; Serialize (Lit lit) where\n    serialize Lit = symbolVal (Proxy :: Proxy lit)\n\ninstance (Serialize a, Serialize b) =&gt; Serialize (a :&gt;&gt; b) where\n    serialize (x :&gt;&gt; y) = serialize x ++ serialize y\n\npad :: Int -&gt; a -&gt; [a] -&gt; [a]\npad 0 _x0 xs = xs\npad n x0 (x:xs) = x : pad (n-1) x0 xs\npad n x0 [] = replicate n x0\n</code></pre>\n\n<p>(of course this has horrible performance with all this <code>String</code> concatenation etc. but that's not the point here)</p>\n\n<blockquote>\n<pre><code>*Seriavant&gt; serialize ((Token \"1234\" :: Token 4) :&gt;&gt; (Lit :: Lit \"FOO\") :&gt;&gt; (Skip :: Skip 2) :&gt;&gt; (Token \"Bar\" :: Token 10))\n\"1234FOO  Bar       \"\n</code></pre>\n</blockquote>\n\n<p>Of course, if we know the format, we can avoid those pesky type annotations:</p>\n\n<pre><code>type MyFormat = Token 4 :&gt;&gt; Lit \"PERSON\" :&gt;&gt; Skip 1 :&gt;&gt; Token 4\n\ntestSerialize :: MyFormat -&gt; String\ntestSerialize = serialize\n</code></pre>\n\n<blockquote>\n<pre><code>*Seriavant&gt; testSerialize (Token \"1234\" :&gt;&gt; Lit :&gt;&gt; Skip :&gt;&gt; Token \"Bar\")\n\"1234PERSON Bar \"\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 40668310, "answer_count": 1, "score": 1, "last_activity_date": 1479445023, "creation_date": 1479430401, "last_edit_date": 1479442104, "question_id": 40667682, "link": "https://stackoverflow.com/questions/40667682/model-a-serial-format-in-the-type-system-like-servant", "title": "Model a serial format in the type system, like Servant", "body": "<p>I'm working on an API integration that ignores the existence of XML or JSON in favor of just appending character data. (The <a href=\"http://www.cdiaonline.org/Metro2/content.cfm?ItemNumber=853\" rel=\"nofollow noreferrer\">Metro2</a> format, if interested)</p>\n\n<p>I'm simplifying, but imagine that a person needs to be serialized like this:</p>\n\n<ul>\n<li>At pos 0, 4 chars: Number of bytes in the message</li>\n<li>At pos 5: 6 chars: <code>\"PERSON\"</code> hard coded</li>\n<li>At pos 11: 20 chars: Name, left-aligned and space-padded</li>\n<li>At pos 21: 8 chars: Birthday, <code>YYYYMMDD</code></li>\n<li>At pos 29: 3 chars: Age, right-aligned and zero-padded</li>\n</ul>\n\n<p>Numeric fields are always right-aligned and zero-padded. Text fields are always left-aligned and space padded. </p>\n\n<p>For example:</p>\n\n<pre><code>\"0032PERSONDAVID WILCOX        19820711035\"\n</code></pre>\n\n<p>Can I express this in the type system? Like what <a href=\"http://haskell-servant.readthedocs.io/en/stable/tutorial/ApiType.html\" rel=\"nofollow noreferrer\">servant</a> does? Something like this?</p>\n\n<pre><code>newtype ByteLength = ByteLength Int\nnewtype Age = Age Int\n-- etc\n\ntype PersonMessage\n     = Field ByteLength '0\n    :| Field \"PERSON\" '5\n    :| Field Name '11\n    :| Field Date '21\n    :| Field Age '29\n\n-- :| is a theoretical type operator, like :&gt; in servant\n-- the number is the expected offset\n-- the length of the field is implicit in the type\n</code></pre>\n\n<p>Can I statically check that my implementation of the serialization matches the type?</p>\n\n<p>Can I statically check that the offset of the 3rd field (<code>Name</code>) is <code>11</code>? That the lengths of the preceding fields add up to 11? I'm assuming no, since that seems like it would require full dependent type support. </p>\n\n<p>Is this on the right track?</p>\n\n<pre><code>instance ToMetro Age where\n   -- get the length into the type system using a type family?\n   field = Numeric '3\n\n   -- express how this is encoded. Would need to use the length from the type family. Or if that doesn't work, put it in the constructor.\n   toMetro age = Numeric age\n</code></pre>\n\n<p><em>Update:</em> Example of a function I would like to statically validate:</p>\n\n<pre><code>personToMetro :: Person -&gt; PersonMessage\npersonToMetro p = error \"Make sure that what I return is a PersonMessage\"\n</code></pre>\n"}, {"tags": ["haskell", "lambda", "syntax"], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 5, "creation_date": 1479412505, "post_id": 40663468, "comment_id": 68558828, "body": "While your answer is essentially correct, &quot;currying&quot; is not quite the right term for the difference between the two definitions in the first question (currying involves going from <code>(a, b) -&gt; c</code> to <code>a -&gt; b -&gt; c</code>, and there are no pairs involved here). I&#39;m not even sure if there is a specific term for that, other than &quot;syntactic sugar&quot;."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1479413051, "post_id": 40663468, "comment_id": 68559190, "body": "<a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-260003.3\" rel=\"nofollow noreferrer\">Section 3.3 of the Haskell Report</a>, which specifies what we are talking about, is titled &quot;Curried Applications and Lambda Abstractions&quot;. Taking my cue from that, I think it would be fine to say, at the beginning of the second paragraph here, that &quot;The difference lies in that the first lambda uses syntax sugar for currying&quot;."}], "tags": [], "owner": {"reputation": 990, "user_id": 2936186, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EOPOx.jpg?s=128&g=1", "display_name": "H&#233;cate", "link": "https://stackoverflow.com/users/2936186/h%c3%a9cate"}, "is_accepted": false, "score": 3, "last_activity_date": 1479433119, "last_edit_date": 1479433119, "creation_date": 1479411050, "answer_id": 40663468, "question_id": 40663215, "link": "https://stackoverflow.com/questions/40663215/meaning-of-different-lambda-functions-and-characters/40663468#40663468", "title": "Meaning of different lambda functions and characters", "body": "<blockquote>\n  <p>First: What is the difference between these two lambdas (-> \\y and y)?</p>\n</blockquote>\n\n<p>There is no difference. Both produce the same output for the same input, and since they're pure functions, you can be sure that they produce no external effects that you wouldn't see.</p>\n\n<p>The difference lies in that the first lambda uses syntactic sugar for <a href=\"https://wiki.haskell.org/Currying\" rel=\"nofollow noreferrer\">currying</a>.\n<code>\\x y -&gt; x + y</code> is equal to <code>\\x -&gt; \\y -&gt; x + y</code>. Now, don't you think it looks a lot like type signatures, such as <code>foo :: Int -&gt; Int -&gt; Int</code> ? ;)\nIt means that the function <code>foo</code> takes 2 <code>Int</code> and produces an <code>Int</code>.</p>\n\n<p>Since I don't have a very precise answer for the 2nd\u2026</p>\n\n<blockquote>\n  <p>Third: What does the <code>\\_</code> exactly mean?</p>\n</blockquote>\n\n<p>It's a lambda function (<code>\\</code>) to which is associated the <code>_</code> variable. <code>_</code> is used as a placeholder to say \u201cI don't care about the content of this variable, I'm even going to give it a proper name\u201d.</p>\n"}, {"tags": [], "owner": {"reputation": 974, "user_id": 3829232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d2de116df80bc024b799e84dcdbc97?s=128&d=identicon&r=PG", "display_name": "soupi", "link": "https://stackoverflow.com/users/3829232/soupi"}, "is_accepted": false, "score": 3, "last_activity_date": 1479412654, "last_edit_date": 1479412654, "creation_date": 1479412149, "answer_id": 40663789, "question_id": 40663215, "link": "https://stackoverflow.com/questions/40663215/meaning-of-different-lambda-functions-and-characters/40663789#40663789", "title": "Meaning of different lambda functions and characters", "body": "<p>On your second question, <code>lambda3</code> is just a bad variable name. this is a list of functions of type <code>Num a =&gt; a -&gt; a</code>. You can verify that by typing the following in ghci:</p>\n\n<pre><code>:t [\\x -&gt; x+1, \\x -&gt; 2*x, \\x -&gt; x^2]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 10, "last_activity_date": 1479415552, "creation_date": 1479415552, "answer_id": 40664677, "question_id": 40663215, "link": "https://stackoverflow.com/questions/40663215/meaning-of-different-lambda-functions-and-characters/40664677#40664677", "title": "Meaning of different lambda functions and characters", "body": "<p><code>lambda2</code> is syntactic sugar for <code>lambda1</code>. All of these are equivalent:</p>\n\n<pre><code>f = \\x -&gt; \\y -&gt; x + y\nf = \\x y -&gt; x + y\nf x = \\y -&gt; x + y\nf x y = x + y\nf x y = (+) x y\nf x = (+) x\nf = (+)\n</code></pre>\n\n<p><code>lambda3</code> is a list of unary functions on numbers. Each function has the type <code>(Num a) =&gt; a -&gt; a</code>, so the list has type <code>(Num a) =&gt; [a -&gt; a]</code>. You could produce a list of values from this with <code>map</code> or a list comprehension:</p>\n\n<pre><code>fs = [\\x -&gt; x+1, \\x -&gt; 2*x, \\x -&gt; x^2]\n\nmap (\\f -&gt; f 3) fs\nmap ($ 3) fs\n[f 3 | f &lt;- fs]\n==\n[4, 6, 9]\n</code></pre>\n\n<p><code>lambda4</code> uses pattern-matching syntax. For example, if you have a data type:</p>\n\n<pre><code>data Foo = Foo Int String\n</code></pre>\n\n<p>Then you can write a lambda that pattern-matches on it:</p>\n\n<pre><code>f = \\ (Foo n s) -&gt; concat (replicate n s)\n\nf (Foo 3 \"bar\") == \"barbarbar\"\n</code></pre>\n\n<p>(But unlike <code>case</code>, there is no way to provide alternative patterns if <code>Foo</code> has multiple constructors.)</p>\n\n<p>The <code>_</code> pattern just says \u201caccept a value and ignore it\u201d, so <code>lambda4</code> is a function that accepts an argument, ignores it, and returns a pair (2-tuple) of unary functions, the first of type <code>(Num a) =&gt; a -&gt; a</code> and the second of type <code>() -&gt; Char</code>, so its type is <code>Num a =&gt; r -&gt; (a -&gt; a, () -&gt; Char)</code>.</p>\n\n<pre><code>lambda4 = \\_ -&gt; (\\x -&gt; x+1, \\() -&gt; 'a')\nlambda4 = \\ignored -&gt; (\\x -&gt; x+1, \\() -&gt; 'a')\n\n(inc, getA) = lambda4 ()\ninc 3 == 4\ngetA () == 'a'\n</code></pre>\n\n<p>Functions that ignore their arguments can be constructed with the <code>const</code> function, and operator sections (<code>(+ 1)</code>) are typically preferred over lambdas (<code>\\x -&gt; x + 1</code>), so you can also write the above as:</p>\n\n<pre><code>lambda4 = const ((+ 1), const 'a')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 0, "last_activity_date": 1479466179, "creation_date": 1479466179, "answer_id": 40675189, "question_id": 40663215, "link": "https://stackoverflow.com/questions/40663215/meaning-of-different-lambda-functions-and-characters/40675189#40675189", "title": "Meaning of different lambda functions and characters", "body": "<p>There is no <code>-&gt; y</code>. The correct way to read this is</p>\n\n<pre><code>(\\ x -&gt; (\\ y -&gt; (x + y)))\n</code></pre>\n\n<p>As it happens, Haskell has \"curried functions\", which means that</p>\n\n<pre><code>\\ x y -&gt; (x + y)\n</code></pre>\n\n<p>just happens to be equivalent to the above.</p>\n\n<hr>\n\n<p><code>lambda3</code> is a list which contains three elements. Each of those elements happens to be a function. Functions are data in Haskell; you can pass them as arguments, return them as results, stuff them into lists, etc.</p>\n\n<pre><code>lambda3 = [ (\\x -&gt; x+1) , (\\x -&gt; 2*x) , (\\x -&gt; x^2) ]\n</code></pre>\n\n<hr>\n\n<pre><code>lambda4 = \\_ -&gt; (\\x -&gt; x+1, \\() -&gt; 'a')\n</code></pre>\n\n<p>The \"<code>_</code>\" character basically means \"I don't care what this is; ignore it\". You can use it anywhere you can use a pattern. For example,</p>\n\n<pre><code>foobar x _ z = x + y\n</code></pre>\n\n<p>is a 3-argument function that completely ignores argument #2. Read about pattern matching and this should become clear. (I.e., it's not to do with lambdas, it's to do with patterns.)</p>\n"}], "owner": {"reputation": 77, "user_id": 5242371, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/06f3e3860a7e14dd00d82b3274f33ffe?s=128&d=identicon&r=PG&f=1", "display_name": "dasskorpion", "link": "https://stackoverflow.com/users/5242371/dasskorpion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 1, "answer_count": 4, "score": 2, "last_activity_date": 1479466179, "creation_date": 1479410137, "last_edit_date": 1479433108, "question_id": 40663215, "link": "https://stackoverflow.com/questions/40663215/meaning-of-different-lambda-functions-and-characters", "title": "Meaning of different lambda functions and characters", "body": "<p>At the moment I am learning Haskell, but I am struggling with the syntax of a few example. What do they exactly mean?</p>\n\n<p><strong>First</strong>: What is the difference between these two lambdas (<code>-&gt; \\y</code> and <code>y</code>)?</p>\n\n<pre><code>lambda1 = \\x -&gt; \\y -&gt; x + y\nlambda2 = \\x y -&gt; x + y\n</code></pre>\n\n<p><strong>Second</strong>: What does this mean? Is this a lambda that act as a \"pseudo\" list generator that generates a list with 3 elements. How can I create such a list?</p>\n\n<pre><code>lambda3 = [\\x -&gt; x+1, \\x -&gt; 2*x, \\x -&gt; x^2]\n</code></pre>\n\n<p><strong>Third</strong>: What does the <code>\\_</code> exactly mean?</p>\n\n<pre><code>lambda4 = \\_ -&gt; (\\x -&gt; x+1, \\() -&gt; 'a')\n</code></pre>\n"}, {"tags": ["haskell", "cabal", "haskell-stack", "gtk2hs"], "comments": [{"owner": {"reputation": 9139, "user_id": 773228, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/baaecdda322cf4462a0dd018d7959b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Wood", "link": "https://stackoverflow.com/users/773228/justin-wood"}, "edited": false, "score": 1, "creation_date": 1479409833, "post_id": 40659148, "comment_id": 68557274, "body": "I think this may be better as a bug report on either <a href=\"https://github.com/fpco/lts-haskell\" rel=\"nofollow noreferrer\">lts-haskell</a> or <a href=\"https://github.com/commercialhaskell/stack\" rel=\"nofollow noreferrer\">stack</a>."}, {"owner": {"reputation": 21, "user_id": 7173658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fad66d51779d1cfffad71e68991cadb?s=128&d=identicon&r=PG&f=1", "display_name": "fujiyan18", "link": "https://stackoverflow.com/users/7173658/fujiyan18"}, "reply_to_user": {"reputation": 9139, "user_id": 773228, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/baaecdda322cf4462a0dd018d7959b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Wood", "link": "https://stackoverflow.com/users/773228/justin-wood"}, "edited": false, "score": 0, "creation_date": 1479745754, "post_id": 40659148, "comment_id": 68676853, "body": "Thanks for the advice. I submitted <a href=\"https://github.com/commercialhaskell/stack/issues/2795\" rel=\"nofollow noreferrer\">a bug report</a>"}, {"owner": {"reputation": 9139, "user_id": 773228, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/baaecdda322cf4462a0dd018d7959b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Wood", "link": "https://stackoverflow.com/users/773228/justin-wood"}, "edited": false, "score": 0, "creation_date": 1479745884, "post_id": 40659148, "comment_id": 68676931, "body": "I&#39;m voting to close this question as off-topic because this is more of a bug report and should go on the projects official tracker."}, {"owner": {"reputation": 21, "user_id": 7173658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fad66d51779d1cfffad71e68991cadb?s=128&d=identicon&r=PG&f=1", "display_name": "fujiyan18", "link": "https://stackoverflow.com/users/7173658/fujiyan18"}, "reply_to_user": {"reputation": 9139, "user_id": 773228, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/baaecdda322cf4462a0dd018d7959b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Wood", "link": "https://stackoverflow.com/users/773228/justin-wood"}, "edited": false, "score": 0, "creation_date": 1482939594, "post_id": 40659148, "comment_id": 69931799, "body": "I confirmed that the problem will be solved by executing the following command.  <code>stack setup --upgrade-cabal</code>"}], "owner": {"reputation": 21, "user_id": 7173658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fad66d51779d1cfffad71e68991cadb?s=128&d=identicon&r=PG&f=1", "display_name": "fujiyan18", "link": "https://stackoverflow.com/users/7173658/fujiyan18"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 222, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1479397418, "creation_date": 1479397418, "question_id": 40659148, "link": "https://stackoverflow.com/questions/40659148/building-project-dependent-on-gtk2hs-fails-on-lts-7-8-and-later", "title": "Building project dependent on gtk2hs fails on lts-7.8 and later", "body": "<p>Building project dependent on glib fails on lts-7.8 and later after Cabal becomes 1.24.1.0.</p>\n\n<h3>Steps to reproduce</h3>\n\n<ol>\n<li><p>Add glib to a project's .cabal file</p>\n\n<pre><code>build-depends:       base\n                   , gtktest\n                   , glib\n</code></pre></li>\n<li><p>Run following commands</p>\n\n<pre><code>stack install gtk2hs-buildtools\nstack build\n</code></pre></li>\n</ol>\n\n<h3>Result</h3>\n\n<p>The following error occurred</p>\n\n<pre><code>...\n\n[debug] Ignoring package Cabal due to wanting version 1.24.1.0 instead of 1.24.0.0\n@(Stack\\Build\\Installed.hs:196:5)\n\n...\n\n--  While building package glib-0.13.4.1 using:\n  C:\\Users\\foo\\AppData\\Local\\Programs\\stack\\x86_64-windows\\ghc-8.0.1\\bin\\ghc.EXE --make -odir C:\\Users\\foo\\AppData\\Local\\Temp\\stack5512\\glib-0.13.4.1\\.stack-work\\dist\\b7fec021\\setup -hidir C:\\Users\\foo\\AppData\\Local\\Temp\\stack5512\\glib-0.13.4.1\\.stack-work\\dist\\b7fec021\\setup -i -i. -package=Cabal-1.24.0.0 -clear-package-db -global-package-db -package-db=C:\\sr\\snapshots\\a78c6a89\\pkgdb C:\\Users\\foo\\AppData\\Local\\Temp\\stack5512\\glib-0.13.4.1\\Setup.hs -o C:\\Users\\foo\\AppData\\Local\\Temp\\stack5512\\glib-0.13.4.1\\.stack-work\\dist\\b7fec021\\setup\\setup\nProcess exited with code: ExitFailure 1\nLogs have been written to: C:\\Users\\foo\\Documents\\Files\\Haskell\\gtktest\\.stack-work\\logs\\glib-0.13.4.1.log\n\n[1 of 1] Compiling Main             ( C:\\Users\\foo\\AppData\\Local\\Temp\\stack5512\\glib-0.13.4.1\\Setup.hs, C:\\Users\\foo\\AppData\\Local\\Temp\\stack5512\\glib-0.13.4.1\\.stack-work\\dist\\b7fec021\\setup\\Main.o )\n\nC:\\Users\\foo\\AppData\\Local\\Temp\\stack5512\\glib-0.13.4.1\\Setup.hs:8:29: error:\n     Couldn't match expected type \u2018Distribution.Simple.UserHooks.UserHooks\u2019\n                  with actual type \u2018Cabal-1.24.1.0:Distribution.Simple.UserHooks.UserHooks\u2019\n      NB: Cabal-1.24.1.0:Distribution.Simple.UserHooks.UserHooks\u2019\n            is defined in \u2018Distribution.Simple.UserHooks\u2019\n                in package \u2018Cabal-1.24.1.0\u2019\n          \u2018Distribution.Simple.UserHooks.UserHooks\u2019\n            is defined in \u2018Distribution.Simple.UserHooks\u2019\n                in package \u2018Cabal-1.24.0.0\u2019\n     In the first argument of \u2018defaultMainWithHooks\u2019, namely\n        gtk2hsUserHooks\u2019\n      In the expression: defaultMainWithHooks gtk2hsUserHooks\n      In an equation for \u2018main\u2019:\n          main = defaultMainWithHooks gtk2hsUserHooks\n</code></pre>\n\n<p>I thought that Cabal-1.24.0.0 in the ghc-8.0.1 global package was causing problems, and succeeded building it after installing Cabal-1.24.1.0 in ghc 's global package.</p>\n\n<p>However, this method is difficult for beginners and I do not think the right solution. How is the correct way to solve it?</p>\n\n<h3>Stack version</h3>\n\n<pre><code>Version 1.2.0, Git revision 123819b7d65df2ad7fe63fb5eb39a98536acb5f3 (4055 commits) x86_64 hpack-0.14.0\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1479391664, "post_id": 40656814, "comment_id": 68545098, "body": "<a href=\"http://stackoverflow.com/questions/40592338/how-to-read-the-following-haskell-definition-num-a-b-a-b\" title=\"how to read the following haskell definition num a b a b\">stackoverflow.com/questions/40592338/&hellip;</a>"}, {"owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "edited": false, "score": 0, "creation_date": 1484218387, "post_id": 40656814, "comment_id": 70423888, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/40592338/how-to-read-the-following-haskell-definition-num-a-b-a-b\">How to read the following haskell definition &quot; Num (a -&gt; b) =&gt; &#91;a&#93; -&gt; &#91;b&#93; &quot;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 0, "creation_date": 1479392513, "post_id": 40656985, "comment_id": 68545728, "body": "So I ran into this because the numeric literals are still &quot;flexible&quot; and could be interpreted as different instances of <code>Num</code>, and as far as the type-checker is concerned <code>1</code> could end up not just as an <code>Int</code> or <code>Fractional</code>, but also as an <code>a -&gt; t</code> ?"}, {"owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 0, "creation_date": 1479392668, "post_id": 40656985, "comment_id": 68545855, "body": "I tried to force the arguments to be <code>Int</code> rather than <code>Num a</code>, and then it did immediately produce an error: <code>let one = 1 :: Int :t (+) one one one   --&gt; type error</code>"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 5, "last_activity_date": 1479391573, "creation_date": 1479391573, "answer_id": 40656985, "question_id": 40656814, "link": "https://stackoverflow.com/questions/40656814/giving-too-many-arguments-to-a-function-in-haskell/40656985#40656985", "title": "Giving too many arguments to a function in Haskell", "body": "<p>In general, you just get an error, because the result of applying a function to \"enough\" arguments does not produce a value that can be applied to another value as a function.</p>\n\n<pre><code>&gt; (++) [1] [2] [3]\n\n&lt;interactive&gt;:1:1: error:\n    \u2022 Couldn't match expected type \u2018[Integer] -&gt; t\u2019\n                  with actual type \u2018[Integer]\u2019\n    \u2022 The function \u2018(++)\u2019 is applied to three arguments,\n      but its type \u2018[Integer] -&gt; [Integer] -&gt; [Integer]\u2019 has only two\n      In the expression: (++) [1] [2] [3]\n      In an equation for \u2018it\u2019: it = (++) [1] [2] [3]\n    \u2022 Relevant bindings include it :: t (bound at &lt;interactive&gt;:1:1)\n</code></pre>\n\n<p>In the case of <code>(+)</code>, though, the return value can be of <em>any</em> type that has an instance of <code>Num</code>. Since <code>(+) 1 2</code> has type <code>Num a =&gt; a</code>, then if <code>a -&gt; t</code> also had an instance of <code>Num</code>, it would be fine to assume that <code>(+) 1 2</code> could be applied again to a third value. This is a demonstration that type classes are <em>open</em>.</p>\n"}, {"comments": [{"owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 0, "creation_date": 1479393037, "post_id": 40657379, "comment_id": 68546124, "body": "I see. So someone could  theoretically make an instance of <code>Num (a -&gt; t)</code> for <code>Num a</code>, and then you&#39;d want <code>(+) x y z</code> to check out for values of this type."}, {"owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 0, "creation_date": 1479393110, "post_id": 40657379, "comment_id": 68546183, "body": "Could that theoretically be made to work even for literals? Is there a way to augment the interpretation of numeric literals in such a way that <code>1</code> can become  a function value (or anything else other than the conversions your compiler has built-in)?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 2, "creation_date": 1479395167, "post_id": 40657379, "comment_id": 68547733, "body": "Yes, having an instance of Num implies that you can use integer literals for your type. This is handled by <code>fromInteger</code> method. So <code>3</code> is really a <code>fromInteger (3::Integer)</code>. You get to write <code>fromInteger</code> for your instance so you can have 3 mean whatever (for examlple <code>const 3</code>)."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 9, "last_activity_date": 1479392636, "creation_date": 1479392636, "answer_id": 40657379, "question_id": 40656814, "link": "https://stackoverflow.com/questions/40656814/giving-too-many-arguments-to-a-function-in-haskell/40657379#40657379", "title": "Giving too many arguments to a function in Haskell", "body": "<p>It's useful to think about it this way. You <em>always</em> give exactly one argument to a function. <code>f a b</code> is exactly equivalent to <code>(f a) b</code>.</p>\n\n<p>So <code>(+) 1 2 3</code> is the same as</p>\n\n<pre><code> (((+) 1) 2) 3\n</code></pre>\n\n<p>Now we know what <code>((+) 1) 2</code> is, it's the same as <code>(+) 1 2</code> or <code>1 + 2</code> which is just 3. So the expression boils down to <code>3 3</code>.</p>\n\n<p>How come it's not an error? </p>\n\n<p>Integer literals in Haskell are overloaded. <code>3</code> could be of <em>any</em> type, provided this type has a <code>Num</code> instance. There is nothing illegal to give a <code>Num</code> instance to a function type either. The type inferencer tells you just that:</p>\n\n<pre><code>(Num a, Num (a -&gt; t)) =&gt; t\n</code></pre>\n\n<p>This can be read as</p>\n\n<blockquote>\n  <p>For any type <code>a</code> which has a <code>Num</code> instance, and any type <code>a-&gt;t</code> which also has a <code>Num</code> instance, the expression in question has type <code>t</code>. </p>\n</blockquote>\n\n<p>Of course in practice such instances are unlikely, but one <em>can</em> in principle define them, and make the expression <code>(+) 1 2 3</code> evaluate to a well-defined value.</p>\n"}], "owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "accepted_answer_id": 40657379, "answer_count": 2, "score": 0, "last_activity_date": 1479392636, "creation_date": 1479391078, "question_id": 40656814, "link": "https://stackoverflow.com/questions/40656814/giving-too-many-arguments-to-a-function-in-haskell", "title": "Giving too many arguments to a function in Haskell", "body": "<p>In Haskell, I can give too few arguments to a function to get back a curried function:</p>\n\n<pre><code>-- the addition function\nPrelude&gt; :t (+) \n(+) :: Num a =&gt; a -&gt; a -&gt; a\n\n-- curried with its first argument =&gt; the increment function\nPrelude&gt; :t (+) 1\n(+) 1 :: Num a =&gt; a -&gt; a\n\n-- supplied with both arguments =&gt; the result\nPrelude&gt; :t (+) 1 2\n(+) 1 2 :: Num a =&gt; a\n</code></pre>\n\n<p>But what do I get when I supply too many arguments?</p>\n\n<pre><code>Prelude&gt; :t (+) 1 2 3\n(+) 1 2 3 :: (Num a, Num (a -&gt; t)) =&gt; t\n</code></pre>\n\n<p>What is this, does it have a name, and is it useful for anything?</p>\n"}, {"tags": ["windows", "haskell", "readline"], "comments": [{"owner": {"reputation": 1469, "user_id": 2934534, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-eF8AiD0GO8s/AAAAAAAAAAI/AAAAAAAAABQ/WZobF6ZbPIg/photo.jpg?sz=128", "display_name": "Michael", "link": "https://stackoverflow.com/users/2934534/michael"}, "edited": false, "score": 1, "creation_date": 1515365535, "post_id": 40654429, "comment_id": 83262624, "body": "Did you end up finding a fix for this? I&#39;m having the exact same issue."}], "owner": {"reputation": 553, "user_id": 5455661, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ae2b0f296e84a77140e79ce57ed6e3b4?s=128&d=identicon&r=PG&f=1", "display_name": "toastedDeli", "link": "https://stackoverflow.com/users/5455661/toasteddeli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1588864573, "creation_date": 1479384299, "last_edit_date": 1515366664, "question_id": 40654429, "link": "https://stackoverflow.com/questions/40654429/how-can-i-install-system-console-readline-for-haskell-ghci-on-windows", "title": "How can I install System.Console.Readline for Haskell GHCi on Windows?", "body": "<p>I am trying to run a haskell file from command prompt. I get the following error :</p>\n\n<pre><code>Failed to load interface for `System.Console.Readline'\nPerhaps you meant System.Console.Haskeline (from haskeline-0.7.2.3)\nLocations searched:\n\nSystem\\Console\\Readline.hs\nSystem\\Console\\Readline.lhs\nSystem\\Console\\Readline.hsig\nSystem\\Console\\Readline.lhsig\n</code></pre>\n\n<p>I thought readline came as part of cabal when you installed the full version of haskell? (which I have done) Does anyone have any idea how I can fix this?</p>\n\n<p>EDIT: I tried >cabal update, followed by >cabal install readline, and I now get this:</p>\n\n<pre><code>Resolving dependencies...\nConfiguring readline-1.0.3.0...\nFailed to install readline-1.0.3.0\nBuild log ( C:\\Users\\Dan\\AppData\\Roaming\\cabal\\logs\\readline-1.0.3.0.log ):\nConfiguring readline-1.0.3.0...\nbash.exe: warning: could not find /tmp, please create!\nchecking for gcc... C:\\PROGRA~1\\HASKEL~1\\802E01~1.1\\mingw\\bin\\gcc.exe\nchecking for C compiler default output file name... a.exe\nchecking whether the C compiler works... yes\nchecking whether we are cross compiling... no\nchecking for suffix of executables... .exe\nchecking for suffix of object files... o\nchecking whether we are using the GNU C compiler... yes\nchecking whether C:\\PROGRA~1\\HASKEL~1\\802E01~1.1\\mingw\\bin\\gcc.exe accepts -g... yes\nchecking for C:\\PROGRA~1\\HASKEL~1\\802E01~1.1\\mingw\\bin\\gcc.exe option to accept ISO C89... none needed\nchecking for GNUreadline.framework... checking for readline... no\nchecking for tputs in -lncurses... no\nchecking for tputs in -ltermcap... no\nchecking for tputs in -lcurses... no\nchecking for rl_readline_version... no\nconfigure: error: readline not found, so this package cannot be built\nSee `config.log' for more details.\ncabal: Leaving directory 'C:\\Users\\Dan\\AppData\\Local\\Temp\\cabal-tmp-884\\readline-1.0.3.0'\ncabal: Error: some packages failed to install:\nreadline-1.0.3.0 failed during the configure step. The exception was:\nExitFailure 1\n</code></pre>\n"}, {"tags": ["haskell", "servant"], "answers": [{"comments": [{"owner": {"reputation": 5991, "user_id": 122643, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/9b8d53dbc30a2db40a85586731e8c5bf?s=128&d=identicon&r=PG", "display_name": "Rich Churcher", "link": "https://stackoverflow.com/users/122643/rich-churcher"}, "edited": false, "score": 0, "creation_date": 1479422290, "post_id": 40662911, "comment_id": 68563856, "body": "Thanks so much, that&#39;s really helpful!"}], "tags": [], "owner": {"reputation": 6364, "user_id": 288913, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/902e8cc4ad1dab7e25d3a2dc1eac732f?s=128&d=identicon&r=PG", "display_name": "Sarah", "link": "https://stackoverflow.com/users/288913/sarah"}, "is_accepted": true, "score": 3, "last_activity_date": 1479409762, "last_edit_date": 1479409762, "creation_date": 1479409023, "answer_id": 40662911, "question_id": 40651661, "link": "https://stackoverflow.com/questions/40651661/catch-all-or-default-routing/40662911#40662911", "title": "Catch-all or default routing", "body": "<p>You got it, basically. <code>serveDirectory \"static\"</code> can be replaced by any wai <code>Application</code>, so for instance, we could have:</p>\n\n<pre><code>...\n{-# LANGUAGE OverloadedStrings #-}\n...\nimport Network.Wai        (responseLBS)\nimport Network.HTTP.Types (status200)\n...\nserver :: Server API \nserver = wombats\n    :&lt;|&gt; wombat\n    :&lt;|&gt; hello\n\nhello :: Application\nhello req respond = respond $ \n  responseLBS \n  status200                        -- \n  [(\"Content-Type\", \"text/plain\")] -- headers\n  \"Hello, World!\"                  -- content\n...\n</code></pre>\n\n<p>To a first approximation, wai applications are simply <code>Request -&gt; Response</code>, but <a href=\"https://hackage.haskell.org/package/wai-3.2.1.1/docs/Network-Wai.html#t:Application\" rel=\"nofollow noreferrer\">the docs</a> tell a fuller story:</p>\n\n<pre><code>Request -&gt; (Response -&gt; IO ResponseReceived) -&gt; IO ResponseReceived\n</code></pre>\n\n<p>So since you've got access to IO, you can check if the file exists and if so serve it, otherwise do whatever you like. In fact, wai defines <code>type Middleware = Application -&gt; Application</code>, so you might think up a handy Middleware that wraps up <code>hello</code> (or any other Application!) in a file existence-checker-and-server.</p>\n"}, {"tags": [], "owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "is_accepted": false, "score": 2, "last_activity_date": 1479475557, "creation_date": 1479475557, "answer_id": 40678288, "question_id": 40651661, "link": "https://stackoverflow.com/questions/40651661/catch-all-or-default-routing/40678288#40678288", "title": "Catch-all or default routing", "body": "<p>Here is another route:</p>\n\n<p><code>serveDirectory</code> is defined as</p>\n\n<pre><code>serveDirectory = staticApp . defaultFileServerSettings . addTrailingPathSeparator\n</code></pre>\n\n<p><a href=\"https://www.stackage.org/haddock/lts-7.9/wai-app-static-3.1.6.1/src/WaiAppStatic.Storage.Filesystem.html#defaultFileServerSettings\" rel=\"nofollow noreferrer\"><code>defaultFileServerSettings</code></a> contains a field <code>ssLookupFile</code> which you can change to serve what you want if the file was not found. Perhaps:</p>\n\n<pre><code>import WaiAppStatic.Types\nimport WaiAppStatic.Storage.Filesystem\nimport Network.Wai.Application.Static\nimport System.FilePath\n\nfileOrIndex root pieces = do\n  res &lt;- ssLookupFile (defaultFileServerSettings root) pieces\n  case res of\n    LRNotFound -&gt; undefined -- index.html here\n    _ -&gt; return res\n\nserveStatic root =\n  let root' = addTrailingPathSeparator root in\n  staticApp $ (defaultFileServerSettings root') {ssLookupFile = fileOrIndex root'}\n</code></pre>\n"}], "owner": {"reputation": 5991, "user_id": 122643, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/9b8d53dbc30a2db40a85586731e8c5bf?s=128&d=identicon&r=PG", "display_name": "Rich Churcher", "link": "https://stackoverflow.com/users/122643/rich-churcher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 1, "accepted_answer_id": 40662911, "answer_count": 2, "score": 2, "last_activity_date": 1479475557, "creation_date": 1479376443, "question_id": 40651661, "link": "https://stackoverflow.com/questions/40651661/catch-all-or-default-routing", "title": "Catch-all or default routing", "body": "<p>These days it's not uncommon to need to return a file (say, <code>index.html</code>) from the backend if the requested route doesn't match an existing API endpoint or another static asset. This is especially handy when using <a href=\"https://github.com/ReactTraining/react-router\" rel=\"nofollow noreferrer\"><code>react-router</code></a> and <a href=\"https://github.com/ReactTraining/react-router/blob/master/docs/guides/Histories.md#browserhistory\" rel=\"nofollow noreferrer\"><code>browserHistory</code></a>.</p>\n\n<p>I'm a bit stumped as to how I might approach this with Servant. I did wonder if intercepting 404's might be the way to go, but then of course sometimes the API will need to legitimately issue 404. Here's the kind of thing I've been using to experiment:</p>\n\n<pre><code>data Wombat = Wombat\n  { id :: Int\n  , name :: String\n  } deriving (Eq, Show, Generic)\ninstance ToJSON Wombat\n\nwombatStore :: [Wombat]\nwombatStore = \n  [ Wombat 0 \"Gertrude\"\n  , Wombat 1 \"Horace\"\n  , Wombat 2 \"Maisie\"\n  , Wombat 3 \"Julius\"\n  ]\n\nwombats :: Handler [Wombat]\nwombats = return wombatStore\n\nwombat :: Int -&gt; Handler Wombat\nwombat wid = do\n  case find (\\w -&gt; Main.id w == wid) wombatStore of\n    Just x -&gt; return x\n    Nothing -&gt; throwE err404\n\ntype API = \n    \"api\" :&gt; \"wombats\" :&gt; Get '[JSON] [Wombat] :&lt;|&gt;\n    \"api\" :&gt; \"wombats\" :&gt; Capture \"id\" Int :&gt; Get '[JSON] Wombat :&lt;|&gt;\n    Raw\n\napi :: Proxy API\napi = Proxy\n\nserver :: Server API \nserver = wombats\n  :&lt;|&gt; wombat\n  :&lt;|&gt; serveDirectory \"static\"\n\napp :: Application\napp = serve api server\n\nmain :: IO ()\nmain = run 3000 app\n</code></pre>\n\n<p>I'd love to see an example of how I could go about adding a 'default route' that sends an HTML response if the request doesn't match an API endpoint or anything in the static directory. Toy repo <a href=\"https://github.com/richchurcher/servant-routes\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": ["parsing", "haskell"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1479405037, "post_id": 40648175, "comment_id": 68554548, "body": "Have a look at <a href=\"https://hackage.haskell.org/package/parsec-3.1.11/docs/Text-Parsec-Expr.html\" rel=\"nofollow noreferrer\"><code>Text.Parsec.Expr</code></a>"}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1479431589, "post_id": 40665685, "comment_id": 68566567, "body": "You can also use <code>(+) &lt;$ symbol &quot;+&quot;</code> instead of <code>symbol &quot;+&quot; *&gt; pure (+)</code>."}], "tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": false, "score": 7, "last_activity_date": 1479450002, "last_edit_date": 1479450002, "creation_date": 1479419442, "answer_id": 40665685, "question_id": 40648175, "link": "https://stackoverflow.com/questions/40648175/parse-expression-right-to-left/40665685#40665685", "title": "Parse expression right-to-left", "body": "<p>You can implement parser combinators like these:</p>\n\n<pre><code>chainl1 :: Parser a -&gt; Parser (a -&gt; a -&gt; a) -&gt; Parser a\nchainl1 p op = p &gt;&gt;= rest\n  where\n    rest x = do{ f &lt;- op\n               ; y &lt;- p\n               ; rest (f x y)\n               }\n         &lt;|&gt; pure x\n\nchainr1 :: Parsec a -&gt; Parsec (a -&gt; a -&gt; a) -&gt; Parsec a\nchainr1 p op = scan\n  where\n    scan = p &gt;&gt;= rest\n    rest x = (\\f y -&gt; f x y) &lt;$&gt; op &lt;*&gt; scan &lt;|&gt; pure x\n</code></pre>\n\n<p>Then you can implement your grammar rules like these:</p>\n\n<pre><code>expr   = term `chainl1` addop\nterm   = expo `chainl1` mulop\nexpo   = factor `chainr1` expop\nfactor = parens expr &lt;|&gt; integer\n\naddop = (+) &lt;$ symbol \"+\" &lt;|&gt; (-) &lt;$ symbol \"-\"\nmulop = (*) &lt;$ symbol \"*\" &lt;|&gt; (div) &lt;$ symbol \"/\"\nexpop = (^) &lt;$ symbol \"^\"\n\nparens p = symbol \"(\" *&gt; p &lt;* symbol \")\"\n</code></pre>\n\n<p>But I recommend you to use parser library like package parsec.</p>\n"}], "owner": {"reputation": 3967, "user_id": 3853711, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/SwXly.png?s=128&g=1", "display_name": "Rahn", "link": "https://stackoverflow.com/users/3853711/rahn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1012, "favorite_count": 2, "answer_count": 1, "score": 7, "last_activity_date": 1479543063, "creation_date": 1479364487, "last_edit_date": 1479543063, "question_id": 40648175, "link": "https://stackoverflow.com/questions/40648175/parse-expression-right-to-left", "title": "Parse expression right-to-left", "body": "<p>I'm building a parser for expression.</p>\n\n<p>Here's my grammar rule:</p>\n\n<pre><code>expr   ::= term   (+ expr | - expr | null)\nterm   ::= expo   (* term | / term | null)\nexpo   ::= factor (^ expo | null)\nfactor ::= (expr) | int\n</code></pre>\n\n<p>and corresponding code:</p>\n\n<pre><code>expr :: Parser Int\nexpr = do t &lt;- term\n          do _ &lt;- symbol \"+\"\n             e &lt;- expr\n             return (t + e)\n             &lt;|&gt; do _ &lt;- symbol \"-\"\n                    e &lt;- expr\n                    return (t - e)\n                    &lt;|&gt; return t\n\nterm :: Parser Int\nterm = do ep &lt;- expo\n          do _ &lt;- symbol \"*\"\n             t &lt;- term\n             return (ep * t)\n             &lt;|&gt; do _ &lt;- symbol \"/\"\n                    t &lt;- term\n                    return (ep `div` t)\n                    &lt;|&gt; return ep\n\nexpo :: Parser Int\nexpo = do f &lt;- factor\n          do _ &lt;- symbol \"^\"\n             e &lt;- expo\n             return (f ^ e)\n             &lt;|&gt; return f\n\nfactor :: Parser Int\nfactor = do _ &lt;- symbol \"(\"\n            e &lt;- expr\n            _ &lt;- symbol \")\"\n            return e\n            &lt;|&gt; integer\n</code></pre>\n\n<p>It works well for most case but fail for certain:</p>\n\n<pre><code>$ eval \"3*1/3\"\n</code></pre>\n\n<blockquote>\n  <p>0</p>\n</blockquote>\n\n<p>since <code>3 * 1 / 3</code> is parsed to <code>3 * (1 / 3)</code> </p>\n\n<pre><code> (*)\n / \\\n3  (/)\n   / \\\n  1   3\n</code></pre>\n\n<p>and</p>\n\n<pre><code>$ eval \"4-3-2\"\n</code></pre>\n\n<blockquote>\n  <p>3</p>\n</blockquote>\n\n<p>since <code>4 - 3 - 2</code> is parsed to <code>4 - (3 - 2)</code></p>\n\n<pre><code> (-)\n / \\\n4  (-)\n   / \\\n  3   2\n</code></pre>\n\n<p>I realize it's all about parsing direction (right associativity).</p>\n\n<p>What I expect is <code>(4 - 3) - 2</code></p>\n\n<pre><code>   (-)\n   / \\\n (-)  2\n / \\\n4   3\n</code></pre>\n\n<p>which means I would parse <code>right-left</code> and interpret it <code>left-right</code> (or parse it recursively).</p>\n\n<p>I have no idea how to achieve so. Nothing but <code>foldl</code> comes to my mind so far.</p>\n\n<p>Could someone suggest what should I do to fix it?</p>\n\n<p>total program:</p>\n\n<pre><code>{-# OPTIONS_GHC -Wall #-}\n\nimport Control.Applicative\nimport Data.Char\n\nnewtype Parser a = P (String -&gt; [(a, String)])\n\nparse :: Parser a -&gt; String -&gt; [(a, String)]\nparse (P p) inp = p inp\n\ninstance Functor Parser where\n    fmap g p = P (\\inp -&gt; case parse p inp of\n                               []         -&gt; []\n                               [(v, out)] -&gt; [(g v, out)]\n                               _          -&gt; undefined)\n\ninstance Applicative Parser where\n    pure v = P (\\inp -&gt; [(v, inp)])\n    pg &lt;*&gt; px = P (\\inp -&gt; case parse pg inp of\n                                []         -&gt; []\n                                [(g, out)] -&gt; parse (fmap g px) out\n                                _          -&gt; undefined)\n\ninstance Monad Parser where\n    p &gt;&gt;= f = P (\\inp -&gt; case parse p inp of\n                              []         -&gt; []\n                              [(v, out)] -&gt; parse (f v) out\n                              _          -&gt; undefined)\n\ninstance Alternative Parser where\n    empty   = P (\\_ -&gt; [])\n    p &lt;|&gt; q = P (\\inp -&gt; case parse p inp of\n                              []         -&gt; parse q inp\n                              [(v, out)] -&gt; [(v, out)]\n                              _          -&gt; undefined)\n    many x = some x &lt;|&gt; pure []\n    some x = pure (:) &lt;*&gt; x &lt;*&gt; many x\n\nitem :: Parser Char\nitem = P (\\inp -&gt; case inp of\n                       []        -&gt; []\n                       (x : xs)  -&gt; [(x, xs)])\n\nsat :: (Char -&gt; Bool) -&gt; Parser Char\nsat p = do x &lt;- item\n           if p x\n               then return x\n               else empty\n\ndigit :: Parser Char\ndigit = sat isDigit\n\nchar :: Char -&gt; Parser Char\nchar x = sat (== x)\n\nstring :: String -&gt; Parser String\nstring []       = return []\nstring (x : xs) = do _ &lt;- char x\n                     _ &lt;- string xs\n                     return (x : xs)\n\nspace :: Parser ()\nspace = do _ &lt;- many (sat isSpace)\n           return ()\n\nnat :: Parser Int\nnat = do xs &lt;- some digit\n         return (read xs)\n\nint :: Parser Int\nint = do _ &lt;- char '-'\n         n &lt;- nat\n         return (-n)\n         &lt;|&gt; nat\n\ntoken :: Parser a -&gt; Parser a\ntoken p = do _ &lt;- space\n             v &lt;- p\n             _ &lt;- space\n             return v\n\ninteger :: Parser Int\ninteger = token int\n\nsymbol :: String -&gt; Parser String\nsymbol = token . string\n\nexpr :: Parser Int\nexpr = do t &lt;- term\n          do _ &lt;- symbol \"+\"\n             e &lt;- expr\n             return (t + e)\n             &lt;|&gt; do _ &lt;- symbol \"-\"\n                    e &lt;- expr\n                    return (t - e)\n                    &lt;|&gt; return t\n\nterm :: Parser Int\nterm = do ep &lt;- expo\n          do _ &lt;- symbol \"*\"\n             t &lt;- term\n             return (ep * t)\n             &lt;|&gt; do _ &lt;- symbol \"/\"\n                    t &lt;- term\n                    return (ep `div` t)\n                    &lt;|&gt; return ep\n\nexpo :: Parser Int\nexpo = do f &lt;- factor\n          do _ &lt;- symbol \"^\"\n             e &lt;- expo\n             return (f ^ e)\n             &lt;|&gt; return f\n\nfactor :: Parser Int\nfactor = do _ &lt;- symbol \"(\"\n            e &lt;- expr\n            _ &lt;- symbol \")\"\n            return e\n            &lt;|&gt; integer\n\neval :: String -&gt; Int\neval xs = case (parse expr xs) of\n               [(n, [])]  -&gt; n\n               [(_, out)] -&gt; error (\"Unused input \" ++ out)\n               []         -&gt; error \"Invalid input\"\n               _          -&gt; undefined\n</code></pre>\n"}, {"tags": ["haskell", "let"], "answers": [{"comments": [{"owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 0, "creation_date": 1479364157, "post_id": 40647788, "comment_id": 68527544, "body": "Can you override operator <code>(=)</code> ? If no, you would know that <code>delta&#39;</code> is a <code>let</code> binding (less distinguishable , but still can).  If yes, you just answer my question."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 0, "creation_date": 1479371574, "post_id": 40647788, "comment_id": 68531409, "body": "@wizzup, no, you cannot override <code>=</code>. It&#39;s not an operator at all, but rather primitive syntax. I think the point is that there are operators that look similar enough to confuse."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 5, "last_activity_date": 1479362893, "creation_date": 1479362893, "answer_id": 40647788, "question_id": 40647332, "link": "https://stackoverflow.com/questions/40647332/why-do-you-need-let-keyword-in-do-block/40647788#40647788", "title": "Why do you need let keyword in do block?", "body": "<p>One argument in favor of the <code>let</code> is that it stands out more in <code>do</code> blocks that may otherwise be filled with a variety of monadic assignment-like operators (think something filled with the <a href=\"https://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-Operators.html\" rel=\"noreferrer\">operators defined in <code>lens</code></a>).</p>\n\n<pre><code>do\n  p1.x += delta             -- (+=) is a custom operator\n  p2.y -= delta             -- (-=) is a custom operator\n  let delta' = delta*delta\n  p3 .= Point delta' delta' -- (.=) is a custom operator\n</code></pre>\n\n<p>Here I can easily distinguish the syntactic sugar for abstracting <code>delta'</code> from actual monadic code because of the <code>let</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1479375487, "post_id": 40648442, "comment_id": 68533896, "body": "I want to add that it is not only about shadowing. Using <code>let</code> you can define local functions in <code>do</code>-block. While w/o <code>let</code> syntax for local functions may become ugly."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1479379586, "post_id": 40648442, "comment_id": 68536873, "body": "Related: a function definition may span over multiple equations. Compare: <code>do ... ; let { f (K1 x) = ... ; f (K2 x) = ... } ; ...</code> vs <code>do ... ; let f (K1 x) = ... ; let f (K2 x) = ... ; ...</code> (shadowing)"}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 16, "last_activity_date": 1479403069, "last_edit_date": 1495541624, "creation_date": 1479365561, "answer_id": 40648442, "question_id": 40647332, "link": "https://stackoverflow.com/questions/40647332/why-do-you-need-let-keyword-in-do-block/40648442#40648442", "title": "Why do you need let keyword in do block?", "body": "<p>I don't know why it was done, but here is one reason I can imagine: it allows you to specify which bindings should be established sequentially, and which simultaneously, which can matter in the case of shadowing.</p>\n\n<p>For example, imagine that your suggestion is implemented, and then consider:</p>\n\n<pre><code>foo :: [Int]\nfoo = do\n  x &lt;- return [1]\n  y = 0:x\n  x = [1..5]\n  y\n</code></pre>\n\n<p>There are two reasonable ways to desugar this:</p>\n\n<pre><code>foo1 :: [Int]\nfoo1 = do\n  x &lt;- return [1]\n  let y = 0:x\n  let x = [1..5]\n  y\n\nfoo2 :: [Int]\nfoo2 = do\n  x &lt;- return [1]\n  let y = 0:x\n      x = [1..5]\n  y\n</code></pre>\n\n<p><code>foo1</code> evaluates to <code>[0,1]</code>, and <code>foo2</code> to <code>[0,1,2,3,4,5]</code>. This is a strange way to write your code, surely, but the fact that the <code>let</code> is required to be explicit means there is no ambiguity as to what you intend.</p>\n\n<p>As noted in the comments by <a href=\"https://stackoverflow.com/questions/40647332/why-do-you-need-let-keyword-in-do-block/40648442#comment68536873_40648442\">chi</a>, shadowing is not the only reason you might need to be explicit about how your <code>let</code> bindings are grouped: a function definition might require multiple equations, to match multiple parameter patterns.</p>\n"}], "owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 0, "accepted_answer_id": 40648442, "answer_count": 2, "score": 5, "last_activity_date": 1479403069, "creation_date": 1479360531, "last_edit_date": 1479361705, "question_id": 40647332, "link": "https://stackoverflow.com/questions/40647332/why-do-you-need-let-keyword-in-do-block", "title": "Why do you need let keyword in do block?", "body": "<p>What is the reason for having <code>let</code> in <code>do</code> block. </p>\n\n<pre><code>-- codeblock A\nmain = do\n  let a = 0\n  let f a = a + 1\n  let b = f 0\n  print (a,b)\n\n-- codeblock B\nmain = do\n  a = 0\n  f a = a + 1\n  b = f 0\n  print (a,b)\n</code></pre>\n\n<p>Assume all <code>let</code> without <code>in</code> must followed by <code>=</code> (Is this true?)</p>\n\n<p>Compiler should be able to imply <code>let</code> from <code>=</code> and preprocess/de-sugar <code>codeblock B</code> to <code>codeblock A</code></p>\n\n<p>using <code>let</code> in this case seem to be unnecessary, like you could write <code>codeblock C</code> but choose to write <code>codeblock D</code></p>\n\n<pre><code>-- codeblock C\nmain = do\n  print (a,b)\n\na = 0\nf a = a + 1\nb = f 0\n\n-- codeblock D\nmain = do\n  print (a,b)\n\nfunction  a = 0\nfunction  f a = a + 1\nfunction  b = f 0\n</code></pre>\n\n<p>To clarify the my assumption doesn't not include <code>let</code> that followed by <code>in</code> which should leave untouched.</p>\n\n<pre><code>-- codeblock E\nmain = do\n  a = 0\n  f a = a + 1\n  b = f 0\n  c = let d = 1 \n          e = 1\n      in d + e\n  print (a,b,c)\n</code></pre>\n"}, {"tags": ["haskell", "graph", "tree"], "comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1479375796, "post_id": 40647260, "comment_id": 68534133, "body": "Can you elaborate on <i>longest path graph</i>? Do you mean <i>2 vertices that have longest distance among all vertex pairs</i>?"}, {"owner": {"reputation": 367, "user_id": 1218601, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/d773283aacac768ba226e418b86265eb?s=128&d=identicon&r=PG", "display_name": "Callum Booth", "link": "https://stackoverflow.com/users/1218601/callum-booth"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1479392248, "post_id": 40647260, "comment_id": 68545540, "body": "@Shersh Sort of; starting from the root, I need the vertex that has the longest distance from the root, and the route of nodes needed to get to it."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479392538, "post_id": 40647260, "comment_id": 68545750, "body": "&quot;and I&#39;m sorry I can&#39;t pretty print this, <code>showForest</code> only prints Strings apparently&quot; -- If you mean <a href=\"https://hackage.haskell.org/package/containers-0.5.8.1/docs/Data-Tree.html#v:drawForest\" rel=\"nofollow noreferrer\"><code>drawForest</code></a>, you can use <code>drawForest . fmap (fmap show)</code>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1479422065, "post_id": 40647260, "comment_id": 68563761, "body": "&quot;but they only work for Trees, not Forests, and I&#39;m unsure if it&#39;s even possible to convert between the two.&quot; -- A <a href=\"https://hackage.haskell.org/package/containers-0.5.8.1/docs/Data-Tree.html#t:Forest\" rel=\"nofollow noreferrer\"><code>Forest</code></a> is just a list of <code>Tree</code>s, so if you have a function that works with <code>Tree</code>s you can, at a minimum, simply <code>fmap</code> it over the <code>Forest</code>."}], "answers": [{"comments": [{"owner": {"reputation": 367, "user_id": 1218601, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/d773283aacac768ba226e418b86265eb?s=128&d=identicon&r=PG", "display_name": "Callum Booth", "link": "https://stackoverflow.com/users/1218601/callum-booth"}, "edited": false, "score": 0, "creation_date": 1479436029, "post_id": 40661524, "comment_id": 68567654, "body": "Thanks for this! I kinda made the naive (and false) assumption that because I was working with the depth of branches, I&#39;d need depth-first search not breadth-first. I have used a breadth-first algorithm now (the bft in duplode&#39;s answer) and it&#39;s working."}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 2, "last_activity_date": 1479404182, "last_edit_date": 1495535559, "creation_date": 1479404182, "answer_id": 40661524, "question_id": 40647260, "link": "https://stackoverflow.com/questions/40647260/finding-the-longest-path-through-a-dfs-forest-in-haskell/40661524#40661524", "title": "Finding the longest path through a DFS Forest in Haskell", "body": "<p>I will first explain what <code>dfs</code> does. As you mentioned in your comments, you use <code>buildG</code> function so I will also use it in my answer.</p>\n\n<p><code>dfs</code> takes 2 arguments: graph and list of root nodes. And then <code>dfs</code> runs <em>depth-first search</em> starting from each vertex number in list, returning <code>Tree</code> of reachable vertices from those nodes in list. For example:</p>\n\n<ol>\n<li>You have graph of 1 vertex and you want find paths from 1. You will then have list with only one <code>Tree</code> where root label is <code>1</code> and subforest is empty.</li>\n<li>You have graph of 2 vertices and edge from 1 to 2 and you want find paths from 1. You will then have list with only one <code>Tree</code> where root label is <code>1</code> and subforest is list with 2 as root label.</li>\n<li>You have graph of 3 vertices and edges (1,2) and (1,3) and you want find paths from 1. You will then have list with only one <code>Tree</code> where root label is <code>1</code> and subforest is list with two trees with 2 and 3 as root labels correspondingly.</li>\n</ol>\n\n<p>All these examples (and even some more) are demonstrated in next <em>ghci</em> session:</p>\n\n<pre><code>\u03bb: let g = buildG (1,1) []\n\u03bb: dfs g [1]\n[Node {rootLabel = 1, subForest = []}]\n\u03bb: dfs g [2]\n*** Exception: Ix{Int}.index: Index (2) out of range ((1,1))\n\u03bb: let g = buildG (1,2) [(1,2)]\n\u03bb: dfs g [1]\n[Node {rootLabel = 1, subForest = [Node {rootLabel = 2, subForest = []}]}]\n\u03bb: dfs g [2]\n[Node {rootLabel = 2, subForest = []}]\n\u03bb: let g = buildG (1,3) [(1,2), (1,3)]\n\u03bb: dfs g [1]\n[Node {rootLabel = 1, subForest = [Node {rootLabel = 3, subForest = []},Node {rootLabel = 2, subForest = []}]}]\n</code></pre>\n\n<p>But, unfortunately, <code>dfs</code> can't help you with your task: finding furthest vertex from given one. In the way algorithm works it is just not capable to solve such problems. Suppose you have graph with 4 vertices and edges:</p>\n\n<p>1 \u2192 2, 2 \u2192 3, 3 \u2192 4, 1 \u2192 4</p>\n\n<p>Vertex that has longest path from 1 is 3 (this path has 2 edges). But <code>dfs</code> will return you different results depending on order of edges you specified.</p>\n\n<pre><code>\u03bb: let g = buildG (1,4) [(1,2), (1,4), (2,3), (3,4)]\n\u03bb: dfs g [1]\n[Node {rootLabel = 1, subForest = [Node {rootLabel = 4, subForest = []},Node {rootLabel = 2, subForest = [Node {rootLabel = 3, subForest = []}]}]}]\n\u03bb: let g = buildG (1,4) [(1,4), (1,2), (2,3), (3,4)]\n\u03bb: dfs g [1]\n[Node {rootLabel = 1, subForest = [Node {rootLabel = 2, subForest = [Node {rootLabel = 3, subForest = [Node {rootLabel = 4, subForest = []}]}]}]}]\n</code></pre>\n\n<p>It is not the problem of particular implementation. It is just how <code>dfs</code> works. And you can't use <code>dfs</code> in general case to solve your particular problem. Also, this problem can't be fixed with just rearranging edges in list because you don't know how to rearrange them in general.</p>\n\n<p>What you really need to use is <code>bfs</code> algorithm \u2014 <em>breadth-first search</em>. Unfortunately, it is not implemented in <code>Data.Graph</code> library. So you need to implement whole algo from zero or find implementation somewhere (here some dicussions: <a href=\"https://stackoverflow.com/questions/21074766/traversing-a-graph-breadth-first-marking-visited-nodes-in-haskell\">Traversing a graph breadth first, marking visited nodes in Haskell</a>).</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 3, "last_activity_date": 1479426056, "last_edit_date": 1479426056, "creation_date": 1479424881, "answer_id": 40666822, "question_id": 40647260, "link": "https://stackoverflow.com/questions/40647260/finding-the-longest-path-through-a-dfs-forest-in-haskell/40666822#40666822", "title": "Finding the longest path through a DFS Forest in Haskell", "body": "<p>As Shersh explains in their answer, depth-first search is not enough to solve your problem (if it was, you could use the <code>generalFold</code> from the answer you linked to to, for instance, reconstruct the longest path in each tree of the forest). One alternative is switching from <code>Data.Graph</code> to <em>fgl</em>, which offers a wide assortment of graph algorithms, including breadth-first search. Note that <a href=\"https://www.stackage.org/lts-7.9/package/fgl-5.5.3.0\" rel=\"nofollow noreferrer\">The Haddock documentation</a> of FGL is rather laconic, and so you will also want to consult the helpful User Guide available though the <a href=\"http://web.engr.oregonstate.edu/~erwig/fgl/haskell/\" rel=\"nofollow noreferrer\">package homepage</a>. In the demo below, I will use the <a href=\"https://www.stackage.org/haddock/lts-7.9/fgl-5.5.3.0/Data-Graph-Inductive-Query-BFS.html#v:bft\" rel=\"nofollow noreferrer\"><code>bft</code></a> function to get a breadth-first spanning tree of a graph, which should be enough to get you started:</p>\n\n<pre><code>GHCi&gt; import Data.Graph.Inductive.Graph\nGHCi&gt; import Data.Graph.Inductive.PatriciaTree \nGHCi&gt; import Data.Graph.Inductive.Query.BFS\nGHCi&gt; :{\nGHCi| test :: UGr\nGHCi| test = mkUGraph [1..7] [(1,3),(1,2),(2,4),(3,5),(2,6),(5,2),(5,7)]\nGHCi| :}\nGHCi&gt; prettyPrint test\n1:()-&gt;[((),2),((),3)]\n2:()-&gt;[((),4),((),6)]\n3:()-&gt;[((),5)]\n4:()-&gt;[]\n5:()-&gt;[((),2),((),7)]\n6:()-&gt;[]\n7:()-&gt;[]\nGHCi&gt; bft 1 test\n[[1],[2,1],[3,1],[4,2,1],[6,2,1],[5,3,1],[7,5,3,1]]\n</code></pre>\n\n<p>The spanning tree is essentially a list of paths from a node to all reachable nodes. If you, for instance, just want to find one of the paths with maximum length and don't care about draws, all you need is:</p>\n\n<pre><code>GHCi&gt; import Data.Ord\nGHCi&gt; import Data.List\nGHCi&gt; maximumBy (comparing length) (bft 1 test)\n[7,5,3,1]\n</code></pre>\n\n<p>If you do care about draws, you will need to do some juggling with things like <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html#v:groupBy\" rel=\"nofollow noreferrer\"><code>groupBy</code></a>, but it won't be fundamentally more difficult.</p>\n"}, {"tags": [], "owner": {"reputation": 344, "user_id": 3626747, "user_type": "registered", "profile_image": "https://graph.facebook.com/100004670593545/picture?type=large", "display_name": "robert_peszek", "link": "https://stackoverflow.com/users/3626747/robert-peszek"}, "is_accepted": false, "score": 0, "last_activity_date": 1515731154, "creation_date": 1515731154, "answer_id": 48219543, "question_id": 40647260, "link": "https://stackoverflow.com/questions/40647260/finding-the-longest-path-through-a-dfs-forest-in-haskell/48219543#48219543", "title": "Finding the longest path through a DFS Forest in Haskell", "body": "<p>It should be noted that longest path in the graph is not the same as longest path \nin a spanning tree.  Graphs can have many spanning trees and these trees do not have\nto have the same height. \nThe btf code presented by duplode finds correctly the longest path in a spanning tree.</p>\n\n<p>For example, the graph in duplode answer\n<code>\nmkUGraph [1..7] [(1,3),(1,2),(2,4),(3,5),(2,6),(5,2),(5,7)]\n</code>\nhas a longer path then the one suggested <code>[1,3,5,7]</code>, that path is <code>[1,3,5,2,6]</code>.</p>\n\n<p>An even simpler example of\n<code>\nmkUGraph [1,2,3] [(1,2),(1,3),(2,3)]\n</code>\nusing FGLs <code>btf 1</code> will yield spanning tree <code>[[1], [3,1], [2,1]]</code> and the longest path is <code>[1,2,3]</code> (and by itself is a spanning tree).</p>\n\n<p>In general, finding longest path is not trivial (NP-hard actually) but it can be done for DAG using a rather straightforward fold of topologically sorted nodes.</p>\n\n<p>See\n<a href=\"https://github.com/rpeszek/graph-exercise\" rel=\"nofollow noreferrer\">https://github.com/rpeszek/graph-exercise</a></p>\n"}], "owner": {"reputation": 367, "user_id": 1218601, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/d773283aacac768ba226e418b86265eb?s=128&d=identicon&r=PG", "display_name": "Callum Booth", "link": "https://stackoverflow.com/users/1218601/callum-booth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 0, "accepted_answer_id": 40666822, "answer_count": 3, "score": 2, "last_activity_date": 1515731154, "creation_date": 1479360152, "last_edit_date": 1495540518, "question_id": 40647260, "link": "https://stackoverflow.com/questions/40647260/finding-the-longest-path-through-a-dfs-forest-in-haskell", "title": "Finding the longest path through a DFS Forest in Haskell", "body": "<p>I have a graph that I'm trying to find the longest path through but I'm unsure how to go about it. I'm using the standard <code>Graph</code> and <code>Edge</code> types from <a href=\"https://hackage.haskell.org/package/containers-0.5.7.1/docs/Data-Graph.html\" rel=\"nofollow noreferrer\"><code>Data.Graph</code></a>, and the graph was generated using the <code>buildG</code> function. My initial thought was to use <code>dfs</code> to perform a depth-first search, but this yielded a <code>Forest</code> object that I'm unsure how to manipulate. </p>\n\n<p>If it at all helps (and I'm sorry I can't pretty print this, <code>showForest</code> only prints strings apparently), this is the output of the <code>dfs</code> command on my graph:</p>\n\n<p><code>[Node {rootLabel = 87, subForest = [Node {rootLabel = 82, subForest = [Node {rootLabel = 70, subForest = []},Node {rootLabel = 83, subForest = [Node {rootLabel = 66, subForest = [Node {rootLabel = 72, subForest = [Node {rootLabel = 88, subForest = []}]}]},Node {rootLabel = 79, subForest = [Node {rootLabel = 69, subForest = [Node {rootLabel = 85, subForest = []},Node {rootLabel = 84, subForest = [Node {rootLabel = 86, subForest = []},Node {rootLabel = 73, subForest = [Node {rootLabel = 81, subForest = []}]}]}]}]}]},Node {rootLabel = 89, subForest = []}]}]}]</code></p>\n\n<p>I've found a few different functions for finding longest paths through Trees, such as in this <a href=\"https://stackoverflow.com/a/22021960/1218601\">answer</a>, but they only work for <code>Tree</code>s, not <code>Forest</code>s, and I'm unsure if it's even possible to convert between the two.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "functional-programming", "agda", "dependent-type", "morte"], "answers": [{"tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": false, "score": 6, "last_activity_date": 1479370902, "creation_date": 1479370902, "answer_id": 40649821, "question_id": 40645730, "link": "https://stackoverflow.com/questions/40645730/how-to-type-zipwith-in-morte/40649821#40649821", "title": "How to type zipWith in Morte?", "body": "<p>I'll be using regular Haskell lists for simplicity. First, let's define <code>zipWith</code> using <code>foldr</code>:</p>\n\n<pre><code>zipWith' :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]\nzipWith' f xs ys = foldr step (const []) xs ys where\n  step x r  []    = []\n  step x r (y:ys) = f x y : r ys\n</code></pre>\n\n<p>Here we fold over <code>xs</code>, pass <code>ys</code> as an argument and split it at each iteration. The problem is that we want to emulate Church-encoded lists, but they can't be pattern matched on. It is however possible to define <code>split</code></p>\n\n<pre><code>split :: [a] -&gt; Maybe (a, [a])\nsplit  []    = Nothing\nsplit (x:xs) = Just (x, xs)\n</code></pre>\n\n<p>in terms of <code>foldr</code>:</p>\n\n<pre><code>split :: [a] -&gt; Maybe (a, [a])\nsplit = snd . foldr (\\x ~(r, _) -&gt; (x : r, Just (x, r))) ([], Nothing)\n</code></pre>\n\n<p>Now we can define <code>zipWith</code> using only right folds:</p>\n\n<pre><code>czipWith :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]\nczipWith f xs ys = foldr step (const []) xs ys where\n  step x r = maybe [] (\\(y, ys) -&gt; f x y : r ys) . split\n</code></pre>\n\n<p>However while <code>split</code> traverses a list lazily (so <code>split [1..] \u2261 Just (1, [2..])</code>), it nevertheless deconstructs and reconstructs an entire list, and hence each <code>split</code> introduces an O(n) overhead, where <code>n</code> is the length of the list being splitted. Since <code>ys</code> is splitted at each iteration, total complexity of the algorithm is O(n^2).</p>\n\n<p>So yes, you can type <code>zipWith</code> using only non-recursive types, but it'll be O(n^2).</p>\n\n<hr>\n\n<p>Also, eliminators are dependent paramorphisms and paramorphisms do give you pattern matching, so if you have eliminators, it's <a href=\"https://github.com/effectfully/random-stuff/blob/master/Lists/zipWith-via-elim.agda\" rel=\"nofollow noreferrer\">straightforward</a> to define O(n) <code>zipWith</code>  and it doesn't have to be as complicated as in <strong>Andr\u00e1s</strong>' answer you linked.</p>\n\n<p>Some reading:</p>\n\n<ul>\n<li>In a typed setting Church encoding is called <a href=\"http://okmij.org/ftp/tagless-final/course/Boehm-Berarducci.html\" rel=\"nofollow noreferrer\">Boehm-Berarducci</a> encoding.</li>\n<li><a href=\"http://okmij.org/ftp/Haskell/zip-folds.lhs\" rel=\"nofollow noreferrer\">How to zip folds</a>.</li>\n<li><a href=\"http://okmij.org/ftp/Haskell/car-fstream.lhs\" rel=\"nofollow noreferrer\">How to take a TAIL of a functional stream</a>.</li>\n<li>That definition of <code>split</code> in terms of <code>foldr</code> I'm using is described somewhere in <a href=\"https://www.cis.upenn.edu/~bcpierce/tapl/\" rel=\"nofollow noreferrer\">TAPL</a>.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 4, "last_activity_date": 1479379423, "last_edit_date": 1495541624, "creation_date": 1479371703, "answer_id": 40650036, "question_id": 40645730, "link": "https://stackoverflow.com/questions/40645730/how-to-type-zipwith-in-morte/40650036#40650036", "title": "How to type zipWith in Morte?", "body": "<p>The clever definition of <code>zipWith</code> (which comes from <a href=\"https://arxiv.org/pdf/1309.5135.pdf\" rel=\"nofollow noreferrer\">Launchbury et al.</a>, I believe) doesn't work in Morte, because typing it without negative recursive types (which Morte doesn't have, and which imply <code>fix</code>, as seen in my <a href=\"https://stackoverflow.com/questions/29885983/infinite-type-error-when-defining-zip-with-foldr-only-can-it-be-fixed/29930561#29930561\">mentioned</a> previous answer) requires induction at least on natural numbers. <a href=\"https://github.com/AndrasKovacs/misc-stuff/blob/master/agda/Hyperfunction.agda\" rel=\"nofollow noreferrer\">Here's</a> a simple Agda version of Launchbury's definition without Church encoding; to reproduce this in Morte we'd need functions whose return type depends on natural numbers (the lengths of input lists).</p>\n\n<p>Without induction, the best we can do is an <code>O(N^2)</code> definition that uses <code>O(N)</code> pattern matching on lists, i. e. a <code>List A -&gt; Maybe (A, List A)</code> function. It's <code>O(N)</code> because we can only get the tail of the list by rebuilding it from the end.</p>\n\n<p>In Morte-compliant Agda (to get Morte, we need to desugar <code>let</code> style definitions to applications and function definitions to annotated lambdas):</p>\n\n<pre><code>Pair : Set \u2192 Set \u2192 Set\nPair A B = \u2200 P \u2192 (A \u2192 B \u2192 P) \u2192 P\n\npair : \u2200 A B \u2192 A \u2192 B \u2192 Pair A B\npair A B a b P p = p a b\n\nList : Set \u2192 Set\nList = \u03bb A \u2192 \u2200 L \u2192 (A \u2192 L \u2192 L) \u2192 L \u2192 L\n\nMaybe : Set \u2192 Set\nMaybe A = \u2200 M \u2192 (A \u2192 M) \u2192 M \u2192 M\n\njust : \u2200 A \u2192 A \u2192 Maybe A\njust A a M j n = j a\n\nnothing : \u2200 A \u2192 Maybe A\nnothing A M j n = n\n\nnil : \u2200 A \u2192 List A\nnil A L c n = n\n\ncons : \u2200 A \u2192 A \u2192 List A \u2192 List A\ncons A a as L c n = c a (as L c n)\n\nmatch : \u2200 A \u2192 List A \u2192 Maybe (Pair A (List A))\nmatch A as =\n  as\n    (Maybe (Pair A (List A)))\n    (\u03bb a m M j n \u2192\n       m M\n         (\u03bb p \u2192 p M (\u03bb a' as \u2192 j (pair A (List A) a (cons A a' as))))\n         (j (pair A (List A) a (nil A))))\n    (nothing (Pair A (List A)))\n\nzipWith : \u2200 A B C \u2192 (A \u2192 B \u2192 C) \u2192 List A \u2192 List B \u2192 List C\nzipWith A B C f as = \n  as\n    (List B \u2192 List C)\n    (\u03bb a hyp bs \u2192 match B bs (List C)\n      (\u03bb p \u2192 p (List C) (\u03bb b bs' \u2192 cons C (f a b) (hyp bs')))\n      (nil C))\n    (\u03bb _ \u2192 nil C)\n</code></pre>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1479432098, "creation_date": 1479349656, "last_edit_date": 1495540417, "question_id": 40645730, "link": "https://stackoverflow.com/questions/40645730/how-to-type-zipwith-in-morte", "title": "How to type zipWith in Morte?", "body": "<p>This is an almost valid <code>zipWith</code> definition in Morte:</p>\n\n<pre><code>zipWith\n  =  \u03bb (u : *)\n  -&gt; \u03bb (f : (u -&gt; u -&gt; u))\n  -&gt; \u03bb (a : (#List u))\n  -&gt; \u03bb (b : (#List u))\n  -&gt; \u03bb (List : *)\n  -&gt; \u03bb (cons : (u -&gt; List -&gt; List))\n  -&gt; \u03bb (nil : List)\n  -&gt; ((\u03bb (A:*) -&gt; \u03bb (B:*) -&gt;\n  (a (B -&gt; List)\n    (\u03bb (h:u) -&gt; \u03bb (t : (B -&gt; List) -&gt; \u03bb k : B -&gt; (k h t)))\n    (\u03bb (k:B) -&gt; nil)\n    (b (u -&gt; A -&gt; List)\n      (\u03bb (h:u) -&gt; \u03bb (t:(u -&gt; A -&gt; List)) -&gt; \u03bb (H:u) -&gt; \u03bb (k:A) -&gt; (cons (f h H) (k t)))\n      (\u03bb (H:u) -&gt; \u03bb (k:A) -&gt; nil)))\n  ) (fix A . ((u -&gt; A -&gt; List) -&gt; List))\n    (fix B . (u -&gt; (B -&gt; List) -&gt; List)))\n</code></pre>\n\n<p>It isn't actually typeable due to the use of <code>fix</code>, which Morte lacks. <a href=\"https://stackoverflow.com/a/29930561/477476\">Andr\u00e1s posted this clever Agda solution without <code>fix</code></a> last year. It isn't obvious to me how it translates to Morte, though, because it also lacks inductive types. How to approach this problem? </p>\n\n<p>Edit: seems like my zipWith was incorrect even with <code>fix</code>. <a href=\"http://lpaste.net/341877\" rel=\"nofollow noreferrer\">This one</a> seems to check, though.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 4, "creation_date": 1479346849, "post_id": 40645148, "comment_id": 68522637, "body": "If you only want to do that for better understanding your program, you will find it much easier to, rather than following the path suggested by the duplicate, take advantage of <a href=\"https://downloads.haskell.org/~ghc/8.0.1/docs/html/users_guide/glasgow_exts.html#partial-type-signatures\" rel=\"nofollow noreferrer\">partial type signatures</a>. Replacing your print line with <code>print (l :: _)</code> will lead to a compile error that will tell you the type of <code>l</code>. That works equally well both when compiling to an executable and when loading the source file in GHCi."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1479347113, "post_id": 40645148, "comment_id": 68522704, "body": "Meta comment: if this is a XY question in the way I suspect it to be (see my comment above), I think it is worth reopening it."}], "owner": {"reputation": 3765, "user_id": 5051564, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/XcA21.jpg?s=128&g=1", "display_name": "matchifang", "link": "https://stackoverflow.com/users/5051564/matchifang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "closed_date": 1479346396, "answer_count": 0, "score": 1, "last_activity_date": 1479345286, "creation_date": 1479345286, "question_id": 40645148, "link": "https://stackoverflow.com/questions/40645148/how-can-you-print-the-type-of-a-haskell-expression-in-main", "closed_reason": "Duplicate", "title": "How can you print the type of a haskell expression in main?", "body": "<p>I'm writing the code in a .hs file, so I want to print the type of an expression in main. Suppose I have the following code: </p>\n\n<pre><code>main :: IO ()\nmain = do\n    ...\n    let l = fmap getFirstElem listOfURL\n    print (:type l)) --print the type of l\n</code></pre>\n\n<p>Is there a equivalent to :type in GHCi Prelude?</p>\n"}]