[{"tags": ["haskell", "lenses"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426720338, "post_id": 29134349, "comment_id": 46494263, "body": "What GHC version is this, and what <code>lens</code> version? Always include this info."}, {"owner": {"reputation": 2628, "user_id": 1031434, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/15f496f9b9b31303923658f3a02254c1?s=128&d=identicon&r=PG", "display_name": "timdiels", "link": "https://stackoverflow.com/users/1031434/timdiels"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426720834, "post_id": 29134349, "comment_id": 46494429, "body": "@dfeuer GHC version 7.8.4, and <code>lens</code> version 4.8."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1426721435, "post_id": 29134349, "comment_id": 46494638, "body": "You are using DatatypeContexts, a deprecated extension which has no merit, so I don&#39;t think you can expect support for it in the lens deriving machinery."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1426721751, "post_id": 29134349, "comment_id": 46494746, "body": "@user2407038, the reason I asked about the version is that <code>DatatypeContexts</code> doesn&#39;t appear in the question."}], "answers": [{"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 2, "creation_date": 1426722380, "post_id": 29134651, "comment_id": 46494930, "body": "Unfortunately a GADT hits straight at one of <a href=\"http://stackoverflow.com/questions/28145369/makelenses-for-gadts-haskell/28145814#28145814\">my previous answers</a> which I have a small hunch the OP already found..."}, {"owner": {"reputation": 2628, "user_id": 1031434, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/15f496f9b9b31303923658f3a02254c1?s=128&d=identicon&r=PG", "display_name": "timdiels", "link": "https://stackoverflow.com/users/1031434/timdiels"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1426722521, "post_id": 29134651, "comment_id": 46494983, "body": "@&#216;rjan Johansen I came across that one indeed."}, {"owner": {"reputation": 2628, "user_id": 1031434, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/15f496f9b9b31303923658f3a02254c1?s=128&d=identicon&r=PG", "display_name": "timdiels", "link": "https://stackoverflow.com/users/1031434/timdiels"}, "edited": false, "score": 0, "creation_date": 1426722970, "post_id": 29134651, "comment_id": 46495108, "body": "In record syntax: <code>data Foo a where     Foo :: Class1 a =&gt; { _field1 :: a } -&gt; Foo a</code>  Details on GADT: <a href=\"https://downloads.haskell.org/~ghc/7.8.4/docs/html/users_guide/data-type-extensions.html#gadt\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/7.8.4/docs/html/users_guide/&hellip;</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2628, "user_id": 1031434, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/15f496f9b9b31303923658f3a02254c1?s=128&d=identicon&r=PG", "display_name": "timdiels", "link": "https://stackoverflow.com/users/1031434/timdiels"}, "edited": false, "score": 0, "creation_date": 1426723961, "post_id": 29134651, "comment_id": 46495344, "body": "@timdiels, thanks. I read that page, but got the colons confused in the GADT record syntax and decided to just throw up my hands. I&#39;ve used GADTs, and I&#39;ve used records, but I&#39;ve never used them together."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 2, "last_activity_date": 1426722626, "last_edit_date": 1495541184, "creation_date": 1426721611, "answer_id": 29134651, "question_id": 29134349, "link": "https://stackoverflow.com/questions/29134349/makelenses-on-data-with-constraint-datatypecontexts/29134651#29134651", "title": "makeLenses on data with constraint (DatatypeContexts)", "body": "<p>The problem, I believe, is that datatype contexts are a somewhat broken feature. You probably mean to use a GADT:</p>\n\n<pre><code>{-# Language GADTs #-}\n\ndata Foo a where\n  Foo :: Class1 a =&gt; a -&gt; Foo a\n</code></pre>\n\n<p>I'm not sure how to get the record syntax in there with the class constraint.</p>\n\n<p>Unfortunately, as \u00d8rjan Johansen <a href=\"https://stackoverflow.com/questions/29134349/makelenses-on-data-with-constraint/29134651?noredirect=1#comment46494930_29134651\">commented</a>, you will immediately run into trouble making the lenses automatically because of the existential type. But you should, I believe be able to write them by hand, whereas the datatype context would never ever have worked.</p>\n"}], "owner": {"reputation": 2628, "user_id": 1031434, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/15f496f9b9b31303923658f3a02254c1?s=128&d=identicon&r=PG", "display_name": "timdiels", "link": "https://stackoverflow.com/users/1031434/timdiels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 29134651, "answer_count": 1, "score": 1, "last_activity_date": 1426723559, "creation_date": 1426720050, "last_edit_date": 1426723559, "question_id": 29134349, "link": "https://stackoverflow.com/questions/29134349/makelenses-on-data-with-constraint-datatypecontexts", "title": "makeLenses on data with constraint (DatatypeContexts)", "body": "<p>Can I use the <code>makeLenses</code> template on a data type with constraints and if so, how? I'd like to do so without reading all about <a href=\"http://www.haskell.org/haskellwiki/Template_Haskell\" rel=\"nofollow\">Template Haskell</a>.</p>\n\n<p>In GHC I have this example:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell, FlexibleInstances, UndecidableInstances, NoMonomorphismRestriction #-}\nmodule Main (main) where\n\nimport Control.Lens\nimport Control.Monad.Reader  -- mtl\n\nclass Class1 a where\n    someThing :: a  -- just some filler\n\ninstance (Num a) =&gt; Class1 a where\n    someThing = 3\n\ndata (Class1 a) =&gt; Foo a = Foo { _field1 :: a }\n\nmakeLenses ''Foo\n\nmain :: IO ()\nmain = putStrLn . show $ runReader (view field1) $ Foo { _field1 = 5 }\n</code></pre>\n\n<p>This produces this compile error:</p>\n\n<pre><code>Could not deduce (Num a1) arising from a use of \u2018Foo\u2019\nfrom the context (Profunctor p, Functor f)\n  bound by the type signature for\n             field1 :: (Profunctor p, Functor f) =&gt;\n                       p a (f a1) -&gt; p (Foo a) (f (Foo a1))\n  at src/main.hs:58:1-16\nPossible fix:\n  add (Num a1) to the context of\n    the type signature for\n      field1 :: (Profunctor p, Functor f) =&gt;\n                p a (f a1) -&gt; p (Foo a) (f (Foo a1))\nIn the second argument of \u2018iso\u2019, namely \u2018Foo\u2019\nIn the expression: iso (\\ (Foo x_a3NK) -&gt; x_a3NK) Foo\nIn an equation for \u2018field1\u2019:\n    field1 = iso (\\ (Foo x_a3NK) -&gt; x_a3NK) Foo\n</code></pre>\n\n<p>So I think it generated:</p>\n\n<pre><code>field1 :: Lens' (Foo a) a\n</code></pre>\n\n<p>I've also tried <code>makeFields</code> and <code>makeClassy</code>, to no avail.</p>\n\n<p>I know I could work around this with:</p>\n\n<pre><code>field1 :: (Class1 a) =&gt; Lens' (Foo a) a\nfield1 = lens _field1 (\\ foo val -&gt; Foo { _field1 = val })\n</code></pre>\n\n<p>But is there a way to do it with <code>makeLenses</code> or Template Haskell?</p>\n\n<p>I'm using GHC version 7.8.4, and <code>lens</code> version 4.8.</p>\n\n<p>(Note: I know there have been similar questions about makeLenses, but I still couldn't get it to work. I'm a beginner at haskell.)</p>\n"}, {"tags": ["haskell", "exception-handling", "signals"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1426720917, "post_id": 29134034, "comment_id": 46494454, "body": "It seems that ghc treats sigterm differently from other exceptions. <a href=\"http://stackoverflow.com/questions/18430748/killing-a-haskell-binary\">This</a> question may be useful."}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 1, "last_activity_date": 1428442461, "creation_date": 1428442461, "answer_id": 29501739, "question_id": 29134034, "link": "https://stackoverflow.com/questions/29134034/haskells-bracket-on-sigterm/29501739#29501739", "title": "haskells bracket on SIGTERM", "body": "<p>Generally, external signals aren't turned into exceptions and passed onto the program (for one, in a multithreaded program, which thread would catch them?), but instead are handled directly by the RTS.</p>\n\n<p>If you want to listen for an external signal and react to it, the proper course of action is to call <code>installHandler</code> from the unix package: <a href=\"http://hackage.haskell.org/package/unix-2.7.1.0/docs/System-Posix-Signals.html\" rel=\"nofollow\">http://hackage.haskell.org/package/unix-2.7.1.0/docs/System-Posix-Signals.html</a></p>\n"}], "owner": {"reputation": 2319, "user_id": 2211273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/6d55ba6b0f08aed750502866c7e7ee77?s=128&d=identicon&r=PG", "display_name": "Kritzefitz", "link": "https://stackoverflow.com/users/2211273/kritzefitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 29501739, "answer_count": 1, "score": 7, "last_activity_date": 1428442461, "creation_date": 1426718307, "last_edit_date": 1426718671, "question_id": 29134034, "link": "https://stackoverflow.com/questions/29134034/haskells-bracket-on-sigterm", "title": "haskells bracket on SIGTERM", "body": "<p>I have been trying to make an daemon that is stopped by sending it a SIGTERM signal (like it is usual for daemons). The daemon acquires some resources that should be freed after running and I wanted to use bracket for doing so.</p>\n\n<p>I noticed that the cleanup part of the bracket isn't run when the program terminates with SIGTERM. This can be reproduced with this program:</p>\n\n<pre><code>main = bracket (return \"ending\")\n       (\\x -&gt; putStrLn x)\n       (\\_ -&gt; threadDelay 10000000000000)\n</code></pre>\n\n<p>This simple program should acquire the string <code>\"ending\"</code> (for simplicity just by retuning it) and print that acquired string on ending.</p>\n\n<p>When I interrupt the program with ctrl-c, it behaves like expected and prints \"ending\" on exit, but when I kill it with <code>killall -TERM test</code> (the executable is named test) it prints \"Beendet\" (\"Ended\" in german), so the final part of the bracket isn't run.</p>\n\n<p>Is this a bug or am I doing something wrong?</p>\n\n<p>I'm using GHC 7.6.3 and I'm running on Linux/GNU Debian jessie i386 (i686)</p>\n"}, {"tags": ["sql", "database", "haskell", "tuples", "persist"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4653789"}, "edited": false, "score": 0, "creation_date": 1426758508, "post_id": 29138675, "comment_id": 46506116, "body": "Thank you. I&#39;m still puzzled since I trusted the inductive definition of the PersistentFieldSql instances to resolve this and I thought I just had to add the correct imports."}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 1, "last_activity_date": 1426747666, "creation_date": 1426747666, "answer_id": 29138675, "question_id": 29133517, "link": "https://stackoverflow.com/questions/29133517/haskell-using-tuple-in-a-persist-sql-database-as-persistsqlfield/29138675#29138675", "title": "Haskell : Using Tuple in a Persist.Sql - Database as PersistSqlField", "body": "<p>It's tricky (and sometimes impossible) to embed complex types inside the persistent definition syntax. My recommendation is to define a type synonym in your Haskell code, e.g.:</p>\n\n<pre><code>type MemberList = [(String, [String])]\n</code></pre>\n\n<p>and then use that type inside the definition.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4653789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 29138675, "answer_count": 1, "score": 0, "last_activity_date": 1426747666, "creation_date": 1426715993, "question_id": 29133517, "link": "https://stackoverflow.com/questions/29133517/haskell-using-tuple-in-a-persist-sql-database-as-persistsqlfield", "title": "Haskell : Using Tuple in a Persist.Sql - Database as PersistSqlField", "body": "<p>I have created a database in which I would like to have a Field of the type [(String, [String])].</p>\n\n<pre><code>    share [mkPersist sqlSettings, mkMigrate \"migrateAll\"][persistLowerCase|\n    ConfigDB\n        numberOfParticipants Int\n        groupId              Int\n        memberList           [(String,[String])]\n        deriving Show\n    |]\n</code></pre>\n\n<p>However, I get an error message: </p>\n\n<blockquote>\n  <p>Exception when trying to run compile-time code: Invalid field type >\"[(String,[String])]\" PSFail PSFail \"PSFail \\\"(\\\\\"\\\\\",\\\\\"\\\\\",Nothing)\\\"</p>\n</blockquote>\n\n<p>The error seems to arise from using a tuple, because [String] works just fine, but if I write (String, String) the compiler tells me: </p>\n\n<blockquote>\n  <p>\"Not in scope: type constructor or class String,\n  Perhaps you meant String (imported from Prelude)\"</p>\n</blockquote>\n\n<p>In Database.Persist.Sql I find \n(PersistFieldSql a, PersistFieldSql b) => PersistFieldSql (a, b) is an instance, so it should work. </p>\n\n<p>Also, importing Data.Tuple didn't help.\nI have imported Database.Persist.Sqlite, of course.</p>\n\n<p>Thanks in advance,</p>\n\n<p>Sophia</p>\n"}, {"tags": ["haskell", "profiling", "ghc"], "answers": [{"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 3, "creation_date": 1426723599, "post_id": 29134597, "comment_id": 46495257, "body": "Will that profile the actual <i>execution</i> of the action rather than just its <i>construction</i>, though?"}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": false, "score": 3, "last_activity_date": 1426721309, "creation_date": 1426721309, "answer_id": 29134597, "question_id": 29132523, "link": "https://stackoverflow.com/questions/29132523/best-way-of-attaching-set-cost-center-to-a-monad-haskell/29134597#29134597", "title": "Best way of attaching &quot;Set Cost Center&quot; to a Monad (Haskell)", "body": "<p>SCCs can be set on any expression. <code>(do { ... })</code> is a valid expression. So is <code>computeStuff</code> and <code>return (x + y)</code>. The only thing that isn't an expression here is <code>x &lt;- computeStuff</code>. You say you want the total time, which I understand to mean the total time for the entire do block. But you can place SCCs anywhere inside the do block; for example, the following is perfectly valid. </p>\n\n<pre><code>computeStuff :: IO Int \ncomputeStuff = return 0 \n\ntest = {-# SCC \"total\" #-} (\n  do\n    x &lt;- {-# SCC \"x\" #-} computeStuff\n    y &lt;- {-# SCC \"y\" #-} computeStuff\n    return $ {-# SCC \"x+y\" #-} (x + y) \n  )\n</code></pre>\n"}], "owner": {"reputation": 3333, "user_id": 3859566, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a7c4c1c9ad9bd41f49004d32884bc680?s=128&d=identicon&r=PG&f=1", "display_name": "yong", "link": "https://stackoverflow.com/users/3859566/yong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1426725616, "creation_date": 1426712314, "last_edit_date": 1426725616, "question_id": 29132523, "link": "https://stackoverflow.com/questions/29132523/best-way-of-attaching-set-cost-center-to-a-monad-haskell", "title": "Best way of attaching &quot;Set Cost Center&quot; to a Monad (Haskell)", "body": "<p>I'm trying to profile my program with SCC (Set Cost Center) annotations. What's the best way to find out how long it takes for a monad defined by a do statement to run? (It is illegal to put an SCC statement in a do block.) In other words, let's say I have:</p>\n\n<pre><code>do\n  x &lt;- computeStuff\n  y &lt;- computeStuff\n  return (x + y)\n</code></pre>\n\n<p>How do I find the total execution time for the two <code>computeStuff</code> and the <code>x + y</code> (instead of the construction time of the Monad)? </p>\n"}, {"tags": ["sorting", "haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1426706556, "post_id": 29130854, "comment_id": 46487481, "body": "Remove the <code>let</code>. Also, your <code>quickerSort</code> is wrong since it does not recursively sorts the sublists."}], "answers": [{"comments": [{"owner": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "reply_to_user": {"reputation": 300, "user_id": 1637272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a43579cbf6aea51bbd0f9ebfd4f21ba?s=128&d=identicon&r=PG", "display_name": "Maz", "link": "https://stackoverflow.com/users/1637272/maz"}, "edited": false, "score": 4, "creation_date": 1426706553, "post_id": 29130882, "comment_id": 46487479, "body": "<code>where</code> is an alternative to <code>let</code> where things are just in the opposite order.  You write either <code>let var = foo in code</code> or <code>code where var = foo</code> (though there are some constructs where <code>let</code> can be used but not <code>where</code>)."}, {"owner": {"reputation": 300, "user_id": 1637272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a43579cbf6aea51bbd0f9ebfd4f21ba?s=128&d=identicon&r=PG", "display_name": "Maz", "link": "https://stackoverflow.com/users/1637272/maz"}, "edited": false, "score": 0, "creation_date": 1426718334, "post_id": 29130882, "comment_id": 46493605, "body": "Is one faster than another? Or do they function the same?"}, {"owner": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "reply_to_user": {"reputation": 300, "user_id": 1637272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a43579cbf6aea51bbd0f9ebfd4f21ba?s=128&d=identicon&r=PG", "display_name": "Maz", "link": "https://stackoverflow.com/users/1637272/maz"}, "edited": false, "score": 0, "creation_date": 1426720118, "post_id": 29130882, "comment_id": 46494187, "body": "@Maz: Any differences between them are erased during compilation.  They&#39;re exactly the same speed."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1426723818, "post_id": 29130882, "comment_id": 46495307, "body": "GHC&#39;s intermediate core language has only <code>let</code>, not <code>where</code>, so they more or less have to be desugared to the same thing."}], "tags": [], "owner": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "is_accepted": true, "score": 3, "last_activity_date": 1426706373, "creation_date": 1426706373, "answer_id": 29130882, "question_id": 29130854, "link": "https://stackoverflow.com/questions/29130854/rewriting-sorting-algorithm-bad-code-or-just-bad-spacing/29130882#29130882", "title": "Rewriting sorting algorithm. Bad code or just bad spacing", "body": "<p><code>where let</code> is invalid syntax; just write <code>where</code> there.</p>\n"}], "owner": {"reputation": 300, "user_id": 1637272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a43579cbf6aea51bbd0f9ebfd4f21ba?s=128&d=identicon&r=PG", "display_name": "Maz", "link": "https://stackoverflow.com/users/1637272/maz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 29130882, "answer_count": 1, "score": 0, "last_activity_date": 1426718604, "creation_date": 1426706280, "last_edit_date": 1426718604, "question_id": 29130854, "link": "https://stackoverflow.com/questions/29130854/rewriting-sorting-algorithm-bad-code-or-just-bad-spacing", "title": "Rewriting sorting algorithm. Bad code or just bad spacing", "body": "<p>I'm trying to teach myself Haskell, so I've been trying to rewrite pieces of code in another way. I found this sorting algorithm on an online tutorial and was trying to see if there were better ways to write this. </p>\n\n<p>Here's what I wrote</p>\n\n<pre><code>  quickerSort :: (Ord a) =&gt; [a] -&gt; [a]\n  quickerSort [] = []\n  quickerSort (x:xs) = smallList ++ [x] ++ bigList\n                     where let smallList = quickerSort [a | a&lt;-xs, a &lt;= x]\n                               bigList = quickerSort [a | a&lt;-xs, a &gt; x]\n</code></pre>\n\n<p>And here's what I was trying to rewrite in my own way. </p>\n\n<pre><code>quicksort :: (Ord a) =&gt; [a] -&gt; [a]  \nquicksort [] = []  \nquicksort (x:xs) =   \n    let smallerSorted = quicksort [a | a &lt;- xs, a &lt;= x]  \n        biggerSorted = quicksort [a | a &lt;- xs, a &gt; x]  \n    in  smallerSorted ++ [x] ++ biggerSorted \n</code></pre>\n\n<p>The interpreter yeilds \"parse error (possibly incorrect indentation or mismatched brackets),\" but I tried different spacing and it did not work. I was just wondering if I just wrote the function incorrectly. </p>\n\n<p>If it is indeed a spacing error, then can somebody link a tutorial that teaches correct haskell spacing?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "shellexecute"], "answers": [{"comments": [{"owner": {"reputation": 28845, "user_id": 238232, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/ccda2293fc93c7a871956102004ac19d?s=128&d=identicon&r=PG", "display_name": "cnd", "link": "https://stackoverflow.com/users/238232/cnd"}, "edited": false, "score": 0, "creation_date": 1426734771, "post_id": 29132432, "comment_id": 46497992, "body": "Thank you but I still want to know if that is possible to handle spaces in <code>system</code>. Maybe I can make something that works like <code>system</code> based on <code>rawSystem</code>..."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1426711999, "creation_date": 1426711999, "answer_id": 29132432, "question_id": 29130802, "link": "https://stackoverflow.com/questions/29130802/how-to-handle-spaces-with-system-process-system/29132432#29132432", "title": "How to handle spaces with System.Process (system)", "body": "<p>Try <a href=\"http://hackage.haskell.org/package/process-1.2.3.0/docs/System-Process.html#v:rawSystem\" rel=\"nofollow\"><code>rawSystem</code></a> instead. It requires you to split the arguments in a list of strings, but at least you should not have any issues with spaces and escaping special characters.</p>\n"}], "owner": {"reputation": 28845, "user_id": 238232, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/ccda2293fc93c7a871956102004ac19d?s=128&d=identicon&r=PG", "display_name": "cnd", "link": "https://stackoverflow.com/users/238232/cnd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 1, "accepted_answer_id": 29132432, "answer_count": 1, "score": 1, "last_activity_date": 1426711999, "creation_date": 1426706124, "question_id": 29130802, "link": "https://stackoverflow.com/questions/29130802/how-to-handle-spaces-with-system-process-system", "title": "How to handle spaces with System.Process (system)", "body": "<p>If I want to execute some string that contains another path with spaces (I can pass it alike <code>\"\\\"C:/Program Files (x86)/G...</code>) <code>system</code> by default ignores quotes and shows error about <code>\"C:/Program\"</code></p>\n\n<p>Is there other quotes or I should replace space with some another symbol there?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1426707950, "post_id": 29129679, "comment_id": 46488290, "body": "That title can be read in two ways ;)"}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 3, "last_activity_date": 1426704084, "creation_date": 1426704084, "answer_id": 29130181, "question_id": 29129679, "link": "https://stackoverflow.com/questions/29129679/foldr-resulting-in-stack-overflow/29130181#29130181", "title": "foldr resulting in stack overflow", "body": "<p>I think the <code>foldr</code> is confusing you, so let's write it out with explicit recursion:</p>\n\n<pre><code>getPrimes :: [Int]\ngetPrimes = getPrimesUsing [3,5..]\n\ngetPrimesUsing :: [Int]-&gt;[Int]\ngetPrimesUsing [] = [2]\ngetPrimesUsing (n:primes)\n  | not $ isAnyDivisibleBy primes n = primes ++ [n]\n  | otherwise = primes\n  where\n    primes = getPrimesUsing primes\n    isAnyDivisibleBy primes n = any (\\x -&gt; isDivisibleBy n x) primes\n    isDivisibleBy x y = x `mod` y == 0\n</code></pre>\n\n<p>Can you see the trouble now?</p>\n\n<p>An unrelated point: the algorithm you seem to be trying to implement here is <em>not</em> the Sieve of Eratosthenes, but rather a much less efficient algorithm called trial division.</p>\n"}, {"tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 2, "last_activity_date": 1426704192, "creation_date": 1426704192, "answer_id": 29130214, "question_id": 29129679, "link": "https://stackoverflow.com/questions/29129679/foldr-resulting-in-stack-overflow/29130214#29130214", "title": "foldr resulting in stack overflow", "body": "<p><code>foldr getNextPrime [2] [3, 5 .. ]</code> expands to:</p>\n\n<pre><code>(getNextPrime 3 (getNextPrime 5 (getNextPrime 7 ...\n</code></pre>\n\n<p>Since <code>getNextPrime</code> always needs to inspect its second argument, we just get a non-terminating chain of <code>getNextPrime</code> calls, and the initial <code>[2]</code> list is never used. </p>\n"}, {"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 2, "last_activity_date": 1426704327, "creation_date": 1426704327, "answer_id": 29130256, "question_id": 29129679, "link": "https://stackoverflow.com/questions/29129679/foldr-resulting-in-stack-overflow/29130256#29130256", "title": "foldr resulting in stack overflow", "body": "<p><code>foldr</code> is defined as</p>\n\n<pre><code>foldr f z [] = z\nfoldr f z (x:xs) = f x (foldr f z xs)\n</code></pre>\n\n<p>So when you plug in the arguments you would get</p>\n\n<pre><code>foldr getNextPrime [2] [3,5..]\n    = getNextPrime 3 (foldr getNextPrime [2] [5,7..])\n    = getNextPrime 3 (getNextPrime 5 (foldr getNextPrime [2] [7,9..])\n    etc...\n</code></pre>\n\n<p>For this to lazily produce values (what you want when dealing with infinite lists) then <code>getNextPrime</code> needs to lazily produce values.  Looking at the definition of <code>getNextPrime</code>, <code>primes ++ [n]</code>, meaning you're appending a value onto the end of your <code>primes</code> list, but <code>primes</code> for <code>getNextPrime 3</code> is <code>getNextPrime 5 (foldr getNextPrime [2] [7,9..])</code>.  But then <code>primes</code> for <code>getNextPrime 5</code> is <code>getNextPrime 7 (foldr getNextPrime [2] [9,11..])</code>, etc, etc.  You never actually are able to produce a normal form value for <code>primes</code>, it's always a chain of computations that never return.</p>\n\n<p>Another way to look at this is to look at this is to replace <code>getNextPrime</code> with an operator, let's call it <code>.:</code></p>\n\n<pre><code>foldr (.:) [2] [3,5..9]\n    = 3 .: (5 .: (7 .: (9 .: [2])))\n</code></pre>\n\n<p>(this is why it's called a right fold, the parens are nested to the right)</p>\n\n<p>This works great for using <code>:</code> in <code>foldr</code>:</p>\n\n<pre><code>foldr (:) [2] [3,5..9]\n    = 3 : (5 : (7 : (9 : [2])\n</code></pre>\n\n<p>because <code>:</code> just builds a new data structure, and the first element of this data structure can be inspected without calculating the rest of the structure.  But <code>.:</code> isn't so nice, it first needs to calculate <code>x1 = 9 .: [2]</code>, then <code>x2 = 7 .: x1</code>, then <code>x3 = 5 .: x2</code>, and finally <code>3 .: x3</code>.  For <code>[3,5..]</code> instead, you never can calculate the last call of <code>something .: [2]</code>, but haskell keeps trying to compute it and that blows the stack.</p>\n"}], "owner": {"reputation": 283, "user_id": 341533, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db19cb0ff7ba1978615dcefdf87fbc41?s=128&d=identicon&r=PG", "display_name": "horatius83", "link": "https://stackoverflow.com/users/341533/horatius83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 29130181, "answer_count": 3, "score": 2, "last_activity_date": 1426704327, "creation_date": 1426702549, "question_id": 29129679, "link": "https://stackoverflow.com/questions/29129679/foldr-resulting-in-stack-overflow", "title": "foldr resulting in stack overflow", "body": "<p>I'm trying to generate primes using the Sieve of Eratosthenes algorithm on an infinite list. I've heard that foldr will examine the list lazily, but every time I try to use the following algorithm I get a stack overflow exception:</p>\n\n<pre><code>getPrimes :: [Int]\ngetPrimes = foldr getNextPrime [2] [3,5..]\n    where\n        getNextPrime n primes\n            | not $ isAnyDivisibleBy primes n = primes ++ [n]\n            | otherwise = primes\n        isAnyDivisibleBy primes n = any (\\x -&gt; isDivisibleBy n x) primes\n        isDivisibleBy x y = x `mod` y == 0\n</code></pre>\n\n<p>example: </p>\n\n<pre><code>takeWhile (\\x -&gt; x &lt; 10) getPrimes\n*** Exception: stack overflow\n</code></pre>\n\n<p>Somewhere the list is getting evaluated, but I can't figure out where. </p>\n"}, {"tags": ["haskell", "quickcheck"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1426698682, "post_id": 29127410, "comment_id": 46482615, "body": "can you give us the code you tried? It&#39;s easier to point you to the right way to do it this way. Aside from this you can also just get 7 random (non-negative?) integers and use a bit integer/modulo arithmetic to bring them into your desired ranges ;) (and there are functions in QuickCheck to massage the generators into that too)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1426706439, "post_id": 29127410, "comment_id": 46487400, "body": "For example, to test a function <code>f</code> on the domain [0..1000] you could do something like <code>prop_f = forAll (choose (0, 1000)) f</code>. You can chain <code>forAll</code>s for each value you need to generate."}], "answers": [{"comments": [{"owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "edited": false, "score": 0, "creation_date": 1426710128, "post_id": 29131014, "comment_id": 46489615, "body": "I searched in hackage for <code>&lt;$&gt;</code> function but I didn&#39;t find it. Which module import this function ?"}, {"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "reply_to_user": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "edited": false, "score": 0, "creation_date": 1426710385, "post_id": 29131014, "comment_id": 46489762, "body": "@JeanJouX Use Hoogle to search for functions: <a href=\"https://www.haskell.org/hoogle/?hoogle=%3C%24%3E\" rel=\"nofollow noreferrer\">haskell.org/hoogle/?hoogle=%3C%24%3E</a> The operator <code>&lt;$&gt;</code> is just another name for <code>fmap</code>. It&#39;s defined in <code>Data.Functor</code> and re-exported from <code>Control.Applicative</code> (which also defines <code>&lt;*&gt;</code>)."}], "tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": true, "score": 1, "last_activity_date": 1426706784, "creation_date": 1426706784, "answer_id": 29131014, "question_id": 29127410, "link": "https://stackoverflow.com/questions/29127410/test-a-function-with-different-list-of-value-with-quickcheck/29131014#29131014", "title": "Test a function with different list of value with quickCheck", "body": "<p>Here's a simpler example that you should be able to adapt to your style. Assuming you have a function</p>\n\n<pre><code>f :: Int -&gt; Int -&gt; Bool\n</code></pre>\n\n<p>and you want to test if <code>f x y</code> evaluates to <code>True</code> for <code>x</code> in the range <code>0</code> to <code>10</code> and <code>y</code> in the range <code>10</code> to <code>20</code>, you can do that by saying</p>\n\n<pre><code>prop_f :: Property\nprop_f = forAll (choose ( 0, 10)) $ \\ x -&gt;\n         forAll (choose (10, 20)) $ \\ y -&gt;\n         f x y\n</code></pre>\n\n<p>Another option is to combine the generation of several values into one <code>forAll</code> call by constructing a new generator on the fly:</p>\n\n<pre><code>prop_f :: Property\nprop_f = forAll ((,) &lt;$&gt; r1 &lt;*&gt; r2) $ \\ (x, y) -&gt; f x y\n  where\n    r1 = choose ( 0, 10)\n    r2 = choose (10, 20)\n</code></pre>\n\n<p>Yet another option is to define your own newtype wrappers:</p>\n\n<pre><code>newtype R1 = R1 Int\nnewtype R2 = R2 Int\n\ninstance Arbitrary R1 where arbitrary = R1 &lt;$&gt; choose ( 0, 10)\ninstance Arbitrary R2 where arbitrary = R2 &lt;$&gt; choose (10, 20)\n\nprop_f :: R1 -&gt; R2 -&gt; Bool\nprop_f (R1 x) (R2 y) = f x y\n</code></pre>\n\n<p>To define a generator that uses a predefined list of options, you'll have to use the <code>elements</code> functions.</p>\n"}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 29131014, "answer_count": 1, "score": 0, "last_activity_date": 1426706784, "creation_date": 1426695908, "question_id": 29127410, "link": "https://stackoverflow.com/questions/29127410/test-a-function-with-different-list-of-value-with-quickcheck", "title": "Test a function with different list of value with quickCheck", "body": "<p>I need to test a function with <code>quickCheck</code> with different range of values.</p>\n\n<p>my function is :</p>\n\n<pre><code>prop_test (x,y,z) (i,j,k) ndiv\n</code></pre>\n\n<p>and I would like to perform tests with :</p>\n\n<ul>\n<li><strong>x,y,z</strong> randomly taken in the range <strong>0</strong> to <strong>1000</strong></li>\n<li><strong>i,j,k</strong> randomly taken in the range <strong>1000</strong> to <strong>100000</strong></li>\n<li><strong>ndiv</strong> randomly taken in a list of fixed values <strong>[2,5,10,20]</strong></li>\n</ul>\n\n<p>I managed to set one property for one argument, but I didn't find how to set multiple (different) property to the function.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1426698682, "post_id": 29126987, "comment_id": 46482616, "body": "Can&#39;t you just use <code>deriving</code> clauses for all of those these days, using <code>-XDeriveDataTypeable</code>?"}, {"owner": {"reputation": 42418, "user_id": 912144, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/d17cb5b704821f11179ce281b8cae25e?s=128&d=identicon&r=PG", "display_name": "Shahbaz", "link": "https://stackoverflow.com/users/912144/shahbaz"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426699349, "post_id": 29126987, "comment_id": 46483082, "body": "Those types are in a library that I don&#39;t have access to itself. A developer of pandoc said he could add <code>deriving (Data)</code> to those types, but then never did. I would try to give <code>-XDeriveDataTypeable</code> (to <code>cabal build</code> in libpandoc?) and see what happens. In the meantime, whatever is preventing me from deriving <code>Data</code> for <code>MediaBag</code>, wouldn&#39;t it also prevent <code>deriving (Data)</code> or <code>-XDeriveDataTypeable</code> to work?"}, {"owner": {"reputation": 133729, "user_id": 98117, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4704a2a1d16b276070962ee01fb6149f?s=128&d=identicon&r=PG", "display_name": "hammar", "link": "https://stackoverflow.com/users/98117/hammar"}, "edited": false, "score": 2, "creation_date": 1426699671, "post_id": 29126987, "comment_id": 46483293, "body": "You can use the <code>-XStandaloneDeriving</code> extension to provide the deriving clauses separately without changing the library, e.g. <code>deriving instance Data WriterOptions</code>. Using the Template Haskell-generated instances won&#39;t work with GHC 7.8+ anyway because it disallows user-written <code>Typeable</code> instances."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426700369, "post_id": 29126987, "comment_id": 46483721, "body": "I don&#39;t understand what all is where, but you need to submit a pull request if you want to get something changed in Pandoc."}, {"owner": {"reputation": 42418, "user_id": 912144, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/d17cb5b704821f11179ce281b8cae25e?s=128&d=identicon&r=PG", "display_name": "Shahbaz", "link": "https://stackoverflow.com/users/912144/shahbaz"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426700573, "post_id": 29126987, "comment_id": 46483840, "body": "@dfeuer, I guess I would have to do that!"}, {"owner": {"reputation": 42418, "user_id": 912144, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/d17cb5b704821f11179ce281b8cae25e?s=128&d=identicon&r=PG", "display_name": "Shahbaz", "link": "https://stackoverflow.com/users/912144/shahbaz"}, "reply_to_user": {"reputation": 133729, "user_id": 98117, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4704a2a1d16b276070962ee01fb6149f?s=128&d=identicon&r=PG", "display_name": "hammar", "link": "https://stackoverflow.com/users/98117/hammar"}, "edited": false, "score": 0, "creation_date": 1426700582, "post_id": 29126987, "comment_id": 46483848, "body": "@hammar, thanks for the info. If I understand correctly, you are saying what I&#39;m doing is eventually futile? If so, I would just go with sending a pull request and try to get that in Pandoc itself."}, {"owner": {"reputation": 133729, "user_id": 98117, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4704a2a1d16b276070962ee01fb6149f?s=128&d=identicon&r=PG", "display_name": "hammar", "link": "https://stackoverflow.com/users/98117/hammar"}, "edited": false, "score": 0, "creation_date": 1426700727, "post_id": 29126987, "comment_id": 46483928, "body": "@Shahbaz: That&#39;s what I&#39;m saying, yes."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426700942, "post_id": 29126987, "comment_id": 46484055, "body": "You can do all sorts of things still to make <code>Data</code> instances, but <code>Data</code> is a subclass of <code>Typeable</code>, and you&#39;re no longer allowed to write your own <code>Typeable</code> instances (because that&#39;s extremely dangerous and close enough to useless). It&#39;s quite possible, however, that the Pandoc maintainer(s) won&#39;t want to derive <code>Data</code> for all the type! Deriving <code>Data</code> exposes the representation, so if any types are abstract, they will probably prefer to write a <code>Data</code> instance with a different representation, if possible."}, {"owner": {"reputation": 42418, "user_id": 912144, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/d17cb5b704821f11179ce281b8cae25e?s=128&d=identicon&r=PG", "display_name": "Shahbaz", "link": "https://stackoverflow.com/users/912144/shahbaz"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426701716, "post_id": 29126987, "comment_id": 46484545, "body": "@dfeuer, interesting. One of the developers had said &quot;wouldn&#39;t be easier if we just derive all of those from Data&quot; or something like this, so I guess they would be fine with it. I&#39;ll give it a shot and see what happens."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426702243, "post_id": 29126987, "comment_id": 46484892, "body": "It looks like most if not all of those are completely exposed anyway, so yeah, maybe no problem."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426724394, "post_id": 29126987, "comment_id": 46495469, "body": "@dfeuer It is perfectly possible to standalone <i>derive</i> <code>Typeable</code>, you just cannot give it a different instance than the default derivation."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1426724492, "post_id": 29126987, "comment_id": 46495495, "body": "@&#216;rjanJohansen, you can, and then when upstream derives it themselves, suddenly you&#39;re in crazy land. So yes, you can do that as a short-term measure, but long term pushing it upstream seems to be the only really good approach."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426724620, "post_id": 29126987, "comment_id": 46495537, "body": "@dfeuer I keep rethinking the idea that different instances should not conflict with each other if they&#39;re both derived the same way..."}], "answers": [{"comments": [{"owner": {"reputation": 42418, "user_id": 912144, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/d17cb5b704821f11179ce281b8cae25e?s=128&d=identicon&r=PG", "display_name": "Shahbaz", "link": "https://stackoverflow.com/users/912144/shahbaz"}, "edited": false, "score": 0, "creation_date": 1426756344, "post_id": 29135164, "comment_id": 46504903, "body": "It makes more sense now!"}], "tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 1, "last_activity_date": 1426724840, "creation_date": 1426724840, "answer_id": 29135164, "question_id": 29126987, "link": "https://stackoverflow.com/questions/29126987/how-to-derive-makedata-a-newtype/29135164#29135164", "title": "How to `derive makeData` a `newType`?", "body": "<p>I think the problem isn't that it's a <code>newtype</code>, but that <code>Text.Pandoc.MediaBag</code> only exports the <em>type</em> constructor <code>MediaBag</code>, not the <em>data</em> constructor. (Note how it's the latter the error message is complaining about.)</p>\n\n<p>Unfortunately, not allowing deriving <code>Data</code> and the like for types with non-exported data constructors is considered a <em>feature</em>, since it secures types against users breaking intended data abstraction. So indeed you'll probably need an upstream change as suggested in the comments.</p>\n"}], "owner": {"reputation": 42418, "user_id": 912144, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/d17cb5b704821f11179ce281b8cae25e?s=128&d=identicon&r=PG", "display_name": "Shahbaz", "link": "https://stackoverflow.com/users/912144/shahbaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 29135164, "answer_count": 1, "score": 2, "last_activity_date": 1426724840, "creation_date": 1426694757, "question_id": 29126987, "link": "https://stackoverflow.com/questions/29126987/how-to-derive-makedata-a-newtype", "title": "How to `derive makeData` a `newType`?", "body": "<p>I'm updating the C bindings library for Pandoc (<a href=\"https://github.com/ShabbyX/libpandoc\" rel=\"nofollow\">libpandoc</a>) and I've encountered an issue that is beyond me. I believe this has to do with template Haskell.</p>\n\n<p>The issue is the following. The original author of libpandoc has done <a href=\"https://github.com/ShabbyX/libpandoc/blob/master/src/LibPandoc/Instances.hs#L14\" rel=\"nofollow\">the following</a>:</p>\n\n<pre><code>$( derive makeData ''WriterOptions )\n</code></pre>\n\n<p>This is apparently important because down the line, the entity that contains <code>WriterOptions</code> is given to <code>Data.Generics.Rep.toRep</code> which requires it to be derived from <code>Data</code>.</p>\n\n<p>The issue is that <code>WriterOptions</code> is defined <a href=\"https://github.com/jgm/pandoc/blob/1.13.2/src/Text/Pandoc/Options.hs#L284\" rel=\"nofollow\">like this</a>:</p>\n\n<pre><code>data WriterOptions = WriterOptions\n  { ...\n    ...\n  , writerMediaBag :: MediaBag\n  } ...\n</code></pre>\n\n<p>and therefore, for <code>WriterOptions</code> to derive from <code>Data</code>, <code>MediaBag</code> also needs to derive from <code>Data</code>. Adding the following line to libpandoc:</p>\n\n<pre><code>$( derive makeData ''MediaBag )\n</code></pre>\n\n<p>doesn't work however with the following error:</p>\n\n<pre><code>src/LibPandoc/Instances.hs:XX:X:\n    Not in scope: data constructor `MediaBag'\n</code></pre>\n\n<p>I have successfully used <code>derive makeData</code> for other types (for example used by <code>ReaderOptions</code>) that were created with the <code>data</code> keyword. However, <code>MediaBag</code> <a href=\"https://github.com/jgm/pandoc/blob/1.13.2/src/Text/Pandoc/MediaBag.hs\" rel=\"nofollow\">is defined with</a> <code>newtype</code>.</p>\n\n<hr>\n\n<p>My question is, how can I eventually make <code>MediaBag</code>, defined using <code>newtype</code>, derive from <code>Data</code> so that I can successfully derive <code>WriterOptions</code> that contains an instance of it?</p>\n"}, {"tags": ["haskell", "web", "websocket", "http-headers", "monads"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1426693568, "post_id": 29126399, "comment_id": 46479058, "body": "Did you mean <code>talk handle &gt;&gt;= putStrLn</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4686054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd5bb2ab2cb7d72791b5dc77536db28?s=128&d=identicon&r=PG&f=1", "display_name": "haskellstuff", "link": "https://stackoverflow.com/users/4686054/haskellstuff"}, "edited": false, "score": 0, "creation_date": 1426888900, "post_id": 29131055, "comment_id": 46570644, "body": "thanks. how would i go about storing talk result in string variable?"}, {"owner": {"reputation": 3, "user_id": 4686054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd5bb2ab2cb7d72791b5dc77536db28?s=128&d=identicon&r=PG&f=1", "display_name": "haskellstuff", "link": "https://stackoverflow.com/users/4686054/haskellstuff"}, "edited": false, "score": 0, "creation_date": 1426889625, "post_id": 29131055, "comment_id": 46570917, "body": "or to pass it to function with type String -&gt; String?"}, {"owner": {"reputation": 1361, "user_id": 2556165, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fGy2y.jpg?s=128&g=1", "display_name": "wowofbob", "link": "https://stackoverflow.com/users/2556165/wowofbob"}, "reply_to_user": {"reputation": 3, "user_id": 4686054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd5bb2ab2cb7d72791b5dc77536db28?s=128&d=identicon&r=PG&f=1", "display_name": "haskellstuff", "link": "https://stackoverflow.com/users/4686054/haskellstuff"}, "edited": false, "score": 0, "creation_date": 1427055055, "post_id": 29131055, "comment_id": 46610933, "body": "@haskellstuff There are no variables in Haskell. You can bound <code>talk</code>&#39;s result to a name like you did with <code>sock</code> and then use it like string constant. Or you can pass it to a function with type <code>String -&gt; String</code> and then access it there. But, to do this, first you need either to bound <code>talk</code>&#39;s result to a name and then pass it via argument to function or to use bound operator directly like <code>talk handle &gt;&gt;= \\ s -&gt; ... let r = f s ...</code>. Here, <code>s</code> is <code>talk handle</code>&#39;s result and <code>f</code> is that function with type <code>String -&gt; String</code>."}, {"owner": {"reputation": 1361, "user_id": 2556165, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fGy2y.jpg?s=128&g=1", "display_name": "wowofbob", "link": "https://stackoverflow.com/users/2556165/wowofbob"}, "reply_to_user": {"reputation": 3, "user_id": 4686054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd5bb2ab2cb7d72791b5dc77536db28?s=128&d=identicon&r=PG&f=1", "display_name": "haskellstuff", "link": "https://stackoverflow.com/users/4686054/haskellstuff"}, "edited": false, "score": 0, "creation_date": 1427056081, "post_id": 29131055, "comment_id": 46611284, "body": "@haskellstuff you can&#39;t just access result of <code>talk</code> because it is inside of <code>IO</code> monad. I edited question to refer to good resources about monads."}], "tags": [], "owner": {"reputation": 1361, "user_id": 2556165, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fGy2y.jpg?s=128&g=1", "display_name": "wowofbob", "link": "https://stackoverflow.com/users/2556165/wowofbob"}, "is_accepted": true, "score": 0, "last_activity_date": 1427056052, "last_edit_date": 1592644375, "creation_date": 1426706925, "answer_id": 29131055, "question_id": 29126399, "link": "https://stackoverflow.com/questions/29126399/haskell-websockets-header/29131055#29131055", "title": "Haskell websockets header", "body": "<p>Return type of <code>talk handle</code> is <code>(MonadIO m =&gt; m String)</code>.</p>\n<p><code>putStrLn</code> has type <code>String -&gt; IO ()</code> or <code>[Char] -&gt; IO ()</code>.</p>\n<p><code>[]</code> is a monad.</p>\n<p><code>putStrLn</code> expects a list of chars, but it gets a value of <code>(MonadIO m =&gt; m String)</code>.</p>\n<p><code>m</code> becomes a list, and <code>putStrLn</code> gets a value of type <code>[String]</code> and this is error.</p>\n<hr />\n<p>As @Zeta suggests, use <code>talk handle &gt;&gt;= putStrLn</code> instead:</p>\n<p><code>&gt;&gt;=</code> is operator which allows to continue computation with the result from another computation. In your case, you can read <code>talk handle &gt;&gt;= putStrLn</code> as follows:</p>\n<pre><code>talk handle -- first compute it\n  &gt;&gt;= putStrLn -- then take string from result of `talk handle` and print it\n</code></pre>\n<p>There won't be any error such was with <code>putStrLn $ talk handle</code>:</p>\n<pre><code>(&gt;&gt;=)                        :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b\ntalk handle                  :: MonadIO m =&gt; m String\n(&gt;&gt;=) (talk handle)          :: MonadIO m =&gt; (String -&gt; m b) -&gt; m b  \nputStrLn                     :: String -&gt; IO ()\n(&gt;&gt;=) (talk handle) putStrLn :: IO () -- `m` becomes `IO`    \n</code></pre>\n<hr />\n<h3>Edited:</h3>\n<p>Here you can find introduction to <code>IO</code> monad: <a href=\"http://learnyouahaskell.com/input-and-output\" rel=\"nofollow noreferrer\">LYHFGG, Input and Output</a></p>\n<p>Here you can find introduction to monads in general: <a href=\"http://learnyouahaskell.com/a-fistful-of-monads#getting-our-feet-wet-with-maybe\" rel=\"nofollow noreferrer\">LYHFGG, A Fistful of Monads</a>.</p>\n<p>You should know about <code>Functor</code> and <code>Applicative</code> in order to read <code>A Fistful of Monads</code>. You can find it in book's contents anyway.</p>\n"}], "owner": {"reputation": 3, "user_id": 4686054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd5bb2ab2cb7d72791b5dc77536db28?s=128&d=identicon&r=PG&f=1", "display_name": "haskellstuff", "link": "https://stackoverflow.com/users/4686054/haskellstuff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 29131055, "answer_count": 1, "score": -2, "last_activity_date": 1427056052, "creation_date": 1426693297, "question_id": 29126399, "link": "https://stackoverflow.com/questions/29126399/haskell-websockets-header", "title": "Haskell websockets header", "body": "<p>I am trying to read websockets header in haskell.</p>\n\n<p>Current code is as follows</p>\n\n<pre><code>import Network\nimport Network.Socket.Internal\nimport Text.Printf\nimport Control.Monad\nimport Control.Monad.IO.Class\nimport Data.Maybe\nimport Data.List\nimport Data.Digest.Pure.SHA (bytestringDigest, sha1)\nimport Text.Regex\nimport System.IO\n\nport :: Int\nport = 8080\n\nbufferLength :: Int\nbufferLength = 2048\n\nkeyRegex :: String\nkeyRegex = \"Sec-WebSocket-Key: (.+)(\\r)\"\n\nresponse :: String\nresponse = \"HTTP/1.1 101 Web Socket Protocol Handshake\\r\\nUpgrade:     WebSocket\\r\\nConnection: Upgrade\\r\\nsec-websocket-accept:     changethis\\r\\n\\r\\n\"\n\nguidString :: String\nguidString = \"258EAFA5-E914-47DA-95CA-C5AB0DC85B11\"\n\ntalk :: MonadIO m =&gt; Handle -&gt; m String\ntalk handle = do liftIO $ hGetContents handle\n\nmain :: IO()\nmain = withSocketsDo $ do\n  sock &lt;- listenOn (PortNumber (fromIntegral port))\n  printf \"Listening on port %d\\n\" port\n  forever $ do\n    (handle, host, port) &lt;- accept sock\n    printf \"Accepted connection from %s: %s\\n\" host (show port)\n    hSetBuffering handle NoBuffering\n    putStrLn $ talk handle\n</code></pre>\n\n<p>The code throws error</p>\n\n<pre><code>Main.hs:38:16:\n    Couldn't match type `[Char]' with `Char'\n    Expected type: String\n      Actual type: [String]\n    In the return type of a call of `talk'\n    In the second argument of `($)', namely `talk handle'\n    In a stmt of a 'do' block: putStrLn $ talk handle\n</code></pre>\n\n<p>How to print header string? Talk function should get the header string and return it to be printed.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 6, "last_activity_date": 1426692723, "creation_date": 1426692723, "answer_id": 29126175, "question_id": 29126138, "link": "https://stackoverflow.com/questions/29126138/calculate-distance-between-two-points-haskell/29126175#29126175", "title": "calculate distance between two points (Haskell)", "body": "<p>You are making an indendation error, this should work- see how where clause is indented:</p>\n\n<pre><code>distance (x1 , y1) (x2 , y2) = sqrt (x'*x' + y'*y')\n    where\n      x' = x1 - x2\n      y' = y1 - y2\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4425, "favorite_count": 0, "accepted_answer_id": 29126175, "answer_count": 1, "score": 1, "last_activity_date": 1426692723, "creation_date": 1426692630, "question_id": 29126138, "link": "https://stackoverflow.com/questions/29126138/calculate-distance-between-two-points-haskell", "title": "calculate distance between two points (Haskell)", "body": "<p>Given an input of two tupples, i want to be able to calculate the distance between two points using the formula: \ndistance = sqrt ( (x1 - x2) ^ 2 + (y1 - y2) ^2 )</p>\n\n<p>so i want the function call and output to look like this: </p>\n\n<pre><code>-- &gt; distance (5 , 10) (3 , 5)\n-- 5.385...\n</code></pre>\n\n<p>when i try to run my code below, it tells me parse error on input 'where'. Can anyone help me resolve my issue? Here is my code:</p>\n\n<pre><code>distance (x1 , y1) (x2 , y2) = sqrt (x'*x' + y'*y')\nwhere\n    x' = x1 - x2\n    y' = y1 - y2\n</code></pre>\n"}, {"tags": ["haskell", "haskell-lens"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426691787, "post_id": 29125149, "comment_id": 46477700, "body": "I believe <code>lens</code> offers an indexed map, but I&#39;m not sure. I know that if you&#39;re using <code>Data.Sequence</code>, it&#39;s far more efficient to use <code>mapWithIndex (,)</code> than any sort of traversal."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1426691937, "post_id": 29125149, "comment_id": 46477835, "body": "<code>itraverse</code> certainly does what you want.  What difficulty are you having using it?"}, {"owner": {"reputation": 2183, "user_id": 52310, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8729b9952488497d0343e8bd86afe8cb?s=128&d=identicon&r=PG", "display_name": "Alex R", "link": "https://stackoverflow.com/users/52310/alex-r"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1426692892, "post_id": 29125149, "comment_id": 46478549, "body": "@Carl My naive intuition of <code>itraverse (,) &quot;abcd&quot;</code> complains about a lack of a monoid instance for Int. It also looks like using <code>(,)</code> as the first argument gives me the wrong output type, namely <code>(Int, t a)</code> rather than <code>t (Int, a)</code>."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 2, "creation_date": 1426693179, "post_id": 29125149, "comment_id": 46478759, "body": "@AlexR Well, yes. <code>traverse</code> and <code>itraverse</code> work in an <code>Applicative</code> context, which you&#39;re ignoring. Try something like <code>imap f = runIdentity . itraverse (\\i a -&gt; return (f i a))</code>."}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 1, "creation_date": 1426728921, "post_id": 29125149, "comment_id": 46496587, "body": "Dunno about lens, but this is fundamentally the same problem as discussed in <a href=\"http://stackoverflow.com/questions/12658443/how-to-decorate-a-tree-in-haskell/12658639\">&quot;How to decorate a Tree in Haskell&quot;</a>.  <a href=\"http://stackoverflow.com/a/12662925/1094403\">The answer by hammar</a> is the same as <a href=\"http://stackoverflow.com/a/29125450/1094403\">bhelkir&#39;s response to your question</a>."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1426691410, "post_id": 29125450, "comment_id": 46477401, "body": "In an <code>Applicative</code> style, by the way, <code>go a = (\\i -&gt; (i,a)) &lt;$&gt; get &lt;* modify (+1)</code>. May I suggest <code>(Traversable t, Integral n) =&gt; t a -&gt; t (n, a)</code>?"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426692893, "post_id": 29125450, "comment_id": 46478551, "body": "@dfeuer Sure, I was just being lazy.  You could even relax it further to <code>Num</code> if you really wanted."}, {"owner": {"reputation": 2183, "user_id": 52310, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8729b9952488497d0343e8bd86afe8cb?s=128&d=identicon&r=PG", "display_name": "Alex R", "link": "https://stackoverflow.com/users/52310/alex-r"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426693057, "post_id": 29125450, "comment_id": 46478667, "body": "That&#39;s the solution I&#39;d probably use normally (well, looking at my code, it more closely resembles @dfeuer modification, except using tuple sections and <code>succ</code>. I&#39;m looking for a Lens-specific answer, though, in part to expand my understanding of the package."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2183, "user_id": 52310, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8729b9952488497d0343e8bd86afe8cb?s=128&d=identicon&r=PG", "display_name": "Alex R", "link": "https://stackoverflow.com/users/52310/alex-r"}, "edited": false, "score": 0, "creation_date": 1426693289, "post_id": 29125450, "comment_id": 46478853, "body": "@AlexR, I avoided tuple sections just because they&#39;re not standard; I&#39;d use them too. You&#39;re right that using <code>Enum</code> makes a lot of sense, but <code>Enum</code> is a terrible, horrible, no good, very bad class :-/"}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 6, "last_activity_date": 1426692827, "last_edit_date": 1426692827, "creation_date": 1426690835, "answer_id": 29125450, "question_id": 29125149, "link": "https://stackoverflow.com/questions/29125149/how-would-i-use-lens-in-haskell-to-duplicate-pythons-enumerate/29125450#29125450", "title": "How would I use lens in Haskell to duplicate Python&#39;s enumerate?", "body": "<p>One solution would be to use the <code>State</code> monad with <code>traverse</code>, since it is also <code>Applicative</code>:</p>\n\n<pre><code>enumerate :: (Integral n, Traversable t) =&gt; t a -&gt; t (n, a)\nenumerate t = evalState (traverse go t) 0\n    where\n        go a = do\n            i &lt;- get\n            modify (+1)\n            return (i, a)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1426693413, "post_id": 29126405, "comment_id": 46478960, "body": "Ah, there are more handy things available, like the ones in cchalmer&#39;s answer."}], "tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": false, "score": 3, "last_activity_date": 1426693312, "creation_date": 1426693312, "answer_id": 29126405, "question_id": 29125149, "link": "https://stackoverflow.com/questions/29125149/how-would-i-use-lens-in-haskell-to-duplicate-pythons-enumerate/29126405#29126405", "title": "How would I use lens in Haskell to duplicate Python&#39;s enumerate?", "body": "<p>You're ignoring the <code>Applicative</code> context on <code>itraverse</code>. You need <em>something</em> for it to be working with.  But the something can be boring, like <code>Identity</code>.</p>\n\n<pre><code>imap f = runIdentity . itraverse (\\i a -&gt; return (f i a))\n</code></pre>\n\n<p>And then you get what you're looking for:</p>\n\n<pre><code>&gt; imap (,) [1,2,3]\n[(0,1),(1,2),(2,3)]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2183, "user_id": 52310, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8729b9952488497d0343e8bd86afe8cb?s=128&d=identicon&r=PG", "display_name": "Alex R", "link": "https://stackoverflow.com/users/52310/alex-r"}, "edited": false, "score": 0, "creation_date": 1426693497, "post_id": 29126416, "comment_id": 46479014, "body": "Thank you. That&#39;s what I was looking for."}], "tags": [], "owner": {"reputation": 2846, "user_id": 4347335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7e6f293a134a5defec74e12cae42cc?s=128&d=identicon&r=PG&f=1", "display_name": "cchalmers", "link": "https://stackoverflow.com/users/4347335/cchalmers"}, "is_accepted": true, "score": 8, "last_activity_date": 1426693340, "creation_date": 1426693340, "answer_id": 29126416, "question_id": 29125149, "link": "https://stackoverflow.com/questions/29125149/how-would-i-use-lens-in-haskell-to-duplicate-pythons-enumerate/29126416#29126416", "title": "How would I use lens in Haskell to duplicate Python&#39;s enumerate?", "body": "<p>If you're using a container that is an instance of <code>FunctorWithIndex</code> then you can simply use <code>imap (,)</code>:</p>\n\n<pre><code>&gt; imap (,) \"abc\"\n[(0,'a'),(1,'b'),(2,'c')]\n</code></pre>\n\n<p>But if the index isn't the position this won't work:</p>\n\n<pre><code>&gt; let m = Map.fromList [('a', \"foo\"), ('b', \"bar\"), ('c', \"foobar\")])\n&gt; imap (,) m\nfromList [('a',('a',\"foo\")),('b',('b',\"bar\")),('c',('c',\"foobar\"))]\n</code></pre>\n\n<p>Instead you can use <code>traversed</code>, which is an indexed traversal where the index is the order the elements appear. This can be used for anything that's <code>Traversable</code>. Instead of <code>imap</code> use <code>iover traversed</code> (which is the same as <code>imapOf</code> but that's been deprecated):</p>\n\n<pre><code>&gt; iover traversed (,) \"abc\"\n[(0,'a'),(1,'b'),(2,'c')]\n\n&gt; iover traversed (,) m\nfromList [('a',(0,\"foo\")),('b',(1,\"bar\")),('c',(2,\"foobar\"))]\n</code></pre>\n"}], "owner": {"reputation": 2183, "user_id": 52310, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8729b9952488497d0343e8bd86afe8cb?s=128&d=identicon&r=PG", "display_name": "Alex R", "link": "https://stackoverflow.com/users/52310/alex-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 1, "accepted_answer_id": 29126416, "answer_count": 3, "score": 4, "last_activity_date": 1426693340, "creation_date": 1426690027, "question_id": 29125149, "link": "https://stackoverflow.com/questions/29125149/how-would-i-use-lens-in-haskell-to-duplicate-pythons-enumerate", "title": "How would I use lens in Haskell to duplicate Python&#39;s enumerate?", "body": "<p>Python's <a href=\"https://docs.python.org/2/library/functions.html#enumerate\" rel=\"nofollow\">enumerate</a> on lists can be written as <code>zip [0..]</code>. I looked at Control.Lens.Traversal and Control.Lens.Indexed, but I couldn't figure out how to use lenses to generalize this to any reasonable container (I hesitate to say \"Traversable\").</p>\n\n<p>I'm guessing <code>itraverse</code> or <code>itraverseOf</code> is key.</p>\n"}, {"tags": ["string", "list", "haskell", "recursion", "type-conversion"], "answers": [{"comments": [{"owner": {"reputation": 516, "user_id": 2114784, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/2c1f3ff53b140db2ecc69af62e3125e2?s=128&d=identicon&r=PG", "display_name": "Kheran", "link": "https://stackoverflow.com/users/2114784/kheran"}, "edited": false, "score": 0, "creation_date": 1426687514, "post_id": 29123785, "comment_id": 46474529, "body": "I was struggling with the base condition initially, for the purpose of my question I removed my (incorrect) line. Thanks for clearing this up as well. Your in-depth explanation confirms my own thought process. I did come across digitToInt, but I wasn&#39;t aware of the use of imports in Haskell. Thank you so much, it&#39;s working like a charm!"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1426710200, "post_id": 29123785, "comment_id": 46489655, "body": "<code>retrieveDecimalsFromString = map digitToInt . filter isDigit</code> looks a bit more nice."}], "tags": [], "owner": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "is_accepted": true, "score": 4, "last_activity_date": 1426686659, "last_edit_date": 1426686659, "creation_date": 1426686340, "answer_id": 29123785, "question_id": 29123639, "link": "https://stackoverflow.com/questions/29123639/retrieve-decimal-numbers-from-string-and-put-them-in-an-int-list-recursively/29123785#29123785", "title": "Retrieve decimal numbers from String and put them in an [Int] list recursively", "body": "<ol>\n<li><p>When you use recursion, you should have a base condition. In your code, when the string is empty, what will it do? That is your base condition. So, change the function definition like this</p>\n\n<pre><code>retrieveDecimalsFromString :: String -&gt; [Int]\nretrieveDecimalsFromString \"\" = []\n</code></pre>\n\n<p>The base condition says that, if the input is an empty string, I ll return an empty list.</p></li>\n<li><p>Now, when <code>x</code> is one of the digits, what will <code>x:retrieveDecimalsFromString xs</code> do? It will try to create a list. But the first element, <code>x</code> is a <code>Char</code> and as per the definition of <code>retrieveDecimalsFromString</code>, the return value is <code>[Int]</code>. So, you need to convert the <code>Char</code> to <code>Int</code>, like this</p>\n\n<pre><code>retrieveDecimalsFromString (x:xs)\n    | x `elem` ['0'..'9'] = (digitToInt x):retrieveDecimalsFromString xs\n    | otherwise = retrieveDecimalsFromString xs\n</code></pre></li>\n</ol>\n\n<hr>\n\n<p>In the <code>filter</code> version, you are saying <code>retrieveDecimalsFromString</code> will return <code>[Int]</code> as per the signature, but the result of filtering would be a <code>[Char]</code>. That is why it is not working. You can fix that by changing the type in either of the places like this</p>\n\n<pre><code>retrieveDecimalsFromString :: String -&gt; [Char]\nretrieveDecimalsFromString xs = filter (`elem` ['0'..'9']) xs\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>retrieveDecimalsFromString :: String -&gt; [Int]\nretrieveDecimalsFromString xs = map digitToInt $ filter (`elem` ['0'..'9']) xs\n</code></pre>\n\n<p><strong>Note:</strong> <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Data-Char.html#v:digitToInt\" rel=\"nofollow\"><code>digitToInt</code></a> function is in <code>Data.Char</code>. So you need to import it before using it.</p>\n"}], "owner": {"reputation": 516, "user_id": 2114784, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/2c1f3ff53b140db2ecc69af62e3125e2?s=128&d=identicon&r=PG", "display_name": "Kheran", "link": "https://stackoverflow.com/users/2114784/kheran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 29123785, "answer_count": 1, "score": 1, "last_activity_date": 1426686659, "creation_date": 1426685989, "last_edit_date": 1426686358, "question_id": 29123639, "link": "https://stackoverflow.com/questions/29123639/retrieve-decimal-numbers-from-string-and-put-them-in-an-int-list-recursively", "title": "Retrieve decimal numbers from String and put them in an [Int] list recursively", "body": "<p>I am working through learnyouahaskell chapters and have been experimenting with recursive functions (and guards). I found some exercises, one of which where I am to retrieve the decimal numbers from a String in the form of [Int]. This is what I have so far:</p>\n\n<pre><code>retrieveDecimalsFromString :: String -&gt; [Int]\nretrieveDecimalsFromString (x:xs)\n    | x `elem` ['0'..'9'] = x:retrieveDecimalsFromString xs\n    | otherwise = retrieveDecimalsFromString xs\n</code></pre>\n\n<p>This crashes, which I understand, because I am returning a String rather than [Int]. I can't seem to find a solution for this though. Maybe my approach is wrong. Alternatively (without recursion) I tried:</p>\n\n<pre><code>retrieveDecimalsFromString :: String -&gt; [Int]\nretrieveDecimalsFromString xs = filter (`elem` ['0'..'9']) xs\n</code></pre>\n\n<p>Which leads to the same problem. Can above be done? </p>\n"}, {"tags": ["haskell", "types", "type-signature", "scrap-your-boilerplate"], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1426680655, "post_id": 29121504, "comment_id": 46469841, "body": "\u201cparameterization over <code>c</code> allows all these intermediate types to be different\u201d \u2013 could you elaborate? That doesn&#39;t really make obvious sense."}, {"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1426680805, "post_id": 29121504, "comment_id": 46469944, "body": "@leftaroundabout In <code>gfoldl&#39;</code> all <code>c X</code> occurrences are <code>r</code>, i.e., they all have to be the same type. With <code>c X</code>, I can still have all of them be the same type, such as in <code>Const r X</code> which is isomorphic to <code>r</code>. But I can also have them all be different, such as e.g. in <code>Identity X</code> which is isomorphic to <code>X</code>."}], "tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": true, "score": 15, "last_activity_date": 1426680375, "last_edit_date": 1426680375, "creation_date": 1426680046, "answer_id": 29121504, "question_id": 29119986, "link": "https://stackoverflow.com/questions/29119986/understanding-the-type-signature-of-gfoldl-from-data-data-data/29121504#29121504", "title": "Understanding the type signature of gfoldl from Data.Data.Data", "body": "<p>The idea is that a value of an algebraic datatype in Haskell has the form</p>\n\n<pre><code>C x_1 x_2 ... x_n\n</code></pre>\n\n<p>where <code>C</code> is a constructor and the <code>x_i</code> are the arguments. What</p>\n\n<pre><code>gfoldl app con\n</code></pre>\n\n<p>does is to turn such a value into</p>\n\n<pre><code>con C `app` x_1 `app` x_2 ... `app` x_n\n</code></pre>\n\n<p>thereby turning an <code>a</code> into a <code>c a</code>. Let's assume the type of <code>C</code> is</p>\n\n<pre><code>C :: T_1 -&gt; T_2 -&gt; ... -&gt; T_n -&gt; D\n</code></pre>\n\n<p>then let's look at the types of the intermediate expressions:</p>\n\n<pre><code>con C                                   :: c (T_1 -&gt; T_2 -&gt; ... -&gt; T_n -&gt; D)\ncon C `app` x_1                         :: c (T_2 -&gt; ... -&gt; T_n -&gt; D)\ncon C `app` x_1 `app` x_2               :: c (... -&gt; T_n -&gt; D)\ncon C `app` x_1 `app` x_2 ... `app` x_n :: c D\n</code></pre>\n\n<p>The parameterization over <code>c</code> allows all these intermediate types to be\ndifferent. If we'd use a simple fold such as <code>gfoldl'</code> instead, then all\nthese intermediate types would have to be the same.</p>\n\n<p>The motivation for <code>gfoldl</code> is to be a\nsingle generalization that lets you express the SYB functions <code>gmapQ</code> and <code>gmapT</code> (and a few others). The types of <code>gmapQ</code> and <code>gmapT</code> are:</p>\n\n<pre><code>gmapQ :: Data a =&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u]\ngmapT :: Data a =&gt; (forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a\n</code></pre>\n\n<p>While <code>gmapQ</code> collapses an <code>a</code> into a uniform list of <code>u</code>s and could\nbe expressed using <code>gfoldl'</code>, this wouldn't be possible for <code>gmapT</code>.</p>\n\n<p>However, with <code>gfoldl</code>, we can use <code>c = Identity</code> to enable us to get\nsomething like <code>gmapT</code>, and <code>c = Const</code> to get something like <code>gmapQ</code>.</p>\n\n<p>For more details, you may also want to look at the paper <a href=\"http://www.andres-loeh.de/SYB0.html\" rel=\"noreferrer\">Scrap your boilerplate Reloaded</a> which shows that <code>gfoldl</code> is an ordinary (yet\nhigher-order) fold of a datatype that is called <code>Spine</code> in that paper.</p>\n\n<p>The use of the identity and constant functors to obtain both transforming and\nupdating behaviour from a single underlying representation has some\nsimilarity to how you obtain the lens operations from \"van Laarhoven\" lenses.</p>\n"}], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 528, "favorite_count": 5, "accepted_answer_id": 29121504, "answer_count": 1, "score": 15, "last_activity_date": 1426680375, "creation_date": 1426675704, "question_id": 29119986, "link": "https://stackoverflow.com/questions/29119986/understanding-the-type-signature-of-gfoldl-from-data-data-data", "title": "Understanding the type signature of gfoldl from Data.Data.Data", "body": "<p><a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Data-Data.html#t:Data\"><code>Data</code></a> defines as one of its core functions <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Data-Data.html#v:gfoldl\"><code>gfoldl</code></a>:</p>\n\n<pre><code>gfoldl\n  :: (Data a)\n  =&gt; (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b) \n  -&gt; (forall g. g -&gt; c g)   \n  -&gt; a  \n  -&gt; c a\n</code></pre>\n\n<p>What's the purpose of <code>c</code> and <code>c (d -&gt; b)</code> in it? Why isn't it just a regular fold, something like</p>\n\n<pre><code>gfoldl'\n  :: (Data a)\n  =&gt; (forall d. Data d =&gt; r -&gt; d -&gt; r)\n  -&gt; r\n  -&gt; a  \n  -&gt; r\n</code></pre>\n"}, {"tags": ["haskell", "cabal"], "answers": [{"tags": [], "owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "is_accepted": true, "score": 3, "last_activity_date": 1426671606, "creation_date": 1426671606, "answer_id": 29118554, "question_id": 29118115, "link": "https://stackoverflow.com/questions/29118115/how-can-cabal-use-multiple-cores-while-building-local-add-sourced-dependency/29118554#29118554", "title": "How can cabal use multiple cores while building local add-source&#39;d dependency", "body": "<p>You can pass <code>-j</code> to <code>ghc</code>. For example: <code>cabal install --ghc-options='-j4'</code></p>\n"}], "owner": {"reputation": 2277, "user_id": 540810, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6ac4c55425d6f9d28db9068dbb49e09?s=128&d=identicon&r=PG", "display_name": "Konstantine Rybnikov", "link": "https://stackoverflow.com/users/540810/konstantine-rybnikov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 29118554, "answer_count": 1, "score": 2, "last_activity_date": 1426671606, "creation_date": 1426670524, "question_id": 29118115, "link": "https://stackoverflow.com/questions/29118115/how-can-cabal-use-multiple-cores-while-building-local-add-sourced-dependency", "title": "How can cabal use multiple cores while building local add-source&#39;d dependency", "body": "<p>My project is split through multiple subprojects, which are connected through <code>cabal sandbox add-source</code>. When I build \"main\" project via <code>cabal build -j</code>, cabal uses multiple cores, while if I do <code>cabal install --only-dependencies -j</code>, it would only use single core for each dependency.</p>\n\n<p>This is very inconvenient, and it would be best for sources added with <code>cabal sandbox add-source</code> to also use multiple cores for each package.</p>\n\n<p>Is this possible? Is it implemented, or is there a ticket for this already? I couldn't find anything about this.</p>\n"}, {"tags": ["haskell", "allocation", "ffi"], "answers": [{"comments": [{"owner": {"reputation": 4773, "user_id": 4148211, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/DiKJf.jpg?s=128&g=1", "display_name": "frasertweedale", "link": "https://stackoverflow.com/users/4148211/frasertweedale"}, "edited": false, "score": 0, "creation_date": 1426716330, "post_id": 29117265, "comment_id": 46492851, "body": "That makes sense.  Seems obvious in hindsight!  Cheers."}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": true, "score": 8, "last_activity_date": 1426667689, "creation_date": 1426667689, "answer_id": 29117265, "question_id": 29117096, "link": "https://stackoverflow.com/questions/29117096/is-it-necessary-to-use-io-when-importing-a-foreign-function-that-allocates/29117265#29117265", "title": "Is it necessary to use IO when importing a foreign function that allocates?", "body": "<p>If <code>foo_create</code> returns a value that only depends on the values of <code>x</code> and <code>name</code>, then yes it's fine return value outside <code>IO</code>. As you say, creating new values inside Haskell causes allocation, and they don't need to be in <code>IO</code> because it's impossible to observe the particular memory addresses that get allocated outside of <code>IO</code>, and also impossible to observe <em>whether or not an allocation succeeds</em> (i.e. whether the program is running out of memory) outside of <code>IO</code>.</p>\n\n<p>However, you say \"whether or not it succeeds is also dependent on the real world\". In that case, no, it is an effectful operation which should have a return type in <code>IO</code>. A Haskell function with a type <code>makeFoo :: CInt -&gt; CString -&gt; Maybe Foo</code> says that whether the <code>Maybe Foo</code> is <code>Nothing</code> or <code>Just _</code> must depend <em>only</em> on the values of the <code>CInt</code> and the <code>CString</code>. This is every bit as important as that the value inside the <code>Just</code> only depends on the arguments.</p>\n\n<p>If it's possible to call a function with the same arguments and get different results depending on the state of the real world, then it isn't a function at all, and should be an <code>IO</code> action.</p>\n"}], "owner": {"reputation": 4773, "user_id": 4148211, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/DiKJf.jpg?s=128&g=1", "display_name": "frasertweedale", "link": "https://stackoverflow.com/users/4148211/frasertweedale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 1, "accepted_answer_id": 29117265, "answer_count": 1, "score": 5, "last_activity_date": 1426667689, "creation_date": 1426666992, "question_id": 29117096, "link": "https://stackoverflow.com/questions/29117096/is-it-necessary-to-use-io-when-importing-a-foreign-function-that-allocates", "title": "Is it necessary to use IO when importing a foreign function that allocates?", "body": "<p>In Haskell, when using the FFI to bind to a function that allocates,\nis it appropriate to <em>avoid</em> using <code>IO</code> when the foreign function allocates\nfor and constructs some value, and that value <em>only</em> depends on the function arguments?</p>\n\n<p>Consider the following function:</p>\n\n<pre><code>/**\n * The foo_create contract: if allocation succeeds, the\n * return value points to a value that depends only on 'x'\n * and 'name', otherwise a null pointer is returned.\n */\nfoo_t *foo_create(int x, const char *name);\n</code></pre>\n\n<p>Would it be appropriate to import this function in the following way?</p>\n\n<pre><code>newtype Foo = Foo (Ptr Foo)\n\nforeign import unsafe \"foo.h foo_create\"\nfoo_create :: CInt -&gt; CString -&gt; Ptr Foo\n</code></pre>\n\n<p>This low-level binding function can then be wrapped to provide\na nicer API:</p>\n\n<pre><code>makeFoo :: CInt -&gt; CString -&gt; Maybe Foo\nmakeFoo x s =\n  let\n    ptr = foo_create x s\n  in\n    if ptr == nullPtr\n      then Nothing\n      else Just (Foo ptr)\n</code></pre>\n\n<p>Although the allocation affects the real world, and whether or not it succeeds is also dependent on the real world, the type does model the\npossible outcomes.  Furthermore, even pure functions and data can cause\nthe Haskell runtime to allocate.  So, is it reasonable\nto avoid the <code>IO</code> monad in situations such as these?</p>\n"}, {"tags": ["haskell", "concurrency", "yesod", "scotty"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1426663691, "post_id": 29115424, "comment_id": 46460512, "body": "if you don&#39;t want to use some low-level stuff <a href=\"http://hackage.haskell.org/package/stm-conduit-2.4.0/docs/Data-Conduit-TMChan.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/stm-conduit-2.4.0/docs/&hellip;</a> migth be interesting for you here"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1426674882, "post_id": 29115424, "comment_id": 46466222, "body": "STM&#39;s TVar or TQueue can certainly be used to sync data between the threads."}], "answers": [{"tags": [], "owner": {"reputation": 2001, "user_id": 988361, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9a433a44669c3a5dd72fb9065ec52b81?s=128&d=identicon&r=PG", "display_name": "egdmitry", "link": "https://stackoverflow.com/users/988361/egdmitry"}, "is_accepted": false, "score": 1, "last_activity_date": 1426702127, "creation_date": 1426702127, "answer_id": 29129545, "question_id": 29115424, "link": "https://stackoverflow.com/questions/29115424/how-to-open-a-separate-socket-connection-in-scotty-or-yesod/29129545#29129545", "title": "How to open a separate socket connection in Scotty or Yesod?", "body": "<p>I found the following works surprisingly great. I ended up using STM.TQueue.</p>\n\n<pre><code>listen :: SSL.SSL -&gt; IO ()\nlisten ssl = do\n  lines &lt;- BL.lines `fmap` SSL.lazyRead ssl\n  mapM_ (processLine ssl . show) lines\n\nprocessQueue :: SSL.SSL -&gt; TQueue String -&gt; IO ()\nprocessQueue ssl queue = forever $ do newData &lt;- atomically $ readTQueue queue\n                                      privmsg ssl newData\n\nweb_service :: TQueue String -&gt; IO ()\nweb_service queue = scotty 25000 $ do\n  get \"/\" $ do\n    liftIO $ atomically $ writeTQueue queue \"test passed\"    \n    status ok200\n\nirc_bot :: [AddrInfo] -&gt; TQueue String -&gt; IO ()\nirc_bot addrs queue = do ssl &lt;- connectToServer (head addrs)\n                         forkIO $ listen ssl\n                         processQueue ssl queue\n\nmain = withOpenSSL $ do\n  let hints = defaultHints { addrSocketType = Stream, addrFamily = AF_INET }\n  addrs &lt;- getAddrInfo (Just hints) (Just \"irc.freenode.com\") (Just \"6697\")\n  queue &lt;- atomically newTQueue\n  forkIO $ irc_bot addrs queue\n  web_service queue\n</code></pre>\n"}], "owner": {"reputation": 2001, "user_id": 988361, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9a433a44669c3a5dd72fb9065ec52b81?s=128&d=identicon&r=PG", "display_name": "egdmitry", "link": "https://stackoverflow.com/users/988361/egdmitry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1426702142, "creation_date": 1426659824, "last_edit_date": 1426702142, "question_id": 29115424, "link": "https://stackoverflow.com/questions/29115424/how-to-open-a-separate-socket-connection-in-scotty-or-yesod", "title": "How to open a separate socket connection in Scotty or Yesod?", "body": "<p>I am building an application that has to connect to an IRC network (open a socket) and also host a web app. Some data should be shared between an IRC part and Http part. What's the best way to achieve that kind of concurrency in Haskell? Should <code>Control.Monad.STM</code> be used to implement this? Is this something the web framework should support as well or is it possible to fork before starting Scotty?</p>\n"}, {"tags": ["haskell", "debian", "cabal"], "comments": [{"owner": {"reputation": 1424, "user_id": 756714, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a0c58c5ad07c97f187f3a9241c4d2639?s=128&d=identicon&r=PG", "display_name": "vivian", "link": "https://stackoverflow.com/users/756714/vivian"}, "edited": false, "score": 0, "creation_date": 1426700964, "post_id": 29113911, "comment_id": 46484066, "body": "<a href=\"http://stackoverflow.com/questions/18415328/how-to-install-haskell-on-linux-debian-wheezy/18415472#18415472\" title=\"how to install haskell on linux debian wheezy\">stackoverflow.com/questions/18415328/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "is_accepted": false, "score": 1, "last_activity_date": 1426656301, "creation_date": 1426656301, "answer_id": 29114691, "question_id": 29113911, "link": "https://stackoverflow.com/questions/29113911/installing-haskell-in-debian-wheezy-2015/29114691#29114691", "title": "Installing Haskell in Debian (Wheezy) 2015", "body": "<p>Have you tried <a href=\"https://www.haskell.org/platform/linux.html\" rel=\"nofollow\">Haskell Platform for Linux</a> ?</p>\n\n<p>Using the Generic Linux Binaries, you can get the <a href=\"https://www.haskell.org/platform/download/2014.2.0.0/haskell-platform-2014.2.0.0-unknown-linux-x86_64.tar.gz\" rel=\"nofollow\">2014.2.0.0 version of Haskell</a> instead of the <a href=\"https://packages.debian.org/search?keywords=haskell-platform\" rel=\"nofollow\">2012.2.0.0 community version</a>.</p>\n\n<p>I use the Generic Linux Binaries on Ubuntu 12 and 14 without any problem. It is designed for Deb 7 systems, it should work for you.</p>\n"}, {"tags": [], "owner": {"reputation": 31664, "user_id": 226975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad744cf47bf63187d6b406f8be7cfa3a?s=128&d=identicon&r=PG", "display_name": "Wyzard", "link": "https://stackoverflow.com/users/226975/wyzard"}, "is_accepted": false, "score": 1, "last_activity_date": 1426659327, "creation_date": 1426659327, "answer_id": 29115317, "question_id": 29113911, "link": "https://stackoverflow.com/questions/29113911/installing-haskell-in-debian-wheezy-2015/29115317#29115317", "title": "Installing Haskell in Debian (Wheezy) 2015", "body": "<p>Debian has a <code>haskell-platform</code> package in the main repository, though the version in Wheezy isn't the latest (as is common for a stable release with long-term support).  That's the easiest and most convenient way to install Haskell in Debian, and it's supported e.g. with security updates for the life of the Wheezy release.  Consider using that unless you specifically need a newer version.</p>\n\n<p>Also, note that a new version of Debian (Jessie) is likely to be released in the next few months.  That includes a newer version of the <code>haskell-platform</code> package.</p>\n"}], "owner": {"reputation": 11, "user_id": 3808825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7a2069a94998e6253e17051da71e1f0?s=128&d=identicon&r=PG&f=1", "display_name": "Dru Chabilich", "link": "https://stackoverflow.com/users/3808825/dru-chabilich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1426659327, "creation_date": 1426651245, "last_edit_date": 1426651875, "question_id": 29113911, "link": "https://stackoverflow.com/questions/29113911/installing-haskell-in-debian-wheezy-2015", "title": "Installing Haskell in Debian (Wheezy) 2015", "body": "<p>How do I install the Haskell Platform in Debian?\nunfortunately, <code>deb.haskell.org</code> isn't working.\nIf there is no way to install the platform, then how do I install the most up to date versions of <code>GHC</code> and <code>Cabal</code> with <code>apt-get</code>?</p>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 3369, "user_id": 645703, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/53dff9cde38dd11e5e3f2368a3da1193?s=128&d=identicon&r=PG", "display_name": "Matt Elson", "link": "https://stackoverflow.com/users/645703/matt-elson"}, "edited": false, "score": 0, "creation_date": 1426693906, "post_id": 29115701, "comment_id": 46479295, "body": "I often hear the phrase &quot;reason about&quot; or reasoning\u201c, e.g., &#39;reason about program&#39;. What does that mean?"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 3369, "user_id": 645703, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/53dff9cde38dd11e5e3f2368a3da1193?s=128&d=identicon&r=PG", "display_name": "Matt Elson", "link": "https://stackoverflow.com/users/645703/matt-elson"}, "edited": false, "score": 1, "creation_date": 1426708173, "post_id": 29115701, "comment_id": 46488418, "body": "@MattElson It&#39;s meaning is similar to &quot;thinking&quot;. &quot;Reasoning about this code&quot; means &quot;thinking about this code&quot;, except that it implies a particular focus on wanting to understand how/why it works, or to figure out properties that the code has. I general &quot;reasoning&quot; implies more rigor or productivity than general &quot;thinking&quot;. &quot;Thinking about this code&quot; is less specific, since it includes any thought process I have related to this code. If I say &quot;My reasoning is that ...&quot; I&#39;m about to explain to you my thought process; how I arrived at some conclusion."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 3369, "user_id": 645703, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/53dff9cde38dd11e5e3f2368a3da1193?s=128&d=identicon&r=PG", "display_name": "Matt Elson", "link": "https://stackoverflow.com/users/645703/matt-elson"}, "edited": false, "score": 0, "creation_date": 1426708190, "post_id": 29115701, "comment_id": 46488429, "body": "@MattElson Does that sort of give you a sense of it? If not, that&#39;s probably an excellent question for english.stackexchange.com. :)"}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": true, "score": 10, "last_activity_date": 1426661075, "creation_date": 1426661075, "answer_id": 29115701, "question_id": 29113863, "link": "https://stackoverflow.com/questions/29113863/where-does-the-name-of-equational-reasoning-come-from/29115701#29115701", "title": "Where does the name of Equational Reasoning come from?", "body": "<p>It's actually not really a name, just a description that has become standardised through repeated use. \"Equational reasoning\" is just reasoning that is \"equational\"; i.e it involves <em>equations</em>.</p>\n\n<p>The idea involved is that this series of rewrites:</p>\n\n<pre><code>fmap even . fmap (+1)\nfmap (even . (+1))\nfmap (\\x -&gt; even (x +1))\nfmap odd\n</code></pre>\n\n<p>Involves the same <em>kind</em> of thinking as this series of rewrites:</p>\n\n<pre><code>(x + 1)(x - 1)\nx^2 + x - x - 1\nx^2 - 1\n</code></pre>\n\n<p>In both cases you're using equations like <code>fmap f . fmap g = fmap (f . g)</code> or <code>(a + b)(c + d) = ac + ad + bc + bd</code> that you know hold in general, and using them to transform your terms to ones that are <em>provably</em> equivalent. The <em>equations</em> are the key, which are previously proven to hold (ideally by someone else ;) ).</p>\n"}], "owner": {"reputation": 3369, "user_id": 645703, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/53dff9cde38dd11e5e3f2368a3da1193?s=128&d=identicon&r=PG", "display_name": "Matt Elson", "link": "https://stackoverflow.com/users/645703/matt-elson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 886, "favorite_count": 0, "accepted_answer_id": 29115701, "answer_count": 1, "score": 6, "last_activity_date": 1563612462, "creation_date": 1426650914, "last_edit_date": 1563612462, "question_id": 29113863, "link": "https://stackoverflow.com/questions/29113863/where-does-the-name-of-equational-reasoning-come-from", "title": "Where does the name of Equational Reasoning come from?", "body": "<p>I know <a href=\"https://wiki.haskell.org/Equational_reasoning_examples#Equational_reasoning\" rel=\"nofollow noreferrer\">equational reasoning</a> is that pieces of code can be replaced by others in any context, but am really curious where does the name of \"equational reasoning\" come from? I have googled it but could not find any relevant answer.</p>\n"}, {"tags": ["haskell", "recursion", "tree"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1426650312, "post_id": 29113677, "comment_id": 46456313, "body": "You&#39;ve only accounted for when the <code>[Tree a]</code> is 0 elements or 1 element.  What if I had <code>Node 1 [Leaf 2, Leaf 3]</code>?"}, {"owner": {"reputation": 231, "user_id": 4191647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/kFi8q.jpg?s=128&g=1", "display_name": "Himself12794", "link": "https://stackoverflow.com/users/4191647/himself12794"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1426650533, "post_id": 29113677, "comment_id": 46456354, "body": "I think I found a fix for that, but now it claims that Tree does not exist when I try to use it."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426650659, "post_id": 29113677, "comment_id": 46456380, "body": "<code>Leaf</code> and <code>Node</code> are not actually keywords\u2014they&#39;re data constructors."}, {"owner": {"reputation": 231, "user_id": 4191647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/kFi8q.jpg?s=128&g=1", "display_name": "Himself12794", "link": "https://stackoverflow.com/users/4191647/himself12794"}, "edited": false, "score": 0, "creation_date": 1426650729, "post_id": 29113677, "comment_id": 46456398, "body": "so what does that mean?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426650997, "post_id": 29113677, "comment_id": 46456446, "body": "A keyword is something like <code>let</code>, <code>if</code>, <code>then</code>, etc., that is built into the language syntax. Data constructors are how you build up values in Haskell out of smaller pieces. Pattern matching on data constructors is then how you take the smaller pieces out of the values."}], "answers": [{"comments": [{"owner": {"reputation": 231, "user_id": 4191647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/kFi8q.jpg?s=128&g=1", "display_name": "Himself12794", "link": "https://stackoverflow.com/users/4191647/himself12794"}, "edited": false, "score": 0, "creation_date": 1426651023, "post_id": 29113859, "comment_id": 46456453, "body": "so, what is a possible solution to my problem? I&#39;m having a very hard time understanding it."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 231, "user_id": 4191647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/kFi8q.jpg?s=128&g=1", "display_name": "Himself12794", "link": "https://stackoverflow.com/users/4191647/himself12794"}, "edited": false, "score": 0, "creation_date": 1426651095, "post_id": 29113859, "comment_id": 46456465, "body": "@Himself12794, yes there is a solution to your problem! You will understand it soon. See <a href=\"https://github.com/bitemyapp/learnhaskell\" rel=\"nofollow noreferrer\">learnhaskell</a> for some good resources."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 231, "user_id": 4191647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/kFi8q.jpg?s=128&g=1", "display_name": "Himself12794", "link": "https://stackoverflow.com/users/4191647/himself12794"}, "edited": false, "score": 0, "creation_date": 1426651345, "post_id": 29113859, "comment_id": 46456520, "body": "@Himself12794, just to simplify things a drop, I suggest you start by writing a version to fold lists first, then binary trees, then trees defined by <code>data Tree = Node a [Tree a]</code> (called rose trees), and then finally the weird ones you&#39;re actually dealing with."}, {"owner": {"reputation": 231, "user_id": 4191647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/kFi8q.jpg?s=128&g=1", "display_name": "Himself12794", "link": "https://stackoverflow.com/users/4191647/himself12794"}, "edited": false, "score": 0, "creation_date": 1426651749, "post_id": 29113859, "comment_id": 46456630, "body": "I guess that will have to do for now. I&#39;m just not getting good examples of anything in the class I am currently in."}, {"owner": {"reputation": 231, "user_id": 4191647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/kFi8q.jpg?s=128&g=1", "display_name": "Himself12794", "link": "https://stackoverflow.com/users/4191647/himself12794"}, "edited": false, "score": 0, "creation_date": 1426652035, "post_id": 29113859, "comment_id": 46456681, "body": "I don&#39;t really have the time needed to learn from another source, and I&#39;m not getting anything useful from my course, which is requiring me to solve this."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 231, "user_id": 4191647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/kFi8q.jpg?s=128&g=1", "display_name": "Himself12794", "link": "https://stackoverflow.com/users/4191647/himself12794"}, "edited": false, "score": 0, "creation_date": 1426652156, "post_id": 29113859, "comment_id": 46456706, "body": "@Himself12794, I&#39;m sorry you&#39;re in such a bind. You may want to try the #haskell channel on FreeNode; it&#39;s more conducive to one-on-one interactive help than SO."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1426650887, "creation_date": 1426650887, "answer_id": 29113859, "question_id": 29113677, "link": "https://stackoverflow.com/questions/29113677/haskell-tree-foldt-on-tree-with-variable-members/29113859#29113859", "title": "Haskell Tree foldt on Tree with variable members", "body": "<p>You can get some help from GHC by turning on warnings. The \"big hammer\" is <code>-Wall</code>:</p>\n\n<pre><code>-- At the very top of the file\n{-# OPTIONS_GHC -Wall #-}\n</code></pre>\n\n<p>A less noisy approach will work too:</p>\n\n<pre><code>{-# OPTIONS_GHC -fwarn-incomplete-patterns #-}\n</code></pre>\n\n<p>Either of these will give you an explicit list of the patterns you failed to match, at compile time.</p>\n\n<p>The reason putting <code>Tree</code> in your pattern won't work is that <code>Tree</code> is a <em>type</em> constructor (the sort you make by putting them on the <em>left hand</em> sides of <code>data</code> or <code>newtype</code> declarations). Only <em>data</em> constructors (the sort you make by putting them on the <em>right hand</em> sides of <code>data</code> or <code>newtype</code> declarations) can be matched in patterns.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426710112, "post_id": 29123728, "comment_id": 46489603, "body": "I knew you could get it. You should, however, replace the <code>b</code> with <code>x:xs</code> directly. This whole exercise is a bit peculiar. The more usual fold for this (very peculiar) tree type looks like this: <code>foldTree :: (a -&gt; b) -&gt; (a -&gt; [a] -&gt; b) -&gt; Tree a -&gt; b</code>. Can you write that one?"}, {"owner": {"reputation": 231, "user_id": 4191647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/kFi8q.jpg?s=128&g=1", "display_name": "Himself12794", "link": "https://stackoverflow.com/users/4191647/himself12794"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426813730, "post_id": 29123728, "comment_id": 46536018, "body": "Thanks for the vote of confidence, :) I don&#39;t really have time to delve into that, but it&#39;s good to know I solved one of the more difficult of the bunch."}], "tags": [], "owner": {"reputation": 231, "user_id": 4191647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/kFi8q.jpg?s=128&g=1", "display_name": "Himself12794", "link": "https://stackoverflow.com/users/4191647/himself12794"}, "is_accepted": true, "score": 1, "last_activity_date": 1426686193, "creation_date": 1426686193, "answer_id": 29123728, "question_id": 29113677, "link": "https://stackoverflow.com/questions/29113677/haskell-tree-foldt-on-tree-with-variable-members/29123728#29123728", "title": "Haskell Tree foldt on Tree with variable members", "body": "<p>I have found the answer. After staying up all I night I had a flash of inspiration. Here it is:</p>\n\n<pre><code>module CSC207a4 where\n\ndata Tree a = Leaf a | Node a [ Tree a ] deriving (Show)\n\nfoldt :: (a -&gt; a -&gt; a) -&gt; Tree a -&gt; a\nfoldt _ (Leaf a)    = a\nfoldt _ (Node a []) = a\nfoldt f (Node a b)  = f (foldt f x) (foldt f (Node a xs))\n    where\n        x:xs = b\n</code></pre>\n\n<p>This passes all of the test cases, and answers my question.</p>\n"}], "owner": {"reputation": 231, "user_id": 4191647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/kFi8q.jpg?s=128&g=1", "display_name": "Himself12794", "link": "https://stackoverflow.com/users/4191647/himself12794"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "accepted_answer_id": 29123728, "answer_count": 2, "score": 0, "last_activity_date": 1426707091, "creation_date": 1426649556, "last_edit_date": 1426650380, "question_id": 29113677, "link": "https://stackoverflow.com/questions/29113677/haskell-tree-foldt-on-tree-with-variable-members", "title": "Haskell Tree foldt on Tree with variable members", "body": "<p>I'm trying to create a custom data type Tree. The definition is below:</p>\n\n<blockquote>\n  <p>A tree can be defined as either a leaf (identified by the keyword \"Leaf\") containing a single piece of information (i.e. it is a node with no child), or a node (identified by the keyword \"Node\") with a single piece of the information, plus a list of trees \u2013 each element in the list represent a subtree rooted at the corresponding child. Note that under this definition, a tree can never be empty.\n  That means a tree can either be:</p>\n  \n  <ul>\n  <li>Leaf data; or</li>\n  <li>Node data [data, data, \u2026] -- there can be zero or more tree inside the list</li>\n  </ul>\n</blockquote>\n\n<p>This is my code:</p>\n\n<pre><code>data Tree a = Leaf a | Node a [ Tree a ] deriving (Show)\n\nfoldt :: (a -&gt; a -&gt; a) -&gt; Tree a -&gt; a\nfoldt f (Leaf a)     = a\nfoldt f (Node a [])  = a\nfoldt f (Node a [b]) = f a (foldt f b)\n</code></pre>\n\n<p>It compiles, but when I try to run:</p>\n\n<pre><code>let myTree = Node 'A' [Node 'B' [Leaf 'E', Node 'F' [Leaf 'I', Leaf 'J', Leaf 'K']], Node 'C' [Leaf 'G', Leaf 'H'], Leaf 'D']\nfoldt min myTree\n</code></pre>\n\n<p>Instead of the expected output <code>'A'</code>, I get the below error:</p>\n\n<pre><code>CSC207a4.hs:(6,1)-(8,38): Non-exhaustive patterns in function foldt\n</code></pre>\n\n<p>What part of my function is non-exhaustive, or have I defined the data type incorrectly?</p>\n\n<p><strong>Update:</strong></p>\n\n<p>I may have solved the non-exhaustive pattern, I now have this, but it claims Tree is not defined:</p>\n\n<p>data Tree a = Leaf a | Node a [ Tree a ] deriving (Show)</p>\n\n<pre><code>foldt :: (a -&gt; a -&gt; a) -&gt; Tree a -&gt; a\nfoldt f (Leaf a)     = a\nfoldt f (Node a [])  = a\nfoldt f (Node a [(Tree x)])  = f a (foldt f x)\nfoldt f (Node a [(Tree x):xs]) = f a (foldt f (f x (foldt f xs)))\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1444939265, "post_id": 29113360, "comment_id": 54123833, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/17409260/what-advantage-does-monad-give-us-over-an-applicative\">What advantage does Monad give us over an Applicative?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": false, "score": 46, "last_activity_date": 1426648622, "creation_date": 1426648622, "answer_id": 29113555, "question_id": 29113360, "link": "https://stackoverflow.com/questions/29113360/join-for-applicatives/29113555#29113555", "title": "&#39;join&#39; for Applicatives?", "body": "<p>There is no such function. <code>join</code> is explicitly what <code>Applicative</code> lacks and <code>Monad</code> has.</p>\n"}, {"tags": [], "owner": {"reputation": 136287, "user_id": 65696, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d8da959b2a586b4a147604e6f534a9fe?s=128&d=identicon&r=PG", "display_name": "SingleNegationElimination", "link": "https://stackoverflow.com/users/65696/singlenegationelimination"}, "is_accepted": false, "score": 51, "last_activity_date": 1426714341, "last_edit_date": 1495540462, "creation_date": 1426649869, "answer_id": 29113724, "question_id": 29113360, "link": "https://stackoverflow.com/questions/29113360/join-for-applicatives/29113724#29113724", "title": "&#39;join&#39; for Applicatives?", "body": "<p>To expand a bit on <a href=\"https://stackoverflow.com/questions/29113360#answer-29113555\">Carl's answer</a>, If there was such a thing as <code>join</code>, but for applicatives:</p>\n\n<pre><code>class Applicative f =&gt; ApplicativeWithJoin f where\n    join' :: f (f a) -&gt; f a\n</code></pre>\n\n<p>Then you would automatically have a monad:</p>\n\n<pre><code>instance ApplicativeWithJoin m =&gt; Monad m where\n    return = pure\n    x &gt;&gt;= f = join' (f &lt;$&gt; x)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 8, "last_activity_date": 1426711539, "creation_date": 1426711539, "answer_id": 29132299, "question_id": 29113360, "link": "https://stackoverflow.com/questions/29113360/join-for-applicatives/29132299#29132299", "title": "&#39;join&#39; for Applicatives?", "body": "<p>To expand on SingleNegationElimination's  answer:</p>\n\n<ul>\n<li><code>Applicative</code>'s <code>&lt;*&gt;</code> allows you to combine effects together and their values inside together, or manipulate a value inside using <code>&lt;$&gt;</code>, but you can't make an effect depend on a value of a previous computation.</li>\n<li><code>Monad</code>s, on the other hand, allow an effect to be determined by the result of the previous computation, as witnessed by <code>&gt;&gt;=</code>.</li>\n</ul>\n\n<p>With any <code>Applicative</code> you can first use <code>&lt;$&gt;</code> to convert a value of type <code>a</code> inside <code>f a</code> into some <code>f b</code>, so you'll get <code>f (f b)</code>. But without <code>join</code>, the inner <code>f b</code> is just another value, there is no way how you can combine it with the outer one that is actually executed. Adding <code>join</code> makes it possible, allowing to define the full power of <code>Monad</code>.</p>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1153, "favorite_count": 6, "answer_count": 3, "score": 25, "last_activity_date": 1426753883, "creation_date": 1426647226, "last_edit_date": 1426753883, "question_id": 29113360, "link": "https://stackoverflow.com/questions/29113360/join-for-applicatives", "title": "&#39;join&#39; for Applicatives?", "body": "<p>I'm looking for the following function:</p>\n\n<p><code>Applicative f =&gt; f (f a) -&gt; f a</code></p>\n\n<p><a href=\"https://www.haskell.org/hoogle/?hoogle=applicative+f+%3D%3E+f+%28f+a%29+-%3E+f+a\">Hoogle</a> shows me <code>join</code>:</p>\n\n<pre><code>&gt;:t join\njoin :: Monad m =&gt; m (m a) -&gt; m a\n</code></pre>\n\n<p>Is there a function that matches my desired signature?</p>\n"}, {"tags": ["parsing", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 4, "last_activity_date": 1426657497, "creation_date": 1426657497, "answer_id": 29114917, "question_id": 29113112, "link": "https://stackoverflow.com/questions/29113112/generating-a-parser-given-a-list-of-tokens/29114917#29114917", "title": "Generating a parser given a list of tokens", "body": "<p>Your <code>Token</code>s are instructions in a small little language for date formats <code>[Token]</code>.</p>\n\n<pre><code>import Data.Functor\nimport Text.Parsec\nimport Text.Parsec.String\n\ndata Date = Date Int Int Int deriving (Show)\n\ndata Token = DayNumber | Year | MonthNumber | Literal String\n</code></pre>\n\n<p>In order to interpret this language, we need a type that represents the state of the interpreter. We start off not knowing any of the components of the <code>Date</code> and then discover them as we encounter <code>DayNumber</code>, <code>Year</code>, or <code>MonthNumber</code>. The following <code>DateState</code> represents the state of knowing or not knowing each of the components of the <code>Date</code>.</p>\n\n<pre><code>data DateState = DateState {dayState :: (Maybe Int), monthState :: (Maybe Int), yearState :: (Maybe Int)}\n</code></pre>\n\n<p>We will start interpreting a <code>[Token]</code> with <code>DateState Nothing Nothing Nothing</code>.</p>\n\n<p>Each <code>Token</code> will be converted into a function that reads the <code>DateState</code> and produces a parser that computes the new <code>DateState</code>.</p>\n\n<pre><code>readDateToken :: Token -&gt; DateState -&gt; Parser DateState\nreadDateToken (DayNumber) ds =\n    do\n        day &lt;- pNatural\n        return ds {dayState = Just day}\nreadDateToken (MonthNumber) ds =\n    do\n        month &lt;- pNatural\n        return ds {monthState = Just month}\nreadDateToken (Year) ds =\n    do\n        year &lt;- pNatural\n        return ds {yearState = Just year}\nreadDateToken (Literal l) ds = string l &gt;&gt; return ds\n\npNatural :: Num a =&gt; Parser a\npNatural = fromInteger . read &lt;$&gt; many1 digit\n</code></pre>\n\n<p>To read a date interpreting a <code>[Token]</code> we will first convert it into a list of functions that decide how to parse a new state based on the current state with <code>map readDateToken :: [Token] -&gt; [DateState -&gt; Parser DateState]</code>. Then, starting with a parser that succeeds with the initial state <code>return (DateState Nothing Nothing Nothing)</code> we will bind all of these functions together with <code>&gt;&gt;=</code>. If the resulting <code>DateState</code> doesn't completely define the <code>Date</code> we will complain that the <code>[Token]</code>s was invalid. We also could have checked this ahead of time. If you want to include invalid date errors as parsing errors this would also be the place to check that the <code>Date</code> is valid and doesn't represent a non-existent date like April 31st.</p>\n\n<pre><code>readDate :: [Token] -&gt; Parser Date\nreadDate tokens =\n    do\n        dateState &lt;- foldl (&gt;&gt;=) (return (DateState Nothing Nothing Nothing)) . map readDateToken $ tokens\n        case dateState of \n            DateState (Just day) (Just month) (Just year) -&gt; return (Date day month year)\n            _                                             -&gt; fail \"Date format is incomplete\"\n</code></pre>\n\n<p>We will run a few examples.</p>\n\n<pre><code>runp p s = runParser p () \"runp\" s\n\nmain = do\n    print . runp (readDate [DayNumber,Literal \"-\",MonthNumber,Literal \"-\",Year])                   $ \"12-3-456\"\n    print . runp (readDate [Literal \"~~\", MonthNumber,Literal \"hello\",DayNumber,Literal \" \",Year]) $ \"~~3hello12 456\"\n    print . runp (readDate [DayNumber,Literal \"-\",MonthNumber,Literal \"-\",Year,Literal \"-\",Year])  $ \"12-3-456-789\"\n    print . runp (readDate [DayNumber,Literal \"-\",MonthNumber])                                    $ \"12-3\"\n</code></pre>\n\n<p>This results in the following outputs. Notice that when we asked to read the <code>Year</code> twice, the second of the two years was used in the <code>Date</code>. You can choose a different behavior by modifying the definitions for <code>readDateToken</code> and possibly modifying the <code>DateState</code> type. When the <code>[Token]</code> didn't specify how to read one of the date fields we get the error <code>Date format is incomplete</code> with a slightly incorrect description; this could be improved upon.</p>\n\n<pre><code>Right (Date 12 3 456)\n\nRight (Date 12 3 456)\n\nRight (Date 12 3 789)\n\nLeft \"runp\" (line 1, column 5):\nunexpected end of input\nexpecting digit\nDate format is incomplete\n</code></pre>\n"}], "owner": {"reputation": 1207, "user_id": 2884502, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d817ec525df88f7a149bc9186e1a31f3?s=128&d=identicon&r=PG&f=1", "display_name": "lightandlight", "link": "https://stackoverflow.com/users/2884502/lightandlight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 29114917, "answer_count": 1, "score": 3, "last_activity_date": 1426657497, "creation_date": 1426645331, "last_edit_date": 1592644375, "question_id": 29113112, "link": "https://stackoverflow.com/questions/29113112/generating-a-parser-given-a-list-of-tokens", "title": "Generating a parser given a list of tokens", "body": "<h3>Background</h3>\n<p>I'm trying to implement a date printing and parsing system using Parsec.</p>\n<p>I have successfully implemented a printing function of type</p>\n<p><code>showDate :: String -&gt; Date -&gt; Parser String</code></p>\n<p>It takes parses a formatting string and creates a new string based on the tokens that the formatted string presented.</p>\n<p>For example</p>\n<p><code>showDate &quot;%d-%m-%Y&quot; $ Date 2015 3 17</code></p>\n<p>has the output <code>Right &quot;17-3-2015&quot;</code></p>\n<p>I already wrote a tokenizer to use in the <code>showDate</code> function, so I thought that I could just use the output of that to somehow generate a parser using the function <code>readDate :: [Token] -&gt; Parser Date</code>. My idea quickly came to a halt as I realised I had no idea how to implement this.</p>\n<h3>What I want to accomplish</h3>\n<p>Assume we have the following functions and types (the implementation doesn't matter):</p>\n<pre><code>data Token = DayNumber | Year | MonthNumber | DayOrdinal | Literal String\n\n-- Parses four digits and returns an integer\npYear :: Parser Integer\n\n-- Parses two digits and returns an integer\npMonthNum :: Parser Int\n\n-- Parses two digits and returns an integer\npDayNum :: Parser Int\n\n-- Parses two digits and an ordinal suffix and returns an integer\npDayOrd :: Parser Int\n\n-- Parses a string literal\npLiteral :: String -&gt; Parser String\n</code></pre>\n<p>The parser <code>readDate [DayNumber,Literal &quot;-&quot;,MonthNumber,Literal &quot;-&quot;,Year]</code> should be equivalent to</p>\n<pre><code>do\n     d &lt;- pDayNum\n     pLiteral &quot;-&quot;\n     m &lt;- pMonthNum\n     pLiteral &quot;-&quot;\n     y &lt;- pYear\n     return $ Date y m d\n</code></pre>\n<p>Similarly, the parser <code>readDate [Literal &quot;~~&quot;, MonthNumber,Literal &quot;hello&quot;,DayNumber,Literal &quot; &quot;,Year]</code> should be equivalent to</p>\n<pre><code>do\n     pLiteral &quot;~~&quot;\n     m &lt;- pMonthNum\n     pLiteral &quot;hello&quot;\n     d &lt;- pDayNum\n     pLiteral &quot; &quot;\n     y &lt;- pYear\n     return $ Date y m d\n</code></pre>\n<p>My intuition suggests there's some kind of concat/map/fold using monad bindings that I can use for this, but I have no idea.</p>\n<h3>Questions</h3>\n<p>Is parsec the right tool for this?</p>\n<p>Is my approach convoluted or ineffective?</p>\n<ul>\n<li><p>If not, how do I achieve this functionality?</p>\n</li>\n<li><p>If so, what should I try to do instead?</p>\n</li>\n</ul>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 17641, "user_id": 16800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1de76c4c343fc844135e18da8a80f1?s=128&d=identicon&r=PG", "display_name": "Guvante", "link": "https://stackoverflow.com/users/16800/guvante"}, "edited": false, "score": 0, "creation_date": 1426636230, "post_id": 29111709, "comment_id": 46452680, "body": "Have you considered using <code>where</code> and <code>if</code>?"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 6, "creation_date": 1426636382, "post_id": 29111709, "comment_id": 46452732, "body": "Despite the similarity in syntax, pattern guards simply aren&#39;t monadic, and I don&#39;t know any way to get pattern fall-through to continue after a monadic action. I can think of workarounds using <code>mplus</code> and monad transformers, but they&#39;re going to be <i>more</i> complicated than just biting the bullet and separating out the function."}], "answers": [{"tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": true, "score": 3, "last_activity_date": 1426712309, "creation_date": 1426712309, "answer_id": 29132520, "question_id": 29111709, "link": "https://stackoverflow.com/questions/29111709/using-a-monadic-boolean-value-in-a-guard-patternguard/29132520#29132520", "title": "Using a monadic boolean value in a guard? (PatternGuard)", "body": "<p>What you're asking for is impossible, and for good reasons. Let's say that <code>foo</code> modifies the state, but the condition in the guard doesn't match. How would you deal with this state modification? Patterns are separate from the values, so matching a pattern can't result in altering results.\nYou really need to have the call to <code>foo</code> in the RHS that decides what to do with its output.</p>\n\n<p>In some cases, where the monad is a data type you can match on, you can do things like</p>\n\n<pre><code>foo :: Int -&gt; Maybe Bool\n...\n\nbar :: Either a Int -&gt; MyM Int\nbar (Right n)\n  | Just False &lt;- foo n = ...\n</code></pre>\n\n<p>but only because you can match directly on the value of the monad.</p>\n\n<p>Also in some cases extensions <a href=\"https://downloads.haskell.org/~ghc/7.6.1/docs/html/users_guide/syntax-extns.html#lambda-case\" rel=\"nofollow\">lambda-case and multi-way if-expressions</a> can make your life somewhat easier.</p>\n"}], "owner": {"reputation": 1452, "user_id": 538973, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f2dc3b359948acc418b091aef228d384?s=128&d=identicon&r=PG", "display_name": "RasmusWL", "link": "https://stackoverflow.com/users/538973/rasmuswl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 741, "favorite_count": 0, "accepted_answer_id": 29132520, "answer_count": 1, "score": 4, "last_activity_date": 1426712309, "creation_date": 1426635614, "question_id": 29111709, "link": "https://stackoverflow.com/questions/29111709/using-a-monadic-boolean-value-in-a-guard-patternguard", "title": "Using a monadic boolean value in a guard? (PatternGuard)", "body": "<p>I just found out about the <a href=\"https://wiki.haskell.org/Pattern_guard\" rel=\"nofollow\">PatternGuards</a> language extension, which seems really nice.</p>\n\n<p>I'm in a situation where I want to pattern match a value out, apply a monadic boolean function on that value, and only do something if the result is <code>False</code>. Otherwise I want to execute a default action (that might not be as simple as listed below).</p>\n\n<p>This can be achieved by using an <code>if</code> after doing the pattern matching, but I would rather not duplicate the code for the default action, or move that out in a separate function (ie. keep the fall through behaviour of guards)</p>\n\n<p>Is there a way to do this <em>without</em> the <code>if</code>?</p>\n\n<pre><code>{-# LANGUAGE GeneralizedNewtypeDeriving, PatternGuards #-}\n\nimport Control.Applicative\nimport Control.Monad.State\n\nnewtype MyM a = MyM (StateT Int (Either String) a)\n                deriving ( MonadState Int\n                         , Monad, Applicative, Functor\n                         )\n\n--------------------------------------------------------------------------------\n\nfoo :: Int -&gt; MyM Bool\nfoo = undefined\n\nbar :: Either a Int -&gt; MyM Int\nbar (Right n)\n  | ok &lt;- foo n, ok == False = return 42\nbar _ = return 0\n</code></pre>\n\n<p>The above code gives the error message</p>\n\n<pre><code>Couldn't match expected type \u2018MyM Bool\u2019 with actual type \u2018Bool\u2019\nIn the second argument of \u2018(==)\u2019, namely \u2018False\u2019\nIn the expression: ok == False\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 3, "creation_date": 1426621882, "post_id": 29108338, "comment_id": 46446382, "body": "There are parsing libraries like parsec that can do this sort of thing.  It wouldn&#39;t be very difficult to write a parser for a <code>Film</code>.  Unfortunately you won&#39;t get very far with <code>read</code> here, since the <code>Read</code> instances for the types you have expect literal haskell values, so you&#39;d need a 4-tuple (with parens) in your database file with a string (with quotes), a list of strings (with brackets), an int, then a list of strings (with brackets), all separated by commas, and then you would need the entire contents of the file to be capable of being interpreted as a literal haskell list, etc etc."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1426621915, "post_id": 29108338, "comment_id": 46446406, "body": "In short, <code>read</code> does not make a good parser."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1426623457, "post_id": 29108338, "comment_id": 46447300, "body": "@bheklilr: true, though it would also be quite simple to convert that format <i>to</i> Haskell code, and then parse that with <code>read</code>. Not really elegant of course, but oh well..."}], "answers": [{"comments": [{"owner": {"reputation": 62908, "user_id": 567620, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/g8HIM.jpg?s=128&g=1", "display_name": "ely", "link": "https://stackoverflow.com/users/567620/ely"}, "edited": false, "score": 0, "creation_date": 1426625951, "post_id": 29109469, "comment_id": 46448638, "body": "I like this answer very much. I think in this case, it would be a little more useful to see all this with a qualified import, even for the data and value constructors. Hard enough to understand this if you&#39;re new to Haskell, let alone with needing to constantly jump back and forth from the code to the module source code to see what functions come from where."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 62908, "user_id": 567620, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/g8HIM.jpg?s=128&g=1", "display_name": "ely", "link": "https://stackoverflow.com/users/567620/ely"}, "edited": false, "score": 1, "creation_date": 1426626248, "post_id": 29109469, "comment_id": 46448788, "body": "@Mr.F Better?  I believe I got all the Parsec imports included as explicit imports, hopefully I didn&#39;t miss one."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 4, "last_activity_date": 1426626221, "last_edit_date": 1426626221, "creation_date": 1426625688, "answer_id": 29109469, "question_id": 29108338, "link": "https://stackoverflow.com/questions/29108338/haskell-converting-data-from-file-to-data-type/29109469#29109469", "title": "Haskell: converting data from file to Data type", "body": "<p>This can be accomplished pretty easily with parsec:</p>\n\n<pre><code>import Text.Parsec\n    ( Parsec, ParseError, parse        -- Types and parser\n    , between, noneOf, sepBy, many1    -- Combinators\n    , char, spaces, digit, newline     -- Simple parsers\n    )\n\n-- Parse a string to a string\nstringLit :: Parsec String u String\nstringLit = between (char '\"') (char '\"') $ many1 $ noneOf \"\\\"\\n\"\n\n-- Parse a string to a list of strings\nlistOfStrings :: Parsec String u [String]\nlistOfStrings = stringLit `sepBy` (char ',' &gt;&gt; spaces)\n\n-- Parse a string to an int\nintLit :: Parsec String u Int\nintLit = fmap read $ many1 digit\n-- Or `read &lt;$&gt; many1 digit` with Control.Applicative\n\nfilm :: Parsec String u Film\nfilm = do\n    -- alternatively `title &lt;- stringLit &lt;* newline` with Control.Applicative\n    title &lt;- stringLit\n    newline\n    cast &lt;- listOfStrings\n    newline\n    year &lt;- intLit\n    newline\n    fans &lt;- listOfStrings\n    newline\n    return (title, cast, year, fans)\n-- Alternatively, you can define it all in one go (with Control.Applicative) as\n-- film = (,,,)\n--      &lt;$&gt; stringlit     &lt;* newline\n--      &lt;*&gt; listOfStrings &lt;* newline\n--      &lt;*&gt; intLit        &lt;* newline\n--      &lt;*&gt; listOfStrings &lt;* newline\n-- Which makes it look very much like your actual file\n\nfilms :: Parsec String u [Film]\nfilms = film `sepBy` newline\n</code></pre>\n\n<p>Then you can use it as</p>\n\n<pre><code>loadDB :: FilePath -&gt; IO (Either ParseError [Film])\nloadDB filename = do\n    db &lt;- readFile filename\n    return $ parse films \"films\" db\n\nmain :: IO ()\nmain = do\n    putStr \"What is your name?\"\n    name &lt;- getLine\n    db' &lt;- loadDB \"films.txt\"\n    case db of\n        Left err -&gt; do\n            putStrLn \"Error loading film database:\"\n            print err\n        Right db -&gt; mainLoop db name\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4656504, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/253d2e29a758b74cda85d9e6a8b2c63f?s=128&d=identicon&r=PG&f=1", "display_name": "Dipz", "link": "https://stackoverflow.com/users/4656504/dipz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1426626221, "creation_date": 1426621614, "last_edit_date": 1426621949, "question_id": 29108338, "link": "https://stackoverflow.com/questions/29108338/haskell-converting-data-from-file-to-data-type", "title": "Haskell: converting data from file to Data type", "body": "<p>I am having trouble converting a list of strings from a text file to a data type I have created called <code>Film</code>. I will display the code below:</p>\n\n<p><code>Inside the films.txt</code></p>\n\n<pre><code>\"Casino Royale\" \n\"Daniel Craig\", \"Eva Green\", \"Judi Dench\"\n2006\n\"Garry\", \"Dave\", \"Zoe\", \"Kevin\", \"Emma\"\n\n\"Cowboys &amp; Aliens\"\n\"Harrison Ford\", \"Daniel Craig\", \"Olivia Wilde\"\n2011\n\"Bill\", \"Jo\", \"Garry\", \"Kevin\", \"Olga\", \"Liz\"\n\n\"Catch Me If You Can\"\n\"Leonardo DiCaprio\", \"Tom Hanks\"\n2002\n\"Zoe\", \"Heidi\", \"Jo\", \"Emma\", \"Liz\", \"Sam\", \"Olga\", \"Kevin\", \"Tim\"\n}\n</code></pre>\n\n<p>My Haskell code:</p>\n\n<pre><code>type Title = String\ntype Actor = String\ntype Cast = [Actor]\ntype Year = Int\ntype Fan = String\ntype Fans = [Fan]\n\ntype Film = (Title, Cast, Year, Fans)\n\nmain ::  IO()\nmain = do \n      putStr \"What is your name?: \"\n      name &lt;- getLine\n      firstdatabase &lt;- readFile \"films.txt\"\n      putStr firstdatabase\n      let database = read firstdatabase :: [Film]\n      mainLoop database name\n</code></pre>\n\n<p>Any ideas on what I will have to do?</p>\n"}, {"tags": ["haskell", "quickcheck"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1426616931, "post_id": 29106904, "comment_id": 46443632, "body": "Be aware that <code>div</code> is the name of Prelude function..."}, {"owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1426617061, "post_id": 29106904, "comment_id": 46443700, "body": "Ooops! I made a mistake while editing. In reality it&#39;s <code>ndiv</code> !"}], "answers": [{"tags": [], "owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "is_accepted": true, "score": 3, "last_activity_date": 1426617194, "creation_date": 1426617194, "answer_id": 29107066, "question_id": 29106904, "link": "https://stackoverflow.com/questions/29106904/test-a-function-with-a-list-of-bounded-value-with-quickcheck/29107066#29107066", "title": "Test a function with a list of bounded value with quickCheck", "body": "<p>You need to combine two parts. The first is <a href=\"https://hackage.haskell.org/package/QuickCheck-2.7.6/docs/Test-QuickCheck.html#g:5\" rel=\"nofollow\">generation</a>\u2014you need to write a QuickCheck random generator that outputs numbers in your desired range. Happily, we can do this with a built-in function:</p>\n\n<pre><code>choose :: Random a =&gt; (a, a) -&gt; Gen a\n</code></pre>\n\n<p>Next, we need to specify a property that uses this custom generator. This is where the <a href=\"https://hackage.haskell.org/package/QuickCheck-2.7.6/docs/Test-QuickCheck.html#g:16\" rel=\"nofollow\">property combinators</a> really come in handy. Again, the function we want is the first one in the documentation section:</p>\n\n<pre><code>forAll :: (Show a, Testable prop) =&gt; Gen a -&gt; (a -&gt; prop) -&gt; Property\n</code></pre>\n\n<p>This lets us pass our custom generator in for a function parameter.</p>\n\n<p>Putting all this together, the test case will look something like this:</p>\n\n<pre><code>prop_myTest (x, y, z) = forAll (choose (1, 40)) $ \\ ndiv -&gt; ...\n</code></pre>\n\n<p>The \"<code>prop_</code>\" naming scheme is conventionally used for QuickCheck tests. This will help people quickly understand what's going on in your code and is used by some test frameworks, so it's a good habit to get into now.</p>\n"}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 1, "accepted_answer_id": 29107066, "answer_count": 1, "score": 3, "last_activity_date": 1426617194, "creation_date": 1426616653, "question_id": 29106904, "link": "https://stackoverflow.com/questions/29106904/test-a-function-with-a-list-of-bounded-value-with-quickcheck", "title": "Test a function with a list of bounded value with quickCheck", "body": "<p>I need to test some function with <code>quickCheck</code> do validate these function.</p>\n\n<p>I need to send value in the range <code>1</code> to <code>40</code> to the function but I'm very beginner with <code>quickCheck</code> and it's modificator.</p>\n\n<p>I tried : </p>\n\n<pre><code>myTestFunction (x,y,z) (Positive div) = ....\n</code></pre>\n\n<p>with</p>\n\n<pre><code>quickCheck myTestFunction\n</code></pre>\n\n<p><code>div</code> remain positive but can take very high value (and I don't want)</p>\n\n<p>What is the correct way to give div random value in the range <code>a</code> to <code>b</code> ?</p>\n\n<p>Is it also possible to impose a list of value (non random) to <code>quickCheck</code> ? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1426613364, "post_id": 29105664, "comment_id": 46441493, "body": "You mean check whether every character is a digit? Or whether all possible digits 0-9 appear at least once? Or something else?"}], "answers": [{"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 1, "last_activity_date": 1426614214, "creation_date": 1426614214, "answer_id": 29106115, "question_id": 29105664, "link": "https://stackoverflow.com/questions/29105664/check-if-number-contains-all-digits/29106115#29106115", "title": "Check if number contains all digits", "body": "<p>There's no reason that a list is terribly inefficient for your purpose. You can use a set to keep track of the digits you have seen.</p>\n\n<pre><code>import Data.List \nimport qualified Data.Set as S\n\ndigits = foldr S.insert S.empty . unfoldr go where \n  go 0 = Nothing \n  go n = let (a,b) = n `divMod` 10 in Just (b,a) \n\nhasAll10Digits = (== (S.fromList [0..9])) . digits\n</code></pre>\n\n<p><code>insert</code> for <code>Data.Set</code> is O(log n), but the set you are inserting into will never have more than 10 elements, so these insertions are essentially constant time. </p>\n"}, {"comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1426617352, "post_id": 29106655, "comment_id": 46443880, "body": "An equally fast implementation is <code>import qualified Data.Set as S</code>; <code>hasAll10Digits = any ((== 10) . S.size) . scanl (flip S.insert) S.empty . show</code>.  It just uses the same algorithm with a different intermediate structure to store the result.  This also works with <code>Data.Map</code> in approximately the same amount of time."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1426626996, "post_id": 29106655, "comment_id": 46449191, "body": "@bheklilr, yes, you could do that, but No_signal&#39;s solution can reasonably be expected to run far faster, as long as the lists fuse away properly (which they might in GHC 7.10 but won&#39;t in GHC 7.8). Doing this somewhat by hand seems quite reasonable, swapping out the <code>any</code> and the <code>scanl</code> for a higher-order <code>foldr</code>. Or you could go really by hand and drop the <code>show</code>, which seems likely to help matters anyway. Be sure to exclude the RTS startup time when comparing."}, {"owner": {"reputation": 402, "user_id": 4674225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f4e8f49f5ccc43297b4b185cd3866b?s=128&d=identicon&r=PG&f=1", "display_name": "No_signal", "link": "https://stackoverflow.com/users/4674225/no-signal"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426628046, "post_id": 29106655, "comment_id": 46449661, "body": "@dfeuer, compiled with -O2 they are equal also <code>map digitToInt . show</code> is faster for large numbers then anything i could find"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426628180, "post_id": 29106655, "comment_id": 46449737, "body": "What GHC version? <code>scanl</code> was not very smart about list fusion until 7.10.... Did you try <code>-fllvm</code> to speed up the by-hand conversion? GHC&#39;s native code generator is pretty stupid about division by known divisors\u2014I&#39;m pretty sure it only handles powers of two."}, {"owner": {"reputation": 402, "user_id": 4674225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f4e8f49f5ccc43297b4b185cd3866b?s=128&d=identicon&r=PG&f=1", "display_name": "No_signal", "link": "https://stackoverflow.com/users/4674225/no-signal"}, "edited": false, "score": 0, "creation_date": 1426653505, "post_id": 29106655, "comment_id": 46457062, "body": "when i say large numbers i mean integers. <code>quotRem</code> is faster for <code>Int</code> but you can&#39;t beat show for getting the digits of a large <code>integer</code> even with <code>-fllvm</code>"}], "tags": [], "owner": {"reputation": 402, "user_id": 4674225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f4e8f49f5ccc43297b4b185cd3866b?s=128&d=identicon&r=PG&f=1", "display_name": "No_signal", "link": "https://stackoverflow.com/users/4674225/no-signal"}, "is_accepted": false, "score": 6, "last_activity_date": 1426617378, "last_edit_date": 1495542493, "creation_date": 1426615803, "answer_id": 29106655, "question_id": 29105664, "link": "https://stackoverflow.com/questions/29105664/check-if-number-contains-all-digits/29106655#29106655", "title": "Check if number contains all digits", "body": "<p>I have made much faster solution than <a href=\"https://stackoverflow.com/a/29106115/2541573\">user2407038's</a>.</p>\n\n<pre><code>import Data.Bits\nimport Data.Char\nimport Data.List\n\nhasAll10Digits = any (==1023) . scanl setBit (0::Int) . map digitToInt . show\n</code></pre>\n\n<p>In <code>ghci</code>, it runs hasAll10Digits (12^223451) in just 0.03 seconds.</p>\n\n<p>In comparison, user2407038's code runs in about 11 seconds.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1426632005, "last_edit_date": 1495540247, "creation_date": 1426628898, "answer_id": 29110358, "question_id": 29105664, "link": "https://stackoverflow.com/questions/29105664/check-if-number-contains-all-digits/29110358#29110358", "title": "Check if number contains all digits", "body": "<p>This is based on No_signal's <a href=\"https://stackoverflow.com/a/29106655/1477667\">excellent approach</a>, but makes a few little optimizations to run without allocating any unnecessary structures. To make this fast, compile with <code>-fllvm</code>\u2014GHC's native code generator doesn't do a good job of optimizing division by known divisors.</p>\n\n<pre><code>hasAllDigits :: Int -&gt; Bool\nhasAllDigits = go 0x3FF where\n go !_set 0 = False\n go set n = case (clearBit set r) of\n    0    -&gt; True\n    set' -&gt; go set' q\n   where\n     (q,r) = n `quotRem` 10\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 4142419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/864e365e477de72345e2c14a580ed5b1?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4142419/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 885, "favorite_count": 0, "accepted_answer_id": 29106115, "answer_count": 3, "score": 2, "last_activity_date": 1426632005, "creation_date": 1426612881, "question_id": 29105664, "link": "https://stackoverflow.com/questions/29105664/check-if-number-contains-all-digits", "title": "Check if number contains all digits", "body": "<p>What is the efficient way to check, whether a number contains all digits in Haskell? Modifying lists is terribly inefficient, so keeping a list of number of occurences of each digit is not okay. You could just keep 10 Bool variables in recursion, in which you go through list of digits of your number, but that seems too ugly.</p>\n"}, {"tags": ["haskell", "text"], "answers": [{"tags": [], "owner": {"reputation": 6415, "user_id": 1416525, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6f23f148b7241e345a61d193ed205685?s=128&d=identicon&r=PG", "display_name": "cdk", "link": "https://stackoverflow.com/users/1416525/cdk"}, "is_accepted": true, "score": 6, "last_activity_date": 1426607341, "creation_date": 1426607341, "answer_id": 29103657, "question_id": 29102772, "link": "https://stackoverflow.com/questions/29102772/haskell-should-i-use-data-text-lazy-builder-to-construct-my-text-values/29103657#29103657", "title": "Haskell: should I use Data.Text.Lazy.Builder to construct my Text values?", "body": "<p><code>Data.Text.concat</code> is an <code>O(n+m)</code> operation where <code>n</code> and <code>m</code> are the lengths of the strings you want to <code>concat</code>. This is because a new memory buffer of size <code>n + m</code> must be allocated to store the result of the concatenation.</p>\n\n<p><code>Builder</code> is specifically optimized for the <code>mappend</code> operation. It's a cheap <code>O(1)</code> operation (function composition, which is also excellently optimized by GHC). With <code>Builder</code> you are essentially building up the <em>instructions</em> for how to produce the final string result, but delaying the actual creation until you do some <code>Builder -&gt; Text</code> transformation.</p>\n\n<p>To answer your questions, you should choose <code>Builder</code> if you have profiled your application and discovered that <code>Text.concat</code> are dominating the run time. This will obviously depend on your needs and application. There is no general rule for when you should use <code>Builder</code> but for short <code>Text</code> literals there is probably no need.</p>\n\n<p>Profiling would definitely be worthwhile if using <code>Builder</code> would involve \"undertaking a large-scale refactoring\". Although it goes without saying that Haskell will naturally make this kind of refactoring much less painful than you might be used to with less developer friendly languages, so it might not be such a difficult undertaking after all.</p>\n"}], "owner": {"reputation": 523, "user_id": 1739395, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f6877c2a0e8b24a4b4c9b4700d33846e?s=128&d=identicon&r=PG", "display_name": "the-konapie", "link": "https://stackoverflow.com/users/1739395/the-konapie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 631, "favorite_count": 0, "accepted_answer_id": 29103657, "answer_count": 1, "score": 5, "last_activity_date": 1426607341, "creation_date": 1426605185, "question_id": 29102772, "link": "https://stackoverflow.com/questions/29102772/haskell-should-i-use-data-text-lazy-builder-to-construct-my-text-values", "title": "Haskell: should I use Data.Text.Lazy.Builder to construct my Text values?", "body": "<p>I'm working on a large application that constructs a lot of <code>Data.Text</code> values on the fly. I've been building all my <code>Text</code> values using <code>(&lt;&gt;)</code> and <code>Data.Text.concat</code>.</p>\n\n<p>I only recently learned of the existence of the <a href=\"https://hackage.haskell.org/package/text-0.11.0.5/docs/Data-Text-Lazy-Builder.html\" rel=\"noreferrer\"><code>Builder</code></a> type. The <a href=\"http://www.apress.com/9781430262503\" rel=\"noreferrer\">Beginning Haskell</a> book has this to say about it:</p>\n\n<blockquote>\n  <p>Every time two elements are concatenated, a new <code>Text</code> value has to be created, and this comes with some overhead to allocate memory, to copy data, and also to keep track of the value and release it when it's no longer needed... Both the <code>text</code> and <code>bytestring</code> packages provide a <code>Builder</code> data type that can be used to <strong>efficiently generate large text values</strong>. [pg 240]</p>\n</blockquote>\n\n<p>However, the book doesn't give any indication of exactly what is meant by \"large text values.\"</p>\n\n<p>So, I'm wondering whether or not I should refactor my code to use <code>Builder</code>. Maybe you can help me make that decision.\nSpecifically, I have these questions:</p>\n\n<p>1) Are there any guidelines or \"best practices\" regarding when one should choose <code>Builder</code> over concatenation? Or, how do I know that a given <code>Text</code> value is \"large\" enough that it merits using <code>Builder</code>?</p>\n\n<p>2) Is using <code>Builder</code> a \"no brainer,\" or would it be worthwhile doing some profiling to confirm its benefits before undertaking a large-scale refactoring?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "pointfree"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1426600181, "post_id": 29100665, "comment_id": 46431788, "body": "<i>In ghci I had to change it</i> - show the original code in its original form."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 9, "last_activity_date": 1426600441, "creation_date": 1426600441, "answer_id": 29100892, "question_id": 29100665, "link": "https://stackoverflow.com/questions/29100665/point-free-programming-style-in-haskell-ghci/29100892#29100892", "title": "Point free programming style in haskell (ghci)", "body": "<p>It's just a matter of operator precedence. Your code is being read as</p>\n\n<pre><code>(filter ((== 2) . length))    .     (subsequences [1,2,3])\n</code></pre>\n\n<p>and then GHCi complains that <code>subsequences [1,2,3]</code> is not a function. So, you need parentheses:</p>\n\n<pre><code>(filter ((== 2) . length) . subsequences) [1,2,3]\n</code></pre>\n\n<p>or <code>$</code>:</p>\n\n<pre><code>filter ((== 2) . length) . subsequences $ [1,2,3]\n</code></pre>\n"}], "owner": {"reputation": 4229, "user_id": 327702, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/FEzyr.jpg?s=128&g=1", "display_name": "opensourcegeek", "link": "https://stackoverflow.com/users/327702/opensourcegeek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1426604342, "creation_date": 1426599840, "last_edit_date": 1426604342, "question_id": 29100665, "link": "https://stackoverflow.com/questions/29100665/point-free-programming-style-in-haskell-ghci", "title": "Point free programming style in haskell (ghci)", "body": "<p>I came across a snippet of code for computing combinations in haskell, and I thought I'll play with it in ghci to understand how it works. In ghci when I run just the bit of code that I'm interested in it fails as shown below. </p>\n\n<pre><code>Prelude Data.List&gt; filter ((== 2) . length) . subsequences [1,2,3]\n\n&lt;interactive&gt;:19:1:\n    No instance for (Show ([a0] -&gt; [[a0]]))\n      arising from a use of \u2018print\u2019\n    In a stmt of an interactive GHCi command: print it\nPrelude Data.List&gt; filter ((== 2) . length) . subsequences [1,2,3]\n\n&lt;interactive&gt;:20:28:\n    Couldn't match expected type \u2018a -&gt; [[a1]]\u2019\n                with actual type \u2018[[a0]]\u2019\n    Relevant bindings include\n      it :: a -&gt; [[a1]] (bound at &lt;interactive&gt;:20:1)\n    Possible cause: \u2018subsequences\u2019 is applied to too many arguments\n    In the second argument of \u2018(.)\u2019, namely \u2018subsequences [1, 2, 3]\u2019\n    In the expression:\n      filter ((== 2) . length) . subsequences [1, 2, 3]\n</code></pre>\n\n<p>I knew it had to be because of the composition(dot) operator. In ghci I had to change it to use \"$\" sign to run that code as shown below</p>\n\n<pre><code>Prelude Data.List&gt; filter ((== 2) . length) $ subsequences [1,2,3]\n[[1,2],[1,3],[2,3]]\n</code></pre>\n\n<p>Could someone explain a bit about what is going on internally when you write code in this programming style(pointfree) please? And why ghci fails when I use that expression directly? </p>\n"}, {"tags": ["string", "haskell", "int"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1426597499, "post_id": 29099732, "comment_id": 46429931, "body": "Take a look at the function <code>Data.List.groupBy</code>."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1426597982, "post_id": 29099732, "comment_id": 46430263, "body": "Hint: you can split when alpha and filter not null elements"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 2980791, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f24272a2b999aa5a713fb81613d4eb36?s=128&d=identicon&r=PG&f=1", "display_name": "Harrienak", "link": "https://stackoverflow.com/users/2980791/harrienak"}, "edited": false, "score": 0, "creation_date": 1426602838, "post_id": 29101090, "comment_id": 46433701, "body": "Tnx a lot! I needed the ( map (read::String-&gt;Int) ) part.  solved it like this: getDecimals xs = ((map (read::String-&gt;Int)) ( filter (not . null) (splitOneOf [&#39;A&#39;..&#39;z&#39;] xs) ))  Dont&#39;t know if it is the best way, but it works:)"}, {"owner": {"reputation": 669, "user_id": 3714434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a65866e8ef0ee97ab4cd4c4ffaadc6?s=128&d=identicon&r=PG&f=1", "display_name": "ibotty", "link": "https://stackoverflow.com/users/3714434/ibotty"}, "edited": false, "score": 0, "creation_date": 1426783000, "post_id": 29101090, "comment_id": 46522249, "body": "unconventional parentheses. I think it&#39;s more cleaner without. also beware that your <code>getDecimals</code> is partial."}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 2, "last_activity_date": 1426600918, "creation_date": 1426600918, "answer_id": 29101090, "question_id": 29099732, "link": "https://stackoverflow.com/questions/29099732/haskell-abc123de45-to-123-45/29101090#29101090", "title": "Haskell &quot;abc123de45&quot; to [123,45]", "body": "<p>Here is a (quite long) on-liner to do this:</p>\n\n<pre><code>import Data.List\nimport Data.Char\n\ngetDecimals = ((map (read::String-&gt;Int)).(filter (isNumber.head)).(groupBy (\\a b -&gt; (isNumber a) &amp;&amp; (isNumber b))))\n</code></pre>\n\n<p>Now let's break it down:</p>\n\n<pre><code>(\n    ( map (read::String-&gt;Int) ).    -- Go over the list of numerical strings and read them as Ints\n    ( filter (isNumber.head) ). -- Filter out the strings which are not begining with digit\n    ( groupBy           -- Split the given list based on the following comparison function:\n        (\\a b -&gt; (isNumber a) &amp;&amp; (isNumber b)) -- The comparison function to return true if both arguments are digits\n    ) \n)\n</code></pre>\n\n<p>Since we are using the <code>.</code> function, which is function composition, the functions above are applied in the order bottom to top to the given argument list. I am pretty sure there is more elegant ways to do this, but I can't think of any at this moment.</p>\n"}, {"tags": [], "owner": {"reputation": 402, "user_id": 4674225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f4e8f49f5ccc43297b4b185cd3866b?s=128&d=identicon&r=PG&f=1", "display_name": "No_signal", "link": "https://stackoverflow.com/users/4674225/no-signal"}, "is_accepted": false, "score": 4, "last_activity_date": 1426652744, "last_edit_date": 1426652744, "creation_date": 1426623846, "answer_id": 29109003, "question_id": 29099732, "link": "https://stackoverflow.com/questions/29099732/haskell-abc123de45-to-123-45/29109003#29109003", "title": "Haskell &quot;abc123de45&quot; to [123,45]", "body": "<p>If you are using <code>Data.List.Split</code> you can do this.</p>\n\n<pre><code>import Data.List.Split\nimport Data.Char\n\ngetDecimals :: String -&gt; [Int]\ngetDecimals = map read . wordsBy (not . isDigit) \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 0, "last_activity_date": 1445635404, "last_edit_date": 1445635404, "creation_date": 1426639519, "answer_id": 29112296, "question_id": 29099732, "link": "https://stackoverflow.com/questions/29099732/haskell-abc123de45-to-123-45/29112296#29112296", "title": "Haskell &quot;abc123de45&quot; to [123,45]", "body": "<p>I've never played with <a href=\"https://hackage.haskell.org/package/regex-applicative\" rel=\"nofollow\">regex-applicative</a> before, so I guess I'll give it a go!</p>\n\n<p>NOTE: the cleanest version, but the least interesting, is way down at the bottom.</p>\n\n<p>The first version here is written to use just one regular expression, which means it's not at all lazy (oy!).</p>\n\n<pre><code>import Text.Regex.Applicative\nimport Data.Char\n\nfakeDigitToInt :: Char -&gt; Int\nfakeDigitToInt x = ord x - ord '0'\n\ndigit = fakeDigitToInt &lt;$&gt; psym isDigit\n\naddDigit big small = 10*big+small\n\nnumber = addDigit &lt;$&gt; reFoldl Greedy addDigit 0 digit &lt;*&gt; digit\n\nspacers = many (psym $ not . isDigit)\n\nnumbersInCrud = many (spacers *&gt; number) &lt;* spacers\n\nreadNumbersFromCrud = maybe [] id . match numbersInCrud\n</code></pre>\n\n<p>To make a lazy version, it's necessary to break things up a bit more, using more features of the parsing system. While I'm at it, I'll fix up the types a bit:</p>\n\n<pre><code>import Text.Regex.Applicative\nimport Data.Char\nimport Data.List (unfoldr)\n\nfakeDigitToInt :: Char -&gt; Int\nfakeDigitToInt x = ord x - ord '0'\n\ndigit :: Num n =&gt; RE Char n\ndigit = fromIntegral . fakeDigitToInt &lt;$&gt; psym isDigit\n\naddDigit big small = 10*big+small\n\nnumber :: Num n =&gt; RE Char n\nnumber = addDigit &lt;$&gt; reFoldl Greedy addDigit 0 digit &lt;*&gt; digit\n\nspacers = many (psym $ not . isDigit)\n\npullNumber :: Num n =&gt; String -&gt; Maybe (n, String)\npullNumber = findLongestPrefix (spacers *&gt; number)\n\nreadNumbersFromCrud :: Num n =&gt; String -&gt; [n]\nreadNumbersFromCrud = unfoldr pullNumber\n</code></pre>\n\n<h3>The cleanest version</h3>\n\n<p>This is kind of boring, but it is simple:</p>\n\n<pre><code>import Text.Regex.Applicative\nimport Text.Regex.Applicative.Common\nimport Data.Char\nimport Data.List (unfoldr)\n\nspacers = many (psym $ not . isDigit)\n\npullNumber :: Num n =&gt; String -&gt; Maybe (n, String)\npullNumber = findLongestPrefix (spacers *&gt; decimal)\n\nreadNumbersFromCrud :: Num n =&gt; String -&gt; [n]\nreadNumbersFromCrud = unfoldr pullNumber\n</code></pre>\n\n<p>And because I couldn't resist, here's the (almost) one-liner:</p>\n\n<pre><code>import Text.Regex.Applicative\nimport Text.Regex.Applicative.Common\nimport Data.Char\nimport Data.List (unfoldr)\n\nreadNumbersFromCrud :: Num n =&gt; String -&gt; [n]\nreadNumbersFromCrud = unfoldr . findLongestPrefix $\n  many (psym $ not . isDigit) *&gt; decimal\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 2980791, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f24272a2b999aa5a713fb81613d4eb36?s=128&d=identicon&r=PG&f=1", "display_name": "Harrienak", "link": "https://stackoverflow.com/users/2980791/harrienak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1445635404, "creation_date": 1426597130, "question_id": 29099732, "link": "https://stackoverflow.com/questions/29099732/haskell-abc123de45-to-123-45", "title": "Haskell &quot;abc123de45&quot; to [123,45]", "body": "<p>From a String like \"abc123def45\" i want to get -> [123, 45].</p>\n\n<p>I have the following now:</p>\n\n<pre><code>getDecimals :: String -&gt; [Int]\ngetDecimals xs = [ digitToInt x | x&lt;-xs , isDigit x]\n</code></pre>\n\n<p>Only this method is returning -> [1,2,3,4,5].</p>\n\n<p>How can i do this?</p>\n\n<p>Tnx!</p>\n"}, {"tags": ["list", "haskell", "list-comprehension"], "answers": [{"comments": [{"owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "edited": false, "score": 0, "creation_date": 1426598389, "post_id": 29099970, "comment_id": 46430559, "body": "Makes me wonder whether there are any types with plausible instances for both <code>Integral</code> as well as <code>Float</code>. I noticed something like <code>f x = sqrt (mod x 10)</code> happily typechecks defining a function of type <code>f :: (Floating a, Integral a) =&gt; a -&gt; a</code> -- but I don&#39;t know any type <code>a</code> which would fit the bill. :-}"}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 5, "last_activity_date": 1426597822, "creation_date": 1426597822, "answer_id": 29099970, "question_id": 29099693, "link": "https://stackoverflow.com/questions/29099693/haskell-list-comprehension-print-sqrt-for-element-of-list/29099970#29099970", "title": "Haskell list comprehension (print sqrt for element of list)", "body": "<p>The problem comes from the fact that when you use <code>mod</code>, the type of the numbers must be <code>Integral a =&gt; a</code>, and when you use <code>sqrt</code> the type of the numbers must be <code>Floating a =&gt; a</code>.  There are no types that GHC knows of that fit both of these constraints, although because you're executing it in GHCi the error message for whatever reason is mostly useless.  The error message is like that because GHCi uses <code>print</code>, which calls <code>show</code>, and for some reason that's the first constraint that gets checked.  Since there are no types with the constraints <code>Show</code>, <code>Integral</code>, and <code>Floating</code>, it doesn't type check.</p>\n\n<p>Your other two examples typecheck because they only use one of <code>mod</code> or <code>sqrt</code>.  You can get the combination of the two to work using <code>fromIntegral</code> before applying <code>sqrt</code>:</p>\n\n<pre><code>sum [sqrt $ fromIntegral x | x &lt;- [10..100], x `mod` 10 == 0]\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 4680637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80c75304977bc5ba8916e8bf4eca4ba4?s=128&d=identicon&r=PG&f=1", "display_name": "eDragon55", "link": "https://stackoverflow.com/users/4680637/edragon55"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "accepted_answer_id": 29099970, "answer_count": 1, "score": 4, "last_activity_date": 1426597850, "creation_date": 1426597045, "last_edit_date": 1426597850, "question_id": 29099693, "link": "https://stackoverflow.com/questions/29099693/haskell-list-comprehension-print-sqrt-for-element-of-list", "title": "Haskell list comprehension (print sqrt for element of list)", "body": "<p>I have GHCi, version 7.8.3. I would like calculate the sum of the sqrt items, which are divisible by 10.</p>\n\n<p>If I write <code>[ x | x &lt;- [10..100], x `mod` 10 == 0]</code> or <code>sum [sqrt x | x &lt;- [10..100]]</code> is correct.</p>\n\n<p>But if I write <code>sum [ sqrt x | x &lt;- [10..100], x `mod` 10 == 0]</code> when an error is displayed:</p>\n\n<pre><code>'&lt;interactive&gt;:39:1:\n    No instance for (Show t0) arising from a use of \u2018print\u2019\n    The type variable \u2018t0\u2019 is ambiguous\n    Note: there are several potential instances:\n      instance Show Double -- Defined in \u2018GHC.Float\u2019\n      instance Show Float -- Defined in \u2018GHC.Float\u2019\n      instance (Integral a, Show a) =&gt; Show (GHC.Real.Ratio a)\n        -- Defined in \u2018GHC.Real\u2019\n      ...plus 23 others\n    In a stmt of an interactive GHCi command: print it'\n</code></pre>\n\n<p><strong>How to change the command , the program that was correct ?</strong></p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1426596040, "post_id": 29097095, "comment_id": 46428974, "body": "Lists are a notoriously bad data structure for worrying about duplicates, but it might help you to look at the source for <a href=\"http://hackage.haskell.org/package/base-4.7.0.1/docs/src/Data-List.html#nub\" rel=\"nofollow noreferrer\"><code>Data.List.nub</code></a>, since it performs this operation (albeit relatively slowly)."}], "answers": [{"tags": [], "owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "is_accepted": true, "score": 1, "last_activity_date": 1426595995, "creation_date": 1426595995, "answer_id": 29099329, "question_id": 29097095, "link": "https://stackoverflow.com/questions/29097095/how-can-i-link-these-two-haskell-functions-together/29099329#29099329", "title": "How can I link these two Haskell functions together?", "body": "<p>If the desired effect is to remove duplicates from a list, it might be easier (and result in faster code) to use a <a href=\"https://hackage.haskell.org/package/containers-0.5.6.3/docs/Data-Set.html\" rel=\"nofollow\"><code>Set</code></a>. A set is a data structure that can contain each item only once. So, to remove duplicates in a list, you can simply convert it to a set and back again to a list.</p>\n\n<pre><code>import Data.Set (Set)\nimport qualified Data.Set as Set\nremoveDuplicates :: Ord a =&gt; [a] -&gt; [a]\nremoveDuplicates = Set.toList . Set.fromList\n</code></pre>\n\n<p>Then, <code>createActorList</code> can be defined as</p>\n\n<pre><code>createActorList :: Actor -&gt; [Actor]\ncreateActorList = removeDuplicates . createWholeActorList\n</code></pre>\n\n<p>Or, without <code>createWholeActorList</code></p>\n\n<pre><code>createActorList = removeDuplicates . concat . actorsInFilm\n</code></pre>\n"}], "owner": {"reputation": 1017, "user_id": 4680275, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f39673092287c4f8c2b38e9778e5f4b6?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/4680275/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 29099329, "answer_count": 1, "score": 0, "last_activity_date": 1426595995, "creation_date": 1426589165, "question_id": 29097095, "link": "https://stackoverflow.com/questions/29097095/how-can-i-link-these-two-haskell-functions-together", "title": "How can I link these two Haskell functions together?", "body": "<p>I am trying to remove a certain actor from a list of actors as there are duplicates. I have these functions that do what i want but i need them to link. The two functions that i need to link are <code>createWholeActorList</code> and <code>removeAllActor</code>.</p>\n\n<pre><code>type Actor = String\ntype Actors = [Actor]\n\nshowActors :: Film -&gt; Actors --Outputs a list of the Actors in the film\nshowActors (_,a,_,_) = a\n\nactorsInFilm :: Actor -&gt; [Actors]\nactorsInFilm actor = map showActors (filmsActorIsIn actor)\n\ncreateWholeActorList :: Actor -&gt; Actors\ncreateWholeActorList actor = concat (actorsInFilm actor)\n\nremoveAllActor :: Actor -&gt; Actors -&gt; Actors\nremoveAllActor _ [] = []\nremoveAllActor actor (head:tail)\n    | head == actor = removeAllActor actor tail\n    | head /= actor = head : removeAllActor actor tail\n</code></pre>\n\n<p>If this way is complicated, is there a way of using list comprehension to achieve the desired result?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "is_accepted": false, "score": 0, "last_activity_date": 1426590792, "creation_date": 1426590792, "answer_id": 29097647, "question_id": 29096003, "link": "https://stackoverflow.com/questions/29096003/how-do-pass-and-listen-work-in-writert/29097647#29097647", "title": "How do `pass` and `listen` work in WriterT?", "body": "<p>The documentation is clear enough? <a href=\"http://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Writer-Lazy.html#g:1\" rel=\"nofollow\">http://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Writer-Lazy.html#g:1</a></p>\n\n<p>Examples (run the following in ghci)</p>\n\n<pre><code>import Control.Monad.Writer\n\nrunWriterT ( do (a,w) &lt;- listen $ do { tell \"foo\" ; return 42 } ; tell $ reverse w ; return a )\n\n    ==&gt; (42,\"foooof\")\n\nrunWriterT ( pass $ do { tell \"foo\" ; return (42,reverse) } )\n\n    ==&gt; (42,\"oof\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1435, "user_id": 3792504, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e1e342dc9ed03c2039e7cde0dab4214e?s=128&d=identicon&r=PG&f=1", "display_name": "TheCriticalImperitive", "link": "https://stackoverflow.com/users/3792504/thecriticalimperitive"}, "edited": false, "score": 2, "creation_date": 1426592817, "post_id": 29097660, "comment_id": 46426789, "body": "But where does that <code>w</code> from <code>(a, f w)</code> come from? e.g. with <code>State s</code> the <code>s</code> is threaded around: <code>modify (\\_ -&gt; x) &gt;&gt;= get</code> but there is no equivalent with <code>Writer</code>. So because there&#39;s no original <code>w</code> that gets passed at <code>runRWST</code> does that mean it uses a local <code>mempty</code> for each Monadic computation and then <code>&lt;&gt;</code> them together, instead of threading around the <code>w</code> as happens with <code>State</code>?"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 1435, "user_id": 3792504, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e1e342dc9ed03c2039e7cde0dab4214e?s=128&d=identicon&r=PG&f=1", "display_name": "TheCriticalImperitive", "link": "https://stackoverflow.com/users/3792504/thecriticalimperitive"}, "edited": false, "score": 1, "creation_date": 1426592954, "post_id": 29097660, "comment_id": 46426867, "body": "@TheCriticalImperitive That&#39;s exactly what it has to do; there&#39;s no sensible alternative."}, {"owner": {"reputation": 1435, "user_id": 3792504, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e1e342dc9ed03c2039e7cde0dab4214e?s=128&d=identicon&r=PG&f=1", "display_name": "TheCriticalImperitive", "link": "https://stackoverflow.com/users/3792504/thecriticalimperitive"}, "edited": false, "score": 0, "creation_date": 1426593100, "post_id": 29097660, "comment_id": 46426960, "body": "I suppose it&#39;s pretty obvious now that you&#39;ve explained it to me. Thanks for taking the time to write that out. It just wasn&#39;t clicking for me when I read that documentation, but when it&#39;s spelled out it&#39;s obvious that there&#39;s no alternative."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 1435, "user_id": 3792504, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e1e342dc9ed03c2039e7cde0dab4214e?s=128&d=identicon&r=PG&f=1", "display_name": "TheCriticalImperitive", "link": "https://stackoverflow.com/users/3792504/thecriticalimperitive"}, "edited": false, "score": 0, "creation_date": 1426593144, "post_id": 29097660, "comment_id": 46426992, "body": "<code>WriterT</code> is the wrong tool for logging. I&#39;m writing another answer describing the right tool."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 2, "last_activity_date": 1426591372, "last_edit_date": 1426591372, "creation_date": 1426590822, "answer_id": 29097660, "question_id": 29096003, "link": "https://stackoverflow.com/questions/29096003/how-do-pass-and-listen-work-in-writert/29097660#29097660", "title": "How do `pass` and `listen` work in WriterT?", "body": "<p>We can determine how <code>listen</code> and <code>pass</code> work almost entirely from their types. We'll start with listen.</p>\n\n<h3>listen</h3>\n\n<pre><code>listen :: (Monoid w, Monad m) =&gt; RWST r w s m a -&gt; RWST r w s m (a, w)\n</code></pre>\n\n<p>Unwrapping the <code>RWST</code> we have</p>\n\n<pre><code>listen :: (Monoid w, Monad m) =&gt; (r -&gt; s -&gt; m (a, s, w)) -&gt; r -&gt; s -&gt; m ((a, w), s, w)\n</code></pre>\n\n<p>It needs to return an <code>m ...</code>. The only way we have to make <code>m</code>s is to <code>return</code> something or apply the input function to an <code>r</code>and an <code>s</code> (we can't use <code>&gt;&gt;=</code> since it requires we already have an <code>m</code>). We don't have an <code>a</code> to return so we have to apply the function to an <code>r</code> and <code>s</code>. There's only one <code>r</code> and <code>s</code> we can use, those passed into the result.</p>\n\n<pre><code>listen k r s = ... (k r s) \n</code></pre>\n\n<p>Now we have an <code>m (a, s, w)</code> but need an <code>m ((a, w), s, w)</code>. We can run the action again to get another <code>m</code> (nonsense for \"<code>listen</code>ing\") or do something with the <code>(a, s, w)</code> inside the  <code>m</code> with <code>&gt;&gt;=</code>.</p>\n\n<pre><code>listen k r s = k r s &gt;&gt;= \\(a, s' w) -&gt; ...\n</code></pre>\n\n<p>To use <code>bind</code> we need an <code>m</code>. We can either return something or apply the input function to an <code>r</code> and <code>s</code> and repeat the action again, which is  nonsense for \"<code>listen</code>ing\". We <code>return</code> something.</p>\n\n<pre><code>listen k r s = k r s &gt;&gt;= \\(a, s', w) -&gt; return ...\n</code></pre>\n\n<p>We need an <code>a</code>, a <code>w</code>, an <code>s</code>, and another <code>w</code>. We only have one <code>a</code> and no way to get any others.</p>\n\n<pre><code>listen k r s = k r s &gt;&gt;= \\(a, s', w) -&gt; return ((a,...),...,...)\n</code></pre>\n\n<p>There are 3 ways we can get a <code>w</code>: <code>mempty</code>, the <code>w</code> from the result of the action, or combining two <code>w</code>s together with <code>&lt;&gt;</code>. Returning <code>mempty</code> is pointless; the user could have just used <code>mempty</code> themselves. Duplicating what was logged with <code>&lt;&gt;</code> is as much nonsense as running an action twice, so we <em>return what was logged by the first action</em>.</p>\n\n<pre><code>listen k r s = k r s &gt;&gt;= \\(a, s', w) -&gt; return ((a,w),...,...)\n</code></pre>\n\n<p>We have two <code>s</code> es: <code>s</code> and <code>s'</code>. Reverting the state changes of the action is nonsense for \"<code>listen</code>ing\", so we return the changed state <code>s'</code>.</p>\n\n<pre><code>listen k r s = k r s &gt;&gt;= \\(a, s', w) -&gt; return ((a,w),s',...)\n</code></pre>\n\n<p>Now we are faced with the only interesting choice: what <code>w</code> should we keep for what was logged? The user has \"<code>listen</code>ed\" for what was logged; we could say that it's their problem now and reset the log to <code>mempty</code>. But \"<code>listen</code>ing\" doesn't suggest that it should change what something does, it should only observe it. Therefore, we keep the resulting log <code>w</code> intact.</p>\n\n<pre><code>listen k r s = k r s &gt;&gt;= \\(a, s', w) -&gt; return ((a,w),s',w)\n</code></pre>\n\n<p>If we wrap this in its <code>RWST</code>s again we have </p>\n\n<pre><code>listen m = RWST \\r s -&gt; (runRWST m) r s &gt;&gt;= \\(a, s', w) -&gt; return ((a,w),s',w)\n</code></pre>\n\n<p>All we did was run the input action and include what it logged along with its resulting <code>a</code> in the result as a tuple. This matches the <a href=\"https://hackage.haskell.org/package/transformers-0.4.2.0/docs/Control-Monad-Trans-RWS-Lazy.html#v:listen\" rel=\"nofollow\">documentation for <code>listen</code></a>:</p>\n\n<blockquote>\n  <p><code>listen m</code> is an action that executes the action <code>m</code> and adds its output to the value of the computation.</p>\n\n<pre><code>runRWST (listen m) r s = liftM (\\ (a, w) -&gt; ((a, w), w)) (runRWST m r s)\n</code></pre>\n</blockquote>\n\n<h3>tell</h3>\n\n<pre><code>pass :: (Monoid w, Monad m) =&gt; RWST r w s m (a, w -&gt; w) -&gt; RWST r w s m a\n</code></pre>\n\n<p>We begin as before, unwrapping the <code>RWST</code></p>\n\n<pre><code>pass :: (Monoid w, Monad m) =&gt; (r -&gt; s -&gt; m ((a, w-&gt;w), s, w)) -&gt; r -&gt; s -&gt; m (a, s, w)\n</code></pre>\n\n<p>We follow the same argument for how to get a resulting <code>m</code> as we used for <code>listen</code></p>\n\n<pre><code>pass k r s = ... (k r s)\n</code></pre>\n\n<p>Now we have an <code>m ((a, w-&gt;w), s, w))</code> but need an <code>m (a, s, w)</code>. We can run the action again to get another <code>m</code> (nonsense for \"<code>pass</code>ing\") or do something with the <code>((a, w-&gt;w), s, w)</code> inside the <code>m</code> with <code>&gt;&gt;=</code>.</p>\n\n<pre><code>pass k r s = k r s &gt;&gt;= \\((a, f), s', w) -&gt; ...\n</code></pre>\n\n<p>To use <code>bind</code> we need an <code>m</code>. We can either return something or apply the input function to an <code>r</code> and <code>s</code> and repeat the action again, which is  nonsense for \"<code>pass</code>ing\". We <code>return</code> something.</p>\n\n<pre><code>pass k r s = k r s &gt;&gt;= \\((a, f), s', w) -&gt; return ...\n</code></pre>\n\n<p>We need an <code>a</code>, an <code>s</code>, and a <code>w</code>. We only have one <code>a</code> and no way to get any others.</p>\n\n<pre><code>pass k r s = k r s &gt;&gt;= \\((a, f), s', w) -&gt; return (a,...,...)\n</code></pre>\n\n<p>We have two <code>s</code> es: <code>s</code> and <code>s'</code>. Reverting the state changes of the action is nonsense for \"<code>pass</code>ing\", so we return the changed state <code>s'</code>.</p>\n\n<pre><code>pass k r s = k r s &gt;&gt;= \\((a, f), s', w) -&gt; return (a,s',...)\n</code></pre>\n\n<p>There are 4 ways we can get a <code>w</code>: <code>mempty</code>, the <code>w</code> from the result of the action, combining two <code>w</code>s together with <code>&lt;&gt;</code>, or applying the function <code>f</code> to another <code>w</code>. Setting the result to <code>mempty</code> leaves us wondering why the user provided a function <code>f :: w -&gt; w</code>. themselves. Duplicating what was logged with <code>&lt;&gt;</code> is as much nonsense as running an action twice. We should be applying the function <code>f</code> to something.</p>\n\n<pre><code>pass k r s = k r s &gt;&gt;= \\((a, f), s', w) -&gt; return (a,s',f ...)\n</code></pre>\n\n<p>We could apply <code>f</code> to something built from <code>mempty</code>s and <code>&lt;&gt;</code>, but if that were the case all of the <code>f</code>s would be equivalent to <code>const ...</code>; the type for it might as well have been a <code>w</code>. We could apply <code>f</code> to some elaborate structure built from <code>w</code>, <code>mempty</code>, <code>&lt;&gt;</code>, and <code>f</code>, but all of those structures could have been defined in <code>f</code> itself if we simply <em>pass</em> it <code>w</code>.</p>\n\n<pre><code>pass k r s = k r s &gt;&gt;= \\((a, f), s', w) -&gt; return (a,s',f w)\n</code></pre>\n\n<p>If we wrap this in its <code>RWST</code>s again we have</p>\n\n<pre><code>pass m = RWST \\r s -&gt; (runRWST k) r s &gt;&gt;= \\((a, f), s', w) -&gt; return (a,s',f w)\n</code></pre>\n\n<p>We ran the input action and changed what was logged by the function that was a result of the action. This matches the <a href=\"https://hackage.haskell.org/package/transformers-0.4.2.0/docs/Control-Monad-Trans-RWS-Lazy.html#v:pass\" rel=\"nofollow\">documentation for <code>pass</code></a>:</p>\n\n<blockquote>\n  <p><code>pass m</code> is an action that executes the action <code>m</code>, which returns a value and a function, and returns the value, applying the function to the output.</p>\n\n<pre><code>runRWST (pass m) r s = liftM (\\ ((a, f), w) -&gt; (a, f w)) (runRWST m r s)\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 1, "last_activity_date": 1426599211, "last_edit_date": 1426599211, "creation_date": 1426598879, "answer_id": 29100329, "question_id": 29096003, "link": "https://stackoverflow.com/questions/29096003/how-do-pass-and-listen-work-in-writert/29100329#29100329", "title": "How do `pass` and `listen` work in WriterT?", "body": "<p>The existing <code>WriterT w m</code> can't perform any action in the underlying <code>m</code> to perform logging until after the action has been run and the <code>w</code> has been assembled. As your question illustrates, this is confusing. The log for the <code>do</code> block <code>loopFunction</code> isn't written by <code>logToFile</code> until after the <code>do</code> block itself finishes running.</p>\n\n<h3>LoggerT</h3>\n\n<p>Let's invent a new <code>WriterT</code> called <code>LoggerT</code>. Our new <code>LoggerT</code> is going to provide a new function</p>\n\n<pre><code>logTells :: (Monoid w, Monoid w', Monad m) =&gt;\n            (w -&gt; LoggerT w' m ()) -&gt; LoggerT w m a -&gt; LoggerT w' m a\n</code></pre>\n\n<p>The intuition behind this is: we'll be able to provide an action (with type <code>w -&gt; LoggerT w' m ()</code>) to log every <code>tell</code>, replacing the logged result with the result of the action. If we smash two things the user <code>tell</code>s us together with <code>&lt;&gt;</code> we'll no longer be able to log both of them; we'll only ever be able to log the result of <code>&lt;&gt;</code>. Since our <code>LoggerT</code> will never be able to use <code>&lt;&gt;</code> it will never need the <code>Monoid</code> instances. We must drop the <code>Monoid</code> constraint from everything in <code>LoggerT</code>.</p>\n\n<pre><code>logTells :: (Monad m) =&gt;\n            (w -&gt; LoggerT w' m ()) -&gt; LoggerT w m a -&gt; LoggerT w' m a\n</code></pre>\n\n<p>We need to remember every <code>tell</code> so that we can replace it later. But when we replace it \"later\", the logging should happen at the point the <code>tell</code> appeared in the code. For example, if we make</p>\n\n<pre><code>processX :: LoggerT String m ()\nprocessX = do\n    tell \"Starting process X\"\n    lotsOfProcessing\n    tell \"Finishing process X\"\n</code></pre>\n\n<p>And then \"later\" write <code>logTells logToFile processX</code> we want the resulting computation to look like the following.</p>\n\n<pre><code>logTells logToFile processX = do\n    logToFile \"Starting process X\"\n    lotsOfProcessing\n    logToFile \"Finishing process X\"\n</code></pre>\n\n<p>None of <code>lotsOfProcessing</code> should happen until the <code>logToFile</code> for <code>tell \"Starting process X\"</code> has already happened. This means that when the user <code>tell</code>s us something we need to remember not only what we were told, but everything that happens after that. We \"remember\" things in the constructor for a <code>data</code>.</p>\n\n<pre><code>data LoggerT w m a\n    = Tell w (LoggerT w m a)\n    | ...\n\ntell :: w -&gt; LoggerT w m ()\ntell w = Tell w (return ())\n</code></pre>\n\n<p>We also need to be able to perform actions in the underlying <code>Monad</code>. It would be tempting to add another constructor <code>Lift (m a)</code>, but then we couldn't decide what to log as a result of the underlying computation. Instead, we'll let it decide the entire future <code>LoggerT w m a</code> to run.</p>\n\n<pre><code>data LoggerT w m a\n    = Tell w    (LoggerT w m a)\n    | M      (m (LoggerT w m a))\n    ...\n</code></pre>\n\n<p>If we try to <code>lift</code> an underlying computation <code>m a</code> into <code>LoggerT</code> we now have a problem; we don't have a way to turn the <code>a</code> into a <code>LoggerT w m a</code> to put it in the <code>M</code> constructor.</p>\n\n<pre><code>instance MonadTrans (LoggerT w m) where\n    lift ma = M (??? ma)\n</code></pre>\n\n<p>We could try <code>lift</code>ing <code>return</code> from the underlying <code>Monad</code>, but that's just a circular definition. We'll add another constructor for <code>Return</code>ing.</p>\n\n<pre><code>data LoggerT w m a\n    = Tell   w    (LoggerT w m a)\n    | M        (m (LoggerT w m a))\n    | Return    a\n\ninstance MonadTrans (LoggerT w m) where\n    lift = M . liftM Return\n</code></pre>\n\n<p>To finish our monad transformer, we'll write a <code>Monad</code> instance.</p>\n\n<pre><code>instance Monad m =&gt; Monad (LoggerT w m) where\n    return = Return\n    la0 &gt;&gt;= k = go la0\n         where\n             go (Tell w la ) = Tell w (go la)\n             go (M      mla) = M      (liftM go mla)\n             go (Return a  ) = Return a\n</code></pre>\n\n<p>We can now define <code>logTells</code>. It replaces every <code>Tell</code> with the action to perform to log it.</p>\n\n<pre><code>logTells :: (w -&gt; LoggerT w' m ()) -&gt; LoggerT w m a -&gt; LoggerT w' m a\nlogTells k = go\n    where\n        go (Tell w la ) = k w &gt;&gt; go la\n        go (M      mla) = M      (liftM go mla)\n        go (Return a)   = return a\n</code></pre>\n\n<p>Finally, we'll provide a way to get out of <code>LoggerT</code> by replacing all of the <code>Tell</code>s with an action, very similar to <code>logTells</code> but dropping the <code>LoggerT</code> from the result.\nSince it will get rid of the <code>LoggerT</code> we'll call it <code>runLoggerT</code> and swap the arguments to match the convention of other transformers.</p>\n\n<pre><code>runLoggerT :: LoggerT w m a -&gt; (w -&gt; m ()) -&gt; m a\nrunLoggerT la0 k = go la0\n    where\n        go (Tell w la ) = k w &gt;&gt; go la\n        go (M      mla) =        liftM go mla\n        go (Return a)   =        return a\n</code></pre>\n\n<p><code>LoggerT</code> already exists, we don't need to write it ourself. It's the <a href=\"https://hackage.haskell.org/package/pipes-4.1.4/docs/Pipes-Core.html#t:Producer\" rel=\"nofollow\"><code>Producer</code></a> from the very mature <a href=\"https://hackage.haskell.org/package/pipes\" rel=\"nofollow\">pipes</a> library.</p>\n\n<h3>pipes</h3>\n\n<p>The <code>Producer</code> from the pipes library is the correct logging transformer.</p>\n\n<pre><code>type Producer b = Proxy X () () b\n</code></pre>\n\n<p>Every <a href=\"https://hackage.haskell.org/package/pipes-4.1.4/docs/Pipes.html#t:Proxy\" rel=\"nofollow\"><code>Proxy</code></a> has a <code>MonadTrans (Proxy a' a b' b)</code> instance and a <code>Monad m =&gt; Monad (Proxy a' a b' b m)</code> instance.</p>\n\n<p>We <code>tell</code> it what to log with <a href=\"https://hackage.haskell.org/package/pipes-4.1.4/docs/Pipes.html#v:yield\" rel=\"nofollow\"><code>yield</code></a>.</p>\n\n<pre><code>yield :: Monad m =&gt; a -&gt; Producer' a m ()\n\ntell = yield                             \n</code></pre>\n\n<p>When we know what we want to do with the <code>yield</code>s, we replace them with what we want to do using <a href=\"https://hackage.haskell.org/package/pipes-4.1.4/docs/Pipes.html#v:for\" rel=\"nofollow\"><code>for</code></a>.</p>\n\n<pre><code>for :: Monad m =&gt;\n             Proxy x' x b' b m a' -&gt;\n       (b -&gt; Proxy x' x c' c m b')   \n          -&gt; Proxy x' x c' c m a'\n</code></pre>\n\n<p>Specialized for <code>Producer</code> and <code>()</code>, <code>for</code> has the type</p>\n\n<pre><code>for :: Monad m =&gt; \n             Producer b m a   -&gt;\n       (b -&gt; Producer c m ()) -&gt;\n             Producer c m a\n\nlogTells = flip for\n</code></pre>\n\n<p>If we replace each of the <code>yield</code>s with an action in the underlying monad, we won't have anything produced anymore and can run the <code>Proxy</code> with <a href=\"https://hackage.haskell.org/package/pipes-4.1.4/docs/Pipes.html#v:runEffect\" rel=\"nofollow\"><code>runEffect</code></a>.</p>\n\n<pre><code>runEffect :: Monad m =&gt; Effect             m r -&gt; m r\nrunEffect :: Monad m =&gt; Proxy    X () () X m r -&gt; m r\nrunEffect :: Monad m =&gt; Producer         X m r -&gt; m r\n\nrunLoggerT la0 k = runEffect $ for la0 (lift . k)\n</code></pre>\n\n<p>We can even recover the <code>WriterT</code> with <a href=\"https://hackage.haskell.org/package/mmorph-1.0.4/docs/Control-Monad-Morph.html#t:MFunctor\" rel=\"nofollow\"><code>hoist</code></a> which replaces the underlying monad (every <code>Proxy a' a b' b</code> has an <code>MFunctor</code> instance).</p>\n\n<pre><code>hoist :: (Monad m, MFunctor t) =&gt; (forall a. m a -&gt; n a) -&gt; t m b -&gt; t n b \n</code></pre>\n\n<p>We use <code>hoist</code> to replace the underlying monad with <code>WriterT w m</code> by <code>lift</code>ing each <code>m a</code> into <code>WriterT w m a</code>. Then we replace each <code>yield</code> with <code>lift . tell</code>, and run the result.</p>\n\n<pre><code>toWriterT :: (Monad m, Monoid w) =&gt; Producer w m r -&gt; WriterT w m r\ntoWriterT p0 = runEffect $ for (hoist lift p0) (lift . tell)\n\ntoWriterT p0 = runLoggerT      (hoist lift p0)         tell\n</code></pre>\n\n<p><code>Producer</code> is essentially the free <code>WriterT</code> that doesn't require a <code>Monoid</code> for the items being written.</p>\n"}, {"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 1, "last_activity_date": 1453020676, "creation_date": 1453020676, "answer_id": 34836634, "question_id": 29096003, "link": "https://stackoverflow.com/questions/29096003/how-do-pass-and-listen-work-in-writert/34836634#34836634", "title": "How do `pass` and `listen` work in WriterT?", "body": "<p>Here's a simplified, but definitely real-life example that uses <code>censor</code> (which is defined in terms of <code>pass</code> as </p>\n\n<pre><code>censor :: (MonadWriter w m) =&gt; (w -&gt; w) -&gt; m a -&gt; m a\ncensor f m = pass $ (,f) &lt;$&gt; m\n</code></pre>\n\n<p>) to collect free variables of a lambda term:</p>\n\n<pre><code>import Control.Monad.Writer\nimport Data.Set (Set)\nimport qualified Data.Set as Set\n\ntype VarId = String\n\ndata Term = Var VarId\n          | Lam VarId Term\n          | App Term Term\n\nfreeVars :: Term -&gt; Set VarId\nfreeVars = execWriter . go\n  where\n    go :: Term -&gt; Writer (Set VarId) ()\n    go (Var x) = tell $ Set.singleton x\n    go (App f e) = go f &gt;&gt; go e\n    go (Lam x e) = censor (Set.delete x) $ go e\n</code></pre>\n\n<p>Now, of course you can implement this without all the <code>Writer</code> machinery, but remember this is just a simplified example standing in for some more involved compilation/analysis function, where tracking free variables is just one of the things going on.</p>\n"}], "owner": {"reputation": 1435, "user_id": 3792504, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e1e342dc9ed03c2039e7cde0dab4214e?s=128&d=identicon&r=PG&f=1", "display_name": "TheCriticalImperitive", "link": "https://stackoverflow.com/users/3792504/thecriticalimperitive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 459, "favorite_count": 0, "accepted_answer_id": 29097660, "answer_count": 4, "score": 2, "last_activity_date": 1453020676, "creation_date": 1426586039, "question_id": 29096003, "link": "https://stackoverflow.com/questions/29096003/how-do-pass-and-listen-work-in-writert", "title": "How do `pass` and `listen` work in WriterT?", "body": "<p>The code below probably isn't a good way to do this, but it's what I've managed to cobble together. Basically, I run a series of complex tasks, during which several things get logged. At the end of each one I dump the log into a .txt file and move on to the next batch in a loop.</p>\n\n<p>To achieve this I make use of <code>listen</code> and <code>pass</code> in <code>WriterT</code> (as part of <code>RWST</code>). The code is below:</p>\n\n<pre><code>-- Miscelaneous stuff\nnewtype Log = Log [String]\ntype ConnectT a = EitherT String (RWST ConnectReader Log ConnectState IO) a\n\ntimeStampLog :: String -&gt; Log\ntimeStampLog msg = do\n    theTime &lt;- liftIO $ fmap zonedTimeToLocalTime getZonedTime\n    let msgStart = show theTime ++ \": \"\n    tell $ Log [msgStart ++ msg]\n\nlogToFileIO :: Log -&gt; IO ()\nlogToFileIO (Log xs) = appendFile \"Log.txt\" $ \"\\r\\n\" ++ intercalate \"\\r\\n\" (reverse xs)\n---------------------\n\n\nlogToFile :: ConnectT a -&gt; ConnectT ()\nlogToFile cta = let ctaw = listen cta\n                in  pass $ do\n                                (_,w) &lt;- ctaw\n                                liftIO $ logToFileIO w\n                                return ((),const mempty)\n\nmapFunction :: (Show a) =&gt; a -&gt; ConnectT ()\nmapFunction a = logToFile $ do\n    timeStampLog $ \"Starting sequence for \" ++ show a\n    lotsOfLogging a\n    timeStampLog $ \"Finishing sequence for \" ++ show a\n\nloopFunction :: ConnectT ()\nloopFunction = logToFile $ do\n    timeStampLog \"Starting Loop\"\n    mapM_ mapFunction someList\n    timeStampLog \"Finishing Loop\"\n</code></pre>\n\n<p>What I end up with is something like this:</p>\n\n<pre><code>2015-03-17 20:21:40.8198823: Starting sequence for a\n2015-03-17 20:21:41.8198823: (logs for a)\n2015-03-17 20:21:41.8198823: Finishing sequence for a\n2015-03-17 20:21:41.8198823: Starting sequence for b\n2015-03-17 20:21:42.8198823: (logs for b)\n2015-03-17 20:21:42.8198823: Finishing sequence for b\n2015-03-17 20:21:39.8198823: Starting Loop\n2015-03-17 20:21:42.8198823: Finishing Loop\n</code></pre>\n\n<p>Where the log entry for starting/finishing the loop end up together at the end.</p>\n\n<p>I'm not entirely surprised that the call to <code>logToFile</code> in <code>mapFunction</code> doesn't include the log information from the <code>loopFunction</code> as the information hasn't passed to it via a bind.</p>\n\n<p>But I'm still having trouble understanding how <code>pass</code> and <code>listen</code> work. And also how I would go about fixing this (admittedly minor) issue.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 1, "creation_date": 1426585012, "post_id": 29094645, "comment_id": 46422260, "body": "Actually, <code>!</code> can also appear in datatype declarations, to denote that a constructor function should be strict (to WHNF) in a particular argument. The use in datatype definitions also predates the appearance of &quot;bang patterns&quot;."}, {"owner": {"reputation": 3369, "user_id": 645703, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/53dff9cde38dd11e5e3f2368a3da1193?s=128&d=identicon&r=PG", "display_name": "Matt Elson", "link": "https://stackoverflow.com/users/645703/matt-elson"}, "edited": false, "score": 0, "creation_date": 1426587141, "post_id": 29094645, "comment_id": 46423530, "body": "what is the difference between add !a b=a+b and add $! a b=a+b ? please give some explanations."}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "reply_to_user": {"reputation": 3369, "user_id": 645703, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/53dff9cde38dd11e5e3f2368a3da1193?s=128&d=identicon&r=PG", "display_name": "Matt Elson", "link": "https://stackoverflow.com/users/645703/matt-elson"}, "edited": false, "score": 0, "creation_date": 1426588459, "post_id": 29094645, "comment_id": 46424245, "body": "@MattElson: there is no difference, both are syntax errors. You can do <code>ghci -XBangPatterns</code>, then it will accept <code>let add (!a) b = a + b</code>, but you cannot <code>let add $! a b = a + b</code>."}, {"owner": {"reputation": 3369, "user_id": 645703, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/53dff9cde38dd11e5e3f2368a3da1193?s=128&d=identicon&r=PG", "display_name": "Matt Elson", "link": "https://stackoverflow.com/users/645703/matt-elson"}, "edited": false, "score": 0, "creation_date": 1426600886, "post_id": 29094645, "comment_id": 46432272, "body": "&quot;...then reduce the !-ed binding to weak head normal form before evaluating the right hand side of the pattern&quot;, what is the right hand side of the pattern in the definition of add?  I guess it is the first parameter a."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 3369, "user_id": 645703, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/53dff9cde38dd11e5e3f2368a3da1193?s=128&d=identicon&r=PG", "display_name": "Matt Elson", "link": "https://stackoverflow.com/users/645703/matt-elson"}, "edited": false, "score": 0, "creation_date": 1426601362, "post_id": 29094645, "comment_id": 46432576, "body": "@MattElson by right hand side I mean on the right of &quot;=&quot;, namely &quot;a + b&quot; there"}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 2, "last_activity_date": 1426592325, "last_edit_date": 1426592325, "creation_date": 1426581940, "answer_id": 29094645, "question_id": 29094046, "link": "https://stackoverflow.com/questions/29094046/what-is-the-difference-between-dollar-exclamation-point-and-exclamation-p/29094645#29094645", "title": "What is the difference between $! (dollar exclamation point) and !(exclamation point)", "body": "<p><code>!</code> as enabled by the <code>BangPatterns</code> extension is always in a pattern, before a binding, like this:</p>\n\n<pre><code>add :: Int -&gt; Int -&gt; Int\nadd !a b = a + b\n</code></pre>\n\n<p>It means \"if execution tries to force this pattern case, then reduce the !-ed binding to weak head normal form before evaluating the right hand side of the pattern\"</p>\n\n<p><code>f $! x</code> means \"if execution tries to force this \"f $! x\" expression, then proceed by first reducing \"x\" to weak head normal form, then applying \"f\" to the reduced \"x\" \". </p>\n\n<p>In both cases, note that the strictness annotations only express a <em>conditional</em> statement. If I have a <code>f $! x</code> lying around (where <code>x</code> might be a thunk for a complicated computation), if the execution never tries to force <code>f $! x</code>, then of course nothing of it will be evaluated. </p>\n"}, {"comments": [{"owner": {"reputation": 3369, "user_id": 645703, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/53dff9cde38dd11e5e3f2368a3da1193?s=128&d=identicon&r=PG", "display_name": "Matt Elson", "link": "https://stackoverflow.com/users/645703/matt-elson"}, "edited": false, "score": 0, "creation_date": 1426590606, "post_id": 29096439, "comment_id": 46425548, "body": "If I understand you correctly: ! is a strictness declaration, so the parameter after ! will be evaluated to weak head normal form(WHNF). $! is strict function application, and it will first evaluate the argument to weak head normal form, and then apply the function. If I am wrong please correct me."}], "tags": [], "owner": {"reputation": 1435, "user_id": 3792504, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e1e342dc9ed03c2039e7cde0dab4214e?s=128&d=identicon&r=PG&f=1", "display_name": "TheCriticalImperitive", "link": "https://stackoverflow.com/users/3792504/thecriticalimperitive"}, "is_accepted": true, "score": 1, "last_activity_date": 1426587283, "creation_date": 1426587283, "answer_id": 29096439, "question_id": 29094046, "link": "https://stackoverflow.com/questions/29094046/what-is-the-difference-between-dollar-exclamation-point-and-exclamation-p/29096439#29096439", "title": "What is the difference between $! (dollar exclamation point) and !(exclamation point)", "body": "<p>Something is considered \"strict\" when it would lead to an exception if passed <code>undefined</code>, as in:</p>\n\n<pre><code>&gt; :set -XBangPatterns\n&gt; let foo b x = if b then show x else \"ignore x\"\n&gt; let foo' b !x = if b then show x else \"ignore x\"\n&gt; foo False undefined\n\"ignore x\"\n&gt; foo' False undefined\n\"*** Exception: Prelude.undefined\n</code></pre>\n\n<p>But we can't use <code>!</code> outside of function declarations. So instead we need to use <code>$!</code> as in the example in the link you provided (in this case it is used to replace <code>$</code>):</p>\n\n<pre><code>&gt; const 1 $ undefined\n1\n&gt; const 1 $! undefined\n*** Exception: Prelude.undefined\n</code></pre>\n\n<p>You'll notice also that for <code>!</code> you need to use the BangPatterns language extension but you don't for <code>$!</code>. It's also useful to note that <code>$!</code> is implemented in terms of <code>!</code> (though in a slightly weird way and refers to what I guess must be <a href=\"https://ghc.haskell.org/trac/ghc/ticket/2273\" rel=\"nofollow\">issue #2273</a>).</p>\n\n<p>See the <a href=\"https://hackage.haskell.org/package/base-4.7.0.2/docs/src/Prelude.html#%24%21\" rel=\"nofollow\">$! implementation in Prelude</a>:</p>\n\n<pre><code>($!)    :: (a -&gt; b) -&gt; a -&gt; b\nf $! x  = let !vx = x in f vx  -- see #2273\n</code></pre>\n"}], "owner": {"reputation": 3369, "user_id": 645703, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/53dff9cde38dd11e5e3f2368a3da1193?s=128&d=identicon&r=PG", "display_name": "Matt Elson", "link": "https://stackoverflow.com/users/645703/matt-elson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 29096439, "answer_count": 2, "score": 3, "last_activity_date": 1426592325, "creation_date": 1426579725, "last_edit_date": 1495542498, "question_id": 29094046, "link": "https://stackoverflow.com/questions/29094046/what-is-the-difference-between-dollar-exclamation-point-and-exclamation-p", "title": "What is the difference between $! (dollar exclamation point) and !(exclamation point)", "body": "<p><a href=\"https://stackoverflow.com/a/2787560/645703\">https://stackoverflow.com/a/2787560/645703</a> says:</p>\n\n<blockquote>\n  <p>($!) is strict function application. That is, it evaluates the\n  argument before evaluating the function.</p>\n</blockquote>\n\n<p>I know !(exclamation point) is a strictness declaration in Haskell. It looks like both both have something with strict application, but what is the difference?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 2, "creation_date": 1426578915, "post_id": 29092655, "comment_id": 46419037, "body": "What makes you think <code>y</code> is a function?"}], "answers": [{"tags": [], "owner": {"reputation": 8858, "user_id": 186026, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/q1xfe.png?s=128&g=1", "display_name": "fjarri", "link": "https://stackoverflow.com/users/186026/fjarri"}, "is_accepted": false, "score": 2, "last_activity_date": 1426574058, "creation_date": 1426574058, "answer_id": 29092722, "question_id": 29092655, "link": "https://stackoverflow.com/questions/29092655/haskell-types-integer-integer/29092722#29092722", "title": "Haskell types [Integer-&gt;Integer]", "body": "<p>First, the actual type of <code>y</code> is <code>Num a =&gt; [a -&gt; a]</code>, because integer numbers are polymorphic constants. </p>\n\n<p>Second, <code>y</code> is not a function, it is a list. It does not take any arguments; its elements do. Or, if you want to call it a function, it has 0 arguments and returns a list.</p>\n"}, {"tags": [], "owner": {"reputation": 23343, "user_id": 1730, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07f21e679da438a4fb2935ee8836b9da?s=128&d=identicon&r=PG", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/1730/nicolas"}, "is_accepted": true, "score": 5, "last_activity_date": 1426574094, "creation_date": 1426574094, "answer_id": 29092732, "question_id": 29092655, "link": "https://stackoverflow.com/questions/29092655/haskell-types-integer-integer/29092732#29092732", "title": "Haskell types [Integer-&gt;Integer]", "body": "<p>There isn't any input. <code>y</code> does not expect any parameter, it will only provides a list of function of type <code>Integer -&gt; Integer</code> (or more precisely: <code>Num a =&gt; a -&gt; a</code>).</p>\n\n<p>How can it be useful?</p>\n\n<p>Well, you can use it in many ways, some examples:</p>\n\n<pre><code>&gt;&gt;&gt; let y = [\\a-&gt;a+3, \\b-&gt;1 , \\c-&gt;c*c]\n&gt;&gt;&gt; map (\\f -&gt; f 3) y\n[6,1,9]\n&gt;&gt;&gt; sequence y 4\n[7,1,16]\n&gt;&gt;&gt; head y 10\n13\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 0, "last_activity_date": 1426586528, "creation_date": 1426586528, "answer_id": 29096183, "question_id": 29092655, "link": "https://stackoverflow.com/questions/29092655/haskell-types-integer-integer/29096183#29096183", "title": "Haskell types [Integer-&gt;Integer]", "body": "<p><code>y</code> is not a function, it's a <em>list of</em> functions.</p>\n\n<p>There is no input. It's just a list of functions. You can pick one of these functions up and call it with some input, but as it stands, it's just a bunch of functions that have been put into a list.</p>\n"}], "owner": {"reputation": 17, "user_id": 2929821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd11c251a5d255f2472e54df1df65c42?s=128&d=identicon&r=PG&f=1", "display_name": "user97919", "link": "https://stackoverflow.com/users/2929821/user97919"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 29092732, "answer_count": 3, "score": 0, "last_activity_date": 1426586528, "creation_date": 1426573783, "question_id": 29092655, "link": "https://stackoverflow.com/questions/29092655/haskell-types-integer-integer", "title": "Haskell types [Integer-&gt;Integer]", "body": "<pre><code> y = [\\a-&gt;a+3, \\b-&gt;1 , \\c-&gt;c*c]\n</code></pre>\n\n<p>I recognize function y has type of [Integer->Integer] , implies that it return list of function and each function takes integer then return a integer. However, I have trouble figure out the input of the function , could someone give me an example?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1426572326, "post_id": 29092263, "comment_id": 46416432, "body": "Why do you want it? You can just say <code>putStrLn (show R)</code>."}, {"owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1426575374, "post_id": 29092263, "comment_id": 46417547, "body": "@n.m. <code>show</code> will take the instance of the class in the current scope. In my example I can pass a different instance of Show Color with non-default implementation."}, {"owner": {"reputation": 23343, "user_id": 1730, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07f21e679da438a4fb2935ee8836b9da?s=128&d=identicon&r=PG", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/1730/nicolas"}, "edited": false, "score": 1, "creation_date": 1426575585, "post_id": 29092263, "comment_id": 46417636, "body": "Multiple instances is a bad idea: <a href=\"https://wiki.haskell.org/Multiple_instances\" rel=\"nofollow noreferrer\">wiki.haskell.org/Multiple_instances</a>"}, {"owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "reply_to_user": {"reputation": 23343, "user_id": 1730, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07f21e679da438a4fb2935ee8836b9da?s=128&d=identicon&r=PG", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/1730/nicolas"}, "edited": false, "score": 0, "creation_date": 1426576061, "post_id": 29092263, "comment_id": 46417842, "body": "@Nicolas Looks like a bad design of the language. In Scala I can write as many instances of a typeclass as I want and import only that instance that I need."}, {"owner": {"reputation": 23343, "user_id": 1730, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07f21e679da438a4fb2935ee8836b9da?s=128&d=identicon&r=PG", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/1730/nicolas"}, "edited": false, "score": 0, "creation_date": 1426576163, "post_id": 29092263, "comment_id": 46417876, "body": "No. In the worst case it can be seen as a tradeoff. We use newtypes to differentiate different typeclasses instances."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1426577973, "post_id": 29092263, "comment_id": 46418652, "body": "Haskell is not designed with multiple applicable instances in mind. Instances are here to be implicit, which can only happen if there&#39;s only one of them applicable. If you want to pass functions explicitly, just do that. Allowing instances to be both implicit and explicit depending on whatever would complicate the language design, with little real benefit. It&#39;s a trade-off between simplicity and usefulness."}, {"owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1426578585, "post_id": 29092263, "comment_id": 46418893, "body": "@n.m. I still don&#39;t understand why the question is downvoted. Most of people come to Haskell from OOP languages and expect that instances of classes can be passed as values. So, I don&#39;t think my question is totally stupid."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 5, "creation_date": 1426579144, "post_id": 29092263, "comment_id": 46419145, "body": "I have no idea why it&#39;s downvoted. I don&#39;t think it&#39;s stupid. I have actually upvoted it. For people that are coming from OOP: Haskell classes are not types and have no associated values. They are not the same as OO classes (some sources claim they are &quot;just like&quot; OO classes but this is misleading)."}, {"owner": {"reputation": 1790, "user_id": 3350784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OTuvN.png?s=128&g=1", "display_name": "Yuuri", "link": "https://stackoverflow.com/users/3350784/yuuri"}, "edited": false, "score": 1, "creation_date": 1426605901, "post_id": 29092263, "comment_id": 46436005, "body": "By the way, in Idris language (which is a more or less direct descendant of Haskell) multiple named instances are allowed, with special syntax to choose the needed \u201eoverloading\u201c in method calls."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1426633992, "post_id": 29094601, "comment_id": 46452020, "body": "The biggest reason to allow only one instance is &quot;coherence&quot;. If I build a <code>Map</code> or a <code>HashMap</code> or whatever, and I choose a different <code>Ord</code> or <code>Hashable</code> instance for different operations, it will not be long before I start getting wrong answers and/or weird errors."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426667759, "post_id": 29094601, "comment_id": 46462210, "body": "@dfeuer Agreed. Yet one can specify an <code>Ord</code> instance which violates transitivity and still break <code>Map</code> invariants. Ditto for a functor instance which does not satisfy its laws. Having the ability of overriding the default instance would also remove the need for the <code>...By</code> functions. I have mixed feelings about this design choice: it does bring a coherence advantage, but we do lose some flexibility."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1426612115, "last_edit_date": 1426612115, "creation_date": 1426581832, "answer_id": 29094601, "question_id": 29092263, "link": "https://stackoverflow.com/questions/29092263/why-cannot-instances-of-classes-be-used-as-values/29094601#29094601", "title": "Why cannot instances of classes be used as values?", "body": "<p>It's hard to discuss <em>why</em> a certain feature of the language is as it is, since only the designers of the language can really answer that. What however happened is that they decided that each type can have at most one instance for each class. This is likely to be driven by the fact that instances are meant to be used implicitly. Consider a class</p>\n\n<pre><code>class Foo a where foo :: a -&gt; String\n</code></pre>\n\n<p>and this module</p>\n\n<pre><code>import A  -- defines an instance Foo Int\nbar :: Int -&gt; String\nbar n = \"The number is \" ++ foo n\n</code></pre>\n\n<p>The <code>bar</code> function <em>implicitly</em> refers to module <code>A</code>'s instance. Now suppose we add another import</p>\n\n<pre><code>import A  -- defines an instance Foo Int\nimport B  -- defines another instance Foo Int\nbar :: Int -&gt; String\nbar n = \"The number is \" ++ foo n\n</code></pre>\n\n<p>This is now ambiguous. Haskell might have provided a syntax to disambiguate this, but instead chose to disallow it. One advantage is that whoever reads the code can more easily find the used instances, since there can be only one.</p>\n\n<p>Multiple instances can be partially simulated, though. A GHC extension allows one to define implicit parameters, allowing one to specify a different \"instance\" for those parameters at each function call:</p>\n\n<pre><code>{-# LANGUAGE ImplicitParams #-}\n\ndata Color = R | G | B\n\nshowColor :: (?showC :: Color -&gt; String)  =&gt; Color -&gt; String\nshowColor c = \"The color is: \" ++ ?showC c\n\nmain :: IO ()\nmain = do\n   let ?showC = \\c -&gt; case c of R -&gt; \"Red\" ; _ -&gt; \"Not Red\"\n     in putStrLn (showColor B)\n   let ?showC = \\c -&gt; case c of G -&gt; \"Green\" ; _ -&gt; \"Not Green\"\n     in putStrLn (showColor B)\n</code></pre>\n\n<p>The output of the above is:</p>\n\n<pre><code>The color is: Not Red\nThe color is: Not Green\n</code></pre>\n\n<p>The Agda programming language does not have type classes, but has <a href=\"http://wiki.portal.chalmers.se/agda/pmwiki.php?n=ReferenceManual.InstanceArguments\" rel=\"nofollow\">implicit instances</a> which play a similar role. There, an instance is implicitly passed (as in Haskell) but if desired you can manually override the implicit argument and use a special syntax to specify a different instance.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426634511, "post_id": 29097366, "comment_id": 46452166, "body": "Ummm... not many people use <code>fold</code>, probably, but <code>foldMap</code> is reasonably popular."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 0, "last_activity_date": 1426589964, "creation_date": 1426589964, "answer_id": 29097366, "question_id": 29092263, "link": "https://stackoverflow.com/questions/29092263/why-cannot-instances-of-classes-be-used-as-values/29097366#29097366", "title": "Why cannot instances of classes be used as values?", "body": "<p>In Haskell, type classes are pretty implicit. (For example, you cannot explicitly export or not export a class instance &mdash; which is occasionally annoying.)</p>\n\n<p>The whole <em>point</em> of a type class is that it's a bunch of functions where the correct one gets selected automatically. If you want to be able to pass in a different function each type &mdash; well, just <em>do that!</em></p>\n\n<p>For example, there's a class</p>\n\n<pre><code>class Monoid m where\n  mempty :: m\n  mappend :: m -&gt; m -&gt; m\n</code></pre>\n\n<p>So we could do something like</p>\n\n<pre><code>fold :: Monoid m =&gt; [m] -&gt; m\nfold (  []) = mempty\nfold (x:xs) = x `mappend` fold xs\n</code></pre>\n\n<p>And yet, nobody does that. Instead, they explicitly pass in the parameters:</p>\n\n<pre><code>foldr :: (x -&gt; y -&gt; y) -&gt; y -&gt; [x] -&gt; y\nfoldr f y0 (  []) = y0\nfoldr f y0 (x:xs) = f x (foldr f y0 xs)\n</code></pre>\n\n<p>Because that way, it's much easier to fold the same data-type with multiple different functions / start values.</p>\n\n<p>If you want to be able to \"show\" a value multiple different ways, just pass the show function in as an argument. If you want the function to automatically pick the right show function for the data-type, use the <code>Show</code> class &mdash; but in that case, there can be only <em>one</em> instance (because that's kind of the point).</p>\n"}, {"comments": [{"owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 0, "creation_date": 1426607235, "post_id": 29101228, "comment_id": 46437097, "body": "If you rewrite this code to Java, you will find that it makes sense: <code>Show&lt;Color&gt; showColor = new ShowColor&lt;Color&gt;()</code>"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 0, "creation_date": 1426608806, "post_id": 29101228, "comment_id": 46438378, "body": "Maybe, but that&#39;s an Haskell question not a Java one. Moreover, even in Java, the type <code>Show&lt;Color&gt;</code> is different from the value <code>ShowColor&lt;color&gt;</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426634427, "post_id": 29101228, "comment_id": 46452132, "body": "Constraints are <i>not</i> like <code>Bool</code>! Their logic is constructive, not Boolean!"}], "tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": -1, "last_activity_date": 1426601513, "last_edit_date": 1426601513, "creation_date": 1426601270, "answer_id": 29101228, "question_id": 29092263, "link": "https://stackoverflow.com/questions/29092263/why-cannot-instances-of-classes-be-used-as-values/29101228#29101228", "title": "Why cannot instances of classes be used as values?", "body": "<p>Your question is hard to understand mainly because</p>\n\n<pre><code>showColour :: Show Color\nshowColour = Show Color\n</code></pre>\n\n<p>Doesn't really make sense. How can <code>Show Color</code> be of type <code>Show Color</code>?\n<code>Show</code> can be seen as a constraint, so ultimatly <code>Show Color</code> is a <code>Bool</code> and in our case will evaluate to True.</p>\n\n<p>Anyway, static scoping can be achieved using module. You can easily do something like</p>\n\n<pre><code>module Color where\n\nimport qualified Prelude\n\ndata Color = ...\n\nshow :: Color -&gt; String\nshow c = Prelude.show c\n</code></pre>\n\n<p>And then use <code>print (Color.show R)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": false, "score": 0, "last_activity_date": 1426715708, "creation_date": 1426715708, "answer_id": 29133433, "question_id": 29092263, "link": "https://stackoverflow.com/questions/29092263/why-cannot-instances-of-classes-be-used-as-values/29133433#29133433", "title": "Why cannot instances of classes be used as values?", "body": "<p>The idea behind type classes is in the name: a type class is a class (or set) of types (which all support a given interface).</p>\n\n<p>For example <code>Eq</code> is the class of types that support equality.</p>\n\n<p>A function with type <code>Eq a =&gt; [a] -&gt; Maybe a</code> is specifying that the type variable <code>a</code> ranges over the types that are members of <code>Eq</code>; this you need proof that your type is a member of <code>Eq</code> before you can call this function.</p>\n\n<p>An instance then is just a constructive proof that a particular type is a member of a class, by demonstrating how the type supports the interface.</p>\n\n<p>Seen this way, it's not just that Haskell doesn't support multiple instances; the idea of multiple instances doesn't make sense. A type is in a class or it isn't; the notion of class/set allows you to enquire about membership, but not to store multiple different implementations.</p>\n\n<p>Most critically, a function shouldn't be able to provide different return values for the same input, just because you used different membership proofs! And existing Haskell code <em>does</em> rely on this property: the classic example being the functions in <code>Data.Map</code> which (almost) all have an <code>Ord</code> constraint in order to operate on a <code>Map</code> as a tree internally. If it were possible (and normal) to have many different instances of <code>Ord</code> for a type and pass one of your choosing at each call, then this would be a wildly unsafe interface!</p>\n\n<p>The practice of defining laws for a class that valid instances must conform to will also depend on this property. If I write a set of interrelated functioned that assume all instances of <code>Monad</code> uphold the monad laws, it's quite likely that my code is broken if different instances can be provided to different calls operating on the same data.</p>\n\n<p>Note that Scala does <em>not</em> have type classes. What it has is implicit parameters; there is a <em>design pattern</em> to implement type classes yourself using implicit parameters. But it's a leaky abstraction; you can use implicit parameters to do things that do not fit the conceptual framework of a \"set of types\".</p>\n\n<p>Haskell implements type classes basically using implicit parameter passing, but it <em>enforces</em> the abstraction; instead of requiring all uses of implicit parameters that are for type classes to be selected coherently, Haskell rejects any situation where instances <em>could</em> be incoherent. The implicit parameters are an internal implementation detail; asking why they are not first class is a bit like asking why vtables are not first class in an OO language.</p>\n\n<p>These days Haskell does explicitly support implicit parameter passing (with an extension), so you could probably use the same design pattern to implement \"multiple instances\" in code that you write. But code written with that facility is expecting the implicit parameters to be <em>parameters</em>, and should work when different values are passed arbitrarily. Code written using type classes expects that the type class abstraction is what's being used.</p>\n"}], "owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 29094601, "answer_count": 4, "score": 2, "last_activity_date": 1426715708, "creation_date": 1426571971, "last_edit_date": 1426575105, "question_id": 29092263, "link": "https://stackoverflow.com/questions/29092263/why-cannot-instances-of-classes-be-used-as-values", "title": "Why cannot instances of classes be used as values?", "body": "<p>Why cannot I write something like:</p>\n\n<pre><code>data Color = R | G | B deriving Show\n\nshowColor :: Show Color\nshowColor = Show Color\n\nmain = do\n    putStrLn (showColor.show R)\n    putStrLn (showColor.show G)\n</code></pre>\n\n<p>Why are instances of classes not first class citizens in Haskell? </p>\n"}, {"tags": ["haskell", "newline"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 4, "creation_date": 1426551186, "post_id": 29089117, "comment_id": 46411082, "body": "If I see another question about this assignment, I&#39;m going to snap..."}, {"owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "edited": false, "score": 1, "creation_date": 1426566831, "post_id": 29089117, "comment_id": 46414813, "body": "Just be glad that someone is giving out an assignment that helps people learn Haskell. :P"}], "answers": [{"comments": [{"owner": {"reputation": 243, "user_id": 4245055, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/686d3e03e93e62b8baac702be13bd1a1?s=128&d=identicon&r=PG&f=1", "display_name": "kmil", "link": "https://stackoverflow.com/users/4245055/kmil"}, "edited": false, "score": 0, "creation_date": 1426551008, "post_id": 29089136, "comment_id": 46411031, "body": "Is there a way that I can use &quot;\\n&quot;?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 243, "user_id": 4245055, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/686d3e03e93e62b8baac702be13bd1a1?s=128&d=identicon&r=PG&f=1", "display_name": "kmil", "link": "https://stackoverflow.com/users/4245055/kmil"}, "edited": false, "score": 0, "creation_date": 1426551237, "post_id": 29089136, "comment_id": 46411098, "body": "@kmil You can use it as this: <code>putStr &quot;aa\\nbb&quot;</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3835277"}, "edited": false, "score": 0, "creation_date": 1457367296, "post_id": 29089136, "comment_id": 59362643, "body": "I&#39;m pretty sure you meant <b>with</b> escaping special characters, not without."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1457374282, "post_id": 29089136, "comment_id": 59367379, "body": "@gragas Actually, <code>putStr</code> does not escape anything. E.g. if <code>string</code> contains a newline, it gets printed as a newline and not as the character <code>` followed by </code>n<code>. Instead, </code>print` does escape special chars."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1426551157, "last_edit_date": 1426551157, "creation_date": 1426550778, "answer_id": 29089136, "question_id": 29089117, "link": "https://stackoverflow.com/questions/29089117/haskell-new-line-not-working/29089136#29089136", "title": "Haskell new line not working", "body": "<p>To print a string as it is, without escaping special characters, use:</p>\n\n<pre><code>putStr string\n</code></pre>\n\n<p>or</p>\n\n<pre><code>putStrLn string\n</code></pre>\n\n<p>if you want an extra newline at the end. In you case, you are probably looking for</p>\n\n<pre><code>putStr (displayFilm (....))\n</code></pre>\n\n<p>Why is this needed? In GHCi, if you evaluate an expression <code>s</code> the result will be printed as if running <code>print s</code> (unless it has type <code>IO something</code> -- forget about this special case). If <code>e</code> is a string, <code>print</code> <em>escapes</em> all the special characters and output the result. This is because <code>print</code> is meant to output a string whose syntax follows the one in Haskell expressions. For numbers, this is the usual decimal notation. For strings, we get quotes and escaped characters.</p>\n"}, {"tags": [], "owner": {"reputation": 12923, "user_id": 1530508, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fG8z0.png?s=128&g=1", "display_name": "ApproachingDarknessFish", "link": "https://stackoverflow.com/users/1530508/approachingdarknessfish"}, "is_accepted": false, "score": 2, "last_activity_date": 1565836498, "last_edit_date": 1565836498, "creation_date": 1426551016, "answer_id": 29089167, "question_id": 29089117, "link": "https://stackoverflow.com/questions/29089117/haskell-new-line-not-working/29089167#29089167", "title": "Haskell new line not working", "body": "<p>When you type an expression into GHC, it displays it using <code>print</code>. Calling <code>print</code> on a string shows its content but does not evaluate escape sequences:</p>\n\n<pre><code>&gt; print \"line1\\nline\"\n\"line1\\nline2\"\n</code></pre>\n\n<p>Note the quotes.</p>\n\n<p>To display the string as you desire, use <code>putStr</code> or <code>putStrLn</code> (the latter will append a newline).</p>\n\n<pre><code>&gt; putStr \"line1\\nline2\"\nline1\nline2\n</code></pre>\n"}], "owner": {"reputation": 243, "user_id": 4245055, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/686d3e03e93e62b8baac702be13bd1a1?s=128&d=identicon&r=PG&f=1", "display_name": "kmil", "link": "https://stackoverflow.com/users/4245055/kmil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4332, "favorite_count": 0, "accepted_answer_id": 29089136, "answer_count": 2, "score": 1, "last_activity_date": 1565836498, "creation_date": 1426550657, "last_edit_date": 1426551300, "question_id": 29089117, "link": "https://stackoverflow.com/questions/29089117/haskell-new-line-not-working", "title": "Haskell new line not working", "body": "<p>Been messing around for about 20 minutes now trying to get the new line working however it always shows in GHCI as a single line.</p>\n\n<p>Here is what I enter into GHCi:</p>\n\n<pre><code>displayFilm (\"Skyfall\",[\"Daniel Craig\", \"Judi Dench\", \"Ralph Fiennes\"], 2012, [\"Bill\", \"Olga\", \"Zoe\", \"Paula\", \"Megan\", \"Sam\", \"Wally\"])\n</code></pre>\n\n<p>Here is what is printed:</p>\n\n<p><code>\"Skyfall----------\\n Cast: Daniel Craig, Judi Dench, Ralph Fiennes\\n Year: 2012\\n Fans: 7\\n\"</code></p>\n\n<pre><code>displayList :: [String] -&gt; String\ndisplayList [] = \"\"\ndisplayList [x] = x ++ \"\" ++  displayList []\ndisplayList (x:xs) = x ++ \", \" ++ displayList xs\n\n\ndisplayFilm :: Film -&gt; String\ndisplayFilm (title, cast, year, fans) = \n    title ++ \"----------\" ++\n    \"\\n Cast: \" ++ (displayList cast) ++\n    \"\\n Year: \" ++ (show year) ++\n    \"\\n Fans: \" ++ show (length fans) ++ \"\\n\"\n</code></pre>\n"}, {"tags": ["haskell", "emacs", "interactive", "read-eval-print-loop"], "answers": [{"tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": false, "score": 1, "last_activity_date": 1426552767, "creation_date": 1426552767, "answer_id": 29089440, "question_id": 29086414, "link": "https://stackoverflow.com/questions/29086414/haskell-mod-plugin-for-emacs-repl-not-work/29089440#29089440", "title": "haskell mod plugin for emacs - REPL not work", "body": "<p>Emacs' shell buffer doesn't get along too well with the Unicode (lambda) prompt. You can manually set the prompt with <code>:set prompt \"ghci&gt; \"</code>.</p>\n\n<p>To automatically run the set prompt command when the shell starts up, edit your <a href=\"https://downloads.haskell.org/~ghc/7.8.3/docs/html/users_guide/ghci-dot-files.html\" rel=\"nofollow\">.ghci file</a> to include the above set command.</p>\n"}], "owner": {"reputation": 91, "user_id": 2663390, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/xp0Kw.jpg?s=128&g=1", "display_name": "srncristea", "link": "https://stackoverflow.com/users/2663390/srncristea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426552767, "creation_date": 1426537987, "question_id": 29086414, "link": "https://stackoverflow.com/questions/29086414/haskell-mod-plugin-for-emacs-repl-not-work", "title": "haskell mod plugin for emacs - REPL not work", "body": "<p>I have installed emacs and haskell-mod, I load the file into emacs star the repL with c-c c-l, appear the prompter(that with lambda), but when I type for example 1+2 and hit Enter nothing is happen. Should I use other key or why it didn't work ?\nThanks,\nSorin </p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1426534854, "post_id": 29085421, "comment_id": 46403862, "body": "Don&#39;t put constraints on constructors."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1426535338, "post_id": 29085421, "comment_id": 46404141, "body": "It works if you add <code>Integral i</code> to the constraints on <code>indexed</code>, although this probably isn&#39;t what you want.  The problem is (I think) that <code>indexed</code> needs to work with all <code>(Ix i, List (l i))</code>, but you&#39;re trying to make it work with <code>(Ix i, Integral i, List (l i))</code>."}, {"owner": {"reputation": 1361, "user_id": 2556165, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fGy2y.jpg?s=128&g=1", "display_name": "wowofbob", "link": "https://stackoverflow.com/users/2556165/wowofbob"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1426535709, "post_id": 29085421, "comment_id": 46404370, "body": "@Cubic, it helps me to cut off instances of <code>IdxByIntList</code> where <code>i</code> isn&#39;t <code>Integral</code> and <code>Ix</code>. Why should I avoid it?"}, {"owner": {"reputation": 1361, "user_id": 2556165, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fGy2y.jpg?s=128&g=1", "display_name": "wowofbob", "link": "https://stackoverflow.com/users/2556165/wowofbob"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1426536617, "post_id": 29085421, "comment_id": 46404900, "body": "@bheklilr, yea, looks like you are right. I guess I found an answer. <code>[0..]</code> has constraint <code>(Num a, Enum a)</code> which goes to <code>zip [0..]</code> and so on and it goes to <code>indexed</code>. So, <code>indexed</code> should has constraint <code>(Ix i, Enum i, Num i, List (l i))</code> but it&#39;s not. That&#39;s why it cannot be compiled."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1426536942, "post_id": 29085421, "comment_id": 46405079, "body": "You can make it less constrained with <code>enumerate = go 0 where go i [] = []; go i (x:xs) = (i, x) : go (i + 1) xs</code>.  This only places the constraint of <code>Num</code> on your index."}], "answers": [{"tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 3, "last_activity_date": 1426550403, "creation_date": 1426550403, "answer_id": 29089079, "question_id": 29085421, "link": "https://stackoverflow.com/questions/29085421/how-to-make-constraints-of-class-function-depends-from-class-instance/29089079#29089079", "title": "How to make constraints of class function depends from class instance?", "body": "<p>What about changing the class a bit to</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n\nimport Data.Ix\n\nclass Indexed li where\n  indexed :: li ~ l i =&gt; li a -&gt; [(i, a)]\n  -- i - type of index\n  -- l - type of wrapper\n\ndata IdxByIntList i a = IdxByIntList { getList :: [a] }\n\ninstance (Integral i, Ix i) =&gt; Indexed (IdxByIntList i) where\n  indexed = zip [0..] . getList\n</code></pre>\n\n<p>This makes the class parameter the applied <code>l i</code> instead of just <code>l</code>, which may be enough for your use.</p>\n\n<p>If you really <em>do</em> need the instance to be parametrized on <code>l</code>, things get more tricky; I think you then need an associated type family of kind <code>* -&gt; Constraint</code>, which requires the <code>ConstraintKinds</code> extension, and it gets awkward to express the family instances when more than one class constraint is involved. (I don't know whether it would work satisfactory in practice.)</p>\n"}], "owner": {"reputation": 1361, "user_id": 2556165, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fGy2y.jpg?s=128&g=1", "display_name": "wowofbob", "link": "https://stackoverflow.com/users/2556165/wowofbob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 29089079, "answer_count": 1, "score": 2, "last_activity_date": 1426550403, "creation_date": 1426534305, "last_edit_date": 1592644375, "question_id": 29085421, "link": "https://stackoverflow.com/questions/29085421/how-to-make-constraints-of-class-function-depends-from-class-instance", "title": "How to make constraints of class function depends from class instance?", "body": "<p>I've been playing with implementing a wrapper for lists which could be indexed differently.</p>\n<p>Basic class of such wrappers:</p>\n<pre><code>class List l where\n  toList :: l a -&gt; [a]\n</code></pre>\n<p>Wrappers which supports indexing:</p>\n<pre><code>class Indexed l where\n  indexed :: (Ix i, List (l i)) =&gt; l i a -&gt; [(i, a)]\n  -- i - type of index\n  -- l - type of wrapper\n</code></pre>\n<p>Wrapper of lists which can be indexed by <code>Integral</code> type:</p>\n<pre><code>data IdxByIntList i a = (Ix i, Integral i) =&gt; IdxByIntList { getList :: [a] }\n</code></pre>\n<p>If <code>IdxByIntList</code> is instance of <code>List</code>, then <code>i</code> is <code>Integral</code> and <code>Ix</code>:</p>\n<pre><code>instance (Integral i, Ix i) =&gt; List (IdxByIntList i) where\n  toList = getList\n</code></pre>\n<p>Looks like constraint <code>(Ix i, Integral i) </code> in <code>indexed</code> function is sutisfied and it's possible to make <code>IdxByIntList</code> to be an instance of <code>Indexed</code>:</p>\n<pre><code>instance Indexed IdxByIntList where\n  indexed = zip [0..] . getList\n</code></pre>\n<p>But it cannot be compiled because compiler cannot deduce\ntype variable <code>i</code> to be an instance of <code>Enum</code> and <code>Num</code>.</p>\n<h2>Edited:</h2>\n<p>In <code>indexed</code> for <code>IdxByIntList</code>, <code>[0..]</code> has constraint <code>(Num a, Enum a)</code> which goes to <code>zip [0..]</code> and so on and it goes to <code>indexed</code>. So, <code>indexed</code> should has constraint <code>(Ix i, Enum i, Num i, List (l i))</code> but it's not.</p>\n<p><code>i</code> is instance of <code>Integral</code>, so it's instance of <code>Num</code> and <code>Enum</code>.</p>\n<p>I want <code>Indexed</code> to has general constraints for all it's instances and to\nhas additional constraints which depends from concrete instance. Here, I want <code>IdxByIntList</code> to has constraint <code>(Ix i, List (l i), Integral i)</code> on <code>indexed</code>. How can I do that?</p>\n"}, {"tags": ["python", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1426528013, "post_id": 29083514, "comment_id": 46400085, "body": "Even though this question seems &#39;opinion based&#39;, I don&#39;t believe anybody thinks that you translate from one language to another. The only answer should be yours :)"}, {"owner": {"reputation": 3542, "user_id": 2984585, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d8b299670c2e1512831e7d2026a8d350?s=128&d=identicon&r=PG", "display_name": "ditoslav", "link": "https://stackoverflow.com/users/2984585/ditoslav"}, "edited": false, "score": 0, "creation_date": 1426530043, "post_id": 29083514, "comment_id": 46401291, "body": "How would you write this functionally in python?"}, {"owner": {"reputation": 25103, "user_id": 1340389, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5d0e5b16679b92b24c8262e1e6aa2aa7?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/1340389/kevin"}, "reply_to_user": {"reputation": 3542, "user_id": 2984585, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d8b299670c2e1512831e7d2026a8d350?s=128&d=identicon&r=PG", "display_name": "ditoslav", "link": "https://stackoverflow.com/users/2984585/ditoslav"}, "edited": false, "score": 2, "creation_date": 1426532533, "post_id": 29083514, "comment_id": 46402563, "body": "@DominikDitoIvosevic: I&#39;d probably start by making greater use of generator expressions and list comprehensions.  Don&#39;t call <code>map(lambda: something, something_else)</code>; that&#39;s just ugly.  <code>map()</code> is for situations where you <i>already have</i> a callable with a simple name.  You can just write <code>(x.foo() for x in bar)</code> instead.  Alternatively, use <code>operator.methodcaller</code> to avoid the lambdas."}, {"owner": {"reputation": 25103, "user_id": 1340389, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5d0e5b16679b92b24c8262e1e6aa2aa7?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/1340389/kevin"}, "edited": false, "score": 0, "creation_date": 1426532674, "post_id": 29083514, "comment_id": 46402622, "body": "You should also consider writing a full-blown generator function instead of trying to do this as a one-liner.  That will still give you nice lazy evaluation, but it&#39;s much easier to read."}, {"owner": {"reputation": 3542, "user_id": 2984585, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d8b299670c2e1512831e7d2026a8d350?s=128&d=identicon&r=PG", "display_name": "ditoslav", "link": "https://stackoverflow.com/users/2984585/ditoslav"}, "reply_to_user": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1426533284, "post_id": 29083514, "comment_id": 46402952, "body": "@Kevin the problem with the <code>for .. in</code> is that it changes the  object which is used while the map only returns the changed one"}, {"owner": {"reputation": 25103, "user_id": 1340389, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5d0e5b16679b92b24c8262e1e6aa2aa7?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/1340389/kevin"}, "reply_to_user": {"reputation": 3542, "user_id": 2984585, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d8b299670c2e1512831e7d2026a8d350?s=128&d=identicon&r=PG", "display_name": "ditoslav", "link": "https://stackoverflow.com/users/2984585/ditoslav"}, "edited": false, "score": 1, "creation_date": 1426533859, "post_id": 29083514, "comment_id": 46403284, "body": "@DominikDitoIvosevic: In Python 3.x, <code>map(x, y)</code> is <i>exactly</i> the same as <code>(x(z) for z in y)</code>."}], "tags": [], "owner": {"reputation": 25103, "user_id": 1340389, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5d0e5b16679b92b24c8262e1e6aa2aa7?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/1340389/kevin"}, "is_accepted": false, "score": 4, "last_activity_date": 1426527878, "creation_date": 1426527878, "answer_id": 29083514, "question_id": 29083463, "link": "https://stackoverflow.com/questions/29083463/how-to-easily-transition-from-haskell-to-python-3/29083514#29083514", "title": "How to easily transition from Haskell to Python 3", "body": "<blockquote>\n  <p>Is there a better way to approach this?</p>\n</blockquote>\n\n<p>Yes.  Don't try to translate your code from Haskell.  Rewrite it using idiomatic Python.</p>\n\n<p>If you want a functional style, look into <code>functools</code>.  For anything involving lists and other iterable objects, consider <code>itertools</code> as well (it's lazy, unlike slicing).  But keep in mind that Python is a multi-paradigm programming language, and it takes the position that different problems are better solved using different methods.</p>\n"}, {"comments": [{"owner": {"reputation": 3542, "user_id": 2984585, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d8b299670c2e1512831e7d2026a8d350?s=128&d=identicon&r=PG", "display_name": "ditoslav", "link": "https://stackoverflow.com/users/2984585/ditoslav"}, "edited": false, "score": 0, "creation_date": 1426577177, "post_id": 29085435, "comment_id": 46418293, "body": "Thank you. What I really needed was some relevant python code and this is just that. I&#39;ll tinkle with your examples a bit to get a feeling of how python feels like."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 5, "last_activity_date": 1426534369, "creation_date": 1426534369, "answer_id": 29085435, "question_id": 29083463, "link": "https://stackoverflow.com/questions/29083463/how-to-easily-transition-from-haskell-to-python-3/29085435#29085435", "title": "How to easily transition from Haskell to Python 3", "body": "<p>I would not recommend writing Python code like this, since Python makes this sort of thing nicer using list comprehensions and other techniques, but if you really wanted to write it in the functional style you could do something like</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import string\nfrom functools import *\nfrom itertools import *\n\ndef take(n, iterable): return islice(iterable, n)\ndef drop(n, iterable): return islice(iterable, n, None)\n\ndef splitOn(sep): return partial(string.split, sep=sep)\n\ntransitions = imap(splitOn(','), chain(*imap(splitOn('-&gt;'), drop(5, input))))\n</code></pre>\n\n<p>As you can tell, this is quite messy.  A more pythonic solution would probably be</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>transitions = (c for a in drop(5, input)\n                 for b in a.split('-&gt;')\n                 for c in b.split(','))\n</code></pre>\n\n<p>This is even a case where I think regular expressions are acceptable:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import re\n\ndef splitOn(*seps): return partial(re.split, '|'.join(re.escape(sep) for sep in seps))\n\ntransitions = imap(splitOn(',', '-&gt;'), drop(5, input))\n</code></pre>\n\n<p>I'm still able to use functional techniques, such as mapping, generic take/drop, partial application and comprehensions but it comes out a lot cleaner to use more of the python features.  My favorite for the simple case is the simple generator comprehension, but the last one is great if you need more delimiters.</p>\n"}], "owner": {"reputation": 3542, "user_id": 2984585, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d8b299670c2e1512831e7d2026a8d350?s=128&d=identicon&r=PG", "display_name": "ditoslav", "link": "https://stackoverflow.com/users/2984585/ditoslav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 29085435, "answer_count": 2, "score": 2, "last_activity_date": 1426534369, "creation_date": 1426527698, "question_id": 29083463, "link": "https://stackoverflow.com/questions/29083463/how-to-easily-transition-from-haskell-to-python-3", "title": "How to easily transition from Haskell to Python 3", "body": "<p>So I've written some very pretty Haskell code for my college homework and have found out that they do not plan on supporting Haskell for our homeworks.</p>\n\n<p>I've received an email saying that I should try Python since of all the supported languages it has the most of the \"functional\". </p>\n\n<p>I've tried some quick code converting to python but am a bit confused whether this really has to look this ugly.</p>\n\n<p>So my Haskell code is</p>\n\n<pre><code>transitions = map (map (splitOn \",\")) $ map (splitOn \"-&gt;\") $ drop 5 $ input'\n</code></pre>\n\n<p>and my python3 code is</p>\n\n<pre><code>transitions = list(map(lambda x: list(map(lambda y: y.split(\",\"), x)), map(lambda z: z.split(\"-&gt;\"), lined_input[5:])))\n</code></pre>\n\n<p>Since I've written about 10 lines of python so far I was kinda hoping I was missing a nicer way to handle such things.</p>\n\n<p>What bothers me the most is the fact that sometimes i have to use x.split and the map has to be map(f, x).</p>\n\n<p>Is there a better way to approach this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 3, "creation_date": 1426528976, "post_id": 29082486, "comment_id": 46400687, "body": "How <code>Up&#47;Down</code> and <code>Even&#47;Odd</code> are related? If <code>Up</code> is always <code>Even</code>, then you can index <code>Coin</code> by <code>Parity</code> like this: <code>data Parity = Even | Odd</code>, <code>data Coin :: Parity -&gt; * where Up :: Coin Even; Down :: Coin Odd</code>. Then <code>flip :: Coin p -&gt; Coin (Flip p)</code>."}, {"owner": {"reputation": 16822, "user_id": 560073, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh6.googleusercontent.com/-A_vJq0ilPI8/AAAAAAAAAAI/AAAAAAAAAJI/dKesA-ExUzA/photo.jpg?sz=128", "display_name": "Linus Oleander", "link": "https://stackoverflow.com/users/560073/linus-oleander"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1426535022, "post_id": 29082486, "comment_id": 46403964, "body": "@user3237465 Thanks for your help. I tired using your example like this, but it doesn&#39;t work. <a href=\"https://gist.github.com/oleander/86c65054264c413aaa5a\" rel=\"nofollow noreferrer\">gist.github.com/oleander/86c65054264c413aaa5a</a> What I&#39;m I missing?"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 2, "creation_date": 1426536733, "post_id": 29082486, "comment_id": 46404972, "body": "@Oleander You are missing <code>{-# LANGUAGE DataKinds #-}</code>"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1426537261, "post_id": 29082486, "comment_id": 46405248, "body": "@Oleander You also need to change <code>Flip</code> so that the result is of kind <code>Parity</code> not <code>*</code> and you have recursion in the definition of <code>Flip</code> that shouldn&#39;t be there. Also, you should consider closed type families. I feel that they&#39;re usually easier to think about because they&#39;re more restricted."}], "answers": [{"tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": true, "score": 4, "last_activity_date": 1426560923, "creation_date": 1426560923, "answer_id": 29090545, "question_id": 29082486, "link": "https://stackoverflow.com/questions/29082486/restrict-output-using-type-families/29090545#29090545", "title": "Restrict output using Type Families", "body": "<p>Putting my comment into an answer:</p>\n\n<pre><code>{-# LANGUAGE GADTs, DataKinds, TypeFamilies #-}\n\ndata Parity = Even | Odd\n\ndata Coin :: Parity -&gt; * where\n    Up   :: Coin Even\n    Down :: Coin Odd\n\ntype family Flip (p :: Parity) :: Parity where\n    Flip Even = Odd\n    Flip Odd  = Even\n\nflip :: Coin p -&gt; Coin (Flip p)\nflip Up   = Down\nflip Down = Up\n</code></pre>\n"}], "owner": {"reputation": 16822, "user_id": 560073, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh6.googleusercontent.com/-A_vJq0ilPI8/AAAAAAAAAAI/AAAAAAAAAJI/dKesA-ExUzA/photo.jpg?sz=128", "display_name": "Linus Oleander", "link": "https://stackoverflow.com/users/560073/linus-oleander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 29090545, "answer_count": 1, "score": 0, "last_activity_date": 1426560923, "creation_date": 1426524605, "question_id": 29082486, "link": "https://stackoverflow.com/questions/29082486/restrict-output-using-type-families", "title": "Restrict output using Type Families", "body": "<p>I've this code for which I'm trying to add a constraint using Haskells Type Families. I want to force the output to always be a flip, is that possible with this code?</p>\n\n<pre><code>{-# LANGUAGE GADTs, TypeFamilies #-}\n\nmodule TF where\n\ndata Even\ndata Odd\n\ndata Coin where\n  Up :: Coin\n  Down :: Coin\n\ntype family Flip n :: *\ntype instance Flip Even = Odd\ntype instance Flip Odd = Even\n\nup = Up \ndown = Down\n\nflip Up   = Down\nflip Down = Up\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 4039, "user_id": 667147, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/1iNND.png?s=128&g=1", "display_name": "jarandaf", "link": "https://stackoverflow.com/users/667147/jarandaf"}, "edited": false, "score": 0, "creation_date": 1426584755, "post_id": 29086688, "comment_id": 46422106, "body": "Thanks. I am trying to use a web proxy without much success, requests triggered with <code>wreq</code> are not detected. See updated question. Any ideas?"}, {"owner": {"reputation": 4039, "user_id": 667147, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/1iNND.png?s=128&g=1", "display_name": "jarandaf", "link": "https://stackoverflow.com/users/667147/jarandaf"}, "edited": false, "score": 0, "creation_date": 1426591864, "post_id": 29086688, "comment_id": 46426242, "body": "Finally it was an unrelated issue (<code>https</code> requests are not directly monitored)."}, {"owner": {"reputation": 938, "user_id": 913893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b2c9583c4c21e1c1cd5c887cf04c18?s=128&d=identicon&r=PG", "display_name": "John Tyree", "link": "https://stackoverflow.com/users/913893/john-tyree"}, "edited": false, "score": 2, "creation_date": 1441639524, "post_id": 29086688, "comment_id": 52747644, "body": "For future reference, you can use <a href=\"http://httpbin.org/\" rel=\"nofollow noreferrer\">httpbin.org</a> to check these things. It&#39;s really excellent."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 3, "last_activity_date": 1426541858, "last_edit_date": 1426541858, "creation_date": 1426539050, "answer_id": 29086688, "question_id": 29082096, "link": "https://stackoverflow.com/questions/29082096/check-wreq-request-headers/29086688#29086688", "title": "Check wreq request headers", "body": "<p>In Wreq, the <code>Options</code> type is an instance of <code>Show</code>, so you can pass it to <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Prelude.html#v:print\" rel=\"nofollow\"><code>print</code></a>, or simply inspect it on ghci:</p>\n\n<pre><code>ghci&gt; import Network.Wreq\nghci&gt; defaults :: Options\nOptions { manager = Left _, proxy = Nothing, auth = Nothing, headers = \n[(\"User-Agent\",\"haskell wreq-0.3.0.1\")], params = [], redirects = 10, cookies = [] }\n</code></pre>\n\n<p>You can also use the <a href=\"http://hackage.haskell.org/package/wreq-0.3.0.1/docs/Network-Wreq.html#v:headers\" rel=\"nofollow\"><code>headers</code></a> lens to focus directly on the headers:</p>\n\n<pre><code>ghci&gt; defaults ^. headers\n[(\"User-Agent\",\"haskell wreq-0.3.0.1\")]\n</code></pre>\n\n<p>But if Wreq is adding some headers <em>after</em> passing the options to <code>postWith</code>, you'll have to use a web debugging proxy like <a href=\"http://www.telerik.com/fiddler\" rel=\"nofollow\">Fiddler</a> to know what's going on.</p>\n"}], "owner": {"reputation": 4039, "user_id": 667147, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/1iNND.png?s=128&g=1", "display_name": "jarandaf", "link": "https://stackoverflow.com/users/667147/jarandaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 778, "favorite_count": 0, "accepted_answer_id": 29086688, "answer_count": 1, "score": 3, "last_activity_date": 1426584740, "creation_date": 1426523518, "last_edit_date": 1426584740, "question_id": 29082096, "link": "https://stackoverflow.com/questions/29082096/check-wreq-request-headers", "title": "Check wreq request headers", "body": "<p>I am pretty new to Haskell and I am not sure how I can achieve this. I am using <a href=\"http://www.serpentine.com/wreq/\" rel=\"nofollow\">wreq</a> as HTTP client and I would like to check what HTTP headers are being sent to the server. For instance, I have defined the following method, which tries to authenticate using Facebook credentials:</p>\n\n<pre><code>authenticate \u2982 String \u2192 String \u2192 IO (Response ByteString)\nauthenticate facebookId facebookToken =\n    postWith opts \"https://api.somedomain.com/auth\" (object $ [\"facebook_token\" .= facebookToken, \"facebook_id\" .= facebookId])\n      where opts = defaults &amp; header \"Content-Type\" .~ [\"application/json\"]\n                            &amp; header \"Accept\" .~ [\"application/json\"]\n                            &amp; proxy ?~ httpProxy \"localhost\" 9396\n</code></pre>\n\n<p>With POSTman I get the proper response but with <code>wreq</code> I get forbidden access (403). I assume some extra request headers might be added by the library and that's what I would like to check.</p>\n\n<p>Any hints?</p>\n\n<p>EDIT: An http proxy is now being used to check HTTP traffic (<code>wreq</code> requests are not detected though).</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1873, "user_id": 4668162, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/69cdf1bc32e68bcebbc21c69c6bcdbb4?s=128&d=identicon&r=PG&f=1", "display_name": "Onix", "link": "https://stackoverflow.com/users/4668162/onix"}, "edited": false, "score": 0, "creation_date": 1426591747, "post_id": 29091296, "comment_id": 46426164, "body": "i have tried the first one and i have the same result. i realize that i get the error because the Cast list does not stop getting actors.. and when it reaches the end of the line the year cant be found especially in the position  <code>list !! 2</code>. now i need to create a function that search for actor names and stops when it finds a year or something?"}], "tags": [], "owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "is_accepted": false, "score": 1, "last_activity_date": 1426566668, "creation_date": 1426566668, "answer_id": 29091296, "question_id": 29081032, "link": "https://stackoverflow.com/questions/29081032/parse-a-file-with-lists-in-haskell/29091296#29091296", "title": "Parse a file with lists in Haskell", "body": "<pre><code>parseActors :: [String] -&gt; Cast\nparseActors [] = []\nparseActors list\n    | length list &gt; 0 = [(list !! 0)] ++ parseActors (drop 1 list)\n</code></pre>\n\n<p>Have you tried this out to see what it does?</p>\n\n<pre><code>ghci&gt; parseActors [\"one\", \"two\", \"three\"]\n[\"one\", \"two\", \"three\"]\n</code></pre>\n\n<p>What you have done is written an overly complicated version of:</p>\n\n<pre><code>parseActors :: [String] -&gt; Cast\nparseActors list = list\n</code></pre>\n\n<p>Likewise,</p>\n\n<pre><code>parseFans :: [String] -&gt; Fans\nparseFans [] = []\nparseFans list\n    | length list &gt; 0 = [(list !! 0)] ++ parseFans (drop 1 list)\n</code></pre>\n\n<p>This code is identical to <code>parseActors</code>, you've just changed the name to <code>parseFans</code> and the result type to <code>Fans</code>. This behaves exactly the same as:</p>\n\n<pre><code>parseFans :: [String] -&gt; Fans\nparseFans list = list\n</code></pre>\n\n<hr>\n\n<p>I'm going to just go ahead and ignore the above for now. Let's take <code>parseChars</code> for a spin instead.</p>\n\n<pre><code>ghci&gt; parseChars \"one,two,three,\" \"\"\n[\"one\", \"two\", \"three\"]\n</code></pre>\n\n<p>Ah, a function that actually does parsing. I'm not sure how you expect this one to work, but I presume it is working as expected.</p>\n\n<p>I want to draw your attention to this part of parseLines:</p>\n\n<pre><code>read(list !! 2)\n</code></pre>\n\n<p>This is what you are using to try and extract the year. And this is what is throwing the error: <code>Prelude.read: no parse</code>. Note how it tells you that a use of <code>Prelude.read</code> is the culprit.</p>\n\n<p>Okay. Let's take the first film and run it through some of this code.</p>\n\n<pre><code>ghci&gt; let gunman = \"The Gunman,Idris Elba,Sean Penn,Javier Bardem,2015,Garry,Dave,Zoe,Kevin,Emma,\"\nghci&gt; let list = parseChars gunman \"\"\nghci&gt; list\n[\"The Gunman\",\"Idris Elba\",\"Sean Penn\",\"Javier Bardem\",\"2015\",\"Garry\",\"Dave\",\"Zoe\",\"Kevin\",\"Emma\"]\nghci&gt; list !! 2\n\"Sean Penn\"\n</code></pre>\n\n<p>Notice how <code>list !! 2</code> is not the year. There's your problem. Well, one of them, anyways.</p>\n\n<p>So lessons hopefully learned:</p>\n\n<ul>\n<li>Use the interactive prompt (ghci) to test out pieces of your code and make sure they behave the way you expect.</li>\n<li>Scrutinize error messages, they often can give you clues about what's wrong with your code.</li>\n</ul>\n"}], "owner": {"reputation": 1873, "user_id": 4668162, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/69cdf1bc32e68bcebbc21c69c6bcdbb4?s=128&d=identicon&r=PG&f=1", "display_name": "Onix", "link": "https://stackoverflow.com/users/4668162/onix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1439508534, "creation_date": 1426520629, "last_edit_date": 1439508534, "question_id": 29081032, "link": "https://stackoverflow.com/questions/29081032/parse-a-file-with-lists-in-haskell", "title": "Parse a file with lists in Haskell", "body": "<p>I am trying to read a file. The Title is read correctly, but when I try to read the Cast (actors) it doesn't seem to stop and search for the year. is there a mistake in parsing Actors or parsing Chars?</p>\n\n<pre><code>-- Types\ntype Title = String\ntype Actor = String\ntype Cast = [Actor]\ntype Year = Int\ntype Fan = String\ntype Fans = [Fan]\ntype Period = (Year, Year)\ntype Database = [Film]\ntype Film = (Title, Cast, Year, Fans)\n</code></pre>\n\n<p>-- Parsing methods for reading the file   </p>\n\n<pre><code>parseLines :: [String] -&gt; Film\nparseLines list = (list !! 0, parseActors (drop 1 list), read(list !! 2), parseActors (drop 3 list))\n\nparseFans :: [String] -&gt; Fans\nparseFans [] = []\nparseFans list\n    | length list &gt; 0 = [(list !! 0)] ++ parseFans (drop 1 list)\n\nparseActors :: [String] -&gt; Cast\nparseActors [] = []\nparseActors list\n    | length list &gt; 0 = [(list !! 0)] ++ parseActors (drop 1 list)\n\nparseChars :: String -&gt; String -&gt; [String]\nparseChars [] _ = []\nparseChars (x:xs) stringCount\n    | x == ',' = [stringCount] ++ parseChars xs \"\"\n    | otherwise = (parseChars xs (stringCount ++ [x]))\n\nparseAll :: [String] -&gt; [Film]\nparseAll [] = []\nparseAll (x:xs) = parseLines (parseChars x \"\") : (parseAll xs)\n</code></pre>\n\n<p>and i get this error</p>\n\n<blockquote>\n  <p>|The Gunman| |Idris Elba,Sean Penn,Javier\n  Bardem,2015,Garry,Dave,Zoe,Kevin,| |*Main> *** Exception:\n  Prelude.read: no parse</p>\n</blockquote>\n\n<p>this is my text file</p>\n\n<pre><code>    The Gunman,Idris Elba,Sean Penn,Javier Bardem,2015,Garry,Dave,Zoe,Kevin,Emma, \n    The Shawshank Redemption, Tim Robbins, Morgan Freeman, Bob Gunton, 1994, Bill, Jo, Garry, Kevin, Olga, Liz, \n    The Dark Knight, Christian Bale, Heath Ledger,Aaron Eckhart, 2008, Zoe, Heidi, Jo, Emma, Liz, Sam, Olga, Kevin, Tim, \n    Inception, Leonardo DiCaprio, Ellen Page, 2010, Jo, Emma, Zack, Olga, Kevin,\n</code></pre>\n"}, {"tags": ["haskell", "compare"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1426516844, "post_id": 29079553, "comment_id": 46392390, "body": "What is (20, &quot;abc&quot;) ? Why longest returning what it is returning?"}, {"owner": {"reputation": 147, "user_id": 4676799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-y648oz0HCX0/AAAAAAAAAAI/AAAAAAAAAN0/xL7ihGVzOjI/photo.jpg?sz=128", "display_name": "Cristian Balint", "link": "https://stackoverflow.com/users/4676799/cristian-balint"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1426517029, "post_id": 29079553, "comment_id": 46392526, "body": "For LZW compression you have to build up a dictionary containing prefixes. (20, &quot;abc&quot;) is the (&lt;index in the dictionary&gt;, &lt;prefix&gt;)"}, {"owner": {"reputation": 199084, "user_id": 56338, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/92fb4563ddc5ceeaa8b19b60a7a172f4?s=128&d=identicon&r=PG", "display_name": "sth", "link": "https://stackoverflow.com/users/56338/sth"}, "edited": false, "score": 1, "creation_date": 1426517071, "post_id": 29079553, "comment_id": 46392563, "body": "So have you written any code and what doesn&#39;t work about it?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1426517118, "post_id": 29079553, "comment_id": 46392597, "body": "Why in the second test case there is same prefix with different indices?"}, {"owner": {"reputation": 147, "user_id": 4676799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-y648oz0HCX0/AAAAAAAAAAI/AAAAAAAAAN0/xL7ihGVzOjI/photo.jpg?sz=128", "display_name": "Cristian Balint", "link": "https://stackoverflow.com/users/4676799/cristian-balint"}, "edited": false, "score": 0, "creation_date": 1426517264, "post_id": 29079553, "comment_id": 46392704, "body": "I&#39;m not sure in which order should I combine the maximumBy and compare functions, and because of this I cannot see how should I split the input and what part of it should I give as parameter to compare, and what part of it to maximumBy"}, {"owner": {"reputation": 147, "user_id": 4676799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-y648oz0HCX0/AAAAAAAAAAI/AAAAAAAAAN0/xL7ihGVzOjI/photo.jpg?sz=128", "display_name": "Cristian Balint", "link": "https://stackoverflow.com/users/4676799/cristian-balint"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1426517366, "post_id": 29079553, "comment_id": 46392781, "body": "@EugeneSh. I have to prepare for the case when a prefix occurs more then once in the dictionary, in this case I have to return the lowest index, prefix pair"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1426517377, "post_id": 29079553, "comment_id": 46392791, "body": "As pointed out by Eugene, your specs are ambiguous. In particular, why is the result of the second test <code>(15, &quot;abc&quot;)</code> and not <code>(20, &quot;abc&quot;)</code>? Also, edit your question and add whatever code you&#39;ve come up with so far."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1426517960, "post_id": 29079553, "comment_id": 46393210, "body": "A function that passes your tests would be <code>longest = maximumBy $ \\(l1, a1) (l2, a2) -&gt; comparing length a1 a2 &lt;&gt; compare l2 l1</code>, be sure to note the order of arguments to <code>compare</code>.  This takes advantage of the fact that <code>Ordering</code> is a monoid (you&#39;ll need to import <code>Data.Monoid</code> and <code>Data.Ord</code> for this implementation)"}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 4676799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-y648oz0HCX0/AAAAAAAAAAI/AAAAAAAAAN0/xL7ihGVzOjI/photo.jpg?sz=128", "display_name": "Cristian Balint", "link": "https://stackoverflow.com/users/4676799/cristian-balint"}, "edited": false, "score": 0, "creation_date": 1426518898, "post_id": 29080046, "comment_id": 46393839, "body": "Thanks alot, it helped me alot. This is what I came up with <code>longest xs = maximumBy selectPrefix xs \twhere \t\tselectPrefix (i1, s1) (i2, s2) = compare (length s1) (length s2)</code> now the only question is how do I get rid of the selectPrefix function"}, {"owner": {"reputation": 147, "user_id": 4676799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-y648oz0HCX0/AAAAAAAAAAI/AAAAAAAAAN0/xL7ihGVzOjI/photo.jpg?sz=128", "display_name": "Cristian Balint", "link": "https://stackoverflow.com/users/4676799/cristian-balint"}, "edited": false, "score": 0, "creation_date": 1426519322, "post_id": 29080046, "comment_id": 46394170, "body": "And one other thing, in my solution above, why do I have <code>selectPrefix (i1, s1) (i2, s2)</code>, where do the 2 tuples come from, which function is calling which one?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 147, "user_id": 4676799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-y648oz0HCX0/AAAAAAAAAAI/AAAAAAAAAN0/xL7ihGVzOjI/photo.jpg?sz=128", "display_name": "Cristian Balint", "link": "https://stackoverflow.com/users/4676799/cristian-balint"}, "edited": false, "score": 0, "creation_date": 1426519460, "post_id": 29080046, "comment_id": 46394278, "body": "In your solution the <code>selectPrefix</code> does not deal with the case the length is equal. To get rid of this function you can use the lambda notation (anonymous function)"}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": true, "score": 1, "last_activity_date": 1426517957, "creation_date": 1426517957, "answer_id": 29080046, "question_id": 29079553, "link": "https://stackoverflow.com/questions/29079553/how-should-i-use-maximumby-and-compare-to-implement-my-function/29080046#29080046", "title": "How should I use maximumBy and compare to implement my function?", "body": "<p>This is what will do:</p>\n\n<pre><code>import Data.List\n\ncompareEntry :: (Int, [Char]) -&gt; (Int, [Char]) -&gt; Ordering\ncompareEntry (i1, s1) (i2, s2)\n    | len1 &gt; len2 = GT   -- First compare the length of the strings\n    | len1 &lt; len2 = LT\n    | i1 &lt; i2 = GT       -- If they are equal, compare the indices\n    | i2 &gt; i1 = LT       -- (mind the reversed order, since you want the lowest index)\n    | otherwise = EQ\n    where \n        len1 = length s1\n        len2 = length s2\n\nlongest = maximumBy compareEntry\n</code></pre>\n\n<p>It can be written in a shorter but less readable way.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1593256955, "post_id": 62606532, "comment_id": 110719334, "body": "... <a href=\"https://hackage.haskell.org/package/base-4.14.0.0/docs/Prelude.html#t:Semigroup\" rel=\"nofollow noreferrer\">using</a> <code>instance Semigroup b =&gt; Semigroup (a -&gt; b) where (f &lt;&gt; g) x = f x &lt;&gt; g x</code> and hence <code>(f &lt;&gt; g) x y = f x y &lt;&gt; g x y</code>, and <a href=\"https://hackage.haskell.org/package/base-4.14.0.0/docs/Prelude.html#t:Semigroup\" rel=\"nofollow noreferrer\"><code>instance Semigroup Ordering</code></a>"}], "tags": [], "owner": {"reputation": 705, "user_id": 4611648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eadb8dc00bcdae1ae32df139dc451beb?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Harniakou", "link": "https://stackoverflow.com/users/4611648/anton-harniakou"}, "is_accepted": false, "score": 1, "last_activity_date": 1593237788, "creation_date": 1593237788, "answer_id": 62606532, "question_id": 29079553, "link": "https://stackoverflow.com/questions/29079553/how-should-i-use-maximumby-and-compare-to-implement-my-function/62606532#62606532", "title": "How should I use maximumBy and compare to implement my function?", "body": "<p>A shorter version of the solution by @Eugene Sh:</p>\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.List\nimport Data.Ord\n\nlongest = maximumBy (comparing (length . snd) &lt;&gt; flip (comparing fst))\n\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 4676799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-y648oz0HCX0/AAAAAAAAAAI/AAAAAAAAAN0/xL7ihGVzOjI/photo.jpg?sz=128", "display_name": "Cristian Balint", "link": "https://stackoverflow.com/users/4676799/cristian-balint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1721, "favorite_count": 0, "accepted_answer_id": 29080046, "answer_count": 2, "score": 0, "last_activity_date": 1593237788, "creation_date": 1426516706, "last_edit_date": 1426517868, "question_id": 29079553, "link": "https://stackoverflow.com/questions/29079553/how-should-i-use-maximumby-and-compare-to-implement-my-function", "title": "How should I use maximumBy and compare to implement my function?", "body": "<p>I have to do an LZW compression in Haskell and I'm a bit stuck at searching the longest prefix because I have to use a combination of <code>maximumBy</code> and <code>compare</code> functions.</p>\n\n<p>The function signature should be the following:</p>\n\n<pre><code>longest :: [(Int, String)] -&gt; (Int, String)\n</code></pre>\n\n<p>Here are some tests that describe the requirements:</p>\n\n<pre><code>test_longest =\n  [ longest [(30, \"a\"), (20, \"abc\"), (15, \"ab\")]  == (20, \"abc\")\n  , longest [(30, \"a\"), (20, \"abc\"), (15, \"abc\")] == (15, \"abc\")\n  ]\n</code></pre>\n\n<p>Any help would be appreciated. </p>\n\n<p>What I've came up with in trying to understand the problem is:</p>\n\n<p><code>longest (x:xs) = maximumBy (compare (length) x) xs</code></p>\n\n<p>but something is definitely off.</p>\n"}, {"tags": ["haskell", "ghc", "ghci"], "comments": [{"owner": {"reputation": 3038, "user_id": 2725031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a052ac048fc2c1c0df69dd66100e9c06?s=128&d=identicon&r=PG&f=1", "display_name": "Marcin \u0141o\u015b", "link": "https://stackoverflow.com/users/2725031/marcin-%c5%81o%c5%9b"}, "edited": false, "score": 0, "creation_date": 1426545861, "post_id": 29079439, "comment_id": 46409372, "body": "Why the <code>dynamic-typing</code> tag?"}], "answers": [{"tags": [], "owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "is_accepted": false, "score": 1, "last_activity_date": 1426517411, "creation_date": 1426517411, "answer_id": 29079829, "question_id": 29079439, "link": "https://stackoverflow.com/questions/29079439/ghc-cannot-find-dynamic-libraries-could-not-find-module-data-functor-reverse/29079829#29079829", "title": "GHC cannot find dynamic libraries - Could not find module \u2018Data.Functor.Reverse\u2019", "body": "<p><a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2009-December/071442.html\" rel=\"nofollow\">https://mail.haskell.org/pipermail/haskell-cafe/2009-December/071442.html</a></p>\n\n<blockquote>\n  <p>Use the <code>--enable-shared</code> option to cabal install. </p>\n  \n  <p>If you want dynamic\n  libraries everywhere, put <code>shared: True</code> in <code>~/.cabal/config</code>. You'll need\n  to recompile all of your libraries.</p>\n</blockquote>\n"}], "owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 463, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1457748759, "creation_date": 1426516403, "last_edit_date": 1457748759, "question_id": 29079439, "link": "https://stackoverflow.com/questions/29079439/ghc-cannot-find-dynamic-libraries-could-not-find-module-data-functor-reverse", "title": "GHC cannot find dynamic libraries - Could not find module \u2018Data.Functor.Reverse\u2019", "body": "<p>GHCi-7.8.4 will not load anything from <code>transformers</code> library as it cannot find the GHCi file. What is wrong?</p>\n\n<pre><code>Prelude&gt; import Data.Functor.Reverse\n\n&lt;no location info&gt;:\n    Could not find module \u2018Data.Functor.Reverse\u2019\n    Perhaps you haven't installed the \"dyn\" libraries for package \u2018transformers-0.4.3.0\u2019?\n    Use -v to see a list of the files searched for.\n\nLocations searched:\n  /home/jdm/.cabal/lib/transformers-0.4.3.0/ghc-7.8.4/Data/Functor/Reverse.dyn_hi\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 5, "creation_date": 1426509984, "post_id": 29077156, "comment_id": 46387658, "body": "Start using <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow noreferrer\">Hoogle</a>; you can even use type signatures in your search. The first entry in the result of <a href=\"https://www.haskell.org/hoogle/?hoogle=%5Ba%5D+-%3E+Int\" rel=\"nofollow noreferrer\">haskell.org/hoogle/?hoogle=%5Ba%5D+-%3E+Int</a> is <code>length</code>, which does exactly what you want."}, {"owner": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "edited": false, "score": 1, "creation_date": 1426509992, "post_id": 29077156, "comment_id": 46387663, "body": "<a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Prelude.html#v:length\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.7.0.2/docs/&hellip;</a>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1426510342, "post_id": 29077156, "comment_id": 46387863, "body": "Of course you <i>should</i> use <code>length</code> for this, but I wonder... whence did you get \u201cyou can do this only if you are using a value to satisfy the condition\u201d? As a matter of fact, if you try to implement that function na&#239;vely with recursion, you&#39;ll readily see that the actually elements aren&#39;t really needed, only the list constructors are.. <code>length&#39; [] = 0</code>; <code>length&#39; (_:l) = 1 + length&#39; l</code>."}, {"owner": {"reputation": 287, "user_id": 4300537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/713271201/picture?type=large", "display_name": "Adam Piper", "link": "https://stackoverflow.com/users/4300537/adam-piper"}, "edited": false, "score": 0, "creation_date": 1426510766, "post_id": 29077156, "comment_id": 46388123, "body": "Thanks guys! That&#39;s answered my question!"}], "answers": [{"tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": true, "score": 1, "last_activity_date": 1426579128, "creation_date": 1426579128, "answer_id": 29093901, "question_id": 29077156, "link": "https://stackoverflow.com/questions/29077156/is-it-possible-to-count-the-number-of-items-in-a-haskell-list/29093901#29093901", "title": "Is it possible to count the number of items in a Haskell list?", "body": "<p><code>length :: [a] -&gt; Int</code> is a function that returns the length of any list.</p>\n\n<p>For example, <code>length [1, 1, 2, 42, 7]</code> evaluates to 5.</p>\n"}], "owner": {"reputation": 287, "user_id": 4300537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/713271201/picture?type=large", "display_name": "Adam Piper", "link": "https://stackoverflow.com/users/4300537/adam-piper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 29093901, "answer_count": 1, "score": -1, "last_activity_date": 1426579128, "creation_date": 1426509893, "question_id": 29077156, "link": "https://stackoverflow.com/questions/29077156/is-it-possible-to-count-the-number-of-items-in-a-haskell-list", "title": "Is it possible to count the number of items in a Haskell list?", "body": "<p>I am trying to count the number of items in a list in Haskell, but all i can find online is that you can do this only if you are using a value to satisfy the condition.</p>\n\n<p>I was wondering if you can use a generic <code>count :: List -&gt; Int</code> function which will give the number of elements in the list</p>\n"}, {"tags": ["haskell", "hash", "pearson"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1426502950, "post_id": 29074855, "comment_id": 46383531, "body": "A tip: If you indent lines by 4 spaces, they&#39;ll be marked as a code sample. You can also highlight the code and click the &quot;code&quot; button (with &quot;{}&quot; on it)."}, {"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 1, "creation_date": 1426506490, "post_id": 29074855, "comment_id": 46385534, "body": "It is unclear what problem you have. Stack Overflow is not a tutoring site. Be more specific."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4675920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78788376a61347e372e11e579b279a4a?s=128&d=identicon&r=PG&f=1", "display_name": "B&#225;lint Csert&#225;n", "link": "https://stackoverflow.com/users/4675920/b%c3%a1lint-csert%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1426519167, "post_id": 29075155, "comment_id": 46394053, "body": "After a quick brainstorm I would say the hashStep function will lokk like this:  hashStep :: [Int] -&gt; Int -&gt; Int hashStep ts h = ts!!(h xor c) | c &lt;- ts  But I have to think it through correctly and test it. I am sure I can figure it out on my own.  Thanks for helping!"}, {"owner": {"reputation": 3629, "user_id": 808237, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e0eac050c6be0999da0c97c4aec4554e?s=128&d=identicon&r=PG", "display_name": "Tair", "link": "https://stackoverflow.com/users/808237/tair"}, "edited": false, "score": 0, "creation_date": 1426524925, "post_id": 29075155, "comment_id": 46398082, "body": "@MathematicalOrchid didn&#39;t even look at the type signature.. thought you are suggesting a lambda and proposed a more obvious way :)"}, {"owner": {"reputation": 21, "user_id": 4675920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78788376a61347e372e11e579b279a4a?s=128&d=identicon&r=PG&f=1", "display_name": "B&#225;lint Csert&#225;n", "link": "https://stackoverflow.com/users/4675920/b%c3%a1lint-csert%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1426614655, "post_id": 29075155, "comment_id": 46442266, "body": "I got the answer!  hashStep :: [Int] -&gt; Int -&gt; Int -&gt; Int hashStep ts h c = ts!!(xor h c) Thanks a lot for the help again!"}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 4, "last_activity_date": 1426524431, "last_edit_date": 1426524431, "creation_date": 1426503567, "answer_id": 29075155, "question_id": 29074855, "link": "https://stackoverflow.com/questions/29074855/pearson-hash-implementation-in-haskell/29075155#29075155", "title": "Pearson Hash implementation in Haskell", "body": "<pre><code>h := 0\nfor each c in C loop\n    index := h xor c\n    h := T[index]\nend loop\nreturn h\n</code></pre>\n\n<p>OK, so this looks pretty imperative. When you see a loop like this, what you probably want to do is turn the \"loop body\" into a function, and then the loop itself will be either <code>foldr</code> or <code>foldl</code>. So your code ends up looking something like</p>\n\n<pre><code>hashStep :: [Int] -&gt; Int -&gt; Int -&gt; Int\nhashStep ts h c = ...???...\n\npearsonHash :: [Int] -&gt; [Int] -&gt; Int\npearsonHash ts cs = foldr (hash_step ts) 0 cs\n</code></pre>\n\n<p>Now, can you figure out what <code>hashStep</code> should do?</p>\n"}], "owner": {"reputation": 21, "user_id": 4675920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78788376a61347e372e11e579b279a4a?s=128&d=identicon&r=PG&f=1", "display_name": "B&#225;lint Csert&#225;n", "link": "https://stackoverflow.com/users/4675920/b%c3%a1lint-csert%c3%a1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 29075155, "answer_count": 1, "score": 1, "last_activity_date": 1426524431, "creation_date": 1426502621, "last_edit_date": 1426505993, "question_id": 29074855, "link": "https://stackoverflow.com/questions/29074855/pearson-hash-implementation-in-haskell", "title": "Pearson Hash implementation in Haskell", "body": "<p>I have to write this Pearson Hash for school, but I never heard of it so it's difficult to imagine how it works. That is makes things more difficult that I learned haskell a long time ago and I almost forgot it.</p>\n\n<p>Here is the thing:\nThey gave me that the syntac of this function will be this:</p>\n\n<pre><code>pearsonHash :: [Int] -&gt; [Int] -&gt; Int\n</code></pre>\n\n<p>and the algorithm of Pearson Hash is:</p>\n\n<pre><code>h := 0\nfor each c in C loop\n    index := h xor c\n    h := T[index]\nend loop\nreturn h\n</code></pre>\n\n<p>They said, that: Let <em>C</em> be the input sequence of bytes, and <em>h</em> the value to be calculated. And the first parameter of pearson hash should a a predefined <em>T</em> list which contains a permutation of <code>[0..255]</code>.</p>\n\n<p>There are the test cases:</p>\n\n<pre><code>pearsonHash ([0..127] ++ [255,254..128]) [1..10]   ==  11\npearsonHash [255,254..0] [ ord c | c &lt;- \"Hello\" ]  ==  189\n</code></pre>\n\n<p>I think they should be <code>True</code>.</p>\n\n<p>This is just a part of the work (meaning this is only one function from a lot), so I don't want you to solve this instead of me, I just need help how to solve this function because I got stuck with this one.</p>\n"}, {"tags": ["haskell", "functional-programming", "functor"], "answers": [{"comments": [{"owner": {"reputation": 2695, "user_id": 1924798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1ba7bffbe41ca39353b6f8bbfd4624a8?s=128&d=identicon&r=PG", "display_name": "Marco Faustinelli", "link": "https://stackoverflow.com/users/1924798/marco-faustinelli"}, "edited": false, "score": 0, "creation_date": 1426526801, "post_id": 29073742, "comment_id": 46399358, "body": "Here is what I&#39;m typing in: *Main &gt; let x1 = [Node 1 Empty Empty] *Main &gt; let x2 = x1 fmap (fmap succ) ERROR! What I am doing wrong? Now I try with the Maybe...."}, {"owner": {"reputation": 2695, "user_id": 1924798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1ba7bffbe41ca39353b6f8bbfd4624a8?s=128&d=identicon&r=PG", "display_name": "Marco Faustinelli", "link": "https://stackoverflow.com/users/1924798/marco-faustinelli"}, "edited": false, "score": 0, "creation_date": 1426527069, "post_id": 29073742, "comment_id": 46399503, "body": "Still unable to make it work: *Main&gt; let y1 = Node (Just 1) Empty Empty *Main&gt; let y2 = y1 fmap (fmap succ) ERROR!"}, {"owner": {"reputation": 2695, "user_id": 1924798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1ba7bffbe41ca39353b6f8bbfd4624a8?s=128&d=identicon&r=PG", "display_name": "Marco Faustinelli", "link": "https://stackoverflow.com/users/1924798/marco-faustinelli"}, "edited": false, "score": 0, "creation_date": 1426527118, "post_id": 29073742, "comment_id": 46399535, "body": "That&#39;s why I asked explicitly for a &quot;clear and complete working example&quot;. Thank you!"}, {"owner": {"reputation": 2695, "user_id": 1924798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1ba7bffbe41ca39353b6f8bbfd4624a8?s=128&d=identicon&r=PG", "display_name": "Marco Faustinelli", "link": "https://stackoverflow.com/users/1924798/marco-faustinelli"}, "edited": false, "score": 0, "creation_date": 1426568808, "post_id": 29073742, "comment_id": 46415310, "body": "OK, I goofed big time with x1/y1 in front of the fmappings. But I KNEW there had to be some trick under the hood. This time is -XDeriveFunctor."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 2695, "user_id": 1924798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1ba7bffbe41ca39353b6f8bbfd4624a8?s=128&d=identicon&r=PG", "display_name": "Marco Faustinelli", "link": "https://stackoverflow.com/users/1924798/marco-faustinelli"}, "edited": false, "score": 1, "creation_date": 1426579643, "post_id": 29073742, "comment_id": 46419354, "body": "@Muzietto You can avoid <code>-XDeriveFunctor</code> if you manually define a functor instance. However, since GHC now can derive that automatically, it&#39;s more convenient to just let it do that."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1426541508, "last_edit_date": 1426541508, "creation_date": 1426499391, "answer_id": 29073742, "question_id": 29073227, "link": "https://stackoverflow.com/questions/29073227/understanding-operations-on-composed-functor-types/29073742#29073742", "title": "Understanding operations on composed functor types", "body": "<p>The type of <code>x</code> is <code>f (g a)</code>. For example, <code>x</code> might be a list of trees of integers: <code>[Tree Int]</code> (which can also be written as <code>[] (Tree Int)</code> so that it matches <code>f (g x)</code> more closely). </p>\n\n<p>As an example, consider function <code>succ :: Int -&gt; Int</code> which adds one to an integer. Then, function <code>fmap succ :: Tree Int -&gt; Tree Int</code> will increment every integer in the tree. Further, <code>fmap (fmap succ) :: [Tree Int] -&gt; [Tree Int]</code> will apply the previous <code>fmap succ</code> to all the trees in a list, hence it will increment every integer in the list of trees.</p>\n\n<p>If instead you have <code>Tree (Maybe Int)</code>, then <code>fmap (fmap succ)</code> will increment every integer in such tree. Values in the tree of the form <code>Nothing</code> will not be affected, while values <code>Just x</code> will have <code>x</code> incremented.</p>\n\n<p>Example: (GHCi session)</p>\n\n<pre><code>&gt; :set -XDeriveFunctor\n&gt; data Tree a = Node a (Tree a) (Tree a) | Empty deriving (Show, Functor)\n&gt; let x1 = [Node 1 Empty Empty]\n&gt; fmap (fmap succ) x1\n[Node 2 Empty Empty]\n&gt; let x2 = [Node 1 Empty Empty, Node 2 (Node 3 Empty Empty) Empty]\n&gt; fmap (fmap succ) x2\n[Node 2 Empty Empty,Node 3 (Node 4 Empty Empty) Empty]\n&gt; let x3 = Just (Node 1 Empty Empty)\n&gt; fmap (fmap succ) x3\nJust (Node 2 Empty Empty)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2695, "user_id": 1924798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1ba7bffbe41ca39353b6f8bbfd4624a8?s=128&d=identicon&r=PG", "display_name": "Marco Faustinelli", "link": "https://stackoverflow.com/users/1924798/marco-faustinelli"}, "edited": false, "score": 1, "creation_date": 1426502000, "post_id": 29073937, "comment_id": 46382970, "body": "Great answer! They say teaching to fish is better than providing one fish. Thank you. Now I wonder if there&#39;s the possibility to specify which fmap belongs to the f instance and which to the g. I understand that the compiler is super-smart and infers that wonderfully, but humans are another thing..."}, {"owner": {"reputation": 2695, "user_id": 1924798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1ba7bffbe41ca39353b6f8bbfd4624a8?s=128&d=identicon&r=PG", "display_name": "Marco Faustinelli", "link": "https://stackoverflow.com/users/1924798/marco-faustinelli"}, "edited": false, "score": 0, "creation_date": 1426502491, "post_id": 29073937, "comment_id": 46383250, "body": "&quot;we guess that we should fmap something over x to get an f (g b)&quot; - that&#39;s a key learning point."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 18, "last_activity_date": 1426512521, "last_edit_date": 1426512521, "creation_date": 1426499918, "answer_id": 29073937, "question_id": 29073227, "link": "https://stackoverflow.com/questions/29073227/understanding-operations-on-composed-functor-types/29073937#29073937", "title": "Understanding operations on composed functor types", "body": "<blockquote>\n  <p>what is the type of x in the last definition?</p>\n</blockquote>\n\n<p>Before saying anything else about the matter: you can ask GHC! GHC 7.8 and above supports <code>TypedHoles</code>, meaning that if you place an underscore in a expression (not pattern), and hit load or compile, you get a message with the expected type of the underscore and the types of the variables in local scope.</p>\n\n<pre><code>newtype Compose f g a = Compose { getCompose :: f (g a) }\n\ninstance (Functor f, Functor g) =&gt; Functor (Compose f g) where\n    fmap f (Compose x) = _\n</code></pre>\n\n<p>GHC says now, with some parts omitted:</p>\n\n<pre><code>Notes.hs:6:26: Found hole \u2018_\u2019 with type: Compose f g b \u2026\n    -- omitted type variable bindings --\n    Relevant bindings include\n      x :: f (g a)\n        (bound at /home/kutta/home/Dropbox/src/haskell/Notes.hs:6:21)\n      f :: a -&gt; b\n        (bound at /home/kutta/home/Dropbox/src/haskell/Notes.hs:6:10)\n      fmap :: (a -&gt; b) -&gt; Compose f g a -&gt; Compose f g b\n        (bound at /home/kutta/home/Dropbox/src/haskell/Notes.hs:6:5)\n    In the expression: _\n    In an equation for \u2018fmap\u2019: fmap f (Compose x) = _\n    In the instance declaration for \u2018Functor (Compose f g)\u2019\n</code></pre>\n\n<p>There you go, <code>x :: f (g a)</code>. And after some practice, <code>TypedHoles</code> can help you tremendously in figuring out complex polymorphic code. Let's try to figure out our current code out by writing out the right hand side from scratch.</p>\n\n<p>We've already seen that the hole had type <code>Compose f g b</code>. Therefore we must have a <code>Compose _</code> on the right side:</p>\n\n<pre><code>instance (Functor f, Functor g) =&gt; Functor (Compose f g) where\n    fmap f (Compose x) = Compose _\n</code></pre>\n\n<p>The new hole has type <code>f (g b)</code>. Now we should look at the context:</p>\n\n<pre><code>Relevant bindings include\n  x :: f (g a)\n    (bound at /home/kutta/home/Dropbox/src/haskell/Notes.hs:6:21)\n  f :: a -&gt; b\n    (bound at /home/kutta/home/Dropbox/src/haskell/Notes.hs:6:10)\n  fmap :: (a -&gt; b) -&gt; Compose f g a -&gt; Compose f g b\n    (bound at /home/kutta/home/Dropbox/src/haskell/Notes.hs:6:5)\n</code></pre>\n\n<p>The goal is to get an <code>f (g b)</code> out of the ingredients in the context. The <code>fmap</code> in the listing above unfortunately refers to the function being defined, which is sometimes helpful, but not here. We're better off knowing that <code>f</code> and <code>g</code> are both functors, therefore they can be <code>fmap</code>-ed over. Since we have <code>x :: f (g a)</code>, we guess that we should <code>fmap</code> something over <code>x</code> to get an <code>f (g b)</code>:</p>\n\n<pre><code>fmap f (Compose x) = Compose (fmap _ x)\n</code></pre>\n\n<p>Now the hole becomes <code>g a -&gt; g b</code>. But <code>g a -&gt; g b</code> is very easy now, since we have <code>f :: a -&gt; b</code> and <code>g</code> is a <code>Functor</code>, so we also have <code>fmap :: (a -&gt; b) -&gt; g a -&gt; g b</code>, and therefore <code>fmap f :: g a -&gt; g b</code>. </p>\n\n<pre><code>fmap f (Compose x) = Compose (fmap (fmap f) x)\n</code></pre>\n\n<p>And we're done. </p>\n\n<p>To wrap up the technique: </p>\n\n<ol>\n<li><p>Start with putting a hole in the place where you don't know how to proceed. Here we started with putting the hole in place of the entire right hand side, but often you will have a good idea about most parts of an implementation and you'll need the hole in a specific problematic subexpression. </p></li>\n<li><p>By looking at the types, try to narrow down which implementations could possibly lead to the goal and which could not. Fill in a new expression and reposition the hole. In proof assistant jargon this is called \"refining\". </p></li>\n<li><p>Repeat step 2 until you either have the goal, in which case you're done, or the current goal seems impossible, in which case backtrack until the last non-obvious choice you made, and try an alternative refining. </p></li>\n</ol>\n\n<p>The above technique is sometimes facetiously called \"type tetris\". A possible drawback is that you can implement complex code just by playing the \"tetris\", without actually understanding what you're doing. And sometimes after going too far, you get seriously stuck in the game, and then you have to start actually thinking about the problem. But ultimately it lets you understand code that would be otherwise very difficult to grasp. </p>\n\n<p>I personally use <code>TypedHoles</code> <em>all the time</em> and basically as a reflex. I've come to rely so much on it so that on a occasion when I had to move  back to GHC 7.6 I felt rather uncomfortable (but fortunately you <a href=\"https://www.youtube.com/watch?v=52VsgyexS8Q\">can emulate holes</a> even there). </p>\n"}], "owner": {"reputation": 2695, "user_id": 1924798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1ba7bffbe41ca39353b6f8bbfd4624a8?s=128&d=identicon&r=PG", "display_name": "Marco Faustinelli", "link": "https://stackoverflow.com/users/1924798/marco-faustinelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 490, "favorite_count": 0, "accepted_answer_id": 29073742, "answer_count": 2, "score": 11, "last_activity_date": 1426541508, "creation_date": 1426497629, "question_id": 29073227, "link": "https://stackoverflow.com/questions/29073227/understanding-operations-on-composed-functor-types", "title": "Understanding operations on composed functor types", "body": "<p>According to several sources, the Haskell implementation for composing functors is more or less the following:</p>\n\n<pre><code>import Data.Functor.Compose\n\nnewtype Compose f g a = Compose { getCompose :: f (g a) }\n\ninstance (Functor f, Functor g) =&gt; Functor (Compose f g) where\n    fmap f (Compose x) = Compose (fmap (fmap f) x)\n</code></pre>\n\n<p>My question is: <strong>what is the type of x in the last definition?</strong></p>\n\n<p>I'd say it is <code>f g a</code>, but even there I struggle to 'see' the computation <code>fmap (fmap f) x</code></p>\n\n<p>Could anyone be as kind as to provide a clear and complete working example of this point? What about fmapping a <code>Tree</code> of <code>Maybe</code>'s paying attention to both <code>Empty</code>'s and <code>Node</code>'s?</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "edited": false, "score": 1, "creation_date": 1426492326, "post_id": 29071549, "comment_id": 46378115, "body": "Do you have a use case in mind?"}], "answers": [{"tags": [], "owner": {"reputation": 5665, "user_id": 982084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mLw2v.jpg?s=128&g=1", "display_name": "WilQu", "link": "https://stackoverflow.com/users/982084/wilqu"}, "is_accepted": false, "score": 3, "last_activity_date": 1426493614, "creation_date": 1426493614, "answer_id": 29072193, "question_id": 29071549, "link": "https://stackoverflow.com/questions/29071549/choose-function-based-on-class/29072193#29072193", "title": "Choose function based on class", "body": "<p>Wrap the value in another type, for example <code>Either</code> or a custom type</p>\n\n<p>Example with <code>Either</code>:</p>\n\n<pre><code>h :: (C1 a, C2 b) =&gt; Either a b -&gt; Int\nh = either f g\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1426495236, "creation_date": 1426495236, "answer_id": 29072590, "question_id": 29071549, "link": "https://stackoverflow.com/questions/29071549/choose-function-based-on-class/29072590#29072590", "title": "Choose function based on class", "body": "<p>This is impossible, since it would cope with separate compilation. Consider</p>\n\n<pre><code>module A where\n\ndata A = A Int\n\nisOfClassEq :: a -&gt; Bool\nisOfClassEq = &lt;&lt;some magic here&gt;&gt;\n\ntest :: Bool\ntest = isOfClassEq (A 42)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>module Main where\nimport A\ninstance Eq A where (A x) == (A y) = x == y\nmain = print test\n</code></pre>\n\n<p>If I opened module <code>A</code> in GHCi, <code>test</code> would evaluate to <code>False</code>. So, the code associated to <code>test</code> must return <code>False</code>. Instead if I load module <code>Main</code> and run <code>main</code> I should see <code>True</code>. If we have separate compilation, since the compiler can not know about the instance when compiling module <code>A</code>, is has to generate code for <code>test</code> which checks the class membership at runtime.</p>\n\n<p>This would require GHC to keep <em>runtime</em> all the type information, including a type&lt;->class table to perform checks. However, Haskell is designed so that type information can be discarded during compile time.</p>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1426495236, "creation_date": 1426490683, "question_id": 29071549, "link": "https://stackoverflow.com/questions/29071549/choose-function-based-on-class", "title": "Choose function based on class", "body": "<p>Is there anyway, even using a bizarre combination of GHC extensions, make a function <code>h</code> like the following psudeocode:</p>\n\n<pre><code>f :: (C1 a) =&gt; a -&gt; Int\ng :: (C2 a) =&gt; a -&gt; Int\n\nh x = \n  if (isOfClass C1 x) then (f x) \n  else if (isOfClass C2 x) then (g x)\n  else COMPILE_ERROR\n</code></pre>\n\n<p>Note that if <code>x</code> is both of class <code>C1</code> and <code>C2</code> I don't mind if I get inconsistent behaviour depending on what's in scope. </p>\n"}, {"tags": ["haskell", "partial-application"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1426473259, "post_id": 29068729, "comment_id": 46372902, "body": "It&#39;s not really clear what you want.  Could you possibly write some pseudo-code to demonstrate the behavior you need?  It might be that you&#39;re trying to solve the problem wrong, since a partially applied function is still a function, not an integer value.  You seem to have noticed the confusion where you want to partially apply something of only one argument, so can you elaborate on your problem a bit more?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1426475336, "post_id": 29068729, "comment_id": 46373348, "body": "Why did you remove the original problem text?"}, {"owner": {"reputation": 1504, "user_id": 4501438, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bdc836549c995c4f675aff01c6162a7b?s=128&d=identicon&r=PG&f=1", "display_name": "Nived", "link": "https://stackoverflow.com/users/4501438/nived"}, "edited": false, "score": 0, "creation_date": 1426475721, "post_id": 29068729, "comment_id": 46373428, "body": "i was able to solve the question in the answer i submitted on the question."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426475947, "post_id": 29068729, "comment_id": 46373475, "body": "@DevinHolland, your answer does not use partial application, and you still haven&#39;t answered my question."}, {"owner": {"reputation": 1504, "user_id": 4501438, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bdc836549c995c4f675aff01c6162a7b?s=128&d=identicon&r=PG&f=1", "display_name": "Nived", "link": "https://stackoverflow.com/users/4501438/nived"}, "edited": false, "score": 0, "creation_date": 1426476175, "post_id": 29068729, "comment_id": 46373528, "body": "@dfeur I&#39;m not quite sure how you mean it&#39;s not using partial applications...each of the two functions double and addOne take an argument but i pass none in when i call them."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426476958, "post_id": 29068729, "comment_id": 46373690, "body": "Eh, I guess technically <i>one</i> of them is partially applied (can you see which)? But so far the only reason I can see for removing the question text is to keep your teacher from finding it."}], "answers": [{"tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": false, "score": 1, "last_activity_date": 1426473384, "creation_date": 1426473384, "answer_id": 29068831, "question_id": 29068729, "link": "https://stackoverflow.com/questions/29068729/haskell-partial-applications-to-add-1-and-double/29068831#29068831", "title": "Haskell partial applications to add 1 and double", "body": "<p>Your assignment is almost certainly asking you to <em>use</em> partial applications of something else to <em>implement</em> the \"increment by one\" and \"double\" operations. It's not asking you to partially apply those operations.</p>\n\n<p>For example in the title of this very question you wrote \"add 1\" to mean your increment operation; isn't that just the partial application of an addition operation (which takes two operations) to a single argument (namely 1) to get a operation that takes only a single argument?</p>\n"}, {"comments": [{"owner": {"reputation": 1504, "user_id": 4501438, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bdc836549c995c4f675aff01c6162a7b?s=128&d=identicon&r=PG&f=1", "display_name": "Nived", "link": "https://stackoverflow.com/users/4501438/nived"}, "edited": false, "score": 0, "creation_date": 1426473784, "post_id": 29068836, "comment_id": 46373023, "body": "So how can i run them both in sequence...like partially apply add and multiply in one function?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 1504, "user_id": 4501438, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bdc836549c995c4f675aff01c6162a7b?s=128&d=identicon&r=PG&f=1", "display_name": "Nived", "link": "https://stackoverflow.com/users/4501438/nived"}, "edited": false, "score": 0, "creation_date": 1426473856, "post_id": 29068836, "comment_id": 46373042, "body": "@DevinHolland <code>add_one_then_double = double . add_one</code>"}, {"owner": {"reputation": 1935, "user_id": 1106715, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/75062970dfbbbf538f1b99d883197482?s=128&d=identicon&r=PG", "display_name": "charleyh", "link": "https://stackoverflow.com/users/1106715/charleyh"}, "edited": false, "score": 0, "creation_date": 1426473888, "post_id": 29068836, "comment_id": 46373047, "body": "You can just apply both of the new function to a value, like <code>double ( add_one 2)</code> to apply it to the value 2. If you wanted to create a function to do these in sequence, you could use function composition, like this: <code>increment_double = double . add_one</code> That notation created a new function that sequences the functions separated by periods from right to left."}, {"owner": {"reputation": 1504, "user_id": 4501438, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bdc836549c995c4f675aff01c6162a7b?s=128&d=identicon&r=PG&f=1", "display_name": "Nived", "link": "https://stackoverflow.com/users/4501438/nived"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1426474047, "post_id": 29068836, "comment_id": 46373077, "body": "@zerkms Currently am using doubleIncr = multiply . add 1 and it gives me an error"}, {"owner": {"reputation": 1935, "user_id": 1106715, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/75062970dfbbbf538f1b99d883197482?s=128&d=identicon&r=PG", "display_name": "charleyh", "link": "https://stackoverflow.com/users/1106715/charleyh"}, "reply_to_user": {"reputation": 1504, "user_id": 4501438, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bdc836549c995c4f675aff01c6162a7b?s=128&d=identicon&r=PG&f=1", "display_name": "Nived", "link": "https://stackoverflow.com/users/4501438/nived"}, "edited": false, "score": 0, "creation_date": 1426474204, "post_id": 29068836, "comment_id": 46373102, "body": "@DevinHolland You&#39;ll need to partially apply the 2 to the multiply also, like this (assuming you have already defined add and multiply): <code>doubleIncr = multiply 2 . add 1</code>"}, {"owner": {"reputation": 1504, "user_id": 4501438, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bdc836549c995c4f675aff01c6162a7b?s=128&d=identicon&r=PG&f=1", "display_name": "Nived", "link": "https://stackoverflow.com/users/4501438/nived"}, "edited": false, "score": 0, "creation_date": 1426476352, "post_id": 29068836, "comment_id": 46373564, "body": "@charleyh do i have to use two parameters for them? Could I just use double . addOne with double and addOne just taking 1 parameter and adding 1 to it and similar for double?"}, {"owner": {"reputation": 1935, "user_id": 1106715, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/75062970dfbbbf538f1b99d883197482?s=128&d=identicon&r=PG", "display_name": "charleyh", "link": "https://stackoverflow.com/users/1106715/charleyh"}, "reply_to_user": {"reputation": 1504, "user_id": 4501438, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bdc836549c995c4f675aff01c6162a7b?s=128&d=identicon&r=PG&f=1", "display_name": "Nived", "link": "https://stackoverflow.com/users/4501438/nived"}, "edited": false, "score": 0, "creation_date": 1426476489, "post_id": 29068836, "comment_id": 46373598, "body": "@DevinHolland yep, <code>doubleIncr = double . addOne</code> works fine, assuming that you already define double and addOne. Using <code>doubleIncr = multiply 2 . add 1</code> just might be less verbose if you won&#39;t need to use a doubling or incrementing function on its own again"}, {"owner": {"reputation": 1504, "user_id": 4501438, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bdc836549c995c4f675aff01c6162a7b?s=128&d=identicon&r=PG&f=1", "display_name": "Nived", "link": "https://stackoverflow.com/users/4501438/nived"}, "edited": false, "score": 0, "creation_date": 1426476594, "post_id": 29068836, "comment_id": 46373623, "body": "@charleyh yeah this is just for one question in an assignment...not going to be reused ever. i defined <code>double a = a *2  and addOne a = a + 1 </code>"}, {"owner": {"reputation": 1935, "user_id": 1106715, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/75062970dfbbbf538f1b99d883197482?s=128&d=identicon&r=PG", "display_name": "charleyh", "link": "https://stackoverflow.com/users/1106715/charleyh"}, "reply_to_user": {"reputation": 1504, "user_id": 4501438, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bdc836549c995c4f675aff01c6162a7b?s=128&d=identicon&r=PG&f=1", "display_name": "Nived", "link": "https://stackoverflow.com/users/4501438/nived"}, "edited": false, "score": 0, "creation_date": 1426476742, "post_id": 29068836, "comment_id": 46373649, "body": "@DevinHolland Although those are functionally the same, that isn&#39;t actually partial application, so if its for an assignment, it might be considered wrong. You need to actually define a function like <code>addOne = (+1)</code> for it to be partially applied."}], "tags": [], "owner": {"reputation": 1935, "user_id": 1106715, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/75062970dfbbbf538f1b99d883197482?s=128&d=identicon&r=PG", "display_name": "charleyh", "link": "https://stackoverflow.com/users/1106715/charleyh"}, "is_accepted": true, "score": 1, "last_activity_date": 1426474301, "last_edit_date": 1426474301, "creation_date": 1426473395, "answer_id": 29068836, "question_id": 29068729, "link": "https://stackoverflow.com/questions/29068729/haskell-partial-applications-to-add-1-and-double/29068836#29068836", "title": "Haskell partial applications to add 1 and double", "body": "<p>It sounds like you are supposed to use functions that take two arguments and partially apply them to arrive with the functions that take one argument. To increment a number by one using partial application, you might do something like this:</p>\n\n<pre><code>add a b = a + b\nadd_one = add 1\n</code></pre>\n\n<p>You take a function to add two numbers and partially apply it with one, so now you have a function that adds one to a number. The same principle applies to doubling.</p>\n\n<pre><code>multiply a b = a * b\ndouble = multiply 2\n</code></pre>\n\n<p>The doubling function is just 2 partially applied to multiplication. To combine these, you can use function composition:</p>\n\n<pre><code>doubleIncr = multiply 2 . add 1\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 1504, "user_id": 4501438, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bdc836549c995c4f675aff01c6162a7b?s=128&d=identicon&r=PG&f=1", "display_name": "Nived", "link": "https://stackoverflow.com/users/4501438/nived"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "closed_date": 1427176051, "accepted_answer_id": 29068836, "answer_count": 2, "score": 0, "last_activity_date": 1426475262, "creation_date": 1426472675, "last_edit_date": 1426475262, "question_id": 29068729, "link": "https://stackoverflow.com/questions/29068729/haskell-partial-applications-to-add-1-and-double", "closed_reason": "Needs details or clarity", "title": "Haskell partial applications to add 1 and double", "body": "<p>I have to write a program that takes in an Integer and then uses two partial applications to first increment the number by one and then the second partial application doubles it. I know that a partial application would be one that would take less arguments than specified but each of these partial applications only needs 1 input. Does that mean I'm not passing anything into either of the partial applications? That really seems wrong/weird to me. Any help on where to start on the partial applications would be greatly appreciated</p>\n"}, {"tags": ["haskell", "syntax-error"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1426472469, "post_id": 29068636, "comment_id": 46372733, "body": "Unrelatedly, <code>interact</code> is virtually never the right way to do I/O in Haskell."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 5, "creation_date": 1426473828, "post_id": 29068636, "comment_id": 46373035, "body": "@dfeuer: there&#39;s nothing wrong with using <code>interact</code> for simple \u201cI just want to have that Haskell function in the shell\u201d -kind of programs. Of course <code>String</code> is always inefficient, but for many such applications that totally doesn&#39;t matter."}, {"owner": {"reputation": 532, "user_id": 1639848, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a149ce115d260987b3a8db22aba70e58?s=128&d=identicon&r=PG", "display_name": "user1639848", "link": "https://stackoverflow.com/users/1639848/user1639848"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1426473959, "post_id": 29068636, "comment_id": 46373061, "body": "@dfeuer I agree, I am just doing this exercise with the existing boilerplate from the book, I haven&#39;t reached the kinda expertise level you have in haskell, but I understand good design and mostly in later stages of the book I&#39;ll learn the &quot;right way&quot; thanks for the comment though"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1426474483, "post_id": 29068636, "comment_id": 46373155, "body": "@leftaroundabout, I like when <code>String</code> fuses away. @user1639848, I&#39;m no expert; I just know that the old &quot;if all you have is a hammer, everything looks like a nail&quot; applies to Haskell, and some people end up taking <code>interact</code> <i>way</i> past the point of sanity."}], "answers": [{"tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": false, "score": 13, "last_activity_date": 1426472197, "creation_date": 1426472197, "answer_id": 29068674, "question_id": 29068636, "link": "https://stackoverflow.com/questions/29068636/haskell-nested-where-clauses/29068674#29068674", "title": "Haskell nested where clauses", "body": "<p>Since your second <code>where</code> is attached to the <code>wordCount</code> definition, it needs to be indented more than it.  (Although you will still have some other errors afterward.)</p>\n"}, {"tags": [], "owner": {"reputation": 532, "user_id": 1639848, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a149ce115d260987b3a8db22aba70e58?s=128&d=identicon&r=PG", "display_name": "user1639848", "link": "https://stackoverflow.com/users/1639848/user1639848"}, "is_accepted": false, "score": 3, "last_activity_date": 1426474112, "creation_date": 1426474112, "answer_id": 29068921, "question_id": 29068636, "link": "https://stackoverflow.com/questions/29068636/haskell-nested-where-clauses/29068921#29068921", "title": "Haskell nested where clauses", "body": "<p>the indentation was incorrect, here's the working version:</p>\n\n<pre><code>-- test comment\nimport Data.List\nmain = interact wordCount\n    where wordCount input = unlines $ [concat $ intersperse \" \" (map show [ls, ws, cs])]\n            where ls = length $ lines input\n                  ws = length $ words input\n                  cs = length input\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 10, "last_activity_date": 1610476641, "last_edit_date": 1610476641, "creation_date": 1426496272, "answer_id": 29072838, "question_id": 29068636, "link": "https://stackoverflow.com/questions/29068636/haskell-nested-where-clauses/29072838#29072838", "title": "Haskell nested where clauses", "body": "<p>Others have already answered. I will just add some more explanation.</p>\n<p>Simplifying a bit, the Haskell indentation rule is:</p>\n<ul>\n<li>Some keywords start a block of things (<code>where</code>,<code>let</code>,<code>do</code>,<code>case ... of</code>).</li>\n<li>Find the first word after such keywords and note its indentation. Name the column it occurs the pivot column.</li>\n<li>Start a line exactly on the pivot to define a new entry in the block.</li>\n<li>Start a line after the pivot to continue the entry started in the previous lines.</li>\n<li>Start a line before the pivot to end the block.</li>\n</ul>\n<p>Hence,</p>\n<pre><code>where\n     wordCount input = show (ls ++ &quot; &quot; ++ ws ++ &quot; &quot; ++ cs  ++ &quot;\\n&quot;)\n     where\n         ls = lines input\n         ws = length words input\n         cs = length input\n</code></pre>\n<p>Actually means</p>\n<pre><code>where {\n     wordCount input = show (ls ++ &quot; &quot; ++ ws ++ &quot; &quot; ++ cs  ++ &quot;\\n&quot;)\n     ;\n     where {     -- same column, new entry\n         ls = lines input\n         ;   -- same column, new entry\n         ws = length words input\n         ;   -- same column, new entry\n         cs = length input\n         }\n     }\n</code></pre>\n<p>which treats the second <code>where</code> as a separate definition unrelated to <code>wordCount</code>. If we indent it more, it will work:</p>\n<pre><code>where {\n     wordCount input = show (ls ++ &quot; &quot; ++ ws ++ &quot; &quot; ++ cs  ++ &quot;\\n&quot;)\n       where {     -- after the pivot, same entry\n         ls = lines input\n         ;\n         ws = length words input\n         ;\n         cs = length input\n         }\n     }\n</code></pre>\n"}], "owner": {"reputation": 532, "user_id": 1639848, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a149ce115d260987b3a8db22aba70e58?s=128&d=identicon&r=PG", "display_name": "user1639848", "link": "https://stackoverflow.com/users/1639848/user1639848"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6820, "favorite_count": 3, "answer_count": 3, "score": 11, "last_activity_date": 1610476641, "creation_date": 1426471910, "question_id": 29068636, "link": "https://stackoverflow.com/questions/29068636/haskell-nested-where-clauses", "title": "Haskell nested where clauses", "body": "<p>I am a beginner coder in haskell, while doing an exercise from the first chapter of this amazing book: <a href=\"http://book.realworldhaskell.org/read/getting-started.html\">http://book.realworldhaskell.org/read/getting-started.html</a>\nI came across this issue:</p>\n\n<pre><code>-- test comment\nmain = interact wordCount\n where\n     wordCount input = show (ls ++ \" \" ++ ws ++ \" \" ++ cs  ++ \"\\n\")\n     where\n         ls = lines input\n         ws = length words input\n         cs = length input\n\n\n\nwonderbox:ch01 manasapte$ runghc WC &lt; quux.txt\nWC.hs:5:9: parse error on input \u2018where\u2019\n</code></pre>\n\n<p>Why can I not nest my wheres ?</p>\n"}, {"tags": ["parsing", "haskell", "attoparsec"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1426477608, "post_id": 29068531, "comment_id": 46373838, "body": "I assume you mean <code>Data.Attoparsec.Text.sepBy</code>?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1426477762, "post_id": 29068531, "comment_id": 46373875, "body": "Also, Hoogle can&#39;t find <code>takeTill&#39;</code>, and <code>takeTill</code> does not look like something you&#39;re really likely to want here."}, {"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426483730, "post_id": 29068531, "comment_id": 46375189, "body": "Thanks, I did mean <code>Data.Attoparsec.Text.sepBy</code>. <code>takeTill&#39;</code> is a helper function I made that does <code>takeTill</code> + also discards the next character (I added the source for that to the question). My line of thinking is: discard up to the first <code>{</code>. Then take the input up to the closing <code>}</code> (that&#39;s the <code>takeTill&#39;</code> part). Then parse that in-between text into the (key, value) pairs."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 3, "creation_date": 1426484711, "post_id": 29068531, "comment_id": 46375468, "body": "Be careful with that strategy.  What if I returned <code>Parameters: {&quot;data&quot; =&gt; &quot;{}&quot;}</code> ?"}, {"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 0, "creation_date": 1426486190, "post_id": 29068531, "comment_id": 46375892, "body": "I think I&#39;m protected against having <code>{}</code> inside the parameters because those characters need to be escaped in a URL (same with the comma and space), though I&#39;m open to solutions that don&#39;t depend on that."}, {"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1426486748, "post_id": 29068531, "comment_id": 46376060, "body": "Oh darn, good call @luqui. I just checked and I found <code>@</code> signs inside the URL parameters, so that must mean that <code>{</code> <code>}</code> <code>,</code> and ` ` aren&#39;t escaped either well. I&#39;ll have to account for that."}], "owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1426483561, "creation_date": 1426470983, "last_edit_date": 1426483561, "question_id": 29068531, "link": "https://stackoverflow.com/questions/29068531/how-can-i-parse-up-to-a-character-then-parse-what-that-matches-in-attoparsec", "title": "How can I parse up to a character, then parse what that matches in Attoparsec?", "body": "<p>I'm writing a parser for a logfile. One of the lines in the logfile lists the parameters of an HTTP request:</p>\n\n<pre><code>  Parameters: {\"back\"=&gt;\"true\", \"embed_key\"=&gt;\"12affbbace\", \"action\"=&gt;\"index\", \"ajax\"=&gt;\"1\", \"controller\"=&gt;\"heyzap\", \"embed\"=&gt;\"1\"}\n</code></pre>\n\n<p>I'm having trouble parsing this with Attoparsec. My basic idea is to parse and discard <code>Parameters: {</code>, then keep the text up to <code>}</code>. Then I'll parse that text into a list of <code>(key, value)</code> tuples. Here's what I've got so far:</p>\n\n<pre><code>parseParams :: Parser [(Text, Text)]\nparseParams = do\n    paramString &lt;- \"  Parameters: {\" *&gt; takeTill' (== '}')\n    let params = splitOn \", \" paramString\n    -- I'm not sure how to apply parseParamPair to params here\n\nparseParamPair :: Parser (Text, Text)\nparseParamPair = do\n    key &lt;- parseKeyOrValue\n    value &lt;- string \"=&gt;\" &gt;&gt; parseKeyOrValue\n    return (key, value)\n    where\n        parseKeyOrValue :: Parser Text\n        parseKeyOrValue = char '\"' &gt;&gt; takeTill' (== '\"')\n\ntakeTill' :: (Char -&gt; Bool) -&gt; Parser Text\ntakeTill' func = takeTill func &lt;* skip func\n</code></pre>\n\n<p>How can I implement this? Should I be using <code>Data.Attoparsec.Text.sepBy</code> somehow? </p>\n"}, {"tags": ["haskell", "haskell-pipes"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 349809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4547960d04d87146cd5cf2a238eee36?s=128&d=identicon&r=PG", "display_name": "Itkovian", "link": "https://stackoverflow.com/users/349809/itkovian"}, "edited": false, "score": 1, "creation_date": 1494510951, "post_id": 29071965, "comment_id": 74868166, "body": "That should be <code>fromSocket socket 4096</code>?"}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 3, "last_activity_date": 1494532740, "last_edit_date": 1494532740, "creation_date": 1426492568, "answer_id": 29071965, "question_id": 29068221, "link": "https://stackoverflow.com/questions/29068221/parsing-a-stream-of-json-with-pipes-aeson/29071965#29071965", "title": "Parsing a stream of JSON with pipes-aeson", "body": "<p><a href=\"http://hackage.haskell.org/package/pipes-aeson-0.4.1.2/docs/Pipes-Aeson-Unchecked.html#v:decoded\" rel=\"nofollow noreferrer\"><code>decoded</code></a> (the one from <code>Pipes.Aeson.Unchecked</code>) is a lens than transforms a Producer of raw bytes into a Producer of parsed <code>FromJSON</code> values. </p>\n\n<p>So, we must first create the Producer of bytes out of the socket using the <a href=\"http://hackage.haskell.org/package/pipes-network-0.6.4/docs/Pipes-Network-TCP.html#v:fromSocket\" rel=\"nofollow noreferrer\"><code>fromSocket</code></a> function from the <code>pipes-network</code> package. Something like this:</p>\n\n<pre><code>-- to help with type inference\nprintTest :: (MonadIO m) =&gt; Consumer' Test m r\nprintTest = P.print\n\nmain = do\n    connect \"127.0.0.1\" \"8000\" $ \\(socket, _) -&gt; $ runEffect $\n        view decoded (fromSocket socket 4096) &gt;-&gt; printTest\n    return ()\n</code></pre>\n"}], "owner": {"reputation": 1003, "user_id": 218307, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71349c1b606c549215197f7ec55e2276?s=128&d=identicon&r=PG", "display_name": "jhickner", "link": "https://stackoverflow.com/users/218307/jhickner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 1, "accepted_answer_id": 29071965, "answer_count": 1, "score": 0, "last_activity_date": 1494532740, "creation_date": 1426468313, "question_id": 29068221, "link": "https://stackoverflow.com/questions/29068221/parsing-a-stream-of-json-with-pipes-aeson", "title": "Parsing a stream of JSON with pipes-aeson", "body": "<p>Given a simple example JSON type:</p>\n\n<pre><code>data Test = Test\n  { name :: Text\n  , age  :: Int\n  } deriving (Show, Generic)\n\ninstance FromJSON Test\n</code></pre>\n\n<p>How can I use pipes-aeson to decode a stream of JSON messages coming over a socket using the <code>decoded</code> lens? As an example I'd like to just print them out as they're parsed:</p>\n\n<pre><code>main = connect \"127.0.0.1\" \"8000\" $ \\(socket, _) -&gt; $ runEffect $\n  some use of zoom decoded? view decoded? &gt;-&gt; P.print\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 10, "creation_date": 1426465180, "post_id": 29067861, "comment_id": 46371172, "body": "So you want to reverse an infinite list? You need to wait then."}, {"owner": {"reputation": 1125, "user_id": 777085, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5112855aef89ec6bf599252fbae5eca7?s=128&d=identicon&r=PG", "display_name": "xcoder", "link": "https://stackoverflow.com/users/777085/xcoder"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1426465351, "post_id": 29067861, "comment_id": 46371216, "body": "@zerkms sorry. What do you mean? There is no way?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 6, "creation_date": 1426465370, "post_id": 29067861, "comment_id": 46371222, "body": "Well, please put what you expect to see as a result for <code>reverse [1..]</code> call. Btw, your first pattern match should accept an empty list and return an empty list. That way you avoid duplication."}, {"owner": {"reputation": 1125, "user_id": 777085, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5112855aef89ec6bf599252fbae5eca7?s=128&d=identicon&r=PG", "display_name": "xcoder", "link": "https://stackoverflow.com/users/777085/xcoder"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1426465540, "post_id": 29067861, "comment_id": 46371251, "body": "@zerkms I have updated the with expected result. But I think I see your point when I tried to do so...so this is impossible I guess?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1426465550, "post_id": 29067861, "comment_id": 46371254, "body": "Your expected result is not correct. <code>take 10</code> returns the first 10 elements of a list. For the reversed <code>[1..]</code> it will be <code>[\u221e, \u221e - 1, \u221e - 2, ...]</code>"}, {"owner": {"reputation": 1125, "user_id": 777085, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5112855aef89ec6bf599252fbae5eca7?s=128&d=identicon&r=PG", "display_name": "xcoder", "link": "https://stackoverflow.com/users/777085/xcoder"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1426465666, "post_id": 29067861, "comment_id": 46371281, "body": "@zerkms um...if I have a f = a . b. c Do I need all a b and c to work with infinite list for f to be able to wok with infinite list?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1426465723, "post_id": 29067861, "comment_id": 46371288, "body": "No you don&#39;t, but when you performed <code>take 1 (reverse [1..])</code> you ask haskell to materialize the whole infinite list. Your expected result is not correct, please go through comments once again. To see why your expected result is wrong - try to pass <code>[1..99999]</code> which is not infinite but big enough for you to see the actual result. Then change the upper bound to <code>999999</code> and compare results."}, {"owner": {"reputation": 1125, "user_id": 777085, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5112855aef89ec6bf599252fbae5eca7?s=128&d=identicon&r=PG", "display_name": "xcoder", "link": "https://stackoverflow.com/users/777085/xcoder"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1426465901, "post_id": 29067861, "comment_id": 46371326, "body": "right...I tried innerReverse [(take 10 [1..])] and it gives the expected result"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1426465954, "post_id": 29067861, "comment_id": 46371343, "body": "Now replace 10 with something else. Sorry, I cannot repeat the same thing more than 3 times. :-("}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1426466139, "post_id": 29067861, "comment_id": 46371380, "body": "<code>innerReverse [(take 10 [1..])]</code> --- is a compltetely different call. Which is identical to <code>innerReverse [[1..10]]</code>, so it has nothing to do with infinite lists in your function (since your function now accepts a finite materialized list)"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1426579266, "post_id": 29067861, "comment_id": 46419196, "body": "@xcoder What do you expect <code>innerReverse [[1..]]</code> to print?"}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1426467891, "post_id": 29067926, "comment_id": 46371766, "body": "\u201cThere is no concept of the &quot;end&quot; of an infinite list\u201d \u2013 indeed that would be a complete oxymoron."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1426468278, "post_id": 29067926, "comment_id": 46371847, "body": "@leftaroundabout, it depends on what you call infinite. <a href=\"https://hackage.haskell.org/package/fmlist-0.8/docs/Data-FMList.html\" rel=\"nofollow noreferrer\">As an example.</a> There is no concept of the &quot;end&quot; of an endless list."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1426470713, "post_id": 29067926, "comment_id": 46372337, "body": "@leftaroundabout, that&#39;s one of the differences between Haskell and set theory; a mathematician would think of <code>[0..]</code> as \u03c9 and <code>[0..]++[0..]</code> as 2\u03c9. But Haskell can&#39;t distinguish them."}, {"owner": {"reputation": 774, "user_id": 2752467, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/81593fbaf44886f58c1a35b2c2de371f?s=128&d=identicon&r=PG&f=1", "display_name": "user2752467", "link": "https://stackoverflow.com/users/2752467/user2752467"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426470993, "post_id": 29067926, "comment_id": 46372409, "body": "@dfeuer I&#39;m not sure I understand your example. Are you using <code>++</code> as an analogue to the union operation?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426471203, "post_id": 29067926, "comment_id": 46372467, "body": "@JustinLardinois, I&#39;m pretending it&#39;s transfinite ordinal addition :-)"}], "tags": [], "owner": {"reputation": 774, "user_id": 2752467, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/81593fbaf44886f58c1a35b2c2de371f?s=128&d=identicon&r=PG&f=1", "display_name": "user2752467", "link": "https://stackoverflow.com/users/2752467/user2752467"}, "is_accepted": true, "score": 8, "last_activity_date": 1565650844, "last_edit_date": 1565650844, "creation_date": 1426465642, "answer_id": 29067926, "question_id": 29067861, "link": "https://stackoverflow.com/questions/29067861/making-a-haskell-function-to-work-with-infinite-list/29067926#29067926", "title": "Making a Haskell function to work with infinite list", "body": "<p>Haskell is a <em>lazy</em> language, which means that evaluations are only performed right before the result is actually used. That's what makes it possible for Haskell to have infinite lists; only the portions of the list that you're accessed so far are actually stored in memory.</p>\n\n<p>The concept of an infinite list makes what you're trying to do impossible. In the list <code>[1..]</code> the first element is <code>1</code>. What's the last element? The answer is that that's a trick question; there is no concept of the \"end\" of an infinite list. Similarly, what is the first element of the reverse of <code>[1..]</code>? Again, it's a trick question. The last element is <code>1</code>, but the list would have no beginning.</p>\n\n<p>The reverse of <code>[1..]</code> is not <code>[10,9,8,7,6,5,4,3,2,1]</code>. The reverse of the latter is <code>[1,2,3,4,5,6,7,8,9,10]</code>, not <code>[1..]</code>.</p>\n"}], "owner": {"reputation": 1125, "user_id": 777085, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5112855aef89ec6bf599252fbae5eca7?s=128&d=identicon&r=PG", "display_name": "xcoder", "link": "https://stackoverflow.com/users/777085/xcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 938, "favorite_count": 0, "accepted_answer_id": 29067926, "answer_count": 1, "score": -4, "last_activity_date": 1565650844, "creation_date": 1426465081, "last_edit_date": 1426466726, "question_id": 29067861, "link": "https://stackoverflow.com/questions/29067861/making-a-haskell-function-to-work-with-infinite-list", "title": "Making a Haskell function to work with infinite list", "body": "<p>I would like to know how I can turn a function to work with infinite list?</p>\n\n<p>For example, I have a function to revert a list of lists.</p>\n\n<p><code>innerReverse [[1,2,3]]</code> will return <code>[[3,2,1]]</code>. However, when I tried  <code>take 10 $ innerReverse [[1..]]</code> It basically runs into an infinite loop.</p>\n\n<p>When I do <code>innerReverse [(take 10 [1..])]</code> It gives the result: <code>[[10,9,8,7,6,5,4,3,2,1]]</code></p>\n"}, {"tags": ["haskell", "io", "function-composition"], "answers": [{"comments": [{"owner": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "edited": false, "score": 0, "creation_date": 1426460831, "post_id": 29067073, "comment_id": 46370125, "body": "I think you have misunderstood me. Can you take a look at my question again? I didn&#39;t use (.) after cycle, I have put space to apply <code>[getRect]</code> to my composed function."}, {"owner": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "edited": false, "score": 0, "creation_date": 1426460965, "post_id": 29067073, "comment_id": 46370161, "body": "Now I have noticed I should probably wrap <code>take 5</code> in braces because it&#39;s supposed to return partially applied function and this way it takes <code>(.)</code> as second argument, but it still doesn&#39;t work."}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "reply_to_user": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "edited": false, "score": 3, "creation_date": 1426461356, "post_id": 29067073, "comment_id": 46370270, "body": "@Reygoch - Function application binds more tightly than <code>(.)</code> so <code>take 5 . cycle [getRect]</code> is <code>take 5 . (cycle [getRect])</code>"}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 4, "last_activity_date": 1426461623, "last_edit_date": 1426461623, "creation_date": 1426459353, "answer_id": 29067073, "question_id": 29067027, "link": "https://stackoverflow.com/questions/29067027/problems-wirh-function-composition-in-haskell/29067073#29067073", "title": "Problems wirh function composition in Haskell", "body": "<p>Function application binds more tightly than <code>(.)</code> so </p>\n\n<pre><code>sequence . take 5 . cycle [getRect]\n</code></pre>\n\n<p>is the same as</p>\n\n<pre><code>sequence . take 5 . (cycle [getRect])\n</code></pre>\n\n<p>since <code>cycle [getRect]</code> is list and not a function you get the error.</p>\n\n<p>You can use parentheses to get the precedence you want:</p>\n\n<pre><code>rectangles &lt;- (sequence . take 5 . cycle) [getRect]\n</code></pre>\n\n<p>note you could use <code>replicateM</code> instead:</p>\n\n<pre><code>rectangles &lt;- replicateM 5 getRect\n</code></pre>\n"}], "owner": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1426461355, "accepted_answer_id": 29067073, "answer_count": 1, "score": 0, "last_activity_date": 1426461623, "creation_date": 1426459101, "last_edit_date": 1426460776, "question_id": 29067027, "link": "https://stackoverflow.com/questions/29067027/problems-wirh-function-composition-in-haskell", "closed_reason": "Duplicate", "title": "Problems wirh function composition in Haskell", "body": "<p>So... I have written this to get 5 rectangles from user :</p>\n\n<pre><code>rectangles &lt;- sequence . take 5 . cycle [getRect]\n</code></pre>\n\n<p>But it doesn't work. Then I have refactored it as this which is shorthand for writing braces:</p>\n\n<pre><code>rectangles &lt;- sequence $ take 5 $ cycle [getRect]\n</code></pre>\n\n<p>I'm not sure why my function compostion is not valid. I would expect it to work like this if I'm to translate it to \"real world\" function, no? :</p>\n\n<pre><code>sequence(take(5 , cycle(getRect)))\n</code></pre>\n\n<p><strong>[EDIT]</strong></p>\n\n<p>I understand that (.) is for function composition and $ for application but my composition should return function and than apply [getRect] to it. Should it not?</p>\n\n<p>I'm looking at this from purely mathematical standpoint. Let's say that</p>\n\n<pre><code>cycle : a -&gt; b\ntake 5 : b -&gt; c  -- partially applied\nsequence : c -&gt; d\n</code></pre>\n\n<p>So why doesn't my composition work? It should be a function with argument [getRect] like this :</p>\n\n<pre><code>(sequence . take 5 . cycle)([getRect]) : a -&gt; d\n</code></pre>\n\n<p>Where <code>a</code> is [getRect] and <code>d</code> is result of IO action.</p>\n"}, {"tags": ["haskell", "ghc", "cabal"], "comments": [{"owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 1, "creation_date": 1426428766, "post_id": 29061469, "comment_id": 46359377, "body": "Do you have LLVM&#39;s executables (opt and friends) in your PATH? If so, what are they called? Perhaps they are named opt-(version) etc."}, {"owner": {"reputation": 375, "user_id": 4232796, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/42912716b8f59e0f6cfd0cbbe6a74bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle McKean", "link": "https://stackoverflow.com/users/4232796/kyle-mckean"}, "reply_to_user": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 0, "creation_date": 1426430341, "post_id": 29061469, "comment_id": 46359928, "body": "@gspr how do i find that out?"}, {"owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 0, "creation_date": 1426432126, "post_id": 29061469, "comment_id": 46360504, "body": "By inspecting the files that came with your installation of LLVM. If you used a package manager (which you should if you&#39;re not sure about what you&#39;re doing), some likely candidates are /usr/bin/llvm-* and friends."}, {"owner": {"reputation": 375, "user_id": 4232796, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/42912716b8f59e0f6cfd0cbbe6a74bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle McKean", "link": "https://stackoverflow.com/users/4232796/kyle-mckean"}, "reply_to_user": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 0, "creation_date": 1426437779, "post_id": 29061469, "comment_id": 46362501, "body": "@gspr I dont have any type of folder named like LLVM how do I download it?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1426452818, "post_id": 29061469, "comment_id": 46367701, "body": "@KyleMcKean You can install LLVM from your package manager. See the documentation for your distribution for more information."}, {"owner": {"reputation": 375, "user_id": 4232796, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/42912716b8f59e0f6cfd0cbbe6a74bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle McKean", "link": "https://stackoverflow.com/users/4232796/kyle-mckean"}, "edited": false, "score": 0, "creation_date": 1426457073, "post_id": 29061469, "comment_id": 46369001, "body": "problem resolved thank you all"}], "owner": {"reputation": 375, "user_id": 4232796, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/42912716b8f59e0f6cfd0cbbe6a74bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle McKean", "link": "https://stackoverflow.com/users/4232796/kyle-mckean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 453, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1426428101, "creation_date": 1426428101, "question_id": 29061469, "link": "https://stackoverflow.com/questions/29061469/cabal-couldnt-figure-out-llvm-verison", "title": "Cabal couldnt figure out LLVM verison.", "body": "<p>I am trying to install the repa-v4l2 package and I get an error I dont know how to fix: </p>\n\n<pre><code>kyle@Kyles-Comp:~$ sudo cabal install repa-v4l2\n[sudo] password for kyle: \nResolving dependencies...\nConfiguring repa-v4l2-0.2.0.0...\nBuilding repa-v4l2-0.2.0.0...\nPreprocessing library repa-v4l2-0.2.0.0...\n[1 of 2] Compiling Graphics.Webcam.Linux.Internal( src/Graphics/Webcam/Linux/Internal.hs, dist/build/Graphics/Webcam/Linux/Internal.o )\n\n&lt;no location info&gt;:\n    Warning: Couldn't figure out LLVM version!\n    Make sure you have installed LLVM\nghc: could not execute: opt\nFailed to install repa-v4l2-0.2.0.0\ncabal: Error: some packages failed to install:\nrepa-v4l2-0.2.0.0 failed during the building phase. The exception was:\nExitFailure 1\n</code></pre>\n\n<p>How do you help LLVM figure out the verison? </p>\n"}, {"tags": ["haskell", "arguments", "standards"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 5, "creation_date": 1426428120, "post_id": 29061307, "comment_id": 46359149, "body": "<a href=\"http://stackoverflow.com/questions/8745597/defining-a-function-by-equations-with-different-number-of-arguments\">Related</a>."}], "owner": {"reputation": 655, "user_id": 2424911, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/6YlX9.jpg?s=128&g=1", "display_name": "Maarten Faddegon", "link": "https://stackoverflow.com/users/2424911/maarten-faddegon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "closed_date": 1426438216, "answer_count": 0, "score": 3, "last_activity_date": 1426427101, "creation_date": 1426427101, "question_id": 29061307, "link": "https://stackoverflow.com/questions/29061307/why-must-equations-of-a-function-in-haskell-have-the-same-number-of-arguments", "closed_reason": "Duplicate", "title": "Why must equations of a function in Haskell have the same number of arguments?", "body": "<p>Sometimes it can be useful in Haskell to not saturate the arguments from a type in the equation of a function. As in the following example:</p>\n\n<pre><code>f :: Int -&gt; Int -&gt; Int\nf _ = id\n</code></pre>\n\n<p>However, when a function is defined with more than one equation. At least GHC seems to demand that all equations have the same number of arguments. For example the following is <strong>not</strong> allowed:</p>\n\n<pre><code>g :: Int -&gt; Int -&gt; Int\ng 0 = id\ng x y = x * y\n</code></pre>\n\n<p>To me this seems like a reasonable definition though. What is the reason that this is not the case?</p>\n"}, {"tags": ["haskell", "recursion", "fibonacci", "reduction"], "answers": [{"comments": [{"owner": {"reputation": 5841, "user_id": 2426316, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fca24c9457510c17786a9ab424553963?s=128&d=identicon&r=PG", "display_name": "user2426316", "link": "https://stackoverflow.com/users/2426316/user2426316"}, "edited": false, "score": 0, "creation_date": 1426427290, "post_id": 29061206, "comment_id": 46358875, "body": "thanks, the part <code>gets applied only when the previous lines do not apply</code> made it clear to me"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1426426488, "creation_date": 1426426488, "answer_id": 29061206, "question_id": 29061171, "link": "https://stackoverflow.com/questions/29061171/how-does-haskell-evaluate-the-fibonacci-function/29061206#29061206", "title": "How does Haskell evaluate the Fibonacci function?", "body": "<p>The order of the equations in the definition does matter. </p>\n\n<p>The part</p>\n\n<pre><code>fib n = fib (n-1) + fib (n-2)\n</code></pre>\n\n<p>gets applied only when the previous lines <em>do not apply</em>. That is, only when <code>n</code> is not <code>0</code> nor <code>1</code>. Because of this, the step</p>\n\n<pre><code>fib 3 = fib (3-1) + fib (3-2)\nfib 3 = fib ((3-1)-1) + fib ((3-1)-2) + fib ((3-2)-1) + fib ((3-2)-2)\n</code></pre>\n\n<p>is wrong: <code>fib (3-2)</code> is <code>fib 1 = 1</code>, and not <code>fib ((3-2)-1) + fib ((3-2)-2)</code>.</p>\n\n<p>Another way to look at is is as follows.\nThe whole 3-lines definition can be equivalently expressed using <code>case</code> as</p>\n\n<pre><code>fib n = case n of\n        0 -&gt; 0\n        1 -&gt; 1\n        m -&gt; fib (m-1) + fib (m-2)\n</code></pre>\n"}], "owner": {"reputation": 5841, "user_id": 2426316, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fca24c9457510c17786a9ab424553963?s=128&d=identicon&r=PG", "display_name": "user2426316", "link": "https://stackoverflow.com/users/2426316/user2426316"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 29061206, "answer_count": 1, "score": 0, "last_activity_date": 1426426488, "creation_date": 1426426259, "question_id": 29061171, "link": "https://stackoverflow.com/questions/29061171/how-does-haskell-evaluate-the-fibonacci-function", "title": "How does Haskell evaluate the Fibonacci function?", "body": "<p>I am currently looking at this function in Haskell which returns the Fibonacci number at position <code>n</code></p>\n\n<pre><code>fib :: Integer -&gt; Integer\nfib 0 = 0\nfib 1 = 1\nfib n = fib (n-1) + fib (n-2)\n</code></pre>\n\n<p>Now, it compiles, returns the correct result and everything... but I don't see how Haskell evaluates this function. </p>\n\n<p>Doesn't Haskell always look for a suitable definition and then apply that definition until it cannot anymore (e.g. reached base case)? </p>\n\n<p>In that case, this is what I came up with. For instance, evaluating <code>fib 3</code></p>\n\n<pre><code>fib n = fib (n-1) + fib (n-2)\nfib 3 = fib (3-1) + fib (3-2)\nfib 3 = fib ((3-1)-1) + fib ((3-1)-2) + fib ((3-2)-1) + fib ((3-2)-2)\nfib 3 = fib (((3-1)-1)-1) + fib (((3-1)-1)-2) +\n        fib (((3-1)-2)-1) + fib (((3-1)-2)-2) + \n        fib (((3-2)-1)-1) + fib (((3-2)-1)-2) + \n        fib (((3-2)-2)-1) + fib (((3-2)-2)-2)\n...\n</code></pre>\n\n<p>This could go on forever without giving an actual result. However, Haskell returns a result. So what am I doing wrong?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1426454928, "post_id": 29060916, "comment_id": 46368341, "body": "Not that the question is <i>wrong</i>, per se, but &quot;wait for the whole input and then print it out&quot; is a pretty anti-modular requirement. I wouldn&#39;t be surprised if that requirement disappears or even becomes a problem for you later in the development of this tool."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1482671750, "last_edit_date": 1482671750, "creation_date": 1426425588, "answer_id": 29061043, "question_id": 29060916, "link": "https://stackoverflow.com/questions/29060916/correct-way-of-reading-from-stdin-in-haskell/29061043#29061043", "title": "Correct way of reading from stdin in haskell", "body": "<p>The problem here is that <code>getContents</code> uses lazy IO, making the input stream to be processed line-by-line.  If you want to force it to read the whole input before starting performing the job you can use the following hack:</p>\n\n<pre><code>...\nif length args == 1 then do\n    content &lt;- getContents\n    length content `seq` return ()   -- force the input to be fully read now\n    let inGramma = getGramma content\n    doJob (head args) inGramma\n    return ()\n</code></pre>\n\n<p>Alternatively, use <code>evaluate</code>, or look in Hackage for a strict IO module providing a strict <code>getContents</code>. For instance, I just found the <code>strict-io</code> package providing <a href=\"http://hackage.haskell.org/package/strict-io-0.2.1/docs/System-IO-Strict.html#v:getContents\" rel=\"nofollow noreferrer\"><code>System.IO.Strict.getContents</code></a>. Using that you should be able to write (untested)</p>\n\n<pre><code>import qualified System.IO.Strict as S\n...\nif length args == 1 then do\n    content &lt;- run S.getContents\n    ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 1, "last_activity_date": 1426430812, "creation_date": 1426430812, "answer_id": 29061927, "question_id": 29060916, "link": "https://stackoverflow.com/questions/29060916/correct-way-of-reading-from-stdin-in-haskell/29061927#29061927", "title": "Correct way of reading from stdin in haskell", "body": "<p>That's not answering the question but instead of testing the length of the arguments, you can pattern match against it and return the <em>correct</em> content</p>\n\n<pre><code>main = do\n    let (opt, contentM) = case getArgs of\n              [opt]       -&gt; (op, getContent)\n              [opt, file] -&gt; (op, hGetContent file)\n              _           -&gt; error (\"Invalid count of argument\")\n    inGramma  &lt;- fmap getGramma contentM\n    doJob opt inGramma\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 1293035, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e9333719c25b9f86fcb7043dcaf48bfa?s=128&d=identicon&r=PG", "display_name": "mbk", "link": "https://stackoverflow.com/users/1293035/mbk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 966, "favorite_count": 0, "accepted_answer_id": 29061043, "answer_count": 2, "score": 1, "last_activity_date": 1482671750, "creation_date": 1426424804, "question_id": 29060916, "link": "https://stackoverflow.com/questions/29060916/correct-way-of-reading-from-stdin-in-haskell", "title": "Correct way of reading from stdin in haskell", "body": "<p>I have a program that depending on the arguments given works in different ways:</p>\n\n<ul>\n<li>If there are 2 arguments - it takes 2nd argument as a filename, reads from it and then simply prints it out.</li>\n<li>If there is 1 argument - it reads from stdin and also prints it out.</li>\n</ul>\n\n<p>Here is the code:\n</p>\n\n<pre><code>main :: IO ()\nmain = do\n\n-- Read given arguments\nargs &lt;- getArgs\n\n-- If file containing gramma was given\nif length args == 2 then do\n    hfile &lt;- openFile (last args) ReadMode\n    content &lt;- hGetContents hfile\n    let inGramma = getGramma content\n    doJob (head args) inGramma\n    hClose hfile\n    return ()\n\n-- If no file was given - reads from stdin\nelse if length args == 1 then do\n    content &lt;- getContents\n    let inGramma = getGramma content\n    doJob (head args) inGramma\n    return ()\n\nelse do putStrLn \"Invalid count of arguments!\"\n</code></pre>\n\n<p>The problem is, when it reads from stdin, after every new line (enter pressed), it prints that line and than reads next. I need it to wait for the whole input and than print it out (after Ctrl+D).</p>\n\n<p>Here are the functions used in that code:</p>\n\n<pre><code>-- | Structure of gramma\ndata GrammaStruct = Gramma\n    { nonTerminals :: NonTerminals\n    , terminals :: Terminals\n    , start :: Start\n    , rules :: Rules\n    } deriving (Eq)\n\n-- | Representation of gramma\ninstance Show GrammaStruct where\n    show (Gramma n t s r) = \n                init (showSplit n) ++ \n        \"\\n\" ++ init (showSplit t) ++ \n        \"\\n\" ++ showStart s ++ \n        \"\\n\" ++ init (showRules r)\n\n-- | Print gramma\nshowGramma :: GrammaStruct -&gt; IO ()\nshowGramma gr = do\n    putStrLn $ show gr\n\n-- | Transforms string given from file of stdin into gramma representation in app\ngetGramma :: String -&gt; GrammaStruct\ngetGramma hIn = procLns (lines hIn)\n\n-- | Depending on option given, provides required functionality\ndoJob :: String -&gt; GrammaStruct -&gt; IO ()\ndoJob op gramma\n        | op == \"-i\" = showGramma gramma\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["haskell", "monads", "lzw"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1426425184, "creation_date": 1426425184, "answer_id": 29060977, "question_id": 29060782, "link": "https://stackoverflow.com/questions/29060782/lzw-routine-in-haskell-using-monads/29060977#29060977", "title": "LZW routine in Haskell using Monads", "body": "<pre><code>put ((append b c) dict)\n</code></pre>\n\n<p>looks wrong. <code>append</code> is already a monadic action, so it should be enough to use</p>\n\n<pre><code>append b c\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 4, "last_activity_date": 1426425244, "creation_date": 1426425244, "answer_id": 29060985, "question_id": 29060782, "link": "https://stackoverflow.com/questions/29060782/lzw-routine-in-haskell-using-monads/29060985#29060985", "title": "LZW routine in Haskell using Monads", "body": "<p>You don't need to write any instances. You're simply using <code>append</code> and <code>munch</code> in a wrong way. </p>\n\n<p><code>append</code> has type <code>MonadState Dictionary m =&gt; String -&gt; String -&gt; m ()</code>. \nIf <code>f</code> and <code>s</code> are strings, then <code>append f s</code> yields a state-modifying action that eventually returns a <code>()</code>.   </p>\n\n<p><code>put</code> has type <code>MonadState s m =&gt; s -&gt; m ()</code>. <code>put</code> replaces the current state with the <code>s</code> argument. </p>\n\n<p>In the light of this, <code>put (append f s) dict</code> makes little sense. You're supposed to supply <code>put</code> a single argument. And you don't have to do anything with <code>dict</code> there; a core point of using the State monad is that the state is left implicit, and there is no need to pass it around. </p>\n\n<p>Also, <code>append f s</code> by itself already updates the state. So what you want here is simply <code>append f s</code>, instead of <code>put (append x y) dict</code>. </p>\n\n<p>There's a similar error in <code>encode</code> with <code>munch</code>; it has a single <code>String</code> argument, so <code>(munch w) dict</code> is erroneous. Again, no need to touch <code>dict</code>. Also, because <code>munch w</code> yields a monadic result, you must bind the result with <code>&lt;-</code> instead of <code>let</code>. So, you should replace <code>let (a, b, c) = (much w dict)</code> with <code>(a, b, c) &lt;- munch w</code>. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4673049"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 29060985, "answer_count": 2, "score": 1, "last_activity_date": 1527203192, "creation_date": 1426423830, "last_edit_date": 1527203192, "question_id": 29060782, "link": "https://stackoverflow.com/questions/29060782/lzw-routine-in-haskell-using-monads", "title": "LZW routine in Haskell using Monads", "body": "<p>I'm trying to implement LZW compression in Haskell using Monads, here is my code so far with test cases:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FlexibleContexts #-}\nimport Control.Monad.State\nimport Control.Monad.Writer\nimport Data.Char (chr, ord)\nimport Data.List (isPrefixOf, maximumBy)\nimport Data.Function\nimport Test.QuickCheck\n\ntype Dictionary = [String]\n\ndictionary :: Dictionary\ndictionary = [[chr x] | x &lt;- [0..127]]\n\n\ntest_dictionary =\n  [ map ord (concat dictionary) == [0..127]\n  , all (\\str -&gt; length str == 1) dictionary\n  ]\n\nprefixes :: String -&gt; Dictionary -&gt; [(Int, String)]\nprefixes str dict = [(x, dict!!x) | x &lt;- [0..length dict - 1], isPrefixOf (dict!!x) str]\n\ntest_prefixes =\n  [ prefixes \"\" dictionary == []\n  , prefixes \"appletree\" []   == []\n  , prefixes \"appletree\" [\"ap\", \"apple\", \"tree\", \"pear\"] == [(0, \"ap\"), (1, \"apple\")]\n  , prefixes \"babe\" dictionary                    == [(98, \"b\")]\n  ]\n\nlongest :: [(Int, String)] -&gt; (Int, String)\nlongest prefs = maximumBy (compare `on` (\\(x,y) -&gt; length y)) prefs\n\ntest_longest =\n  [ longest [(30, \"a\"), (20, \"abc\"), (15, \"ab\")]  == (20, \"abc\")\n  , longest [(30, \"a\"), (20, \"abc\"), (15, \"abc\")] == (15, \"abc\")\n  ]\n\ninstance MonadState Dictionary ((-&gt;) Dictionary) where\n    get = \\s -&gt; s\n\nmunch :: MonadState Dictionary m =&gt; String -&gt; m (Int, String, String)\nmunch str = do\n        dict &lt;- get\n        let longst = longest (prefixes str dict)\n        return (fst longst, snd longst, [str!!x | x &lt;- [length (snd longst)..length str - 1]])\n\ntest_munch =\n  [ evalState (munch \"a\")      [\"a\"]            == (0, \"a\", \"\")\n  , evalState (munch \"appletree\") [\"a\"]            == (0, \"a\", \"ppletree\")\n  , evalState (munch \"peach\") [\"a\", \"ba\", \"b\"] == (1, \"ba\", \"be\")\n  ]\n\ninstance MonadState m (StateT Dictionary ((-&gt;) m)) where\n\nappend :: MonadState Dictionary m =&gt; String -&gt; String -&gt; m ()\nappend s \"\" = return ()\nappend s w = do\n        dict &lt;- get\n        let newWord = s ++ (take 1 w)\n        if (notElem newWord dict)\n        then do\n            put (dict++[newWord])\n        else return ()\n\ntest_append =\n  [ execState (append \"a\" \"\")   []         == []\n  , execState (append \"a\" \"\")   dictionary == dictionary\n  , execState (append \"a\" \"bc\") []         == [\"ab\"]\n  , execState (append \"a\" \"bc\") [\"ab\"]     == [\"ab\"]\n  ]\n\nencode :: String -&gt; WriterT [Int] (State Dictionary) ()\nencode \"\" = return ()\nencode w = do\n        dict &lt;- get\n        let (a, b, c) = (munch w) dict\n        if length dict &lt; 256\n        then do\n            tell [a]\n            put ((append b c) dict)\n            encode c\n        else return ()\n\ntest_encode =\n  [ evalState (execWriterT (encode \"\"))         []         == []\n  , evalState (execWriterT (encode \"aaa\"))      [\"a\"]      == [0, 1]\n  , evalState (execWriterT (encode \"aaaa\"))     [\"a\"]      == [0, 1, 0]\n  , evalState (execWriterT (encode \"aaaaa\"))    [\"a\"]      == [0, 1, 1]\n  , evalState (execWriterT (encode \"abababab\")) [\"a\", \"b\"] == [0, 1, 2, 4, 1]\n  , evalState (execWriterT (encode \"aaabbbccc\")) dictionary\n    == [97, 128, 98, 130, 99, 132]\n  ]\n\ndecode :: [Int] -&gt; WriterT String (State Dictionary) ()\ndecode [] = return ()\ndecode [x] = do\n    dict &lt;- get\n    tell (dict!!x)\ndecode (x:xs) = do\n    dict &lt;- get\n    let f = dict!!x\n    let s = if(length dict &gt; head xs) \n            then dict!!head xs\n            else f\n    tell f\n    put (append f s) dict\n    decode xs\n\n    test_decode =\n  [ evalState (execWriterT (decode []))           []         == []\n  , evalState (execWriterT (decode [0]))          [\"a\"]      == \"a\"\n  , evalState (execWriterT (decode [0, 1, 1, 0])) [\"a\", \"b\"] == \"abba\"\n  , evalState (execWriterT (decode [0, 1, 2, 0])) [\"a\", \"b\"] == \"ababa\"\n  , evalState (execWriterT (decode [0, 1, 2, 4, 1])) [\"a\", \"b\"] == \"abababab\"\n  , evalState (execWriterT (decode [97, 128, 98, 130, 99, 132])) dictionary\n    == \"aaabbbccc\"\n  ]\n\ncompress :: String -&gt; [Int]\ncompress w = evalState (execWriterT (encode w)) dictionary\n\ntest_compress =\n  [ compress \"\"          == []\n  , compress \"a\"         == [97]\n  , compress \"aaa\"       == [97, 128]\n  , compress \"aaabbbccc\" == [97, 128, 98, 130, 99, 132]\n  ]\n\ndecompress :: [Int] -&gt; String\ndecompress list = evalState (execWriterT (decode list)) dictionary\n\ntest_decompress =\n  [ decompress []                          == \"\"\n  , decompress [97]                        == \"a\"\n  , decompress [97, 128]                   == \"aaa\"\n  , decompress [97, 128, 98, 130, 99, 132] == \"aaabbbccc\"\n  ]\n\nprop_compressDecompress :: String -&gt; Bool\nprop_compressDecompress w = do\n    let tmp = [chr (div (ord x) 2) | x &lt;- w]\n    decompress (compress tmp) == tmp\n\ncompressFile :: FilePath -&gt; FilePath -&gt; IO ()\ncompressFile source target = do\n    s &lt;- readFile source\n    let compressed = compress s\n    let chars = [chr x | x &lt;- compressed]\n    writeFile target chars\n\ndecompressFile  :: FilePath -&gt; FilePath -&gt; IO ()\ndecompressFile  source target = do\n    s &lt;- readFile source\n    let code = [ord x | x &lt;- s]\n    let decompressed = decompress code\n    writeFile target decompressed\n\nallTests = [test_dictionary, test_prefixes, test_longest, test_munch, test_append \n    ,test_encode\n    --, test_decode, test_compress, test_decompress\n    ]\n\nmain = do\n    --quickCheck prop_compressDecompress\n    print (allTests, and (concat allTests))\n</code></pre>\n\n<p>With this code I get the following error (referring to the use of put in \"encode\" and \"decode\" functions) :</p>\n\n<blockquote>\n  <p>Main.hs@80:13-80:16 No instance for (MonadState () (StateT Dictionary Data.Functor.Identity.Identity)) arising from a use of put</p>\n</blockquote>\n\n<p>I've tried to define this instance but the best I could achieve is a \"functional dependencies conflict between instance declarations\" error.\nI know there is more simple solutions without Monads but I have to use them, also the types of the functions are not to be modified.</p>\n\n<p>Could you give me any help about what I'm doing wrong here?</p>\n"}, {"tags": ["algorithm", "haskell", "functional-programming", "generic-programming"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1426410797, "post_id": 29058761, "comment_id": 46354463, "body": "Does <a href=\"http://stackoverflow.com/questions/23515191/how-to-enumerate-a-recursive-datatype-in-haskell\">How to enumerate a recursive datatype in Haskell?</a> answer your question?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1426411130, "post_id": 29058761, "comment_id": 46354526, "body": "If you want an explicit version of the bijection, you can mechanically build one from the bijections <code>encodeTimes :: Integer-&gt;Integer-&gt;Integer</code> (dovetailing) and <code>encodePlus :: Either Integer Integer -&gt; Integer</code> (interleaving) and little else. You apply these following the definition of your recursive type."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1426411291, "post_id": 29058761, "comment_id": 46354567, "body": "You can also use <a href=\"http://stackoverflow.com/a/27809179/3234959\">this technique</a> to enumerate a type using list comprehensions."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1426411842, "post_id": 29058761, "comment_id": 46354687, "body": "@chi this question is mine too - notice the generic answer isn&#39;t an algorithm to map back and forth from godel numberings - it goes one way, so it is not what I&#39;m asking for. (You could do it by enumerating and then finding the element on the list, but that&#39;d be unpractical.)"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1426412278, "post_id": 29058761, "comment_id": 46354809, "body": "What I&#39;m really asking for is a generic, systematic way to derive <code>fromGodel : Int \u2192 Type</code> and <code>toGodel : Type \u2192 Int</code>, <a href=\"http://lpaste.net/125863\" rel=\"nofollow noreferrer\">like this one</a>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1426419441, "post_id": 29058761, "comment_id": 46356561, "body": "You cannot encode lazy infinite values like <code>let x = 1:x in x</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1426455670, "post_id": 29058761, "comment_id": 46368574, "body": "@n.m. A suitably lazy natural number type might be able to encode such values."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1426475715, "post_id": 29058761, "comment_id": 46373426, "body": "@DanielWagner There are more infinite lists than natural numbers..."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1426523741, "post_id": 29058761, "comment_id": 46397244, "body": "@n.m. There are the same number of computable infinite lists as there are computable natural numbers."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1426526436, "post_id": 29058761, "comment_id": 46399131, "body": "@DanielWagner that&#39;s right, now can we have a method to skip non-computable ones?"}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1426453188, "post_id": 29059356, "comment_id": 46367806, "body": "How do we know <code>gto</code> is dense, i.e. its image on <code>SomeGoedelNumbering</code> is all the natural numbers?"}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1426453414, "post_id": 29059356, "comment_id": 46367871, "body": "@DanielWagner We don&#39;t, I didn&#39;t aim for that."}], "tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": true, "score": 3, "last_activity_date": 1426413900, "last_edit_date": 1426413900, "creation_date": 1426413559, "answer_id": 29059356, "question_id": 29058761, "link": "https://stackoverflow.com/questions/29058761/generic-algorithm-to-enumerate-sum-and-product-types-on-haskell/29059356#29059356", "title": "Generic algorithm to enumerate sum and product types on Haskell?", "body": "<p>In order to avoid dealing with a particular Goedel numbering, let's define a class that'll abstract the necessary operations (with some imports we'll need later):</p>\n\n<pre><code>{-# LANGUAGE TypeOperators, DefaultSignatures, FlexibleContexts, DeriveGeneric #-}\nimport Control.Applicative\nimport GHC.Generics\nimport Test.QuickCheck\nimport Test.QuickCheck.Gen\n\nclass GodelNum a where\n    fromInt :: Integer -&gt; a\n    toInt :: a -&gt; Maybe Integer\n    encode :: [a] -&gt; a\n    decode :: a -&gt; [a]\n</code></pre>\n\n<p>So we can inject natural numbers and encode sequences. Let's further create a canonical instance of this class that'll use throughout the code, which does no real Goedel encoding, just constructs a tree of terms.</p>\n\n<pre><code>data TermNum = Value Integer | Complex [TermNum]\n  deriving (Show)\n\ninstance GodelNum TermNum where\n    fromInt = Value\n    toInt (Value x) = Just x\n    toInt _         = Nothing\n    encode = Complex\n    decode (Complex xs) = xs\n    decode _            = []\n</code></pre>\n\n<p>For real encoding we'd use another implementation that'd use just one <code>Integer</code>, something like <code>newtype SomeGoedelNumbering = SGN Integer</code>. </p>\n\n<p>Let's further create a class for types that we can encode/decode:</p>\n\n<pre><code>class GNum a where\n    gto :: (GodelNum g) =&gt; a -&gt; g\n    gfrom :: (GodelNum g) =&gt; g -&gt; Maybe a\n\n    default gto :: (Generic a, GodelNum g, GGNum (Rep a)) =&gt; a -&gt; g\n    gto = ggto . from\n    default gfrom :: (Generic a, GodelNum g, GGNum (Rep a)) =&gt; g -&gt; Maybe a\n    gfrom = liftA to . ggfrom\n</code></pre>\n\n<p>The last four lines define a generic implementation of <code>gto</code> and <code>gfrom</code> using GHC <a href=\"https://wiki.haskell.org/GHC.Generics\" rel=\"nofollow\">Generics</a> and <code>DefaultSignatures</code>. The class <code>GGNum</code> that they use is a helper class which we'll use to define encoding for the atomic ADT operations - products, sums, etc.:</p>\n\n<pre><code>class GGNum f where\n    ggto :: (GodelNum g) =&gt; f a -&gt; g\n    ggfrom :: (GodelNum g) =&gt; g -&gt; Maybe (f a)\n\n-- no-arg constructors\ninstance GGNum U1 where\n    ggto U1 = encode []\n    ggfrom _ = Just U1\n\n-- products\ninstance (GGNum a, GGNum b) =&gt; GGNum (a :*: b) where\n    ggto (a :*: b) = encode [ggto a, ggto b]\n    ggfrom e | [x, y] &lt;- decode e    = liftA2 (:*:) (ggfrom x) (ggfrom y)\n            | otherwise             = Nothing\n\n-- sums\ninstance (GGNum a, GGNum b) =&gt; GGNum (a :+: b) where\n    ggto (L1 x) = encode [fromInt 0, ggto x]\n    ggto (R1 y) = encode [fromInt 1, ggto y]\n    ggfrom e | [n, x] &lt;- decode e = case toInt n of\n                                    Just 0  -&gt; L1 &lt;$&gt; ggfrom x\n                                    Just 1  -&gt; R1 &lt;$&gt; ggfrom x\n                                    _       -&gt; Nothing\n\n-- metadata\ninstance (GGNum a) =&gt; GGNum (M1 i c a) where\n    ggto (M1 x) = ggto x\n    ggfrom e = M1 &lt;$&gt; ggfrom e\n\n-- constants and recursion of kind *\ninstance (GNum a) =&gt; GGNum (K1 i a) where\n    ggto (K1 x) = gto x\n    ggfrom e = K1 &lt;$&gt; gfrom e\n</code></pre>\n\n<p>Having that, we can then define a data type like yours and just declare its <code>GNum</code> instance, everything else will be automatically derived.</p>\n\n<pre><code>data Term = Prod Term Term | SumL Term | SumR Term | AtomA | AtomB\n  deriving (Eq, Show, Generic)\n\ninstance GNum Term where\n</code></pre>\n\n<p>And just to be sure we've done everything right, let's use <a href=\"https://www.fpcomplete.com/user/pbv/an-introduction-to-quickcheck-testing\" rel=\"nofollow\">QuickCheck</a> to verify that our <code>gfrom</code> is an inverse of <code>gto</code>:</p>\n\n<pre><code>instance Arbitrary Term where\n    arbitrary = oneof [ return AtomA\n                      , return AtomB\n                      , SumL &lt;$&gt; arbitrary\n                      , SumR &lt;$&gt; arbitrary\n                      , Prod &lt;$&gt; arbitrary &lt;*&gt; arbitrary\n                      ]\n\nprop_enc_dec :: Term -&gt; Property\nprop_enc_dec x = Just x === gfrom (gto x :: TermNum)\n\nmain :: IO ()\nmain = quickCheck prop_enc_dec\n</code></pre>\n\n<p><strong>Notes</strong>:</p>\n\n<ul>\n<li>The same thing could be accomplished using <a href=\"https://hackage.haskell.org/package/syb\" rel=\"nofollow\">Scrap Your Boilerplate</a>, perhaps more efficiently, as it allows somewhat higher-level access - enumerating constructors and records, etc.</li>\n<li>See also paper <a href=\"http://www.cse.unt.edu/~tarau/research/bijectiveNSF/cgoedel.pdf\" rel=\"nofollow\">Efficient Bijective G\u00a8odel Numberings for Term Algebras</a> (I haven't read the paper yet, but seems related).</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1426454702, "post_id": 29066291, "comment_id": 46368275, "body": "Ah, I see now I misunderstood the question. I will update with some comments about generic programming later."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1426578581, "post_id": 29066291, "comment_id": 46418891, "body": "I thank you for the answer which is correct and neat - but the thread is still not solved since that is not a generic algorithm, just one for my example datatype..."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1426615069, "post_id": 29066291, "comment_id": 46442515, "body": "@Viclib I agree. I am still working on a generic version -- as you suggested, it is trickier than one might expect."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1426621685, "post_id": 29066291, "comment_id": 46446284, "body": "I guess it is. If you are doing this for this question, please, don&#39;t worry! But if you&#39;ll do it anyway, I guess it would be a great addition to Hackage."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1426454266, "creation_date": 1426454266, "answer_id": 29066291, "question_id": 29058761, "link": "https://stackoverflow.com/questions/29058761/generic-algorithm-to-enumerate-sum-and-product-types-on-haskell/29066291#29066291", "title": "Generic algorithm to enumerate sum and product types on Haskell?", "body": "<p>For fun, I decided to try the approach in the link you posted, and didn't get stuck anywhere. So here's my code, with no commentary (the explanation is the same as the last time). First, code stolen from the other answer:</p>\n\n<pre><code>{-# LANGUAGE TypeSynonymInstances #-}\nimport Control.Applicative\nimport Data.Universe.Helpers\n\ntype Nat = Integer\nclass Godel a where\n    to   :: a -&gt; Nat\n    from :: Nat -&gt; a\n\ninstance Godel Nat where to = id; from = id\n\ninstance (Godel a, Godel b) =&gt; Godel (a, b) where\n    to (m_, n_) = (m + n) * (m + n + 1) `quot` 2 + m where\n        m = to m_\n        n = to n_\n    from p = (from m, from n) where\n        isqrt    = floor . sqrt . fromIntegral\n        base     = (isqrt (1 + 8 * p) - 1) `quot` 2\n        triangle = base * (base + 1) `quot` 2\n        m = p - triangle\n        n = base - m\n</code></pre>\n\n<p>And the code specific to your new type:</p>\n\n<pre><code>data Term = Prod Term Term | SumL Term | SumR Term | AtomA | AtomB\n    deriving (Eq, Ord, Read, Show)\n\nts = AtomA : AtomB : interleave [uncurry Prod &lt;$&gt; ts +*+ ts, SumL &lt;$&gt; ts, SumR &lt;$&gt; ts]\n\ninstance Godel Term where\n    to AtomA = 0\n    to AtomB = 1\n    to (Prod t1 t2) = 2 + 0 + 3 * to (t1, t2)\n    to (SumL t)     = 2 + 1 + 3 * to t\n    to (SumR t)     = 2 + 2 + 3 * to t\n    from 0 = AtomA\n    from 1 = AtomB\n    from n = case quotRem (n-2) 3 of\n        (q, 0) -&gt; uncurry Prod (from q)\n        (q, 1) -&gt; SumL (from q)\n        (q, 2) -&gt; SumR (from q)\n</code></pre>\n\n<p>The same ghci test as last time:</p>\n\n<pre><code>*Main&gt; take 30 (map from [0..]) == take 30 ts\nTrue\n</code></pre>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 1, "accepted_answer_id": 29059356, "answer_count": 2, "score": 2, "last_activity_date": 1426454266, "creation_date": 1426408672, "last_edit_date": 1495540718, "question_id": 29058761, "link": "https://stackoverflow.com/questions/29058761/generic-algorithm-to-enumerate-sum-and-product-types-on-haskell", "title": "Generic algorithm to enumerate sum and product types on Haskell?", "body": "<p>Some time ago, I've asked <a href=\"https://stackoverflow.com/questions/23923229/is-there-a-fast-algorithm-to-determine-the-godel-number-of-a-term-of-a-context-f\">how to map back and forth from godel numbers to terms of a context-free language</a>. While the answer solved the issue specificaly, I'm having trouble in actually programming it generically. So, this question is more generic: given a recursive algebraic data type with terminals, sums and products - such as </p>\n\n<pre><code>data Term = Prod Term Term | SumL Term | SumR Term | AtomA | AtomB\n</code></pre>\n\n<p>what is an algorithm that will map a term of this type to its godel number, and its inverse?</p>\n\n<p>Edit: for example:</p>\n\n<pre><code>data Foo = A | B Foo | C Foo deriving Show\n\nto :: Foo -&gt; Int\nto A = 1\nto (B x) = to x * 2\nto (C x) = to x * 2 + 1\n\nfrom :: Int -&gt; Foo\nfrom 1 = A\nfrom n = case mod n 2 of\n    0 -&gt; B (from (div n 2))\n    1 -&gt; C (from (div n 2))\n</code></pre>\n\n<p>Here, <code>to</code> and <code>from</code> do what I want for <code>Foo</code>. I'm just asking for a systematic way to derive those functions for any datatype.</p>\n"}, {"tags": ["list", "haskell", "functional-programming", "list-comprehension"], "comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 16, "creation_date": 1426380791, "post_id": 29055913, "comment_id": 46349308, "body": "I think this is debatable enough that in reality, only whoever made the assignment can tell whether it&#39;s allowed."}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 0, "creation_date": 1426408668, "post_id": 29055913, "comment_id": 46353968, "body": "I can&#39;t say yes but I can&#39;t say no either; list comprehensions aren&#39;t functions (should be safe to use for your assignment)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1426411657, "post_id": 29055913, "comment_id": 46354645, "body": "My feeling is that the restriction &quot;do not use higher order functions&quot; could be meant to force students into using explicit recursion. It&#39;s not crystal clear, though."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 5, "creation_date": 1426390318, "post_id": 29055984, "comment_id": 46350910, "body": "One possible translation (assuming no language extensions) is given in the <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-420003.11\" rel=\"nofollow noreferrer\">List Comprehensions</a> section of the Report, and does not mention <code>Monad</code> at all; it does use <code>concatMap</code>, which happens to be similar to the bind for the monad, but it can be completely independent. Of course <code>concatMap</code> is just as much a higher-order function as <code>(&gt;&gt;=)</code> is."}, {"owner": {"reputation": 1260, "user_id": 1467419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78cfc322a3cc06cd4d310515286e3c78?s=128&d=identicon&r=PG", "display_name": "d3dave", "link": "https://stackoverflow.com/users/1467419/d3dave"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1426390689, "post_id": 29055984, "comment_id": 46350981, "body": "@DanielWagner I got my information from <a href=\"https://wiki.haskell.org/List_comprehension\" rel=\"nofollow noreferrer\">this wiki page</a>. But the report, of course, should be the basis for judgement. I will edit my answer."}, {"owner": {"reputation": 708, "user_id": 4553930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/308c878dca0a01a80bc9b5b9b19c7ab6?s=128&d=identicon&r=PG&f=1", "display_name": "Abhay", "link": "https://stackoverflow.com/users/4553930/abhay"}, "edited": false, "score": 1, "creation_date": 1426427486, "post_id": 29055984, "comment_id": 46358925, "body": "@d3dave Using higher order functions to define something does not make it higher order. I can say <code>ys = map f xs</code>, which uses <code>map</code> which is higher order, but that does not make <code>ys</code> higher order."}, {"owner": {"reputation": 1260, "user_id": 1467419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78cfc322a3cc06cd4d310515286e3c78?s=128&d=identicon&r=PG", "display_name": "d3dave", "link": "https://stackoverflow.com/users/1467419/d3dave"}, "reply_to_user": {"reputation": 708, "user_id": 4553930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/308c878dca0a01a80bc9b5b9b19c7ab6?s=128&d=identicon&r=PG&f=1", "display_name": "Abhay", "link": "https://stackoverflow.com/users/4553930/abhay"}, "edited": false, "score": 0, "creation_date": 1426427706, "post_id": 29055984, "comment_id": 46359008, "body": "@Abhay: yes, but <code>Q</code> in the list comprehension ranges over qualifiers, which can include functions, and is used in the <code>ok</code> function. So it would be more correct to mention the usage <code>Q</code> in the pattern perhaps."}, {"owner": {"reputation": 708, "user_id": 4553930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/308c878dca0a01a80bc9b5b9b19c7ab6?s=128&d=identicon&r=PG&f=1", "display_name": "Abhay", "link": "https://stackoverflow.com/users/4553930/abhay"}, "edited": false, "score": 1, "creation_date": 1426428011, "post_id": 29055984, "comment_id": 46359104, "body": "I mean to say, whatever is used inside, the result of a list comprehension is a list. And a list is a non-function value, so order-zero."}], "tags": [], "owner": {"reputation": 1260, "user_id": 1467419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78cfc322a3cc06cd4d310515286e3c78?s=128&d=identicon&r=PG", "display_name": "d3dave", "link": "https://stackoverflow.com/users/1467419/d3dave"}, "is_accepted": true, "score": 13, "last_activity_date": 1426427764, "last_edit_date": 1426427764, "creation_date": 1426380191, "answer_id": 29055984, "question_id": 29055913, "link": "https://stackoverflow.com/questions/29055913/haskell-are-list-comprehensions-higher-order-functions/29055984#29055984", "title": "Haskell: Are list comprehensions higher order functions?", "body": "<p>A list comprehension in Haskell is just syntactic sugar. It is defined in the Haskell 2010 Report <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-420003.11\" rel=\"nofollow noreferrer\">here</a> like so: </p>\n\n<pre><code>[ e | True ]          = [e]\n[ e | q ]             = [ e | q, True ]\n[ e | b, Q  ]         = if b then [ e | Q ] else []\n[ e | p &lt;- l, Q ]     = let ok p = [ e | Q ]\n                            ok _ = []\n                        in concatMap ok  l\n[ e | let decls, Q ]  = let decls in [ e | Q ]\n</code></pre>\n\n<p>Note the use of <code>Q</code>, which ranges over qualifiers (which can include functions), in the patterns. So the answer is yes, a list comprehension is higher-order.</p>\n"}, {"tags": [], "owner": {"reputation": 708, "user_id": 4553930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/308c878dca0a01a80bc9b5b9b19c7ab6?s=128&d=identicon&r=PG&f=1", "display_name": "Abhay", "link": "https://stackoverflow.com/users/4553930/abhay"}, "is_accepted": false, "score": 1, "last_activity_date": 1426396753, "creation_date": 1426396753, "answer_id": 29057510, "question_id": 29055913, "link": "https://stackoverflow.com/questions/29055913/haskell-are-list-comprehensions-higher-order-functions/29057510#29057510", "title": "Haskell: Are list comprehensions higher order functions?", "body": "<p>\u201dHigher order\" has a specific meaning. If a function takes an argument which is a function (or returns a function), the former is said to be higher order. (For example: map.)</p>\n\n<p>List comprehensions are expressions representing list values, not functions. So the answer is: No.</p>\n"}], "owner": {"reputation": 571, "user_id": 2850913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0102d3704dfeadc6e05b3f9374b6584a?s=128&d=identicon&r=PG&f=1", "display_name": "tail_recursion", "link": "https://stackoverflow.com/users/2850913/tail-recursion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "accepted_answer_id": 29055984, "answer_count": 2, "score": 4, "last_activity_date": 1426427764, "creation_date": 1426379478, "last_edit_date": 1426403048, "question_id": 29055913, "link": "https://stackoverflow.com/questions/29055913/haskell-are-list-comprehensions-higher-order-functions", "title": "Haskell: Are list comprehensions higher order functions?", "body": "<p>I have an assignment where we are not supposed to use any higher order functions, could a list comprehension be classified as a higher order function?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1426380624, "post_id": 29055883, "comment_id": 46349269, "body": "What does that mean? What&#39;s <code>2^x++</code>?"}, {"owner": {"reputation": 322, "user_id": 4214173, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/e6186849fa903475fdfca205612d767e?s=128&d=identicon&r=PG&f=1", "display_name": "bajky", "link": "https://stackoverflow.com/users/4214173/bajky"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426380932, "post_id": 29055883, "comment_id": 46349328, "body": "by algorithm to convert binary number to decimal number indexing number from right  ... 2^0 2^1 2^2 ...*0 || *1"}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1426383241, "creation_date": 1426383241, "answer_id": 29056296, "question_id": 29055883, "link": "https://stackoverflow.com/questions/29055883/how-implement-2x-in-haskell/29056296#29056296", "title": "How implement 2^x++ in haskell", "body": "<p>First off, you can't change variables in Haskell. Pretty much eveything is immutable. If you want a counter, the simplest way to get one is to add another argument to a function:</p>\n\n<pre><code>binToDec binary = binToDec binary 0 where\n  binToDec' 0 _ = 0\n  binToDec' binary counter = (remainder10 binary) * 2^counter + binToDec' (portion10 binary) (counter+1)\n</code></pre>\n\n<p>Secondly, however, you can actually do rather better in this case. Note that calculating <code>2^n</code> requires squaring 2 several times, and doing some extra multiplications. You can actually do without that.</p>\n"}, {"tags": [], "owner": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "is_accepted": false, "score": 0, "last_activity_date": 1426420478, "creation_date": 1426420478, "answer_id": 29060298, "question_id": 29055883, "link": "https://stackoverflow.com/questions/29055883/how-implement-2x-in-haskell/29060298#29060298", "title": "How implement 2^x++ in haskell", "body": "<p>Or you can do it like this, just another version:</p>\n\n<pre><code>binToDec :: Int -&gt; Int -&gt; Int\nbinToDec 0 _ = 0\nbinToDec b c = mod b 10 * 2^c + binToDec (div b 10) (c + 1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 1, "last_activity_date": 1426432508, "creation_date": 1426432508, "answer_id": 29062237, "question_id": 29055883, "link": "https://stackoverflow.com/questions/29055883/how-implement-2x-in-haskell/29062237#29062237", "title": "How implement 2^x++ in haskell", "body": "<p>Or without explicit recursion, with just playing with list functions</p>\n\n<pre><code>import Data.List\nimport Data.Tuple\n\nbinToDec x = sum $ zipWith (*) (unfoldr remainder x)\n                               (iterate (*2) 1) where\n    remainder 0 = Nothing\n    remainder x = Just . swap  $ divMod x 10\n</code></pre>\n\n<p><code>iterate (*2) 1</code> is the answer to your question , how to \"implement <code>2^x++</code>\".</p>\n"}], "owner": {"reputation": 322, "user_id": 4214173, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/e6186849fa903475fdfca205612d767e?s=128&d=identicon&r=PG&f=1", "display_name": "bajky", "link": "https://stackoverflow.com/users/4214173/bajky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1426432508, "creation_date": 1426379233, "question_id": 29055883, "link": "https://stackoverflow.com/questions/29055883/how-implement-2x-in-haskell", "title": "How implement 2^x++ in haskell", "body": "<p>Hi i programing function in Haskell, that convert binary number to decimal </p>\n\n<p>i have function remainder </p>\n\n<pre><code>--return last bit\nportion :: Integer -&gt; Integer \nportion10 n = n `div` 10\n\nremainder10 :: Integer -&gt; Integer\nremaindern10 n = n `mod` 10\n</code></pre>\n\n<p>now i wanna binToDec with use recursive</p>\n\n<pre><code>binToDec 0 = 0\nbinToDec binary = (remainder10 binary) * 2^x++ + binToDec (portion10 binary) \n</code></pre>\n\n<p>i need know how i can implement 2^x++ in me binToDec function :/ please help :)</p>\n"}, {"tags": ["haskell", "haskell-platform"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426388229, "post_id": 29055867, "comment_id": 46350518, "body": "The best rule of thumb for using <code>printf</code> in Haskell is &quot;Don&#39;t use <code>printf</code> in Haskell.&quot; It&#39;s weird, it&#39;s a bit slow, and if you break it you get to keep both pieces. Sure, you can use it from time to time if you want, but there are usually better ways."}], "answers": [{"tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 2, "last_activity_date": 1426380124, "creation_date": 1426380124, "answer_id": 29055975, "question_id": 29055867, "link": "https://stackoverflow.com/questions/29055867/print-database-with-printf-in-haskel/29055975#29055975", "title": "print database with printf in haskel", "body": "<p>The problem is that <code>cast</code> and <code>fans</code> are lists of <code>String</code>s, not <code>String</code>s themselves. <code>%s</code> only supports single strings.  The error message is slightly confused by <code>printf</code>'s internal type magic, but essentially tells that it wants a <code>Char</code> rather than a <code>String = [Char]</code>.</p>\n\n<p>You need to convert those lists to how you want them to get printed yourself. Something like</p>\n\n<pre><code>printFilms filmList = sequence_\n    [printf(\"|%-s| |%-20s| |%2d| |%.1f|\\n\") title (unwords cast) year (unwords fans)\n    | (title, cast, year, fans) &lt;- filmList]\n</code></pre>\n\n<p>should allow you to get it to compile, although you probably want to replace <code>unwords</code> (at least the first one) with your own subformatting functions.</p>\n"}], "owner": {"reputation": 1873, "user_id": 4668162, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/69cdf1bc32e68bcebbc21c69c6bcdbb4?s=128&d=identicon&r=PG&f=1", "display_name": "Onix", "link": "https://stackoverflow.com/users/4668162/onix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 29055975, "answer_count": 1, "score": 2, "last_activity_date": 1426380124, "creation_date": 1426379014, "question_id": 29055867, "link": "https://stackoverflow.com/questions/29055867/print-database-with-printf-in-haskel", "title": "print database with printf in haskel", "body": "<p>something is wrong with my printf method . i am trying to print all the movies in the testDatabase. is the problem coming from the format characters i used in printf?</p>\n\n<pre><code>import Prelude\nimport Data.Char\nimport Data.Int\nimport Text.Printf\n\n    -- Types\ntype Title = String\ntype Actor = String\ntype Cast = [Actor]\ntype Year = Int\ntype Fan = String\ntype Fans = [Fan]\ntype Period = (Year, Year)\n    type Database = [Film]\n\ntestDatabase :: Database\ntestDatabase = [(\"The Gunman\", [\"Idris Elba\", \"Sean Penn\", \" Javier Bardem\"], 2015,[\"Garry\", \"Dave\", \"Zoe\", \"Kevin\", \"Emma\"]),\n                (\"The Shawshank Redemption\", [\"Tim Robbins\", \"Morgan Freeman\", \"Bob Gunton\"],1994, [\"Bill\", \"Jo\", \"Garry\", \"Kevin\", \"Olga\", \"Liz\"]),\n                (\"The Dark Knight\", [\"Christian Bale\", \"Heath Ledger\",\"Aaron Eckhart\"], 2008, [\"Zoe\",\"Heidi\", \"Jo\", \"Emma\", \"Liz\", \"Sam\", \"Olga\", \"Kevin\", \"Tim\"]),\n                (\"Inception\", [\"Leonardo DiCaprio\", \"Ellen Page\"], 2010, [\"Jo\", \"Emma\", \"Zack\", \"Olga\", \"Kevin\"])]\n\n\n\nprintFilms :: Database -&gt; IO()\nprintFilms [] = putStrLn \"There are no films in the database\"\nprintFilms filmList = sequence_ [printf(\"|%-s| |%-20s| |%2d| |%.1f|\\n\") title cast year fans | (title, cast, year, fans) &lt;- filmList]\n\n\n\n\n No instance for (IsChar [Char]) arising from a use of `printf'\nPossible fix: add an instance declaration for (IsChar [Char])\nIn the expression:\n  printf (\"|%s| |%-20s| |%2d| |%.1f|\") title cast year fans\nIn the first argument of `sequence_', namely\n  `[printf (\"|%s| |%-20s| |%2d| |%.1f|\") title cast year fans |\n      (title, cast, year, fans) &lt;- filmList]'\nIn the expression:\n  sequence_\n    [printf (\"|%s| |%-20s| |%2d| |%.1f|\") title cast year fans |\n       (title, cast, year, fans) &lt;- filmList]\n</code></pre>\n"}, {"tags": ["haskell", "io", "numbers"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1426378439, "post_id": 29055736, "comment_id": 46348813, "body": "<code>getNumber = readLn</code>."}, {"owner": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1426378781, "post_id": 29055736, "comment_id": 46348880, "body": "yes, I know about readLn, but how can I re implement such function in this  style? @leftaroundabout"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1426379232, "post_id": 29055736, "comment_id": 46348990, "body": "Well, you just did, your second version is exactly equivalent to <code>readLn</code>."}, {"owner": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1426379531, "post_id": 29055736, "comment_id": 46349052, "body": "really? but I absolutely don&#39;t know how to get value from it. Say I want to read int from user, I have tried something like <code>num :: Int &lt;- getNumber</code> but it doesn&#39;t work. @leftaroundabout"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1426379853, "post_id": 29055736, "comment_id": 46349117, "body": "It should work alright. (Mind, that <code>x :: T &lt;- action</code> syntax needs the <code>ScopedTypeVariables</code> extension, but with that (or the equivalent writing <code>num &lt;- getNumber :: IO Int</code>) you should be fine)."}, {"owner": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1426380092, "post_id": 29055736, "comment_id": 46349162, "body": "snap! I have forgotten <i>IO</i> part."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1426380200, "post_id": 29055736, "comment_id": 46349184, "body": "Well, <code>num :: Int &lt;- getNumber</code> is actually the best way to write this IMO. Only, as I said, you need to <code>:set -XScopedTypeVariables</code> to use that syntax (as  ghci suggests, BTW!)"}, {"owner": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1426380281, "post_id": 29055736, "comment_id": 46349200, "body": "Although I intuitivly get it, I&#39;m still not sure why it needs to return something of a <b>Read</b> class, isn&#39;t the thing allready read in the <code>return</code> statement line? Shouldn&#39;t I be able to write definition like <code>getNumber :: IO Num</code>? It kind of makes more sense to me."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1426380720, "post_id": 29055736, "comment_id": 46349292, "body": "Why does it make more sense to you? How would you hope to use an action with such a signature? \u2014 Your action has \u201cnumber\u201d in its name, but it doesn&#39;t actually have anything to do with numbers, just with reading stuff from strings. <b>Therefore</b>, <code>Read</code> is the constraint you need. You can still add <code>Num</code> as an extra constraint, but this just makes it less general without changing anything at all. Better just drop <code>Number</code> from the name... i.e., simply use <code>readLn</code> right away (or some proper parsing library)."}, {"owner": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1426381743, "post_id": 29055736, "comment_id": 46349450, "body": "Because I&#39;m returning number that I&#39;ll use in calculations and not something I will read later, that is allready taken care of in my function <code>read string</code>. At least that is my logic. Final result of my <code>getNumber</code> function should be <code>IO Num</code> type from which I can extract value that acts like a number and not member of <code>Read</code>. (I&#39;m not exactly sure what I&#39;m talking about here, still a bit confused :D)"}, {"owner": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1426381805, "post_id": 29055736, "comment_id": 46349459, "body": "It&#39;s analogue to my first <code>getFloat</code> function."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1426382612, "post_id": 29055736, "comment_id": 46349613, "body": "No, it&#39;s not analogue to <code>getFloat</code> because <code>Num</code> is a <i>type class</i>. Types (such a <code>Float</code>) and type classes are two completely and fundamentally different concepts. \u2013 I elaborate somewhat in my answer."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1426390500, "post_id": 29055736, "comment_id": 46350939, "body": "@Reygoch In this case, the class constraint is not about what you can do with the value later, but about how values of the given type can be built. Since you use <code>read</code>, you need to know that the type you&#39;re asking for can be constructed out of a <code>String</code> with <code>read</code> -- that is, that it is an instance of the <code>Read</code> class."}], "answers": [{"comments": [{"owner": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "edited": false, "score": 0, "creation_date": 1426413079, "post_id": 29056224, "comment_id": 46354997, "body": "Thank you very much! You have really cleared it up for me. I think I understand now. I was expecting result type to be member of Num class since read can be used like this : <code>someNum = read string :: Int</code>"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 2, "last_activity_date": 1426382932, "last_edit_date": 1426382932, "creation_date": 1426382544, "answer_id": 29056224, "question_id": 29055736, "link": "https://stackoverflow.com/questions/29055736/general-function-for-reading-numbers-in-haskell/29056224#29056224", "title": "General function for reading numbers in Haskell", "body": "<p>When you write the signature</p>\n\n<pre><code>getNumber' :: Num a =&gt; IO a\n</code></pre>\n\n<p>it means this action will need to be able to offer any result type <code>a</code> that the caller might request &ndash; provided the type is an instance of the <code>Num</code> class. So essentially, the action knows nothing about the type it has to produce, though it can use the methods of that particular <code>Num</code> instance:</p>\n\n<pre><code>class Num a where\n  fromInteger :: Integer -&gt; a\n  (+) :: a -&gt; a -&gt; a\n  ...\n</code></pre>\n\n<p>Note that this does not give you any tools to generate fractional/floating-pt. numbers, only integer ones. You could in fact write</p>\n\n<pre><code>getNumber' :: Num a =&gt; IO a\ngetNumber' = do\n   i &lt;- readLn\n   return $ fromInteger i\n</code></pre>\n\n<p>but this is pretty useless, indeed it'll fail if you actually attempt to read something like <code>0.3</code> to a float &ndash; because that can't be pulled through the intermediate <code>Integer</code> type.</p>\n\n<p>You could do this:</p>\n\n<pre><code>getNumber'' :: Fractional a =&gt; IO a\ngetNumber'' = do\n   q &lt;- readLn\n   return $ fromRational q\n</code></pre>\n\n<p>in this case, the input will first be read as an arbitrary-precision rational type (which can deal with decimal-fraction input) and then converted to the desired final type, like <code>Double</code><sup>1</sup>. However, this can <em>not</em> be an integer type, because those obviously could not handle the possible fractional inputs!</p>\n\n<p>Maybe what you envision is this:</p>\n\n<pre><code>getNumber''' :: IO (\u2203a. Num a =&gt; a)\n</code></pre>\n\n<p>which would be an <em>existential type</em>. That's basically a constrained <em>dynamic type</em>, i.e. the type is not chosen at compile-type by inference from what the caller wants, but instead at runtime, choosing a suitable type that can properly deal with the particular string input (integer if possible, floating if needed).</p>\n\n<p>Well, Haskell doesn't have<sup>2</sup> existential types, and <a href=\"https://lukepalmer.wordpress.com/2010/01/24/haskell-antipattern-existential-typeclass/\" rel=\"nofollow\">for good reasons</a>. Its standard parametric polymorphism is rather more useful because you actually get guarantees that some type will be exactly what you specify at compile time. Value should be integral? Make it an <code>Integer</code>; if then a decimal-fraction turns up in the input you get a meaningful error message right a way. Value might be fractional? Make it <code>Rational</code> or <code>Double</code>; these of course include integral values as well.</p>\n\n<p>At any rate, there's no real reason to constrain the action to any numerical class. If you make it polymorphic at all, you should constrain it only as much as needed for the implementation (i.e., <code>Read</code>). To sum up: simply use <code>readLn</code>, don't write any <code>getT\u028f\u1d18\u1d07</code> action at all.</p>\n\n<hr>\n\n<p><sup>1</sup><sub>As a general rule, <a href=\"https://wiki.haskell.org/Performance/Floating_point\" rel=\"nofollow\">never use <code>Float</code></a> except when you're sure <code>Double</code> is not what you want.</sub></p>\n\n<p><sup>2</sup><sub>Well, it has a (generally disrecommended) workaround: existentially qualified record constructors.</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\ndata SomeNum where\n  SomeNum :: Num a =&gt; a -&gt; SomeNum\ngetNumber'''' :: IO SomeNum\n</code></pre>\n\n<p></sub></p>\n"}], "owner": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "accepted_answer_id": 29056224, "answer_count": 1, "score": 1, "last_activity_date": 1426382932, "creation_date": 1426377750, "question_id": 29055736, "link": "https://stackoverflow.com/questions/29055736/general-function-for-reading-numbers-in-haskell", "title": "General function for reading numbers in Haskell", "body": "<p>So, I wanted to get a <code>Float</code> from user and I have made this function :</p>\n\n<pre><code>getFloat :: IO Float\ngetFloat = do\n    string &lt;- getLine\n    return (read string :: Float)\n</code></pre>\n\n<p>Now I would like to know how to make a more general function that can return ints, doubles and floats all in one go.</p>\n\n<p>I have tried using <code>Num</code> type class to accomodate more possibilities but it doesn't work.</p>\n\n<p>This is as far as I have got, it compiles but I'm not sure what I'm doing here exactly nor if it works at all.</p>\n\n<pre><code>etNumber :: (Read a) =&gt; IO a\ngetNumber = do\n    string &lt;- getLine\n    return (read string)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 41, "user_id": 4656504, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/253d2e29a758b74cda85d9e6a8b2c63f?s=128&d=identicon&r=PG&f=1", "display_name": "Dipz", "link": "https://stackoverflow.com/users/4656504/dipz"}, "edited": false, "score": 0, "creation_date": 1426377268, "post_id": 29055619, "comment_id": 46348565, "body": "type Title = String        type Actor = String         type Cast = [Actor]          type Year = Int           type Fan = String     type Fans = [Fan]      type Film = (Title, Cast, Year, Fans)"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4656504, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/253d2e29a758b74cda85d9e6a8b2c63f?s=128&d=identicon&r=PG&f=1", "display_name": "Dipz", "link": "https://stackoverflow.com/users/4656504/dipz"}, "edited": false, "score": 0, "creation_date": 1426377741, "post_id": 29055683, "comment_id": 46348658, "body": "Ahhh GREAT. its working now thanks! Am i correct by assuming that elem is a function which searches through a specific string in a list?"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 41, "user_id": 4656504, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/253d2e29a758b74cda85d9e6a8b2c63f?s=128&d=identicon&r=PG&f=1", "display_name": "Dipz", "link": "https://stackoverflow.com/users/4656504/dipz"}, "edited": false, "score": 0, "creation_date": 1426377815, "post_id": 29055683, "comment_id": 46348675, "body": "Yes, although it works for lists of other types than strings as well."}], "tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 1, "last_activity_date": 1426377348, "creation_date": 1426377348, "answer_id": 29055683, "question_id": 29055619, "link": "https://stackoverflow.com/questions/29055619/haskell-logical-output-error/29055683#29055683", "title": "Haskell logical output error", "body": "<p>When you use the pattern <code>fan:fans</code>, <code>fan</code> becomes bound to only the <em>first</em> element in a list of fans. Since <code>\"Tim\"</code> never occurs at that spot, you get no hits.</p>\n\n<p>You probably want something like</p>\n\n<pre><code>showFanFilms name database\n =  filter(\\(title, cast, year, fans) -&gt; name `elem` fans) database\n</code></pre>\n\n<p>instead.</p>\n"}], "owner": {"reputation": 41, "user_id": 4656504, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/253d2e29a758b74cda85d9e6a8b2c63f?s=128&d=identicon&r=PG&f=1", "display_name": "Dipz", "link": "https://stackoverflow.com/users/4656504/dipz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 29055683, "answer_count": 1, "score": 0, "last_activity_date": 1426377348, "creation_date": 1426376809, "question_id": 29055619, "link": "https://stackoverflow.com/questions/29055619/haskell-logical-output-error", "title": "Haskell logical output error", "body": "<p>Here is my following code which is meant to filter out the films that contains the users names below is my database</p>\n\n<pre><code> testDatabase :: [Film]\ntestDatabase = [\n                    (\"Casino Royale\", [\"Daniel Craig\", \"Eva Green\", \"Judi Dench\"], 2006, [\"Garry\", \"Dave\", \"Zoe\", \"Kevin\", \"Emma\"]),\n                (\"The Departed\", [\"Leonardo DiCaprio\", \"Matt Damon\", \"Jack Nicholson\"], 2006, [\"Zoe\", \"Emma\", \"Paula\", \"Olga\", \"Dave\"]),\n                (\"Inception\", [\"Leonardo DiCaprio\"], 2010, [\"Chris\", \"Emma\", \"Jo\", \"Bill\", \"Dave\", \"Liz\", \"Wally\", \"Zoe\", \"Amy\", \"Sam\", \"Paula\", \"Kevin\", \"Olga\"]),\n                (\"Up in the Air\", [\"George Clooney\", \"Vera Farmiga\"], 2009, [\"Wally\", \"Liz\", \"Kevin\", \"Tim\", \"Emma\"]),\n                (\"The Shawshank Redemption\", [\"Tim Robbins\", \"Morgan Freeman\"], 1994, [\"Jo\", \"Wally\", \"Liz\", \"Tim\", \"Sam\", \"Zoe\", \"Emma\", \"Garry\", \"Olga\", \"Kevin\"])\n           ]\n</code></pre>\n\n<p>And here is there function which does as specifed above</p>\n\n<pre><code>showFanFilms :: String -&gt; [Film] -&gt; [Film]\nshowFanFilms name database\n =  filter(\\(title, cast, year, fan:fans) -&gt; fan == name) database\n</code></pre>\n\n<p>every time I run the code with the correct input for example</p>\n\n<pre><code>showFanFilms \"Tim\" testDatabase\n</code></pre>\n\n<p>it keeps giving me an empty array</p>\n\n<pre><code>   []\n</code></pre>\n\n<p>Any ideas why?</p>\n"}, {"tags": ["opengl", "haskell", "shader", "vertices"], "comments": [{"owner": {"reputation": 10492, "user_id": 603688, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1058344e1b119c4d9dd3aedc5456277b?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/603688/dan"}, "edited": false, "score": 0, "creation_date": 1426517895, "post_id": 29055257, "comment_id": 46393161, "body": "I think you&#39;re transposing the matrix. GL wants column major."}, {"owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "reply_to_user": {"reputation": 10492, "user_id": 603688, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1058344e1b119c4d9dd3aedc5456277b?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/603688/dan"}, "edited": false, "score": 0, "creation_date": 1426519348, "post_id": 29055257, "comment_id": 46394192, "body": "I specify column major when I get the matrix components, aren&#39;t I?"}], "answers": [{"comments": [{"owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "edited": false, "score": 0, "creation_date": 1426498893, "post_id": 29056845, "comment_id": 46381169, "body": "Is there another way to use transformation matrices in the shaders, then? As I understand it, the built in names for them have been deprecated."}], "tags": [], "owner": {"reputation": 2567, "user_id": 994206, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/699bacad8f85a069dda312cc29e03baa?s=128&d=identicon&r=PG", "display_name": "Mokosha", "link": "https://stackoverflow.com/users/994206/mokosha"}, "is_accepted": false, "score": 0, "last_activity_date": 1426389296, "creation_date": 1426389296, "answer_id": 29056845, "question_id": 29055257, "link": "https://stackoverflow.com/questions/29055257/how-do-i-send-a-uniform-matrix-to-a-shader-in-haskell/29056845#29056845", "title": "How do I send a uniform matrix to a shader in Haskell?", "body": "<p>Haskell's OpenGL bindings (currently 2.11.1.0) don't expose a function for uniform matrix values. This has been reported multiple times on the bug tracker:</p>\n\n<ul>\n<li><a href=\"https://github.com/haskell-opengl/OpenGL/issues/68\" rel=\"nofollow\">https://github.com/haskell-opengl/OpenGL/issues/68</a></li>\n<li><a href=\"https://github.com/haskell-opengl/OpenGL/issues/33\" rel=\"nofollow\">https://github.com/haskell-opengl/OpenGL/issues/33</a></li>\n<li><a href=\"https://github.com/haskell-opengl/OpenGL/issues/14\" rel=\"nofollow\">https://github.com/haskell-opengl/OpenGL/issues/14</a></li>\n</ul>\n\n<p>That being said, if you have a datatype that satisfies an instance of type <code>Storable</code>, such as the <code>M44 Float</code> type from <a href=\"https://hackage.haskell.org/package/linear\" rel=\"nofollow\">ekmett/linear</a>, you can just use the raw pointer to the proper OpenGLRaw bindings call. <a href=\"https://github.com/Mokosha/Lambency/blob/master/lib/Lambency/Shader.hs#L61\" rel=\"nofollow\">See an example here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "is_accepted": true, "score": 0, "last_activity_date": 1426520183, "creation_date": 1426520183, "answer_id": 29080869, "question_id": 29055257, "link": "https://stackoverflow.com/questions/29055257/how-do-i-send-a-uniform-matrix-to-a-shader-in-haskell/29080869#29080869", "title": "How do I send a uniform matrix to a shader in Haskell?", "body": "<p>Got it working! Main reason it wasn't working is because I wasn't using the projection matrix as well. </p>\n\n<p>Please don't beat me with sticks for my bad/confusing variable names. </p>\n\n<pre><code>    mvMatrix &lt;- get ((matrix $ Just $ Modelview 0)::StateVar(GLmatrix GLfloat))\n    pMatrix &lt;- get ((matrix $ Just Projection)::StateVar(GLmatrix GLfloat))\n    mv &lt;- getMatrixComponents ColumnMajor mvMatrix\n    pm &lt;-   getMatrixComponents ColumnMajor pMatrix\n    let mvm = getMat mv\n    let pM = getMat pm \n    let mvmp = mvm !*! pM\n    setUniform p \"uModelViewMatrix\" mvmp\n</code></pre>\n\n<p>My getMat function is as:</p>\n\n<pre><code>getMat :: [GLfloat] -&gt; V4 (V4 GLfloat)\ngetMat (a11:a12:a13:a14: \n            a21:a22:a23:a24:\n            a31:a32:a33:a34:\n            a41:a42:a43:a44:_) = V4 (V4 a11 a12 a13 a14)\n             (V4 a21 a22 a23 a24)\n             (V4 a31 a32 a33 a34)\n             (V4 a41 a42 a43 a44)\n</code></pre>\n\n<p>I'm using the Linear package. The <code>!*!</code> infix function is a matrix multiplication.</p>\n\n<p>This works exactly as I wanted it to, so yay! Hope it helps anyone else! </p>\n"}], "owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 0, "accepted_answer_id": 29080869, "answer_count": 2, "score": 1, "last_activity_date": 1438000257, "creation_date": 1426374046, "last_edit_date": 1438000257, "question_id": 29055257, "link": "https://stackoverflow.com/questions/29055257/how-do-i-send-a-uniform-matrix-to-a-shader-in-haskell", "title": "How do I send a uniform matrix to a shader in Haskell?", "body": "<p>Trying to do essentially do matrix multiplication on vertices in shaders for transformations and it's uh, not having it. </p>\n\n<p>At the moment, I've got this:</p>\n\n<pre><code>curMatrix &lt;- get ((matrix $ Just $ Modelview 0)::StateVar(GLmatrix GLfloat))\n       mc &lt;- getMatrixComponents ColumnMajor curMatrix\nsetUniform p \"uModelViewMatrix\" mc \n</code></pre>\n\n<p>setUniform being a function in the GLUtil package. Do I need to convert my array to a Vec4 (Vec4), or is there another way? </p>\n\n<p>Thanks!</p>\n\n<p>Edit:</p>\n\n<p>I've ended up doing this:</p>\n\n<pre><code>getMat :: [GLfloat] -&gt; [V4 GLfloat]\ngetMat (a11:a12:a13:a14: \n        a21:a22:a23:a24:\n        a31:a32:a33:a34:\n        a41:a42:a43:a44:_) = [(V4 a11 a12 a13 a14),\n                              (V4 a21 a22 a23 a24),\n                              (V4 a31 a32 a33 a34),\n                              (V4 a41 a42 a43 a44)]\n</code></pre>\n\n<p>And uh, well that doesn't seem to have worked!</p>\n\n<p>Edit 2: What I mean by it didn't work is, that I got it to set it as a uniform variable, but now my object has disappeared! </p>\n"}, {"tags": ["haskell", "stack-overflow"], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 9, "last_activity_date": 1426372129, "last_edit_date": 1426372129, "creation_date": 1426371767, "answer_id": 29054940, "question_id": 29054898, "link": "https://stackoverflow.com/questions/29054898/why-does-this-haskell-code-produce-a-stack-overflow/29054940#29054940", "title": "Why does this Haskell code produce a stack overflow?", "body": "<p>You didn't define the methods of the instance.  The default for <code>show</code> uses <code>showPrec</code> (via <code>shows</code>) and the default for <code>showPrec</code> uses <code>show</code>.  So you have a cyclic definition which will clearly overflow the stack eventually.  Perhaps you intended to derive an instance?</p>\n\n<pre><code>Prelude&gt; data ImNewToHaskell = AndWhatIsThis deriving (Show)\nPrelude&gt; show AndWhatIsThis\n\"AndWhatIsThis\"\n</code></pre>\n\n<p>EDIT: Clearing up any issues with <code>instance</code> and <code>deriving</code>:</p>\n\n<p>When you type <code>instance</code> is means \"I am going to define my own instance or leverage the type class's default code\":</p>\n\n<pre><code>instance Show Foo where\n    show Foo = \"This is the string representing Foo\"\n</code></pre>\n\n<p>When you type <code>deriving</code> after a data declaration then the compiler will automatically generate a sensible instance for your type:</p>\n\n<pre><code>data MyType = OneOrMoreConstructors deriving (Show)\n</code></pre>\n\n<p>If you, or another programmer, did not deriving a desired instance and you do not desire to write your own then you can use standalone deriving, which yields the same result as using <code>deriving</code> but on its own line likely in a different module:</p>\n\n<pre><code>{-# LANGUAGE StandaloneDeriving #-}\nderiving instance Show MyType\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1426372067, "post_id": 29054965, "comment_id": 46347268, "body": "Notice the author is using GHC 7.6.3 which has no such warning."}], "tags": [], "owner": {"reputation": 23895, "user_id": 472416, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa78d79fb4238d200e26fb87e3de947b?s=128&d=identicon&r=PG", "display_name": "utdemir", "link": "https://stackoverflow.com/users/472416/utdemir"}, "is_accepted": false, "score": 5, "last_activity_date": 1426431652, "last_edit_date": 1426431652, "creation_date": 1426371904, "answer_id": 29054965, "question_id": 29054898, "link": "https://stackoverflow.com/questions/29054898/why-does-this-haskell-code-produce-a-stack-overflow/29054965#29054965", "title": "Why does this Haskell code produce a stack overflow?", "body": "<p><a href=\"https://ghc.haskell.org/trac/ghc/ticket/7633\" rel=\"nofollow\">Newer GHC's</a> emits a warning there:</p>\n\n<pre><code>\u03bb&gt; data ImNewToHaskell = AndWhatIsThis\n\u03bb&gt; instance Show ImNewToHaskell\n\n&lt;interactive&gt;:108:10: Warning:\n    No explicit implementation for\n      either \u2018showsPrec\u2019 or \u2018show\u2019\n    In the instance declaration for \u2018Show ImNewToHaskell\u2019\n\u03bb&gt; show AndWhatIsThis\n\"*** Exception: stack overflow\n</code></pre>\n\n<p>As you can see, you aren't defining an implementation for methods necessary, and the <a href=\"http://git.haskell.org/packages/base.git/blob_plain/HEAD:/GHC/Show.lhs\" rel=\"nofollow\">default implementations</a> of the methods cause infinite recursion and therefore stack overflow.</p>\n\n<pre><code>class  Show a  where\n    showsPrec :: Int -&gt; a -&gt; ShowS\n    show      :: a   -&gt; String\n    showList  :: [a] -&gt; ShowS\n\n    showsPrec _ x s = show x ++ s\n    show x          = shows x \"\"\n    showList ls   s = showList__ shows ls s\n\nshows           :: (Show a) =&gt; a -&gt; ShowS\nshows           =  showsPrec 0\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4671827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b785b766d7e73285a6ff87efa1b18cb3?s=128&d=identicon&r=PG&f=1", "display_name": "dawr", "link": "https://stackoverflow.com/users/4671827/dawr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 554, "favorite_count": 0, "accepted_answer_id": 29054940, "answer_count": 2, "score": 3, "last_activity_date": 1426431652, "creation_date": 1426371374, "question_id": 29054898, "link": "https://stackoverflow.com/questions/29054898/why-does-this-haskell-code-produce-a-stack-overflow", "title": "Why does this Haskell code produce a stack overflow?", "body": "<p>I'm playing around with Haskell for the first time. I wrote these three lines, expecting to get a compiler error, but typing it inside <code>ghci</code> results in a stack overflow.</p>\n\n<pre><code>$ ghci\nGHCi, version 7.6.3: http://www.haskell.org/ghc/  :? for help\nLoading package ghc-prim ... linking ... done.\nLoading package integer-gmp ... linking ... done.\nLoading package base ... linking ... done.\nPrelude&gt; data ImNewToHaskell = AndWhatIsThis\nPrelude&gt; instance Show ImNewToHaskell\nPrelude&gt; show AndWhatIsThis\n\"*** Exception: stack overflow\n</code></pre>\n\n<p>Can anyone explain this behavior?</p>\n"}, {"tags": ["haskell", "types"], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1426370221, "post_id": 29054617, "comment_id": 46346741, "body": "<code>t1</code> in your second text block should be <code>t2</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1426370489, "post_id": 29054617, "comment_id": 46346833, "body": "@ThomasM.DuBuisson Thanks. Fixed."}, {"owner": {"reputation": 465, "user_id": 3541888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/341f9846dc6bfc0a531e074a507a3e1e?s=128&d=identicon&r=PG&f=1", "display_name": "dmw64", "link": "https://stackoverflow.com/users/3541888/dmw64"}, "edited": false, "score": 0, "creation_date": 1426371699, "post_id": 29054617, "comment_id": 46347189, "body": "You are right, this is how is has to be done. Thank you very much :D"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 9, "last_activity_date": 1426370804, "last_edit_date": 1426370804, "creation_date": 1426369703, "answer_id": 29054617, "question_id": 29054454, "link": "https://stackoverflow.com/questions/29054454/type-of/29054617#29054617", "title": "Type of (.) . (.)", "body": "<p>The expression <code>(.) . (.)</code> means <code>(.) (.) (.)</code>. To obtain its type let's start from:</p>\n\n<pre><code>(.) :: (t2 -&gt; t3) -&gt; (t1 -&gt; t2) -&gt; t1 -&gt; t3\n(.)    (.)        :: ???\n</code></pre>\n\n<p>Let's alpha-convert the type of second <code>(.)</code> to <code>(a2 -&gt; a3) -&gt; (a1 -&gt; a2) -&gt; a1 -&gt; a3</code>. This type is <code>t2 -&gt; t3</code>, so we get</p>\n\n<pre><code>t2 = a2 -&gt; a3\nt3 = (a1 -&gt; a2) -&gt; a1 -&gt; a3\n</code></pre>\n\n<p>Hence,</p>\n\n<pre><code>(.) (.) :: (t1 -&gt; t2) -&gt; t1 -&gt; t3    with the above t2,t3\n(.) (.) :: (t1 -&gt; a2 -&gt; a3) -&gt; t1 -&gt; (a1 -&gt; a2) -&gt; a1 -&gt; a3\n</code></pre>\n\n<p>Now,</p>\n\n<pre><code>(.) (.) :: (t1 -&gt; a2 -&gt; a3) -&gt; t1 -&gt; (a1 -&gt; a2) -&gt; a1 -&gt; a3\n(.) (.)    (.)              :: ???\n</code></pre>\n\n<p>Let the third <code>(.)</code> have type <code>(b2 -&gt; b3) -&gt; (b1 -&gt; b2) -&gt; b1 -&gt; b3</code>. \nThis is <code>t1 -&gt; a2 -&gt; a3</code>, so we get</p>\n\n<pre><code>t1 = b2 -&gt; b3\na2 -&gt; a3 = (b1 -&gt; b2) -&gt; b1 -&gt; b3\n</code></pre>\n\n<p>hence</p>\n\n<pre><code>t1 = b2 -&gt; b3\na2 = b1 -&gt; b2\na3 = b1 -&gt; b3\n</code></pre>\n\n<p>Concluding:</p>\n\n<pre><code>(.) (.) (.) :: t1 -&gt; (a1 -&gt; a2) -&gt; a1 -&gt; a3   with the above t1,a2,a3\n(.) (.) (.) :: (b2 -&gt; b3) -&gt; (a1 -&gt; b1 -&gt; b2) -&gt; a1 -&gt; b1 -&gt; b3\n</code></pre>\n\n<p>which is your expected type</p>\n\n<pre><code>               (b  -&gt; c ) -&gt; (a  -&gt; a1 -&gt; b ) -&gt; a  -&gt; a1 -&gt; c\n</code></pre>\n\n<p>once type variables are alpha-converted.</p>\n"}], "owner": {"reputation": 465, "user_id": 3541888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/341f9846dc6bfc0a531e074a507a3e1e?s=128&d=identicon&r=PG&f=1", "display_name": "dmw64", "link": "https://stackoverflow.com/users/3541888/dmw64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 1, "accepted_answer_id": 29054617, "answer_count": 1, "score": 4, "last_activity_date": 1426370804, "creation_date": 1426368721, "last_edit_date": 1426369009, "question_id": 29054454, "link": "https://stackoverflow.com/questions/29054454/type-of", "title": "Type of (.) . (.)", "body": "<p>How can one infer that the type of <code>(.) . (.)</code> is <code>(b -&gt; c) -&gt; (a -&gt; a1 -&gt; b) -&gt; a -&gt; a1 -&gt; c</code>?</p>\n\n<p>(What I thought and which is obviously wrong is: The type of <code>(.)</code> is <code>(t2-&gt;t3) -&gt; (t1-&gt;t2) -&gt; t1 -&gt; t3</code>, which should be the same as <code>(t2-&gt;t3) -&gt; [(t1-&gt;t2) -&gt; (t1-&gt;t3)]</code> (using also <code>[]{}</code> for readability). Hence, the type of <code>(.) . (.)</code> should be something like <code>{(b2-&gt;b3) -&gt; [(b1-&gt;b2) -&gt; (b1-&gt;b3)]} -&gt; {(a2-&gt;a3) -&gt; [(a1-&gt;a2) -&gt; (a1-&gt;a3)]}</code> which requires <code>(b2-&gt;b3)</code> to match <code>[(a1-&gt;a2) -&gt; (a1-&gt;a3)]</code>... </p>\n\n<p>But this never leads to the desired type. </p>\n\n<p>What is wrong?</p>\n"}, {"tags": ["haskell", "immutability", "frege"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1426366599, "post_id": 29053945, "comment_id": 46345659, "body": "It depends. Mutability can be obtained through the <code>State Person</code> monad. If you also need to do IO on top of that, then you probably need <code>StateT Person IO</code> instead."}, {"owner": {"reputation": 1308, "user_id": 2746333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a006d823040407817369ae675172ac39?s=128&d=identicon&r=PG", "display_name": "Dierk", "link": "https://stackoverflow.com/users/2746333/dierk"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1426367025, "post_id": 29053945, "comment_id": 46345782, "body": "The State monad doesn&#39;t cut it since you only get state succession (new states with every change) but no reference to a &quot;current&quot; state."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1426367350, "post_id": 29053945, "comment_id": 46345895, "body": "It&#39;s very unclear to me what you are trying to express in this bit of  pseudocode."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1426367364, "post_id": 29053945, "comment_id": 46345903, "body": "What would you consider a &quot;reference to a current state&quot;, exactly? It can&#39;t be some value <code>current :: Person</code> since that would be immutable."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426367446, "post_id": 29053945, "comment_id": 46345925, "body": "You <i>might</i> be looking for something like <code>IORef</code>."}, {"owner": {"reputation": 1308, "user_id": 2746333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a006d823040407817369ae675172ac39?s=128&d=identicon&r=PG", "display_name": "Dierk", "link": "https://stackoverflow.com/users/2746333/dierk"}, "edited": false, "score": 0, "creation_date": 1426367810, "post_id": 29053945, "comment_id": 46346023, "body": "It is most likely is some kind of reference type but IO should not be required."}], "answers": [{"comments": [{"owner": {"reputation": 1308, "user_id": 2746333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a006d823040407817369ae675172ac39?s=128&d=identicon&r=PG", "display_name": "Dierk", "link": "https://stackoverflow.com/users/2746333/dierk"}, "edited": false, "score": 0, "creation_date": 1426369904, "post_id": 29054402, "comment_id": 46346656, "body": "Thanks, this is certainly a solution for my question."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1426368365, "creation_date": 1426368365, "answer_id": 29054402, "question_id": 29053945, "link": "https://stackoverflow.com/questions/29053945/mutable-references-to-immutable-data-in-haskell/29054402#29054402", "title": "Mutable references to immutable data in Haskell", "body": "<p>I'm not sure about what the question really asks for. The posted example\ncan be rewritten to use the <code>StateT Person IO</code> monad as follows.</p>\n\n<pre><code>import Control.Monad.State\n\ndata Person = Person {name, level, topic :: String }\n   deriving Show\n\ndierk :: Person\ndierk = Person \"Dierk\" \"confident\" \"Java\"\n\nworks :: Person -&gt; String\nworks person = name person ++ \" is \" ++ level person ++ \" in \" ++ topic person\n\nmain :: IO ()\nmain = flip evalStateT dierk $ do\n   -- use the current topic\n   lift . putStrLn . works =&lt;&lt; get\n   -- change the current topic\n   modify (\\t -&gt; t{level= \"proficient\", topic=\"Groovy\"})\n   lift . putStrLn . works =&lt;&lt; get\n   -- change the current topic\n   modify (\\t -&gt; t{level= \"dabbling\", topic=\"Haskell\"})\n   lift . putStrLn . works =&lt;&lt; get\n\n{- Output:\nDierk is confident in Java\nDierk is proficient in Groovy\nDierk is dabbling in Haskell\n-}\n</code></pre>\n\n<p>If instead a real reference type is wanted, one could use <code>IORef Person</code>, or <code>STRef</code> if in the <code>ST</code> monad. But in such case, you must be working inside some monad allowing these reference types. By comparison, <code>StateT Person m</code> works in any monad <code>m</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1308, "user_id": 2746333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a006d823040407817369ae675172ac39?s=128&d=identicon&r=PG", "display_name": "Dierk", "link": "https://stackoverflow.com/users/2746333/dierk"}, "is_accepted": false, "score": 0, "last_activity_date": 1426448979, "creation_date": 1426448979, "answer_id": 29065392, "question_id": 29053945, "link": "https://stackoverflow.com/questions/29053945/mutable-references-to-immutable-data-in-haskell/29065392#29065392", "title": "Mutable references to immutable data in Haskell", "body": "<p>Just to wrap up and give hints to other Haskell newbies like me - here is the solution that I finally settled with. This is no pseudo-code :-) but Frege (a Haskell for the JVM) that has some minor notational differences.</p>\n\n<pre><code>module Person where\n\nimport frege.control.monad.State\n\ndata Person = Person {name, level, topic :: String }\n\nderive Show Person\n\ndierk = Person \"Dierk\" \"confident\" \"Java\"\n\nworks :: Person -&gt; String\nworks person = person.name ++ \" is \" ++ person.level ++ \" in \" ++ person.topic\n\nprintCurrentPerson :: StateT Person IO ()\nprintCurrentPerson = do\n    person &lt;- StateT.get            -- independent of any particular person reference\n    StateT.lift $ println $ works person\n\nupdateCurrentPerson :: Monad m =&gt; String -&gt; String -&gt; StateT Person m ()\nupdateCurrentPerson level topic = do\n    StateT.modify (\\person -&gt; Person.{level= level, topic=topic} person)\n\nusingMutableRefsToImmutableState :: Person -&gt; IO ((),Person)\nusingMutableRefsToImmutableState start =\n    flip StateT.run start $ do\n        printCurrentPerson\n        updateCurrentPerson \"proficient\" \"Groovy\"\n        printCurrentPerson\n        StateT.lift $ println \"-- user input could influence which selection is 'current' \"\n        updateCurrentPerson \"dabbling\" \"Haskell\"\n        printCurrentPerson\n\nmain = do -- using the StateT transformer to work in combination with any monad (here: IO)\n    (_, lastPerson) &lt;- usingMutableRefsToImmutableState dierk\n    println \"-- a second round with relaying the last person\"\n    _ &lt;- usingMutableRefsToImmutableState lastPerson\n    return ()\n\n{-  output\n    Dierk is confident in Java\n    Dierk is proficient in Groovy\n    -- user input could influence which selection is 'current' \n    Dierk is dabbling in Haskell\n    -- a second round with relaying the last person\n    Dierk is dabbling in Haskell\n    Dierk is proficient in Groovy\n    -- user input could influence which selection is 'current' \n    Dierk is dabbling in Haskell\n-}\n</code></pre>\n\n<p>Thank you all.</p>\n"}], "owner": {"reputation": 1308, "user_id": 2746333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a006d823040407817369ae675172ac39?s=128&d=identicon&r=PG", "display_name": "Dierk", "link": "https://stackoverflow.com/users/2746333/dierk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 29054402, "answer_count": 2, "score": 1, "last_activity_date": 1426448979, "creation_date": 1426365668, "last_edit_date": 1426368552, "question_id": 29053945, "link": "https://stackoverflow.com/questions/29053945/mutable-references-to-immutable-data-in-haskell", "title": "Mutable references to immutable data in Haskell", "body": "<p>I'd like to keep track of a \"current\" value in a succession of immutable values.\nWhat is the best way to do that in Haskell without introducing a new reference for every new value?\nHere is an example:</p>\n\n<pre><code>data Person = Person {name, level, topic :: String }\n    deriving(Show)\n\ndierk :: Person\ndierk = Person \"Dierk\" \"confident\" \"Java\"\n\nworks :: Person -&gt; String\nworks person = name person ++ \" is \" ++ level person ++ \" in \" ++ topic person\n\n\nmain _ = do\n    putStrLn $ works dierk\n    -- do more with \"current\" topic\n    putStrLn $ works dierk {level= \"proficient\", topic=\"Groovy\"}\n    -- do more with \"current\" topic\n    putStrLn $ works dierk {level= \"dabbling\", topic=\"Haskell\"}\n    -- do more with \"current\" topic\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426387971, "post_id": 29052834, "comment_id": 46350478, "body": "I don&#39;t know why this question is getting such a negative reception. It strikes me as quite unexceptional."}], "answers": [{"tags": [], "owner": {"reputation": 27685, "user_id": 610979, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ku5ga.png?s=128&g=1", "display_name": "Frank Schmitt", "link": "https://stackoverflow.com/users/610979/frank-schmitt"}, "is_accepted": true, "score": 4, "last_activity_date": 1426381389, "last_edit_date": 1426381389, "creation_date": 1426359686, "answer_id": 29052967, "question_id": 29052834, "link": "https://stackoverflow.com/questions/29052834/display-all-films-in-a-database-haskell/29052967#29052967", "title": "display all films in a database haskell", "body": "<p>Look at the error message; ghci tells you that you're trying to print a function of type <em>Database -> [(Title, Cast, Year, Fans)]</em> and that it doesn't know how to do that.</p>\n\n<p>Presumably, you tried printing <code>displayAllFilms</code>, whereas you probably meant <code>displayAllFilms testDatabase</code></p>\n"}], "owner": {"reputation": 1873, "user_id": 4668162, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/69cdf1bc32e68bcebbc21c69c6bcdbb4?s=128&d=identicon&r=PG&f=1", "display_name": "Onix", "link": "https://stackoverflow.com/users/4668162/onix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 29052967, "answer_count": 1, "score": -2, "last_activity_date": 1426381389, "creation_date": 1426359013, "last_edit_date": 1426359721, "question_id": 29052834, "link": "https://stackoverflow.com/questions/29052834/display-all-films-in-a-database-haskell", "title": "display all films in a database haskell", "body": "<pre><code>    -- Types\n    type Title = String\n\ntype Actor = String\ntype Cast = [Actor]\ntype Year = Int\ntype Fan = String\ntype Fans = [Fan]\ntype Period = (Year, Year)\ntype Database = [Film]\n\n\n\n testDatabase :: Database\ntestDatabase = [(\"The Gunman\", [\"Idris Elba\", \"Sean Penn\", \" Javier Bardem\"], \n               2015,[\"Garry\", \"Dave\", \"Zoe\", \"Kevin\", \"Emma\"]),(\"The Shawshank Redemption\", [\"Tim Robbins\", \"Morgan Freeman\", \"Bob Gunton\"],1994, [\"Bill\", \"Jo\", \"Garry\"]),\n                (\"The Dark Knight\", [\"Christian Bale\", \"Heath Ledger\",\"Aaron Eckhart\"], 2008, [\"Zoe\",\"Heidi\", \"Jo\", \"Emma\", \"Liz\", \"Sam\", \"Olga\", \"Kevin\", \"Tim\"]),\n                (\"Inception\", [\"Leonardo DiCaprio\", \"Ellen Page\"], 2010, [\"Jo\", \"Emma\", \"Zack\", \"Olga\", \"Kevin\"])]\n\n\ndisplayAllFilms :: Database -&gt;[(Title, Cast, Year, Fans)]\ndisplayAllFilms [] = []\ndisplayAllFilms ((i, j, k, l): xs)\n    |l == [] = (i, j, k, []) : displayAllFilms xs\n    |otherwise = (i, j, k, l) : displayAllFilms xs \n</code></pre>\n\n<p>And i get this error> I dont know what to do. What is the Error?</p>\n\n<pre><code>*Main&gt; displayAllFilms\n\n&lt;interactive&gt;:13:1:\n    No instance for (Show (Database -&gt; [(Title, Cast, Year, Fans)]))\n      arising from a use of `print'\n    Possible fix:\n      add an instance declaration for\n      (Show (Database -&gt; [(Title, Cast, Year, Fans)]))\n    In a stmt of an interactive GHCi command: print it\n</code></pre>\n"}, {"tags": ["haskell", "cabal", "ihaskell"], "comments": [{"owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "edited": false, "score": 0, "creation_date": 1426357712, "post_id": 29052530, "comment_id": 46342879, "body": "does not work: <a href=\"http://stackoverflow.com/questions/24838712/cabal-reports-usr-bin-ld-cannot-find-lhsrandom-1-0-1-1-ghc7-8-3\" title=\"cabal reports usr bin ld cannot find lhsrandom 1 0 1 1 ghc7 8 3\">stackoverflow.com/questions/24838712/&hellip;</a>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1426361502, "post_id": 29052530, "comment_id": 46344138, "body": "Hurm.  You said <code>mtl-2.2.1</code> is installed but the library the linker is looking for is <code>mtl-2.1.3.1</code>.  I&#39;d hazard to guess that <i>none</i> of these are installed."}], "answers": [{"tags": [], "owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "is_accepted": false, "score": 2, "last_activity_date": 1426531280, "last_edit_date": 1592644375, "creation_date": 1426531280, "answer_id": 29084547, "question_id": 29052530, "link": "https://stackoverflow.com/questions/29052530/difficulties-installing-ihaskell/29084547#29084547", "title": "difficulties installing iHaskell", "body": "<p>After reading on StackOverflow and posting several issues on Github, I learned that my symlink to cabal was out of date.  For some reason it pointed to version 16 even after I downloaded and installed version 22.</p>\n<p><a href=\"https://github.com/ekmett/semigroupoids/issues/21\" rel=\"nofollow noreferrer\"><strong>semigroupoids</strong> Issue #21</a></p>\n<blockquote>\n<p>Even after updating with <code>cabal install cabal-install</code> it still didn't recognize <code>sandbox init</code> and it fact <code>cabal -V</code> showed it was still version 16.</p>\n<p>Using <code>where cabal</code> I found the faulty cabal executable from my <code>ghc-7.6</code> installation and replaced it with a symlink.  In my case</p>\n<p><code>sudo ln -s /home/jdm/.cabal/bin/cabal /usr/bin/cabal</code></p>\n<p>So now I have cabal version 23, I opened a sandbox and <strong>profunctors</strong> (and <strong>iHaskell</strong>) install perfectly.  Case closed.</p>\n</blockquote>\n"}], "owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 748, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426531280, "creation_date": 1426357282, "last_edit_date": 1495542615, "question_id": 29052530, "link": "https://stackoverflow.com/questions/29052530/difficulties-installing-ihaskell", "title": "difficulties installing iHaskell", "body": "<p>After much difficulty with <code>cabal install ihaskell</code> I read</p>\n\n<blockquote>\n  <p>If you have trouble with this installation, please make sure to try the Github version first. IHaskell is in rapid development, so Hackage may not always be the most recent. In order to install from Github, pull from the repository, and then install with <code>./build.sh all</code></p>\n</blockquote>\n\n<p>This morning I upgraded to <code>ghc-7.8.4</code> and <code>cabal-1.22</code> and I am downloading iHaskell from the github repository using a simple <code>git clone</code>.  </p>\n\n<p>It is having difficulting locating several libraries.  </p>\n\n<pre><code>/usr/bin/ld: cannot find -lHStransformers-compat-0.4.0.3-ghc7.8.4\n/usr/bin/ld: cannot find -lHSmtl-2.1.3.1-ghc7.8.4\n/usr/bin/ld: cannot find -lHStagged-0.7.3-ghc7.8.4\n/usr/bin/ld: cannot find -lHStext-1.2.0.4-ghc7.8.4\n/usr/bin/ld: cannot find -lHSvector-0.10.12.2-ghc7.8.4\n/usr/bin/ld: cannot find -lHSunordered-containers-0.2.5.1-ghc7.8.4\n/usr/bin/ld: cannot find -lHSsyb-0.4.4-ghc7.8.4\n/usr/bin/ld: cannot find -lHSmtl-2.1.3.1-ghc7.8.4\n/usr/bin/ld: cannot find -lHSdlist-0.7.1-ghc7.8.4\n/usr/bin/ld: cannot find -lHSattoparsec-0.12.1.3-ghc7.8.4\n/usr/bin/ld: cannot find -lHSscientific-0.3.3.7-ghc7.8.4\n/usr/bin/ld: cannot find -lHShashable-1.2.3.1-ghc7.8.4\n</code></pre>\n\n<p>Unfortunately I can verify some of these are present.  </p>\n\n<pre><code>me@ubuntu:~/Downloads/IHaskell$ cabal install mtl\nResolving dependencies...\nAll the requested packages are already installed:\nmtl-2.2.1\nUse --reinstall if you want to reinstall anyway\n</code></pre>\n\n<p><code>ld</code> seems to be more of a C++ error than a Haskell error but I don't know how to deal.</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/16710047/usr-bin-ld-cannot-find-lnameofthelibrary\">usr/bin/ld: cannot find -l&lt;nameOfTheLibrary&gt;</a></li>\n</ul>\n"}, {"tags": ["haskell", "ubuntu-14.04", "ghc"], "comments": [{"owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 4, "creation_date": 1426352625, "post_id": 29051419, "comment_id": 46341146, "body": "The <i>very place you linked to</i> explicitly says: &quot;The packages install into <code>&#47;opt&#47;ghc&#47;$VER&#47;</code> so in order to use them, the easiest way is to bring a particular GHC version into scope by placing the respective <code>&#47;opt&#47;ghc&#47;$VER&#47;bin</code> folder early into the PATH environment variable.&quot; Well then, is /opt/ghc/$VER/bin in your PATH?"}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1457748814, "creation_date": 1457748814, "answer_id": 35952948, "question_id": 29051419, "link": "https://stackoverflow.com/questions/29051419/installed-ghc-from-ppa-no-such-file-or-directory/35952948#35952948", "title": "installed ghc from PPA &#39;no such file or directory&#39;", "body": "<p>As the linked page describes</p>\n\n<blockquote>\n  <p>The packages install into <code>/opt/ghc/$VER/</code> so in order to use them, the easiest way is to bring a particular GHC version into scope by placing the respective <code>/opt/ghc/$VER/bin</code> folder early into the PATH environment variable.</p>\n</blockquote>\n"}], "owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 237, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1457748814, "creation_date": 1426351138, "question_id": 29051419, "link": "https://stackoverflow.com/questions/29051419/installed-ghc-from-ppa-no-such-file-or-directory", "title": "installed ghc from PPA &#39;no such file or directory&#39;", "body": "<p>I added GHC-7.10.1 from this <code>ppa:hvr/ghc</code> @ <a href=\"https://launchpad.net/~hvr/+archive/ubuntu/ghc\" rel=\"nofollow\">https://launchpad.net/~hvr/+archive/ubuntu/ghc</a></p>\n\n<p>However I can't seem to find ghc from the command line.  any suggestions?</p>\n\n<pre><code>me@ubuntu:~/Documents/haskell$ ghc\nbash: /usr/bin/ghc: No such file or directory\n</code></pre>\n"}, {"tags": ["haskell", "cabal", "ihaskell"], "comments": [{"owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "edited": false, "score": 0, "creation_date": 1426337263, "post_id": 29048977, "comment_id": 46336366, "body": "similar issue on Github <a href=\"https://github.com/ndmitchell/hlint/issues/116\" rel=\"nofollow noreferrer\">github.com/ndmitchell/hlint/issues/116</a>"}, {"owner": {"reputation": 1077, "user_id": 519066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc13eb3fe110b6ea822adbc797ba0454?s=128&d=identicon&r=PG", "display_name": "Justin Leitgeb", "link": "https://stackoverflow.com/users/519066/justin-leitgeb"}, "edited": false, "score": 0, "creation_date": 1426338393, "post_id": 29048977, "comment_id": 46336707, "body": "Looks like IHaskell depends on a version of hlint which may have an incompatibility with an API change in some versions of hscolour. Are you installing IHaskell from GitHub? If so, try eliminating the <a href=\"https://github.com/ndmitchell/hlint/issues/116\" rel=\"nofollow noreferrer\">version of hlint causing the bug</a> by changing the ihaskell.cabal lower bound of hlint to 1.9.17, which fixes that incompatibility with hscolour (<a href=\"https://github.com/gibiansky/IHaskell/blob/master/ihaskell.cabal#L74\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://github.com/gibiansky/IHaskell/blob/master/ihaskell.cabal#L173\" rel=\"nofollow noreferrer\">here</a>, change the <code>&gt;=1.9</code> to <code>&gt;=1.9.17</code>)."}, {"owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "reply_to_user": {"reputation": 1077, "user_id": 519066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc13eb3fe110b6ea822adbc797ba0454?s=128&d=identicon&r=PG", "display_name": "Justin Leitgeb", "link": "https://stackoverflow.com/users/519066/justin-leitgeb"}, "edited": false, "score": 0, "creation_date": 1426342168, "post_id": 29048977, "comment_id": 46337817, "body": "@JustinLeitgeb I am installing using cabal install, which may be <a href=\"https://hackage.haskell.org/package/ihaskell\" rel=\"nofollow noreferrer\">a little behind</a>.  When I install from github I get <code>could not resolve dependency</code> errors."}, {"owner": {"reputation": 2340, "user_id": 2068635, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/vFzWX.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2068635/stefan"}, "edited": false, "score": 0, "creation_date": 1426347442, "post_id": 29048977, "comment_id": 46339431, "body": "I installed IHaskell from Hackage in a new sandbox and everything went smoothly. The installed version of <code>hlint</code> is <code>1.9.17</code>."}, {"owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "reply_to_user": {"reputation": 2340, "user_id": 2068635, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/vFzWX.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2068635/stefan"}, "edited": false, "score": 0, "creation_date": 1426355775, "post_id": 29048977, "comment_id": 46342236, "body": "@Stefan Good for you unfortunately I am having difficulty.  Sandbox doesn&#39;t even work for me.  <code>cabal: unrecognised command: sandbox (try --help)</code>"}, {"owner": {"reputation": 2340, "user_id": 2068635, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/vFzWX.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2068635/stefan"}, "edited": false, "score": 0, "creation_date": 1426358933, "post_id": 29048977, "comment_id": 46343301, "body": "What version of <code>cabal</code> do you use? I&#39;m using version 1.22, which is almost the latest."}, {"owner": {"reputation": 1077, "user_id": 519066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc13eb3fe110b6ea822adbc797ba0454?s=128&d=identicon&r=PG", "display_name": "Justin Leitgeb", "link": "https://stackoverflow.com/users/519066/justin-leitgeb"}, "edited": false, "score": 0, "creation_date": 1426371919, "post_id": 29048977, "comment_id": 46347235, "body": "@johnmangual if sandbox is an unrecognized command, you&#39;ll need to upgrade cabal. Do cabal <code>update &amp;&amp; cabal install cabal-install</code> and you should be able to use sandboxes."}, {"owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "reply_to_user": {"reputation": 1077, "user_id": 519066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc13eb3fe110b6ea822adbc797ba0454?s=128&d=identicon&r=PG", "display_name": "Justin Leitgeb", "link": "https://stackoverflow.com/users/519066/justin-leitgeb"}, "edited": false, "score": 0, "creation_date": 1426375285, "post_id": 29048977, "comment_id": 46348050, "body": "@JustinLeitgeb still unable"}, {"owner": {"reputation": 2340, "user_id": 2068635, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/vFzWX.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2068635/stefan"}, "edited": false, "score": 0, "creation_date": 1426433177, "post_id": 29048977, "comment_id": 46360862, "body": "You might have to add the installation path of the updated cabal (iirc, somewhere in <code>~&#47;.cabal</code>) to your <code>$PATH</code> variable."}, {"owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "reply_to_user": {"reputation": 2340, "user_id": 2068635, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/vFzWX.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2068635/stefan"}, "edited": false, "score": 0, "creation_date": 1426475733, "post_id": 29048977, "comment_id": 46373430, "body": "@Stefan see <a href=\"http://stackoverflow.com/questions/29052530/difficulties-installing-ihaskell\" title=\"difficulties installing ihaskell\">stackoverflow.com/questions/29052530/&hellip;</a>"}], "owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1426336391, "creation_date": 1426336391, "question_id": 29048977, "link": "https://stackoverflow.com/questions/29048977/trying-to-install-ihaskell-conflicting-versions-of-hlint", "title": "trying to install iHaskell - conflicting versions of hLint", "body": "<p>According to the <a href=\"http://gibiansky.github.io/IHaskell/\" rel=\"nofollow\">iHaskell</a> page it should be possible to install from Hackage</p>\n\n<pre><code>cabal install ihaskell\n</code></pre>\n\n<p>However, when I do so it fails to install certain packages:</p>\n\n<pre><code>...\n[ 7 of 44] Compiling HsColour         ( src/HsColour.hs, dist/build/HsColour.o )\n\nsrc/HsColour.hs:25:16:\n    Couldn't match type `Int' with `[Char]'\n    Expected type: String -&gt; String\n      Actual type: Int -&gt; String -&gt; String\n    In the return type of a call of `CSS.hscolour'\n    Probable cause: `CSS.hscolour' is applied to too few arguments\n    In the expression: CSS.hscolour False\n    In an equation for `hsColourHTML':\n        hsColourHTML = CSS.hscolour False\nFailed to install hlint-1.9.10\ncabal: Error: some packages failed to install:\nhlint-1.9.10 failed during the building phase. The exception was:\nExitFailure 1\nihaskell-0.5.0.0 depends on hlint-1.9.10 which failed to install.\n</code></pre>\n\n<p>Suggesting something about <a href=\"https://hackage.haskell.org/package/hlint\" rel=\"nofollow\"><code>hlint-1.9.10</code></a>.  However, <code>hlint-1.9.17</code> is in fact present.</p>\n\n<pre><code>ubuntu:~$ hlint -V\nHLint v1.9.17, (C) Neil Mitchell 2006-2015\n</code></pre>\n"}, {"tags": ["debugging", "haskell", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 4738, "user_id": 917635, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2365756407af40c28c05d4d30182dbac?s=128&d=identicon&r=PG", "display_name": "artella", "link": "https://stackoverflow.com/users/917635/artella"}, "edited": false, "score": 0, "creation_date": 1426331542, "post_id": 29048086, "comment_id": 46334797, "body": "Thanks! Do you know why I have to do this when <code>getLength</code> is in a separate file and don&#39;t have to do this when <code>getLength</code> is in the same file (i.e. in <code>Main.hs</code>)?"}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "reply_to_user": {"reputation": 4738, "user_id": 917635, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2365756407af40c28c05d4d30182dbac?s=128&d=identicon&r=PG", "display_name": "artella", "link": "https://stackoverflow.com/users/917635/artella"}, "edited": false, "score": 0, "creation_date": 1426335188, "post_id": 29048086, "comment_id": 46335725, "body": "artella: Not really. I&#39;m guessing when it&#39;s all compiled in a single module, the compiler does some optimizations that the debugger can detect?"}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": true, "score": 1, "last_activity_date": 1426330452, "creation_date": 1426330452, "answer_id": 29048086, "question_id": 29047261, "link": "https://stackoverflow.com/questions/29047261/viewing-data-contents-of-generic-container-in-cabal-repl-ghci/29048086#29048086", "title": "Viewing data contents of generic container in cabal repl/ghci", "body": "<p>You can use <code>toList</code> to get to the underlying data:</p>\n\n<pre><code>\u03bb :print vec\nvec = (_t1::Vector a)\n\u03bb :force vec\nvec = Data.Vector.Vector 0 2 _\n\u03bb :print vec\nvec = Data.Vector.Vector 0 2 (_t2::GHC.Prim.Array# a)\n\u03bb let as = toList vec\n\u03bb :print as\nas = (_t6::[a])\n\u03bb :force as\nas = [1,2]\n\u03bb :print vec\nvec = Data.Vector.Vector 0 2 (_t7::GHC.Prim.Array# Int)\n\u03bb :force vec\nvec = Data.Vector.Vector 0 2 _\n\u03bb print vec\nfromList [1,2]\n</code></pre>\n"}], "owner": {"reputation": 4738, "user_id": 917635, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2365756407af40c28c05d4d30182dbac?s=128&d=identicon&r=PG", "display_name": "artella", "link": "https://stackoverflow.com/users/917635/artella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 29048086, "answer_count": 1, "score": 3, "last_activity_date": 1426330452, "creation_date": 1426324210, "question_id": 29047261, "link": "https://stackoverflow.com/questions/29047261/viewing-data-contents-of-generic-container-in-cabal-repl-ghci", "title": "Viewing data contents of generic container in cabal repl/ghci", "body": "<p>Suppose that I have the following : </p>\n\n<pre><code>--Main.hs\nmodule Main where\nimport Data.Vector as V\nimport Test\n\nmain = do\n  let v = V.fromList ([1,2]::[Int])\n  print (getLength v)\n</code></pre>\n\n<p>and : </p>\n\n<pre><code>--Test.hs\nmodule Test where\nimport Data.Vector as V\n\ngetLength :: (Show a) =&gt; V.Vector a -&gt; Int\ngetLength vec = let l = V.length vec in -- line 6\n  l\n</code></pre>\n\n<p>I encounter the following problem when trying to print out <code>vec</code> from within <code>getLength</code> : </p>\n\n<pre><code>&gt; cabal repl\n&gt; :break Test 6\n&gt; main\nStopped at Test.hs:6:25-36\n_result :: Int = _\nvec :: Vector a = _\n&gt; vec\n&lt;interactive&gt;:4:1:\n    No instance for (Show a) arising from a use of \u2018print\u2019\n    Cannot resolve unknown runtime type \u2018a\u2019\n    Use :print or :force to determine these types\n    Relevant bindings include\n      it :: Vector a (bound at &lt;interactive&gt;:4:1)\n    Note: there are several potential instances:\n      instance Show Double -- Defined in \u2018GHC.Float\u2019\n      instance Show Float -- Defined in \u2018GHC.Float\u2019\n      instance (Integral a, Show a) =&gt; Show (GHC.Real.Ratio a)\n        -- Defined in \u2018GHC.Real\u2019\n      ...plus 45 others\n    In a stmt of an interactive GHCi command: print it\n</code></pre>\n\n<p>I have tried to use <code>:force</code> and <code>:print</code> but neither help. Strangely when <code>getLength</code> is placed in <code>Main.hs</code>, then I have no problem printing out <code>vec</code> from within <code>getLength</code>.</p>\n"}, {"tags": ["haskell", "ghc", "cabal"], "comments": [{"owner": {"reputation": 9139, "user_id": 773228, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/baaecdda322cf4462a0dd018d7959b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Wood", "link": "https://stackoverflow.com/users/773228/justin-wood"}, "edited": false, "score": 1, "creation_date": 1426345025, "post_id": 29046620, "comment_id": 46338633, "body": "It looks like it is trying to start <code>cabal repl</code>, not <code>ghci</code>. Can you run <code>cabal repl</code> at the command line?"}, {"owner": {"reputation": 216, "user_id": 2461210, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/26d2a8e1d82de52abdd3e93ac60d87c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias", "link": "https://stackoverflow.com/users/2461210/tobias"}, "reply_to_user": {"reputation": 9139, "user_id": 773228, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/baaecdda322cf4462a0dd018d7959b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Wood", "link": "https://stackoverflow.com/users/773228/justin-wood"}, "edited": false, "score": 0, "creation_date": 1426351237, "post_id": 29046620, "comment_id": 46340638, "body": "No, i just get &quot;Preprocessing library haskellsicp-0.1.0.0...&quot; then back to cmd."}], "owner": {"reputation": 216, "user_id": 2461210, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/26d2a8e1d82de52abdd3e93ac60d87c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias", "link": "https://stackoverflow.com/users/2461210/tobias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 262, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1426318649, "creation_date": 1426318649, "question_id": 29046620, "link": "https://stackoverflow.com/questions/29046620/cant-start-ghci-using-emacs", "title": "Can&#39;t start ghci using emacs", "body": "<p>when I type the command \"C-c C-l\" I get this error and i can't figure out what is wrong please help I want to load my file into an interactive session but it just terminates. I do get a few questions about cabal directories but i just press enter on them.</p>\n\n<pre><code>(\"Starting inferior `cabal repl' process using cabal ...\" \"haskellsicp\" nil \"cabal\" \"repl\" \"--ghc-option=-ferror-spans\")\n-&gt; :set prompt \"\\4\"\n-&gt; Prelude.putStrLn \"\"\n-&gt; :set -v1\n&lt;- Preprocessing library haskellsicp-0.1.0.0...\n\nEvent: \"finished\n\"\n\nProcess reset.\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 2, "creation_date": 1426319929, "post_id": 29046401, "comment_id": 46332182, "body": "This can be written more succinctly as <code>let isUNode UNode = True; isUNode _ = False in filter isUNode</code>. There&#39;s no need to use a <code>case</code> expression."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1426353861, "post_id": 29046401, "comment_id": 46341574, "body": "@AaditMShah: In cases where <code>isUNode</code> is a longer name, this is shorter, and I don\u2019t like repeating it. That\u2019s all."}], "tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": true, "score": 5, "last_activity_date": 1426316675, "creation_date": 1426316675, "answer_id": 29046401, "question_id": 29046369, "link": "https://stackoverflow.com/questions/29046369/how-to-filter-list-by-type-in-haskell/29046401#29046401", "title": "how to filter list by type in haskell", "body": "<p>Unfortunately, the simplest way is also the only way, as far as I\u2019m aware: match.</p>\n\n<pre><code>let isUNode node =\n    case node of\n        UNode _ -&gt; True\n        _ -&gt; False\nin filter isUNode\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 12, "last_activity_date": 1426328524, "creation_date": 1426328524, "answer_id": 29047811, "question_id": 29046369, "link": "https://stackoverflow.com/questions/29046369/how-to-filter-list-by-type-in-haskell/29047811#29047811", "title": "how to filter list by type in haskell", "body": "<p>List comprehensions seem useful here:</p>\n\n<pre><code>[ x | x@(Unode _) &lt;- list ]\n</code></pre>\n"}], "owner": {"reputation": 2550, "user_id": 1366643, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/QFRXO.jpg?s=128&g=1", "display_name": "Herokiller", "link": "https://stackoverflow.com/users/1366643/herokiller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 908, "favorite_count": 2, "accepted_answer_id": 29046401, "answer_count": 2, "score": 4, "last_activity_date": 1426328524, "creation_date": 1426316454, "question_id": 29046369, "link": "https://stackoverflow.com/questions/29046369/how-to-filter-list-by-type-in-haskell", "title": "how to filter list by type in haskell", "body": "<p>I have a list, with elements of some Node type, which may be either UNode or LNode or RNode</p>\n\n<pre><code>[\n    UNode(\"a\"), LNode(\"b\"), RNode(\"c\")\n]\n</code></pre>\n\n<p>How can I filter it by the type ( UNode for example)</p>\n"}, {"tags": ["postgresql", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "is_accepted": true, "score": 6, "last_activity_date": 1426287152, "creation_date": 1426287152, "answer_id": 29043267, "question_id": 29043099, "link": "https://stackoverflow.com/questions/29043099/execute-dynamic-query-with-postgresql-simple/29043267#29043267", "title": "Execute dynamic query with postgresql-simple", "body": "<p>The <code>Query</code> is an instance of <code>IsString</code>, so you can use <code>Data.String.fromString</code> to convert arbitrary string to <code>Query</code>.</p>\n"}], "owner": {"reputation": 1075, "user_id": 1299428, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/330bcefb9bb0b6a8e071e5c8b2ff9d6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sophie", "link": "https://stackoverflow.com/users/1299428/sophie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 1, "accepted_answer_id": 29043267, "answer_count": 1, "score": 4, "last_activity_date": 1426287152, "creation_date": 1426286165, "question_id": 29043099, "link": "https://stackoverflow.com/questions/29043099/execute-dynamic-query-with-postgresql-simple", "title": "Execute dynamic query with postgresql-simple", "body": "<p>I need to execute arbitrary SQL commands composed as string via Haskell or even loaded from files.</p>\n\n<p>The postgresql-simple library provides <code>execute_</code> and <code>exec</code> for executing SQL commands. The problem with <code>execute_</code> is that it needs a <code>Query</code> as parameter. I do understand the intention behind that but I need to execute arbitrary queries. The <code>exec</code> function can be called without a <code>Query</code> but is undocumented and fails silently without exception on error.</p>\n\n<p>How can I convert a <code>String</code> to a <code>Query</code>?</p>\n"}, {"tags": ["string", "haskell", "reverse"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 6, "creation_date": 1426286054, "post_id": 29043046, "comment_id": 46326073, "body": "Why don&#39;t you put it up in <code>ghci</code> and see for yourself if it works or not ?"}, {"owner": {"reputation": 1, "user_id": 4669167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee1f85b89aae3d546f20534781ba25c9?s=128&d=identicon&r=PG&f=1", "display_name": "moobean222", "link": "https://stackoverflow.com/users/4669167/moobean222"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1426286499, "post_id": 29043046, "comment_id": 46326227, "body": "I don&#39;t have it on this system, I will have to do it tomorrow but since I asked a question I thought I might be able to get some clarification"}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1426330792, "post_id": 29043046, "comment_id": 46334601, "body": "moobean222: so <a href=\"https://tryhaskell.org/\" rel=\"nofollow noreferrer\">try it in your browser</a> with <code>let peopletext = &quot;everybody is happy&quot; in reverse peopletext</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "is_accepted": false, "score": 1, "last_activity_date": 1426289574, "creation_date": 1426289574, "answer_id": 29043614, "question_id": 29043046, "link": "https://stackoverflow.com/questions/29043046/haskell-reversing-string-and-taking-words-out/29043614#29043614", "title": "Haskell reversing string and taking words out", "body": "<p>The correct function to get what you want is :</p>\n\n<pre><code>Prelude&gt; filter (\\x -&gt; length x &gt; 3) (words peopletext)\n[\"everybody\",\"happy\"]\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4669167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee1f85b89aae3d546f20534781ba25c9?s=128&d=identicon&r=PG&f=1", "display_name": "moobean222", "link": "https://stackoverflow.com/users/4669167/moobean222"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1426289574, "creation_date": 1426285927, "last_edit_date": 1426287123, "question_id": 29043046, "link": "https://stackoverflow.com/questions/29043046/haskell-reversing-string-and-taking-words-out", "title": "Haskell reversing string and taking words out", "body": "<p>Two questions.</p>\n\n<p>With this definition:</p>\n\n<pre><code>peopletext = \"everybody is happy\"\n</code></pre>\n\n<p>would this code litterally reverse that string, so it outputs \"yppab si ydobyreve\":</p>\n\n<pre><code>reverse peopletext\n</code></pre>\n\n<p>Also, if it's not too much, I want to capture words that are over 3 charater longs and put them in a list. So, only \"happy\" &amp; \"everybody\" would be outputted. Here is what I have been able to come up with so far, but I'm stuck now and real tired :(</p>\n\n<pre><code>length $ filter (elem 3)(words peopletext)\n</code></pre>\n"}, {"tags": ["haskell", "input"], "answers": [{"comments": [{"owner": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "edited": false, "score": 0, "creation_date": 1426280694, "post_id": 29041818, "comment_id": 46324044, "body": "aaa... I see, I forgot that return wraps things in IO stuff lol! And I have spent so much time trying to figure this out."}, {"owner": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "edited": false, "score": 0, "creation_date": 1426280734, "post_id": 29041818, "comment_id": 46324065, "body": "A bit off topic... is this a good way to store data into array or is there a more clever way?"}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "reply_to_user": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "edited": false, "score": 0, "creation_date": 1426280991, "post_id": 29041818, "comment_id": 46324191, "body": "@Reygoch - See update. If you want arrays in particular then Haskell has them in <a href=\"https://hackage.haskell.org/package/array-0.5.0.0/docs/Data-Array.html\" rel=\"nofollow noreferrer\"><code>Data.Array</code></a>"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1426296769, "post_id": 29041818, "comment_id": 46328636, "body": "Also, <code>fmap read getLine</code> is otherwise known as <code>readLn</code>, except that the latter will give any parse errors immediately rather than when the value is used later."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1426303480, "post_id": 29041818, "comment_id": 46329596, "body": "@&#216;rjanJohansen, <code>readLn</code> is okay, but you need to catch an exception to deal with parse errors. The (non-standard) <code>readMaybe</code> and <code>readEither</code> seem a bit more Haskell-flavored."}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 7, "last_activity_date": 1426280811, "last_edit_date": 1426280811, "creation_date": 1426280323, "answer_id": 29041818, "question_id": 29041759, "link": "https://stackoverflow.com/questions/29041759/haskell-store-user-input-in-array/29041818#29041818", "title": "Haskell store user input in array", "body": "<p>You need an <code>IO [Int]</code> in your base case:</p>\n\n<pre><code>intArray 0 = return []\n</code></pre>\n\n<p>and you need to change the <code>return</code> in your recursive case to use the correct precedence:</p>\n\n<pre><code>return (int:nextInt)\n</code></pre>\n\n<p>As an aside, <code>[Int]</code> is a singly-linked list of ints, not an array. You could also simplify your function using <code>replicateM</code> from Control.Monad:</p>\n\n<pre><code>import Control.Monad\nintArray i = replicateM i (fmap read getLine)\n</code></pre>\n"}], "owner": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2141, "favorite_count": 0, "accepted_answer_id": 29041818, "answer_count": 1, "score": 4, "last_activity_date": 1563081268, "creation_date": 1426280079, "last_edit_date": 1563081268, "question_id": 29041759, "link": "https://stackoverflow.com/questions/29041759/haskell-store-user-input-in-array", "title": "Haskell store user input in array", "body": "<p>I'm learning Haskell and I would like to have user input x numbers into the console and store those numbers in array which can be passed on to my functions.</p>\n\n<p>Unfortunately no matter what I try it doesn't work, here is my code:</p>\n\n<pre><code>-- Int Array\nintArray :: Int -&gt; IO [Int]\nintArray 0 = []\nintArray x = do\n    str &lt;- getLine\n    nextInt &lt;- intArray (x - 1)\n    let int = read str :: Int\n    return int:nextInt\n\n-- Main Function\nmain = do\n    array &lt;- intArray 5\n    putStrLn (show array)\n</code></pre>\n"}, {"tags": ["haskell", "compiler-errors"], "answers": [{"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 1, "last_activity_date": 1426275346, "creation_date": 1426275346, "answer_id": 29040577, "question_id": 29040400, "link": "https://stackoverflow.com/questions/29040400/haskell-compile-error/29040577#29040577", "title": "Haskell - Compile Error", "body": "<p><code>Comparable</code> is a subclass of <code>Ord</code> so you need to add an instance for <code>Ord (Set a)</code> e.g.:</p>\n\n<pre><code>instance Ord a =&gt; Ord (Set a) where\n  compare (Set s1) (Set s2) =\n    compare (sort s1) (sort s2)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 10655, "user_id": 4529124, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/4P3eZ.png?s=128&g=1", "display_name": "Chris Emerson", "link": "https://stackoverflow.com/users/4529124/chris-emerson"}, "edited": false, "score": 0, "creation_date": 1426525142, "post_id": 29040580, "comment_id": 46398237, "body": "In this case, you might also simply drop the <code>Ord</code> constraint on your <code>Comparable</code> class."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 10655, "user_id": 4529124, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/4P3eZ.png?s=128&g=1", "display_name": "Chris Emerson", "link": "https://stackoverflow.com/users/4529124/chris-emerson"}, "edited": false, "score": 0, "creation_date": 1426540122, "post_id": 29040580, "comment_id": 46406802, "body": "@ChrisEmerson True, but I wasn&#39;t sure about what the OP needed, so I left the class as it was posted."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1426275359, "creation_date": 1426275359, "answer_id": 29040580, "question_id": 29040400, "link": "https://stackoverflow.com/questions/29040400/haskell-compile-error/29040580#29040580", "title": "Haskell - Compile Error", "body": "<p>This declaration</p>\n\n<pre><code>class Ord a =&gt; Comparable a where\n</code></pre>\n\n<p>states that every member of the class <code>Comparable</code> must be a member of class <code>Ord</code>. If I were to attempt doing</p>\n\n<pre><code>data MyType = ...\ninstance Comparable MyType where\n  cmp x y = \"hello\"\n</code></pre>\n\n<p>the compiler would complain that an instance <code>Ord MyType</code> is missing. IT does not matter that I am not using anything from that <code>Ord</code> instance: it is required by the definition of <code>Comparable</code>.</p>\n\n<p>To fix that, add an instance</p>\n\n<pre><code>instance Ord a =&gt; Ord (Set a) where\n   compare setA setB = ....\n</code></pre>\n\n<p>After that, you can use your <code>Comparable</code> instance, provided you add <code>Ord a</code> to the constraints.</p>\n\n<pre><code>instance (Ord a , Comparable a) =&gt; Comparable (Set a) where\n  cmp (Set xs) (Set ys)\n    | (Set xs) == (Set ys) = \"same\"\n    | otherwise            = \"different\"  \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "is_accepted": false, "score": 0, "last_activity_date": 1426275518, "creation_date": 1426275518, "answer_id": 29040627, "question_id": 29040400, "link": "https://stackoverflow.com/questions/29040400/haskell-compile-error/29040627#29040627", "title": "Haskell - Compile Error", "body": "<p>You gave a instance of Equality to your set data type but it doesn't have an Ord instance. When you try to  make Set and instance of the Comparable class it requires that Set must be an instance of Ord.</p>\n"}], "owner": {"reputation": 203, "user_id": 3657132, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/445d86c044c5251d316141ed21183f6e?s=128&d=identicon&r=PG&f=1", "display_name": "User137481", "link": "https://stackoverflow.com/users/3657132/user137481"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 29040580, "answer_count": 3, "score": 1, "last_activity_date": 1426275518, "creation_date": 1426274704, "question_id": 29040400, "link": "https://stackoverflow.com/questions/29040400/haskell-compile-error", "title": "Haskell - Compile Error", "body": "<pre><code>data Set a = Set [a]\nmember xs x = elem x xs\nsubset xs ys = and (map (member ys) xs)\n\ninstance (Eq a) =&gt; Eq (Set a) where  \n  (Set xs) == (Set ys) = (subset xs ys) &amp;&amp; (subset ys xs)\n\nclass Ord a =&gt; Comparable a where\n  cmp :: a -&gt; a -&gt; String\n  cmp x y\n    | x == y    = \"eq\"\n    | otherwise = \"neq\"\n\ninstance Comparable a =&gt; Comparable (Set a) where\n  cmp (Set xs) (Set ys)\n    | (Set xs) == (Set ys) = \"same\"\n    | otherwise            = \"different\"  \n</code></pre>\n\n<p>I'm getting the following error:</p>\n\n<p>Could not deduce (Ord (Set a))\n  arising from the superclasses of an instance declaration\nfrom the context (Comparable a)\n  bound by the instance declaration for \u2018Comparable (Set a)\u2019</p>\n\n<p>I'd like to know what the error is?\nThanks.</p>\n"}, {"tags": ["haskell", "closures", "distributed"], "comments": [{"owner": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "edited": false, "score": 1, "creation_date": 1427815145, "post_id": 29039815, "comment_id": 46925101, "body": "Andrew Cowie and Ozgun Ataman suggested me to compile the program and ship it to the nodes, since the compiled binary is self-contained and easy to rsync. One example of this is hadron[1]-based Hadoop MapReduce programs to cluster nodes at work, developed by Ozgun Ataman.         [1] <a href=\"https://github.com/soostone/hadron\" rel=\"nofollow noreferrer\">github.com/soostone/hadron</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "is_accepted": true, "score": 1, "last_activity_date": 1449016174, "creation_date": 1449016174, "answer_id": 34032851, "question_id": 29039815, "link": "https://stackoverflow.com/questions/29039815/distributing-haskell-on-a-cluster/34032851#34032851", "title": "Distributing Haskell on a cluster", "body": "<p>Yep. There is a magical library called <a href=\"https://github.com/jberthold/packman\" rel=\"nofollow\"><code>packman</code></a>. It allows you to turn any haskell thing into data (as long as it does not have <code>IORef</code>s or related things in them.) Here the things you would need:</p>\n\n<pre><code>trySerialize :: a -&gt; IO (Serialized a)\ndeserialize :: Serialized a -&gt; IO a\ninstance Typeable a =&gt; Binary (Serialized a)\n</code></pre>\n\n<p>Yep, those are the exact types. You can package up your <code>IO</code> actions using <code>trySerialize</code>, use <code>Binary</code> to transfer it to wherever, and then <code>deserialize</code> to get the IO action out, ready for use.</p>\n\n<p>Caveats for <code>packman</code> is that:</p>\n\n<ul>\n<li>It stores things as thunks. This is probably what you want, so that the node can do the evaluating.\n\n<ul>\n<li>That said, if your thunk is huge, the <code>Binary</code> will probably be huge. Evaluating the thunk can fix this.</li>\n<li>Like I said, mutable references are a no-no. One thing to watch out is them being <em>inside thunks</em> without you knowing it.</li>\n</ul></li>\n</ul>\n\n<p>Other than that, this seems like what you want!</p>\n"}], "owner": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 2, "accepted_answer_id": 34032851, "answer_count": 1, "score": 18, "last_activity_date": 1449016174, "creation_date": 1426272636, "last_edit_date": 1426289049, "question_id": 29039815, "link": "https://stackoverflow.com/questions/29039815/distributing-haskell-on-a-cluster", "title": "Distributing Haskell on a cluster", "body": "<p>I have a piece of code that process files,</p>\n\n<pre><code>processFiles ::  [FilePath] -&gt; (FilePath -&gt; IO ()) -&gt; IO ()\n</code></pre>\n\n<p>This function spawns an async process that execute an IO action. This IO action must be submitted to a cluster through a job scheduling system (e.g Slurm). </p>\n\n<p>Because I must use the job scheduling system, it's not possible to use cloudHaskell to distribute the closure. Instead the program writes a new <em>Main.hs</em> containing the desired computations, that is copy to the cluster node together with all the modules that main depends on and then it is executed remotely with \"runhaskell Main.hs [opts]\". Then the async process should ask periodically to the job scheduling system (using <em>threadDelay</em>) if the job is done. </p>\n\n<p>Is there a way to avoid creating a new Main? Can I serialize the IO action and execute it somehow in the node?</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1426272146, "post_id": 29039526, "comment_id": 46319820, "body": "Did you mean <code>(#) :: Interface c i =&gt; c -&gt; (i -&gt; r) -&gt; r</code>?"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1426272221, "post_id": 29039526, "comment_id": 46319854, "body": "@Andr&#225;sKov&#225;cs or <code>class Interface i c where</code> instead, but it amounts to the same problem.  Thanks for pointing it out."}], "answers": [{"comments": [{"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 1, "creation_date": 1426278932, "post_id": 29039865, "comment_id": 46323268, "body": "You could reduce the type synonym issues by using <code>type IDrawable = Interface IDrawable&#39;</code> (i.e., eta-reducing the definition to get rid of <code>c</code>) \u2013 you still couldn&#39;t declare an instance of <code>IDrawable</code>, but you could pass it as a type-level argument, you wouldn&#39;t need spurious instances of some new <code>IDrawable</code> class, etc."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 0, "creation_date": 1426281184, "post_id": 29039865, "comment_id": 46324270, "body": "@AntalS-Z What I was looking for is &quot;you still couldn&#39;t declare an instance of <code>IDrawable</code>&quot;.  I doubt there&#39;s any documentation as to why, but is there a more thorough explanation as to why?"}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1426304187, "post_id": 29039865, "comment_id": 46329709, "body": "@bheklilr: Sorry, I should have been clearer that the comment was addressed at the second half of this answer only.  As for why\u2026 well, because <code>IDrawable</code> isn&#39;t a class, I suppose :-)  There&#39;s not much beyond that, I don&#39;t think.  And I&#39;d imagine things would become weird if you had to expand out type synonyms before deciding if they were valid instance heads.  But then, <code>TypeSynonymInstances</code> allows this for arguments, so maybe it&#39;s just that nobody has done it."}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1426304724, "post_id": 29039865, "comment_id": 46329781, "body": "@bheklilr: Actually, hang on, there&#39;s a weird bug going on here: check out <a href=\"https://gist.github.com/antalsz/c8a2cc435fe92f4eb276\" rel=\"nofollow noreferrer\">this gist</a> of your desired code running in GHCi.  I can&#39;t create the instance if I define the method, but I can if I don&#39;t.  So the check about  <code>IDrawable</code> doesn&#39;t work, but I can&#39;t tell if it ought to be loosened or tightened!"}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1426305726, "post_id": 29039865, "comment_id": 46329919, "body": "@bheklilr: I found the relevant GHC bug: it&#39;s <a href=\"https://ghc.haskell.org/trac/ghc/ticket/7543\" rel=\"nofollow noreferrer\">ticket 7543</a>, with some comments about why this doesn&#39;t work.  It sounds like the issue is that type synonym expansion and type class method name resolution are done by two different parts of the compiler, so they can&#39;t interact properly."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 0, "creation_date": 1426306008, "post_id": 29039865, "comment_id": 46329950, "body": "@AntalS-Z Well that&#39;s interesting.  Maybe I can get the discussion going again on the bug tracker.  That&#39;s a good explanation as to why I can&#39;t do what I want, thanks!"}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 1, "last_activity_date": 1426273572, "last_edit_date": 1426273572, "creation_date": 1426272810, "answer_id": 29039865, "question_id": 29039526, "link": "https://stackoverflow.com/questions/29039526/defining-partially-applied-typeclasses/29039865#29039865", "title": "Defining partially applied typeclasses", "body": "<p>You can declare a \"partial\" class with no instances:</p>\n\n<pre><code>class Interface IDrawable' c =&gt; IDrawable c\n\ninstance Interface IDrawable' Object where i = IDrawable . objectDraw\ninstance Interface IDrawable' Person where i = IDrawable . personDraw\n</code></pre>\n\n<p>Alternatively, constraint synonyms could be used:</p>\n\n<pre><code>type IDrawable c = Interface IDrawable' c\n</code></pre>\n\n<p>The classy solution is probably preferable though, since the <code>IDrawable</code> class has a proper <code>* -&gt; Constraint</code> kind, while the type synonym is unusable unless fully applied. This can be relevant, since data definitions (and type families and pretty much all type-level hackery) can only make use of proper type constructors.  </p>\n"}, {"comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1426307048, "post_id": 29045365, "comment_id": 46330090, "body": "Thanks for the complete answer.  It&#39;s not often I come across a bug in GHC.  I&#39;ve commented on trac to see if maybe we can get it resolved one way or the other.  I can see where if it were implemented just right it could make it easier to work with and compose typeclasses, so I&#39;m interested to see what can be done."}], "tags": [], "owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "is_accepted": true, "score": 1, "last_activity_date": 1426306909, "last_edit_date": 1495542490, "creation_date": 1426306342, "answer_id": 29045365, "question_id": 29039526, "link": "https://stackoverflow.com/questions/29039526/defining-partially-applied-typeclasses/29045365#29045365", "title": "Defining partially applied typeclasses", "body": "<p>No, this isn't possible (as of 7.8.3, and I think also 7.10); it's <a href=\"https://ghc.haskell.org/trac/ghc/ticket/7543\" rel=\"nofollow noreferrer\">GHC bug #7543</a>.  It's not a very trafficked bug; there are clearly at least a few people who'd like to be able to write this sort of thing (<em>e.g.</em>, you, Edward Kmett), but mostly this goes unnoticed.  There's no progress on changing this behavior recorded on the tracker.</p>\n\n<p>As for why you can't, let me paraphrase Simon Peyton-Jones's explanation on the bug tracker.  The problem is that type checking instances has two parts: first, GHC has to look up where the method names (here, <code>i</code>) are from; second, GHC has to expand the type synonyms.  Because these two steps are performed in this issue by two different components of GHC, constraint synonym instances can't be supported; GHC can't tell what class it needs to look in to find <code>i</code>.</p>\n\n<hr>\n\n<p>The other reason this is a bug \u2013 and the reason I found this, as per the comments on <a href=\"https://stackoverflow.com/a/29039865/237428\">Andr\u00e1s Kov\u00e1cs's answer</a> \u2013 is that the current behavior isn't as simple as \"it doesn't work\".  Instead, it <em>tries</em> to work, but you can't declare any methods\u2026 but you <em>can</em> declare a methodless instance!  In GHCi:</p>\n\n<pre><code>GHCi, version 7.8.3: http://www.haskell.org/ghc/  :? for help\n...\nPrelude&gt; :set -XMultiParamTypeClasses -XFlexibleInstances -XConstraintKinds\nPrelude&gt; class Interface i c where i :: c -&gt; i\nPrelude&gt; instance Interface i i where i = id\nPrelude&gt; let (#) :: Interface i c =&gt; c -&gt; (i -&gt; r) -&gt; r ; c # f = f $ i c ; infixl 1 #\nPrelude&gt; data IDrawable' = IDrawable { draw :: IO () }\nPrelude&gt; type IDrawable = Interface IDrawable'\nPrelude&gt; instance IDrawable () where i _ = IDrawable $ return ()\n\n&lt;interactive&gt;:8:29:\n    \u2018i\u2019 is not a (visible) method of class \u2018IDrawable\u2019\nPrelude&gt; ()#draw\n\n&lt;interactive&gt;:9:3:\n    No instance for (Interface IDrawable' ()) arising from a use of \u2018#\u2019\n    In the expression: () # draw\n    In an equation for \u2018it\u2019: it = () # draw\nPrelude&gt; instance IDrawable () where {}\n\n&lt;interactive&gt;:10:10: Warning:\n    No explicit implementation for\n      \u2018i\u2019\n    In the instance declaration for \u2018Interface IDrawable' ()\u2019\nPrelude&gt; ()#draw\n*** Exception: &lt;interactive&gt;:10:10-21: No instance nor default method for class operation Ghci1.i\n</code></pre>\n\n<p>In other words:</p>\n\n<pre><code>instance IDrawable () where i _ = IDrawable $ return ()\n</code></pre>\n\n<p>fails, but </p>\n\n<pre><code>instance IDrawable () where {}\n</code></pre>\n\n<p>succeeds!  So clearly, the check needs to either be loosened or tightened, depending on the desired behavior :-)</p>\n\n<hr>\n\n<p>P.S.: One more thing: You should always eta-reduce type synonyms as much as possible.  This is why I changed <code>IDrawable</code> to</p>\n\n<pre><code>type IDrawable = Interface IDrawable'\n</code></pre>\n\n<p>and dropped the <code>c</code> parameter on both sides in the <code>GHCi</code> code above.  The advantage of this is that since type synonyms can't be partially applied, you can't pass your version of <code>IDrawable</code> as a parameter to anything; however, the fully eta-reduced version can be passed anywhere expecting something of kind <code>* -&gt; Constraint</code>.</p>\n\n<p>(This is touched on in <a href=\"https://stackoverflow.com/a/29039865/237428\">Andr\u00e1s Kov\u00e1cs's answer</a>, and I mentioned this in a comment there; nevertheless, since I ended up writing an answer too, I figured I'd add it here as well.)</p>\n"}], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 2, "accepted_answer_id": 29045365, "answer_count": 2, "score": 8, "last_activity_date": 1426306909, "creation_date": 1426271602, "last_edit_date": 1426272188, "question_id": 29039526, "link": "https://stackoverflow.com/questions/29039526/defining-partially-applied-typeclasses", "title": "Defining partially applied typeclasses", "body": "<p>Exploring the idea that <a href=\"https://wiki.haskell.org/OOP_vs_type_classes#Type_classes_are_like_interfaces.2Fabstract_classes.2C_not_classes_itself\">typeclasses are essentially C++ abstract classes without nested inheritance</a>, I have written the typeclass</p>\n\n<pre><code>class Interface i c where\n    i :: c -&gt; i\n\ninstance Interface i i where i = id\n\ninfixl 1 #\n(#) :: Interface i c =&gt; c -&gt; (i -&gt; r) -&gt; r\nc # f = f $ i c\n</code></pre>\n\n<p>With an interface like</p>\n\n<pre><code>data IDrawable' = IDrawable { draw :: IO () }\n</code></pre>\n\n<p>I'd like to have something like</p>\n\n<pre><code>type IDrawable c = Interface IDrawable' c\n</code></pre>\n\n<p>So that I could do</p>\n\n<pre><code>data Object = Object { objectDraw :: IO () }\ndata Person = Person { personDraw :: IO () }\n\ninstance IDrawable Object where i = IDrawable . objectDraw\ninstance IDrawable Person where i = IDrawable . personDraw\n</code></pre>\n\n<p>While the <code>type IDrawable c</code> compiles with <code>ConstraintKinds</code>, I'm not allowed to do <code>instance IDrawable Object where i = IDrawable . objectDraw</code> with the error</p>\n\n<pre><code>'i' is not a (visible) method of class 'IDrawable`\n</code></pre>\n\n<p>Is there a way to declare <code>IDrawable c = Interface IDrawable' c</code> so that it can be instanced?</p>\n\n<p>This is purely out of academic interest, I'm not recommending anyone use this pattern in a real application, I just want to know if this sort of thing is possible without applying <code>TemplateHaskell</code> or <code>CPP</code>.</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1426271045, "post_id": 29039251, "comment_id": 46319237, "body": "You haven&#39;t written an <code>instance Comparable Integer where ....</code> to say how <code>Integer</code>s are <code>Comparable</code>. Since <code>Comparable</code> provides a default implementation for <code>cmp</code>, if you add the line <code>instance Comparable Integer</code> you will have a <code>Comparable</code> instance for <code>Integer</code>s."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1426271220, "post_id": 29039251, "comment_id": 46319320, "body": "The <code>Comparable</code> instance for a <code>Set a</code> doesn&#39;t need a <code>Comparable</code> instance for <code>a</code>. The definition of <code>cmp</code> for <code>Comparable (Set a)</code> doesn&#39;t use <code>cmp</code> from <code>Comparable a</code>, it only uses <code>==</code> from <code>Eq a</code>. The context for the <code>Comparable (Set a)</code> instance could be changed from <code>Comparable a =&gt;</code> to <code>Eq a =&gt;</code>."}, {"owner": {"reputation": 203, "user_id": 3657132, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/445d86c044c5251d316141ed21183f6e?s=128&d=identicon&r=PG&f=1", "display_name": "User137481", "link": "https://stackoverflow.com/users/3657132/user137481"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1426272146, "post_id": 29039251, "comment_id": 46319821, "body": "@Cirdec I will be adding the other operators like &#39;&lt;&#39;, &#39;&gt;&#39; to Comparable so Comparable (Set a) will eventually use cmp from Comparable a.  In the (Set a), &#39;a&#39; is any type that has an ordering. Does that mean I have to add the lines &quot;instance Comparable a&quot; for each type a?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1426297090, "post_id": 29039251, "comment_id": 46328689, "body": "@User137481 The declaration <code>instance Comparable a =&gt; Comparable (Set a)</code> says that if you want to use the <code>Comparable</code> instance for a set (e.g. by calling <code>cmp</code> on it), you need to have an instance of <code>Comparable</code> for the type contained in the set. So yes."}, {"owner": {"reputation": 203, "user_id": 3657132, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/445d86c044c5251d316141ed21183f6e?s=128&d=identicon&r=PG&f=1", "display_name": "User137481", "link": "https://stackoverflow.com/users/3657132/user137481"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1426298905, "post_id": 29039251, "comment_id": 46328971, "body": "@DanielWagner ok, so the instance declaration isn&#39;t what I want. I only want the set itself to be Comparable. The elements of the set only need to be Eq instances. So, what do I need to do to fix the problem? Thanks."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426303015, "post_id": 29039251, "comment_id": 46329533, "body": "I&#39;m still not seeing why you want <code>Comparable</code> when the Prelude already has <code>Ord</code>, which is good for any totally ordered type."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1426304476, "post_id": 29039251, "comment_id": 46329740, "body": "@User137481 Cirdec already said how to do that..."}, {"owner": {"reputation": 203, "user_id": 3657132, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/445d86c044c5251d316141ed21183f6e?s=128&d=identicon&r=PG&f=1", "display_name": "User137481", "link": "https://stackoverflow.com/users/3657132/user137481"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426355400, "post_id": 29039251, "comment_id": 46342100, "body": "@dfeuer The reason is that sets are only partially ordered. For example {1, 2, 3} and {1, 5} cannot really be compared using &lt; or &gt;."}], "answers": [{"comments": [{"owner": {"reputation": 203, "user_id": 3657132, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/445d86c044c5251d316141ed21183f6e?s=128&d=identicon&r=PG&f=1", "display_name": "User137481", "link": "https://stackoverflow.com/users/3657132/user137481"}, "edited": false, "score": 0, "creation_date": 1426302799, "post_id": 29044840, "comment_id": 46329494, "body": "The elements of Set can be of any type. From your response it would mean I would have to provide an instance of Comparable for every type. I&#39;m not sure how to do this. My intention was to make Set an instance of Comparable. The elements of the Set do not need to be instances of Comparable. Is there a solution for this? Thanks."}, {"owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "reply_to_user": {"reputation": 203, "user_id": 3657132, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/445d86c044c5251d316141ed21183f6e?s=128&d=identicon&r=PG&f=1", "display_name": "User137481", "link": "https://stackoverflow.com/users/3657132/user137481"}, "edited": false, "score": 0, "creation_date": 1426338488, "post_id": 29044840, "comment_id": 46336740, "body": "@User137481 Then you would have to remove <code>Comparable a =&gt;</code> from the <code>Comparable (Set a)</code> instance."}], "tags": [], "owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "is_accepted": true, "score": 0, "last_activity_date": 1426300788, "creation_date": 1426300788, "answer_id": 29044840, "question_id": 29039251, "link": "https://stackoverflow.com/questions/29039251/what-does-no-instance-for-comparable-integer-mean/29044840#29044840", "title": "What does &quot;No instance for (Comparable Integer)&quot; mean?", "body": "<p>When you are executing:</p>\n\n<pre><code>cmp i1 i2  \n</code></pre>\n\n<p>Haskell infers the type of <code>i1</code> and <code>i2</code> to be <code>Set [Integer]</code>. And since <code>cmp</code> has type:</p>\n\n<pre><code>cmp :: (Comparable a) =&gt; a -&gt; a -&gt; String\n</code></pre>\n\n<p><code>Integer</code>\u00a0has to have an instance of the <code>Comparable</code> type class; which it doesn't. So to solve this issue you should provide an instance of <code>Comparable</code> for <code>Integer</code>.</p>\n\n<p>Also notice that you probably meant to use <code>Ord</code> which defines comparison between values of different types.</p>\n"}], "owner": {"reputation": 203, "user_id": 3657132, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/445d86c044c5251d316141ed21183f6e?s=128&d=identicon&r=PG&f=1", "display_name": "User137481", "link": "https://stackoverflow.com/users/3657132/user137481"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 29044840, "answer_count": 1, "score": 2, "last_activity_date": 1426300788, "creation_date": 1426270606, "last_edit_date": 1426296993, "question_id": 29039251, "link": "https://stackoverflow.com/questions/29039251/what-does-no-instance-for-comparable-integer-mean", "title": "What does &quot;No instance for (Comparable Integer)&quot; mean?", "body": "<pre><code>data Set a = Set [a]\ni1 = Set [1, 2, 3]\ni2 = Set [3, 2, 1]\n\nmember xs x  = elem x xs\nsubset xs ys = and (map (member ys) xs)\n\ninstance (Eq a) =&gt; Eq (Set a) where\n  (Set xs) == (Set ys) = (subset xs ys) &amp;&amp; (subset ys xs)\n\nclass Eq a =&gt; Comparable a where\n  cmp :: a -&gt; a -&gt; String\n  cmp x y\n    | x == y    = \"eq\"\n    | otherwise = \"neq\"\n\ninstance Comparable a =&gt; Comparable (Set a) where\n  cmp (Set xs) (Set ys)\n    | (Set xs) == (Set ys) = \"same\"\n    | otherwise            = \"different\" \n</code></pre>\n\n<p>When executing:  <code>cmp i1 i2</code> I get the following error:</p>\n\n<pre><code>No instance for (Comparable Integer) arising from a use of \u2018cmp\u2019  \n In the expression: cmp i1 i2  \n In an equation for \u2018it\u2019: it = cmp i1 i2\n</code></pre>\n\n<p>I'd like to know what it means?\nThanks.</p>\n"}, {"tags": ["string", "haskell", "count", "words"], "comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1426265065, "post_id": 29037600, "comment_id": 46315836, "body": "Check the function <code>elem :: Eq a =&gt; a -&gt; [a] -&gt; Bool</code>. Then you can filter and check the length."}, {"owner": {"reputation": 11, "user_id": 4667875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdb4e47fc38719918d40a26ae08bf566?s=128&d=identicon&r=PG&f=1", "display_name": "j0rd4nn2", "link": "https://stackoverflow.com/users/4667875/j0rd4nn2"}, "reply_to_user": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1426265122, "post_id": 29037600, "comment_id": 46315869, "body": "are you able to show me a working example from the example I gave? i just cant do it :( my head is mess"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 5, "creation_date": 1426265197, "post_id": 29037600, "comment_id": 46315921, "body": "@j0rd4nn2 You have to demonstrate that you made some effort towards finding a solution; Stack Overflow isn&#39;t a place where you can just ask people to do your homework for you."}], "answers": [{"tags": [], "owner": {"reputation": 40039, "user_id": 699224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4feb08afcd7c57acb72bd49fc2bf834d?s=128&d=identicon&r=PG", "display_name": "DNA", "link": "https://stackoverflow.com/users/699224/dna"}, "is_accepted": false, "score": 1, "last_activity_date": 1426268408, "last_edit_date": 1426268408, "creation_date": 1426265207, "answer_id": 29037691, "question_id": 29037600, "link": "https://stackoverflow.com/questions/29037600/haskell-counting-words-containing-specific-characters-in-strings/29037691#29037691", "title": "Haskell counting words containing specific characters in strings", "body": "<p>One way of doing this (shown as a GHCi session) is:</p>\n\n<pre><code>\u03bb&gt; let w = \"yes no maybe\"\n\u03bb&gt; length $ filter (elem 'e') (words w)\n2\n</code></pre>\n\n<p>We split the string into words using the <code>words</code> function.\nThen filter the list of words using <code>elem</code> and our chosen character.\nThen finally count the number of words that contained the character, using <code>length</code>.</p>\n\n<p>Can also be written as:</p>\n\n<pre><code>length . filter (elem 'e') $ words w\n</code></pre>\n\n<p>composing the <code>length</code> and <code>filter</code> functions, then applying the combined function to the list of words.</p>\n"}], "owner": {"reputation": 11, "user_id": 4667875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdb4e47fc38719918d40a26ae08bf566?s=128&d=identicon&r=PG&f=1", "display_name": "j0rd4nn2", "link": "https://stackoverflow.com/users/4667875/j0rd4nn2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 705, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1426268408, "creation_date": 1426264948, "question_id": 29037600, "link": "https://stackoverflow.com/questions/29037600/haskell-counting-words-containing-specific-characters-in-strings", "title": "Haskell counting words containing specific characters in strings", "body": "<p>is it possible to get the number of words which contain a specific character from a string ? </p>\n\n<p>for example: string = \"yes no maybe\"</p>\n\n<p>it would return 2 if the specific character was 'e'.</p>\n\n<p>I have been trying for hours :(</p>\n\n<p>thanks</p>\n"}, {"tags": ["haskell", "compiler-errors"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1426260399, "post_id": 29036066, "comment_id": 46312877, "body": "<code>World</code> isn&#39;t a class.  Did you instead mean <code>instance Hello a =&gt; Hello (World a) where ...</code>?"}, {"owner": {"reputation": 203, "user_id": 3657132, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/445d86c044c5251d316141ed21183f6e?s=128&d=identicon&r=PG&f=1", "display_name": "User137481", "link": "https://stackoverflow.com/users/3657132/user137481"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1426260890, "post_id": 29036066, "comment_id": 46313190, "body": "@bheklilr Yes, I did. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 1, "last_activity_date": 1426260872, "last_edit_date": 1426260872, "creation_date": 1426260566, "answer_id": 29036171, "question_id": 29036066, "link": "https://stackoverflow.com/questions/29036066/compile-error-when-instantiating-classes/29036171#29036171", "title": "Compile Error when instantiating classes", "body": "<p>The <code>instance</code> doesn't make much sense. An instance is defined on a type. A possible fix is:</p>\n\n<pre><code>instance Hello (World a) where\n    method1 _ = \"Hello World\"\n</code></pre>\n\n<p>An <code>instance</code> deals with specifying how a type (or a list of types) maps on a class, so if you have a class <code>C</code> with parameters <code>a</code>, you can specify:</p>\n\n<pre><code>class C a where\n    foo :: a -&gt; a\n</code></pre>\n\n<p>Now you don't buy much with this, because you have never said which <code>a</code>'s are actually applicable for <code>C</code>. With <code>instance</code> you specify that a given type (these types can be \"generic\") are applicable to <code>C</code>, so next you can say:</p>\n\n<pre><code>instance C a where\n    foo = id\n</code></pre>\n\n<p>Here you basically say every type <code>a</code> (thus all types) are instances of <code>C</code>. And that <code>foo</code> should be seen as the <code>id</code> function.</p>\n\n<p>Sometimes you want to put additional constraints on <code>a</code>, <code>a</code> should for instance instantiate an other class. For instance with</p>\n\n<pre><code>instance (Integral i) =&gt; C i where\n    foo = (+) 1\n</code></pre>\n\n<p>Here you say that all integral types <code>i</code> are instances of <code>C</code> with <code>foo</code> being defined as the increment function. <strong>Note that you can't simply combine this and the previous instance, because Haskell doesn't know which to pick in that case.</strong></p>\n\n<p>Or perhaps you meant to define the instance as @bheklilr suggests:</p>\n\n<pre><code>instance (Hello a) =&gt; Hello (World a) where\n    method1 _ = \"Hello World\"\n</code></pre>\n"}], "owner": {"reputation": 203, "user_id": 3657132, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/445d86c044c5251d316141ed21183f6e?s=128&d=identicon&r=PG&f=1", "display_name": "User137481", "link": "https://stackoverflow.com/users/3657132/user137481"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426261112, "creation_date": 1426260274, "last_edit_date": 1426261112, "question_id": 29036066, "link": "https://stackoverflow.com/questions/29036066/compile-error-when-instantiating-classes", "title": "Compile Error when instantiating classes", "body": "<pre><code>class Hello a where\n  method1 :: a -&gt; String\n  method1 a = \"Hello\"  \n\ndata World s = World [s]   \n\ninstance Hello a =&gt; World a where  \n  method1 a = \"Hello World\"\n</code></pre>\n\n<p>I'm getting the following error when I load the code into Haskell:</p>\n\n<p>\u2018method1\u2019 is not a (visible) method of class \u2018World\u2019</p>\n\n<p>Could someone tell me where the error is?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["string", "haskell", "count", "character"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1426259712, "post_id": 29035809, "comment_id": 46312341, "body": "What are your thoughts or attempts on how to do this?"}, {"owner": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "edited": false, "score": 2, "creation_date": 1426259817, "post_id": 29035809, "comment_id": 46312427, "body": "Did you try out what was suggested in the <a href=\"http://stackoverflow.com/questions/29035559/haskell-count-words-and-chars-within-a-string#comment46311923_29035559\">helpful comment straight under your previous, strongly related question</a> yet? If not, go do that first before asking another question."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1426263978, "post_id": 29035809, "comment_id": 46315190, "body": "I&#39;m voting to close this question as off-topic because it shows no independent effort."}], "answers": [{"comments": [{"owner": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "edited": false, "score": 1, "creation_date": 1426261701, "post_id": 29036373, "comment_id": 46313730, "body": "<code>(\\x -&gt; x==&#39;a&#39;)</code> can be written <code>(==&#39;a&#39;)</code>."}, {"owner": {"reputation": 777, "user_id": 3900056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45ff0756018a3a41955b5d29e3ab63fb?s=128&d=identicon&r=PG&f=1", "display_name": "zcleghern", "link": "https://stackoverflow.com/users/3900056/zcleghern"}, "reply_to_user": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "edited": false, "score": 0, "creation_date": 1426262099, "post_id": 29036373, "comment_id": 46314007, "body": "Thanks, I always miss that."}], "tags": [], "owner": {"reputation": 777, "user_id": 3900056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45ff0756018a3a41955b5d29e3ab63fb?s=128&d=identicon&r=PG&f=1", "display_name": "zcleghern", "link": "https://stackoverflow.com/users/3900056/zcleghern"}, "is_accepted": false, "score": 1, "last_activity_date": 1426262197, "last_edit_date": 1495542136, "creation_date": 1426261133, "answer_id": 29036373, "question_id": 29035809, "link": "https://stackoverflow.com/questions/29035809/counting-character-in-string-in-haskell/29036373#29036373", "title": "Counting character in string in Haskell", "body": "<p>Think about it this way: you want to know the size of the list in which all letters that are not 'a' have been removed. To remove these, we can use <code>filter</code>.  This function filters out any items in a list that do not satisfy a given predicate.  Then getting the size of this list is trivial with <code>length</code>.</p>\n\n<pre><code>length $ filter (\\x -&gt; x=='a') \"this is an example string\"\n</code></pre>\n\n<p>Edit:\nAs per <a href=\"https://stackoverflow.com/users/1598537/andrewc\">AndrewC</a>'s suggestion, you can also write this as:</p>\n\n<pre><code>length $ filter (=='a') \"this is an example string\"\n</code></pre>\n\n<p>This way is more readable and clearer.</p>\n"}], "owner": {"reputation": 11, "user_id": 4667875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdb4e47fc38719918d40a26ae08bf566?s=128&d=identicon&r=PG&f=1", "display_name": "j0rd4nn2", "link": "https://stackoverflow.com/users/4667875/j0rd4nn2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1659, "favorite_count": 0, "closed_date": 1426274687, "answer_count": 1, "score": -5, "last_activity_date": 1426262197, "creation_date": 1426259625, "question_id": 29035809, "link": "https://stackoverflow.com/questions/29035809/counting-character-in-string-in-haskell", "closed_reason": "Not suitable for this site", "title": "Counting character in string in Haskell", "body": "<pre><code>string = \"this is an example string\"\n</code></pre>\n\n<p>in haskell, how can i count how many times the character 'a' appears in the string above? Preferably in one line.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "is_accepted": false, "score": 6, "last_activity_date": 1426259719, "creation_date": 1426259719, "answer_id": 29035845, "question_id": 29035725, "link": "https://stackoverflow.com/questions/29035725/operator-in-haskell-gives-data-constructor-error/29035845#29035845", "title": "$ operator in Haskell gives data constructor error", "body": "<p><code>$</code> doesn't literally place parentheses around arbitrary code, but changes the order in which functions are evaluated (like parentheses do, too).</p>\n"}, {"comments": [{"owner": {"reputation": 175, "user_id": 2901259, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5eec020647b0d7ff639b31db7aed9cca?s=128&d=identicon&r=PG&f=1", "display_name": "ssh", "link": "https://stackoverflow.com/users/2901259/ssh"}, "edited": false, "score": 0, "creation_date": 1426269895, "post_id": 29036028, "comment_id": 46318636, "body": "Thank you for your answer, and explanation of the error message. Can you explain why <code>:1</code> is not a function? If <code>1:[2]</code> gives <code>[1,2]</code>, that means <code>:</code> is <code>: :: a -&gt; [a] -&gt; [a]</code>. Through currying <code>1:</code> would give <code>[a] -&gt; [a]</code> which is a function. Even if this is incorrect, how did <code>()</code> turn it into a function?"}, {"owner": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "reply_to_user": {"reputation": 175, "user_id": 2901259, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5eec020647b0d7ff639b31db7aed9cca?s=128&d=identicon&r=PG&f=1", "display_name": "ssh", "link": "https://stackoverflow.com/users/2901259/ssh"}, "edited": false, "score": 1, "creation_date": 1426331547, "post_id": 29036028, "comment_id": 46334798, "body": "It&#39;s called an operator section, and it&#39;s a form of partial application. Operators take two arguments, but if you supply one of them and put it in brackets the compiler sees it as a function of the one remaining argument, and you can do whatever you can normally do with a function. Examples: <code>(+7)</code> is a function that adds seven, <code>(&quot;Hi, &quot;++)</code> adds at the front of a string, and <code>(&#39; &#39;:)</code> puts a space at the front of a string."}, {"owner": {"reputation": 175, "user_id": 2901259, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5eec020647b0d7ff639b31db7aed9cca?s=128&d=identicon&r=PG&f=1", "display_name": "ssh", "link": "https://stackoverflow.com/users/2901259/ssh"}, "edited": false, "score": 1, "creation_date": 1426517109, "post_id": 29036028, "comment_id": 46392590, "body": "Thank you very much for the term. I found more information here: <a href=\"https://wiki.haskell.org/Section_of_an_infix_operator\" rel=\"nofollow noreferrer\">wiki.haskell.org/Section_of_an_infix_operator</a>"}], "tags": [], "owner": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "is_accepted": false, "score": 10, "last_activity_date": 1426260175, "creation_date": 1426260175, "answer_id": 29036028, "question_id": 29035725, "link": "https://stackoverflow.com/questions/29035725/operator-in-haskell-gives-data-constructor-error/29036028#29036028", "title": "$ operator in Haskell gives data constructor error", "body": "<p>You put <code>$</code> between a function and a value, and it applies the function to the value.</p>\n\n<p><code>1:</code> isn't a function, but <code>(1:)</code> is, so you can do <code>(1:) $ [2]</code> but not <code>1: $ [2]</code>.</p>\n\n<p>(The error you got was because without spaces, the compiler thinks <code>:$</code> is one thing, not two, and operators starting with <code>:</code> are data constructors, just like functions starting with capitals are data constructors.)</p>\n"}, {"comments": [{"owner": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "edited": false, "score": 0, "creation_date": 1426262423, "post_id": 29036092, "comment_id": 46314227, "body": "I think this answer deserves more credit than mine, but so far only one other person has joined with my sentiment."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "edited": false, "score": 0, "creation_date": 1426262744, "post_id": 29036092, "comment_id": 46314447, "body": "@AndrewC Your answer was still good, you got it posted first, and you mentioned operator sections, something I failed to.  It&#39;s not like I mind the rep, at this point I don&#39;t get any more privileges, and <a href=\"http://data.stackexchange.com/stackoverflow/query/45578/top-100-users-in-a-given-tag\" rel=\"nofollow noreferrer\">we&#39;re pretty closely matched on the haskell tag anyway</a> =P"}, {"owner": {"reputation": 175, "user_id": 2901259, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5eec020647b0d7ff639b31db7aed9cca?s=128&d=identicon&r=PG&f=1", "display_name": "ssh", "link": "https://stackoverflow.com/users/2901259/ssh"}, "edited": false, "score": 0, "creation_date": 1426269500, "post_id": 29036092, "comment_id": 46318442, "body": "Thank you very much for your explanation. I learned many new things today."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 9, "last_activity_date": 1426260941, "last_edit_date": 1426260941, "creation_date": 1426260328, "answer_id": 29036092, "question_id": 29035725, "link": "https://stackoverflow.com/questions/29035725/operator-in-haskell-gives-data-constructor-error/29036092#29036092", "title": "$ operator in Haskell gives data constructor error", "body": "<p>The <code>$</code> operator is not syntax, it's just a normal function like every other.  When you write</p>\n\n<pre><code>1 :$ [2]\n</code></pre>\n\n<p>The first problem the compiler sees is that <code>:$</code> appears as its own operator (consider <code>+ +</code> versus <code>++</code>, these are very different things), but <code>:$</code> is not defined anywhere.</p>\n\n<p>If you were to write</p>\n\n<pre><code>1 : $ [2]\n</code></pre>\n\n<p>Then the compiler doesn't understand what to do since you have two operators right next to each other, this isn't allowed, just as <code>1 + * 2</code> isn't allowed.  These expressions simply don't make any sense.  The <code>$</code> operator is actually just defined as</p>\n\n<pre><code>f $ x = f x\n</code></pre>\n\n<p>But it has a low precedence, like <a href=\"http://en.wikipedia.org/wiki/Order_of_operations#Mnemonics\" rel=\"noreferrer\">Please Excuse My Dear Aunt Sally</a> for arithmetic operator precedence, so that you can chain operations more easily.  It does not actually insert parentheses into an expression.</p>\n"}], "owner": {"reputation": 175, "user_id": 2901259, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5eec020647b0d7ff639b31db7aed9cca?s=128&d=identicon&r=PG&f=1", "display_name": "ssh", "link": "https://stackoverflow.com/users/2901259/ssh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 29036092, "answer_count": 3, "score": 4, "last_activity_date": 1426260941, "creation_date": 1426259410, "last_edit_date": 1426259941, "question_id": 29035725, "link": "https://stackoverflow.com/questions/29035725/operator-in-haskell-gives-data-constructor-error", "title": "$ operator in Haskell gives data constructor error", "body": "<p><code>1:([2])</code> works as expected.</p>\n\n<p><code>1:$[2]</code> gives <code>&lt;interactive&gt;:15:2: Not in scope: data constructor `:$'</code></p>\n\n<p>I thought the <code>$</code> operator parenthesizes everything after it:\n<a href=\"https://stackoverflow.com/questions/940382/haskell-difference-between-dot-and-dollar-sign\">Haskell: difference between . (dot) and $ (dollar sign)</a></p>\n\n<p>What is going on?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1426259570, "post_id": 29035560, "comment_id": 46312228, "body": "Probably the monomorphism restriction.  Are you in GHCi or GHC?  The rules are a bit different for GHCi so the type checker isn&#39;t supposed to get in the way as much making interactive development easier."}, {"owner": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "edited": false, "score": 2, "creation_date": 1426259679, "post_id": 29035560, "comment_id": 46312306, "body": "If you try giving it an explicit type signature, you might win."}, {"owner": {"reputation": 2628, "user_id": 1031434, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/15f496f9b9b31303923658f3a02254c1?s=128&d=identicon&r=PG", "display_name": "timdiels", "link": "https://stackoverflow.com/users/1031434/timdiels"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1426261346, "post_id": 29035560, "comment_id": 46313500, "body": "@bheklilr This was in GHC. Monomorphism restriction will be the cause then. Thanks"}], "owner": {"reputation": 2628, "user_id": 1031434, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/15f496f9b9b31303923658f3a02254c1?s=128&d=identicon&r=PG", "display_name": "timdiels", "link": "https://stackoverflow.com/users/1031434/timdiels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "closed_date": 1426259750, "answer_count": 0, "score": 0, "last_activity_date": 1426258965, "creation_date": 1426258965, "question_id": 29035560, "link": "https://stackoverflow.com/questions/29035560/two-seemingly-equivalent-definitions-one-compiles-the-other-doesnt", "closed_reason": "Duplicate", "title": "Two seemingly equivalent definitions; one compiles, the other doesn&#39;t", "body": "<p>This code:</p>\n\n<pre><code>import Control.Monad.Trans\nliftIOToApp = lift\n</code></pre>\n\n<p>Gives this error:</p>\n\n<pre><code>No instance for (MonadTrans t0) arising from a use of `lift'\nIn the expression: lift\nIn an equation for `liftIOToApp': liftIOToApp = lift\n</code></pre>\n\n<p>But after adding an argument to both sides, it compiles fine:</p>\n\n<pre><code>import Control.Monad.Trans\nliftIOToApp a = lift a\n</code></pre>\n\n<p>These two definitions of <code>liftIOToApp</code> seem equivalent to me. Please explain.</p>\n"}, {"tags": ["haskell", "ghc", "nixos", "nix"], "answers": [{"comments": [{"owner": {"reputation": 4444, "user_id": 2662193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7318fa44e2a2cf165441a765c3c4f62?s=128&d=identicon&r=PG", "display_name": "Levi Pearson", "link": "https://stackoverflow.com/users/2662193/levi-pearson"}, "edited": false, "score": 0, "creation_date": 1426289377, "post_id": 29033581, "comment_id": 46326997, "body": "Thanks for posting this! One thing I&#39;d find helpful is how to manage profiling, which requires all dependencies to be built with profiling support as well. I found a way, but I don&#39;t fully understand it and it currently applies globally, so it would be good to see how to have only a single package&#39;s environment demand the profiling versions of its dependencies."}, {"owner": {"reputation": 9514, "user_id": 130886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rw5LO.jpg?s=128&g=1", "display_name": "rzetterberg", "link": "https://stackoverflow.com/users/130886/rzetterberg"}, "reply_to_user": {"reputation": 4444, "user_id": 2662193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7318fa44e2a2cf165441a765c3c4f62?s=128&d=identicon&r=PG", "display_name": "Levi Pearson", "link": "https://stackoverflow.com/users/2662193/levi-pearson"}, "edited": false, "score": 0, "creation_date": 1426495672, "post_id": 29033581, "comment_id": 46379565, "body": "@LeviPearson No worries! Just thought it would be nice to put this information in a place that is easy to access. See my edit regarding overriding how packages are built and specifically adding profiling!"}, {"owner": {"reputation": 4444, "user_id": 2662193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7318fa44e2a2cf165441a765c3c4f62?s=128&d=identicon&r=PG", "display_name": "Levi Pearson", "link": "https://stackoverflow.com/users/2662193/levi-pearson"}, "edited": false, "score": 0, "creation_date": 1426525626, "post_id": 29033581, "comment_id": 46398570, "body": "I figured out how to call lib.enableLibraryProfiling, but it didn&#39;t seem to affect the recursive dependencies of the derivation I called it on, so my build just failed one step further on as its dependencies w/profiling enabled weren&#39;t found. Maybe I just missed a &#39;clean&#39; step or something, though."}, {"owner": {"reputation": 7575, "user_id": 663299, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f3a117b27e019d6d19b46698a21c8a11?s=128&d=identicon&r=PG", "display_name": "mhwombat", "link": "https://stackoverflow.com/users/663299/mhwombat"}, "edited": false, "score": 1, "creation_date": 1431882296, "post_id": 29033581, "comment_id": 48676074, "body": "I&#39;m new to NixOS, and with some help I finally got one of my haskell projects building under Haskell NG. But my default.nix looks like your shell.nix, and my shell.nix looks like your default.nix. Do you have the filenames swapped in your answer, or do the filenames not matter?"}, {"owner": {"reputation": 9514, "user_id": 130886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rw5LO.jpg?s=128&g=1", "display_name": "rzetterberg", "link": "https://stackoverflow.com/users/130886/rzetterberg"}, "reply_to_user": {"reputation": 4444, "user_id": 2662193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7318fa44e2a2cf165441a765c3c4f62?s=128&d=identicon&r=PG", "display_name": "Levi Pearson", "link": "https://stackoverflow.com/users/2662193/levi-pearson"}, "edited": false, "score": 0, "creation_date": 1432193967, "post_id": 29033581, "comment_id": 48825550, "body": "@LeviPearson Ah, I see! I think what you need to do is to recursively overwrite each package and their dependency  via <code>buildDepends</code>."}, {"owner": {"reputation": 9514, "user_id": 130886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rw5LO.jpg?s=128&g=1", "display_name": "rzetterberg", "link": "https://stackoverflow.com/users/130886/rzetterberg"}, "reply_to_user": {"reputation": 7575, "user_id": 663299, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f3a117b27e019d6d19b46698a21c8a11?s=128&d=identicon&r=PG", "display_name": "mhwombat", "link": "https://stackoverflow.com/users/663299/mhwombat"}, "edited": false, "score": 0, "creation_date": 1432194109, "post_id": 29033581, "comment_id": 48825662, "body": "@mhwombat When calling <code>nix-shell</code> without arguments it first looks for <code>shell.nix</code>, if that file doesn&#39;t exist it looks for <code>default.nix</code>. That&#39;s why I added all imports in <code>shell.nix</code>, so I can just call <code>nix-shell</code> without args."}, {"owner": {"reputation": 3583, "user_id": 1391026, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/af98bdbeea8772f2d90d47d507098256?s=128&d=identicon&r=PG", "display_name": "musicmatze", "link": "https://stackoverflow.com/users/1391026/musicmatze"}, "edited": false, "score": 0, "creation_date": 1432234236, "post_id": 29033581, "comment_id": 48853223, "body": "Where would I add a (for example) postgres server here? So, if my app needs a running postgresql server - how to integrate this in the upper definitions?"}, {"owner": {"reputation": 9514, "user_id": 130886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rw5LO.jpg?s=128&g=1", "display_name": "rzetterberg", "link": "https://stackoverflow.com/users/130886/rzetterberg"}, "reply_to_user": {"reputation": 3583, "user_id": 1391026, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/af98bdbeea8772f2d90d47d507098256?s=128&d=identicon&r=PG", "display_name": "musicmatze", "link": "https://stackoverflow.com/users/1391026/musicmatze"}, "edited": false, "score": 1, "creation_date": 1432466375, "post_id": 29033581, "comment_id": 48931273, "body": "@musicmatze If your package needs a running postgresql server, your <code>default.nix</code> should only define what libraries it needs to use postgresql. It would not define what services the system needs to run."}, {"owner": {"reputation": 9514, "user_id": 130886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rw5LO.jpg?s=128&g=1", "display_name": "rzetterberg", "link": "https://stackoverflow.com/users/130886/rzetterberg"}, "reply_to_user": {"reputation": 3583, "user_id": 1391026, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/af98bdbeea8772f2d90d47d507098256?s=128&d=identicon&r=PG", "display_name": "musicmatze", "link": "https://stackoverflow.com/users/1391026/musicmatze"}, "edited": false, "score": 1, "creation_date": 1432466506, "post_id": 29033581, "comment_id": 48931313, "body": "@musicmatze Take nginx as an example, the <a href=\"https://github.com/NixOS/nixpkgs/blob/master/pkgs/servers/http/nginx/default.nix\" rel=\"nofollow noreferrer\"><code>default.nix</code>-file</a> only defines it&#39;s dependencies for building, installing and running. How nginx is deployed (whether it uses systemd to start it, if it needs a mutable directory to store data in, etc) is defined in a NixOS <a href=\"https://github.com/NixOS/nixpkgs/blob/master/nixos/modules/services/web-servers/nginx/default.nix\" rel=\"nofollow noreferrer\"><code>service.nix</code>-file</a>."}], "tags": [], "owner": {"reputation": 9514, "user_id": 130886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rw5LO.jpg?s=128&g=1", "display_name": "rzetterberg", "link": "https://stackoverflow.com/users/130886/rzetterberg"}, "is_accepted": true, "score": 32, "last_activity_date": 1520284951, "last_edit_date": 1520284951, "creation_date": 1426253625, "answer_id": 29033581, "question_id": 29033580, "link": "https://stackoverflow.com/questions/29033580/how-do-i-use-the-new-haskell-ng-infrastructure-on-nixos/29033581#29033581", "title": "How do I use the new haskell-ng infrastructure on NixOS?", "body": "<p>Here's <em>one way</em> of doing it on a per project basis. I'm developing a Yesod webbapp so I'm using my current setup as an example.</p>\n\n<p>In my project folder I have two files: <code>default.nix</code> (specifies how to build my project) and <code>shell.nix</code> (specifies how to setup build inputs). </p>\n\n<p>This way I can just run <code>nix-shell</code> and it drops me into an environment which has ghc installed with the provided packages and paths setup.</p>\n\n<h2>The setup</h2>\n\n<p><strong>default.nix</strong></p>\n\n<pre><code>{ stdenv, haskellPackages }:\n\nlet\n  env = haskellPackages.ghcWithPackages (p: with p; [\n    aeson\n    bytestring\n    cabal-install\n    classy-prelude\n    classy-prelude-conduit\n    classy-prelude-yesod\n    conduit\n    containers\n    data-default\n    directory\n    fast-logger\n    file-embed\n    hjsmin\n    http-conduit\n    monad-control\n    monad-logger\n    persistent\n    persistent-postgresql\n    persistent-template\n    safe\n    shakespeare\n    template-haskell\n    text\n    time\n    unordered-containers\n    vector\n    wai-extra\n    wai-logger\n    warp\n    yaml\n    yesod\n    yesod-auth\n    yesod-bin\n    yesod-core\n    yesod-form\n    yesod-static\n  ]);\nin\n  stdenv.mkDerivation {\n    name        = \"project-name\";\n    buildInputs = [env];\n    shellHook   = ''\n      export NIX_GHC=\"${env}/bin/ghc\"\n      export NIX_GHCPKG=\"${env}/bin/ghc-pkg\"\n      export NIX_GHC_DOCDIR=\"${env}/share/doc/ghc/html\"\n      export NIX_GHC_LIBDIR=$( $NIX_GHC --print-libdir )\n    '';\n  }\n</code></pre>\n\n<p><strong>shell.nix</strong></p>\n\n<pre><code>{ pkgs ? (import &lt;nixpkgs&gt; {}) }:\n\n(import ./default.nix) {\n    stdenv            = pkgs.stdenv;\n    haskellPackages = pkgs.haskellPackages;\n  }\n</code></pre>\n\n<h2>More information</h2>\n\n<p>For more information you can read:</p>\n\n<p><a href=\"http://lists.science.uu.nl/pipermail/nix-dev/2015-January/015591.html\" rel=\"nofollow noreferrer\">A Journey into the Haskell NG infrastructure: Part I</a></p>\n\n<p><a href=\"http://lists.science.uu.nl/pipermail/nix-dev/2015-January/015608.html\" rel=\"nofollow noreferrer\">A Journey into the Haskell NG infrastructure: Part II</a></p>\n\n<p>Those links explains how haskell-ng works and what will happen in the future.</p>\n\n<p>If you want to dig into the source of the haskell-ng infrastructure I suggest:</p>\n\n<p><a href=\"https://github.com/NixOS/nixpkgs/blob/7e968a47cd4383919ac1fdf4b675024787506c8c/pkgs/top-level/all-packages.nix#L6196\" rel=\"nofollow noreferrer\">The file where haskellPackages is defined</a></p>\n\n<p><a href=\"https://github.com/NixOS/nixpkgs/blob/7e968a47cd4383919ac1fdf4b675024787506c8c/pkgs/top-level/haskell-packages.nix#L1\" rel=\"nofollow noreferrer\">The haskell packages module</a></p>\n\n<p><a href=\"https://github.com/NixOS/nixpkgs/tree/master/pkgs/development/haskell-modules\" rel=\"nofollow noreferrer\">The haskell-module folder</a></p>\n\n<h2>Update: Building dependencies with profiling enabled</h2>\n\n<p>All packages in haskell-ng are defined in <a href=\"https://github.com/NixOS/nixpkgs/blob/master/pkgs/development/haskell-modules/hackage-packages.nix\" rel=\"nofollow noreferrer\">hackage-packages.nix</a>. They are built using <code>cabal.mkDerivation</code>.</p>\n\n<p>If you want to override how a package is built you need to override how <code>mkDerivation</code> is called on that package. <a href=\"https://nixos.org/wiki/Haskell#Overriding_a_package\" rel=\"nofollow noreferrer\">In the Haskell Wiki you have information on how to do that.</a>. Basically you define a new <code>haskellPackages</code> with the overrides you want for each package:</p>\n\n<pre><code>let haskellPackages' = haskellPackages.override {\n       overrides = self: super: {\n         fullstop = super.fullstop.override {\n           mkDerivation = (attrs: self.mkDerivation (attrs // { doCheck = false; }));\n         };\n       };\n     };\n</code></pre>\n\n<p>This can be quite tedious to do, therefor there are helper functions in the file <a href=\"https://github.com/NixOS/nixpkgs/blob/master/pkgs/development/haskell-modules/lib.nix\" rel=\"nofollow noreferrer\">lib.nix</a> in <code>haskell-modules</code> that you can use.</p>\n\n<p>The file <code>haskell-ng</code> imports <code>lib.nix</code> and exposes it. And <code>haskell-ng</code> is exposed as a top-level package so you can access the lib functions easily.</p>\n\n<p>Say we have a package that want to enable profiling on the text library we can do something like this:</p>\n\n<pre><code>{ pkgs ? (import &lt;nixpkgs&gt; {}).pkgs }:\n\nlet\n  lib = pkgs.haskell-ng.lib;\n  env = pkgs.haskellPackages.ghcWithPackages (p: with p; [\n    (lib.enableLibraryProfiling text)\n  ]);\nin\n  pkgs.stdenv.mkDerivation {\n    name        = \"hello-world-wide-web\";\n    buildInputs = [env];\n    shellHook   = ''\n      export NIX_GHC=\"${env}/bin/ghc\"\n      export NIX_GHCPKG=\"${env}/bin/ghc-pkg\"\n      export NIX_GHC_DOCDIR=\"${env}/share/doc/ghc/html\"\n      export NIX_GHC_LIBDIR=$( $NIX_GHC --print-libdir )\n    '';\n  }\n</code></pre>\n\n<p>I found this information this weekend by going through the nix source for haskell-ng and testing it. I'm still quite new to NixOS and nix so there could be a better way of doing this. </p>\n"}], "owner": {"reputation": 9514, "user_id": 130886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rw5LO.jpg?s=128&g=1", "display_name": "rzetterberg", "link": "https://stackoverflow.com/users/130886/rzetterberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2799, "favorite_count": 13, "accepted_answer_id": 29033581, "answer_count": 1, "score": 25, "last_activity_date": 1520284951, "creation_date": 1426253625, "last_edit_date": 1430670008, "question_id": 29033580, "link": "https://stackoverflow.com/questions/29033580/how-do-i-use-the-new-haskell-ng-infrastructure-on-nixos", "title": "How do I use the new haskell-ng infrastructure on NixOS?", "body": "<p>How do I setup a simple Haskell development environment on NixOS using the new haskell-ng infrastructure?</p>\n"}, {"tags": ["haskell", "io"], "comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 2, "creation_date": 1426249936, "post_id": 29032200, "comment_id": 46305453, "body": "What do <code>inputOne</code>, <code>inputTwo</code> etc. do? You&#39;re doing something wrong if you need eight different functions for eight cases."}, {"owner": {"reputation": 5, "user_id": 3494699, "user_type": "registered", "profile_image": "https://graph.facebook.com/1519822012/picture?type=large", "display_name": "user3494699", "link": "https://stackoverflow.com/users/3494699/user3494699"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1426250152, "post_id": 29032200, "comment_id": 46305599, "body": "They perform various IO actions depending on input chosen and sometimes change the value that they return."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1426251163, "post_id": 29032200, "comment_id": 46306308, "body": "If you do really actually need 8 different functions here you could reduce your typing a lot with <code>getInformation input db = ([inputOne, inputTwo, inputThree, ..., inputEigth] !! pred input) db</code>, obviously filling in the rest of the list.  Be careful that you don&#39;t pass it <code>9</code> for <code>input</code>, otherwise it would result in a runtime error!"}], "answers": [{"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 3, "last_activity_date": 1426250250, "creation_date": 1426250250, "answer_id": 29032456, "question_id": 29032200, "link": "https://stackoverflow.com/questions/29032200/haskell-multiple-actions-in-single-case/29032456#29032456", "title": "Haskell: Multiple Actions in Single Case", "body": "<p>If you want a do-block, you need the actual <code>do</code> keyword:</p>\n\n<pre><code>| input == 1 = do db2 &lt;- inputOne db; return db2\n</code></pre>\n\n<p>You could also structure it like</p>\n\n<pre><code>| input == 1 = do\n  db2 &lt;- inputOut db\n  return db2\n</code></pre>\n\n<p>if you prefer.</p>\n\n<p>Notice that putting the result into a variable and immediately returning the same thing is the same as</p>\n\n<pre><code>| input == 1 = inputOne db\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 3494699, "user_type": "registered", "profile_image": "https://graph.facebook.com/1519822012/picture?type=large", "display_name": "user3494699", "link": "https://stackoverflow.com/users/3494699/user3494699"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 548, "favorite_count": 0, "accepted_answer_id": 29032456, "answer_count": 1, "score": 0, "last_activity_date": 1426250250, "creation_date": 1426249484, "last_edit_date": 1426249881, "question_id": 29032200, "link": "https://stackoverflow.com/questions/29032200/haskell-multiple-actions-in-single-case", "title": "Haskell: Multiple Actions in Single Case", "body": "<p>I am trying to get IO functions within Haskell to send a variable up the IO to use within the main of the program. The specific part below is the main part giving me grief.</p>\n\n<pre><code>getInformation :: Int -&gt; [String] -&gt; IO [String]\ngetInformation input db\n    |input == 1 = return (inputOne db)\n    |input == 2 = return (inputTwo db)\n    |input == 3 = return (inputThree db)\n    |input == 4 = return (inputFour db)\n    |input == 5 = return (inputFive db)\n    |input == 6 = return (inputSix db)\n    |input == 7 = return (inputSeven db)\n    |input == 8 = return (inputEight db)\n</code></pre>\n\n<p>inputOne ... inputEight all return a value of IO [String] and I am trying to have the return be based on [String] rather than IO [String].\nIdeally I want to try something like this for each case but I'm not sure how to go about this:</p>\n\n<pre><code>db2 &lt;- (inputOne db)\nreturn (db2)\n</code></pre>\n\n<p>I have tried doing experiments along the lines of:</p>\n\n<pre><code>|input == 1 = {db2 &lt;- (inputOne db)\n               return (db2)}\n</code></pre>\n\n<p>However, this would error and not work even though I believe that is along the right lines.</p>\n\n<p>Any help would be much appreciated.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 3, "creation_date": 1426248629, "post_id": 29031687, "comment_id": 46304571, "body": "Well, <code>pointfree</code> returns <code>((f1 &gt;&gt;=) .) . flip . flip f2</code>. Is that really easier for you to understand?"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 1, "creation_date": 1426248982, "post_id": 29031687, "comment_id": 46304812, "body": "If it&#39;s this hard to make it point-free, it&#39;s probably not a good idea to make it point-free. ;-)"}, {"owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 0, "creation_date": 1426249540, "post_id": 29031687, "comment_id": 46305184, "body": "Thanks Zeta, I should have run pointfree first, of course. The version with flip is not easier, but f2 is mine to change, so I can change it to <code>b -&gt; c -&gt; a -&gt; md</code>and the expression becomes <code>(((f1 &gt;&gt;=) .) .) f2</code>"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1426250190, "post_id": 29032326, "comment_id": 46305624, "body": "It&#39;s hard to counter that this does not answer the question, since it does exactly what was asked. Well played, sir, well played..."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1426250309, "post_id": 29032326, "comment_id": 46305701, "body": "I&#39;m glad somebody has a sense of humor. :-)"}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 2, "last_activity_date": 1426249834, "creation_date": 1426249834, "answer_id": 29032326, "question_id": 29031687, "link": "https://stackoverflow.com/questions/29031687/make-monadic-functions-invocation-point-free/29032326#29032326", "title": "Make monadic functions invocation point free", "body": "<p>Well, here's my joke answer:</p>\n\n<ul>\n<li>\u03bb f st \u2192 f1 >>= \u03bb m \u2192 f2 m f st</li>\n<li>[\u03bb f st \u2192 f1 >>= [\u03bb m \u2192 f2 m f st]]</li>\n<li>[\u03bb f st \u2192 f1 >>= S [\u03bb m \u2192 f2 m f] [\u03bb m \u2192 st]]</li>\n<li>[\u03bb f st \u2192 f1 >>= S [\u03bb m \u2192 f2 m f] (K st)]</li>\n<li>[\u03bb f st \u2192 f1 >>= S (S [\u03bb m \u2192 f2 m] [\u03bb m \u2192 f]) (K st)]</li>\n<li>[\u03bb f st \u2192 f1 >>= S (S [\u03bb m \u2192 f2 m] (K f)) (K st)]</li>\n<li>[\u03bb f st \u2192 f1 >>= S (S [f2] (K f)) (K st)]</li>\n<li>[\u03bb f st \u2192 f1 >>= S (S f2 (K f)) (K st)]</li>\n<li>[\u03bb f st \u2192 (>>=) f1 (S (S f2 (K f)) (K st))]</li>\n<li>[\u03bb f \u2192 [\u03bb st \u2192 (>>=) f1 (S (S f2 (K f)) (K st))]]</li>\n<li>[\u03bb f \u2192 S [\u03bb st \u2192 (>>=) f1] [\u03bb st \u2192 S (S f2 (K f)) (K st)]]</li>\n<li>[\u03bb f \u2192 S (K ((>>=) f1)) [\u03bb st \u2192 S (S f2 (K f)) (K st)]]</li>\n<li>[\u03bb f \u2192 S (K ((>>=) f1)) (S [\u03bb st \u2192 S (S f2 (K f))] [\u03bb st \u2192 K st])]</li>\n<li>[\u03bb f \u2192 S (K ((>>=) f1)) (S [\u03bb st \u2192 S (S f2 (K f))] [K])]</li>\n<li>[\u03bb f \u2192 S (K ((>>=) f1)) (S [\u03bb st \u2192 S (S f2 (K f))] K)]</li>\n<li>[\u03bb f \u2192 S (K ((>>=) f1)) (S (K (S (S f2 (K f)))) K)]</li>\n<li>S [\u03bb f \u2192 S (K ((>>=) f1))] [\u03bb f \u2192 S (K (S (S f2 (K f)))) K]</li>\n<li>S (K (S (K ((>>=) f1)))) [\u03bb f \u2192 S (K (S (S f2 (K f)))) K]</li>\n<li>S (K (S (K ((>>=) f1)))) (S [\u03bb f \u2192 S (K (S (S f2 (K f))))] [\u03bb f \u2192 K])</li>\n<li>S (K (S (K ((>>=) f1)))) (S [\u03bb f \u2192 S (K (S (S f2 (K f))))] (K K))</li>\n<li>S (K (S (K ((>>=) f1)))) (S (S [\u03bb f \u2192 S] [\u03bb f \u2192 K (S (S f2 (K f)))]) (K K))</li>\n<li>S (K (S (K ((>>=) f1)))) (S (S (K S) [\u03bb f \u2192 K (S (S f2 (K f)))]) (K K))</li>\n<li>S (K (S (K ((>>=) f1)))) (S (S (K S) (S [\u03bb f \u2192 K] [\u03bb f \u2192 S (S f2 (K f))])) (K K))</li>\n<li>S (K (S (K ((>>=) f1)))) (S (S (K S) (S (K K) [\u03bb f \u2192 S (S f2 (K f))])) (K K))</li>\n<li>S (K (S (K ((>>=) f1)))) (S (S (K S) (S (K K) (S [\u03bb f \u2192 S] [\u03bb f \u2192 S f2 (K f)]))) (K K))</li>\n<li>S (K (S (K ((>>=) f1)))) (S (S (K S) (S (K K) (S (K S) [\u03bb f \u2192 S f2 (K f)]))) (K K))</li>\n<li>S (K (S (K ((>>=) f1)))) (S (S (K S) (S (K K) (S (K S) (S [\u03bb f \u2192 S f2] [\u03bb f \u2192 K f])))) (K K))</li>\n<li>S (K (S (K ((>>=) f1)))) (S (S (K S) (S (K K) (S (K S) (S (K (S f2)) [\u03bb f \u2192 K f])))) (K K))</li>\n<li>S (K (S (K ((>>=) f1)))) (S (S (K S) (S (K K) (S (K S) (S (K (S f2)) [K])))) (K K))</li>\n<li>S (K (S (K ((>>=) f1)))) (S (S (K S) (S (K K) (S (K S) (S (K (S f2)) K)))) (K K))</li>\n</ul>\n\n<p>The functions S and K are defined by</p>\n\n<pre><code>k :: x -&gt; y -&gt; x\nk x y = x\n\ns :: (x -&gt; y -&gt; z) -&gt; (x -&gt; y) -&gt; (x -&gt; z)\ns f g x = (f x) (g x)\n</code></pre>\n\n<p>Anybody who tries to actually use this is of course crazy. ;-)</p>\n"}], "owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1426249834, "creation_date": 1426247980, "question_id": 29031687, "link": "https://stackoverflow.com/questions/29031687/make-monadic-functions-invocation-point-free", "title": "Make monadic functions invocation point free", "body": "<p>I have code that compiles:</p>\n\n<pre><code>\\f st -&gt; f1 &gt;&gt;= \\m-&gt; f2 m f st\n</code></pre>\n\n<p>f1 is of type <code>m a</code> and f2 of type <code>a -&gt; b -&gt; c -&gt; m d</code>, in the same Monad m. I can't for the life of me rewrite this expression pointfree, without the ugly \\f st and the \\m in the middle. I would like to, not for aesthetics but because I have other equations for the same function that I can write pointfree, so it would make the code a lot easier to understand.</p>\n\n<p>Thanks for any help! </p>\n"}, {"tags": ["haskell", "pattern-matching", "list-comprehension"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1426244346, "post_id": 29029683, "comment_id": 46302071, "body": "To avoid falling into this error in the future, I&#39;d recommend to turn on GHC warnings with <code>-Wall</code>: this would point out that <code>x</code> is being bound twice (the inner <code>x</code> shadows the outer one)."}], "answers": [{"comments": [{"owner": {"reputation": 1795, "user_id": 1839343, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b26d97dd045ce61904e7c6d1a9775e0c?s=128&d=identicon&r=PG", "display_name": "jules", "link": "https://stackoverflow.com/users/1839343/jules"}, "edited": false, "score": 0, "creation_date": 1426243270, "post_id": 29029942, "comment_id": 46301436, "body": "thank you very much ... if I understand correctly it&#39;s necessary that <code>a</code> is an instance of <code>Eq</code> under any circumstances?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 1795, "user_id": 1839343, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b26d97dd045ce61904e7c6d1a9775e0c?s=128&d=identicon&r=PG", "display_name": "jules", "link": "https://stackoverflow.com/users/1839343/jules"}, "edited": false, "score": 2, "creation_date": 1426243494, "post_id": 29029942, "comment_id": 46301550, "body": "@jules yes. One reason for why we don&#39;t have equality testing in patterns is because not all types are instances of <code>Eq</code>. I guess it could be still implemented as syntactic sugar, but no one really thought it worth the hassle."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 8, "last_activity_date": 1426242967, "last_edit_date": 1426242967, "creation_date": 1426242622, "answer_id": 29029942, "question_id": 29029683, "link": "https://stackoverflow.com/questions/29029683/pattern-matching-in-case-expressions-list-comprehensions/29029942#29029942", "title": "Pattern matching in case expressions/list comprehensions", "body": "<p>Haskell has linear patterns, meaning that there must be no repeated variables in patterns. Also, pattern variables in inner expressions shadow outer variables, instead of establishing equality of identical variables. </p>\n\n<p>You're trying to do something like this:</p>\n\n<pre><code>charEq :: Char -&gt; Char -&gt; Bool\ncharEq c c = True\ncharEq _ _ = False\n</code></pre>\n\n<p>But this is an error because of the repeated variables. If we move the second <code>c</code> to an inner expression, it compiles, but it still doesn't work as intended:</p>\n\n<pre><code>charEq :: Char -&gt; Char -&gt; Bool\ncharEq c d = case d of\n  c -&gt; True\n  _ -&gt; False\n</code></pre>\n\n<p>Here the inner <code>c</code> is just a new variable that shadows the outer <code>c</code>, so <code>charEq</code> always returns <code>True</code>.</p>\n\n<p>If we'd like to check for equality we must use <code>==</code> explicitly:</p>\n\n<pre><code>subs :: [(Term a, Term a)] -&gt; Term a -&gt; Term a\nsubs subList term = case term of \n    atom@(Atom x)       -&gt;  let substitutions = \n                                [ s | s@(Atom x', _) &lt;- subList, x == x' ]\n                            in  if null substitutions\n                                then atom\n                                else snd . head $ substitutions\n    (Compound t1 t2)    -&gt; Compound (subs subList t1) (subs subList t2)\n</code></pre>\n"}], "owner": {"reputation": 1795, "user_id": 1839343, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b26d97dd045ce61904e7c6d1a9775e0c?s=128&d=identicon&r=PG", "display_name": "jules", "link": "https://stackoverflow.com/users/1839343/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 29029942, "answer_count": 1, "score": 3, "last_activity_date": 1426246023, "creation_date": 1426241800, "last_edit_date": 1426246023, "question_id": 29029683, "link": "https://stackoverflow.com/questions/29029683/pattern-matching-in-case-expressions-list-comprehensions", "title": "Pattern matching in case expressions/list comprehensions", "body": "<p>Why does the following attempt to pattern-match in a list comprehension not work?</p>\n\n<p>Example: simultaneous substitution of atoms in a term data type.</p>\n\n<p>The data type:</p>\n\n<pre><code>data Term a \n    = Atom a\n    | Compound (Term a) (Term a)\n    deriving Show\n</code></pre>\n\n<p>The substitution algorithm for atoms in terms (picks the first matching substitution if any and ignores the rest):</p>\n\n<pre><code>subs :: [(Term a, Term a)] -&gt; Term a -&gt; Term a\nsubs subList term = case term of \n    atom@(Atom x)       -&gt;  let substitutions = \n                                [ s | s@(Atom x, _) &lt;- subList ]\n                            in  if null substitutions\n                                then atom\n                                else snd . head $ substitutions\n    (Compound t1 t2)    -&gt; Compound (subs subList t1) (subs subList t2)\n</code></pre>\n\n<p>Some test data:</p>\n\n<pre><code>subList = [((Atom 'a'), Compound (Atom 'b') (Atom 'c'))]\nterm1 = Atom 'a' \nterm2 = Atom 'x' \n</code></pre>\n\n<p>Running the example results in:</p>\n\n<pre><code>&gt;: subs subList term1\nCompound (Atom 'b') (Atom 'c')\n</code></pre>\n\n<p>which is the desired behaviour, and</p>\n\n<pre><code>&gt;: subs subList term2\nCompound (Atom 'b') (Atom 'c')\n</code></pre>\n\n<p>which is not.</p>\n\n<p>Strangley explicit matching works:</p>\n\n<pre><code>subs'' :: [(Term Char, Term Char)] -&gt; Term Char -&gt; Term Char\nsubs'' subList term = case term of \n    atom@(Atom _)       -&gt;  let substitutions = \n                            [ s | s@(Atom 'a', _) &lt;- subList ]\n                            in  if null substitutions\n                                then atom\n                                else snd . head $ substitutions\n    (Compound t1 t2)    -&gt; Compound (subs subList t1) (subs subList t2)\n\nsubs''' subList term = case term of \n     atom@(Atom _)       -&gt;  let substitutions = \n                             [ s | s@(Atom 'x', _) &lt;- subList ]\n                             in  if null substitutions\n                                 then atom\n                                 else snd . head $ substitutions\n     (Compound t1 t2)    -&gt; Compound (subs subList t1) (subs subList t2)\n</code></pre>\n\n<p>feed with the test data result in:</p>\n\n<p><code>&gt;: subs'' subList term1</code> or <code>&gt;: subs'' subList term2</code><br>\n<code>Compound (Atom 'b') (Atom 'c')</code>  </p>\n\n<p><code>&gt;: subs''' subList term1</code> or <code>&gt;: subs''' subList term2</code><br>\n<code>Atom 'x'</code></p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["haskell", "typeclass"], "answers": [{"comments": [{"owner": {"reputation": 23895, "user_id": 472416, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa78d79fb4238d200e26fb87e3de947b?s=128&d=identicon&r=PG", "display_name": "utdemir", "link": "https://stackoverflow.com/users/472416/utdemir"}, "edited": false, "score": 0, "creation_date": 1426239397, "post_id": 29028797, "comment_id": 46299169, "body": "Yes, after defining that instance, I got <code>src&#47;Utils.hs:52:20: Overlapping instances for Eq Integer arising from a use of \u2018&#47;=\u2019 \u2026     Matching instances:       instance Eq Integer -- Defined in \u2018integer-gmp:GHC.Integer.Type\u2019       instance (Eq b, HasPK a b) =&gt; Eq a</code>. But I wasn&#39;t expecting that error since <code>Integer</code> hasn&#39;t got an <code>HasPk Integer b</code> instance. I&#39;d understand the error if I define both Eq and HasPK, but since there isn&#39;t <code>HasPK Integer</code>, shouldn&#39;t it directly use ordinary <code>Eq</code> instance?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 23895, "user_id": 472416, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa78d79fb4238d200e26fb87e3de947b?s=128&d=identicon&r=PG", "display_name": "utdemir", "link": "https://stackoverflow.com/users/472416/utdemir"}, "edited": false, "score": 2, "creation_date": 1426240116, "post_id": 29028797, "comment_id": 46299565, "body": "@utdemir The problem is: an <code>instance C a =&gt; Eq a</code> applies to every type, even to those for which <code>C a</code> is false (!). Haskell will commit to use this instance, and when <code>C a</code> it false it will error out, instead of backtracking and look for other instances. This is done because with backtracking the problem becomes much harder, and the Haskell designers were concerned with compilation time. GHC has an <code>OverlappingInstances</code> extension that relaxes this restriction, but I&#39;d not recommend it. Overlapping instances are best to be avoided, IMHO."}, {"owner": {"reputation": 23895, "user_id": 472416, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa78d79fb4238d200e26fb87e3de947b?s=128&d=identicon&r=PG", "display_name": "utdemir", "link": "https://stackoverflow.com/users/472416/utdemir"}, "edited": false, "score": 0, "creation_date": 1426259789, "post_id": 29028797, "comment_id": 46312399, "body": "Thank you, I went with type family solution since it looks like the least controversial extension is that one."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 9, "last_activity_date": 1426239379, "last_edit_date": 1426239379, "creation_date": 1426239021, "answer_id": 29028797, "question_id": 29028714, "link": "https://stackoverflow.com/questions/29028714/inferring-eq-typeclass/29028797#29028797", "title": "Inferring Eq typeclass", "body": "<p>You need a functional dependency here: use</p>\n\n<pre><code>class Eq b =&gt; HasPK a b | a -&gt; b where\n  getPK :: a -&gt; b\n</code></pre>\n\n<p>and enable whatever extension GHC points to.</p>\n\n<p>The issue lies in the possibility of having multiple PKs for the same type,\nas in</p>\n\n<pre><code>instance HasPK MyType Int where ...\ninstance HasPK MyType String where ...\n</code></pre>\n\n<p>Since the above double instance could be added later, code like <code>(==) `on` getPK</code> is potentially ambiguous. Indeed, when the instances above are added, it does not specify whether to use the <code>Int</code> PK or the <code>String</code> one.</p>\n\n<hr>\n\n<p>However, an instance like</p>\n\n<pre><code>instance (HasPK a b) =&gt; Eq a where\n  ...\n</code></pre>\n\n<p>is likely to cause problems, since it overlaps with any other <code>Eq</code> instance. Be careful here. I would instead write</p>\n\n<pre><code>equalPK :: HasPK a b =&gt; a -&gt; a -&gt; Bool\nequalPK = (==) `on` getPK\n</code></pre>\n\n<p>and then provide explicit instances to all the relevant types as this:</p>\n\n<pre><code>instance Eq MyType1 where (==) = equalPK\ninstance Eq MyType2 where (==) = equalPK\n...\n</code></pre>\n\n<hr>\n\n<p>As another alternative, you can use a type family such as</p>\n\n<pre><code>class HasPK a where\n   type PK a\n   getPK :: a -&gt; PK a\n\nequalPK :: Eq (PK a) =&gt; a -&gt; a -&gt; Bool\nequalPK = (==) `on` getPK\n\ninstance Eq MyType1 where (==) = equalPK\n...\n</code></pre>\n"}], "owner": {"reputation": 23895, "user_id": 472416, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa78d79fb4238d200e26fb87e3de947b?s=128&d=identicon&r=PG", "display_name": "utdemir", "link": "https://stackoverflow.com/users/472416/utdemir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 1, "accepted_answer_id": 29028797, "answer_count": 1, "score": 7, "last_activity_date": 1426239379, "creation_date": 1426238773, "question_id": 29028714, "link": "https://stackoverflow.com/questions/29028714/inferring-eq-typeclass", "title": "Inferring Eq typeclass", "body": "<p>I'm writing a CRUD like application and have a lot of lookups by primary key(primary keys can have different types). So I defined following typeclass:</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n\nclass Eq b =&gt; HasPK a b where\n  getPK :: a -&gt; b\n</code></pre>\n\n<p>Now I can write:</p>\n\n<pre><code>import Data.Maybe\n\nlookupPK :: HasPK a b =&gt; b -&gt; [a] -&gt; Maybe a\nlookupPK s = listToMaybe . filter ((== s) . getPK)\n</code></pre>\n\n<p>Now, when I want to compare two things with PK, I just want to compare their PK's. So, I'm trying to define this:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances    #-}\n{-# LANGUAGE UndecidableInstances #-}\n\ninstance (HasPK a b) =&gt; Eq a where\n  (==) = (==) `on` getPK\n</code></pre>\n\n<p>But now it gives me:</p>\n\n<pre><code>src/Utils.hs:61:10: Could not deduce (HasPK a b0) \u2026\n      arising from the ambiguity check for an instance declaration\n    from the context (HasPK a b)\n      bound by an instance declaration: HasPK a b =&gt; Eq a\n      at /home/utdemir/workspace/.../Utils.hs:61:10-28\n    The type variable \u2018b0\u2019 is ambiguous\n    In the ambiguity check for: forall a b. HasPK a b =&gt; Eq a\n    To defer the ambiguity check to use sites, enable AllowAmbiguousTypes\n    In the instance declaration for \u2018Eq a\u2019\nCompilation failed.\n</code></pre>\n\n<p>Can anyone explain this error to me? Am I on the right track, or is there a safer way to achieve what I want?</p>\n"}, {"tags": ["haskell", "sparql", "cabal"], "comments": [{"owner": {"reputation": 1365, "user_id": 536017, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5a8149f6e0f3f0276a525bf9a76a5397?s=128&d=identicon&r=PG", "display_name": "danem", "link": "https://stackoverflow.com/users/536017/danem"}, "edited": false, "score": 0, "creation_date": 1426279336, "post_id": 29028661, "comment_id": 46323449, "body": "Wait, when you try <code>cabal install hsparql</code> you get that error message? Are you using a sandbox? I usually see that error message when using sandboxes and I haven&#39;t added the mentioned package to my cabal file."}, {"owner": {"reputation": 2550, "user_id": 1366643, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/QFRXO.jpg?s=128&g=1", "display_name": "Herokiller", "link": "https://stackoverflow.com/users/1366643/herokiller"}, "reply_to_user": {"reputation": 1365, "user_id": 536017, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5a8149f6e0f3f0276a525bf9a76a5397?s=128&d=identicon&r=PG", "display_name": "danem", "link": "https://stackoverflow.com/users/536017/danem"}, "edited": false, "score": 0, "creation_date": 1426307601, "post_id": 29028661, "comment_id": 46330190, "body": "@danem no I&#39;m not using sandbox"}, {"owner": {"reputation": 1365, "user_id": 536017, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5a8149f6e0f3f0276a525bf9a76a5397?s=128&d=identicon&r=PG", "display_name": "danem", "link": "https://stackoverflow.com/users/536017/danem"}, "edited": false, "score": 0, "creation_date": 1426373506, "post_id": 29028661, "comment_id": 46347639, "body": "And if you fire up GHCi, you can import Network.URI?"}], "owner": {"reputation": 2550, "user_id": 1366643, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/QFRXO.jpg?s=128&g=1", "display_name": "Herokiller", "link": "https://stackoverflow.com/users/1366643/herokiller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1426238586, "creation_date": 1426238586, "question_id": 29028661, "link": "https://stackoverflow.com/questions/29028661/cabal-install-hsparql-error", "title": "cabal install hsparql error", "body": "<p>Im trying to install hsparql, cabal version 1.22.1.1</p>\n\n<pre><code>cabal install hsparql\n</code></pre>\n\n<p>gives </p>\n\n<pre><code>Could not find module `Network.URI'\nIt is a member of the hidden package `network-uri-2.6.0.1'.\nPerhaps you need to add `network-uri' to the build-depends in your .cabal file.\nUse -v to see a list of the files searched for.\nFailed to install hsparql-0.2.5\ncabal: Error: some packages failed to install:\nhsparql-0.2.5 failed during the building phase. The exception was:\nExitFailure 1\n</code></pre>\n\n<p>but </p>\n\n<pre><code>cabal install network-uri\n</code></pre>\n\n<p>shows</p>\n\n<pre><code>All the requested packages are already installed:\nnetwork-uri-2.6.0.1\n</code></pre>\n\n<p>what could be the problem?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1426215765, "post_id": 29023751, "comment_id": 46291018, "body": "This looks like homework.  What have you tried and we&#39;ll help with any problems you&#39;ve encountered, but you shouldn&#39;t ask someone to do your homework for you on SO."}, {"owner": {"reputation": 13, "user_id": 4665404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc0b099dd3327e4da7bec5c31f0819fa?s=128&d=identicon&r=PG&f=1", "display_name": "SuperSoooap", "link": "https://stackoverflow.com/users/4665404/supersoooap"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1426216650, "post_id": 29023751, "comment_id": 46291261, "body": "oh sorry , I forgot to put on my solution"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1426217410, "post_id": 29023751, "comment_id": 46291438, "body": "In <code>lines (x:xs) = x : lines xs</code>, <code>x</code> has type <code>Char</code>, so <code>x :</code> has type <code>[Char] -&gt; [Char]</code>. Obviously this cannot be correct because the output type must be <code>[[Char]]</code>. Note that you only want to prepend <code>x</code> to the <i>first element</i> of the list <code>lines xs</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1426219897, "post_id": 29023751, "comment_id": 46292061, "body": "I would suggest you try to break the problem down a bit, and work one step at a time. Start by thinking about how you&#39;d extract just the <i>first</i> line."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4665404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc0b099dd3327e4da7bec5c31f0819fa?s=128&d=identicon&r=PG&f=1", "display_name": "SuperSoooap", "link": "https://stackoverflow.com/users/4665404/supersoooap"}, "edited": false, "score": 0, "creation_date": 1426230965, "post_id": 29026321, "comment_id": 46295330, "body": "By the way, what&#39;s the difference between &quot;&quot; and [] , cause String == [Char]. In my opinion, &quot;&quot; is an empty list of Char, so are they the same?"}, {"owner": {"reputation": 1212, "user_id": 2455145, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kazBZ.jpg?s=128&g=1", "display_name": "AlexJ136", "link": "https://stackoverflow.com/users/2455145/alexj136"}, "reply_to_user": {"reputation": 13, "user_id": 4665404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc0b099dd3327e4da7bec5c31f0819fa?s=128&d=identicon&r=PG&f=1", "display_name": "SuperSoooap", "link": "https://stackoverflow.com/users/4665404/supersoooap"}, "edited": false, "score": 0, "creation_date": 1426235083, "post_id": 29026321, "comment_id": 46297006, "body": "They represent the same value, but <code>&quot;&quot;</code> tells the type checker that it must be a list of characters, whereas <code>[]</code> only tells the type checker that it is a list, and lets the type checker on infer what type of list it is. So <code>&quot;&quot; :: [a]</code> is only valid for <code>a == Char</code>, but <code>[] :: [a]</code> is valid for any <code>a</code>."}], "tags": [], "owner": {"reputation": 1212, "user_id": 2455145, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kazBZ.jpg?s=128&g=1", "display_name": "AlexJ136", "link": "https://stackoverflow.com/users/2455145/alexj136"}, "is_accepted": true, "score": 1, "last_activity_date": 1426229881, "last_edit_date": 1426229881, "creation_date": 1426228928, "answer_id": 29026321, "question_id": 29023751, "link": "https://stackoverflow.com/questions/29023751/implement-the-function-lines-in-haskell/29026321#29026321", "title": "implement the function lines in haskell", "body": "<p>Firstly, you need a way of retrieving all the text before the first newline character. This is simple recursion:</p>\n\n<pre><code>beforeNewLine :: [Char] -&gt; [Char]\nbeforeNewLine \"\"        = \"\"\nbeforeNewLine ('\\n':xs) = \"\"\nbeforeNewLine (x:xs)    = x : beforeNewLine xs\n</code></pre>\n\n<p>Likewise, we need to be able to get all the text after the first newline character:</p>\n\n<pre><code>afterNewLine :: [Char] -&gt; [Char]\nafterNewLine \"\"        = \"\"\nafterNewLine ('\\n':xs) = xs\nafterNewLine (x:xs)    = afterNewLine xs\n</code></pre>\n\n<p>Put it all together:</p>\n\n<pre><code>myLines :: [Char] -&gt; [[Char]]\nmyLines \"\" = []\nmyLines xs = (beforeNewLine xs) : myLines (afterNewLine xs)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 708, "user_id": 4553930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/308c878dca0a01a80bc9b5b9b19c7ab6?s=128&d=identicon&r=PG&f=1", "display_name": "Abhay", "link": "https://stackoverflow.com/users/4553930/abhay"}, "edited": false, "score": 0, "creation_date": 1426260599, "post_id": 29032130, "comment_id": 46312994, "body": "&quot;what do you do with the empty list? what do you do with x cons xs?&quot; Exactly! Probably the most important line in the answer, and a thousand other answers."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1426266553, "post_id": 29032130, "comment_id": 46316717, "body": "Ok, but what does this have to do with ferrying souls across the river Styx?"}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": false, "score": 6, "last_activity_date": 1426249252, "creation_date": 1426249252, "answer_id": 29032130, "question_id": 29023751, "link": "https://stackoverflow.com/questions/29023751/implement-the-function-lines-in-haskell/29032130#29032130", "title": "implement the function lines in haskell", "body": "<p>Suppose you had already knew the result of <code>lines</code> for all but the first character of your input. How would you add the first character onto that result?</p>\n\n<pre><code>charon :: Char -&gt; [[Char]] -&gt; [[Char]]\ncharon '\\n'     css  = [] : css    -- to begin with newline, insert blank line\ncharon c         []  = [[c]]       -- very last char is in line of its own\ncharon c (cs : css)  = (c : cs) : css  -- else put char in first line\n</code></pre>\n\n<p>And with that mystery solved,</p>\n\n<pre><code>lines = foldr charon []\n</code></pre>\n\n<p>For years, I have made students bang their fists on the furniture and chant \"<em>what</em> do you <em>do</em> with the <em>emp</em>ty <em>list</em>? <em>what</em> do you <em>do</em> with <em>x</em> cons <em>xs</em>?\". Sometimes it helps.</p>\n"}], "owner": {"reputation": 13, "user_id": 4665404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc0b099dd3327e4da7bec5c31f0819fa?s=128&d=identicon&r=PG&f=1", "display_name": "SuperSoooap", "link": "https://stackoverflow.com/users/4665404/supersoooap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1040, "favorite_count": 0, "accepted_answer_id": 29026321, "answer_count": 2, "score": 1, "last_activity_date": 1426249252, "creation_date": 1426212610, "last_edit_date": 1426218491, "question_id": 29023751, "link": "https://stackoverflow.com/questions/29023751/implement-the-function-lines-in-haskell", "title": "implement the function lines in haskell", "body": "<p>e.g. <code>lines \"One string\\non\\neach line\"</code> = <code>[\"One string\",\"on\",\"each line\"]</code></p>\n\n<p>Use pattern matching and recursion on lists, the list constructors, but no other functions.</p>\n\n<p>That's my solution, I think logically, but it still gives me an error`</p>\n\n<pre><code>lines :: [Char] -&gt; [[Char]]\nlines [] = [[]]\nlines (x:'\\n':xs) = [x] : lines xs\nlines (x:xs) = x : lines xs\n</code></pre>\n"}, {"tags": ["haskell", "applicative"], "comments": [{"owner": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "edited": false, "score": 0, "creation_date": 1426212223, "post_id": 29023602, "comment_id": 46290063, "body": "Are you sure, its not <code>&gt;&gt;</code>?"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "reply_to_user": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "edited": false, "score": 2, "creation_date": 1426212485, "post_id": 29023602, "comment_id": 46290155, "body": "@thefourtheye <code>*&gt;</code> is <code>&gt;&gt;</code> if the applicative in question is also a monad."}], "answers": [{"comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 5, "creation_date": 1426212873, "post_id": 29023732, "comment_id": 46290271, "body": "In the end, the effect is that each element of <code>[1,2,3]</code> is replaced with <code>[4,5]</code>, giving <code>[[4,5],[4,5],[4,5]]</code>, which is then flatted with <code>concat</code> into <code>[4,5,4,5,4,5]</code>. If you define this yourself as <code>xs *&gt; ys = concat (map (const ys) xs)</code>, you can show that this is equivalent to the given definition of <code>(*&gt;)</code>, and also to <code>(&gt;&gt;)</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1426213261, "post_id": 29023732, "comment_id": 46290373, "body": "@ReinHenrichs, I need to finish that off properly and reword some things, but I&#39;m feeling oddly giddy at the moment, so it&#39;s hard to focus. If you want to take the last step or two from <code>&lt;*&gt;</code> to <code>*&gt;</code>, go ahead and edit."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1426213448, "post_id": 29023732, "comment_id": 46290425, "body": "I tried that and it was difficult so I stopped when I saw your answer. :D It&#39;s a rather circuitous path."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1426213477, "post_id": 29023732, "comment_id": 46290430, "body": "@ReinHenrichs I think there&#39;s most likely also a connection to be made to tree grafting monads via some sort of morphism. Tree grafting seems a much more natural expression of this than list <code>concatMap</code>."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1426213508, "post_id": 29023732, "comment_id": 46290443, "body": "This is a good example of monads for substitution, yes. I&#39;m just not sure how to word it concisely."}, {"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1426214120, "post_id": 29023732, "comment_id": 46290592, "body": "Interesting, @Rein. But, <code>concat (map (const ys) xs)</code> won&#39;t work with <code>Maybe a</code>. So, is <code>dfeuer</code>&#39;s generic definition considered better - <code>const id &lt;$&gt; xs &lt;*&gt; ys</code> out of its genericity? I admit that I don&#39;t know how <code>*&gt;</code> is defined - whether it&#39;s defined in general for all usages or per implementing class."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 1, "creation_date": 1426214573, "post_id": 29023732, "comment_id": 46290721, "body": "@KevinMeredith, it has a default definition, and all implementations are expected to be semantically the same as that (except possibly more defined). But some types (e.g., <code>Data.Sequence</code>) are able to work magic and give more efficient <code>*&gt;</code> implementations than the default."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 2, "creation_date": 1426217717, "post_id": 29023732, "comment_id": 46291520, "body": "@KevinMeredith Rein Henrichs version works in general if you rewrite it a little bit to use functions that are more generic: <code>join (fmap (const ys) xs)</code>"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 7, "last_activity_date": 1426212935, "last_edit_date": 1426212935, "creation_date": 1426212490, "answer_id": 29023732, "question_id": 29023602, "link": "https://stackoverflow.com/questions/29023602/understanding-right-apply/29023732#29023732", "title": "Understanding Right Apply", "body": "<p>The <code>*&gt;</code> operator is defined, by default, as</p>\n\n<pre><code>xs *&gt; ys = id &lt;$ xs &lt;*&gt; ys\n</code></pre>\n\n<p>which in turn translates, by default, to</p>\n\n<pre><code>const id &lt;$&gt; xs &lt;*&gt; ys\n</code></pre>\n\n<p>That is, it replaces each element of <code>xs</code> with <code>id</code> to get <code>xs'</code> and then calculates <code>xs' &lt;*&gt; ys</code>. <code>[]</code> is a <code>Monad</code> instance, where <code>(=&lt;&lt;) = concatMap</code>. One of the laws of <code>Applicative</code> lays out the relationship between <code>Applicative</code> and <code>Monad</code> instances:</p>\n\n<pre><code>pure = return\nfs &lt;*&gt; as = fs `ap` as = fs &gt;&gt;= \\f -&gt; as &gt;&gt;= \\a -&gt; f a\n</code></pre>\n\n<p>For lists, this is</p>\n\n<pre><code>fs &lt;*&gt; as = [f a | f &lt;- fs, a &lt;- as]\n</code></pre>\n\n<p>So <code>*&gt;</code> for lists is ultimately determined by the <code>Monad</code> instance.</p>\n\n<p>Note that there is another very sensible <code>Applicative</code> instance for lists, which is made available through a newtype in <code>Control.Applicative</code>:</p>\n\n<pre><code>newtype ZipList a = ZipList [a]\ninstance Applicative ZipList where\n  pure = repeat\n  (&lt;*&gt;) = zipWith ($) \n</code></pre>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 1, "accepted_answer_id": 29023732, "answer_count": 1, "score": 4, "last_activity_date": 1426230439, "creation_date": 1426211694, "last_edit_date": 1426230439, "question_id": 29023602, "link": "https://stackoverflow.com/questions/29023602/understanding-right-apply", "title": "Understanding Right Apply", "body": "<p>For a List, why does <code>right apply (*&gt;)</code> behave as repeating and appending the second argument <code>n</code> times, where <code>n</code> is the length of the first argument?</p>\n\n<pre><code>ghci&gt; [1,2,3] *&gt; [4,5]\n[4,5,4,5,4,5]\n</code></pre>\n"}, {"tags": ["haskell", "random"], "comments": [{"owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "edited": false, "score": 1, "creation_date": 1426214653, "post_id": 29023263, "comment_id": 46290748, "body": "This is the standard &quot;building a list in a monad&quot; problem. Monads force a certain kind of strictness on you some times. You can use a solution like <code>pipes</code>, though."}], "answers": [{"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": false, "score": 2, "last_activity_date": 1426219705, "creation_date": 1426219705, "answer_id": 29024732, "question_id": 29023263, "link": "https://stackoverflow.com/questions/29023263/haskell-infinite-list-of-bernoulli-distributed-booleans/29024732#29024732", "title": "Haskell infinite list of Bernoulli distributed booleans", "body": "<p>The culprit is <code>sequence . repeat</code> - this will hang for (almost?) every monad, since you must perform a potentially infinite number of effects. </p>\n\n<p>The simplest solutions would be to use a different library - which may not be possible if you are relying on the quality of the numbers produced from mwc-random. The next simplest solution is to rewrite <code>foo</code> to have type <code>[IO Bool] -&gt; IO [Bool]</code> and pass it <code>repeat (bernoulli 0.25 gen)</code> - this would allow <code>foo</code> to make the choice of when to stop executing the effects produced by the infinite list. But having your logic inside of <code>IO</code> is not very nice.</p>\n\n<p>The standard trick when you need an infinite list of random numbers is to use a pure function <code>f :: StdGen -&gt; (Result, StdGen)</code>. Then <code>unfoldr (Just . f) :: StdGen -&gt; [Result]</code>, and the output is an infinite list. At first glance, it may appear that mwc-random only has monadic functions, and that there is no pure interface. However, that is not the case, because <code>ST s</code> is an instance of <code>PrimMonad</code>. You also have the functions converting a <code>Gen</code> to a <code>Seed</code>. Using these, you can get a pure RNG function for any monadic one:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n\nimport System.Random.MWC\nimport System.Random.MWC.Distributions \nimport Control.Monad.ST \nimport Data.List \n\npureRand :: (forall s . GenST s -&gt; ST s t) -&gt; Seed -&gt; (t, Seed) \npureRand f s = runST $ do \n  s'  &lt;- restore s\n  r   &lt;- f s' \n  s'' &lt;- save s' \n  return (r, s'')\n\npureBernoulli :: Double -&gt; Seed -&gt; (Bool, Seed)\npureBernoulli a = pureRand (bernoulli a) \n\nfoo :: [Bool] -&gt; [Bool]\nfoo = id \n\nmain = do\n  gen &lt;- create &gt;&gt;= save\n  let bits = unfoldr (Just . pureBernoulli 0.25) gen \n  print . take 32 . foo $ bits\n</code></pre>\n\n<p>It is unfortunate that mwc-random doesn't expose this sort of interface by default but it is pretty easy to get to.</p>\n\n<p>The other option is slightly more scary - use unsafe functions.</p>\n\n<pre><code>import System.IO.Unsafe\n\nrepeatM rand = go where\n  go = do\n    x  &lt;- rand\n    xs &lt;- unsafeInterleaveIO go\n    return (x : xs)\n\nmain2 = do\n  gen &lt;- create\n  bits &lt;- repeatM (bernoulli 0.25 gen) \n  print . take 32 . foo $ bits\n</code></pre>\n\n<p>Naturally this comes with the usual caveats surrounding <code>unsafe</code> - use it only if you are exceedingly inconvenienced by the pure functions. <code>unsafeInterleaveIO</code> may reorder or never execute effects - if <code>foo</code>, for example, ignores one element, it will never be computed and the corresponding effect of updating the state stored in <code>gen</code> may not happen. For example, the following will print nothing:</p>\n\n<pre><code>snd &lt;$&gt; ((,) &lt;$&gt; unsafeInterleaveIO (putStrLn \"Hello\") &lt;*&gt; return ())  \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 293, "user_id": 478658, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/357dd2bc31ed5785c639b641415c3db5?s=128&d=identicon&r=PG", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/478658/sebastian"}, "edited": false, "score": 0, "creation_date": 1426515681, "post_id": 29024745, "comment_id": 46391522, "body": "For testing purposes it would be really useful to be able to use a fixed random seed (<code>initialize</code>) instead of the <code>withSystemRandom</code> function. I can&#39;t figure out how to alter the code to work with such a setup."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 293, "user_id": 478658, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/357dd2bc31ed5785c639b641415c3db5?s=128&d=identicon&r=PG", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/478658/sebastian"}, "edited": false, "score": 0, "creation_date": 1426531476, "post_id": 29024745, "comment_id": 46402029, "body": "@Sebastian <code>create</code> and <code>initialize</code> make a <code>forall s. ST s (GenST s))</code>. You can apply a computation in the <code>forall s. ST s</code> monad with <code>&gt;&gt;=</code>, for example <code>create &gt;&gt;= unfoldStream interesting 0</code> or <code>initialize vector &gt;&gt;= randomStream (bernoulli 0.25)</code> (where <code>vector</code> is some vector you defined). In either case you will get an <code>forall s. ST s [Bool]</code> which you can run with <code>runST</code> to get just a <code>[Bool]</code>, for example <code>runST (initialize vector &gt;&gt;= randomStream (bernoulli 0.25))</code>."}, {"owner": {"reputation": 293, "user_id": 478658, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/357dd2bc31ed5785c639b641415c3db5?s=128&d=identicon&r=PG", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/478658/sebastian"}, "edited": false, "score": 0, "creation_date": 1426541083, "post_id": 29024745, "comment_id": 46407271, "body": "Thanks, turns out I was missing the runST and was just trying to extract the value from the Monad with <code>&lt;-</code>."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 5, "last_activity_date": 1426221131, "last_edit_date": 1426221131, "creation_date": 1426219854, "answer_id": 29024745, "question_id": 29023263, "link": "https://stackoverflow.com/questions/29023263/haskell-infinite-list-of-bernoulli-distributed-booleans/29024745#29024745", "title": "Haskell infinite list of Bernoulli distributed booleans", "body": "<p>The <code>mwc-random</code> package provides two <code>PrimMonad</code> instances, one for <code>IO</code> and another for <code>ST s</code>. As long as an <code>ST</code> computation is parameterized over all state tags <code>s</code>, we can run the computation and extract the value with <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Monad-ST.html#v:runST\" rel=\"noreferrer\"><code>runST :: (forall s. ST s a) -&gt; a</code></a>. By itself this wouldn't be very useful since we'd lose the state: the seed of the random generator, but mwc-random also provides explicit ways to <a href=\"https://hackage.haskell.org/package/mwc-random-0.13.3.0/docs/System-Random-MWC.html#t:Seed\" rel=\"noreferrer\">handle the seeds</a>:</p>\n\n<pre><code>save :: PrimMonad m =&gt; Gen (PrimState m) -&gt; m Seed\nrestore :: PrimMonad m =&gt; Seed -&gt; m (Gen (PrimState m))\n</code></pre>\n\n<p>We can use these to make a computation that generates a stream of values from a computation that generates a single value, as long as the generator is in <code>forall s. ST s</code>.</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n\nimport System.Random.MWC\nimport Control.Monad.ST\nimport System.Random.MWC.Distributions\n\nrandomStream :: forall s a. (forall s. GenST s -&gt; ST s a) -&gt; GenST s -&gt; ST s [a]\nrandomStream item = go\n    where\n        go :: forall s. GenST s -&gt; ST s [a]\n        go gen = do\n            x &lt;- item gen\n            seed &lt;- save gen\n            return (x:runST (restore seed &gt;&gt;= go))\n</code></pre>\n\n<p>With this we can write your example as</p>\n\n<pre><code>main = do\n    bits &lt;- withSystemRandom (randomStream (bernoulli 0.25))\n    print . take 32 $ bits\n</code></pre>\n\n<p>We can actually build generators more sophisticated than using the same generator for each item in the stream. We could thread a state along the stream so that each value can depend on the results of the previous ones.</p>\n\n<pre><code>unfoldStream :: forall s a b. (forall s. b -&gt; GenST s -&gt; ST s (a, b)) -&gt; b -&gt; GenST s -&gt; ST s [a]\nunfoldStream item = go\n    where\n        go :: forall s. b -&gt; GenST s -&gt; ST s [a]\n        go b gen = do\n            (x,b') &lt;- item b gen\n            seed &lt;- save gen\n            return (x:runST (restore seed &gt;&gt;= go b'))\n</code></pre>\n\n<p>The following example stream has results that increase in likelihood every time the result is <code>False</code>.</p>\n\n<pre><code>import Control.Monad.Primitive\n\ninteresting :: (PrimMonad m) =&gt; Double -&gt; Gen (PrimState m) -&gt; m (Bool, Double)\ninteresting p gen = do\n    result &lt;- bernoulli p gen\n    let p' = if result then p else p + (1-p)*0.25\n    return (result, p')\n\nmain = do\n    bits &lt;- withSystemRandom (unfoldStream interesting 0)\n    print . take 32 $ bits\n</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 478658, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/357dd2bc31ed5785c639b641415c3db5?s=128&d=identicon&r=PG", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/478658/sebastian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 1, "accepted_answer_id": 29024745, "answer_count": 2, "score": 1, "last_activity_date": 1426221131, "creation_date": 1426209628, "question_id": 29023263, "link": "https://stackoverflow.com/questions/29023263/haskell-infinite-list-of-bernoulli-distributed-booleans", "title": "Haskell infinite list of Bernoulli distributed booleans", "body": "<p>I need an list of biased, random booleans. Each boolean needs to have the same probability of being True (Bernoulli distributed). These booleans are passed to a function, which generates zero or more output booleans per input boolean. I need an infinite list, because I don't know in advance how many booleans are required to provide enough output. See the below (simplified) code:</p>\n\n<pre><code>import System.Random.MWC\nimport System.Random.MWC.Distributions\n\nfoo :: [Bool] -&gt; [Bool] -- foo outputs zero or more Bools per input Bool\n\nmain = do\n  gen &lt;- create\n  bits &lt;- sequence . repeat $ bernoulli 0.25 gen\n  print . take 32 . foo $ bits\n</code></pre>\n\n<p>Unfortunately, this code just hangs at the second line of <code>main</code>. I guess that there is something non-lazy happening somewhere with <code>Control.Monad.ST</code>?</p>\n\n<p>(I would be able to do something like this with <code>System.Random.randoms</code>, but the resulting values don't have the required distributions.)</p>\n\n<p>Can I fix this while keep using the <code>System.Random.MWC</code> library? Or does this require me to switch to alternative implementations?</p>\n"}, {"tags": ["haskell", "web", "websocket", "real-time", "haskell-platform"], "answers": [{"tags": [], "owner": {"reputation": 206, "user_id": 3943027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b609c6568ccf94f887297f33ebc9f62?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre R", "link": "https://stackoverflow.com/users/3943027/pierre-r"}, "is_accepted": false, "score": 2, "last_activity_date": 1426254334, "last_edit_date": 1426254334, "creation_date": 1426253691, "answer_id": 29033616, "question_id": 29022372, "link": "https://stackoverflow.com/questions/29022372/running-websockets-haskell-example/29033616#29033616", "title": "Running websockets Haskell example", "body": "<p>If you have a look at the example folder:</p>\n\n<p><a href=\"https://github.com/jaspervdj/websockets/blob/master/example/client.hs\" rel=\"nofollow\">https://github.com/jaspervdj/websockets/blob/master/example/client.hs</a></p>\n\n<blockquote>\n  <p>main = withSocketsDo $ WS.runClient \"echo.websocket.org\"\n  80 \"/\" app</p>\n</blockquote>\n\n<p>app is of type <code>app :: WS.ClientApp ()</code> which is a synonym for <code>Connection -&gt; IO a</code></p>\n\n<p><code>runClient</code> will open the socket connection for you. If you want to know how, take a look at the source of the function (<a href=\"https://hackage.haskell.org/package/websockets-0.9.3.0/docs/src/Network-WebSockets-Client.html#runClient\" rel=\"nofollow\">https://hackage.haskell.org/package/websockets-0.9.3.0/docs/src/Network-WebSockets-Client.html#runClient</a>).</p>\n\n<p>As an aside, <code>withSocketDo</code> belongs to <code>socket</code>. You will find the explanation here: <a href=\"https://hackage.haskell.org/package/network-2.6.0.2/docs/Network-Socket.html#v:withSocketsDo\" rel=\"nofollow\">https://hackage.haskell.org/package/network-2.6.0.2/docs/Network-Socket.html#v:withSocketsDo</a></p>\n\n<p>There are other examples here: <a href=\"http://jaspervdj.be/websockets/example.html\" rel=\"nofollow\">http://jaspervdj.be/websockets/example.html</a></p>\n\n<p>I haven't used <code>websocket</code> and it is usually not such a good idea to answer unfamiliar topic. Hope to be of some help.</p>\n"}], "owner": {"reputation": 1477, "user_id": 946299, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ce94c7b4c3cdbb7aed488d74aef770bb?s=128&d=identicon&r=PG", "display_name": "php--", "link": "https://stackoverflow.com/users/946299/php"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 554, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1426254334, "creation_date": 1426203585, "question_id": 29022372, "link": "https://stackoverflow.com/questions/29022372/running-websockets-haskell-example", "title": "Running websockets Haskell example", "body": "<p>Running websockets Haskell example, show below, obviously does not work since there is no main function.</p>\n\n<p>running ghc --make Main.hs -o Main confirms that</p>\n\n<p>Meow function requires websockets connection. How to open the connection?</p>\n\n<p>The library used is <a href=\"https://github.com/jaspervdj/websockets\" rel=\"nofollow\">https://github.com/jaspervdj/websockets</a>.</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport           Control.Monad      (forever)\nimport qualified Data.Text          as T\nimport qualified Network.WebSockets as WS\n\nmeow :: WS.Connection -&gt; IO ()\nmeow conn = forever $ do\n    msg &lt;- WS.receiveData conn\n    WS.sendTextData conn $ msg `T.append` \", meow\"\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426197111, "post_id": 29020412, "comment_id": 46285229, "body": "You might want to avoid <code>printf</code>. It&#39;s pretty weird."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1426197432, "post_id": 29020412, "comment_id": 46285383, "body": "But if you want to use it, you should probably use it for the whole string: <code>putStrLn $ printf &quot;The average ... films of %s is: %.2f&quot; actor (countAveFans actor testDatabase)</code>"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426202150, "post_id": 29020412, "comment_id": 46287288, "body": "@dfeuer If you&#39;re using it for the whole string, note that <code>printf ...</code> can also be used as an <code>IO</code> action, so you don&#39;t need the <code>putStrLn</code>. (Although you then need an extra <code>\\n</code>.) However, I suspect using it on the whole string is actually less efficient, because it then needs to parse at runtime the parts of the string that don&#39;t contain <code>%</code>s..."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1426202703, "post_id": 29020412, "comment_id": 46287455, "body": "Also, if you <i>do</i> try to avoid <code>printf</code> here, the function you want to use instead is probably <code>showFFloat</code> from the <code>Numeric</code> module. Note that it&#39;s a <code>ShowS</code> function so it has a last argument that is a string to prepend to."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1426203213, "post_id": 29020412, "comment_id": 46287631, "body": "@&#216;rjanJohansen, <code>printf</code> is more a type system magic trick than a practical function, as far as I can tell. If you&#39;re going to do silly tricks, you might as well go all the way, right? I didn&#39;t realize it could also be <code>IO()</code>; that&#39;s pretty funny."}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 0, "creation_date": 1426227538, "post_id": 29020412, "comment_id": 46294062, "body": "I&#39;m not sure what&#39;s so weird about <code>printf</code>, I use it all the time."}], "answers": [{"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 7, "last_activity_date": 1426195782, "creation_date": 1426195782, "answer_id": 29020564, "question_id": 29020412, "link": "https://stackoverflow.com/questions/29020412/not-compiling-printf-in-haskell/29020564#29020564", "title": "Not compiling printf in haskell", "body": "<p>You need to supply a <code>RealFloat</code> instead of a <code>String</code> to <code>printf</code> so remove the call to <code>show</code>:</p>\n\n<pre><code>putStrLn $ \"The average number of fans for the films of \" ++ actor ++ \" is : \" ++ (printf \"%.2f\\n\" $ countAveFans actor testDatabase)\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 4656096, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aMsj5.jpg?s=128&g=1", "display_name": "Tasos Barlas", "link": "https://stackoverflow.com/users/4656096/tasos-barlas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1426197901, "creation_date": 1426195271, "last_edit_date": 1426197901, "question_id": 29020412, "link": "https://stackoverflow.com/questions/29020412/not-compiling-printf-in-haskell", "title": "Not compiling printf in haskell", "body": "<p>guys please tell me why this is not compiling</p>\n\n<pre><code>putStrLn(\"The average number of fans for the films of \" ++ actor ++ \" is : \" ++ printf \"%.2f\\n\" (show(countAveFans actor testDatabase))\n</code></pre>\n\n<p>Its to simple but i cant think why it doesnt work.I try to convert the whole thing to string and take the 2 decimal point print out.Thanks</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1426190154, "post_id": 29018924, "comment_id": 46281989, "body": "<code>var</code> is a function, how would you propose you &quot;loop through&quot; a function?  Are you wanting to inspect the function&#39;s definition?  Code reflection isn&#39;t really the norm in Haskell and isn&#39;t particularly easy.  However, you could write a <code>data MyType</code> with fields representing the number of times <code>concat</code> and <code>single</code> are called, then in the definitions of those two functions just increment the respective field by 1."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1426190183, "post_id": 29018924, "comment_id": 46282003, "body": "Alternatively you could make an ADT to represent the structure, interpreting it later: <code>data Expr = Lit MyType | Concat Expr Expr | Single Char</code>.  Then you can inspect the structure to count the number of times <code>Concat</code> is used."}, {"owner": {"reputation": 1125, "user_id": 777085, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5112855aef89ec6bf599252fbae5eca7?s=128&d=identicon&r=PG", "display_name": "xcoder", "link": "https://stackoverflow.com/users/777085/xcoder"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1426190296, "post_id": 29018924, "comment_id": 46282056, "body": "@bheklilr Thanks for the comment. I know using ADT works, as I have tried it. I am just wondering a similar trick can be applied if I use a custom type instead."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1426190375, "post_id": 29018924, "comment_id": 46282095, "body": "You can&#39;t do it with <code>type MyType = String -&gt; Bool</code>.  There just aren&#39;t really ways to inspect a function&#39;s definition.  Your type and your functions have to handle this action explicitly."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1426204426, "post_id": 29018924, "comment_id": 46288025, "body": "i wonder if you might enjoy a logic language. Haskell is only good at solving a very limited class of equations\u2014it pretty much expects you to tell it how to do its job, aside from some of the crazier type system shenanigans."}], "answers": [{"comments": [{"owner": {"reputation": 1125, "user_id": 777085, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5112855aef89ec6bf599252fbae5eca7?s=128&d=identicon&r=PG", "display_name": "xcoder", "link": "https://stackoverflow.com/users/777085/xcoder"}, "edited": false, "score": 0, "creation_date": 1426190869, "post_id": 29019050, "comment_id": 46282328, "body": "Thanks for your reply. If this cannot be done, how can I possibly achieved what I want as described in the EDIT?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 1125, "user_id": 777085, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5112855aef89ec6bf599252fbae5eca7?s=128&d=identicon&r=PG", "display_name": "xcoder", "link": "https://stackoverflow.com/users/777085/xcoder"}, "edited": false, "score": 1, "creation_date": 1426191557, "post_id": 29019050, "comment_id": 46282689, "body": "@xcoder that&#39;s easy. Make a function that makes a string from that, like this: <code>toStr :: MyType -&gt; String; toStr (Single a) = [a]; toStr (Concat a b) = toStr a ++ toStr b</code>. Then just compare the string with it!"}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 5, "last_activity_date": 1426190016, "creation_date": 1426190016, "answer_id": 29019050, "question_id": 29018924, "link": "https://stackoverflow.com/questions/29018924/haskell-loop-through-a-custom-type/29019050#29019050", "title": "Haskell loop through a custom type", "body": "<p>No, there is not.</p>\n\n<p><code>var</code> has the type <code>MyType = String -&gt; Bool</code>, so it is a function. The only thing you can do with a function is to call it. Calling <code>var</code> will either result in <code>true</code> or <code>false</code> because its result type is <code>Bool</code>. So that is not enough to encode the information you want.</p>\n"}], "owner": {"reputation": 1125, "user_id": 777085, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5112855aef89ec6bf599252fbae5eca7?s=128&d=identicon&r=PG", "display_name": "xcoder", "link": "https://stackoverflow.com/users/777085/xcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "accepted_answer_id": 29019050, "answer_count": 1, "score": 0, "last_activity_date": 1426195137, "creation_date": 1426189533, "last_edit_date": 1426195137, "question_id": 29018924, "link": "https://stackoverflow.com/questions/29018924/haskell-loop-through-a-custom-type", "title": "Haskell loop through a custom type", "body": "<p>If I have the following custom type:</p>\n\n<pre><code>type MyType = String -&gt; Bool\nsingle :: Char -&gt; MyType\nconcat :: MyType -&gt; MyType -&gt; MyType\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>var :: MyType\nvar = concat (concat (single 'A') (single 'B')) (single 'C')\n</code></pre>\n\n<p>Is it possible to loop through var and see how many times concat and single are called?</p>\n"}]