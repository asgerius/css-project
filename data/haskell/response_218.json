[{"tags": ["haskell", "filter"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 6, "creation_date": 1552520057, "post_id": 55152711, "comment_id": 97045785, "body": "sounds like <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Char.html#v:isDigit\" rel=\"nofollow noreferrer\">isDigit</a> might be helpful..."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 6, "creation_date": 1552520131, "post_id": 55152711, "comment_id": 97045810, "body": "although <code>[&#39;0&#39;..&#39;9&#39;]</code> works fine for this purpose, or even the &quot;longhand&quot; form <code>&quot;0123456789&quot;</code>"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 9, "creation_date": 1552520365, "post_id": 55152711, "comment_id": 97045875, "body": "Can you clarify what you want? There are only 10 digits (&#39;0&#39; to &#39;9&#39;). Anything bigger than that is not a single character anymore. It doesn&#39;t really make sense to talk about the &#39;range of natural numbers as characters&#39;."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1552520564, "post_id": 55152711, "comment_id": 97045916, "body": "Please give a full nontrivial test case, what you would want the output to be, and what it currently is instead."}, {"owner": {"reputation": 165, "user_id": 11132350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7c35f00a0f054f012c8ccfd98a6490a?s=128&d=identicon&r=PG&f=1", "display_name": "Mandy", "link": "https://stackoverflow.com/users/11132350/mandy"}, "edited": false, "score": 0, "creation_date": 1552521227, "post_id": 55152711, "comment_id": 97046074, "body": "Id like to account for all natural numbers, including 0"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1552521722, "post_id": 55152711, "comment_id": 97046204, "body": "but you&#39;re dealing with them as characters within a string, and <i>as strings</i> (assuming decimal notation) all natural numbers are combinations of the 10 characters <code>&#39;0&#39;</code> through <code>&#39;9&#39;</code>. That&#39;s why any of the things I suggested in my first 2 comments should work. Please let me know if I&#39;ve misunderstood and you don&#39;t just want to filter out all digits."}, {"owner": {"reputation": 165, "user_id": 11132350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7c35f00a0f054f012c8ccfd98a6490a?s=128&d=identicon&r=PG&f=1", "display_name": "Mandy", "link": "https://stackoverflow.com/users/11132350/mandy"}, "edited": false, "score": 0, "creation_date": 1552522567, "post_id": 55152711, "comment_id": 97046423, "body": "isDigit works for me. thx everyone. I do check for &#39;0&#39; to &#39;9&#39; indeed"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1552542762, "post_id": 55152711, "comment_id": 97051165, "body": "@Mandy If you&#39;ve found an answer, can you write up a self-answer and accept it? That way this question won&#39;t be listed as unanswered any more."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1552569314, "post_id": 55152711, "comment_id": 97065943, "body": "<code>ord &#39;a&#39;</code> produces <code>97</code>, does that help you? <code>chr 97</code> gives <code>&#39;a&#39;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": true, "score": 4, "last_activity_date": 1552550529, "creation_date": 1552550529, "answer_id": 55157548, "question_id": 55152711, "link": "https://stackoverflow.com/questions/55152711/how-to-define-range-of-natural-numbers-as-chars-in-haskell/55157548#55157548", "title": "How to define range of natural numbers as chars in Haskell?", "body": "<p>As in the comments there are some ways:</p>\n\n<p>Succession of natural numbers as <code>chars</code>. Well as char only numbers from <code>0</code> to <code>9</code> can be encoded:</p>\n\n<pre><code>naturalN :: [Char]\nnaturalN = ['0'..'9']\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>['0'..'9']\n\n=&gt; \"0123456789\"\n</code></pre>\n\n<p>As far as a succesion of <strong>all</strong> natural numbers, that cannot be encoded as chars, but as strings. For example:</p>\n\n<pre><code>naturalN :: [String]\nnaturalN = map show [0..]\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>take 20 naturalN\n=&gt; [\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\"]\n</code></pre>\n\n<p>The problem with this approach is that you cannot check for <code>elem</code> or <code>notElem</code> because it will never finish to compute if in case the condition is not satisfied since it is an infinite list. You will have to actually use a limit of what you are searching.</p>\n\n<p>Then the problem is how you try to attempt to filter the string, which is ok if you use the first list approach:</p>\n\n<pre><code>filter (\\x -&gt; x `elem` ['0'..'9']) \"a 1 255 d e 6 g h\"\n=&gt; \"12556\"\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>filter isDigit \"a 1 255 d e 6 g h\"\n=&gt; \"12556\"\n</code></pre>\n\n<p>In case you want the oposite, which is take off the numbers of the string:</p>\n\n<pre><code>filter (not.isDigit) \"a 1 255 d e 6 g h\"\n=&gt; \"a   d e  g h\"\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 11132350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7c35f00a0f054f012c8ccfd98a6490a?s=128&d=identicon&r=PG&f=1", "display_name": "Mandy", "link": "https://stackoverflow.com/users/11132350/mandy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 55157548, "answer_count": 1, "score": 1, "last_activity_date": 1552550529, "creation_date": 1552519927, "question_id": 55152711, "link": "https://stackoverflow.com/questions/55152711/how-to-define-range-of-natural-numbers-as-chars-in-haskell", "title": "How to define range of natural numbers as chars in Haskell?", "body": "<p>I tried:</p>\n\n<pre><code>['1','2',..]\n</code></pre>\n\n<p>but this takes into account other characters also.\nI could do [1,2..] , But for my application I need to check the following:</p>\n\n<pre><code>  filter (\\x -&gt; x `notElem` ['0','1'..]) \"a 1 255 d e 6 g h\" \n</code></pre>\n\n<p>Which attempts to filter out all elements including spaces that are not natural numbers, in this case 'chars'.</p>\n"}, {"tags": ["haskell", "fold"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1552516621, "post_id": 55152140, "comment_id": 97044831, "body": "<code>op x w</code> should be the same as the definition of <code>f (x:xs)</code>, except you need to use <code>w</code> instead of the recursive call <code>f xs</code>."}], "answers": [{"tags": [], "owner": {"reputation": 479, "user_id": 1050182, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/bfgX0.jpg?s=128&g=1", "display_name": "Yuan Wang", "link": "https://stackoverflow.com/users/1050182/yuan-wang"}, "is_accepted": false, "score": 2, "last_activity_date": 1552520445, "creation_date": 1552520445, "answer_id": 55152775, "question_id": 55152140, "link": "https://stackoverflow.com/questions/55152140/write-haskell-function-using-foldr/55152775#55152775", "title": "Write haskell function using foldr", "body": "<p>How about </p>\n\n<p><code>\nf = fst . foldr (\\ x (xs', y) -> if y &amp;&amp; x == 0 then (xs', x==0) else (x:xs', x==0 )) ([], True)\n</code></p>\n\n<p>in this case, <code>op</code> returns a tuple of list and Bool, Bool is for tracking whether the accumulated list started with 0. At the end, we use <code>fst</code> to discard the Bool. We have to use <code>([], True)</code> as the initial value, to handle the trailing zero case. </p>\n"}], "owner": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1552520445, "creation_date": 1552516264, "question_id": 55152140, "link": "https://stackoverflow.com/questions/55152140/write-haskell-function-using-foldr", "title": "Write haskell function using foldr", "body": "<p>I have the following function and should write it with <code>foldr</code>.</p>\n\n<pre><code>f [] = []\nf (x:xs)\n  | x == 0 = case f xs of\n               [] -&gt; []\n               ys@(y:_) -&gt; if y == 0 then ys else x : ys\n  | otherwise = x : f xs\n</code></pre>\n\n<p>This function basically removes all trailing <code>0's</code>, but keeps at most one leading 0.</p>\n\n<p>For example:</p>\n\n<pre><code>f [1,2,0,0] = [1,2]\n\nf [1,2,0,1] = [1,2,0,1]\n\nf [0,0,1,0,0,3] = [0,1,0,3]\n</code></pre>\n\n<p>I have <code>foldr op z lst</code>, but don't know what <code>op</code> can be. <code>z</code> should be <code>[]</code>.</p>\n\n<p>Example I traced:</p>\n\n<pre><code>foldr op [] [0,0,1,0,0,3]\n\n-&gt; 0 op (0 op (1 op (0 op (0 op (3 op []))))\n\n                                |-- [3] ---|\n                           |---[0,3] ------|\n                     |-----[0,3]-----------|\n               |-----[1,0,3]---------------|\n         |-----[0,1,0,3]-------------------|\n   |-----[0,1,0,3]-------------------------|\n</code></pre>\n"}, {"tags": ["haskell", "existential-type"], "comments": [{"owner": {"reputation": 4431, "user_id": 23106, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BYY6E.png?s=128&g=1", "display_name": "Colin Barrett", "link": "https://stackoverflow.com/users/23106/colin-barrett"}, "edited": false, "score": 2, "creation_date": 1552514829, "post_id": 55151743, "comment_id": 97044202, "body": "<code>(exists a. Show a =&gt; a)</code> can always be rewritten as something like <code>forall c. Show b =&gt; (forall a. Show a =&gt; a -&gt; c) -&gt; b -&gt; c.</code> This is similar to the connection in logic between existential quantification and universal quantification."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 4431, "user_id": 23106, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BYY6E.png?s=128&g=1", "display_name": "Colin Barrett", "link": "https://stackoverflow.com/users/23106/colin-barrett"}, "edited": false, "score": 1, "creation_date": 1552528571, "post_id": 55151743, "comment_id": 97047860, "body": "@ColinBarrett Did you really mean the <code>b</code> stuff to be there, and not just, say, <code>forall c. (forall a. Show a =&gt; a -&gt; c) -&gt; c</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 1915, "user_id": 2682729, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PZlkg.gif?s=128&g=1", "display_name": "typesanitizer", "link": "https://stackoverflow.com/users/2682729/typesanitizer"}, "is_accepted": true, "score": 4, "last_activity_date": 1552515829, "creation_date": 1552515829, "answer_id": 55152065, "question_id": 55151743, "link": "https://stackoverflow.com/questions/55151743/existential-quantification-without-data-constructors/55152065#55152065", "title": "Existential quantification without data constructors", "body": "<p>Borrowing from Colin's comment and looking at this <a href=\"https://stackoverflow.com/a/10753957/2682729\">answer</a>, it is possible to write a CPS-ed version of the same code without an <code>exists</code> quantifier.</p>\n\n<pre><code>f' :: Int -&gt; ((forall a. Show a =&gt; a -&gt; r) -&gt; r)\nf' x = case x of\n  0 -&gt; \\k -&gt; k 0\n  _ -&gt; \\k -&gt; k \"non-zero\"\n</code></pre>\n\n<p>While this is not ideal, it certainly solves the problem without introducing extra data types.</p>\n"}], "owner": {"reputation": 1915, "user_id": 2682729, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PZlkg.gif?s=128&g=1", "display_name": "typesanitizer", "link": "https://stackoverflow.com/users/2682729/typesanitizer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 55152065, "answer_count": 1, "score": 1, "last_activity_date": 1552515829, "creation_date": 1552513931, "question_id": 55151743, "link": "https://stackoverflow.com/questions/55151743/existential-quantification-without-data-constructors", "title": "Existential quantification without data constructors", "body": "<p>It is easy to get existential quantification by packing dictionaries in data constructors.</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n\ndata S where\n  MkS :: Show a =&gt; a -&gt; S\n\nf :: Int -&gt; S\nf x = case x of\n  0 -&gt; MkS 0\n  _ -&gt; MkS \"non-zero\"\n</code></pre>\n\n<p>The relevant <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#existentially-quantified-data-constructors\" rel=\"nofollow noreferrer\">section</a> in the GHC guide explicitly talks about \"Existentially quantified data constructors\". Is it possible to write the same code but without introducing extra data types and constructors, i.e., something with a signature like</p>\n\n<pre><code>f :: Int -&gt; (exists a. Show a =&gt; a)\nf x = case x of\n  0 -&gt; 0\n  _ -&gt; \"non-zero\"\n</code></pre>\n\n<p>If not, is there a documented reason for why this limitation exists? Avoiding adding a new quantifier?</p>\n"}, {"tags": ["haskell", "time-complexity", "prime-factoring"], "comments": [{"owner": {"reputation": 2966, "user_id": 3014199, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/72332b0ac6ee78bc829c378c6c747e0e?s=128&d=identicon&r=PG", "display_name": "peer", "link": "https://stackoverflow.com/users/3014199/peer"}, "edited": false, "score": 0, "creation_date": 1552512343, "post_id": 55151393, "comment_id": 97043207, "body": "What algorithm do you want to use for that?"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 4, "creation_date": 1552512917, "post_id": 55151393, "comment_id": 97043478, "body": "I&#39;d approach this in Haskell by first generating an infinite list of primes. Then search over this list until you get to the appropriate place, and take the next three primes from the list."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 9212927, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LdGFsqm8ygw/AAAAAAAAAAI/AAAAAAAAAOI/N3VzKbD7PQM/photo.jpg?sz=128", "display_name": "omonimus2016", "link": "https://stackoverflow.com/users/9212927/omonimus2016"}, "edited": false, "score": 0, "creation_date": 1552906172, "post_id": 55186633, "comment_id": 97174190, "body": "that&#39;s amazing, thanks so much, appreciate it @oo_miguel"}, {"owner": {"reputation": 2284, "user_id": 2430189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FQ4Pq.png?s=128&g=1", "display_name": "oo_miguel", "link": "https://stackoverflow.com/users/2430189/oo-miguel"}, "reply_to_user": {"reputation": 7, "user_id": 9212927, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LdGFsqm8ygw/AAAAAAAAAAI/AAAAAAAAAOI/N3VzKbD7PQM/photo.jpg?sz=128", "display_name": "omonimus2016", "link": "https://stackoverflow.com/users/9212927/omonimus2016"}, "edited": false, "score": 0, "creation_date": 1552919565, "post_id": 55186633, "comment_id": 97182259, "body": "@DavidePollcino: Glad to help. So you can accept and vote up this answer now :)"}, {"owner": {"reputation": 7, "user_id": 9212927, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LdGFsqm8ygw/AAAAAAAAAAI/AAAAAAAAAOI/N3VzKbD7PQM/photo.jpg?sz=128", "display_name": "omonimus2016", "link": "https://stackoverflow.com/users/9212927/omonimus2016"}, "edited": false, "score": 0, "creation_date": 1552933928, "post_id": 55186633, "comment_id": 97190403, "body": "Thanks for the feedback! Votes cast by those with less than 15 reputation are recorded, but do not change the publicly displayed post score."}, {"owner": {"reputation": 2284, "user_id": 2430189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FQ4Pq.png?s=128&g=1", "display_name": "oo_miguel", "link": "https://stackoverflow.com/users/2430189/oo-miguel"}, "reply_to_user": {"reputation": 7, "user_id": 9212927, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LdGFsqm8ygw/AAAAAAAAAAI/AAAAAAAAAOI/N3VzKbD7PQM/photo.jpg?sz=128", "display_name": "omonimus2016", "link": "https://stackoverflow.com/users/9212927/omonimus2016"}, "edited": false, "score": 0, "creation_date": 1552942694, "post_id": 55186633, "comment_id": 97194307, "body": "Oh, I was not aware of that."}], "tags": [], "owner": {"reputation": 2284, "user_id": 2430189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FQ4Pq.png?s=128&g=1", "display_name": "oo_miguel", "link": "https://stackoverflow.com/users/2430189/oo-miguel"}, "is_accepted": false, "score": 0, "last_activity_date": 1552666696, "last_edit_date": 1552666696, "creation_date": 1552666201, "answer_id": 55186633, "question_id": 55151393, "link": "https://stackoverflow.com/questions/55151393/calculate-next-3-prime-numbers-given-an-int-in-haskell/55186633#55186633", "title": "Calculate next 3 prime numbers given an int in Haskell", "body": "<p>sorry... but I could not resist... </p>\n\n<pre><code>nextPrimes :: Int -&gt; [Int]\nnextPrimes n = let sq    = fromIntegral . ceiling . sqrt $ fromIntegral n\n                   pri k = (k,and [ k`mod`x/=0 | x &lt;- [2..sq]])\n               in  take 3 . map fst . filter snd $ map pri [n..]\n</code></pre>\n\n<p>This works almost instantly, even when we have to count up all the way until <em>sqrt n</em>:</p>\n\n<pre><code>\u03bb&gt; nextPrimes 295084709089\n[295084709159,295084709209,295084709273]\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 9212927, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LdGFsqm8ygw/AAAAAAAAAAI/AAAAAAAAAOI/N3VzKbD7PQM/photo.jpg?sz=128", "display_name": "omonimus2016", "link": "https://stackoverflow.com/users/9212927/omonimus2016"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1554931613, "creation_date": 1552512068, "question_id": 55151393, "link": "https://stackoverflow.com/questions/55151393/calculate-next-3-prime-numbers-given-an-int-in-haskell", "title": "Calculate next 3 prime numbers given an int in Haskell", "body": "<p>I am trying to write a function in Haskell that allows me to calculate the next 3 prime numbers, given a Intenger N and store the three prime numbers in a sorted list. </p>\n\n<p>The challenge is to do it without import any external module. </p>\n\n<p>Behavior of the function:</p>\n\n<p>*nextPrimes 75 = [79,83,89] </p>\n\n<p>*nextPrimes 64 = [67,71,73]</p>\n\n<p>it should calculate the next 3 prime numbers of an N with 10-digit numbers in less than 2 minutes.</p>\n\n<p><code>nextPrimes :: Int -&gt; [Int]\nnextPrimes n</code></p>\n"}, {"tags": ["string", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 8, "last_activity_date": 1552503187, "last_edit_date": 1552503187, "creation_date": 1552502535, "answer_id": 55149176, "question_id": 55149045, "link": "https://stackoverflow.com/questions/55149045/how-to-convert-string-to-tuple-using-reads/55149176#55149176", "title": "How to convert string to tuple using `reads`?", "body": "<p>You have to account for the trailing <code>String</code> which <code>reads</code> always produces.</p>\n\n<pre><code>&gt; reads \"(1,2)\" :: [((Integer,Integer),String)]\n[((1,2),\"\")]\n</code></pre>\n\n<p>If you only want a single pair and are absolutely certain that the string parses correctly, use <code>read</code> instead</p>\n\n<pre><code>&gt; read \"(1,2)\" :: (Integer,Integer)\n(1,2)\n</code></pre>\n\n<p>Note that <code>read</code> (unlike <code>reads</code>) will crash your program on an invalid string. If you can not assume the string parses correctly, but you still want a single pair, use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Text-Read.html#v:readMaybe\" rel=\"noreferrer\"><code>readMaybe</code></a> instead form <code>Text.Read</code>.</p>\n"}], "owner": {"reputation": 165, "user_id": 11132350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7c35f00a0f054f012c8ccfd98a6490a?s=128&d=identicon&r=PG&f=1", "display_name": "Mandy", "link": "https://stackoverflow.com/users/11132350/mandy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 55149176, "answer_count": 1, "score": 3, "last_activity_date": 1552561979, "creation_date": 1552502049, "last_edit_date": 1552561979, "question_id": 55149045, "link": "https://stackoverflow.com/questions/55149045/how-to-convert-string-to-tuple-using-reads", "title": "How to convert string to tuple using `reads`?", "body": "<p>In GHCi, I try to read string as tuple.</p>\n\n<pre><code>&gt;reads \"(1,2)\" :: [(Integer),(Integer)]\n</code></pre>\n\n<p>which outputs the error: </p>\n\n<blockquote>\n  <p>Couldn't match type [Char] with Integer<br>\n  expected type: [(Integer,Integer)]<br>\n  actual type: [(Integer,String)]</p>\n</blockquote>\n\n<p>The example I found online, and works is:</p>\n\n<pre><code>&gt;reads \"(34, True),abc\" :: [((Integer,Bool),String)]\n[((34,True),\",abc\")]\n</code></pre>\n\n<p>So why the one I try to create won't work?</p>\n"}, {"tags": ["haskell", "tree", "monads", "applicative", "free-monad"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1552509262, "post_id": 55148561, "comment_id": 97041830, "body": "It&#39;s trivial to prove that the identity, homomorphism, and interchange laws all hold. The composition law is tougher. After splitting it into cases, it looks like the toughest part will be proving that <code>liftA2 (&lt;*&gt;) (Free $ liftA2 (&lt;*&gt;) (fmap (fmap (.)) fu) fv) fw = liftA2 (&lt;*&gt;) fu (liftA2 (&lt;*&gt;) fv fw)</code>, where <code>fu</code>, <code>fv</code>, and <code>fw</code> are all of type <code>Applicative f =&gt; f (FreeMonad f a)</code>."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1552522902, "post_id": 55148561, "comment_id": 97046505, "body": "@JosephSible I\u2019ve been thinking about that some more. Since the RHS of the <code>Free</code>/<code>Free</code> case of <code>&lt;*&gt;</code> is identical to that of <code>Compose</code>\u2019s, the <code>Free</code>/<code>Free</code>/<code>Free</code> case of the composition law follows directly from the correctness of <code>Compose</code>\u2019s instance (and the induction hypothesis). If there\u2019s a bug, it\u2019ll be when one or more of the values is a <code>Return</code>, I think."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1552524817, "post_id": 55148561, "comment_id": 97046974, "body": "Though I didn&#39;t actually write down the proof, I believe the mixed-<code>Free</code>-and-<code>Return</code> cases of the composition law must hold due to parametricity. I also suspect that should be easier to show using <a href=\"http://blog.ezyang.com/2012/08/applicative-functors/\" rel=\"nofollow noreferrer\">the monoidal presentation</a>."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1552568243, "post_id": 55148561, "comment_id": 97065095, "body": "@duplode Seems to me that parametricity says that there\u2019s only one <i>type</i>-correct implementation of the <code>Return</code> cases (namely mapping over the other tree), but that doesn\u2019t necessarily imply that it\u2019s lawful. Unless there\u2019s a free theorem?"}], "answers": [{"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1552503197, "post_id": 55149227, "comment_id": 97039005, "body": "Sure, let&#39;s forget about <code>Monad</code> for now. Is the <code>Applicative</code> instance itself lawful?"}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1552503415, "post_id": 55149227, "comment_id": 97039107, "body": "Sure, it looks like it should satisfy the <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Applicative.html#t:Applicative\" rel=\"nofollow noreferrer\">identity, interchange, homomorphism and composition laws</a> to me, but it&#39;d probably be a good check to write the proofs out using equational reasoning"}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": false, "score": 3, "last_activity_date": 1552502758, "creation_date": 1552502758, "answer_id": 55149227, "question_id": 55148561, "link": "https://stackoverflow.com/questions/55148561/are-free-monads-also-zippily-applicative/55149227#55149227", "title": "Are free monads also zippily applicative?", "body": "<p>From the <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Applicative.html#t:Applicative\" rel=\"nofollow noreferrer\">definition of <code>Applicative</code></a>:</p>\n\n<blockquote>\n  <p>If <code>f</code> is also a <code>Monad</code>, it should satisfy</p>\n  \n  <ul>\n  <li><p><code>pure</code> = <code>return</code></p></li>\n  <li><p><code>(&lt;*&gt;)</code> = <code>ap</code></p></li>\n  <li><p><code>(*&gt;)</code> = <code>(&gt;&gt;)</code></p></li>\n  </ul>\n</blockquote>\n\n<p>So this implementation would break the applicative laws that say it <em>must</em> agree with the <code>Monad</code> instance.</p>\n\n<p>That said, there's no reason you couldn't have a newtype wrapper for <code>FreeMonad</code> that didn't have a monad instance, but did have the above applicative instance</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>newtype Zip f a = Zip { runZip :: FreeMonad f a }\n  deriving Functor\n\ninstance Applicative f =&gt; Applicative (Zip f) where -- ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 14, "last_activity_date": 1554489012, "last_edit_date": 1554489012, "creation_date": 1552517806, "answer_id": 55152385, "question_id": 55148561, "link": "https://stackoverflow.com/questions/55148561/are-free-monads-also-zippily-applicative/55152385#55152385", "title": "Are free monads also zippily applicative?", "body": "<p><strong>Yes</strong>, it looks like this is a lawful <code>Applicative</code>. Weird!</p>\n\n<p>As <a href=\"https://stackoverflow.com/questions/55148561/are-free-monads-also-zippily-applicative#comment97041830_55148561\">@JosephSible points out</a>, you can read off the <strong>identity</strong>, <strong>homomorphism</strong> and <strong>interchange</strong> laws immediately from the definitions. The only tricky one is the <strong>composition</strong> law.</p>\n\n<pre><code>pure (.) &lt;*&gt; u &lt;*&gt; v &lt;*&gt; w = u &lt;*&gt; (v &lt;*&gt; w)\n</code></pre>\n\n<p>There are eight cases to check, so strap in.</p>\n\n<ul>\n<li>One case with three <code>Return</code>s: <code>pure (.) &lt;*&gt; Return f &lt;*&gt; Return g &lt;*&gt; Return z</code>\n\n<ul>\n<li>Follows trivially from associativity of <code>(.)</code>.</li>\n</ul></li>\n<li>Three cases with one <code>Free</code>:\n\n<ul>\n<li><code>pure (.) &lt;*&gt; Free u &lt;*&gt; Return g &lt;*&gt; Return z</code>\n\n<ul>\n<li>Working backwards from <code>Free u &lt;*&gt; (Return g &lt;*&gt; Return z)</code> you get <code>fmap (\\f -&gt; f (g z)) (Free u)</code>, so this follows from the functor law.</li>\n</ul></li>\n<li><pre><code>pure (.) &lt;*&gt; Return f &lt;*&gt; Free v &lt;*&gt; Return z\nfmap ($z) $ fmap f (Free v)\nfmap (\\g -&gt; f (g z)) (Free v)                  -- functor law\nfmap (f . ($z)) (Free v)\nfmap f (fmap ($z) (Free v))                    -- functor law\nReturn f &lt;$&gt; (Free v &lt;*&gt; Return z)             -- RHS of `&lt;*&gt;` (first and second cases)\nQED\n</code></pre></li>\n<li><code>pure (.) &lt;*&gt; Return f &lt;*&gt; Return g &lt;*&gt; Free w</code>\n\n<ul>\n<li>Reduces immediately to <code>fmap (f . g) (Free w)</code>, so follows from the functor law.</li>\n</ul></li>\n</ul></li>\n<li>Three cases with one <code>Return</code>:\n\n<ul>\n<li><pre><code>pure (.) &lt;*&gt; Return f &lt;*&gt; Free v &lt;*&gt; Free w\nFree $ fmap (&lt;*&gt;) (fmap (fmap (f.)) v) &lt;*&gt; w\nFree $ fmap (\\y z -&gt; fmap (f.) y &lt;*&gt; z) v &lt;*&gt; w                  -- functor law\nFree $ fmap (\\y z -&gt; fmap (.) &lt;*&gt; Return f &lt;*&gt; y &lt;*&gt; z) v &lt;*&gt; w  -- definition of fmap, twice\nFree $ fmap (\\y z -&gt; Return f &lt;*&gt; (y &lt;*&gt; z)) v &lt;*&gt; w             -- composition\nFree $ fmap (\\y z -&gt; fmap f (y &lt;*&gt; z)) v &lt;*&gt; w                   -- RHS of fmap, definition of liftA2\nFree $ fmap (fmap f) $ fmap (&lt;*&gt;) v &lt;*&gt; w                        -- functor law, eta reduce\nfmap f $ Free $ liftA2 (&lt;*&gt;) v w                                 -- RHS of fmap\nReturn f &lt;*&gt; Free v &lt;*&gt; Free w                                   -- RHS of &lt;*&gt;\nQED.\n</code></pre></li>\n<li><pre><code>pure (.) &lt;*&gt; Free u &lt;*&gt; Return g &lt;*&gt; Free w\nFree ((fmap (fmap ($g))) (fmap (fmap (.)) u)) &lt;*&gt; Free w\nFree (fmap (fmap (\\f -&gt; f . g) u)) &lt;*&gt; Free w                    -- functor law, twice\nFree $ fmap (&lt;*&gt;) (fmap (fmap (\\f -&gt; f . g)) u) &lt;*&gt; w\nFree $ fmap (\\x z -&gt; fmap (\\f -&gt; f . g) x &lt;*&gt; z) u &lt;*&gt; w         -- functor law\nFree $ fmap (\\x z -&gt; pure (.) &lt;*&gt; x &lt;*&gt; Return g &lt;*&gt; z) u &lt;*&gt; w\nFree $ fmap (\\x z -&gt; x &lt;*&gt; (Return g &lt;*&gt; z)) u &lt;*&gt; w             -- composition\nFree $ fmap (&lt;*&gt;) u &lt;*&gt; fmap (Return g &lt;*&gt;) w                    -- https://gist.github.com/benjamin-hodgson/5b36259986055d32adea56d0a7fa688f\nFree u &lt;*&gt; fmap g w                                              -- RHS of &lt;*&gt; and fmap\nFree u &lt;*&gt; (Return g &lt;*&gt; w)\nQED.\n</code></pre></li>\n<li><pre><code>pure (.) &lt;*&gt; Free u &lt;*&gt; Free v &lt;*&gt; Return z\nFree (fmap (&lt;*&gt;) (fmap (fmap (.)) u) &lt;*&gt; v) &lt;*&gt; Return z\nFree (fmap (\\x y -&gt; fmap (.) x &lt;*&gt; y) u &lt;*&gt; v) &lt;*&gt; Return z        -- functor law\nFree $ fmap (fmap ($z)) (fmap (\\x y -&gt; fmap (.) x &lt;*&gt; y) u &lt;*&gt; v)\nFree $ liftA2 (\\x y -&gt; (fmap ($z)) (fmap (.) x &lt;*&gt; y)) u v         -- see Lemma, with f = fmap ($z) and g x y = fmap (.) x &lt;*&gt; y\nFree $ liftA2 (\\x y -&gt; fmap (.) x &lt;*&gt; y &lt;*&gt; Return z) u v          -- interchange\nFree $ liftA2 (\\x y -&gt; x &lt;*&gt; (y &lt;*&gt; Return z)) u v                 -- composition\nFree $ liftA2 (\\f g -&gt; f &lt;*&gt; fmap ($z) g) u v                      -- interchange\nFree $ fmap (&lt;*&gt;) u &lt;*&gt; (fmap (fmap ($z)) v)                       -- https://gist.github.com/benjamin-hodgson/5b36259986055d32adea56d0a7fa688f\nFree u &lt;*&gt; Free (fmap (fmap ($z)) v)\nFree u &lt;*&gt; (Free v &lt;*&gt; Return z)\nQED.\n</code></pre></li>\n</ul></li>\n<li>Three <code>Free</code>s: <code>pure (.) &lt;*&gt; Free u &lt;*&gt; Free v &lt;*&gt; Free w</code>\n\n<ul>\n<li>This case only exercises the <code>Free</code>/<code>Free</code> case of <code>&lt;*&gt;</code>, whose right-hand side is identical to that of <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Functor-Compose.html\" rel=\"nofollow noreferrer\"><code>Compose</code></a>'s <code>&lt;*&gt;</code>. So this one follows from the correctness of <code>Compose</code>'s instance.</li>\n</ul></li>\n</ul>\n\n<p>For the <code>pure (.) &lt;*&gt; Free u &lt;*&gt; Free v &lt;*&gt; Return z</code> case I used a lemma:</p>\n\n<p><strong>Lemma</strong>: <code>fmap f (fmap g u &lt;*&gt; v) = liftA2 (\\x y -&gt; f (g x y)) u v</code>.</p>\n\n<pre><code>fmap f (fmap g u &lt;*&gt; v)\npure (.) &lt;*&gt; pure f &lt;*&gt; fmap g u &lt;*&gt; v  -- composition\nfmap (f .) (fmap g u) &lt;*&gt; v             -- homomorphism\nfmap ((f .) . g) u &lt;*&gt; v                -- functor law\nliftA2 (\\x y -&gt; f (g x y)) u v          -- eta expand\nQED.\n</code></pre>\n\n<p>Variously I'm using functor and applicative laws under the induction hypothesis.</p>\n\n<p>This was pretty fun to prove! I'd love to see a formal proof in Coq or Agda (though I suspect the termination/positivity checker might mess it up).</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 4, "last_activity_date": 1552609967, "last_edit_date": 1552609967, "creation_date": 1552609587, "answer_id": 55173908, "question_id": 55148561, "link": "https://stackoverflow.com/questions/55148561/are-free-monads-also-zippily-applicative/55173908#55173908", "title": "Are free monads also zippily applicative?", "body": "<p>For the sake of completeness, I will use this answer to expand on <a href=\"https://stackoverflow.com/questions/55148561/are-free-monads-also-zippily-applicative/55152385#comment97046974_55148561\">my comment above</a>:</p>\n\n<blockquote>\n  <p>Though I didn't actually write down the proof, I believe the mixed-Free-and-Return cases of the composition law must hold due to parametricity. I also suspect that should be easier to show using <a href=\"http://blog.ezyang.com/2012/08/applicative-functors/\" rel=\"nofollow noreferrer\">the monoidal presentation</a>.</p>\n</blockquote>\n\n<p>The monoidal presentation of the <code>Applicative</code> instance here is:</p>\n\n<pre><code>unit = Return ()\n\nReturn x *&amp;* v = (x,) &lt;$&gt; v\nu *&amp;* Return y = (,y) &lt;$&gt; u\n-- I will also piggyback on the `Compose` applicative, as suggested above.\nFree u *&amp;* Free v = Free (getCompose (Compose u *&amp;* Compose v))\n</code></pre>\n\n<p>Under the monoidal presentation, the composition/associativity law is:</p>\n\n<pre><code>(u *&amp;* v) *&amp;* w ~ u *&amp;* (v *&amp;* w)\n</code></pre>\n\n<p>Now let's consider one of its mixed cases; say, the <code>Free</code>-<code>Return</code>-<code>Free</code> one:</p>\n\n<pre><code>(Free fu *&amp;* Return y) *&amp;* Free fw ~ Free fu *&amp;* (Return y *&amp;* Free fw)\n\n(Free fu *&amp;* Return y) *&amp;* Free fw -- LHS\n((,y) &lt;$&gt; Free fu) *&amp;* Free fw\n\nFree fu *&amp;* (Return y *&amp;* Free fw) -- RHS\nFree fu *&amp;* ((y,) &lt;$&gt; Free fw)\n</code></pre>\n\n<p>Let's have a closer look at this left-hand side. <code>(,y) &lt;$&gt; Free fu</code> applies <code>(,y) :: a -&gt; (a, b)</code> to the <code>a</code> values found in <code>Free fu :: FreeMonad f a</code>. Parametricity (or, more specifically, the free theorem for <code>(*&amp;*)</code>) means that it doesn't matter if we do that before or after using <code>(*&amp;*)</code>. That means the left-hand side amounts to:</p>\n\n<pre><code>first (,y) &lt;$&gt; (Free fu *&amp;* Free fw)\n</code></pre>\n\n<p>Analogously, the right-hand side becomes:</p>\n\n<pre><code>second (y,) &lt;$&gt; (Free fu *&amp;* Free fw)\n</code></pre>\n\n<p>Since <code>first (,y) :: (a, c) -&gt; ((a, b), c)</code> and <code>second (y,) :: (a, c) -&gt; (a, (b, c))</code> are the same up to reassociation of pairs, we have:</p>\n\n<pre><code>first (,y) &lt;$&gt; (Free fu *&amp;* Free fw) ~ second (y,) &lt;$&gt; (Free fu *&amp;* Free fw)\n-- LHS ~ RHS\n</code></pre>\n\n<p>The other mixed cases can be dealt with analogously. For the rest of the proof, see <a href=\"https://stackoverflow.com/a/55152385/2751851\">Benjamin Hodgson's answer</a>.</p>\n"}], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 719, "favorite_count": 5, "accepted_answer_id": 55152385, "answer_count": 3, "score": 24, "last_activity_date": 1554661739, "creation_date": 1552500298, "last_edit_date": 1554661739, "question_id": 55148561, "link": "https://stackoverflow.com/questions/55148561/are-free-monads-also-zippily-applicative", "title": "Are free monads also zippily applicative?", "body": "<p>I think I've come up with an interesting \"zippy\" <code>Applicative</code> instance for <a href=\"http://hackage.haskell.org/package/free-5.1/docs/Control-Monad-Free.html#t:Free\" rel=\"nofollow noreferrer\"><code>Free</code></a>.</p>\n\n<pre><code>data FreeMonad f a = Free (f (FreeMonad f a))\n                   | Return a\n\ninstance Functor f =&gt; Functor (FreeMonad f) where\n    fmap f (Return x) = Return (f x)\n    fmap f (Free xs) = Free (fmap (fmap f) xs)\n\ninstance Applicative f =&gt; Applicative (FreeMonad f) where\n    pure = Return\n\n    Return f &lt;*&gt; xs = fmap f xs\n    fs &lt;*&gt; Return x = fmap ($x) fs\n    Free fs &lt;*&gt; Free xs = Free $ liftA2 (&lt;*&gt;) fs xs\n</code></pre>\n\n<p>It's sort of a zip-longest strategy. For example, using <code>data Pair r = Pair r r</code> as the functor (so <code>FreeMonad Pair</code> is an externally labelled binary tree):</p>\n\n<pre><code>    +---+---+    +---+---+               +-----+-----+\n    |       |    |       |      &lt;*&gt;      |           |\n +--+--+    h    x   +--+--+    --&gt;   +--+--+     +--+--+\n |     |             |     |          |     |     |     |\n f     g             y     z         f x   g x   h y   h z\n</code></pre>\n\n<p>I haven't seen anyone mention this instance before. Does it break any <code>Applicative</code> laws? (It doesn't agree with the usual <code>Monad</code> instance of course, which is \"substitutey\" rather than \"zippy\".)</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9660393"}, "edited": false, "score": 1, "creation_date": 1552489960, "post_id": 55144200, "comment_id": 97031030, "body": "Thank you so much. I actually had something similar but used [] in the count declaration instead of ((a,b,c) : d)"}, {"owner": {"reputation": 590, "user_id": 6184960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9168edfb66b98995cae68f6b46d81ef?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Yellow", "link": "https://stackoverflow.com/users/6184960/mr-yellow"}, "edited": false, "score": 0, "creation_date": 1552633524, "post_id": 55144200, "comment_id": 97092520, "body": "You could have also used a generic <code>d</code> for the array and then use something like fst (first) to get the first  but then you would handle other things."}], "tags": [], "owner": {"reputation": 590, "user_id": 6184960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9168edfb66b98995cae68f6b46d81ef?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Yellow", "link": "https://stackoverflow.com/users/6184960/mr-yellow"}, "is_accepted": false, "score": 5, "last_activity_date": 1552487067, "creation_date": 1552487067, "answer_id": 55144200, "question_id": 55144121, "link": "https://stackoverflow.com/questions/55144121/haskell-non-exhaustive-patterns-in-recursive-listed-tuple-count/55144200#55144200", "title": "Haskell non-exhaustive patterns in recursive listed tuple count", "body": "<p>You are only handling the 2 cases where the list of tuples is either empty or has exactly one element (a,b,c). You must include a pattern where your list has more than 1 element. Such a pattern could be <code>count x ((a,b,c):d)</code></p>\n\n<p>In the end it should look something like this:</p>\n\n<pre><code>count :: Int -&gt; [(Int, Int, Int)] -&gt; Int \ncount x []         = 0\ncount x ((a,b,c):d)\n  | x == a              = 1 + (count x d)\n  | otherwise           = count x d\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": false, "score": 3, "last_activity_date": 1552487112, "creation_date": 1552487112, "answer_id": 55144213, "question_id": 55144121, "link": "https://stackoverflow.com/questions/55144121/haskell-non-exhaustive-patterns-in-recursive-listed-tuple-count/55144213#55144213", "title": "Haskell non-exhaustive patterns in recursive listed tuple count", "body": "<p>You're using the wrong pattern. <code>[(a,b,c)]</code> only matches a list consisting of exactly <em>one</em> 3-tuple. What I believe you meant is this:</p>\n\n<pre><code>count :: Int -&gt; [(Int, Int, Int)] -&gt; Int \ncount x []         = 0\ncount x ((a,b,c):xs)\n  | x == a              = 1 + (count x xs)\n  | otherwise           = count x xs\n</code></pre>\n\n<p>Here the <code>((a,b,c):xs)</code> pattern matches any non-empty list of 3-tuples, where the first one is <code>(a,b,c)</code>. This allows you to use recursion as intended - because <code>xs</code> stands for the rest of the list (minus that first 3-tuple).</p>\n\n<p>Note that you can clean this up a little bit by using underscores for the arguments you don't care about:</p>\n\n<pre><code>count :: Int -&gt; [(Int, Int, Int)] -&gt; Int \ncount _ []         = 0\ncount x ((a,_,_):xs)\n  | x == a              = 1 + (count x xs)\n  | otherwise           = count x xs\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9660393"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1552487178, "creation_date": 1552486826, "question_id": 55144121, "link": "https://stackoverflow.com/questions/55144121/haskell-non-exhaustive-patterns-in-recursive-listed-tuple-count", "title": "Haskell non-exhaustive patterns in recursive listed tuple count", "body": "<p>I'm trying to count the number of times x comes up in a listed tuple (of Ints). It's only the first Int in the tuple that needs to be located and counted so the other two Int tuples don't really matter. I'm trying a simple recursion count (so that it will add 1 until the list is empty and then it will add 0) but I get a non-exhaustive pattern and I don't understand what pattern is missing to cause it.</p>\n\n<pre><code>count :: Int -&gt; [(Int, Int, Int)] -&gt; Int \ncount x []         = 0\ncount x [(a,b,c)]\n  | x == a              = 1 + (count x [(a,b,c)])\n  | otherwise           = count x [(a,b,c)]\n</code></pre>\n"}, {"tags": ["haskell", "count", "counting"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 2, "creation_date": 1552487713, "post_id": 55143882, "comment_id": 97029357, "body": "How does immutability get in the way? Just use an immutable hash map."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1552492214, "post_id": 55143882, "comment_id": 97032577, "body": "The OP is probably asking how to write an O(n) implementation. Most immutable hash maps have o(1) lookup and insertion operations. (<code>Data.IntMap</code> comes close to O(1), as in practice you probably don&#39;t have arbitrarily large counts to deal with.)"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 7, "last_activity_date": 1552486441, "creation_date": 1552486441, "answer_id": 55143986, "question_id": 55143882, "link": "https://stackoverflow.com/questions/55143882/count-all-occurences-of-each-element-in-a-list/55143986#55143986", "title": "Count all occurences of each element in a list", "body": "<p><code>group . sort</code> will produce an output list such as</p>\n\n<pre><code>&gt; group . sort $ [1, 1, 2, 3, 1, 2, 4] \n[[1,1,1],[2,2],[3],[4]]\n</code></pre>\n\n<p>Hence,</p>\n\n<pre><code>&gt; map (head &amp;&amp;&amp; length) . group . sort $ [1, 1, 2, 3, 1, 2, 4] \n[(1,3),(2,2),(3,1),(4,1)]\n</code></pre>\n\n<p>So, we obtain</p>\n\n<pre><code>import Data.List (group, sort)\nimport Control.Arrow ((&amp;&amp;&amp;))\n\ncountOccurences :: Ord a =&gt; [a] -&gt; [(a, Int)]\ncountOccurences = map (head &amp;&amp;&amp; length) . group . sort\n</code></pre>\n\n<p>It should require only <code>O(n log n)</code> time.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1552492841, "post_id": 55145433, "comment_id": 97033077, "body": "or <code>histogram = foldl&#39; (\\m k -&gt; M.insertWith (+) k 1 m) M.empty</code>, to eliminate the need for <code>zip</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1552497448, "post_id": 55145433, "comment_id": 97035930, "body": "Or <code>Data.HashMap</code>, or <code>Data.IntMap</code>. Whichever you choose, use the strict operations: <code>import qualified Data.Map.Strict as M</code>."}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1552553379, "post_id": 55145433, "comment_id": 97055672, "body": "@dfeuer: Thanks, I&#39;ve updated it to <code>Data.Map.Strict</code>."}], "tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 5, "last_activity_date": 1552506699, "last_edit_date": 1552506699, "creation_date": 1552490501, "answer_id": 55145433, "question_id": 55143882, "link": "https://stackoverflow.com/questions/55143882/count-all-occurences-of-each-element-in-a-list/55145433#55145433", "title": "Count all occurences of each element in a list", "body": "<p>Since chi provided a solution using <code>group . sort</code>, here is one that uses <a href=\"https://hackage.haskell.org/package/containers-0.6.0.1/docs/Data-Map-Strict.html\" rel=\"nofollow noreferrer\"><code>Data.Map</code></a>:</p>\n\n<pre><code>import qualified Data.Map.Strict as M\nimport           Data.Map.Strict (Map)\n\nhistogram :: Ord a =&gt; [a] -&gt; Map a Int\nhistogram = M.fromListWith (+) . (`zip` [1,1..])\n</code></pre>\n\n<p>This also uses <em>O(n log n)</em> time.</p>\n\n<blockquote>\n  <p>I thought of using an associative list or some hash map, but immutability gets in the way</p>\n</blockquote>\n\n<p><code>Data.Map</code> is a tree-based associative map, so maybe this representation is for you.</p>\n\n<p>If you'd rather like an <code>[(a, Int)]</code>, <code>M.assocs</code> can convert the <code>Data.Map</code> back:</p>\n\n<pre><code>countOccurrences :: Ord a =&gt; [a] -&gt; [(a, Int)]\ncountOccurrences = M.assocs . histogram\n</code></pre>\n"}], "owner": {"reputation": 1276, "user_id": 3496846, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/61b8fab1c7d87e4da4c841accaf11a1b?s=128&d=identicon&r=PG&f=1", "display_name": "user3496846", "link": "https://stackoverflow.com/users/3496846/user3496846"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 55143986, "answer_count": 2, "score": 1, "last_activity_date": 1552506699, "creation_date": 1552486171, "question_id": 55143882, "link": "https://stackoverflow.com/questions/55143882/count-all-occurences-of-each-element-in-a-list", "title": "Count all occurences of each element in a list", "body": "<p>How do I efficiently count all occurences of each element in a list? I thought of using an associative list or some hash map, but immutability gets in the way and it's not evidently clear how an (hopefully) elegant solution should arise.</p>\n\n<p>The signature could be like this:</p>\n\n<pre><code>countOccurences :: [a] -&gt; [(a, Int)]\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>countOccurences [1, 1, 2, 3, 1, 2, 4] \n</code></pre>\n\n<p>results in </p>\n\n<pre><code>[(1, 3), (2, 2), (3, 1), (4, 1)]\n</code></pre>\n\n<p>(order is not important though).</p>\n"}, {"tags": ["haskell", "types", "type-mismatch"], "comments": [{"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 0, "creation_date": 1552485916, "post_id": 55143591, "comment_id": 97027939, "body": "How about <code>a = [(1::Int,[2::Int,3])]</code>?"}, {"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 0, "creation_date": 1552550865, "post_id": 55143591, "comment_id": 97054382, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/32496864/what-is-the-monomorphism-restriction\">What is the monomorphism restriction?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 1, "creation_date": 1552535805, "post_id": 55143833, "comment_id": 97049451, "body": "The <code>{-# LANGUAGE NoMonomorphismRestriction #-}</code> isn&#39;t necessary in your last example; the same code works just fine without it. When you call <code>testFunc a</code> in the same source file that you define <code>a</code>, then the monomorphism restriction infers <code>a :: [(TestType, [TestType])]</code>. The monomorphism restriction won&#39;t pick <code>Integer</code> over <code>Int</code> if the only use sites require <code>Int</code>, as in your example. I suspect the OP was calling the function in GHCi after loading a file containing <code>testFunc</code> and <code>a</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1552563820, "post_id": 55143833, "comment_id": 97062244, "body": "@Ben interesting, I actually didn&#39;t know that it does that over top-level bindings. This isn&#39;t something I would ever rely on though \u2013 moving that definition to another module would change the type inference! Better always give a signature."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1552604877, "post_id": 55143833, "comment_id": 97085690, "body": "I definitely agree that the right solution is to give a type signature."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1552485971, "creation_date": 1552485971, "answer_id": 55143833, "question_id": 55143591, "link": "https://stackoverflow.com/questions/55143591/change-variable-type-to-match-the-expected-type/55143833#55143833", "title": "Change variable type to match the expected type", "body": "<blockquote>\n  <p>How do I declare my list 'test' so that it matches the type of testFunc?</p>\n</blockquote>\n\n<p>Well, by declaring this as the type.</p>\n\n<pre><code>a :: [(TestType, [TestType])]\na = [(1,[2,3])]\n</code></pre>\n\n<p>Generally speaking, you should always give explicit type signatures for top-level definitions like this. Without such a signature, the compiler will pick one for you. Generally Haskell tries to pick the most general available type possible; in this case that would be</p>\n\n<pre><code>a :: (Num a, Num b) =&gt; [(a, [b])]\n</code></pre>\n\n<p>...which would include both <code>[(Int, [Int])]</code> and <code>[(Integer, [Integer])]</code>. However, the <a href=\"https://wiki.haskell.org/Monomorphism_restriction\" rel=\"nofollow noreferrer\">monomorphism restriction</a> restricts the type by default, excluding such polymorphism. So GHC has to pick one version, and the default one is <code>Integer</code>, not <code>Int</code>.</p>\n\n<p>The right solution, again, is to provide an explicit signature. However, you can also turn off the monomorphism restriction:</p>\n\n<pre><code>{-# LANGUAGE NoMonomorphismRestriction #-}\n\ntype TestType = Int\na = [(1,[2,3])]\n\ntestFunc :: [(TestType ,[TestType])] -&gt; TestType \ntestFunc ((x,(y:z)):w) = x\n\nmain :: IO ()\nmain = print $ testFunc a\n</code></pre>\n"}], "owner": {"reputation": 186, "user_id": 3548298, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d60bfa89cb98ef24ab1f44a10fdccf6d?s=128&d=identicon&r=PG&f=1", "display_name": "user3548298", "link": "https://stackoverflow.com/users/3548298/user3548298"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 1, "accepted_answer_id": 55143833, "answer_count": 1, "score": 2, "last_activity_date": 1552550915, "creation_date": 1552485278, "last_edit_date": 1552550915, "question_id": 55143591, "link": "https://stackoverflow.com/questions/55143591/change-variable-type-to-match-the-expected-type", "title": "Change variable type to match the expected type", "body": "<p>In the following code, I get the error </p>\n\n<blockquote>\n  <p>Couldn't match type 'Integer' with 'Int'<br>\n  Expected type :[(Test, [Test])]<br>\n  Actual type : [(Integer, [Integer])]</p>\n</blockquote>\n\n<p>when executing</p>\n\n<pre><code>testFunc test\n</code></pre>\n\n<p>with the following declaration</p>\n\n<pre><code>type TestType = Int\na = [(1,[2,3])]\n\ntestFunc :: [(TestType ,[TestType])] -&gt; TestType \ntestFunc ((a,(b:c)):d) = a\n</code></pre>\n\n<p>How do I declare my list <code>a</code> so that it matches the type of <code>testFunc</code>?</p>\n\n<p>And is there a way to fix the error without modifying <code>type Test = Int</code> or the declaration of <code>a</code>?</p>\n"}, {"tags": ["string", "list", "haskell", "split", "sequence"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10375436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd9f6f7b0032c13eb67f562f24039cae?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott Heldenbergh", "link": "https://stackoverflow.com/users/10375436/elliott-heldenbergh"}, "edited": false, "score": 0, "creation_date": 1552477810, "post_id": 55140892, "comment_id": 97022442, "body": "Thanks a lot ! It is not doing a complete &quot;circle&quot; (&quot;891&quot;, &quot;912&quot; not in the list) but I will try to fix this. Thanks again and have a good day :)"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 11, "user_id": 10375436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd9f6f7b0032c13eb67f562f24039cae?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott Heldenbergh", "link": "https://stackoverflow.com/users/10375436/elliott-heldenbergh"}, "edited": false, "score": 0, "creation_date": 1552478190, "post_id": 55140892, "comment_id": 97022679, "body": "oops, that&#39;s because I only noticed the &quot;cycle&quot; late on, and updated the list it was taking from, but not the indices in the comprehension. I&#39;ll do that now. [EDIT: done]"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1552482431, "post_id": 55140892, "comment_id": 97025438, "body": "I am not a huge fan of this approach. I would instead try to adapt <code>take n &lt;$&gt; tails xs</code> so that the shortest lists at the very end do not show up. This could also avoid the quadratic complexity wrt <code>length xs</code>, which the approach above has."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1552489642, "post_id": 55140892, "comment_id": 97030795, "body": "An edge case to consider: what if <code>n &gt; 2*length xs</code>?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1552490537, "post_id": 55140892, "comment_id": 97031446, "body": "You&#39;re right, this won&#39;t behave correctly when <code>n</code> gets too large (in fact <code>n &gt; length xs</code> is enough to mess it up as far as I can see). I confess I just hurriedly wrote up the first thing that popped into my head without thinking it through fully. It&#39;s pointless me adding more complexity to try to salvage this, given that you and Will have added better answers - but I&#39;ll leave this here because I think there is some value in showing a &quot;naive&quot; solution which works in most situations, as well as the valuable comments pointing out the flaws."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1552490619, "post_id": 55140892, "comment_id": 97031505, "body": "@RobinZigmond very true, about providing the counterpoint. :)"}], "tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": false, "score": 1, "last_activity_date": 1552478212, "last_edit_date": 1552478212, "creation_date": 1552476679, "answer_id": 55140892, "question_id": 55140810, "link": "https://stackoverflow.com/questions/55140810/transform-a-string-into-a-list-of-substrings-describing-sequences/55140892#55140892", "title": "Transform a string into a list of substrings describing sequences", "body": "<p>I would just use a combination of <code>take</code> and <code>drop</code>, with a list comprehension:</p>\n\n<pre><code>splitList :: Int -&gt; [a] -&gt; [[a]]\nsplitList n xs = [take n $ drop i $ xs ++ xs | i &lt;- [0..(length xs - 1)]]\n</code></pre>\n\n<p>(the <code>xs ++ xs</code> is only there to get the \"cycling\" affect, it could be tuned to only add on the first (n-1) elements but I believe Haskell's laziness should mean there is no efficiency loss in doing it this way)</p>\n"}, {"comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1552490291, "post_id": 55145191, "comment_id": 97031250, "body": "Thanks for the tip about <code>zipWith const</code>, I must confess I was staring at that thinking &quot;isn&#39;t <code>zipWith const xs ys</code> the same as <code>xs</code>?&quot; before I saw your explanation and light slowly dawned :)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1552489787, "creation_date": 1552489787, "answer_id": 55145191, "question_id": 55140810, "link": "https://stackoverflow.com/questions/55140810/transform-a-string-into-a-list-of-substrings-describing-sequences/55145191#55145191", "title": "Transform a string into a list of substrings describing sequences", "body": "<p>I would do it this way:</p>\n\n<pre><code>import Data.List\nsplitList n xs = zipWith const chunks xs where\n    chunks = map (take n) . tails . cycle $ xs\n</code></pre>\n\n<p>This should have complexity O(m*n), where m is the length of xs and n is the size of each chunk; naively it seems as though it should be hard to do better than that, since that's the size of the output. It also neatly handles a number of awkward edge cases, including working sensibly on infinite list inputs.</p>\n\n<p>If you haven't seen the <code>zipWith const</code> trick before, it's definitely one worth adding to your arsenal. It lets you do roughly the same thing as <code>take (length xs) ys</code>, but without actually computing <code>length xs</code> beforehand.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1552490165, "post_id": 55145279, "comment_id": 97031161, "body": "I had it all typed out already. :) decided to post it anyway, for the pointfree.  :)"}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1552490106, "last_edit_date": 1552490106, "creation_date": 1552490048, "answer_id": 55145279, "question_id": 55140810, "link": "https://stackoverflow.com/questions/55140810/transform-a-string-into-a-list-of-substrings-describing-sequences/55145279#55145279", "title": "Transform a string into a list of substrings describing sequences", "body": "<pre><code>splitList :: Int -&gt; [a] -&gt; [[a]]\nsplitList n xs = zipWith const (map (take n) . tails . cycle $ xs) xs\n\n-- splitList n = zipWith const =&lt;&lt; map (take n) . tails . cycle\n\n-- splitList n = map (take n) . tails . cycle &gt;&gt;= zipWith const\n</code></pre>\n\n<p>does the job, and also works on infinite input, i.e. is properly lazy.</p>\n\n<p><code>zipWith const</code> is used instead of <code>length</code> and <code>take</code>, counting in list elements instead of numbers.</p>\n\n<p>The pointfree variants are even readable / illuminating somewhat as to what is going on here.</p>\n\n<p>(forgot to mention, <code>tails</code> are from <code>Data.List</code>).</p>\n"}], "owner": {"reputation": 11, "user_id": 10375436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd9f6f7b0032c13eb67f562f24039cae?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott Heldenbergh", "link": "https://stackoverflow.com/users/10375436/elliott-heldenbergh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1552490106, "creation_date": 1552476395, "last_edit_date": 1552487714, "question_id": 55140810, "link": "https://stackoverflow.com/questions/55140810/transform-a-string-into-a-list-of-substrings-describing-sequences", "title": "Transform a string into a list of substrings describing sequences", "body": "<p>I am trying to split a string into a list of sequences that are substrings of this string. It's a bit hard to explain but I will give you an example so you can understand what I am looking for.</p>\n\n<p>From this string <code>\"123456789\"</code>, I would like to obtain a list like so:</p>\n\n<p><code>[\"123\", \"234, \"345, ..., \"789\", \"891\", \"912\"]</code></p>\n\n<p>At the moment, I only have a function that splits a string into a list of <code>n</code> parts of this string:</p>\n\n<pre><code>splitList :: Int -&gt; [a] -&gt; [[a]]\nsplitList _ [] = []\nsplitList n xs = as : splitList n bs\n    where (as,bs) = splitAt n xs\n</code></pre>\n"}, {"tags": ["haskell", "yesod", "aeson"], "answers": [{"tags": [], "owner": {"reputation": 1455, "user_id": 706882, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b8e621d3734b19dbb87061e1b9157e0?s=128&d=identicon&r=PG", "display_name": "sbditto85", "link": "https://stackoverflow.com/users/706882/sbditto85"}, "is_accepted": false, "score": 1, "last_activity_date": 1552490524, "creation_date": 1552490524, "answer_id": 55145442, "question_id": 55140418, "link": "https://stackoverflow.com/questions/55140418/check-type-of-incoming-json-structure-with-aeson/55145442#55145442", "title": "Check type of incoming JSON structure with AESON", "body": "<p>The Aeson <code>Object</code> type is just a <code>HashMap Text Value</code> (<a href=\"https://hackage.haskell.org/package/aeson-1.4.2.0/docs/Data-Aeson-Types.html#t:Object\" rel=\"nofollow noreferrer\">docs</a>) so you can use <code>withObject</code> to get an object (assuming all are objects) then do whatever logic you'd like to convert it to the appropriate type. Most likely this would involve checking for specific keys to identify which variant it is or possibly having the json declare what it is in a <code>type</code> field. This of course is by making a manual version of <code>parseJSON</code> in the <code>FromJSON</code> instance, but honestly for anything that isn't completely simple I prefer to do that anyways.</p>\n"}], "owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1552490524, "creation_date": 1552475166, "question_id": 55140418, "link": "https://stackoverflow.com/questions/55140418/check-type-of-incoming-json-structure-with-aeson", "title": "Check type of incoming JSON structure with AESON", "body": "<p>I'm using Yesod to make a single POST endpoint that can handle multiple formats of JSON. These I have called <code>MessageType</code> (see in code bellow).</p>\n\n<p>I'm trying to work out how I could case match against the structure of the JSON that comes in to work out what <code>MessageType</code> it is, for this example I need to check if it is a <code>ProjectCreation</code>.</p>\n\n<p>Want to be able to <code>JSON (projectCreation structure) -&gt; MessageType -&gt; do X</code></p>\n\n<p>Is there a way to simply <code>case</code> match JSON to work out its type?</p>\n\n<pre><code>data MessageType =\n    ProjectCreation { id                 :: ProjectId\n                    , permId             :: Maybe UUID\n                    , queueId            :: UUID\n                    , transactionTimeKey :: Maybe Text\n                    , name               :: Text\n                    , description        :: Maybe Text\n                    , createdOn          :: Maybe UTCTime\n                    , createdBy          :: Maybe AgentId\n                    , enabled            :: Bool\n                    , size               :: Fixed E2\n                    }\n  | DebtPaymentHistorical {..}\n  | PowerForecast {..} \n    ...\n  deriving (Show, Read, Eq)\n\nderivePersistField \"MessageType\"\n\n$(deriveJSON defaultOptions ''MessageType)\n</code></pre>\n"}, {"tags": ["haskell", "type-inference"], "answers": [{"comments": [{"owner": {"reputation": 479, "user_id": 9903901, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jack malkovick", "link": "https://stackoverflow.com/users/9903901/jack-malkovick"}, "edited": false, "score": 0, "creation_date": 1552481388, "post_id": 55140287, "comment_id": 97024795, "body": "Thank you for the response. I realized my comment would be too big, so I&#39;ve edited the original post. I still new to Haskell so I was not able to reproduce your answer in code. Could you please show me where I was wrong?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 479, "user_id": 9903901, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jack malkovick", "link": "https://stackoverflow.com/users/9903901/jack-malkovick"}, "edited": false, "score": 0, "creation_date": 1552481688, "post_id": 55140287, "comment_id": 97024972, "body": "@jackmalkovick You assume that <code>g</code> is a method in the class, but <code>g</code> does not have to be a method, AFAICU. You can define, outside the class, <code>g :: \u2200a,b. H(a \u2192 b) \u21d2 b</code> as <code>g = undefined</code>. GHC will complain that the type is ambiguous. Even if you force to accept it by turning on a GHC extension, <code>g &amp;&amp; True</code> will trigger an error, I think."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1552474801, "creation_date": 1552474801, "answer_id": 55140287, "question_id": 55139822, "link": "https://stackoverflow.com/questions/55139822/haskell-declarations-to-mach-a-type-scheme/55140287#55140287", "title": "Haskell declarations to mach a type scheme", "body": "<p>Since <code>H</code> is a typeclass name, it can admit multiple instances</p>\n\n<pre><code>instance H (Int -&gt; Bool) where\ninstance H (Char -&gt; Bool) where\n...\n</code></pre>\n\n<p>In such case, if we have a term</p>\n\n<pre><code>x :: \u2200a,b. H(a \u2192 b) \u21d2 b\n</code></pre>\n\n<p>and we need to compute</p>\n\n<pre><code>x &amp;&amp; True\n</code></pre>\n\n<p>we need to typecheck <code>x :: Bool</code>, but this only determines <code>b = Bool</code>, while both <code>a = Int</code> and <code>a = Char</code> could be used. The type is ambiguous because of that.</p>\n"}], "owner": {"reputation": 479, "user_id": 9903901, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jack malkovick", "link": "https://stackoverflow.com/users/9903901/jack-malkovick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 55140287, "answer_count": 1, "score": 1, "last_activity_date": 1552481282, "creation_date": 1552473375, "last_edit_date": 1552481282, "question_id": 55139822, "link": "https://stackoverflow.com/questions/55139822/haskell-declarations-to-mach-a-type-scheme", "title": "Haskell declarations to mach a type scheme", "body": "<p>I'm wondering what Haskell type declarations would match the type scheme below?</p>\n\n<p>\u2200a,b.H(a \u2192 b) \u21d2 b</p>\n\n<p>This is from <a href=\"http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.62.8605&amp;rep=rep1&amp;type=pdf\" rel=\"nofollow noreferrer\">4.1 Unambiguity / A Theory of Overloading</a></p>\n\n<hr>\n\n<p>Later Edit after <a href=\"https://stackoverflow.com/users/3234959/chi\">chi</a>'s answer.\nI tried out this code, but I can't make it fail as it should</p>\n\n<pre><code>class H f where \n  g :: f -&gt; Bool\n\ninstance H (Integer -&gt; Bool) where\n  g f = f 0\n\ninstance H (Char -&gt; Bool) where\n  g f = f '1'\n\ng (\\x -&gt; if x &gt; 10 then True else False)\n\ng (\\x -&gt; if x == '0' then True else False)\n</code></pre>\n\n<p>Also, I realized that for this code couldn't make the type unambiguous by adding a functional dependency like <code>| b -&gt; a</code> to match this propagation rule</p>\n\n<p><code>(FH) H (a \u2014&gt; b),H (a' \u2014&gt; b) =&gt; a = a'</code></p>\n"}, {"tags": ["haskell", "set"], "comments": [{"owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "edited": false, "score": 2, "creation_date": 1552459788, "post_id": 55135591, "comment_id": 97012322, "body": "I would guess that python uses the &quot;Ord instance&quot; of the hash code to implement the set"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1552467183, "post_id": 55135591, "comment_id": 97015802, "body": "There are other options than binary search trees. See <code>Data.IntSet</code> (a PATRICIA tree) and <code>Data.HashSet</code> (a hash array-mapped trie)."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1552467507, "post_id": 55135591, "comment_id": 97015994, "body": "To elaborate on @dfeuer: <code>Data.HashSet</code> (from the <code>unordered-containers</code> library) is probably your best bet here; it uses <code>Hashable</code> instead of <code>Ord</code>, allowing more types to be stored. I don&#39;t think you can get rid of the constraint entirely though."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1552467675, "post_id": 55135591, "comment_id": 97016085, "body": "@bradrn, probably not more types. But a slightly different set of types, and many more efficiently."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1552467950, "post_id": 55135591, "comment_id": 97016263, "body": "@dfeuer Thanks for correcting me! I always thought that <code>HashSet</code> (a) supported more types and (b) was less efficient than <code>Set</code>; it seems I was wrong on both counts."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1552477878, "post_id": 55135591, "comment_id": 97022487, "body": "It should be possible to have a hash-set with O(1) acces for the case you don&#39;t have to change the content of the set, just like you have vectors which have O(1) access as well. Using the right monad it should be possible to have O(1) update as well. I never used something like this in Haskell  so you have to do your own reserarch for this."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1552489309, "post_id": 55135591, "comment_id": 97030542, "body": "Your English text says &quot;Only <code>__eq__</code> and <code>__ne__</code>&quot;, but your code says &quot;...and also <code>__hash__</code>&quot;."}, {"owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1552523810, "post_id": 55135591, "comment_id": 97046716, "body": "@DanielWagner I am a haskell and python hobbyist, so maybe I haven&#39;t understood the mechanism of the implementation. <code>__hash__ is defined since python needs it for a set, but actually I don&#39;t understand why the class has to be hashable. Are there any implicit information that I miss with the </code>__hash__` defined?"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1552921416, "post_id": 55135591, "comment_id": 97183506, "body": "You could always try bloom filters. That still requires a hash implementation though..."}], "answers": [{"comments": [{"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 2, "creation_date": 1552471546, "post_id": 55136266, "comment_id": 97018601, "body": "There is <code>Data.HashSet</code> which requires <code>Hashable a, Eq a</code> - but it&#39;s a tree too."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1552478112, "post_id": 55136266, "comment_id": 97022625, "body": "I do not think it has anything to do with dynamically typed. In C# and Java you can have (hash)sets with the same access / update time complexity as in Python."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1552488116, "post_id": 55136266, "comment_id": 97029649, "body": "Not all values in Python are hashable, and it is hardly &quot;cheating&quot; to take advantage of available mutable data structures."}, {"owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "reply_to_user": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1552517323, "post_id": 55136266, "comment_id": 97045036, "body": "@Elmex80s my claim was not about speed.  Haskell sets are very fast as well, but require that the programmer (or standard library) need to provide an <code>Ord</code> instance. What dynamic typing has is a free psudo-ordering of all values based on the internals header of the value as stored in memory. I do not know enough about the low-level representation of data in Java or C# to say if they have similar value headers that could be used, but Haskell removes type information when converting from the STG representation. <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Commentary/Compiler/GeneratedCode\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/wiki/Commentary/Compiler/GeneratedC&zwnj;&#8203;ode</a>"}, {"owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "edited": false, "score": 1, "creation_date": 1552525634, "post_id": 55136266, "comment_id": 97047180, "body": "So, if I understand it right, what you mean is for the sake of speed, there is something related to the ordering explicitly or implicitly. Since haskell&#39;s <code>HashSet</code> needs its elements to be hashable, I understand that <code>HashSet</code> is equivalent to python&#39;s set roughly, am I right?"}], "tags": [], "owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "is_accepted": true, "score": 3, "last_activity_date": 1552461126, "creation_date": 1552461126, "answer_id": 55136266, "question_id": 55135591, "link": "https://stackoverflow.com/questions/55135591/are-there-any-efficient-data-structure-to-represent-set-except-binary-searching/55136266#55136266", "title": "Are there any efficient data structure to represent Set except binary searching tree", "body": "<p>Python is cheating.  <a href=\"https://stackoverflow.com/questions/3949310/how-is-set-implemented\">All values in Python are hashable and <code>set()</code> is just a dictionary with no value.</a> </p>\n\n<p>Python can get away with this as a side effect of being dynamically typed language.  The same machinery that lets Python keep track of the types of it variables also makes it easy to impose an psudo-ordering on them.</p>\n\n<p>Haskell as a statically typed language espically a statically typed language with first class functions cannot invent an arbitrary ordering for a data type. Therefore <code>Data.Set</code> requires <code>Ord</code> to be efficient.  Without ordering adding a new value to a set becomes O(n).</p>\n"}], "owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 55136266, "answer_count": 1, "score": 1, "last_activity_date": 1552461126, "creation_date": 1552458025, "last_edit_date": 1552458369, "question_id": 55135591, "link": "https://stackoverflow.com/questions/55135591/are-there-any-efficient-data-structure-to-represent-set-except-binary-searching", "title": "Are there any efficient data structure to represent Set except binary searching tree", "body": "<p>As we know, in Haskell, a set of elements is represented by a binary searching tree in <a href=\"https://hackage.haskell.org/package/containers-0.6.0.1/docs/Data-Set.html\" rel=\"nofollow noreferrer\"><code>Data.Set</code></a> module, which is efficient. However, most operations require the elememt to be an instance of the <code>Ord</code> class. </p>\n\n<p>However, a general set doesn't need its elememt to be an instance of the <code>Ord</code>. Since a set is where there is no duplicate elements, so its element being an instance of the <code>Eq</code> class is just enough. </p>\n\n<p>In Haskell, I can only think of the implementation by a single linked list, just like the default <code>[a]</code>, but the single linked list are not as efficient as a BST, while a BST needs the <code>Ord</code> class. </p>\n\n<p>By the way, in Python, the <code>set</code> class doesn't needs its element to be orderable. Only <code>__eq__</code> and <code>__ne__</code> (which is silimar to Haskell's <code>Eq</code> class) defined is enough, e.g.:</p>\n\n<pre><code>class Fruit:\n    def __init__(self, name):\n        self.name = name.title()\n\n    def __repr__(self):\n        return self.name\n\n    def __eq__(self, other):\n        return self.name == other.name     # defines the equality operation\n\n    def __ne__(self, other):\n        return self.name != other.name     # defines the unequality operation\n\n    def __hash__(self):\n        return hash(self.name)     # so that Fruit instance can be an element of a set\n</code></pre>\n\n<blockquote>\n  <p>?: x = Fruit('apple') </p>\n  \n  <p>?: y = Fruit('apple') </p>\n  \n  <p>?: z = Fruit('Apple')</p>\n  \n  <p>?: {x,y,z} </p>\n  \n  <p>{Apple}</p>\n  \n  <p>?: x &lt;= y</p>\n  \n  <p>Traceback (most recent call last):</p>\n  \n  <p>File \"\", line 1, in module</p>\n\n<pre><code>x &lt;= y\n</code></pre>\n  \n  <p>TypeError: '&lt;=' not supported between instances of 'Fruit' and 'Fruit'</p>\n</blockquote>\n\n<p>So I wonder whether there are some efficient data structure in Haskell that could be used to represent the <code>Set</code> but does not need the <code>Ord</code> class. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1552480244, "post_id": 55133331, "comment_id": 97024062, "body": "Minor nit: the GCD of <code>n</code> and <code>n</code> is always going to be <code>n</code>; you probably need to check for <code>[1..n-1]</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 2, "creation_date": 1552448596, "post_id": 55133400, "comment_id": 97008982, "body": "It&#39;s probably useful to mention that using an &#39;inner&#39; <code>go</code> function is the standard way to do any recursion in Haskell when an extra variable name or parameter is required."}, {"owner": {"reputation": 23, "user_id": 11138316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03398bc997d95e803f698e6e42881d8b?s=128&d=identicon&r=PG&f=1", "display_name": "max12424", "link": "https://stackoverflow.com/users/11138316/max12424"}, "edited": false, "score": 0, "creation_date": 1552475923, "post_id": 55133400, "comment_id": 97021292, "body": "Thanks a lot , that works and its pretty cool that you can use another function like that!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1581580547, "post_id": 55133400, "comment_id": 106484642, "body": "(a side note) this fails to mention explicitly that the &quot;helper function&quot; is defined in the nested scope of the original <code>myproduct</code> function. a non-nested (top-level) <code>myproduct_helper :: Integer-&gt;Integer-&gt;Integer</code> would also have access to the original argument value (this is the Prolog way to achieve this, since it doesn&#39;t have nested scope). in Haskell/LC-based languages/ turning a nested function into the top-level one by adding parameters to it is known as &quot;lambda lifting&quot;."}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 7, "last_activity_date": 1552443757, "creation_date": 1552443757, "answer_id": 55133400, "question_id": 55133331, "link": "https://stackoverflow.com/questions/55133331/how-to-store-value-of-function-call-to-a-variable/55133400#55133400", "title": "How to store value of function call to a variable", "body": "<p>Use a helper function (often called <code>go</code>) to do the recursion, and use a different variable name in the outermost call than in the recursive call, like this:</p>\n\n<pre><code>myproduct :: Integer-&gt;Integer\n\nmyproduct orig_n = go orig_n\n  where\n    go 0 = 1\n    go n\n      |gcd n orig_n  /= 1 = go (n-1)\n      |otherwise = x\n      where\n        x = n * go (n - 1)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11138316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03398bc997d95e803f698e6e42881d8b?s=128&d=identicon&r=PG&f=1", "display_name": "max12424", "link": "https://stackoverflow.com/users/11138316/max12424"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 55133400, "answer_count": 1, "score": 2, "last_activity_date": 1552580163, "creation_date": 1552443123, "last_edit_date": 1552580163, "question_id": 55133331, "link": "https://stackoverflow.com/questions/55133331/how-to-store-value-of-function-call-to-a-variable", "title": "How to store value of function call to a variable", "body": "<p>I have this function where I need to check if the <code>gdc</code> of the numbers <code>[1..n]</code> and <code>n</code> is <code>== 1</code> and do some calculations then.  So I am stuck because I can't find a way to store the initial value of n to a variable.  </p>\n\n<p>For example, if I call the function with the number 7 its a recursion so <code>n</code> becomes <code>6</code> then <code>5</code> etc so I can't <code>gdc</code> properly; for example <code>1-7</code> then <code>2 - 7</code> then <code>3 -7</code>. Do you know how I can store the value of <code>n</code> to <code>a</code> variable ?</p>\n\n<pre><code>myproduct :: Integer-&gt;Integer\n\nmyproduct 0 = 1\nmyproduct n  \n  |gcd n (n from first call)  /= 1 = myproduct (n-1) \n  |otherwise = x\n  where \n    x = n * myproduct (n - 1)\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack", "nixos"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552435595, "post_id": 55132464, "comment_id": 97006376, "body": "Why are you using <code>sudo</code> to run <code>stack build</code>?"}, {"owner": {"reputation": 2534, "user_id": 375616, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/05e5a5b30a8fd45115825e2942c82183?s=128&d=identicon&r=PG", "display_name": "Nutritioustim", "link": "https://stackoverflow.com/users/375616/nutritioustim"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552435743, "post_id": 55132464, "comment_id": 97006408, "body": "@JosephSible Same error happens with an without <code>sudo</code>. I tried with <code>sudo</code> to see if that was the problem."}, {"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1553175326, "post_id": 55132464, "comment_id": 97293078, "body": "Have you tried <code>stack build --nix</code>?"}, {"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1553175442, "post_id": 55132464, "comment_id": 97293141, "body": "Seems to be mentioned on this github issue: <a href=\"https://github.com/commercialhaskell/stack/issues/4196\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/4196</a>"}, {"owner": {"reputation": 2534, "user_id": 375616, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/05e5a5b30a8fd45115825e2942c82183?s=128&d=identicon&r=PG", "display_name": "Nutritioustim", "link": "https://stackoverflow.com/users/375616/nutritioustim"}, "reply_to_user": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1553268784, "post_id": 55132464, "comment_id": 97334493, "body": "@ChrisStryczynski Running <code>stack build --nix</code> gives me <code>error: attribute &#39;ghc864&#39; missing, at (string):1:43</code>. So thanks for pointing our that GH issue. I added to that issue, adding this thread to the pile. As outlined above, I tried manually adding the missing libs, but got more missing dependency errors (which I can&#39;t add). So maybe the devs have more insight."}, {"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1553269370, "post_id": 55132464, "comment_id": 97334869, "body": "<a href=\"https://stackoverflow.com/questions/47916591/stack-build-error-attribute-ghc822-missing-at-string153/47922106\" title=\"stack build error attribute ghc822 missing at string153\">stackoverflow.com/questions/47916591/&hellip;</a> could be a similar issue to this too"}], "answers": [{"comments": [{"owner": {"reputation": 2534, "user_id": 375616, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/05e5a5b30a8fd45115825e2942c82183?s=128&d=identicon&r=PG", "display_name": "Nutritioustim", "link": "https://stackoverflow.com/users/375616/nutritioustim"}, "edited": false, "score": 0, "creation_date": 1553268167, "post_id": 55277287, "comment_id": 97334085, "body": "Yes agreed. I guess what I&#39;m wondering is why including <code>stack</code> in <code>environment.systemPackages</code>, doesn&#39;t pull down all needed dependencies, including ghc. I tried explicitly including <code>ghc</code>, and get the same error."}], "tags": [], "owner": {"reputation": 104, "user_id": 826753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d32bda212d90f3d131b7f7781f8ac0b?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Petersen", "link": "https://stackoverflow.com/users/826753/jens-petersen"}, "is_accepted": false, "score": 0, "last_activity_date": 1553160709, "creation_date": 1553160709, "answer_id": 55277287, "question_id": 55132464, "link": "https://stackoverflow.com/questions/55132464/ghc-cabal-no-such-file-or-directory-error-while-building-haskell-stack-exampl/55277287#55277287", "title": "&quot;ghc-cabal: No such file or directory&quot; error while building Haskell Stack example in NixOS", "body": "<p>ghc-cabal is an artifact in ghc's build, included in ghc binary distributions:</p>\n\n<pre><code>$ ls -l  ~/.stack/programs/x86_64-linux/ghc-tinfo6-8.6.3.tar.xz\n-rw-rw-r--. 1 user group 182356948 Dec 25 15:11 ghc-tinfo6-8.6.3.tar.xz\n$ tar tvf ~/.stack/programs/x86_64-linux/ghc-tinfo6-8.6.3.tar.xz | grep tmp/ghc-cabal\n-rwxr-xr-x ghc/ghc      225936 2018-12-08 00:03 ghc-8.6.3/utils/ghc-cabal/dist-install/build/tmp/ghc-cabal\n-rwxr-xr-x ghc/ghc         858 2018-12-08 00:03 ghc-8.6.3/utils/ghc-cabal/dist-install/build/tmp/ghc-cabal-bindist\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2534, "user_id": 375616, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/05e5a5b30a8fd45115825e2942c82183?s=128&d=identicon&r=PG", "display_name": "Nutritioustim", "link": "https://stackoverflow.com/users/375616/nutritioustim"}, "is_accepted": true, "score": 0, "last_activity_date": 1553609560, "creation_date": 1553609560, "answer_id": 55359265, "question_id": 55132464, "link": "https://stackoverflow.com/questions/55132464/ghc-cabal-no-such-file-or-directory-error-while-building-haskell-stack-exampl/55359265#55359265", "title": "&quot;ghc-cabal: No such file or directory&quot; error while building Haskell Stack example in NixOS", "body": "<p>So I solved this with the help of <a href=\"https://github.com/qrilka\" rel=\"nofollow noreferrer\">Kirill Zaborsky</a> in a <code>commercialhaskell/stack</code> issues <a href=\"https://github.com/commercialhaskell/stack/issues/4196\" rel=\"nofollow noreferrer\">thread</a>. The cause of the error (in <code>stack new</code> and <code>stack build</code>) was an old Stack version. Specifically, my local user had an older stack (<code>1.6.5</code>) than root (<code>1.9.3</code>). </p>\n\n<p>Version 1.6.5 uses <code>Cabal-2.0</code>, and since then new features were introduced by <code>Cabal</code> (ex <code>base-noprelude</code>) use leading commas, implemented in <a href=\"https://github.com/haskell/cabal/pull/4953\" rel=\"nofollow noreferrer\">haskell/cabal#4953</a> which came with 2.2. So Stack fails parsing cabal files using the new format features.</p>\n\n<p>Details are in the <code>commercialhaskell/stack</code> issues <a href=\"https://github.com/commercialhaskell/stack/issues/4196\" rel=\"nofollow noreferrer\">thread</a>. And upgrading my local user's stack (<code>nix-env --upgrade stack</code>) fixed the problem.</p>\n"}], "owner": {"reputation": 2534, "user_id": 375616, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/05e5a5b30a8fd45115825e2942c82183?s=128&d=identicon&r=PG", "display_name": "Nutritioustim", "link": "https://stackoverflow.com/users/375616/nutritioustim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 722, "favorite_count": 0, "accepted_answer_id": 55359265, "answer_count": 2, "score": 3, "last_activity_date": 1553609560, "creation_date": 1552435476, "last_edit_date": 1552669314, "question_id": 55132464, "link": "https://stackoverflow.com/questions/55132464/ghc-cabal-no-such-file-or-directory-error-while-building-haskell-stack-exampl", "title": "&quot;ghc-cabal: No such file or directory&quot; error while building Haskell Stack example in NixOS", "body": "<p><strong>A)</strong> I'm trying to create a Haskell project i) with Stack, ii) on NixOS (channels/nixos-18.03). While following the <a href=\"https://docs.haskellstack.org/en/stable/GUIDE/#hello-world-example\" rel=\"nofollow noreferrer\">HelloWorld example</a> in the user guide, to build the project, I get the error <code>ghc-cabal: No such file or directory</code>. </p>\n\n<pre><code>$ stack new helloworld new-template\n$ cd helloworld\n$ sudo stack build\n...\nRunning /run/current-system/sw/bin/make install in directory /root/.stack/programs/x86_64-linux/ghc-8.6.4.temp/ghc-8.6.4/ exited with ExitFailure 2\n...\nutils/ghc-cabal/dist-install/build/tmp/ghc-cabal-bindist: line 3: /root/.stack/programs/x86_64-linux/ghc-8.6.4.temp/ghc-8.6.4/utils/ghc-cabal/dist-install/build/tmp/ghc-cabal: No such file or directory\nmake[1]: *** [ghc.mk:990: install_packages] Error 127\nmake: *** [Makefile:51: install] Error 2\n\nError: Error encountered while installing GHC with\n         make install\n         run in /root/.stack/programs/x86_64-linux/ghc-8.6.4.temp/ghc-8.6.4/\n\n       The following directories may now contain files, but won't be used by stack:\n         - /root/.stack/programs/x86_64-linux/ghc-8.6.4.temp/\n         - /root/.stack/programs/x86_64-linux/ghc-8.6.4/\n</code></pre>\n\n<p><strong>B)</strong> Iteratively, I've built up my <code>/etc/nixos/configuration.nix</code> file to look like this. And in the resulting system, indeed there's no <code>ghc-cabal</code> binary. There's <code>cabal</code>, but no <code>ghc-cabal</code>.</p>\n\n<pre><code>  environment.systemPackages = with pkgs; [\n    wget vim emacs\n    pkgs.firefoxWrapper pkgs.chromium\n\n    stack\n    haskellPackages.ghc\n    haskellPackages.cabal-install\n    haskellPackages.cabal2nix\n    haskellPackages.hdevtools\n\n    tree gnumake which binutils gcc clang coreutils gnutar\n    tmux silver-searcher gitAndTools.gitFull\n  ];\n</code></pre>\n\n<p><strong>C)</strong> I've also followed the steps in Stack's <a href=\"https://docs.haskellstack.org/en/stable/nix_integration/\" rel=\"nofollow noreferrer\">Nix Integration</a> section. But to no avail. </p>\n\n<p>What package installs <code>ghc-cabal</code>? Is there a mismatch between <code>stack</code> and <code>haskellPackages.cabal-install</code>? What am I missing? </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I did a bit of digging around and came across some useful resources.\nIn particular, <a href=\"https://osoco.es/thoughts/2018/07/gradle-and-nixos/\" rel=\"nofollow noreferrer\">this article</a> points out that my problem could be  caused by an unresolved dynamic library. </p>\n\n<p>Indeed when querying the loaded libraries for that binary, I get the result below. </p>\n\n<pre><code>$ ldd ~/.stack/programs/x86_64-linux/ghc-8.6.4.temp/ghc-8.6.4/utils/ghc-cabal/dist-install/build/tmp/ghc-cabal\n    linux-vdso.so.1 (0x00007fff0ab01000)\n    libm.so.6 =&gt; /nix/store/681354n3k44r8z90m35hm8945vsp95h1-glibc-2.27/lib/libm.so.6 (0x00007fe82c07f000)\n    libHSCabal-2.4.0.1-ghc8.6.4.so =&gt; not found\n    libHSprocess-1.6.5.0-ghc8.6.4.so =&gt; not found\n    libHSpretty-1.1.3.6-ghc8.6.4.so =&gt; not found\n    libHSparsec-3.1.13.0-ghc8.6.4.so =&gt; not found\n    libHStext-1.2.3.1-ghc8.6.4.so =&gt; not found\n    libHSmtl-2.2.2-ghc8.6.4.so =&gt; not found\n    libHStransformers-0.5.6.2-ghc8.6.4.so =&gt; not found\n    libHSdirectory-1.3.3.0-ghc8.6.4.so =&gt; not found\n    libHSunix-2.7.2.2-ghc8.6.4.so =&gt; not found\n    libHStime-1.8.0.2-ghc8.6.4.so =&gt; not found\n    libHSfilepath-1.4.2.1-ghc8.6.4.so =&gt; not found\n    libHSbinary-0.8.6.0-ghc8.6.4.so =&gt; not found\n    libHScontainers-0.6.0.1-ghc8.6.4.so =&gt; not found\n    libHSbytestring-0.10.8.2-ghc8.6.4.so =&gt; not found\n    libHSdeepseq-1.4.4.0-ghc8.6.4.so =&gt; not found\n    libHSarray-0.5.3.0-ghc8.6.4.so =&gt; not found\n    libHSbase-4.12.0.0-ghc8.6.4.so =&gt; not found\n    libHSinteger-gmp-1.0.2.0-ghc8.6.4.so =&gt; not found\n    libHSghc-prim-0.5.3-ghc8.6.4.so =&gt; not found\n    libHSrts-ghc8.6.4.so =&gt; not found\n    libffi.so.7 =&gt; not found\n    librt.so.1 =&gt; /nix/store/681354n3k44r8z90m35hm8945vsp95h1-glibc-2.27/lib/librt.so.1 (0x00007fe82c06d000)\n    libutil.so.1 =&gt; /nix/store/681354n3k44r8z90m35hm8945vsp95h1-glibc-2.27/lib/libutil.so.1 (0x00007fe82c068000)\n    libdl.so.2 =&gt; /nix/store/681354n3k44r8z90m35hm8945vsp95h1-glibc-2.27/lib/libdl.so.2 (0x00007fe82c063000)\n    libpthread.so.0 =&gt; /nix/store/681354n3k44r8z90m35hm8945vsp95h1-glibc-2.27/lib/libpthread.so.0 (0x00007fe82c042000)\n    libgmp.so.10 =&gt; not found\n    libc.so.6 =&gt; /nix/store/681354n3k44r8z90m35hm8945vsp95h1-glibc-2.27/lib/libc.so.6 (0x00007fe82be8a000)\n    /lib64/ld-linux-x86-64.so.2 =&gt; /nix/store/681354n3k44r8z90m35hm8945vsp95h1-glibc-2.27/lib64/ld-linux-x86-64.so.2 (0x00007fe82c219000)\n</code></pre>\n\n<p>I tried resolving the missing libs, by adding <code>haskellPackages.stdio</code> and <code>haskellPackages.stdf</code> to configuration.nix. But further upstream errors spring from that (ex: I can't add aeson as an <code>environment.systemPackages</code> dependency). So I haven't gotten the right mix yet.</p>\n\n<pre><code>CallStack (from HasCallStack):\n  die', called at libraries/Cabal/Cabal/Distribution/Simple/Configure.hs:950:20 in Cabal-2.4.0.1:Distribution.Simple.Configure\n  configureFinalizedPackage, called at libraries/Cabal/Cabal/Distribution/Simple/Configure.hs:460:12 in Cabal-2.4.0.1:Distribution.Simple.Configure\n  configure, called at libraries/Cabal/Cabal/Distribution/Simple.hs:596:20 in Cabal-2.4.0.1:Distribution.Simple\n  confHook, called at libraries/Cabal/Cabal/Distribution/Simple/UserHooks.hs:67:5 in Cabal-2.4.0.1:Distribution.Simple.UserHooks\n  configureAction, called at libraries/Cabal/Cabal/Distribution/Simple.hs:178:19 in Cabal-2.4.0.1:Distribution.Simple\n  defaultMainHelper, called at libraries/Cabal/Cabal/Distribution/Simple.hs:115:27 in Cabal-2.4.0.1:Distribution.Simple\n  defaultMain, called at Setup.hs:2:8 in main:Main\nSetup: Encountered missing dependencies:\naeson ==0.8.*, base ==4.7.*, binary ==0.7.*, text ==1.1.*\n</code></pre>\n"}, {"tags": ["haskell", "functor", "category-theory", "profunctor"], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 1, "last_activity_date": 1552440803, "creation_date": 1552440803, "answer_id": 55133075, "question_id": 55132048, "link": "https://stackoverflow.com/questions/55132048/generalization-of-strong-and-closed-profunctors/55133075#55133075", "title": "Generalization of strong and closed profunctors", "body": "<p>Very intriguing. This isn't really an answer, just thoughts...</p>\n\n<p>So what we need is an abstraction over <code>(,)</code> and <code>(-&gt;)</code> which offers generalisation of <code>assoc</code>/<code>curry</code> and <code>first</code>/<code>precompose</code>. I'll address the former:</p>\n\n<pre><code>class Isotropic f where\n  lefty :: f a (f b c) -&gt; f (a,b) c\n  righty :: f (a,b) c -&gt; f a (f b c)\n  -- lefty \u2261 righty\u207b\u00b9\n\ninstance Isotropic (,) where\n  lefty (a,(b,c)) = ((a,b),c)\n  righty ((a,b),c) = (a,(b,c))\n\ninstance Isotropic (-&gt;) where\n  lefty = uncurry\n  righty = curry\n</code></pre>\n\n<p>Easy. Question is, are there any other instances of this? There's certainly the trivial one</p>\n\n<pre><code>newtype Biconst c a b = Biconst c\n\ninstance Isotropic (Biconst c) where\n  lefty (Biconst c) = Biconst c\n  righty (Biconst c) = Biconst c\n</code></pre>\n\n<p>Then the resulting profunctor</p>\n\n<pre><code>class Profunctor p =&gt; Stubborn p where\n  stubborn :: p a b -&gt; p (Biconst d c a) (Biconst d c b)\n</code></pre>\n\n<p>could as well be written</p>\n\n<pre><code>class Profunctor p =&gt; Stubborn p where\n  stubborn :: p a b -&gt; p d d\n</code></pre>\n\n<p>But the instances of this seem to come out rather too trivial as well, to be any use:</p>\n\n<pre><code>instance Stubborn (-&gt;) where\n  stubborn _ = id\ninstance (Monad m) =&gt; Stubborn (Kleisli m) where\n  stubborn (Kleisli _) = Kleisli pure\ninstance (Monoid m) =&gt; Stubborn (Forget m) where\n  stubborn (Forget _) = Forget $ const mempty\n</code></pre>\n\n<p>I suspect that <code>(,)</code> and <code>(-&gt;)</code> really are the only useful cases for this, because they are the \u201cfree bifunctor\u201d / \u201cfree profunctor\u201d, respectively.</p>\n"}, {"comments": [{"owner": {"reputation": 547, "user_id": 832176, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8d7cd2cd4d6d4ef64df3b266136ab853?s=128&d=identicon&r=PG", "display_name": "M Farkas-Dyck", "link": "https://stackoverflow.com/users/832176/m-farkas-dyck"}, "edited": false, "score": 0, "creation_date": 1552447974, "post_id": 55133297, "comment_id": 97008847, "body": "I was thinking to note <code>Choice</code> in my question but the docs of the &quot;profunctors&quot; package already say it&#39;s another notion of strength so i left it out. Anyhow, thanks!"}], "tags": [], "owner": {"reputation": 9111, "user_id": 90088, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c018f213204496b4bbf481e7c8e6c15c?s=128&d=identicon&r=PG", "display_name": "Bartosz Milewski", "link": "https://stackoverflow.com/users/90088/bartosz-milewski"}, "is_accepted": true, "score": 6, "last_activity_date": 1552442797, "creation_date": 1552442797, "answer_id": 55133297, "question_id": 55132048, "link": "https://stackoverflow.com/questions/55132048/generalization-of-strong-and-closed-profunctors/55133297#55133297", "title": "Generalization of strong and closed profunctors", "body": "<p>You could add <code>Choice</code> to the list. Both <code>Strong</code> and <code>Choice</code> (or cartesian and cocartesian, as Jeremy Gibbons calls them) are examples of Tambara modules. I talk about the general pattern that includes <code>Closed</code> in my blog post on <a href=\"https://bartoszmilewski.com/2017/07/07/profunctor-optics-the-categorical-view/\" rel=\"noreferrer\">profunctor optics</a> (skip to the Discussion section), under the name <code>Related</code>.</p>\n"}], "owner": {"reputation": 547, "user_id": 832176, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8d7cd2cd4d6d4ef64df3b266136ab853?s=128&d=identicon&r=PG", "display_name": "M Farkas-Dyck", "link": "https://stackoverflow.com/users/832176/m-farkas-dyck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 3, "accepted_answer_id": 55133297, "answer_count": 2, "score": 10, "last_activity_date": 1562468059, "creation_date": 1552432526, "last_edit_date": 1562468059, "question_id": 55132048, "link": "https://stackoverflow.com/questions/55132048/generalization-of-strong-and-closed-profunctors", "title": "Generalization of strong and closed profunctors", "body": "<p>I was looking at the classes of strong and closed profunctors:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class Profunctor p where\n    dimap :: (a' -&gt; a) -&gt; (b -&gt; b') -&gt; p a b -&gt; p a' b'\nclass Profunctor p =&gt; Strong p where\n    strong :: p a b -&gt; p (c, a) (c, b)\nclass Profunctor p =&gt; Closed p where\n    closed :: p a b -&gt; p (c -&gt; a) (c -&gt; b)\n</code></pre>\n\n<p>(<code>(,)</code> is a symmetric bifunctor, so it's equivalent to the definition in \"profunctors\" package.)</p>\n\n<p>I note both <code>(-&gt;) a</code> and <code>(,) a</code> are endofunctors. It seems <code>Strong</code> and <code>Closed</code> have a similar form:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class (Functor f, Profunctor p) =&gt; C f p where\n    c :: p a b -&gt; p (f a) (f b)\n</code></pre>\n\n<p>Indeed, if we look at the laws, some also have a similar form:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>strong . strong \u2261 dimap unassoc assoc . strong\nclosed . closed \u2261 dimap uncurry curry . closed\n\nlmap (first f) . strong \u2261 rmap (first f) . strong\nlmap (. f)     . closed \u2261 rmap (. f)     . closed\n</code></pre>\n\n<p>Are these both special cases of some general case?</p>\n"}, {"tags": ["list", "haskell", "fixpoint-combinators"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1552431322, "post_id": 55131843, "comment_id": 97005292, "body": "This is far too broad. Show what you&#39;ve tried what note what specifically you need help with."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1552431360, "post_id": 55131843, "comment_id": 97005307, "body": "It&#39;s probably worth looking at - or trying to come up with (it&#39;s not hard) - the recursive definition of <code>map</code> first. Then I believe there&#39;s a fairly &quot;mechanical&quot; way to translate that into using <code>fix</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10914499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/989c0f87d05e6985d84f43db61d165c4?s=128&d=identicon&r=PG&f=1", "display_name": "VengeQ", "link": "https://stackoverflow.com/users/10914499/vengeq"}, "edited": false, "score": 2, "creation_date": 1552434009, "post_id": 55131965, "comment_id": 97006006, "body": "Thanks! It&#39;s really useful. With it i could write filter and foldr, it&#39;s not so complicated."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1552431932, "creation_date": 1552431932, "answer_id": 55131965, "question_id": 55131843, "link": "https://stackoverflow.com/questions/55131843/haskell-list-function-map-zip-etc-with-fix/55131965#55131965", "title": "Haskell List function (map, zip, etc..) with fix", "body": "<p>To use <code>fix</code>, one needs to write the recursive definition in the form</p>\n\n<pre><code>map = .... something involving map .... \n</code></pre>\n\n<p>Then, we let</p>\n\n<pre><code>map = fix (\\m -&gt; .... something involving m ....)\n</code></pre>\n\n<p>For instance,</p>\n\n<pre><code>map = \\f xs -&gt; case xs of\n   []   -&gt; []\n   y:ys -&gt; f y : map f ys\n</code></pre>\n\n<p>so,</p>\n\n<pre><code>map = fix (\\m f xs -&gt; case xs of\n   []   -&gt; []\n   y:ys -&gt; f y : m f ys)\n</code></pre>\n\n<p>Alternatively, since the argument <code>f</code> is the same for each recursive call, we can let</p>\n\n<pre><code>map f = \\xs -&gt; case xs of\n   []   -&gt; []\n   y:ys -&gt; f y : map f ys\n</code></pre>\n\n<p>and obtain</p>\n\n<pre><code>map f = fix (\\m xs -&gt; case xs of\n   []   -&gt; []\n   y:ys -&gt; f y : m ys)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10914499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/989c0f87d05e6985d84f43db61d165c4?s=128&d=identicon&r=PG&f=1", "display_name": "VengeQ", "link": "https://stackoverflow.com/users/10914499/vengeq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 55131965, "answer_count": 1, "score": -1, "last_activity_date": 1563167802, "creation_date": 1552431247, "last_edit_date": 1563167802, "question_id": 55131843, "link": "https://stackoverflow.com/questions/55131843/haskell-list-function-map-zip-etc-with-fix", "title": "Haskell List function (map, zip, etc..) with fix", "body": "<p>I try to learn haskell and have exercise -try to rewrite standart list operation(map, foldr, zip, iterate, etc.) with function fix.\nI have example with repeat:</p>\n\n<pre><code>repeat a = fix $ \\xs -&gt; a : xs\n</code></pre>\n\n<p>and it's further simplify </p>\n\n<pre><code>repeat a = fix (a:)\nrepeat = fix . (:)\n</code></pre>\n\n<p>Can anyone help me with map? \nSorry for my bad engl and thank u in advance.</p>\n"}, {"tags": ["haskell", "typeclass", "newtype"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1552419398, "post_id": 55129179, "comment_id": 97000436, "body": "e.g. <code>instance (Num a, TooMany a) =&gt; TooMany (Baz a) where tooMany (Baz (n, m)) = n &gt; 42 || tooMany m</code>."}, {"owner": {"reputation": 2088, "user_id": 4281998, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/q8Jvt.png?s=128&g=1", "display_name": "Brady Dean", "link": "https://stackoverflow.com/users/4281998/brady-dean"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1552419682, "post_id": 55129179, "comment_id": 97000560, "body": "@WillNess You also need <code>Ord a</code> but I like it. I think the writer meant to put that in the exercise, otherwise the first element can&#39;t be used for much"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1552438079, "post_id": 55129179, "comment_id": 97006917, "body": "there are many possible definition for those two constraints, e.g. <code>tooMany (n+1) || tooMany m</code>."}], "answers": [{"comments": [{"owner": {"reputation": 2088, "user_id": 4281998, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/q8Jvt.png?s=128&g=1", "display_name": "Brady Dean", "link": "https://stackoverflow.com/users/4281998/brady-dean"}, "edited": false, "score": 2, "creation_date": 1552418750, "post_id": 55129251, "comment_id": 97000118, "body": "I figured it needed to go in the type constructor, just couldn&#39;t figure out the syntax."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1552418603, "creation_date": 1552418603, "answer_id": 55129251, "question_id": 55129179, "link": "https://stackoverflow.com/questions/55129179/add-type-variable-to-newtype-definition/55129251#55129251", "title": "Add type variable to newtype definition", "body": "<p>You likely need to use an argument to <code>Baz</code>:</p>\n\n<pre><code>newtype Baz a = Baz (a, a) deriving (Eq, Show)\n        -- ^^^ --\n\ninstance (Num a, TooMany a) =&gt; TooMany (Baz a) where\n   ...\n</code></pre>\n\n<p>I'm unsure about what the <code>Num a</code> is for, but I added that since you mentioned it.</p>\n"}], "owner": {"reputation": 2088, "user_id": 4281998, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/q8Jvt.png?s=128&g=1", "display_name": "Brady Dean", "link": "https://stackoverflow.com/users/4281998/brady-dean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 55129251, "answer_count": 1, "score": 1, "last_activity_date": 1552418603, "creation_date": 1552418256, "question_id": 55129179, "link": "https://stackoverflow.com/questions/55129179/add-type-variable-to-newtype-definition", "title": "Add type variable to newtype definition", "body": "<p>In an exercise from Haskell Programming from First Principles it says to declare an instance of <code>TooMany</code> for the type <code>(Num a, TooMany a) =&gt; (a, a)</code> by creating a <code>newtype</code> for it first. My problem is adding a typeclass constraint to <code>Baz</code>. Is it even possible? I cannot find any other examples online.</p>\n\n<pre><code>class TooMany a where\n  tooMany :: a -&gt; Bool\n\nnewtype Baz = Baz (a, a) deriving (Eq, Show)\n\ninstance TooMany Baz where\n  tooMany (Baz (n, _)) = n &gt; 42\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1552401853, "post_id": 55124206, "comment_id": 96989966, "body": "Do you understand the difference between <code>Char</code> and <code>[Char]</code>?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1552401856, "post_id": 55124206, "comment_id": 96989969, "body": "<code>[Char]</code> is a list of <code>Char</code>&#39;s - also known as a <code>String</code>. <code>[[Char]]</code> is a list of them. These are different types."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1552402013, "post_id": 55124206, "comment_id": 96990045, "body": "incidentally that function is (imo) better written as <code>revStr ls = map reverse ls</code>, or in pointfree style just <code>revStr = map reverse</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1552404169, "post_id": 55124206, "comment_id": 96991626, "body": "If all you want to do is reverse a <i>single</i> string, the type would be <code>[Char] -&gt; [Char]</code>. This function reverses each string in a <i>list</i> of strings."}, {"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 3, "creation_date": 1552405054, "post_id": 55124206, "comment_id": 96992245, "body": "Why is it downvoted?"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 1, "creation_date": 1552410360, "post_id": 55124206, "comment_id": 96995669, "body": "Simply playing with String (or [Char]) and [String] (or [[Char]]) could illuminate. There&#39;s no indication OP made even a tiny attempt to understand prior to coming to stackoverflow. Therefore, <a href=\"http://idownvotedbecau.se/noresearch/\" rel=\"nofollow noreferrer\">idownvotedbecau.se/noresearch</a>"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 7, "last_activity_date": 1552405041, "creation_date": 1552405041, "answer_id": 55125397, "question_id": 55124206, "link": "https://stackoverflow.com/questions/55124206/what-is-the-difference-between-char-and-char-in-haskell/55125397#55125397", "title": "What is the difference between [[Char]] and [Char] in Haskell?", "body": "<p><code>'a'</code> is a <code>Char</code>, a single character.</p>\n\n<p><code>['a','b','c']</code> is a string, a list-of-<code>Char</code>. This list can also be written as <code>\"abc\"</code>, using double quotes. Its type can be written as <code>String</code> or <code>[Char]</code>.</p>\n\n<p><code>[\"abc\", \"de\"]</code> is a list of strings. Its type can be written as <code>[String]</code> or <code>[[Char]]</code> (list-of-lists-of-<code>Char</code>).</p>\n\n<p>We could go on, and say that <code>[[\"abc\",\"de\"], [\"ef\", \"abc\"]]</code> is a <code>[[String]]</code> (list-of-lists-of-strings) or <code>[[[Char]]]</code>.</p>\n\n<p>Your <code>revStr</code> takes as input not a single string, but a list of strings, hence the <code>[[Char]]</code> type. Its output is again a list of strings.</p>\n"}, {"tags": [], "owner": {"reputation": 590, "user_id": 6184960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9168edfb66b98995cae68f6b46d81ef?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Yellow", "link": "https://stackoverflow.com/users/6184960/mr-yellow"}, "is_accepted": false, "score": 3, "last_activity_date": 1552405528, "creation_date": 1552405528, "answer_id": 55125559, "question_id": 55124206, "link": "https://stackoverflow.com/questions/55124206/what-is-the-difference-between-char-and-char-in-haskell/55125559#55125559", "title": "What is the difference between [[Char]] and [Char] in Haskell?", "body": "<ul>\n<li><code>Char</code> is a character, meaning a single symbol like <code>'A'</code>, <code>'$'</code> or <code>'3'</code></li>\n<li><code>[Char]</code> is a list of characters, also called a String (note <code>[Char] = String</code>) like <code>['A','$','3'] = \"A$3\"</code></li>\n<li><code>[[Char]]</code> is a list of lists of characters, (also <code>[[Char]] = [String]</code>). This is essentially a list of Strings like <code>[\"Hello\", \"World\"]</code></li>\n</ul>\n\n<p><code>revStr</code> reverses all Strings (or <code>[Char]</code>) in the provided List, thus its type is a list of Strings </p>\n"}], "owner": {"reputation": 27, "user_id": 11191746, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oRgZInNZucs/AAAAAAAAAAI/AAAAAAAAADw/Llng00ADqzM/photo.jpg?sz=128", "display_name": "Ah Gou", "link": "https://stackoverflow.com/users/11191746/ah-gou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 484, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1572080923, "creation_date": 1552401672, "last_edit_date": 1572080923, "question_id": 55124206, "link": "https://stackoverflow.com/questions/55124206/what-is-the-difference-between-char-and-char-in-haskell", "title": "What is the difference between [[Char]] and [Char] in Haskell?", "body": "<p>Why do I need to use [[ ]] in this function?</p>\n\n<p>Description: the function reverse all elements on the strings.</p>\n\n<pre><code>revStr :: [[Char]] -&gt; [[Char]]\nrevStr ls = [reverse s | s &lt;- ls]\n</code></pre>\n"}, {"tags": ["haskell", "tree", "nodes"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1552400804, "post_id": 55123697, "comment_id": 96989198, "body": "In the case <code>findpath f x (Data d)</code> don&#39;t you need to check whether <code>f d == x</code> ? Otherwise, <code>f</code> and <code>x</code> are never used! This is not the only issue, but you can start fixing this."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1552400868, "post_id": 55123697, "comment_id": 96989255, "body": "Well, you start with the problem that your list of paths can <i>never</i> be empty because none of your functions actually return an empty list. So you violate your own specification right away. You also never actually check if your <code>x</code> is equal to your <code>d</code>, so of course the paths you get are wrong."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1552403190, "post_id": 55123697, "comment_id": 96990936, "body": "This question is much improved compared to your previous draft, nice work!"}, {"owner": {"reputation": 692, "user_id": 9721893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nE50Z.jpg?s=128&g=1", "display_name": "Mantas Astra", "link": "https://stackoverflow.com/users/9721893/mantas-astra"}, "edited": false, "score": 0, "creation_date": 1552404859, "post_id": 55123697, "comment_id": 96992095, "body": "Thank you for the replies. I will amend my code using these recommendations."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1552405380, "post_id": 55123697, "comment_id": 96992461, "body": "As a hint try to handle the general case <code>findpath f x (Branch left right)</code> where <code>left</code> and <code>right</code> can be arbitrary subtrees. Right now you require that one of them is <code>Data ...</code>, which is not always the case. You need to use recursion and carefully add some <code>L</code> or <code>R</code> in the right places. Likely some concatenation of lists will be useful. It&#39;s not trivial when you are a beginner, so don&#39;t panic if you can&#39;t see the solution at first."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1552413230, "post_id": 55123697, "comment_id": 96997301, "body": "By the way, on a complete tangent, I think the spec for this function isn&#39;t so great. I&#39;d much prefer the type signature <code>findpath :: (a -&gt; Bool) -&gt; Btree a -&gt; [Path]</code>, and replace &quot;where f d is equal to x&quot; in the spec with &quot;where f d is True&quot;. This way callers can use other predicates than exact equality if they like. Of course, the two forms of <code>findpath</code> are easily interconvertible by <code>findpathDA f x = findpathDW ((x==) . f)</code> and <code>findpathDW p = findpathDA p True</code>, but still."}, {"owner": {"reputation": 692, "user_id": 9721893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nE50Z.jpg?s=128&g=1", "display_name": "Mantas Astra", "link": "https://stackoverflow.com/users/9721893/mantas-astra"}, "edited": false, "score": 0, "creation_date": 1552413388, "post_id": 55123697, "comment_id": 96997398, "body": "Thank you for your insight. It makes the function even better."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1552420616, "post_id": 55123697, "comment_id": 97000989, "body": "I thought at first that you might be able to apply <a href=\"https://stackoverflow.com/questions/36474647/haskell-depth-for-each-node-in-binary-tree-using-reader-monad\" title=\"haskell depth for each node in binary tree using reader monad\">stackoverflow.com/questions/36474647/&hellip;</a> here, but your type of tree is different enough that the trick in that answer won&#39;t work. The machinery you need to transfer that idea to this situation is rather too much for a Stack Overflow answer, but would probably make a good blog post!"}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 692, "user_id": 9721893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nE50Z.jpg?s=128&g=1", "display_name": "Mantas Astra", "link": "https://stackoverflow.com/users/9721893/mantas-astra"}, "edited": false, "score": 0, "creation_date": 1552411840, "post_id": 55125612, "comment_id": 96996507, "body": "@DrAnonymous Hah, whoops! I didn&#39;t quite transliterate the spec into code correctly in the <code>Data d</code> case. Can you spot the bug? =)"}, {"owner": {"reputation": 692, "user_id": 9721893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nE50Z.jpg?s=128&g=1", "display_name": "Mantas Astra", "link": "https://stackoverflow.com/users/9721893/mantas-astra"}, "edited": false, "score": 0, "creation_date": 1552412010, "post_id": 55125612, "comment_id": 96996603, "body": "So the bug is in the &quot;if f x == d&quot; namely &quot;x&quot;. I believe that it has something to do with Eq function and therefore, in this case, x type is not the same as Data d type. But I have no idea how to fix this. I kept staring at the code for the past hour :D"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 692, "user_id": 9721893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nE50Z.jpg?s=128&g=1", "display_name": "Mantas Astra", "link": "https://stackoverflow.com/users/9721893/mantas-astra"}, "edited": false, "score": 1, "creation_date": 1552412091, "post_id": 55125612, "comment_id": 96996658, "body": "@DrAnonymous I&#39;ll give you a very strong hint: spec says &quot;f d is equal to x&quot;, code says <code>f x == d</code>."}, {"owner": {"reputation": 692, "user_id": 9721893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nE50Z.jpg?s=128&g=1", "display_name": "Mantas Astra", "link": "https://stackoverflow.com/users/9721893/mantas-astra"}, "edited": false, "score": 0, "creation_date": 1552412232, "post_id": 55125612, "comment_id": 96996733, "body": "I thought about it and implemented it before. This got rid of the error but now every time I test the function it outputs empty list &quot;[]&quot;. So now I believe that there is an issue somewhere else in my code. Anyway, thank you for helping me!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 692, "user_id": 9721893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nE50Z.jpg?s=128&g=1", "display_name": "Mantas Astra", "link": "https://stackoverflow.com/users/9721893/mantas-astra"}, "edited": false, "score": 0, "creation_date": 1552412354, "post_id": 55125612, "comment_id": 96996811, "body": "@DrAnonymous Do you believe the empty list result is incorrect? For what call? What do you believe the correct result is?"}, {"owner": {"reputation": 692, "user_id": 9721893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nE50Z.jpg?s=128&g=1", "display_name": "Mantas Astra", "link": "https://stackoverflow.com/users/9721893/mantas-astra"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1552412377, "post_id": 55125612, "comment_id": 96996822, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/189901/discussion-between-dr-anonymous-and-daniel-wagner\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1552417950, "last_edit_date": 1552417950, "creation_date": 1552405684, "answer_id": 55125612, "question_id": 55123697, "link": "https://stackoverflow.com/questions/55123697/haskell-find-path-to-value-of-nodes/55125612#55125612", "title": "Haskell - find path to value of nodes", "body": "<p>Let's take things one case at a time, using exactly the cases from the data definition of <code>Btree</code>. That is, since</p>\n\n<pre><code>data Btree a = ND | Data a | Branch (Btree a) (Btree a)\n</code></pre>\n\n<p>then we will consider exactly the following shapes of trees, and no others:</p>\n\n<ol>\n<li><code>ND</code></li>\n<li><code>Data d</code></li>\n<li><code>Branch l r</code></li>\n</ol>\n\n<p>Let's begin.</p>\n\n<pre><code>findpath f x ND = {- TODO -}\n</code></pre>\n\n<p>Recall the specification:</p>\n\n<blockquote>\n  <p>Function findpath which given a function f, some data x and a tree t, returns the list of paths (possibly empty) in t to the nodes of the form Data d where f d is equal to x.</p>\n</blockquote>\n\n<p>(I've assumed where you wrote \"Node d\", you meant \"Data d\", to align with your definition of trees, and changed \"lists\" to \"list\".)</p>\n\n<p>In the current case, we have <code>f</code> and <code>x</code> as described, and <code>t = ND</code>. Substituting these in the description of what we should return, we get:</p>\n\n<blockquote>\n  <p>the list of paths in ND to the nodes of the form Data d where ...</p>\n</blockquote>\n\n<p>Since <code>ND</code> does not contain any nodes of the form <code>Data d</code>, there are no such paths. So:</p>\n\n<pre><code>findpath f x ND = []\n</code></pre>\n\n<p>Next case:</p>\n\n<pre><code>findpath f x (Data d) = {- TODO -}\n</code></pre>\n\n<p>Now we have <code>t = Data d</code>. Revising the spec again, we must return</p>\n\n<blockquote>\n  <p>the list of paths in <code>Data d</code> to the nodes of the form Data d where f d is equal to x.</p>\n</blockquote>\n\n<p>Okay, well, then we must check whether <code>f d</code> is equal to <code>x</code> or not, hey?</p>\n\n<pre><code>findpath f x (Data d) = if f d == x\n    then {- TODO -}\n    else {- TODO -}\n</code></pre>\n\n<p>If <code>f d == x</code>, then there's exactly one path to a node of the form Data d where f d is equal to x -- namely, the empty path. If not <code>f d == x</code>, then there's no such paths. So:</p>\n\n<pre><code>findpath f x (Data d) = if f d == x\n    then [[]]\n    else []\n</code></pre>\n\n<p>And the last case:</p>\n\n<pre><code>findpath f x (Branch l r) = {- TODO -}\n</code></pre>\n\n<p>Revising the specification once again, now with <code>t = Branch l r</code>, we must return</p>\n\n<blockquote>\n  <p>the list of paths in <code>Branch l r</code> to the nodes of the form Data d where f d is equal to x.</p>\n</blockquote>\n\n<p>Now you may feel a little bit stuck. After all, <code>l</code> and <code>r</code> are so general, that it's hard to know whether there are paths into them to nodes of the form Data d, right? So how can you discover whether there's a path into <code>Branch l r</code> that eventually ends at a Data d node? Of course, if there were only a way to find out the answer to those two subquestions, perhaps we could augment those paths, hey?</p>\n\n<p>Luckily, we have a function that answers the subquestion: <code>findpath</code> itself. So let's answer the subquestions, and then think about what to do.</p>\n\n<pre><code>findpath f x (Branch l r) = {- TODO -} where\n    pathsInL = findpath f x l\n    pathsInR = findpath f x r\n</code></pre>\n\n<p>Okay, so we have some paths in the tree <code>l</code> that lead to nodes of the form <code>Data d</code> where <code>f x</code> is equal to <code>d</code> (respectively, some paths in the tree <code>r</code>). How can we transform those paths to be paths in the tree <code>Branch l r</code>? Easy: by prepending <code>L</code> (respectively, <code>R</code>) to each of the paths. Then we can combine the two collections of paths together.</p>\n\n<p>At this point I am going to stop providing code: I think the key missing insight for you should already be above in the recursive skeleton provided. However, I will suggest some functions that you may find helpful while fleshing out the last little bits of the skeleton:</p>\n\n<ol>\n<li><code>(:)</code> can be used to prepend a new <code>Dir</code> to a <code>Path</code>.</li>\n<li><code>map</code> can be used to upgrade a function which modifies a single <code>Path</code> into one that modifies an entire list of <code>Path</code>s.</li>\n<li><code>(++)</code> can be used to concatenate two lists of <code>Path</code>s, producing a single list that has all the elements of each of its two arguments.</li>\n</ol>\n\n<p>Give it a shot, and let us know where you next get stuck!</p>\n"}], "owner": {"reputation": 692, "user_id": 9721893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nE50Z.jpg?s=128&g=1", "display_name": "Mantas Astra", "link": "https://stackoverflow.com/users/9721893/mantas-astra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "accepted_answer_id": 55125612, "answer_count": 1, "score": 4, "last_activity_date": 1552417950, "creation_date": 1552400308, "question_id": 55123697, "link": "https://stackoverflow.com/questions/55123697/haskell-find-path-to-value-of-nodes", "title": "Haskell - find path to value of nodes", "body": "<p>The question for this problem is:</p>\n\n<blockquote>\n  <p>Tree holds data of type a. Function findpath which given a function f, some data x and a tree t, returns the lists of paths (possibly empty) in t to the nodes of the form Node d where f d is equal to x. </p>\n</blockquote>\n\n<p>Declared structure of data types used in this problem:</p>\n\n<pre><code>data Btree a = ND | Data a |  Branch (Btree a) (Btree a)\n           deriving (Show,Eq)\n\ndata Dir = L | R \n       deriving (Show,Eq)\n\ntype Path =  [Dir]\n</code></pre>\n\n<p>My attempt to solve this function:</p>\n\n<pre><code>findpath :: Eq b =&gt; (a -&gt; b) -&gt; b -&gt; Btree a -&gt; [Path]\nfindpath f x (Data d)                = [[]]\nfindpath f x ND                      = [[]]\nfindpath f x (Branch (Data d) right) = [[L]] ++ (findpath f x right)\nfindpath f x (Branch left (Data d))  = [[R]] ++ (findpath f x left)\n</code></pre>\n\n<p>Data used for testing:</p>\n\n<pre><code>tree1 = Branch ND ND\ntree2 = Branch ND (Data 3)\ntree3 = Branch tree1 tree2\n</code></pre>\n\n<p>A function call to test the function:</p>\n\n<pre><code>1. findpath (2*) 3 tree2\n2. findpath (2*) 2 tree2\n3. findpath (2*) 3 tree1\n</code></pre>\n\n<p>The output it gives is:</p>\n\n<pre><code>1. [[R],[]]\n2. [[R],[]] - incorrect\n3. Throws exception\n</code></pre>\n\n<p>Any help on the findpath function will be highly appreciated. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 2, "creation_date": 1552394146, "post_id": 55121375, "comment_id": 96984602, "body": "Your pseudocode has the right idea.  Think of for loop as a function, and at the end of that function where you do the &gt;= test, decide whether the function should return the result of calling itself recursively (with different parameters) or simply return the result it has so far.  I don&#39;t think I understand your logic well enough to write a working example with confidence, but your function would likely be calling itself recursively on a smaller list of children with possibly updated values of value and alpha."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1552410742, "post_id": 55121375, "comment_id": 96995886, "body": "I see a tree at the Wikipedia page. Haskell is very good with trees (as it can be defined as a recursive data-structure). I would try to exploit that fact. Can&#39;t you do it using a recursive function for example?"}], "answers": [{"comments": [{"owner": {"reputation": 7892, "user_id": 3310334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/BTb0z.jpg?s=128&g=1", "display_name": "theonlygusti", "link": "https://stackoverflow.com/users/3310334/theonlygusti"}, "edited": false, "score": 0, "creation_date": 1552396533, "post_id": 55121845, "comment_id": 96986127, "body": "What&#39;s the recursive part meant to look like? To calculate newValue"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 7892, "user_id": 3310334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/BTb0z.jpg?s=128&g=1", "display_name": "theonlygusti", "link": "https://stackoverflow.com/users/3310334/theonlygusti"}, "edited": false, "score": 0, "creation_date": 1552396584, "post_id": 55121845, "comment_id": 96986181, "body": "I don&#39;t think I quite understand the question."}, {"owner": {"reputation": 7892, "user_id": 3310334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/BTb0z.jpg?s=128&g=1", "display_name": "theonlygusti", "link": "https://stackoverflow.com/users/3310334/theonlygusti"}, "edited": false, "score": 0, "creation_date": 1552396631, "post_id": 55121845, "comment_id": 96986221, "body": "<code>(alphabeta child alpha beta otherPlayer)</code> all of these terms are undefined and it&#39;s the part I find most difficult."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 7892, "user_id": 3310334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/BTb0z.jpg?s=128&g=1", "display_name": "theonlygusti", "link": "https://stackoverflow.com/users/3310334/theonlygusti"}, "edited": false, "score": 0, "creation_date": 1552396747, "post_id": 55121845, "comment_id": 96986300, "body": "<code>child</code> and <code>alpha</code> are defined, and the rest come from your own example, so I assumed you do have them defined somehow."}, {"owner": {"reputation": 7892, "user_id": 3310334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/BTb0z.jpg?s=128&g=1", "display_name": "theonlygusti", "link": "https://stackoverflow.com/users/3310334/theonlygusti"}, "edited": false, "score": 0, "creation_date": 1552397136, "post_id": 55121845, "comment_id": 96986580, "body": "alphabeta is the recursive function I am trying to build, the for loop is a little component inside of the definition of alphabeta. I just edited to make that clearer"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 7892, "user_id": 3310334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/BTb0z.jpg?s=128&g=1", "display_name": "theonlygusti", "link": "https://stackoverflow.com/users/3310334/theonlygusti"}, "edited": false, "score": 0, "creation_date": 1552397374, "post_id": 55121845, "comment_id": 96986764, "body": "Oooooh! Got it. Will amend the answer shortly."}, {"owner": {"reputation": 7892, "user_id": 3310334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/BTb0z.jpg?s=128&g=1", "display_name": "theonlygusti", "link": "https://stackoverflow.com/users/3310334/theonlygusti"}, "edited": false, "score": 0, "creation_date": 1552397416, "post_id": 55121845, "comment_id": 96986806, "body": "Sorry it was kind of unclear, I&#39;m frazzled at the moment and wrote the question lazily. In the end that made more work for you, thank you for all your help so far man\u2014and yeah sorry about that :c"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 7892, "user_id": 3310334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/BTb0z.jpg?s=128&g=1", "display_name": "theonlygusti", "link": "https://stackoverflow.com/users/3310334/theonlygusti"}, "edited": false, "score": 0, "creation_date": 1552400279, "post_id": 55121845, "comment_id": 96988791, "body": "Ok, amended the answer"}, {"owner": {"reputation": 7892, "user_id": 3310334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/BTb0z.jpg?s=128&g=1", "display_name": "theonlygusti", "link": "https://stackoverflow.com/users/3310334/theonlygusti"}, "edited": false, "score": 0, "creation_date": 1552401016, "post_id": 55121845, "comment_id": 96989356, "body": "Thanks. I managed to figure this out in the last hour lmao, my EUREKA! moment was just like 2 minutes before you updated the answer I was about to write my own x) Thanks for helping me out sm Fyodor"}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 5, "last_activity_date": 1552400252, "last_edit_date": 1552400252, "creation_date": 1552394808, "answer_id": 55121845, "question_id": 55121375, "link": "https://stackoverflow.com/questions/55121375/implement-procedural-for-loop-in-haskell-tracking-multiple-variables/55121845#55121845", "title": "implement procedural for loop in haskell, tracking multiple variables", "body": "<p>The most fundamental form of \"looping\" is recursion. In fact, <code>fold</code> is implemented via recursion under the hood, and while <code>fold</code> makes it more manageable and harder to get wrong, you can always drop down to the most basic level if you don't see how to use a fold.</p>\n\n<p>The rule of thumb is this: every time you would \"go to next iteration\", call the function recursively, and all the state that changes from one iteration to another becomes the function arguments. When you want to \"break\" from the loop - simply don't call the function recursively.</p>\n\n<p>With that said, your algorithm would look something like this:</p>\n\n<pre><code>alphabeta node initialAlpha beta player =\n    ...\n    let value = loop minBound initialAlpha (childrenOf node)\n    in\n    ...\n    where\n    loop value alpha [] = value \n    loop value alpha (child:restOfChildren) =\n        let newValue = max value (alphabeta child alpha beta otherPlayer)\n            newAlpha = max alpha value\n        in\n            if newAlpha &gt;= beta \n                then newValue \n                else loop newValue newAlpha restOfChildren\n</code></pre>\n\n<p>At the entry point, I call <code>loop</code> passing it <code>minBound</code> as <code>value</code> and all children of <code>node</code> as a list.</p>\n\n<p>The loop itself then matches on the list of children it's been passed: if the list is empty, the result of the loop is <code>value</code>; if the list of children is not empty, <code>loop</code> performs the calculation on the first child and then calls itself recursively, passing to the next iteration new values of <code>value</code> and <code>alpha</code>, and the rest of the children; unless <code>newAlpha &gt;= beta</code>, in which case the result of <code>loop</code> is the current (just-calculated) <code>value</code>.</p>\n"}], "owner": {"reputation": 7892, "user_id": 3310334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/BTb0z.jpg?s=128&g=1", "display_name": "theonlygusti", "link": "https://stackoverflow.com/users/3310334/theonlygusti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 55121845, "answer_count": 1, "score": 1, "last_activity_date": 1552400252, "creation_date": 1552393399, "last_edit_date": 1552397211, "question_id": 55121375, "link": "https://stackoverflow.com/questions/55121375/implement-procedural-for-loop-in-haskell-tracking-multiple-variables", "title": "implement procedural for loop in haskell, tracking multiple variables", "body": "<p>I am trying to do some alpha-beta pruning, <a href=\"https://en.wikipedia.org/wiki/Alpha%E2%80%93beta_pruning\" rel=\"nofollow noreferrer\">here's an example of an algorithm</a> I can understand and the algorithm I <em>think</em>  of when I think how I would approach this problem.</p>\n\n<p>But I have to write this in Haskell and am struggling to \"convert\" my way of thinking from procedural for-loops and variable etc. to Haskell's functional approach.</p>\n\n<p>The part that's got me stumped p much is how to write something like </p>\n\n<pre><code>function alphabeta(node, \u03b1, \u03b2, player) is\n    .\n    .\n    value := \u2212\u221e\n    for each child of node do\n        value := max(value, alphabeta(child, \u03b1, \u03b2, otherPlayer))\n        \u03b1 := max(\u03b1, value)\n        if \u03b1 \u2265 \u03b2 then\n            break (* \u03b2 cut-off *)\n    return value\n    .\n    .\n</code></pre>\n\n<p>I realise I can <em>kind of</em> do for-loops with a fold, e.g.</p>\n\n<pre><code>foldl (max ... alphabeta ...) -\u221e (children node)\n</code></pre>\n\n<p>But I see that I need to break from the loop when <code>\u03b1 \u2265 \u03b2</code>.</p>\n\n<p>I wondered if I could switch to using <code>scanl</code> and <code>dropWhile</code>, maybe something like</p>\n\n<pre><code>head $ dropWhile (&lt;b) $ scanl (max ... alphabeta ...) -\u221e (children node)\n</code></pre>\n\n<p>but no! looks like I am meant to compare the <em>changing</em> variable <code>\u03b1</code> with \u03b2.</p>\n\n<p>The for loop is constantly changing and using (in its recursion) two different variables, <code>\u03b1</code> and <code>value</code>, and that's what's throwing me off, I have no idea how to \"track\" two different variables that influence each other (so like, figuring out a recursive solution as I may attempt for single-variable loops becomes difficult, at least to me).</p>\n\n<p>I'm just wondering what I can do to better understand how to approach this problem.</p>\n"}, {"tags": ["performance", "haskell", "io", "writefile"], "comments": [{"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "edited": false, "score": 1, "creation_date": 1552391959, "post_id": 55120077, "comment_id": 96983367, "body": "Is it faster if you batch the writes?  Something like <code>T.replicate 10 dat</code> or even 1000x."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1552392874, "post_id": 55120077, "comment_id": 96983881, "body": "Did you compile with optimisations turned on? Writing a 14GB file with more or less what you&#39;re doing here takes me about 5 mins on my machine. (Also, you forgot to close your file after writing to it, you should just use <code>withFile</code> rather than <code>openFile</code> tbh)"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1552393565, "post_id": 55120077, "comment_id": 96984277, "body": "I have  not compiled with optimizations turned on. (I &#39;m still a beginner)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1552393950, "post_id": 55120077, "comment_id": 96984491, "body": "Using bytestrings and with optimizations on, your code created a 4GB file in 43s. A main issue here is that <code>Text</code> is stored as UTF16 while file output is usually is UTF8, so conversion will require some time. Building a bytestring once, I converted <code>dat</code> only once for the whole program. In a real-world scenario, however, you might have a lot of different lines. If skipping <code>Text</code> is an option, I&#39;d try to go for that."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1552394003, "post_id": 55120077, "comment_id": 96984520, "body": "Apparently after i closed the <code>handle</code> it worked a lot faster , as <b>@Cubic</b> pointed out."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1552490306, "post_id": 55120077, "comment_id": 97031266, "body": "General advice: text files bigger than a few MB are a bad idea. Use binary formats for all significant amounts of data."}], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 3, "last_activity_date": 1552471615, "creation_date": 1552471615, "answer_id": 55139166, "question_id": 55120077, "link": "https://stackoverflow.com/questions/55120077/how-to-write-big-file-efficiently-in-haskell/55139166#55139166", "title": "How to write big file efficiently in Haskell", "body": "<p>I would recommend using a Builder for this, which is an efficient way to fill up buffers and can be written directly to a Handle.</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack --resolver ghc-8.6.4 script\n{-# LANGUAGE OverloadedStrings #-}\nimport Data.ByteString.Builder (Builder, hPutBuilder)\nimport Data.Foldable (fold)\nimport System.IO (IOMode (WriteMode), withBinaryFile)\n\npt :: FilePath\npt = \"data2.csv\"\n\ncnt :: Int\ncnt = 400000000\n\nmain :: IO ()\nmain = writeWithHandle pt dat\n\ndat :: Builder\ndat = \"0744442339\"\n\nwriteWithHandle :: FilePath -&gt; Builder -&gt; IO ()\nwriteWithHandle path tx =\n  withBinaryFile path WriteMode $ \\h -&gt;\n  hPutBuilder h $ makeBuilder cnt tx\n\nmakeBuilder :: Int -&gt; Builder -&gt; Builder\nmakeBuilder cnt payload = fold $ replicate cnt $ payload &lt;&gt; \"\\n\"\n</code></pre>\n\n<p>You can keep <code>payload</code> as a <code>Text</code> value instead if you'd like, and convert to a <code>Builder</code> using <a href=\"https://www.stackage.org/haddock/lts-13.12/text-1.2.3.1/Data-Text-Encoding.html#v:encodeUtf8Builder\" rel=\"nofollow noreferrer\"><code>encodeUtf8Builder</code></a>.</p>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 55139166, "answer_count": 1, "score": 1, "last_activity_date": 1552471615, "creation_date": 1552389018, "last_edit_date": 1552389383, "question_id": 55120077, "link": "https://stackoverflow.com/questions/55120077/how-to-write-big-file-efficiently-in-haskell", "title": "How to write big file efficiently in Haskell", "body": "<p>Hello i am trying to write a <code>~1GB</code> file in a timely manner.Is there any recommended  method.Up until now the process takes somewhere in the order of tens of minutes . Am i wrong in using <code>Text</code> should i use <code>ByteString</code> ? (I have also used <code>String</code>)</p>\n\n<pre><code>    pt=\"d:\\\\data2.csv\"\n    cnt=400000000\n\n    main::IO()\n    main=do\n        let payload=dat\n        writeWithHandle pt dat\n\n\n    dat::Text\n    dat=Data.Text.pack \"0744442339\"\n\n\n    writeWithHandle::FilePath-&gt;Text-&gt;IO()\n    writeWithHandle path tx=do\n        handle&lt;-openFile path WriteMode\n        writeTimes cnt handle dat\n\n    writeTimes::Int-&gt;Handle-&gt;Text-&gt;IO()\n    writeTimes cnt handle payload= forM_ ([0..cnt])  (\\x-&gt;Data.Text.IO.hPutStrLn handle payload)\n</code></pre>\n\n<p>I do not understand why it is taking so much in the order of tens of minutes.Initially i was using <code>writeFile</code> but i thought that would mean continously opening and closing the <code>file</code> for each row so i used <code>appendFile</code> to no avail.</p>\n"}, {"tags": ["haskell", "idioms"], "comments": [{"owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 15, "creation_date": 1552345828, "post_id": 55111687, "comment_id": 96966060, "body": "What happened when you tried having multiple underscores?"}, {"owner": {"reputation": 7892, "user_id": 3310334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/BTb0z.jpg?s=128&g=1", "display_name": "theonlygusti", "link": "https://stackoverflow.com/users/3310334/theonlygusti"}, "reply_to_user": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 3, "creation_date": 1552349500, "post_id": 55111687, "comment_id": 96966964, "body": "@MarcTalbot I didn&#39;t know <code>_</code> was special in Haskell, I was assuming like in other programming languages <code>_</code> was just another valid identifier. I didn&#39;t try having multiple underscores before asking the question, probably it didn&#39;t enter my mind to do so, or I considered it a waste of time because &quot;it would error anyway&quot;, or I was scared that even if it ran successfully I was screwing something else up somewhere (imagine it cloned the first argument or something). I felt more comfortable asking first, sorry."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1552352657, "post_id": 55111687, "comment_id": 96967762, "body": "you&#39;ve nothing to be sorry for. :( check out <a href=\"https://wiki.haskell.org/Keywords#.5C\" rel=\"nofollow noreferrer\">wiki.haskell.org/Keywords#.5C</a> (the entry for <code>_</code> is next under it)."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1552393715, "post_id": 55111687, "comment_id": 96984352, "body": "@theonlygusti Even in languages where <code>_</code> <i>is</i> just another identifier, there is (or may be) no problem. You can write <code>_, _, y, _ = (&quot;w&quot;, &quot;x&quot;, &quot;y&quot;, &quot;z&quot;)</code> in Python, for example."}, {"owner": {"reputation": 7892, "user_id": 3310334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/BTb0z.jpg?s=128&g=1", "display_name": "theonlygusti", "link": "https://stackoverflow.com/users/3310334/theonlygusti"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1552394147, "post_id": 55111687, "comment_id": 96984603, "body": "@chepner in python <code>def f(_,_,y,_)</code> doesn&#39;t work, and <code>_, _, y, _ = (&quot;w&quot;, &quot;x&quot;, &quot;y&quot;, &quot;z&quot;)</code> is not really like a function definition, but anyway it just sets <code>_</code> to <code>&#39;z&#39;</code> because the <code>_</code> means the same thing every time, which would be a problem in haskell (because the arguments are not the same thing every time)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1552395443, "post_id": 55111687, "comment_id": 96985424, "body": "The point about function definitions holds, but if you don&#39;t care about the value of <code>_</code>, then it doesn&#39;t matter if <code>_</code> gets assigned <code>&quot;w&quot;</code>, <code>&quot;x&quot;</code>, or <code>&quot;z&quot;</code>, because you are never planning to <i>read</i> the value of <code>_</code>."}, {"owner": {"reputation": 7892, "user_id": 3310334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/BTb0z.jpg?s=128&g=1", "display_name": "theonlygusti", "link": "https://stackoverflow.com/users/3310334/theonlygusti"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1552395541, "post_id": 55111687, "comment_id": 96985497, "body": "@chepner I suspect Haskell would complain if I did <code>f :: Int -&gt; Bool -&gt; String -&gt; Int</code> and then <code>f a a v a = ...</code>. And similarly, Haskell&#39;s analogue of Python&#39;s tuple-decomposition assignment <code>(a,a,a) = (&#39;a&#39;,&#39;b&#39;,&#39;c&#39;)</code> also errors. I don&#39;t really see the comparison between your Python example and my question :("}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1552396158, "post_id": 55111687, "comment_id": 96985885, "body": "Yes, it would complain, because pattern matching isn&#39;t just assigning names to parameters. It&#39;s matching the <i>values</i> of the arguments. <code>f 3 True &quot;bob&quot; = ...</code> is a perfectly valid use of <i>refutable</i> patterns; a name like <code>a</code> is simply a an <i>irrefutable</i> pattern, but the names have to be unique. I never claimed that <code>_</code> was an ordinary pattern in Haskell."}], "answers": [{"comments": [{"owner": {"reputation": 7892, "user_id": 3310334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/BTb0z.jpg?s=128&g=1", "display_name": "theonlygusti", "link": "https://stackoverflow.com/users/3310334/theonlygusti"}, "edited": false, "score": 2, "creation_date": 1552346304, "post_id": 55111762, "comment_id": 96966163, "body": "oh I didn&#39;t know it was actually a language feature"}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "reply_to_user": {"reputation": 7892, "user_id": 3310334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/BTb0z.jpg?s=128&g=1", "display_name": "theonlygusti", "link": "https://stackoverflow.com/users/3310334/theonlygusti"}, "edited": false, "score": 2, "creation_date": 1552346421, "post_id": 55111762, "comment_id": 96966197, "body": "@theonlygusti yeah the whole point about <code>_</code> is that it&#39;s a wildcard in the pattern matching"}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 3, "creation_date": 1552375979, "post_id": 55111762, "comment_id": 96973987, "body": "I&#39;d just add that you can avoid that last warning if you name the parameter starting with underscore: <code>_a</code>."}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1552406679, "post_id": 55111762, "comment_id": 96993400, "body": "That&#39;s because you&#39;re actually assigning the value to the variable, so memory is actually allocated. With Haskell laziness you might not see the difference but you can actually use that variable in your computation, unlike for a simple underscore"}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "reply_to_user": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1552406715, "post_id": 55111762, "comment_id": 96993426, "body": "@AlexeyRomanov if you try to run <code>f _a = _a</code> it will compile and work"}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1552410088, "post_id": 55111762, "comment_id": 96995506, "body": "@Lorenzo I meant that <code>g _a b = b</code> won&#39;t give you a warning (and this applies to all <code>-Wunused-*</code> warnings, not just to function parameters)."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1552410392, "post_id": 55111762, "comment_id": 96995684, "body": "@Lorenzo &quot;That&#39;s because you&#39;re actually assigning the value to the variable, so memory is actually allocated.&quot; I think that&#39;s incorrect, and anyway that would apply to <code>g a b = b</code> exactly the same (unless I misunderstood what you meant)."}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "reply_to_user": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1552414988, "post_id": 55111762, "comment_id": 96998232, "body": "@AlexeyRomanov Sorry, misread your comment, you&#39;re totally right."}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": true, "score": 11, "last_activity_date": 1552346055, "creation_date": 1552346055, "answer_id": 55111762, "question_id": 55111687, "link": "https://stackoverflow.com/questions/55111687/how-to-have-multiple-throwaway-arguments/55111762#55111762", "title": "how to have multiple throwaway arguments", "body": "<p>You can definitely have more than one underscore in the same function. As they are not assigned to any value, it wouldn't override anything.</p>\n\n<p>It is also easier to read, as you know it won't matter what the value is and you can pay attention to what actually contributes to the result. Also, If you enable all the warnings when compiling, you will actually get an error if you do not use an argument that has a name:</p>\n\n<pre><code>g a b = b\n</code></pre>\n\n<p>will return a <code>Warning: Defined but not used: 'a'</code></p>\n"}], "owner": {"reputation": 7892, "user_id": 3310334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/BTb0z.jpg?s=128&g=1", "display_name": "theonlygusti", "link": "https://stackoverflow.com/users/3310334/theonlygusti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 55111762, "answer_count": 1, "score": 1, "last_activity_date": 1552346055, "creation_date": 1552345555, "question_id": 55111687, "link": "https://stackoverflow.com/questions/55111687/how-to-have-multiple-throwaway-arguments", "title": "how to have multiple throwaway arguments", "body": "<p>I know it's common to have functions like</p>\n\n<pre><code>f _ [] = Nothing\nf a (x:xs) = ...\n</code></pre>\n\n<p>in Haskell it seems idiomatic that <code>_</code> is the throwaway parameter name.</p>\n\n<p>What if I have lots I don't care about? E.g.</p>\n\n<pre><code>g _ _ [] _     = Nothing\ng a _ (x:xs) b = ...\n</code></pre>\n\n<p>is what I would like to write but I don't think I can have multiple <code>_</code> in one definition.</p>\n\n<p>So what should I do when I don't care about a lot of them?</p>\n"}, {"tags": ["haskell", "ghc", "cabal", "haskell-stack", "cabal-install"], "answers": [{"tags": [], "owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "is_accepted": false, "score": 3, "last_activity_date": 1552345301, "creation_date": 1552345301, "answer_id": 55111649, "question_id": 55111027, "link": "https://stackoverflow.com/questions/55111027/stack-only-finds-newer-version-of-cabal/55111649#55111649", "title": "Stack only finds newer version of Cabal", "body": "<p>Stack solver error messages are known to be bad and choke on cabal output. I don't believe this feature is well maintained.</p>\n\n<p>I do wish stack would update its errors and warnings. Sticking with cabal-install-2.4.1.0 is probably the best choice.</p>\n\n<p>Instead of using <code>stack solver</code>, I recommend you force it to use lts-13.12 and then add extra deps by hand to address any issues you encounter. Most of the time stack will helpfully recommend the right extra deps (without using the solver), but you do need to apply some intuition to make sure they are right.</p>\n"}], "owner": {"reputation": 7230, "user_id": 788337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wiVpx.png?s=128&g=1", "display_name": "jmite", "link": "https://stackoverflow.com/users/788337/jmite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1552345301, "creation_date": 1552341444, "question_id": 55111027, "link": "https://stackoverflow.com/questions/55111027/stack-only-finds-newer-version-of-cabal", "title": "Stack only finds newer version of Cabal", "body": "<p>I'm trying to build a project of mine using Stackage lts-13.12. </p>\n\n<p>After Stack was complaining that the version of Cabal was too new, I've tried to install an older version:</p>\n\n<pre><code>cabal --version\n  cabal-install version 2.2.0.0\n  compiled using version 2.2.0.1 of the Cabal library \n</code></pre>\n\n<p>However, when I run <code>stack solver</code>, I get the following error:</p>\n\n<pre><code>Using configuration file: stack.yaml\nUsing cabal packages:\n- ./\n\nUsing resolver: lts-13.12\n\nWarning: Installed version of cabal-install (2.4.1.0) is newer than stack has been tested with.  If you run into difficulties, consider downgrading.\n\nUsing compiler: ghc-8.6.4\nAsking cabal to calculate a build plan...\nTrying with packages from lts-13.12 and 1 external packages as hard constraints...\nThe following lines from cabal-install output could not be parsed: \noptparse-applicative-0.14.3.0 (via: project-0.1.0.0 project-0.1.0.0) (new\npackage)\nCallStack (from HasCallStack):\n  error, called at src/Stack/Solver.hs:174:16 in stack-1.9.3-F7FXKCpM3pk5wCtbL9Utvv:Stack.Solver\n</code></pre>\n\n<p>My questions are:</p>\n\n<ul>\n<li>Why is Stack seeing the newer Cabal? How can I make it see the older one?</li>\n<li>Why is Stack incompatible with Cabal 2.4.1.0, when that's the version in the Stackage LTS 13.12?</li>\n</ul>\n\n<p>I'm running <code>Version 1.9.3</code> of Stack, if that makes a difference.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1552342355, "post_id": 55110643, "comment_id": 96965068, "body": "<code>ReaderT</code> won&#39;t let you update the state"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 3, "creation_date": 1552342820, "post_id": 55110643, "comment_id": 96965238, "body": "If your <code>ReaderT</code> is over <code>IO</code>, you can keep a mutable reference in your environment and use it to store state. For an example of library that uses this trick, <code>RIO</code> has a <code>MonadState</code> instance when a <code>SomeRef</code> is in the environment <a href=\"http://hackage.haskell.org/package/rio-0.1.8.0/docs/RIO.html#t:RIO\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/rio-0.1.8.0/docs/RIO.html#t:RIO</a>"}], "answers": [{"comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 4, "creation_date": 1552378682, "post_id": 55111788, "comment_id": 96975243, "body": "Here&#39;s an example of doing this with rio: <a href=\"https://gist.github.com/snoyberg/ce5600bbc102cb0a70611e14ecdbf2ef\" rel=\"nofollow noreferrer\">gist.github.com/snoyberg/ce5600bbc102cb0a70611e14ecdbf2ef</a>"}, {"owner": {"reputation": 639, "user_id": 10654293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N3y4b1ilweA/AAAAAAAAAAI/AAAAAAAAAAQ/nO5VTzQiUu0/photo.jpg?sz=128", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/10654293/mcbear-holden"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 1, "creation_date": 1552383100, "post_id": 55111788, "comment_id": 96977740, "body": "@MichaelSnoyman Wow thanks, Michael! So honored to get a direct gist from you:)"}], "tags": [], "owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "is_accepted": true, "score": 8, "last_activity_date": 1552346239, "creation_date": 1552346239, "answer_id": 55111788, "question_id": 55110643, "link": "https://stackoverflow.com/questions/55110643/haskell-readert-design-pattern-vs-mtl-statet-pattern/55111788#55111788", "title": "Haskell ReaderT Design Pattern vs mtl StateT pattern", "body": "<p>From what I've seen, ReaderT pattern users typically don't use the MonadState lens operators. Instead, use <code>view</code> to access the desired MVar (or whatever kind of mutable var you're dealing with) and update that as usual (e.g. with modifyMVar).</p>\n\n<p>The RIO monad offers an appropriate MonadState instance, though. A better answer than mine could probably adapt your code to the RIO monad fairly easily.</p>\n"}], "owner": {"reputation": 639, "user_id": 10654293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N3y4b1ilweA/AAAAAAAAAAI/AAAAAAAAAAQ/nO5VTzQiUu0/photo.jpg?sz=128", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/10654293/mcbear-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 625, "favorite_count": 2, "accepted_answer_id": 55111788, "answer_count": 1, "score": 15, "last_activity_date": 1552346239, "creation_date": 1552339535, "last_edit_date": 1552343067, "question_id": 55110643, "link": "https://stackoverflow.com/questions/55110643/haskell-readert-design-pattern-vs-mtl-statet-pattern", "title": "Haskell ReaderT Design Pattern vs mtl StateT pattern", "body": "<p>I'm designing a small game which basically uses StateT and just updating the state. Below is the simplified version:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n\nimport           Control.Lens\nimport           Control.Monad\nimport           Control.Monad.IO.Class\nimport           Control.Monad.State\nimport           Control.Monad.State.Class\nimport           System.Random\n\ndata PlayerState = PlayerState {\n  _psName  :: String,\n  _psScore :: Int\n                               } deriving (Show)\n\nmakeClassy ''PlayerState\n\ndata Game = Game {\n  _turns   :: Int,\n  _players :: [PlayerState]\n                 } deriving (Show)\n\nmakeClassy ''Game\n\nrandomGameInit :: IO Game\nrandomGameInit = do\n  players &lt;- replicateM 5 $  PlayerState &lt;$&gt; (replicateM 4 $ randomRIO ('a', 'z')) &lt;*&gt; randomRIO (1,10)\n  return $ Game 0 players\n\nupdate :: (MonadState s m, HasGame s) =&gt; m ()\nupdate = do\n  players . ix 0 . psName %= (\\_ -&gt; \"mordor\")\n  turns %= (+1)\n  exitCondition &lt;- fmap (&gt;10) (turns &lt;%= id)\n  unless exitCondition update\n\nmain :: IO ()\nmain = do\n  init &lt;- randomGameInit\n  runStateT update init &gt;&gt; print \"Game Over\"\n</code></pre>\n\n<p>I've recently learned about the <a href=\"https://www.fpcomplete.com/blog/2017/06/readert-design-pattern\" rel=\"noreferrer\">ReaderT Design Pattern vs mtl StateT</a>, which encourages replacing <code>StateT</code> with a mutable reference inside a <code>ReaderT</code> over <code>IO</code>.</p>\n\n<p>I wonder how I should adapt the code using ReaderT. Most specifically, many <code>Lens</code> functions have types: <code>(MonadState s m)</code> which apparently need to be inside a State. Does this mean that <code>Lens</code> library functions are designed for StateT and not ReaderT?  How to use <code>Lens</code> with <code>ReaderT</code> design pattern?</p>\n"}, {"tags": ["haskell", "tree", "fold"], "comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1552337163, "post_id": 55109855, "comment_id": 96963077, "body": "<code>foldTree f g tree</code> basically applies <code>f</code> to each leaf of the tree, then recursively applies <code>g</code> between the components of each <code>Node</code>, so e.g. <code>foldTree f g (Node (Node (Leaf 1) (Leaf 2)) (Leaf 4)) = g (g (f 1) (f 2)) (f 4)</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1552381779, "post_id": 55109855, "comment_id": 96976948, "body": "... or IOW, <code>(f 1 `g` f 2) `g` f 4</code> == <code>((*2) 1 + (*2) 2) + (*2) 4</code> == <code>(1*2 + 2*2) + 4*2</code>."}, {"owner": {"reputation": 395, "user_id": 11019303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bfaec7dd8db91951fb7515a3908c60?s=128&d=identicon&r=PG&f=1", "display_name": "Sniper", "link": "https://stackoverflow.com/users/11019303/sniper"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1552410776, "post_id": 55109855, "comment_id": 96995897, "body": "@bradrn Thanks, I understand what you said, but i am confused how it interpreted to apply g to the components of Node. And what would be the definition of g in this case? How it interpreted (b-&gt;b-&gt;b) function whereas to me it just seems, same as function (a-&gt;b).  Apologies, i am beginner in this."}, {"owner": {"reputation": 395, "user_id": 11019303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bfaec7dd8db91951fb7515a3908c60?s=128&d=identicon&r=PG&f=1", "display_name": "Sniper", "link": "https://stackoverflow.com/users/11019303/sniper"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1552411302, "post_id": 55109855, "comment_id": 96996193, "body": "@bradrn how it mapped (\\x y -&gt; x + y) to (b-&gt;b-&gt;b) what is x and y after first function passed the output to (\\x y -&gt; x + y)"}], "answers": [{"comments": [{"owner": {"reputation": 395, "user_id": 11019303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bfaec7dd8db91951fb7515a3908c60?s=128&d=identicon&r=PG&f=1", "display_name": "Sniper", "link": "https://stackoverflow.com/users/11019303/sniper"}, "edited": false, "score": 0, "creation_date": 1552412118, "post_id": 55110790, "comment_id": 96996673, "body": "Thanks for detailed answer. It treated g as a binary data constructor? Why we replaced g with the Node? Whereas Node is a part of Tree where as (b-&gt;b-&gt;b) is a separate binary function?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 395, "user_id": 11019303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bfaec7dd8db91951fb7515a3908c60?s=128&d=identicon&r=PG&f=1", "display_name": "Sniper", "link": "https://stackoverflow.com/users/11019303/sniper"}, "edited": false, "score": 2, "creation_date": 1552412499, "post_id": 55110790, "comment_id": 96996889, "body": "@Sniper <code>g</code> indeed plays the role of the binary constructor <code>Node</code>, when folding. We replace <code>Node</code> with <code>g</code> since that&#39;s how <code>foldTree</code> is defined: <code>foldTree f g (Node .. ..) = g (..) (..)</code>, so a <code>Node</code> becomes <code>g</code> when expanding the definition. Essentially, <code>Node</code> is a binary constructor function function taking two <code>Tree</code>s, while <code>g</code> generalizes that to take any two <code>b</code>s. Similarly, <code>Leaf ...</code> becomes <code>f ..</code> when expanding the definition."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1552340239, "creation_date": 1552340239, "answer_id": 55110790, "question_id": 55109855, "link": "https://stackoverflow.com/questions/55109855/how-this-fold-tree-function-works-in-haskell/55110790#55110790", "title": "How this Fold Tree Function works in Haskell", "body": "<p>To understand the result of <code>foldTree f g tree</code> you can use this technique:</p>\n\n<ul>\n<li>Write down the value of <code>tree</code> using the constructors, e.g. in your example we have <code>(Node (Node (Leaf 1) (Leaf 2)) (Leaf 4))</code>.</li>\n<li>Syntactically replace <code>Leaf</code> with <code>f</code> and <code>Node</code> with <code>g</code>. For the previous example, we get <code>(g (g (f 1) (f 2)) (f 4))</code>.</li>\n<li>Use the definitions of functions <code>f</code> and <code>g</code> to compute the result of the last expression. For the example, we get <code>((+) ((+) ((*2) 1) ((*2) 2)) ((*2) 4))</code> which is\n<code>((+) ((+) (1*2) (2*2)) (4*2))</code> which is <code>((1*2) + (2*2)) + (4*2)</code> which is <code>(2+4)+8 = 14</code>.</li>\n</ul>\n\n<p>Note how we replace <code>Leaf</code> a unary constructor with <code>f</code>, a unary function, and <code>Node</code>, a binary constructor with <code>g</code>, a binary function. So, we always have the right number of arguments for our functions. More in general, the types will match just fine.</p>\n"}], "owner": {"reputation": 395, "user_id": 11019303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bfaec7dd8db91951fb7515a3908c60?s=128&d=identicon&r=PG&f=1", "display_name": "Sniper", "link": "https://stackoverflow.com/users/11019303/sniper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 55110790, "answer_count": 1, "score": 1, "last_activity_date": 1552382987, "creation_date": 1552335965, "last_edit_date": 1552382987, "question_id": 55109855, "link": "https://stackoverflow.com/questions/55109855/how-this-fold-tree-function-works-in-haskell", "title": "How this Fold Tree Function works in Haskell", "body": "<p>Here i am trying to understand this function which folds a tree to one value. It shows that foldTree takes two functions as arguments, it applies first function to the element of the <code>Tree a</code> and then passes the result to second function <code>(b-&gt;b-&gt;b)</code> which again performs some operation and produces final result. </p>\n\n<pre><code>foldTree :: (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Tree a -&gt; b\nfoldTree f g (Leaf x) = f x\nfoldTree f g (Node tl tr) = g (foldTree f g tl) (foldTree f g tr) \n</code></pre>\n\n<p>I am trying following input to see how it works.    </p>\n\n<pre><code>Input 1:  foldTree (*2) (\\x y -&gt; x + y) (Leaf 6)\nInput 2:  foldTree (*2) (\\x y -&gt; x + y) (Node (Node (Leaf 1) (Leaf 2)) (Leaf 4))\n</code></pre>\n\n<p>It returns </p>\n\n<pre><code>Output 1 : 12\nOutput 2 : 14\n</code></pre>\n\n<p>The problem i am facing in understanding is where the second function argument operation is performed? and how it actually passes the values to the second function, apparently second function takes two values as arguments but first function only returns one value... from where the second value is passed? Can i say it took result of first function <em>twice</em> so that <code>x</code> and <code>y</code> values are same? because second function <code>(\\x y -&gt; x + y)</code> takes <em>two</em> arguments? but then result would not be same as mentioned in output 1 and 2. </p>\n\n<p>Secondly does it return the final result after performing second function or it returns the result after applying only the first function because i am confused even i removed second function it produces the same results. </p>\n\n<p>Thirdly what is the purpose of <code>g</code> here outside of two curly brackets? <code>***g*** (foldTree f g tl) (foldTree f g tr)</code> it took it as a Data constructor from the start or what? I know data constructor can be constructed as smart constructors but here how it treated. </p>\n\n<p>I am so confused understanding this, may be i am complicating a lot of concepts in this one? Please don't hesitate to go into details. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1552334648, "post_id": 55109509, "comment_id": 96961937, "body": "<code>(+) :: Num a =&gt; a -&gt; a -&gt; a</code>; you want something with type <code>Char -&gt; Char -&gt; [Char]</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1552337401, "post_id": 55109509, "comment_id": 96963179, "body": "Even if you <i>did</i> come up with a definition of <code>+</code> that fit the signature, you can&#39;t define a <code>Num</code> instance without also defining <code>(*)</code>, <code>abs</code>, <code>signum</code>, <code>fromInteger</code>, and either <code>negate</code> or <code>(-)</code>. And if you <i>do</i> define them, they still need to obey various laws like <code>a + b == b + a</code> and <code>x + fromInteger 0 == x</code>. The kind of operator overloading provided by type classes is not the free-for-all, any-definition-goes kind provided by other languages."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1552348042, "post_id": 55109509, "comment_id": 96966607, "body": "@chepner The built-in <code>Natural</code> type doesn&#39;t have a reasonable definition of <code>negate</code> or <code>(-)</code>, and it breaks a lot of the &quot;laws&quot; (which aren&#39;t actually defined in the report)."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 7036574, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6c64c58d7a2241d71fce37ca79ded53b?s=128&d=identicon&r=PG&f=1", "display_name": "kalle konsida", "link": "https://stackoverflow.com/users/7036574/kalle-konsida"}, "edited": false, "score": 0, "creation_date": 1552335043, "post_id": 55109553, "comment_id": 96962101, "body": "I see, but if i took two strings as input and concatinated them, in other words a typesignature [Char] -&gt; [Char] -&gt; [Char], it would then be possible to define (+) on [Char] ?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 111, "user_id": 7036574, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6c64c58d7a2241d71fce37ca79ded53b?s=128&d=identicon&r=PG&f=1", "display_name": "kalle konsida", "link": "https://stackoverflow.com/users/7036574/kalle-konsida"}, "edited": false, "score": 4, "creation_date": 1552335493, "post_id": 55109553, "comment_id": 96962282, "body": "The compiler would not complain, but any humans reading your program would."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1552335998, "post_id": 55109553, "comment_id": 96962495, "body": "The <a href=\"https://www.stackage.org/haddock/lts-13.12/base-4.12.0.0/Prelude.html#t:Num\" rel=\"nofollow noreferrer\">docs for <code>Num</code></a> specify a few laws that instances should satisfy, and concatenating strings wouldn&#39;t fit them. For example, string concatenation wouldn&#39;t satisfy addition commutativity. The compiler will not object, but such instance will have weird behavior, unobvious to other people, and thus will lead to subtle bugs."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1552340770, "post_id": 55109553, "comment_id": 96964514, "body": "Also, it occurs to me now, the compiler <i>would</i> complain. You must define an instance for <code>[a]</code> in general, and cannot specialize to only <code>[Char]</code>. You could define addition for lists to be concatenation, but of course this would be widely reviled."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 6, "last_activity_date": 1552334677, "creation_date": 1552334677, "answer_id": 55109553, "question_id": 55109509, "link": "https://stackoverflow.com/questions/55109509/define-addition-as-an-instance-of-num-in-haskell/55109553#55109553", "title": "define addition as an instance of Num in haskell", "body": "<p>This is impossible. The <code>(+)</code> function in <code>Num</code> has type <code>a -&gt; a -&gt; a</code>, so the return type must be the same as the parameter type. You cannot add two Char and receive a String as a result. More generally, you should not implement Num for things other than arithmetic on numbers.</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1552337782, "post_id": 55110061, "comment_id": 96963345, "body": "Bringing out the big cannons, eh? <code>on</code>, <code>pure</code>... you just barely missed generalizing <code>(++)</code> to <code>(&lt;&gt;)</code> to make it as inscrutable as possible. We have lost touch with how simple Haskell can be, it seems. <code>a ^+ b = [a, b]</code> (Upvoted anyway.)"}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1552344347, "post_id": 55110061, "comment_id": 96965713, "body": "Sorry, I performed what I thought was an edit suggestion but ended up actually editing the answer; my SO is a bit rusty.  I agree with the main idea of the answer, but proposed a more reasonable implementation of <code>^+</code>.  Feel free to edit back if you feel like the original implementation is more reasonable."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1552375490, "post_id": 55110061, "comment_id": 96973726, "body": "@JustinL. You have enough reputation that your edits don&#39;t need peer review: you&#39;re expected to know well enough how things work and not make wantonly unreasonable edits. Case in point: this edit was totally reasonable."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1552391219, "post_id": 55110061, "comment_id": 96982907, "body": "I&#39;d prefer an addition to the answer rather than omitting the <code>on</code> solution altogether."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 8, "last_activity_date": 1552391199, "last_edit_date": 1552391199, "creation_date": 1552336800, "answer_id": 55110061, "question_id": 55109509, "link": "https://stackoverflow.com/questions/55109509/define-addition-as-an-instance-of-num-in-haskell/55110061#55110061", "title": "define addition as an instance of Num in haskell", "body": "<p>Rather than overload <code>(+)</code> with non-numeric semantics, define your own character \"addition\" operator.</p>\n\n<pre><code>import Data.Function\n\n-- The ^ is meant to suggest lifting values into a list.\n(^+) :: a -&gt; a -&gt; [a]\nx ^+ y = (++) `on` pure\n-- Or more simply,\n-- x ^+ y = [x, y]\n</code></pre>\n\n<p>Then <code>'a' ^+ 'b' == \"ab\"</code>. <code>(^+)</code> will work for creating a two-element list of <em>any</em> type, not just <code>Char</code>.</p>\n\n<pre><code>&gt; 'a' ^+ 'b'\n\"ab\"\n&gt; 3 ^+ 4\n[3,4]\n&gt; [1,2] ^+ [4,5]\n[[1,2],[4,5]]\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 7036574, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6c64c58d7a2241d71fce37ca79ded53b?s=128&d=identicon&r=PG&f=1", "display_name": "kalle konsida", "link": "https://stackoverflow.com/users/7036574/kalle-konsida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 55110061, "answer_count": 2, "score": -1, "last_activity_date": 1552391199, "creation_date": 1552334481, "last_edit_date": 1552334777, "question_id": 55109509, "link": "https://stackoverflow.com/questions/55109509/define-addition-as-an-instance-of-num-in-haskell", "title": "define addition as an instance of Num in haskell", "body": "<p>I wish to define addition between two chars as concatination but im unsure of how to properly do so.</p>\n\n<p>my attempt:</p>\n\n<pre><code>instance Num Char where\n (+) (a) (b) = [a] ++ [b]\n</code></pre>\n\n<p>but the error i get is that the  return type is not the expected one.  </p>\n\n<p>My expected output is as stated a list of Char which is formed by concatinating the two chars.</p>\n"}, {"tags": ["string", "haskell", "printing"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1552329537, "post_id": 55105976, "comment_id": 96959601, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/55105774/how-do-i-print-special-characters-like-tabulations-or-newlines\">How do I print special characters like tabulations or newlines?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": true, "score": 8, "last_activity_date": 1552321061, "creation_date": 1552321061, "answer_id": 55106155, "question_id": 55105976, "link": "https://stackoverflow.com/questions/55105976/can-i-use-special-characters-like-tabulations-and-newlines-in-show/55106155#55106155", "title": "Can I use special characters like tabulations and newlines in Show?", "body": "<p><code>show</code> returns a string, and then when you put that in GHCi, it does <code>print . show $ (P 5 6)</code>, which is equivalent to <code>putStrLn . show . show $ (P 5 6)</code> which will print all the characters.</p>\n\n<p>The problem is with the double show.</p>\n\n<p>What you want to do is use print only, as <code>print (P 5 6)</code>. If you're using the GHCi, <code>print</code> is automatically applied to every expression, so you only need to type</p>\n\n<pre><code>Prelude&gt; P 5 6\n</code></pre>\n"}], "owner": {"reputation": 6365, "user_id": 4385532, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0573709d0b88e4b50af0e28c3e96873b?s=128&d=identicon&r=PG&f=1", "display_name": "gaazkam", "link": "https://stackoverflow.com/users/4385532/gaazkam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 55106155, "answer_count": 1, "score": 0, "last_activity_date": 1552321061, "creation_date": 1552320467, "question_id": 55105976, "link": "https://stackoverflow.com/questions/55105976/can-i-use-special-characters-like-tabulations-and-newlines-in-show", "title": "Can I use special characters like tabulations and newlines in Show?", "body": "<pre><code>data Pair = P Int Int\n\ninstance Show Pair where\n  show (P n1 n2) = (show n1) ++ \"\\t\" ++ (show n2)\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>GHCi, version 7.6.3: http://www.haskell.org/ghc/  :? for help\n\\Loading package ghc-prim ... linking ... done.\nLoading package integer-gmp ... linking ... done.\nLoading package base ... linking ... done.\n[1 of 1] Compiling Main             ( labn.hs, interpreted )\nOk, modules loaded: Main.\n*Main&gt; show (P 5 6)\n\"5\\t6\"\n</code></pre>\n\n<p>OK for a pair of ints this might be an artificial problem, but my actual use case is trying to pretty print a tree - where newlines and tabs seem instrumental for readability.</p>\n\n<p>Can I somehow use these  characters with <code>show</code>?</p>\n"}, {"tags": ["haskell", "compiler-errors", "syntax-error"], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 6, "last_activity_date": 1552331593, "last_edit_date": 1552331593, "creation_date": 1552322692, "answer_id": 55106590, "question_id": 55105898, "link": "https://stackoverflow.com/questions/55105898/is-it-possible-to-use-let-in-in-an-instance-clause/55106590#55106590", "title": "Is it possible to use `let in` in an instance clause?", "body": "<p>The body of an instance declaration is not an arbitrary expression; it's a list of function definitions. <code>let</code> can only be used where an expression is expected, and  <code>where</code> has to be associated with a single equation. However, it's simple enough to define <code>show</code> with a single equation that would allow you to use either.</p>\n\n<pre><code>-- using where\ninstance Show a =&gt; Show (ShowableTree a) where\n    show (ST depth t) = case t of\n                         Empty -&gt; indent depth ++ \"()\"\n                         Node n l r -&gt; let stl = ST (depth + 1) l\n                                           str = ST (depth + 1) r\n                                       in  indent depth ++ \"(\\n\" ++ indent depth ++ show n ++ \"\\n\" ++ show stl ++ \"\\n\" ++ show str ++ \"\\n\" ++ indent depth ++ \")\\n\"\n        where indent = flip replicate '\\t'\n\n-- using let\ninstance Show a =&gt; Show (ShowableTree a) where\n    show (ST depth t) = let indent = flip replicate '\\t'\n                        in case t of\n                             Empty -&gt; indent depth ++ \"()\"\n                             Node n l r -&gt; let stl = ST (depth + 1) l\n                                               str = ST (depth + 1) r\n                                           in  indent depth ++ \"(\\n\" ++ indent depth ++ show n ++ \"\\n\" ++ show stl ++ \"\\n\" ++ show str ++ \"\\n\" ++ indent depth ++ \")\\n\"\n</code></pre>\n"}], "owner": {"reputation": 6365, "user_id": 4385532, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0573709d0b88e4b50af0e28c3e96873b?s=128&d=identicon&r=PG&f=1", "display_name": "gaazkam", "link": "https://stackoverflow.com/users/4385532/gaazkam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 55106590, "answer_count": 1, "score": 1, "last_activity_date": 1552331593, "creation_date": 1552320206, "question_id": 55105898, "link": "https://stackoverflow.com/questions/55105898/is-it-possible-to-use-let-in-in-an-instance-clause", "title": "Is it possible to use `let in` in an instance clause?", "body": "<pre><code>import Prelude hiding (Either (..))\n\ndata Tree a = Empty | Node a (Tree a) (Tree a)\n\ninstance Show a =&gt; Show (Tree a) where\n  show t = show ST t\n\ndata ShowableTree a = ST Int (Tree a)\n\ninstance Show a =&gt; Show (ShowableTree a) where\n  let\n    indent 0 = \"\"\n    indent n = \"\\t\" ++ (indent n-1)\n  in\n    show (ST depth Empty) = (indent depth) ++ \"()\"\n    show (ST depth (Node n l r)) =\n      let\n        stl = ST (depth+1) l\n        str = ST (depth+1) r\n      in\n        (indent depth) ++ \"(\\n\" ++ (indent depth) ++ (show n) ++ \"\\n\" ++ (show stl) ++ \"\\n\" ++ (show str) ++ \"\\n\" ++ (indent depth) ++ \")\\n\"\n</code></pre>\n\n<p>This spits out errors:</p>\n\n<pre><code>[m@green09 ~]$ ghci labn.hs\nGHCi, version 7.6.3: http://www.haskell.org/ghc/  :? for help\nLoading package ghc-prim ... linking ... done.\nLoading package integer-gmp ... linking ... done.\nLoading package base ... linking ... done.\n[1 of 1] Compiling Main             ( labn.hs, interpreted )\n\nlabn.hs:14:3:\n    parse error (possibly incorrect indentation or mismatched brackets)\nFailed, modules loaded: none.\n</code></pre>\n\n<p>Let's try <code>where</code> perhaps?</p>\n\n<pre><code>instance Show a =&gt; Show (ShowableTree a)\n  where\n    show (ST depth Empty) = (indent depth) ++ \"()\"\n    show (ST depth (Node n l r)) =\n      let\n        stl = ST (depth+1) l\n        str = ST (depth+1) r\n      in\n        (indent depth) ++ \"(\\n\" ++ (indent depth) ++ (show n) ++ \"\\n\" ++ (show stl) ++ \"\\n\" ++ (show str) ++ \"\\n\" ++ (indent depth) ++ \")\\n\"\n    where\n      indent 0 = \"\"\n      indent n = \"\\t\" ++ (indent n-1)\n</code></pre>\n\n<p>Still no success:</p>\n\n<pre><code>[m@green09 ~]$ ghci labn.hs\nGHCi, version 7.6.3: http://www.haskell.org/ghc/  :? for help\nLoading package ghc-prim ... linking ... done.\nLoading package integer-gmp ... linking ... done.\nLoading package base ... linking ... done.\n[1 of 1] Compiling Main             ( labn.hs, interpreted )\n\nlabn.hs:19:5: parse error on input `where'\nFailed, modules loaded: none.\n</code></pre>\n\n<p>One clear solution is to pollute the global scope by moving the definition of <code>indent</code> to the global scope.</p>\n\n<p>Barring this, however, is it possible to somehow define <code>indent</code> within <code>ShowableTree</code>?</p>\n"}, {"tags": ["string", "haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 4, "creation_date": 1552319975, "post_id": 55105774, "comment_id": 96954529, "body": "Use <code>putStrLn</code>, not <code>print</code>. <code>print = putStrLn . show</code>."}, {"owner": {"reputation": 6365, "user_id": 4385532, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0573709d0b88e4b50af0e28c3e96873b?s=128&d=identicon&r=PG&f=1", "display_name": "gaazkam", "link": "https://stackoverflow.com/users/4385532/gaazkam"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1552320645, "post_id": 55105774, "comment_id": 96954995, "body": "@AJFarmar This begs the question... <a href=\"https://stackoverflow.com/questions/55105976/can-i-use-special-characters-like-tabulations-and-newlines-in-show\">Can I use special characters like tabulations and newlines in Show?</a>"}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 1, "creation_date": 1552322786, "post_id": 55105774, "comment_id": 96956266, "body": "No it doesn\u2019t. Yes you can. The only related this might <i>raise</i> is which characters <code>Show :: String -&gt; String</code> will choose to escape"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1552332473, "post_id": 55105774, "comment_id": 96960963, "body": "This behavior of <code>print</code> is so that one can correctly understand strings within larger types. E.g. if we print a <code>[String]</code> which contains the (unescaped) string <code>&quot;aa&quot;, &quot;bb&quot;</code>, we really want to see that properly escaped so that we read e.g. <code>[&quot;first&quot;, &quot;\\&quot;aa\\&quot;, \\&quot;bb\\&quot;&quot;, &quot;last&quot;]</code> and <i>not</i> the unescaped <code>[first, &quot;aa&quot;, &quot;bb&quot;, last]</code> which is ambiguous. This escaping is really useful when printing complex types, and a bit annoying when printing single strings -- but there&#39;s always <code>putStrLn</code> to write a string without escaping it."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1552333281, "creation_date": 1552333281, "answer_id": 55109193, "question_id": 55105774, "link": "https://stackoverflow.com/questions/55105774/how-do-i-print-special-characters-like-tabulations-or-newlines/55109193#55109193", "title": "How do I print special characters like tabulations or newlines?", "body": "<p>You just do it.</p>\n\n<pre><code>&gt; putStrLn \"a\\tb\"\na   b\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "is_accepted": false, "score": 0, "last_activity_date": 1552334893, "last_edit_date": 1552334893, "creation_date": 1552334409, "answer_id": 55109486, "question_id": 55105774, "link": "https://stackoverflow.com/questions/55105774/how-do-i-print-special-characters-like-tabulations-or-newlines/55109486#55109486", "title": "How do I print special characters like tabulations or newlines?", "body": "<p>When you insert a value of type <code>Show a =&gt; a</code> into the REPL, the ghci will execute <code>print</code> on it, and if type of this value is <code>IO ()</code> it will just evaluate it. If you look at the definition of print you will see that <code>print = putStrLn . show</code>, or less pointfree: <code>print s = putStrLn (show s)</code>. </p>\n\n<p>The problem is that <code>show</code> is not a tool for pretty printing. This function's purpose is to \"show\" the underlying structure, so that it can be <code>read</code> back by Haskell or by human. This is the point where the escaping characters are revealed. You may check that <code>show \"\\t\" /= \"\\t\"</code>.</p>\n\n<p>If you want to actually print the string \"as it is\" you should explicitly call <code>putStr</code> or <code>putStrLn</code> action, that will omit this <code>show</code> layer.</p>\n\n<hr>\n\n<p>Few examples:</p>\n\n<pre><code>&gt;&gt;&gt; putStrLn \"a\\tb\"\na    b\n\n&gt;&gt;&gt; \"a\\tb\"\n\"a\\tb\"\n\n&gt;&gt;&gt; show \"a\\tb\" -- notice that it is actually `putStrLn (show (show \"a\\tb\"))`!\n\"\\\"a\\\\tb\\\"\"\n\n&gt;&gt;&gt; print \"a\\tb\"\n\"a\\tb\"\n</code></pre>\n"}], "owner": {"reputation": 6365, "user_id": 4385532, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0573709d0b88e4b50af0e28c3e96873b?s=128&d=identicon&r=PG&f=1", "display_name": "gaazkam", "link": "https://stackoverflow.com/users/4385532/gaazkam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1552334893, "creation_date": 1552319876, "question_id": 55105774, "link": "https://stackoverflow.com/questions/55105774/how-do-i-print-special-characters-like-tabulations-or-newlines", "title": "How do I print special characters like tabulations or newlines?", "body": "<pre><code>[m@green09 ~]$ ghci\nGHCi, version 7.6.3: http://www.haskell.org/ghc/  :? for help\nLoading package ghc-prim ... linking ... done.\nLoading package integer-gmp ... linking ... done.\nLoading package base ... linking ... done.\nPrelude&gt; print \"asdf\"\n\"asdf\"\nPrelude&gt; print \"\\tasdf\"\n\"\\tasdf\"\nPrelude&gt; \n</code></pre>\n\n<p>Awesome. Just awesome.</p>\n\n<p>How to print a tabulation or newline?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1552318389, "post_id": 55105319, "comment_id": 96953514, "body": "I&#39;m not really sure what you&#39;re getting at, but the only answer has to be &quot;no&quot;. <code>Height</code> is just a constructor for the <code>Human</code> type (one which takes no values, so it&#39;s a bit like a Boolean value like <code>True</code>), and <code>getHeight</code> doesn&#39;t involve the <code>Human</code> type at all. Did you mean for the <code>Height</code> constructor to take a <code>String</code> parameter and then have <code>getHeight</code> return a <code>Human</code> by doing eg. <code>otherwise = Height &quot;Tall&quot;</code>?"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 6, "creation_date": 1552318864, "post_id": 55105319, "comment_id": 96953800, "body": "Well... no. Just because two things have similar names doesn&#39;t mean they&#39;re related. Your <code>Human</code> type also looks a bit sketchy, because it basically reads &quot;A human is either age, or a human is weight, or a human is height&quot; which doesn&#39;t make a whole lot of sense on the surface level."}], "answers": [{"tags": [], "owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "is_accepted": true, "score": 4, "last_activity_date": 1552355096, "last_edit_date": 1552355096, "creation_date": 1552328545, "answer_id": 55108100, "question_id": 55105319, "link": "https://stackoverflow.com/questions/55105319/are-haskell-functions-and-data-constructors-have-anything-in-common-if-they-both/55108100#55108100", "title": "Are Haskell functions and data constructors have anything in common if they both have the same ending from the capital letter?", "body": "<p>The names aren't related the way that you've written them.  However, if you defined your data type as:</p>\n\n<p><code>data Human = Human { age :: Double, height :: Double, weight :: Double }</code></p>\n\n<p>then you would get a height method for free:</p>\n\n<pre><code>let bob = Human 18 72 189\nheight bob    -- this will be 72\n</code></pre>\n\n<p>You might consider making your getHeight function more specific to take a Human rather than a double:</p>\n\n<pre><code>getHeight :: Human -&gt; String\ngetHeight person \n  | height person &lt;= 165 = \"Short\"\n  | height person &lt; 180  = \"Average\"\n  | otherwise = \"Tall\"\n</code></pre>\n\n<p>Now the getHeight function <em>is</em> linked to the height that was defined as being an attribute of a Human, as opposed to simply being associated with an arbitrary double.</p>\n"}], "owner": {"reputation": 125, "user_id": 9419947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78daa77f0251eb5ac51d0dd69995d2a1?s=128&d=identicon&r=PG&f=1", "display_name": "UnseenElder", "link": "https://stackoverflow.com/users/9419947/unseenelder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 55108100, "answer_count": 1, "score": -2, "last_activity_date": 1552355096, "creation_date": 1552318246, "question_id": 55105319, "link": "https://stackoverflow.com/questions/55105319/are-haskell-functions-and-data-constructors-have-anything-in-common-if-they-both", "title": "Are Haskell functions and data constructors have anything in common if they both have the same ending from the capital letter?", "body": "<p>Let's imagine we have the following data definitions:</p>\n\n<pre><code>data Human = Age | Weight | Height\n</code></pre>\n\n<p>Now we define some function, which do something useful</p>\n\n<pre><code>getHeight :: Double -&gt; String\ngetHeight a\n  | a &lt;= 165   = \"Short\"\n  | a &lt; 185    = \"Average\"\n  | otherwise    = \"Tall\"\n</code></pre>\n\n<p>The question is: does Height and getHeight have anything in common at all?</p>\n"}, {"tags": ["file", "haskell", "io"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1552316450, "post_id": 55104520, "comment_id": 96952249, "body": "<code>writeToFile path cnt payload = replicateM_ cnt (writeFile path payload)</code>; no explicit recursion needed. The same logic holds if you replace <code>writeFile</code> with <code>appendFile</code>, as recommended."}], "answers": [{"comments": [{"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 2, "creation_date": 1552316163, "post_id": 55104640, "comment_id": 96952075, "body": "check also <code>appendFile</code>"}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 5, "last_activity_date": 1552316095, "creation_date": 1552316095, "answer_id": 55104640, "question_id": 55104520, "link": "https://stackoverflow.com/questions/55104520/why-cant-i-write-to-a-file/55104640#55104640", "title": "Why can&#39;t I write to a file?", "body": "<p>Each call to <code>writeFile</code> overwrites the existing file with the next record.</p>\n\n<p>What you want to do is <em>either</em></p>\n\n<ul>\n<li>Open the file (<code>openFile</code>), write each line to the file handle (<code>hPutStrLn</code>), close the file at the end (<code>hClose</code>).</li>\n<li>Generate a giant string representing the entire file contents, and <code>writeFile</code> that at the end.</li>\n</ul>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 55104640, "answer_count": 1, "score": -1, "last_activity_date": 1552317316, "creation_date": 1552315787, "last_edit_date": 1552317316, "question_id": 55104520, "link": "https://stackoverflow.com/questions/55104520/why-cant-i-write-to-a-file", "title": "Why can&#39;t I write to a file?", "body": "<p>I am trying to create a <code>csv</code> file for testing purposes and when I try to write it, it continues to fluctuate either at <code>0kb</code> or <code>1kb</code> and only 1 record is written. It continues to fluctuate like this for a while until I get</p>\n\n<blockquote>\n  <p>openfile: permission denied</p>\n</blockquote>\n\n<pre><code>module Generator where \n\n    path=\"d:\\\\data.csv\"\n    cnt=1000000\n    main::IO()\n    main=do\n        let payload=makeString\n        writeToFile path cnt payload\n\n\n    makeString::String\n    makeString=\"0741142339,\\r\\n\"\n\n    writeToFile::String-&gt;Int-&gt;String-&gt;IO()\n    writeToFile _ 0 _ =return ()\n    writeToFile path cnt payload=writeFile path payload &gt;&gt; writeToFile path (cnt-1)  payload\n</code></pre>\n\n<p>If I try to write to a location on <code>C://</code> I get not allowed permission.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1552315345, "post_id": 55104286, "comment_id": 96951505, "body": "You  might consider modifying <code>T</code>: <code>data T a = TStr String | TOther a</code>. Now your <code>Show</code> instance can determine from the argument to <code>show</code> whether to use <code>show</code> recursively."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 2, "creation_date": 1552315561, "post_id": 55104286, "comment_id": 96951667, "body": "The answer is &quot;basically yes, but you shouldn&#39;t&quot;. If you have specific demands of your visual representation then <code>Show</code> simply isn&#39;t the right tool for that."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1552316521, "post_id": 55104750, "comment_id": 96952297, "body": "You <i>can</i> do that, but overlapping instances are usually a sign that you&#39;re abusing type classes for something that better be done in a direct way."}, {"owner": {"reputation": 11496, "user_id": 5438433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OJ1qY.png?s=128&g=1", "display_name": "TheInnerLight", "link": "https://stackoverflow.com/users/5438433/theinnerlight"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1552316847, "post_id": 55104750, "comment_id": 96952488, "body": "@leftaroundabout Agreed.  I think more context would really help for suggesting alternatives so thought I&#39;d just suggest a potential way of solving the problem as described."}, {"owner": {"reputation": 15, "user_id": 9111156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7224fdc1969a619c76ad5ad779383f62?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Voloshin", "link": "https://stackoverflow.com/users/9111156/nikita-voloshin"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1552317225, "post_id": 55104750, "comment_id": 96952734, "body": "@leftaroundabout Thank you! Yeah, I know that it&#39;s not a good way, and I&#39;m disappointed that I have to use such a &quot;tricks&quot; just for avoiding qoutes"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 15, "user_id": 9111156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7224fdc1969a619c76ad5ad779383f62?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Voloshin", "link": "https://stackoverflow.com/users/9111156/nikita-voloshin"}, "edited": false, "score": 0, "creation_date": 1552317721, "post_id": 55104750, "comment_id": 96953050, "body": "@NikitaVoloshin perhaps you should explain a bit more for what you&#39;re actually trying to accomplish, to get advice on a better alternative."}, {"owner": {"reputation": 15, "user_id": 9111156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7224fdc1969a619c76ad5ad779383f62?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Voloshin", "link": "https://stackoverflow.com/users/9111156/nikita-voloshin"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1552319369, "post_id": 55104750, "comment_id": 96954135, "body": "@leftaroundabout well, I have a type similar to one described above. And for now, there are only two alternatives for type parameter: either <code>Int</code> or <code>String</code>. And yes, I know that I can do smth like <code>data TInt = TInt Int</code> and <code>data TString = TString String</code> and work with them separately. But my question was about the general case. For example, <code>list</code> is an instance like that."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 15, "user_id": 9111156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7224fdc1969a619c76ad5ad779383f62?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Voloshin", "link": "https://stackoverflow.com/users/9111156/nikita-voloshin"}, "edited": false, "score": 0, "creation_date": 1552319502, "post_id": 55104750, "comment_id": 96954217, "body": "@NikitaVoloshin Have you considered simply writing separately <code>instance Show (T Int)</code> and <code>instance Show (T String)</code>? \u2014 Anyways, that&#39;s not really what I meant: <i>what do you need <code>show</code> on this type for, and why does it matter to have strings wrapped in extra quotes</i>?"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1552324616, "post_id": 55104750, "comment_id": 96957285, "body": "If you&#39;re concerned with presentation, you probably want a pretty printing library, not <code>Show</code>."}, {"owner": {"reputation": 15, "user_id": 9111156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7224fdc1969a619c76ad5ad779383f62?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Voloshin", "link": "https://stackoverflow.com/users/9111156/nikita-voloshin"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1552325528, "post_id": 55104750, "comment_id": 96957789, "body": "@leftaroundabout maybe I&#39;m doing wrong, but <code>instance Show (T String)</code> doesn&#39;t compile with message <code>Illegal instance declaration for Show (T String)</code>. And about quotes: presentation matters, there is a grammar string representation must satisfy"}, {"owner": {"reputation": 15, "user_id": 9111156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7224fdc1969a619c76ad5ad779383f62?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Voloshin", "link": "https://stackoverflow.com/users/9111156/nikita-voloshin"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1552325628, "post_id": 55104750, "comment_id": 96957832, "body": "@Carl thank you for advice, but actually it&#39;s not my case because I&#39;m not allowed to use 3rd party libraries for some reasons"}, {"owner": {"reputation": 11496, "user_id": 5438433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OJ1qY.png?s=128&g=1", "display_name": "TheInnerLight", "link": "https://stackoverflow.com/users/5438433/theinnerlight"}, "reply_to_user": {"reputation": 15, "user_id": 9111156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7224fdc1969a619c76ad5ad779383f62?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Voloshin", "link": "https://stackoverflow.com/users/9111156/nikita-voloshin"}, "edited": false, "score": 1, "creation_date": 1552326817, "post_id": 55104750, "comment_id": 96958406, "body": "@NikitaVoloshin You need to use <code>FlexibleInstances</code> as shown above to create an instance of <code>Show (T String)</code> otherwise you will get that error."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 15, "user_id": 9111156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7224fdc1969a619c76ad5ad779383f62?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Voloshin", "link": "https://stackoverflow.com/users/9111156/nikita-voloshin"}, "edited": false, "score": 0, "creation_date": 1552334573, "post_id": 55104750, "comment_id": 96961902, "body": "@NikitaVoloshin yeah, it requires <code>FlexibleInstances</code>, but unlike <code>Overlapping</code> that&#39;s completely harmless and uncontroversial."}, {"owner": {"reputation": 616, "user_id": 8578679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CeZ5Z.png?s=128&g=1", "display_name": "Ruifeng Xie", "link": "https://stackoverflow.com/users/8578679/ruifeng-xie"}, "edited": false, "score": 0, "creation_date": 1552355383, "post_id": 55104750, "comment_id": 96968353, "body": "AFAIK, it&#39;s better to use OVERLAPPING instead of OVERLAPS, for the latter also implies OVERLAPPABLE."}, {"owner": {"reputation": 15, "user_id": 9111156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7224fdc1969a619c76ad5ad779383f62?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Voloshin", "link": "https://stackoverflow.com/users/9111156/nikita-voloshin"}, "edited": false, "score": 0, "creation_date": 1552415368, "post_id": 55104750, "comment_id": 96998444, "body": "So, guys, thank you all for your answers! It&#39;s really helpful"}], "tags": [], "owner": {"reputation": 11496, "user_id": 5438433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OJ1qY.png?s=128&g=1", "display_name": "TheInnerLight", "link": "https://stackoverflow.com/users/5438433/theinnerlight"}, "is_accepted": true, "score": 0, "last_activity_date": 1552385567, "last_edit_date": 1552385567, "creation_date": 1552316433, "answer_id": 55104750, "question_id": 55104286, "link": "https://stackoverflow.com/questions/55104286/get-rid-of-show-string-in-instance-show-for-polymorphic-type/55104750#55104750", "title": "Get rid of show String in instance Show for polymorphic type", "body": "<p>If you want to declare an instance of <code>Show</code> for <code>T String</code> you can use <code>FlexibleInstances</code></p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n\ndata T a = T a\n\ninstance Show (T String) where\n  show (T smth) = smth\n</code></pre>\n\n<p>You would then need to provide explicit instances for other <code>a</code>s that you wish to support.</p>\n\n<hr>\n\n<p>If you want to retain your catch-all instance shown in your question too, you would then be into using <code>OVERLAPS/OVERLAPPABLE</code></p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n\ndata T a = T a\n\ninstance {-# OVERLAPPABLE #-} Show a =&gt; Show (T a) where\n    show (T smth) = show smth\n\ninstance {-# OVERLAPPING #-} Show (T String) where\n    show (T smth) = smth\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9111156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7224fdc1969a619c76ad5ad779383f62?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Voloshin", "link": "https://stackoverflow.com/users/9111156/nikita-voloshin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 55104750, "answer_count": 1, "score": 0, "last_activity_date": 1552385567, "creation_date": 1552315050, "question_id": 55104286, "link": "https://stackoverflow.com/questions/55104286/get-rid-of-show-string-in-instance-show-for-polymorphic-type", "title": "Get rid of show String in instance Show for polymorphic type", "body": "<p>I have a type kinda <code>data T a = T a</code></p>\n\n<p>I want to declare <code>Show</code> instance for this type, something like</p>\n\n<pre><code>instance Show a =&gt; Show (T a) where\n  show (T smth) = ... ++ show smth\n</code></pre>\n\n<p>But I don't want to call <code>show smth</code> if <code>a</code> is <code>String</code>, because I don't need additional quotes</p>\n\n<p>Is there any solution how to declare such an instance?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 6, "creation_date": 1552311925, "post_id": 55103173, "comment_id": 96949283, "body": "<code>do</code> notation is exclusively for use with monads (including but not limited to <code>IO</code>). You&#39;re not doing any I/O here, or using any other monad, it&#39;s a simple pure function <code>Double -&gt; Double -&gt; String</code>. You appear to be falling into the trap of thinking you can use <code>do</code> notation anywhere to use an imperative style - but this isn&#39;t the case."}, {"owner": {"reputation": 109, "user_id": 9019907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7e48c2af930f7535da3d7cb0688bda2?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Foot", "link": "https://stackoverflow.com/users/9019907/andrew-foot"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1552312488, "post_id": 55103173, "comment_id": 96949657, "body": "Thank you for the quick explanation. I&#39;ve come from a C# background and only had 4 days in Haskell."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 9019907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7e48c2af930f7535da3d7cb0688bda2?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Foot", "link": "https://stackoverflow.com/users/9019907/andrew-foot"}, "edited": false, "score": 0, "creation_date": 1552312549, "post_id": 55103275, "comment_id": 96949699, "body": "Thanks for the answer. This was what I was looking for. I would up vote but don&#39;t have high enough reputation."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 7, "last_activity_date": 1552312448, "last_edit_date": 1552312448, "creation_date": 1552312015, "answer_id": 55103275, "question_id": 55103173, "link": "https://stackoverflow.com/questions/55103173/function-isnt-being-called-not-found/55103275#55103275", "title": "Function isn&#39;t being called/not found?", "body": "<p>You need to change the the type of <code>grades</code> and dispense with the inappropriate <code>do</code> notation; you aren't doing any monadic calculations. Also, variables must start with lowercase letters; capitalized names indicate a type or type class.</p>\n\n<pre><code>percentage :: Double -&gt; Double -&gt; Double\npercentage a b = a / b\n\n\ngrades :: Double -&gt; Double -&gt; Either String Double\ngrades x 0 = Left \"Zero denominator\"\ngrades x y = let p = percentage x y\n             in if p &gt; 1 then Left \"Greater than 100%\"\n                         else Right p\n</code></pre>\n\n<p>Another alternative is to pre-define the error conditions that occur, rather than returning arbitrary strings to describe them; not every string will describe one of the two possible errors, but every value of <code>PercentageError</code> does.</p>\n\n<pre><code>data PercentageError = ZeroDenominator | Over100Percent\n\ngrades :: Double -&gt; Double -&gt; Either PercentageError Double\ngrades x 0 = Left ZeroDenominator\ngrades x y = let p = percentage x y\n             in if p &gt; 1 then Left Over100Percent\n                         else Right p\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 9019907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7e48c2af930f7535da3d7cb0688bda2?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Foot", "link": "https://stackoverflow.com/users/9019907/andrew-foot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 55103275, "answer_count": 1, "score": 1, "last_activity_date": 1591302783, "creation_date": 1552311716, "last_edit_date": 1591302783, "question_id": 55103173, "link": "https://stackoverflow.com/questions/55103173/function-isnt-being-called-not-found", "title": "Function isn&#39;t being called/not found?", "body": "<p>I'm brand new to Haskell and I'm not so familiar with the syntax. I've got a pure function that has 2 integer parameters and then want to call another function and change the value of one parameter with the return value from the called function. However I get an error \"No modules loaded\". Is there any way to change the value of a variable.</p>\n\n<p>EDIT This breaks the fundamental of functional programming as every variable is a constant to keep it pure. This is admirable as it allows for more secure code due to not need to worry about overwritten memory.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>percentage A B = (A/B)\n\ngrades x y  = do\n   if y /= 0 then do  \n      x &lt;- percentage x y\n      if x &gt; 1 then \"Error\"\n      else\n        &lt;code&gt;\n   else \"Error\"\n</code></pre>\n\n<p>Here is how I define it:</p>\n\n<pre><code>percentage :: Double -&gt; Double -&gt; Double\ngrades :: Double -&gt; Double -&gt; String\n</code></pre>\n\n<p>I've looked already at other threads and online but none seem to cover the changing of a parameter.</p>\n"}, {"tags": ["haskell", "refactoring", "higher-order-functions"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 4, "creation_date": 1552273175, "post_id": 55094413, "comment_id": 96933322, "body": "There doesn&#39;t seem to be a question here. I can&#39;t figure out what unpleasant code you&#39;ve had to write, and what beautiful code you wish you had instead."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 7, "creation_date": 1552274601, "post_id": 55094413, "comment_id": 96933576, "body": "<code>higherOrder operator a b = a `operator` b</code> is equivalent to <code>higherOrder = id</code>. Also, your <code>operator</code> and <code>equation</code> are equivalent."}, {"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 2, "creation_date": 1552301488, "post_id": 55094413, "comment_id": 96943326, "body": "What&#39;s the actual question?"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1552304561, "creation_date": 1552304561, "answer_id": 55101104, "question_id": 55094413, "link": "https://stackoverflow.com/questions/55094413/refactor-higher-order-functions-in-haskell-to-avoid-passing-operators-through-se/55101104#55101104", "title": "Refactor Higher Order Functions in Haskell to avoid passing Operators Through Several Functions", "body": "<p>I don't completely understand your question, but I guess you want something similar to this.</p>\n\n<p>Define a type for operators, giving a name to the ones you want.</p>\n\n<pre><code>data Operator = Add | Sub\n</code></pre>\n\n<p>You can then define their semantics:</p>\n\n<pre><code>semOp :: Operator -&gt; (Integer -&gt; Integer -&gt; Integer)\nsemOp Add = (+)\nsemOp Sub = (-)\n</code></pre>\n\n<p>Then, define a type for aritmetic expressions:</p>\n\n<pre><code>data Expr = Constant Integer | BinOp Expr Operator Expr\n</code></pre>\n\n<p>and a semantics for the expressions:</p>\n\n<pre><code>semExpr :: Expr -&gt; Integer\nsemExpr (Constant a) = a\nsemExpr (BinOp e1 op e2) = semOp op (semExpr e1) (semExpr e2)\n</code></pre>\n\n<p>In this way, the syntax and semantics of binary operators is completely factored away from the definition of the expressions and their semantics.</p>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 806909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee36be6ab367e0ca1e5e58073fb14ac?s=128&d=identicon&r=PG", "display_name": "Michael Rauh", "link": "https://stackoverflow.com/users/806909/michael-rauh"}, "is_accepted": true, "score": 0, "last_activity_date": 1553433817, "creation_date": 1553433817, "answer_id": 55324247, "question_id": 55094413, "link": "https://stackoverflow.com/questions/55094413/refactor-higher-order-functions-in-haskell-to-avoid-passing-operators-through-se/55324247#55324247", "title": "Refactor Higher Order Functions in Haskell to avoid passing Operators Through Several Functions", "body": "<p>Looking back at this question, it is essentially one about moving behavior down closer to where the differences occur. Taking heavy inspiration from @chi's answer above (thank you @chi!), I have arrived at this as the smallest change to get the desired effect: </p>\n\n<pre><code>data Operator = Add | Sub\n\nadd' = higherOrder Add\nsubtract' = higherOrder Sub\n\nhigherOrder :: Operator -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int\nhigherOrder operator a b c d = d + someLowerFunction operator a b c\n\nsomeLowerFunction :: Operator -&gt; Int -&gt; Int -&gt; Int -&gt; Int\nsomeLowerFunction operator a b c = c + someEvenLowerFunction a b operator\n\nsomeEvenLowerFunction :: Int -&gt; Int -&gt; Operator -&gt; Int\nsomeEvenLowerFunction a b Add = a + b\nsomeEvenLowerFunction a b Sub = a - b\n</code></pre>\n\n<p>Notably, I am still passing the operator down, but in the case where there are multiple operators that need to be passed, they can all be replaced with just the algebraic data type that allows this later matching.</p>\n\n<p>As a more general comment, having the code this entwined is a bit of a smell. The fact that there is so much shared, except for a small difference later on shows that there should be some higher generalization that can be used to get around the problem entirely.</p>\n"}], "owner": {"reputation": 81, "user_id": 806909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee36be6ab367e0ca1e5e58073fb14ac?s=128&d=identicon&r=PG", "display_name": "Michael Rauh", "link": "https://stackoverflow.com/users/806909/michael-rauh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 55324247, "answer_count": 2, "score": -4, "last_activity_date": 1553433817, "creation_date": 1552270443, "last_edit_date": 1552438843, "question_id": 55094413, "link": "https://stackoverflow.com/questions/55094413/refactor-higher-order-functions-in-haskell-to-avoid-passing-operators-through-se", "title": "Refactor Higher Order Functions in Haskell to avoid passing Operators Through Several Functions", "body": "<p>I am trying to refactor this bit of code to avoid having to pass the same operators down through several functions. </p>\n\n<p>The program that I am writing relies on several operators to be passed in at the top level in order to reuse code in lower layers. A simplified example of the pattern that I am using is: </p>\n\n<pre><code>add' = higherOrder (+)\nsubtract' = higherOrder (-)\n\nhigherOrder operator a b c d = d + someLowerFunction operator a b c\nsomeLowerFunction operator a b c = c + someEvenLowerFunction a b operator\nsomeEvenLowerFunction a b operator = operator a b\n</code></pre>\n\n<p>where the useful functions that are intended to be called are <code>add'</code> and <code>subtract'</code> and <code>higherOrder</code>, <code>someLowerFunction</code>, and <code>someEvenLowerFunction</code> is merely there to deduplicate the code that is common between the two exposed functions. </p>\n\n<p>Is there some way to keep the benefits of this code (namely, that <code>higherOrder</code>, <code>someLowerFunction</code>, and <code>someEvenLowerFunction</code> can be reused) without having to pass <code>operator</code> over and over again? I have attempted to get creative with algebraic data types to make this happen but have so far not gotten good results.</p>\n"}, {"tags": ["haskell", "getter-setter", "setter"], "comments": [{"owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 0, "creation_date": 1552279744, "post_id": 55091157, "comment_id": 96934507, "body": "Are you aware of <a href=\"https://github.com/data61/lets-lens\" rel=\"nofollow noreferrer\">lets-lens</a>? you can build your own lens in multiple ways."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 4, "creation_date": 1552282452, "post_id": 55091157, "comment_id": 96935059, "body": "The word &quot;function&quot; is not generally interchangeable with the word &quot;functor&quot;. They are different things."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 4, "creation_date": 1552282569, "post_id": 55091157, "comment_id": 96935085, "body": "A Setter is not a function or a functor that is triggered &quot;when the value in the dataset is updated&quot;. A Setter is not at all the same thing as an Observable."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1028880"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1553052410, "post_id": 55091157, "comment_id": 97238481, "body": "@ReinHenrichs Depends on a programming language. A couple of languages call it as a setter, so you cannot deny it."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1553063259, "post_id": 55091157, "comment_id": 97241319, "body": "@KenOKABE This is a question about Haskell and you specifically referred to Control.Lens.Setter. What other languages may call a \u201csetter\u201d is irrelevant to your question as asked."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1028880"}, "edited": false, "score": 0, "creation_date": 1552247356, "post_id": 55091602, "comment_id": 96928067, "body": "Thanks for your input. Yeah, I know this in fact. Generally speaking, the term &quot;setter&quot; is a function/functor to be triggered when the value in the dataset is updated. ie) Observable. I also understand the mutation issue. The fact is ST Monad in Haskell behaves as if it mutates, and perhaps it&#39;s more efficient. That is why I refered it in my Question."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 2, "creation_date": 1552247519, "post_id": 55091602, "comment_id": 96928120, "body": "A function to be triggered when a value is updated is generally called a &quot;listener&quot;, not &quot;setter&quot;."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1552311334, "post_id": 55091602, "comment_id": 96948862, "body": "@KenOKABE That is not what anyone else in this community means when they say the word &#39;setter&#39;."}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 4, "last_activity_date": 1552247083, "last_edit_date": 1552247083, "creation_date": 1552246635, "answer_id": 55091602, "question_id": 55091157, "link": "https://stackoverflow.com/questions/55091157/what-is-the-way-to-implement-observable-other-than-control-lens-setter-in-haskel/55091602#55091602", "title": "What is the way to implement Observable other than Control.Lens.Setter in Haskell?", "body": "<p>It's not very clear what you're looking for here, but if you just want to update a record field, you can use the Haskell record update syntax:</p>\n\n<pre><code>x = Foo { val = 5 }\ny = x { val = 42 }\n</code></pre>\n\n<p>This works for any record, with any number of fields, and you don't need to list all the fields, only the ones you'd like to update, for example:</p>\n\n<pre><code>data D = D { a :: String, b :: Int }\n\nx = D { a = \"foo\", b = 42 }\ny = x { a = \"bar\" }  -- now y = D { a = \"bar\", b = 42 }\nz = x { b = 43 }  -- now z = D { a = \"foo\", b = 43 }\n</code></pre>\n\n<p>Keep in mind that this doesn't actually <em>update</em> (\"change\", \"mutate\") the values in memory, but rather creates <em>copies</em> of the records with all the fields equal to those of the original record, except the updated fields. Lenses work the same way, and in fact everything in Haskell does, since Haskell doesn't allow mutation at all.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1028880"}, "edited": false, "score": 0, "creation_date": 1552251079, "post_id": 55092182, "comment_id": 96929140, "body": "Thanks for your input. Well, &quot;immutability&quot; in Haskell is just main=&quot;here&quot;. &quot;main&quot; connects RealWorld that is mutable, and STMonad&#39;s <code>runST</code> imports the mutable RealWolrd, that essentially same as IO monad in design."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1552263594, "post_id": 55092182, "comment_id": 96931791, "body": "@KenOKABE I think you&#39;ve slightly misunderstood what I&#39;m trying to say. By &#39;immutability&#39; I mean that once you&#39;ve created a value such as <code>Foo { val=1, val2=&quot;test&quot; }</code>, you can&#39;t then change <code>val</code> to <code>2</code> without creating a new object. By contrast, in languages such as Java or C#, if you have an object <code>myFoo</code> of class <code>Foo</code>, with <code>myFoo.val = 1</code> and <code>myFoo.val2 = &quot;test</code>, you can then simply change <code>myFoo.val = 2</code> without creating a new <code>Foo</code> object."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1028880"}, "edited": false, "score": 0, "creation_date": 1553052003, "post_id": 55092182, "comment_id": 97238405, "body": "I think I did not misunderstand. Here&#39;s my confirmation to your thought. Do you agree to the idea <code>unsafePerformIO</code> is a mutable act or not.  Plus, I know the thing about &quot;immutability&quot; that you repeatedly mention in answer and comment. What I&#39;m asking here is your deep understanding of immutability."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1553060483, "post_id": 55092182, "comment_id": 97240405, "body": "@KenOKABE &#39;Do you agree to the idea <code>unsafePerformIO</code> is a mutable act or not.&#39; I don&#39;t quite know what you mean by a &#39;mutable act&#39; here. However, this is my understanding of mutability and <code>unsafePerformIO</code>: if you have an <code>IO</code> action which mutates an <code>IORef</code> or similar, then <code>unsafePerformIO</code> will convert it into a &#39;pure&#39; computation (although it isn&#39;t really) which has the side-effect of modifying a value. However, irregardless of whether you&#39;re inside <code>IO</code> or not, you can <b>never</b> mutate a value which isn&#39;t in an <code>IORef</code>, <code>STRef</code> or similar mutable reference type."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1028880"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1553096259, "post_id": 55092182, "comment_id": 97260683, "body": "@dfeuer I wrote a book about functional programming published by one of the major publishers in Japan, so I know what I&#39;m talking about. Your comment is not polite indeed. What I found very &quot;unuseful&quot; is that some people comments &quot;it&#39;s unuseful&quot; when one discuss some concept. &quot;Think&quot; or &quot;not think&quot; by someone should absolutely not be your concern, especially in programming topic.."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1028880"}, "edited": false, "score": 0, "creation_date": 1553097245, "post_id": 55092182, "comment_id": 97261421, "body": "I think the major problem of your opinion is that it&#39;s always Gray colored. &quot; (although it isn&#39;t really) which has the side-effect of modifying a value.&quot; this is so-called mutable.  &quot;since (almost) every Haskell value is immutable.&quot; &quot;This concept does not exist in Haskell; I&#39;m sure you could make it somehow, but it wouldn&#39;t be very useful&quot; &lt;-Do you know there&#39;s a concept of Functional Reactive Programming in Haskell?? You are saying it does not exist, or not useful. Perhaps you are not aware of it."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1553121922, "post_id": 55092182, "comment_id": 97273666, "body": "@KenOKABE I think we&#39;re actually saying the same thing, but just having a bit of trouble communicating. My view is as follows: all <i>values</i> in Haskell are immutable; that is, you can&#39;t reassign a value which has already been assigned. However, a value may &#39;point&#39; to another value which <i>is</i> mutable. For instance, an <code>IORef</code> <i>value</i> is immutable, but may &#39;point&#39; to another value stored in memory which may be mutated via the <code>readIORef</code> and <code>writeIORef</code> functions. (Comment continued in next comment.)"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1553121947, "post_id": 55092182, "comment_id": 97273674, "body": "@KenOKABE FRP is similar: the whole point is that in FRP time-varying values are treated as immutable &#39;behaviours&#39;, with the time variation not able to be observed within the program. (By the way, your book sounds interesting; do you have a link I can look at?)"}], "tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": false, "score": 4, "last_activity_date": 1552263403, "last_edit_date": 1552263403, "creation_date": 1552250367, "answer_id": 55092182, "question_id": 55091157, "link": "https://stackoverflow.com/questions/55091157/what-is-the-way-to-implement-observable-other-than-control-lens-setter-in-haskel/55092182#55092182", "title": "What is the way to implement Observable other than Control.Lens.Setter in Haskell?", "body": "<p>I think that you're a bit confused between a few concepts; specifically, setter vs observable.</p>\n\n<ul>\n<li>I don't know much about them, but an <strong>observable</strong> does seem to be, as you described, a way to run a function every time a value is changed. This concept does not exist in Haskell; I'm sure you could make it somehow, but it wouldn't be very useful, since (almost) every Haskell value is immutable.</li>\n<li>By contrast, a <strong>setter</strong> is just a function which changes part of a value, the same as with Java getters and setters. The only slight complication is that in Haskell, all values are immutable (as I mentioned above), so instead of changing the value, a setter copies the value across but with the thing set. For instance, if you have a setter <code>setName</code> (for a record), and you invoke it with something like <code>setName \"foo\" oldRecord</code>, this will keep <code>oldRecord</code> as is, but return a new record with the name set to <code>\"foo\"</code>. As you already know, there are other, more complex, implementations of setters, such as lenses.</li>\n<li>You also mention <strong>ST</strong>. This is a more advanced concept; it's basically used when you <em>have</em> to use some sort of mutable variable locally but still retain purity (which is not very often).</li>\n</ul>\n\n<p>Now to answer your other question: How do I use setters without lenses? Well, if you have a record like <code>data Foo = Foo {val :: Int, val2 :: String}</code> (your example + an extra field), and you have an old record - let's say <code>oldRecord = Foo { val = 1, val2 = \"test\" }</code>, Haskell has special setter syntax: doing <code>oldRecord { val = 2 }</code> will give a <strong>new</strong> record with <code>val</code> set to <code>2</code> - that is, it will give <code>Foo { val = 2, val2 = \"test\" }</code>. Obviously this syntax is a bit clumsy though for nested records, which is the reason lenses were invented.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1028880"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "answer_count": 2, "score": -6, "last_activity_date": 1553051741, "creation_date": 1552243886, "last_edit_date": 1553051741, "question_id": 55091157, "link": "https://stackoverflow.com/questions/55091157/what-is-the-way-to-implement-observable-other-than-control-lens-setter-in-haskel", "title": "What is the way to implement Observable other than Control.Lens.Setter in Haskell?", "body": "<p><a href=\"http://hackage.haskell.org/package/lens-3.7.1.2/docs/Control-Lens-Setter.html\" rel=\"nofollow noreferrer\">Control.Lens.Setter</a> is remarkable to use  Observable feature in Haskell. ( function/functor to be triggered when the value in the dataset is updated.  )</p>\n\n<p>However, considering the lens is not included in the standard environment, and then required to extra installation, without the lens, when I want to use just a primitive setter feature such as with a field label:</p>\n\n<pre><code>data Foo = Foo {val :: Int} \n</code></pre>\n\n<p>How to do this?</p>\n\n<p>Does ST Monad fit this purpose?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1552244040, "post_id": 55091150, "comment_id": 96926991, "body": "<a href=\"https://wiki.haskell.org/Handling_errors_in_Haskell\" rel=\"nofollow noreferrer\">wiki.haskell.org/Handling_errors_in_Haskell</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 0, "creation_date": 1552259909, "post_id": 55091241, "comment_id": 96931118, "body": "A minor correction: <code>import System.IO</code> is needed for <code>isEOF</code>."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 7, "last_activity_date": 1552302589, "last_edit_date": 1552302589, "creation_date": 1552244386, "answer_id": 55091241, "question_id": 55091150, "link": "https://stackoverflow.com/questions/55091150/change-exit-value-on-getline-exception-in-haskell/55091241#55091241", "title": "Change exit value on getLine exception in Haskell", "body": "<p>Your program never sees Control-D. What it <em>does</em> see is the fact that standard input has been closed, in this case by your <em>terminal</em> in response to Control-D being typed. This means you want to catch the EOF condition before <code>getLine</code> tries to read a line from a closed file.</p>\n\n<pre><code>import System.IO\nimport System.Exit\n\nmain :: IO ()\nmain = do\n    isClosed &lt;- isEOF\n    if isClosed \n      then exitWith (ExitFailure 84)\n      else getLine &gt;&gt;= putStrLn\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "is_accepted": false, "score": 1, "last_activity_date": 1552314144, "creation_date": 1552314144, "answer_id": 55104002, "question_id": 55091150, "link": "https://stackoverflow.com/questions/55091150/change-exit-value-on-getline-exception-in-haskell/55104002#55104002", "title": "Change exit value on getLine exception in Haskell", "body": "<p>Instead of manually checking for <code>isEof</code> you could just catch the IO exception as it happens:</p>\n\n<pre><code>import Control.Exception (catch)\nimport System.IO.Error(isEOFError)\nimport System.Exit\n\ntryMain :: IO ()\ntryMain = getLine &gt;&gt;= putStrLn\n\nmain :: IO ()\nmain = tryMain `catch` (\\e -&gt;\n  if isEOFError e\n  then exitWith (ExitFailure 84)\n  else exitWith (ExitFailure 99))\n\n</code></pre>\n\n<p>As you can in general not rule out IO exceptions in advance, this is the approach I'd recommend.</p>\n"}], "owner": {"reputation": 109, "user_id": 10628180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7bTVQYf2k74/AAAAAAAAAAI/AAAAAAAADCM/l_PdWAySHfg/photo.jpg?sz=128", "display_name": "Osa", "link": "https://stackoverflow.com/users/10628180/osa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 55091241, "answer_count": 2, "score": 3, "last_activity_date": 1552314144, "creation_date": 1552243856, "question_id": 55091150, "link": "https://stackoverflow.com/questions/55091150/change-exit-value-on-getline-exception-in-haskell", "title": "Change exit value on getLine exception in Haskell", "body": "<p>I'm working on a student project in Haskell and i'm having a problem with getLine's behaviour.\nHere's the code (simplified) :</p>\n\n<pre><code>main :: IO()\nmain = do\nstr &lt;- getLine\nputStrLn str\n</code></pre>\n\n<p>What i'd like to do is, when the user presses Ctrl+D, be able to exitWith (ExitFailure 84).\ngetLine simply prints an error and exit the program (and returns 1)</p>\n\n<pre><code>deBruijn: &lt;stdin&gt;: hGetLine: end of file\n</code></pre>\n\n<p>How to change this behaviour ? I only want to change the exit value to 84.</p>\n"}, {"tags": ["javascript", "haskell", "monad-transformers", "applicative"], "answers": [{"comments": [{"owner": {"reputation": 3831, "user_id": 5536315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/38Cjm.png?s=128&g=1", "display_name": "scriptum", "link": "https://stackoverflow.com/users/5536315/scriptum"}, "edited": false, "score": 0, "creation_date": 1552237325, "post_id": 55090025, "comment_id": 96924964, "body": "I was that close. Here is the working code: <code>(ap, of) =&gt; ttf =&gt; ttx =&gt; ap(ap(of(optAp)) (ttf)) (ttx)</code>. Thank you!"}, {"owner": {"reputation": 3831, "user_id": 5536315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/38Cjm.png?s=128&g=1", "display_name": "scriptum", "link": "https://stackoverflow.com/users/5536315/scriptum"}, "edited": false, "score": 0, "creation_date": 1552246496, "post_id": 55090025, "comment_id": 96927793, "body": "<code>optApT</code> can actually be simplified to <code>(map, ap) =&gt; ttf =&gt; ttx =&gt; ap(map(optAp) (ttf)) (ttx)</code>. And with eta reduction to <code>(map, ap) =&gt; ttf =&gt; ap(map(optAp) (ttf))</code> FP is amazing!"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1552236810, "last_edit_date": 1552236810, "creation_date": 1552236403, "answer_id": 55090025, "question_id": 55089491, "link": "https://stackoverflow.com/questions/55089491/maybet-applicative-instance-without-monad-constraint-for-the-outer-monad/55090025#55090025", "title": "MaybeT applicative instance without monad constraint for the outer monad", "body": "<p>Hopefully this helps...</p>\n\n<p>Here are the types associated with the various type-class functions:</p>\n\n<pre><code>abf &lt;&lt;**&gt;&gt; abs = pure (&lt;*&gt;) &lt;*&gt; abf &lt;*&gt; abs\n                  (4)  (3)  (2)     (1)\n\n(1), (2): the `ap` for type a\n(3): the `ap` for type b\n(4): the `pure` for type a\n</code></pre>\n\n<p>And the evaluation order is:</p>\n\n<pre><code>(pure (&lt;*&gt;)) &lt;*&gt; abf &lt;*&gt; abs\n</code></pre>\n"}], "owner": {"reputation": 3831, "user_id": 5536315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/38Cjm.png?s=128&g=1", "display_name": "scriptum", "link": "https://stackoverflow.com/users/5536315/scriptum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 55090025, "answer_count": 1, "score": 3, "last_activity_date": 1552236810, "creation_date": 1552233214, "last_edit_date": 1552236053, "question_id": 55089491, "link": "https://stackoverflow.com/questions/55089491/maybet-applicative-instance-without-monad-constraint-for-the-outer-monad", "title": "MaybeT applicative instance without monad constraint for the outer monad", "body": "<p>I am implementing the monad transformer of the <code>Maybe</code> (aka <code>Option</code>) type in Javascript (please note that I use type-dictionary passing):</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>const optOfT = of =&gt; x =&gt;\n  of(optOf(x));\n\nconst optMapT = map =&gt; f =&gt; ttx =&gt;\n  map(optMap(f)) (ttx);\n\nconst optApT = chain =&gt; ttf =&gt; ttx =&gt;\n  chain(tf =&gt;\n    chain(tx =&gt;\n      optAp(tf) (tx)) (ttx)) (ttf);\n\nconst optChainT = chain =&gt; fm =&gt; mmx =&gt;\n  chain(mx =&gt;\n    optChain(fm) (mx)) (mmx);\n</code></pre>\n\n<p>(map ~ <code>&lt;$&gt;</code>, ap ~ <code>&lt;*&gt;</code>, chain ~ <code>=&lt;&lt;</code>, of = pure/return)</p>\n\n<p>While this code works I wonder if I can implement <code>optApT</code> without the monad constraint for the outer monad. I stumbled upon this Haskell example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>(&lt;&lt;**&gt;&gt;) :: (Applicative a, Applicative b) =&gt; a (b (s -&gt; t)) -&gt; a (b s) -&gt; a (b t)\nabf &lt;&lt;**&gt;&gt; abs = pure (&lt;*&gt;) &lt;*&gt; abf &lt;*&gt; abs\n</code></pre>\n\n<p>This seems exactly what I want, but I can't recognize the evaluation order of <code>pure (&lt;*&gt;) &lt;*&gt; abf &lt;*&gt; abs</code> and which <code>&lt;*&gt;</code> operator belongs to which applicative layer:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>const optApT = (ap, of) =&gt; ttf =&gt; ttx =&gt;\n  ...?\n</code></pre>\n\n<p>Any hint is appreciated.</p>\n"}, {"tags": ["parsing", "haskell", "parser-combinators"], "answers": [{"comments": [{"owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 0, "creation_date": 1552260142, "post_id": 55089659, "comment_id": 96931156, "body": "You were right, it was state in the <a href=\"https://hackage.haskell.org/package/base/docs/Text-ParserCombinators-ReadP.html#g:4\" rel=\"nofollow noreferrer\">doc</a> about list of all possible parses. There are lots of things in parsing (e.g., ReadP, ReadS, readPrec, readsPrec, readP_to_S, readP_to_Prec, ...), I still can&#39;t get the clear overview picture of how they are related. Do you have any additional recommend learning resources?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 1, "creation_date": 1552269009, "post_id": 55089659, "comment_id": 96932618, "body": "(Added more info about the <code>ReadS</code>, <code>ReadP</code> and <code>ReadPrec</code> types in the original response.)"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 4, "last_activity_date": 1552268973, "last_edit_date": 1552268973, "creation_date": 1552234125, "answer_id": 55089659, "question_id": 55086822, "link": "https://stackoverflow.com/questions/55086822/understanding-text-parsercombinators-readp-sepby1/55089659#55089659", "title": "Understanding Text.ParserCombinators.ReadP.sepBy1", "body": "<p>Running <code>ReadP</code> will return all the possible parses. You can restrict the number of valid parses by specifying what should happen after the <code>sepBy1</code> parse, e.g. end of input or some other syntactic element.</p>\n\n<p>For instance, try something like:</p>\n\n<pre><code>readValues = do\n  xs &lt;- (munch isAlpha) `sepBy1` (char '-')\n  eof\n  pure $ V xs\n</code></pre>\n\n<p>Addendum...</p>\n\n<p>The <code>ReadS</code> type follows the development of monadic parsing as presented in the classic Hutton and Meijer paper <a href=\"http://www.cs.nott.ac.uk/~pszgmh/pearl.pdf\" rel=\"nofollow noreferrer\">Monadic Parsing in Haskell</a>. From the little documentation there is, I gather that the <code>ReadP</code> implements parallel exploration of all alternatives. There is a lot of support for creating <code>ReadP</code> actions and not so much for <code>ReadS</code>, so I think you're using the library correctly by building a <code>ReadP</code> action and then using <code>readP_to_S</code> at the end. When I've used the module I've just taken the first match of the <code>ReadS</code> action (or returned a parse error if it was the empty list.)</p>\n\n<p>The <code>ReadPrec</code> monad is used to support precedence, and it basically is <code>ReaderT Int ReadP</code> -- here the <code>Int</code> is the current precedence. Again, it looks like you start with a <code>ReadP</code> parser and then convert it to a <code>ReadPrec</code> action using <code>lift</code> or <code>readP_to_Prec</code>. To run it you can use <code>readPrec_to_S</code> just like in the <code>ReadP</code> case.</p>\n"}], "owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "accepted_answer_id": 55089659, "answer_count": 1, "score": 1, "last_activity_date": 1552708268, "creation_date": 1552214382, "last_edit_date": 1552708268, "question_id": 55086822, "link": "https://stackoverflow.com/questions/55086822/understanding-text-parsercombinators-readp-sepby1", "title": "Understanding Text.ParserCombinators.ReadP.sepBy1", "body": "<p>I am confused by the result of <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Text-ParserCombinators-ReadP.html#v:sepBy1\" rel=\"nofollow noreferrer\">sepBy1</a></p>\n\n<p>Following code is running in ghci</p>\n\n<pre><code>\u03bb&gt; import Text.ParserCombinators.ReadP\n\u03bb&gt; import Data.Char\n\n\u03bb&gt; readP_to_S ((munch1 isAlpha) `sepBy1` (char '-')) \"dish-dash-dosh\"\n[([\"dish\"],\"-dash-dosh\"),([\"dish\",\"dash\"],\"-dosh\"),[\"dish\",\"dash\",\"dosh\"],\"\")]\n\n</code></pre>\n\n<ol>\n<li>Why it is not the case that output is <code>[([\"dish\",\"dash\",\"dosh\"],\"\")]</code>?</li>\n</ol>\n\n<p>The following <code>doctest</code> is <strong>only one</strong> that failed.</p>\n\n<pre><code>-- |\n-- &gt;&gt;&gt; readP_to_S readValues \"dish-dash-dosh\"\n-- [(V [\"dish\",\"dash\",\"dosh\"],\"\")\nreadValues :: ReadP Value\nreadValues = do\n  xs &lt;- (munch isAlpha) `sepBy1` (char '-')\n  pure $ V xs\n</code></pre>\n\n<pre><code>Main.hs:64: failure in expression `readP_to_S readValues \"dish-dash-dosh\"'\nexpected: [(V [\"dish\",\"dash\",\"dosh\"],\"\")\n but got: [(V [\"dish\"],\"-dash-dosh\"),(V [\"dish\",\"dash\"],\"-dosh\"),(V [\"dish\",\"dash\",\"dosh\"],\"\")]\n\n</code></pre>\n\n<p>I am using <code>ReadP</code> for <code>Read</code> instance of my data. The code for <code>Read</code> instance is working but I am confused. </p>\n\n<p>Haven't done any complex parsing, I always think that running <code>ReadP</code> will return output in form of single element list <code>[(result,\"\")]</code>, obviously it is not the case.</p>\n\n<pre><code>data Value = V [String]\n  deriving Show\n\n-- |\n-- &gt;&gt;&gt; read \"dish-dash-dosh\" :: Value\n-- V [\"dish\",\"dash\",\"dosh\"]\n--\ninstance Read Value where\n  readPrec = readP_to_Prec (const readValues)\n\n</code></pre>\n\n<ol start=\"2\">\n<li>Is it the case that <code>read</code> will success only if there is nothing left in the <code>snd</code> of the last <code>[(Value,String)]</code>, other elements in this list are unuse anywhere?</li>\n</ol>\n\n<p>I am aware of alternative <a href=\"https://stackoverflow.com/questions/40710600/how-to-parse-a-string-of-comma-separated-values-into-a-list-of-strings-in-haskel\">way</a> to do this. This question is solely about understanding <code>sepBy</code> output and it usage.</p>\n"}, {"tags": ["haskell", "monads", "io-monad", "do-notation"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 9, "creation_date": 1552192765, "post_id": 55084440, "comment_id": 96914417, "body": "What is the error message? This code looks fine."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1552193802, "post_id": 55084440, "comment_id": 96914568, "body": "<i>you can&#39;t compare a char literal to an IO Char directly</i> <a href=\"https://ideone.com/BRnc5e\" rel=\"nofollow noreferrer\">Apparently the code isn&#39;t doing that</a>"}, {"owner": {"reputation": 181, "user_id": 9985445, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y4ooBZ_hzRc/AAAAAAAAAAI/AAAAAAAAAtQ/dL_nPMm3FLM/photo.jpg?sz=128", "display_name": "James Strieter", "link": "https://stackoverflow.com/users/9985445/james-strieter"}, "edited": false, "score": 0, "creation_date": 1552228621, "post_id": 55084440, "comment_id": 96922280, "body": "Added error message to question"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1552229887, "post_id": 55084440, "comment_id": 96922644, "body": "Your error message seems to be about completely different code than what you posted. Please have code exemplifying your actual problem in your question."}, {"owner": {"reputation": 181, "user_id": 9985445, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y4ooBZ_hzRc/AAAAAAAAAAI/AAAAAAAAAtQ/dL_nPMm3FLM/photo.jpg?sz=128", "display_name": "James Strieter", "link": "https://stackoverflow.com/users/9985445/james-strieter"}, "edited": false, "score": 0, "creation_date": 1552231748, "post_id": 55084440, "comment_id": 96923189, "body": "That&#39;s a good point. The errant code was for a related but different issue, so I will create a separate question for that. My apologies I&#39;m new at this."}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 5, "last_activity_date": 1552193781, "creation_date": 1552193781, "answer_id": 55084549, "question_id": 55084440, "link": "https://stackoverflow.com/questions/55084440/how-to-wrap-char-literal-in-io-monad-in-haskell/55084549#55084549", "title": "How to wrap char literal in IO monad in Haskell?", "body": "<blockquote>\n  <p>But you can't compare a char literal to an IO Char directly.</p>\n</blockquote>\n\n<p>Sure, but when you \"bind\" the result of the IO action it is no longer an <code>IO Char</code> but just a <code>Char</code> so that's why it works.</p>\n\n<p>In more words:</p>\n\n<pre><code>Prelude&gt; :t getChar\ngetChar :: IO Char\nPrelude&gt; c &lt;- getChar\nx\nPrelude&gt; :t c\nc :: Char\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 6, "creation_date": 1552207071, "post_id": 55084551, "comment_id": 96916901, "body": "just one nitpick, <code>getChar</code> does not &quot;return <code>IO Char</code>, it <i>is</i> <code>IO Char</code>."}], "tags": [], "owner": {"reputation": 7577, "user_id": 5638835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fba9e7db4baba416a82c4277758d886?s=128&d=identicon&r=PG&f=1", "display_name": "puhlen", "link": "https://stackoverflow.com/users/5638835/puhlen"}, "is_accepted": true, "score": 8, "last_activity_date": 1552244191, "last_edit_date": 1552244191, "creation_date": 1552193816, "answer_id": 55084551, "question_id": 55084440, "link": "https://stackoverflow.com/questions/55084440/how-to-wrap-char-literal-in-io-monad-in-haskell/55084551#55084551", "title": "How to wrap char literal in IO monad in Haskell?", "body": "<p>The code you posted looks perfectly correct and functional. </p>\n\n<p>do-notation is a way of working with value in monad. </p>\n\n<p><code>c &lt;- getChar</code> within the do block binds c to the char inside the <code>IO Char</code> you get with <code>getChar</code>.  You can compare <code>c == 'q'</code> just fine here because c is a plain char, not an <code>IO Char</code>. </p>\n\n<p>To answer you direct question, you can use the <code>return</code> function to put a pure value into any monad, including IO, so <code>return 'q'</code> \"wraps\" the character literal 'q' into a monad.  This isn't what you want in this case, the code you already have is what you are looking for. </p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1552228586, "creation_date": 1552228586, "answer_id": 55088771, "question_id": 55084440, "link": "https://stackoverflow.com/questions/55084440/how-to-wrap-char-literal-in-io-monad-in-haskell/55088771#55088771", "title": "How to wrap char literal in IO monad in Haskell?", "body": "<p>One of the most important things to understand about the <code>IO</code> monad is that the expression <code>m &gt;&gt;= f</code> does <em>not</em> execute the action <code>m</code>, nor does it every call the function <code>f</code>. </p>\n\n<p>Instead, it just creates a <em>new</em> <code>IO</code> action that wraps both <code>m</code> and <code>f</code> and, when executed, finally executes <code>m</code>, extracts the return value, and calls <code>f</code> with the result.</p>\n\n<p>That's it. Your entire Haskell program is nothing but a DSL for building a single IO action that gets assigned to <code>main</code>, which the Haskell <em>runtime</em> will execute for you.</p>\n\n<p>So when you write</p>\n\n<pre><code>-- Rewritten slightly for brevity\nmyFunction = do\n    c &lt;- getChar\n    putStrLn (if (c == 'q')\n        then \"take action 1\"\n        else \"take action 2\")\n</code></pre>\n\n<p>this is desugared to</p>\n\n<pre><code>myFunction = getChar &gt;&gt;= (\\c -&gt; putStrLn (if (c == 'q') then \"take action 1\" else \"take action 2\")\n</code></pre>\n\n<p>and what you are actually saying is \"Build an <code>IO</code> action containing <code>getChar</code> and a function of type <code>Char -&gt; IO ()</code>, such that when this action is executed, it executes <code>getChar</code> and passes the resulting <code>Char</code> to the function to produce <em>another</em> <code>IO</code> action to be executed immediately.\"</p>\n"}], "owner": {"reputation": 181, "user_id": 9985445, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y4ooBZ_hzRc/AAAAAAAAAAI/AAAAAAAAAtQ/dL_nPMm3FLM/photo.jpg?sz=128", "display_name": "James Strieter", "link": "https://stackoverflow.com/users/9985445/james-strieter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 540, "favorite_count": 0, "accepted_answer_id": 55084551, "answer_count": 3, "score": 2, "last_activity_date": 1552244191, "creation_date": 1552192237, "last_edit_date": 1552228600, "question_id": 55084440, "link": "https://stackoverflow.com/questions/55084440/how-to-wrap-char-literal-in-io-monad-in-haskell", "title": "How to wrap char literal in IO monad in Haskell?", "body": "<p>I know you're supposed to wrap up the operations you want to perform on a result in a monad rather than unwrap things from the monad. </p>\n\n<p>What I can't find are any idiot-friendly examples of how to do that. </p>\n\n<p>For example, I want to do something like this:</p>\n\n<pre><code>myFunction = do\n    c &lt;- getChar\n    if (c == 'q')\n        then putStrLn \"take action 1\"\n        else putStrLn \"take action 2\"\n</code></pre>\n\n<p>But you can't compare a char literal to an IO Char directly. </p>\n\n<p>GHCi version is 8.4.4.</p>\n\n<p>Error Message:</p>\n\n<p>[1 of 2] Compiling Lib              ( /Users/jamesstrieter/hask-tink/src/Lib.hs, interpreted )</p>\n\n<p>/Users/jamesstrieter/hask-tink/src/Lib.hs:66:18: error:\n    \u2022 Couldn't match expected type \u2018IO char\u2019 with actual type \u2018Char\u2019\n    \u2022 In the second argument of \u2018(==)\u2019, namely \u2018'q'\u2019\n      In the expression: x == 'q'\n      In an equation for \u2018what2do\u2019: what2do x = x == 'q'\n    \u2022 Relevant bindings include\n        x :: IO char\n          (bound at /Users/jamesstrieter/hask-tink/src/Lib.hs:66:9)\n        what2do :: IO char -> Bool\n          (bound at /Users/jamesstrieter/hask-tink/src/Lib.hs:66:1)\n   |\n66 | what2do x = x == 'q'\n   |                  ^^^\nFailed, no modules loaded.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 6, "creation_date": 1552174795, "post_id": 55083024, "comment_id": 96911727, "body": "It seems you are guessing at haskell&#39;s syntax. I think this question is a little too broad (SO is not a homework writing service). Maybe you can cut this down to one specific problem? For instance you are having trouble with the first argument to <code>hoMergeSort</code>, so why not remove all the other parts of your question and ask about <code>( (x,_,_) (x&#39;,_,_) = x&lt;x&#39; )</code>: what type is this supposed to have? What do you want it to do? What errors do you get from the compiler and what specifically is confusing you about them?"}, {"owner": {"reputation": 19, "user_id": 8952473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2946dbc7c32ba8a68ade32666927dd29?s=128&d=identicon&r=PG&f=1", "display_name": "henahzurfdsa", "link": "https://stackoverflow.com/users/8952473/henahzurfdsa"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1552175031, "post_id": 55083024, "comment_id": 96911792, "body": "Sorry, I thought i specified. What I mean is what sort of code will allow to me compare the 1st elements of the tuples with a function in place of <code>( (x,_,_) (x&#39;,_,_) = x&lt;x&#39; )</code>"}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1552181741, "post_id": 55083024, "comment_id": 96912918, "body": "Did you understand your solution to exercise 2 after you wrote it? Probably worth making sure you do understand it before moving on to the later steps"}, {"owner": {"reputation": 2522, "user_id": 324969, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/60babc4ee603c9f9156ea0e52280b335?s=128&d=identicon&r=PG", "display_name": "Suzanne Soy", "link": "https://stackoverflow.com/users/324969/suzanne-soy"}, "edited": false, "score": 0, "creation_date": 1552204350, "post_id": 55083024, "comment_id": 96916412, "body": "Welcome to StackOverflow @henahzurfdsa! We generally add the <code>homework</code> tag for homework-related questions, could you edit your post to add the tag? While you&#39;re at it, don&#39;t hesitate to include the clarification in your comment (saying that you&#39;re looking for a replacement for <code>( (x,_,_) (x&#39;,_,_) = x&lt;x&#39; )</code>) in your post. Other than that, it seems to me that this is a well-written question \u2014 it shows what you tried and asks something clear :) ."}], "answers": [{"comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552195247, "post_id": 55083422, "comment_id": 96914768, "body": "The ordering you define in the last sentence seems wrong. In particular, with that order, (1,2,3) &lt; (3,2,1) is true, but so is (3,2,1) &lt; (1,2,3)."}, {"owner": {"reputation": 2522, "user_id": 324969, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/60babc4ee603c9f9156ea0e52280b335?s=128&d=identicon&r=PG", "display_name": "Suzanne Soy", "link": "https://stackoverflow.com/users/324969/suzanne-soy"}, "edited": false, "score": 0, "creation_date": 1552204763, "post_id": 55083422, "comment_id": 96916497, "body": "The OP is looking to sort &quot;lexicographically by names&quot;, so they want the lexicographical order on the first field <code>(&quot;bar&quot;,&quot;zozo&quot;,9) &lt; (&quot;foo&quot;,&quot;alfa&quot;,2)</code> because <code>&quot;bar&quot; &lt; &quot;foo&quot;</code>. So I&#39;d argue it <i>is</i> the lexicographical order (on a projection, not on the whole tuple)."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 2522, "user_id": 324969, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/60babc4ee603c9f9156ea0e52280b335?s=128&d=identicon&r=PG", "display_name": "Suzanne Soy", "link": "https://stackoverflow.com/users/324969/suzanne-soy"}, "edited": false, "score": 0, "creation_date": 1552206758, "post_id": 55083422, "comment_id": 96916839, "body": "@GeorgesDup&#233;ron on re-reading the post, I think you&#39;re right. fortunately, strings are already compared lexicographically, by <code>&lt;</code>."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 0, "last_activity_date": 1552204048, "last_edit_date": 1552204048, "creation_date": 1552178482, "answer_id": 55083422, "question_id": 55083024, "link": "https://stackoverflow.com/questions/55083024/haskell-function-to-sort-1st-element-of-3-tuples-lexicographically/55083422#55083422", "title": "Haskell: function to sort 1st element of 3 tuples lexicographically", "body": "<p>Let's not run. Let's move slowly with this:</p>\n\n<pre><code>-- sortLastName [(x,y,z)] = hoMergeSort ( (x,_,_) (x',_,_) = x&lt;x' ) [(x,y,z)]\nsortLastName xyzs = hoMergeSort fun xyzs\n    where\n</code></pre>\n\n<p>Let's look into that definition for a moment,</p>\n\n<pre><code>-- homerge fun (x:xs) (y:ys) | fun x &lt; fun y = x : homerge fun xs (y:ys)\n</code></pre>\n\n<p>See, we have <code>fun x</code> and <code>fun y</code> there? The results of which go as operands into the <code>&lt;</code> comparison? </p>\n\n<pre><code>    fun (x,y,z) =  \n</code></pre>\n\n<p>which value from those available here do we want to go into the <code>&lt;</code> comparison as an operand? </p>\n\n<pre><code>                  .....\n</code></pre>\n\n<p><code>fun</code> isn't used for comparison. <em>That</em> is done by <code>&lt;</code>, in your source code of the function <code>homerge</code>. The <code>fun</code> function is used to <em>supply the value</em> to be used in that comparison.</p>\n\n<p>Go slowly, get far.</p>\n\n<hr>\n\n<p>Note that this is not lexicographical order. This is ordering by nth field of a triple, regardless of the values of the other fields. The lexicographical order is rather</p>\n\n<pre><code>(x,y,z) &lt; (a,b,c) = x &lt; a || x==a &amp;&amp; (y &lt; b || y==b &amp;&amp; z &lt; c)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2522, "user_id": 324969, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/60babc4ee603c9f9156ea0e52280b335?s=128&d=identicon&r=PG", "display_name": "Suzanne Soy", "link": "https://stackoverflow.com/users/324969/suzanne-soy"}, "is_accepted": false, "score": 0, "last_activity_date": 1552206521, "last_edit_date": 1552206521, "creation_date": 1552205295, "answer_id": 55085706, "question_id": 55083024, "link": "https://stackoverflow.com/questions/55083024/haskell-function-to-sort-1st-element-of-3-tuples-lexicographically/55085706#55085706", "title": "Haskell: function to sort 1st element of 3 tuples lexicographically", "body": "<p>The syntax</p>\n\n<pre><code>-- ( (x,_,_) (x',_,_) = x&lt;x' )\n</code></pre>\n\n<p>is not quite valid. To create an anonymous function, use the syntax <code>\\arg -&gt; result</code>. If you were to write the above, the result would be is another function which returns <code>x&lt;x'</code>:</p>\n\n<pre><code>-- \\(x,_,_) -&gt; ( \\(x',_,_) -&gt; x&lt;x' )\n-- i.e. without the parentheses:\n-- \\(x,_,_) -&gt; \\(x',_,_) -&gt; x&lt;x'\n</code></pre>\n\n<p>As @WillNess pointed out, you are already doing the comparison <code>fun x &lt; fun y</code> inside the definition of <code>homerge</code>.</p>\n\n<p>The <code>fun</code> argument should therefore be a projection from the whole tuple to the part that you want to compare.</p>\n\n<pre><code>\\(x,_,_) -&gt; x\n</code></pre>\n\n<p>The whole sortLastName function is then:</p>\n\n<pre><code>sortLastName xyzs = hoMergeSort (\\(name,_,_) -&gt; name) xyzs where\n</code></pre>\n\n<p>As @WillNess suggested, you can use the <code>where</code> syntax which is very practical for small helper definitions:</p>\n\n<pre><code>sortLastName xyzs = hoMergeSort fun xyzs where\n  fun (name,_,_) = name\n</code></pre>\n\n<p>Note that by supplying only a comparison, you cannot easily reverse the order. If the <code>name</code> field was a <code>Num</code>, you could return <code>0-x</code>, i.e. <code>\\(x,_,_) -&gt; -x</code> to sort in descending order, but for strings there is no practical way to do this. It would therefore be better if you modified <code>hoMergeSort</code> so that it accepts a comparison with two arguments, instead of expecting a projection of a single argument.</p>\n"}], "owner": {"reputation": 19, "user_id": 8952473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2946dbc7c32ba8a68ade32666927dd29?s=128&d=identicon&r=PG&f=1", "display_name": "henahzurfdsa", "link": "https://stackoverflow.com/users/8952473/henahzurfdsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 205, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1552206521, "creation_date": 1552174177, "question_id": 55083024, "link": "https://stackoverflow.com/questions/55083024/haskell-function-to-sort-1st-element-of-3-tuples-lexicographically", "title": "Haskell: function to sort 1st element of 3 tuples lexicographically", "body": "<p>Suppose we have a spreadsheet :: [(String,String,Int)] containing\ntriples (name, user,mark) where name is the lastname of a student, user\nis his username and mark is the result of the student\u2019s first CW.\nWrite a function sortLastname that sorts a spreadsheet lexicographically\nby names using the higher order insertion sort defined in Exercise 2.</p>\n\n<p>My code for exercise 2:</p>\n\n<pre><code>homerge :: Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a] -&gt; [a]\nhomerge _ xs [] = xs\nhomerge _ [] ys = ys\nhomerge fun (x:xs) (y:ys) | fun x &lt; fun y = x : homerge fun xs (y:ys)\n                          | otherwise = y : homerge fun (x:xs) ys`\n\n\nhoMergeSort :: Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]\nhoMergeSort _ [x] = [x]\nhoMergeSort fun xs = homerge fun (hoMergeSort fun ys) (hoMergeSort fun ws)\n                 where (ys,ws) = (take l xs, drop l xs)\n                               where l = length xs `div` 2\n</code></pre>\n\n<p>My current attempt:</p>\n\n<pre><code>sortLastName [(x,y,z)] = hoMergeSort ( (x,_,_) (x',_,_) = x&lt;x' ) [(x,y,z)]\n</code></pre>\n\n<p>My problem is getting the correct function to check whether the first element of 3-tuple is less than the next element. </p>\n\n<p>Any advice would be really appreciated.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552168903, "post_id": 55082377, "comment_id": 96910500, "body": "Do you have a working implementation of a regular merge sort?"}, {"owner": {"reputation": 19, "user_id": 8952473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2946dbc7c32ba8a68ade32666927dd29?s=128&d=identicon&r=PG&f=1", "display_name": "henahzurfdsa", "link": "https://stackoverflow.com/users/8952473/henahzurfdsa"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552169107, "post_id": 55082377, "comment_id": 96910543, "body": "Yes - <code>msort [] = [] msort [x] = [x] msort xs = merge (msort ys) (msort ws) where (ys,ws) = (take l xs, drop l xs) where l = length xs \u2018div\u2018 2</code>"}, {"owner": {"reputation": 19, "user_id": 8952473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2946dbc7c32ba8a68ade32666927dd29?s=128&d=identicon&r=PG&f=1", "display_name": "henahzurfdsa", "link": "https://stackoverflow.com/users/8952473/henahzurfdsa"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552169159, "post_id": 55082377, "comment_id": 96910552, "body": "<code>merge [] ys = ys merge xs [] = xs merge (x:xs) (y:ys) = if x&lt;y then x : merge xs (y:ys) else y : merge (x:xs) ys</code>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1552169254, "post_id": 55082377, "comment_id": 96910579, "body": "&quot;the compiler is not having any of it&quot; and the error message is.......?"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8952473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2946dbc7c32ba8a68ade32666927dd29?s=128&d=identicon&r=PG&f=1", "display_name": "henahzurfdsa", "link": "https://stackoverflow.com/users/8952473/henahzurfdsa"}, "edited": false, "score": 0, "creation_date": 1552174657, "post_id": 55082437, "comment_id": 96911698, "body": "hey lorenzo, wonder if u can help me with this one aswell <a href=\"https://stackoverflow.com/questions/55083024/haskell-function-to-sort-1st-element-of-3-tuples-lexicographically\" title=\"haskell function to sort 1st element of 3 tuples lexicographically\">stackoverflow.com/questions/55083024/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": true, "score": 3, "last_activity_date": 1552174944, "last_edit_date": 1552174944, "creation_date": 1552169146, "answer_id": 55082437, "question_id": 55082377, "link": "https://stackoverflow.com/questions/55082377/haskell-higher-order-functions/55082437#55082437", "title": "Haskell: Higher order functions", "body": "<p>You want to insert <code>x</code> into the list, not <code>fun x</code>. Here is a function that should work:</p>\n\n<pre><code>homerge :: Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a] -&gt; [a]\nhomerge _ xs [] = xs\nhomerge _ [] ys = ys\nhomerge f (x:xs) (y:ys) | f x &lt; f y = x : homerge f xs (y:ys)\n                        | otherwise = y : homerge f (x:xs) ys\n</code></pre>\n\n<p>Note I used guards because they make the code much more clear then if-then-else. Also this only merges two already-sorted lists.</p>\n"}], "owner": {"reputation": 19, "user_id": 8952473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2946dbc7c32ba8a68ade32666927dd29?s=128&d=identicon&r=PG&f=1", "display_name": "henahzurfdsa", "link": "https://stackoverflow.com/users/8952473/henahzurfdsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 55082437, "answer_count": 1, "score": -1, "last_activity_date": 1552174944, "creation_date": 1552168717, "question_id": 55082377, "link": "https://stackoverflow.com/questions/55082377/haskell-higher-order-functions", "title": "Haskell: Higher order functions", "body": "<p><strong>The Problem:</strong></p>\n\n<p>Implement the higher order insertion sort algorithm hoMergeSort which\nis similar to merge sort except that an element x is placed before an\nelement y if fun x &lt; fun y where fun :: a -> b is a function taken as\ninput by higher order merge sort. In other words, the result of evaluating\nhoMergeSort fun xs should be a list [y1,y2,..., yn] such that\nfun y1 &lt; fun y2 &lt; ... &lt; fun yn.</p>\n\n<p>My non-working attempt:</p>\n\n<pre><code>homerge :: Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a] -&gt; [a]\nhomerge _ xs [] = xs\nhomerge _ [] ys = ys\nhomerge fun (x:xs) (y:ys) = if (fun x)&lt;(fun y) then fun x : (homerge fun xs (y:ys)) \n                            else y : (homerge fun (x:xs) ys)\n</code></pre>\n\n<p>I've been trying to get my head around this problem for the past hour and a half and have been making no progress. The way I've written my code makes sense to me but the compiler is not having any of it. </p>\n\n<p>Not looking for someone to completely solve the question for me, just set me on the right track of thinking.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["macos", "haskell", "macos-mojave", "binutils", "nix"], "owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1552160948, "creation_date": 1552160948, "question_id": 55081321, "link": "https://stackoverflow.com/questions/55081321/cctools-binutils-darwin-bin-ranlib-failed-malformed-object-unknown-load-comman", "title": "cctools-binutils-darwin/bin/ranlib failed, malformed object (unknown load command)", "body": "<p>I am attempting to build the <code>gitlib-libgit2</code> Haskell package on macos via nix in roughly the following manner.</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>mkdir nix-repro &amp;&amp; cd nix-repro\ncabal2nix --no-check cabal://gitlib-libgit2 &gt; gitlib-libgit2.nix\necho '(import &lt;nixpkgs&gt; {}).haskellPackages.callPackage ./gitlib-libgit2.nix {}' &gt; default.nix\nnix-build\n</code></pre>\n\n<p>I am seeing the following warnings and error:</p>\n\n<pre><code>ld: warning: /nix/store/spx9xz1jv3yhmqw8y3agki1fvdr2x2fv-libiconv-osx-10.11.6/lib/libiconv.dylib, ignoring unexpected dylib file\nld: warning: /nix/store/spx9xz1jv3yhmqw8y3agki1fvdr2x2fv-libiconv-osx-10.11.6/lib/libiconv.dylib, ignoring unexpected dylib file\n/nix/store/s33984hx2gwcg2d4dgpcm4342md19qvh-cctools-binutils-darwin/bin/ranlib: object: dist/build/libHSgitlib-libgit2-3.1.2.1-1fYQZMedHRP3aXiBXJFDO2-ghc8.6.3.a(s2_meth.o) malformed object (unknown load command 1)\n`ranlib' failed in phase `Ranlib'. (Exit code: 1)\nbuilder for '/nix/store/yrran1p69pvdq1b34jqfq7dmd95j9fh9-gitlib-libgit2-3.1.2.1.drv' failed with exit code 1\nerror: build of '/nix/store/yrran1p69pvdq1b34jqfq7dmd95j9fh9-gitlib-libgit2-3.1.2.1.drv' failed\n</code></pre>\n\n<p>What does this mean, and how can I go about fixing it?</p>\n\n<p>It only fails this way on macos, as far as I can tell. I'm on nixpkgs-unstable. I am able to build this package using other tools, so the failure must be something specific to the nix tooling I'm using to build it.</p>\n\n<pre><code>$ cat $HOME/.nix-defexpr/channels/nixpkgs/.git-revision\n6e5caa3f8ac48750233ef82a94825be238940825\n</code></pre>\n\n<p>Here's the full <code>gitlib-libgit2.nix</code> expression if you don't want to run <code>cabal2nix</code> for yourself:</p>\n\n<pre><code>{ mkDerivation, base, bytestring, conduit, conduit-combinators\n, containers, directory, exceptions, fast-logger, filepath, gitlib\n, gitlib-test, hlibgit2, hspec, hspec-expectations, HUnit, mmorph\n, monad-loops, mtl, resourcet, stdenv, stm, stm-conduit, tagged\n, template-haskell, text, text-icu, time, transformers\n, transformers-base, unliftio, unliftio-core\n}:\nmkDerivation {\n  pname = \"gitlib-libgit2\";\n  version = \"3.1.2.1\";\n  sha256 = \"b90e0ad2e7e0f58379e02cbe60d2900c95f0a255c34bd3461f8ee5753a6aa23e\";\n  libraryHaskellDepends = [\n    base bytestring conduit conduit-combinators containers directory\n    exceptions fast-logger filepath gitlib hlibgit2 mmorph monad-loops\n    mtl resourcet stm stm-conduit tagged template-haskell text text-icu\n    time transformers transformers-base unliftio unliftio-core\n  ];\n  testHaskellDepends = [\n    base exceptions gitlib gitlib-test hspec hspec-expectations HUnit\n    transformers\n  ];\n  doCheck = false;\n  description = \"Libgit2 backend for gitlib\";\n  license = stdenv.lib.licenses.mit;\n}\n</code></pre>\n"}, {"tags": ["haskell", "coq", "church-encoding"], "answers": [{"comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1552163278, "post_id": 55081624, "comment_id": 96909016, "body": "Doesn&#39;t the <code>forall m</code> break the static guarantee? Shouldn&#39;t it be fixed so that <code>n ~ S m</code>?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1552163447, "post_id": 55081624, "comment_id": 96909054, "body": "@FyodorSoikin I don&#39;t think so. The inductive case needs to work on any <code>m</code> (otherwise, how are you to perform induction?). Note that the right hand side of <code>type List a (S n)</code> does not mention <code>List a n</code>."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1552163615, "post_id": 55081624, "comment_id": 96909093, "body": "I see. My head hurts a bit though. :-)"}, {"owner": {"reputation": 1315, "user_id": 3780931, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7ed60a7e72a67346cacc5173dd359c65?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/3780931/bob"}, "edited": false, "score": 0, "creation_date": 1552164112, "post_id": 55081624, "comment_id": 96909209, "body": "Does it mean that Haskell is a dependently-typed language like Idris?"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 1315, "user_id": 3780931, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7ed60a7e72a67346cacc5173dd359c65?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/3780931/bob"}, "edited": false, "score": 0, "creation_date": 1552165142, "post_id": 55081624, "comment_id": 96909484, "body": "@Bob kind of. You can do most of the useful stuff, but not strictly everything that Idris can. The situation is gradually improving though."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 1315, "user_id": 3780931, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7ed60a7e72a67346cacc5173dd359c65?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/3780931/bob"}, "edited": false, "score": 0, "creation_date": 1552165203, "post_id": 55081624, "comment_id": 96909501, "body": "@Bob not yet. Some other examples from Coq or Idris have no Haskell equivalent. I&#39;m ill-placed to compare Haskell to Idris/Coq given that I don&#39;t really know either."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1552165572, "post_id": 55081624, "comment_id": 96909597, "body": "Even in the case where Haskell can do something, the syntax in Idris is usually much simpler; the language itself can fill in the details that Haskell makes you provide explicitly."}, {"owner": {"reputation": 1315, "user_id": 3780931, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7ed60a7e72a67346cacc5173dd359c65?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/3780931/bob"}, "edited": false, "score": 0, "creation_date": 1552170752, "post_id": 55081624, "comment_id": 96910889, "body": "When I replace Z and S by zero and succ of Church numeral I get an error &quot;Not is scope&quot; :-(  <code>type Nat = forall t. t -&gt; (t -&gt; t) -&gt; t  zero :: Nat zero = \\z _ -&gt; z  succ :: Nat -&gt; Nat succ n = \\z s -&gt; s (n z s)  type List (a :: Type) (n :: Nat) =   forall (x :: Nat -&gt; Type). x zero -&gt; (forall (m :: Nat). a -&gt; x m -&gt; x (succ m)) -&gt; x n</code>"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 1315, "user_id": 3780931, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7ed60a7e72a67346cacc5173dd359c65?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/3780931/bob"}, "edited": false, "score": 1, "creation_date": 1552170858, "post_id": 55081624, "comment_id": 96910907, "body": "@Bob that&#39;s one play where Haskell is not dependently typed enough: you can&#39;t just put any expression (like a church encoded numeral) into a type."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1315, "user_id": 3780931, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7ed60a7e72a67346cacc5173dd359c65?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/3780931/bob"}, "edited": false, "score": 1, "creation_date": 1552171507, "post_id": 55081624, "comment_id": 96911042, "body": "@Bob There are some big differences between real dependently typed languages and Haskell. A major one is that Haskell does not allow lambdas in types, e.g. <code>x :: F (\\n -&gt; ...)</code> is invalid. Similarly, if <code>x :: forall (f :: A -&gt; B). ...</code> we can&#39;t write <code>x (\\a -&gt; ...)</code> and choose the <code>f</code> argument in that way. Such <code>f</code> can only be chosen to be (roughly) a type constructor, usually defined though a <code>newtype</code> or <code>data</code>. In Haskell types, <code>f x = g y</code> iff <code>f=g</code> and <code>x=y</code>, which is nonsense in dependent types."}, {"owner": {"reputation": 1315, "user_id": 3780931, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7ed60a7e72a67346cacc5173dd359c65?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/3780931/bob"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1552174280, "post_id": 55081624, "comment_id": 96911616, "body": "@chi What are the reasons for these limitations?"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "reply_to_user": {"reputation": 1315, "user_id": 3780931, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7ed60a7e72a67346cacc5173dd359c65?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/3780931/bob"}, "edited": false, "score": 0, "creation_date": 1552183231, "post_id": 55081624, "comment_id": 96913140, "body": "@Bob Haskell wasn&#39;t conceived as a dependently typed language. Some dependly-typed-ish features were ported on top of Haskells existing type system as an extension, but turning Haskell into a fully dependently typed language is probably never going to happen - not least of all because while dependent typing is very useful in some concepts, it doesn&#39;t come without <a href=\"https://www.reddit.com/r/haskell/comments/3zc81v/tradeoffs_of_dependent_types_xpost_from_ridris/\" rel=\"nofollow noreferrer\">it&#39;s own set of tradeoffs</a> over the approach taken in Haskell"}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1552205078, "post_id": 55081624, "comment_id": 96916565, "body": "If you need more proof that this works: <a href=\"https://stackoverflow.com/q/50844444/5684257\">stackoverflow.com/q/50844444/5684257</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1315, "user_id": 3780931, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7ed60a7e72a67346cacc5173dd359c65?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/3780931/bob"}, "edited": false, "score": 1, "creation_date": 1552208660, "post_id": 55081624, "comment_id": 96917250, "body": "@Bob Mainly, it greatly simplifies type inference. If one calls <code>foo (Just True)</code> where <code>foo :: f a -&gt; ...</code> we get <code>f=Maybe</code> and <code>a = Bool</code>. In Coq, there are infinitely many solutions. Further, handling equality between types is made almost automatic when using Haskell GADTs, while in Coq we often need to prove a bunch of easy equations (at least, without some Coq plugins). The &quot;Hasochism&quot; paper describes GADTs vs equality in dependent types very well."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 4, "last_activity_date": 1552167313, "last_edit_date": 1552167313, "creation_date": 1552163116, "answer_id": 55081624, "question_id": 55081273, "link": "https://stackoverflow.com/questions/55081273/church-encoding-for-dependent-types-from-coq-to-haskell/55081624#55081624", "title": "Church encoding for dependent types: from Coq to Haskell", "body": "<p>Sure it is:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE RankNTypes #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE GADTs #-}\n\nimport Data.Kind        -- Needed for `Type`\n\ndata Nat = Z | S Nat    -- Roll your own...\n\ntype List (a :: Type) (n :: Nat) =\n  forall (x :: Nat -&gt; Type). x Z -&gt; (forall (m :: Nat). a -&gt; x m -&gt; x (S m)) -&gt; x n\n\nniln :: List a Z\nniln = \\z _ -&gt; z\n\nconsn :: a -&gt; List a n -&gt; List a (S n)\nconsn a l = \\n c -&gt; c a (l n c)\n</code></pre>\n\n<p>Further proof (for skeptics) of the isomorphism with the usual GADT formulation:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data List' (a :: Type) (n :: Nat) where\n  Nil :: List' a Z\n  Cons :: a -&gt; List' a m -&gt; List' a (S m)\n\nto :: List' a n -&gt; List a n\nto Nil = niln\nto (Cons a l) = consn a (to l)\n\nfrom :: List a n -&gt; List' a n\nfrom l = l Nil Cons\n</code></pre>\n"}], "owner": {"reputation": 1315, "user_id": 3780931, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7ed60a7e72a67346cacc5173dd359c65?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/3780931/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 1, "accepted_answer_id": 55081624, "answer_count": 1, "score": 4, "last_activity_date": 1552167313, "creation_date": 1552160629, "question_id": 55081273, "link": "https://stackoverflow.com/questions/55081273/church-encoding-for-dependent-types-from-coq-to-haskell", "title": "Church encoding for dependent types: from Coq to Haskell", "body": "<p>In Coq I can define a Church encoding for lists of length n:</p>\n\n<pre><code>Definition listn (A : Type) : nat -&gt; Type :=\nfun m =&gt; forall (X : nat -&gt; Type), X 0 -&gt; (forall m, A -&gt; X m -&gt; X (S m)) -&gt; X m.\n\nDefinition niln (A : Type) : listn A 0 :=\nfun X n c =&gt; n.\n\nDefinition consn (A : Type) (m : nat) (a : A) (l : listn A m) : listn A (S m) :=\nfun X n c =&gt; c m a (l X n c).\n</code></pre>\n\n<p>Is the type system of Haskell (including its extensions) strong enough to accommodate such definitions? If yes, how?</p>\n"}, {"tags": ["json", "haskell", "aeson"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1552149840, "post_id": 55079309, "comment_id": 96905282, "body": "The Generic <code>ToJSON</code> instance is almost certainly only going to produce a map when the key is text-like (ex. Text, String).  Is there something wrong with making an explicit ToJSON instance?"}, {"owner": {"reputation": 538, "user_id": 4875652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ea513cad32d33ca70db6369d6277875?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Losilla", "link": "https://stackoverflow.com/users/4875652/sergio-losilla"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1552166873, "post_id": 55079309, "comment_id": 96909961, "body": "I see, thanks. Any hints as to why it cannot produce a map?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1552167471, "post_id": 55079309, "comment_id": 96910131, "body": "Well JSON maps can&#39;t be keyed by anything besides a string. Unless you give a method to transform you key into a string that obviously won&#39;t translate."}, {"owner": {"reputation": 538, "user_id": 4875652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ea513cad32d33ca70db6369d6277875?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Losilla", "link": "https://stackoverflow.com/users/4875652/sergio-losilla"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1552177044, "post_id": 55079309, "comment_id": 96912201, "body": "Sure, I was puzzled because in the encoded JSON A was being converted to text as [[&quot;A&quot;,&quot;b&quot;]]. But yeah, now I get it from the documentation."}], "answers": [{"comments": [{"owner": {"reputation": 538, "user_id": 4875652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ea513cad32d33ca70db6369d6277875?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Losilla", "link": "https://stackoverflow.com/users/4875652/sergio-losilla"}, "edited": false, "score": 0, "creation_date": 1552166900, "post_id": 55079651, "comment_id": 96909971, "body": "Lovely! I will try to figure why it falls back to producing an array of arrays. But this certainly works."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 1, "last_activity_date": 1552151400, "last_edit_date": 1552151400, "creation_date": 1552150150, "answer_id": 55079651, "question_id": 55079309, "link": "https://stackoverflow.com/questions/55079309/aeson-encoding-of-data-map-strict-map-with-custom-key-type-results-in-array-of-a/55079651#55079651", "title": "Aeson encoding of Data.Map.Strict.Map with custom key type results in array of arrays instead of object", "body": "<p>Take a look at <a href=\"http://hackage.haskell.org/package/aeson-1.4.2.0/docs/Data-Aeson-Types.html#t:ToJSONKey\" rel=\"nofollow noreferrer\">the docs for <code>ToJSONKey</code></a>. Basically, the <code>toJSONKey :: ToJSONKeyFunction a</code> method handles two cases:</p>\n\n<ol>\n<li>when you can turn the key directly into something text like</li>\n<li>when the best you can do is turn the key into some general JSON</li>\n</ol>\n\n<p>For the first of these, <code>aeson</code> will use a proper JSON object. For the latter, it falls back to nested arrays.</p>\n\n<p>So why is it choosing option two in your case? Because you are deriving <code>ToJSONKey</code> and the default implementation chooses the second more general option. You can work around this problem by manually implementing <code>ToJSONKey LOL</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE DeriveAnyClass #-}\n\nimport Data.Aeson\nimport Data.Aeson.Types\n\nimport qualified Data.Text as T\nimport qualified Data.Map.Strict as M\nimport qualified Data.ByteString.Lazy.Char8 as B\n\nimport GHC.Generics\n\ndata LOL = A | B | C deriving (Eq, Ord, Show, Generic, ToJSON)\ninstance ToJSONKey LOL where\n  toJSONKey = toJSONKeyText (T.pack . show)\n\nmain = do\n    B.putStrLn $ encode $ M.fromList [(A,\"b\")]\n    B.putStrLn $ encode $ M.fromList [(\"A\",\"b\")]\n</code></pre>\n\n<p>That should give you</p>\n\n<pre><code>$ ./tojsonkey \n{\"A\":\"b\"}\n{\"A\":\"b\"}\n</code></pre>\n"}], "owner": {"reputation": 538, "user_id": 4875652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ea513cad32d33ca70db6369d6277875?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Losilla", "link": "https://stackoverflow.com/users/4875652/sergio-losilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 55079651, "answer_count": 1, "score": 1, "last_activity_date": 1552151400, "creation_date": 1552148036, "question_id": 55079309, "link": "https://stackoverflow.com/questions/55079309/aeson-encoding-of-data-map-strict-map-with-custom-key-type-results-in-array-of-a", "title": "Aeson encoding of Data.Map.Strict.Map with custom key type results in array of arrays instead of object", "body": "<p>I am having trouble getting Aeson to spit out objects when I use custom types as keys. Let me demonstrate:</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE DeriveAnyClass #-}\n\nimport Data.Aeson\n\nimport qualified Data.Map.Strict as M\nimport qualified Data.ByteString.Lazy.Char8 as B\n\nimport GHC.Generics\n\ndata LOL = A | B | C deriving (Eq, Ord, Generic, ToJSONKey, ToJSON)\nmain = do\n    B.putStrLn $ encode $\u00a0M.fromList [(A,\"b\")]\n    B.putStrLn $ encode $\u00a0M.fromList [(\"A\",\"b\")]\n</code></pre>\n\n<p>In one case, I get an array of arrays, while in the other it's a regular object:</p>\n\n<pre><code>$ ./tojsonkey \n[[\"A\",\"b\"]]\n{\"A\":\"b\"}\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["haskell", "haskell-backpack"], "comments": [{"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 5, "creation_date": 1552142108, "post_id": 55078118, "comment_id": 96903132, "body": "Have you looked at <a href=\"https://wiki.haskell.org/Module_signature\" rel=\"nofollow noreferrer\">this wiki page</a> and the <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Backpack\" rel=\"nofollow noreferrer\">relevant GHC trac page</a>? They seem to provide a pretty good overview and plenty of links to uses in existing packages. There&#39;s also <a href=\"https://www.microsoft.com/en-us/research/wp-content/uploads/2016/07/backpack.pdf\" rel=\"nofollow noreferrer\">a paper</a> which seems to cover the motivation and design."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1552156987, "post_id": 55079975, "comment_id": 96907349, "body": "I have never used that feature, but I think that, if we compare it to OCaml functors, it should work as an OCaml functor <i>which can be only instantiated once</i>. If my intuition is correct, that greatly diminishes the power wrt real OCaml functors."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1552160382, "post_id": 55079975, "comment_id": 96908283, "body": "@chi One can instantiate a signature-using library multiple times, it requires making multiple renamed &quot;copies&quot; of the library modules\u2014and of the signature they require\u2014by means of the <code>mixins</code> clause of the Cabal file. Here&#39;s an example: <a href=\"https://github.com/danidiaz/really-small-backpack-example/tree/master/lesson2-signatures\" rel=\"nofollow noreferrer\">github.com/danidiaz/really-small-backpack-example/tree/maste&zwnj;&#8203;r/&hellip;</a> Renaming modules is pretty intuitive (and a better alternative to <code>-XPackageImports</code>) but renaming a required <i>signature</i> in a library in order to match some implementation module feels a bit unintuitive at first."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1552161487, "post_id": 55079975, "comment_id": 96908545, "body": "@danidiaz Ah, thanks. I wasn&#39;t aware of this renaming feature. That seems to really change the game, since without being able to rename the signature, only a single implementation of that seemed possible. Using such renaming, we should indeed get something very close to OCaml functors."}], "tags": [], "owner": {"reputation": 1635, "user_id": 2254489, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b9c417017130602fd4561958e6840a2c?s=128&d=identicon&r=PG", "display_name": "Sventimir", "link": "https://stackoverflow.com/users/2254489/sventimir"}, "is_accepted": false, "score": 1, "last_activity_date": 1552152000, "creation_date": 1552152000, "answer_id": 55079975, "question_id": 55078118, "link": "https://stackoverflow.com/questions/55078118/what-are-module-signatures-in-haskell/55079975#55079975", "title": "What are module signatures in Haskell?", "body": "<p>As described <a href=\"https://wiki.haskell.org/Module_signature\" rel=\"nofollow noreferrer\">here</a>, they're quite closely related to OCaml module signatures. They allow you to create a package missing some modules and say these modules, containing such and such types and values, should be delivered by package's user. I haven't tested it myself, but I imagine that such a package works very much like an OCaml functor.</p>\n"}, {"comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1552223874, "post_id": 55081420, "comment_id": 96921015, "body": "Here&#39;s an interesting comment on typecasses vs. signatures for modularity by the creator of Backpack <a href=\"http://blog.ezyang.com/2016/09/the-base-of-a-string-theory-for-haskell/#comment-21258\" rel=\"nofollow noreferrer\">blog.ezyang.com/2016/09/the-base-of-a-string-theory-for-hask&zwnj;&#8203;ell/&hellip;</a>"}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 4, "last_activity_date": 1552215780, "last_edit_date": 1552215780, "creation_date": 1552161680, "answer_id": 55081420, "question_id": 55078118, "link": "https://stackoverflow.com/questions/55078118/what-are-module-signatures-in-haskell/55081420#55081420", "title": "What are module signatures in Haskell?", "body": "<p>They are related to the OCaml module system, but with some important differences:</p>\n\n<ul>\n<li><p>Signatures are defined within the language (in <strong>.hsig</strong> files) but unlike in OCaml they are <em>not</em> instantiated within the language. Instead, the package manager controls instantiation (currently, only Cabal provides that). Modules never know if they are importing an abstract signature or an actual module.</p></li>\n<li><p>Implementation modules know nothing about signatures and do not not reference them directly. Any existing module can implement a signature if the definitions happen to be compatible.</p></li>\n<li><p>Instantiation is triggered by a coincidence of module name and signature name in the dependencies of some compilation unit (executable, library, test suite...) When the names coincide, a process called \"signature matching\" takes place that verifies that the types and definitions are compatible.</p></li>\n</ul>\n\n<p>The \"happy path\" is that in your program you depend on some library having a signature \"hole\", and also on another library that provides an implementation module with the same name. Then signature matching happens automatically. When the names don't match, or we need multiple instantiations of the signature-using library, we have to rename signatures and/or modules in the <a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html#pkg-field-mixins\" rel=\"nofollow noreferrer\">mixins</a> section of the Cabal file.</p>\n\n<hr>\n\n<p>As for why module signatures might be useful, consider <a href=\"http://hackage.haskell.org/package/bytestring\" rel=\"nofollow noreferrer\">bytestring</a>, the most popular library by far for handling binary data in Haskell. But there are others, for example <a href=\"http://hackage.haskell.org/package/stdio\" rel=\"nofollow noreferrer\">stdio</a> with its <a href=\"http://winterland.me/2019/02/17/stdio-A-simple-and-high-performance-IO%20toolkit-for-Haskell/\" rel=\"nofollow noreferrer\"><code>Bytes</code></a> type.</p>\n\n<p>Suppose you are writing your own library that uses binary data, and you don't want to force your users into either stdio or <a href=\"http://hackage.haskell.org/package/bytestring\" rel=\"nofollow noreferrer\">bytestring</a>. What are your choices?</p>\n\n<ul>\n<li>One would be to create something like a <code>Bytelike</code> class and parameterize all your functions with it. You would also need to add a type parameter to <em>every</em> data type that contains bytes. </li>\n<li>Another would be to create a signature that defines an abstract binary data type and all the operations that are required of it. Your library would make use of the signature, and remain \"indefinite\" until the user depends both on your library and a suitable implementation when creating his own libraries.</li>\n</ul>\n\n<p>From the perspective of the user, the typeclass solution is unsatisfactory. The user knows that he wants to use either <code>ByteString</code> or <code>Bytes</code>, just one of them. The decision will not depend on some runtime flag and will remain constant across the extent of <em>his</em> program. And yet he has to deal with a more complex API that reminds him of that already decided issue at every turn. </p>\n\n<p>It's better if he makes the decision once, writes it in his .cabal file, and deals with a simpler API from then onwards.</p>\n"}], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 505, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1552215780, "creation_date": 1552140056, "last_edit_date": 1552151296, "question_id": 55078118, "link": "https://stackoverflow.com/questions/55078118/what-are-module-signatures-in-haskell", "title": "What are module signatures in Haskell?", "body": "<p>I have recently found Haskell's feature called \"module signatures\". As I have discovered they are put in <code>.hsig</code> files and begin with <code>signature</code> keyword instead of <code>module</code>.\nThe example syntax of such a file may look like</p>\n\n<pre><code>signature Str where\n\ndata Str\nempty :: Str\nappend :: Str -&gt; Str -&gt; Str\n</code></pre>\n\n<p>However, I cannot imagine how and why one would use them. Could you explain me which problems do they solve and how to properly make use of them?</p>\n\n<p>They strongly remind me the module system that one can see in OCaml (<a href=\"https://caml.inria.fr/pub/docs/manual-ocaml/moduleexamples.html\" rel=\"nofollow noreferrer\">link</a>), which also has modules signatures and separate implementations, but I can't decide how close are these two concepts. Is it somehow related?</p>\n"}, {"tags": ["haskell", "types", "type-inference", "church-encoding"], "comments": [{"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 3, "creation_date": 1552137600, "post_id": 55077731, "comment_id": 96901858, "body": "How does it &quot;not work&quot;? Please <a href=\"https://stackoverflow.com/posts/55077731/edit\">edit your post</a> to include the exact error messages you get or the exact differences in the behaviour you get and the behaviour you expect."}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1552137762, "post_id": 55077731, "comment_id": 96901900, "body": "You&#39;re defining an instance for <b>any</b> <code>t -&gt; t -&gt; t</code>, but you&#39;re specifically using <code>Bool</code>s in the definition of <code>show</code>, which prevents it being a valid definition for arbitrary <code>t</code>."}, {"owner": {"reputation": 3603, "user_id": 165806, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c889e0a95a3bb07f90ab28ad442f1127?s=128&d=identicon&r=PG", "display_name": "Iceland_jack", "link": "https://stackoverflow.com/users/165806/iceland-jack"}, "edited": false, "score": 3, "creation_date": 1552138145, "post_id": 55077731, "comment_id": 96901997, "body": "You need a <code>newtype ChBool = ChBool (forall x. x -&gt; x -&gt; x)</code> if you want instances"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 3603, "user_id": 165806, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c889e0a95a3bb07f90ab28ad442f1127?s=128&d=identicon&r=PG", "display_name": "Iceland_jack", "link": "https://stackoverflow.com/users/165806/iceland-jack"}, "edited": false, "score": 0, "creation_date": 1552139457, "post_id": 55077731, "comment_id": 96902365, "body": "yes, if you do as @Iceland_jack says (you need to use the <code>Rank2Types</code> or <code>RankNTypes</code> extension) then it works. (You also have to change <code>show b =</code> to <code>show (ChBool b =</code>"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1552139554, "post_id": 55077731, "comment_id": 96902395, "body": "[Although I have my own question about this, it doesn&#39;t work to just put <code>instance Show (forall t. t -&gt; t -&gt; t) where</code> even with <code>Rank2Types</code> enabled, I get an error about an &quot;illegal polymorphic type&quot; which I don&#39;t really understand, particularly as using a <code>newtype</code> wrapper for the type seems to be absolutely fine.]"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1552230082, "post_id": 55077731, "comment_id": 96922701, "body": "Would be much easier if you didn&#39;t insist on implementing <code>Show</code> and instead just had something like <code>showBoolean :: (forall t. t -&gt; t -&gt; t) -&gt; String; showBoolean b = b &quot;True&quot; &quot;False&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1315, "user_id": 3780931, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7ed60a7e72a67346cacc5173dd359c65?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/3780931/bob"}, "edited": false, "score": 0, "creation_date": 1552170112, "post_id": 55078300, "comment_id": 96910776, "body": "Why doesn&#39;t it work with the class Boolean (from Data.Boolean) instead of BiExample?"}, {"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "reply_to_user": {"reputation": 1315, "user_id": 3780931, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7ed60a7e72a67346cacc5173dd359c65?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/3780931/bob"}, "edited": false, "score": 1, "creation_date": 1552174189, "post_id": 55078300, "comment_id": 96911591, "body": "I was just not aware of this class. I will update my answer"}, {"owner": {"reputation": 1315, "user_id": 3780931, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7ed60a7e72a67346cacc5173dd359c65?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/3780931/bob"}, "edited": false, "score": 0, "creation_date": 1552231886, "post_id": 55078300, "comment_id": 96923228, "body": "Your solution with the Boolean class does not work. Try the following to see the error message:  <code>myTrue :: t -&gt; t -&gt; t myTrue = \\t _ -&gt; t  main = print $ myTrue</code>"}, {"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "reply_to_user": {"reputation": 1315, "user_id": 3780931, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7ed60a7e72a67346cacc5173dd359c65?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/3780931/bob"}, "edited": false, "score": 0, "creation_date": 1552237708, "post_id": 55078300, "comment_id": 96925076, "body": "First of all, you missed class constraints for <code>myTrue</code>: <code>myTrue :: (Show t, Boolean t) =&gt; t -&gt; t -&gt; t</code>. Second, this won&#39;t work for general type obviously because neither <code>Boolean</code> nor <code>Show</code> class provide sufficient defaults. The instance however is completely valid, and will work for any instantiated type (for example for <code>myTrue :: Bool -&gt; Bool -&gt; Bool</code>)"}], "tags": [], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "is_accepted": true, "score": 5, "last_activity_date": 1552238982, "last_edit_date": 1552238982, "creation_date": 1552141458, "answer_id": 55078300, "question_id": 55077731, "link": "https://stackoverflow.com/questions/55077731/printing-church-booleans/55078300#55078300", "title": "Printing Church Booleans", "body": "<p>The problem is that <code>show :: (t -&gt; t -&gt; t) -&gt; String</code> should work for <strong>any</strong> function working on <strong>any</strong> type <code>t</code>. You are assuming that <code>t</code> is Boolean which is illegal, because (according to GHC) \"<code>t</code> is a rigid type variable\" and cannot be unified with specialized type.</p>\n\n<hr>\n\n<p>One possible solution would be to specialize your instance by <code>Bool</code> (<code>FlexibleInstances</code> are necessary)</p>\n\n<pre><code>{-#LANGUAGE FlexibleInstances #-}\n\ninstance Show (Bool -&gt; Bool -&gt; Bool) where\n  show b = show $ b True False\n</code></pre>\n\n<p>But this will reduce generality of your Church's boolean. </p>\n\n<p>It is impossible to define flexible solution that would work on any type, because you will need to have two representatives of that type that would describe <em>true</em> and <em>false</em> cases, and there are types such like <code>Void</code> which have no (defined) values.</p>\n\n<hr>\n\n<p>An idea that comes to my mind and is quite universal is to add few more class constraints to <code>t</code>:</p>\n\n<pre><code>{-#LANGUAGE FlexibleInstances #-}\nimport Data.Boolean\n\ninstance (Show t, Boolean t) =&gt; Show (t -&gt; t -&gt; t) where\n  show b = show $ b true false\n</code></pre>\n\n<p>The <code>Boolean</code> class collects types that can be understood as logic values in some terms. For example for <code>Bool</code>:</p>\n\n<pre><code>instance Boolean Bool where\n  true = True\n  false = False\n  notB = not\n  (||*) = (||)\n  (&amp;&amp;*) = (&amp;&amp;)\n</code></pre>\n\n<p>And now we can ensure that</p>\n\n<ul>\n<li><code>t</code> is a thing that you can actually <code>show</code></li>\n<li>There are at least two valid and different values of type <code>t</code> that appear as <code>true</code> and <code>false</code></li>\n</ul>\n\n<p>Which are the required circumstances to actually be able to <code>show</code> a function of such signature in this way.</p>\n\n<p><strong>IMPORTANT</strong></p>\n\n<p>Following example won't work:</p>\n\n<pre><code>show (true :: (Show t, Boolean t) =&gt; t -&gt; t -&gt; t) \n</code></pre>\n\n<p>The problem is that typechecker won't guess which <code>t</code> are you going to have here. This solution provides valid and working instance, but only for fully instantiated types. If you get ambiguity error, you will need to specify what is <code>t</code>:</p>\n\n<pre><code>show (true :: Bool -&gt; Bool -&gt; Bool)\n&gt;&gt;&gt; \"True\"\n\nshow (true :: Int -&gt; Int -&gt; Int)  -- assuming Boolean instance\n&gt;&gt;&gt; \"1\"\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT</strong>:</p>\n\n<p>Yet another idea was mentioned in the comments. The solution would be to wrap your Church boolean with <code>Rank2Type</code>:</p>\n\n<pre><code>{-# LANGUAGE Rank2Types #-}\n\nnewtype ChBool = ChBool (forall t. t -&gt; t -&gt; t)\n</code></pre>\n\n<p>Which will let <code>t</code> be any type independent of the context. Then you may define casual instance like this:</p>\n\n<pre><code>instance Show ChBool where\n  show (ChBool f) = show $ f True False\n</code></pre>\n"}], "owner": {"reputation": 1315, "user_id": 3780931, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7ed60a7e72a67346cacc5173dd359c65?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/3780931/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 55078300, "answer_count": 1, "score": 0, "last_activity_date": 1552238982, "creation_date": 1552137405, "last_edit_date": 1552157591, "question_id": 55077731, "link": "https://stackoverflow.com/questions/55077731/printing-church-booleans", "title": "Printing Church Booleans", "body": "<p>The following code is meant to print Church encoding of booleans as Haskell's <code>Bool</code>:</p>\n\n<pre><code>{-#LANGUAGE FlexibleInstances #-}\n\ninstance Show (t -&gt; t -&gt; t) where\n  show b = show $ b True False\n</code></pre>\n\n<p>Which leads to this error:</p>\n\n<pre><code>&lt;interactive&gt;:4:21: error:\n\u2022 Couldn't match expected type \u2018t\u2019 with actual type \u2018Bool\u2019\n  \u2018t\u2019 is a rigid type variable bound by\n    the instance declaration at &lt;interactive&gt;:3:10-27\n\u2022 In the first argument of \u2018b\u2019, namely \u2018True\u2019\n  In the second argument of \u2018($)\u2019, namely \u2018b True False\u2019\n  In the expression: show $ b True False\n\u2022 Relevant bindings include\n    b :: t -&gt; t -&gt; t (bound at &lt;interactive&gt;:4:8)\n    show :: (t -&gt; t -&gt; t) -&gt; String (bound at &lt;interactive&gt;:4:3)\n</code></pre>\n\n<p>How to make it work?</p>\n"}, {"tags": ["windows", "haskell", "version", "build-numbers"], "answers": [{"tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 2, "last_activity_date": 1552145481, "creation_date": 1552145481, "answer_id": 55078905, "question_id": 55077476, "link": "https://stackoverflow.com/questions/55077476/get-windows-build-number-in-haskell/55078905#55078905", "title": "Get windows build number in Haskell", "body": "<p>Is there a native C function in WinAPI that returns Windows build number?</p>\n\n<p>If yes, you can easily call it from Haskell using <a href=\"https://wiki.haskell.org/Foreign_Function_Interface\" rel=\"nofollow noreferrer\">ForeignFunctionInterface</a> extension.</p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 8423881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d20071bbf3be523d87ed13232b3d497?s=128&d=identicon&r=PG&f=1", "display_name": "Malyutin Egor", "link": "https://stackoverflow.com/users/8423881/malyutin-egor"}, "edited": false, "score": 0, "creation_date": 1552208780, "post_id": 55080889, "comment_id": 96917277, "body": "Isn&#39;t it an overkill for such simple task?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 71, "user_id": 8423881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d20071bbf3be523d87ed13232b3d497?s=128&d=identicon&r=PG&f=1", "display_name": "Malyutin Egor", "link": "https://stackoverflow.com/users/8423881/malyutin-egor"}, "edited": false, "score": 0, "creation_date": 1552209820, "post_id": 55080889, "comment_id": 96917494, "body": "@MalyutinEgor Overkill? Why do you think that? It couldn&#39;t be much simpler than that: importing a single library and using one library function to query OS information. Further, it&#39;s also way more efficient than spawning an external process to call <code>ver</code>, and parsing the output."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1552157973, "creation_date": 1552157973, "answer_id": 55080889, "question_id": 55077476, "link": "https://stackoverflow.com/questions/55077476/get-windows-build-number-in-haskell/55080889#55080889", "title": "Get windows build number in Haskell", "body": "<p>The <a href=\"http://hackage.haskell.org/package/Win32-2.8.3.0/docs/System-Win32-Info-Version.html\" rel=\"nofollow noreferrer\"><code>Win32</code> package</a> seems to allow to access the build number, within the IO monad. Untested.</p>\n\n<pre><code>import System.Win32.Info.Version -- from Win32 package\n\nmain :: IO ()\nmain = do\n   osVersionInfo &lt;- getVersionEx\n   print (dwBuildNumber osVersionInfo)\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 8423881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d20071bbf3be523d87ed13232b3d497?s=128&d=identicon&r=PG&f=1", "display_name": "Malyutin Egor", "link": "https://stackoverflow.com/users/8423881/malyutin-egor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 55080889, "answer_count": 2, "score": 0, "last_activity_date": 1552157973, "creation_date": 1552135462, "question_id": 55077476, "link": "https://stackoverflow.com/questions/55077476/get-windows-build-number-in-haskell", "title": "Get windows build number in Haskell", "body": "<p>How can I get windows build number in Haskell? I think I can use <code>readProcess</code> and <code>ver</code>, but maybe there are more clear methods.</p>\n"}, {"tags": ["haskell", "typeclass", "applicative"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1552122951, "post_id": 55075707, "comment_id": 96898426, "body": "Start by writing down the functions you need to define to make <code>CouldBe</code> an instance of <code>Applicative</code>, with their type signatures (specialised to <code>CouldBe</code>). You should find there&#39;s really only one sensible solution if you let the types guide you. And your <code>Functor</code> instance shows you how to handle <code>Lost</code>."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 4, "creation_date": 1552123024, "post_id": 55075707, "comment_id": 96898441, "body": "Pattern match as much as possible and then construct the results in the only way that type checks. This works often."}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "edited": false, "score": 2, "creation_date": 1552123716, "post_id": 55075707, "comment_id": 96898582, "body": "Logically I&#39;d be defining <code>pure</code> and <code>&lt;*&gt;</code>, correct? I think pure should be simple like <code>pure a = Is a</code>, but doesn&#39;t <code>&lt;*&gt;</code> require more variants..."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1552124670, "post_id": 55075707, "comment_id": 96898793, "body": "Try pattern matching on each side of <code>&lt;*&gt;</code>; this should give four different cases. Then use @RobinZigmond&#39;s advice and &#39;follow the types&#39; for each case. One other thing which could help is typed holes: if you don&#39;t know what to put somewhere, use an underscore <code>_</code>, and GHC will give you the type which should be there. They&#39;re <i>incredibly</i> useful in these sort of &#39;follow the types&#39; situations."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1552149832, "post_id": 55075707, "comment_id": 96905279, "body": "Note that your <code>CouldBe</code> is isomorphic to Haskell&#39;s built-in <code>Maybe</code> type, so any time you want to know how to write an instance for your type, you can just look how the corresponding instance for <code>Maybe</code> is written."}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552287864, "post_id": 55075707, "comment_id": 96936699, "body": "@JosephSible it is indeed identical to <code>Maybe</code>, but they idea was to reason about the definitions. All comments were very helpful though, and Will Ness&#39;s answer more than complete."}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 3, "last_activity_date": 1552301181, "last_edit_date": 1552301181, "creation_date": 1552127983, "answer_id": 55076464, "question_id": 55075707, "link": "https://stackoverflow.com/questions/55075707/making-instance-of-applicative/55076464#55076464", "title": "Making instance of Applicative", "body": "<p>You just write it out, following the types:</p>\n\n<pre><code>instance Applicative CouldBe where\n   {- \n        <b>Minimal complete definition:</b>\n          pure, ((&lt;*>) | liftA2)\n\n      pure :: a -> f a \n      pure :: a -> CouldBe a\n\n      liftA2 :: (a -> b -> c) -> f a -> f b -> f c \n      liftA2 :: (a -> b -> c) -> CouldBe a -> CouldBe b -> CouldBe c \n   -}\n    pure a = fa\n        where\n        fa = ....\n\n    liftA2 abc fa fb = fc\n        where\n        fc = ....</code></pre>\n\n<p>According to</p>\n\n<pre><code>data CouldBe a = Is a | Lost\n</code></pre>\n\n<p>our toolset is</p>\n\n<pre><code>Is   :: a -&gt; CouldBe a\nLost :: CouldBe a\n</code></pre>\n\n<p>but we can also use pattern matching, e.g.</p>\n\n<pre><code>couldBe   is   lost  (Is a)    = is a\ncouldBe   is   lost  (Lost)    = lost\ncouldBe :: ? -&gt; ? -&gt; CouldBe a -&gt; b\ncouldBe :: ? -&gt; b -&gt; CouldBe a -&gt; b\ncouldBe :: (a -&gt; b) -&gt; b -&gt; CouldBe a -&gt; b\n</code></pre>\n\n<p>So,</p>\n\n<pre><code>    -- pure :: a -&gt; f a \n    pure :: a -&gt; CouldBe a     \n</code></pre>\n\n<p>matches up with</p>\n\n<pre><code>    Is   :: a -&gt; CouldBe a\n</code></pre>\n\n<p>so we define</p>\n\n<pre><code>    pure a = Is a\n</code></pre>\n\n<p>Then, for <code>liftA2</code>, we follow the data cases:</p>\n\n<pre><code>    -- liftA2 :: (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c \n    -- liftA2 :: (a -&gt; b -&gt; c) -&gt; CouldBe a -&gt; CouldBe b -&gt; CouldBe c\n    liftA2 abc Lost    _     = ...\n    liftA2 abc  _     Lost   = ...\n    liftA2 abc (Is a) (Is b) = fc\n        where\n        c = abc a b\n        fc = ....     -- create an `f c` from `c`: \n                      -- do we have a `c -&gt; CouldBe c` ?\n                      -- do we have an `a -&gt; CouldBe a` ? (it's the same type)\n</code></pre>\n\n<p>But in the first two cases we don't have an <code>a</code> or a <code>b</code>; so we have to come up with a <code>CouldBe c</code> out of nothing. We do have this tool in <em>our toolset</em> as well.</p>\n\n<p>Having completed all the missing pieces, we can substitute the expressions directly into the definitions, eliminating all the unneeded interim values / variables.</p>\n"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 55076464, "answer_count": 1, "score": 5, "last_activity_date": 1552301181, "creation_date": 1552122379, "question_id": 55075707, "link": "https://stackoverflow.com/questions/55075707/making-instance-of-applicative", "title": "Making instance of Applicative", "body": "<p>Still not a hundred percent shure how to make instances of the more complex types. Have this: </p>\n\n<pre><code>data CouldBe a = Is a | Lost deriving (Show, Ord) \n</code></pre>\n\n<p>Made an instance of <code>Functor</code>, using <code>Maybe</code> as an example:</p>\n\n<pre><code>instance Functor CouldBe where \n  fmap f (Is x) = Is (f x) \n  fmap f Lost   = Lost \n</code></pre>\n\n<p>For doing something like this: </p>\n\n<pre><code>tupleCouldBe :: CouldBe a -&gt; CouldBe b -&gt; CouldBe (a,b)\ntupleCouldBe x y = (,) &lt;$&gt; x &lt;*&gt; y\n</code></pre>\n\n<p><code>CouldBe</code> needs to be an instance of <code>Applicative</code>, but how would you go about that? Sure I can look it up and copy it, but I want to learn the process behind it and finally end up with the <code>instance</code> declaration of CouldBe.</p>\n"}, {"tags": ["haskell", "linker", "ghc"], "comments": [{"owner": {"reputation": 542, "user_id": 1956587, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e92d52f1c16bcf435ef24f7a474fde04?s=128&d=identicon&r=PG", "display_name": "tolUene", "link": "https://stackoverflow.com/users/1956587/toluene"}, "edited": false, "score": 0, "creation_date": 1552103997, "post_id": 55073455, "comment_id": 96895141, "body": "Haven&#39;t tried this, but according <a href=\"https://downloads.haskell.org/~ghc/7.0.3/docs/html/users_guide/options-phases.html\" rel=\"nofollow noreferrer\">the ghc manual</a>, <code>-optl</code> should let you pass options, and <code>-pgml</code> should let you use a different linker."}, {"owner": {"reputation": 754, "user_id": 178750, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f53f42a7048e675d4b24a3a2bc8f5acc?s=128&d=identicon&r=PG", "display_name": "Juan", "link": "https://stackoverflow.com/users/178750/juan"}, "reply_to_user": {"reputation": 542, "user_id": 1956587, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e92d52f1c16bcf435ef24f7a474fde04?s=128&d=identicon&r=PG", "display_name": "tolUene", "link": "https://stackoverflow.com/users/1956587/toluene"}, "edited": false, "score": 0, "creation_date": 1552153998, "post_id": 55073455, "comment_id": 96906522, "body": "These are good hints - thanks. The docs organization don&#39;t make it easy to search all the options very easily. There&#39;s some idiosyncracies with these options I&#39;m trying to work through (e.g., -optl -B/usr/local/bin or -optc -B/usr/local/bin don&#39;t seem to &quot;work&quot; - odd error: /usr/local/bin/settings: openFile: does not exist).  I&#39;ll work through the oddities and craft an answer."}], "answers": [{"tags": [], "owner": {"reputation": 104, "user_id": 826753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d32bda212d90f3d131b7f7781f8ac0b?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Petersen", "link": "https://stackoverflow.com/users/826753/jens-petersen"}, "is_accepted": false, "score": 0, "last_activity_date": 1553161489, "creation_date": 1553161489, "answer_id": 55277552, "question_id": 55073455, "link": "https://stackoverflow.com/questions/55073455/how-can-i-have-ghc-invoke-the-linker-differently-than-its-default-configuration/55277552#55277552", "title": "How can I have ghc invoke the linker differently than its default configuration?", "body": "<p>I think you can do <code>ghc -optl-rpath -optl/usr/local/lib</code>\nand <code>ghc -optc-B/usr/local/bin</code>.</p>\n"}], "owner": {"reputation": 754, "user_id": 178750, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f53f42a7048e675d4b24a3a2bc8f5acc?s=128&d=identicon&r=PG", "display_name": "Juan", "link": "https://stackoverflow.com/users/178750/juan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1553161489, "creation_date": 1552098741, "question_id": 55073455, "link": "https://stackoverflow.com/questions/55073455/how-can-i-have-ghc-invoke-the-linker-differently-than-its-default-configuration", "title": "How can I have ghc invoke the linker differently than its default configuration?", "body": "<p>I can pass options to the linker using <code>cc</code> with the <code>-Wl</code> option.  For example:</p>\n\n<pre><code>cc -Wl,-rpath -Wl,/usr/local/lib\n</code></pre>\n\n<p>That will invoke the linker with <code>-rpath /usr/local/lib</code></p>\n\n<p>How can I do the same with ghc?</p>\n\n<p>Also how can I also direct <code>ghc</code> to use a different linker than its default linker?  For instance, if <code>ghc</code> is configured to use <code>/usr/bin/ld</code>, how can I tell it to use <code>/usr/local/bin/ld</code> instead?  One way to do that with <code>cc</code> is:</p>\n\n<pre><code>cc -B/usr/local/bin\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 36975, "user_id": 94977, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8341c5bff3dcbd8ed34d9d68bd4169f2?s=128&d=identicon&r=PG", "display_name": "Jason Orendorff", "link": "https://stackoverflow.com/users/94977/jason-orendorff"}, "edited": false, "score": 1, "creation_date": 1552102703, "post_id": 55073376, "comment_id": 96894949, "body": "Two different variables are named <code>x</code>."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1552105644, "post_id": 55073376, "comment_id": 96895376, "body": "<code>group [1,1,2] == [[1,1],2]</code> I know that can&#39;t be true without even looking at the source of <code>group</code>, because the RHS is ill-typed."}], "answers": [{"comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1552103029, "post_id": 55073720, "comment_id": 96895011, "body": "Did you mean to say &quot;<i>less</i> practical&quot; instead of &quot;<i>more</i> practical&quot;?"}], "tags": [], "owner": {"reputation": 542, "user_id": 1956587, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e92d52f1c16bcf435ef24f7a474fde04?s=128&d=identicon&r=PG", "display_name": "tolUene", "link": "https://stackoverflow.com/users/1956587/toluene"}, "is_accepted": false, "score": 5, "last_activity_date": 1552103156, "last_edit_date": 1552103156, "creation_date": 1552102278, "answer_id": 55073720, "question_id": 55073376, "link": "https://stackoverflow.com/questions/55073376/how-to-fix-this-haskell-function-using-take-and-drop-while/55073720#55073720", "title": "How to fix this haskell function using take and drop while?", "body": "<p>Short answer: Your mistake is the usage of <code>head</code> in your condition. You want to compare with <code>x</code>, not <code>head xs</code>.</p>\n\n<p>Stylistically, note also that </p>\n\n<ol>\n<li><code>something ++ [x]</code> is less practical (and \"efficient\", although it doesn't really matter here) as <code>x : something</code> here, as order doesn't matter,</li>\n<li>a function as <code>f = \\x -&gt; something</code> should really be written as <code>f x = something</code>,</li>\n<li>and you probably shouldn't use the same variable name to refer to different values, it's get confusing very easily.</li>\n</ol>\n\n<p>Your function cond is easily rewritten using a partially applied <code>==</code>:</p>\n\n<pre><code>group [] = []\ngroup (x:xs) = (x : takeWhile cond xs) : group (dropWhile cond xs)\n  where cond = (==) x\n</code></pre>\n\n<p>This yields the expected result for <code>group [1,1,1,2,4]</code>.</p>\n"}], "owner": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552103156, "creation_date": 1552097877, "question_id": 55073376, "link": "https://stackoverflow.com/questions/55073376/how-to-fix-this-haskell-function-using-take-and-drop-while", "title": "How to fix this haskell function using take and drop while?", "body": "<p>I am asked to create a haskell function that will perform the following:</p>\n\n<pre><code>group [1,1,2,3,3] = [[1,1],[2],[3,3]]\n\ngroup [] = []\n</code></pre>\n\n<p>Essentially it groups the consecutive terms that are the same</p>\n\n<p>I should use take and drop while:</p>\n\n<pre><code>group [] = []\ngroup (x:xs) = (takeWhile cond xs ++ [x]) : group (dropWhile cond xs)\n   where\n    cond = (\\x -&gt; x == head xs)\n</code></pre>\n\n<p>Here is what I have.</p>\n\n<p>The above works for cases where a single element is at the end: <code>group [1,1,2] == [[1,1],2]</code> but not for cases where it's in the middle: <code>group [1,1,1,2,4] == [[1,1,1],[4,2]]</code> (it should be <code>[[1,1,1],[4],[2]]</code></p>\n\n<p>What is my mistake in the function?</p>\n"}, {"tags": ["haskell", "mutual-recursion"], "comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1552080980, "post_id": 55070688, "comment_id": 96890239, "body": "I don&#39;t think so, unfortunately."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1552081577, "post_id": 55070688, "comment_id": 96890463, "body": "Actually, I think that my last comment was wrong. Writing up an answer now."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 1, "creation_date": 1552090134, "post_id": 55070688, "comment_id": 96892990, "body": "Is your actual code set up like your example? It seems like the logic in each instance is &quot;handle certain events, and pass any other events to the appropriate handler in a consistent way&quot;. If this is actually the logic you have (and not just a result of simplification for the question), you may want to reassess your approach, and be sure you&#39;re not overengineering. There are much simpler ways to do things like this."}, {"owner": {"reputation": 3085, "user_id": 4040600, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/B4ER6.png?s=128&g=1", "display_name": "&#201;amonn Olive", "link": "https://stackoverflow.com/users/4040600/%c3%89amonn-olive"}, "reply_to_user": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1552102081, "post_id": 55070688, "comment_id": 96894871, "body": "@DarthFennec My problem here is that unlike my examples I do not actually select the appropriate handler in a consistant way.  I suppose I should reassess my approach altogether though."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1552172466, "post_id": 55070688, "comment_id": 96911229, "body": "It seems to me splitting up a mess into multiple modules makes more of a mess, no?...  I suspect you maybe shouldn&#39;t be using type classes here at all"}], "answers": [{"comments": [{"owner": {"reputation": 3085, "user_id": 4040600, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/B4ER6.png?s=128&g=1", "display_name": "&#201;amonn Olive", "link": "https://stackoverflow.com/users/4040600/%c3%89amonn-olive"}, "edited": false, "score": 0, "creation_date": 1552082288, "post_id": 55071503, "comment_id": 96890766, "body": "My whole intention was to avoid putting all my definitions in a single module.  It is nice that I could have each instance in a separate module but this doesn&#39;t help me avoid the fact that <code>Internal.Recursive</code> is going to be an absolute mess."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 3085, "user_id": 4040600, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/B4ER6.png?s=128&g=1", "display_name": "&#201;amonn Olive", "link": "https://stackoverflow.com/users/4040600/%c3%89amonn-olive"}, "edited": false, "score": 0, "creation_date": 1552087535, "post_id": 55071503, "comment_id": 96892402, "body": "@SriotchilismO&#39;Zaic It is going to be a mess, unfortunately. There&#39;s very little you can do about it. I suppose you could try to separate out just the recursive definitions into a separate module to keep it as simple as possible, but this wouldn&#39;t really work above a certain amount of recursion."}], "tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": false, "score": 1, "last_activity_date": 1552081924, "creation_date": 1552081924, "answer_id": 55071503, "question_id": 55070688, "link": "https://stackoverflow.com/questions/55070688/how-do-i-remove-this-type-of-mutual-recursion/55071503#55071503", "title": "How do I remove this type of mutual recursion?", "body": "<p>Here's one slightly hacky way to do it. First, put your recursive definitions in one module:</p>\n\n<pre><code>module Internal.Recursive\n\ndata XData = ...\ndata YData = ...\n\n-- Recursive definitions...\n</code></pre>\n\n<p>Then re-export each definition from a separate module:</p>\n\n<pre><code>module XData (IR.XData) where\n\nimport qualified Internal.Recursive as IR\n</code></pre>\n\n<hr>\n\n<pre><code>module YData (IR.XYata) where\n\nimport qualified Internal.Recursive as IR\n</code></pre>\n\n<p>This will give the appearance of mutually recursive modules. (I don't believe that GHC allows any easy way of making actual recursive modules.)</p>\n"}, {"tags": [], "owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "is_accepted": false, "score": 1, "last_activity_date": 1552087986, "creation_date": 1552087986, "answer_id": 55072432, "question_id": 55070688, "link": "https://stackoverflow.com/questions/55070688/how-do-i-remove-this-type-of-mutual-recursion/55072432#55072432", "title": "How do I remove this type of mutual recursion?", "body": "<p>Perhaps you could abstract the recursive requirement out? Something like this:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\nrunFooX :: forall ydata. Foo ydata =&gt; Proxy ydata -&gt; (XData, Result) -&gt; IO (XData, Result)\nrunFooX _ (data, result) = do\n  currentEvent &lt;- getEvent\n  case currentEvent of\n    EventA -&gt; return (data, result)\n    EventB -&gt;\n      (openFoo result :: IO ydata)\n        &gt;&gt;= runFoo\n          &gt;&gt;= closeFoo\n            &gt;&gt;= curry return data\n</code></pre>\n\n<p>And in a separate file:</p>\n\n<pre><code>instance Foo XData where\n   openFoo result = ...\n   runFoo = runFooX (Proxy :: Proxy YData)\n   closeFoo (data, result) = ...\n</code></pre>\n\n<p>This way, your file structure might look something like this:</p>\n\n<pre><code>            +-----------+\n            | class Foo |\n            +-----------+\n              /       \\\n             v         v\n+---------------+   +---------------+\n| data XData    |   | data YData    |\n| runFooX = ... |   | runFooY = ... |\n+---------------+   +---------------+\n              |       |\n              v       v\n       +---------------------+\n       | instance Foo XData  |\n       | instance Foo YData  |\n       +---------------------+\n</code></pre>\n\n<p>You still need to put all the <code>instance</code> definitions in one file (otherwise, for example, the instance for <code>XData</code> can't know that <code>YData</code> implements <code>Foo</code>), but at least the logic is separated into different modules, which is what you're looking for.</p>\n\n<p>It also looks a little awkward, but I guess it's a trade-off. There may be a way to make it nicer.</p>\n"}], "owner": {"reputation": 3085, "user_id": 4040600, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/B4ER6.png?s=128&g=1", "display_name": "&#201;amonn Olive", "link": "https://stackoverflow.com/users/4040600/%c3%89amonn-olive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1552087986, "creation_date": 1552077643, "question_id": 55070688, "link": "https://stackoverflow.com/questions/55070688/how-do-i-remove-this-type-of-mutual-recursion", "title": "How do I remove this type of mutual recursion?", "body": "<p>I am running into a mutual recursion issue.  The basic structure I have employed is that I have a module that defines a type class and several modules that define instances of that type class.  Each instance however is defined in terms of all the other instances.</p>\n\n<p>If that description is a little too abstract here is some code that has a structure like my code.  (I've trimmed it down quite a bit to make the necessary bits obvious and added some ellipses to parts that are not relevant to the overall structure).</p>\n\n<p>My class looks like the following:</p>\n\n<pre><code>data Result = ...\n\nclass Foo a where\n  openFoo  :: Result      -&gt; IO (a, Result)\n  runFoo   :: (a, Result) -&gt; IO (a, Result)\n  closeFoo :: (a, Result) -&gt; IO Result\n</code></pre>\n\n<p>Then I have the instances</p>\n\n<pre><code>data XData = ...\n\ninstance Foo XData where\n   openFoo result = ...\n   runFoo (data, result) = do\n     currentEvent &lt;- getEvent\n     case currentEvent of\n       EventA -&gt; return (data, result)\n       EventB -&gt;\n         (openFoo result :: IO YData)\n           &gt;&gt;= runFoo\n             &gt;&gt;= closeFoo\n               &gt;&gt;= curry return data\n   closeFoo (data, result) = ...\n</code></pre>\n\n<hr>\n\n<pre><code>data YData = ...\n\ninstance Foo YData where\n   openFoo result = ...\n   runFoo (data, result) = do\n     currentEvent &lt;- getEvent\n     case currentEvent of\n       EventA -&gt; return (data, result)\n       EventB -&gt;\n         (openFoo result :: IO XData)\n           &gt;&gt;= runFoo\n             &gt;&gt;= closeFoo\n               &gt;&gt;= curry return data\n   closeFoo (data, result) = ...\n</code></pre>\n\n<p>Now I could simply resolve this by putting all of my instances into a single module, however rather than the 2 shown in my example I have 8 instances that are all mutually recursive with each other. On top of that each instance is quite large.  Meaning the resulting module would be an enormous innavigable mess.</p>\n\n<p>Now the <a href=\"https://wiki.haskell.org/Mutually_recursive_modules\" rel=\"noreferrer\">haskell wiki has two suggestion</a> for solving mutual recursion issues, but both of them are really more about mutually recursive types and neither of them is going to work here.</p>\n\n<p>Is there anyway to get around this mutual recursion without simply combining all of my modules?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1552077780, "post_id": 55069897, "comment_id": 96889016, "body": "Update 3 fails because it doesn&#39;t let me write, for example, <code>(3.3 + f) :: Float</code> to get <code>4.3</code>; Haskell will not silently convert an <code>Int</code> to a <code>Float</code>. When you give something an explicit type like <code>Num a =&gt; a</code>, you give up control over what types <code>f</code> can be used as; you&#39;ve already promised it can be used as <i>any</i> type that has a <code>Num</code> instance, and the <i>integer</i> 1 does not fill that roll."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1552078316, "post_id": 55069897, "comment_id": 96889240, "body": "In Update 2, <code>f :: Num a =&gt; a -&gt; a</code> uses type inference to see that its argument type is <code>Fractional a =&gt; a</code>, (<i>not</i> <code>Float</code>), which means the return type is also <code>Fractional a =&gt; a</code>. All it does is return the value it is given. <code>f :: Num a =&gt; a</code>, you aren&#39;t defining a <i>function</i>; you&#39;re just defining a value, and you have already said that <code>f</code> can provide a value of <i>any</i> type that implements <code>Num</code>, which includes <code>Int</code>, but <code>1.0</code> <i>cannot</i> provide an <code>Int</code>. It&#39;s type is <code>Fractional a =&gt; a</code>, and <code>Int</code> does not have a <code>Fractional</code> instance."}, {"owner": {"reputation": 1435, "user_id": 1873643, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1d30a649ee593abc35605ea3161d1535?s=128&d=identicon&r=PG", "display_name": "Francis Toth", "link": "https://stackoverflow.com/users/1873643/francis-toth"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1552080721, "post_id": 55069897, "comment_id": 96890135, "body": "@chepner: This is what confuses me. An instance of <code>Num</code> is available for Floats and <code>Double</code>. There is also an instance of <code>Fractional</code> for both of these types. So shouldn&#39;t I be able to use a <code>Double</code> or a <code>Float</code> whenever a <code>Num</code> or a <code>Fractional</code> is expected? Maybe my problem is that I think in terms of Scala implicits"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1552081755, "post_id": 55069897, "comment_id": 96890518, "body": "<code>f :: Num a =&gt; a</code> does not mean a type with a <code>Num</code> instance is <i>expected</i>; it means <i>any</i> value whose type has a <code>Num</code> instance can be <i>produced</i>. <code>f = 1 :: Int</code> is too restrictive; <code>f = 1</code> is fine, because the literal <code>1</code> itself has type <code>Num a =&gt; a</code>. As long as a value <code>x</code> belongs to a type with a <code>Num</code> instance, I can write <code>x + 1</code>, because the <code>1</code> itself can be specialized to a matching type. The type signature does <i>not</i> mean you can assign any <i>monomorphic</i> value that happens to have a <code>Num</code> instance to <code>f</code>, the value itself needs to be just as polymorphic."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1552146201, "post_id": 55069897, "comment_id": 96904265, "body": "When it comes to assignment, read <code>g :: Num a =&gt; a</code> to mean &quot;<code>g</code> holds values of <i>every</i> type except those without <code>Num</code> instances&quot; instead of &quot;<code>g</code> holds a value of some type that has a <code>Num</code> instance&quot;. See the difference?"}], "answers": [{"comments": [{"owner": {"reputation": 1435, "user_id": 1873643, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1d30a649ee593abc35605ea3161d1535?s=128&d=identicon&r=PG", "display_name": "Francis Toth", "link": "https://stackoverflow.com/users/1873643/francis-toth"}, "edited": false, "score": 0, "creation_date": 1552074347, "post_id": 55069988, "comment_id": 96887551, "body": "Isn&#39;t <code>Float</code> a <code>Num</code> type?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1552074400, "post_id": 55069988, "comment_id": 96887579, "body": "<code>Float</code> implements <code>Num</code>, but <code>1.0 :: Fractional a =&gt; a</code> is not a valid value for <i>all</i> types that implement <code>Num</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 1435, "user_id": 1873643, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1d30a649ee593abc35605ea3161d1535?s=128&d=identicon&r=PG", "display_name": "Francis Toth", "link": "https://stackoverflow.com/users/1873643/francis-toth"}, "edited": false, "score": 2, "creation_date": 1552074580, "post_id": 55069988, "comment_id": 96887664, "body": "@FrancisToth <code>f :: Num a =&gt; a</code> means that <code>f</code> can be used as a value of <i>any</i> numeric type, not that it has a single specific type which happens to be numeric."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 1435, "user_id": 1873643, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1d30a649ee593abc35605ea3161d1535?s=128&d=identicon&r=PG", "display_name": "Francis Toth", "link": "https://stackoverflow.com/users/1873643/francis-toth"}, "edited": false, "score": 3, "creation_date": 1552074731, "post_id": 55069988, "comment_id": 96887742, "body": "@FrancisToth I believe the problem you are having is that you are thinking of <code>Num</code> and <code>Fractional</code> like OOP classes. If that were the case then a <code>Float</code> implementing the <code>Fractional</code> interface, also implements <code>Num</code> and you are good to go. But Typeclasses are about <i>parametric polymorphisms</i>. So <code>Num a =&gt; a</code> means &quot;this is a polymorphic value that can have <b>any</b> type that belongs (aka has an instance) for the <code>Num</code> typeclass. But <code>5.12</code> is not a valid <code>Int</code> and <code>Int</code> is a <code>Num</code> hence <code>5.12</code> is not a valid <code>Num a =&gt; a</code>. <code>5.12</code> however belongs to the <code>Fractional</code> subset of <code>Num</code>."}, {"owner": {"reputation": 1435, "user_id": 1873643, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1d30a649ee593abc35605ea3161d1535?s=128&d=identicon&r=PG", "display_name": "Francis Toth", "link": "https://stackoverflow.com/users/1873643/francis-toth"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1552075485, "post_id": 55069988, "comment_id": 96888079, "body": "@Bakuriu: In <code>Num a =&gt; a</code>, <code>a</code> can have any type that belongs to the <code>Num</code> typeclass. This includes Int among others. <code>Float</code> provides an instance for <code>Num</code>, so why a Float would not be a valid <code>Num</code>?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 1435, "user_id": 1873643, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1d30a649ee593abc35605ea3161d1535?s=128&d=identicon&r=PG", "display_name": "Francis Toth", "link": "https://stackoverflow.com/users/1873643/francis-toth"}, "edited": false, "score": 0, "creation_date": 1552075785, "post_id": 55069988, "comment_id": 96888199, "body": "@FrancisToth - as others have tried (and evidently failed) to explain, you&#39;re thinking about it backwards. <code>a</code> can indeed &quot;have any type that belongs to the <code>Num</code> typeclass<code>, if it has type </code>Num a =&gt; a<code>. That *any* is meant literally, and it&#39;s a pretty strong condition. In particular, </code>Int` belongs to the <code>Num</code> typeclass, so anything with that type signature <i>must</i> be able to have type <code>Int</code>. (Amongst many others.) But <code>1.0</code> <i>cannot</i> have type <code>Int</code>, because it can have any type that is an instance of <code>Fractional</code> - and <code>Int</code> isn&#39;t such an instance."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1552075929, "post_id": 55069988, "comment_id": 96888266, "body": "But don&#39;t feel bad if this is hard to take in. I recall getting confused by similar things recently in trying to learn some slightly more advanced Haskell topics (the fact that certain types with a <code>Functor</code> constraint in their type are actually more restrictive than the same types with an <code>Applicative</code> constraint)."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 1435, "user_id": 1873643, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1d30a649ee593abc35605ea3161d1535?s=128&d=identicon&r=PG", "display_name": "Francis Toth", "link": "https://stackoverflow.com/users/1873643/francis-toth"}, "edited": false, "score": 1, "creation_date": 1552082752, "post_id": 55069988, "comment_id": 96890932, "body": "@FrancisToth You should really try to understand the example chi provided where they put the explicit quantifier. The actual type is <code>f :: forall a. Num a =&gt; a</code>. So <code>f</code> is a value whose type is <code>a</code> <b><i>FORALL</i></b> possible types <code>a</code> that belong to <code>Num</code>. if <code>f = 5.12</code> then being a non integer value obviously <code>f</code> cannot be an <code>Int</code> or <code>Integer</code>, hence the forall fails. You are thinking about the type with the <i>exists</i> quantifier, which is a different type."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 9, "last_activity_date": 1552074761, "last_edit_date": 1552074761, "creation_date": 1552074248, "answer_id": 55069988, "question_id": 55069897, "link": "https://stackoverflow.com/questions/55069897/haskell-type-substitution/55069988#55069988", "title": "Haskell type substitution", "body": "<p>If I have <code>f :: Num a =&gt; a</code> this means that I can use <code>f</code> wherever I need any numeric type. So, all of <code>f :: Int</code>, <code>f :: Double</code> must type check.</p>\n\n<p>In your case, we can't have <code>1.0 :: Int</code> for the same reason we can't have <code>543.24 :: Int</code>, that is, <code>Int</code> does not represent fractional values. However, <code>1.0</code> does fit any fractional type (as <code>543.24</code> does).</p>\n\n<p><code>Fractional</code> indeed can be thought as a subset of <code>Num</code>. But if I have a value inside <em>all</em> the fractionals <code>f :: forall a . Fractional a =&gt; a</code>, I don't necessarily have a value in all the numeric types <code>f :: forall a . Num a =&gt; a</code>.</p>\n\n<p>Note that, in a sense, the constraints are on the left side of <code>=&gt;</code>, which makes them behave <em>contra-variantly</em>. I.e. cars are a subset of vehichles, but I can't conclude that a wheel that can be used in any car will be able to be used with any vehicle. Rather, the opposite: a wheel that can be used in any vehicle will be able to be used with any car.</p>\n\n<p>So, you can roughly regard <code>f :: forall a . Num a =&gt; a</code> (values fitting in any numeric type, like <code>3</code> and <code>5</code>) as a subtype of  <code>f :: forall a . Fractional a =&gt; a</code> (values fitting in any fractional type, like <code>3</code>,<code>5</code>, and <code>32.43</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 1435, "user_id": 1873643, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1d30a649ee593abc35605ea3161d1535?s=128&d=identicon&r=PG", "display_name": "Francis Toth", "link": "https://stackoverflow.com/users/1873643/francis-toth"}, "edited": false, "score": 0, "creation_date": 1552088530, "post_id": 55071926, "comment_id": 96892661, "body": "I feel really dumb and am really sorry about that. You said that: <code>You&#39;ve now promised that f can be used to provide a value of any type that has a Num instance. That includes Int and Integer</code>- but also <code>Double</code> and <code>Float</code> as shown by <code>:i Num</code> (hence my confusion). You also said: <code>but neither of those types has a Fractional instance.</code> - why does that matter? Covariance is maybe what messes me up. I think about <code>Double</code> as a type holding both the Num and the Fractional contract. So it has the capabilities to be used wherever one or the other is expected."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 1435, "user_id": 1873643, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1d30a649ee593abc35605ea3161d1535?s=128&d=identicon&r=PG", "display_name": "Francis Toth", "link": "https://stackoverflow.com/users/1873643/francis-toth"}, "edited": false, "score": 0, "creation_date": 1552092475, "post_id": 55071926, "comment_id": 96893427, "body": "@FrancisToth - the key word in that sentence you quoted is &quot;any&quot;. Yes, <code>Double</code> and <code>Float</code> have <code>Num</code> instances, and they are possible types of <code>1.0</code>. But the type signature <code>Num a =&gt; a</code> promises that its value can be used with any instance of <code>Num</code>. <code>Int</code> and <code>Integer</code> are included in that &quot;any&quot;, and are not possible types for <code>1.0</code> - and that&#39;s why this does&#39;t work. It&#39;s rather like using <code>2</code> to prove that not all prime numbers are odd - the fact that many other primes, indeed all other primes, are odd is irrelevant."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 1435, "user_id": 1873643, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1d30a649ee593abc35605ea3161d1535?s=128&d=identicon&r=PG", "display_name": "Francis Toth", "link": "https://stackoverflow.com/users/1873643/francis-toth"}, "edited": false, "score": 0, "creation_date": 1552141085, "post_id": 55071926, "comment_id": 96902827, "body": "@FrancisToth I think you keep assuming that Haskell supports <a href=\"https://en.wikipedia.org/wiki/Subtyping\" rel=\"nofollow noreferrer\">subtype polymorphism</a>; it does not. Typeclasses are not classes in the sense of object-oriented programming, where any instance of a subclass is-a instance of a superclass. Rather, it is a <i>requirement</i> that an instance of a superclass exist before you can define a <i>separate</i> instance for a subclass. (I.e., <code>Real</code> has both <code>Num</code> and <code>Ord</code> as superclasses. That doesn&#39;t mean defining a <code>Real</code> instance for a type automatically gives it both <code>Num</code> and <code>Ord</code> instances..."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1552141132, "post_id": 55071926, "comment_id": 96902846, "body": "... Quite the opposite, it means you <i>cannot</i> define a <code>Real</code> instance unless you have <i>already</i> defined both <code>Num</code> and <code>Ord</code> instances for the type."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 4, "last_activity_date": 1552140646, "last_edit_date": 1552140646, "creation_date": 1552084347, "answer_id": 55071926, "question_id": 55069897, "link": "https://stackoverflow.com/questions/55069897/haskell-type-substitution/55071926#55071926", "title": "Haskell type substitution", "body": "<p>Let's start with the <em>monomorphic</em> case:</p>\n\n<pre><code>f :: Float\nf = 1.0\n</code></pre>\n\n<p>Here, you've said that <code>f</code> is a <code>Float</code>; not an <code>Int</code>, not a <code>Double</code>, not any other type. <code>1.0</code>, on the other hand, is a <em>polymorphic</em> constant; it has type <code>Fractional a =&gt; a</code>, and so can be used to provide a value of <em>any</em> type that has a <code>Fractional</code> instance. You can restrict it to <code>Float</code>, or <code>Double</code>, etc. Since <code>f</code> has to be a <code>Float</code>, that's what <code>1.0</code> is restricted to.</p>\n\n<p>If you try to change the signature</p>\n\n<pre><code>f :: Num a =&gt; a\nf = 1.0\n</code></pre>\n\n<p>now you have a problem. You've now promised that <code>f</code> can be used to <em>provide</em> a value of <em>any</em> type that has a <code>Num</code> instance. That includes <code>Int</code> and <code>Integer</code>, but neither of those types has a <code>Fractional</code> instance. So, the compiler refuses to let you do this. <code>1.0</code> simply can't produce an <code>Int</code> should the need arise.</p>\n\n<p>Likewise, </p>\n\n<pre><code>1.0::(Num a =&gt; a)\n</code></pre>\n\n<p>is a lie, because this isn't a restriction; it's an attempt at <em>expanding</em> the set of types that <code>1.0</code> can produce. Something with type <code>Num a =&gt; a</code> should be able to give me an <code>Int</code>, but <code>1.0</code> cannot do that.</p>\n\n<pre><code>1.0::(Fractional a =&gt; a)\n</code></pre>\n\n<p>works because you are just restating something that is already true. It's neither restricting <code>1.0</code> to a smaller set of types or trying to expand it.</p>\n\n<hr>\n\n<p>Now we get something a little more interesting, because you are specifying a <em>function</em> type, not just a value type.</p>\n\n<pre><code>f :: Num a =&gt; a -&gt; a\nf a = a\n</code></pre>\n\n<p>This just says that <code>f</code> can take as its argument any value that is <em>no more polymorphic</em> than <code>Num a =&gt; a</code>. <code>a</code> can be any type that implements <code>Num</code>, or it can be a polymorphic value that is a <em>subset</em> of the types that represent <code>Num</code>.\nYou chose</p>\n\n<pre><code>f 1.0\n</code></pre>\n\n<p>which means <code>a</code> gets unified with <code>Fractional a =&gt; a</code>. Type inference then decides that the return type is also <code>Fractional a =&gt; a</code>, and returning the same value you passed in is allowed.</p>\n\n<hr>\n\n<p>We've already covered why this </p>\n\n<pre><code>f :: Num a =&gt; a\nf = 1.0\n</code></pre>\n\n<p>isn't allowed above, and </p>\n\n<pre><code>f :: Num a =&gt; a\nf = (1::Int)\n</code></pre>\n\n<p>fails for the same reason. <code>Int</code> is simply too specific; it is <em>not</em> the same as <code>Num a =&gt; a</code>.</p>\n\n<p>For example, <code>(+) :: Num a =&gt; a -&gt; a -&gt; a</code> requires two arguments of the same type. So, I might try to write</p>\n\n<pre><code>1 :: Integer + f\n</code></pre>\n\n<p><em>or</em> </p>\n\n<pre><code>1 :: Float + f\n</code></pre>\n\n<p>. In both cases, I need <code>f</code> to be able to provide a value with the same type as the other argument, to satisfy the type of <code>(+)</code>: if I want an <code>Integer</code>, I should be able to get an <code>Integer</code>, and if I want a <code>Float</code>, I should be able to get a <code>Float</code>. But if you could specify a value with something less specific than <code>Num a =&gt; a</code>, you wouldn't be able to keep that promise. <code>1.0 :: Fractional a =&gt; a</code> can't provide an <code>Integer</code>, and <code>1 :: Int</code> can't provide  <em>anything</em> except an <code>Int</code>, not even an <code>Integer</code>.</p>\n\n<hr>\n\n<p>Think of a polymorphic type as a function from a concrete type to a value; you can literally do this if you enable the <code>TypeApplications</code> extension.</p>\n\n<pre><code>Prelude&gt; :set -XTypeApplications\nPrelude&gt; :{\nPrelude| f :: Num a =&gt; a\nPrelude| f = 1\nPrelude| :}\nPrelude&gt; :t f\nf :: Num a =&gt; a\nPrelude&gt; :t f @Int\nf @Int :: Int\nPrelude&gt; f @Int\n1\nPrelude&gt; :t f @Float\nf @Float :: Float\nPrelude&gt; f @Float\n1.0\nPrelude&gt; :t f @Rational\nf @Rational :: Rational\nPrelude&gt; f @Rational\n1 % 1\n</code></pre>\n\n<p>The reason these all work is because you promised that you could pass <em>any</em> type with a <code>Num</code> instance to <code>f</code>, and it could return a value of that type. But if you had been allowed to say <code>f = 1.0</code>, there is <em>no way</em> that <code>f @Int</code> could, in fact, return an <code>Int</code>, because <code>1.0</code> simply <em>is not capable</em> of producing an <code>Int</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1435, "user_id": 1873643, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1d30a649ee593abc35605ea3161d1535?s=128&d=identicon&r=PG", "display_name": "Francis Toth", "link": "https://stackoverflow.com/users/1873643/francis-toth"}, "edited": false, "score": 0, "creation_date": 1552232550, "post_id": 55072810, "comment_id": 96923419, "body": "I looked at all answers/comment and feel that I am starting to get it. The key here is to understand that type parameters are decided (like in <code>a</code>) by the caller. If I assign <code>f</code> to &#224; an argument that expects an Int, I need to make sure that the <code>a</code> being returned is an Int. Not a <code>Double</code>. In the same way, if I expect a Float, <code>f</code> cannot return a Double either. So <code>Num a =&gt; a</code> cannot return an Int, nor a Float or a Double. It can only return a <code>Num a =&gt; a</code> which happens to be the type of <code>1</code> for example. If this is correct, I will update my question and provide a better explanation."}, {"owner": {"reputation": 1435, "user_id": 1873643, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1d30a649ee593abc35605ea3161d1535?s=128&d=identicon&r=PG", "display_name": "Francis Toth", "link": "https://stackoverflow.com/users/1873643/francis-toth"}, "edited": false, "score": 1, "creation_date": 1552232789, "post_id": 55072810, "comment_id": 96923478, "body": "When you think about it, this the equivalent of <code>def f[T: Num]: T = ???</code> in Scala"}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": false, "score": 2, "last_activity_date": 1552091785, "last_edit_date": 1552091785, "creation_date": 1552091420, "answer_id": 55072810, "question_id": 55069897, "link": "https://stackoverflow.com/questions/55069897/haskell-type-substitution/55072810#55072810", "title": "Haskell type substitution", "body": "<p>When values with polymorphic types like <code>Num a =&gt; a</code> are involved, there are two sides. The <strong>source</strong> of the value, and the <strong>use</strong> of the value. One side gets the flexibility to choose any specific type compatible with the polymorphic type (like using <code>Float</code> for <code>Num a =&gt; a</code>). The other side is restricted to using code that will work <em>regardless</em> of which specific type is involved - it can <em>only</em> make use of features that will work for <strong>every</strong> type compatible with the polymorphic type.</p>\n\n<p>There is no free lunch; both sides cannot have the same freedom to pick any compatible type they like.</p>\n\n<p>This is just as true for object-oriented subclass polymorphism, however OO polymorphism rules give the flexibility to the <strong>source</strong> side, and put all the restrictions on the <strong>use</strong> side (except for generics, which works like parametric polymorphism), while Haskell's parametric polymorphism gives the flexibility to the use side, and puts all the restrictions on the source side.</p>\n\n<p>For example in an OO language with a general number class <code>Num</code>, and <code>Int</code> and <code>Double</code> as subclasses of this, then a method returning something of type <code>Num</code> would work the way you're expecting. You can return <code>1.0 :: Double</code>, but the caller can't use any methods on the value that are provided specifically by <code>Double</code> (like say one that splits off the fractional part) because the caller must be programmed to work the same whether you return an <code>Int</code> or a <code>Double</code> (or even any brand new subclass of <code>Num</code> that is private to your code, that the caller cannot possibly know about).</p>\n\n<p>Polymorphism in Haskell is based on type parameters rather than subtyping, which switches things around. The place in the code where <code>f :: Num a =&gt; a</code> is used has the freedom to demand any particular choice for <code>a</code> (subject to the <code>Num</code> constraint), and the code for <code>f</code> that is the source of the value must be programmed to work <em>regardless</em> of the use-site's choice. The use-site is even free to demand values of a type that is private to the code using <code>f</code>, that the implementer of <code>f</code> cannot possibly know about. (I can literally open up a new file, make any bizarre new type I like and give it an instance for <code>Num</code>, and any of the standard library functions written years ago that are polymorphic in <code>Num</code> will work with my type)</p>\n\n<p>So this works:</p>\n\n<pre><code>f :: Float\nf = 1.0\n</code></pre>\n\n<p>Because there are no type variables, so both source and use-site simply have to treat this as a <code>Float</code>. But this does not:</p>\n\n<pre><code>f :: Num a =&gt; a\nf = 1.0\n</code></pre>\n\n<p>Because the place where <code>f</code> is <em>used</em> can demand <em>any</em> valid choice for <code>a</code>, and this code must be able to work for that choice. (It would not work when <code>Int</code> is chosen, for example, so the compiler must reject this definition of <code>f</code>). But this does work:</p>\n\n<pre><code>f :: Fractional a =&gt; a\nf = 1.0\n</code></pre>\n\n<p>Because now the use site is only free to demand any type that is in <code>Fractional</code>, which excludes the ones (like <code>Int</code>) that floating point literals like <code>1.0</code> cannot support.</p>\n\n<p>Note that this is <em>exactly</em> how \"generics\" work in object oriented languages, so if you're familiar with any language supporting generics, just treat Haskell types the way you do generic ones in OO languages.</p>\n\n<hr>\n\n<p>One further thing that may be confusing you is that in this:</p>\n\n<pre><code>f :: Float\nf = 1.0\n</code></pre>\n\n<p>The literal <code>1.0</code> isn't actually definitively a <code>Float</code>. Haskell literals are much more flexible than those of most other languages. Whereas e.g. Java says that <code>1.0</code> is definitely a value of type <code>double</code> (with some automatic conversion rules if you use a <code>double</code> where certain other types are expected), in Haskell that <code>1.0</code> is actually itself a thing with a polymorphic type. <code>1.0</code> has type <code>Fractional a =&gt; a</code>.</p>\n\n<p>So the reason the <code>f :: Fractional a =&gt; a</code> definition worked is obvious, it's actually the <code>f :: Float</code> definition that needs some explanation. It's making use of exactly the rules I described above in the first section of my post. Your code <code>f = 1.0</code> is a <strong>use-site</strong> of the value represented by <code>1.0</code>, so it can demand any type it likes (subject to <code>Fractional</code>). In particular, it can demand that the literal <code>1.0</code> supply a value of type <code>Float</code>.</p>\n\n<p>This again reinforces why the <code>f :: Num a =&gt; a</code> definition can't work. Here the type for <code>f</code> is promising to <code>f</code>'s callers that they can demand any type they like (subject to <code>Num</code>). But it's going to fulfill that demand by just passing the demand down the chain to the literal <code>1.0</code>, which has the most general type of <code>Fractional a =&gt; a</code>. So if the use-site of <code>f</code> demands a type that is in <code>Num</code> but outside <code>Fractional</code>, <code>f</code> would then try to demand that <code>1.0</code> supply that same non-<code>Fractional</code> type, which it can't.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1552142745, "last_edit_date": 1552142745, "creation_date": 1552142198, "answer_id": 55078403, "question_id": 55069897, "link": "https://stackoverflow.com/questions/55069897/haskell-type-substitution/55078403#55078403", "title": "Haskell type substitution", "body": "<p>Names do not have types. Values have types, and the type is an intrinsic part of the value. <code>1 :: Int</code> and <code>1 :: Integer</code> are two different values. Haskell does not implicitly convert values between types, though it can be trivial to define functions that take values of one type and return values of another. (For example, <code>f :: Int -&gt; Integer</code> with <code>f x = x</code> will \"convert\" its <code>Int</code> arugment to an <code>Integer</code>.</p>\n\n<p>A declaration like</p>\n\n<pre><code>f :: Num a =&gt; a\n</code></pre>\n\n<p>does not say that <code>f</code> has type <code>Num a =&gt; a</code>, it says that you can assign values of type <code>Num a =&gt; a</code> to <code>f</code>.</p>\n\n<p>You can think of a polymorphic value like <code>1 :: Num a =&gt; a</code> being all <code>1</code>-like values in every type with a <code>Num</code> instance, including <code>1 :: Int</code>, <code>1 :: Integer</code>, <code>1 :: Rational</code>, etc.</p>\n\n<p>An assignment like <code>f = 1</code> succeeds because the literal <code>1</code> has the expected type <code>Num a =&gt; a</code>.</p>\n\n<p>An assignment like <code>f = 1.0</code> fails because the literal <code>1.0</code> has a different type, <code>Fractional a =&gt; a</code>, and that type is too specific. It does not include all <code>1</code>-like values that <code>Num a =&gt; a</code> may be called on to produce.</p>\n\n<p>Suppose you declared <code>g :: Fractional a =&gt; a</code>. You can say <code>g = 1.0</code>, because the types match. You cannot say <code>g = (1.0 :: Float)</code>, because the types do not match; <code>Float</code> has a <code>Fractional</code> instance, but it is just one of a possibly infinite set of types that could have <code>Fractional</code> instances.</p>\n\n<p>You <em>can</em> say <code>g = 1</code>, because <code>Fractional a =&gt; a</code> is <em>more</em> specific than <code>Num a =&gt; a</code>, and has <code>Fractional</code> has <code>Num</code> as its superclass. The assignment \"selects\" the subset of <code>1 :: Num a =&gt; a</code> that overlaps with (and for all intents and purposes <em>is</em>) <code>1 :: Fractional a =&gt; a</code> and assigns that to <code>g</code>. Put another way, just <code>1 :: Num a =&gt; a</code> can produce a value for any <em>single</em> type that has a <code>Num</code> instance, it can produce a value for any <em>subset</em> of types implied by a subclass of <code>Num</code>.</p>\n"}], "owner": {"reputation": 1435, "user_id": 1873643, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1d30a649ee593abc35605ea3161d1535?s=128&d=identicon&r=PG", "display_name": "Francis Toth", "link": "https://stackoverflow.com/users/1873643/francis-toth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 1, "answer_count": 4, "score": 1, "last_activity_date": 1552269066, "creation_date": 1552073816, "last_edit_date": 1552269066, "question_id": 55069897, "link": "https://stackoverflow.com/questions/55069897/haskell-type-substitution", "title": "Haskell type substitution", "body": "<p>I am going through the Haskell Book (<a href=\"http://haskellbook.com/\" rel=\"nofollow noreferrer\">http://haskellbook.com/</a>) and got stuck at the following exercise:</p>\n\n<pre><code>f :: Float\nf = 1.0\n\n-- Question: Can you replace `f`'s signature by `f :: Num a =&gt; a`\n</code></pre>\n\n<p>At first, I thought the answer would be Yes. Float provides an instance for Num, so substituting a <code>Num a =&gt; a</code> by a <code>Float</code> value should be fine (I am thinking co-variance here).</p>\n\n<p>This does not compile however:</p>\n\n<pre><code>Could not deduce (Fractional a) arising from the literal \u20181.0\u2019\n      from the context: Num a\n        bound by the type signature for:\n                   f :: forall a. Num a =&gt; a\n        at ...\n      Possible fix:\n        add (Fractional a) to the context of\n          the type signature for:\n            f :: forall a. Num a =&gt; a\n    \u2022 In the expression: 1.0\n      In an equation for \u2018f\u2019: f = 1.0\n</code></pre>\n\n<p>If I do this however, no problem:</p>\n\n<pre><code>f :: Fractional a =&gt; a\nf = 1.0\n</code></pre>\n\n<p>Why can't I use a less specific constraint here like <code>Num a =&gt; a</code>?</p>\n\n<p><strong>UPD</strong>:</p>\n\n<p>Actually, you can sum this up to:</p>\n\n<pre><code>1.0::(Num a =&gt; a)\n</code></pre>\n\n<p>vs</p>\n\n<pre><code>1.0::(Fractional a =&gt; a)\n</code></pre>\n\n<p>Why is the second working but not the first one? I thought <code>Fractional</code> was a subset of <code>Num</code> (meaning <code>Fractional</code> is compatible with <code>Num</code>)</p>\n\n<p><strong>UPD 2:</strong></p>\n\n<p>Thanks for your comments, but I am still confused. Why this works:</p>\n\n<pre><code>f :: Num a =&gt; a -&gt; a\nf a = a\n\nf 1.0\n</code></pre>\n\n<p>while this not:</p>\n\n<pre><code>f :: Num a =&gt; a\nf = 1.0\n</code></pre>\n\n<p><strong>UPD 3:</strong>\nI have just noticed something:</p>\n\n<pre><code>f :: Num a =&gt; a\nf = (1::Int)\n</code></pre>\n\n<p>does not work either.</p>\n\n<p><strong>UPD 4</strong></p>\n\n<p>I have been reading all the answers/comments and as far as I understand:</p>\n\n<pre><code>f :: Num a =&gt; a \n</code></pre>\n\n<p>is the Scala equivalent of </p>\n\n<pre><code>def f[A: Num]: A\n</code></pre>\n\n<p>which would explain why many mentioned that <code>a</code> is defined by the caller. The only reason why we can write this:</p>\n\n<pre><code>f :: Num a =&gt; a \nf = 1\n</code></pre>\n\n<p>is because 1 is typed as a <code>Num a =&gt; a</code>. Could someone please confirm this assumption? In any case, thank you all for your help.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 6, "creation_date": 1552054676, "post_id": 55064896, "comment_id": 96877920, "body": "Don&#39;t use a backslash to continue a line. Haskell just requires indentation."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1552081143, "post_id": 55064896, "comment_id": 96890304, "body": "Side question: How come you&#39;re using prefix operators? I would think it&#39;s easiest to use operators between numbers, as they&#39;re supposed to be used. Besides, your program gives several type errors when you do fix the parse errors; these would probably go away when you get rid of the prefix operators (or at least parenthesise them)."}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 1, "last_activity_date": 1552054784, "creation_date": 1552054784, "answer_id": 55065109, "question_id": 55064896, "link": "https://stackoverflow.com/questions/55064896/why-is-haskell-complaining-about-this-plus-sign/55065109#55065109", "title": "Why is Haskell complaining about this plus sign?", "body": "<p>Don't use backslashes, and remember to properly bracket pattern matches:</p>\n\n<pre><code>frombal3 :: String -&gt; Integer\nfrombal3 \"+\" =  1\nfrombal3 \"0\" =  0\nfrombal3 \"-\" = -1\nfrombal3 (current:therest) = -- ^ Note brackets\n  (*) frombal3 current (^) 3 length therest \n  + frombal3 therest\n</code></pre>\n\n<p>This still causes a problem due to how you're using operators, but I think you can solve this on your own, especially since I can't work out what you're trying to do here.</p>\n"}, {"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 1, "last_activity_date": 1552054850, "creation_date": 1552054850, "answer_id": 55065123, "question_id": 55064896, "link": "https://stackoverflow.com/questions/55064896/why-is-haskell-complaining-about-this-plus-sign/55065123#55065123", "title": "Why is Haskell complaining about this plus sign?", "body": "<p>You appear to be trying to use backslashes to continue onto the next line; don't do that. If you just delete all the backslashes, the error will go away. (You'll get several <em>other</em> errors, but this particular one will go away.)</p>\n\n<p>Haskell uses indentation to detect where one part ends and the next begins. You don't need to manually add backslashes to the end of each line to continue an expression.</p>\n"}, {"tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": false, "score": 3, "last_activity_date": 1552054888, "last_edit_date": 1592644375, "creation_date": 1552054888, "answer_id": 55065133, "question_id": 55064896, "link": "https://stackoverflow.com/questions/55064896/why-is-haskell-complaining-about-this-plus-sign/55065133#55065133", "title": "Why is Haskell complaining about this plus sign?", "body": "<p>It is not clear what you are trying to achieve, but I can see some mistakes that can be already pointed out.</p>\n<h1>Problems</h1>\n<p>You don't need <code>\\</code> to continue a line, that's only needed inside strings. Indentation is enough in Haskell</p>\n<p>You need to wrap your pattern matching with parenthesis: <code>(current:therest)</code>. Furthermore, this pattern will make <code>current</code> a Char and not a String, so you cannot directly pass it to your function that takes a String.</p>\n<p>You need to wrap your function arguments as well: if you want to multiply <code>frombal3 current</code> by 3, you need <code>(*) (frombal3 current) 3</code>, or the much better <code>frombal3 current * 3</code>. Infix functions have higher precedence and make the code more clear.</p>\n<h1>Suggestions</h1>\n<p>I am not sure what you want to achieve, but this looks like somthing that can be done with a <code>fold</code> or simple list comprehension</p>\n"}], "owner": {"reputation": 21, "user_id": 7308605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e76291e3616f98e4db069b004e6cde2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Stewart", "link": "https://stackoverflow.com/users/7308605/jacob-stewart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1552054888, "creation_date": 1552053998, "question_id": 55064896, "link": "https://stackoverflow.com/questions/55064896/why-is-haskell-complaining-about-this-plus-sign", "title": "Why is Haskell complaining about this plus sign?", "body": "<p>From this code intended to convert a balanced ternary representation to a Haskell <code>Integer</code>:</p>\n\n<pre><code>frombal3 :: String -&gt; Integer\nfrombal3 \"+\" =  1\nfrombal3 \"0\" =  0\nfrombal3 \"-\" = -1\nfrombal3 current:therest = \\\n  (*) frombal3 current (^) 3 length therest \\\n  + frombal3 therest\n</code></pre>\n\n<p>I got the error:</p>\n\n<pre><code>main.hs:7:3: error: parse error on input \u2018+\u2019\n  |\n7 |   + frombal3 therest\n  |   ^\n&lt;interactive&gt;:3:1: error:\n   \u2022 Variable not in scope: main\n   \u2022 Perhaps you meant \u2018min\u2019 (imported from Prelude)\n</code></pre>\n"}, {"tags": ["haskell", "haskell-backpack"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551998814, "post_id": 55053954, "comment_id": 96857567, "body": "If I understand you correctly, I think you&#39;d just have to pass some kind of parameter (either a <code>Bool</code> or some specially-constructed custom data type) to indicate which module you want to use. Perhaps others will know some more sophisticated way to do it."}, {"owner": {"reputation": 3985, "user_id": 387527, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2ee4bf552ca59c2f324e666a3de008bd?s=128&d=identicon&r=PG", "display_name": "agam", "link": "https://stackoverflow.com/users/387527/agam"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1551998915, "post_id": 55053954, "comment_id": 96857609, "body": "@RobinZigmond I see your point, you mean <code>let insertfn = if &lt;param&gt; then M.insert else HML.insert</code> (and similarly for <code>sizefn</code>) and then use <code>insertfn</code> as needed? I guess that works, but then I&#39;m wondering whether there&#39;s an idiomatic way to do this when I have more than two possible modules."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551999947, "post_id": 55053954, "comment_id": 96857939, "body": "yes, that&#39;s what I meant. As I said, I don&#39;t know if there&#39;s a &quot;nicer&quot; way to do it - I don&#39;t think it&#39;s likely, but let&#39;s wait for the experts to comment/answer."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1552001343, "post_id": 55053954, "comment_id": 96858384, "body": "Can&#39;t. A well designed typeclass interface often solves the same kind of problem, but not always.  See also &quot;backpack&quot; which is an ML functor-like module extension for Haskell (still experimental, though I believe it&#39;s now shipping with ghc)."}], "answers": [{"tags": [], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "is_accepted": false, "score": 1, "last_activity_date": 1552003609, "last_edit_date": 1552003609, "creation_date": 1552003273, "answer_id": 55054758, "question_id": 55053954, "link": "https://stackoverflow.com/questions/55053954/how-do-i-parameterize-a-function-by-module-in-haskell/55054758#55054758", "title": "How do I parameterize a function by module in Haskell?", "body": "<p>I am afraid that it is not possible to do in Haskell without workarounds. Main problem is that <code>comp</code> would use different types for same objects for <code>M</code> and for <code>HML</code> variants, which is impossible to do in Haskell directly.</p>\n\n<p>You will need to let <code>comp</code> know which option are you going to take using either data or polymorphism.</p>\n\n<p>As a base idea I would create ADT to cover possible options and use boolean value to determine the module:</p>\n\n<pre><code>data SomeMap k v = M (M.Map k v) | HML (HML.HashMap k v)\nf :: Bool -&gt; IO ()\nf shouldIUseM = do ...\n</code></pre>\n\n<p>And then use <code>case</code> expression in <code>foldr</code> to check whether your underlying map is <code>M</code> or <code>HML</code>. However, I don't see any good point of using such a bloatcode, it would be much better to create <code>compM</code> and <code>compHML</code> separately.</p>\n\n<p>Another approach would be to create typeclass that would wrap all your cases</p>\n\n<pre><code>class SomeMap m where\n  empty :: m k v\n  insert :: k -&gt; v -&gt; m k v -&gt; m k v\n  size :: m k v -&gt; Int\n</code></pre>\n\n<p>And then write instances for each map manually (or using some TemplateHaskell magic, which I believe could help here, however it is out of my skills). It will require some bloat code as well, but then you will be able to parametrize <code>comp</code> over the used map type:</p>\n\n<pre><code>comp :: SomeMap m =&gt; m -&gt; IO ()\ncomp thisCouldBeEmptyInitMap = do ...\n</code></pre>\n\n<p>But honestly, I would write this function like this:</p>\n\n<pre><code>comp :: Bool -&gt; IO ()\ncomp m = if m then fooM else fooHML\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3985, "user_id": 387527, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2ee4bf552ca59c2f324e666a3de008bd?s=128&d=identicon&r=PG", "display_name": "agam", "link": "https://stackoverflow.com/users/387527/agam"}, "edited": false, "score": 0, "creation_date": 1552028744, "post_id": 55055107, "comment_id": 96865031, "body": "Thanks, the &quot;passing a record of <i>map ops</i>&quot; idea seems like the least bloat-y right now."}, {"owner": {"reputation": 3985, "user_id": 387527, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2ee4bf552ca59c2f324e666a3de008bd?s=128&d=identicon&r=PG", "display_name": "agam", "link": "https://stackoverflow.com/users/387527/agam"}, "edited": false, "score": 0, "creation_date": 1552078934, "post_id": 55055107, "comment_id": 96889470, "body": "Question: since I can&#39;t <i>literally</i> use <code>K</code> and <code>V</code> as in this example, I&#39;m assuming you meant the underlying concrete types? i.e. if I &quot;really&quot; was using <code>Data.Map String Int</code>, I should annotate the type of insert as <code>String -&gt; Int -&gt; m -&gt; m</code> ?  (or, is there a way to say &quot;the type of keys in the map of type m&quot; ?)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 3985, "user_id": 387527, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2ee4bf552ca59c2f324e666a3de008bd?s=128&d=identicon&r=PG", "display_name": "agam", "link": "https://stackoverflow.com/users/387527/agam"}, "edited": false, "score": 0, "creation_date": 1552088069, "post_id": 55055107, "comment_id": 96892549, "body": "@agam Yes, use <code>String</code> and <code>Int</code>. You could alternately add additional parameters, as in <code>data MapOps k v m = MapOps { insert :: k -&gt; v -&gt; m -&gt; m, ... }</code>."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 3985, "user_id": 387527, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2ee4bf552ca59c2f324e666a3de008bd?s=128&d=identicon&r=PG", "display_name": "agam", "link": "https://stackoverflow.com/users/387527/agam"}, "edited": false, "score": 0, "creation_date": 1552097206, "post_id": 55055107, "comment_id": 96894205, "body": "@agam You could alternatively use a higher kinded <code>m</code> parameter, so that <code>empty :: m k v</code>, <code>insert :: c k =&gt; k -&gt; v -&gt; m k v -&gt; m k v</code>, etc. Then you don&#39;t have to fix <code>String</code> and <code>Int</code> when you compile, or when you create a <code>MapOps</code> record, but you&#39;ll never be able to adapt a non-polymorphic map type, and you&#39;ll need to use <code>ConstraintKinds</code> to also add a <code>c</code> parameter for the constraint you need on the keys (e.g. <code>Ord</code> or <code>Hashable</code>)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1552161595, "post_id": 55055107, "comment_id": 96908577, "body": "@Ben That proposal makes the solution less flexible, not more. Even with <code>insert :: k -&gt; v -&gt; m -&gt; m</code> you can make just one <code>mapOps :: Ord k =&gt; MapOps (Map k v) k v</code> without fixing the key and value type; but with your <code>insert :: k -&gt; v -&gt; m k v -&gt; m k v</code> one can&#39;t use things like <code>IntMap</code> which take fewer type-level parameters (at least without newtype wrappers)."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 5, "last_activity_date": 1552017375, "last_edit_date": 1552017375, "creation_date": 1552005696, "answer_id": 55055107, "question_id": 55053954, "link": "https://stackoverflow.com/questions/55053954/how-do-i-parameterize-a-function-by-module-in-haskell/55055107#55055107", "title": "How do I parameterize a function by module in Haskell?", "body": "<p>The simplest is to parameterize by the operations you actually need, rather than the module. So:</p>\n\n<pre><code>mapComp ::\n  m -&gt;\n  (K -&gt; V -&gt; m -&gt; m) -&gt;\n  (m -&gt; Int) -&gt;\n  KVPairs -&gt; IO ()\nmapComp empty insert size kvpairs = do\n  let m = foldr ins empty kvpairs where\n        ins (k, v) t = insert k v t\n  if size m /= length kvpairs\n  then putStrLn $ \"FAIL: \" ++ show (size m) ++ \", \" ++ show (length kvpairs)\n  else pure ()\n</code></pre>\n\n<p>You can then call it as, e.g. <code>mapComp M.empty M.insert M.size</code> or <code>mapComp HM.empty HM.insert HM.size</code>. As a small side benefit, callers may use this function even if the data structure they prefer doesn't offer a module with exactly the right names and types by writing small adapters and passing them in.</p>\n\n<p>If you like, you can combine these into a single record to ease passing them around:</p>\n\n<pre><code>data MapOps m = MapOps\n    { empty :: m\n    , insert :: K -&gt; V -&gt; m -&gt; m\n    , size :: m -&gt; Int\n    }\n\nmops = MapOps M.empty M.insert M.size\nhmops = MapOps HM.empty HM.insert HM.size\n\nmapComp :: MapOps m -&gt; KVPairs -&gt; IO ()\nmapComp ops kvpairs = do\n    let m = foldr ins (empty ops) kvpairs where\n          ins (k, v) t = insert ops k v t\n    if size ops m /= length kvpairs\n    then putStrLn \"Yikes!\"\n    else pure ()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": false, "score": 1, "last_activity_date": 1552006196, "creation_date": 1552006196, "answer_id": 55055161, "question_id": 55053954, "link": "https://stackoverflow.com/questions/55053954/how-do-i-parameterize-a-function-by-module-in-haskell/55055161#55055161", "title": "How do I parameterize a function by module in Haskell?", "body": "<p>I'm a little suspicious this is an XY problem, so here's how I would address the code you linked to. You have, the following:</p>\n\n<pre><code>mapComp :: KVPairs -&gt; IO ()\nmapComp kvpairs = do\n  let init = M.empty\n  let m = foldr ins init kvpairs where\n        ins (k, v) t = M.insert k v t\n  if M.size m /= length kvpairs\n  then putStrLn $ \"FAIL: \" ++ show (M.size m) ++ \", \" ++ show (length kvpairs)\n  else pure ()\n\nhashmapComp :: KVPairs -&gt; IO()\nhashmapComp kvpairs = do\n  let init = HML.empty\n  let m = foldr ins init kvpairs where\n        ins (k, v) t = HML.insert k v t\n  if HML.size m /= length kvpairs\n  then putStrLn $ \"Fail: \" ++ show (HML.size m) ++ \", \" ++ show (length kvpairs)\nelse pure ()\n</code></pre>\n\n<p>This has a lot of repetition, which is usually not good. So we factor out the bits that are different between the two functions, and <em>parameterize a new function by those changing bits</em>:</p>\n\n<pre><code>-- didn't try to compile this\ncomp :: mp k v -&gt; (k -&gt; v -&gt; mp k v -&gt; mp k v) -&gt; (mp k v -&gt; Int) -&gt; KVPairs -&gt; IO()\ncomp h_empty h_insert h_size kvpairs = do\n  let init = h_empty\n  let m = foldr ins init kvpairs where\n        ins (k, v) t = h_insert k v t\n  if h_size m /= length kvpairs\n  then putStrLn $ \"Fail: \" ++ show (h_size m) ++ \", \" ++ show (length kvpairs)\nelse pure ()\n</code></pre>\n\n<p>As you can see this is a really mechanical process. Then you call e.g. <code>comp M.empty M.insert M.size</code>.</p>\n\n<p>If you want to be able to define <code>comp</code> such that it can work on <em>map types that you haven't thought of yet</em> (or which your users will specify), then you must define <code>comp</code> against an abstract interface. This is done with typeclasses, as in <code>SomeMap</code> radrow's answer.</p>\n\n<p>In fact you can do part of this abstracting already, by noticing that both maps you want to work with implement the standard <code>Foldable</code> and <code>Monoid</code>.</p>\n\n<pre><code>-- didn't try to compile this\ncomp :: (Foldable (mp k), Monoid (mp k v))=&gt; (k -&gt; v -&gt; mp k v -&gt; mp k v) -&gt; KVPairs -&gt; IO()\ncomp h_insert kvpairs = do\n  let init = mempty -- ...also why not just use `mempty` directly below:\n  let m = foldr ins init kvpairs where\n        ins (k, v) t = h_insert k v t\n  if length m /= length kvpairs\n  then putStrLn $ \"Fail: \" ++ show (length m) ++ \", \" ++ show (length kvpairs)\nelse pure ()\n</code></pre>\n\n<p>As mentioned in the comments, I think <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Backpack\" rel=\"nofollow noreferrer\">backpack</a> is (will be?) the way to get what I think you're asking for, i.e. parameterized <em>modules</em>. I don't know much about it, and it's not clear to me what usecases it solves that you wouldn't want to use the more traditional approach I've described above (maybe I'll read the wiki page).</p>\n"}, {"comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1552029890, "post_id": 55058530, "comment_id": 96865473, "body": "Relevant links: <a href=\"https://kowainik.github.io/posts/2018-08-19-picnic-put-containers-into-a-backpack\" rel=\"nofollow noreferrer\">kowainik.github.io/posts/&hellip;</a> <a href=\"https://github.com/danidiaz/really-small-backpack-example\" rel=\"nofollow noreferrer\">github.com/danidiaz/really-small-backpack-example</a>"}, {"owner": {"reputation": 3985, "user_id": 387527, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2ee4bf552ca59c2f324e666a3de008bd?s=128&d=identicon&r=PG", "display_name": "agam", "link": "https://stackoverflow.com/users/387527/agam"}, "edited": false, "score": 0, "creation_date": 1552030974, "post_id": 55058530, "comment_id": 96865890, "body": "Excellent! Yeah, this seems like the &quot;right&quot; way to do this ... but is there a GHC version dependency here? (also, about the <i>implementation</i> example: there would be one of these per &quot;concrete&quot; module, correct? E.g. one for <code>Data.Map</code> and another for <code>Data.Hashmap.Lazy</code> ?)"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1552064199, "post_id": 55058530, "comment_id": 96882807, "body": "Nice. Since there&#39;s relatively little about backpack on this site, could you elaborate a little on when you might want to use this approach over something more traditional with typeclasses? IIUC think one of the benefits is you can offer users an API that is monomorphic but allow them to fiddle with the internals, e.g. replace the hashing algorithm in a hash-based containers library. Does that sound right?"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 3985, "user_id": 387527, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2ee4bf552ca59c2f324e666a3de008bd?s=128&d=identicon&r=PG", "display_name": "agam", "link": "https://stackoverflow.com/users/387527/agam"}, "edited": false, "score": 0, "creation_date": 1552069890, "post_id": 55058530, "comment_id": 96885500, "body": "@agam One needs a relatively recent version of GHC, an also a package manager that supports Backpack, which IIRC is only Cabal &gt; 2.0 at the moment. Yes one needs one implementation per concrete module, although if some package with the right types and nomenclature already exists and matches your signature, you can simply use that (because implementations are independent of signatures)."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1552070543, "post_id": 55058530, "comment_id": 96885767, "body": "@jberryman Yes, Backpack seems useful to switch some internal detail in a module without complicating the function signatures and the definition of the datatypes. If you want to configure some aspect of your code that doesn&#39;t depend on runtime configuration and doesn&#39;t vary <i>within</i> your code (say, the type of string your library accepts) Backpack might be an option. But it has an overhead because you have to define all those auxiliary libraries, and it&#39;s not supported by all Haskell build systems."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1552072821, "post_id": 55058530, "comment_id": 96886863, "body": "I guess it&#39;s also a kind of looser coupling, since IIUC an implementation may <i>incidentally</i> match an interface; it doesn&#39;t need to be aware of the interface (in contrast to a library that must import/depend-on  a typeclass)."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 7, "last_activity_date": 1552092910, "last_edit_date": 1552092910, "creation_date": 1552029862, "answer_id": 55058530, "question_id": 55053954, "link": "https://stackoverflow.com/questions/55053954/how-do-i-parameterize-a-function-by-module-in-haskell/55058530#55058530", "title": "How do I parameterize a function by module in Haskell?", "body": "<p>Here's how to to it with module signatures and mixins (a.k.a. <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Backpack\" rel=\"nofollow noreferrer\">Backpack</a>)</p>\n\n<p>You would have to define a library (it could be an internal library) with a <a href=\"https://wiki.haskell.org/Module_signature\" rel=\"nofollow noreferrer\">signature</a> like:</p>\n\n<pre><code>-- file Mappy.hsig\nsignature Mappy where\n\nclass C k\ndata Map k v\nempty :: Map k v\ninsert :: C k =&gt; k -&gt; v -&gt; Map k v -&gt; Map k v \nsize :: Map k v -&gt; Int\n</code></pre>\n\n<p>in the same library or in another, write code that imports the signature as if it were a normal module:</p>\n\n<pre><code>module Stuff where\n\nimport qualified Mappy as M\n\ntype KVPairs k v = [(k,v)]\n\ncomp :: M.C k =&gt; KVPairs k v -&gt; IO ()\ncomp kvpairs = do\n  let init = M.empty\n  let m = foldr ins init kvpairs where\n        ins (k, v) t = M.insert k v t\n  if M.size m /= length kvpairs\n  then putStrLn $ \"FAIL: \" ++ show (M.size m) ++ \", \" ++ show (length kvpairs)\n  else pure ()\n</code></pre>\n\n<p>In another library (it must be a different one) write an \"implementation\" module that matches the signature:</p>\n\n<pre><code>-- file Mappy.hs\n{-# language ConstraintKinds #-}\nmodule Mappy (C,insert,empty,size,Map) where\n\nimport Data.Map.Lazy\n\ntype C = Ord\n</code></pre>\n\n<p>The \"signature match\" is performed based on names and types only, the implementation module doesn't need to know about the existence of the signature.</p>\n\n<p>Then, in a library or executable in which you want to use the abstract code, pull both the library with the abstract code and the library with the implementation:</p>\n\n<pre><code>executable somexe\n  main-is:             Main.hs\n  build-depends:       base ^&gt;=4.11.1.0,\n                       indeflib,\n                       lazyimpl\n  default-language:    Haskell2010\n\nlibrary indeflib\n  exposed-modules:     Stuff\n  signatures:          Mappy\n  build-depends:       base ^&gt;=4.11.1.0\n  hs-source-dirs:      src\n  default-language:    Haskell2010\n\nlibrary lazyimpl\n  exposed-modules:     Mappy\n  build-depends:       base ^&gt;=4.11.1.0,\n                       containers &gt;= 0.5\n  hs-source-dirs:      impl1\n  default-language:    Haskell2010\n</code></pre>\n\n<p>Sometimes the name of the signature and of the implementing module don't match, in that case one has to use the <a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html?highlight=mixins#pkg-field-mixins\" rel=\"nofollow noreferrer\">mixins</a> section of the Cabal file.</p>\n\n<p><strong>Edit.</strong> Creating the <code>HashMap</code> implementation proved somewhat tricky, because <a href=\"http://hackage.haskell.org/package/unordered-containers-0.2.10.0/docs/Data-HashMap-Strict.html#v:insert\" rel=\"nofollow noreferrer\"><code>insert</code></a> required two constraints (<code>Eq</code> and <code>Hashable</code>) instead of one. I had to resort to the <a href=\"https://www.reddit.com/r/haskell/comments/ab8ypl/monthly_hask_anything_january_2019/edk1ot3/?context=8&amp;depth=9\" rel=\"nofollow noreferrer\">\"class synonym\"</a> trick. Here's the code:</p>\n\n<pre><code>{-# language ConstraintKinds, FlexibleInstances, UndecidableInstances #-}\nmodule Mappy (C,insert,HM.empty,HM.size,Map) where\n\nimport Data.Hashable\nimport qualified Data.HashMap.Strict as HM\n\ntype C = EqHash \n\nclass (Eq q, Hashable q) =&gt; EqHash q -- class synonym trick\ninstance (Eq q, Hashable q) =&gt; EqHash q\n\ninsert :: EqHash k =&gt; k -&gt; v -&gt; Map k v -&gt; Map k v\ninsert = HM.insert\n\ntype Map = HM.HashMap\n</code></pre>\n"}], "owner": {"reputation": 3985, "user_id": 387527, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2ee4bf552ca59c2f324e666a3de008bd?s=128&d=identicon&r=PG", "display_name": "agam", "link": "https://stackoverflow.com/users/387527/agam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "accepted_answer_id": 55058530, "answer_count": 4, "score": 10, "last_activity_date": 1552218030, "creation_date": 1551998371, "last_edit_date": 1552218030, "question_id": 55053954, "link": "https://stackoverflow.com/questions/55053954/how-do-i-parameterize-a-function-by-module-in-haskell", "title": "How do I parameterize a function by module in Haskell?", "body": "<p>This might seem artificial, but I can't seem to find an obvious answer to the following:</p>\n\n<p>Say I have the following imports:</p>\n\n<pre><code>import qualified Data.Map as M\nimport qualified Data.HashMap.Lazy as HML\n</code></pre>\n\n<p>Now I have some function (<code>comp</code>) that takes some list, does something, creates a map, returns it.</p>\n\n<p>My question is how do I have two ways of calling <code>comp</code> so that its calls (say) to <code>insert</code> and <code>size</code> map correctly?</p>\n\n<p>As a strawman, I could write two copies of this function, one referencing <code>M.insert</code> and <code>M.size</code>, while the other references <code>HML.insert</code> and <code>HML.size</code> ... but how do I \"pass the module as a parameter\", or indicate this otherwise?</p>\n\n<p>Thanks!</p>\n\n<p><em>Edit:</em> to make this less abstract these are the exact definitions of <code>comp</code>: </p>\n\n<pre><code>mapComp :: KVPairs -&gt; IO ()\nmapComp kvpairs = do\n  let init = M.empty\n  let m = foldr ins init kvpairs where\n        ins (k, v) t = M.insert k v t\n  if M.size m /= length kvpairs\n  then putStrLn $ \"FAIL: \" ++ show (M.size m) ++ \", \" ++ show (length kvpairs)\n  else pure ()\n\nhashmapComp :: KVPairs -&gt; IO()\nhashmapComp kvpairs = do\n  let init = HML.empty\n  let m = foldr ins init kvpairs where\n        ins (k, v) t = HML.insert k v t\n  if HML.size m /= length kvpairs\n  then putStrLn $ \"Fail: \" ++ show (HML.size m) ++ \", \" ++ show (length kvpairs)\n  else pure ()\n</code></pre>\n\n<p><em>Edit (2):</em> this turned out to be <em>way</em> more interesting than I anticipated, thanks to everyone who responded!</p>\n"}, {"tags": ["list", "haskell", "functional-programming", "set-intersection"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1551997716, "post_id": 55053785, "comment_id": 96857225, "body": "<code>(Eq a_</code> should be <code>(Eq a)</code>"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1551997828, "post_id": 55053785, "comment_id": 96857263, "body": "<code>\u2026 if \u2026 else \u2026</code> is not Haskell syntax. <a href=\"https://en.wikibooks.org/wiki/Haskell/Control_structures\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/Haskell/Control_structures</a>"}, {"owner": {"reputation": 29, "user_id": 8173680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f972bd6b28fea9dff5f6ffcad01254d?s=128&d=identicon&r=PG", "display_name": "ayrnee", "link": "https://stackoverflow.com/users/8173680/ayrnee"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1552004274, "post_id": 55053785, "comment_id": 96859194, "body": "Big thanks to Lorenzo and @Robin-Zigmond for getting me on track with the syntax. There was one more error that had to be corrected as well as shown in the edit above but its working perfectly."}], "answers": [{"comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1552041021, "post_id": 55053866, "comment_id": 96870636, "body": "Thanks @Netwave - I just copied it from the OP and didn&#39;t even notice that! I see the OP also corrected it though."}], "tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": false, "score": 4, "last_activity_date": 1552040989, "last_edit_date": 1552040989, "creation_date": 1551997890, "answer_id": 55053866, "question_id": 55053785, "link": "https://stackoverflow.com/questions/55053785/how-to-check-for-an-empty-intersection-of-lists-with-haskell/55053866#55053866", "title": "How to check for an empty intersection of lists with Haskell", "body": "<p>You've basically got the right idea here, there are just a few slight issues:</p>\n\n<ul>\n<li>You haven't closed the brackets around the list comprehension, which results in a parse error.</li>\n<li>A list can't be used directly with <code>if</code>, since <code>if</code> only works with values of type <code>Bool</code>. You may perhaps be thinking of some other languages where lists/arrays are considered \"true\" if and only if they are non-empty - but Haskell does no automatic type conversions, so you have to explicitly check if the list is non-empty. The best and easiest way to do this is to use the <code>null</code> function (which takes a list and returns <code>True</code> if its empty, and <code>False</code> otherwise).</li>\n<li>As @Bergi pointed out (and I missed initially), you've got a typo in your <code>(Eq a)</code> constraint.</li>\n<li>The <code>if</code> statement is backwards. Python has the construct <code>x if (condition) else y</code>, but Haskell instead uses <code>if condition then x else y</code>. Also, although this isn't wrong, there's no need for it when your <code>x</code> and <code>y</code> are <code>True</code> and <code>False</code>, because the whole thing just evaluates to whatever <code>(condition)</code> is.</li>\n</ul>\n\n<p>So the code should be:</p>\n\n<pre><code>empty_intersection :: (Eq a) =&gt; [a] -&gt; [a] -&gt; Bool\nempty_intersection as bs = null [x | x &lt;- as, x  `elem` bs]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": false, "score": 4, "last_activity_date": 1552040198, "last_edit_date": 1552040198, "creation_date": 1551998094, "answer_id": 55053904, "question_id": 55053785, "link": "https://stackoverflow.com/questions/55053785/how-to-check-for-an-empty-intersection-of-lists-with-haskell/55053904#55053904", "title": "How to check for an empty intersection of lists with Haskell", "body": "<h1>Problem</h1>\n\n<p>Your code will not compile because a list cannot be a boolean, so you cannot have it in an if statement. There are however functions like <code>all</code>, <code>any</code> and <code>null</code> that can take lists and return booleans.</p>\n\n<h2>Solution</h2>\n\n<p>Just use the Prelude function <code>null :: [a] -&gt; Bool</code> which returns true if your list is empty. (Also note as @Bergi said you have a typo in your type constraint)</p>\n\n<pre><code>empty_intersection :: (Eq a =&gt; [a] -&gt; [a] -&gt; Bool\nempty_intersection as bs = null [x | x &lt;- as, x  `elem` bs]\n</code></pre>\n\n<h2>Even better</h2>\n\n<p>Also, as it's your second question on set unions and intersections, note that there is a library <code>Data.Set</code> for dealing with ordered sets which has much more efficients functions for intersection, union, membership, difference, etc.</p>\n"}, {"tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": false, "score": 0, "last_activity_date": 1552039702, "creation_date": 1552039702, "answer_id": 55060920, "question_id": 55053785, "link": "https://stackoverflow.com/questions/55053785/how-to-check-for-an-empty-intersection-of-lists-with-haskell/55060920#55060920", "title": "How to check for an empty intersection of lists with Haskell", "body": "<p>You can use <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:intersect\" rel=\"nofollow noreferrer\"><code>intersect</code></a></p>\n\n<pre><code>empty_intersection :: (Eq a) =&gt; [a] -&gt; [a] -&gt; Bool\nempty_intersection = null . intersect\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 8173680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f972bd6b28fea9dff5f6ffcad01254d?s=128&d=identicon&r=PG", "display_name": "ayrnee", "link": "https://stackoverflow.com/users/8173680/ayrnee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 497, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1552040989, "creation_date": 1551997510, "last_edit_date": 1552004306, "question_id": 55053785, "link": "https://stackoverflow.com/questions/55053785/how-to-check-for-an-empty-intersection-of-lists-with-haskell", "title": "How to check for an empty intersection of lists with Haskell", "body": "<p>Below is my code attempt for trying to create and then check the intersection of two lists in Haskell. Can someone help me get it to run?</p>\n\n<pre><code>empty_intersection :: (Eq a_ =&gt; [a] -&gt; [a] -&gt; Bool\nempty_intersection as bs = (true if ([x | x &lt;- as, x  `elem` bs) else false)\n</code></pre>\n"}, {"tags": ["haskell", "xmonad"], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1564621040, "post_id": 57297888, "comment_id": 101094658, "body": "Wow thanks for your in depth answer. I am someone who barely knows Haskell, only the real basics and you explained it so well I could understand. This is honestly one of the best answers I have ever seen on a question. Cheers."}, {"owner": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1564621903, "post_id": 57297888, "comment_id": 101094825, "body": "One question I do have. I have noticed that in haskell when you import stuff, for one reason or another sometimes you have to do something like <code>import qualified XMonad.StackSet as W</code>. I assume that is what you have done here for the letter M. Just wondering what import is M?"}, {"owner": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1564622224, "post_id": 57297888, "comment_id": 101094876, "body": "Because you use the word keys and its an M I assume it is <code>Data.Map</code>?"}, {"owner": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1564650435, "post_id": 57297888, "comment_id": 101103715, "body": "I can&#39;t quite get it to work. I get a Type error as follows &quot;Couldn&#39;t match expected type [(Window, Rectangle)] -&gt; [Window] with actual type [Window] In the expression: M.keys $ W.floating wset"}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "reply_to_user": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1564680529, "post_id": 57297888, "comment_id": 101120363, "body": "@Dylan Yeah, since I modified this code from XMonad.Layout.NoBorders I used the same imports that uses. I edited my answer and added the imports for clarity. You don&#39;t really need to <a href=\"https://stackoverflow.com/questions/11274864/what-does-qualified-mean-in-import-qualified-data-list-statement\">qualify imports</a>, but it&#39;s a good idea because it makes it obvious where the functions you&#39;re calling come from. This is especially important if multiple libraries you&#39;re importing define functions with the same names."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "reply_to_user": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1564680644, "post_id": 57297888, "comment_id": 101120423, "body": "@Dylan Are you sure your <code>hiddens</code> has the correct number of arguments? So <code>hiddens _ wset _ _ = ...</code> rather than <code>hiddens _ wset _ = ...</code>?"}, {"owner": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1564701058, "post_id": 57297888, "comment_id": 101127367, "body": "I managed to get it work. I had to write &quot;hiddens _ wset _ _ _ =&quot; instead of &quot;hiddens _ wset _ _&quot;."}, {"owner": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1564701621, "post_id": 57297888, "comment_id": 101127471, "body": "Not related to this question at all, but since you seem to know a lot. Is there any better way to define window sizes in XMonad with a type better than RationalRect? Maybe something that defines the size by distance from the edge of the screen in pixels?"}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "reply_to_user": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1564704178, "post_id": 57297888, "comment_id": 101127942, "body": "@Dylan Oh that&#39;s strange, it shouldn&#39;t take that many arguments. I mean if it works it works, but I must be missing something in that case ... I think most stuff only takes <code>RationalRect</code>, but with some math you can write a function that does the conversion to <code>RationalRect</code>, and pass your pixel coordinates and the total screen size into that."}], "tags": [], "owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "is_accepted": true, "score": 4, "last_activity_date": 1564679741, "last_edit_date": 1564679741, "creation_date": 1564602237, "answer_id": 57297888, "question_id": 55053645, "link": "https://stackoverflow.com/questions/55053645/how-would-i-remove-borders-from-all-floating-windows-in-xmonad/57297888#57297888", "title": "How would I remove borders from all Floating windows in XMonad", "body": "<p>I'll be using the <a href=\"https://hackage.haskell.org/package/xmonad-contrib-0.13/docs/src/XMonad-Layout-NoBorders.html\" rel=\"nofollow noreferrer\">source code</a> of XMonad.Layout.NoBorders as a reference, since I can't find anything more fitting that already exists. We want to see how it implements \"remove borders on fullscreen floating windows\", to see if it can be easily relaxed to \"remove borders on floating windows\" (without the fullscreen constraint).</p>\n\n<p>According to the answer on the question you linked:</p>\n\n<pre><code>layoutHook = lessBorders OnlyFloat $ avoidStruts $ myLayout\n</code></pre>\n\n<p><code>OnlyFloat</code> seems to be the specifier for \"remove borders on fullscreen floating windows\", so let's check the definition of that:</p>\n\n<pre><code>data Ambiguity = Combine With Ambiguity Ambiguity\n               | OnlyFloat\n               | Never\n               | EmptyScreen\n               | OtherIndicated\n               | Screen\n    deriving (Read, Show)\n</code></pre>\n\n<p>Not too helpful on its own. We should look elsewhere to see how the code treats these values.</p>\n\n<hr>\n\n<p>It's a pretty safe bet that the first function to check is <code>lessBorders</code>:</p>\n\n<pre><code>lessBorders :: (SetsAmbiguous p, Read p, Show p, LayoutClass l a) =&gt;\n        p -&gt; l a -&gt; ModifiedLayout (ConfigurableBorder p) l a\nlessBorders amb = ModifiedLayout (ConfigurableBorder amb [])\n</code></pre>\n\n<p>From the type signature of <code>lessBorders</code>, we can see that:</p>\n\n<pre><code>OnlyFloat :: (SetsAmbiguous p, Read p, Show p) =&gt; p\n</code></pre>\n\n<p>This is a good sign, as it means <code>lessBorders</code> doesn't explicitly expect an <code>Ambiguity</code>: we can extend the functionality here by implementing our own <code>SetsAmbiguous</code> and passing it to the existing <code>lessBorders</code>. Let's now look at <code>SetsAmbiguous</code>, and <code>Ambiguity</code>'s implementation of it:</p>\n\n<pre><code>class SetsAmbiguous p where\n    hiddens :: p -&gt; WindowSet -&gt; Maybe (W.Stack Window) -&gt; [(Window, Rectangle)] -&gt; [Window]\n\ninstance SetsAmbiguous Ambiguity where\n    hiddens amb wset mst wrs\n      | Combine Union a b &lt;- amb = on union next a b\n      | Combine Difference a b &lt;- amb = on (\\\\) next a b\n      | Combine Intersection a b &lt;- amb = on intersect next a b\n      | otherwise = tiled ms ++ floating\n      where next p = hiddens p wset mst wrs\n            nonzerorect (Rectangle _ _ 0 0) = False\n            nonzerorect _ = True\n            screens =\n              [ scr | scr &lt;- W.screens wset,\n                      case amb of\n                            Never -&gt; True\n                            _ -&gt; not $ null $ integrate scr,\n                      nonzerorect . screenRect $ W.screenDetail scr]\n            floating = [ w |\n                        (w, W.RationalRect px py wx wy) &lt;- M.toList . W.floating $ wset,\n                        px &lt;= 0, py &lt;= 0,\n                        wx + px &gt;= 1, wy + py &gt;= 1]\n            ms = filter (`elem` W.integrate' mst) $ map fst wrs\n            tiled [w]\n              | Screen &lt;- amb = [w]\n              | OnlyFloat &lt;- amb = []\n              | OtherIndicated &lt;- amb\n              , let nonF = map integrate $ W.current wset : W.visible wset\n              , length (concat nonF) &gt; length wrs\n              , singleton $ filter (1==) $ map length nonF = [w]\n              | singleton screens = [w]\n            tiled _ = []\n            integrate y = W.integrate' . W.stack $ W.workspace y\n</code></pre>\n\n<p><code>hiddens</code> is the only method here that we need to implement. Its arguments are our <code>SetsAmbiguous</code> value, a <code>WindowSet</code>, and some other things, and it returns a list of windows that should not show borders. There's a lot of logic for the combining operations and other <code>Ambiguity</code> values, but those don't matter to us right now. What we care about is this snippet:</p>\n\n<pre><code>            floating = [ w |\n                        (w, W.RationalRect px py wx wy) &lt;- M.toList . W.floating $ wset,\n                        px &lt;= 0, py &lt;= 0,\n                        wx + px &gt;= 1, wy + py &gt;= 1]\n</code></pre>\n\n<p>This is very promising. It defines a set of floating windows by extracting all windows from the <code>floating</code> section of the <code>WindowSet</code>, converting it to a list (initially it's a <code>Data.Map</code>), and filtering out all the windows that don't cover the entire screen. All we need to do is remove the filter.</p>\n\n<hr>\n\n<p>After making that change, and removing all unnecessary code pertaining to tiled windows and set operations (which is most of the implementation), we end up with simply:</p>\n\n<pre><code>import XMonad.Layout.NoBorders\nimport qualified XMonad.StackSet as W\nimport qualified Data.Map as M\n\ndata AllFloats = AllFloats deriving (Read, Show)\n\ninstance SetsAmbiguous AllFloats where\n    hiddens _ wset _ _ = M.keys $ W.floating wset\n</code></pre>\n\n<p>We can then say:</p>\n\n<pre><code>layoutHook = lessBorders AllFloats $ myLayout...\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 0, "accepted_answer_id": 57297888, "answer_count": 1, "score": 4, "last_activity_date": 1564679741, "creation_date": 1551996822, "question_id": 55053645, "link": "https://stackoverflow.com/questions/55053645/how-would-i-remove-borders-from-all-floating-windows-in-xmonad", "title": "How would I remove borders from all Floating windows in XMonad", "body": "<p>There are several similar questions but none quite solve it for me, for example <a href=\"https://stackoverflow.com/questions/13498979/remove-border-from-fullscreen-floating-windows-only-xmonad-configuration\">this</a> question explains how to remove borders from fullscreen floating windows.</p>\n\n<p>Using <a href=\"https://hackage.haskell.org/package/xmonad-contrib-0.13/docs/XMonad-Layout-NoBorders.html\" rel=\"nofollow noreferrer\">XMonad.Layout.NoBorders</a> you can do lots of cool stuff like remove borders from certain windows or if it is the only window or only fullscreen floating windows. </p>\n\n<p>I couldn't find anything for all floating windows, however if someone could just point me to some tool that I could use to check if a window is floating or not, I am sure I could try hack up a solution.</p>\n\n<p>Any suggestions are welcome</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1551994873, "post_id": 55053148, "comment_id": 96856177, "body": "It is not clear what you want to change and how. Could you be more clear on that? Do you just need a regex to wrap a word with parenthesis?"}, {"owner": {"reputation": 437, "user_id": 5775622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/64YBh.png?s=128&g=1", "display_name": "1234", "link": "https://stackoverflow.com/users/5775622/1234"}, "reply_to_user": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1551994958, "post_id": 55053148, "comment_id": 96856210, "body": "Given string &quot;mydog dog&quot;, I want to use subRegex to change the string to &quot;mydog (dog)&quot; , e.g. put bracket around my word, which is &quot;dog&quot; in this case"}, {"owner": {"reputation": 437, "user_id": 5775622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/64YBh.png?s=128&g=1", "display_name": "1234", "link": "https://stackoverflow.com/users/5775622/1234"}, "reply_to_user": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1551995022, "post_id": 55053148, "comment_id": 96856238, "body": "In Regex,  word is [a-zA-Z_]+ I think,"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1551995161, "post_id": 55053148, "comment_id": 96856303, "body": "<code>Text.Regex</code> implements POSIX regular expressions only, which do not support word boundaries.  Try <a href=\"http://hackage.haskell.org/package/regex-pcre\" rel=\"nofollow noreferrer\">regex-pcre</a> for Perl-compatible regular expressions."}], "answers": [{"comments": [{"owner": {"reputation": 437, "user_id": 5775622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/64YBh.png?s=128&g=1", "display_name": "1234", "link": "https://stackoverflow.com/users/5775622/1234"}, "edited": false, "score": 0, "creation_date": 1552073329, "post_id": 55067548, "comment_id": 96887123, "body": "Actually, I use your code, the output still is  &quot;mydog dog&quot; on my GHCI"}, {"owner": {"reputation": 437, "user_id": 5775622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/64YBh.png?s=128&g=1", "display_name": "1234", "link": "https://stackoverflow.com/users/5775622/1234"}, "edited": false, "score": 0, "creation_date": 1552073387, "post_id": 55067548, "comment_id": 96887158, "body": "How do I know subRegex is from regex-compat, not from other package?"}, {"owner": {"reputation": 437, "user_id": 5775622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/64YBh.png?s=128&g=1", "display_name": "1234", "link": "https://stackoverflow.com/users/5775622/1234"}, "edited": false, "score": 0, "creation_date": 1552073486, "post_id": 55067548, "comment_id": 96887201, "body": "Here are the regex on my machine."}, {"owner": {"reputation": 437, "user_id": 5775622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/64YBh.png?s=128&g=1", "display_name": "1234", "link": "https://stackoverflow.com/users/5775622/1234"}, "edited": false, "score": 0, "creation_date": 1552073499, "post_id": 55067548, "comment_id": 96887211, "body": "regex-base-0.93.2 regex-compat-0.95.1 regex-posix-0.95.2"}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": true, "score": 1, "last_activity_date": 1552063762, "creation_date": 1552063762, "answer_id": 55067548, "question_id": 55053148, "link": "https://stackoverflow.com/questions/55053148/anyone-know-how-to-use-text-regex-for-word-boundary/55067548#55067548", "title": "Anyone know how to use Text.Regex for word boundary?", "body": "<p><code>Text.Regex</code> from the <code>regex-compat</code> package uses POSIX-compatible regular expressions, not PCRE ones.</p>\n\n<p>In POSIX regular expressions, the left word boundary is <code>\\&lt;</code> and the right word boundary is <code>\\&gt;</code>:</p>\n\n<pre><code>ghci&gt; let r = mkRegex \"\\\\&lt;dog\\\\&gt;\"\nghci&gt; subRegex r \"mydog dog\" \"(\\\\0)\"\n\"mydog (dog)\"\n</code></pre>\n"}], "owner": {"reputation": 437, "user_id": 5775622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/64YBh.png?s=128&g=1", "display_name": "1234", "link": "https://stackoverflow.com/users/5775622/1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 55067548, "answer_count": 1, "score": 1, "last_activity_date": 1552063762, "creation_date": 1551994485, "question_id": 55053148, "link": "https://stackoverflow.com/questions/55053148/anyone-know-how-to-use-text-regex-for-word-boundary", "title": "Anyone know how to use Text.Regex for word boundary?", "body": "<p>I use <strong>Text.Regex</strong> package right now.</p>\n\n<p>I try to use subRegex for <strong>word boundary</strong>,</p>\n\n<pre><code>let r = mkRegex \"\\\\bdog\\\\b\"\n\nsubRegex r \"mydog dog\" \"(\\\\0)\"\n</code></pre>\n\n<p>output => \"mydog dog\"</p>\n\n<p>I also try following:</p>\n\n<pre><code>let r = mkRegex \"\\\\b(dog)\\\\b\"\n\nsubRegex r \"mydog dog\" \"(\\\\0)\"\n</code></pre>\n\n<p>output => \"mydog dog\"</p>\n\n<p>I try to change \"mydog dog\" => \"mydog (dog)\"</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1551991921, "post_id": 55052567, "comment_id": 96855048, "body": "Just use the <code>length</code> function. Or is this an exercise where you&#39;re not allowed to use it?"}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1551991961, "post_id": 55052567, "comment_id": 96855073, "body": "also isn&#39;t the union empty if and only if both are empty? If you&#39;re computing it just to check then there&#39;s no point"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1551993648, "post_id": 55052567, "comment_id": 96855753, "body": "@ayrnee: Please don&#39;t edit the question to ask something completely different, especially after an answer has already been posted. If you want to ask about intersections as well, please <a href=\"https://stackoverflow.com/questions/ask\">post a new question</a>"}], "answers": [{"comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 5, "creation_date": 1551992344, "post_id": 55052671, "comment_id": 96855238, "body": "Or just <code>null ls</code>."}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1551993139, "post_id": 55052671, "comment_id": 96855544, "body": "Lol I completely missed that, you can make it your answer or I&#39;ll edit mine if you want"}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": false, "score": 2, "last_activity_date": 1552000663, "last_edit_date": 1592644375, "creation_date": 1551992179, "answer_id": 55052671, "question_id": 55052567, "link": "https://stackoverflow.com/questions/55052567/how-to-check-if-the-explicit-union-of-two-sets-is-empty/55052671#55052671", "title": "How to check if the explicit union of two sets is empty?", "body": "<p>The Union is empty if and only if both sets are empty. So if you're computing the union just for that, you're wasting computational time.</p>\n<p>If instead you're given the union or have to use it anyways, length is the most natural method.</p>\n<p>However as you only want to know if it's empty, instead of <code>length ls == 0</code> you can use <code>take 1 ls == []</code>. This way Haskell -- as it's a lazy language --  only has to compute the first element, instead of the whole list as <code>length</code> would require</p>\n<h1>Edit</h1>\n<p>As @joseph pointed out, there's a Prelude function to check if a list is null: <code>null :: [a] -&gt; Bool</code></p>\n"}], "owner": {"reputation": 29, "user_id": 8173680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f972bd6b28fea9dff5f6ffcad01254d?s=128&d=identicon&r=PG", "display_name": "ayrnee", "link": "https://stackoverflow.com/users/8173680/ayrnee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552000663, "creation_date": 1551991710, "last_edit_date": 1551993588, "question_id": 55052567, "link": "https://stackoverflow.com/questions/55052567/how-to-check-if-the-explicit-union-of-two-sets-is-empty", "title": "How to check if the explicit union of two sets is empty?", "body": "<p>Below is my code for the explicit union of two lists. How would I get the length of the list rather than the list itself?</p>\n\n<pre><code>explicit_union :: (Eq a) =&gt; [a] -&gt; [a] -&gt; [a]\nexplicit_union as bs = foldl (\\as b -&gt; if elem b as then as else as ++ [b]) as bs\n</code></pre>\n"}, {"tags": ["list", "haskell", "split", "tuples", "concat"], "answers": [{"tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": true, "score": 8, "last_activity_date": 1551988301, "last_edit_date": 1592644375, "creation_date": 1551988301, "answer_id": 55051809, "question_id": 55051693, "link": "https://stackoverflow.com/questions/55051693/haskell-concat-a-list-of-tuples-with-an-element-and-a-list-a-b-a-b/55051809#55051809", "title": "Haskell: concat a list of tuples with an element and a list: [(a,[b])] -&gt; [(a,b)]", "body": "<h1>Why not a simple list comprehension?</h1>\n<p>List comprehensions can often do as much as higher order functions, and I think that if you don't need to change the data but only &quot;unpack&quot; it, they are pretty clear. Here's a working example:</p>\n<pre><code>concS :: [(a,[b])] -&gt; [(a,b)]\nconcS ls = [(a,b) | (a,x) &lt;- ls, b &lt;- x]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "is_accepted": false, "score": 1, "last_activity_date": 1551991897, "creation_date": 1551991897, "answer_id": 55052600, "question_id": 55051693, "link": "https://stackoverflow.com/questions/55051693/haskell-concat-a-list-of-tuples-with-an-element-and-a-list-a-b-a-b/55052600#55052600", "title": "Haskell: concat a list of tuples with an element and a list: [(a,[b])] -&gt; [(a,b)]", "body": "<p>You can also use the monad instance for lists:</p>\n\n<pre><code>concatSplit l = l &gt;&gt;= \\(a,x) -&gt; x &gt;&gt;= \\b -&gt; return (a,b)\n</code></pre>\n\n<p>Which can be simplified to:</p>\n\n<pre><code>concatSplit l = l &gt;&gt;= \\(a,x) -&gt; map ((,) a) x\n</code></pre>\n\n<p>And reformatted to <code>do</code> notation</p>\n\n<pre><code>concatSplit l = do\n  (a,x) &lt;- l\n  map ((,) a) x\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1552070603, "post_id": 55055170, "comment_id": 96885793, "body": "it&#39;d add much value to the answer if you could expound a bit on the specific types and instances involved."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1552079025, "post_id": 55055170, "comment_id": 96889498, "body": "@WillNess I added some explanation."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1552080182, "post_id": 55055170, "comment_id": 96889943, "body": "great; can&#39;t uv twice. :) I don&#39;t know if that&#39;s an accepted terminology, but I usually say <code>sequence</code> &quot;transposes&quot; the types, or &quot;flips&quot; them. (&quot;turns inside-out&quot; also sounds nice.) here, it turns a pair with a list  into a list of pairs... so we have <code>concatsplit = (&gt;&gt;= (\\(a,bs) -&gt; (a ,) &lt;$&gt; bs))</code> and that&#39;s exactly the definition of the &quot;pair&quot; Traversable. Nice; thanks for making me work through this. :) another tricky example is <code>traverse (splitAt 1)</code> which does exactly what&#39;s expected of it from the types, like magic; simpler, yet nice, is <code>traverse ZipList</code> (cf. &quot;transposes&quot; above ;) )."}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1552079017, "last_edit_date": 1552079017, "creation_date": 1552006264, "answer_id": 55055170, "question_id": 55051693, "link": "https://stackoverflow.com/questions/55051693/haskell-concat-a-list-of-tuples-with-an-element-and-a-list-a-b-a-b/55055170#55055170", "title": "Haskell: concat a list of tuples with an element and a list: [(a,[b])] -&gt; [(a,b)]", "body": "<p><code>sequenceA</code> makes it really easy:</p>\n\n<pre><code>concatsplit = concatMap sequenceA\n</code></pre>\n\n<p>Or generalize it even further:</p>\n\n<pre><code>concatsplit = (&gt;&gt;= sequenceA)\n</code></pre>\n\n<p>Details:</p>\n\n<ul>\n<li><code>sequenceA</code> has type <code>(Applicative f, Traversable t) =&gt; t (f a) -&gt; f (t a)</code>. This means that if you have a type with a <code>Traversable</code> on the \"outside\" and an <code>Applicative</code> on the \"inside\", you can call <code>sequenceA</code> on it to turn it inside-out, so that the <code>Applicative</code> is on the \"outside\" and the <code>Traversable</code> is on the \"inside\".</li>\n<li>In this case, <code>(True, \"xy\")</code> has type <code>(Bool, [Char])</code>, which desugars to <code>(,) Bool ([] Char)</code>. There's <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/src/Data.Traversable.html#line-252\" rel=\"nofollow noreferrer\">an instance</a> of <code>Traversable</code> for <code>((,) a)</code>, and there's <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.Base.html#line-972\" rel=\"nofollow noreferrer\">an instance</a> of <code>Applicative</code> for <code>[]</code>. Thus, you can call <code>sequenceA</code> on it, and the result will be of type <code>[] ((,) Bool Char)</code>, or <code>[(Bool, Char)]</code> with sugar.</li>\n<li>As it turns out, not only does <code>sequenceA</code> have a useful type, but it does exactly the thing you need here (and turns out to be exactly equivalent to <code>concatsplit'</code>).</li>\n<li><code>concatMap</code> has type <code>Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]</code>. <code>(&gt;&gt;=)</code> has type <code>Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b</code>. When specialized to lists, these become the same, except with their arguments in the opposite order.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1552034861, "post_id": 55056397, "comment_id": 96867520, "body": "I very much like <code>TupleSections</code>: <code>concatMap (\\(a,bs) -&gt; map (a,) bs)</code>.  No essential difference but the one fewer pair of parentheses cleans it up a lot for me."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1552069750, "post_id": 55056397, "comment_id": 96885430, "body": "@luqui I prefer <code>(a ,)</code>, similar to <code>(f .)</code> over <code>(f.)</code>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1552016558, "creation_date": 1552016558, "answer_id": 55056397, "question_id": 55051693, "link": "https://stackoverflow.com/questions/55051693/haskell-concat-a-list-of-tuples-with-an-element-and-a-list-a-b-a-b/55056397#55056397", "title": "Haskell: concat a list of tuples with an element and a list: [(a,[b])] -&gt; [(a,b)]", "body": "<p>The other answers show how to do this idiomatically from scratch, which I like a lot. It might also be interesting to show how you might polish what you've already got. Here it is again as a reminder:</p>\n\n<pre><code>concatsplit a = concatMap (\\(x,y)-&gt; concatsplit' (x,y)) a\nconcatsplit' y = map (\\x -&gt; ((fst y),x)) (snd y)\n</code></pre>\n\n<p>The first thing I'd consistently change is called \"eta reduction\", and it is when you turn something of the shape <code>\\x -&gt; foo x</code> into just <code>foo</code>. We can do this in the argument to <code>concatMap</code> to get</p>\n\n<pre><code>concatsplit a = concatMap concatsplit' a\n</code></pre>\n\n<p>and then again in the argument to <code>concatsplit</code> to get:</p>\n\n<pre><code>concatsplit = concatMap concatsplit'\n</code></pre>\n\n<p>Looking at <code>concatsplit'</code>, the thing I like least is the use of <code>fst</code> and <code>snd</code> instead of pattern matching. With pattern matching, it looks like this:</p>\n\n<pre><code>concatsplit' (a,bs) = map (\\x -&gt; (a,x)) bs\n</code></pre>\n\n<p>If you really wanted to practice your eta reduction, you might notice that <code>(,)</code> can be applied prefix and change this to</p>\n\n<pre><code>concatsplit' (a,bs) = map (\\x -&gt; (,) a x) bs\n                    = map ((,) a) bs\n</code></pre>\n\n<p>but I think I'm just as happy one way or the other. At this point, this definition is small enough that I'd be tempted to inline it into <code>concatsplit</code> itself, getting:</p>\n\n<pre><code>concatsplit = concatMap (\\(a,bs) -&gt; map ((,) a) bs)\n</code></pre>\n\n<p>This looks like a pretty good definition to me, and I'd stop there.</p>\n\n<p>You <em>might</em> be bugged by the almost-eta-reduction here: it's almost the right shape to drop the <code>bs</code>. An advanced user might go on, noticing that:</p>\n\n<pre><code>uncurry (\\a bs -&gt; map ((,) a) bs) = \\(a,bs) -&gt; map ((,) a) bs\n</code></pre>\n\n<p>Hence with some eta reduction and other point-free techniques, we could transition this way:</p>\n\n<pre><code>concatsplit = concatMap (uncurry (\\a bs -&gt; map ((,) a) bs))\n            = concatMap (uncurry (\\a -&gt; map ((,) a)))\n            = concatMap (uncurry (map . (,)))\n</code></pre>\n\n<p>But, personally, I find this less readable than where I declared I would stop above, namely:</p>\n\n<pre><code>concatsplit = concatMap (\\(a,bs) -&gt; map ((,) a) bs)\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 10686157, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IQBCPjl5qzM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jyBParm2NeUyniKNHAokFIdty--g/mo/photo.jpg?sz=128", "display_name": "oddi", "link": "https://stackoverflow.com/users/10686157/oddi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 1, "accepted_answer_id": 55051809, "answer_count": 4, "score": 3, "last_activity_date": 1552079017, "creation_date": 1551987852, "question_id": 55051693, "link": "https://stackoverflow.com/questions/55051693/haskell-concat-a-list-of-tuples-with-an-element-and-a-list-a-b-a-b", "title": "Haskell: concat a list of tuples with an element and a list: [(a,[b])] -&gt; [(a,b)]", "body": "<p>I want to concat in a list of tuples of elements and Strings, each char with the element. </p>\n\n<p>For example: [(True, \"xy\"), (False, \"abc\")] \udbff\udc01-> [(True,\u2019x\u2019),(True,\u2019y\u2019),(False,\u2019a\u2019), (False,\u2019b\u2019),(False,\u2019c\u2019)]</p>\n\n<p>I do have a solution, but im wondering if there is a better one:</p>\n\n<pre><code>concatsplit :: [(a,[b])] -&gt; [(a,b)]\nconcatsplit a = concatMap (\\(x,y)-&gt; concatsplit' (x,y)) a\n\nconcatsplit' :: (a,[b]) -&gt; [(a,b)]\nconcatsplit' y = map (\\x -&gt; ((fst y),x)) (snd y)\n</code></pre>\n"}, {"tags": ["string", "haskell", "filter", "count"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1551982438, "post_id": 55050264, "comment_id": 96850583, "body": "is overlapping allowed? does &quot;egegeg&quot; have one &quot;egeg&quot; or two?"}, {"owner": {"reputation": 75, "user_id": 10686157, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IQBCPjl5qzM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jyBParm2NeUyniKNHAokFIdty--g/mo/photo.jpg?sz=128", "display_name": "oddi", "link": "https://stackoverflow.com/users/10686157/oddi"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1551982585, "post_id": 55050264, "comment_id": 96850649, "body": "no one, i want to count every connected &quot;egg&quot;"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1551982807, "post_id": 55050264, "comment_id": 96850759, "body": "well, how many &quot;xox&quot; in &quot;xoxox&quot; then?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1551982887, "post_id": 55050264, "comment_id": 96850796, "body": "I don&#39;t think he&#39;s asking for the generalized implementation.  Just one specialized to &#39;egg&#39;."}, {"owner": {"reputation": 75, "user_id": 10686157, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IQBCPjl5qzM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jyBParm2NeUyniKNHAokFIdty--g/mo/photo.jpg?sz=128", "display_name": "oddi", "link": "https://stackoverflow.com/users/10686157/oddi"}, "edited": false, "score": 1, "creation_date": 1551983066, "post_id": 55050264, "comment_id": 96850888, "body": "I didn&#39;t  thought about this special case, it doesn&#39;t matter i think, with &quot;egg&quot; you don&#39;t have this case"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 10686157, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IQBCPjl5qzM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jyBParm2NeUyniKNHAokFIdty--g/mo/photo.jpg?sz=128", "display_name": "oddi", "link": "https://stackoverflow.com/users/10686157/oddi"}, "edited": false, "score": 0, "creation_date": 1551983502, "post_id": 55050431, "comment_id": 96851102, "body": "Do you know, why it says: Module \u2018Data.Text.Internal.Search\u2019 does not export \u2018indicies\u2019 ?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 75, "user_id": 10686157, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IQBCPjl5qzM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jyBParm2NeUyniKNHAokFIdty--g/mo/photo.jpg?sz=128", "display_name": "oddi", "link": "https://stackoverflow.com/users/10686157/oddi"}, "edited": false, "score": 0, "creation_date": 1551984997, "post_id": 55050431, "comment_id": 96851757, "body": "Because it isn&#39;t <code>indicies</code> it is <code>indices</code> (note the <code>ie</code> vs just <code>e</code>).  I&#39;ll edit to fix that typo. EDIT:  I also imported Text qualified to avoid a name clash on <code>length</code>."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 1, "last_activity_date": 1551985003, "last_edit_date": 1551985003, "creation_date": 1551982837, "answer_id": 55050431, "question_id": 55050264, "link": "https://stackoverflow.com/questions/55050264/haskell-count-infixes-of-a-string/55050431#55050431", "title": "Haskell: Count infixes of a string", "body": "<p>Counting words can be quite easy. Just use a boyer moore implementation</p>\n\n<pre><code>import Data.Text.Internal.Search (indices)\nimport qualified Data.Text as T\n\neaster :: String -&gt; Int\neaster = length . indices (T.pack \"egg\") . T.pack\n</code></pre>\n\n<p>Now the fun part is writing the algorithm yourself.  It's a great learning exercise and common in algorithm classes.  Try it out!  Don't bother to use Text the first time, just use String as you already have been and follow the wikipedia article.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 3, "last_activity_date": 1551983431, "creation_date": 1551983431, "answer_id": 55050581, "question_id": 55050264, "link": "https://stackoverflow.com/questions/55050264/haskell-count-infixes-of-a-string/55050581#55050581", "title": "Haskell: Count infixes of a string", "body": "<p>Without possibility of overlapping it's as easy as</p>\n\n<pre><code>&gt; let s=\"eggabcdefgegggzueggeggegg\" in sum [1 | i &lt;- tails s, take 3 i == \"egg\"]\n\n5\n</code></pre>\n\n<p><code>tails</code> is in <code>Data.List</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1551983588, "creation_date": 1551983588, "answer_id": 55050606, "question_id": 55050264, "link": "https://stackoverflow.com/questions/55050264/haskell-count-infixes-of-a-string/55050606#55050606", "title": "Haskell: Count infixes of a string", "body": "<p>Keeping in mind that a <code>String</code> is just a <code>[Char]</code>, pattern matching is simple.</p>\n\n<pre><code>easter :: String -&gt; Int\neaster [] = 0\neaster ('e':'g':'g':rest) = 1 + easter rest\neaster (x:xs) = easter xs\n</code></pre>\n\n<p>An empty string clearly has 0 occurrences of \"egg\".</p>\n\n<p>If the string starts with \"egg\", there's at least 1 occurrence. Remove it, and check the remainder of the string.</p>\n\n<p>If the string starts with anything else, remove the first letter and continue.</p>\n"}, {"tags": [], "owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "is_accepted": true, "score": 4, "last_activity_date": 1551983869, "creation_date": 1551983869, "answer_id": 55050664, "question_id": 55050264, "link": "https://stackoverflow.com/questions/55050264/haskell-count-infixes-of-a-string/55050664#55050664", "title": "Haskell: Count infixes of a string", "body": "<p>Take a look at the <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#g:10\" rel=\"nofollow noreferrer\">Extracting Sublists</a> section of the Data.List standard library.</p>\n\n<p>You want to build a function that looks at each point in the String (remember <code>String</code> is a type alias for <code>[Char]</code>) to see if it starts \"egg.\"</p>\n\n<p>Here is how I might do it.</p>\n\n<pre><code>easter :: String -&gt; Int\neaster str = length $ filter (isPrefixOf \"egg\") (tails str)\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 10686157, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IQBCPjl5qzM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jyBParm2NeUyniKNHAokFIdty--g/mo/photo.jpg?sz=128", "display_name": "oddi", "link": "https://stackoverflow.com/users/10686157/oddi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 55050664, "answer_count": 4, "score": 0, "last_activity_date": 1551985003, "creation_date": 1551982186, "question_id": 55050264, "link": "https://stackoverflow.com/questions/55050264/haskell-count-infixes-of-a-string", "title": "Haskell: Count infixes of a string", "body": "<p>I want to count, how often the String \"egg\" is in a given String.\nI just know how to count chars</p>\n\n<pre><code>easter :: String -&gt; Int\neaster s = length $ filter (== 'e') s\n</code></pre>\n\n<p>Example: easter \"eggabcdefgegggzueggeggegg\" -> 5</p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["haskell", "constraints", "typeclass"], "answers": [{"comments": [{"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "edited": false, "score": 0, "creation_date": 1551977961, "post_id": 55049055, "comment_id": 96848327, "body": "Brilliant. Understandable and noted! Thx"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 3, "creation_date": 1551981005, "post_id": 55049055, "comment_id": 96849943, "body": "I think if you&#39;re going to call the trivial instance &quot;valid&quot; you should point out that this only follows the Eq substitutivity law if you don&#39;t provide a way for clients to observe the value inside Is. More likely, those values are exposed, and so the trivial instance technically compiles but doesn&#39;t behave like an Eq instance should."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1551982018, "post_id": 55049055, "comment_id": 96850393, "body": "Thanks; I don&#39;t think I ever noticed the substitutivity law before."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 7, "last_activity_date": 1551981678, "last_edit_date": 1551981678, "creation_date": 1551977623, "answer_id": 55049055, "question_id": 55048943, "link": "https://stackoverflow.com/questions/55048943/haskell-instance-of-typeclass-definition-with-type-constructor/55049055#55049055", "title": "Haskell instance of typeclass definition with type constructor", "body": "<p>Your original definition said that <code>CouldBe m</code> was an instance of <code>Eq</code> for <em>any</em> type <code>m</code>, even one that doesn't have an <code>Eq</code> instance. But if that's true, you have to find some way of defining <code>Is x == Is y</code> without using <code>x == y</code> (since you haven't required <code>m</code> to have an <code>Eq</code> instance, <code>x == y</code> isn't necessarily defined.)</p>\n\n<p>As a specific example, it prevents you from writing something like</p>\n\n<pre><code>Is (+3) == Is (* 5)  -- (+3) == (*5) is undefined\n</code></pre>\n\n<p>Adding the constraint ensures you can compare two <code>CouldBe</code> values only if the wrapped type can also be compared.</p>\n\n<hr>\n\n<p>A \"valid\", but trivial, instance without adding the constraint:</p>\n\n<pre><code>instance Eq (CouldBe m) where\n  Is x == Is y = True\n  Lost == Lost = True\n  _ == _ = False\n</code></pre>\n\n<p>Two <code>CouldBe m</code> values are equal as long as they share the same data constructor, regardless of the wrapped value. No attempt is made to use <code>x</code> or <code>y</code> at all, so their types can be unconstrained.</p>\n\n<p>\"Valid\" is in quotes because this definition could be in violation of the substitutivity law, defined at <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Eq.html\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Eq.html</a>. Suppose you had a function that could pull apart a <code>CouldBe</code> value:</p>\n\n<pre><code>couldbe :: b -&gt; (a -&gt; b) -&gt; CouldBe a -&gt; b\ncouldBe x _ Lost = x\ncouldBe _ f (Is x) = f x\n</code></pre>\n\n<p>The violation occurs because <code>Is 3 == Is 5</code> would be true, but let <code>f = couldbe 0 id</code>. Then <code>f (Is 3) == f (Is 5)</code> evaluates to <code>3 == 5</code> which is false.</p>\n\n<p>Whether it's <em>actually</em> a violation or not depends on the existence of a function like <code>couldbe</code> that can see \"inside\" a <code>CouldBe</code> value.</p>\n"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 55049055, "answer_count": 1, "score": 5, "last_activity_date": 1551981678, "creation_date": 1551977241, "question_id": 55048943, "link": "https://stackoverflow.com/questions/55048943/haskell-instance-of-typeclass-definition-with-type-constructor", "title": "Haskell instance of typeclass definition with type constructor", "body": "<pre><code>data CouldBe a = Is a | Lost deriving (Show, Ord)\n\ninstance Eq (CouldBe m) where\n  Is x == Is y = x == y \n  Lost == Lost = True \n  _ == _ = False \n</code></pre>\n\n<p>Gives an error: <code>No instance for (Eq m) arising from a use of \u2018==\u2019</code>\nSo:</p>\n\n<pre><code>instance (Eq m) =&gt; Eq (CouldBe m) where\n  Is x == Is y = x == y \n  Lost == Lost = True \n  _ == _ = False \n</code></pre>\n\n<p>Works fine (at least I start understanding the errors), but why do I need that constraint? \nI am trying to learn, so the 'why' is very important to me. </p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1551970310, "creation_date": 1551970310, "answer_id": 55046658, "question_id": 55045463, "link": "https://stackoverflow.com/questions/55045463/accumulator-version-of-recursion/55046658#55046658", "title": "Accumulator version of recursion", "body": "<p>Here's a hint: add an accumulator argument <code>acc</code></p>\n\n<pre><code>ff a n = ffACC a n (some initial accumulator value)\n\nffACC a n acc =\n    if n==0      then ...\n    else if n==1 then ...\n    else  ...\n</code></pre>\n\n<p>Make sure that in each <code>...</code> all the recursive calls are tail calls. That is, return <code>ffACC (new a) (new n) (new acc)</code>, not something like <code>value * ffACC ...</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 3585, "user_id": 2832011, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh6.googleusercontent.com/-qmf5h7espz4/AAAAAAAAAAI/AAAAAAAAAeg/sSX2THu0FUw/photo.jpg?sz=128", "display_name": "Christoph Burschka", "link": "https://stackoverflow.com/users/2832011/christoph-burschka"}, "is_accepted": false, "score": 0, "last_activity_date": 1551970320, "creation_date": 1551970320, "answer_id": 55046660, "question_id": 55045463, "link": "https://stackoverflow.com/questions/55045463/accumulator-version-of-recursion/55046660#55046660", "title": "Accumulator version of recursion", "body": "<p>You start with an initial value 1: <code>ff a n = ffAccu a n 1</code>, then call the recursion as</p>\n\n<pre><code>ffAccu a n m = if n == 0 then m else (ffAccu a (n-1) (a*m))\n</code></pre>\n\n<p>(Note: The <code>if then else</code> construct might be written more cleanly by using pattern matching, as in</p>\n\n<pre><code>ffAccu a 0 m = m\nffAccu a n m = ffAccu a (n-1) (a*m)\n</code></pre>\n\n<p>)</p>\n"}], "owner": {"reputation": 1, "user_id": 11165781, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3F6MvNtl1L0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfcg1RqLZS9hNKgyPADLXmWOh9ftA/mo/photo.jpg?sz=128", "display_name": "FirstStepByStep", "link": "https://stackoverflow.com/users/11165781/firststepbystep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1551995992, "creation_date": 1551966876, "last_edit_date": 1551995992, "question_id": 55045463, "link": "https://stackoverflow.com/questions/55045463/accumulator-version-of-recursion", "title": "Accumulator version of recursion", "body": "<p>I have a example of accu version of recursion. \nNormal recursion:</p>\n\n<pre><code>fib n = if n== 0 then 1 else if n==1 then 1 else fib(n-1) + fib (n-2) \n</code></pre>\n\n<p>Accu recursion:</p>\n\n<pre><code>fib n fibPOM n 1 1 \nfibPOM n f1 f2 = if n ==1 then f1 else fibPOM (n-1) (f1+f2) f1 \n</code></pre>\n\n<p>And i must do the same with this(a^n recursion): </p>\n\n<pre><code>ff a n = if n==0 then 1 else if n==1 then a else a * ff a (n-1)\n</code></pre>\n\n<p>But i have no idea what i must do to get a^n accu recursion.  </p>\n"}, {"tags": ["haskell", "functor"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551966468, "post_id": 55045285, "comment_id": 96841151, "body": "Not sure if it&#39;s fully a dupe, as you&#39;re asking a few other things and it&#39;s a slightly more complicated example, but I hope the above link is helpful."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 5, "creation_date": 1551966519, "post_id": 55045285, "comment_id": 96841178, "body": "In the expression 3-2+1, you can&#39;t say \u201dI&#39;m just going to think about the 2+1 first, which is 3, so the whole expression is 3-3, which is 0\u201d. That&#39;s wrong because + and - have the same precedence and are left-associative in math. You&#39;re making the exact same mistake with &lt;$&gt; and &lt;*&gt; in Haskell."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1551993300, "post_id": 55045285, "comment_id": 96855622, "body": "Not really an answer, but here&#39;s an intuitive overview of what&#39;s going on: when you do <code>func &lt;$&gt; f &lt;*&gt; g &lt;*&gt; h &lt;*&gt; ... $ x</code>, it gets evaluated as <code>func (f x) (g x) (h x) ...</code>. It&#39;s very useful when you have some data you want to pass to all parameters of a function."}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 3, "last_activity_date": 1551968348, "creation_date": 1551968348, "answer_id": 55045993, "question_id": 55045285, "link": "https://stackoverflow.com/questions/55045285/how-does-x-y-z-x-y-z-3-2-2-5-really-work/55045993#55045993", "title": "How does &quot;(\\x y z -&gt; [x,y,z]) &lt;$&gt; (+3) &lt;*&gt; (*2) &lt;*&gt; (/2) $ 5 &quot; really work?", "body": "<p>That expression is actually parenthesized to the left:</p>\n\n<pre><code>(\\x y z -&gt; [x,y,z]) &lt;$&gt; (+3) &lt;*&gt; (*2) &lt;*&gt; (/2) $ 5 \n=\n((((\\x y z -&gt; [x,y,z]) &lt;$&gt; (+3)) &lt;*&gt; (*2)) &lt;*&gt; (/2)) 5 \n=\n((((\\x y z -&gt; [x,y,z])  .  (+3)) &lt;*&gt; (*2)) &lt;*&gt; (/2)) 5 \n=\n (((\\x y z -&gt; [x,y,z])  .  (+3)) &lt;*&gt; (*2)) 5   ((/2) 5)\n=\n  ((\\x y z -&gt; [x,y,z])  .  (+3)) 5   ((*2) 5)   ((/2) 5)\n=\n   (\\x y z -&gt; [x,y,z])    ((+3) 5)   ((*2) 5)   ((/2) 5)\n=\n   (\\x y z -&gt; [x,y,z])    (5+3)      (5*2)      (5/2)\n</code></pre>\n\n<p>which is</p>\n\n<pre><code>=\n   let x = (5+3) in (\\y z -&gt; [x,y,z])   (5*2)      (5/2)\n=\n   let x = (5+3) ; y = (5*2)  in  (\\z -&gt; [x,y,z])   (5/2)\n=\n   let x = (5+3) ; y = (5*2) ; z = (5/2)  in   [x,y,z]    \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1551968356, "creation_date": 1551968356, "answer_id": 55045998, "question_id": 55045285, "link": "https://stackoverflow.com/questions/55045285/how-does-x-y-z-x-y-z-3-2-2-5-really-work/55045998#55045998", "title": "How does &quot;(\\x y z -&gt; [x,y,z]) &lt;$&gt; (+3) &lt;*&gt; (*2) &lt;*&gt; (/2) $ 5 &quot; really work?", "body": "<p>I think you got the precedence wrong. The expression</p>\n\n<pre><code>(\\x y z -&gt; [x,y,z]) &lt;$&gt; (+3) &lt;*&gt; (*2) &lt;*&gt; (/2) $ 5  \n</code></pre>\n\n<p>does <em>not</em> involve as a subexpression the one you mention</p>\n\n<pre><code>(+3) &lt;*&gt; (*2) &lt;*&gt; (/2)\n</code></pre>\n\n<p>since it should be parsed associating <em>to the left</em>, as follows:</p>\n\n<pre><code>((((\\x y z -&gt; [x,y,z]) &lt;$&gt; (+3)) &lt;*&gt; (*2)) &lt;*&gt; (/2)) $ 5\n</code></pre>\n\n<p>Here, we start to simplify from the left:</p>\n\n<pre><code>(\\x y z -&gt; [x,y,z]) &lt;$&gt; (+3)\n= { def. &lt;$&gt; }\n(\\a y z -&gt; [(+3) a,y,z])\n</code></pre>\n\n<p>Then, we proceed:</p>\n\n<pre><code>(\\a y z -&gt; [(+3) a,y,z]) &lt;*&gt; (*2)\n= { def. &lt;*&gt; }\n(\\a z -&gt; [(+3) a, (*2) a,z])\n</code></pre>\n\n<p>Finally,</p>\n\n<pre><code>(\\a z -&gt; [(+3) a, (*2) a,z]) &lt;*&gt; (/2)\n= { def. &lt;*&gt; }\n(\\a -&gt; [(+3) a, (*2) a, (/2) a])\n</code></pre>\n\n<p>As a last step, we let <code>a</code> to be <code>5</code>, obtaining <code>[5+3, 5*2, 5/2]</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10661584"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "closed_date": 1552031507, "accepted_answer_id": 55045998, "answer_count": 2, "score": 0, "last_activity_date": 1551968356, "creation_date": 1551966233, "question_id": 55045285, "link": "https://stackoverflow.com/questions/55045285/how-does-x-y-z-x-y-z-3-2-2-5-really-work", "closed_reason": "Duplicate", "title": "How does &quot;(\\x y z -&gt; [x,y,z]) &lt;$&gt; (+3) &lt;*&gt; (*2) &lt;*&gt; (/2) $ 5 &quot; really work?", "body": "<p>In <a href=\"http://learnyouahaskell.com/functors-applicative-functors-and-monoids\" rel=\"nofollow noreferrer\">this example from Learn you a Haskell</a>, the author showed how to declare an instance of <code>Applicative</code> for function <code>-&gt;r</code></p>\n\n<pre><code>instance Applicative ((-&gt;) r) where  \n    pure x = (\\_ -&gt; x)  \n    f &lt;*&gt; g = \\x -&gt; f x (g x)  \n</code></pre>\n\n<p>Later on, he gave a concrete example</p>\n\n<pre><code>ghci&gt; (\\x y z -&gt; [x,y,z]) &lt;$&gt; (+3) &lt;*&gt; (*2) &lt;*&gt; (/2) $ 5  \n[8.0,10.0,2.5]  \n</code></pre>\n\n<p>I try to reason this snippet step by step</p>\n\n<ol>\n<li>Seeing <code>(+3) &lt;*&gt; (*2) &lt;*&gt; (/2)</code> as <code>f &lt;*&gt; g &lt;*&gt; h</code> and thinking that <code>f &lt;*&gt; g &lt;*&gt; h</code> returns a function <code>\\x -&gt; f x (g x (h x))</code>, I thought <code>(+3) &lt;*&gt; (*2) &lt;*&gt; (/2)</code> returns a function <code>\\x -&gt; x+3 (x*2 (x/2))</code>. But I can not do <code>:t (+3) &lt;*&gt; (*2) &lt;*&gt; (/2)</code> in ghci, which raises this error</li>\n</ol>\n\n<pre><code>error:\n    \u2022 Occurs check: cannot construct the infinite type:\n        a1 ~ a -&gt; a1 -&gt; b\n      Expected type: (a -&gt; a1 -&gt; b) -&gt; a1\n        Actual type: a1 -&gt; a1\n    \u2022 In the second argument of \u2018(&lt;*&gt;)\u2019, namely \u2018(/ 2)\u2019\n      In the expression: (+ 3) &lt;*&gt; (* 2) &lt;*&gt; (/ 2)\n</code></pre>\n\n<ol start=\"2\">\n<li>If <code>(+3) &lt;*&gt; (*2) &lt;*&gt; (/2)</code> does return a function <code>\\x -&gt; x+3 (x*2 (x/2))</code>, how does it pattern match with the lambda function <code>\\x y z -&gt; [x,y,z]</code>? (Actually I am still having some trouble to understand lambda functions except for the really basic simple ones.)</li>\n</ol>\n"}, {"tags": ["haskell", "monads", "composition", "monad-transformers"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1551966534, "post_id": 55044292, "comment_id": 96841186, "body": "@RobinZigmond But given that a monad is a functor, <i>something</i> about the extra structure in a monad &quot;breaks&quot; composition. I think that&#39;s what the OP is looking for, what that &quot;something&quot; is."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1551966663, "post_id": 55044292, "comment_id": 96841262, "body": "@NirvinM - not sure why you think I&#39;m being &quot;mean&quot;. I&#39;m just trying to understand what you need by way of further explanation. (Not that I&#39;m necessarily able to give it, being no expert in this area.) @chepner - I agree, unfortunately I had to drastically cut my original comment due to the character limit so the part where I acknowledged that ended up not being there. But I think the linked-to answer did a good job about explaining that, based on the <code>join</code> definition of a Monad (I presume something similar happens when you try using <code>&gt;&gt;=</code>)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551967847, "post_id": 55044292, "comment_id": 96841977, "body": "@RobinZigmond Perhaps what&#39;s missing form the linked answer is a concrete counterexample. The answer simply shows that if we attempt to prove that monads compose in the straightforward way, we fail. Strictly speaking, this does not prove that monads don&#39;t compose: we need a counterexample."}, {"owner": {"reputation": 3961, "user_id": 176015, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/398c96f77ec9b99b1e8122214227305d?s=128&d=identicon&r=PG", "display_name": "svenningsson", "link": "https://stackoverflow.com/users/176015/svenningsson"}, "edited": false, "score": 0, "creation_date": 1551970359, "post_id": 55044292, "comment_id": 96843618, "body": "Note that even though monads are not closed under composition, monad transformers are indeed closed under composition. Though it won&#39;t work with the kind of composition you have in your example, you need one which works for higher kinds."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1551975881, "post_id": 55044292, "comment_id": 96847115, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/7040844/applicatives-compose-monads-dont\" title=\"applicatives compose monads dont\">stackoverflow.com/questions/7040844/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1551974033, "post_id": 55046691, "comment_id": 96845943, "body": "distribute aka sequenceA? the types fit (besides the Traversable constraint on <code>g</code>)"}, {"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1551974925, "post_id": 55046691, "comment_id": 96846519, "body": "@WillNess there are various way to distribute functors, e.g. <a href=\"http://hackage.haskell.org/package/distributive-0.6/docs/Data-Distributive.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/distributive-0.6/docs/&hellip;</a> is another one."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551976109, "post_id": 55046691, "comment_id": 96847254, "body": "while this is a good answer, I&#39;m not sure the counterexample is totally convincing given that <code>unsafePerformIO</code> exists, which should be &quot;impossible&quot; for much the same reason."}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551982334, "post_id": 55046691, "comment_id": 96850528, "body": "@RobinZigmond: I think there are two answers to that: (1) We reason about <code>Monad</code> in the total and pure fragment of Haskell \u2013 if we don&#39;t worry about <code>undefined</code>, we certainly don&#39;t worry about <code>unsafePerformIO</code> (especially since <code>unsafePerformIO</code> can be used to implement <code>unsafeCast :: a -&gt; b</code>).  (2) <code>unsafePerformIO</code> doesn&#39;t (I presume) satisfy the laws that, as Matt mentioned, we need for the resulting <code>Monad</code> instance to be lawful."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551983955, "post_id": 55046691, "comment_id": 96851309, "body": "I take your point, that <code>unsafePerformIO</code> is exceptional, because it isn&#39;t a pure function. But <code>IO</code> still satisfies the Monad laws - <code>unsafePerformIO</code> doesn&#39;t change that at all. Of course if we disallow impure functions then there can be no function <code>IO (Maybe a) -&gt; Maybe (IO a)</code> (because there can be no function <code>IO a -&gt; b</code> unless <code>b = IO c</code> for some <code>c</code>). But this still raises the question of whether it is only in the pure subset of Haskell that Monads fail to be closed under composition, or whether there&#39;s some deeper explanation than the need for purity. I don&#39;t know the answer to that!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1551984507, "post_id": 55046691, "comment_id": 96851551, "body": "@RobinZigmond <code>distribute ( getLine &gt;&gt;= (\\s -&gt; if length s &gt; 2 then return (Just s) else return Nothing) ) :: Maybe (IO String)</code>. So it&#39;s a value which <b>already knows</b> what a user <b>will type</b>. If it&#39;s <code>Just act</code>, we can execute that <code>act</code>, and it will magically produce a user which is guaranteed to type in no less than 3 characters! that&#39;s not unsafe I/O, that&#39;s pure magic. // that&#39;s how I understand that argument anyway."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1552037420, "post_id": 55046691, "comment_id": 96868759, "body": "@RobinZigmond I saw your thanks, and you&#39;re welcome. :) wanted to write a longer reply, got distracted -- something about timelines and how this flipping of monads&#39; order is similar to having the &quot;<code>runMonad</code>&quot; function which we don&#39;t have for the IO in the &quot;now&quot;, since it runs strictly in &quot;the future&quot;. something like that."}, {"owner": {"reputation": 195, "user_id": 10891762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a71b4e51a1e940199e9f59075f2e997?s=128&d=identicon&r=PG&f=1", "display_name": "Nirvin M", "link": "https://stackoverflow.com/users/10891762/nirvin-m"}, "edited": false, "score": 0, "creation_date": 1552041160, "post_id": 55046691, "comment_id": 96870707, "body": "Thanks. That explains why the composition should&#39;nt be possible. Is it that the Type System smart enough to prevent this kind of definition or just a coincidence?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1552069834, "post_id": 55046691, "comment_id": 96885474, "body": "A counterexample with a different accent: <code>Const ()</code> and <code>Const Void</code> (in the total fragment) surely do not distribute."}, {"owner": {"reputation": 568, "user_id": 493746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beb35a7c27e7281aa6125e91a9ceec05?s=128&d=identicon&r=PG", "display_name": "dvitek", "link": "https://stackoverflow.com/users/493746/dvitek"}, "edited": false, "score": 0, "creation_date": 1609688818, "post_id": 55046691, "comment_id": 115895113, "body": "I think you may want to explain a bit more the <b>only</b> in &quot;Monads can only compose if ...&quot;.  You argue that monads can compose if we have a distribute, but it&#39;s not clear to me why your argument would show that monads can only compose if we have a distribute."}, {"owner": {"reputation": 316, "user_id": 11166043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5f6ab4ce7e1d88c137b824a774c3033?s=128&d=identicon&r=PG", "display_name": "Matt Noonan", "link": "https://stackoverflow.com/users/11166043/matt-noonan"}, "reply_to_user": {"reputation": 568, "user_id": 493746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beb35a7c27e7281aa6125e91a9ceec05?s=128&d=identicon&r=PG", "display_name": "dvitek", "link": "https://stackoverflow.com/users/493746/dvitek"}, "edited": false, "score": 0, "creation_date": 1609736563, "post_id": 55046691, "comment_id": 115906550, "body": "@dvitek oof, yes, that was sloppy. The &quot;only&quot; is slightly subtle: you can construct a natural transformation with the right type to be a distributive law, but you need a bit more in order to get it to satisfy the correct properties. I&#39;ve added some of the details to the answer."}, {"owner": {"reputation": 568, "user_id": 493746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beb35a7c27e7281aa6125e91a9ceec05?s=128&d=identicon&r=PG", "display_name": "dvitek", "link": "https://stackoverflow.com/users/493746/dvitek"}, "edited": false, "score": 0, "creation_date": 1609801149, "post_id": 55046691, "comment_id": 115931500, "body": "@MattNoonan OK, thanks for clarifying!  That looks roughly like what I had in mind, although your reference to the nLab and the details there about certain compositions being the right things are points I definitely would have overlooked."}], "tags": [], "owner": {"reputation": 316, "user_id": 11166043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5f6ab4ce7e1d88c137b824a774c3033?s=128&d=identicon&r=PG", "display_name": "Matt Noonan", "link": "https://stackoverflow.com/users/11166043/matt-noonan"}, "is_accepted": true, "score": 20, "last_activity_date": 1609737285, "last_edit_date": 1609737285, "creation_date": 1551970409, "answer_id": 55046691, "question_id": 55044292, "link": "https://stackoverflow.com/questions/55044292/why-are-monads-not-closed-under-composition/55046691#55046691", "title": "Why are monads not closed under composition?", "body": "<p>I think this is easiest to understand by looking at the <code>join</code> operator:</p>\n<pre><code>join :: Monad m =&gt; m (m a) -&gt; m a\n</code></pre>\n<p><code>join</code> is an alternative to <code>&gt;&gt;=</code> for defining a <code>Monad</code>, and is a little easier to reason about. (But now you have an exercise to do: show how to implement <code>&gt;&gt;=</code> from <code>join</code>, and how to implement <code>join</code> from <code>&gt;&gt;=</code>!)</p>\n<p>Let's try to make a <code>join</code> operation for <code>Composed f g</code> and see what goes wrong. Our input is essentially a value of type <code>f (g (f (g a)))</code>, and we want to produce a value of type <code>f (g a)</code>. We also know that we have <code>join</code> for <code>f</code> and <code>g</code> individually, so if we could get a value of type <code>f (f (g (g a)))</code>, then we could hit it with <code>fmap join . join</code> to get the <code>f (g a)</code> we wanted.</p>\n<p>Now, <code>f (f (g (g a)))</code> isn't <em>so</em> far from <code>f (g (f (g a)))</code>. All we really need is a function like this: <code>distribute :: g (f a) -&gt; f (g a)</code>. Then we could implement <code>join</code> like this:</p>\n<pre><code>join = Compose . fmap join . join . fmap (distribute . fmap getCompose) . getCompose\n</code></pre>\n<p>Note: there are some laws that we would want <code>distribute</code> to satisfy, in order to make sure that the <code>join</code> we get here is lawful.</p>\n<hr />\n<p>Ok, so that shows how we can compose two monads if we have a <em>distributive law</em> <code>distribute :: (Monad f, Monad g) =&gt; g (f a) -&gt; f (g a)</code>. Now, it <em>could</em> be true that every pair of monads has a distributive law. Maybe we just have to think really hard about how to write one down?</p>\n<p>Unfortunately there <em>are</em> pairs of monads that don't have a distributive law. So we can answer your original question by producing two monads that definitely <em>don't</em> have a way of turning a <code>g (f a)</code> into an <code>f (g a)</code>. These two monads will witness to the fact that monads don't compose in general.</p>\n<p>I claim that <code>g = IO</code> and <code>f = Maybe</code> do not have a distributive law</p>\n<pre><code>-- Impossible!\ndistribute :: IO (Maybe a) -&gt; Maybe (IO a)\n</code></pre>\n<p>Let's think about why such a thing should be impossible. The input to this function is an IO action that goes out into the real world and eventually produces <code>Nothing</code> or a <code>Just x</code>. The output of this function is either <code>Nothing</code>, or <code>Just</code> an IO action that, when run, eventually produces <code>x</code>. To produce the <code>Maybe (IO a)</code>, we would have to peek into the future and predict what the <code>IO (Maybe a)</code> action is going to do!</p>\n<hr />\n<p>In summary:</p>\n<ul>\n<li>Monads can compose if there is a distributive law <code>g (f a) -&gt; f (g a)</code>. (but see the addendum below)</li>\n<li>There are some monads that don't have such a distributive law.</li>\n<li><em>Some</em> monads can compose with each other, but not <em>every</em> pair of monads can compose.</li>\n</ul>\n<hr />\n<p>Addendum: &quot;if&quot;, but what about &quot;only if&quot;? If all three of <code>F</code>, <code>G</code>, and <code>FG</code> are monads, then you can construct a natural transformation <code>\u03b4 : \u2200X. GFX -&gt; FGX</code> as the composition of <code>GF\u03b7_X : GFX -&gt; GFGX</code> followed by <code>\u03b7_{GFGX} : GFGX -&gt; FGFGX</code> and then by <code>\u03bc_X : FGFGX -&gt; FGX</code>. In Haskellese (with explicit type applications for clarity), that would be</p>\n<pre><code>delta :: forall f g x. (Monad f, Monad g, Monad (Compose f g))\n      =&gt; g (f x) -&gt; f (g x)\ndelta = join' . pure @f . fmap @g (fmap @f (pure @g)) \n  where\n    -- join for (f . g), via the `Monad (Compose f g)` instance\n    join' :: f (g (f (g x))) -&gt; f (g x)\n    join' = getCompose . join @(Compose f g) . fmap Compose . Compose\n</code></pre>\n<p>So if the composition <code>FG</code> is a monad, then you can get a natural transformation with the right <em>shape</em> to be a distributive law. However, there are some extra constraints that fall out of making sure your distributive law satisfies the correct properties, vaguely alluded to above. As always, <a href=\"https://golem.ph.utexas.edu/category/2017/02/distributive_laws.html\" rel=\"nofollow noreferrer\">the n-Category Cafe has the gory details</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 169, "user_id": 1325960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gB5mi.jpg?s=128&g=1", "display_name": "Philip Schwarz", "link": "https://stackoverflow.com/users/1325960/philip-schwarz"}, "is_accepted": false, "score": 1, "last_activity_date": 1555255916, "creation_date": 1555255916, "answer_id": 55676998, "question_id": 55044292, "link": "https://stackoverflow.com/questions/55044292/why-are-monads-not-closed-under-composition/55676998#55676998", "title": "Why are monads not closed under composition?", "body": "<p>Monads do not Compose - see here: <a href=\"https://www.slideshare.net/pjschwarz/monads-do-not-compose\" rel=\"nofollow noreferrer\">https://www.slideshare.net/pjschwarz/monads-do-not-compose</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/7IAf2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7IAf2.png\" alt=\"first slide\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/SVCGP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SVCGP.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 195, "user_id": 10891762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a71b4e51a1e940199e9f59075f2e997?s=128&d=identicon&r=PG&f=1", "display_name": "Nirvin M", "link": "https://stackoverflow.com/users/10891762/nirvin-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 757, "favorite_count": 4, "accepted_answer_id": 55046691, "answer_count": 2, "score": 13, "last_activity_date": 1609737285, "creation_date": 1551963223, "last_edit_date": 1592644375, "question_id": 55044292, "link": "https://stackoverflow.com/questions/55044292/why-are-monads-not-closed-under-composition", "title": "Why are monads not closed under composition?", "body": "<p>While I was learning <code>Composing Types</code> chapter from Haskell Book, I was given tasks to write Functor and Applicative instances for the following type.</p>\n<pre><code>newtype Compose f g a = Compose { getCompose :: f (g a) }\n</code></pre>\n<p>I wrote the following definitions</p>\n<h2>Functor:</h2>\n<pre><code>fmap f (Compose fga) = Compose $ (fmap . fmap) f fga\n</code></pre>\n<h2>Applicative:</h2>\n<pre><code>(Compose f) &lt;*&gt; (Compose a) = Compose $ (&lt;*&gt;) &lt;$&gt; f &lt;*&gt; a\n</code></pre>\n<p>I learned that composing two Functors or Applicatives gives Functor and Applicative respectively.</p>\n<p>The author also explained it is not possible to compose two Monads the same way. So we use Monad Transformers. I just do not want to read Monad Transformers unless I'm clear with why Monads do not compose.</p>\n<p>So far I tried to write <code>bind</code> function like this:</p>\n<h2>Monad:</h2>\n<pre><code>(&gt;&gt;=) :: Compose f g a -&gt; (a -&gt; Compose f g b) -&gt; Compose f g b\n(Compose fga) &gt;&gt;= h = (fmap.fmap) h fga\n</code></pre>\n<p>and of course got this error from GHC</p>\n<blockquote>\n<p>Expected type: Compose f g b</p>\n<p>Actual type: f (g (Compose f g b))</p>\n</blockquote>\n<p>If I can strip the outermost <code>f g</code> somehow, the composition gives us a monad right? (I still couldn't figure out how to strip that though)</p>\n<p>I tried reading answers from other Stack Overflow questions like <a href=\"https://stackoverflow.com/questions/29453915/composing-monads-v-applicative-functors\">this</a>, but all answers are more theoretical or some Math. I still haven't learned why Monads do not compose. Can somebody explain me without using Math?</p>\n"}, {"tags": ["haskell", "ghci", "winghci"], "comments": [{"owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 2, "creation_date": 1551962595, "post_id": 55043646, "comment_id": 96838808, "body": "You are reading two things that both don&#39;t mean what you might intuitively think they mean.  In your first message, that does NOT necessarily mean that you had peak usage on 17.6 GB, only that there were 17.8 GB allocated.  Your second message with the Stack Overflow <i>is</i> memory related, but it&#39;s related to the deferred computations that you have.  If you made that strict, you&#39;d have no problems with the same operation."}, {"owner": {"reputation": 101, "user_id": 11052561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f96d20a3e2dd59dc776953439b9be08?s=128&d=identicon&r=PG&f=1", "display_name": "Nick M", "link": "https://stackoverflow.com/users/11052561/nick-m"}, "reply_to_user": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 0, "creation_date": 1551963936, "post_id": 55043646, "comment_id": 96839593, "body": "@Marc Thank you for the explanation on the memory display matter, that does not seem to be confusing now!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1551972138, "post_id": 55043646, "comment_id": 96844726, "body": "I know you mentioned it in your answer, but note that there might be a huge difference between GHCi and compiled code, especially when optimization is turned on. I&#39;d expect your code to run using a constant amount of memory when properly compiled. If the right optimizations kick in, the <code>[1..2*10^8]</code> list cells will not even be allocated, essentially reducing your code to a sort of &quot;for loop&quot; as in imperative languages."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 11052561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f96d20a3e2dd59dc776953439b9be08?s=128&d=identicon&r=PG&f=1", "display_name": "Nick M", "link": "https://stackoverflow.com/users/11052561/nick-m"}, "edited": false, "score": 0, "creation_date": 1551963853, "post_id": 55044103, "comment_id": 96839538, "body": "Thank you for the brief and simple explanation on the matter!  Other than that, is there a (built-in) way to actually measure the peak memory consumption of the process?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 101, "user_id": 11052561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f96d20a3e2dd59dc776953439b9be08?s=128&d=identicon&r=PG&f=1", "display_name": "Nick M", "link": "https://stackoverflow.com/users/11052561/nick-m"}, "edited": false, "score": 1, "creation_date": 1551965727, "post_id": 55044103, "comment_id": 96840713, "body": "@NickM There are external tools like <code>time</code> that will tell you peak memory usage of a process; but you&#39;ll need to run just one thing at a time that way."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 101, "user_id": 11052561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f96d20a3e2dd59dc776953439b9be08?s=128&d=identicon&r=PG&f=1", "display_name": "Nick M", "link": "https://stackoverflow.com/users/11052561/nick-m"}, "edited": false, "score": 1, "creation_date": 1551979315, "post_id": 55044103, "comment_id": 96849033, "body": "@NickM: For detailed analysis, you can also look into GHC\u2019s built-in profiling tools\u2014you can find more about it in the docs, but briefly, you compile your program with profiling enabled (e.g. the <code>--enable-executable-profiling</code> and <code>--enable-library-profiling</code> flags for Stack/Cabal/<code>Setup.hs</code>) then run it with different RTS options to produce different reports (such as <code>+RTS -hy</code> to profile by type) in <code>.hp</code> \u201cheap profile\u201d format, which can be converted for pretty display in a PostScript/PDF viewer using the <code>hp2ps</code> utility."}, {"owner": {"reputation": 101, "user_id": 11052561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f96d20a3e2dd59dc776953439b9be08?s=128&d=identicon&r=PG&f=1", "display_name": "Nick M", "link": "https://stackoverflow.com/users/11052561/nick-m"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1551994512, "post_id": 55044103, "comment_id": 96856041, "body": "@Jon thanks a bunch for pointing out profiling can be performed using the built-in tools, will try to make use of that"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 7, "last_activity_date": 1551962592, "creation_date": 1551962592, "answer_id": 55044103, "question_id": 55043646, "link": "https://stackoverflow.com/questions/55043646/how-is-it-possible-ghci-displays-used-memory-of-bigger-value-than-i-physically-h/55044103#55044103", "title": "How is it possible GHCI displays used memory of bigger value than I physically have?", "body": "<p>The magic of garbage collection: the number reported by <code>:set +s</code> that you show tells the total number of bytes requested from the allocator, even if they were later deallocated and returned to the allocator to be reused before the computation finished.</p>\n"}], "owner": {"reputation": 101, "user_id": 11052561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f96d20a3e2dd59dc776953439b9be08?s=128&d=identicon&r=PG&f=1", "display_name": "Nick M", "link": "https://stackoverflow.com/users/11052561/nick-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 55044103, "answer_count": 1, "score": 6, "last_activity_date": 1551962592, "creation_date": 1551961195, "question_id": 55043646, "link": "https://stackoverflow.com/questions/55043646/how-is-it-possible-ghci-displays-used-memory-of-bigger-value-than-i-physically-h", "title": "How is it possible GHCI displays used memory of bigger value than I physically have?", "body": "<p>The basic question comes along with the quotes from the GHCI interpreter. Yes, I know that the supposed use of code is compiling it into executable, however, as I am a beginner in Haskell, GHCI seems to be perfect to learn some Haskell.</p>\n\n<p>When I use the heavy-computational load algortihms, I sometimes come across messages like the following:</p>\n\n<pre><code>Prelude Data.List&gt; foldl' (+) 0 [1..2*10^8]\n20000000100000000\nit :: (Num b, Enum b) =&gt; b\n(8.35 secs, 17,600,063,056 bytes)\n</code></pre>\n\n<p>At the same time, I only have 8 GB of RAM physically installed.</p>\n\n<p>If memory usage is over a certain limit (which I'm not quite sure how many that is, but suggest that's all memory that can be used), the Stack Overflow exception is thrown, like illustrated below:</p>\n\n<pre><code>Prelude&gt; foldl (+) 0 [1..5 * 10^7]\n*** Exception: stack overflow\n</code></pre>\n\n<p>However, how is it possible that the program uses > 16 GBs of memory while my RAM is totalling to 8 GB and that without throwing Stack Overflow exception?</p>\n"}, {"tags": ["haskell", "property-based-testing", "haskell-hedgehog"], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1551957523, "creation_date": 1551957523, "question_id": 55042556, "link": "https://stackoverflow.com/questions/55042556/what-is-the-effect-of-freeze-in-the-definition-of-hedgehog-gen-list", "title": "What is the effect of freeze in the definition of Hedgehog.Gen.list", "body": "<p><a href=\"http://hackage.haskell.org/package/hedgehog-0.6.1/docs/src/Hedgehog.Internal.Gen.html#list\" rel=\"nofollow noreferrer\"><code>Hedgehog.Gen.list</code></a> is defined as follows:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- | Generates a list using a 'Range' to determine the length.\n--\nlist :: MonadGen m =&gt; Range Int -&gt; m a -&gt; m [a]\nlist range gen =\n  sized $ \\size -&gt;\n    (traverse snd =&lt;&lt;) .\n    ensure (atLeast $ Range.lowerBound size range) .\n    shrink Shrink.list $ do\n      k &lt;- integral_ range\n      replicateM k (freeze gen)\n</code></pre>\n\n<p>I would have expected that using <code>Shrink.list</code> would be enough to produce all the shrinks of the list. However it makes a call to <a href=\"https://www.stackage.org/haddock/lts-13.10/hedgehog-0.6.1/src/Hedgehog.Internal.Gen.html#freeze\" rel=\"nofollow noreferrer\"><code>freeze</code></a>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- | Freeze the size and seed used by a generator, so we can inspect the value\n--   which it will produce.\n--\n--   This is used for implementing `list` and `subtermMVec`. It allows us to\n--   shrink the list itself before trying to shrink the values inside the list.\n--\nfreeze :: MonadGen m =&gt; m a -&gt; m (a, m a)\nfreeze =\n  freezeGen\n</code></pre>\n\n<p>From the function's comments I understand why it is used, but I'm puzzled about how this goal is acheived and what the effect would be of leaving this out.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "edited": false, "score": 0, "creation_date": 1551951883, "post_id": 55040277, "comment_id": 96832158, "body": "What compilation error it gives?"}, {"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "edited": false, "score": 0, "creation_date": 1551951938, "post_id": 55040277, "comment_id": 96832194, "body": "What do you think <code>replicate length x x</code> do? And why you think so?"}, {"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "edited": false, "score": 1, "creation_date": 1551952324, "post_id": 55040277, "comment_id": 96832447, "body": "Your calculation of max length is wrong (try <code>[&quot;aa&quot;, &quot;b&quot;]</code> it give <code>1</code> instead of <code>2</code>)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8902801"}, "reply_to_user": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "edited": false, "score": 0, "creation_date": 1551952426, "post_id": 55040277, "comment_id": 96832522, "body": "i am try now again, will be touch as soon as i did @talex"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8902801"}, "reply_to_user": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "edited": false, "score": 0, "creation_date": 1551952966, "post_id": 55040277, "comment_id": 96832831, "body": "@talex thanks for your contribution!, i shared my solution"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8902801"}, "edited": false, "score": 0, "creation_date": 1551951945, "post_id": 55040566, "comment_id": 96832204, "body": "to getting max items of list is clear, i did as well but the problem is how to determine the number of missed char then add it"}, {"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "edited": false, "score": 0, "creation_date": 1551952076, "post_id": 55040566, "comment_id": 96832294, "body": "@mWelt I extended my ansver."}], "tags": [], "owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "is_accepted": true, "score": 2, "last_activity_date": 1551952046, "last_edit_date": 1551952046, "creation_date": 1551951797, "answer_id": 55040566, "question_id": 55040277, "link": "https://stackoverflow.com/questions/55040277/how-to-make-length-of-items-of-list-same-as-longest-one-in-haskell/55040566#55040566", "title": "how to make length of items of list same as longest one in haskell", "body": "<p>To get max length you can:</p>\n\n<pre><code>maxLength list = maximum $ map length list\n</code></pre>\n\n<p>to duplicate character use <code>replicate</code> (example <code>replicate 3 '*'</code> gives <code>\"***\"</code>).</p>\n\n<p>All you need to do is combine this two methods. </p>\n\n<p>To determine number of missing characters you need to subtract length of string (<code>length \"somestring\"</code> give it to you) from max length.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8902801"}, "is_accepted": false, "score": 3, "last_activity_date": 1551952847, "creation_date": 1551952847, "answer_id": 55040915, "question_id": 55040277, "link": "https://stackoverflow.com/questions/55040277/how-to-make-length-of-items-of-list-same-as-longest-one-in-haskell/55040915#55040915", "title": "how to make length of items of list same as longest one in haskell", "body": "<p>here is the solution with helper function by @talex</p>\n\n<pre><code>longest :: [String] -&gt; Int\nlongest m = maximum $ map length m\n\nmakeSame :: [String] -&gt; [String]\nmakeSame m = map (\\ x -&gt; x ++ replicate (longest m- length x) '*') m \n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8902801"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 55040566, "answer_count": 2, "score": -2, "last_activity_date": 1551952847, "creation_date": 1551950913, "last_edit_date": 1551952457, "question_id": 55040277, "link": "https://stackoverflow.com/questions/55040277/how-to-make-length-of-items-of-list-same-as-longest-one-in-haskell", "title": "how to make length of items of list same as longest one in haskell", "body": "<p>for instance:\n<code>makeSame [\"ab\", \"bad\", \"mammy\"]</code> then the output is <code>[\"ab***\",\"bad**\", \"mammy\"]</code>\nfor each missed char get a <code>'*'</code></p>\n\n<pre><code>makeSame:: [String] -&gt; [String]\nmakeSame m = let f = length  (last (sort m))\n  in \n    (\\x -&gt;replicate length x x ++'*') m\n</code></pre>\n\n<p>but is even not compiling.</p>\n"}, {"tags": ["haskell", "types", "type-inference", "gadt"], "comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1552184279, "post_id": 55036762, "comment_id": 96913294, "body": "<a href=\"https://stackoverflow.com/questions/55077731/printing-church-booleans\" title=\"printing church booleans\">stackoverflow.com/questions/55077731/printing-church-boolean&zwnj;&#8203;s</a> q &amp; answer seems to apply: the instance here returning <code>ToTerm i</code> is not allowing just any type for <code>c</code>. OTOH it is allowing any type that meets the <code>IsTerm a c =&gt;</code> constraint on method <code>eval</code>. So(?) GHC is ignoring the constraint? Or isn&#39;t clever enough to see the constraint has a FunDep that improves <code>c</code> to exactly the type of <code>ToTerm i</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1551996262, "post_id": 55048814, "comment_id": 96856746, "body": "&quot;It can&#39;t  ... I don&#39;t know why&quot;. Other qs on <code>rigid type variable</code>s suggest I need a RHS of type no less general than bare <code>c</code>. So is the <code>IsTerm</code> constraint just ignored? Your suggestion of associated TF <code>TermType</code> seems even more verbose than my top-level TF <code>ToTerm</code>; why make it associated? What I mean by &quot;large contexts&quot; is for <code>data If b a1 a2 = ...</code> whose <code>Eval</code> instance requires <code>IsTerm b (Term Bool)</code> and the Term type of <code>a1, a2</code> to be the same, and that&#39;s the type of the result. The instance for a two-param <code>Eval</code> is more succinct, even with the repetition."}], "tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": false, "score": 1, "last_activity_date": 1551977677, "last_edit_date": 1551977677, "creation_date": 1551976798, "answer_id": 55048814, "question_id": 55036762, "link": "https://stackoverflow.com/questions/55036762/rigid-type-variable-trouble-suspect-impredicativity/55048814#55048814", "title": "rigid type variable trouble/suspect Impredicativity", "body": "<blockquote>\n  <p>If GHC can infer (via the FunDep) that c must be Term Int for = undefined</p>\n</blockquote>\n\n<p>It can't. If you try <code>undefined :: Term Int</code>, you'll get the same rigid type variable error. If you use a typed hole <code>= _undefined</code> you'll see it's inferring <code>undefined :: c</code>. I don't know why, but the functional dependency only seems to be used when <em>applying</em> <code>eval</code> to <code>Lit</code>, not when defining it.</p>\n\n<p>What about this?</p>\n\n<pre><code>class IsTerm a where\n  type TermType a :: *\ninstance IsTerm Lit where\n  type TermType Lit = Int\ninstance IsTerm a =&gt; IsTerm (Inc a) where\n  type TermType (Inc a) = TermType a\n\nclass IsTerm a =&gt; Eval a   \n  where eval :: a -&gt; Term (TermType a) \n\ninstance Eval Lit  where    \n         eval (Lit i) = ToTerm i\n\n-- needs UndecidableInstances\ninstance (Eval a, Num (TermType a)) =&gt; Eval (Inc a)  where    \n         eval (Inc i) = ToTerm (fromTerm (eval i) + 1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "is_accepted": false, "score": 0, "last_activity_date": 1552273583, "creation_date": 1552273583, "answer_id": 55094722, "question_id": 55036762, "link": "https://stackoverflow.com/questions/55036762/rigid-type-variable-trouble-suspect-impredicativity/55094722#55094722", "title": "rigid type variable trouble/suspect Impredicativity", "body": "<p>Note that the <code>IsTerm</code> constraint is on method <code>eval</code>, not a superclass constraint on <code>Eval</code> -- it couldn't be there because the return type <code>c</code> of <code>eval</code> is not a parameter to the class.</p>\n\n<p>Then it's misleading to consider <code>instance Eval Lit</code> in isolation. Consider the instance for <code>Inc</code>, and its instance for <code>IsTerm</code>:</p>\n\n<pre><code>instance ( {-# tba #-} ) =&gt; Eval (Inc a)  where\n  eval (Inc i) = ToTerm $ 1 + fromTerm (eval i)\n\ninstance (IsTerm a (Term int)) =&gt; IsTerm (Inc a) (Term Int)\n</code></pre>\n\n<p>What should that <code>tba</code> constraint include?</p>\n\n<ul>\n<li>The method body has a recursive call to <code>eval</code>, so it needs <code>Eval a</code> for that.</li>\n<li>The method body's <code>1 + ... eval ...</code> needs <code>eval</code> to return an <code>Int</code>, but the <code>Eval</code> constraint doesn't provide that (because it doesn't mention the return type).</li>\n<li>Could a constraint <code>IsTerm a (Term Int)</code> provide it? No: <code>IsTerm</code> is (at best) implied by <code>Eval</code>, not the other way round.</li>\n</ul>\n\n<p>So the only way this could hang together without a lot of duplication is if:</p>\n\n<ul>\n<li>The compiler saw the recursive call to <code>eval</code>; magically added an <code>IsTerm a c1</code> constraint for it; found the applicable instance of <code>IsTerm</code> for <code>a</code>; and then figured out that <code>IsTerm</code> instance yielded <code>c1 ~ Term Int</code>.</li>\n<li>But if all it has is bare <code>a</code>, there's no way to know which instance. So leave the constraint as Wanted pending getting <code>eval</code> applied to <code>(Inc x)</code> for some term <code>x</code>?</li>\n</ul>\n\n<p>Contrast that in the GADT definition for <code>Inc</code>, its argument needs to be <code>Term Int</code>. This is the straitjacket that prevents an EDSL user entering an ill-typed term:</p>\n\n<pre><code>  Inc :: Term Int -&gt; Term Int\n</code></pre>\n\n<p>As to the specific rejection message for the <code>instance Eval Lit</code>, I think Hugs' wording makes it clearer:</p>\n\n<pre><code>- Inferred type is not general enough\n*** Expression    : eval\n*** Expected type : (Eval Lit, IsTerm Lit a) =&gt; Lit -&gt; a\n*** Inferred type : (Eval Lit, IsTerm Lit (Term Int)) =&gt; Lit -&gt; Term Int\n</code></pre>\n\n<p>The 'Expected type' is the method's signature with the instance head substituted in. To typecheck a method body whose type is not 'general enough' would need:</p>\n\n<ol>\n<li>seeing the method's constraint as part of checking the method's body;</li>\n<li>seeing that the class for that constraint has a FunDep, and that it improves the return type from the argument type;</li>\n<li>finding the applicable instance of <code>IsTerm</code> for the instance of <code>Eval</code> (and instances for any constraints on that instance, recursively);</li>\n<li>improving <code>c</code> to <code>Term int</code> via the FunDep.</li>\n</ol>\n\n<p>Step 3. in particular is too much to expect: the applicable instance(s) might be declared in a separate module, which is not in scope; in general (unlike this example) it might need an instance for a type scheme/the available instances might be more specific or more general/can't be picked until types are more refined.</p>\n\n<p>But I do have an outstanding question:</p>\n\n<ul>\n<li>If the type of the method's body is more specific than inferred by substituting in the instance head, what goes wrong?</li>\n<li>The inferred type in the Hugs message is more specific, but also carries the constraints, so they must be discharged for the program to be accepted.</li>\n<li>If the caller of <code>eval</code> is expecting a more general type, the more specific result can substitute in.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "is_accepted": false, "score": 0, "last_activity_date": 1553407174, "creation_date": 1553407174, "answer_id": 55321132, "question_id": 55036762, "link": "https://stackoverflow.com/questions/55036762/rigid-type-variable-trouble-suspect-impredicativity/55321132#55321132", "title": "rigid type variable trouble/suspect Impredicativity", "body": "<p>I'm posting another answer because it's quite a surprise/a rare beast: code that compiles under Hugs and works; but doesn't compile under GHC (8.6.4). That is unless someone here can see I've gone wrong and can fix it up.</p>\n\n<p>Consider first the <strong>Addit:</strong> example from the 2011 paper. This achieves it in Hugs only (WinHugs 'latest' release Sep 2006)</p>\n\n<pre><code>class F a b | a -&gt; b\ninstance F Int Bool\n\nclass D a where { op :: (F a b) =&gt; a -&gt; b } \ninstance (TypeCast Bool b') =&gt; D Int where { op _ = typeCast True }\n</code></pre>\n\n<p>That code is same as in the paper except for the <code>instance D Int</code>. I've added a <code>TypeCast</code> constraint (and call to its method), which looks weird because type variable <code>b'</code> isn't used anywhere.</p>\n\n<p>I've tried various ways round to get that to compile in GHC:</p>\n\n<ul>\n<li>The <code>TypeCast</code> is approximately equal to GHC's <code>~</code> constraint, which is not a feature in Hugs; but changing it to <code>~</code> won't get GHC to accept the code.</li>\n<li>I've tried various type annotations, including with <code>ScopedTypeVariables</code>. Nada.</li>\n</ul>\n\n<p>See <a href=\"https://gitlab.haskell.org/ghc/ghc/issues/16430#note_189393\" rel=\"nofollow noreferrer\">Trac #16430</a> for more details, including the definition for <code>TypeCast</code> -- which is entirely standard.</p>\n\n<p>Then the code for the original q here goes like this (Hugs only)</p>\n\n<pre><code>class    Eval a   where\n         eval :: (IsTerm a c) =&gt; a -&gt; c \n\ninstance (TypeCast (Term Int) c') =&gt; Eval Lit  where\n         eval (Lit i) = typeCast (ToTerm i)       -- rejected without typeCast\n\ninstance (Eval a, IsTerm a (Term Int), TypeCast (Term Int) c')\n         =&gt; Eval (Inc a)  where\n         eval (Inc i) = typeCast (ToTerm $ 1 + fromTerm (eval i))\ninstance (Eval a, IsTerm a (Term Int), TypeCast (Term Bool) c') \n         =&gt; Eval (IsZ a)  where\n         eval (IsZ i) = typeCast (ToTerm $ 0 == fromTerm (eval i))\n</code></pre>\n\n<p><code>eval aTerm</code> (see the q above) now returns <code>(ToTerm False)</code>; <code>eval illtypedTerm</code> gives a rejection message, as expected.</p>\n\n<p>All of those instances feature that <code>TypeCast</code> to a dangling type variable (if \"feature\" is the right word). It's debatable whether I've achieved any saving of duplicated code as against making <code>Eval</code> a class with two parameters that just repeats from <code>IsTerm</code>.</p>\n"}], "owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "answer_count": 3, "score": 7, "last_activity_date": 1553407174, "creation_date": 1551937135, "last_edit_date": 1552480817, "question_id": 55036762, "link": "https://stackoverflow.com/questions/55036762/rigid-type-variable-trouble-suspect-impredicativity", "title": "rigid type variable trouble/suspect Impredicativity", "body": "<p>Following on from <a href=\"https://stackoverflow.com/questions/54919548/gadts-for-a-dsl-swings-and-roundabouts\">this q about GADTs</a>, I'm trying to build an EDSL (for the example in the paper) but without GADTs. I have got something working that avoids doubling-up the datatypes for the AST; but instead it seems to be doubling-up the code. So I tried trimming down the code, which is where I've run into trouble ...</p>\n\n<p>Instead of a GADT like so</p>\n\n<pre><code>data Term a where\n  Lit ::      Int -&gt; Term Int\n  Inc :: Term Int -&gt; Term Int\n  IsZ :: Term Int -&gt; Term Bool\n  -- etc\n</code></pre>\n\n<p>declare each constructor as a separate datatype</p>\n\n<pre><code>data Lit   = Lit Int  deriving (Show, Read)\ndata Inc a = Inc a    deriving (Show, Read)\ndata IsZ a = IsZ a    deriving (Show, Read)\n-- etc\n</code></pre>\n\n<p>Then the EDSL user can enter and <code>show</code> terms</p>\n\n<pre><code>aTerm = IsZ (Inc (Lit 5))\n\nilltypedTerm = Inc (IsZ (Lit 5))    -- accepted OK and can show\n                                    -- but can't eval [good!]\n</code></pre>\n\n<p>Then to catch that they're all <code>Term</code>s and need to be well-typed</p>\n\n<pre><code>data Term a = ToTerm { fromTerm :: a} deriving (Show, Eq)\n\nclass IsTerm a c  | a -&gt; c \ninstance IsTerm Lit (Term Int) \n-- etc\n</code></pre>\n\n<p>The FunDep captures the return type from the original GADT. Then <code>eval</code> can use that <code>Term</code> type</p>\n\n<pre><code>class Eval a   \n  where eval :: (IsTerm a c) =&gt; a -&gt; c \n                             -- hmm this makes 'c' a rigid tyvar\ninstance Eval Lit  where    \n         eval (Lit i) = -- undefined     -- accepted OK, infers :: Term Int\n                        ToTerm i         -- rejected\n</code></pre>\n\n<p>The equation <code>eval (Lit i) = undefined</code> (commented out) compiles OK, and GHC infers <code>eval (Lit 5) :: Term Int</code>. But if I put <code>= ToTerm i</code>:</p>\n\n<pre><code>* Couldn't match expected type `c' with actual type `Term Int'\n  `c' is a rigid type variable bound by\n    the type signature for:\n      eval :: forall c. IsTerm Lit c =&gt; Lit -&gt; c\n* Relevant bindings include\n    eval :: Lit -&gt; c\n</code></pre>\n\n<p>If GHC can infer (via the FunDep) that <code>c</code> must be <code>Term Int</code> for <code>= undefined</code>, why can't it for <code>= ToTerm i</code>? Is the specialised type sig it's inferred <code>eval :: forall c. IsTerm Lit c =&gt; Lit -&gt; c</code> Impredicative? But <code>c</code> is the return type, so it's not RankN(?)</p>\n\n<p>What avoids this error? I do have working</p>\n\n<ul>\n<li><p><code>class (IsTerm a c) =&gt; Eval a c  | a -&gt; c  where ...</code> this just duplicates all the instance heads from <code>IsTerm</code>, so the superclass constraint is only acting as belt and braces. (That's the doubling-up I was trying to avoid.)</p></li>\n<li><p><code>type family ToTerm a ...; class Eval a  where eval :: a -&gt; ToTerm a</code>. But again the instances for <code>Eval</code> double-up all the instances for <code>ToTerm</code>, and furthermore need large contexts with many <code>~</code> constraints between <code>ToTerm</code> calls.</p></li>\n</ul>\n\n<p>I could just throw away class <code>IsTerm</code>, and put all the Term-inference on class <code>Eval</code>. But I was trying to closely mirror the GADT style such that I might have many application 'clients' sharing the same definition for Term.</p>\n\n<p><strong>Addit:</strong> [March 14]</p>\n\n<p>The 2011 paper <a href=\"https://www.microsoft.com/en-us/research/wp-content/uploads/2007/01/tldi22-sulzmann-with-appendix.pdf?from=http%3A%2F%2Fresearch.microsoft.com%2Fen-us%2Fum%2Fpeople%2Fsimonpj%2Fpapers%2Fext-f%2Ftldi22-sulzmann-with-appendix.pdf\" rel=\"nofollow noreferrer\">System F with Type Equality Coercions</a>, Section 2.3, has this example (in discussing Functional Dependencies)</p>\n\n<pre><code>class F a b | a -&gt; b\ninstance F Int Bool\n\nclass D a where { op :: F a b =&gt; a -&gt; b }\ninstance D Int where { op _ = True }\n</code></pre>\n\n<blockquote>\n  <p>Using FC, this problem [of typing the definition of <code>op</code> in the instance <code>D Int</code>] is easily solved: the coercion in the dictionary for <code>F</code> enables the result of <code>op</code> to be cast to type <code>b</code> as required.</p>\n</blockquote>\n\n<ul>\n<li><p>This example seems to be the same as the q, with class <code>F</code>, with FunDep, being <code>IsTerm</code> and class <code>D</code> being <code>Eval</code>.</p></li>\n<li><p>This example doesn't compile: gives the same rejection as <code>IsTerm/Eval</code>.</p></li>\n</ul>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1551925503, "post_id": 55034963, "comment_id": 96822545, "body": "The code of <code>sumAge</code> looks fine to me. What&#39;s the problem that you see?"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1551937344, "post_id": 55034963, "comment_id": 96825372, "body": "Try <code>sumAge _ ages = foldl (+) 0 ages</code> - your current pattern <code>[b, c]</code> only matches two-element lists. Also, what&#39;s the unused parameter for?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1551941808, "post_id": 55034963, "comment_id": 96826858, "body": "The average is just the sum divided by the length. Each of those can be implemented by a fold, but the average itself can&#39;t. (Unless you do both folds &quot;at once&quot; by having it return a tuple, then combine the two elements at the end m)"}, {"owner": {"reputation": 325, "user_id": 10759740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa69b17ab54deb4330b263ea093c485?s=128&d=identicon&r=PG&f=1", "display_name": "R Y", "link": "https://stackoverflow.com/users/10759740/r-y"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1552076837, "post_id": 55034963, "comment_id": 96888642, "body": "@RobinZigmond You can use the recursive formula for average values of a sequence to use a fold instead of a tuple, since <code>m[i+1] = (i * m[i] + x[i+1]) &#47; (i+1)</code>, but it does require using a sequence instead of a list so you can access indices."}], "answers": [{"comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1551976267, "post_id": 55046321, "comment_id": 96847343, "body": "Don&#39;t you need to use <code>fromIntegral</code> on both numerator and denominator in order for the division to compile? (And the return type should of course be <code>Double</code> or similar, not <code>Int</code>.)"}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551976983, "post_id": 55046321, "comment_id": 96847731, "body": "That is true, edited my answer. But I&#39;d say it makes sense for the age to be a double so no need for <code>fromIntegral</code>?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551977207, "post_id": 55046321, "comment_id": 96847860, "body": "True, in that case you don&#39;t need it. But then it&#39;s perfectly common to want to average a list of integers, and indeed people generally refer to ages as whole numbers."}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551977394, "post_id": 55046321, "comment_id": 96847981, "body": "I thought they might want to be more precise with animals as they are usually smaller ages, but ill put that in the answer"}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": true, "score": 2, "last_activity_date": 1551977489, "last_edit_date": 1551977489, "creation_date": 1551969360, "answer_id": 55046321, "question_id": 55034963, "link": "https://stackoverflow.com/questions/55034963/averaging-ages-across-a-list-with-foldl-haskell/55046321#55046321", "title": "Averaging ages across a list with foldl (Haskell)", "body": "<p>The code for your sum looks fine, I'd use <code>foldl'</code> instead of <code>foldl</code> so you don't risk a stack overflow, and also change that <code>[b,c]</code> pattern to a generic variable or even better point free so it looks better and it's also more general:</p>\n\n<pre><code>sumAge :: [Double] -&gt; [Double]\nsumAge = foldl' (+) 0\n</code></pre>\n\n<p>As for the average, you just sum and divide by the length:</p>\n\n<pre><code>averageAge :: [Double] -&gt; Double\naverageAge ls = sumAge ls / length ls\n</code></pre>\n\n<p>PS. In case your ages are integer, then the first function still works, but the average need to change:</p>\n\n<pre><code>averageInt :: [Int] -&gt; Double\naverageInt ls = (fromInteger . sum) ls / (fromInteger . length) ls\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1551983843, "post_id": 55050504, "comment_id": 96851254, "body": "or we could delay the calculations, use a pair as an accumulator, and put it through <code>uncurry (&#47;)</code> as one post-processing step. your approach is great if we use it with <code>scanl</code>, not <code>foldl</code>."}], "tags": [], "owner": {"reputation": 325, "user_id": 10759740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa69b17ab54deb4330b263ea093c485?s=128&d=identicon&r=PG&f=1", "display_name": "R Y", "link": "https://stackoverflow.com/users/10759740/r-y"}, "is_accepted": false, "score": 2, "last_activity_date": 1551987544, "last_edit_date": 1551987544, "creation_date": 1551983186, "answer_id": 55050504, "question_id": 55034963, "link": "https://stackoverflow.com/questions/55034963/averaging-ages-across-a-list-with-foldl-haskell/55050504#55050504", "title": "Averaging ages across a list with foldl (Haskell)", "body": "<h2>TL;DR version</h2>\n\n<ul>\n<li>Sum: <code>sumAges animals = foldl (\\age animal -&gt; age + (getAge animal)) 0 animals</code></li>\n<li>Average:</li>\n</ul>\n\n<pre><code>import Data.Sequence(foldlWithIndex, fromList)\n\naverage numbers = foldlWithIndex (\\a i x -&gt; let k = fromIntegral i in (k*a + x) / (k + 1)) 0 . fromList $ numbers\n</code></pre>\n\n<h2>Long version</h2>\n\n<p>If you have an interest in math, it may help to understand the design of fold functions as equivalent to discovering sequence formulas by induction.</p>\n\n<h3>Sum</h3>\n\n<p>For sum, since you have <code>s[i+1] = s[i] + x[i+1]</code>, you can simply use addition like you did, although you may have to convert before you add:</p>\n\n<pre><code>sumAges :: [Animal] -&gt; Int\nsumAges animals = foldl (\\age animal -&gt; age + (getAge animal)) 0 animals\n\nsumAgesPointFree :: [Animal] -&gt; Int\nsumAgesPointFree = foldl (flip $ (+) . getAge) 0\n</code></pre>\n\n<h3>Average</h3>\n\n<p>For example, one way to calculate the average of a list using a single fold function is to use a recursive mathematical version of calculating the rolling average of a sequence: <code>m[i+1] = (i * m[i] + x[i+1]) / (i + 1)</code>.  You can see this in how you calculate the average of lists of varying sizes:</p>\n\n<pre><code>{-\n  Not Haskell, just attempting mathematical notation without knowing MathML in Markdown.\n\n  m: mean or average\n  x: an element of a list or sequence\n  []: subscript\n -}\nm[1] = x[1]\nm[2] = (x[1] + x[2]) / 2 = (m[1] + x[2]) / 2     -- m[1] = x[1], so substitute\nm[3] = (x[1] + x[2] + x[3]) / 3                  -- (a+b)/n = a/n + b/n, so distribute\n   = (x[1] + x[2]) / 3 + x[3] / 3                -- a = n/n * a, n not in {0, Infinity}\n   = 2/2 * (x[1] + x[2]) / 3 + x[3] / 3          -- n/n * 1/a = n/a * 1/n\n   = 2/3 * (x[1] + x[2]) / 2 + x[3] / 3          -- m[2] = (x[1] + x[2])/2, so substitute\n   = 2/3 * m[2] + x[3] / 3\n   = 2*m[2] / 3 + x[3] / 3\n   = (2*m[2] + x[3]) / 3\n...\nm[i+1] = (i * m[i] + x[i+1]) / (i+1)\n</code></pre>\n\n<p>However, since this function would require the element index as a parameter, due to the List structure's lack of (convenient) indexing, the Sequence type from the <code>Data.Sequence</code> module may work out better than a List, especially considering the <code>Data.Sequence</code> module has this really nice <code>foldlWithIndex</code> function:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>module Average(average) where\n  import Data.Sequence(foldlWithIndex, fromList)\n\n  average :: Fractional a =&gt; [a] -&gt; a\n  average = foldlWithIndex averageByPrevious 0 . fromList\n    where averageByPrevious previous index current = (coefficient*previous + current) / (coefficient + 1)\n            where coefficient = fromIntegral index\n</code></pre>\n\n<p>Then you can simply run <code>average list</code> where list is some list you want to find the rolling average of.  This is one way to calculate the average of a list using a single fold without adding a large performance overhead as you would by running multiple O(n) functions over the same list, even considering laziness as a benefit to the performance of multiple calls.</p>\n\n<p><strong>NOTE</strong>: I will admit, this is not easy to read, so <code>average xs = (sum xs) / (length xs)</code> as @Lorenzo said will work much better if legibility is more important than performance here.</p>\n"}], "owner": {"reputation": 677, "user_id": 2636579, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b615adca01077d21372bbbed1b998617?s=128&d=identicon&r=PG", "display_name": "reallymemorable", "link": "https://stackoverflow.com/users/2636579/reallymemorable"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 55046321, "answer_count": 2, "score": 0, "last_activity_date": 1551987544, "creation_date": 1551924416, "question_id": 55034963, "link": "https://stackoverflow.com/questions/55034963/averaging-ages-across-a-list-with-foldl-haskell", "title": "Averaging ages across a list with foldl (Haskell)", "body": "<p>I am doing some arbitrary operations in Haskell as I learn, and have been playing with a list of animals with certain properties, including age.</p>\n\n<p>This is my script:</p>\n\n<pre><code>module Animals where\n\ndata Animal = CatThing String Int\n            | DogThing String Int\n            deriving Show\n\nanimalList :: [Animal]\nanimalList = [CatThing \"Spot\" 2, DogThing \"Rex\" 5]\n\n-- write a function that returns the string component given an animal\ngetName :: Animal -&gt; String\ngetName (CatThing name _) = name\ngetName (DogThing name _) = name \n\n-- get the age of an animal (uses \"map\")\ngetAge :: Animal -&gt; Int\ngetAge (CatThing _ age) = age\ngetAge (DogThing _ age) = age\n\n-- sum age\nsumAge :: Int -&gt; [Int] -&gt; Int\nsumAge _ [b, c] = foldl (+) 0 [b, c]\n\n-- average age\n???\n</code></pre>\n\n<p>I am stuck on how to sum using <code>foldl'</code>.  I know there is a <code>sum</code> function built in, but I am really trying to practice folds, so am trying to do it that way.</p>\n\n<p>Does anyone have suggestions on how to proceed?</p>\n"}, {"tags": ["haskell", "context-free-grammar"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1551927027, "post_id": 55034680, "comment_id": 96822878, "body": "<code>Grammar</code> isn&#39;t a type that&#39;s built in to Haskell. Please post its definition."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11034844"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1551927582, "post_id": 55034680, "comment_id": 96822985, "body": "Sorry about that. Just fixed it."}], "answers": [{"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1551928049, "creation_date": 1551928049, "answer_id": 55035441, "question_id": 55034680, "link": "https://stackoverflow.com/questions/55034680/finding-distinct-terminal-and-nonterminals-symbols/55035441#55035441", "title": "Finding Distinct Terminal and Nonterminals Symbols", "body": "<pre><code>terminals :: Grammar -&gt; [String]                                          \nterminals ts = nub [ x | x &lt;-ts]\n</code></pre>\n\n<p>Your function <code>terminals</code> is typed as returning a <code>[String]</code>. Its implementation returns the result of <code>nub</code>. <code>nub</code> has type <code>Eq a =&gt; [a] -&gt; [a]</code>, so for it to return a <code>[String]</code>, its input must be a <code>[String]</code> as well. This implies that <code>[ x | x &lt;-ts]</code> must be of type <code>[String]</code>, and then that <code>x</code> must be of type <code>String</code>. Doing <code>x &lt;- ts</code> in a list comprehension means that <code>ts</code> must be a list of whatever type <code>x</code> is, so in this case, <code>ts</code> must be <code>[String]</code>.</p>\n\n<p>Now the problem becomes apparent. Given the type of the output of your function and its implementation, <code>ts</code> must be of type <code>[String]</code>, but given the type of the input of your function, <code>ts</code> must be of type <code>Grammar</code>. Since <code>[String]</code> and <code>Grammar</code> are different types, this causes the type error that you're seeing.</p>\n\n<p>Side note: <code>[ x | x &lt;-ts]</code> is exactly equivalent to just <code>ts</code>, and <code>[ x | x &lt;- nt]</code> is exactly equivalent to just <code>nt</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11034844"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1551945405, "creation_date": 1551922072, "last_edit_date": 1551945405, "question_id": 55034680, "link": "https://stackoverflow.com/questions/55034680/finding-distinct-terminal-and-nonterminals-symbols", "title": "Finding Distinct Terminal and Nonterminals Symbols", "body": "<p>I am currently working on writing two functions that will be used to return lists of all distinct terminals that appear in a given grammar. </p>\n\n<p>Here is the type for Grammar : </p>\n\n<pre><code>data Grammar = Grammar [Prod]\n               deriving (Show, Eq)\n</code></pre>\n\n<p>Here is what I have so far : </p>\n\n<pre><code>terminals :: Grammar -&gt; [String]                                          \nterminals ts = nub [ x | x &lt;-ts]\n\nnonterms  :: Grammar -&gt; [String]\nnonterms nt = nub [ x | x &lt;- nt]\n</code></pre>\n\n<p>Where the grammar that is being placed into the function would be something like this (3 Examples) :</p>\n\n<pre><code>g4 = \"P -&gt; true ; P -&gt; false; P -&gt; not P ; P -&gt; P and P\"\ng5 = \"P -&gt; P &amp; N; P -&gt; N; N -&gt; ~ N; N -&gt; t\"                                   \ng6 = \"P -&gt; N &amp; P; P -&gt; N; N -&gt; ~ N; N -&gt; t\"\n</code></pre>\n\n<p>However though, the functions that I am using do not work because GHCI could not match expected type \u2018[String]\u2019 with actual type \u2018Grammar\u2019.</p>\n\n<p>I am going off of the basic principles of Context-free grammars (CFGs), that a context-free grammar is</p>\n\n<pre><code> G = (T,N,P,S)\n</code></pre>\n\n<p>Where T is a set T of terminal symbols (\"tokens\"), a set N of nonterminal symbols, a set P of productions, and a start symbol S.</p>\n\n<p>How could I use / write two functions that could return lists of all the distinct terminals (respectively nonterminals) that appear in a given grammar. Three examples of grammars above. Thank you.</p>\n"}]