[{"tags": ["haskell"], "comments": [{"owner": {"reputation": 18780, "user_id": 683218, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/7Vy7c.png?s=128&g=1", "display_name": "tinlyx", "link": "https://stackoverflow.com/users/683218/tinlyx"}, "edited": false, "score": 0, "creation_date": 1452725134, "post_id": 34778469, "comment_id": 57302015, "body": "@luqui sure , this is shorter."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1452725157, "post_id": 34778469, "comment_id": 57302024, "body": "Oh I deleted it.  For future reference, it was <code>isEqualOn f x y = comparing f x y == EQ</code>."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1452725220, "post_id": 34778469, "comment_id": 57302058, "body": "And in general you have the function <code>(== EQ) :: Ordering -&gt; Bool</code>, and having a function which gets you from where you are to where you want to be is basically the most compositional thing you can have (though you might find it notationally inconvenient until you get more comfortable with working with composition)"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1452725314, "post_id": 34778469, "comment_id": 57302107, "body": "<code>isEqualOn = (result.result.result) (== EQ)</code> using the <a href=\"http://conal.net/blog/posts/semantic-editor-combinators\" rel=\"nofollow noreferrer\">SEC</a> approach.  See that link or <a href=\"http://stackoverflow.com/questions/413930/how-to-compose-not-with-a-function-of-arbitrary-arity/415154\">this answer</a> for more."}, {"owner": {"reputation": 18780, "user_id": 683218, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/7Vy7c.png?s=128&g=1", "display_name": "tinlyx", "link": "https://stackoverflow.com/users/683218/tinlyx"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1452727389, "post_id": 34778469, "comment_id": 57302889, "body": "@luqui The SEC approach seems to be the right answer. If you write an answer about it in this case, I&#39;ll accept it."}, {"owner": {"reputation": 1562, "user_id": 854868, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b567cc07672322c6bac131f67f60f69?s=128&d=identicon&r=PG", "display_name": "Andras Gyomrey", "link": "https://stackoverflow.com/users/854868/andras-gyomrey"}, "edited": false, "score": 0, "creation_date": 1453801802, "post_id": 34778469, "comment_id": 57749080, "body": "<i>my question is about the general technique to change function return types</i> pay attention: you are asking for function composition. You don&#39;t like <code>a -&gt; b</code> because you want <code>c</code>? write your <code>b -&gt; c</code> function and compose those two to get <code>a -&gt; c</code>. That&#39;s exactly what your answer suggests. There&#39;s not much more to it."}, {"owner": {"reputation": 18780, "user_id": 683218, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/7Vy7c.png?s=128&g=1", "display_name": "tinlyx", "link": "https://stackoverflow.com/users/683218/tinlyx"}, "reply_to_user": {"reputation": 1562, "user_id": 854868, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b567cc07672322c6bac131f67f60f69?s=128&d=identicon&r=PG", "display_name": "Andras Gyomrey", "link": "https://stackoverflow.com/users/854868/andras-gyomrey"}, "edited": false, "score": 1, "creation_date": 1453806320, "post_id": 34778469, "comment_id": 57751683, "body": "@AndrasGyomrey Note, that the type of the function to be changed is <i>not</i> <code>a -&gt; b</code> (i.e. not unary), but <code>a -&gt; b (-&gt;...) -&gt; c</code>. It is to be changed to <code>a -&gt; b (-&gt; ...) -&gt; d</code>. The only thing I&#39;ve seen doing it is the SEC approach linked in the comments. It takes some digestion though."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1452725756, "post_id": 34778598, "comment_id": 57302294, "body": "<code>on</code> is more commonly written as an infix: <code>((==)`on`abs) 2 (-2)</code>. Or, of course more relevant is an example like <code>groupBy ((==)`on`abs) [1,2,-2,-3,3,4]</code>, which gives <code>[[1],[2,-2],[-3,3],[4]]</code>."}, {"owner": {"reputation": 18780, "user_id": 683218, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/7Vy7c.png?s=128&g=1", "display_name": "tinlyx", "link": "https://stackoverflow.com/users/683218/tinlyx"}, "edited": false, "score": 0, "creation_date": 1452725808, "post_id": 34778598, "comment_id": 57302310, "body": "Thanks. But I am interested in the general approach to convert functions. For example, I may need to derive a <code>less</code> predicate out of <code>comparing</code> by changing the return type. :)  (That&#39;s why I used bold font on &quot;for example&quot;)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1452725849, "post_id": 34778598, "comment_id": 57302333, "body": "I think of &quot;on&quot; as a preposition, so I always use <code>on</code> infix; I&#39;d write <code>(==) `on` f</code> instead of <code>on (==) f</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1452725876, "post_id": 34778598, "comment_id": 57302344, "body": "Ha, @leftaroundabout beat me to the punch again."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 18780, "user_id": 683218, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/7Vy7c.png?s=128&g=1", "display_name": "tinlyx", "link": "https://stackoverflow.com/users/683218/tinlyx"}, "edited": false, "score": 2, "creation_date": 1452726383, "post_id": 34778598, "comment_id": 57302520, "body": "@tinlyx Besides the compositional approaches that actually call <code>comparing</code> given in the comments to your question, you should seriously consider this answer for your actual code. It is easy to adapt to a <code>less</code> predicate: just use <code>on (&lt;)</code> instead."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 18780, "user_id": 683218, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/7Vy7c.png?s=128&g=1", "display_name": "tinlyx", "link": "https://stackoverflow.com/users/683218/tinlyx"}, "edited": false, "score": 0, "creation_date": 1452726552, "post_id": 34778598, "comment_id": 57302588, "body": "@tinlyx luqui&#39;s comments do answer the real question, in my opinion."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 18780, "user_id": 683218, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/7Vy7c.png?s=128&g=1", "display_name": "tinlyx", "link": "https://stackoverflow.com/users/683218/tinlyx"}, "edited": false, "score": 0, "creation_date": 1452726629, "post_id": 34778598, "comment_id": 57302612, "body": "@tinlyx And luqui&#39;s comments show how to adapt a function by the return type to get a new function."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 18780, "user_id": 683218, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/7Vy7c.png?s=128&g=1", "display_name": "tinlyx", "link": "https://stackoverflow.com/users/683218/tinlyx"}, "edited": false, "score": 1, "creation_date": 1452743401, "post_id": 34778598, "comment_id": 57307563, "body": "@tinlyx, in practice, it tends to pay to design library APIs and the basic functions you build your code on as well as you possibly can. That way, you end up spending as little time and code as possible making round pegs fit in square holes. <code>on</code> is a much better building block than <code>comparing = (compare `on`)</code>."}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": false, "score": 5, "last_activity_date": 1452725554, "creation_date": 1452725554, "answer_id": 34778598, "question_id": 34778469, "link": "https://stackoverflow.com/questions/34778469/changing-the-return-type-of-a-function-in-haskell/34778598#34778598", "title": "Changing the return type of a function in Haskell?", "body": "<p>Your definition of <code>isEqualOn</code> would be the same as <code>on (==)</code>:</p>\n\n<pre><code>\\&gt; import Data.Function (on)\n\\&gt; :t (on (==))\n(on (==)) :: Eq a1 =&gt; (a -&gt; a1) -&gt; a -&gt; a -&gt; Bool\n</code></pre>\n\n<p>for example to compare on absolute value:</p>\n\n<pre><code>\\&gt; let isEqualOn = on (==)\n\\&gt; isEqualOn abs 2 (-2)\nTrue\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9368, "user_id": 283240, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8eb2178645e26d829aaa67925c41b4cc?s=128&d=identicon&r=PG", "display_name": "HaskellElephant", "link": "https://stackoverflow.com/users/283240/haskellelephant"}, "is_accepted": false, "score": 0, "last_activity_date": 1452769002, "creation_date": 1452769002, "answer_id": 34787813, "question_id": 34778469, "link": "https://stackoverflow.com/questions/34778469/changing-the-return-type-of-a-function-in-haskell/34787813#34787813", "title": "Changing the return type of a function in Haskell?", "body": "<p>As mentioned you can use the function <code>on</code> from Data.Function, but\nperhaps you are looking for the operator <code>==</code> which returns a <code>Bool</code>.\nIn which case your function can be written as:</p>\n\n<pre><code>isEqualOn f x y = fx == fy\n</code></pre>\n\n<p>and personally I would never write this particular function but\n\"inline\" it where it is used.</p>\n\n<p>On the more general matter of \"changing the return type\". What you are looking for is composition:</p>\n\n<pre><code>isEq Eq = True\nisEq _  = False\n\nequal x y = isEq (comparing x y)\n</code></pre>\n\n<p>or more haskell flavored:</p>\n\n<pre><code>equal x = isEq . comparing x\n</code></pre>\n"}], "owner": {"reputation": 18780, "user_id": 683218, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/7Vy7c.png?s=128&g=1", "display_name": "tinlyx", "link": "https://stackoverflow.com/users/683218/tinlyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 2, "answer_count": 2, "score": 3, "last_activity_date": 1453794494, "creation_date": 1452724897, "last_edit_date": 1453794494, "question_id": 34778469, "link": "https://stackoverflow.com/questions/34778469/changing-the-return-type-of-a-function-in-haskell", "title": "Changing the return type of a function in Haskell?", "body": "<p>Is there is a succinct way to change the return type of a function?</p>\n\n<p>Consider <strong>for example</strong> <code>comparing</code> in <code>Data.Ord</code>. It returns an <code>Ordering</code>. Yet I am only interested in whether the two items are equal or not. So I need to convert the resulting <code>Ordering</code> to a <code>Bool</code>.</p>\n\n<p>A straight forward way I can think of is:</p>\n\n<pre><code>isEqualOn f x y = if comparing f x y==EQ then True else False \n</code></pre>\n\n<p>(or <code>isEqualOn f x y = comparing f x y==EQ</code> as here as pointed out in the comments).</p>\n\n<p>Is there a more compositional way to do this (sort of adapting <code>comparing</code> or writing it in a pointless manner) without having to write out everything? Ideally, I am looking for something that works on n-ary functions as well.</p>\n\n<p>-- Update --</p>\n\n<p>As suggested by the answers/comments, the specific example above (<code>isEqualOn</code>) can be implemented using the standard <code>on</code> function as <code>on (==)</code>. However, my question is about the general technique to change function return types in a compositional/pointless manner as exemplified by the SEC approach in the comments.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 3, "creation_date": 1452723051, "post_id": 34777951, "comment_id": 57301087, "body": "Welcome to StackOverflow. When you encounter a problem show what you&#39;ve already tried. If the functions compiled/type-check, show their output, and what you actually expected as output. This will demonstrate the problem to possible posters better. Also, <a href=\"https://stackoverflow.com/editing-help\">use markdown to format your post</a>."}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1452723444, "post_id": 34778040, "comment_id": 57301257, "body": "<i>&quot;Hey guys im relatively new to Haskell&quot;</i>. You&#39;re going to need a whole lot more explanation."}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": false, "score": 2, "last_activity_date": 1452723737, "last_edit_date": 1452723737, "creation_date": 1452722938, "answer_id": 34778040, "question_id": 34777951, "link": "https://stackoverflow.com/questions/34777951/filter-out-the-format-n-from-a-string-in-haskell/34778040#34778040", "title": "Filter out the format [n] from a string in Haskell", "body": "<p>You may use <a href=\"https://hackage.haskell.org/package/regex-posix-0.95.2/docs/Text-Regex-Posix.html\" rel=\"nofollow\"><code>Text.Regex.Posix</code></a> for that:</p>\n\n<pre><code>\\&gt; import Text.Regex.Posix ((=~))\n\\&gt; let txt = \"blah blah [1] blah blah [1] blah blah [2]\"\n\\&gt; let pat = \"\\\\[[0-9]+\\\\]\"  -- regular expression pattern to match\n\\&gt; txt =~ pat :: Int\n3\n</code></pre>\n\n<p>The function <code>=~</code> is <em>overloaded on return type</em>; for example if you want to see what matched, you use the exact same function call with different type annotation:</p>\n\n<pre><code>\\&gt; txt =~ pat :: [[String]]\n[[\"[1]\"],[\"[1]\"],[\"[2]\"]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1452725511, "creation_date": 1452725511, "answer_id": 34778589, "question_id": 34777951, "link": "https://stackoverflow.com/questions/34777951/filter-out-the-format-n-from-a-string-in-haskell/34778589#34778589", "title": "Filter out the format [n] from a string in Haskell", "body": "<p>You can quite easily achieve your goal with standard Haskell alone. The general name for this kind of task is <em>parsing</em>, but at least for such simple grammars that amounts mostly <em>pattern matching</em> on string-heads. Very easy because Haskell strings are just lists of characters!</p>\n\n<p>First, think about what signature you want.</p>\n\n<pre><code>extractBracketNums :: String -&gt; [Integer]\n</code></pre>\n\n<p>seems a good idea. If you only want to <em>count</em> them, the result type could as well be a single <code>Int</code>, but if you actually output the list of numbers you keep the function more generally useful, and it's trivial to obtain the count afterwards with <code>length</code>.</p>\n\n<p>Now, to implement this we need three cases:</p>\n\n<pre><code>extractBracketNums \"\" = []\n</code></pre>\n\n<p>this is just the base case, ensuring that any recursion we do will safely terminate when the string has been fully consumed. Nothing in the string means, no bracketed numbers either!</p>\n\n<pre><code>extractBracketNums ('[':r) = ...\n</code></pre>\n\n<p>This is the interesting case: we've found an opening bracket, it <em>might</em> be the beginning of a number!</p>\n\n<p>Before actually implementing that case, we need to consider one more:</p>\n\n<pre><code>extractBracketNums (_:r) = extractBracketNums\n</code></pre>\n\n<p>This means: a (sub-) string that doesn't begin with an opening bracket is uninteresting for us, so just discard any such character.</p>\n\n<p>Now for the interesting case: we need to check that after the opening bracket comes a number, and only a number, before the bracket is closed again. So, we need to try to <em>split off</em> a number from the beginning of the remaining string. This can be done quite well with the <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:span\" rel=\"nofollow\"><code>span</code></a> function. Its signature is <code>(a-&gt;Bool) -&gt; [a] -&gt; ([a],[a])</code>, so for us <code>(Char-&gt;Bool) -&gt; String -&gt; (String,String)</code>. It takes a <em>predicate on characters</em>, which should determine whether a character is possibly part of a number-string. The module <code>Data.Char</code> has <a href=\"https://www.haskell.org/hoogle/?hoogle=isNumber\" rel=\"nofollow\">that exact function</a> available.</p>\n\n<pre><code>extractBracketNums ('[':r) = case span isNumber r of\n    ...\n</code></pre>\n\n<p>so now we need to decide if we really found a number, and nothing else. If we <em>didn't</em>  find a number right at the beginning, then <code>span</code> will immediately fail, i.e. give an empty string as its first result.</p>\n\n<pre><code>extractBracketNums ('[':r) = case span isNumber r of\n                              ([],_) -&gt; extractBracketNums r\n</code></pre>\n\n<p>i.e., in this case I just forget about the opening bracket since it doesn't contain (only) a number. Same plan if we do find a number but not a closing bracket immediately after it (we'll cover that one in the end) but if we <em>do</em> find a closing bracket directly after the split off number, we can take that number, convert it from string to <code>Integer</code>, prepend it to any possible other numbers yet to be found. And be happy.</p>\n\n<pre><code>                              (num,']':r') -&gt; read num : extractBracketNums r'\n</code></pre>\n\n<p>Now the completing case (did find some number, but no closing bracket after it): this also means we'll simply forget about the opening bracket.</p>\n\n<pre><code>                              (_,_) -&gt; extractBracketNums r\n</code></pre>\n\n<p>So, all together:</p>\n\n<pre><code>import Data.Char (isNumber)\n\nextractBracketNums :: String -&gt; [Integer]\nextractBracketNums \"\" = []\nextractBracketNums ('[':r) = case span isNumber r of\n                              ([],_) -&gt; extractBracketNums r\n                              (num,']':r') -&gt; read num : extractBracketNums r'\n                              (_,_) -&gt; extractBracketNums r\nextractBracketNums (_:r) = extractBracketNums r\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 5783322, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0c5349784e2a78f39d9de70e575a27af?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/5783322/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 34778589, "answer_count": 2, "score": 0, "last_activity_date": 1452725511, "creation_date": 1452722593, "last_edit_date": 1452723919, "question_id": 34777951, "link": "https://stackoverflow.com/questions/34777951/filter-out-the-format-n-from-a-string-in-haskell", "title": "Filter out the format [n] from a string in Haskell", "body": "<p>Hey guys I'm relatively new to Haskell and I'm trying to return the number of references of the format <code>[n]</code> from a string.  </p>\n\n<p>For example  <code>let x = \"blah blah [1] blah blah [1] blah blah [2]\"</code> should return <code>3</code> since the function would see that there are three references in this function. I'm having trouble trying to match against <code>[n]</code> since <code>n</code> can be any number. I have tried things such as <code>filter([_])</code> but had no luck.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 6, "creation_date": 1452733569, "post_id": 34776282, "comment_id": 57304938, "body": "An observation which may or may not help: the inferred type for <code>f &lt; g</code> is <code>RealFloat a =&gt; Bool</code>, which is ambiguous <i>because</i> the type <code>a</code> is not mentioned on the right-hand side of the <code>=&gt;</code>. In contrast, the inferred type for <code>f + g</code> is <code>RealFloat a =&gt; a</code>, which does not have this property -- all the type variables mentioned on the left of <code>=&gt;</code> are also mentioned on the right."}], "answers": [{"comments": [{"owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "edited": false, "score": 0, "creation_date": 1452719987, "post_id": 34776517, "comment_id": 57299586, "body": "Is it true in Haskell that the function implementations of <code>&lt;</code> and <code>+</code> must be precisely determined at <b>compile-time</b>? (Which means we can&#39;t for <code>&lt;</code> choose among <code>Float</code> and <code>Double</code> at runtime because that&#39;s not how Haskell works?) Kindly confirm this, because if this is the case, this whole thing is finally starting to make sense to me."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "edited": false, "score": 3, "creation_date": 1452720619, "post_id": 34776517, "comment_id": 57299892, "body": "@haskellHQ Mostly yes, except that there are polymorphic values (like your f, g, h). Implementations of type class methods must be <i>either</i> statically chosen at compile time at the call site <i>or</i> passed on as a constraint (the <code>RealFloat =&gt;</code> bit) in the type. If the constraint is passed on, the places that call <i>us</i> get to fix the implementation (or pass the constraint on again... Eventually it must be fixed)."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "edited": false, "score": 3, "creation_date": 1452720840, "post_id": 34776517, "comment_id": 57300002, "body": "@haskellHQ So a given <code>+</code> or <code>&lt;</code> might actually be used with many different implementations, so you could say it&#39;s chosen at runtime; it can even be called with implementations that didn&#39;t exist when the code containing <code>+</code> or <code>&lt;</code> was complied - it&#39;s a lot more flexible than &quot;must be chosen at compile time&quot; sounds like! But yes, when the choice is actually made, it&#39;s made at compile time."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "edited": false, "score": 2, "creation_date": 1452721293, "post_id": 34776517, "comment_id": 57300231, "body": "@haskellHQ That is a good first approximation of the truth, but there are some wrinkles. See <a href=\"http://stackoverflow.com/a/11422333/791604\">my answer to another question</a> for some discussion -- it centers around a <code>read</code>-like function rather than <code>(+)</code>, but the core idea is the same."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1452722909, "post_id": 34776517, "comment_id": 57301002, "body": "There&#39;s some substantial extra flexibility from the fact that the chosen implementation can depend on others in polymorphic recursive contexts. That&#39;s unlikely to show up in a <code>RealFloat</code> situation, but it happens in real code for other classes like <code>Functor</code>, <code>Applicative</code>, <code>Foldable</code>, <code>Eq</code>, <code>Ord</code>, <code>Show</code>, etc. Look up &quot;nested types&quot; and prepare to be confused for a while. Unrelatedly, <code>reflection</code> throws in extreme dynamic fun!"}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": true, "score": 24, "last_activity_date": 1452717445, "last_edit_date": 1452717445, "creation_date": 1452717219, "answer_id": 34776517, "question_id": 34776282, "link": "https://stackoverflow.com/questions/34776282/type-mysteries-why-does-this-code-compile/34776517#34776517", "title": "Type mysteries. Why does this code compile?", "body": "<p>In your second example <code>h</code> <em>also</em> has a polymorphic type. So the type at which <code>+</code> is used isn't ambiguous; it just hasn't been chosen yet.</p>\n\n<p>The context where <code>h</code> is <em>used</em> will determine which type's <code>+</code> is chosen (and different use-sites can make different choices). The user of <code>h</code> can ask it to provide any <code>RealFloat</code> type they please; <code>f</code> and <code>g</code> can also provide any <code>RealFloat</code> type, so <code>h</code> will just ask them for exactly the type its user is asking for.</p>\n"}, {"tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 11, "last_activity_date": 1452723358, "last_edit_date": 1452723358, "creation_date": 1452717227, "answer_id": 34776519, "question_id": 34776282, "link": "https://stackoverflow.com/questions/34776282/type-mysteries-why-does-this-code-compile/34776519#34776519", "title": "Type mysteries. Why does this code compile?", "body": "<p>With <code>h = f &lt; g :: Bool</code>, the type <code>Bool</code> doesn't contain the polymorphic <code>a</code> variable. To actually compute the <code>Bool</code> result, the <code>a</code> needs to be instantiated, and the resulting <code>Bool</code> value can depend on the choice of <code>a</code> (through the <code>RealFloat</code> instance), so instead of making an arbitrary choice GHC refuses to compile.</p>\n\n<p>With <code>h = f + g</code>, the <code>a</code> parameter is in the type of the result, therefore there is no ambiguity. The choice for <code>a</code> has not yet been made, we can still instantiate <code>a</code> as we like (or more precisely, we re-generalized the type of <code>f + g</code>). </p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1452799316, "last_edit_date": 1452799316, "creation_date": 1452731506, "answer_id": 34779654, "question_id": 34776282, "link": "https://stackoverflow.com/questions/34776282/type-mysteries-why-does-this-code-compile/34779654#34779654", "title": "Type mysteries. Why does this code compile?", "body": "<p>To precisely understand the meaning of polymorphism, I find it convenient to think about functional languages with explicit type arguments -- either theoretical ones, such as System F, or real-world ones such as Agda, Idris, Coq, etc.</p>\n\n<p>In these languages, <em>types</em> are passed as function arguments as values normally are. If we have a polymorphic function</p>\n\n<pre><code>f :: forall a. T a\n</code></pre>\n\n<p>this actually expects a <em>type</em> as a first argument, like this:</p>\n\n<pre><code>f Int :: T Int\nf Char :: T Char\nf String :: T String\n...\n</code></pre>\n\n<p>Note how the <code>a</code> in the resulting type gets instantiated to the type argument.</p>\n\n<p>Adding typeclass constraints, we have that</p>\n\n<pre><code>f :: RealFloat a =&gt; a\nf = 1.0\n</code></pre>\n\n<p>can be seen as a function expecting: 1) a type argument <code>a</code>, 2) a proof that the chosen type is a <code>RealFloat</code> (e.g. a typeclass dictionary). When this is provided, a result of the chosen type <code>a</code> will be returned. A more pedantic definition could be</p>\n\n<pre><code>f :: forall a. RealFloat a =&gt; a\nf = \\\\a -&gt; \\\\proof -&gt;  ... -- use proof to generate 1.0 :: a\n</code></pre>\n\n<p>where <code>\\\\</code> is used as a type-level lambda, for the additional arguments described earlier. A call could then be as follows:</p>\n\n<pre><code>-- pseudo syntax\nf Double double_is_a_RealFloat_proof\n</code></pre>\n\n<p>which will return <code>1.0 :: Double</code>.</p>\n\n<p>Now, what happens if we write the posted code?</p>\n\n<pre><code>h :: RealFloat a =&gt; a\nh = f + g\n</code></pre>\n\n<p>Well, now <code>f</code> and <code>g</code> expect type arguments, as well as <code>h</code>, since all three are polymorphic values. During type inference, a few additional arguments are added by the compiler as follows:</p>\n\n<pre><code>h :: forall a. RealFloat a =&gt; a\nh = \\\\a -&gt; \\\\proof -&gt; (f a proof) + (g a proof)\n</code></pre>\n\n<p>(technically, even <code>+</code>, being polymorphic, has additional arguments, but let's put that under the rug for readability's sake...)</p>\n\n<p>Note that now it is clear what type <code>f</code> should produce: it's <code>a</code>, the same type which is produced by <code>h</code>. In other words, <code>h</code> asks its caller which type is wanted, and forwards the same type to <code>f</code>. Ditto for <code>g</code>.</p>\n\n<p>By comparison, in</p>\n\n<pre><code>h :: Bool\nh = f &lt; g\n</code></pre>\n\n<p>there's no polymorphism in <code>h</code>, but <code>f</code> and <code>g</code> are still polymorphic. During type inference the compiler reaches</p>\n\n<pre><code>h = (f a? proof?) &lt; (g a? proof?)\n</code></pre>\n\n<p>and has to invent <code>a?</code> and <code>proof?</code> out of thin air, since <code>h</code> is not asking them to its caller. Hence the ambiguity error.</p>\n\n<p>Finally, note that it is possible to see the additional type arguments which are added by GHC during type inference. To do that, it suffices to dump the GHC Core intermediate language, e.g. with the <code>-ddump-simpl</code> GHC flag. In GHC 8.x, which is not yet released, rumors say that we will be even allowed to specify explicit type arguments in our code when we want to, and let the compiler infer them as usual otherwise. It sounds fun!</p>\n"}], "owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1020, "favorite_count": 2, "accepted_answer_id": 34776517, "answer_count": 3, "score": 17, "last_activity_date": 1452799316, "creation_date": 1452716421, "question_id": 34776282, "link": "https://stackoverflow.com/questions/34776282/type-mysteries-why-does-this-code-compile", "title": "Type mysteries. Why does this code compile?", "body": "<p>This code does not compile:</p>\n\n<pre><code>default ()\n\nf :: RealFloat a =&gt; a\nf = 1.0\n\ng :: RealFloat a =&gt; a\ng = 1.0\n\nh :: Bool\nh = f &lt; g --Error. Ambiguous.\n</code></pre>\n\n<p>This is expected because it's ambiguous. The two possibilities are <code>Float</code> and <code>Double</code> and the compiler doesn't know which <code>&lt;</code> to pick.</p>\n\n<p>However, this code <em>does</em> compile:</p>\n\n<pre><code>default ()\n\nf :: RealFloat a =&gt; a\nf = 1.0\n\ng :: RealFloat a =&gt; a\ng = 1.0\n\nh :: RealFloat a =&gt; a\nh = f + g --Why does this compile?\n</code></pre>\n\n<p>Why? Why isn't Haskell confused here, in a similar manner as in the example above, about which <code>+</code> to pick (for <code>Float</code> or <code>Double</code>)?</p>\n"}, {"tags": ["haskell", "homebrew", "webkitgtk", "ghcjs", "ghcjs-dom"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1452714354, "post_id": 34774356, "comment_id": 57296552, "body": "what error do you get with <code>cabal install webkitgtk3</code> it should be available at  <a href=\"https://hackage.haskell.org/package/webkitgtk3\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/webkitgtk3</a>"}, {"owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1452714753, "post_id": 34774356, "comment_id": 57296789, "body": "@epsilonhalbe <code>setup: The pkg-config package &#39;webkitgtk-3.0&#39; version &gt;=1.8 is required but it could not be found.</code>  It seems to require an OS package, but there doesn&#39;t seem to be one for homebrew."}, {"owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "edited": false, "score": 1, "creation_date": 1452720841, "post_id": 34774356, "comment_id": 57300004, "body": "Is <code>webkitgtk-3.0</code> listed in <code>pkg-config --list-all</code>? If it doesn&#39;t, try to find <code>webkitgtk-3.0.pc</code> file (or something similar) and add path to it to <code>PKG_CONFIG_PATH</code> environment variable. Also try <code>cabal configure -v3</code> for detailed log."}, {"owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "reply_to_user": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "edited": false, "score": 1, "creation_date": 1452725476, "post_id": 34774356, "comment_id": 57302180, "body": "@Yuras: I found a tar.gz file in <code>~&#47;.cabal&#47;packages&#47;hackage.haskell.org&#47;webkitgtk3&#47;</code>, but no <code>.pc</code> file.  When I <code>--list-all</code> I see <code>webkit2gtk-web-extension-4.0</code> and <code>webkit2gtk-4.0</code>."}, {"owner": {"reputation": 2865, "user_id": 6369276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d91ac54d4035616b112dcfb66433550e?s=128&d=identicon&r=PG&f=1", "display_name": "michaelmesser", "link": "https://stackoverflow.com/users/6369276/michaelmesser"}, "edited": false, "score": 0, "creation_date": 1470016477, "post_id": 34774356, "comment_id": 64759515, "body": "Did you ever figure this out?"}, {"owner": {"reputation": 319, "user_id": 5556960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8461c69f2ceeed1b54eb5c5ae3dd275e?s=128&d=identicon&r=PG&f=1", "display_name": "MarLinn", "link": "https://stackoverflow.com/users/5556960/marlinn"}, "edited": false, "score": 0, "creation_date": 1471475107, "post_id": 34774356, "comment_id": 65366779, "body": "This sounds like what @MarkKaravan wrote in the comment: A missing OS package. That almost always means an OS package in its &quot;dev&quot; version. Maybe when installing GTK you can choose something? Maybe you can compile one from source? Otherwise, the only thing left is to wonder why the heck ghcjs would need such a package and switch either OS or language. There are some EDSLs in Haskell that compile to JS (Haste, Sunroof), there are Haskell-inspired JS-wrappers like Purecript or Elm and according to documentation UHC can compile Haskell to JS, too."}, {"owner": {"reputation": 2865, "user_id": 6369276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d91ac54d4035616b112dcfb66433550e?s=128&d=identicon&r=PG&f=1", "display_name": "michaelmesser", "link": "https://stackoverflow.com/users/6369276/michaelmesser"}, "reply_to_user": {"reputation": 319, "user_id": 5556960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8461c69f2ceeed1b54eb5c5ae3dd275e?s=128&d=identicon&r=PG&f=1", "display_name": "MarLinn", "link": "https://stackoverflow.com/users/5556960/marlinn"}, "edited": false, "score": 0, "creation_date": 1471549342, "post_id": 34774356, "comment_id": 65403421, "body": "@MarLinn ghcjs-dom not ghcjs needs it when it is using webkit-gtk not ghc-js"}, {"owner": {"reputation": 3115, "user_id": 218799, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/21a241aa10ee457a5f6b72aca98a4860?s=128&d=identicon&r=PG", "display_name": "Wade Williams", "link": "https://stackoverflow.com/users/218799/wade-williams"}, "edited": false, "score": 0, "creation_date": 1476297872, "post_id": 34774356, "comment_id": 67290148, "body": "FWIW, the docs seem to reference requiring MacPorts in order to install. Homebrew currently doesn&#39;t implement WebKitGTK3: <a href=\"https://github.com/leksah/leksah#building-on-os-x\" rel=\"nofollow noreferrer\">github.com/leksah/leksah#building-on-os-x</a> ; <a href=\"https://github.com/gtk2hs/webkit/issues/13\" rel=\"nofollow noreferrer\">github.com/gtk2hs/webkit/issues/13</a>"}], "answers": [{"tags": [], "owner": {"reputation": 13132, "user_id": 2168, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/5e7e68e1cdaea224d93da209afb28e9d?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/2168/john"}, "is_accepted": false, "score": 1, "last_activity_date": 1496335182, "creation_date": 1496335182, "answer_id": 44312975, "question_id": 34774356, "link": "https://stackoverflow.com/questions/34774356/installing-webkitgtk3-for-ghcjs-on-osx/44312975#44312975", "title": "Installing webkitgtk3 for GHCJS on osx", "body": "<p>As I'm still running into this problem now, I've created a <a href=\"https://github.com/lgastako/homebrew-webkitgtk-formula\" rel=\"nofollow noreferrer\">repository here</a> with an attempt at a homebrew tap to solve this problem.  It's not fully functional yet but I think it's close. </p>\n"}], "owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 2, "answer_count": 1, "score": 19, "last_activity_date": 1496335182, "creation_date": 1452709809, "last_edit_date": 1471154260, "question_id": 34774356, "link": "https://stackoverflow.com/questions/34774356/installing-webkitgtk3-for-ghcjs-on-osx", "title": "Installing webkitgtk3 for GHCJS on osx", "body": "<p>I'm trying to install the ghcjs-dom package on Mac OSX.  It's been bumpy as there are a lot of dependencies.  Webkitgtk3 is my current nemesis</p>\n\n<pre><code>cabal install ghcjs-dom\nResolving dependencies...\nConfiguring webkitgtk3-0.14.1.1...\nFailed to install webkitgtk3-0.14.1.1\nBuild log ( /Users/markkaravan/.cabal/logs/webkitgtk3-0.14.1.1.log ):\n[1 of 2] Compiling SetupWrapper     ( /var/folders/br/4zwhphlx3816v87cc0bb5sxh0000gn/T/cabal-tmp-24401/webkitgtk3-0.14.1.1/SetupWrapper.hs, /var/folders/br/4zwhphlx3816v87cc0bb5sxh0000gn/T/cabal-tmp-24401/webkitgtk3-0.14.1.1/dist/setup/SetupWrapper.o )\n[2 of 2] Compiling Main             ( /var/folders/br/4zwhphlx3816v87cc0bb5sxh0000gn/T/cabal-tmp-24401/webkitgtk3-0.14.1.1/dist/setup/setup.hs, /var/folders/br/4zwhphlx3816v87cc0bb5sxh0000gn/T/cabal-tmp-24401/webkitgtk3-0.14.1.1/dist/setup/Main.o )\nLinking /var/folders/br/4zwhphlx3816v87cc0bb5sxh0000gn/T/cabal-tmp-24401/webkitgtk3-0.14.1.1/dist/setup/setup ...\n[1 of 2] Compiling Gtk2HsSetup      ( Gtk2HsSetup.hs, dist/setup-wrapper/Gtk2HsSetup.o )\n[2 of 2] Compiling Main             ( SetupMain.hs, dist/setup-wrapper/Main.o )\nLinking dist/setup-wrapper/setup ...\nConfiguring webkitgtk3-0.14.1.1...\nsetup: The pkg-config package 'webkitgtk-3.0' version &gt;=1.8 is required but it\ncould not be found.\ncabal: Error: some packages failed to install:\nghcjs-dom-0.2.3.1 depends on webkitgtk3-0.14.1.1 which failed to install.\nwebkitgtk3-0.14.1.1 failed during the configure step. The exception was:\nExitFailure 1\n</code></pre>\n\n<p>I've tried the following commands to install this sucker:</p>\n\n<pre><code>brew install gtk+3    \nbrew install webkitgtk\nbrew install webkitgtk3\nbrew install webkitgtk+3\ncabal install webkitgtk3\n</code></pre>\n\n<p>...but no such luck.  does anyone know how to install this package?</p>\n"}, {"tags": ["scala", "haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 4, "creation_date": 1452707640, "post_id": 34773441, "comment_id": 57292385, "body": "the error is on the right hand side of the <code>::</code>;  <code>Either FailedLogin ...</code> mixes two different things - <code>Either</code> (a type constructor) and <code>FailedLogin</code> a (data constructor) you need something of &#39;type constructor&#39;, in this case <code>AppError</code>. Note <code>AppError</code> and <code>FailedLogin</code> live in different namespaces!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 5, "creation_date": 1452713082, "post_id": 34773441, "comment_id": 57295735, "body": "I think the crucial difference here can be summarized as follows. Scala has subtyping (from OOP tradition), Haskell like most FP languages has no subtyping. This is why Scala is able to have <code>FailedLogin.type</code> as a type, which is a subtype of <code>AppError</code>. Instead, Haskell has no such type, only the <i>value</i> <code>FailedLogin</code> of type <code>AppError</code>."}], "answers": [{"comments": [{"owner": {"reputation": 6364, "user_id": 288913, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/902e8cc4ad1dab7e25d3a2dc1eac732f?s=128&d=identicon&r=PG", "display_name": "Sarah", "link": "https://stackoverflow.com/users/288913/sarah"}, "edited": false, "score": 1, "creation_date": 1452714053, "post_id": 34774065, "comment_id": 57296355, "body": "Using &quot;constructor&quot; there is a bit ambiguous, since an AppError is also a (type) constructor. &quot;You are using a <i>value</i> where you need a type&quot; might be clearer."}], "tags": [], "owner": {"reputation": 31706, "user_id": 479180, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a6a0fe77d0b255095771224c05db75cc?s=128&d=identicon&r=PG", "display_name": "LuxuryMode", "link": "https://stackoverflow.com/users/479180/luxurymode"}, "is_accepted": false, "score": 2, "last_activity_date": 1452727369, "last_edit_date": 1452727369, "creation_date": 1452708818, "answer_id": 34774065, "question_id": 34773441, "link": "https://stackoverflow.com/questions/34773441/comparing-haskells-data-constructor-w-scalas-sub-class/34774065#34774065", "title": "Comparing Haskell&#39;s Data Constructor w/ Scala&#39;s Sub-class", "body": "<p>Briefly stated: Both the <code>e</code> and <code>a</code> in <code>Either e a</code> need to be types. You are using a value where you need a type. The <strong>type</strong> of <code>FailedLogin</code> is <code>AppError</code>. One of <code>AppError</code>'s <strong>constructors</strong> is <code>FailedLogin</code>.</p>\n\n<p>Constructors are ways to create a value of some type. Thus, for any data type <code>data X = A | B | C ... Z</code>, we can use any of its constructors to create a value of type <code>X</code>. </p>\n\n<p>For example, <code>Maybe a</code> is a type and <code>Just</code> is one of its constructors: </p>\n\n<pre><code>&gt; :t Just 1\nJust 1 :: Num a =&gt; Maybe a\n</code></pre>\n\n<p><code>Nothing</code> is also one of <code>Maybe</code>'s constructors. </p>\n\n<pre><code>&gt; :t Nothing\nNothing :: Maybe a\n</code></pre>\n\n<p>The <strong>type</strong> is always the thing on the left-hand side of the data type and its <strong>constructors</strong> are on the right. </p>\n\n<p>I can't speak to how <code>.type</code> works in Scala, but I'd argue that the correct usage of sum types in Scala would be to only speak in terms of <code>AppError</code> and not <code>FailedLogin</code>. If <code>FailedLogin</code> truly stands on its own, it ought to be it's own trait. </p>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1452727369, "creation_date": 1452706919, "question_id": 34773441, "link": "https://stackoverflow.com/questions/34773441/comparing-haskells-data-constructor-w-scalas-sub-class", "title": "Comparing Haskell&#39;s Data Constructor w/ Scala&#39;s Sub-class", "body": "<p>Let's say that my app has two types of errors:</p>\n\n<pre><code>\u03bb: data AppError = FailedLogin | InvalidMessage deriving Show\n</code></pre>\n\n<p>It has <code>login</code> and <code>sendMessage</code> functions:</p>\n\n<pre><code>\u03bb: let login user pw = Left FailedLogin :: Either AppError String\n\u03bb: let sendMessage msg token = Left InvalidMessage :: Either AppError Int\n\u03bb: login \"foo\" \"bar\" &gt;&gt;= (\\token -&gt; sendMessage \"hello world\" token)\nLeft FailedLogin\n</code></pre>\n\n<p>However, note that the return type is <code>Either AppError String</code>. I can't specify an <code>Either FailedLogin ...</code>:</p>\n\n<pre><code>\u03bb: let f = Left FailedLogin :: Either FailedLogin String\n\n&lt;interactive&gt;:18:36:\n    Not in scope: type constructor or class \u2018FailedLogin\u2019\n    A data constructor of that name is in scope; did you mean DataKinds?\n</code></pre>\n\n<p>What's the reason for this behavior, i.e. not able to use a data constructor in <code>Either</code>'s <code>Left</code> type?</p>\n\n<p>Secondly, let's say that I reproduce the above code in Scala:</p>\n\n<pre><code>scala&gt; sealed trait AppError \ndefined trait AppError\n\nscala&gt; case object FailedLogin extends AppError\ndefined object FailedLogin\n\nscala&gt; case object InvalidMessage extends AppError\ndefined object InvalidMessage                                                        \n\nscala&gt; def login(user: String, password: String): Either[FailedLogin.type, String] = ???\nlogin: (user: String, password: String)Either[FailedLogin.type,String]\n</code></pre>\n\n<p>Note that I can specify <code>FailedLogin</code> as a return type. It would not make sense if I needed to call: <code>login &gt;&gt;= sendMessage</code>. However, if I only expected a single value on <code>Either</code>'s <code>Left</code>, would using a <code>case object</code> be idiomatic? Or is it worthwhile to create a <code>sealed trait ...</code> with a single sub-class, referencing the trait in the <code>Either</code>s Left`?</p>\n"}, {"tags": ["haskell", "io", "functional-programming"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1452705355, "post_id": 34772844, "comment_id": 57290917, "body": "your trouble start when you realize that <code>answerQuestion</code> will not compile (as <code>playerAnswer</code> is an <code>IO String</code> action)  - that&#39;s why you should split up the functionality and add the answer as an additional <code>String</code> argument to your <code>answerQuestion</code> IMO"}, {"owner": {"reputation": 539, "user_id": 1759437, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a149bb5926a01844450ee1e95d80feb2?s=128&d=identicon&r=PG", "display_name": "Alberto Pellizzon", "link": "https://stackoverflow.com/users/1759437/alberto-pellizzon"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1452707463, "post_id": 34772844, "comment_id": 57292266, "body": "Nice approach, so how can i perform a string match for an <code>IO String</code> answer against a <code>answer(question)</code> <code>String</code>"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1452708469, "post_id": 34772844, "comment_id": 57292853, "body": "btw. <code>points :: String</code> - is this really what you want?"}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 2, "creation_date": 1452717672, "post_id": 34772844, "comment_id": 57298447, "body": "I recommend that you read <a href=\"http://blog.jle.im/entry/inside-my-world-ode-to-functor-and-monad\" rel=\"nofollow noreferrer\">&quot;Inside My World (Ode to Functor and Monad)&quot;</a>.  It addresses this topic very well, I think."}], "answers": [{"comments": [{"owner": {"reputation": 539, "user_id": 1759437, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a149bb5926a01844450ee1e95d80feb2?s=128&d=identicon&r=PG", "display_name": "Alberto Pellizzon", "link": "https://stackoverflow.com/users/1759437/alberto-pellizzon"}, "edited": false, "score": 0, "creation_date": 1452707221, "post_id": 34773008, "comment_id": 57292129, "body": "This is a viable solution what i don&#39;t like about that is  1 - writing the entire function in an imperative way (if / then / else)  2 - i want  <code>askQuestion</code> to return a Player 3 - if i have to call <code>answerQuestion</code> from another function i also have to call it inside a do block and so on"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 539, "user_id": 1759437, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a149bb5926a01844450ee1e95d80feb2?s=128&d=identicon&r=PG", "display_name": "Alberto Pellizzon", "link": "https://stackoverflow.com/users/1759437/alberto-pellizzon"}, "edited": false, "score": 0, "creation_date": 1452707339, "post_id": 34773008, "comment_id": 57292193, "body": "well you can rewrite it to <code>case</code> if you like but it&#39;s just the same as yours ... and once you enter <code>do</code> it will always look very imperative - btw: what is your question then?"}, {"owner": {"reputation": 539, "user_id": 1759437, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a149bb5926a01844450ee1e95d80feb2?s=128&d=identicon&r=PG", "display_name": "Alberto Pellizzon", "link": "https://stackoverflow.com/users/1759437/alberto-pellizzon"}, "edited": false, "score": 0, "creation_date": 1452707996, "post_id": 34773008, "comment_id": 57292592, "body": "So the real problem here is that i am not able to perform a match with an IO String against a String and in order to do that from what i know i have to &quot;covert&quot; the IO String into a String and this can be done only inside a do block but doing that will make my code to be only inside that and to me it seems an hack, i am talking from a very beginner prospective and you actually already answer my question so i am going to accept it, just trying to dig deeper in this problem"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1452708642, "post_id": 34773008, "comment_id": 57292933, "body": "well not exactly - you don&#39;t convert some values - you should think of <code>IO String</code> as an <i>action</i> that you can <i>execute</i> (more than once if you like) and get back a <code>String</code> (if you execute it more than once than those may be different) - you can join/bind/compose together those <i>actions</i> (that&#39;s the monad part) and one way of doing this is the <code>do</code>-block syntactic sugar - but in the end you will only execute those actions when the runtimes execute the <code>main :: IO ()</code> <i>action</i>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1452708666, "post_id": 34773008, "comment_id": 57292940, "body": "@chi yes thanks - in this case I only copy&amp;pasted the code"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 1, "last_activity_date": 1452708681, "last_edit_date": 1452708681, "creation_date": 1452705520, "answer_id": 34773008, "question_id": 34772844, "link": "https://stackoverflow.com/questions/34772844/how-to-handle-io-return-values-properly-in-haskell/34773008#34773008", "title": "How to handle IO return values properly in Haskell", "body": "<p>as an alternative you can <em>promote</em> <code>answerQuestion</code> to an action as well:</p>\n\n<pre><code>answerQuestion ::  Question -&gt; Player -&gt; IO Player \nanswerQuestion question player =\n    answer &lt;- playerAnswer\n    if isCorrect question answer\n    then return $ Player (name player) (points player + 1)\n    else return player\n    where\n      playerAnswer = do\n          putStrLn $ text question\n          getLine\n</code></pre>\n\n<p>so yes you could say that in this case you should call <code>isCorrect</code> from inside a <code>do</code> block</p>\n"}, {"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1452708803, "post_id": 34774013, "comment_id": 57293028, "body": "One of these days I&#39;m going to write a normal sized answer."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 4, "creation_date": 1452708878, "post_id": 34774013, "comment_id": 57293071, "body": "or just write some script to extract all your answers, string them together and publish &quot;Haskell the ultimate reference to programming the universe and all the rest&quot; ;)"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1452720037, "post_id": 34774013, "comment_id": 57299613, "body": "@Carsten Sure. &quot;In the beginning, my account was created. This has made a lot of people very angry and been widely regarded as a bad move.&quot;."}, {"owner": {"reputation": 539, "user_id": 1759437, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a149bb5926a01844450ee1e95d80feb2?s=128&d=identicon&r=PG", "display_name": "Alberto Pellizzon", "link": "https://stackoverflow.com/users/1759437/alberto-pellizzon"}, "edited": false, "score": 0, "creation_date": 1452787776, "post_id": 34774013, "comment_id": 57331962, "body": "Hi guys thank you all for your answers, it will took me some time to read and understand everything, one thing that i noticed is that all 3 answers are considerably different and maybe this means that it not an easy topic :D, i will accept this as the right answer(of course because it is the longest) when i understand it completely"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 6, "last_activity_date": 1452708650, "creation_date": 1452708650, "answer_id": 34774013, "question_id": 34772844, "link": "https://stackoverflow.com/questions/34772844/how-to-handle-io-return-values-properly-in-haskell/34774013#34774013", "title": "How to handle IO return values properly in Haskell", "body": "<p><sup>Note: This post is written in literate Haskell. You can save it as Game.lhs and try it in your GHCi.</sup></p>\n\n<blockquote>\n  <p>now playerAnswer has type <code>IO String</code> so do i have to call isCorrect inside the do block? </p>\n</blockquote>\n\n<p>Yes, if you stay on that course.</p>\n\n<blockquote>\n  <p>Is there another way to parse <code>IO String</code> into <code>String</code>?</p>\n</blockquote>\n\n<p>None that's not unsafe. An <code>IO String</code> is something that gives you a <code>String</code>, but whatever uses the <code>String</code> has to stay in <code>IO</code>.</p>\n\n<blockquote>\n  <p>In case of first i am feeling like loosing all the benefits from functional programming because i will end up writing my entire code in do blocks in order to access the String value .</p>\n</blockquote>\n\n<p>This can happen if you don't take measurements early. However, let's approach this from a top-down approach. First, let's introduce some type aliases so that it's clear whether we look at a <code>String</code> in as an answer or a name:</p>\n\n<pre><code>&gt; type Text   = String\n&gt; type Answer = String\n&gt; type Name   = String\n&gt; type Points = Int    -- points are usually integers\n</code></pre>\n\n<p>Your original types stay the same:</p>\n\n<pre><code>&gt; data Question = Question { answer :: Answer\n&gt;                          , text   :: Text } deriving Show\n&gt; data Player   = Player { name   :: Name\n&gt;                        , points :: Points } deriving Show\n</code></pre>\n\n<p>Now let's think about a single turn of the game. You want to ask the player a question, get his answer, and if he's right, add some points:</p>\n\n<pre><code>&gt; gameTurn :: Question -&gt; Player -&gt; IO Player\n&gt; gameTurn q p = do\n&gt;    askQuestion q\n&gt;    a &lt;- getAnswer\n&gt;    increasePointsIfCorrect q p a\n</code></pre>\n\n<p>This will be enough to fill your game with a single turn. Let's fill those functions with life. <code>askQuestions</code> and <code>getAnswer</code> change the world: they print something on the terminal and ask for user input. They <em>have</em> to be in <code>IO</code> at some point:</p>\n\n<pre><code>&gt; askQuestion :: Question -&gt; IO ()\n&gt; askQuestion q = putStrLn (text q)\n\n&gt; getAnswer :: IO String\n&gt; getAnswer = getLine\n</code></pre>\n\n<p>Before we actually define <code>increasePointsIfCorrect</code>, let's think about a version that does not use <code>IO</code>, again, in a slightly more abstract way:</p>\n\n<pre><code>&gt; increasePointsIfCorrect' :: Question -&gt; Player -&gt; Answer -&gt; Player\n&gt; increasePointsIfCorrect' q p a =\n&gt;    if isCorrect q a\n&gt;       then increasePoints p\n&gt;       else p\n</code></pre>\n\n<p>By the way, if you watch closely, you'll notice that <code>increasePointsIfCorrect'</code> is actually a single game turn. After all, it's checks the answer and increases the points. Speaking of:</p>\n\n<pre><code>&gt; increasePoints :: Player -&gt; Player\n&gt; increasePoints (Player n p) = Player n (p + 1)\n\n&gt; isCorrect :: Question -&gt; Answer -&gt; Bool\n&gt; isCorrect q a = answer q == a\n</code></pre>\n\n<p>We now defined several functions that don't use <code>IO</code>. All that's missing is <code>increasePointsIfCorrect</code>:</p>\n\n<pre><code>&gt; increasePointsIfCorrect :: Question -&gt; Player -&gt; Answer -&gt; IO Player\n&gt; increasePointsIfCorrect q p a = return (increasePointsIfCorrect' q p a)\n</code></pre>\n\n<p>You can check this now with a simple short game:</p>\n\n<pre><code>&gt; theQuestion = Question { text   = \"What is your favourite programming language?\"\n&gt;                        , answer = \"Haskell (soon)\"}\n&gt; thePlayer   = Player { name   = \"Alberto Pellizzon\"\n&gt;                      , points = 306 }\n&gt;\n&gt; main :: IO ()\n&gt; main = gameTurn theQuestion thePlayer &gt;&gt;= print\n</code></pre>\n\n<p>There are other ways to handle this, but I guess this is one of the easier ones for beginners. </p>\n\n<p>Either way, what's nice is that we could now test all the logic without using <code>IO</code>. For example:</p>\n\n<pre><code>prop_increasesPointsOnCorrectAnswer q p =\n   increasePointsIfCorrect' q p (answer q) === increasePoints p\n\nprop_doesnChangePointsOnWrongAnswer q p a = a /= answer q ==&gt;\n   increasePointsIfCorrect' q p a === p\n\nghci&gt; quickCheck prop_increasesPointsOnCorrectAnswer \nOK. Passed 100 tests.\nghci&gt; quickCheck prop_doesnChangePointsOnWrongAnswer \nOK. Passed 100 tests.\n</code></pre>\n\n<p>Implementing those tests completely is out of scope of this question though.</p>\n\n<h3>Exercises</h3>\n\n<ul>\n<li>Tell the player whether his answer was correct.</li>\n<li>Add <code>playGame :: [Question] -&gt; Player -&gt; IO ()</code>, which asks several questions after another and tells the player the final score. </li>\n<li>Ask the player for his/her name and store it in the initial player.</li>\n<li>(Very Hard for a beginner) Try to find a way so that you can either play a game automatically  (for example for testing), or \"against\" a human. Hint: Look for \"domain specific language\".</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1452719865, "post_id": 34776777, "comment_id": 57299515, "body": "Sorry, but that&#39;s a bad example. The <code>Question</code> is already known at that point. <code>liftM (isCorrect question) getAnswer</code> or <code>fmap (isCorrect question) getAnswer</code> would be better, unless your <code>question :: IO Question</code> is the slightly bogus <code>putQuestion q &gt;&gt; return q</code>. Also, you&#39;re using the already existing function <code>answer</code> in a local binding, shadowing the <code>answer :: Question -&gt; String</code> OP provided in his question. The overall mentality/paradigm of your answer holds, but that example is probably confusing for a language beginner."}], "tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 0, "last_activity_date": 1452718807, "last_edit_date": 1452718807, "creation_date": 1452718258, "answer_id": 34776777, "question_id": 34772844, "link": "https://stackoverflow.com/questions/34772844/how-to-handle-io-return-values-properly-in-haskell/34776777#34776777", "title": "How to handle IO return values properly in Haskell", "body": "<blockquote>\n  <p>Is there another way to parse <code>IO String</code> into <code>String</code>?</p>\n</blockquote>\n\n<p>No, there is no safe way of turning <code>IO String</code> into <code>String</code>.  This is the <em>point</em> of the <code>IO</code> type!</p>\n\n<blockquote>\n  <p>now playerAnswer has type <code>IO String</code> so do i have to call <code>isCorrect</code> inside the <code>do</code> block ? [...] In case of first i am feeling like loosing all the benefits from functional programming because i will end up writing my entire code in do blocks in order to access the <code>String</code> value</p>\n</blockquote>\n\n<p>That's what it looks like at first, but it's not like that.  The trick is that we use <strong>adapter</strong> functions to connect the pure and the effectful worlds.  So for example, suppose you have:</p>\n\n<ul>\n<li>A question <code>question :: IO Question</code></li>\n<li>An answer <code>answer :: IO String</code></li>\n</ul>\n\n<p>And you want to call <code>isCorrect :: Question -&gt; String -&gt; Bool</code> on the <code>Question</code> and the <code>String</code>.  One way to do this is to use the <code>liftA2</code> function:</p>\n\n<pre><code>import Control.Applicative (liftA2)\n\nexample :: IO Bool\nexample = liftA2 isCorrect question answer\n  where question :: IO Question\n        question = _\n        answer :: IO String\n        answer = _\n</code></pre>\n\n<p><code>liftA2</code> has this generic type:</p>\n\n<pre><code>liftA2 :: Applicative f =&gt; (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c\n</code></pre>\n\n<p>In this example, we're using it with:</p>\n\n<ul>\n<li><code>f := IO</code></li>\n<li><code>a := Question</code></li>\n<li><code>b := String</code></li>\n<li><code>c := Bool</code></li>\n</ul>\n\n<p>So what liftA2 does is <strong>adapt</strong> a pure function to work with side-effecting types.  And that's how Haskell programming generally works:</p>\n\n<ol>\n<li>You try to write most of your code as pure functions</li>\n<li>You use auxiliary functions like <code>liftA2</code> to adapt them to work with impure effects.</li>\n</ol>\n\n<p>It takes some study and practice to get the hang of this.  </p>\n"}], "owner": {"reputation": 539, "user_id": 1759437, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a149bb5926a01844450ee1e95d80feb2?s=128&d=identicon&r=PG", "display_name": "Alberto Pellizzon", "link": "https://stackoverflow.com/users/1759437/alberto-pellizzon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 2, "accepted_answer_id": 34774013, "answer_count": 3, "score": 1, "last_activity_date": 1452718807, "creation_date": 1452705026, "last_edit_date": 1452708404, "question_id": 34772844, "link": "https://stackoverflow.com/questions/34772844/how-to-handle-io-return-values-properly-in-haskell", "title": "How to handle IO return values properly in Haskell", "body": "<p>Hi i have a very noob question, lets say i want to create a game when you have to answer questions, i wrote this</p>\n\n<pre><code>data Question = Question { answer::String, text::String }\ndata Player = Player { name::String, points::String }\n\nanswerQuestion ::  Question -&gt; Player -&gt; Player \nanswerQuestion question player\n    | isCorrect question playerAnswer = Player (name player) (points player + 1)\n    | otherwise = player\n    where\n      playerAnswer = do\n          putStrLn text(question)\n          getLine\n\nisCorrect ::  Question -&gt; String -&gt; Bool \nisCorrect question try = try == answer(question)\n</code></pre>\n\n<p>now playerAnswer has type <code>IO String</code> so do i have to call <code>isCorrect</code> inside the <code>do</code> block ? Is there another way to parse <code>IO String</code> into <code>String</code> ?</p>\n\n<p>In case of first i am feeling like loosing all the benefits from functional programming because i will end up writing my entire code in <code>do</code> blocks in order to access the <code>String</code> value </p>\n"}, {"tags": ["haskell", "lazy-evaluation"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 2, "creation_date": 1452704416, "post_id": 34772591, "comment_id": 57290292, "body": "Did you put it into GHCi and try it?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1452704474, "post_id": 34772591, "comment_id": 57290333, "body": "Why do you think that there is anything problematic about that line?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 4, "creation_date": 1452704631, "post_id": 34772591, "comment_id": 57290433, "body": "My guess is that you got the question wrong (is it <code>take 3 (reverse [1..])</code>?) - because this is obvious and has nothing to do with lazyness and I don&#39;t see what the explanation would be short of writing down the evaluation steps"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1452705038, "post_id": 34772591, "comment_id": 57290716, "body": "@Carsten I think beginners have trouble understanding if an declared expression is actually evaluated or not. But i&#39;m not sure if that&#39;s what Luxzero is having."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1452705118, "post_id": 34772591, "comment_id": 57290769, "body": "but in this cause should the question not be phrased &quot;Because of lazyness <b>will</b> Haskell evaluate ...&quot;?"}, {"owner": {"reputation": 41, "user_id": 5609937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e45b59279056903ea3b256421f842267?s=128&d=identicon&r=PG&f=1", "display_name": "Luxzero", "link": "https://stackoverflow.com/users/5609937/luxzero"}, "edited": false, "score": 0, "creation_date": 1452706105, "post_id": 34772591, "comment_id": 57291409, "body": "Yeah I got the question wrong. Carsten was right"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1452706118, "post_id": 34772591, "comment_id": 57291418, "body": "ok - assuming it was no <i>frustation edit</i> - the answer now is <b>no</b> - Haskell will not be able to evaluate this in an finite time - to see this ask yourself: what would the first element of the result of <code>reverse [1..]</code> be? (you can see this formally if you write down the definition of reverse and try to evaluate this by hand ... you soon will end up in some kind of mess ;))"}, {"owner": {"reputation": 41, "user_id": 5609937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e45b59279056903ea3b256421f842267?s=128&d=identicon&r=PG&f=1", "display_name": "Luxzero", "link": "https://stackoverflow.com/users/5609937/luxzero"}, "edited": false, "score": 0, "creation_date": 1452706469, "post_id": 34772591, "comment_id": 57291641, "body": "Yeah that answers my question. Thanks for the help! And sorry about getting the question wrong"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1452723327, "post_id": 34773286, "comment_id": 57301206, "body": "Your fun fact turns out to be substantially more interesting than you may realize once you look at the <i>real</i> source code for <code>take</code>."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452724606, "post_id": 34773286, "comment_id": 57301756, "body": "@dfeuer Can you explain? The <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/src/GHC.List.html#take\" rel=\"nofollow noreferrer\">source code</a> I found simply returns the empty list for <code>n&lt;=0</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1452725128, "post_id": 34773286, "comment_id": 57302010, "body": "@Eric, look just below <code>unsafeTake</code> to the <code>RULES</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1452725297, "post_id": 34773286, "comment_id": 57302096, "body": "@Eric, even without the <code>RULES</code>, one is likely to be a bit surprised by the special case for <code>1</code> in <code>unsafeTake</code>."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452748484, "post_id": 34773286, "comment_id": 57308884, "body": "@dfeuer :D ... to be honest I kindof expected the OP to take the naive implementation for take and just try to reason it out ^^"}, {"owner": {"reputation": 6787, "user_id": 549641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c97f3ebc820da8f94f4495a7ba8dc9b6?s=128&d=identicon&r=PG", "display_name": "jmg", "link": "https://stackoverflow.com/users/549641/jmg"}, "edited": false, "score": 2, "creation_date": 1452978562, "post_id": 34773286, "comment_id": 57405927, "body": "Another fun fact: If you precede the given code with <code>import Data.Int</code> and <code>default (Int16)</code>, the given expression returns immediately with <code>[32767,32766,32765]</code>, So keep in mind that <code>[1..]</code> is <i>not always an infinite list</i>. It may as well be finite."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 4, "last_activity_date": 1452707482, "last_edit_date": 1452707482, "creation_date": 1452706419, "answer_id": 34773286, "question_id": 34772591, "link": "https://stackoverflow.com/questions/34772591/haskell-and-lazy-evaluation/34773286#34773286", "title": "Haskell and lazy evaluation", "body": "<p>The answer is <strong>no</strong> - Haskell will not be able to evaluate this (on my system it will eat away tons of memory and crash at some point ;))</p>\n\n<p>The reason is that you just cannot reverse an infinite list. To see this - assuming <code>reverse</code> is defined as:</p>\n\n<pre><code>reverse [] = []\nreverse (x:xs) = reverse xs ++ [x]\n</code></pre>\n\n<p>you would now evaluate </p>\n\n<pre><code>reverse [1..]\n= reverse 1:[2..]\n{ 2nd case }\n= reverse [2..] ++ [1]\n= reverse (2:[3..]) ++ [1]\n{ 2nd case }\n= reverse [3..] ++ [2] ++ [1]\n= ...\n</code></pre>\n\n<p>so you will always see yet another <code>reverse [n..]</code> with increasing <code>n</code> but never the case <code>reverse []</code></p>\n\n<p>So the evaluation will never end - and thus you will never be able to tell  what the first (or 2nd or 3rd) element will be</p>\n\n<hr>\n\n<h3>fun fact</h3>\n\n<p>Haskell has no problem evaluating</p>\n\n<pre><code>take 0 (reverse [1..])\n</code></pre>\n\n<p>though - and this time lazyness <em>wins the day</em> - can you see why?</p>\n"}, {"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1452748861, "post_id": 34778264, "comment_id": 57308970, "body": "nice - still the question (can it be evaluated) would be no ;) (or so I think at 6am without my first coffee intake)"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 0, "last_activity_date": 1452724008, "creation_date": 1452724008, "answer_id": 34778264, "question_id": 34772591, "link": "https://stackoverflow.com/questions/34772591/haskell-and-lazy-evaluation/34778264#34778264", "title": "Haskell and lazy evaluation", "body": "<p>No, that will run forever, but it's <em>possible</em> to write a reverse function that produces the <em>spines</em> of lists lazily, and therefore gives</p>\n\n<pre><code>reverse' [1..] = repeat undefined\n               = undefined : undefined : undefined : ...\n</code></pre>\n\n<p>instead of what the actual implementation gives,</p>\n\n<pre><code>reverse [1..] = undefined\n</code></pre>\n\n<p>Specifically</p>\n\n<pre><code>-- Take two lists and return the second with its\n-- length fixed (perhaps truncated) to that of the\n-- first. Blows up (eventually) if the second list\n-- is shorter.\nwithLengthOf :: [a] -&gt; [b] -&gt; [b]\nwithLengthOf [] _ = []\nwithLengthOf (_ : xs) ~(y : ys) =\n   y : withLengthOf xs ys\n\nreverse' :: [a] -&gt; [a]\nreverse' xs = withLengthOf xs (reverse xs)\n</code></pre>\n\n<p>This is not generally the most useful thing (because lists have very boring spines) and it's somewhat inefficient. That's why the real <code>reverse</code> doesn't bother.</p>\n"}], "owner": {"reputation": 41, "user_id": 5609937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e45b59279056903ea3b256421f842267?s=128&d=identicon&r=PG&f=1", "display_name": "Luxzero", "link": "https://stackoverflow.com/users/5609937/luxzero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 34773286, "answer_count": 2, "score": -2, "last_activity_date": 1452724008, "creation_date": 1452704303, "last_edit_date": 1452706038, "question_id": 34772591, "link": "https://stackoverflow.com/questions/34772591/haskell-and-lazy-evaluation", "title": "Haskell and lazy evaluation", "body": "<p>Because of his lazyness can Haskell evaluate this next expression?</p>\n\n<pre><code>    take 3 (reverse [1..])\n</code></pre>\n\n<p>If so, can you try to explain me how?\nThanks in advance</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "is_accepted": false, "score": -1, "last_activity_date": 1452700997, "creation_date": 1452700997, "answer_id": 34771381, "question_id": 34771339, "link": "https://stackoverflow.com/questions/34771339/what-is-the-idiomatic-way-to-access-part-of-algebraic-data-type-in-haskell/34771381#34771381", "title": "What is the idiomatic way to access part of Algebraic data type in Haskell?", "body": "<p>You could use guards or pattern matching in the functions you are handing a <code>FooBar</code> as an argument.</p>\n"}, {"comments": [{"owner": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "edited": false, "score": 1, "creation_date": 1452702120, "post_id": 34771683, "comment_id": 57288443, "body": "Based on the wording of the question and the type signature of <code>test</code>, I didn&#39;t think bringing up prisms was a good idea;)"}], "tags": [], "owner": {"reputation": 21248, "user_id": 223274, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2a6aad3c8269beb376b3e2b0bd29bec4?s=128&d=identicon&r=PG", "display_name": "Ian Henry", "link": "https://stackoverflow.com/users/223274/ian-henry"}, "is_accepted": true, "score": 2, "last_activity_date": 1452701825, "creation_date": 1452701825, "answer_id": 34771683, "question_id": 34771339, "link": "https://stackoverflow.com/questions/34771339/what-is-the-idiomatic-way-to-access-part-of-algebraic-data-type-in-haskell/34771683#34771683", "title": "What is the idiomatic way to access part of Algebraic data type in Haskell?", "body": "<p>One easier way is to define a helper to get you part of the way there:</p>\n\n<pre><code>data FooBar = Foo Int | Bar String\n\nfoo :: FooBar -&gt; Maybe Int\nfoo (Foo x) = Just x\nfoo _ = Nothing\n\ntest :: Maybe Int -&gt; Bool\nx :: FooBar\n\nresult :: Bool\nresult = test . foo $ x\n</code></pre>\n\n<p>If you're the one defining <code>test</code>, you could also just define it differently to make things easier on yourself:</p>\n\n<pre><code>test' :: FooBar -&gt; Bool\ntest' (Foo x) = (some logic)\ntest' _ = (the default value)\n</code></pre>\n\n<p>There is a neat concept called a \"prism\" that models this general concept -- extracting pieces of data from sum types -- elegantly. But they're... kind of hard to understand, and whether or not they can be considered \"idiomatic\" is pretty controversial.</p>\n"}], "owner": {"reputation": 2216, "user_id": 2260919, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6732557387dfa9107c693e19b95b292e?s=128&d=identicon&r=PG", "display_name": "ais", "link": "https://stackoverflow.com/users/2260919/ais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "accepted_answer_id": 34771683, "answer_count": 2, "score": 0, "last_activity_date": 1452701825, "creation_date": 1452700898, "question_id": 34771339, "link": "https://stackoverflow.com/questions/34771339/what-is-the-idiomatic-way-to-access-part-of-algebraic-data-type-in-haskell", "title": "What is the idiomatic way to access part of Algebraic data type in Haskell?", "body": "<p>There is an easier way to call function <code>test</code> with value <code>x</code> than using <code>case</code> expression?</p>\n\n<pre><code>data FooBar = Foo Int | Bar String\n\ntest :: Maybe Int -&gt; Bool -- Int from Foo constructor\n\nx :: FooBar\n</code></pre>\n"}, {"tags": ["haskell", "recursion", "sieve-of-eratosthenes"], "comments": [{"owner": {"reputation": 3199, "user_id": 2864062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/837cfd1b02c3b7dbf6448a6b2314ed23?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Hansen", "link": "https://stackoverflow.com/users/2864062/steven-hansen"}, "edited": false, "score": 4, "creation_date": 1452699895, "post_id": 34770836, "comment_id": 57286726, "body": "Refreshing to see someone just asking for a point in the right direction instead of for someone else to do all the work."}], "answers": [{"comments": [{"owner": {"reputation": 106, "user_id": 4092041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a17a05c8dc308682b1240b39aece7362?s=128&d=identicon&r=PG&f=1", "display_name": "eeKat88", "link": "https://stackoverflow.com/users/4092041/eekat88"}, "edited": false, "score": 1, "creation_date": 1452701645, "post_id": 34771456, "comment_id": 57288066, "body": "Thanks for the points. About (2), its a typo. The idea was to apply <code>removep</code> with arguments <code>(\\x -&gt; (mod x h) == 0) </code>and <code>t</code> so that whatever is divisible by the head of the list gets removed."}], "tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": false, "score": 3, "last_activity_date": 1452701234, "creation_date": 1452701234, "answer_id": 34771456, "question_id": 34770836, "link": "https://stackoverflow.com/questions/34770836/sieve-of-eratosthenes-infinite-list/34771456#34771456", "title": "Sieve of Eratosthenes infinite list", "body": "<p>There are a few errors in your code:</p>\n\n<ol>\n<li><p>You want to define a <code>sieve</code> list that should be the list of primes, but in the <code>where</code> you <em>shadow</em> the name <code>sieve</code> with a function. Inside this definition you use <code>sieve</code> as a list, but here it actually references the function and thus you get a typeerror.</p>\n\n<p>You want to apply a function to <code>drop 1 nats</code> to obtain the list of primes.</p></li>\n<li><p>In <code>mod x p</code> it should be <code>mod x h</code> since <code>h</code> is the prime you are considering there.</p></li>\n<li><p>You are defining <code>sieve (h:t) = h:removep ... :_</code>  But here you are creating a list where the first element is <code>h</code>, a number, the second element is <code>removep ...</code>, which is a list, and then the remaining elements are taken by <code>sieve</code> (which is incorrect as already said.</p></li>\n<li><p>Nitpicking: technically this is not the sieve of eratosthenes because in the algorithm of the sieve you <em>never</em> actually use <code>mod</code> to check for divisibility. </p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 2530, "user_id": 3669940, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gUupX.jpg?s=128&g=1", "display_name": "qbit", "link": "https://stackoverflow.com/users/3669940/qbit"}, "is_accepted": true, "score": 1, "last_activity_date": 1452706816, "creation_date": 1452706816, "answer_id": 34773397, "question_id": 34770836, "link": "https://stackoverflow.com/questions/34770836/sieve-of-eratosthenes-infinite-list/34773397#34773397", "title": "Sieve of Eratosthenes infinite list", "body": "<p>The basic idea is that you get the list of <code>nats</code> as a starting point for sieve. Then you recursively apply your <code>removep</code> function with your predicate to all but the first elements. </p>\n\n<p>You are close, but i think your problem lies in the notation (see Bakuriu's answer)\nI won't give you the answer but i will give you a hint:</p>\n\n<pre><code>sieve = s (drop 1 nats)\n  where\n    -- Recursive definition of s here\n    -- s (h:t) = ???\n</code></pre>\n\n<p>I hope i didn't give away too much to make it trivial. Good luck.</p>\n\n<p><strong>PS</strong>: As Bakuriu mentioned, this is really not a true sieve. For more info on the matter, take a look <a href=\"https://www.cs.hmc.edu/~oneill/papers/Sieve-JFP.pdf\" rel=\"nofollow\"><strong>here</strong></a></p>\n"}], "owner": {"reputation": 106, "user_id": 4092041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a17a05c8dc308682b1240b39aece7362?s=128&d=identicon&r=PG&f=1", "display_name": "eeKat88", "link": "https://stackoverflow.com/users/4092041/eekat88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "accepted_answer_id": 34773397, "answer_count": 2, "score": 4, "last_activity_date": 1452706816, "creation_date": 1452699608, "question_id": 34770836, "link": "https://stackoverflow.com/questions/34770836/sieve-of-eratosthenes-infinite-list", "title": "Sieve of Eratosthenes infinite list", "body": "<p>Hello i have to implement a function for sieve of Eratosthenes.</p>\n\n<p>I already have a function</p>\n\n<pre><code>removep p l\n</code></pre>\n\n<p>that removes elements of <code>l</code> that match the predicate <code>p</code> and a function</p>\n\n<pre><code>nats\n</code></pre>\n\n<p>that returns an infinite list of naturals numbers, and i am supposed to use both in my solution.</p>\n\n<p>Now, i do understand how the sieve itself works but it seems i am having problems implementing this.</p>\n\n<p>I am doing something like this:</p>\n\n<pre><code>sieve = (drop 1 nats)\n where\n   sieve (h:t) = h : (removep (\\x -&gt; (mod x p) == 0) t) : sieve\n</code></pre>\n\n<p>but this doesn't seem to work. Any help?\nAlso note that this is an assignment so if possible do not give away the exact solution. Id rather get an idea of what i am doing wrong and how i need to change it. Thanks in advance.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 4, "creation_date": 1452695822, "post_id": 34769083, "comment_id": 57283603, "body": "Haskell is an expression-oriented language. Everything on the RHS of an <code>=</code> (or <code>-&gt;</code> in case expressions) is an expression.<code>do</code> blocks are fancy expressions, but not appropriate for this use case. For your case, you really should think about what the <i>result</i> needs to be.  Then write an expression describing it."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1452696989, "post_id": 34769083, "comment_id": 57284460, "body": "I think you are pretty close - you just have to realize that you don&#39;t want to <i>do</i> something - indeed you are trying to return a <code>list</code> of moves - you have to <i>concat</i> the results somehow ;) .... also to the downvoters: shame on you - this is a good question - maybe not PhD level but please keep the community friendly to beginners!"}, {"owner": {"reputation": 131, "user_id": 5769707, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ddc1d07e117c045e0fb404507e3f40a7?s=128&d=identicon&r=PG&f=1", "display_name": "Nia", "link": "https://stackoverflow.com/users/5769707/nia"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1452697396, "post_id": 34769083, "comment_id": 57284749, "body": "@Carsten Thank you for such sweet, kind and motivational comment, I will try to think of concating the result.Its good to hear that I am some what close to the solution :) Thanks again!!!!"}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 5769707, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ddc1d07e117c045e0fb404507e3f40a7?s=128&d=identicon&r=PG&f=1", "display_name": "Nia", "link": "https://stackoverflow.com/users/5769707/nia"}, "edited": false, "score": 1, "creation_date": 1452697924, "post_id": 34770113, "comment_id": 57285164, "body": "Thank you a millions, indeed this was what I was struggling with. Thank you for being so kind and helpful!!!!! :)"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 9, "last_activity_date": 1452697695, "creation_date": 1452697695, "answer_id": 34770113, "question_id": 34769083, "link": "https://stackoverflow.com/questions/34769083/executing-multiple-commands-in-the-same-function-haskell/34770113#34770113", "title": "Executing multiple commands in the same function (Haskell)", "body": "<p>to help you out a bit here is a way to get it to compile and work (well almost):</p>\n\n<pre><code>type Rod = String\ntype Move = (Integer, Rod, Rod)\n\nhanoi :: Integer -&gt; Rod -&gt; Rod -&gt; Rod -&gt; [Move]\nhanoi n source helper destination =\n  if n==1 then\n    [(n, source, destination)]\n  else\n    hanoi (n-1) source helper destination \n    ++ [(n, source, destination)]\n    ++ hanoi (n-1) helper destination source\n</code></pre>\n\n<p>the things I changed are:</p>\n\n<ul>\n<li>gave a type for <code>Move</code> (I hope you wanted a tuple)</li>\n<li>changed the results into tuple (<code>(n source destination) -&gt; (n,source,destination)</code>)</li>\n<li>concatenated the results with <code>++</code></li>\n</ul>\n\n<p>Now you only have to fix a slight problem with the order of the operations ;) and it should print you a solution :D</p>\n"}], "owner": {"reputation": 131, "user_id": 5769707, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ddc1d07e117c045e0fb404507e3f40a7?s=128&d=identicon&r=PG&f=1", "display_name": "Nia", "link": "https://stackoverflow.com/users/5769707/nia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 929, "favorite_count": 2, "accepted_answer_id": 34770113, "answer_count": 1, "score": 1, "last_activity_date": 1452697695, "creation_date": 1452694882, "last_edit_date": 1452696794, "question_id": 34769083, "link": "https://stackoverflow.com/questions/34769083/executing-multiple-commands-in-the-same-function-haskell", "title": "Executing multiple commands in the same function (Haskell)", "body": "<p>I am trying to execute few statements in my function in Haskell,\nI looked online and got the idea that may be if I use \"do\" I can be able to do that.I used that but it still is not working for me, If some one can please have a look and guide me what I am doing wrong, I have just started with haskell, so its a little struggle with Haskell syntax.</p>\n\n<p>My function: </p>\n\n<pre><code>type Rod = String\nMove = (Integer, Rod, Rod)\nhanoi :: Integer -&gt; Rod -&gt; Rod -&gt; Rod -&gt; [Move]\nhanoi n source helper destination= if n==1 then [(n source destination)] else do\n                                (hanoi (n-1) source helper destination) \n                                ([n source destination]) \n                                (hanoi (n-1) helper destination source)\n</code></pre>\n\n<p>I am trying to do the towers of Hanoi problem.and I want to execute the three statements that are after \"do\". Any help would be highly appreciated . </p>\n\n<p>Thanks in advance!!!</p>\n"}, {"tags": ["algorithm", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1452691628, "post_id": 34765868, "comment_id": 57280644, "body": "I don&#39;t know how much of a hint you want, but your algorithm does not always find the best (= minimum product) path."}], "answers": [{"comments": [{"owner": {"reputation": 1690, "user_id": 5691928, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/pm6iL.jpg?s=128&g=1", "display_name": "Ratan Senapathy", "link": "https://stackoverflow.com/users/5691928/ratan-senapathy"}, "edited": false, "score": 1, "creation_date": 1454562462, "post_id": 34791853, "comment_id": 58102821, "body": "Thank you. I realized this after a few days and corrected the code. Now it works. Thank you again"}], "tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 1, "last_activity_date": 1452787471, "last_edit_date": 1452787471, "creation_date": 1452781197, "answer_id": 34791853, "question_id": 34765868, "link": "https://stackoverflow.com/questions/34765868/solving-chrl4-on-code-chef-chef-and-way-in-haskell/34791853#34791853", "title": "Solving CHRL4 on code chef (CHEF and Way) in Haskell", "body": "<p>Your algorithm doesn't always give the smallest product for all the inputs, e.g. this one:</p>\n\n<pre><code>5 2\n3 2 3 2 3\n</code></pre>\n\n<p>The <a href=\"https://discuss.codechef.com/questions/37605/chrl4-editorial\" rel=\"nofollow\">editorial</a> explained the problem throughout, you really should read it again.  </p>\n\n<p>This problem is basically a shortest path problem, streets are vertices, possible movements from street to street are edges of the graph, the weight of an edge is determined by the special value of the tail alone. While the total movement cost is defined as the product but not the sum of all the costs,  the question can be normalized by taking logarithms of all the special values, since</p>\n\n<blockquote>\n  <p>a * b = exp(log(a) + log(b))  </p>\n</blockquote>\n\n<p>Given log is monotonically increasing function, the minimal product is just the minimal sum of logarithms.</p>\n\n<p>In editorial the editor picked Dijkstra's algorithm, but after taking the log transformation, it will be a standard shortest path problem and can be solved with any shortest path algorithm you like.</p>\n\n<p>There are many implementations of Dijkstra's algorithm in Haskell, I found two on Hackage and one <a href=\"http://rosettacode.org/wiki/Dijkstra&#39;s_algorithm#Haskell\" rel=\"nofollow\">here</a>. The parsing and graph initializing code is straight forward.</p>\n\n<pre><code>import           Control.Monad      (foldM)\nimport           Control.Monad.ST\nimport           Data.Array\nimport           Data.Array.MArray\nimport           Data.Array.ST\nimport           Data.Function      (on)\nimport           Data.IntMap.Strict as M\nimport           Data.List          (groupBy)\nimport           Data.Set           as S\n\n-- Code from http://rosettacode.org/wiki/Dijkstra's_algorithm#Haskell\ndijkstra :: (Ix v, Num w, Ord w, Bounded w) =&gt; v -&gt; v -&gt; Array v [(v,w)] -&gt; (Array v w, Array v v)\ndijkstra src invalid_index adj_list = runST $ do\n  min_distance &lt;- newSTArray b maxBound\n  writeArray min_distance src 0\n  previous &lt;- newSTArray b invalid_index\n  let aux vertex_queue =\n        case S.minView vertex_queue of\n          Nothing -&gt; return ()\n          Just ((dist, u), vertex_queue') -&gt;\n            let edges = adj_list Data.Array.! u\n                f vertex_queue (v, weight) = do\n                  let dist_thru_u = dist + weight\n                  old_dist &lt;- readArray min_distance v\n                  if dist_thru_u &gt;= old_dist then\n                    return vertex_queue\n                  else do\n                    let vertex_queue' = S.delete (old_dist, v) vertex_queue\n                    writeArray min_distance v dist_thru_u\n                    writeArray previous v u\n                    return $ S.insert (dist_thru_u, v) vertex_queue'\n            in\n            foldM f vertex_queue' edges &gt;&gt;= aux\n  aux (S.singleton (0, src))\n  m &lt;- freeze min_distance\n  p &lt;- freeze previous\n  return (m, p)\n  where b = bounds adj_list\n        newSTArray :: Ix i =&gt; (i,i) -&gt; e -&gt; ST s (STArray s i e)\n        newSTArray = newArray\n\nshortest_path_to :: (Ix v) =&gt; v -&gt; v -&gt; Array v v -&gt; [v]\nshortest_path_to target invalid_index previous =\n  aux target [] where\n    aux vertex acc | vertex == invalid_index = acc\n                   | otherwise = aux (previous Data.Array.! vertex) (vertex : acc)\n\n\n-- Code I wrote\ninstance Bounded Double where\n    minBound = -1e100\n    maxBound = 1e100\n\nconstructInput :: Int -&gt; Int -&gt; M.IntMap Integer -&gt; Array Int [(Int, Double)]\nconstructInput n k specMap =\n    let\n        specMap' = fmap (log . fromIntegral) specMap\n        edges = [(src, [(dest, specMap' M.! dest) | dest &lt;- [src+1..src+k], dest &lt;= n]) | src &lt;- [1..n]]\n    in\n        array (1, n) edges\n\nmain :: IO ()\nmain = do\n    rawInput &lt;- getContents\n    let\n        [l, l'] = lines rawInput\n        [n,k] = fmap read . words $ l\n        specs = fmap read . words $ l'\n        specMap = M.fromList $ [1..n] `zip` specs\n        adj_list = constructInput n k specMap\n        (_, previous) = dijkstra 1 0 adj_list\n        path = shortest_path_to n 0 previous\n        weight = (product $ fmap (specMap M.!) path) `mod` 1000000007\n    print weight\n</code></pre>\n\n<p>PS: My program scores 30 with a lot of TLE (short for \"Too Long Execution\" I guess) on CodeChief, for the full mark you may have to try it yourself and get a better solution.</p>\n"}], "owner": {"reputation": 1690, "user_id": 5691928, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/pm6iL.jpg?s=128&g=1", "display_name": "Ratan Senapathy", "link": "https://stackoverflow.com/users/5691928/ratan-senapathy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1533, "favorite_count": 0, "accepted_answer_id": 34791853, "answer_count": 1, "score": 1, "last_activity_date": 1452787471, "creation_date": 1452685491, "last_edit_date": 1452705109, "question_id": 34765868, "link": "https://stackoverflow.com/questions/34765868/solving-chrl4-on-code-chef-chef-and-way-in-haskell", "title": "Solving CHRL4 on code chef (CHEF and Way) in Haskell", "body": "<p>I am trying to solve this question in Haskell but the codechef compiler keeps on saying it is the wrong answer. The question is as follows:</p>\n\n<p>After visiting a childhood friend, Chef wants to get back to his home. Friend lives at the first street, and Chef himself lives at the N-th (and the last) street. Their city is a bit special: you can move from the X-th street to the Y-th street if and only if 1 &lt;= Y - X &lt;= K, where K is the integer value that is given to you. Chef wants to get to home in such a way that the product of all the visited streets' special numbers is minimal (including the first and the N-th street). Please, help him to find such a product.\nInput</p>\n\n<p>The first line of input consists of two integer numbers - N and K - the number of streets and the value of K respectively. The second line consist of N numbers - A1, A2, ..., AN respectively, where Ai equals to the special number of the i-th street.\nThe output should be modulo 1000000007</p>\n\n<p>Input</p>\n\n<p>4 2</p>\n\n<p>1 2 3 4</p>\n\n<p>Output</p>\n\n<p>8</p>\n\n<p>The solution I used is as follows:</p>\n\n<pre><code>import qualified Data.ByteString.Char8 as B\nimport Data.Maybe (fromJust)\n\n\nfindMinIndex x index minIndex n\n      | index == n = minIndex\n      | (x!!index) &lt; (x!!minIndex) = findMinIndex x (index+1) index n\n      | otherwise = findMinIndex x (index+1) minIndex n\n\n\nminCost []     _ = 1\nminCost (x:xs) k = let indexList = take k xs\n                       minIndex = findMinIndex indexList 0 0 (length indexList)\n                   in x * minCost(drop minIndex xs) k\n\nmain :: IO()\nmain = do\n       t &lt;- B.getContents\n       let inputs = B.lines t\n       let firstLine = inputs !! 0\n       let secondLine = inputs !! 1\n       let [n,k] = map (fst . fromJust . B.readInt) $ B.split ' ' firstLine\n       let specialNums = reverse $ map (fst . fromJust . B.readInteger) $ B.split ' ' secondLine\n       putStrLn $ show ((minCost specialNums k) `mod` 1000000007)\n</code></pre>\n\n<hr>\n\n<p>It worked for the given test case and a few other test cases I tries out. But it is not being accepted by codechef. I followed the editorial for the problem and made it. Basically starting from the last number in the list of special numbers the program search it's immediate k predecessors and finds the minimum one in that range and multiplies it with the current value and so on till the beginning of the list</p>\n"}, {"tags": ["haskell", "yesod", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": false, "score": 1, "last_activity_date": 1452694135, "creation_date": 1452694135, "answer_id": 34768818, "question_id": 34764371, "link": "https://stackoverflow.com/questions/34764371/directory-structure-yesod-and-stack/34768818#34768818", "title": "Directory Structure Yesod and Stack", "body": "<p>If you take the standard Yesod scaffolding, it should compile without issue with Stack (I am actually doing that right now, as a matter of fact). I'd recommend against moving the scaffolded files around until you're familiar with the setup. If you really want to move the source files, I'd recommend keeping the templates in the original location.</p>\n"}], "owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1452699040, "creation_date": 1452681343, "last_edit_date": 1452699040, "question_id": 34764371, "link": "https://stackoverflow.com/questions/34764371/directory-structure-yesod-and-stack", "title": "Directory Structure Yesod and Stack", "body": "<p>I have a simple Yesod project with the usual directory structure like this:</p>\n\n<pre><code>./Main.hs\n./Foundation.hs\n./Handler/Home.hs\n./Handler/... etc\n./config/routes\n./templates/home.hamlet\n./templates/default-layout.hamlet\n./templates/default-layout-wrapper.hamlet\n./templates/default-layout-wrapper.cassius\n...\n</code></pre>\n\n<p>I am trying to build this project with stack, where typically the <code>Main.hs</code> program is under the <code>app</code> directory.  </p>\n\n<p>I have tried to place all the Yesod structure under the <code>app</code> dir (the <code>app</code> dir is the <code>.</code> above).  </p>\n\n<p>the project's cabal file looks like this:</p>\n\n<pre><code>executable proj-web01-exe\n  hs-source-dirs:      app\n  main-is:             Main.hs\n  ghc-options:         -threaded -rtsopts -with-rtsopts=-N\n  build-depends:       base, bytestring, split, filepath\n                     , stm, data-default, text, conduit, conduit-extra\n                     , containers, resourcet, blaze-html, blaze-markup\n                     , shakespeare, yesod, yesod-static\n                     , proj-web01\n  default-language:    Haskell2010\n</code></pre>\n\n<p>Now when I try to <code>stack build</code>, I get the following error message :</p>\n\n<pre><code>[1 of 6] Compiling Foundation       ( app/Foundation.hs, .stack-work/dist/x86_64-linux/Cabal-1.22.5.0/build/proj-web01-exe/proj-web01-exe-tmp/Foundation.o )\n\n/home/me/proj-web01/app/Foundation.hs:46:35:\n    Exception when trying to run compile-time code:\n      Called widgetFileNoReload on \"default-layout\", but no templates were found.\n    Code: widgetFileNoReload (def) \"default-layout\"\n    In the splice: $(widgetFileNoReload def \"default-layout\")\n\n--  While building package proj-web01-0.1.0.0 using:\n      /home/me/.stack/setup-exe-cache/x86_64-linux/setup-Simple-Cabal-1.22.5.0-ghc-7.10.3 --builddir=.stack-work/dist/x86_64-linux/Cabal-1.22.5.0 build lib:proj-web01 exe:proj-web01-exe --ghc-options \" -ddump-hi -ddump-to-file\"\n    Process exited with code: ExitFailure 1\n</code></pre>\n\n<p><code>widgetFileNoReload</code> does not know where to find the \"default-layout\" files, which are in the <code>app/templates</code> directory. </p>\n\n<p><strong>My question :</strong> should I write the cabal file differently, or should I place the templates, Handler... folders elsewhere (eg in src)? What is the most natural directory structure when using stack? Or alternatively how to set up stack parameters (cabal and yaml files) to fit a usual Yesod directory structure?</p>\n"}, {"tags": ["haskell", "haskell-lens", "lenses"], "answers": [{"tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 13, "last_activity_date": 1452662182, "creation_date": 1452662182, "answer_id": 34758882, "question_id": 34758746, "link": "https://stackoverflow.com/questions/34758746/how-to-compose-lenses-that-return-maybe-haskell/34758882#34758882", "title": "How to compose lenses that return Maybe (Haskell)", "body": "<p>Use the <code>_Just</code> prism to set values in a Map conditional on whether the key exists. That's what prisms are for!</p>\n\n\n\n<pre><code>\u03bb&gt; let m = fromList [(1, (2, 3))]\n\u03bb&gt; m &amp; at 1 . _Just . _2 .~ 4\nfromList [(1,(2,4))]\n\u03bb&gt; m &amp; at 100 . _Just . _2 .~ 4\nfromList [(1,(2,3))]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "is_accepted": false, "score": 3, "last_activity_date": 1453558019, "creation_date": 1453558019, "answer_id": 34964449, "question_id": 34758746, "link": "https://stackoverflow.com/questions/34758746/how-to-compose-lenses-that-return-maybe-haskell/34964449#34964449", "title": "How to compose lenses that return Maybe (Haskell)", "body": "<p>To set a value you can just write:</p>\n\n<pre><code>&gt; m &amp; ix 1 . _2 .~ 4\nfromList [(1,(2,4))]\n</code></pre>\n\n<p>To get a value, you can do something similar:</p>\n\n<pre><code>&gt; m ^? ix 1 . _2\nJust 3\n</code></pre>\n"}], "owner": {"reputation": 950, "user_id": 2430739, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fd47a57b46a46d55f7a8dde166ea3742?s=128&d=identicon&r=PG", "display_name": "holdenlee", "link": "https://stackoverflow.com/users/2430739/holdenlee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1300, "favorite_count": 2, "accepted_answer_id": 34758882, "answer_count": 2, "score": 7, "last_activity_date": 1453558019, "creation_date": 1452661479, "last_edit_date": 1452670721, "question_id": 34758746, "link": "https://stackoverflow.com/questions/34758746/how-to-compose-lenses-that-return-maybe-haskell", "title": "How to compose lenses that return Maybe (Haskell)", "body": "<p>Suppose I have a lens like <code>at _</code> that needs some <code>Maybe a</code>:</p>\n\n<pre><code>import Data.Map as M\nm = M.fromList [(1,(2,3))]\n--set 2nd element\nm ^. at 1 .~ Just (4,5) \n--gives fromList [(1,(4,5))]\nm ^. at 1 .~ Nothing\n--gives fromList ()\n</code></pre>\n\n<p>Now suppose I want to compose it with another lens. The fact that this lens returns some <code>Maybe a</code> prevents me from doing it directly.</p>\n\n<pre><code>m ^. at 1 . _2 .~ Just 4\n--error\n-- I want to get M.fromList [(1,(2,4))]\n</code></pre>\n\n<p>What's the right way to do this?</p>\n"}, {"tags": ["haskell", "type-families", "foldable", "classy-prelude"], "answers": [{"comments": [{"owner": {"reputation": 2704, "user_id": 2629787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/HApc9.jpg?s=128&g=1", "display_name": "Koz Ross", "link": "https://stackoverflow.com/users/2629787/koz-ross"}, "edited": false, "score": 0, "creation_date": 1452659974, "post_id": 34758460, "comment_id": 57262543, "body": "Thanks for that - no &#39;minimal implementation&#39; was described in the type, I really wasn&#39;t sure what was actually needed or not.   Also, why do you now know that you&#39;ll never use classy-prelude? Could this be fixed upstream?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 2704, "user_id": 2629787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/HApc9.jpg?s=128&g=1", "display_name": "Koz Ross", "link": "https://stackoverflow.com/users/2629787/koz-ross"}, "edited": false, "score": 1, "creation_date": 1452660260, "post_id": 34758460, "comment_id": 57262636, "body": "@KozRoss I like some power in the prelude but ultimately the prelude should be principled and rather simple.  Even with our now rather large default Prelude in GHC the principles are clear and no particularly complex features are used - Kinds, MPTC, TypeFamilies are all elsewhere.  It doesn&#39;t depend on a large set of libraries or huge set of datatypes that some author probably thinks should have been part of the language."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 1, "creation_date": 1452675277, "post_id": 34758460, "comment_id": 57269428, "body": "This is a silly conclusion to make from the fact that there are default implementations of functions available. Default implementations are available to address the common case of polymorphic containers (like lists and vectors), and need to be overridden otherwise. I can&#39;t figure out any way you&#39;ve concluded that this is not a well principled design from this (very standard) usage of defaulting."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 3, "last_activity_date": 1452660040, "last_edit_date": 1452660040, "creation_date": 1452659532, "answer_id": 34758460, "question_id": 34758264, "link": "https://stackoverflow.com/questions/34758264/cannot-understand-why-monofoldable-for-my-type-doesnt-compile-or-the-error-mes/34758460#34758460", "title": "Cannot understand why MonoFoldable for my type doesn&#39;t compile, or the error message", "body": "<p>Have you tried actually implementing the class?  It appears there is some oddity with the default definitions and your type family.  If you define at least the below then the file type checks:</p>\n\n<pre><code>instance MonoFoldable (RuleSet a) where --this is unhappy\n    ofoldl1Ex' = undefined\n    ofoldr1Ex  = undefined\n    ofoldl'    = undefined\n    ofoldr     = undefined\n    ofoldMap   = undefined\n</code></pre>\n\n<p>EDIT: The classy prelude, which I now know I will never use, has default implementations and type signatures that include the constraints <code>t a ~ mono, a ~ Element (t a)</code>.  Working carefully since I had to think twice here.  <code>t a ~ RuleSet a0</code> so <code>t == RuleSet</code> and <code>a == a0</code>.  Then <code>a ~ Element (RuleSet a)</code>, which is your exact error in the message, would suggest <code>a ~ Rule a</code> and that just isn't right.</p>\n"}, {"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": false, "score": 3, "last_activity_date": 1452675852, "creation_date": 1452675852, "answer_id": 34762361, "question_id": 34758264, "link": "https://stackoverflow.com/questions/34758264/cannot-understand-why-monofoldable-for-my-type-doesnt-compile-or-the-error-mes/34762361#34762361", "title": "Cannot understand why MonoFoldable for my type doesn&#39;t compile, or the error message", "body": "<p>To clarify about the default implementations: since there are a large number of types out there which are properly polymorphic - and therefore instances of <code>Functor</code> - <code>MonoFunctor</code> provides an easy way to make those also instances of <code>MonoFunctor</code>, via <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/type-class-extensions.html#class-default-signatures\" rel=\"nofollow\">default method signatures</a>. In the case where you have a <code>Functor</code>, simply declaring <code>instance MonoFunctor</code> is sufficient.</p>\n\n<p>In your case, you get a confusing error message since your type is actually a <code>Functor</code>, but for a different type than your desired <code>MonoFunctor</code> instance. Specifically, by its shape, <code>RuleSet a</code> is a <code>Functor</code> for <code>a</code>, while you want it to be <code>Rule a</code>. There's nothing wrong with that, it just conflicts with the default implementations, and therefore you need to provide separate implementations.</p>\n\n<p>Note that this isn't specific to your type: anything which isn't a simple translation from <code>Functor</code> to <code>MonoFunctor</code> requires this work. This applies to some of the built-in instances, like <code>Text</code> and <code>ByteString</code>.</p>\n"}], "owner": {"reputation": 2704, "user_id": 2629787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/HApc9.jpg?s=128&g=1", "display_name": "Koz Ross", "link": "https://stackoverflow.com/users/2629787/koz-ross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 34758460, "answer_count": 2, "score": 1, "last_activity_date": 1452675852, "creation_date": 1452658284, "last_edit_date": 1452658829, "question_id": 34758264, "link": "https://stackoverflow.com/questions/34758264/cannot-understand-why-monofoldable-for-my-type-doesnt-compile-or-the-error-mes", "title": "Cannot understand why MonoFoldable for my type doesn&#39;t compile, or the error message", "body": "<p>I have the following code:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>{-# LANGUAGE NoImplicitPrelude, OverloadedStrings, TypeFamilies #-}\n\nmodule AI.Analysis.Rules where\n\nimport ClassyPrelude\n\n-- Our set of rules\n\ndata RuleSet a = RuleSet [Rule a] [Rule a]\n  deriving (Eq)\n\nmkRuleSet :: (Ord a) =&gt; [Rule a] -&gt; RuleSet a\nmkRuleSet rules = uncurry RuleSet (partition isStandard uniques)\n  where uniques = ordNub rules\n        isStandard x = case x of\n          Standard _ _ -&gt; True\n          LastResort _ -&gt; False\n\ninstance (Show a) =&gt; Show (RuleSet a) where\n  show (RuleSet s l) = unlines [toLines s, \"----\", toLines l]\n    where toLines = unlines . fmap show\n\ninstance (Ord a) =&gt; Monoid (RuleSet a) where\n  mempty = RuleSet [] []\n  mappend (RuleSet s1 l1) (RuleSet s2 l2) = RuleSet (ordNub (s1 ++ s2)) (ordNub (l1 ++ l2))\n\ninstance (Ord a) =&gt; Semigroup (RuleSet a) where\n  (&lt;&gt;) = mappend\n\ntype instance Element (RuleSet a) = (Rule a)\n\ninstance MonoFoldable (RuleSet a) --this is unhappy\n\n-- A rule in our system\n-- For now, we assume rules *individually* are always internally-consistent\n\ndata Rule a = Standard [a] a | LastResort a\n  deriving (Eq)\n\nmkRule :: (Eq a, Ord a) =&gt; [a] -&gt; a -&gt; Rule a\nmkRule as c = case as of\n  [] -&gt; LastResort c\n  _ -&gt; Standard ((sort . ordNub) as) c\n\n-- Last-resort rules and standard rules cannot be compared for consistency\nmutuallyConsistent :: (Eq a) =&gt; Rule a -&gt; Rule a -&gt; Maybe Bool\nmutuallyConsistent (LastResort c1) (LastResort c2) = Just (c1 == c2)\nmutuallyConsistent (Standard as1 c1) (Standard as2 c2) = Just ((as1 /= as2) || (c1 == c2))\nmutuallyConsistent _ _ = Nothing\n\ninstance (Show a) =&gt; Show (Rule a) where\n  show x = case x of\n    Standard as c -&gt; formatAnd as ++ \" -&gt; \" ++ show c\n    LastResort c -&gt; \"-&gt; \" ++ show c\n     where formatAnd = unwords . intersperse \"^\" . map show . otoList\n\n -- LastResort rules are always ordered smaller than standard ones\n instance (Ord a) =&gt; Ord (Rule a) where\n   (&lt;=) (LastResort _) (Standard _ _) = True\n   (&lt;=) (Standard _ _) (LastResort _) = False\n   (&lt;=) (LastResort c1) (LastResort c2) = c1 &lt;= c2\n   (&lt;=) (Standard as1 c1) (Standard as2 c2) = (as1 &lt;= as2) || (c1 &lt;= c2)\n</code></pre>\n\n<p>However, I get the following error from the compiler, whose meaning I am having trouble understanding:</p>\n\n<pre><code>/home/koz/documents/uni/research/summer-research-2015/clinical/rules-analysis/src/AI/Analysis/Rules.hs:47:10:\n    Couldn't match type \u2018a\u2019 with \u2018Rule a\u2019\n      \u2018a\u2019 is a rigid type variable bound by\n          the instance declaration\n          at /home/koz/documents/uni/research/summer-research-2015/clinical/rules-analysis/src/AI/Analysis/Rules.hs:47:10\n    Expected type: Element (RuleSet a)\n      Actual type: a\n    Relevant bindings include\n      ofoldMap :: (Element (RuleSet a) -&gt; m) -&gt; RuleSet a -&gt; m\n        (bound at /home/koz/documents/uni/research/summer-research-2015/clinical/rules-analysis/src/AI/Analysis/Rules.hs:47:10)\n    In the expression:\n      mono-traversable-0.10.0.1:Data.MonoTraversable.$gdmofoldMap\n    In an equation for \u2018ofoldMap\u2019:\n        ofoldMap\n          = mono-traversable-0.10.0.1:Data.MonoTraversable.$gdmofoldMap\n    In the instance declaration for \u2018MonoFoldable (RuleSet a)\u2019\n</code></pre>\n\n<p>Near as I can tell, my thinking seems to make sense - after all, a <code>RuleSet</code> is just a container for <code>Rule</code>s, which should allow for foldability, but the error message in question doesn't make any sense to me. Could someone please clarify what I failed to grasp here?</p>\n"}, {"tags": ["haskell", "dependent-type", "type-level-computation"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1452658149, "post_id": 34757783, "comment_id": 57261979, "body": "That&#39;s a datatype context. Datatype contexts are utterly useless. I suspect you&#39;re not going to be able to do exactly what you&#39;re trying to do in Haskell just yet, but singletons can do some weird stuff...."}, {"owner": {"reputation": 85, "user_id": 1976901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/426a40922f9a318fbb20393dec3c575c?s=128&d=identicon&r=PG", "display_name": "Aistis Raulinaitis", "link": "https://stackoverflow.com/users/1976901/aistis-raulinaitis"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452658532, "post_id": 34757783, "comment_id": 57262081, "body": "Yes, you are right, datatype contexts are not exactly how I would want to do this. But they get the point across. I am able to reify the type value and do the comparison at the value level, but this isn&#39;t what I want to do."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452658706, "post_id": 34757783, "comment_id": 57262122, "body": "Can you explain a bit better what exactly your ultimate goal is here? What do you want to express, really?"}, {"owner": {"reputation": 85, "user_id": 1976901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/426a40922f9a318fbb20393dec3c575c?s=128&d=identicon&r=PG", "display_name": "Aistis Raulinaitis", "link": "https://stackoverflow.com/users/1976901/aistis-raulinaitis"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452658910, "post_id": 34757783, "comment_id": 57262195, "body": "I just want to be able to take a type level nat and a type level list and check that n ~ Length ls at the type level, I don&#39;t want to do it at the value level. I edited my OP with additional details."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452659486, "post_id": 34757783, "comment_id": 57262368, "body": "Have you looked at frightening things like <code>Data.Singletons.Prelude.Eq</code>? I don&#39;t know what to make of that, but there might well be a simpler way."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 1976901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/426a40922f9a318fbb20393dec3c575c?s=128&d=identicon&r=PG", "display_name": "Aistis Raulinaitis", "link": "https://stackoverflow.com/users/1976901/aistis-raulinaitis"}, "edited": false, "score": 0, "creation_date": 1452660132, "post_id": 34758520, "comment_id": 57262603, "body": "Good example, but I want to use GHC&#39;s builtin type nats. Plus I answered my own question!"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1452659941, "creation_date": 1452659941, "answer_id": 34758520, "question_id": 34757783, "link": "https://stackoverflow.com/questions/34757783/equality-constraints-on-type-level-lists/34758520#34758520", "title": "Equality constraints on type level lists", "body": "<p>One option might be to use a type family:</p>\n\n<pre><code>data Nat = Z | S Nat\n\ntype family LengthIs (n :: Nat) (xs :: [*]) :: Bool where\n  LengthIs 'Z '[] = 'True\n  LengthIs ('S n) (x ': xs) = LengthIs n xs\n  LengthIs n xs = 'False\n\ntest :: LengthIs ('S ('S 'Z)) '[Bool,String,Int] ~ 'True =&gt; ()\ntest = ()\n</code></pre>\n\n<p>This will not pass the type checker; the only way to make it pass is to make the type list have two elements. I don't know how <code>Nat</code> works in the singletons library, but I imagine you might be able to do something similar.</p>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 1976901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/426a40922f9a318fbb20393dec3c575c?s=128&d=identicon&r=PG", "display_name": "Aistis Raulinaitis", "link": "https://stackoverflow.com/users/1976901/aistis-raulinaitis"}, "edited": false, "score": 0, "creation_date": 1452706650, "post_id": 34761572, "comment_id": 57291742, "body": "Excellent, this is pretty close to what I&#39;m looking for!  Although, how do I make this work with Proxy?"}, {"owner": {"reputation": 85, "user_id": 1976901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/426a40922f9a318fbb20393dec3c575c?s=128&d=identicon&r=PG", "display_name": "Aistis Raulinaitis", "link": "https://stackoverflow.com/users/1976901/aistis-raulinaitis"}, "edited": false, "score": 0, "creation_date": 1452707183, "post_id": 34761572, "comment_id": 57292097, "body": "Yes, I want to carry this invariant around. But I don&#39;t want to define a separate TList, it should be using Proxy."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 85, "user_id": 1976901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/426a40922f9a318fbb20393dec3c575c?s=128&d=identicon&r=PG", "display_name": "Aistis Raulinaitis", "link": "https://stackoverflow.com/users/1976901/aistis-raulinaitis"}, "edited": false, "score": 0, "creation_date": 1452801062, "post_id": 34761572, "comment_id": 57340007, "body": "Impossible - the entire point of <code>Proxy</code> is it carries no type information. I can&#39;t see exactly why you would need to use proxy in particular - you can always produce a <code>Proxy</code> anyways . You can of course simply place the constraint where you need it and use <code>Proxy</code> there : <code>Length xs ~ n =&gt; Proxy xs -&gt; Proxy n -&gt; ...</code> but then you don&#39;t have the &quot;correct by construction&quot; property."}, {"owner": {"reputation": 85, "user_id": 1976901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/426a40922f9a318fbb20393dec3c575c?s=128&d=identicon&r=PG", "display_name": "Aistis Raulinaitis", "link": "https://stackoverflow.com/users/1976901/aistis-raulinaitis"}, "edited": false, "score": 0, "creation_date": 1452899771, "post_id": 34761572, "comment_id": 57385452, "body": "Huh, really, to me it seems that Proxy is exactly the opposite of what you said, it&#39;s carries no data, it&#39;s meant only to hold types. Although I could be completely wrong."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 85, "user_id": 1976901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/426a40922f9a318fbb20393dec3c575c?s=128&d=identicon&r=PG", "display_name": "Aistis Raulinaitis", "link": "https://stackoverflow.com/users/1976901/aistis-raulinaitis"}, "edited": false, "score": 1, "creation_date": 1452907360, "post_id": 34761572, "comment_id": 57387413, "body": "<code>Proxy :: Proxy x</code> is isomorphic to <code>()</code> at runtime for any type x. It does not store the type of <code>x</code> in any capacity. This is not true for <code>TList</code>. At runtime, constraints become concrete values, so the type of <code>TList</code> is essentially <code>TList :: Coercion (Length xs) n -&gt; TList n xs</code> - <code>Coercion</code> is the internal type used by GHC to represent type equalities - it is a runtime witness of the equality of two types, hence, runtime type information."}, {"owner": {"reputation": 85, "user_id": 1976901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/426a40922f9a318fbb20393dec3c575c?s=128&d=identicon&r=PG", "display_name": "Aistis Raulinaitis", "link": "https://stackoverflow.com/users/1976901/aistis-raulinaitis"}, "edited": false, "score": 0, "creation_date": 1452930461, "post_id": 34761572, "comment_id": 57391516, "body": "Thanks! That makes sense!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1481408819, "post_id": 34761572, "comment_id": 69368045, "body": "You can import <code>Data.Type.Equality</code> to get <code>:~:</code> instead of defining it yourself."}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": false, "score": 4, "last_activity_date": 1452673280, "creation_date": 1452673280, "answer_id": 34761572, "question_id": 34757783, "link": "https://stackoverflow.com/questions/34757783/equality-constraints-on-type-level-lists/34761572#34761572", "title": "Equality constraints on type level lists", "body": "<p>If this is something like an invariant (which it seems it is), you should store the proof in the datatype:</p>\n\n<pre><code>{-# LANGUAGE PolyKinds, UndecidableInstances #-} \n\nimport GHC.TypeLits \n\ntype family Length (xs :: [k]) :: Nat where \n  Length '[] = 0 \n  Length (x ': xs) = 1 + Length xs \n\ndata TList n l where \n  TList :: (Length xs ~ n) =&gt; TList n xs \n</code></pre>\n\n<p>Note that while the proof is still available at the type level, it is sort of \"hidden\" behind the data constructor. You can recover the proof simply by pattern matching:</p>\n\n<pre><code>data (:~:) a b where Refl :: a :~: a \n\ntest :: TList n l -&gt; Length l :~: n \ntest TList = Refl \n</code></pre>\n\n<p>Now, mismatches between the two parameters are a type error:</p>\n\n<pre><code>bad :: TList 3 '[Int, Bool]\nbad = TList \n\ngood :: TList 2 '[Int, Bool]\ngood = TList \n</code></pre>\n\n<p>Of course this can still be beaten by bottom values, so</p>\n\n<pre><code>uh_oh :: TList 10 '[] \nuh_oh = undefined \n</code></pre>\n\n<p>To avoid this, simply make sure you always pattern match on the <code>TList</code> constructor. </p>\n"}], "owner": {"reputation": 85, "user_id": 1976901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/426a40922f9a318fbb20393dec3c575c?s=128&d=identicon&r=PG", "display_name": "Aistis Raulinaitis", "link": "https://stackoverflow.com/users/1976901/aistis-raulinaitis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1452707473, "creation_date": 1452654730, "last_edit_date": 1452707473, "question_id": 34757783, "link": "https://stackoverflow.com/questions/34757783/equality-constraints-on-type-level-lists", "title": "Equality constraints on type level lists", "body": "<p>I'm trying to enforce a type-level constraint that a type-level list must be the same length as a type-level Nat being carried around. For example, using Length from singletons [1] package:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data (n ~ Length ls) =&gt; NumList (n :: Nat) (ls :: [*])\n\ntest :: Proxy (NumList 2 '[Bool, String, Int])\ntest = Proxy\n</code></pre>\n\n<p>I would not expect this code to compile, since there is a mismatch.</p>\n\n<p>EDIT: As dfeuer mentioned Datatype contexts aren't a good idea. I can do the comparison at the value level, but I want to be able to do this at the type level:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class NumListLen a \n  sameLen :: Proxy a -&gt; Bool\n\ninstance (KnownNat n, KnownNat (Length m)) =&gt; NumListLen (NumList n m) where\n  sameLen = const $ (natVal (Proxy :: Proxy n)) == (natVal (Proxy :: Proxy (Length m)))\n</code></pre>\n\n<p>~~~~</p>\n\n<p>EDIT: Sorta answered my own question, simply add the constraint to the instance:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class NumListLen a \n  sameLen :: Proxy a -&gt; Bool\n\ninstance (KnownNat n, KnownNat (Length m), n ~ Length m) =&gt; NumListLen (NumList n m) where\n  sameLen = const $ (natVal (Proxy :: Proxy n)) == (natVal (Proxy :: Proxy (Length m)))\n</code></pre>\n\n<pre><code>/home/aistis/Projects/SingTest/SingTest/app/Main.hs:333:13:\n    Couldn't match type \u20183\u2019 with \u20182\u2019\n    In the second argument of \u2018($)\u2019, namely \u2018sameLen test\u2019\n    In a stmt of a 'do' block: print $ sameLen test\n    In the expression:\n      do { print $ sameLen test;\n           putStrLn \"done!\" }\n</code></pre>\n\n<p>[1] <a href=\"https://hackage.haskell.org/package/singletons-2.0.0.2/docs/Data-Promotion-Prelude-List.html#t:Length\" rel=\"nofollow\">https://hackage.haskell.org/package/singletons-2.0.0.2/docs/Data-Promotion-Prelude-List.html#t:Length</a></p>\n"}, {"tags": ["haskell", "typeclass"], "answers": [{"comments": [{"owner": {"reputation": 2204, "user_id": 1063961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/s9gRK.png?s=128&g=1", "display_name": "Centril", "link": "https://stackoverflow.com/users/1063961/centril"}, "edited": false, "score": 0, "creation_date": 1452653820, "post_id": 34757615, "comment_id": 57260993, "body": "Haskell, practical use :P? I thought it was for thinking only ^,-"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1452665403, "post_id": 34757615, "comment_id": 57264367, "body": "Unfortunately, <code>signum</code> (what the heck was that even designed for?) and <code>abs</code> (which has the wrong type to be really useful for complex numbers) exist. Also unfortunately, floating point representations are instances of <code>Num</code> despite not behaving much at all like numbers. Another unfortunate fact is that natural numbers don&#39;t support <code>(-)</code> or <code>negate</code> very well at all."}, {"owner": {"reputation": 27437, "user_id": 370541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c3fdae66f7cfe0c334742f54bab1f69?s=128&d=identicon&r=PG", "display_name": "John L", "link": "https://stackoverflow.com/users/370541/john-l"}, "edited": false, "score": 0, "creation_date": 1452934239, "post_id": 34757615, "comment_id": 57392332, "body": "I think the primary reasoning is that <code>Num</code> was driven primarily by practical concerns.  The syntax is basically identical to other languages, and it works properly most of the time for most common types and uses.  Unfortunately it does break down at edge cases.  I disagree it&#39;s unfortunate that floating point representations are instances of <code>Num</code>; rather I would suggest that some of the choices of IEEE754 are unfortunate."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 4, "last_activity_date": 1452653594, "creation_date": 1452653594, "answer_id": 34757615, "question_id": 34757498, "link": "https://stackoverflow.com/questions/34757498/haskell-why-is-part-of-num-typeclass/34757615#34757615", "title": "Haskell: Why is (+), (-) part of Num typeclass?", "body": "<p>A lot of it is due to historic reasons, but there are also mathematical ones.  For example, there are already mathematical names for structures that support binary operators.  The most commonly used one is a Monoid, which you can use in <code>Data.Monoid</code>.  This typeclass defines a function <code>mappend</code> and a value <code>mempty</code>, the equivalent of the identity element for <code>mappend</code>, and there is an operator alias for <code>mappend</code> called <code>&lt;&gt;</code>.  Lists and many other objects form monoids, and numbers actually form 2, with <code>+</code> and with <code>*</code>, where the identity elements are 0 and 1 respectively.  Structures that have an identity, an associative binary operation, and an inverse for that operation (subtraction is the inverse of addition, for example) are called groups (not part of the standard library), and structures that form a group under one operator and a monoid under a second operator are called rings.  These objects are the basis for algebraic structures/abstract algebra classes.</p>\n\n<p>These mathematical constructs are somewhat tricky to implement in Haskell, at least very well.  There are overlapping instances for <code>Monoid</code> for all <code>Num</code> types with <code>+</code> and <code>*</code>, and for some numeric types there's a <code>Group</code> overlap if <code>/</code> can be defined such that dividing by 0 is well defined (some structures can allow this).  These overlapping instances lead to lots of newtypes that make it difficult to work on a day to day basis.  The <code>Num</code> typeclass helps here because it provides a useful interface, that of manipulating and performing operations on numbers, that is easy to use in real world code rather than just in academia.  There have been attempts to introduce a more mathematical version of <code>Prelude</code>, and some people use these with varying success, but your average Haskeller would rather ditch mathematical purity for a more practical interface.</p>\n\n<p>In short, the <code>Num</code> typeclass is defined this way for historical reasons, but also for very practical reasons.  A more strict mathematical construction is unwieldy, and for many types simply using <code>Data.Monoid</code>'s <code>&lt;&gt;</code> operator is perfect.</p>\n"}, {"tags": [], "owner": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "is_accepted": false, "score": 1, "last_activity_date": 1452654274, "creation_date": 1452654274, "answer_id": 34757718, "question_id": 34757498, "link": "https://stackoverflow.com/questions/34757498/haskell-why-is-part-of-num-typeclass/34757718#34757718", "title": "Haskell: Why is (+), (-) part of Num typeclass?", "body": "<p>My guess is that they intended <code>Num</code> to reflect the mathematical nature of numbers, rather than some more general structure.  The operation in <code>Num</code> are largely those that support an abstract mathematical structure called a <em>ring</em>, of which the integers (and any extensions thereof) are a prominent example.</p>\n\n<p>Since Haskell allows you to define your own operators, you can set up your own notation.  Then, when others read your code, they will be able to tell that you are working with something which is not <code>Num</code>ber-like, but perhaps more general.</p>\n\n<p>There are many unfortunate historical design decisions in the Haskell prelude, which cannot be fixed because they would break compatibility.  However, IMHO, the basic design of the <code>Num</code> typeclass and operators is sound.</p>\n"}], "owner": {"reputation": 2204, "user_id": 1063961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/s9gRK.png?s=128&g=1", "display_name": "Centril", "link": "https://stackoverflow.com/users/1063961/centril"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1775, "favorite_count": 0, "accepted_answer_id": 34757615, "answer_count": 2, "score": 6, "last_activity_date": 1452654274, "creation_date": 1452652854, "last_edit_date": 1452652955, "question_id": 34757498, "link": "https://stackoverflow.com/questions/34757498/haskell-why-is-part-of-num-typeclass", "title": "Haskell: Why is (+), (-) part of Num typeclass?", "body": "<p>From ghci:</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>Prelude&gt; :i Num                              \nclass Num a where                            \n  (+) :: a -&gt; a -&gt; a                         \n  (-) :: a -&gt; a -&gt; a                         \n  (*) :: a -&gt; a -&gt; a                         \n  negate :: a -&gt; a                           \n  abs :: a -&gt; a                              \n  signum :: a -&gt; a                           \n  fromInteger :: Integer -&gt; a                \n        -- Defined in `GHC.Num'              \ninstance Num Word -- Defined in `GHC.Num'    \ninstance Num Integer -- Defined in `GHC.Num' \ninstance Num Int -- Defined in `GHC.Num'     \ninstance Num Float -- Defined in `GHC.Float' \ninstance Num Double -- Defined in `GHC.Float'\n</code></pre>\n\n<p>Why is <code>(+)</code>, <code>(-)</code> part of the Num class to begin with?</p>\n\n<p>For example - you could easily define this type class:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class Plus a where\n     (+) :: a -&gt; a -&gt; a\n</code></pre>\n\n<p>And then let:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance Plus [] where\n    (+) = (++)\n</code></pre>\n\n<p>And you could also define these for sets to mean set union, or add <code>(-)</code> to a type class to mean set difference... And it makes no sense to define <code>signum</code> on a list.</p>\n\n<p>Of course I could create my own type class that uses <code>(|+|)</code> instead\n - but why was these operators reserved in haskell for Num alone?</p>\n\n<p>So why was this choice made? Is it due to legacy or has no one wanted this?</p>\n"}, {"tags": ["haskell", "gtk", "cabal", "pkg-config", "ghcjs"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1452648690, "post_id": 34756441, "comment_id": 57259655, "body": "Hmmm I wonder why ghcjs needs gtk.  Those seem to be pretty... incompatible."}], "answers": [{"comments": [{"owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "edited": false, "score": 0, "creation_date": 1452661687, "post_id": 34757802, "comment_id": 57263113, "body": "it seems to have installed gtk-0.14.2, but when I run <code>cabal install ghcjs-dom</code> it fails, saying <code>Failed to install gtk3-0.14.2</code>.  Were you able to get away with gtk rather than gtk3?"}, {"owner": {"reputation": 3669, "user_id": 4876946, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5dc4839a7e9466d54f3791122f8f5d75?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4876946/matt"}, "reply_to_user": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "edited": false, "score": 0, "creation_date": 1452702128, "post_id": 34757802, "comment_id": 57288453, "body": "Sorry, I should have read your question more carefully.  You need the gtk3 Haskell package, which depends on the gtk+-3.0 system package.  You can get gtk+-3.0 via <code>brew install gtk+3</code> on Mac (assuming you have homebrew, which if you don&#39;t, you definitely should get it).  I&#39;ve updated my answer accordingly."}, {"owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "edited": false, "score": 0, "creation_date": 1452707146, "post_id": 34757802, "comment_id": 57292061, "body": "Well that worked so I&#39;m marking this as correct.  Now it&#39;s stuck on <code>Failed to install webkitgtk3-0.14.1.1</code>...is there a list of the dependencies for these GHCJS packages?"}, {"owner": {"reputation": 3669, "user_id": 4876946, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5dc4839a7e9466d54f3791122f8f5d75?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4876946/matt"}, "reply_to_user": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "edited": false, "score": 0, "creation_date": 1452717272, "post_id": 34757802, "comment_id": 57298212, "body": "Try doing <code>cabal install ghcjs-dom -f-gtk3</code>.  This will use regular gtk rather than gtk3.  This will now require that you do <code>cabal install gtk -fhave-quartz-gtk</code> at some point."}, {"owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "edited": false, "score": 0, "creation_date": 1452721893, "post_id": 34757802, "comment_id": 57300491, "body": "<code>Building gtk-0.13.9...Failed to install gtk-0.13.9</code>  Getttng a similar error"}, {"owner": {"reputation": 3669, "user_id": 4876946, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5dc4839a7e9466d54f3791122f8f5d75?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4876946/matt"}, "reply_to_user": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "edited": false, "score": 0, "creation_date": 1452785297, "post_id": 34757802, "comment_id": 57330099, "body": "It seems they want an older version of gtk for some reason.  You&#39;ll have to explicitly specify the version number, such as <code>cabal install gtk-0.13.9 -fhave-quartz-gtk</code>"}, {"owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "edited": false, "score": 0, "creation_date": 1452797306, "post_id": 34757802, "comment_id": 57337901, "body": "That installed gtk-0.13.9.  When I run <code>cabal install ghcjs-dom -f-gtk3</code>, I get <code>Failed to install webkit-0.14.1.1</code>.  When I try to install that version with <code>cabal install gtk-0.14.1.1 -fhave-quartz-gtk</code> I get <code>cabal: Could not resolve dependencies:</code>"}], "tags": [], "owner": {"reputation": 3669, "user_id": 4876946, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5dc4839a7e9466d54f3791122f8f5d75?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4876946/matt"}, "is_accepted": true, "score": 2, "last_activity_date": 1452702294, "last_edit_date": 1452702294, "creation_date": 1452654905, "answer_id": 34757802, "question_id": 34756441, "link": "https://stackoverflow.com/questions/34756441/installing-gtk3-for-haskell-ghcjs/34757802#34757802", "title": "Installing gtk3 for Haskell (GHCJS)", "body": "<p>You need to <code>brew install gtk+3</code>.  Doing <code>cabal install gtk</code> will only install the Haskell bindings for gtk.  That said, the reason you are getting the build errors when trying to install gtk (which you don't need) is because you are missing the <code>-fhave-quartz-gtk</code> flag, which is needed for mac.</p>\n"}], "owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 793, "favorite_count": 0, "accepted_answer_id": 34757802, "answer_count": 1, "score": 1, "last_activity_date": 1452702294, "creation_date": 1452645353, "question_id": 34756441, "link": "https://stackoverflow.com/questions/34756441/installing-gtk3-for-haskell-ghcjs", "title": "Installing gtk3 for Haskell (GHCJS)", "body": "<p>I'm trying to install GHCJS on Mac OSX (Yosemite).  So far, I have updated Alex and Happy and installed gtk2hs-buildtools.  Now when I run <code>cabal install ghcjs-dom</code>, I'm told that I need to install pkg-config...</p>\n\n<pre><code>~/Haskell/ghcjs-test/domTest: cabal install ghcjs-dom\nResolving dependencies...\nConfiguring cairo-0.13.1.1...\n...\n[2 of 2] Compiling Main             ( SetupMain.hs, dist/setup-wrapper/Main.o )\nLinking dist/setup-wrapper/setup ...\nConfiguring cairo-0.13.1.1...\nsetup: The program 'pkg-config' version &gt;=0.9.0 is required but it could not\nbe found.\nFailed to install glib-0.13.2.2\nBuild log ( /Users/markkaravan/.cabal/logs/glib-0.13.2.2.log ):\n...\n</code></pre>\n\n<p>Hmmmm, pkg-config eh?</p>\n\n<pre><code>~/Haskell/ghcjs-test/domTest: cabal install pkg-config\ncabal: There is no package named 'pkg-config'.\n</code></pre>\n\n<p>I then keep running <code>cabal install ghcjs-dom</code>, each time hitting a dependency that I then have to google and install via brew.  This happens about 4 or 5 times.  Finally, I'm stuck on gtk.  </p>\n\n<pre><code>~/Haskell/ghcjs-test/domTest: cabal install ghcjs-dom\nResolving dependencies...\n... \nConfiguring gtk3-0.14.2...\nsetup: The pkg-config package 'gtk+-3.0' is required but it could not be\nfound.\ncabal: Error: some packages failed to install:\nghcjs-dom-0.2.3.1 depends on gtk3-0.14.2 which failed to install.\ngtk3-0.14.2 failed during the configure step. The exception was:\nExitFailure 1\nwebkitgtk3-0.14.1.1 depends on gtk3-0.14.2 which failed to install.\n</code></pre>\n\n<p>After failing to brew install it, I try to install it with cabal:</p>\n\n<pre><code>~/Haskell/ghcjs-test/domTest: cabal install gtk\nResolving dependencies...\nDownloading gtk-0.14.2...\nConfiguring gtk-0.14.2...\nBuilding gtk-0.14.2...\nFailed to install gtk-0.14.2\nBuild log ( /Users/markkaravan/.cabal/logs/gtk-0.14.2.log ):\n[1 of 2] Compiling SetupWrapper     ( /var/folders/br/4zwhphlx3816v87cc0bb5sxh0000gn/T/cabal-tmp-12417/gtk-0.14.2/SetupWrapper.hs, /var/folders/br/4zwhphlx3816v87cc0bb5sxh0000gn/T/cabal-tmp-12417/gtk-0.14.2/dist/setup/SetupWrapper.o )\n[2 of 2] Compiling Main             ( /var/folders/br/4zwhphlx3816v87cc0bb5sxh0000gn/T/cabal-tmp-12417/gtk-0.14.2/dist/setup/setup.hs, /var/folders/br/4zwhphlx3816v87cc0bb5sxh0000gn/T/cabal-tmp-12417/gtk-0.14.2/dist/setup/Main.o )\nLinking /var/folders/br/4zwhphlx3816v87cc0bb5sxh0000gn/T/cabal-tmp-12417/gtk-0.14.2/dist/setup/setup ...\n[1 of 2] Compiling Gtk2HsSetup      ( Gtk2HsSetup.hs, dist/setup-wrapper/Gtk2HsSetup.o )\n[2 of 2] Compiling Main             ( SetupMain.hs, dist/setup-wrapper/Main.o )\nLinking dist/setup-wrapper/setup ...\nConfiguring gtk-0.14.2...\nBuilding gtk-0.14.2...\nPreprocessing library gtk-0.14.2...\n[  1 of 209] Compiling Graphics.UI.Gtk.ModelView.Sequence ( Graphics/UI/Gtk/ModelView/Sequence.hs, dist/build/Graphics/UI/Gtk/ModelView/Sequence.o )\n[  2 of 209] Compiling Graphics.UI.Gtk.Gdk.Enums ( dist/build/Graphics/UI/Gtk/Gdk/Enums.hs, dist/build/Graphics/UI/Gtk/Gdk/Enums.o )\n[  3 of 209] Compiling Graphics.UI.Gtk.General.Enums ( dist/build/Graphics/UI/Gtk/General/Enums.hs, dist/build/Graphics/UI/Gtk/General/Enums.o )\n[  4 of 209] Compiling Graphics.UI.Gtk.General.Threading ( Graphics/UI/Gtk/General/Threading.hs, dist/build/Graphics/UI/Gtk/General/Threading.o )\n[  5 of 209] Compiling Graphics.UI.Gtk.Signals ( dist/build/Graphics/UI/Gtk/Signals.hs, dist/build/Graphics/UI/Gtk/Signals.o )\n[  6 of 209] Compiling Graphics.UI.Gtk.Types ( dist/build/Graphics/UI/Gtk/Types.hs, dist/build/Graphics/UI/Gtk/Types.o )\n[  7 of 209] Compiling Graphics.UI.Gtk.General.DNDTypes ( dist/build/Graphics/UI/Gtk/General/DNDTypes.hs, dist/build/Graphics/UI/Gtk/General/DNDTypes.o )\n[  8 of 209] Compiling Graphics.UI.Gtk.Abstract.ContainerChildProperties ( dist/build/Graphics/UI/Gtk/Abstract/ContainerChildProperties.hs, dist/build/Graphics/UI/Gtk/Abstract/ContainerChildProperties.o )\n[  9 of 209] Compiling Graphics.UI.Gtk.Embedding.Types ( dist/build/Graphics/UI/Gtk/Embedding/Types.hs, dist/build/Graphics/UI/Gtk/Embedding/Types.o )\n[ 10 of 209] Compiling Graphics.UI.Gtk.Embedding.Embedding ( dist/build/Graphics/UI/Gtk/Embedding/Embedding.hs, dist/build/Graphics/UI/Gtk/Embedding/Embedding.o )\n[ 11 of 209] Compiling Graphics.UI.Gtk.ModelView.Types ( dist/build/Graphics/UI/Gtk/ModelView/Types.hs, dist/build/Graphics/UI/Gtk/ModelView/Types.o )\n[ 12 of 209] Compiling Graphics.UI.Gtk.Gdk.PixbufData ( Graphics/UI/Gtk/Gdk/PixbufData.hs, dist/build/Graphics/UI/Gtk/Gdk/PixbufData.o )\n[ 13 of 209] Compiling Graphics.UI.Gtk.Gdk.PixbufAnimation ( dist/build/Graphics/UI/Gtk/Gdk/PixbufAnimation.hs, dist/build/Graphics/UI/Gtk/Gdk/PixbufAnimation.o )\n[ 14 of 209] Compiling Graphics.UI.Gtk.Builder ( dist/build/Graphics/UI/Gtk/Builder.hs, dist/build/Graphics/UI/Gtk/Builder.o )\n[ 15 of 209] Compiling Graphics.UI.Gtk.Abstract.Separator ( Graphics/UI/Gtk/Abstract/Separator.hs, dist/build/Graphics/UI/Gtk/Abstract/Separator.o )\n[ 16 of 209] Compiling Graphics.UI.Gtk.Abstract.Scrollbar ( Graphics/UI/Gtk/Abstract/Scrollbar.hs, dist/build/Graphics/UI/Gtk/Abstract/Scrollbar.o )\n[ 17 of 209] Compiling Graphics.UI.Gtk.Abstract.Scale ( dist/build/Graphics/UI/Gtk/Abstract/Scale.hs, dist/build/Graphics/UI/Gtk/Abstract/Scale.o )\n[ 18 of 209] Compiling Graphics.UI.Gtk.Abstract.Object ( dist/build/Graphics/UI/Gtk/Abstract/Object.hs, dist/build/Graphics/UI/Gtk/Abstract/Object.o )\n[ 19 of 209] Compiling Graphics.UI.Gtk.Abstract.Paned ( dist/build/Graphics/UI/Gtk/Abstract/Paned.hs, dist/build/Graphics/UI/Gtk/Abstract/Paned.o )\n[ 20 of 209] Compiling Graphics.UI.Gtk.General.Structs ( dist/build/Graphics/UI/Gtk/General/Structs.hs, dist/build/Graphics/UI/Gtk/General/Structs.o )\n[ 21 of 209] Compiling Graphics.UI.Gtk.Abstract.Range ( dist/build/Graphics/UI/Gtk/Abstract/Range.hs, dist/build/Graphics/UI/Gtk/Abstract/Range.o )\n[ 22 of 209] Compiling Graphics.UI.Gtk.Embedding.Plug ( dist/build/Graphics/UI/Gtk/Embedding/Plug.hs, dist/build/Graphics/UI/Gtk/Embedding/Plug.o )\n\nGraphics/UI/Gtk/Embedding/Plug.chs:120:6:\n    Couldn't match expected type \u2018Ptr ()\u2019\n                with actual type \u2018Maybe DrawWindow\u2019\n    In the first argument of \u2018gtk_plug_new\u2019, namely\n      \u2018(fromNativeWindowId (fromMaybe nativeWindowIdNone socketId))\u2019\n    In the second argument of \u2018($)\u2019, namely\n      \u2018gtk_plug_new\n         (fromNativeWindowId (fromMaybe nativeWindowIdNone socketId))\u2019\n\nGraphics/UI/Gtk/Embedding/Plug.chs:137:6:\n    Couldn't match expected type \u2018Ptr ()\u2019\n                with actual type \u2018Maybe DrawWindow\u2019\n    In the second argument of \u2018\\ (Display arg1) arg2\n                                 -&gt; withForeignPtr arg1\n                                    $ \\ argPtr1 -&gt; gtk_plug_new_for_display argPtr1 arg2\u2019, namely\n      \u2018(fromNativeWindowId (fromMaybe nativeWindowIdNone socketId))\u2019\n    In the second argument of \u2018($)\u2019, namely\n      \u2018(\\ (Display arg1) arg2\n          -&gt; withForeignPtr arg1\n             $ \\ argPtr1 -&gt; gtk_plug_new_for_display argPtr1 arg2)\n         display\n         (fromNativeWindowId (fromMaybe nativeWindowIdNone socketId))\u2019\n\nGraphics/UI/Gtk/Embedding/Plug.chs:151:3:\n    Couldn't match type \u2018Ptr ()\u2019 with \u2018Maybe DrawWindow\u2019\n    Expected type: IO (Maybe DrawWindow)\n      Actual type: IO (Ptr ())\n    In the second argument of \u2018($)\u2019, namely\n      \u2018(\\ (Plug arg1)\n          -&gt; withForeignPtr arg1 $ \\ argPtr1 -&gt; gtk_plug_get_id argPtr1)\n         (toPlug self)\u2019\n    In the expression:\n      liftM toNativeWindowId\n      $ (\\ (Plug arg1)\n           -&gt; withForeignPtr arg1 $ \\ argPtr1 -&gt; gtk_plug_get_id argPtr1)\n          (toPlug self)\ncabal: Error: some packages failed to install:\ngtk-0.14.2 failed during the building phase. The exception was:\nExitFailure 1\n</code></pre>\n\n<p>Now I'm lost.  Google is coming up short.  Any ideas?</p>\n"}, {"tags": ["haskell", "function-composition"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1452643118, "post_id": 34755600, "comment_id": 57258177, "body": "Do you see why with the equivalent <code>doSomeY x = \\y -&gt; x + y + 1</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "is_accepted": true, "score": 6, "last_activity_date": 1452642594, "creation_date": 1452642594, "answer_id": 34755958, "question_id": 34755600, "link": "https://stackoverflow.com/questions/34755600/haskell-and-function-composition/34755958#34755958", "title": "Haskell and function composition", "body": "<p>The difference is caused by <code>doSomeY</code> yielding a number in the first case vs. yielding a function in the second case when applied to one argument.</p>\n\n<p>Given</p>\n\n<pre><code>doSomeX x = if x==7 then True else False\ndoSomeY x y = x+y+1\n</code></pre>\n\n<p>we can infer the types (these aren't the most generic types possible, but they'll do for our purposes):</p>\n\n<pre><code>doSomeX :: Int -&gt; Bool\ndoSomeY :: Int -&gt; Int -&gt; Int\n</code></pre>\n\n<p>Remember that <code>-&gt;</code> in type signature associates to the right, so the type of <code>doSomeY</code> is equivalent to</p>\n\n<pre><code>doSomeY :: Int -&gt; (Int -&gt; Int)\n</code></pre>\n\n<p>With this in mind, consider the type of <code>(.)</code>:</p>\n\n<pre><code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n</code></pre>\n\n<p>If you define</p>\n\n<pre><code>doSomeXY = doSomeX.doSomeY\n</code></pre>\n\n<p>...which is equivalent to <code>(.) doSomeX doSomeY</code>, it means that the first argument to <code>(.)</code> is <code>doSomeX</code> and the second argument is <code>doSomeY</code>. Hence, the type <code>b -&gt; c</code> (the first argument to <code>(.)</code>) must match the type <code>Int -&gt; Bool</code> (the type of <code>doSomeX</code>). So</p>\n\n<pre><code>b ~ Int\nc ~ Bool\n</code></pre>\n\n<p>Hence,</p>\n\n<pre><code>(.) doSomeX :: (a -&gt; Int) -&gt; a -&gt; Bool\n</code></pre>\n\n<p>Now, applying this to <code>doSomeY</code> causes a type error. As mentioned above,</p>\n\n<pre><code>doSomeY :: Int -&gt; (Int -&gt; Int)\n</code></pre>\n\n<p>So when inferring a type for <code>(.) doSomeX doSomeY</code> the compiler has to unify <code>a -&gt; Int</code> (the first argument of <code>(.) doSomeX</code>) with <code>Int -&gt; (Int -&gt; Int)</code> (the type of <code>doSomeY</code>). <code>a</code> can be unified with <code>Int</code>, but the second half won't work. Hence the compiler barfs.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 3, "last_activity_date": 1452643457, "creation_date": 1452643457, "answer_id": 34756111, "question_id": 34755600, "link": "https://stackoverflow.com/questions/34755600/haskell-and-function-composition/34756111#34756111", "title": "Haskell and function composition", "body": "<p><code>(.)</code> is defined as</p>\n\n<pre><code>(.) f g x = f (g x)\n</code></pre>\n\n<p>so <code>(f . g) x y = (.) f g x y = f (g x) y</code>, not <code>f (g x y)</code> like you intended. </p>\n\n<p>On the other hand, <code>(f . g) (x,y) = f (g (x,y))</code>, because <code>(x,y)</code> is <em>one</em> value,  a 2-tuple, so your first version is okay.</p>\n"}], "owner": {"reputation": 907, "user_id": 2917666, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0868ffbc32d665832e38f956a1509bf2?s=128&d=identicon&r=PG&f=1", "display_name": "Rakim", "link": "https://stackoverflow.com/users/2917666/rakim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 1, "accepted_answer_id": 34755958, "answer_count": 2, "score": 2, "last_activity_date": 1452643457, "creation_date": 1452640582, "question_id": 34755600, "link": "https://stackoverflow.com/questions/34755600/haskell-and-function-composition", "title": "Haskell and function composition", "body": "<p>I was learning some basic function composition in Haskell and while I was playing around I realised something I cannot really explain. When I use the following block of code the compiler seems to be happy about it and works fine: </p>\n\n<pre><code>doSomeX x = if x==7 then True else False\ndoSomeY (x,y) = x+y+1\ndoSomeXY = doSomeX.doSomeY\n</code></pre>\n\n<p>However when I split the doSomeY into 2 args instead of a pair, i.e.:</p>\n\n<pre><code>doSomeX x = if x==7 then True else False\ndoSomeY x y = x+y+1\ndoSomeXY = doSomeX.doSomeY\n</code></pre>\n\n<p>I am getting the following error:</p>\n\n<pre><code> No instance for (Num a0) arising from a use of `doSomeY'\n The type variable `a0' is ambiguous\n Relevant bindings include\n   doSomeXY :: a0 -&gt; Bool (bound at test.hs:21:1)\n Note: there are several potential instances:\n   instance Integral a =&gt; Num (GHC.Real.Ratio a)\n     -- Defined in `GHC.Real'\n   instance Num Integer -- Defined in `GHC.Num'\n   instance Num Double -- Defined in `GHC.Float'\n   ...plus three others\n In the second argument of `(.)', namely `doSomeY'\n In the expression: doSomeX . doSomeY\n In an equation for `doSomeXY': doSomeXY = doSomeX . doSomeY\n</code></pre>\n\n<p>I don't really see why though. On both cases the return type of the <code>doSomeY</code> is the same type with that of the arg of the function <code>doSomeX</code> why would the input type of <code>doSomeY</code> would make a difference? Am I missing something fundamental here?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "dom", "ghcjs"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1452643982, "post_id": 34754736, "comment_id": 57258417, "body": "If one question is solved please mark the most suitable answer as correct and for errors occurring afterwards, please consider asking a different question. Multiple edits make future searches more difficult."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1452644017, "post_id": 34754736, "comment_id": 57258427, "body": "have you checked if <code>pkg-config</code> is installed on your system?"}, {"owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1452644409, "post_id": 34754736, "comment_id": 57258520, "body": "I deleted that edit.  Installed pkg-config, now working through lots of brew installs..."}], "answers": [{"tags": [], "owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "is_accepted": true, "score": 2, "last_activity_date": 1452637929, "creation_date": 1452637929, "answer_id": 34755020, "question_id": 34754736, "link": "https://stackoverflow.com/questions/34754736/trouble-installing-ghcjs-dom-package/34755020#34755020", "title": "Trouble Installing GHCJS DOM Package", "body": "<p>Try to update <code>alex</code> (and probably <code>happy</code>). See here for details: <a href=\"https://ro-che.info/articles/2014-03-08-happy-alex-ghc-7.8.html\" rel=\"nofollow\">https://ro-che.info/articles/2014-03-08-happy-alex-ghc-7.8.html</a></p>\n"}], "owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 34755020, "answer_count": 1, "score": 1, "last_activity_date": 1452644345, "creation_date": 1452636794, "last_edit_date": 1452644345, "question_id": 34754736, "link": "https://stackoverflow.com/questions/34754736/trouble-installing-ghcjs-dom-package", "title": "Trouble Installing GHCJS DOM Package", "body": "<p>I'm trying to install GHCJS.  When I run <code>cabal install ghcjs-dom</code>, it tells me</p>\n\n<pre><code>Cannot find gtk2hsC2hs\nPlease install `gtk2hs-buildtools` first and check that the install directory is in your PATH (e.g. HOME/.cabal/bin).\n</code></pre>\n\n<p>Ok, here we go then...</p>\n\n<pre><code>~/Haskell/ghcjs-test/domTest: cabal install gtk2hs-buildtools\nResolving dependencies...\nConfiguring gtk2hs-buildtools-0.13.0.5...\nBuilding gtk2hs-buildtools-0.13.0.5...\nFailed to install gtk2hs-buildtools-0.13.0.5\nBuild log ( /Users/markkaravan/.cabal/logs/gtk2hs-buildtools-0.13.0.5.log ):\nConfiguring gtk2hs-buildtools-0.13.0.5...\nBuilding gtk2hs-buildtools-0.13.0.5...\nPreprocessing executable 'gtk2hsTypeGen' for gtk2hs-buildtools-0.13.0.5...\n[1 of 2] Compiling Paths_gtk2hs_buildtools ( dist/build/autogen/Paths_gtk2hs_buildtools.hs, dist/build/gtk2hsTypeGen/gtk2hsTypeGen-tmp/Paths_gtk2hs_buildtools.o )\n[2 of 2] Compiling Main             ( hierarchyGen/TypeGen.hs, dist/build/gtk2hsTypeGen/gtk2hsTypeGen-tmp/Main.o )\nLinking dist/build/gtk2hsTypeGen/gtk2hsTypeGen ...\nPreprocessing executable 'gtk2hsHookGenerator' for\ngtk2hs-buildtools-0.13.0.5...\n[1 of 2] Compiling Paths_gtk2hs_buildtools ( dist/build/autogen/Paths_gtk2hs_buildtools.hs, dist/build/gtk2hsHookGenerator/gtk2hsHookGenerator-tmp/Paths_gtk2hs_buildtools.o )\n[2 of 2] Compiling Main             ( callbackGen/HookGenerator.hs, dist/build/gtk2hsHookGenerator/gtk2hsHookGenerator-tmp/Main.o )\nLinking dist/build/gtk2hsHookGenerator/gtk2hsHookGenerator ...\nPreprocessing executable 'gtk2hsC2hs' for gtk2hs-buildtools-0.13.0.5...\n[ 1 of 41] Compiling DLists           ( c2hs/base/general/DLists.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/DLists.o )\n[ 2 of 41] Compiling BaseVersion      ( c2hs/base/admin/BaseVersion.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/BaseVersion.o )\n[ 3 of 41] Compiling Switches         ( c2hs/state/Switches.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/Switches.o )\n[ 4 of 41] Compiling Map              ( c2hs/base/general/Map.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/Map.o )\n[ 5 of 41] Compiling FastMutInt       ( c2hs/base/general/FastMutInt.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/FastMutInt.o )\n[ 6 of 41] Compiling Config           ( c2hs/base/admin/Config.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/Config.o )\n[ 7 of 41] Compiling C2HSConfig       ( c2hs/toplevel/C2HSConfig.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/C2HSConfig.o )\n[ 8 of 41] Compiling CInfo            ( c2hs/gen/CInfo.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/CInfo.o )\n[ 9 of 41] Compiling Version          ( c2hs/toplevel/Version.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/Version.o )\n[10 of 41] Compiling Binary           ( c2hs/base/general/Binary.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/Binary.o )\n[11 of 41] Compiling Position         ( c2hs/base/general/Position.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/Position.o )\n[12 of 41] Compiling UNames           ( c2hs/base/general/UNames.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/UNames.o )\n[13 of 41] Compiling Errors           ( c2hs/base/errors/Errors.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/Errors.o )\n[14 of 41] Compiling Attributes       ( c2hs/base/syms/Attributes.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/Attributes.o )\n[15 of 41] Compiling Idents           ( c2hs/base/syms/Idents.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/Idents.o )\n[16 of 41] Compiling CTokens          ( c2hs/c/CTokens.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/CTokens.o )\n[17 of 41] Compiling CAST             ( c2hs/c/CAST.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/CAST.o )\n[18 of 41] Compiling CPretty          ( c2hs/c/CPretty.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/CPretty.o )\n[19 of 41] Compiling Lexers           ( c2hs/base/syntax/Lexers.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/Lexers.o )\n\nc2hs/base/syntax/Lexers.hs:133:1: Warning: Tab character\n\nc2hs/base/syntax/Lexers.hs:134:1: Warning: Tab character\n...\n\nc2hs/base/syntax/Lexers.hs:518:1: Warning: Tab character\n\nc2hs/base/syntax/Lexers.hs:519:1: Warning: Tab character\n\nc2hs/base/syntax/Lexers.hs:520:1: Warning: Tab character\n\nc2hs/base/syntax/Lexers.hs:520:15: Warning: Tab character\n[20 of 41] Compiling StateTrans       ( c2hs/base/state/StateTrans.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/StateTrans.o )\n[21 of 41] Compiling StateBase        ( c2hs/base/state/StateBase.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/StateBase.o )\n[22 of 41] Compiling NameSpaces       ( c2hs/base/syms/NameSpaces.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/NameSpaces.o )\n[23 of 41] Compiling CAttrs           ( c2hs/c/CAttrs.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/CAttrs.o )\n[24 of 41] Compiling CBuiltin         ( c2hs/c/CBuiltin.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/CBuiltin.o )\n[25 of 41] Compiling CParserMonad     ( c2hs/c/CParserMonad.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/CParserMonad.o )\n[26 of 41] Compiling CLexer           ( dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/CLexer.hs, dist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/CLexer.o )\n\ndist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/CLexer.hs:463:29:\n    Couldn't match expected type \u2018Bool\u2019 with actual type \u2018Int#\u2019\n    In the first argument of \u2018(&amp;&amp;)\u2019, namely \u2018(offset &gt;=# 0#)\u2019\n    In the expression: (offset &gt;=# 0#) &amp;&amp; (check ==# ord_c)\n    In the expression:\n      if (offset &gt;=# 0#) &amp;&amp; (check ==# ord_c) then\n          alexIndexInt16OffAddr alex_table offset\n      else\n          alexIndexInt16OffAddr alex_deflt s\n\ndist/build/gtk2hsC2hs/gtk2hsC2hs-tmp/CLexer.hs:463:48:\n    Couldn't match expected type \u2018Bool\u2019 with actual type \u2018Int#\u2019\n    In the second argument of \u2018(&amp;&amp;)\u2019, namely \u2018(check ==# ord_c)\u2019\n    In the expression: (offset &gt;=# 0#) &amp;&amp; (check ==# ord_c)\n    In the expression:\n      if (offset &gt;=# 0#) &amp;&amp; (check ==# ord_c) then\n          alexIndexInt16OffAddr alex_table offset\n      else\n          alexIndexInt16OffAddr alex_deflt s\ncabal: Error: some packages failed to install:\ngtk2hs-buildtools-0.13.0.5 failed during the building phase. The exception\nwas:\nExitFailure 1\n</code></pre>\n\n<p>In this situation, is it actually wise to mess with these source files that have type errors, or is there a better way to go about this?</p>\n"}, {"tags": ["haskell", "haskell-lens"], "comments": [{"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1452639391, "post_id": 34754199, "comment_id": 57256828, "body": "I\u2019m curious: Why does <code>use $ ix i</code> not work? What is the error message?"}, {"owner": {"reputation": 3385, "user_id": 841562, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4cbb35380ef84f4f0f68061f578a4e73?s=128&d=identicon&r=PG", "display_name": "Lemming", "link": "https://stackoverflow.com/users/841562/lemming"}, "reply_to_user": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 1, "creation_date": 1452644192, "post_id": 34754199, "comment_id": 57258467, "body": "@JoachimBreitner The error message is that <code>Char</code> has no instance of <code>Monoid</code>. If the element type is a monoid and we try to access a missing element, then lens will instead return <code>mempty</code>. However, since <code>Char</code> has no monoid instance lens doesn&#39;t know what to do in that case."}], "answers": [{"comments": [{"owner": {"reputation": 3385, "user_id": 841562, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4cbb35380ef84f4f0f68061f578a4e73?s=128&d=identicon&r=PG", "display_name": "Lemming", "link": "https://stackoverflow.com/users/841562/lemming"}, "edited": false, "score": 0, "creation_date": 1452675523, "post_id": 34757907, "comment_id": 57269584, "body": "Thanks, that is indeed exactly what I was looking for. Do you have any hints on how to find such a thing? I find the documentation of lens quite unwieldy and wouldn&#39;t know what kind of type to search for on hoogle."}, {"owner": {"reputation": 21248, "user_id": 223274, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2a6aad3c8269beb376b3e2b0bd29bec4?s=128&d=identicon&r=PG", "display_name": "Ian Henry", "link": "https://stackoverflow.com/users/223274/ian-henry"}, "reply_to_user": {"reputation": 3385, "user_id": 841562, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4cbb35380ef84f4f0f68061f578a4e73?s=128&d=identicon&r=PG", "display_name": "Lemming", "link": "https://stackoverflow.com/users/841562/lemming"}, "edited": false, "score": 0, "creation_date": 1452694573, "post_id": 34757907, "comment_id": 57282711, "body": "@Lemming It&#39;s really hard for me to Hoogle for lens too. But if you do something like <code>:t gets . preview</code> at the repl and plug that in you can usually get results. In general though <a href=\"https://hackage.haskell.org/package/lens-4.13/docs/Control-Lens-Fold.html#v:pre\" rel=\"nofollow noreferrer\"><code>pre</code></a> lets you convert functions that take lenses (like <code>use</code> or <code>view</code>) into functions that take prisms. <code>preview = view . pre</code>, <code>preuse = use . pre</code>, etc. If you learn the language -- the wordplay -- you can predict what&#39;s out there a little better. (I&#39;m still terrible at it.)"}, {"owner": {"reputation": 3385, "user_id": 841562, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4cbb35380ef84f4f0f68061f578a4e73?s=128&d=identicon&r=PG", "display_name": "Lemming", "link": "https://stackoverflow.com/users/841562/lemming"}, "edited": false, "score": 0, "creation_date": 1452697779, "post_id": 34757907, "comment_id": 57285049, "body": "Thanks for the hint. It turns out that this doesn&#39;t produce any results at <code>www.haskell.org&#47;hoogle</code>. However, thanks to <code>nix</code> I can make my own hoogle very easily: <code>nix-shell -p &#39;haskell.packages.ghc7102.ghcWithHoogle (pkgs: with pkgs; [ lens ])&#39;</code> and if I search for <code>Getting (First a) s a -&gt; m (Maybe a)</code> in there, then it spits out <code>preuse</code> as the first result."}, {"owner": {"reputation": 21248, "user_id": 223274, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2a6aad3c8269beb376b3e2b0bd29bec4?s=128&d=identicon&r=PG", "display_name": "Ian Henry", "link": "https://stackoverflow.com/users/223274/ian-henry"}, "reply_to_user": {"reputation": 3385, "user_id": 841562, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4cbb35380ef84f4f0f68061f578a4e73?s=128&d=identicon&r=PG", "display_name": "Lemming", "link": "https://stackoverflow.com/users/841562/lemming"}, "edited": false, "score": 0, "creation_date": 1452699348, "post_id": 34757907, "comment_id": 57286259, "body": "If you add <code>+lens</code> it seems to work on <a href=\"https://www.haskell.org/hoogle/?hoogle=%2Blens+Getting+%28First+a%29+s+a+-%3E+m+%28Maybe+a%29\" rel=\"nofollow noreferrer\">vanilla Hoogle</a>."}, {"owner": {"reputation": 3385, "user_id": 841562, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4cbb35380ef84f4f0f68061f578a4e73?s=128&d=identicon&r=PG", "display_name": "Lemming", "link": "https://stackoverflow.com/users/841562/lemming"}, "edited": false, "score": 0, "creation_date": 1452700901, "post_id": 34757907, "comment_id": 57287524, "body": "I did not know about that feature. Thanks!"}], "tags": [], "owner": {"reputation": 21248, "user_id": 223274, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2a6aad3c8269beb376b3e2b0bd29bec4?s=128&d=identicon&r=PG", "display_name": "Ian Henry", "link": "https://stackoverflow.com/users/223274/ian-henry"}, "is_accepted": true, "score": 2, "last_activity_date": 1452655687, "creation_date": 1452655687, "answer_id": 34757907, "question_id": 34754199, "link": "https://stackoverflow.com/questions/34754199/array-element-access-with-lens-in-the-state-monad/34757907#34757907", "title": "Array element access with lens in the state monad", "body": "<p>There is a function <a href=\"https://hackage.haskell.org/package/lens-4.13/docs/Control-Lens-Fold.html#v:preuse\" rel=\"nofollow\"><code>preuse</code></a> that sounds like exactly what you're looking for:</p>\n\n<pre><code>accessElemInState :: Int -&gt; State MyArray (Maybe Char)\naccessElemInState i = preuse $ ix i\n\n-- or\naccessElemInState = preuse . ix\n</code></pre>\n"}], "owner": {"reputation": 3385, "user_id": 841562, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4cbb35380ef84f4f0f68061f578a4e73?s=128&d=identicon&r=PG", "display_name": "Lemming", "link": "https://stackoverflow.com/users/841562/lemming"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 725, "favorite_count": 0, "accepted_answer_id": 34757907, "answer_count": 1, "score": 3, "last_activity_date": 1554304833, "creation_date": 1452634489, "last_edit_date": 1554304833, "question_id": 34754199, "link": "https://stackoverflow.com/questions/34754199/array-element-access-with-lens-in-the-state-monad", "title": "Array element access with lens in the state monad", "body": "<p>What is the recommended way to access an element of an array within the state\nmonad with <a href=\"https://hackage.haskell.org/package/lens\" rel=\"nofollow\">lens</a> if the value type\nis not a monoid.</p>\n\n<p>The following will fail to compile, because lens doesn't know what to do if\nthere is no element at the given index <code>i</code>.</p>\n\n<pre><code>type MyArray = Array Int Char\n-- accessElemInStateWrong :: Int -&gt; State MyArray Char\n-- accessElemInStateWrong i = use $ ix i\n</code></pre>\n\n<p>A working version can be implemented by combining <code>gets</code> from\n<code>Control.Monad.State.Class</code> with <code>preview</code> from <code>Control.Lens.Fold</code>.</p>\n\n<pre><code>accessElemInState :: Int -&gt; State MyArray (Maybe Char)\naccessElemInState i = gets $ preview $ ix i\n</code></pre>\n\n<p>This works just fine. However, given the plethora of functions and operators\nthat lens defines, I was surprised to find that there doesn't seem to be one\nfor this particular case.</p>\n\n<p>So, my question is: Does lens define something like <code>gets . preview</code>? And if\nnot, what's the recommended way to implement <code>accessElementInState</code>?</p>\n\n<hr>\n\n<p>The reason why I'm asking is because <code>lens</code> does define a special operator\noutside of the state monad. While the following will not compile for the same\nreason as above.</p>\n\n<pre><code>-- accessElemWrong :: Int -&gt; MyArray -&gt; Char\n-- accessElemWrong i a = a ^. ix i\n</code></pre>\n\n<p>We can use the operator <code>(^?)</code> to wrap the result in a <code>Maybe</code> and perform safe\nlookup.</p>\n\n<pre><code>accessElem :: Int -&gt; MyArray -&gt; Maybe Char\naccessElem i a = a ^? ix i\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1452633392, "post_id": 34753631, "comment_id": 57253954, "body": "Someone or other wrote about <code>&lt;$&gt;</code>, <code>&lt;*&gt;</code>, and <code>=&lt;&lt;</code> all being variations on function application. So it&#39;s helpful to give them all vaguely similar syntax. As Cale Gibbard (I think) said, it&#39;s unfortunate that <code>$</code> is right associative while all the other sorts of application are left associative."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1452642145, "post_id": 34753631, "comment_id": 57257835, "body": "Note that <code>&lt;*&gt;</code> isn&#39;t the same as fmap: rather, <code>&lt;$&gt;</code> is actually a synonym for fmap, and <code>&lt;*&gt;</code> is something that is <i>a lot like fmap</i>, but a bit different."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1452632604, "post_id": 34753706, "comment_id": 57253538, "body": "Though you could of course still write <code>f `fmap` x `ap` y `ap` z</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 10, "creation_date": 1452632642, "post_id": 34753706, "comment_id": 57253558, "body": "@leftaroundabout Sure. And if you&#39;re going to be doing that all the time, you might as well choose function names that can be used infix."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1460408980, "post_id": 34753706, "comment_id": 60719059, "body": "It&#39;s also worth mention that <code>&lt;*&gt;</code> has a stronger specification than <code>ap</code>, as it works on all Applicatives, and therefore all Monads, but <code>ap</code> only works on Monads."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 13, "last_activity_date": 1452632426, "creation_date": 1452632426, "answer_id": 34753706, "question_id": 34753631, "link": "https://stackoverflow.com/questions/34753631/why-is-an-infix-function-in-haskell/34753706#34753706", "title": "Why is &lt;*&gt; an infix function in Haskell?", "body": "<p>I think it's mostly motivated by this idiom:</p>\n\n<pre><code>f &lt;$&gt; x &lt;*&gt; y &lt;*&gt; z\n</code></pre>\n\n<p>Spelled with prefix functions it's a lot less pretty, and you need to know how many applications there are just to start typing:</p>\n\n<pre><code>ap (ap (fmap f x) y) z\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 4996462, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-d3OtW_WIFw4/AAAAAAAAAAI/AAAAAAAAACk/rOwkxo7XawA/photo.jpg?sz=128", "display_name": "Robin Haveneers", "link": "https://stackoverflow.com/users/4996462/robin-haveneers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 0, "accepted_answer_id": 34753706, "answer_count": 1, "score": 6, "last_activity_date": 1452632426, "creation_date": 1452632170, "question_id": 34753631, "link": "https://stackoverflow.com/questions/34753631/why-is-an-infix-function-in-haskell", "title": "Why is &lt;*&gt; an infix function in Haskell?", "body": "<p>Perhaps this is not the right place to ask and presumably this question is too 'meta', but is there any reason the <code>&lt;*&gt;</code> (and analogously <code>&lt;$&gt;</code>) function is infix? To my understanding and my knowledge (thus far) of Haskell it does the same as <code>fmap</code>. </p>\n\n<p>So, why is <code>fmap</code> not infix but its Applicative and Functor variant are?</p>\n"}, {"tags": ["haskell", "io", "frp", "reactive-banana", "sodiumfrp"], "comments": [{"owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "edited": false, "score": 0, "creation_date": 1452957947, "post_id": 34748759, "comment_id": 57398942, "body": "On a conceptual level, sampling a <code>Behavior</code> only makes sense in the context of a <code>Moment</code>, i.e. at a particular moment in time, which <code>IO</code> does not provide. This is not just a theoretical issue, but is important for the internal consistency of the implementation, so I&#39;m hesitating to add a function like this. Could you elaborate on the specific context in which you want to use this (dbus)? Chances are that it can be expressed in a different way."}, {"owner": {"reputation": 101, "user_id": 3695873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8ed811c6d7ee0c85bc2c5de743ba7de?s=128&d=identicon&r=PG", "display_name": "Philonous", "link": "https://stackoverflow.com/users/3695873/philonous"}, "edited": false, "score": 0, "creation_date": 1452979172, "post_id": 34748759, "comment_id": 57406131, "body": "Im setting a callback function (getCurrentState:: IO Response) when creating the property that is called when a request is received. Said callback function should somehow retrieve the current value of the Behaviour (presumably using the same notion of &quot;current&quot; or &quot;now&quot; as triggering an event by calling the handler function created by newAddHandler does)."}, {"owner": {"reputation": 101, "user_id": 3695873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8ed811c6d7ee0c85bc2c5de743ba7de?s=128&d=identicon&r=PG", "display_name": "Philonous", "link": "https://stackoverflow.com/users/3695873/philonous"}, "edited": false, "score": 1, "creation_date": 1452984968, "post_id": 34748759, "comment_id": 57407703, "body": "It turns out I can re-implement the same behaviour with the tools reactive-banana provides: <a href=\"https://gist.github.com/b334c81018628fd6cfc8\" rel=\"nofollow noreferrer\">gist</a>. I&#39;m using unsafePerformIO in this example to come as close as possible to sodium&#39;s semantics, but this is by no means necessary (I would just just have to pass the IO action around). So the question becomes: Is there a reason not to build the network with repeated &quot;execute&quot;s rather than directly with compile?"}, {"owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "edited": false, "score": 1, "creation_date": 1453156917, "post_id": 34748759, "comment_id": 57470100, "body": "@Philonous Could you be more precise and add code that shows the interaction between dbus and your code? I see a good chance that reading the Behavior can be packaged together with an Event."}, {"owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "edited": false, "score": 1, "creation_date": 1453157097, "post_id": 34748759, "comment_id": 57470180, "body": "@Philonous For the second question: Could you make an issue on Github for that? I do see the need for running MomentIO after the network has been built. Note that if several networks are allowed, then it is problematic to return a Behavior from <code>sync</code>, because you could try to use it in another network, which will fail horribly."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "edited": false, "score": 0, "creation_date": 1453807201, "post_id": 34748759, "comment_id": 57752165, "body": "@HeinrichApfelmus trying to see the bigger picture: how did Sodium differ that <code>sample</code> just worked there? Can I assume it was because it was breaking some laws...? Or was it a (safe) hack? Another question: could we simply generate an event that happens every, say, 0.01s, <code>&lt;@</code> that into the behavior, and get back roughly what Sodium offers? That would be less accurate but depending on needs, might work. (on another note: my gut feeling though is still to track what really is the underlying <code>Event</code> that directly or indirectly causes the vaue of the <code>Behavior</code> to change, and use that.)"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "edited": false, "score": 0, "creation_date": 1453808009, "post_id": 34748759, "comment_id": 57752564, "body": "@HeinrichApfelmus yet another idea: would it be theoretically possible to provide a <code>sample</code> that did (probably dependent-types based) analysis to see if there is indeed an underlying <code>Event</code> from which the <code>Behavior</code> is computed, and automatically <code>&lt;@</code> with that <code>Event</code>? but cause a compile error if no such <code>Event</code> exists? But then again, outside &quot;influence&quot; is always ultimately an <code>Event</code>, so I think <code>sample</code> could always <i>just work</i> and thus deptypes would not even be needed...?"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1453808141, "post_id": 34748759, "comment_id": 57752620, "body": "Acutally, a <code>Behavior</code> can obviously also lazily read from an external resource (although, under the hood, absolutely everything is interrupt-based, so at least conceptually it&#39;s all event-based), so I guess deptypes or equiv. would still be needed."}, {"owner": {"reputation": 101, "user_id": 3695873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8ed811c6d7ee0c85bc2c5de743ba7de?s=128&d=identicon&r=PG", "display_name": "Philonous", "link": "https://stackoverflow.com/users/3695873/philonous"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1453906350, "post_id": 34748759, "comment_id": 57805497, "body": "@erik-allik Reactive-banana does already have sample (called <a href=\"http://hackage.haskell.org/package/reactive-banana-1.1.0.0/docs/Reactive-Banana-Combinators.html#v:valueB\" rel=\"nofollow noreferrer\">valueB</a>), it&#39;s <a href=\"http://hackage.haskell.org/package/sodium-0.11.0.3/docs/FRP-Sodium.html#v:sync\" rel=\"nofollow noreferrer\">sync</a> that&#39;s missing. And I managed to <a href=\"https://gist.github.com/Philonous/29a9976ae72f90ebb191\" rel=\"nofollow noreferrer\">simulate</a> it with the primitives available in reactive-banana, so it can&#39;t be breaking any laws that reactive-banana isn&#39;t already breaking."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1453907710, "post_id": 34748759, "comment_id": 57806528, "body": "Could you <i>please</i> share your solution in the form of an answer? I would love to learn from and upvote it. Your original question has 9 upvotes so it kind of even is your moral duty to resolve what you started :)"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "edited": false, "score": 0, "creation_date": 1453907959, "post_id": 34748759, "comment_id": 57806710, "body": "Although I still think my own idea viable, i.e. to extract any underlying <code>Event</code> from a <code>Behavior</code> under observation \u2014 because <code>valueB</code> is nice but it does not stay within the pure world of events and behaviors, but a deeper solution could. Looking forward to a reply by @HeinrichApfelmus"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 3695873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8ed811c6d7ee0c85bc2c5de743ba7de?s=128&d=identicon&r=PG", "display_name": "Philonous", "link": "https://stackoverflow.com/users/3695873/philonous"}, "edited": false, "score": 0, "creation_date": 1452690979, "post_id": 34755610, "comment_id": 57280204, "body": "I&#39;m not sure how this applies to my question. I&#39;m fairly certain that it should be a Behaviour, since it models a time-varying value. My problem is that I have a request coming in from the network that I would like to answer with the current value of this Behaviour. Of course, I could model the arrival of this request as an Event (by triggering a handler), but this will only get the request into the (frp-) network, it can&#39;t retrieve the result to send back."}, {"owner": {"reputation": 101, "user_id": 3695873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8ed811c6d7ee0c85bc2c5de743ba7de?s=128&d=identicon&r=PG", "display_name": "Philonous", "link": "https://stackoverflow.com/users/3695873/philonous"}, "edited": false, "score": 0, "creation_date": 1452691795, "post_id": 34755610, "comment_id": 57280733, "body": "My choice of the word &quot;poll&quot; may have been misleading. I do not want to check when the value has changed, rather I&#39;d like to retrieve the value of a Behaviour at certain times, e.g. to answer a network request (think HTTP)"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 101, "user_id": 3695873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8ed811c6d7ee0c85bc2c5de743ba7de?s=128&d=identicon&r=PG", "display_name": "Philonous", "link": "https://stackoverflow.com/users/3695873/philonous"}, "edited": false, "score": 0, "creation_date": 1452694911, "post_id": 34755610, "comment_id": 57282964, "body": "Oh, I see, my bad then :)"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 101, "user_id": 3695873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8ed811c6d7ee0c85bc2c5de743ba7de?s=128&d=identicon&r=PG", "display_name": "Philonous", "link": "https://stackoverflow.com/users/3695873/philonous"}, "edited": false, "score": 0, "creation_date": 1453807765, "post_id": 34755610, "comment_id": 57752440, "body": "Actually retracted my deletion \u2014 I still think this is the way to go. This only does not work if there is <i>no</i> underlying <code>Event</code> that is &quot;triggering&quot; changes to the <code>Behavior</code>, which might or might not be the case. But then again, you could also consider <i>changing</i> your design in a way that you are relying on an incoming event to emit outgoing events. Anything else is either a hack (breaking the laws) or an approximation (time-based sampling)... but I might be missing something."}], "tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 0, "last_activity_date": 1453807788, "last_edit_date": 1453807788, "creation_date": 1452640632, "answer_id": 34755610, "question_id": 34748759, "link": "https://stackoverflow.com/questions/34748759/sampling-a-behaviour-from-outside-network/34755610#34755610", "title": "Sampling a behaviour from outside network", "body": "<p>For conceptual/architectural reasons, Reactive Banana has functions from <code>Event</code> to <code>Behavior</code>, but not vice versa, and it makes sense too, given th nature and meaning of FRP. I'm quite sure you can write a polling function, but instead you should consider changing the underlying code to expose events instead.</p>\n\n<p>Is there a reason you can't change your <code>Behavior</code> into an <code>Event</code>? If not, that would be a good way to go about resolving your issue. (It might in theory even reveal a design shortcoming you have been overlooking so far.)</p>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 3695873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8ed811c6d7ee0c85bc2c5de743ba7de?s=128&d=identicon&r=PG", "display_name": "Philonous", "link": "https://stackoverflow.com/users/3695873/philonous"}, "edited": false, "score": 0, "creation_date": 1452768984, "post_id": 34780502, "comment_id": 57319044, "body": "There is no action to reply to the request, rather, the return value of the callback set for the dbus property is sent in reply. What I could do is create a new IORef and pass is into the Event along with the request, use reactimate to put the sampled value into the IORef, and then read the IORef in the request handling function once the Event-call returns. However, this requires interacting code in two places (the event network and the callback funcion) which makes the code harder to maintain, compared to the simple solution that sodium affords."}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": false, "score": 1, "last_activity_date": 1452737091, "creation_date": 1452737091, "answer_id": 34780502, "question_id": 34748759, "link": "https://stackoverflow.com/questions/34748759/sampling-a-behaviour-from-outside-network/34780502#34780502", "title": "Sampling a behaviour from outside network", "body": "<p>If you have a Behaviour modelling the value of your property, and you have an Event modelling the incoming requests for the property's value, then you can just use <code>(&lt;@) :: Behavior b -&gt; Event a -&gt; Event b</code><sup>1</sup> to get a new event occurring at the times of your incoming requests with the value the property has at that time). Then you can transform that into the actual IO actions you need to take to reply to the request and use <code>reactimate</code> as usual.</p>\n\n<hr>\n\n<p><sup>1</sup> <a href=\"https://hackage.haskell.org/package/reactive-banana-1.1.0.0/docs/Reactive-Banana-Combinators.html#v:-60--64-\" rel=\"nofollow\">https://hackage.haskell.org/package/reactive-banana-1.1.0.0/docs/Reactive-Banana-Combinators.html#v:-60--64-</a></p>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 3695873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8ed811c6d7ee0c85bc2c5de743ba7de?s=128&d=identicon&r=PG", "display_name": "Philonous", "link": "https://stackoverflow.com/users/3695873/philonous"}, "is_accepted": true, "score": 0, "last_activity_date": 1453922247, "creation_date": 1453922247, "answer_id": 35046113, "question_id": 34748759, "link": "https://stackoverflow.com/questions/34748759/sampling-a-behaviour-from-outside-network/35046113#35046113", "title": "Sampling a behaviour from outside network", "body": "<p>The answer seems to be \"it's sort of possible\". </p>\n\n<p><a href=\"http://hackage.haskell.org/package/sodium-0.11.0.3/docs/FRP-Sodium.html#v:sync\" rel=\"nofollow\">sample</a> corresponds to <a href=\"http://hackage.haskell.org/package/reactive-banana-1.1.0.0/docs/Reactive-Banana-Combinators.html#v:valueB\" rel=\"nofollow\">valueB</a>, but there is no direct equivalent to <a href=\"http://hackage.haskell.org/package/sodium-0.11.0.3/docs/FRP-Sodium.html#v:sync\" rel=\"nofollow\">sync</a>. </p>\n\n<p>However, it can be re-implemented with the help of <a href=\"http://hackage.haskell.org/package/reactive-banana-1.1.0.0/docs/Reactive-Banana-Frameworks.html#v:execute\" rel=\"nofollow\">execute</a>:</p>\n\n<pre><code>module Sync where\n\nimport Control.Monad.Trans\nimport Data.IORef\nimport Reactive.Banana\nimport Reactive.Banana.Frameworks\n\ndata Network = Network { eventNetwork :: EventNetwork\n                       , run :: MomentIO () -&gt; IO ()\n                       }\n\nnewNet :: IO Network\nnewNet = do\n    -- Create a new Event to handle MomentIO actions to be executed\n    (ah, call) &lt;- newAddHandler\n    network &lt;- compile $ do\n        globalExecuteEV &lt;- fromAddHandler ah\n        -- Set it up so it executes MomentIO actions passed to it\n        _ &lt;- execute globalExecuteEV\n        return ()\n    actuate network\n    return $ Network { eventNetwork = network\n                     , run = call -- IO Action to fire the event\n                     }\n\n-- To run a MomentIO action within the context of the network, pass it to the\n-- event.\nsync :: Network -&gt; MomentIO a -&gt; IO a\nsync Network{run = call} f = do\n    -- To retrieve the result of the action we set up an IORef\n    ref &lt;- newIORef (error \"Network hasn't written result to ref\")\n    -- (`call' passes the do-block to the event)\n    call $ do\n        res &lt;- f\n        -- Put the result into the IORef\n        liftIO $ writeIORef ref res\n    -- and read it back once the event has finished firing\n    readIORef ref\n\n-- Example\nmain :: IO ()\nmain = do\n    net &lt;- newNet -- Create an empty network\n    (bhv1, set1) &lt;- sync net $ newBehavior (0 :: Integer)\n    (bhv2, set2) &lt;- sync net $ newBehavior (0 :: Integer)\n    set1 3\n    set2 7\n    let sumB = (liftA2 (+) bhv1 bhv2)\n    print =&lt;&lt; sync net (valueB sumB)\n    set1 5\n    print =&lt;&lt; sync net (valueB sumB)\n    return ()\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 3695873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8ed811c6d7ee0c85bc2c5de743ba7de?s=128&d=identicon&r=PG", "display_name": "Philonous", "link": "https://stackoverflow.com/users/3695873/philonous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 3, "accepted_answer_id": 35046113, "answer_count": 3, "score": 10, "last_activity_date": 1453922247, "creation_date": 1452615795, "last_edit_date": 1453807873, "question_id": 34748759, "link": "https://stackoverflow.com/questions/34748759/sampling-a-behaviour-from-outside-network", "title": "Sampling a behaviour from outside network", "body": "<p>Since sodium has been <a href=\"http://blog.reactiveprogramming.org/?p=258\" rel=\"nofollow\">deprecated </a> by the author I'm trying to port my code to reactive-banana. However, there seem to be some incongruencies between the two that I'm having a hard time overcomming.</p>\n\n<p>For example, in sodium it was easy to retrieve the current value of a behaviour:</p>\n\n<pre><code>retrieve :: Behaviour a -&gt; IO a\nretrieve b = sync $ sample b\n</code></pre>\n\n<p>I don't see how to do this in reactive-banana</p>\n\n<p>(The reason I want this is because I'm trying to export the behaviour as a dbus property. Properties can be queried from other dbus clients)</p>\n\n<p>Edit: Replaced the word \"poll\" as it was misleading</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 4, "creation_date": 1452611029, "post_id": 34746966, "comment_id": 57239753, "body": "Was answered before: <a href=\"http://stackoverflow.com/questions/32974091/what-does-mean-in-a-type-signature/32974148#32974148\" title=\"what does mean in a type signature\">stackoverflow.com/questions/32974091/&hellip;</a>"}, {"owner": {"reputation": 1363, "user_id": 5779452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5c07c442a138d5852b368944ecf43a4c?s=128&d=identicon&r=PG&f=1", "display_name": "DxAlpha", "link": "https://stackoverflow.com/users/5779452/dxalpha"}, "reply_to_user": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 1, "creation_date": 1452611612, "post_id": 34746966, "comment_id": 57240200, "body": "For some reason, I couldn&#39;t find that link even though I used similar wording."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1452631610, "post_id": 34746966, "comment_id": 57253025, "body": "@DxAlpha: Don&#39;t worry. Your question is still adding value, as the next one who looks for <code>=&gt;</code> might find it. Duplicates aren&#39;t necessarily bad things."}], "answers": [{"tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": false, "score": 0, "last_activity_date": 1452611044, "creation_date": 1452611044, "answer_id": 34747021, "question_id": 34746966, "link": "https://stackoverflow.com/questions/34746966/what-exactly-does-do-in-haskell/34747021#34747021", "title": "What exactly does =&gt; do in haskell?", "body": "<p>It constrains a parameter <code>a</code> to a certain class, in this case <code>Integral</code> and <code>Show</code></p>\n"}, {"comments": [{"owner": {"reputation": 1363, "user_id": 5779452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5c07c442a138d5852b368944ecf43a4c?s=128&d=identicon&r=PG&f=1", "display_name": "DxAlpha", "link": "https://stackoverflow.com/users/5779452/dxalpha"}, "edited": false, "score": 0, "creation_date": 1452611408, "post_id": 34747031, "comment_id": 57240025, "body": "Yeah I don&#39;t think I&#39;ve gotten to the classes yet.  I usually just see it through the standard OOP definition but I wish that they would use different names if it is not based on OOP."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 1363, "user_id": 5779452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5c07c442a138d5852b368944ecf43a4c?s=128&d=identicon&r=PG&f=1", "display_name": "DxAlpha", "link": "https://stackoverflow.com/users/5779452/dxalpha"}, "edited": false, "score": 0, "creation_date": 1452611450, "post_id": 34747031, "comment_id": 57240063, "body": "@DxAlpha: then see it as a constraint such that you can use a set of function defined on <code>a</code>. This is not the &quot;full&quot; specification, but will probably suffice for now."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 0, "last_activity_date": 1452611537, "last_edit_date": 1452611537, "creation_date": 1452611079, "answer_id": 34747031, "question_id": 34746966, "link": "https://stackoverflow.com/questions/34746966/what-exactly-does-do-in-haskell/34747031#34747031", "title": "What exactly does =&gt; do in haskell?", "body": "<p><strong>In short</strong>:</p>\n\n<p>Although not complete, if you haven't yet read about <code>class</code>es, you can see it as a constraint that there is defined a set of functions on the type <code>a</code>.</p>\n\n<p><strong>Explanation</strong>:</p>\n\n<p>You can see it as putting constraints on a type. For instance in the case of <code>lucky</code>:</p>\n\n<pre><code>lucky :: (Integral a) =&gt; a -&gt; String\n</code></pre>\n\n<p>It means the function is defined <em>for any type <code>a</code>, as long as <code>a</code> is an <code>instance</code> of <code>Integral</code></em>.</p>\n\n<p>Now I don't know if you are familiar with <code>class</code>es yet (those are not the ones used in object-oriented programming), but classes more or less introduce functions on <code>a</code> that can then by used in your function definition. For instance the class <code>Integral</code> is defined as:</p>\n\n<pre><code>class (Real a, Enum a) =&gt; Integral a where\n  quot :: a -&gt; a -&gt; a\n  rem :: a -&gt; a -&gt; a\n  div :: a -&gt; a -&gt; a\n  mod :: a -&gt; a -&gt; a\n  quotRem :: a -&gt; a -&gt; (a, a)\n  divMod :: a -&gt; a -&gt; (a, a)\n  toInteger :: a -&gt; Integer\n</code></pre>\n\n<p>Now this class is rather hard to understand since it uses <code>=&gt;</code> in the signature as well. Perhaps an easier one is <code>Show</code>:</p>\n\n<pre><code>class Show a where\n  showsPrec :: Int -&gt; a -&gt; ShowS\n  show :: a -&gt; String\n  showList :: [a] -&gt; ShowS\n</code></pre>\n\n<p>It means that if <code>a</code> is an instance of <code>Show</code>, that <strong>you can use the <code>show</code> function on <code>a</code></strong>. Otherwise the following line:</p>\n\n<pre><code>tell (x:[]) = \"The list has one element: \" ++ show x\n</code></pre>\n\n<p>would not compile since Haskell isn't sure it can call <code>show</code> on <code>x</code>. By constraining the type <code>a</code> however, we know that we can only use <code>tell</code> on types where <code>a</code> is an instance of <code>Show</code>, and thus the <code>show</code> function is defined.</p>\n"}], "owner": {"reputation": 1363, "user_id": 5779452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5c07c442a138d5852b368944ecf43a4c?s=128&d=identicon&r=PG&f=1", "display_name": "DxAlpha", "link": "https://stackoverflow.com/users/5779452/dxalpha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "closed_date": 1452611646, "accepted_answer_id": 34747031, "answer_count": 2, "score": 1, "last_activity_date": 1452611537, "creation_date": 1452610885, "question_id": 34746966, "link": "https://stackoverflow.com/questions/34746966/what-exactly-does-do-in-haskell", "closed_reason": "Duplicate", "title": "What exactly does =&gt; do in haskell?", "body": "<p>I've just started reading through Learn You a Haskell for Great Good.  In chapter 3, I've seen the author use => but I could not find out exactly what it does and why they use it.</p>\n\n<p>I think this is the first time it was used:</p>\n\n<pre><code>lucky :: (Integral a) =&gt; a -&gt; String  \nlucky 7 = \"LUCKY NUMBER SEVEN!\"  \nlucky x = \"Sorry, you're out of luck, pal!\" \n</code></pre>\n\n<p>Here is another example:</p>\n\n<pre><code>tell :: (Show a) =&gt; [a] -&gt; String  \ntell [] = \"The list is empty\"  \ntell (x:[]) = \"The list has one element: \" ++ show x  \ntell (x:y:[]) = \"The list has two elements: \" ++ show x ++ \" and \" ++ show y  \ntell (x:y:_) = \"This list is long. The first two elements are: \" ++ show x ++ \" and \" ++ show y  \n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["xml", "haskell", "hxt"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 1056350, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2e771754034e77080eea435ede7810cd?s=128&d=identicon&r=PG", "display_name": "Iggy M", "link": "https://stackoverflow.com/users/1056350/iggy-m"}, "edited": false, "score": 1, "creation_date": 1452701778, "post_id": 34751827, "comment_id": 57288175, "body": "Thank you. This is what I will end up using. But I am still wondering whether there is a way to convert a simple returned value <code>x</code> which I get with <code>x &lt;- runX parseRoot</code> to arrow <code>a</code> for later use: <code>runX $ a &gt;&gt;&gt; parseSomething</code> `"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "reply_to_user": {"reputation": 115, "user_id": 1056350, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2e771754034e77080eea435ede7810cd?s=128&d=identicon&r=PG", "display_name": "Iggy M", "link": "https://stackoverflow.com/users/1056350/iggy-m"}, "edited": false, "score": 1, "creation_date": 1452710507, "post_id": 34751827, "comment_id": 57294144, "body": "I don&#39;t understand what you mean by &quot;convert a value to an arrow&quot;. An arrow is a morphism from one value to another. A function is another kind of morphism, so its a bit like saying you want to convert your value into a function.  A function to do what?"}, {"owner": {"reputation": 115, "user_id": 1056350, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2e771754034e77080eea435ede7810cd?s=128&d=identicon&r=PG", "display_name": "Iggy M", "link": "https://stackoverflow.com/users/1056350/iggy-m"}, "edited": false, "score": 1, "creation_date": 1452979753, "post_id": 34751827, "comment_id": 57406302, "body": "That&#39;s right! &quot;Convert a value to an arrow&quot; is exactly what I meant, and there is a function <code>constA</code> that does this. I guess I didn&#39;t pose original question well enough."}], "tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 1, "last_activity_date": 1452625508, "creation_date": 1452625508, "answer_id": 34751827, "question_id": 34746375, "link": "https://stackoverflow.com/questions/34746375/hxt-reuse-preparsed-data/34751827#34751827", "title": "HXT: reuse &quot;preparsed&quot; data", "body": "<p>You need to do the same thing in parseDoc that you do in getWindow:</p>\n\n<pre><code>runX $ parseXML filename &gt;&gt;&gt; proc myDoc -&gt; do\n    window &lt;- getWindow -&lt; myDoc\n    something &lt;- getSomethingElse -&lt; myDoc\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 115, "user_id": 1056350, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2e771754034e77080eea435ede7810cd?s=128&d=identicon&r=PG", "display_name": "Iggy M", "link": "https://stackoverflow.com/users/1056350/iggy-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1452979558, "creation_date": 1452979558, "answer_id": 34832317, "question_id": 34746375, "link": "https://stackoverflow.com/questions/34746375/hxt-reuse-preparsed-data/34832317#34832317", "title": "HXT: reuse &quot;preparsed&quot; data", "body": "<p>After reading more about arrows I found this:</p>\n\n<pre><code>\u03bb: :t constA\nconstA :: ArrowList a =&gt; c -&gt; a b c\n</code></pre>\n\n<p>Now using <code>constA</code> on an element of type <code>XmlTree</code> we get an arrow that we can reuse:</p>\n\n<pre><code>main = do\n  x &lt;- runX parseRoot\n  windows &lt;- runX $ constA (head x) &gt;&gt;&gt; getWindow\n  doors &lt;- runX $ constA (head x) &gt;&gt;&gt; getDoor\n</code></pre>\n\n<p>I have to use <code>head x</code> as <code>x</code> will be of type <code>[XmlTree]</code> but the second arrow expects <code>XmlTree</code>.</p>\n"}], "owner": {"reputation": 115, "user_id": 1056350, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2e771754034e77080eea435ede7810cd?s=128&d=identicon&r=PG", "display_name": "Iggy M", "link": "https://stackoverflow.com/users/1056350/iggy-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 2, "accepted_answer_id": 34832317, "answer_count": 2, "score": 1, "last_activity_date": 1452979558, "creation_date": 1452609105, "question_id": 34746375, "link": "https://stackoverflow.com/questions/34746375/hxt-reuse-preparsed-data", "title": "HXT: reuse &quot;preparsed&quot; data", "body": "<p>I am trying to 'preparse' XML with HXT into [XmlTree] once and then reuse this data several times.</p>\n\n<p>Below is my code:</p>\n\n<pre><code>{-# LANGUAGE Arrows, NoMonomorphismRestriction #-}\nimport Text.XML.HXT.Core\n\nparseXML = readDocument [ withValidate no\n                        , withRemoveWS yes  -- throw away formating WS\n                        ] \n\natTag tag = deep (isElem &gt;&gt;&gt; hasName tag)\n\n\ndata UiWindow = UiWindow {\n    wndName :: String,\n    wndNameLib :: String,\n    wndChildren :: [UiWindow]\n    } deriving (Show)\n\ninitUiWindow = UiWindow {\n    wndName = \"empty\",\n    wndNameLib = \"\",\n    wndChildren = []\n    }\n\n\nparseDoc docName = runX $ parseXML fileName &gt;&gt;&gt; getWindow\n  where\n    fileName = docName ++ \".xml\"\n\n\ngetWindow = atTag \"Window\" &gt;&gt;&gt; proc x -&gt; do\n    libraryItemName &lt;- getAttrValue \"libraryItemName\" -&lt; x\n    name &lt;- getAttrValue \"name\" -&lt; x\n    children &lt;- arrIO parseDoc -&lt; libraryItemName\n    returnA -&lt; initUiWindow { wndName = name, wndNameLib = libraryItemName, wndChildren = children}\n\n\ndocumentName = \"DOMDocument.xml\"        \n\nparseRoot = parseXML documentName\n\n--runX (parseRoot &gt;&gt;&gt; getWindow )\n</code></pre>\n\n<p>If I parse beforehand: </p>\n\n<pre><code>\u03bb: x &lt;- runX parseRoot\n\n\u03bb: :t x\nx :: [XmlTree]\n\u03bb: :t getWindow\ngetWindow :: IOSLA (XIOState ()) XmlTree UiWindow\n</code></pre>\n\n<p>How do I run something like this:</p>\n\n<pre><code>runX $ XYZ(x) &gt;&gt;&gt; getWindow\n</code></pre>\n\n<p>or this:</p>\n\n<pre><code>runX $ XYZ(x) &gt;&gt;&gt; getSomethingElse\n</code></pre>\n\n<p>Allowing me to reuse data in 'x'.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 84157, "user_id": 238978, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a633afaf19e6d4bb53ee50b62e3b5397?s=128&d=identicon&r=PG", "display_name": "Emil Vikstr&#246;m", "link": "https://stackoverflow.com/users/238978/emil-vikstr%c3%b6m"}, "edited": false, "score": 1, "creation_date": 1452609051, "post_id": 34746196, "comment_id": 57238206, "body": "See also <a href=\"http://stackoverflow.com/q/4328620/238978\">stackoverflow.com/q/4328620/238978</a>"}, {"owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "edited": false, "score": 3, "creation_date": 1452609300, "post_id": 34746196, "comment_id": 57238394, "body": "If you actually want to add some logging, you might be interested in the <a href=\"https://wiki.haskell.org/All_About_Monads#The_Writer_monad\" rel=\"nofollow noreferrer\">writer monad</a>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "edited": false, "score": 0, "creation_date": 1452651168, "post_id": 34746196, "comment_id": 57260374, "body": "@FrerichRaabe, I&#39;ve demonstrated this, and a different technique than yours, in my answer."}, {"owner": {"reputation": 837, "user_id": 5784051, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/smjWQ.jpg?s=128&g=1", "display_name": "Xwtek", "link": "https://stackoverflow.com/users/5784051/xwtek"}, "edited": false, "score": 0, "creation_date": 1452685580, "post_id": 34746196, "comment_id": 57276637, "body": "<a href=\"https://en.wikipedia.org/wiki/Rice&#39;s_theorem\" rel=\"nofollow noreferrer\">Rice&#39;s theorem</a> have a word for you."}], "answers": [{"tags": [], "owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "is_accepted": true, "score": 10, "last_activity_date": 1452609149, "creation_date": 1452609149, "answer_id": 34746392, "question_id": 34746196, "link": "https://stackoverflow.com/questions/34746196/haskell-is-it-possible-to-identify-which-function-was-passed-as-parameter-to-a/34746392#34746392", "title": "Haskell: Is it possible to identify which function was passed as parameter to a high order function?", "body": "<p>No, this is not possible.</p>\n\n<p>You could achieve something to that effect by having a data type which represents the operation, maybe</p>\n\n<pre><code>data Operation\n    = Add (a -&gt; a -&gt; a)\n    | Sub (a -&gt; a -&gt; a)\n    | Other (a -&gt; a -&gt; a)\n\nmyFunc :: Operation -&gt; a -&gt; a -&gt; IO a\nmyFunc (Add f) x y = do print \"add was performed\"\n                     return (f x y)\nmyFunc (Sub f) x y = do print \"sub was performed\"\n                     return (f x y)\nmyFunc (Other f) x y = do print \"another function was performed\"\n                     return (f x y)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "edited": false, "score": 0, "creation_date": 1452675259, "post_id": 34752820, "comment_id": 57269418, "body": "I found that a useful first step towards <code>evalExpr</code> would be to define a fold on <code>Expr a</code>, i.e. <code>foldExpr :: (a -&gt; b) -&gt; (Op a -&gt; b -&gt; b) -&gt; Expr a -&gt; b</code>. That would simplify the eval function to <code>evalExpr = foldExpr id runOp</code>, but it also permits pretty printing or, say, counting the number of additions in the expression or so. It makes dealing with <code>Expr a</code> values very easy."}, {"owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "edited": false, "score": 0, "creation_date": 1452675704, "post_id": 34752820, "comment_id": 57269711, "body": "I forgot a <code>-&gt; b</code> there, I meant to write <code>foldExpr :: (a -&gt; b) -&gt; (Op a -&gt; b -&gt; b -&gt; b) -&gt; Expr a -&gt; b</code>. StackOverflow won&#39;t let me fix my earlier comment. :o]"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1452650734, "last_edit_date": 1452650734, "creation_date": 1452629159, "answer_id": 34752820, "question_id": 34746196, "link": "https://stackoverflow.com/questions/34746196/haskell-is-it-possible-to-identify-which-function-was-passed-as-parameter-to-a/34752820#34752820", "title": "Haskell: Is it possible to identify which function was passed as parameter to a high order function?", "body": "<p>It's not possible to do exactly what you requested. I would recommend that you instead make an embedded domain-specific language (EDSL) and write one or more interpreters for it. The most common approach is to represent the EDSL using an algebraic datatype or (in more complicated situations) a generalized algebraic datatype. Here you might have something like</p>\n\n<pre><code>data Expr a = Lit a\n            | BinOp (Op a) (Expr a) (Expr a)\n            deriving (Show)\n\ndata Op a = Add\n          | Sub\n          | Other (a -&gt; a -&gt; a)\n\ninstance Show (Op a) where\n  show Add = \"Add\"\n  show Sub = \"Sub\"\n  show Other{} = \"Other\"\n</code></pre>\n\n<p>Now you can write an evaluator that takes an <code>Expr a</code> and performs the requested operations:</p>\n\n<pre><code>evalExpr :: Num a =&gt; Expr a -&gt; a\nevalExpr (Lit x) = x\nevalExpr (BinOp op e1 e2) = runOp op (evalExpr e1) (evalExpr e2)\n\nrunOp :: Num a =&gt; Op a -&gt; a -&gt; a -&gt; a\nrunOp Add a b = a + b\nrunOp Sub a b = a - b\nrunOp (Other f) a b = f a b\n</code></pre>\n\n<p>You can add tracing too:</p>\n\n<pre><code>evalExpr' :: (Num a, MonadWriter [(Expr a, a)] m) =&gt; Expr a -&gt; m a\nevalExpr' e = do\n    result &lt;- case e of\n                Lit a -&gt; return a\n                BinOp op e1 e2 -&gt; runOp op &lt;$&gt; evalExpr' e1 &lt;*&gt; evalExpr' e2\n    tell [(e, result)]\n    return result\n</code></pre>\n\n<p>Sample use:</p>\n\n<pre><code>*Write&gt; runWriter $ evalExpr' (BinOp Add (Lit 3) (BinOp Sub (Lit 4) (Lit 5)))\n(2,[(Lit 3,3),(Lit 4,4),(Lit 5,5),(BinOp Sub (Lit 4) (Lit 5),-1),(BinOp Add (Lit 3) (BinOp Sub (Lit 4) (Lit 5)),2)])\n</code></pre>\n\n<p>For convenience, you can write</p>\n\n<pre><code>instance Num a =&gt; Num (Expr a) where\n  fromInteger = Lit . fromInteger\n  (+) = BinOp Add\n  (-) = BinOp Sub\n</code></pre>\n\n<p>Then the above can be abbreviated</p>\n\n<pre><code>*Write Control.Monad.Writer&gt; runWriter $ evalExpr' (3 + (4-5))\n(2,[(Lit 3,3),(Lit 4,4),(Lit 5,5),(BinOp Sub (Lit 4) (Lit 5),-1),(BinOp Add (Lit 3) (BinOp Sub (Lit 4) (Lit 5)),2)])\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1452651007, "post_id": 34756798, "comment_id": 57260333, "body": "No, there is no way to make it work 100% of the time. <code>brokenAdd :: (Eq a, Num a) =&gt; a -&gt; a -&gt; a -&gt; a -&gt; a; brokenAdd breakx breaky x y = if x == breakx &amp;&amp; y == breaky then x + y + 1 else x + y</code>. You can apply <code>brokenAdd</code> to arbitrarily large numbers, breaking any finite test."}], "tags": [], "owner": {"reputation": 443, "user_id": 4621761, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/OeIZl.jpg?s=128&g=1", "display_name": "sharp_c-tudent", "link": "https://stackoverflow.com/users/4621761/sharp-c-tudent"}, "is_accepted": false, "score": 1, "last_activity_date": 1452647745, "creation_date": 1452647745, "answer_id": 34756798, "question_id": 34746196, "link": "https://stackoverflow.com/questions/34746196/haskell-is-it-possible-to-identify-which-function-was-passed-as-parameter-to-a/34756798#34756798", "title": "Haskell: Is it possible to identify which function was passed as parameter to a high order function?", "body": "<p>Maybe to simplify and not to change a lot the overall look of your code, if it's already a long project and that's a concern, you could do something like:</p>\n\n<pre><code>add  x y = x+y\nsub  x y = x-y\n\nmyFunc :: (Eq a, Num a) =&gt; (a-&gt;a-&gt;a) -&gt; a -&gt; a -&gt; IO a\nmyFunc f x y =  if (add x y) == (f x y) then \n                   do print \"add was performed\"\n                      return (add x y) \n                else if (sub x y) == (f x y) then \n                        do print \"sub was performed\"\n                        return (sub x y)\n                else\n                    do print \"another function was performed\"\n                       return (f x y)\n</code></pre>\n\n<p>It works, the only problem is that you wont be able to diferentiate for example an add 2 1 from a multiplication 2 1, so if thats a possibility you can throw new cases in there to cover all important grounds, like instead of only comparing add x y = f x y, also compare add y x with f y x. With some thought it will work 100% of the time.</p>\n"}], "owner": {"reputation": 331, "user_id": 3120835, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/48c2c7ebc4561f431e104d799f6d4256?s=128&d=identicon&r=PG&f=1", "display_name": "andregps", "link": "https://stackoverflow.com/users/3120835/andregps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 1, "accepted_answer_id": 34746392, "answer_count": 3, "score": 3, "last_activity_date": 1452650734, "creation_date": 1452608647, "question_id": 34746196, "link": "https://stackoverflow.com/questions/34746196/haskell-is-it-possible-to-identify-which-function-was-passed-as-parameter-to-a", "title": "Haskell: Is it possible to identify which function was passed as parameter to a high order function?", "body": "<p>I want to idenfity what function was passed as parameter to a high-order function. \nHow can i do that? Using pattern matching? \nI want to do something like the following code:</p>\n\n<pre><code>add x y = x+y\nsub x y = x-y\n\nmyFunc :: (a-&gt;a-&gt;a) -&gt; a -&gt; a -&gt; IO a\nmyFunc add x y = do print \"add was performed\"\n                    add x y \nmyFunc sub x y = do print \"sub was performed\"\n                    sum x y\nmyFunc f x y = do print \"another function was performed\"\n                  f x y\n</code></pre>\n\n<p>If this is not possible,  does anyone has other idea to do that?</p>\n"}, {"tags": ["haskell", "pattern-matching", "helper"], "answers": [{"comments": [{"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1452605327, "post_id": 34742434, "comment_id": 57235357, "body": "And without the &quot;where&quot;? There could still be sharing by CSE."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 1, "creation_date": 1452606311, "post_id": 34742434, "comment_id": 57236099, "body": "@d8d0d65b3f7cf42 Unless <code>arbitrary_complex_calculation</code> has a polymorphic type (which would mess with the <code>Show</code> instance, though). Also, GHC <a href=\"https://wiki.haskell.org/GHC/FAQ#Does_GHC_do_common_subexpression_elimination.3F\" rel=\"nofollow noreferrer\">uses CSE only sparsely</a> (but I don&#39;t know whether this still holds in GHC 7.10+)."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 9, "last_activity_date": 1452598006, "creation_date": 1452598006, "answer_id": 34742434, "question_id": 34742270, "link": "https://stackoverflow.com/questions/34742270/sharing-definitions-across-guard-patterns/34742434#34742434", "title": "sharing definitions across guard patterns", "body": "<p>Yes, a <code>where</code> clause is valid (and often used) with guards:</p>\n\n<pre><code>arbitrary :: String -&gt; String -&gt; Maybe String\narbitrary st1 st2 \n  | st1 == st2 = Just \"foo\"\n  | acc ==  7  = Nothing\n  | otherwise  = Just $ show acc\n where \n   acc = arbitrarily_complex_calculation\n</code></pre>\n"}], "owner": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 34742434, "answer_count": 1, "score": 3, "last_activity_date": 1452606596, "creation_date": 1452597529, "last_edit_date": 1452606596, "question_id": 34742270, "link": "https://stackoverflow.com/questions/34742270/sharing-definitions-across-guard-patterns", "title": "sharing definitions across guard patterns", "body": "<p>Say I have a function:</p>\n\n<pre><code>arbitrary :: String -&gt; String -&gt; Maybe String\narbitrary st1 st2 | (st1 == st2) = Just \"foo\"\n                  | (arbitrarily_complex_calculation == 7) = Nothing\n                  | otherwise = Just $ show arbitrarily_complex_calculation\n</code></pre>\n\n<p>How can I share arbitrarily complex_calculation across the two guard blocks? Can this be done via a <code>let</code> / <code>where</code> or do I have to write a helper function?</p>\n"}, {"tags": ["haskell", "functional-programming", "function-composition"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 5, "creation_date": 1452586107, "post_id": 34737915, "comment_id": 57222642, "body": "You&#39;re right in that it &quot;doesn&#39;t make any sense&quot; - there&#39;s no notion of composing binary functions in mathematics. If you want to make it make sense, you need to first define what &quot;composing&quot; addition and subtraction means."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1452586275, "post_id": 34737915, "comment_id": 57222720, "body": "Your type for foo says that the composition of addition and subtraction is a function that takes two <i>functions</i> (<code>Integer -&gt; Integer</code>) and returns an integer."}], "answers": [{"comments": [{"owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "edited": false, "score": 0, "creation_date": 1452585669, "post_id": 34738028, "comment_id": 57222444, "body": "A slightly different definition, <code>foo f g x y = f (g x y) y</code> can be shortened to <code>foo = liftM2 (.)</code>."}], "tags": [], "owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "is_accepted": true, "score": 7, "last_activity_date": 1452590316, "last_edit_date": 1452590316, "creation_date": 1452584609, "answer_id": 34738028, "question_id": 34737915, "link": "https://stackoverflow.com/questions/34737915/haskell-composition-with-two-parameters/34738028#34738028", "title": "Haskell composition with two parameters", "body": "<p>Given a function</p>\n\n<pre><code>add :: Integer -&gt; Integer -&gt; Integer\n</code></pre>\n\n<p>it's useful to remember (as you pointed out yourself in the <em>What I understood</em> section) that <code>-&gt;</code> in type signatures associates to the right, i.e. the above type is the same as</p>\n\n<pre><code>add :: Integer -&gt; (Integer -&gt; Integer)\n</code></pre>\n\n<p>Now, consider the type of <code>(.)</code>:</p>\n\n<pre><code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n</code></pre>\n\n<p>This means that in an expression</p>\n\n<pre><code>(.) add\n</code></pre>\n\n<p>The <code>b</code> in the type of <code>(.)</code> is <code>Integer</code> and the <code>c</code> corresponds to <code>Integer -&gt; Integer</code>. Another way to write this is</p>\n\n<pre><code>b ~ Integer\nc ~ Integer -&gt; Integer\n</code></pre>\n\n<p>So we get</p>\n\n<pre><code>(.) add :: (a -&gt; Integer) -&gt; a -&gt; (Integer -&gt; Integer)\n</code></pre>\n\n<p>If you now apply <code>(.) add</code> to <code>sub</code>, the compiler notices that <code>a -&gt; Integer</code> cannot be made to match <code>Integer -&gt; Integer -&gt; Integer</code>.</p>\n\n<p>I suspect that you probably want the composition to take <em>three</em> arguments: two to apply <code>sub</code> to, and the result of that is then - together with the third argument - passed to <code>add</code>. So a possible definition which composes the two functions would be</p>\n\n<pre><code>foo :: (Integer -&gt; Integer -&gt; Integer) -&gt; (Integer -&gt; Integer -&gt; Integer) -&gt; Integer -&gt; Integer -&gt; Integer\nfoo f g x y = f (g x y) y\n</code></pre>\n\n<p>For what it's worth, there's a related problem: composing a two argument function with a one argument function, e.g. composing</p>\n"}, {"comments": [{"owner": {"reputation": 1404, "user_id": 1831096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gw70o.jpg?s=128&g=1", "display_name": "Isti115", "link": "https://stackoverflow.com/users/1831096/isti115"}, "edited": false, "score": 0, "creation_date": 1600283811, "post_id": 34742402, "comment_id": 113042404, "body": "Thank you very much for explaining <code>(add .) . sub</code> at the end of the answer! That was what I was searching for when I found this answer, not that I think that it would be a good idea to use in real code, just as a brain twister I was trying to figure out if it was even possible at all to make a ternary function out of a binary one without specifying parameters or using lambdas, but turns out it is and I really appreciate the beauty of it, even if I (currently at least) cannot really see a situation in which it would prove to be useful."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 7, "last_activity_date": 1452597893, "creation_date": 1452597893, "answer_id": 34742402, "question_id": 34737915, "link": "https://stackoverflow.com/questions/34737915/haskell-composition-with-two-parameters/34742402#34742402", "title": "Haskell composition with two parameters", "body": "<blockquote>\n  <p>I want to be able to compose them. It doesn't make any sense okay, but it's for a learning aim.</p>\n</blockquote>\n\n<p>That's actually the problem here. How do you want to compose them? Let us have a look at some possible compositions:</p>\n\n<pre><code>foo x y = sub x (add x y)          -- x + y - x = y\nfoo x y = sub y (add x y)          -- x + y - y = x\nfoo x y = sub x (add y y)          -- 2 * y - x \nfoo x y = sub y (add y y)          -- 2 * y - y = y\nfoo x y = sub y (sub y (add x x))  -- 2 * x - 2 * y\n</code></pre>\n\n<p>That being said, let us inspect the type error by checking the types from hand:</p>\n\n<pre><code>type I = Integer -- otherwise the lines are going to be very long\n\n(.)         :: (b -&gt;    c   ) -&gt; (a -&gt;   b   ) -&gt; a -&gt; c\nadd         ::  I -&gt; (I -&gt; I)\nsub         ::                   I -&gt; (I -&gt; I)\n--                               |||||||||||||\n(.) add     ::                   (a  -&gt; I    ) -&gt; a -&gt; (I -&gt; I)\n--                               ^^^^^^^^^^^^^\n</code></pre>\n\n<p>As you can see, <code>(.) add</code> already mandates that the other function may only have type <code>a -&gt; Integer</code> for an arbitrary <code>a</code>. But <code>sub</code>'s type is <code>Integer -&gt; (Integer -&gt; Integer)</code> (remember, <code>(-&gt;)</code> is right associative).</p>\n\n<p>Now, what can you do to actually fix this? First, let us inspect your proposed type of <code>foo</code>:</p>\n\n<pre><code>foo :: (Integer -&gt; Integer) -&gt; (Integer -&gt; Integer) -&gt; Integer\n</code></pre>\n\n<p>That's actually a <em>very</em> interesting type of function. How would you actually get your result? You're just have two functions at hand, but no values:</p>\n\n<pre><code>&gt; foo f g = \n</code></pre>\n\n<p>You can solve this by using a fixed point of one of the functions and then apply the other:</p>\n\n<pre><code>&gt;   let x = f x in g x\n&gt;\n&gt; example = foo (const 12) (+1) -- returns 13\n</code></pre>\n\n<p>But that's not what you meant, right? At this point, it's very important to think about the semantics of  your composition. Since those are not clear, you cannot write a general way to compose both functions here. </p>\n\n<p>However, if you <em>actually</em> meant</p>\n\n<pre><code>foo :: Integer -&gt; Integer -&gt; Integer -&gt; Integer\nfoo x y z = add (sub x y) z\n</code></pre>\n\n<p>then that's possible with</p>\n\n<pre><code>foo = (add .) . sub\n</code></pre>\n\n<p>since</p>\n\n<pre><code>(.) add        :: (a -&gt; I) -&gt; a -&gt; (I -&gt; I)\n(.) ((.) add)  :: (a -&gt; b -&gt; Integer) -&gt; a -&gt; b -&gt; Integer -&gt; Integer\n</code></pre>\n\n<p>But <code>(add .) . sub</code> isn't really easy to the eye anymore. You're better off writing a point-wise definition of <code>foo</code> if this kind of function was your original goal.</p>\n"}], "owner": {"reputation": 713, "user_id": 5423180, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/048f5f9eeb3ecb03c122408efb864b9a?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas thomas", "link": "https://stackoverflow.com/users/5423180/thomas-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2079, "favorite_count": 1, "accepted_answer_id": 34738028, "answer_count": 2, "score": 8, "last_activity_date": 1452597893, "creation_date": 1452584153, "last_edit_date": 1452589188, "question_id": 34737915, "link": "https://stackoverflow.com/questions/34737915/haskell-composition-with-two-parameters", "title": "Haskell composition with two parameters", "body": "<p>I'm trying to understand functional programming through Haskell and I'm having so much trouble dealing with function composition.</p>\n\n<p>Actually I have these two functions :</p>\n\n<pre><code>add:: Integer -&gt; Integer -&gt; Integer\nadd x y =  x + y\n\nsub:: Integer -&gt; Integer -&gt; Integer\nsub x y =  x - y\n</code></pre>\n\n<p>I want to be able to compose them. It doesn't make any sense okay, but it's for a learning aim.</p>\n\n<p><strong>What I've tried :</strong></p>\n\n<pre><code>foo:: (Integer -&gt; Integer) -&gt; (Integer -&gt; Integer) -&gt; Integer\nfoo = add . sub\n</code></pre>\n\n<p><strong>What I've understood :</strong></p>\n\n<p>Haskell uses functions with only one args, so that we return a new function to execute after each function execution.</p>\n\n<p>So the first <code>Integer</code> is the param type, while the second is the return type of a generated function that has to add the second number.</p>\n\n<p>This will return another function (<code>sub</code>) that will makes the same flow (returning a function with params etc...)</p>\n\n<p>Am I right ?</p>\n\n<p><strong>Here's my actual error code :</strong></p>\n\n<pre><code>src\\Main.hs:23:7:\n    Couldn't match type `Integer' with `Integer -&gt; Integer'\n    Expected type: Integer -&gt; (Integer -&gt; Integer) -&gt; Integer\n      Actual type: Integer -&gt; Integer -&gt; Integer\n    In the first argument of `(.)', namely `add'\n    In the expression: add . sub\n\nsrc\\Main.hs:23:13:\n    Couldn't match type `Integer -&gt; Integer' with `Integer'\n    Expected type: (Integer -&gt; Integer) -&gt; Integer\n      Actual type: Integer -&gt; Integer -&gt; Integer\n    Probable cause: `sub' is applied to too few arguments\n    In the second argument of `(.)', namely `sub'\n    In the expression: add . sub\n</code></pre>\n\n<p>I don't know what I'm doing wrong.</p>\n\n<p>Can you help me understanding a bit more this error so I can find a solution ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 7, "creation_date": 1452574191, "post_id": 34735229, "comment_id": 57217788, "body": "Any reason you&#39;re using <code>data</code> instead of <code>newtype</code>?"}, {"owner": {"reputation": 13920, "user_id": 371228, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a4028c5dd749d198d7a8f2601d4afe07?s=128&d=identicon&r=PG", "display_name": "bdesham", "link": "https://stackoverflow.com/users/371228/bdesham"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1452785203, "post_id": 34735229, "comment_id": 57330023, "body": "@Carl Nope, just ignorance :-)"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452599539, "post_id": 34738864, "comment_id": 57231258, "body": "<code>lens</code> now offers (for 7.10+ only; don&#39;t know why not 7.8--could&#39;ve been my mistake) <code>coerced :: forall s t a b. (Coercible s a, Coercible t b) =&gt; Iso s t a b</code>."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1452818862, "post_id": 34738864, "comment_id": 57348175, "body": "<code>lens</code> also offers the <code>Control.Lens.Wrapped</code> module for various forms of performing an operation under a newtype."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 5, "last_activity_date": 1452588187, "last_edit_date": 1452588187, "creation_date": 1452587701, "answer_id": 34738864, "question_id": 34735229, "link": "https://stackoverflow.com/questions/34735229/how-can-i-deal-with-typedef-style-data-types-with-a-minimum-of-boilerplate/34738864#34738864", "title": "How can I deal with \u201ctypedef\u201d-style data types with a minimum of boilerplate?", "body": "<p>Before anything else, you should make sure to use <code>newtype</code> for single-field single-constructor types. <code>data</code> introduces runtime overhead and extra laziness, and prevents us from using the first two of the following techniques.</p>\n\n<p>First, you can use <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/deriving.html#newtype-deriving\" rel=\"noreferrer\"><code>GeneralizedNewtypeDeriving</code></a> when possible:</p>\n\n<pre><code>{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n\nnewtype Foo a = Foo a deriving (Eq, Show, Ord, Num)\n\nfoo :: Foo Int\nfoo = 0\n\nbar :: Foo Int\nbar = foo * 120\n</code></pre>\n\n<p>Second, you can use <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Coerce.html\" rel=\"noreferrer\"><code>coerce</code></a> to generally convert between newtype wrappings:</p>\n\n<pre><code>import Data.Coerce\n\nnewtype Foo a = Foo a\nnewtype Bar a = Bar a\n\na :: [(Foo (Bar Int), Foo ())]\na = [(Foo (Bar 0), Foo ())]\n\nb :: [(Int, ())]\nb = coerce a\n</code></pre>\n\n<p>Third, you can use <a href=\"https://hackage.haskell.org/package/lens-4.13/docs/Control-Lens-Iso.html\" rel=\"noreferrer\"><code>iso</code></a>-s from <a href=\"https://hackage.haskell.org/package/lens-4.13\" rel=\"noreferrer\"><code>lens</code></a> to concisely move operations over/under newtype constructors. </p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n\nimport Data.Set (Set)\nimport qualified Data.Set as Set\nimport Control.Lens\n\nnewtype GraphEdge a = GraphEdge (Set a)\nmakePrisms ''GraphEdge\n\nmodifyItemsSomehow :: Ord a =&gt; GraphEdge a -&gt; GraphEdge a\nmodifyItemsSomehow = _GraphEdge %~ Set.map someFunction\n</code></pre>\n"}], "owner": {"reputation": 13920, "user_id": 371228, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a4028c5dd749d198d7a8f2601d4afe07?s=128&d=identicon&r=PG", "display_name": "bdesham", "link": "https://stackoverflow.com/users/371228/bdesham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 1, "accepted_answer_id": 34738864, "answer_count": 1, "score": 5, "last_activity_date": 1452588187, "creation_date": 1452570164, "question_id": 34735229, "link": "https://stackoverflow.com/questions/34735229/how-can-i-deal-with-typedef-style-data-types-with-a-minimum-of-boilerplate", "title": "How can I deal with \u201ctypedef\u201d-style data types with a minimum of boilerplate?", "body": "<p>I defined a custom data type that contains a single field:</p>\n\n<pre><code>import Data.Set (Set)\n\ndata GraphEdge a = GraphEdge (Set a)\n</code></pre>\n\n<p>Defining my own type feels more semantically correct but it leads to a lot of boilerplate in my functions. Any time I want to use the built-in <code>Set</code> functions I have to unwrap the inner set and later rewrap it:</p>\n\n<pre><code>import Data.Set (map)\n\nmodifyItemsSomehow :: Ord a =&gt; GraphEdge a -&gt; GraphEdge a\nmodifyItemsSomehow (GraphEdge items) = GraphEdge $ Set.map someFunction items\n</code></pre>\n\n<p>This could be improved slightly by making it a record, like</p>\n\n<pre><code>import Data.Set (Set, map)\n\ndata GraphEdge a = GraphEdge { unGraphEdge :: Set a }\n\nmodifyItemsSomehow = GraphEdge . map someFunction . unGraphEdge\n</code></pre>\n\n<p>but this still feels far from ideal. What is the most idiomatic way to handle this kind of boilerplate when dealing with a user-defined data type that consists of a single field?</p>\n"}, {"tags": ["haskell", "arithmetic-expressions"], "comments": [{"owner": {"reputation": 97, "user_id": 5184122, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1050059711694160/picture?type=large", "display_name": "ajanakos", "link": "https://stackoverflow.com/users/5184122/ajanakos"}, "edited": false, "score": 0, "creation_date": 1452565205, "post_id": 34734484, "comment_id": 57215422, "body": "lol sorry, huge brainfart"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 5184122, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1050059711694160/picture?type=large", "display_name": "ajanakos", "link": "https://stackoverflow.com/users/5184122/ajanakos"}, "edited": false, "score": 0, "creation_date": 1452583189, "post_id": 34734539, "comment_id": 57221207, "body": "great solution.. could you clarify what the full stop does ( . ) and what the slash does in the last line? ty"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 97, "user_id": 5184122, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1050059711694160/picture?type=large", "display_name": "ajanakos", "link": "https://stackoverflow.com/users/5184122/ajanakos"}, "edited": false, "score": 0, "creation_date": 1452583754, "post_id": 34734539, "comment_id": 57221495, "body": "In Haskell, <code>(.)</code> is the function composition operator, and <code>\\x -&gt; y</code> is a lambda expression."}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": false, "score": 7, "last_activity_date": 1452565078, "creation_date": 1452565078, "answer_id": 34734539, "question_id": 34734484, "link": "https://stackoverflow.com/questions/34734484/haskell-division/34734539#34734539", "title": "Haskell + division", "body": "<p>The math is completely wrong.</p>\n\n<pre><code>averageYear [(_, _, 2010)] = (2010 + averageYear []) `div` 2\n                           = (2010 + 0) `div` 2\n                           = 2010 `div` 2\n                           = 1005\n</code></pre>\n\n<p>To compute the average, you have to divide the sum by the number of items.</p>\n\n<pre><code>average :: [Int] -&gt; Int\naverage xs = sum xs `div` length xs\n\naverageYear :: [(String, String, Int)] -&gt; Int\naverageYear = average . map (\\(_, _, year) -&gt; year)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126, "user_id": 5766031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-APTQZlmDZaQ/AAAAAAAAAAI/AAAAAAAAAG4/u-iOSDRTsOo/photo.jpg?sz=128", "display_name": "Zacharie 007", "link": "https://stackoverflow.com/users/5766031/zacharie-007"}, "is_accepted": false, "score": 0, "last_activity_date": 1452730065, "creation_date": 1452730065, "answer_id": 34779452, "question_id": 34734484, "link": "https://stackoverflow.com/questions/34734484/haskell-division/34779452#34779452", "title": "Haskell + division", "body": "<p>@Dietrich Epp \n Length xs is zero and not two in your example.  </p>\n\n<pre><code>   averageYear ((x,y,z):xs) = (z + (averageYear xs)) `div` (length xs)\n</code></pre>\n\n<p>If xs is empty then length xs equal zero and you divide by zero.</p>\n"}], "owner": {"reputation": 97, "user_id": 5184122, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1050059711694160/picture?type=large", "display_name": "ajanakos", "link": "https://stackoverflow.com/users/5184122/ajanakos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 1, "answer_count": 2, "score": -3, "last_activity_date": 1452730065, "creation_date": 1452564700, "last_edit_date": 1452565346, "question_id": 34734484, "link": "https://stackoverflow.com/questions/34734484/haskell-division", "title": "Haskell + division", "body": "<p>Im able to sum the zth element of all of the tuples but for some weird reason I only get 1 after dividing my result by 2.</p>\n\n<pre><code>averageYear :: [(String, String, Int)] -&gt; Int\naverageYear [] = 0\naverageYear ((x,y,z):xs) = (z + (averageYear xs)) `div` (length xs)\n</code></pre>\n\n<p>Thanks!!</p>\n"}, {"tags": ["haskell", "matrix"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1452557163, "post_id": 34733374, "comment_id": 57213140, "body": "What if you remove the <code>FlexibleInstances</code> and <code>FlexibleContexts</code>. I do not get your reported compiler output. It works fine for me."}, {"owner": {"reputation": 1261, "user_id": 1478732, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3200120fc1ec5bbd9f128589a6287078?s=128&d=identicon&r=PG", "display_name": "fdsa", "link": "https://stackoverflow.com/users/1478732/fdsa"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1452557377, "post_id": 34733374, "comment_id": 57213208, "body": "@WillemVanOnsem If I remove <code>FlexibleInstances</code>, I can&#39;t compile as I get an <code>IllegalInstanceDeclaration</code> on the instance <code>Num a</code> line. I am using version <code>7.10.2</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1452557475, "post_id": 34733374, "comment_id": 57213235, "body": "sorry, you indeed need these. Nevertheless I am unable to reproduce the error. It works just fine."}, {"owner": {"reputation": 1261, "user_id": 1478732, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3200120fc1ec5bbd9f128589a6287078?s=128&d=identicon&r=PG", "display_name": "fdsa", "link": "https://stackoverflow.com/users/1478732/fdsa"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1452557838, "post_id": 34733374, "comment_id": 57213346, "body": "@WillemVanOnsem Can you reproduce the error if you try to run the code e.g. <code>(Matrix 1 2 3 4) *(Matrix 1 1 1 1)</code> ?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1452558062, "post_id": 34733374, "comment_id": 57213416, "body": "Why would you parameterise <code>Matrix</code> on <i>four possibly different</i> types? That completely contradicts the concept of a matrix (a <i>homogeneous</i> 2D-array, representing linear mappings between vector spaces <i>over a single field</i>)."}, {"owner": {"reputation": 1261, "user_id": 1478732, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3200120fc1ec5bbd9f128589a6287078?s=128&d=identicon&r=PG", "display_name": "fdsa", "link": "https://stackoverflow.com/users/1478732/fdsa"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1452558323, "post_id": 34733374, "comment_id": 57213502, "body": "@leftaroundabout I am still learning Haskell. I thought that by specifying <code>Matrix a a a a</code> in the instance declaration I was saying that all of the parameters should be the same number. Is that incorrect?"}, {"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 2, "creation_date": 1452573048, "post_id": 34733374, "comment_id": 57217399, "body": "@fdsa but why have the four different types in the first place?  Why not write <code>data Matrix a = Matrix a a a a</code>?"}, {"owner": {"reputation": 1261, "user_id": 1478732, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3200120fc1ec5bbd9f128589a6287078?s=128&d=identicon&r=PG", "display_name": "fdsa", "link": "https://stackoverflow.com/users/1478732/fdsa"}, "reply_to_user": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 0, "creation_date": 1452621481, "post_id": 34733374, "comment_id": 57247094, "body": "@LouisWasserman Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 1261, "user_id": 1478732, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3200120fc1ec5bbd9f128589a6287078?s=128&d=identicon&r=PG", "display_name": "fdsa", "link": "https://stackoverflow.com/users/1478732/fdsa"}, "edited": false, "score": 0, "creation_date": 1452557441, "post_id": 34733434, "comment_id": 57213225, "body": "I should have been more clear in my question. The code will compile but it errors when I actually try to perform a multiplication"}, {"owner": {"reputation": 3883, "user_id": 1529734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c7d967945459535ac46463f40783caf2?s=128&d=identicon&r=PG", "display_name": "stites", "link": "https://stackoverflow.com/users/1529734/stites"}, "edited": false, "score": 1, "creation_date": 1452563073, "post_id": 34733434, "comment_id": 57214838, "body": "A point from the peanut gallery: wouldn&#39;t it be possible to simplify the typings in your example of (Matrix (1 :: Int) ...? You should be able to get away with just one explicit type and ghci will infer the rest. Doesn&#39;t change the answer, but perhaps it&#39;s worth noting."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 3883, "user_id": 1529734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c7d967945459535ac46463f40783caf2?s=128&d=identicon&r=PG", "display_name": "stites", "link": "https://stackoverflow.com/users/1529734/stites"}, "edited": false, "score": 1, "creation_date": 1452586467, "post_id": 34733434, "comment_id": 57222826, "body": "@stites: No. This won&#39;t work: note that you only specified an instance for <code>Matrix a a a a</code>. This means that the <code>instance</code> for <code>Matrix Int Float Int Float</code> is still open for additional specification. You can however limit yourself to specifying the left <code>Matrix</code>: <code>(Matrix (1 :: Int) (2 :: Int) (3 :: Int) (4 :: Int)) * (Matrix 7 5 3 1)</code> works, because Haskell knows that a <code>(*)</code> is always define on the same types left and right."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 3883, "user_id": 1529734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c7d967945459535ac46463f40783caf2?s=128&d=identicon&r=PG", "display_name": "stites", "link": "https://stackoverflow.com/users/1529734/stites"}, "edited": false, "score": 0, "creation_date": 1452587051, "post_id": 34733434, "comment_id": 57223099, "body": "@stites: I found your comment quite valuable, I&#39;ve added a note in the answer that should explain the situation."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1452601053, "post_id": 34733434, "comment_id": 57232283, "body": "You will get the most out of type inference if you write the instance as <code>instance (Num a, a ~ b, b ~ c, c ~ d) =&gt; Num (Matrix a b c d) where ...</code> - in this case these expressions should compile without additional type annotations."}, {"owner": {"reputation": 3883, "user_id": 1529734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c7d967945459535ac46463f40783caf2?s=128&d=identicon&r=PG", "display_name": "stites", "link": "https://stackoverflow.com/users/1529734/stites"}, "edited": false, "score": 1, "creation_date": 1452609561, "post_id": 34733434, "comment_id": 57238618, "body": "@WillemVanOnsem \u2014 great explanation! Thanks for this!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1452610052, "last_edit_date": 1495541040, "creation_date": 1452557323, "answer_id": 34733434, "question_id": 34733374, "link": "https://stackoverflow.com/questions/34733374/haskell-matrix-appears-to-not-be-calling-num-instance/34733434#34733434", "title": "Haskell Matrix appears to not be calling Num instance", "body": "<p>The definition for your matrix multiplication is fine (although semantically it is not correct). Your code compiles well. The problem is however that if you perform a query:</p>\n\n<pre><code>*Main&gt; (Matrix 1 2 3 4) * (Matrix 7 5 3 1)\n</code></pre>\n\n<p>Haskell is confused which type it should attach to <code>1</code>, <code>2</code>, etc. It could be <code>Int</code>, <code>Integer</code>, <code>Float</code>, <code>Double</code>, etc. and all these have different implementations (if it picks <code>Float</code>, it will perform a <em>floating point multiplication</em>, which is different from an <em>integer multiplication</em>).</p>\n\n<p>The solution is that you give Haskell a hint which type you are using:</p>\n\n<pre><code>*Main&gt; (Matrix (1 :: Int) (2 :: Int) (3 :: Int) (4 :: Int)) * (Matrix (7 :: Int) (5 :: Int) (3 :: Int) (1 :: Int))\nMatrix 7 6 15 4\n</code></pre>\n\n<p>After all, <code>1</code> <strong>can be any kind of <code>Num</code> type</strong> (even a matrix), internally Haskell will call <code>fromInteger</code> to convert it to the correct <code>Num</code> type.</p>\n\n<p>That's also the reason why instantiating a <code>Matrix</code> from <code>Num</code> is not straightforward: you need to convert an integer to a matrix. Since your <code>Matrix</code> datatype only allows 2 x 2 matrices, there is no straightforward way of doing so.</p>\n\n<p>A final note is that your matrix multiplication is wrong. You should use:</p>\n\n<pre><code>instance Num a=&gt;Num (Matrix a a a a) where\n    (*) (Matrix a1 b1 c1 d1) (Matrix a2 b2 c2 d2) = Matrix (a1*a2+b1*c2) (a1*b2+b1*d2) (c1*a2+d1*c2) (b2*c1+d1*d2)\n</code></pre>\n\n<p>although I can understand this is only a simple test.</p>\n\n<h1>Additional notes</h1>\n\n<p><a href=\"https://stackoverflow.com/questions/34733374/haskell-matrix-appears-to-not-be-calling-num-instance/34733434?noredirect=1#comment57214838_34733434\">In the comments</a>, @stites asked an interesting question of whether it would be sufficient to instantiate only one of the Matrix types. Something like:</p>\n\n<pre><code>(Matrix (1 :: Int) 2 3 4) * (Matrix 7 5 3 1)\n</code></pre>\n\n<p>Haskell however errors on this, and that is reasonable. After all, a valid way of reasoning about this, is that you can still intend to use:</p>\n\n<pre><code>Matrix Int Float Float Int\n</code></pre>\n\n<p>Now you only defined an <code>instance</code> for <code>Matrix a a a a</code>, but it would be possible <em>to define an additional one</em>, like:</p>\n\n<pre><code>instance Num (Matrix Int Float Float Int) where\n    (*) ...\n</code></pre>\n\n<p>since a compiler should be <em>conservative</em>, it cannot <em>simply assume</em> the most popular <code>instance</code> is selected: perhaps you are under the impression that you have defined another instance somewhere.</p>\n\n<p>Additionally when you fully specify the type of the left matrix, it works:</p>\n\n<pre><code>*Main&gt; (Matrix (1 :: Int) (2 :: Int) (3 :: Int) (4 :: Int)) * (Matrix 7 5 3 1)\nMatrix 7 6 15 4\n</code></pre>\n\n<p>This is because now you have fully specified the left operand being of the type <code>Matrix Int Int Int Int</code>. Since <code>(*)</code> has the signature:</p>\n\n<pre><code>(*) :: Num e =&gt; e -&gt; e -&gt; e\n</code></pre>\n\n<p>(used <code>e</code> to reduce confusion), it knows that <code>e = Matrix Int Int Int Int</code> so it can \"collapse\" the right operand: it can thus derive the right operand is of type <code>Matrix Int Int Int Int</code> as well.</p>\n\n<p>You can even specify the types at arbitrary sides, for instance:</p>\n\n<pre><code>*Main&gt; (Matrix (1 :: Int) 2 (3 :: Int) 4) * (Matrix 7 (5 :: Int) 3 (1 :: Int))\nMatrix 7 6 15 4\n</code></pre>\n\n<p>works as well. Because first Haskell derives that <code>e = Matrix a b c d</code>. Now the first operand fills in <code>a = Int</code>, the second <code>b = Int</code>, etc.</p>\n\n<p>@user2407038 also provides a useful <a href=\"https://stackoverflow.com/questions/34733374/haskell-matrix-appears-to-not-be-calling-num-instance/34733434?noredirect=1#comment57232283_34733434\">comment</a>. You can also write your defintion as:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n\n-- ...\n\ninstance (Num a, a ~ b, b ~ c, c ~ d) =&gt; Num (Matrix a b c d) where\n    (*) (Matrix a1 b1 c1 d1) (Matrix a2 b2 c2 d2) = Matrix (a1*a2+b1*c2) (a1*b2+b1*d2) (c1*a2+d1*c2) (b2*c1+d1*d2)\n</code></pre>\n\n<p>Since the signature says <code>Matrix a b c d</code>, Haskell will try to match the multipication with this instance. And it can do so if <code>(Num a, a ~ b, b ~ c, c ~ d)</code>. Which is true.</p>\n"}], "owner": {"reputation": 1261, "user_id": 1478732, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3200120fc1ec5bbd9f128589a6287078?s=128&d=identicon&r=PG", "display_name": "fdsa", "link": "https://stackoverflow.com/users/1478732/fdsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 34733434, "answer_count": 1, "score": 1, "last_activity_date": 1599011140, "creation_date": 1452556947, "last_edit_date": 1599011140, "question_id": 34733374, "link": "https://stackoverflow.com/questions/34733374/haskell-matrix-appears-to-not-be-calling-num-instance", "title": "Haskell Matrix appears to not be calling Num instance", "body": "<p>I am trying to multiply 2x2 matrices as a learning exercise. I am trying to make my <code>Matrix</code> type an instance of <code>Num</code> so I can multiply with <code>*</code>. When I attempt to execute <code>(Matrix 1 2 3 4) *(Matrix 1 1 1 1)</code> in GHCI, I get an error that says use <code>FlexibleContexts to permit this</code> even though I am using Flexible contexts:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE FlexibleContexts #-}\nimport Debug.Trace\ndata Matrix a b c d= Matrix a b c d\n    deriving (Show)\n\ninstance Num a=&gt;Num (Matrix a a a a) where\n    (*) (Matrix a1 b1 c1 d1) (Matrix a2 b2 c2 d2) =  (trace \"* ran\")(Matrix (a1*a2 + b1*c2) (a1*b2 + b1*d2) (c1*a2 + d1*c2) (c1*b2+d2*d1))\n\nmultMat (Matrix a1 b1 c1 d1) (Matrix a2 b2 c2 d2) =  (trace \"Multmat ran\")(Matrix (a1*a2 + b1*c2) (a1*b2 + b1*d2) (c1*a2 + d1*c2) (c1*b2 + d1*d2))\n</code></pre>\n\n<p>I don't think my <code>*</code> method is being called as the <code>\"* ran\"</code> never prints out. On the other hand, if I run multMat (which is the same code, except for the function name) the debug statement prints and I get the expected answer. </p>\n\n<p><strong>*I think the problem is that when is use <code>*</code> on Matrix data types, some other method is being called. How can I make it call my method? *</strong> </p>\n\n<p>While this code compiles, it gives a runtime error on attempts to use <code>*</code> type <code>Matrix</code>.</p>\n"}, {"tags": ["haskell", "recursion", "factorial", "fixpoint-combinators"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 10, "creation_date": 1452553598, "post_id": 34732782, "comment_id": 57211938, "body": "Yes, this is possible. In fact it&#39;s a pretty standard thing. Care to show any research effort on your own part?"}, {"owner": {"reputation": 9, "user_id": 5776082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5d63cbe5bc55ad235b0a3e95303c811?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/5776082/jack"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1452553701, "post_id": 34732782, "comment_id": 57211977, "body": "@leftaroundabout I know how to calculate factorial in a different way, but it is kind of confusing to do it with function &#39;&#39;fix&#39;&#39;"}, {"owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "edited": false, "score": 2, "creation_date": 1452556236, "post_id": 34732782, "comment_id": 57212835, "body": "Have  you considered to use the following <a href=\"https://en.wikipedia.org/wiki/Fixed-point_combinator\" rel=\"nofollow noreferrer\">solution</a>?"}, {"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "reply_to_user": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "edited": false, "score": 0, "creation_date": 1452557045, "post_id": 34732782, "comment_id": 57213097, "body": "The article @RodrigoRibeiro mentions even has a specific example for factorial: <a href=\"https://en.wikipedia.org/wiki/Fixed-point_combinator#The_factorial_function\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/&hellip;</a>"}, {"owner": {"reputation": 9, "user_id": 5776082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5d63cbe5bc55ad235b0a3e95303c811?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/5776082/jack"}, "reply_to_user": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "edited": false, "score": 0, "creation_date": 1452558257, "post_id": 34732782, "comment_id": 57213478, "body": "@RodrigoRibeiro Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1452560651, "creation_date": 1452560651, "answer_id": 34733939, "question_id": 34732782, "link": "https://stackoverflow.com/questions/34732782/tricky-factorial-in-haskell/34733939#34733939", "title": "Tricky factorial in Haskell", "body": "<p>Yes. The trivial way:</p>\n\n<pre><code>factorial = fix go 1 where\n  go f acc n = fact acc n\n</code></pre>\n\n<p>Where <code>fact acc n === acc * n!</code>. This is, of course, an altogether ridiculous definition.</p>\n\n<p>Can you see how to modify the ridiculous definition so that it uses the <code>f</code> parameter? This will, hopefully, mimic the structure of the explicitly recursive definition you've already written.</p>\n"}, {"tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": false, "score": 4, "last_activity_date": 1452572507, "creation_date": 1452572507, "answer_id": 34735553, "question_id": 34732782, "link": "https://stackoverflow.com/questions/34732782/tricky-factorial-in-haskell/34735553#34735553", "title": "Tricky factorial in Haskell", "body": "<p>To be original</p>\n\n<pre><code>fac = (fix ((1:) . zipWith (*) [1..]) !!)\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5776082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5d63cbe5bc55ad235b0a3e95303c811?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/5776082/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "answer_count": 2, "score": -8, "last_activity_date": 1563168379, "creation_date": 1452553503, "last_edit_date": 1563168379, "question_id": 34732782, "link": "https://stackoverflow.com/questions/34732782/tricky-factorial-in-haskell", "title": "Tricky factorial in Haskell", "body": "<p>Is there is a way to create function to calculate factorial in Haskell, using the following function:</p>\n\n<pre><code>fix f = f (fix f)\n</code></pre>\n"}, {"tags": ["haskell", "haskell-lens"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1452553473, "post_id": 34732588, "comment_id": 57211882, "body": "Of course, the problem vanishes if you just stick to using <code>data</code> for <i>either</i> sum or variant types but not both at once, i.e. <code>data Exp = Lit Int | Var String | Lambda LambdaRec</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1020, "user_id": 500060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c122862374667042520953c02df7d7ed?s=128&d=identicon&r=PG", "display_name": "glguy", "link": "https://stackoverflow.com/users/500060/glguy"}, "is_accepted": true, "score": 1, "last_activity_date": 1454871021, "creation_date": 1454871021, "answer_id": 35257602, "question_id": 34732588, "link": "https://stackoverflow.com/questions/34732588/combo-lenses-and-prisms-for-sums-of-products/35257602#35257602", "title": "Combo lenses and prisms for sums of products?", "body": "<p>You can take a detour through another generated Iso to get this behavior. (makePrisms generates Isos when applied to a type with a single constructor)</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n\nmodule Demo where\n\nimport Control.Lens\n\ndata Exp = Lit Int | Var String | Lambda String Exp\ndata LambdaRec = LambdaRec { _bound::String, _body::Exp }\n\nmakePrisms ''Exp\nmakePrisms ''LambdaRec\nmakeLenses ''LambdaRec\n\n_ExpLambdaRec :: Prism' Exp LambdaRec\n_ExpLambdaRec = _Lambda . from _LambdaRec\n\n-- Example using _ExpLambdaRec\nexpBound :: Traversal' Exp String\nexpBound = _ExpLambdaRec . bound\n</code></pre>\n\n<p>Note that thanks to optimizations that GHC can do that this intermediate record type isn't necessarily used in the generated code.</p>\n\n<pre><code>getBound :: Exp -&gt; Maybe String\ngetBound = preview expBound\n\n-- Generated core for getBound\n--\n-- getBound1 =\n--   \\ eta_B1 -&gt;\n--     case eta_B1 of _ {\n--       __DEFAULT -&gt; (Nothing) `cast` ...;\n--       Lambda y1_a6XB y2_a6XC -&gt; (Just y1_a6XB) `cast` ...\n--     }\n</code></pre>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 2, "accepted_answer_id": 35257602, "answer_count": 1, "score": 2, "last_activity_date": 1454871021, "creation_date": 1452552652, "last_edit_date": 1452559129, "question_id": 34732588, "link": "https://stackoverflow.com/questions/34732588/combo-lenses-and-prisms-for-sums-of-products", "title": "Combo lenses and prisms for sums of products?", "body": "<p>If I have a record type, I can do pretty much anything I want to it with lenses. If I have a sum type, I can do pretty much whatever I want to it with prisms. But if I have a sum that includes a record, <code>makeFields</code> doesn't give me lenses into the fields (of course), but only traversals for them. <code>declarePrisms</code> seems a bit more promising. According to the documentation,</p>\n\n<pre><code>declarePrisms [d|\n  data Exp = Lit Int | Var String | Lambda{ bound::String, body::Exp }\n  |]\n</code></pre>\n\n<p>will create</p>\n\n<pre><code>data Exp = Lit Int | Var String | Lambda { bound::String, body::Exp }\n_Lit :: Prism' Exp Int\n_Var :: Prism' Exp String\n_Lambda :: Prism' Exp (String, Exp)\n</code></pre>\n\n<p>This gets me almost there, but what I really want is more like this:</p>\n\n<pre><code>data Exp = Lit Int | Var String | Lambda String Exp\ndata LambdaRec = { _bound::String, _body::Exp }\n...\n_Lambda :: Prism' Exp LambdaRec\n-- bound and body lenses into LambdaRec,\n-- and ideally also traversals to look at them in Exp.\nclass MightBeLambda t where\n  type BoundOptic t\n  type BodyOptic t\n  bound :: BoundOptic t\n  body :: BodyOptic t\ninstance MightBeLambda Exp where\n  type BoundOptic Exp = Traversal' Exp String\n  ...\ninstance MightBeLambda LambdaRec where\n  type BoundOptic LambdaRec = Lens' LambdaRec String\n</code></pre>\n\n<p>Is there any way to do something like this automatically, or would I have to do it by hand?</p>\n\n<hr>\n\n<p>An even crazier way one might wish to do it:</p>\n\n<pre><code>data ExpTag = LitT | VarT | LambdaT\n\ndata Exp' :: ExpTag -&gt; * where\n  Lit' :: Int -&gt; Exp' LitT\n  Var' :: String -&gt; Exp' VarT\n  Lambda' :: { _bound::String, _body::Exp } -&gt; Exp' LambdaT\n</code></pre>\n\n<p>Then the prisms can be defined evilly, using <code>unsafeCoerce</code> to avoid any risk of copying records.</p>\n"}, {"tags": ["haskell", "monads", "functor"], "comments": [{"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 5, "creation_date": 1452552747, "post_id": 34732571, "comment_id": 57211608, "body": "That&#39;s because a cofunctor is the same as a functor. There&#39;s no difference between the two. However, monads and comonads are different. There is such a thing as a contravariant functor though, with a <code>contramap</code> method which has the type <code>Contravariant f =&gt; (a -&gt; b) -&gt; f b -&gt; f a</code>. However, it&#39;s not the same as a cofunctor."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1452552880, "post_id": 34732571, "comment_id": 57211654, "body": "Do you mean &quot;cofunctor&quot; as the dual of a functor (which is just a functor, since it&#39;s self-dual), or to mean a functor which is contravariant?  <a href=\"http://math.stackexchange.com/questions/394472/is-cofunctor-an-accepted-term-for-contravariant-functors\" title=\"is cofunctor an accepted term for contravariant functors\">math.stackexchange.com/questions/394472/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 9, "creation_date": 1452557627, "post_id": 34732721, "comment_id": 57213276, "body": "Wouldn&#39;t the dual of a functor C -&gt; D a functor D -&gt; C? So the dual of <b>a</b> functor isn&#39;t the same functor itself, but the dual concept of &quot;functor in general&quot; is still &quot;functor in general&quot;. I think I&#39;m just playing semantics, but the language in &quot;a functor is it&#39;s self dual&quot; sounds like the claim that individual functor are somehow usable as their own inverse, or something."}, {"owner": {"reputation": 680, "user_id": 2048999, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/ydOtY.jpg?s=128&g=1", "display_name": "Zaaier", "link": "https://stackoverflow.com/users/2048999/zaaier"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1515099904, "post_id": 34732721, "comment_id": 83182530, "body": "@Ben That more or less shakes out to the formal definition: <a href=\"https://en.wikipedia.org/wiki/Equivalence_of_categories#Definition\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Equivalence_of_categories#Definition</a>"}], "tags": [], "owner": {"reputation": 866, "user_id": 2415602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pSmrA.jpg?s=128&g=1", "display_name": "J. A. Corbal", "link": "https://stackoverflow.com/users/2415602/j-a-corbal"}, "is_accepted": true, "score": 27, "last_activity_date": 1452604019, "last_edit_date": 1452604019, "creation_date": 1452553192, "answer_id": 34732721, "question_id": 34732571, "link": "https://stackoverflow.com/questions/34732571/why-there-is-no-cofunctor-typeclass-in-haskell/34732721#34732721", "title": "Why there is no `Cofunctor` typeclass in Haskell?", "body": "<p><code>Functor</code> is defined as:</p>\n\n<pre><code>class Functor f where\n    fmap :: (a -&gt; b) -&gt; (f a -&gt; f b)\n</code></pre>\n\n<p><code>Cofunctor</code> could be defined as follows:</p>\n\n<pre><code>class Cofunctor f where\n    cofmap :: (b -&gt; a) -&gt; (f b -&gt; f a)\n</code></pre>\n\n<p>So, both are technically the same, and that's why <code>Cofunctor</code> does not exist. \"The dual concept of 'functor in general' is still 'functor in general'\".</p>\n\n<p>Since <code>Functor</code> and <code>Cofunctor</code> are the same, both monads and comonads are defined by using <code>Functor</code>. But don't let that make you think that monads and comonads are the same thing, they're not.</p>\n\n<p>A monad is defined (simplifying) as:</p>\n\n<pre><code>class Functor m =&gt; Monad where\n    return :: a -&gt; m a\n    (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>whether a comonad (again, simplified) is:</p>\n\n<pre><code>class Functor w =&gt; Comonad where\n    extract :: w a -&gt; a\n    extend :: (w a -&gt; b) -&gt; w a -&gt; w b\n</code></pre>\n\n<p>Note the \"symmetry\".</p>\n\n<hr>\n\n<p>Another thing is a contravariant functor, defined as:</p>\n\n<pre><code>import Data.Functor.Contravariant\nclass Contravariant f where\n    contramap :: (b -&gt; a) -&gt; (f a -&gt; f b)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 141, "user_id": 3801960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d81b49a66ea7bf8026da832dfbec92b?s=128&d=identicon&r=PG&f=1", "display_name": "Stratege", "link": "https://stackoverflow.com/users/3801960/stratege"}, "edited": false, "score": 0, "creation_date": 1456831169, "post_id": 34733467, "comment_id": 59117767, "body": "we could define an unmap with: &quot;unmap f = extract . f . return&quot; and type signature &quot;unmap :: Monad f, Comonad f =&gt; (f a -&gt; f b) -&gt; a -&gt; b&quot;"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 4, "last_activity_date": 1452567734, "last_edit_date": 1452567734, "creation_date": 1452557510, "answer_id": 34733467, "question_id": 34732571, "link": "https://stackoverflow.com/questions/34732571/why-there-is-no-cofunctor-typeclass-in-haskell/34733467#34733467", "title": "Why there is no `Cofunctor` typeclass in Haskell?", "body": "<p>For reference,</p>\n\n<pre><code>class Functor w =&gt; Comonad w where\n  extract :: w a -&gt; a\n  duplicate :: w a -&gt; w (w a)\n  extend :: (w a -&gt; b) -&gt; w a -&gt; w b\n\ninstance Applicative m =&gt; Monad m where\n  return :: a -&gt; m a\n  (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b\n\njoin :: Monad m =&gt; m (m a) -&gt; m a\n</code></pre>\n\n<p>Note that given <code>extract</code> and <code>extend</code> you can produce <code>fmap</code> and <code>duplicate</code>, and that given <code>return</code> and <code>&gt;&gt;=</code> you can produce <code>fmap</code>, <code>pure</code>, <code>&lt;*&gt;</code>, and <code>join</code>. So we can focus on just <code>pure</code>+<code>&gt;&gt;=</code> and <code>extract</code>+<code>extend</code>.  </p>\n\n<p>I imagine you might be looking for something like</p>\n\n<pre><code>class InverseFunctor f where\n  unmap :: (f a -&gt; f b) -&gt; a -&gt; b\n</code></pre>\n\n<p>Since the <code>Monad</code> class makes it easy to \"put things in\" while only allowing a sort of hypothetical approach to \"taking things out\", and <code>Comonad</code> does something opposed to that, your request initially sounds sensible. However, there is a significant asymmetry between <code>&gt;&gt;=</code> and <code>extend</code> that will get in the way of any attempt to define <code>unmap</code>. Note in particular that the first argument of <code>&gt;&gt;=</code> has type <code>m a</code>. The second argument of <code>extend</code> has type <code>w a</code>&mdash;<em>not</em> <code>a</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 607, "user_id": 2436412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07531356cc096dc9551e1ac5983f651d?s=128&d=identicon&r=PG", "display_name": "Heimdell", "link": "https://stackoverflow.com/users/2436412/heimdell"}, "is_accepted": false, "score": 4, "last_activity_date": 1452576857, "creation_date": 1452576857, "answer_id": 34736246, "question_id": 34732571, "link": "https://stackoverflow.com/questions/34732571/why-there-is-no-cofunctor-typeclass-in-haskell/34736246#34736246", "title": "Why there is no `Cofunctor` typeclass in Haskell?", "body": "<p>Actually, you're wrong: there is one!</p>\n\n<p><a href=\"https://hackage.haskell.org/package/acme-cofunctor\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/acme-cofunctor</a></p>\n"}], "owner": {"reputation": 151, "user_id": 5460092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd22b324df81186fdc34deddc18167f?s=128&d=identicon&r=PG&f=1", "display_name": "user9090006", "link": "https://stackoverflow.com/users/5460092/user9090006"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1788, "favorite_count": 3, "accepted_answer_id": 34732721, "answer_count": 3, "score": 14, "last_activity_date": 1452606106, "creation_date": 1452552527, "last_edit_date": 1452606106, "question_id": 34732571, "link": "https://stackoverflow.com/questions/34732571/why-there-is-no-cofunctor-typeclass-in-haskell", "title": "Why there is no `Cofunctor` typeclass in Haskell?", "body": "<p>Monads get <code>fmap</code> from <code>Functor</code> typeclass. Why comonads don't need a <code>cofmap</code> method defined in a <code>Cofunctor</code> class?</p>\n"}, {"tags": ["string", "haskell", "io"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1452547150, "post_id": 34730326, "comment_id": 57208699, "body": "Values of type <code>String</code> <i>cannot</i> produce output. So your requirements (&quot;I must produce output&quot; and &quot;the return type must be <code>String</code>&quot;) are in conflict."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 5184122, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1050059711694160/picture?type=large", "display_name": "ajanakos", "link": "https://stackoverflow.com/users/5184122/ajanakos"}, "edited": false, "score": 0, "creation_date": 1452546771, "post_id": 34730429, "comment_id": 57208497, "body": "Only problem is I need to generate the String with only                          ghci&gt; bibliography_rec [(...),(...)] or is there something im still missing. Also what does the $ do??"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 97, "user_id": 5184122, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1050059711694160/picture?type=large", "display_name": "ajanakos", "link": "https://stackoverflow.com/users/5184122/ajanakos"}, "edited": false, "score": 0, "creation_date": 1452551706, "post_id": 34730429, "comment_id": 57211146, "body": "@ajanakos There&#39;s definitely something you&#39;re missing.  A <code>String</code> value is just a <code>String</code> value, in Haskell that means that it has no side effects and simply can&#39;t do things like print a value to the screen.  In GHCi when you evaluate a value, it performs an <code>IO</code> action behind the scenes so that you get to see a <i>representation</i> of that value displayed, since otherwise the &quot;interactive&quot; part of GHCi wouldn&#39;t really be useful.  Note that code entered into GHCi is not the same as executing a <code>.hs</code> file."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 97, "user_id": 5184122, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1050059711694160/picture?type=large", "display_name": "ajanakos", "link": "https://stackoverflow.com/users/5184122/ajanakos"}, "edited": false, "score": 0, "creation_date": 1452551865, "post_id": 34730429, "comment_id": 57211224, "body": "@ajanakos The <code>$</code> operator has many, many discussions, clarifications, etc all over stackoverflow and the rest of the internet, I won&#39;t go into detail here, but suffice to say that it&#39;s a do-nothing operator with a specific order of operations so that you can drop parentheses frequently.  The above line of code could have been equivalently written as <code>putStrLn (bibliography_rec [...])</code> and it would have been identical in execution.  This comes in handy with things like <code>f $ g $ h 1</code> instead of <code>f (g (h 1)))</code>, where the parens mostly just add noise."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 5, "last_activity_date": 1452543935, "creation_date": 1452543935, "answer_id": 34730429, "question_id": 34730326, "link": "https://stackoverflow.com/questions/34730326/haskell-output-string-as-type-string/34730429#34730429", "title": "Haskell + output String as type String", "body": "<p>Looks like you're already there, you just need to <code>putStrLn</code> the string instead of <code>print</code>ing it (which is what ghci does by default).  <code>print</code> runs its argument through <code>show</code> first, so it will quote the escape characters like <code>\"\\n\"</code>.</p>\n\n<pre><code>ghci&gt; putStrLn $ bibliography_rec [...]\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 5184122, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1050059711694160/picture?type=large", "display_name": "ajanakos", "link": "https://stackoverflow.com/users/5184122/ajanakos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1452544510, "creation_date": 1452543518, "last_edit_date": 1452544510, "question_id": 34730326, "link": "https://stackoverflow.com/questions/34730326/haskell-output-string-as-type-string", "title": "Haskell + output String as type String", "body": "<p>I've written a basic recursive function:</p>\n\n<pre><code>bibliography_rec :: [(String, String, Int)] -&gt; String\nbibliography_rec [] = \"\"\nbibliography_rec (x:xs) = (citeBook x) ++ \"\\n\" ++ (bibliography_rec xs)\n</code></pre>\n\n<p><code>citeBook</code> simply reformats the tuple into a String.</p>\n\n<p>When run with this input:</p>\n\n<pre><code>ghci&gt; bibliography_rec [(\"Herman Melville\", \"Moby Dick\", 1851),(\"Georgy Poo\", \"Alex Janakos\", 1666)]\n</code></pre>\n\n<p>It produces:</p>\n\n<pre><code>\"Moby Dick (Herman Melville, 1851)\\nAlex Janakos (Georgy Poo, 1666)\\n\"\n</code></pre>\n\n<p>I need line by line printing so I used this:</p>\n\n<pre><code>bibliography_rec (x:xs) = putStr ((citeBook x) ++ \"\\n\" ++ (bibliography_rec xs))\n</code></pre>\n\n<p>My problem is my output NEEDS to be of type <code>String</code> NOT <code>IO ()</code></p>\n\n<p>I've been stuck on this for way too long so any help is great!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 1, "creation_date": 1452537271, "post_id": 34727512, "comment_id": 57203282, "body": "I can highly recommend <a href=\"http://learnyouahaskell.com\" rel=\"nofollow noreferrer\">learnyouahaskell.com</a> (free online text or book)"}], "answers": [{"tags": [], "owner": {"reputation": 21248, "user_id": 223274, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2a6aad3c8269beb376b3e2b0bd29bec4?s=128&d=identicon&r=PG", "display_name": "Ian Henry", "link": "https://stackoverflow.com/users/223274/ian-henry"}, "is_accepted": false, "score": 1, "last_activity_date": 1452533728, "creation_date": 1452533728, "answer_id": 34727684, "question_id": 34727512, "link": "https://stackoverflow.com/questions/34727512/specifying-arguments/34727684#34727684", "title": "Specifying arguments", "body": "<pre><code>prop_max1((max 1 2) (max' 1 2))\n</code></pre>\n\n<p>Is the same as:</p>\n\n<pre><code>prop_max1 ((max 1 2) (max' 1 2))\n</code></pre>\n\n<p>Which you might write, in a language like Python or Java which uses <code>()</code> as function invocation, as:</p>\n\n<pre><code>prop_max1(max(1, 2)(max'(1, 2)))\n</code></pre>\n\n<p>When you put the parens like that, you're saying that you want to invoke the return value of <code>max 1 2</code> with the return value of <code>max' 1 2</code>. But <code>max 1 2</code> doesn't return a function, so that doesn't typecheck.</p>\n\n<p>Haskell uses the space character to mean function invocation, and parens are only used for grouping expressions. (Er, and for tuples.)</p>\n"}, {"tags": [], "owner": {"reputation": 10492, "user_id": 1351298, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/KJKqs.jpg?s=128&g=1", "display_name": "Electric Coffee", "link": "https://stackoverflow.com/users/1351298/electric-coffee"}, "is_accepted": true, "score": 8, "last_activity_date": 1452608020, "last_edit_date": 1452608020, "creation_date": 1452535329, "answer_id": 34728123, "question_id": 34727512, "link": "https://stackoverflow.com/questions/34727512/specifying-arguments/34728123#34728123", "title": "Specifying arguments", "body": "<p>If you're familiar with <strong><em>Python</em></strong>, <strong><em>Ruby</em></strong>, <strong><em>Java</em></strong> or <strong><em>C#</em></strong>, functions are generally invoked as this:</p>\n\n<pre><code>func(a, b)\n</code></pre>\n\n<p>While in <strong><em>Haskell</em></strong>, <strong><em>F#</em></strong>, and <strong><em>OCaml</em></strong> they're invoked like this:</p>\n\n<pre><code>func a b\n</code></pre>\n\n<p>This means one term followed by another in Haskell a-la <code>a b</code> is a function call a-la <code>a(b)</code> in Python.</p>\n\n<p>What this basically boils down to is this:</p>\n\n<pre><code>prop_max1 (max 1 2) (max' 1 2) -- is the same as prop_max1(max(1, 2), max'(1, 2))\n</code></pre>\n\n<p>While</p>\n\n<pre><code>prop_max1 ((max 1 2) (max' 1 2)) -- is the same as prop_max1(max(1, 2)(max'(1, 2))))\n</code></pre>\n\n<p>Notice how <code>prop_max1(max(1, 2), max'(1, 2))</code> and <code>prop_max1(max(1, 2)(max'(1, 2))))</code> differ in terms of <code>()</code> placement. </p>\n\n<hr>\n\n<p>Side note: A function call that looks like this: <code>f(a)(b)</code> is essentially the same as this:</p>\n\n<pre><code>g = f(a)\ng(b)\n</code></pre>\n\n<p>But written as a single statement, meaning <code>max(1, 2)(max'(1, 2))</code> is the same as</p>\n\n<pre><code>m1 = max(1, 2) \nm1(max'(1, 2))\n</code></pre>\n\n<p>Same holds for Haskell, where <code>(max 1 2) (max' 1 2)</code> is the same as:</p>\n\n<pre><code>m1 = max 1 2\nm1 (max' 1 2)\n</code></pre>\n\n<hr>\n\n<p>Anyway, it's probably easier to see if we remove the 1 and 2, making it <code>prop_max1(max, max')</code> vs <code>prop_max1(max(max'))</code>.</p>\n\n<p>In the first case <code>max</code> and <code>max'</code> are the first and second argument of <code>prop_max1</code> respectively, while in the second case <code>max'</code> is <code>max</code>'s returned function's argument.</p>\n\n<p>That's why <code>prop_max1 (max 1 2) (max' 1 2)</code> works, and <code>prop_max1 ((max 1 2) (max' 1 2))</code> doesn't.</p>\n"}], "owner": {"reputation": 439, "user_id": 2014730, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6b95cceb2d995c7425f6ca6dd9f11cbd?s=128&d=identicon&r=PG", "display_name": "tenkii", "link": "https://stackoverflow.com/users/2014730/tenkii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 34728123, "answer_count": 2, "score": 0, "last_activity_date": 1452608020, "creation_date": 1452533104, "last_edit_date": 1452564256, "question_id": 34727512, "link": "https://stackoverflow.com/questions/34727512/specifying-arguments", "title": "Specifying arguments", "body": "<p>I am new to Haskell and I am working some exercises in the craft of functional programming.</p>\n\n<p>Below is an example of how to specify finding the maximum of two numbers:</p>\n\n<pre><code>max :: Integer -&gt; Integer -&gt; Integer\nmax x y\n | x &gt;= y = x\n | otherwise = y\n\nmax' :: Integer -&gt; Integer -&gt; Integer\nmax' x y = \n if x &gt;= y then x else y\n\nprop_max1 :: Integer -&gt; Integer -&gt; Bool\nprop_max1 x y =\n x &lt;= max x y &amp;&amp; y &lt;= max' x y\n</code></pre>\n\n<p>I want to use the <code>prop_max1</code> function so I write:</p>\n\n<pre><code>prop_max1 (max 1 2) (max' 1 2)\n</code></pre>\n\n<p>which returns <code>True</code>.</p>\n\n<p>But if I write</p>\n\n<pre><code>prop_max1((max 1 2) (max' 1 2))\n</code></pre>\n\n<p>this doesn't work and I get an error along the lines of couldn't match expected type. Why can I not write it this way? </p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1452527070, "post_id": 34725315, "comment_id": 57196729, "body": "To be pure, it must be a function of the table, or of the whole DB."}, {"owner": {"reputation": 869, "user_id": 2029548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f44dcf3e58fcd22cd857cd563402178?s=128&d=identicon&r=PG", "display_name": "obadz", "link": "https://stackoverflow.com/users/2029548/obadz"}, "edited": false, "score": 1, "creation_date": 1452528040, "post_id": 34725315, "comment_id": 57197450, "body": "What&#39;s the actual question? Database access functions in Haskell live in some kind of monad context (IO or otherwise)"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 4, "creation_date": 1452528202, "post_id": 34725315, "comment_id": 57197571, "body": "Why would you like to make <code>getAll</code> a pure function - knowing that it isn&#39;t?"}], "answers": [{"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 3, "creation_date": 1452533554, "post_id": 34725799, "comment_id": 57201197, "body": "<code>unsafePerformIO</code> is a really bad idea, in all my years of haskell programming I have never had the need to use it!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452628434, "post_id": 34725799, "comment_id": 57251252, "body": "Now, now, it&#39;s necessary for some things. The <code>unamb</code> stuff needs it, for example (yes, that&#39;s &quot;unsafe&quot; to some degree, but there&#39;s no getting around it). And while others disagree vehemently, I think it&#39;s a perfectly legitimate way to use a Las Vegas (<i>not</i> Monte Carlo!) algorithm in a pure context."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1452634140, "post_id": 34725799, "comment_id": 57254341, "body": "I just wanted to say - in my 7 years of haskell (1/2 year professional) I did not have the need to use <code>unsafePerformIO</code> - I have seen it once in production code. But the need never occurred to me - so noone beginning haskell should not need it as well. I know that there are perfectly good reasons for having and using it. But usually if you are asking &quot;should I be using it&quot; this disqualifies you from using it."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452635800, "post_id": 34725799, "comment_id": 57255173, "body": "I completely agree. It&#39;s a special-purpose tool that should pretty much only be used, with great care, to build new language features or perform crazy optimizations in libraries."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 4, "last_activity_date": 1452533355, "last_edit_date": 1452533355, "creation_date": 1452527766, "answer_id": 34725799, "question_id": 34725315, "link": "https://stackoverflow.com/questions/34725315/pure-function-with-haskell-and-database-access/34725799#34725799", "title": "Pure function with haskell and database access", "body": "<p>Disclaimer: I don't know enough about lisp to give any information about the situation with respect to that language. I only know there is something out there like typed scheme - but again I don't know enough about the power of its type system.</p>\n\n<h2>How to tell if a function is pure (in a data access context or not)</h2>\n\n<p>In haskell you can see/encode information about the purity of a function in its type signature. I would guess the signature of <code>getAll</code> would be something like:</p>\n\n<pre><code>getAll :: DBConn -&gt; IO Tables\n</code></pre>\n\n<p>here the <code>IO</code> marks that the impurity of that function. In haskell this modelling of impurity can be done with <code>Monads</code> a general abstraction for situation that appear quite often.</p>\n\n<h2>How to make a function pure?</h2>\n\n<p>Now there are Monads you can easily get out of - for example <code>Maybe</code> you can use <code>fromMaybe defaultValue maybeValue</code> to get rid of the monad context.</p>\n\n<p><code>IO</code> is unlike that - there is no safe way to leave the monad context, notably there is <code>unsafePerformIO</code> that can undermine the type system to make the compiler believe \"in this situation it is ok to leave <code>IO</code>\", but unless you really know what you are doing - do not use this!!!</p>\n\n<p>But maybe this is the wrong question - better ask:</p>\n\n<h2>How can I tie pure functions with impure functions together?</h2>\n\n<p>Now there are several abstractions that help you tie pure functions in monadic or similar contexts, I recommend to look for <code>Functor</code>, <code>Applicative</code> and (of course) <code>Monad</code> to start with.</p>\n\n<p>For example if you have a function <code>users :: Table -&gt; [User]</code> you could use the <code>Functor</code> abstraction to tie them together</p>\n\n<pre><code>fmap users (getAll conn) (:: IO [User])\n</code></pre>\n\n<p>or equivalently</p>\n\n<pre><code>users &lt;$&gt; (getAll conn)\n</code></pre>\n\n<p>note the result of this computation is pure in the <code>users</code> part - and gets the indicator for impurity (nameley <code>IO ..</code>) \"inherited\" from the <code>getAll conn</code> part.</p>\n\n<p>You can imagine performing the users function inside the <code>IO</code> tag.</p>\n"}], "owner": {"reputation": 713, "user_id": 5423180, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/048f5f9eeb3ecb03c122408efb864b9a?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas thomas", "link": "https://stackoverflow.com/users/5423180/thomas-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 611, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1452535121, "creation_date": 1452526468, "last_edit_date": 1452535121, "question_id": 34725315, "link": "https://stackoverflow.com/questions/34725315/pure-function-with-haskell-and-database-access", "title": "Pure function with haskell and database access", "body": "<p>How can it be possible to tell that a function is pure :</p>\n\n<ul>\n<li>statelessness : given the same parameters, the result is stricly the same (1+2 = 3)</li>\n<li>immutability : the value doesn't change with time</li>\n</ul>\n\n<p>in a data access context ?</p>\n\n<p>Admiting that I have a getAll function that retrieves all the users of a table. This users can vary with time, with add, remove etc...</p>\n\n<p>How can it be possible to make getAll a pure function ?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 6, "creation_date": 1452513763, "post_id": 34721074, "comment_id": 57187728, "body": "I guess, a reference to <a href=\"https://wiki.haskell.org/Currying\" rel=\"nofollow noreferrer\">currying</a> and <a href=\"https://wiki.haskell.org/Partial_application\" rel=\"nofollow noreferrer\">partial application</a> for details wouldn&#39;t hurt."}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 4, "last_activity_date": 1452513637, "creation_date": 1452513637, "answer_id": 34721074, "question_id": 34720928, "link": "https://stackoverflow.com/questions/34720928/understanding-haskell-function-signature/34721074#34721074", "title": "Understanding Haskell function signature", "body": "<p>As a simple mental model - yes, the thing after the last arrow is a return type, and everything else are parameters.</p>\n\n<p>Signatures for 2-and-more-ary functions look this way because they are actually unary functions returning another 1-and-more-ary function.</p>\n\n<p>In your case</p>\n\n<pre><code>add :: Integer -&gt; (Integer -&gt; Integer)\n</code></pre>\n\n<p>Passing <code>add</code> an argument gives</p>\n\n<pre><code>add 3 :: (Integer -&gt; Integer)\n</code></pre>\n\n<p>And <code>add 3 4</code>, therefore is just <code>Integer</code> type.</p>\n"}, {"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 15, "last_activity_date": 1452513795, "creation_date": 1452513795, "answer_id": 34721121, "question_id": 34720928, "link": "https://stackoverflow.com/questions/34720928/understanding-haskell-function-signature/34721121#34721121", "title": "Understanding Haskell function signature", "body": "<p>Colloquially we may indeed refer to <code>add</code> as a function that takes two <code>Integer</code>s and produces an <code>Integer</code>. However to understand the notation, you need to understand that technically there's no such thing as a function that takes two arguments in Haskell.</p>\n\n<p>Rather every function takes exactly one argument and the type of a function is written <code>a -&gt; r</code> where <code>a</code> is the type of the argument and <code>r</code> is the type of the result. The function arrow is right-associative, which means that the type <code>a -&gt; (b -&gt; c)</code> can be written without parentheses as <code>a -&gt; b -&gt; c</code>.</p>\n\n<p>So <code>Integer -&gt; Integer -&gt; Integer</code> is the same as <code>Integer -&gt; (Integer -&gt; Integer)</code>, which tells us that <code>add</code> is a function that takes an <code>Integer</code> and produces another function of type <code>Integer -&gt; Integer</code>. This is known as currying and is the usual way to \"encode\" multi-argument functions in Haskell.</p>\n\n<p>To call such a curried function, we can write <code>add 1 2</code>, which, because function application is left associative, is the same as <code>(add 1) 2</code>, first calling <code>add 1</code> to get a function of type <code>Integer -&gt; Integer</code> and then applying that function to the argument <code>2</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1635, "user_id": 2254489, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b9c417017130602fd4561958e6840a2c?s=128&d=identicon&r=PG", "display_name": "Sventimir", "link": "https://stackoverflow.com/users/2254489/sventimir"}, "is_accepted": false, "score": 2, "last_activity_date": 1452514099, "creation_date": 1452514099, "answer_id": 34721222, "question_id": 34720928, "link": "https://stackoverflow.com/questions/34720928/understanding-haskell-function-signature/34721222#34721222", "title": "Understanding Haskell function signature", "body": "<p>The short answer is yes: it's exactly what it means. The last type is the return value, all others are arguments.</p>\n\n<p>This is so for a very simple reason, namely: there's no such thing as multi-agrument function in Haskell. All functions are single-argument in reallity, function's general type being <code>a -&gt; b</code>. Then we have something looking like multi-parameter functions thanks to <strong>currying</strong>. All you need to understand this are parentheses:</p>\n\n<pre><code>add :: Integer -&gt; (Integer -&gt; Integer)\n</code></pre>\n\n<p>Which reads: <code>add</code> is a function which takes an <code>Integer</code> and returns a function <code>Integer -&gt; Integer</code>. All parentheses sqeeze on the right-hand side here. On the contrary, when you apply, all parentheses squeeze on the left hand size, like so:</p>\n\n<pre><code>(add 5) 6\n</code></pre>\n\n<p>Which reads: apply  <code>add</code> to argument <code>5</code>. In return you'll get a function - then apply that function to <code>6</code> (the final result being <code>11</code>). We could equally well define it like so:</p>\n\n<pre><code>add :: Integer -&gt; (Integer -&gt; Integer)\nadd x = \\y -&gt; x + y\n</code></pre>\n\n<p>So the fact that you can specify multiple arguments for a function is only a syntactic sugar so that you don't have to return all these lambdas down the road.</p>\n\n<p>This very fact is also why we can do this:</p>\n\n<pre><code>add5 :: Integer -&gt; Integer\nadd5 = (+5)\n</code></pre>\n"}], "owner": {"reputation": 713, "user_id": 5423180, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/048f5f9eeb3ecb03c122408efb864b9a?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas thomas", "link": "https://stackoverflow.com/users/5423180/thomas-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 524, "favorite_count": 1, "accepted_answer_id": 34721121, "answer_count": 3, "score": 5, "last_activity_date": 1452564298, "creation_date": 1452513214, "last_edit_date": 1452564298, "question_id": 34720928, "link": "https://stackoverflow.com/questions/34720928/understanding-haskell-function-signature", "title": "Understanding Haskell function signature", "body": "<p>I m new in haskell's world and I m having some troubles with function signatures :</p>\n\n<p>What does it mean in simple worlds  :</p>\n\n<pre><code>add:: Integer -&gt; Integer -&gt; Integer\n</code></pre>\n\n<p>Does it mean that the two first parameters are <code>Integer</code> and the returned value is <code>Integer</code> too ?</p>\n\n<p>Can you explain me, the aim of using arrows to determine a type of parameter or at least give me a brief explanation about this function signature ?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 3, "last_activity_date": 1452506036, "creation_date": 1452506036, "answer_id": 34718460, "question_id": 34718154, "link": "https://stackoverflow.com/questions/34718154/why-does-foldr-return-immediately/34718460#34718460", "title": "Why does foldr return immediately?", "body": "<p>That source is the default <code>Foldable</code> implementation of <code>foldr</code>, it's not the actual implementation for lists. The actual <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/src/GHC.Base.html#foldr\" rel=\"nofollow\">implementation</a> is straightforward:</p>\n\n<pre><code>foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\nfoldr k z = go\n          where\n            go []     = z\n            go (y:ys) = y `k` go ys\n</code></pre>\n\n<p>The result of <code>foldr (\\_ _ -&gt; 1) 2 [1..]</code> can be understood by substitution:</p>\n\n<pre><code>foldr (\\_ _ -&gt; 1) 2 [1..] \ngo [1..]                  \ngo (1 : [2..])            -- evaluate [1..]\n(\\_ _ -&gt; 1) 1 (go [2..])  -- evaluate `go` at (:) case\n1                         -- evaluate expression\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": false, "score": 0, "last_activity_date": 1452610048, "last_edit_date": 1452610048, "creation_date": 1452508150, "answer_id": 34719200, "question_id": 34718154, "link": "https://stackoverflow.com/questions/34718154/why-does-foldr-return-immediately/34719200#34719200", "title": "Why does foldr return immediately?", "body": "<p>Specifically in GHC, foldl is actually implemented by foldr:</p>\n\n<pre><code>foldl :: forall a b. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b\n{-# INLINE foldl #-}\nfoldl k z0 xs =\n  foldr (\\(v::a) (fn::b-&gt;b) -&gt; oneShot (\\(z::b) -&gt; fn (k z v))) (id :: b -&gt; b) xs z0\n</code></pre>\n\n<p>So no matter your folding function evaluates the parameters or not, it will build a composed function from the list and pass the initial value to it, so will not terminate with infinite list.</p>\n"}], "owner": {"reputation": 2912, "user_id": 342366, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2d4ce7807783bf13634c9a90807f698a?s=128&d=identicon&r=PG", "display_name": "rhapsodyn", "link": "https://stackoverflow.com/users/342366/rhapsodyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "closed_date": 1452508826, "accepted_answer_id": 34718460, "answer_count": 2, "score": 4, "last_activity_date": 1452610048, "creation_date": 1452505085, "last_edit_date": 1452544779, "question_id": 34718154, "link": "https://stackoverflow.com/questions/34718154/why-does-foldr-return-immediately", "closed_reason": "Duplicate", "title": "Why does foldr return immediately?", "body": "<p>Newbie to Haskell.</p>\n\n<p>Trying to figure out why:</p>\n\n<pre><code>foldr (\\_ _ -&gt; 1) 2 [1..]\n</code></pre>\n\n<p>returns <code>1</code> immediately, however:</p>\n\n<pre><code>foldl (\\_ _ -&gt; 1) 2 [1..]\n</code></pre>\n\n<p>runs forever.</p>\n\n<p>Reading some <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/src/Data.Foldable.html#foldr\" rel=\"nofollow\">source code</a>, but stuck at some <code>#.</code>s .</p>\n\n<p>Help me out. (Run tests on Windows GHC 7.10.3)</p>\n"}, {"tags": ["haskell", "recursion", "pattern-matching", "primes", "non-exhaustive-patterns"], "comments": [{"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "edited": false, "score": 1, "creation_date": 1452594052, "post_id": 34718121, "comment_id": 57227595, "body": "Although the formulation looks like the sieve of Eratosthenes, the evaluation is actually different and very slow. You might be interested in <a href=\"https://www.cs.hmc.edu/~oneill/papers/Sieve-JFP.pdf\" rel=\"nofollow noreferrer\">this article</a>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1471019843, "post_id": 34718121, "comment_id": 65202224, "body": "change it to <code>sieve (p:xs) | p*p&lt;=m = p : sieve [x|x &lt;- xs, x `mod` p &gt; 0] | otherwise = (p:xs)</code> for a fix and a tremendous speedup."}], "answers": [{"tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": false, "score": 5, "last_activity_date": 1452506536, "creation_date": 1452506536, "answer_id": 34718648, "question_id": 34718121, "link": "https://stackoverflow.com/questions/34718121/haskell-non-exhaustive-patterns-with-sieve-of-eratosthenes/34718648#34718648", "title": "Haskell: Non-exhaustive patterns with Sieve of Eratosthenes", "body": "<p>Unlike the version on the website,  your function will eventually consume the whole list,  so you need a pattern matching for <code>[]</code></p>\n\n<pre><code>sieve [] = []\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 431, "user_id": 3360918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79cc9097de8b89e2e470ce4c85f46756?s=128&d=identicon&r=PG&f=1", "display_name": "Shumush", "link": "https://stackoverflow.com/users/3360918/shumush"}, "is_accepted": false, "score": 2, "last_activity_date": 1452606246, "last_edit_date": 1452606246, "creation_date": 1452605850, "answer_id": 34745192, "question_id": 34718121, "link": "https://stackoverflow.com/questions/34718121/haskell-non-exhaustive-patterns-with-sieve-of-eratosthenes/34745192#34745192", "title": "Haskell: Non-exhaustive patterns with Sieve of Eratosthenes", "body": "<p>As zakyggaps said, your version evaluates the function <code>sieve</code> with a finite list <code>[2..m]</code> which eventually will evaluate the empty list case.</p>\n\n<p>Another way to solve this problem is to use the function <code>takeWhile :: (a -&gt; Bool) -&gt; [a] -&gt; [a]</code> to evaluate <code>sieve [2..]</code> until you reach your limit m.</p>\n\n<pre><code>primes :: Integral a =&gt; a -&gt; [a]\nprimes m  = takeWhile (\\p -&gt; p &lt;= m) $ sieve [2..]\n  where\n    sieve (p:xs) = p : sieve [x|x &lt;- xs, x `mod` p &gt; 0]\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 4986360, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XXF3O0TECFo/AAAAAAAAAAI/AAAAAAAAABE/UfZfMFzBy4w/photo.jpg?sz=128", "display_name": "Rainflow", "link": "https://stackoverflow.com/users/4986360/rainflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "closed_date": 1474567537, "answer_count": 2, "score": 2, "last_activity_date": 1470872472, "creation_date": 1452504955, "last_edit_date": 1470872472, "question_id": 34718121, "link": "https://stackoverflow.com/questions/34718121/haskell-non-exhaustive-patterns-with-sieve-of-eratosthenes", "closed_reason": "Duplicate", "title": "Haskell: Non-exhaustive patterns with Sieve of Eratosthenes", "body": "<p>I wanted to use this code of Sieve of Eratosthenes from this page: <a href=\"http://en.literateprograms.org/Sieve_of_Eratosthenes_(Haskell)#chunk\" rel=\"nofollow\">http://en.literateprograms.org/Sieve_of_Eratosthenes_(Haskell)#chunk</a> def:primes_naive</p>\n\n<p>Only a bit modified, so it only shows the primes up to a number:</p>\n\n<pre><code>primes :: Integral a =&gt; a -&gt; [a]\nprimes m  = sieve [2..m]\n  where\n    sieve (p:xs) = p : sieve [x|x &lt;- xs, x `mod` p &gt; 0]\n</code></pre>\n\n<p>But in WinGHCi always the error comes (example 10):</p>\n\n<pre><code>primes 10\n[2,3,5,7*Main&gt; *** Exception: eratosthenes.hs:4:5-55: Non-exhaustive patterns in function sieve\n</code></pre>\n\n<p>I know this error from recursive functions, where for example cases are missing, but what is missing here?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 4, "creation_date": 1452494669, "post_id": 34715471, "comment_id": 57177107, "body": "What compiler error do you get? Include it in your question."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1452500456, "post_id": 34715471, "comment_id": 57179510, "body": "Suppose I define my own type <code>A</code>, with my own <code>RealFloat</code> and <code>Ord</code> instances. What should the <code>foo &lt; 2.0</code> comparison do? Should it call my own definition of <code>&lt;</code>, the <code>Double</code> one, or something else? It really is ambiguous, as the GHC error should point out."}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 3, "last_activity_date": 1452496866, "creation_date": 1452496866, "answer_id": 34716070, "question_id": 34715471, "link": "https://stackoverflow.com/questions/34715471/how-do-i-solve-these-type-mysteries/34716070#34716070", "title": "How do I solve these type mysteries?", "body": "<p>When the function signature does not fully dictate the types of internal values, such as <code>foo</code>, you <em>must</em> locally inform the compiler about the types of foo and 2.0.  This can be done explicitly via type signatures or implicitly via defaulting and type inference.</p>\n\n<p>Why?  Well there isn't any other mechanism to type <code>foo</code> in that expression.  You could provide the machinery yourself if you'd like:</p>\n\n<pre><code>import Data.Proxy\n\ng :: RealFloat a =&gt; Proxy a -&gt; Bool\ng ty = let foo = undefined `asProxyTypeOf` ty\n       in foo &lt; 2.0\n</code></pre>\n\n<p>Now the \"precision\" (as you called it, not exactly an accurate term) is something the callee controls by passing in the correct type:</p>\n\n<pre><code>main = print (g (Proxy :: Proxy Float))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "edited": false, "score": 0, "creation_date": 1452538217, "post_id": 34716607, "comment_id": 57203764, "body": "That Proxy thing looks too tedious. (1) Can you speak to that idea, versus the idea of doing <code>type FloatingPointType = Double</code> and using <code>FloatingPointType</code> everywhere in my code? One advantage is that I can replace <code>Double</code> with <code>CReal</code> in one line of code to increase accuracy. A major drawback is that if I send individual pure functions to other programmers, they&#39;ll be burdened with a <code>FloatingPointType</code> they are not familiar with. (2) Can you also speak about whether the new GHC 8.0 feature you mentioned can help us solve this in a better way? How would such GHC 8.0 code look?"}, {"owner": {"reputation": 34861, "user_id": 110081, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/cSvwm.jpg?s=128&g=1", "display_name": "Roman Cheplyaka", "link": "https://stackoverflow.com/users/110081/roman-cheplyaka"}, "reply_to_user": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "edited": false, "score": 0, "creation_date": 1452551223, "post_id": 34716607, "comment_id": 57210905, "body": "(1) the Proxy approach is more flexible in case you don&#39;t know in advance which type will be needed (say, you&#39;re writing a library that others will use, or the configuration happens at runtime). If you control the whole program, <code>type FloatingPointType = ...</code> should suffice. (2) Yes, I added an example to the answer."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452561802, "post_id": 34716607, "comment_id": 57214471, "body": "Using implicit arguments is pretty yucky. Another option is to use <code>ScopedTypeVariables</code> and manufacture a new proxy whenever you need one and don&#39;t happen to have one on hand."}, {"owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "edited": false, "score": 0, "creation_date": 1452633024, "post_id": 34716607, "comment_id": 57253787, "body": "@RomanCheplyaka Thanks, this was great! I&#39;m just going to wait for GHC 8 now. Final question: Do you know of any other programming language that makes this possible? I mean working with ordinary, familiar literals like 2 and 2.0 and functions like exp in such a general way where you can modify the floating-point precision of the whole program by changing just one line! Mind-blowing."}, {"owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "edited": false, "score": 0, "creation_date": 1452720098, "post_id": 34716607, "comment_id": 57299645, "body": "Hey, caught my last comment? Just checking."}, {"owner": {"reputation": 34861, "user_id": 110081, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/cSvwm.jpg?s=128&g=1", "display_name": "Roman Cheplyaka", "link": "https://stackoverflow.com/users/110081/roman-cheplyaka"}, "edited": false, "score": 0, "creation_date": 1452720974, "post_id": 34716607, "comment_id": 57300062, "body": "I haven&#39;t thought this through, but it sounds like <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/basedefs/tgmath.h.html\" rel=\"nofollow noreferrer\">type-generic macros</a> in C can do what you want (together with <code>#define FloatingPointType double</code>, as in your first comment). That page  mentions that Fortran has such functions, too."}], "tags": [], "owner": {"reputation": 34861, "user_id": 110081, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/cSvwm.jpg?s=128&g=1", "display_name": "Roman Cheplyaka", "link": "https://stackoverflow.com/users/110081/roman-cheplyaka"}, "is_accepted": true, "score": 5, "last_activity_date": 1452551184, "last_edit_date": 1452551184, "creation_date": 1452499256, "answer_id": 34716607, "question_id": 34715471, "link": "https://stackoverflow.com/questions/34715471/how-do-i-solve-these-type-mysteries/34716607#34716607", "title": "How do I solve these type mysteries?", "body": "<p>It will help understand what's going on if you think of polymorphic values (such as <code>f</code> or <code>foo</code>) as being <em>functions</em> that must be applied to the <em>type arguments</em> before any computation can be carried on.</p>\n\n<p>(Indeed, in GHC 8.0, you'll be able to have such type application in the language itself.)</p>\n\n<p>I'll answer your second question first: why is <code>foo &lt; 2.0</code> an error? Because <code>foo</code> is polymorphic and has to be instantiated at some type in order for the result to be computed. The semantics of <code>&lt;</code> depends on such instantiation, and depending on which type you choose, you may get different answers.</p>\n\n<p>So, this works:</p>\n\n<pre><code>default ()\n\nf :: RealFloat a =&gt; a\nf = undefined\n\ng :: Bool\ng = let\n        foo = f\n    in\n        foo &lt; (2.0 :: Double)\n</code></pre>\n\n<p>which should answer your first question, \"Why do I even need this?\" -- you don't.</p>\n\n<p>Now, it looks like you actually want your code polymorphic. For that, you need to let <code>g</code> know from the outside which type to use for computation. You ask:</p>\n\n<blockquote>\n  <p>Why can't it automatically deduce it from the type of f?</p>\n</blockquote>\n\n<p>Well, it is because <code>f</code> is also polymorphic, so <em>it doesn't know its type itself</em>! It is also a function from a type to a value of that type. In different parts of your program, it can be instantiated at different types and evaluated to different values.</p>\n\n<p>In order to tell <em>g</em> which type to use, you can add a proxy argument like this:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\nimport Data.Proxy\n\ndefault ()\n\nf :: RealFloat a =&gt; a\nf = undefined\n\ng :: forall a . RealFloat a =&gt; Proxy a -&gt; Bool\ng _ = let\n        foo = f\n    in\n        foo &lt; (2.0 :: a)\n</code></pre>\n\n<p>Passing around proxies can be inconvenient. Instead, you can use implicit\nparameters:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables, ImplicitParams #-}\n\nimport Data.Proxy\n\ndefault ()\n\nf :: RealFloat a =&gt; a\nf = undefined\n\ng :: forall a . (RealFloat a, ?t :: Proxy a) =&gt; Bool\ng = let\n        foo = f\n    in\n        foo &lt; (2.0 :: a)\n</code></pre>\n\n<p>This should get you what you're asking; you can say</p>\n\n<pre><code>let ?t = Proxy :: Proxy Double\n</code></pre>\n\n<p>in <code>main</code>, and the information will get propagated to <code>g</code> automatically.</p>\n\n<p>In GHC 8.0, you can replace <code>Proxy</code> by enabling <code>TypeApplications</code> like this:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables, TypeApplications #-}\n\nf :: RealFloat a =&gt; a\nf = 2.0 - 1e-12\n\ng :: forall a . RealFloat a =&gt; Bool\ng = let\n        foo = f @a\n    in\n        foo &lt; 2\n\nmain = do\n  print $ g @Float\n  print $ g @Double\n</code></pre>\n"}], "owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 34716607, "answer_count": 2, "score": 1, "last_activity_date": 1452551184, "creation_date": 1452494102, "question_id": 34715471, "link": "https://stackoverflow.com/questions/34715471/how-do-i-solve-these-type-mysteries", "title": "How do I solve these type mysteries?", "body": "<p>See these two questions:</p>\n\n<pre><code>--I don't want any defaulting. For example, I don't want\n--a general Num to convert to Double deep within my codebase.\n--I want to keep my codebase as general as possible.\n--Only in main, where I actually call my pure functions,\n--do I want to specify an actual, concrete type.\ndefault ()\n\nf :: RealFloat a =&gt; a\nf = undefined\n\ng :: Bool\ng = let\n        foo :: RealFloat a =&gt; a --First question: Why do I even need this?\n        foo = f\n    in\n        foo &lt; 2.0 --Second question: Why is this an error?\n</code></pre>\n\n<p>First, why do I need to explicitly tell Haskell about the type of <code>foo</code>? Why can't it automatically deduce it from the type of <code>f</code>?</p>\n\n<p>Second, why doesn't <code>foo &lt; 2</code> compile? Seems strange because <code>foo</code> is known to be <code>RealFloat</code> and <code>2</code> is <code>Num</code>, which is an ancestor of <code>RealFloat</code> so I thought <code>2</code> would be able to act as a <code>RealFloat</code> like it normally can.</p>\n\n<p>I could solve the error by doing <code>foo :: Double</code> instead of <code>foo :: RealFloat a =&gt; a</code>. But you have seen my thoughts on <code>default ()</code>. I don't want concrete <code>Double</code>s deep within my codebase. I want to keep using <code>RealFloat</code> everywhere so I can specify the accuracy I want in <code>main</code>. That could be <code>Float</code>, <code>Double</code>, or even <code>BigFloat</code> from the numbers package.</p>\n\n<p>In short, I don't want to specify the computational accuracy deep in my code. The accuracy should remain general and be specified in <code>main</code> where I ask Haskell to compute things.</p>\n\n<p>Are there ways out of this situation?</p>\n"}, {"tags": ["haskell", "matrix", "repa"], "answers": [{"comments": [{"owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "edited": false, "score": 0, "creation_date": 1452631563, "post_id": 34734475, "comment_id": 57252996, "body": "Thanks. Yeah this seems pretty basic. I don&#39;t know how others get by without such a basic thing. Maybe some people are using repa in batch mode and not interactively."}, {"owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "edited": false, "score": 0, "creation_date": 1452631628, "post_id": 34734475, "comment_id": 57253031, "body": "btw, do you mostly use hmatrix over repa these days? does the maturity of hmatrix still trump the advantages of repa?"}, {"owner": {"reputation": 1593, "user_id": 1829442, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f1b88b650cc161e532273962f4017f75?s=128&d=identicon&r=PG", "display_name": "idontgetoutmuch", "link": "https://stackoverflow.com/users/1829442/idontgetoutmuch"}, "reply_to_user": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "edited": false, "score": 0, "creation_date": 1452713568, "post_id": 34734475, "comment_id": 57296067, "body": "Depends on the application. If you want to solve something like a diffusion then repa is probably appropriate. If you want to do standard linear algebra then hmatrix is probably better. Also hmatrix has a nice static module. It would be nice to put something like this on top of repa also."}], "tags": [], "owner": {"reputation": 1593, "user_id": 1829442, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f1b88b650cc161e532273962f4017f75?s=128&d=identicon&r=PG", "display_name": "idontgetoutmuch", "link": "https://stackoverflow.com/users/1829442/idontgetoutmuch"}, "is_accepted": true, "score": 2, "last_activity_date": 1452564624, "creation_date": 1452564624, "answer_id": 34734475, "question_id": 34714306, "link": "https://stackoverflow.com/questions/34714306/haskell-repa-is-there-a-way-to-pretty-print-matrices/34734475#34734475", "title": "Haskell / repa - is there a way to pretty-print matrices?", "body": "<p>This works for me. Maybe it's worth adding to repa or a repa-extras package?</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n\nmodule PrettyPrint where\n\nimport Data.Array.Repa\nimport Data.Array.Repa.Algorithms.Matrix\n\nimport Text.PrettyPrint\nimport Text.PrettyPrint.HughesPJClass\n\ninstance (Source t a, Pretty a) =&gt; Pretty (Array t DIM1 a) where\n pPrint a = brackets $ hcat $ punctuate (comma &lt;&gt; space) elems\n    where\n     elems = [ pPrint (a!j) | i &lt;- [0..n-1], let j = Z :. i ]\n     Z :. n = extent a\n\ninstance (Source t a, Pretty a) =&gt; Pretty (Array t DIM2 a) where\n pPrint a = vcat elems\n   where\n     elems = [ pPrint (slice a j) | i &lt;- [0..n-1], let j = Any :. i :. All]\n     Z :. n :. _m = extent a\n</code></pre>\n"}], "owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 0, "accepted_answer_id": 34734475, "answer_count": 1, "score": 3, "last_activity_date": 1452564624, "creation_date": 1452487366, "question_id": 34714306, "link": "https://stackoverflow.com/questions/34714306/haskell-repa-is-there-a-way-to-pretty-print-matrices", "title": "Haskell / repa - is there a way to pretty-print matrices?", "body": "<p>Using repa in haskell, is there a way to print matrices so they're nicely formatted with matrix rows being on separate lines (the default for most numerical computing environments like R or matlab)?</p>\n\n<p>I could write one, but it seems like something that would already exist.</p>\n\n<p>This type of output is unwieldy to interact with:</p>\n\n<pre><code>\u03bb&gt; foo\nAUnboxed ((Z :. 3) :. 5) (fromList [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]) \n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 33082, "user_id": 726300, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWH6H.png?s=128&g=1", "display_name": "Luc Danton", "link": "https://stackoverflow.com/users/726300/luc-danton"}, "edited": false, "score": 4, "creation_date": 1452482436, "post_id": 34713662, "comment_id": 57173732, "body": "Whenever you ask something performance related like that, you <i>must</i> provide the compiler settings etc. that you have used in your measurements."}, {"owner": {"reputation": 945, "user_id": 4610065, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/BTON9.jpg?s=128&g=1", "display_name": "Michael T", "link": "https://stackoverflow.com/users/4610065/michael-t"}, "reply_to_user": {"reputation": 33082, "user_id": 726300, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWH6H.png?s=128&g=1", "display_name": "Luc Danton", "link": "https://stackoverflow.com/users/726300/luc-danton"}, "edited": false, "score": 0, "creation_date": 1452482677, "post_id": 34713662, "comment_id": 57173783, "body": "I used <code>time</code> to measure time taken (<code>time stack exec ......</code>). I used stack to build the project. The <code>simple</code> template does not have a <code>ghc-options</code> section in the <code>cabal</code> file. However, if I add <code>ghc-options:  -O2</code> to the <code>cabal</code> files, I get essentially the same results."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 2, "creation_date": 1452483203, "post_id": 34713662, "comment_id": 57173897, "body": "Haskell is tail recursive. No ST needed in this case."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 4, "creation_date": 1452483407, "post_id": 34713662, "comment_id": 57173930, "body": "also, when timing stuff, use <a href=\"https://hackage.haskell.org/package/criterion\" rel=\"nofollow noreferrer\">Criterion</a>. It&#39;s awesome."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1452528356, "post_id": 34713662, "comment_id": 57197682, "body": "You can expect code like the first version to be compiled (sometimes with a little coaxing) to compile to a tight loop where <code>x</code> and <code>y</code> remain in registers, whereas the <code>ST</code> should be expected to always do allocation: it&#39;s a pointer to a boxed value. And the <code>modify*Ref</code>- type functions are one of the few places where you can&#39;t expect the strictness analyzer to help you out and which should scream &quot;space leak&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 945, "user_id": 4610065, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/BTON9.jpg?s=128&g=1", "display_name": "Michael T", "link": "https://stackoverflow.com/users/4610065/michael-t"}, "edited": false, "score": 0, "creation_date": 1452495873, "post_id": 34713950, "comment_id": 57177590, "body": "Ah, lazy evaluation bites again. Serves me right for not looking at the documentation. (I was instead looking at a couple of tutorials which did not use the strict version of <code>modifySTRef&#39;</code>.) Thanks a lot!"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1452520641, "post_id": 34713950, "comment_id": 57192353, "body": "Note that <code>peanoAddRec</code> isn&#39;t strict in <code>y</code> either, and it should be. Best to change the second pattern to <code>... = peanoAddRec (x - 1) $! (y + 1)</code>."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1452541614, "post_id": 34713950, "comment_id": 57205722, "body": "Also, even if you keep them evaluated with <code>modifySTRef&#39;</code>, the contents of an STRef are always boxed, which means new <code>Int</code> objects need to get allocated on every iteration. If you want an unboxed STRef, you can try a one-element STUArray."}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": true, "score": 8, "last_activity_date": 1452484327, "creation_date": 1452484327, "answer_id": 34713950, "question_id": 34713662, "link": "https://stackoverflow.com/questions/34713662/using-the-st-monad/34713950#34713950", "title": "Using the ST monad", "body": "<p>One reason your ST program could be running slow is that you're using <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Data-STRef.html#v:modifySTRef\"><code>modifySTRef</code>, which is non-strict</a>:</p>\n\n<blockquote>\n  <p>Be warned that <code>modifySTRef</code> does not apply the function strictly. This\n  means if the program calls <code>modifySTRef</code> many times, but seldomly uses\n  the value, thunks will pile up in memory resulting in a space leak.\n  This is a common mistake made when using an STRef as a counter. For\n  example, the following will leak memory and likely produce a stack\n  overflow:</p>\n\n<pre><code>print $ runST $ do\n    ref &lt;- newSTRef 0\n    replicateM_ 1000000 $ modifySTRef ref (+1)\n    readSTRef ref\n</code></pre>\n</blockquote>\n\n<p>Your <code>x'</code> is forced once per loop, but <code>y'</code> isn't forced until the <code>print</code>, so there's a huge chain of thunks built up.</p>\n\n<p>Benchmarking it on my laptop against a version using <code>modifySTRef'</code> shows how strictness can improve runtime (though both still lose to the recursive version).</p>\n\n<pre><code>benchmarking rec\ntime                 7.896 ms   (7.602 ms .. 8.269 ms)\n                     0.992 R\u00b2   (0.988 R\u00b2 .. 0.997 R\u00b2)\nmean                 7.842 ms   (7.724 ms .. 8.001 ms)\nstd dev              404.5 \u03bcs   (303.9 \u03bcs .. 523.8 \u03bcs)\nvariance introduced by outliers: 25% (moderately inflated)\n\nbenchmarking st\ntime                 18.44 ms   (17.84 ms .. 19.01 ms)\n                     0.996 R\u00b2   (0.993 R\u00b2 .. 0.998 R\u00b2)\nmean                 18.03 ms   (17.79 ms .. 18.41 ms)\nstd dev              750.4 \u03bcs   (528.0 \u03bcs .. 1.110 ms)\nvariance introduced by outliers: 16% (moderately inflated)\n\nbenchmarking st'\ntime                 9.191 ms   (9.028 ms .. 9.437 ms)\n                     0.996 R\u00b2   (0.992 R\u00b2 .. 0.999 R\u00b2)\nmean                 9.317 ms   (9.175 ms .. 9.527 ms)\nstd dev              475.8 \u03bcs   (311.8 \u03bcs .. 677.9 \u03bcs)\nvariance introduced by outliers: 25% (moderately inflated)\n</code></pre>\n\n<p>The benchmarking code:</p>\n\n<pre><code>import Criterion.Main\nimport Control.Monad.ST\nimport Data.STRef\nimport Control.Monad.Loops\n\npeanoAddST :: Int -&gt; Int -&gt; Int\npeanoAddST x y = runST $ do\n    x' &lt;- newSTRef x\n    y' &lt;- newSTRef y\n    whileM_ (do x'' &lt;- readSTRef x'\n                return $ x'' /= 0)\n            (do modifySTRef x' (subtract 1)\n                modifySTRef y' (+1))\n    readSTRef y'\n\npeanoAddST' :: Int -&gt; Int -&gt; Int\npeanoAddST' x y = runST $ do\n    x' &lt;- newSTRef x\n    y' &lt;- newSTRef y\n    whileM_ (do x'' &lt;- readSTRef x'\n                return $ x'' /= 0)\n            (do modifySTRef' x' (subtract 1)\n                modifySTRef' y' (+1))\n    readSTRef y'\n\npeanoAddRec :: Int -&gt; Int -&gt; Int\npeanoAddRec 0 y = y\npeanoAddRec x y = peanoAddRec (x - 1) (y + 1)\n\nmain =\n  let n = 64000 in\n  defaultMain\n  [ bench \"rec\" $ whnf (peanoAddRec n) n\n  , bench \"st\" $ whnf (peanoAddST n) n\n  , bench \"st'\" $ whnf (peanoAddST' n) n\n  ]\n</code></pre>\n"}], "owner": {"reputation": 945, "user_id": 4610065, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/BTON9.jpg?s=128&g=1", "display_name": "Michael T", "link": "https://stackoverflow.com/users/4610065/michael-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 681, "favorite_count": 0, "accepted_answer_id": 34713950, "answer_count": 1, "score": 3, "last_activity_date": 1452484327, "creation_date": 1452482126, "question_id": 34713662, "link": "https://stackoverflow.com/questions/34713662/using-the-st-monad", "title": "Using the ST monad", "body": "<p>In the blog post, <a href=\"http://galvanist.com/post/83741037068/adding-badly-under-python-julia-go\" rel=\"nofollow\">http://galvanist.com/post/83741037068/adding-badly-under-python-julia-go</a>, the author uses a simple algorithm to compare the performance of various languages (including Haskell). In the Haskell example, the author uses a recursive function. As an exercise, I wanted to use the ST monad to allow local mutable state. This works but the recursive function is MUCH faster than my function which uses the ST monad.</p>\n\n<p>Recursive function-</p>\n\n<pre><code>peanoAdd :: Int -&gt; Int -&gt; Int\npeanoAdd 0 y = y\npeanoAdd x y = peanoAdd (x - 1) (y + 1)\n\nmain :: IO ()\nmain = do\n    let a = 64000000 :: Int\n    let b = 64000000 :: Int\n    let n = peanoAdd a b\n    print n\n\n128000000\n\nreal    0m0.583s\nuser    0m0.480s\nsys     0m0.096s\n</code></pre>\n\n<p>Using the ST monad-</p>\n\n<pre><code>import Control.Monad.ST\nimport Data.STRef\nimport Control.Monad.Loops\n\npeanoAdd :: Int -&gt; Int -&gt; Int\npeanoAdd x y = runST $ do\n    x' &lt;- newSTRef x\n    y' &lt;- newSTRef y\n    whileM_ (do x'' &lt;- readSTRef x'\n                return $ x'' /= 0)\n            (do modifySTRef x' (subtract 1)\n                modifySTRef y' (+1))\n    readSTRef y'\n\nmain :: IO ()\nmain = do\n    let a = 64000000 :: Int\n    let b = 64000000 :: Int\n    let n = peanoAdd a b\n    print n\n\n128000000\n\nreal    0m17.837s\nuser    0m16.412s\nsys     0m1.424s\n</code></pre>\n\n<p>Is there something I am doing obviously wrong which is hurting performance in the ST monad example? (PS. I am using Stack with the simple template for both projects.)</p>\n"}, {"tags": ["haskell", "types", "numbers"], "answers": [{"comments": [{"owner": {"reputation": 1178, "user_id": 1568590, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/b6bb720c28219294cf31d0693ed47388?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1568590/alasdair"}, "edited": false, "score": 0, "creation_date": 1452484075, "post_id": 34712386, "comment_id": 57174091, "body": "Many thanks for your detailed and informed answer.  You will appreciate that I am coming to Haskell from a procedural background!  However, maybe my confusion was simply caused by not putting the right parentheses in place."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 9, "last_activity_date": 1452473555, "last_edit_date": 1452473555, "creation_date": 1452471535, "answer_id": 34712386, "question_id": 34712332, "link": "https://stackoverflow.com/questions/34712332/haskell-reading-expressions-as-integers-from-ghci-prompt/34712386#34712386", "title": "Haskell: Reading expressions as Integers from ghci prompt?", "body": "<p>This has nothing to do with needing the expression \u201cevaluated to an <code>Integer</code> value\u201d. Haskell evaluates any expression when it's needed, and as whichever type the environment demands.</p>\n\n<p>Only, <code>factor 2^11-1</code> is <em>parsed</em> as <code>(factor 2)^11 - 1</code>, which is evidently not what you want. (There exists no subexpression <code>2^11-1</code> in there!) But <code>factor (2^11 - 1)</code> or &ndash; somewhat preferred style &ndash; <code>factor $ 2^11 - 1</code> will work just fine.</p>\n\n<p>As a matter of fact, <code>factor (toInteger 2^11-1)</code> also does not what you seem to think: this is parsed as <code>factor ((toInteger 2)^11 - 1)</code>. There's totally no need to write <code>toInteger 2</code>, instead of just <code>2</code><sup>&dagger;</sup>.</p>\n\n<p>Short overview of Haskell parsing rules:</p>\n\n<ul>\n<li>Prefix function application always has precedence. Hence <code>f x^y</code> is parsed as <code>(f x)^y</code>, not as <code>f (x^y)</code>.\n\n<ul>\n<li>This works greedily from left to right. Thus, <code>f x y</code> is parsed as <code>(f x) y</code><sup>&ddagger;</sup>, not <code>f (x y)</code>.</li>\n</ul></li>\n<li>Infix operators are parsed according to their <em>fixity</em>, which you can for instance look up in GHCi with <code>:i ^</code>. For instance, <code>infixr 8 ^</code> is higher than <code>infixl 6 -</code>, that's why <code>2^11-1</code> is parsed as <code>(2^11) - 1</code> and not as <code>2 ^ (11-1)</code>.\n\n<ul>\n<li>The <code>l</code> or <code>r</code> in the fixity indicates the direction if you chain multiple instances of the same operator. For instance, <code>infixr 5 :</code> means that <code>1:2:3:[]</code> is parsed as <code>1:(2:(3:[]))</code>, not as <code>((1:2):3):[]</code>.</li>\n</ul></li>\n</ul>\n\n<hr>\n\n<p><sup>&dagger;</sup><sub>Actually that's not always true. Literals like <code>2</code> are polymorphic, i.e. they can really be evaluated as whatever type you ask for. For instance, <code>2 * 3 + 4 * sin 5 :: Double</code> will carry out all the operations as floating-point multiplication / addition. Whereas <code>toInteger</code> is in fact restricted so the result must always be an integer (and if you try to use it in a setting that expects a <code>Double</code>, this will actually be a compile-time error!), i.e. it is actually equivalent to <code>(2 :: Integer)</code>.</sub></p>\n\n<p><sup>&ddagger;</sup><sub>Though that behaves, in many ways, more like what other languages would write as <code>f(x,y)</code>. Which would also be legal in Haskell, if slightly unidiomatic. (Then <code>f</code> would actually not be a function of two arguments, but a function of a single argument which happens to be a tuple.)</sub></p>\n"}], "owner": {"reputation": 1178, "user_id": 1568590, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/b6bb720c28219294cf31d0693ed47388?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1568590/alasdair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 34712386, "answer_count": 1, "score": 2, "last_activity_date": 1452473555, "creation_date": 1452471001, "question_id": 34712332, "link": "https://stackoverflow.com/questions/34712332/haskell-reading-expressions-as-integers-from-ghci-prompt", "title": "Haskell: Reading expressions as Integers from ghci prompt?", "body": "<p>I am experimenting with some number theoretic functions, and dealing with large integers.  However, I'd like to be able to read an expression in from the prompt.  I have a function defined by</p>\n\n<pre><code>factor :: Integer -&gt; Integer\n</code></pre>\n\n<p>and if I enter</p>\n\n<pre><code>ghci&gt; factor 2047\n</code></pre>\n\n<p>it works fine.  But I can't enter</p>\n\n<pre><code>ghci&gt; factor 2^11-1\n</code></pre>\n\n<p>because the expression <code>2^11-1</code> is not evaluated (at the prompt) to an <code>Integer</code>.  I can get round this with</p>\n\n<pre><code>ghci&gt; factor (toInteger 2^11-1)\n</code></pre>\n\n<p>but I'm wondering if there's a way to automatically have expressions read as <code>Integer</code> values?</p>\n"}, {"tags": ["haskell", "gulp", "hakyll"], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 1, "last_activity_date": 1452526546, "creation_date": 1452526546, "answer_id": 34725342, "question_id": 34712261, "link": "https://stackoverflow.com/questions/34712261/how-to-use-gulp-with-hakyll/34725342#34725342", "title": "How to use Gulp with Hakyll", "body": "<p>I think the key to finding your solution would be <a href=\"https://jaspervdj.be/hakyll/tutorials/using-clay-with-hakyll.html\" rel=\"nofollow\">using clay with hakyll</a> in the section of integrating clay we have</p>\n\n<pre><code>match \"css/*.hs\" $ do\n    route   $ setExtension \"css\"\n    compile $ getResourceString &gt;&gt;= withItemBody (unixFilter \"runghc\" [])\n\n-- cabal sandbox users can use (unixFilter \"cabal\" [\"exec\", \"runghc\"])\n-- given that you've added cabal to your PATH\n</code></pre>\n\n<p>I think you can replace the <code>\"runghc\" []</code> part with the according <code>\"gulp\" [\"buildcss\"]</code> and add another section <code>match \"js/*.js</code></p>\n\n<pre><code>match \"css/*.scss\" $ do\n        route   $ setExtension \"css\"\n        compile $ getResourceString &gt;&gt;= withItemBody (unixFilter \"gulp\" [\"buildcss\"])\n\nmatch \"js/*.js\" $ do\n            route   $ setExtension \"js\"\n            compile $ getResourceString &gt;&gt;= withItemBody (unixFilter \"gulp\" [\"buildjs\"])\n</code></pre>\n\n<p>Note: this code is untested for I don't use gulp in my setup.</p>\n"}], "owner": {"reputation": 4576, "user_id": 500270, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/7470e91e6ab818b5c631ec6e77f8f66e?s=128&d=identicon&r=PG", "display_name": "uglymunky", "link": "https://stackoverflow.com/users/500270/uglymunky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1452526546, "creation_date": 1452470385, "question_id": 34712261, "link": "https://stackoverflow.com/questions/34712261/how-to-use-gulp-with-hakyll", "title": "How to use Gulp with Hakyll", "body": "<p>I'm new to <a href=\"https://www.haskell.org/\" rel=\"nofollow\">Haskell</a> and thought I would start by making a blog with <a href=\"https://jaspervdj.be/hakyll/\" rel=\"nofollow\">Hakyll</a>.  I'm also using <a href=\"http://gulpjs.com/\" rel=\"nofollow\">gulp</a> for pre-processing my js and scss.</p>\n\n<p>How do I go about generating my js and css files when I build my Hakyll site?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1452469576, "post_id": 34712111, "comment_id": 57170779, "body": "Using <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-List.html#v:permutations\" rel=\"nofollow noreferrer\"><code>Data.List.permutations</code></a> and <code>zip</code> should get you there."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1452469652, "post_id": 34712111, "comment_id": 57170801, "body": "Oh, is there a reason you&#39;re only considering half of the permutations of [1,2,3]?  (e.g. [3,2,1] isn&#39;t present)"}, {"owner": {"reputation": 367, "user_id": 4716940, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/363a400a9b096b10c2ba8070f7b12f35?s=128&d=identicon&r=PG&f=1", "display_name": "demathieu", "link": "https://stackoverflow.com/users/4716940/demathieu"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1452472195, "post_id": 34712111, "comment_id": 57171407, "body": "The importance for me is that every letter is matched to every number, there order in the list is not important, e.g. [(a,1),(b,2),(c,3)] == [(c,3),(b,2),(a,1)]"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 3, "creation_date": 1452472398, "post_id": 34712111, "comment_id": 57171459, "body": "ah, yes but you seem to have missed the matching <code>[(a,3),(b,2),(c,1)]</code>, as well as two others, in your example."}], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 4, "last_activity_date": 1452484349, "creation_date": 1452484349, "answer_id": 34713953, "question_id": 34712111, "link": "https://stackoverflow.com/questions/34712111/alternative-permutation-of-two-lists/34713953#34713953", "title": "alternative permutation of two lists", "body": "<p>You only need to permute one of your two lists, then pair up each permutation with the other list in the original order: </p>\n\n<pre><code>import Data.List (permutations)\n\nbijections :: [a] -&gt; [b] -&gt; [[(a, b)]]\nbijections xs ys = map (zip xs) (permutations ys)\n</code></pre>\n\n<p>What this does is it generates all permutations of <code>ys</code> (so that would be <code>[1, 2, 3], [1, 3, 2], [2, 1, 3], [2, 3, 1], [3, 1, 2], [3, 2, 1]</code> for your example) and then for each of them, it pairs them up with <code>xs</code> in its original order. </p>\n"}], "owner": {"reputation": 367, "user_id": 4716940, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/363a400a9b096b10c2ba8070f7b12f35?s=128&d=identicon&r=PG&f=1", "display_name": "demathieu", "link": "https://stackoverflow.com/users/4716940/demathieu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "accepted_answer_id": 34713953, "answer_count": 1, "score": 0, "last_activity_date": 1452484349, "creation_date": 1452469075, "question_id": 34712111, "link": "https://stackoverflow.com/questions/34712111/alternative-permutation-of-two-lists", "title": "alternative permutation of two lists", "body": "<p>I'm trying to get a alternative permutation of two list with no fixed length for example:</p>\n\n<pre><code>x = [\"a\",\"b\",\"c\"]\ny = [1,2,3]\n</code></pre>\n\n<p>should return:</p>\n\n<pre><code>[(a,1),(b,2),(c,3)] , [(a,2),(b,3),(c,1)], [(a,3),(b,1),(c,2)]\n</code></pre>\n\n<p>with list comprehensions I was able to get this:</p>\n\n<pre><code>[(x,y) | x&lt;-x, y&lt;-y ]\n\n[(\"a\",1),(\"a\",2),(\"a\",3),(\"b\",1),(\"b\",2),(\"b\",3),(\"c\",1),(\"c\",2),(\"c\",3)]\n</code></pre>\n\n<p>which is not exactly what I want </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1452466531, "post_id": 34711695, "comment_id": 57169832, "body": "I&#39;d say it&#39;s not discouraged and not very common. If you need that, that&#39;s fine as far as I can see."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452546108, "post_id": 34711695, "comment_id": 57208146, "body": "<code>data Bar b = Eq b =&gt; Bar b</code> is not discouraged, per se, but it&#39;s much more commonly written using GADT syntax: <code>data Bar b where Bar :: Eq b =&gt; Bar b</code>. This particular one is actually more likely to be expressed using <code>Data.Constraint</code>: <code>type Bar b = Dict (Eq b)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452546345, "post_id": 34711876, "comment_id": 57208263, "body": "While datatype contexts are utterly useless, constraints on data constructors are not."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452546666, "post_id": 34711876, "comment_id": 57208451, "body": "@dfeuer: yeah, in the form of GADTs."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 5, "last_activity_date": 1452467902, "last_edit_date": 1452467902, "creation_date": 1452467464, "answer_id": 34711876, "question_id": 34711695, "link": "https://stackoverflow.com/questions/34711695/is-a-typeclass-constraint-discouraged-in-a-typeclass-method/34711876#34711876", "title": "Is a typeclass constraint discouraged in a typeclass method?", "body": "<p>A typeclass method is, from a usage perspective, no different from an ordinary polymorphic function which just happens to have that class as a constraint on one (<a href=\"https://wiki.haskell.org/Multi-parameter_type_class\" rel=\"noreferrer\">or more</a>) of in its participant type variables. But there may be other type variables in the signature which need other constraints not supplied by the one class head. Constraints are (usually) <em>necessary for you to be able to implement the function</em>, so, it's certainly reasonable to need constraints on class methods &ndash; unlike constraints on <code>data</code> types, which actually serve no purpose at all (the implementation of a <code>data</code> is just some data layout, it can't possibly need any methods from any classes<sup>&dagger;</sup>).</p>\n\n<p>However, you can avoid this issue by including the extra constrained type variables in the class head:</p>\n\n<pre><code>class (Eq b) =&gt; Foo b a where\n  foo :: a -&gt; b\n</code></pre>\n\n<p>Sometimes, this is better than your proposal, but sometimes it's certainly not better, for instance if <code>Foo</code> has a whole bunch of methods and of these only one is concerned with <code>b</code> at all. Of course in that case it would also be possible to split off only <code>foo</code> into a subclass that has <code>b</code> in its head, and leave the other methods in a class without extra constraints. But having two classes instead of one may also not be so nice.\n<br>Therefore, I would consider it perfectly legitimate to add constraints to class methods, if you find yourself in a situation where this is a natural thing to do.</p>\n\n<p>Existing examples of methods which have such constraints are <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Foldable.html#v:foldMap\" rel=\"noreferrer\"><code>foldMap</code></a>, <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Traversable.html#v:traverse\" rel=\"noreferrer\"><code>traverse</code></a> and <a href=\"http://hackage.haskell.org/package/transformers-0.5.0.0/docs/Control-Monad-Trans-Class.html#v:lift\" rel=\"noreferrer\"><code>lift</code></a>. It's not a ubiquitous pattern, but definitely not totally uncommon either.</p>\n\n<hr>\n\n<p><sup>&dagger;</sup><sub>This looks a bit different if you consider type/data families, but even then you don't need constraints on <code>data</code> but just the functions that deal with this data.</sub></p>\n"}], "owner": {"reputation": 117, "user_id": 5592551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d521a4021aea28572ece936720e60925?s=128&d=identicon&r=PG&f=1", "display_name": "hsk6", "link": "https://stackoverflow.com/users/5592551/hsk6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 34711876, "answer_count": 1, "score": 2, "last_activity_date": 1452468857, "creation_date": 1452466119, "last_edit_date": 1452468857, "question_id": 34711695, "link": "https://stackoverflow.com/questions/34711695/is-a-typeclass-constraint-discouraged-in-a-typeclass-method", "title": "Is a typeclass constraint discouraged in a typeclass method?", "body": "<p>I know that <strong>constraints in data</strong> are discouraged in Haskell. For instance,</p>\n\n<pre><code>data Eq b =&gt; Bar b = Bar b\n</code></pre>\n\n<p>is not possible without a deprecated extension. I also hear that even</p>\n\n<pre><code>data Bar b = Eq b =&gt; Bar b\n</code></pre>\n\n<p>is not common and even discouraged. (Is this right BTW?)</p>\n\n<hr>\n\n<p>Is the same true for <strong>constraints in typeclasses</strong>? For instance, is doing something like</p>\n\n<pre><code>class Foo a where\n    foo :: Eq b =&gt; a -&gt; b\n</code></pre>\n\n<p>discouraged in Haskell as well? Is it commonly seen in real code?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1452465040, "post_id": 34711339, "comment_id": 57169377, "body": "Can <code>doStuff</code> potentially return <code>Nothing</code>? If not then you can get away with an <code>fmap</code> instead."}, {"owner": {"reputation": 328, "user_id": 1213968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b53fb563063c6f31b403b5cb5d978ac6?s=128&d=identicon&r=PG", "display_name": "tmpz", "link": "https://stackoverflow.com/users/1213968/tmpz"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1452467097, "post_id": 34711339, "comment_id": 57169989, "body": "Potentially it can, for example in do stuff I use <code>uriAuthority :: Maybe URIAuth</code> to get the domain of the URL"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1452548064, "post_id": 34711339, "comment_id": 57209215, "body": "See also <a href=\"http://stackoverflow.com/q/33005903/791604\">How do I deal with many levels of indentation?</a>."}], "answers": [{"comments": [{"owner": {"reputation": 328, "user_id": 1213968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b53fb563063c6f31b403b5cb5d978ac6?s=128&d=identicon&r=PG", "display_name": "tmpz", "link": "https://stackoverflow.com/users/1213968/tmpz"}, "edited": false, "score": 0, "creation_date": 1452467318, "post_id": 34711657, "comment_id": 57170061, "body": "Thanks for the explanation but I&#39;m not sure I completely understand so here are are my comments:  wrt <code>Maybe (IO ())</code> you say:   <code>if you have a Maybe (IO ()) value on the top-level, then you&#39;re able to determine if an action can happen without actually having to do any IO first</code>.  ... and that&#39;s the case since I&#39;m already doing the IO to get the user input before. I just want to execute it if the input if correct, and that&#39;s how I read (probably wrongly) the type: Maybe do something.  The type IO (Maybe ()) reads counter intuitive to me as (to me) it implies already doing something."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 328, "user_id": 1213968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b53fb563063c6f31b403b5cb5d978ac6?s=128&d=identicon&r=PG", "display_name": "tmpz", "link": "https://stackoverflow.com/users/1213968/tmpz"}, "edited": false, "score": 0, "creation_date": 1452468203, "post_id": 34711657, "comment_id": 57170360, "body": "I would rather read <code>Maybe (IO ())</code> as <i>maybe <b>be able to</b> do something</i>. You&#39;re right that <code>IO (Maybe ())</code> implies that already something can be done before the decision \u2013 as you probably need! If you&#39;re seperating that IO beforehand which is needed to determine whether an action should be taken, then you don&#39;t need any combination of <code>Maybe</code> and <code>IO</code> at all: just retrieve the necessary value from <code>IO</code> and use it to decide with an ordinary conditional (e.g. <code>when</code>) whether to execute the other action."}, {"owner": {"reputation": 328, "user_id": 1213968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b53fb563063c6f31b403b5cb5d978ac6?s=128&d=identicon&r=PG", "display_name": "tmpz", "link": "https://stackoverflow.com/users/1213968/tmpz"}, "edited": false, "score": 0, "creation_date": 1452468383, "post_id": 34711657, "comment_id": 57170426, "body": "Also, you mention transformer stack. I&#39;m guessing the stack grown form left to right so by deeper in the stack of a transformer Monad you mean the rightmost type? E.g. in MaybeT IO ()  IO would be the deepest in the stack."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 328, "user_id": 1213968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b53fb563063c6f31b403b5cb5d978ac6?s=128&d=identicon&r=PG", "display_name": "tmpz", "link": "https://stackoverflow.com/users/1213968/tmpz"}, "edited": false, "score": 0, "creation_date": 1452468480, "post_id": 34711657, "comment_id": 57170453, "body": "Yes. In this case rightmost = innermost = lowermost (in the syntax tree)."}, {"owner": {"reputation": 328, "user_id": 1213968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b53fb563063c6f31b403b5cb5d978ac6?s=128&d=identicon&r=PG", "display_name": "tmpz", "link": "https://stackoverflow.com/users/1213968/tmpz"}, "edited": false, "score": 0, "creation_date": 1452468961, "post_id": 34711657, "comment_id": 57170602, "body": "Thanks for your answer, I think I have now a better understanding of a lot of things (lift and MabeyT just to mentions a few). You&#39;re a good teacher."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 3, "last_activity_date": 1452465790, "creation_date": 1452465790, "answer_id": 34711657, "question_id": 34711339, "link": "https://stackoverflow.com/questions/34711339/conditional-computation-maybe-io/34711657#34711657", "title": "Conditional computation Maybe (IO ())", "body": "<p>First off: the type of an <code>IO ()</code> action that may or may not happen can be simply <code>IO ()</code>: you don't care about a result, or whether it was succesful, you just want it executed <em>if possible</em>.</p>\n\n<p>If you do care about the success, then there are two options.</p>\n\n<ul>\n<li><code>Maybe (IO ())</code> is the type of an action or not an action, but whether is a transparent \u201cpure value\u201d. I.e., if you have a <code>Maybe (IO ())</code> value on the top-level, then you're able to determine if an action can happen <em>without actually having to do any <code>IO</code> first</em>. But this can not be the type of a value where you first have to do some IO to determine whether the critical action is going to happen, because in order to bind any IO you already have to be in the <code>Just</code> branch of the <code>Maybe</code>! So, if success depends on a user-supplied string then this can't be the right type for you.</li>\n<li><code>IO (Maybe ())</code> is the type of an <code>IO</code> action which may do anything it needs to determine what action to take. The type is actually equivalent to a <code>IO Bool</code> &ndash; an <code>IO</code> action returning some indicator flag. You may <em>specify</em> that <code>Just ()</code> means some critical action has happened and <code>Nothing</code> means it hasn't, but there's no way to actually see this from the signature.</li>\n</ul>\n\n<p><code>MaybeT IO ()</code> is equivalent to the latter to, and is in fact probably the best type for you application. Only, you need to do the transformer-lifting correctly! <code>lift</code> takes an action from <em>down</em> in the transformer stack, up to the top of that stack. Hence <code>lift</code>! You need it for instance to lift a normal <code>IO</code> action like <code>getLine :: IO String</code> into the <code>MaybeT IO</code> stack:</p>\n\n<pre><code>lift getLine :: MaybeT IO String\n</code></pre>\n\n<p>But if you have a pure <code>Maybe</code> value, you rather need to \u201cunderpin\u201d it to get a <code>MaybeT IO</code>. The easiest way to do that is to just use the <code>MaybeT</code> constructor directly.</p>\n\n<pre><code>getResource :: String -&gt; MaybeT IO ()\ngetResource url = MaybeT (return $ parseURI url) &gt;&gt;= doStuff\n\ndoStuff :: URI -&gt; MaybeT IO ()\ndoStuff = undefined\n</code></pre>\n"}], "owner": {"reputation": 328, "user_id": 1213968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b53fb563063c6f31b403b5cb5d978ac6?s=128&d=identicon&r=PG", "display_name": "tmpz", "link": "https://stackoverflow.com/users/1213968/tmpz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 34711657, "answer_count": 1, "score": 3, "last_activity_date": 1452465790, "creation_date": 1452463605, "question_id": 34711339, "link": "https://stackoverflow.com/questions/34711339/conditional-computation-maybe-io", "title": "Conditional computation Maybe (IO ())", "body": "<p>I am fairly new to Haskell and I would like to express the concept of and IO action that might or might not happen.</p>\n\n<p>Network.URI provides a function to parse a URI </p>\n\n<pre><code>parseURI :: String -&gt; Maybe URI\n</code></pre>\n\n<p>in my main function I get the input form the user</p>\n\n<pre><code>main :: IO ()\nmain = do\n  url &lt;- getLine\n  getResource url\n</code></pre>\n\n<p>and the use the parseURI function </p>\n\n<pre><code>getResource :: String -&gt; Maybe (IO ())\ngetResource url = parseURI url &gt;&gt;= doStuff\n\ndoStuff :: URI -&gt; Maybe (IO ())\ndoStuff = undefined\n</code></pre>\n\n<p>As you can see I want to use <code>&gt;&gt;=</code> to avoid the <code>case of</code> cascade I would get dealing with the Maybes.</p>\n\n<p>I have managed to do so by embedding IO into Maybe. I want to express the case of an IO action that may or may not happen. What should I use? I'm surely not the first one with this problem. I have looked into MaybeT and MonadIO but I am not sure that's what I need.</p>\n\n<p>Specifically, if I move doStuff to <code>MaybeT IO ()</code> I'm still stuck with <code>parseURI url :: Maybe String</code>. If I lift that to MaybeT now I have <code>MaybeT Maybe String</code> and that won't match my <code>doStuff :: MaybeT IO ()</code> </p>\n\n<p>I'd like this to look better (if possible) and to understand what is the right direction and what are the mainstream tools to use. </p>\n\n<p>Thank you for your time and advice.</p>\n"}, {"tags": ["arrays", "haskell", "dependent-type"], "answers": [{"comments": [{"owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "edited": false, "score": 0, "creation_date": 1452464437, "post_id": 34711279, "comment_id": 57169198, "body": "Sorry for noising... I have missed this library. Thanks for your attention."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 7, "last_activity_date": 1452463242, "creation_date": 1452463242, "answer_id": 34711279, "question_id": 34710997, "link": "https://stackoverflow.com/questions/34710997/size-indexed-mutable-arrays-in-haskell/34711279#34711279", "title": "Size indexed mutable arrays in Haskell", "body": "<p>Such a type <a href=\"http://hackage.haskell.org/package/fixed-vector-0.8.1.0/docs/Data-Vector-Fixed-Mutable.html\" rel=\"noreferrer\">does exist on Hackage</a>.</p>\n\n<p>I would avoid something like <code>type Array n a = IORef (Vec n a)</code>. Mutable arrays are all about efficiency. If you don't need it to run fast / with low memory footprint, then there's not much point in using them \u2013 even \u201cmutable algorithms\u201d are generally easier to express in Haskell using functional style, perhaps with a state monad but no true destructive mutable state.\n<br>But if efficiency matters, then you also want tight cache-efficient storage. <a href=\"http://hackage.haskell.org/package/vector-0.11.0.0/docs/Data-Vector-Unboxed-Mutable.html\" rel=\"noreferrer\">Unboxed vectors</a> are ideal. OTOH, <code>Vec</code> is on the runtime data level no different from ordinary lists, which are of course not so great in terms  of cache coherence. Even if you defined them to actually interweave mutability into the list spine, it wouldn't be really better in any way than using immutable <code>Vec</code>s in a pure-functional style.</p>\n\n<p>So, if I had to write something like that simple, I'd rather wrap an (unsafe, length-wise) unboxed mutable arrox in a length-indexed newtype.</p>\n\n<pre><code>import qualified Data.Vector.Unboxed.Mutable as VUM\n\nnewtype MVec (s :: *) (n :: Nat) (a :: *)\n        = MVec { getMVector :: VUM.MVector s a }\n</code></pre>\n\n<p>You can then define an interface that makes all public operations type-checked length-safe, while still retaining the performance profile of <code>MVector</code>.</p>\n"}], "owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 1, "accepted_answer_id": 34711279, "answer_count": 1, "score": 2, "last_activity_date": 1452463242, "creation_date": 1452461359, "question_id": 34710997, "link": "https://stackoverflow.com/questions/34710997/size-indexed-mutable-arrays-in-haskell", "title": "Size indexed mutable arrays in Haskell", "body": "<p>In Haskell is possible to write functions over a size indexed list that ensure that we never get out of bounds. A possible implementation is:</p>\n\n<pre><code>data Nat = Zero | Succ Nat deriving (Eq, Ord, Show)\n\ninfixr 5 :-\n\ndata Vec (n :: Nat) a where\n    Nil  :: Vec 'Zero a\n    (:-) :: a -&gt; Vec n a -&gt; Vec ('Succ n) a       \n\ndata Fin (n :: Nat) where\n    FZ :: Fin ('Succ n)\n    FS :: Fin n -&gt; Fin ('Succ n)                       \n\nvLookup :: Vec n a -&gt; Fin n -&gt; a\nvLookup Nil _ = undefined           \nvLookup (x :- _) FZ = x\nvLookup (_ :- xs) (FS i) = vLookup xs i                      \n</code></pre>\n\n<p>Of course, this is just fine for immutable size indexed lists (aka <code>Vec</code>). </p>\n\n<p>But how about mutable ones? Is possible to define (or is there a library for) mutable size indexed arrays in Haskell? If there's no such library, how it could be implemented? </p>\n\n<p><strong>Edit 1:</strong> I searched <a href=\"http://hackage.haskell.org\" rel=\"nofollow\">Hackage</a> and didn't found any library matching my description (size indexed mutable arrays).</p>\n\n<p><strong>Edit 2:</strong> I would like to mention that I have thought use <code>IORef</code>'s to get the desired mutability:</p>\n\n<pre><code> type Array n a = IORef (Vec n a)\n</code></pre>\n\n<p>but I'm wondering if there's a better (more efficient, more elegant) option...</p>\n"}, {"tags": ["haskell", "parsec"], "comments": [{"owner": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "edited": false, "score": 0, "creation_date": 1452458553, "post_id": 34710502, "comment_id": 57167206, "body": "isn&#39;t it just <code>start</code> plus the length of <code>result</code>?"}, {"owner": {"reputation": 8813, "user_id": 389119, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/05241abffd72dcdcd1dc9d6833706ba9?s=128&d=identicon&r=PG", "display_name": "antoyo", "link": "https://stackoverflow.com/users/389119/antoyo"}, "reply_to_user": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "edited": false, "score": 0, "creation_date": 1452458948, "post_id": 34710502, "comment_id": 57167341, "body": "Well, in this case, yes. But in more complex cases (multi-line string or function definitions) it will be harder to compute the end position."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 2901300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6604b879c876eb834b65ecbeb25cbf4?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Mears", "link": "https://stackoverflow.com/users/2901300/chris-mears"}, "is_accepted": false, "score": 1, "last_activity_date": 1452570063, "creation_date": 1452570063, "answer_id": 34735215, "question_id": 34710502, "link": "https://stackoverflow.com/questions/34710502/get-end-position-with-parsec/34735215#34735215", "title": "Get end position with Parsec", "body": "<p>If you mean <code>identifier</code> from <code>Text.Parsec.Token</code>, I don't think this will be easy.  <code>identifier</code> is defined using <code>lexeme</code>:</p>\n\n<pre><code>identifier =\n    lexeme $ try $\n    do{ name &lt;- ident\n      ; if (isReservedName name)\n         then unexpected (\"reserved word \" ++ show name)\n         else return name\n      }\n</code></pre>\n\n<p>and <code>lexeme</code> consumes the whitespace:</p>\n\n<pre><code>lexeme p\n    = do{ x &lt;- p; whiteSpace; return x  }\n</code></pre>\n\n<p>which means by the time you get the result from <code>identifier</code>, the end position of the identifier is lost.</p>\n\n<p>I don't think there is an elegant solution.  An ugly one is to copy the definition of <code>makeTokenParser</code> from <code>Text.Parsec.Token</code> and change its definition of <code>lexeme</code> so that it doesn't skip the whitespace.  Then you can have this:</p>\n\n<pre><code>myMakeTokenParser :: (Stream s m Char)\n                  =&gt; GenLanguageDef s u m -&gt; GenTokenParser s u m\nmyMakeTokenParser languageDef\n    = TokenParser{ identifier = identifier\n                 , reserved = reserved\n    ...\n  lexeme p = p\n    ...\n  }\n\nlexer = myMakeTokenParser haskellDef\nidentifier' = identifier lexer\ntest = do\n  start &lt;- getPosition\n  result &lt;- identifier'\n  end &lt;- getPosition\n  return (result, (start, end))\n\nmain = parseTest test \"abc   def   \"\n\n&gt; :main\n(\"abc\",((line 1, column 1),(line 1, column 4)))\n</code></pre>\n\n<p>Of course, now you need to be careful because the parsers won't skip whitespace any more.  An alternative would be to make <code>lexeme</code> record the position of the end of the inner parser (e.g. <code>identifier</code>) as part of the \"user state\", then skip the whitespace as usual.  You could then retrieve the end position from the user state.</p>\n"}], "owner": {"reputation": 8813, "user_id": 389119, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/05241abffd72dcdcd1dc9d6833706ba9?s=128&d=identicon&r=PG", "display_name": "antoyo", "link": "https://stackoverflow.com/users/389119/antoyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1452570063, "creation_date": 1452458302, "question_id": 34710502, "link": "https://stackoverflow.com/questions/34710502/get-end-position-with-parsec", "title": "Get end position with Parsec", "body": "<p>I would like to get the end token position while parsing with Parsec.</p>\n\n<p>For instance, if I use the <code>identifier</code> combinator in the following way:</p>\n\n<pre><code>test = do\n    start &lt;- getPosition\n    result &lt;- identifier\n    end &lt;- getPosition\n</code></pre>\n\n<p>The <code>end</code> will not point to the end of the identifier. It will point to the next token (skipping spaces).</p>\n\n<p>I could write my own <code>identifier</code> combinator to get the end position before skipping spaces, but I wonder if there is anything already doing this in Parsec.</p>\n\n<p>Is there a way to get the end position of a combinator with Parsec?</p>\n"}, {"tags": ["haskell", "reflection", "typeclass"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452546591, "post_id": 34710465, "comment_id": 57208404, "body": "Hmmm... I wonder if GHC could be tricked by using <code>SPECIALIZE</code> on a function ultimately passed to <code>reify</code>. I&#39;m going to try that when I get home."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 4, "last_activity_date": 1452508930, "last_edit_date": 1452508930, "creation_date": 1452457944, "answer_id": 34710465, "question_id": 34708700, "link": "https://stackoverflow.com/questions/34708700/does-reflection-risk-incoherence/34710465#34710465", "title": "Does reflection risk incoherence?", "body": "<p>I tentatively say it doesn't risk incoherence. After some tinkering, the best way I could come up with to hijack <code>reflect</code> used <code>INCOHERENT</code>, which is unsurprisingly sufficient to yield incoherence:</p>\n\n<pre><code>{-# LANGUAGE\n  TypeFamilies, FlexibleInstances, MultiParamTypeClasses,\n  ScopedTypeVariables #-}\n\nimport Data.Constraint\nimport Data.Proxy\nimport Data.Reflection\n\ninstance {-# INCOHERENT #-} Reifies (s :: *) Int where\n  reflect _ = 0\n\nreflectThis :: forall (s :: *). Dict (Reifies s Int)\nreflectThis = Dict\n\n-- prints 0\nmain = print $\n  reify (1 :: Int) $ \\(p :: Proxy s) -&gt;\n   case reflectThis :: Dict (Reifies s Int) of\n     Dict -&gt; reflect p\n</code></pre>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 1, "answer_count": 1, "score": 8, "last_activity_date": 1452508930, "creation_date": 1452447802, "question_id": 34708700, "link": "https://stackoverflow.com/questions/34708700/does-reflection-risk-incoherence", "title": "Does reflection risk incoherence?", "body": "<p>The <code>reflection</code> package offers a class</p>\n\n<pre><code>class Reifies s a | s -&gt; a where\n  reflect :: proxy s -&gt; a\n</code></pre>\n\n<p>and a function</p>\n\n<pre><code>reify :: a -&gt; (forall s . Reifies s a =&gt; Proxy s -&gt; r) -&gt; r\n</code></pre>\n\n<p>Given only these, one could mess things up rather badly by giving, for example, the instance</p>\n\n<pre><code>instance Reifies s Int where\n  reflect _ = 0\n</code></pre>\n\n<p>This would be bad because, for instance,</p>\n\n<pre><code>reify (1 :: Int) $ \\p -&gt; reflect p\n</code></pre>\n\n<p>could legitimately produce either 1 (via the usual reflection process) or 0 (by specializing the passed function before applying <code>reify</code>).</p>\n\n<p>In reality, this particular exploit seems to be blocked by the inclusion of a few <code>Reifies</code> instances in <code>Data.Reflection</code>. The evil instance I described will be rejected as overlapping. If overlapping instances are enabled, I believe the specialization may be blocked by the uncertainty overlapping brings.</p>\n\n<p>Still, I'm wondering if there's some way to expose this with a shady instance, perhaps with the help of GADTs or some such.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 14, "creation_date": 1452444050, "post_id": 34707983, "comment_id": 57161926, "body": "The prefix colon is for GHCi commands. They only work inside the interactive interpreter and are not, as such, a part of the Haskell language. For example, you cannot use them inside a .hs file."}, {"owner": {"reputation": 51, "user_id": 5770281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4afbddf8c56459e93789b4d8d2d06c9?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/5770281/bob"}, "reply_to_user": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1452444110, "post_id": 34707983, "comment_id": 57161953, "body": "@SimonShine So the colon was just picked as convention? Can functions/variables use : in their names?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1452444284, "post_id": 34707983, "comment_id": 57162032, "body": "@Bob The colon character must begin every infix constructor. IE: <code>data Foo a = a :~ Bar</code>. The infix fuction <code>(:)</code> is the list constructor."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1452444365, "post_id": 34707983, "comment_id": 57162066, "body": "and you cannot define any other operator starting with <code>:</code> - but it might contain them - so <code>let (:$) ...</code> will not work but  <code>let ($:) ...</code> is ok"}, {"owner": {"reputation": 51, "user_id": 5770281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4afbddf8c56459e93789b4d8d2d06c9?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/5770281/bob"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1452444552, "post_id": 34707983, "comment_id": 57162133, "body": "@AJFarmar Certainly, but you&#39;re not implying that this is an infix constructor, are you?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1452445076, "post_id": 34707983, "comment_id": 57162355, "body": "no - <code>:t</code>, <code>:i</code>, <code>:m</code> ... are just commands you pass on to GHCi while you are using it - it&#39;s not part of your program/script"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1452446375, "post_id": 34707983, "comment_id": 57162897, "body": "@Bob No, an infix constructor must consist entirely of non-alphanumeric characters. Commands such as <code>:type</code>, <code>:load</code> etc are GHCi commands which <i>only have meaning at all in GHCi</i>."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1452536056, "post_id": 34718312, "comment_id": 57202592, "body": "I&#39;d add that in <i>type operators</i>, the colon can be used just like any other infix symbol, e.g. you can define both <code>type a :&amp; b = a</code> and <code>type a &amp;: b = b</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452541328, "post_id": 34718312, "comment_id": 57205571, "body": "In GHC, I believe an infix <i>type</i> constructor does not need to start with a colon."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 7, "last_activity_date": 1452505552, "creation_date": 1452505552, "answer_id": 34718312, "question_id": 34707983, "link": "https://stackoverflow.com/questions/34707983/meaning-of-single-colon-in-haskell-t/34718312#34718312", "title": "Meaning of single colon in Haskell :t", "body": "<p>The <code>:t</code> (short for <code>:type</code>) syntax is special to GHCi, and is <em>not</em> part of the Haskell language syntax. This is similar to how the SQLite interpreter accepts <code>.tables</code> as a command, even though this isn't valid a SQL statement. If you type <code>:?</code>, you can see a complete list of all the commands GHCi understands.</p>\n\n<p>As for using the colon in actual Haskell code:</p>\n\n<ul>\n<li>A colon by itself is a list constructor. This is a reserved name, and can never be redefined.</li>\n<li>You should know that function names always start lowercase, while constructor names always start uppercase. Well, in a similar way, an infix constructor <em>must</em> start with a colon, whereas a normal infix operator <em>must not</em> start with a colon (but may contain colons elsewhere).</li>\n</ul>\n\n<p>So, for example, \"<code>?:?</code>\" is a legal operator name, and <code>:??</code> is a legal constructor operator name.</p>\n\n<pre><code>x ?:? y = ...whatever...\n\ndata Foobar = Int :?? Bool\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5770281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4afbddf8c56459e93789b4d8d2d06c9?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/5770281/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2927, "favorite_count": 0, "accepted_answer_id": 34718312, "answer_count": 1, "score": 4, "last_activity_date": 1452505552, "creation_date": 1452443905, "question_id": 34707983, "link": "https://stackoverflow.com/questions/34707983/meaning-of-single-colon-in-haskell-t", "title": "Meaning of single colon in Haskell :t", "body": "<p>As far as I've been able to gather, the single colon in Haskell is used in list comprehension. Why then does it show up in the :t command? Also in the :quit command? There isn't any list comprehension being done, is there?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 4076, "user_id": 1370541, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/LIKzX.png?s=128&g=1", "display_name": "JSQuareD", "link": "https://stackoverflow.com/users/1370541/jsquared"}, "edited": false, "score": 0, "creation_date": 1452439298, "post_id": 34707042, "comment_id": 57160116, "body": "You&#39;re looking for a function which takes a list, and reverses it. Have you tried querying <a href=\"http://haskell.org/hoogle\" rel=\"nofollow noreferrer\">haskell.org/hoogle</a> for either <code>reverse</code> or <code>[a]-&gt;[a]</code>?"}, {"owner": {"reputation": 131, "user_id": 5769707, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ddc1d07e117c045e0fb404507e3f40a7?s=128&d=identicon&r=PG&f=1", "display_name": "Nia", "link": "https://stackoverflow.com/users/5769707/nia"}, "reply_to_user": {"reputation": 55943, "user_id": 3933332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zuzev.png?s=128&g=1", "display_name": "Rizier123", "link": "https://stackoverflow.com/users/3933332/rizier123"}, "edited": false, "score": 0, "creation_date": 1452439300, "post_id": 34707042, "comment_id": 57160118, "body": "@Rizier123 I am new to Haskell so only know a little syntax in it, I wrote a function which reverse the elements of the list, but I don&#39;t want that, so to answer your question, I am still figuring it out and needed some directions."}, {"owner": {"reputation": 55943, "user_id": 3933332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zuzev.png?s=128&g=1", "display_name": "Rizier123", "link": "https://stackoverflow.com/users/3933332/rizier123"}, "edited": false, "score": 0, "creation_date": 1452439349, "post_id": 34707042, "comment_id": 57160136, "body": "@Nia <i>I wrote a function which reverse the elements of the list</i> &lt;- Show us this code, maybe you are closer to the solution than you think"}, {"owner": {"reputation": 131, "user_id": 5769707, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ddc1d07e117c045e0fb404507e3f40a7?s=128&d=identicon&r=PG&f=1", "display_name": "Nia", "link": "https://stackoverflow.com/users/5769707/nia"}, "reply_to_user": {"reputation": 55943, "user_id": 3933332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zuzev.png?s=128&g=1", "display_name": "Rizier123", "link": "https://stackoverflow.com/users/3933332/rizier123"}, "edited": false, "score": 0, "creation_date": 1452439557, "post_id": 34707042, "comment_id": 57160217, "body": "@Rizier123 thanks I have this code for reversing it:  myreverse ::[Integer] -&gt; [Integer]  myreverse [] = []  myreverse (h:t)= myappend (myreverse t) [h]  myappend is a function I have which appends the list."}, {"owner": {"reputation": 131, "user_id": 5769707, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ddc1d07e117c045e0fb404507e3f40a7?s=128&d=identicon&r=PG&f=1", "display_name": "Nia", "link": "https://stackoverflow.com/users/5769707/nia"}, "reply_to_user": {"reputation": 55943, "user_id": 3933332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zuzev.png?s=128&g=1", "display_name": "Rizier123", "link": "https://stackoverflow.com/users/3933332/rizier123"}, "edited": false, "score": 0, "creation_date": 1452439627, "post_id": 34707042, "comment_id": 57160249, "body": "@Rizier123  sorry for adding the code to the comment, it looks hard to read. I hope you can read it."}, {"owner": {"reputation": 55943, "user_id": 3933332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zuzev.png?s=128&g=1", "display_name": "Rizier123", "link": "https://stackoverflow.com/users/3933332/rizier123"}, "edited": false, "score": 0, "creation_date": 1452439662, "post_id": 34707042, "comment_id": 57160262, "body": "@Nia Just <a href=\"https://stackoverflow.com/posts/34707042/edit\">edit</a> your question and add it in there."}, {"owner": {"reputation": 131, "user_id": 5769707, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ddc1d07e117c045e0fb404507e3f40a7?s=128&d=identicon&r=PG&f=1", "display_name": "Nia", "link": "https://stackoverflow.com/users/5769707/nia"}, "reply_to_user": {"reputation": 55943, "user_id": 3933332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zuzev.png?s=128&g=1", "display_name": "Rizier123", "link": "https://stackoverflow.com/users/3933332/rizier123"}, "edited": false, "score": 0, "creation_date": 1452439684, "post_id": 34707042, "comment_id": 57160272, "body": "@Rizier123 okay i will do that, thanks"}, {"owner": {"reputation": 55943, "user_id": 3933332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zuzev.png?s=128&g=1", "display_name": "Rizier123", "link": "https://stackoverflow.com/users/3933332/rizier123"}, "edited": false, "score": 0, "creation_date": 1452440099, "post_id": 34707042, "comment_id": 57160432, "body": "@Nia FYI: See <a href=\"https://stackoverflow.com/tour\">tour</a> to get a quick overview of this site and see how everything works."}, {"owner": {"reputation": 55943, "user_id": 3933332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zuzev.png?s=128&g=1", "display_name": "Rizier123", "link": "https://stackoverflow.com/users/3933332/rizier123"}, "edited": false, "score": 0, "creation_date": 1452441272, "post_id": 34707042, "comment_id": 57160919, "body": "There is no need to put the tags in your title: <a href=\"http://meta.stackexchange.com/q/19190\">meta.stackexchange.com/q/19190</a> For this you tag your question."}], "answers": [{"tags": [], "owner": {"reputation": 1025, "user_id": 1439629, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4cfce72158cd5741f0a48e67483b85e8?s=128&d=identicon&r=PG", "display_name": "Hamish", "link": "https://stackoverflow.com/users/1439629/hamish"}, "is_accepted": false, "score": 2, "last_activity_date": 1452440058, "last_edit_date": 1452440058, "creation_date": 1452439647, "answer_id": 34707165, "question_id": 34707042, "link": "https://stackoverflow.com/questions/34707042/how-to-reverse-a-list-of-lists/34707165#34707165", "title": "How to reverse a list of lists?", "body": "<p>You can do this with the <code>reverse</code> function, or by doing something like this:</p>\n\n<pre><code>reversal :: [a] -&gt; [a]\nreversal [] = []\nreversal (x : xs) = (reversal xs) ++ [x]\n</code></pre>\n\n<p>Using this on your example:</p>\n\n<pre><code>*Main&gt; reversal [[1,2,3],[1,2],[1],[]]\n[[],[1],[1,2],[1,2,3]]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 131, "user_id": 5769707, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ddc1d07e117c045e0fb404507e3f40a7?s=128&d=identicon&r=PG&f=1", "display_name": "Nia", "link": "https://stackoverflow.com/users/5769707/nia"}, "edited": false, "score": 0, "creation_date": 1452441059, "post_id": 34707214, "comment_id": 57160812, "body": "thank you so much!!!!!! indeed its very helpful!!! If you don&#39;t mind, can I ask you one more question regarding this matter? I have a function and its output is like this  [[1,2,3],[1,2],[1],[]] but I wanted it in opposite order. Now when I am applying the reverse to that function, its giving a weird output, If you don&#39;t mind would you please look at my function? if you say yes, I will put the code in my question."}, {"owner": {"reputation": 55943, "user_id": 3933332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zuzev.png?s=128&g=1", "display_name": "Rizier123", "link": "https://stackoverflow.com/users/3933332/rizier123"}, "reply_to_user": {"reputation": 131, "user_id": 5769707, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ddc1d07e117c045e0fb404507e3f40a7?s=128&d=identicon&r=PG&f=1", "display_name": "Nia", "link": "https://stackoverflow.com/users/5769707/nia"}, "edited": false, "score": 1, "creation_date": 1452441133, "post_id": 34707214, "comment_id": 57160849, "body": "@Nia You can put the function which you try right now here in the comments just but back ticks around them, e.g. `code`. But if you use the code from my answer everything should work fine"}, {"owner": {"reputation": 131, "user_id": 5769707, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ddc1d07e117c045e0fb404507e3f40a7?s=128&d=identicon&r=PG&f=1", "display_name": "Nia", "link": "https://stackoverflow.com/users/5769707/nia"}, "edited": false, "score": 0, "creation_date": 1452441921, "post_id": 34707214, "comment_id": 57161178, "body": "thank you. my function is <code>prefix:: [a] -&gt; [[a]]  prefix[] =[]:[]  prefix (h:t)= (h:t) : prefix (init (h:t)) </code>   When I call it with prefix [1,2,3,4], Right now it returns  **  [[1,2,3],[1,2],[1],[]] ** but when I change the last line of the function to <code>reverse((h:t) : prefix (init (h:t)))</code> it returns **[[1,2,3],[1],[],[1,2],[1,2,3,4]] **"}, {"owner": {"reputation": 55943, "user_id": 3933332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zuzev.png?s=128&g=1", "display_name": "Rizier123", "link": "https://stackoverflow.com/users/3933332/rizier123"}, "reply_to_user": {"reputation": 131, "user_id": 5769707, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ddc1d07e117c045e0fb404507e3f40a7?s=128&d=identicon&r=PG&f=1", "display_name": "Nia", "link": "https://stackoverflow.com/users/5769707/nia"}, "edited": false, "score": 1, "creation_date": 1452442266, "post_id": 34707214, "comment_id": 57161300, "body": "@Nia Don&#39;t do that in your function. Just do it when you call the function, e.g. <code>reverse (prefix [1,2,3,4])</code>"}, {"owner": {"reputation": 131, "user_id": 5769707, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ddc1d07e117c045e0fb404507e3f40a7?s=128&d=identicon&r=PG&f=1", "display_name": "Nia", "link": "https://stackoverflow.com/users/5769707/nia"}, "edited": false, "score": 1, "creation_date": 1452442530, "post_id": 34707214, "comment_id": 57161401, "body": "very good idea, thank you so much for being so kind and helpful!! I can not possibly thank you enough. :))"}], "tags": [], "owner": {"reputation": 55943, "user_id": 3933332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zuzev.png?s=128&g=1", "display_name": "Rizier123", "link": "https://stackoverflow.com/users/3933332/rizier123"}, "is_accepted": true, "score": 5, "last_activity_date": 1452439906, "creation_date": 1452439906, "answer_id": 34707214, "question_id": 34707042, "link": "https://stackoverflow.com/questions/34707042/how-to-reverse-a-list-of-lists/34707214#34707214", "title": "How to reverse a list of lists?", "body": "<p>Your attempt is already very close to the solution:</p>\n\n<pre><code>myreverse ::[Integer] -&gt; [Integer]\nmyreverse [] = []\nmyreverse (h:t)= myappend (myreverse t) [h]\n</code></pre>\n\n<p>Mainly you just have to change two things. First change out <code>Integer</code> with a type variable, so you can reverse lists in lists with your function. And second you want to append a list to a list here: <code>myappend (myreverse t) [h]</code> so for this, just use <code>++</code>, and you're done!</p>\n\n<pre><code>myreverse :: [<b>a</b>] -> [<b>a</b>]\nmyreverse [] = []\nmyreverse (h:t)= <b>(myreverse t) ++ [h]</b>\n</code></pre>\n\n<hr>\n\n<p>Also there is already a <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-List.html#v:reverse\"><code>reverse</code></a> function out there, if you don't want to write your own:</p>\n\n<pre><code>Data.List.reverse [[1,2,3],[1,2],[1],[]]\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>[[],[1],[1,2],[1,2,3]]\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 5769707, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ddc1d07e117c045e0fb404507e3f40a7?s=128&d=identicon&r=PG&f=1", "display_name": "Nia", "link": "https://stackoverflow.com/users/5769707/nia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 763, "favorite_count": 1, "accepted_answer_id": 34707214, "answer_count": 2, "score": 1, "last_activity_date": 1452441744, "creation_date": 1452438972, "last_edit_date": 1452441744, "question_id": 34707042, "link": "https://stackoverflow.com/questions/34707042/how-to-reverse-a-list-of-lists", "title": "How to reverse a list of lists?", "body": "<p>I have a <code>[[a]]</code> type and for example it looks like:</p>\n\n<pre><code>[[1,2,3],[1,2],[1],[]]\n</code></pre>\n\n<p>But I want to make a function in Haskell which will make it look like:</p>\n\n<pre><code>[[],[1],[1,2],[1,2,3]]\n</code></pre>\n\n<p>I started with this function, but it does not work for a list with lists in it:</p>\n\n<pre><code>myreverse ::[Integer] -&gt; [Integer]\nmyreverse [] = []\nmyreverse (h:t)= myappend (myreverse t) [h]\n</code></pre>\n\n<p>(<code>myappend</code> is a local function I have, it appends the list)</p>\n\n<p>So what do I need to change in my code, to get it to work with a list containing other lists?</p>\n"}, {"tags": ["http", "haskell", "request", "streaming"], "answers": [{"comments": [{"owner": {"reputation": 1510, "user_id": 1576064, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/47c868b652ffdc287498a8c604a30013?s=128&d=identicon&r=PG", "display_name": "Lubom&#237;r Sedl&#225;\u0159", "link": "https://stackoverflow.com/users/1576064/lubom%c3%adr-sedl%c3%a1%c5%99"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1452436910, "post_id": 34706626, "comment_id": 57159125, "body": "@ErikAllik Probably is. I&#39;m open to suggestions. Also, feel free to edit and improve :)"}], "tags": [], "owner": {"reputation": 1510, "user_id": 1576064, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/47c868b652ffdc287498a8c604a30013?s=128&d=identicon&r=PG", "display_name": "Lubom&#237;r Sedl&#225;\u0159", "link": "https://stackoverflow.com/users/1576064/lubom%c3%adr-sedl%c3%a1%c5%99"}, "is_accepted": false, "score": 1, "last_activity_date": 1452437358, "last_edit_date": 1452437358, "creation_date": 1452436690, "answer_id": 34706626, "question_id": 34706535, "link": "https://stackoverflow.com/questions/34706535/how-to-use-wreq-to-download-only-part-of-response/34706626#34706626", "title": "How to use wreq to download only part of response?", "body": "<p>One option is to use the <a href=\"http://hackage.haskell.org/package/wreq-0.4.1.0/docs/Network-Wreq.html#v:foldGet\" rel=\"nofollow\">foldGet</a> function, accumulate chunks of data as they arrive, and throw an exception once enough data has been downloaded. The accumulated data will be passed out in the exception.</p>\n\n<pre><code>import qualified Control.Exception           as E\nimport qualified Data.ByteString             as BS\nimport qualified Data.ByteString.Lazy        as BL\nimport           Data.ByteString.Builder\n\ndata EnoughException = Enough Builder\n\ninstance Show EnoughException where\n    show _ = \"EnoughException\"\n\ninstance E.Exception EnoughException\n\ngetFile :: Int -&gt; String -&gt; IO BL.ByteString\ngetFile maxLen url = ((extract . fst) &lt;$&gt; foldGet process (mempty, 0) url) `E.catch` enough\n  where\n    extract :: Builder -&gt; String\n    extract = BL.take (fromIntegral maxLen) . toLazyByteString\n\n    process :: (Builder, Int)   -- ^(Accumulated data, current length)\n            -&gt; BS.ByteString    -- ^Downloded chunk\n            -&gt; IO (Builder, Int)\n    process (acc, cur) now = do\n        let acc' = acc &lt;&gt; byteString now\n        let cur' = cur + BS.length now\n        if cur' &gt; maxLen\n            then E.throw (Enough acc')\n            else return (acc', cur')\n\n    enough (Enough d) = return (extract d)\n</code></pre>\n\n<p>(Note: this function does not handle exceptions that could be thrown by <em>wreq</em>. For real use that would be necessary.)</p>\n"}], "owner": {"reputation": 1510, "user_id": 1576064, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/47c868b652ffdc287498a8c604a30013?s=128&d=identicon&r=PG", "display_name": "Lubom&#237;r Sedl&#225;\u0159", "link": "https://stackoverflow.com/users/1576064/lubom%c3%adr-sedl%c3%a1%c5%99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1452437358, "creation_date": 1452436071, "last_edit_date": 1452436696, "question_id": 34706535, "link": "https://stackoverflow.com/questions/34706535/how-to-use-wreq-to-download-only-part-of-response", "title": "How to use wreq to download only part of response?", "body": "<p>How can I download only the first 1 KiB of the response using <a href=\"http://www.serpentine.com/wreq/\" rel=\"nofollow\">wreq</a> library?</p>\n\n<p>Theoretically I could use the <code>Range</code> HTTP header. However, that requires support on the server, which I can't rely on.</p>\n\n<p>How can I abort the request once I have enough data on the client?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452448294, "post_id": 34706787, "comment_id": 57163613, "body": "That&#39;s a list, not an array. Looking things up in it will be slow."}], "tags": [], "owner": {"reputation": 423, "user_id": 2653131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5223eb44abc331b45762a01c7e67f02?s=128&d=identicon&r=PG", "display_name": "jnes", "link": "https://stackoverflow.com/users/2653131/jnes"}, "is_accepted": true, "score": 1, "last_activity_date": 1452439194, "last_edit_date": 1452439194, "creation_date": 1452437559, "answer_id": 34706787, "question_id": 34706252, "link": "https://stackoverflow.com/questions/34706252/generate-list-of-random-characters-while-keeping-the-seed/34706787#34706787", "title": "Generate list of random Characters while keeping the seed", "body": "<p>One approach would be to define the available characters you are interested in as an array and then randomly select characters from the array. </p>\n\n<pre><code>randomEl :: RandomGen g =&gt; [a] -&gt; g -&gt; (a, g)\nrandomEl xs g -&gt; (g', xs !! r) \n  where (r, g') = randomR (0, length xs - 1) g\n\nrandomAlphaNum :: RandomGen g =&gt; g -&gt; (Char, g)\nrandomAlphaNum = randomEl (['0'..'9'] ++ ['a'..'z'])\n</code></pre>\n\n<p>Next building the string should be pretty easy... There is for example the  <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:iterate\" rel=\"nofollow\">iterate</a> defined in Prelude.</p>\n\n<pre><code>generate :: RandomGen g =&gt; Int -&gt; g -&gt; (String, g)\ngenerate n g = (map fst iterations, (snd . last) iterations)\n  where iterations = (take n . iterate (randomAlphaNum . snd)) (randomAlphaNum g)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 3, "last_activity_date": 1452438812, "creation_date": 1452438812, "answer_id": 34707010, "question_id": 34706252, "link": "https://stackoverflow.com/questions/34706252/generate-list-of-random-characters-while-keeping-the-seed/34707010#34707010", "title": "Generate list of random Characters while keeping the seed", "body": "<p>The best technique is to use \"split\":</p>\n\n<pre><code>class RandomGen g where\n    split :: g -&gt; (g,g)\n    -- Other functions as well.\n</code></pre>\n\n<p>Split your random generator in two. Use one of the results to generate your random string, and return the other one with the result.</p>\n\n<p>Its not clear from your question how long the string should be: presumably it should be the same length as the input string. If so then it would be better style to take an Int length as the argument.</p>\n\n<p>You also say you haven't figured out how to select from a more complicated range than just ('a', 'z'). You need to set up an array (or better yet, a vector) of candidate items and choose one from that. You could use a list, but that means you will be iterating through the list every time.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1530331737, "last_edit_date": 1530331737, "creation_date": 1452448853, "answer_id": 34708883, "question_id": 34706252, "link": "https://stackoverflow.com/questions/34706252/generate-list-of-random-characters-while-keeping-the-seed/34708883#34708883", "title": "Generate list of random Characters while keeping the seed", "body": "<p>Paul Johnson's seed splitting approach is certainly reasonable, but since you're producing a string of known length, another good option is to use <code>replicateM</code> within a randomness monad.</p>\n\n<pre><code>generateR :: (MonadRandom m, Random a) =&gt; Int -&gt; (a, a) -&gt; m [a]\ngenerateR len range = replicateM len (getRandomR range)\n</code></pre>\n"}], "owner": {"reputation": 367, "user_id": 4716940, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/363a400a9b096b10c2ba8070f7b12f35?s=128&d=identicon&r=PG&f=1", "display_name": "demathieu", "link": "https://stackoverflow.com/users/4716940/demathieu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1050, "favorite_count": 0, "accepted_answer_id": 34706787, "answer_count": 3, "score": 1, "last_activity_date": 1530331737, "creation_date": 1452434386, "question_id": 34706252, "link": "https://stackoverflow.com/questions/34706252/generate-list-of-random-characters-while-keeping-the-seed", "title": "Generate list of random Characters while keeping the seed", "body": "<p>My goal is to write a function that generates a random string of characters (alphanumeric) of a given length based on a seed. Important is that the result is not only the string but also the new seed. </p>\n\n<p>I know I can get a String by using take on randomRS but the problem is I wouldn't be able to retrieve the seed afterwards</p>\n\n<pre><code>generate :: StdGen -&gt; String -&gt; (String, StdGen) \n</code></pre>\n\n<p>I was able to write it for one character although I couldn't not get the range to allow both letters and numbers</p>\n\n<pre><code>generateRandomCharacter gen = randomR ('a','z') gen\n</code></pre>\n"}, {"tags": ["haskell", "glfw", "ghci"], "owner": {"reputation": 21, "user_id": 5769726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a22404ec85aefefc3deabb267183cad2?s=128&d=identicon&r=PG&f=1", "display_name": "Geff Okno", "link": "https://stackoverflow.com/users/5769726/geff-okno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1452434638, "creation_date": 1452434173, "last_edit_date": 1452434638, "question_id": 34706215, "link": "https://stackoverflow.com/questions/34706215/program-crash-while-i-try-use-glfw-b-in-ghci", "title": "Program crash while I try use GLFW-b in GHCi", "body": "<p>I'm trying to write an application using <strong>OpenGL</strong> and <strong>GLFW-b</strong>, but I get into difficulties when I try to work in <strong>GHCi</strong>. </p>\n\n<p>Here's the code:</p>\n\n<pre><code>import Graphics.UI.GLFW as GLFW\n\nmain = do\n  GLFW.init\n  GLFW.terminate\n</code></pre>\n\n<p>When I build the code using <strong>stack build</strong> and then execute the file, the program works correct. But if I try to execute it in ghci, <strong>ghc.exe</strong> crashes. How to solve this problem?</p>\n\n<p>Flag <strong>-fno-ghci-sandbox</strong> doesn't help (<a href=\"https://github.com/bsl/GLFW-b/issues/53\" rel=\"nofollow\">https://github.com/bsl/GLFW-b/issues/53</a>).</p>\n\n<p>I am using GHC-7.10.3.</p>\n"}, {"tags": ["haskell", "concurrency", "io"], "comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1452433079, "post_id": 34705845, "comment_id": 57157827, "body": "<code>but I can&#39;t wait until a new line is available</code> Do you mean that you want to process the line as it is being generated, perhaps without wholly keeping it in memory?"}, {"owner": {"reputation": 131, "user_id": 4938013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69806c5fee49d4807312b8b2508c1f3e?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Bidlingmaier", "link": "https://stackoverflow.com/users/4938013/martin-bidlingmaier"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1452434013, "post_id": 34705845, "comment_id": 57158181, "body": "No, I do want to process only full lines. I edited the post for clarification."}], "answers": [{"tags": [], "owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "is_accepted": false, "score": 1, "last_activity_date": 1452541256, "creation_date": 1452541256, "answer_id": 34729703, "question_id": 34705845, "link": "https://stackoverflow.com/questions/34705845/haskell-read-lines-from-handle-without-blocking/34729703#34729703", "title": "Haskell - Read Lines from Handle without blocking", "body": "<p>After a bit of tinkering I came up with this, hope it helps you:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>dealWithLine :: String -&gt; IO ()\ndealWithLine l = putStrLn $ l ++ \"; length: \" ++ (show $ length l)\n\nmain = getContents &gt;&gt;= (\\s -&gt; mapM dealWithLine $ lines s)\n</code></pre>\n\n<p>The key function for you is <code>getContents</code> which takes input as is, is none blocking and you can feed it to whatever function you want in order to deal with stdin.</p>\n"}], "owner": {"reputation": 131, "user_id": 4938013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69806c5fee49d4807312b8b2508c1f3e?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Bidlingmaier", "link": "https://stackoverflow.com/users/4938013/martin-bidlingmaier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1452541256, "creation_date": 1452431880, "last_edit_date": 1452434671, "question_id": 34705845, "link": "https://stackoverflow.com/questions/34705845/haskell-read-lines-from-handle-without-blocking", "title": "Haskell - Read Lines from Handle without blocking", "body": "<p>I want to process the stdout of a process launched via <code>createProcess</code> linewise, but I can't  wait until a new line is available. My application will do something like this:</p>\n\n<ol>\n<li>Get all full lines from the output of some external program that are available without waiting</li>\n<li>Launch a job that processes these lines</li>\n<li>Once the job is completed, wait until at least one line of the external program's output is available and repeat</li>\n</ol>\n\n<p>I don't know how to implement 1. Is there an equivalent to <code>Handle</code>'s <code>hGetBufNonBlocking</code> that operates on a per-line basis? If not, what is the Haskell\u2122 way to solve this problem? Use <code>hReady</code> and <code>hGetChar</code> to implement custom line buffering or some form of concurrency?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "edited": false, "score": 0, "creation_date": 1452433288, "post_id": 34705766, "comment_id": 57157899, "body": "A little tip: If you know the signature of the function you want, then you can search for it on <a href=\"https://www.haskell.org/hoogle/?hoogle=%5Ba%5D+-%3E+%5B%5Ba%5D%5D\" rel=\"nofollow noreferrer\">Hoogle</a> or <a href=\"http://hayoo.fh-wedel.de/?query=%5Ba%5D+-%3E+%5B%5Ba%5D%5D\" rel=\"nofollow noreferrer\">Hayoo</a>. In both cases, the first result for <code>[a] -&gt; [[a]]</code> is actually the answer you are looking for. Of course, it&#39;s not always that easy, but it&#39;s a good place to start."}, {"owner": {"reputation": 131, "user_id": 5769707, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ddc1d07e117c045e0fb404507e3f40a7?s=128&d=identicon&r=PG&f=1", "display_name": "Nia", "link": "https://stackoverflow.com/users/5769707/nia"}, "reply_to_user": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "edited": false, "score": 0, "creation_date": 1452436571, "post_id": 34705766, "comment_id": 57159009, "body": "@PeterHall, thank you Peter, very useful tip!!!"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452451298, "post_id": 34705799, "comment_id": 57164750, "body": "This turns out to be very slow."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1452431636, "creation_date": 1452431636, "answer_id": 34705799, "question_id": 34705766, "link": "https://stackoverflow.com/questions/34705766/writing-a-prefix-function-haskell/34705799#34705799", "title": "Writing a prefix function Haskell", "body": "<p>The library function <code>inits</code> does what you want.</p>\n\n<p>Otherwise, consider this:</p>\n\n<pre><code>prefix :: [a] -&gt; [[a]]\nprefix [] = baseCase\nprefix (x:xs) = doSomethingTo (prefix xs)\n</code></pre>\n\n<p>Can you guess what <code>baseCase</code> and <code>doSomethingTo</code> should be?</p>\n\n<p>For the latter: think about how to transform</p>\n\n<pre><code>prefix [2,3] = [[], [2], [2,3]]\n</code></pre>\n\n<p>into</p>\n\n<pre><code>prefix [1,2,3] = [[], [1], [1,2], [1,2,3]]\n</code></pre>\n\n<p>A way to do that is to first transform <code>[[], [2], [2,3]]</code> into <code>[[1], [1,2], [1,2,3]]</code> and then add the additional <code>[]</code> in front of that.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6428287"}, "is_accepted": false, "score": 0, "last_activity_date": 1503249278, "last_edit_date": 1503249278, "creation_date": 1491248909, "answer_id": 43193092, "question_id": 34705766, "link": "https://stackoverflow.com/questions/34705766/writing-a-prefix-function-haskell/43193092#43193092", "title": "Writing a prefix function Haskell", "body": "<pre><code>suffixes, prefices :: [a] -&gt; [[a]]\n\nsuffixes []          = [] :\u00a0[]\nsuffixes lst@(_ : s) = lst : suffixes s\n\nprefices []  = [] : []\nprefices lst = lst : prefices (init lst)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 581, "user_id": 6178240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CRJ95.jpg?s=128&g=1", "display_name": "MiFi", "link": "https://stackoverflow.com/users/6178240/mifi"}, "is_accepted": false, "score": 0, "last_activity_date": 1581358510, "creation_date": 1581358510, "answer_id": 60156133, "question_id": 34705766, "link": "https://stackoverflow.com/questions/34705766/writing-a-prefix-function-haskell/60156133#60156133", "title": "Writing a prefix function Haskell", "body": "<p>Poin-free solution:</p>\n\n<pre><code>prefixes = foldr (\\el acc -&gt; [] : map (el:) acc) [[]]\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 5769707, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ddc1d07e117c045e0fb404507e3f40a7?s=128&d=identicon&r=PG&f=1", "display_name": "Nia", "link": "https://stackoverflow.com/users/5769707/nia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 1, "accepted_answer_id": 34705799, "answer_count": 3, "score": 0, "last_activity_date": 1581358510, "creation_date": 1452431473, "question_id": 34705766, "link": "https://stackoverflow.com/questions/34705766/writing-a-prefix-function-haskell", "title": "Writing a prefix function Haskell", "body": "<p>I am new to Haskell [I am loving Haskell by the way :)].\nThe problem is that I want to write a function myPrefix that takes as input a list, and gives as output the list consisting of all prefixes of the input-list. For Example:</p>\n\n<pre><code>*Main&gt; prefix [1,2,3]\n[[],[1],[1,2],[1,2,3]]\n</code></pre>\n\n<p>But I can not think of a way to do it.\nIf some one can please give me a push in the right direction, I will be in debt.</p>\n\n<p>I have tried to find related posts but I could not find any, SO I posted a question.</p>\n\n<p>Thank you in advance!!!</p>\n"}, {"tags": ["haskell", "yesod", "haskell-stack"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1452449889, "post_id": 34705334, "comment_id": 57164229, "body": "Add 1 GB of swap space and then try again."}, {"owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1452480934, "post_id": 34705334, "comment_id": 57173400, "body": "The hosting service provider does not seem very generous on user swap space...  Now checking what my options are."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1452490465, "post_id": 34705334, "comment_id": 57175721, "body": "If you have a shell access, you can do this: <a href=\"http://stackoverflow.com/a/13106205/1651941\">stackoverflow.com/a/13106205/1651941</a>"}, {"owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1452502684, "post_id": 34705334, "comment_id": 57180641, "body": "@Sibi. That&#39;s precisely what I have done, however the VPS solution apparently does not allow &quot;user defined swap&quot; and I get a <code>swapon: &#47;swapfile: swapon failed: Operation not permitted</code> error message when trying to enable swap (<code>swapon &#47;swapfile</code> command), that&#39;s what is mentioned in the U&amp;L discussion link above (in my edit). I called the hosting service provider who suggested that I switch from a VPS to a dedicated server... :("}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1452502919, "post_id": 34705334, "comment_id": 57180785, "body": "Just so that you haven&#39;t missed the obvious thing, did you use <code>sudo</code> while issuing the command ?"}, {"owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1452503324, "post_id": 34705334, "comment_id": 57180980, "body": "@Sibi. Good question, but I haven&#39;t. The <code>swapon failed: Operation not permitted</code> error msg is with sudo ; without sudo it is <code>open failed: Permission denied</code>. I am still optimistic and believe that there is a solution around the issue, as probably many other users have already installed Yesod on a VPS."}], "answers": [{"tags": [], "owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "is_accepted": false, "score": 1, "last_activity_date": 1452677771, "creation_date": 1452677771, "answer_id": 34763002, "question_id": 34705334, "link": "https://stackoverflow.com/questions/34705334/stack-build-issue-with-yesod/34763002#34763002", "title": "`stack build` Issue with Yesod", "body": "<p>Not a great technical solution, but I changed VPS provider, running on the same OS and the same apparent specs, and I was easily able to <code>stack build</code> everything (including the yesod suite).</p>\n\n<p>The new VPS service provider allows user-base swapping, but I have checked that it is not necessary and I could still compile with no swap file on (but obviously, it's slower).</p>\n"}], "owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452677771, "creation_date": 1452428774, "last_edit_date": 1492086991, "question_id": 34705334, "link": "https://stackoverflow.com/questions/34705334/stack-build-issue-with-yesod", "title": "`stack build` Issue with Yesod", "body": "<p>I am trying to stack-build a new Yesod-based project on a clean (new) VPS server, which runs on Ubuntu Trusty x86_64.</p>\n\n<p>In case it matters for the question, here is the memory info: </p>\n\n<pre><code>me@user:~/proj-web01$ free -h\n            total       used       free     shared    buffers     cached\nMem:        1.0G         46M        977M     8.8M      0B          11M\n-/+ buffers/cache:       35M        988M\nSwap:          0B         0B          0B\n</code></pre>\n\n<p>Here is a piece of the stack project's cabal file :</p>\n\n<pre><code>library\n  hs-source-dirs:      src\n  exposed-modules:     Lib\n  build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5\n  default-language:    Haskell2010\n\nexecutable proj-web01-exe\n  hs-source-dirs:      app\n  main-is:             Main.hs\n  ghc-options:         -threaded -rtsopts -with-rtsopts=-N\n  build-depends:       base, yesod\n                     , proj-web01\n  default-language:    Haskell2010\n</code></pre>\n\n<p>There are other packages in the dependencies besides yesod, and when I <code>stack build</code> without adding yesod in the dependencies, the various packages download normally and all looks fine - except of course that the build cannot complete since yesod is also needed. </p>\n\n<p>However when I add yesod the list of dependencies, I get a <code>Progress: 0/96Killed</code> error message. It does not seem to matter if there are other packages present in the dependencies list or not. Here is a dump of <code>stack build --verbose</code> :  </p>\n\n<p><code>me@user:~/proj-web01$ stack build --verbose</code></p>\n\n<pre><code>Version 1.0.0, Git revision 3bc26237b5b3c387b8fd564459ea4dd88fd58b30 (2939 commits) x86_64\n2016-01-10 04:30:53.022676: [debug] Checking for project config at: /home/me/proj-web01/stack.yaml @(stack_Jo7PUTL0uTIFJF98jKr0KI:Stack.Config src/Stack/Config.hs:577:9)\n2016-01-10 04:30:53.023099: [debug] Loading project config file stack.yaml @(stack_Jo7PUTL0uTIFJF98jKr0KI:Stack.Config src/Stack/Config.hs:600:13)\n2016-01-10 04:30:53.024852: [debug] Run process: ldd /usr/bin/stack @(stack_Jo7PUTL0uTIFJF98jKr0KI:System.Process.Read src/System/Process/Read.hs:267:3)\n2016-01-10 04:30:53.037163: [debug] Trying to decode /home/me/.stack/build-plan-cache/x86_64-linux/lts-4.0.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:55:5)\n2016-01-10 04:30:53.057650: [debug] Success decoding /home/me/.stack/build-plan-cache/x86_64-linux/lts-4.0.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:64:13)\n2016-01-10 04:30:53.057869: [debug] Trying to decode /home/me/.stack/indices/Hackage/00-index.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:55:5)\n2016-01-10 04:30:53.407750: [debug] Success decoding /home/me/.stack/indices/Hackage/00-index.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:64:13)\n2016-01-10 04:30:53.440540: [debug] Run process: ghc --numeric-version @(stack_Jo7PUTL0uTIFJF98jKr0KI:System.Process.Read src/System/Process/Read.hs:267:3)\n2016-01-10 04:30:53.498901: [debug] Run process: ghc-pkg --no-user-package-db field --simple-output Cabal version @(stack_Jo7PUTL0uTIFJF98jKr0KI:System.Process.Read src/System/Process/Read.hs:267:3)\n2016-01-10 04:30:53.536509: [debug] Run process: ghc-pkg --no-user-package-db list --global @(stack_Jo7PUTL0uTIFJF98jKr0KI:System.Process.Read src/System/Process/Read.hs:267:3)\n2016-01-10 04:30:53.567473: [debug] Checking resolver: lts-4.0 @(stack_Jo7PUTL0uTIFJF98jKr0KI:Stack.Build.Source src/Stack/Build/Source.hs:164:17)\n2016-01-10 04:30:53.567752: [debug] Trying to decode /home/me/.stack/build-plan-cache/x86_64-linux/lts-4.0.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:55:5)\n2016-01-10 04:30:53.584895: [debug] Success decoding /home/me/.stack/build-plan-cache/x86_64-linux/lts-4.0.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:64:13)\n2016-01-10 04:30:53.597807: [debug] Run process: ghc-pkg --global --no-user-package-db dump --expand-pkgroot @(stack_Jo7PUTL0uTIFJF98jKr0KI:System.Process.Read src/System/Process/Read.hs:267:3)\n2016-01-10 04:30:53.667493: [debug] Ignoring package haskeline due to wanting version 0.7.2.2 instead of 0.7.2.1 @(stack_Jo7PUTL0uTIFJF98jKr0KI:Stack.Build.Installed src/Stack/Build/Installed.hs:189:5)\n2016-01-10 04:30:53.668492: [debug] Ignoring package terminfo due to wanting version 0.4.0.2 instead of 0.4.0.1 @(stack_Jo7PUTL0uTIFJF98jKr0KI:Stack.Build.Installed src/Stack/Build/Installed.hs:189:5)\n2016-01-10 04:30:53.668681: [debug] Ignoring package Cabal due to wanting version 1.22.6.0 instead of 1.22.5.0 @(stack_Jo7PUTL0uTIFJF98jKr0KI:Stack.Build.Installed src/Stack/Build/Installed.hs:189:5)\n2016-01-10 04:30:53.669068: [debug] Run process: ghc-pkg --user --no-user-package-db --package-db /home/me/.stack/snapshots/x86_64-linux/lts-4.0/7.10.3/pkgdb dump --expand-pkgroot @(stack_Jo7PUTL0uTIFJF98jKr0KI:System.Process.Read src/System/Process/Read.hs:267:3)\n2016-01-10 04:30:53.756455: [debug] Run process: ghc-pkg --user --no-user-package-db --package-db /home/me/proj-web01/.stack-work/install/x86_64-linux/lts-4.0/7.10.3/pkgdb dump --expand-pkgroot @(stack_Jo7PUTL0uTIFJF98jKr0KI:System.Process.Read src/System/Process/Read.hs:267:3)\n2016-01-10 04:30:53.793549: [debug] Trying to decode /home/me/.stack/indices/Hackage/00-index.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:55:5)\n2016-01-10 04:30:54.256386: [debug] Success decoding /home/me/.stack/indices/Hackage/00-index.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:64:13)\n2016-01-10 04:30:54.590810: [debug] Run process: ghc-pkg --no-user-package-db list --global @(stack_Jo7PUTL0uTIFJF98jKr0KI:System.Process.Read src/System/Process/Read.hs:267:3)\n2016-01-10 04:30:54.622680: [debug] Trying to decode /home/me/.stack/indices/Hackage/00-index.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:55:5)\n2016-01-10 04:30:54.623042: [debug] Trying to decode /home/me/.stack/indices/Hackage/00-index.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:55:5)\n2016-01-10 04:30:54.691642: [debug] Trying to decode /home/me/.stack/indices/Hackage/00-index.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:55:5)\n2016-01-10 04:30:54.912320: [debug] Trying to decode /home/me/.stack/indices/Hackage/00-index.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:55:5)\n2016-01-10 04:30:54.952101: [debug] Trying to decode /home/me/.stack/indices/Hackage/00-index.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:55:5)\n2016-01-10 04:30:55.012247: [debug] Trying to decode /home/me/.stack/indices/Hackage/00-index.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:55:5)\n2016-01-10 04:30:55.092340: [debug] Trying to decode /home/me/.stack/indices/Hackage/00-index.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:55:5)\n2016-01-10 04:30:55.332220: [debug] Trying to decode /home/me/.stack/indices/Hackage/00-index.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:55:5)\n2016-01-10 04:30:55.451634: [debug] Trying to decode /home/me/.stack/indices/Hackage/00-index.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:55:5)\n2016-01-10 04:30:55.591685: [debug] Trying to decode /home/me/.stack/indices/Hackage/00-index.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:55:5)\n2016-01-10 04:30:55.755769: [debug] Trying to decode /home/me/.stack/indices/Hackage/00-index.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:55:5)\n2016-01-10 04:30:56.328004: [debug] Trying to decode /home/me/.stack/indices/Hackage/00-index.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:55:5)\n2016-01-10 04:30:56.492233: [debug] Trying to decode /home/me/.stack/indices/Hackage/00-index.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:55:5)\n2016-01-10 04:30:56.672429: [debug] Trying to decode /home/me/.stack/indices/Hackage/00-index.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:55:5)\n2016-01-10 04:30:56.872068: [debug] Trying to decode /home/me/.stack/indices/Hackage/00-index.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:55:5)\n2016-01-10 04:30:57.092262: [debug] Success decoding /home/me/.stack/indices/Hackage/00-index.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:64:13)\n2016-01-10 04:30:57.331815: [debug] Success decoding /home/me/.stack/indices/Hackage/00-index.cache @(stack_Jo7PUTL0uTIFJF98jKr0KI:Data.Binary.VersionTagged src/Data/Binary/VersionTagged.hs:64:13)\nProgress: 0/96Killed\n</code></pre>\n\n<p>I cannot see anything in these output messages which provides clues of what happens at the end <code>Progress: 0/96Killed</code>, no warnings, nothing... I searched for similar issues on the web but could not find any, and I'm stuck there.</p>\n\n<p><strong>My question:</strong> What should I look for, where else should I look at? Is there a test I should do to give me some idea of where the issue might come from? Thanks.  </p>\n\n<p><strong>== EDIT ==</strong>  </p>\n\n<p>In fact the issue is a lot simpler to reproduce : </p>\n\n<pre><code>me@user:~/proj-web00$ stack install yesod\nProgress: 0/95Killed\nme@user:~/proj-web00$ \n</code></pre>\n\n<p>installing other, smaller, packages works just fine (eg <code>stack install csv</code> ...)</p>\n\n<p>Following Sibi's advice I tried to increase the swap space on my VPS, but apparently that isn't allowed at user level (<a href=\"https://unix.stackexchange.com/a/2896\">U&amp;L discussion</a>). There are <a href=\"http://linux-problem-solver.blogspot.com/2013/08/create-fake-swap-in-openvz-vps-if-you-get-swapon-failed-operation-not-permitted-error.html\" rel=\"nofollow noreferrer\">hacks</a> around this restriction, but that does not seem to change anything while trying to install yesod. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 2, "creation_date": 1452427611, "post_id": 34704992, "comment_id": 57156127, "body": "You need to define you <code>data Heap = ... deriving (Show)</code>, see <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses\" rel=\"nofollow noreferrer\">learnyouahaskell.com/making-our-own-types-and-typeclasses</a>. Also, try to not make lines longer than 70 or 80 chars, and before a <code>where</code> is always a good place to make a newline."}, {"owner": {"reputation": 1859, "user_id": 463897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2a9d30a2487a924165aaaa016b54f87?s=128&d=identicon&r=PG", "display_name": "Olathe", "link": "https://stackoverflow.com/users/463897/olathe"}, "reply_to_user": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1452436155, "post_id": 34704992, "comment_id": 57158881, "body": "@mb21, can you please make this an answer?"}, {"owner": {"reputation": 17, "user_id": 5764299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221e62d703bdd55cd8040aa74b2959ff?s=128&d=identicon&r=PG", "display_name": "DiogoJDO", "link": "https://stackoverflow.com/users/5764299/diogojdo"}, "reply_to_user": {"reputation": 1859, "user_id": 463897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2a9d30a2487a924165aaaa016b54f87?s=128&d=identicon&r=PG", "display_name": "Olathe", "link": "https://stackoverflow.com/users/463897/olathe"}, "edited": false, "score": 0, "creation_date": 1452442466, "post_id": 34704992, "comment_id": 57161375, "body": "@Olathe data Heap a = Empty | Node a (Heap a) (Heap a)"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 5764299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221e62d703bdd55cd8040aa74b2959ff?s=128&d=identicon&r=PG", "display_name": "DiogoJDO", "link": "https://stackoverflow.com/users/5764299/diogojdo"}, "edited": false, "score": 0, "creation_date": 1452471613, "post_id": 34711662, "comment_id": 57171278, "body": "Hey thanks! And if you&#39;re taking the test tomorrow, good luck!"}], "tags": [], "owner": {"reputation": 26, "user_id": 5771162, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/2775001f78d137c8f6c157ee1ffef9e8?s=128&d=identicon&r=PG", "display_name": "JBB", "link": "https://stackoverflow.com/users/5771162/jbb"}, "is_accepted": true, "score": 1, "last_activity_date": 1452465827, "creation_date": 1452465827, "answer_id": 34711662, "question_id": 34704992, "link": "https://stackoverflow.com/questions/34704992/heap-exercise-in-haskell/34711662#34711662", "title": "Heap exercise in Haskell", "body": "<p>Here you go:</p>\n\n<pre><code>instance (Show a) =&gt; Show (Heap a) where\n    show (Empty) = \"Empty\"\n    show (Node x a b) = (\"Node \") ++ show x ++ (\" (\") ++ show a ++ (\") \") ++ (\"(\") ++ show b ++ (\")\")\n\nremoveMin :: Ord a =&gt; Heap a -&gt; (a,Heap a)\nremoveMin (Node a e d) = (a,build e d) where\n    build (Node a e d) (Node b e2 d2)\n        | (a &lt; b) = (Node a (build e d) (Node b e2 d2))\n        | otherwise = (Node b (Node a e d) (build e2 d2))\n    build a Empty = a\n    build Empty b = b\n</code></pre>\n\n<p>JBB is your friend</p>\n"}], "owner": {"reputation": 17, "user_id": 5764299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221e62d703bdd55cd8040aa74b2959ff?s=128&d=identicon&r=PG", "display_name": "DiogoJDO", "link": "https://stackoverflow.com/users/5764299/diogojdo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 34711662, "answer_count": 1, "score": 0, "last_activity_date": 1452465827, "creation_date": 1452426386, "last_edit_date": 1452428866, "question_id": 34704992, "link": "https://stackoverflow.com/questions/34704992/heap-exercise-in-haskell", "title": "Heap exercise in Haskell", "body": "<p>I've got this exercise where I've got to remove the minimum element from a Heap and return a tuple with (a,b) where a = the element removed and b = the new Heap.</p>\n\n<p>So where's my code</p>\n\n<pre><code>removeMin :: Ord a =&gt; Heap a -&gt; (a, Heap a)\nremoveMin (Node r (Node a b c) (Node x y z)) = (r, newHeap (Node a b c) (Node x y z))\n  where\n    newHeap Empty Empty = Empty\n    newHeap h Empty = h\n    newHeap Empty h = h\n    newHeap (Node a b c) (Node x y z) = (Node (min a x) (newHeap b c) (newHeap y z))\n</code></pre>\n\n<p>And I get this error code </p>\n\n<pre><code>No instance for (Show (Heap a0)) arising from a use of \u2018print\u2019\nIn the first argument of \u2018print\u2019, namely \u2018it\u2019\nIn a stmt of an interactive GHCi command: print it\n</code></pre>\n\n<p>when I try to do something like this</p>\n\n<pre><code> removeMin (Node 2 (Node 5 (Node 7 Empty Empty) (Node 9 Empty Empty)) (Node 10 (Node 13 Empty Empty) (Node 15 Empty Empty)))\n</code></pre>\n\n<p>This might be an easy problem, but I'm in my first year of Computer Science and Haskell is my first real coding experience so I'm sorry to bother with such simples questions, but I really appreciate the help. </p>\n"}, {"tags": ["haskell", "tuples"], "comments": [{"owner": {"reputation": 24791, "user_id": 499214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PObJM.png?s=128&g=1", "display_name": "John Dvorak", "link": "https://stackoverflow.com/users/499214/john-dvorak"}, "edited": false, "score": 0, "creation_date": 1452426324, "post_id": 34704920, "comment_id": 57155706, "body": "Any chance you&#39;re mixing tabs with spaces accidentally?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 24791, "user_id": 499214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PObJM.png?s=128&g=1", "display_name": "John Dvorak", "link": "https://stackoverflow.com/users/499214/john-dvorak"}, "edited": false, "score": 0, "creation_date": 1452426582, "post_id": 34704920, "comment_id": 57155791, "body": "@JanDvorak: this has nothing to do with tabs/spaces: note a pipe is placed after the <code>=</code>..."}, {"owner": {"reputation": 24791, "user_id": 499214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PObJM.png?s=128&g=1", "display_name": "John Dvorak", "link": "https://stackoverflow.com/users/499214/john-dvorak"}, "edited": false, "score": 0, "creation_date": 1452426719, "post_id": 34704920, "comment_id": 57155839, "body": "Oh well... Time to close as a brain typo, then"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1452427229, "post_id": 34705013, "comment_id": 57156010, "body": "The constructs introduced by <code>|</code> are simply called &quot;guards&quot;. <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/syntax-extns.html#pattern-guards\" rel=\"nofollow noreferrer\">Pattern guards</a> are a more advanced form of guards, which GHC implements as an extension."}, {"owner": {"reputation": 178, "user_id": 5635144, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cdad212c64e09721be44eb2adb694709?s=128&d=identicon&r=PG&f=1", "display_name": "naturesenshi", "link": "https://stackoverflow.com/users/5635144/naturesenshi"}, "edited": false, "score": 0, "creation_date": 1452427570, "post_id": 34705013, "comment_id": 57156118, "body": "Ah, thank you. May I ask why the &quot;dm&quot; ? Win hugs is now displaying a new error message:  Type error in application *** Expression     : dm mod 60 *** Term           : dm *** Type           : Int *** Does not match : a -&gt; b -&gt; c"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1452427614, "post_id": 34705013, "comment_id": 57156129, "body": "<code>dm</code> stands for <i>days modulo</i>. It is simply used as an intermediate result for <code>h</code> and <code>m</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 178, "user_id": 5635144, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cdad212c64e09721be44eb2adb694709?s=128&d=identicon&r=PG&f=1", "display_name": "naturesenshi", "link": "https://stackoverflow.com/users/5635144/naturesenshi"}, "edited": false, "score": 0, "creation_date": 1452427664, "post_id": 34705013, "comment_id": 57156148, "body": "@naturesenshi: that was a small error in the first version. Please use the version edited six minutes ago."}, {"owner": {"reputation": 178, "user_id": 5635144, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cdad212c64e09721be44eb2adb694709?s=128&d=identicon&r=PG&f=1", "display_name": "naturesenshi", "link": "https://stackoverflow.com/users/5635144/naturesenshi"}, "edited": false, "score": 1, "creation_date": 1452428048, "post_id": 34705013, "comment_id": 57156267, "body": "Ah great!! Thank you!! Works a charm!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1452427267, "last_edit_date": 1452427267, "creation_date": 1452426533, "answer_id": 34705013, "question_id": 34704920, "link": "https://stackoverflow.com/questions/34704920/error-in-haskell-code-containing-tuples/34705013#34705013", "title": "Error in Haskell code containing tuples", "body": "<p>The pipe (<code>|</code>) is used as a <em>guard</em>, what you need is a <code>where</code> clause I think:</p>\n\n<pre><code>dayshoursmins :: Int-&gt;(Int,Int,Int)\ndayshoursmins n = (d,h,m)\n    where d = div n 1440\n          dm = mod n 1440\n          h = div dm 60\n          m = mod dm 60\n</code></pre>\n\n<p>Running this with <code>ghci</code> gives:</p>\n\n<pre><code>*Main&gt; dayshoursmins 2016\n(1,9,36)\n</code></pre>\n\n<p>I don't really understand your code: it does seem to mix all kinds of concepts. After the <code>=</code> operator, you cannot put <em>guards</em> anymore.</p>\n"}], "owner": {"reputation": 178, "user_id": 5635144, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cdad212c64e09721be44eb2adb694709?s=128&d=identicon&r=PG&f=1", "display_name": "naturesenshi", "link": "https://stackoverflow.com/users/5635144/naturesenshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 34705013, "answer_count": 1, "score": 0, "last_activity_date": 1452427267, "creation_date": 1452425932, "last_edit_date": 1452427251, "question_id": 34704920, "link": "https://stackoverflow.com/questions/34704920/error-in-haskell-code-containing-tuples", "title": "Error in Haskell code containing tuples", "body": "<p>I have been trying to create a function in Haskell that will take a non-negative value which corresponds to minutes and return it in the format (days,hours,minutes) e.g. 4000 minutes will give (2, 18, 39). </p>\n\n<p>My code keeps returning the error \"<code>file:.\\prac0.hs:27 - Syntax error in input (unexpected `|')</code>\" on load.</p>\n\n<p>Here is my code: </p>\n\n<pre><code>dayshoursmins :: Int-&gt;(Int,Int,Int)\ndayshoursmins n = (x,y,z)\n    | n==0 = 0  \n    | n`div`1440 =&gt;1 = x &amp;&amp; dayshoursmins(n`mod`1440)\n    | n`div`60 &lt; 24 = y &amp;&amp; dayshoursmins(n`mod`60)\n    | n &lt; 60 = z\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": true, "score": 6, "last_activity_date": 1452421701, "creation_date": 1452421701, "answer_id": 34704368, "question_id": 34704261, "link": "https://stackoverflow.com/questions/34704261/algebraic-data-type-in-haskell/34704368#34704368", "title": "Algebraic Data Type in Haskell", "body": "<p>You can use, e.g.,</p>\n\n<pre><code>data BinOp = Add | Mul\ndata UnaryOp = Sin | Cos\n\ndata Expr\n  = Num Double\n  | Binary BinOp Expr Expr\n  | Unary UnaryOp Expr\n</code></pre>\n\n<p>YMMV on whether this is simpler.</p>\n"}], "owner": {"reputation": 13, "user_id": 5769346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cfe71bca3ae67de75fd4501c5c7f62d?s=128&d=identicon&r=PG&f=1", "display_name": "V. Kalle", "link": "https://stackoverflow.com/users/5769346/v-kalle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 34704368, "answer_count": 1, "score": 1, "last_activity_date": 1452426466, "creation_date": 1452420870, "last_edit_date": 1452426466, "question_id": 34704261, "link": "https://stackoverflow.com/questions/34704261/algebraic-data-type-in-haskell", "title": "Algebraic Data Type in Haskell", "body": "<p>I'm trying to write a simple data type for mathematical expressions. The code I have right now is:</p>\n\n<pre><code>data Expr\n  = Num Double\n  | Add Expr Expr\n  | Mul Expr Expr\n  | Sin Expr\n  | Cos Expr\n  | X\n  deriving Eq\n</code></pre>\n\n<p>This works as expected but I want to make it simpler with only one line for binary operators (Add and Mul) and one for unary operators (Sin and Cos). Any suggestions?</p>\n"}, {"tags": ["haskell", "ghc", "ffi", "haskell-stack"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1452420368, "post_id": 34703265, "comment_id": 57154123, "body": "Can you increase verbosity of the build? LD_LIBRARY_PATH has nothing to do with linking and only adds confusion. I recommend using <code>-rpath</code> instead. Your linker command needs to get <code>-L &#47;usr&#47;local&#47;lib</code> but this doesn&#39;t seem to happen."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1452422356, "post_id": 34703265, "comment_id": 57154647, "body": "A guess: <code>stack build --extra-lib-dirs=&#47;usr&#47;local&#47;lib</code>. Does that work ?"}, {"owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1452425731, "post_id": 34703265, "comment_id": 57155544, "body": "@n.m and Sibi thanks for your suggestions. I tried as recommended but without success. But I finally got to the bottom of it : I needed to add an extra library dependency, which I&#39;ll describe in an edit."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1452434798, "post_id": 34703265, "comment_id": 57158452, "body": "Hmm. &quot;needed to add an extra library dependency&quot; \u2014 that&#39;s what I thought initially and commented to that effect. Deleted the comment because something about it seemed wrong."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 3, "creation_date": 1452437991, "post_id": 34703265, "comment_id": 57159552, "body": "Why don&#39;t you answer the question yourself instead of the edit ?"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1457747665, "post_id": 34703265, "comment_id": 59561827, "body": "@JeanAnthelme you should post the solution you found as an answer and accept it so this question falls out of the &quot;unanswered&quot; queue."}], "owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 553, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1452842432, "creation_date": 1452412237, "last_edit_date": 1495541805, "question_id": 34703265, "link": "https://stackoverflow.com/questions/34703265/haskell-stack-and-c-libraries-ii", "title": "Haskell Stack and C Libraries II", "body": "<p>This is a follow-up of <a href=\"https://stackoverflow.com/questions/34701443/haskell-stack-and-c-libraries/34702095#34702095\">this post</a> (unfortunately).</p>\n\n<p>I am trying to <code>stack build</code> a project where <code>Main.hs</code> has some FFI calls to a proprietary C library, <code>libMyLib.so</code>, located in <code>/usr/local/lib</code> (which is included in <code>LD_LIBRARY_PATH</code>).  </p>\n\n<p>When run in GHCi (outside <code>stack</code>) with the command <code>ghci /usr/local/lib/ -lMyLib</code>, everything works fine. </p>\n\n<p>However when running <code>stack build</code>, I have a linking-related issue :  </p>\n\n<pre><code>me@user:~/myproject$ stack build\n\nmyproject-0.1.0.0: build\nPreprocessing library myproject-0.1.0.0...\nIn-place registering myproject-0.1.0.0...\nPreprocessing executable 'myproject-exe' for myproject-0.1.0.0...\nLinking .stack-work/dist/x86_64-linux/Cabal-1.22.5.0/build/myproject-exe/myproject-exe ...\n/usr/bin/ld: .stack-work/dist/x86_64-linux/Cabal-1.22.5.0/build/myproject-exe/myproject-exe-tmp/Main.o: undefined reference to symbol 'mycfunction'\n/usr/local/lib/libMyLib.so.2: error adding symbols: DSO missing from command line\ncollect2: error: ld returned 1 exit status\n\n--  While building package myproject-0.1.0.0 using:\n      /home/me/.stack/setup-exe-cache/x86_64-linux/setup-Simple-Cabal-1.22.5.0-ghc-7.10.3 --builddir=.stack-work/dist/x86_64-linux/Cabal-1.22.5.0 build lib:myproject exe:myproject-exe --ghc-options \" -ddump-hi -ddump-to-file\"\n    Process exited with code: ExitFailure 1\n</code></pre>\n\n<p>Here is an extra of the associated cabal file: </p>\n\n<pre><code>library\n  hs-source-dirs:      src\n  exposed-modules:     Lib\n  build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5\n  default-language:    Haskell2010\n  extra-libraries:     MyLib\n\nexecutable myproject-exe\n  hs-source-dirs:      app\n  main-is:             Main.hs\n  ghc-options:         -threaded -rtsopts -with-rtsopts=-N\n  build-depends:       base, bytestring, safe, split\n                     , myproject\n  default-language:    Haskell2010\n</code></pre>\n\n<p>Running <code>stack exec env</code> shows that the <code>LD_LIBRARY_PATH</code> points to the right directory (<code>LD_LIBRARY_PATH=/usr/local/lib</code>), and just to make sure I have added this directory to the <code>.yaml</code> file (<code>extra-lib-dirs: [/usr/local/lib]</code>).</p>\n\n<p>I have played with various GCC compile options, e.g. <code>-pthread</code> instead of <code>-threaded</code>..., via the <code>.cabal</code> file parameters or directly via <code>stack build</code> (<code>stack build --ghc-options=\"-foo...\"</code>), but to no avail.</p>\n\n<p><strong>My question:</strong> where else should I look? What kind of test should I run to find the origin of the issue (apparent linking problem)?  </p>\n\n<p>== EDIT ==<br>\nThere were two versions of the same C library installed, and one has a dependency on another C library, say <code>libOther.so</code>. \nWhen I finally realized that, I added it to the cabal file and that worked fine :  </p>\n\n<pre><code>extra-libraries:     Other, MyLib\n</code></pre>\n"}, {"tags": ["haskell", "ffi", "haskell-stack"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1452397850, "post_id": 34701443, "comment_id": 57149818, "body": "I think it should just be <code>extra-libraries: MyLib</code>"}, {"owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1452399269, "post_id": 34701443, "comment_id": 57150047, "body": "@Reid Barton. That worked! Now I run into an ugly <code>&#47;usr&#47;local&#47;lib&#47;libMyLib.so.2: error adding symbols: DSO missing from command line</code> but that&#39;s a problem independent of the original post that I&#39;ll have to handle separately. Please post your answer and I&#39;ll accept it. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 5, "last_activity_date": 1452400509, "creation_date": 1452400509, "answer_id": 34702095, "question_id": 34701443, "link": "https://stackoverflow.com/questions/34701443/haskell-stack-and-c-libraries/34702095#34702095", "title": "Haskell Stack and C Libraries", "body": "<p><code>extra-libraries</code> should have just the base library name, so use <code>extra-libraries: MyLib</code>.</p>\n"}], "owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2102, "favorite_count": 1, "accepted_answer_id": 34702095, "answer_count": 1, "score": 11, "last_activity_date": 1452400509, "creation_date": 1452393628, "last_edit_date": 1495540000, "question_id": 34701443, "link": "https://stackoverflow.com/questions/34701443/haskell-stack-and-c-libraries", "title": "Haskell Stack and C Libraries", "body": "<p>This is possibly a duplicate of <a href=\"https://stackoverflow.com/questions/34267376/haskell-missing-c-library-on-arch-linux-works-on-ubuntu\">this post</a>. But the only answer it got does not seem to work for me, so I post my own case here hoping to find a specific solution. I am on Linux Ubuntu Trusty.</p>\n\n<p>I have a proprietary C library, libMyLib.so, located in /usr/local/lib (which is included in LD_LIBRARY_PATH). </p>\n\n<p>I wrote the haskell bindings to this C library the ususal way. Main.hs :</p>\n\n<pre><code>{-# LANGUAGE ForeignFunctionInterface #-}\n\nmodule Main where\n\nimport Foreign\nimport Foreign.C.Types\n\nforeign import ccall safe \"mycfunction\" c_myCfunction :: CInt -&gt; IO (CInt)\n-- etc...\n\nmain = do -- ...\n</code></pre>\n\n<p>I can test this program with ghci, passing it the library and the directory where it can find it : <code>ghci /usr/local/lib/ -lMyLib</code> and it works just fine. </p>\n\n<p>Now, independently, I am trying to start using stack, and following <a href=\"http://docs.haskellstack.org/en/stable/GUIDE.html\" rel=\"nofollow noreferrer\">this guide</a> I was able to build several non-trivial program examples. </p>\n\n<p>However, I am not able to stack-build the FFI Main.hs program above as it complains about the missing C library :</p>\n\n<p><strong>First try :</strong><br>\n<code>me@user:~/myProject$ stack build</code></p>\n\n<pre><code>myProject-0.1.0.0: configure\nConfiguring myProject-0.1.0.0...\nmyProject-0.1.0.0: build\nPreprocessing library myProject-0.1.0.0...\nIn-place registering myProject-0.1.0.0...\nPreprocessing executable 'myProject-exe' for myProject-0.1.0.0...\nLinking .stack-work/dist/x86_64-linux/Cabal-1.22.5.0/build/myProject-exe/myProject-exe ...\n.stack-work/dist/x86_64-linux/Cabal-1.22.5.0/build/myProject-exe/myProject-exe-tmp/MyModule.o: In function `c8QI_info':\n(.text+0x102b): undefined reference to `MyModule_mycfunction'\ncollect2: error: ld returned 1 exit status\n\n--  While building package myProject-0.1.0.0 using:\n      /home/me/.stack/setup-exe-cache/x86_64-linux/setup-Simple-Cabal-1.22.5.0-ghc-7.10.3 --builddir=.stack-work/dist/x86_64-linux/Cabal-1.22.5.0 build lib:myProject exe:myProject-exe --ghc-options \" -ddump-hi -ddump-to-file\"\n    Process exited with code: ExitFailure 1\n</code></pre>\n\n<p>Before the 2nd try, I did add the following :<br>\n- added <code>extra-lib-dirs: [/usr/local/lib]</code> to the stack.yaml file.<br>\n- added <code>extra-include-dirs: [/usr/local/lib]</code> to the stack.yaml file (although it's probably not needed).<br>\n- added <code>extra-libraries: lMyLib</code> in the project's cabal file under the labels executable or library (I also tried <code>extra-libraries: libMyLib.so</code> witht the same result).  </p>\n\n<p><strong>Second try :</strong><br>\n<code>me@user:~/myProject$ stack build</code></p>\n\n<pre><code>myProject-0.1.0.0: configure\nConfiguring myProject-0.1.0.0...\nsetup-Simple-Cabal-1.22.5.0-ghc-7.10.3: Missing dependency on a foreign\nlibrary:\n* Missing C library: lMyLib\nThis problem can usually be solved by installing the system package that\nprovides this library (you may need the \"-dev\" version). If the library is\nalready installed but in a non-standard location then you can use the flags\n--extra-include-dirs= and --extra-lib-dirs= to specify where it is.\n\n--  While building package myProject-0.1.0.0 using:\n      /home/me/.stack/setup-exe-cache/x86_64-linux/setup-Simple-Cabal-1.22.5.0-ghc-7.10.3 --builddir=.stack-work/dist/x86_64-linux/Cabal-1.22.5.0 configure --with-ghc=/home/me/.stack/programs/x86_64-linux/ghc-7.10.3/bin/ghc --with-ghc-pkg=/home/me/.stack/programs/x86_64-linux/ghc-7.10.3/bin/ghc-pkg --user --package-db=clear --package-db=global --package-db=/home/me/.stack/snapshots/x86_64-linux/lts-4.0/7.10.3/pkgdb --package-db=/home/me/myProject/.stack-work/install/x86_64-linux/lts-4.0/7.10.3/pkgdb --libdir=/home/me/myProject/.stack-work/install/x86_64-linux/lts-4.0/7.10.3/lib --bindir=/home/me/myProject/.stack-work/install/x86_64-linux/lts-4.0/7.10.3/bin --datadir=/home/me/myProject/.stack-work/install/x86_64-linux/lts-4.0/7.10.3/share --libexecdir=/home/me/myProject/.stack-work/install/x86_64-linux/lts-4.0/7.10.3/libexec --sysconfdir=/home/me/myProject/.stack-work/install/x86_64-linux/lts-4.0/7.10.3/etc --docdir=/home/me/myProject/.stack-work/install/x86_64-linux/lts-4.0/7.10.3/doc/myProject-0.1.0.0 --htmldir=/home/me/myProject/.stack-work/install/x86_64-linux/lts-4.0/7.10.3/doc/myProject-0.1.0.0 --haddockdir=/home/me/myProject/.stack-work/install/x86_64-linux/lts-4.0/7.10.3/doc/myProject-0.1.0.0 --dependency=base=base-4.8.2.0-0d6d1084fbc041e1cded9228e80e264d --dependency=bytestring=bytestring-0.10.6.0-9a873bcf33d6ce2fd2698ce69e2c1c66 --dependency=safe=safe-0.3.9-e3aa437cf6afe091d2ac3ab91bc10ddd --dependency=split=split-0.2.2-10f39ee49f650eefddf38af51b65d10a --extra-include-dirs=/usr/local/lib --extra-lib-dirs=/usr/local/lib --enable-tests --enable-benchmarks\n    Process exited with code: ExitFailure 1\n</code></pre>\n\n<p>So now it knows which C library it needs, since it complained about it, while the right extra library directory has been added (see the very end of the error message). I am not sure if the comment <code>(you may need the \"-dev\" version)</code> is relevant or not here.</p>\n\n<p><strong>My Question :</strong> I'm stuck here. Is there anything else I should do to the yaml or the cabal files, or elsewhere, so that <code>stack build</code> finds the C library?</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1452402203, "post_id": 34701107, "comment_id": 57150518, "body": "You can probably coax cabal into getting to to step 1 almost by itself by passing the correct ghc-options; for the rest you will probably have to write your own <code>postBuildHook</code>. You probably already have a bash script or the like to do this - your hook can just call this script. There isn&#39;t much finesse at this level, I think - cabal hooks are a big hammer."}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1452390321, "creation_date": 1452390321, "question_id": 34701107, "link": "https://stackoverflow.com/questions/34701107/customising-cabal-libraries-i-think", "title": "Customising Cabal libraries (I think?)", "body": "<p>Perhaps it's just better to describe my problem.</p>\n\n<p>I'm developing a Haskell library. But part of the library is written in C, and another part actually in raw LLVM. To actually get GHC to spit out the code I want I have to follow this process:</p>\n\n<ol>\n<li>Run <code>ghc -emit-llvm</code> on both the code that uses the Haskell module and the \"Main\" module.  </li>\n<li>Run <code>clang -emit-llvm</code> on the C file</li>\n<li>Now I've got three <code>.ll</code> files from above. I add the part of the library I've handwritten in raw LLVM and <code>llvm-link</code> these into one <code>.ll</code> file.</li>\n<li>I then run LLVM's <code>opt</code> on the linked file.</li>\n<li>Lastly, I feed the LLVM bitcode fileback into GHC (which pleasantly accepts it) and produces an executable. </li>\n</ol>\n\n<p>This process (with appropriate optimisation settings of course) seems to be the only way I can inline code from C, removing the function call overhead. Since many of these C functions are very small this is significant.</p>\n\n<p>Anyway, I want to be able to distribute the library and for users to be able to use it as painlessly as possible, whilst still gaining the optimisations from the process above. I understand it's going to be a bit more of a pain than an ordinary library (for example, you're forced to compile via LLVM) but as <em>painlessly</em> as possible is what I'm looking for advice for.</p>\n\n<p>Any guidance will be appreciated, I don't expect a step by step answer because I think it will be complex, but just some ideas would be helpful.</p>\n"}, {"tags": ["haskell", "types", "type-inference", "function-composition", "combinators"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1452395585, "post_id": 34701011, "comment_id": 57149356, "body": "You might like the &quot;semantic editor combinators&quot; view of function composition, where we rename <code>(.)</code> to <code>result</code>. The intuition given in <a href=\"http://conal.net/blog/posts/semantic-editor-combinators\" rel=\"nofollow noreferrer\">this post</a> is quite nice, and in my opinion makes it quite clear why stacking compositions of <code>(.)</code> results in the types it does."}, {"owner": {"reputation": 73, "user_id": 1911378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cd8c04a89876264a14d0373979f1855?s=128&d=identicon&r=PG", "display_name": "Xiaogang Liu", "link": "https://stackoverflow.com/users/1911378/xiaogang-liu"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1452399239, "post_id": 34701011, "comment_id": 57150043, "body": "@DanielWagner, thanks for the link. I&#39;ll read it soon. Actually I was about to google &#39;semantic editor combinators&#39; as Edward mentioned it a lot in the talk."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 1911378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cd8c04a89876264a14d0373979f1855?s=128&d=identicon&r=PG", "display_name": "Xiaogang Liu", "link": "https://stackoverflow.com/users/1911378/xiaogang-liu"}, "edited": false, "score": 1, "creation_date": 1452399093, "post_id": 34701189, "comment_id": 57150020, "body": "Thanks for the beautiful answer. It answers both of my questions:)."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 9, "last_activity_date": 1503000749, "last_edit_date": 1503000749, "creation_date": 1452391241, "answer_id": 34701189, "question_id": 34701011, "link": "https://stackoverflow.com/questions/34701011/how-to-manually-infer-the-type-of/34701189#34701189", "title": "How to manually infer the type of &#39;(.) . (.) . (.)&#39;?", "body": "<p>With  functions,</p>\n\n<pre><code>instance Functor ((-&gt;) r) where\n   -- fmap :: (a -&gt; b) -&gt;   f   a  -&gt;   f   b\n   --         (a -&gt; b) -&gt; (r -&gt; a) -&gt; (r -&gt; b)\n   fmap          p           q         x = p (q x)   -- fmap = (.)\n</code></pre>\n\n<p>so what you actually have is <code>fmap . fmap . fmap</code>:</p>\n\n<pre><code>fmap               :: (a -&gt; b) -&gt; f       a   -&gt; f       b\nfmap . fmap        :: (a -&gt; b) -&gt; f (g    a)  -&gt; f (g    b)\nfmap . fmap . fmap :: (a -&gt; b) -&gt; f (g (h a)) -&gt; f (g (h b))\n</code></pre>\n\n<p>which is</p>\n\n<pre><code> (a -&gt; b) -&gt; (c -&gt; (d -&gt; (e -&gt; a))) -&gt; (c -&gt; (d -&gt; (e -&gt; b)))   ~\n (a -&gt; b) -&gt; (c -&gt;  d -&gt;  e -&gt; a)   -&gt; (c -&gt;  d -&gt;  e -&gt; b)     \n</code></pre>\n\n<p>Why is <code>fmap . fmap :: (a -&gt; b) -&gt; f (g    a)  -&gt; f (g    b)</code>? Because,</p>\n\n<pre><code>(fmap . fmap) foo = fmap (fmap foo)\n{-\nfmap            :: (a  -&gt;  b) -&gt; f a     -&gt; f b\nfoo             ::  a  -&gt;  b\nfmap foo        ::               f a     -&gt; f b\nfmap foo        :: g a -&gt; g b\nfmap (fmap foo) ::               f (g a) -&gt; f (g b)\n-}\n</code></pre>\n\n<p>Mechanical type derivation is all about substitution and consistent renaming of type variables. See more e.g. <a href=\"https://stackoverflow.com/a/23316814/849891\">here</a> or <a href=\"https://stackoverflow.com/search?q=user%3A849891+mechanically\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 1911378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cd8c04a89876264a14d0373979f1855?s=128&d=identicon&r=PG", "display_name": "Xiaogang Liu", "link": "https://stackoverflow.com/users/1911378/xiaogang-liu"}, "edited": false, "score": 0, "creation_date": 1452413018, "post_id": 34702740, "comment_id": 57152486, "body": "Thanks! That is what I initially tried to achieve. If I could mark two correct answers, I would mark you answer as correct too."}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": false, "score": 8, "last_activity_date": 1452407163, "creation_date": 1452407163, "answer_id": 34702740, "question_id": 34701011, "link": "https://stackoverflow.com/questions/34701011/how-to-manually-infer-the-type-of/34702740#34702740", "title": "How to manually infer the type of &#39;(.) . (.) . (.)&#39;?", "body": "<p><code>(.) . (.) . (.)</code> reduces in two steps: first reduce dots without parentheses around:</p>\n\n<pre><code>((.) . (.) . (.)) f = (.) ((.) ((.) f))\n                    = (.) ((.) (f .))\n                    = (.) ((f .) .)\n                    = ((f .) .) .)\n</code></pre>\n\n<p>second reduce the remaining expression</p>\n\n<pre><code>((f .) .) .) g = ((f .) .) . g\n               = \\x -&gt; ((f .) .) (g x)\n               = \\x -&gt; (f .) . g x\n               = \\x y -&gt; (f .) (g x y)\n               = \\x y -&gt; f . g x y\n               = \\x y z -&gt; f (g x y z)\n</code></pre>\n\n<p>So first you compose <code>n</code> dots in parentheses using <code>n - 1</code> dots. Then you apply this construction to functions <code>f :: a -&gt; b</code> and <code>g</code> and get <code>(...((f .) .) ... .) g</code> where each dot corresponds to an argument that <code>g</code> receives \u2014 that's why there is a pattern: each dot in parentheses handles one argument of <code>g</code> and you need another dot to compose this dot with all previous. After all reductions the expression becomes</p>\n\n<pre><code>\\x1 x2 ... xn -&gt; f (g x1 x2 ... xn)\n</code></pre>\n\n<p>and its type is obvious.</p>\n\n<hr>\n\n<p>One nice thing is that if we would have postfix operators we could write (the code is in Agda)</p>\n\n<pre><code>open import Function renaming (_\u2218\u2032_ to _\u2218_) using ()\n\n_% = _\u2218_\n\npostulate\n  a b c d e : Set\n  f : a -&gt; b\n  g : c -&gt; d -&gt; e -&gt; a\n\nfg : c -&gt; d -&gt; e -&gt; b\nfg = f % % \u2218 g\n</code></pre>\n\n<p>instead of <code>((f .) .) . g</code>.</p>\n"}], "owner": {"reputation": 73, "user_id": 1911378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cd8c04a89876264a14d0373979f1855?s=128&d=identicon&r=PG", "display_name": "Xiaogang Liu", "link": "https://stackoverflow.com/users/1911378/xiaogang-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 1, "accepted_answer_id": 34701189, "answer_count": 2, "score": 7, "last_activity_date": 1503000749, "creation_date": 1452389313, "last_edit_date": 1452419031, "question_id": 34701011, "link": "https://stackoverflow.com/questions/34701011/how-to-manually-infer-the-type-of", "title": "How to manually infer the type of &#39;(.) . (.) . (.)&#39;?", "body": "<p>In Edward Kmett's talk <a href=\"https://youtu.be/cefnmjtAolY?t=496\" rel=\"nofollow\">Lenses, Folds, and Traversals</a>, on the slide \"The Power is in the Dot\", he shows the type of <code>(.) . (.) . (.)</code> is </p>\n\n<p><code>(a -&gt; b) -&gt; (c -&gt; d -&gt; e -&gt; a) -&gt; c -&gt; d -&gt; e -&gt; b</code></p>\n\n<p>I can see it by showing its type in GHCI. But I'd also like to know why. The other thing I'd like to understand is why there's the pattern in the regular change of parameters from <code>(.)</code> to <code>(.) . (.)</code> and <code>(.) . (.) . (.)</code>:</p>\n\n<pre><code>(.)             :: (a -&gt; b) -&gt; (c -&gt;           a) -&gt; c -&gt;           b\n(.) . (.)       :: (a -&gt; b) -&gt; (c -&gt; d -&gt;      a) -&gt; c -&gt; d -&gt;      b\n(.) . (.) . (.) :: (a -&gt; b) -&gt; (c -&gt; d -&gt; e -&gt; a) -&gt; c -&gt; d -&gt; e -&gt; b\n</code></pre>\n\n<p>P.S. I tried to resolve <code>(.) . (.)</code> myself by expanding the function definition of <code>(.) . (.)</code>. After applying the definition of <code>(.)</code> I got:</p>\n\n<pre><code>\\x y z t -&gt; x ((y z) t)\n</code></pre>\n\n<p>So I inferred the types:</p>\n\n<pre><code>x :: a -&gt; b\ny :: c -&gt; d -&gt; a\nz :: c\nt :: d\n</code></pre>\n\n<p>However I got lost on <code>(.) . (.) . (.)</code>. And I don't know if this is the right way to do manual type inference.</p>\n"}, {"tags": ["haskell", "random", "monads", "type-signature"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 5, "creation_date": 1452384445, "post_id": 34700457, "comment_id": 57147016, "body": "You can&#39;t. The whole point of the <code>IO</code> type is to prevent you from being able to do this. If you <i>could</i>, it would break your programs. You should instead ask how to use <code>getNums :: IO [Int]</code> in a way that lets you work with the <code>[Int]</code> value it computes in your other functions. This is what the <code>Monad</code> and <code>Functor</code> typeclass methods are for."}, {"owner": {"reputation": 8858, "user_id": 186026, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/q1xfe.png?s=128&g=1", "display_name": "fjarri", "link": "https://stackoverflow.com/users/186026/fjarri"}, "edited": false, "score": 0, "creation_date": 1452385353, "post_id": 34700457, "comment_id": 57147239, "body": "If you are feeling adventurous, you can use <a href=\"https://hackage.haskell.org/package/base-4.0.0.0/docs/System-IO-Unsafe.html\" rel=\"nofollow noreferrer\"><code>unsafePerformIO</code></a>. Note the <b>unsafe</b> bit."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 5, "creation_date": 1452385402, "post_id": 34700457, "comment_id": 57147247, "body": "Please don&#39;t recommend <code>unsafePerformIO</code> to someone who doesn&#39;t understand the dangerous ramifications of its use or the idiomatic way of writing Haskell without it. It is harmful."}, {"owner": {"reputation": 8858, "user_id": 186026, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/q1xfe.png?s=128&g=1", "display_name": "fjarri", "link": "https://stackoverflow.com/users/186026/fjarri"}, "edited": false, "score": 0, "creation_date": 1452385565, "post_id": 34700457, "comment_id": 57147287, "body": "That&#39;s why it&#39;s not an answer. I&#39;m not recommending it, I&#39;m making OP aware of its existence. Sweeping dust under the rug never helped anyone \u2014 this function exists and is a part of the standard library."}, {"owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "edited": false, "score": 1, "creation_date": 1452385570, "post_id": 34700457, "comment_id": 57147288, "body": "I&#39;d much rather learn to do it the right way"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 8858, "user_id": 186026, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/q1xfe.png?s=128&g=1", "display_name": "fjarri", "link": "https://stackoverflow.com/users/186026/fjarri"}, "edited": false, "score": 0, "creation_date": 1452385640, "post_id": 34700457, "comment_id": 57147304, "body": "@fjarri This is akin to saying &quot;You can also point your gun at your foot and pull the trigger.&quot; Asking you not to suggest this is not &quot;sweeping dust under the rug&quot;. It is harmful to suggest it and helpful to not do so."}, {"owner": {"reputation": 8858, "user_id": 186026, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/q1xfe.png?s=128&g=1", "display_name": "fjarri", "link": "https://stackoverflow.com/users/186026/fjarri"}, "edited": false, "score": 1, "creation_date": 1452386009, "post_id": 34700457, "comment_id": 57147380, "body": "Once again, it&#39;s not an advice, it&#39;s a bit of relevant information that can be of interest and provide some educational value (if he encounters some problems while using it). I very much doubt that OP is writing production code, so your analogy with the gun is not applicable here."}], "answers": [{"comments": [{"owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "edited": false, "score": 0, "creation_date": 1452384882, "post_id": 34700489, "comment_id": 57147133, "body": "Perhaps I should add context.  I&#39;m making a CLI sudoku generator that puts out a random board.  Is it more Haskellian to 1) prompt the user for explicit random input, or 2) pass around <code>IO Type</code> throughout the code?"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "edited": false, "score": 0, "creation_date": 1452384918, "post_id": 34700489, "comment_id": 57147143, "body": "@MarkKaravan False dichotomy. It is more Haskellian to do neither of those things. See my answer for the alternative."}, {"owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "edited": false, "score": 0, "creation_date": 1452385066, "post_id": 34700489, "comment_id": 57147177, "body": "@Erik Allik: can you provide an example of passing in randomness in from a high level point in your code hierarchy that lives in IO?"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1452388362, "post_id": 34700489, "comment_id": 57147921, "body": "I was typing on the phone... a bit too tedious a way to write code snippets on a saturday night. Rein already got ahead of me and did a perfect job."}], "tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 2, "last_activity_date": 1452384782, "last_edit_date": 1452384782, "creation_date": 1452384623, "answer_id": 34700489, "question_id": 34700457, "link": "https://stackoverflow.com/questions/34700457/getting-random-numbers-from-non-monadic-functions/34700489#34700489", "title": "Getting random numbers from non-monadic functions", "body": "<p>The purpose of IO is exactly to not allow side effects in pure code. All nonpure code must run in the IO monad. Randomness is also based on state, or reading from an external resource (global state). So what you are attempting is impossible without hacks. And I would strongly urge you to not use any hacks. Such hacks completely bypass the safety offered by the type system; they should only be limited to localized, safe hacks, primarily when the type system isn't smart enogh and needs some convincing. But that's not the case here \u2014 making a pure function deliberately behave like a non-pure one is very much not a localized hack as any code that calls it will inherit the broken semantics with no way for keeping track of where purity ends and non-purity begins. </p>\n\n<p>It's best if you redesign your code to not need to generate random numbers in pure code. Just pass the randomness in from a high level point in your code hierarchy that lives in IO. </p>\n"}, {"comments": [{"owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "edited": false, "score": 0, "creation_date": 1452385478, "post_id": 34700534, "comment_id": 57147266, "body": "That helps.  I&#39;m going to have to think about how to work this into my code, but I see where this is going now."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "edited": false, "score": 1, "creation_date": 1452424662, "post_id": 34700534, "comment_id": 57155245, "body": "@MarkKaravan A simple way of looking at it: You don&#39;t get the data out of IO and send it to your functions. Your top level glue code uses monad combinators to push the pure functions <i>into</i> the IO monad to operate on the data where it lives. (Or write do blocks, which is syntactic sugar for doing that)."}], "tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": true, "score": 4, "last_activity_date": 1452385062, "creation_date": 1452385062, "answer_id": 34700534, "question_id": 34700457, "link": "https://stackoverflow.com/questions/34700457/getting-random-numbers-from-non-monadic-functions/34700534#34700534", "title": "Getting random numbers from non-monadic functions", "body": "<p>You can't, shouldn't, and don't need to do this.</p>\n\n<p>You claim that all functions which use <code>getNums :: IO [Int]</code> must have <code>IO</code> in their type. This is simply not true. You can work with the <code>[Int]</code> value that the <code>IO [Int]</code> action computes in a number of ways, for example:</p>\n\n<pre><code>main = do\n  ints &lt;- getNums -- ints is now of type [Int]\n  return (map (+1) ints) -- map (+1) does not have IO in its type.\n</code></pre>\n\n<p>This is one of the reasons that the <code>Functor</code>, <code>Applicative</code>, and <code>Monad</code> typeclasses were introduced: to provide a consistent way to work with things like <code>IO [Int]</code> when you want to avoid dealing with <code>IO</code> everywhere.</p>\n"}], "owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 2, "accepted_answer_id": 34700534, "answer_count": 2, "score": 0, "last_activity_date": 1452385062, "creation_date": 1452384298, "question_id": 34700457, "link": "https://stackoverflow.com/questions/34700457/getting-random-numbers-from-non-monadic-functions", "title": "Getting random numbers from non-monadic functions", "body": "<p>So my goal is to be able to call a non-monadic function and have it return a random value.</p>\n\n<pre><code>getNums :: [Int] -- this only works when the type signature is \"IO [Int]\"\ngetNums = getListFromIO 10\n\ngetListFromIO :: Int -&gt; IO [Int]\ngetListFromIO n = do\n  gen &lt;- newStdGen\n  return $ generateList n gen\n\ngenerateList :: Int -&gt; StdGen -&gt; [Int]\ngenerateList n gen = take n $ randomRs (1,9) $ gen\n</code></pre>\n\n<p>If I call <code>getListFromIO</code>, all is well; I get my precious random list of integers, and it is different every time. But every function that calls it must use <code>IO [Int]</code> it the type signature.  I don't want that.</p>\n\n<p>How can I structure this so that I am able to get a random number list of type <code>[Int]</code>?</p>\n"}, {"tags": ["haskell", "io"], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 3, "last_activity_date": 1452387996, "last_edit_date": 1452387996, "creation_date": 1452380540, "answer_id": 34699950, "question_id": 34699820, "link": "https://stackoverflow.com/questions/34699820/haskell-io-sum-up-all-inputs/34699950#34699950", "title": "Haskell IO Sum up all inputs", "body": "<p>the problem you are having is that the function you define (<code>main</code>) is of type <code>IO ()</code> if you want to have a recursive sum you would need to pass on the current value.</p>\n\n<pre><code>mainSum :: Double -&gt; IO ()\nmainSum accumulator = do putStrLn $ \"the current sum = \" ++ show accumulator\n                         input &lt;- getLine\n                         let summy = read input + accumulator\n                         mainSum summy\n</code></pre>\n\n<p>But if you can avoid the <code>IO</code> part (in this case reading the input) I would recommend to separate it from the computational part. Also the function <code>read</code> is partial, i.e. <code>read \"PWND!\" :: Double</code> yields an error - which is not desireable - so switching to something like a</p>\n\n<pre><code> safeRead :: Read a =&gt; String -&gt; Maybe a\n</code></pre>\n\n<p>might be a good idea to switch to in a future version of this program.</p>\n\n<p>btw - your program as of now would not even compile - those <code>print</code>-statements are not correct haskell code if not included in a \"bigger function\" so try to do it like this</p>\n\n<pre><code>main :: IO ()\nmain = do print ...\n          print ...\n          mainSum 0\n</code></pre>\n"}], "owner": {"reputation": 217, "user_id": 1880437, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/y39IE.jpg?s=128&g=1", "display_name": "pythoniosIV", "link": "https://stackoverflow.com/users/1880437/pythoniosiv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1452387996, "creation_date": 1452379564, "question_id": 34699820, "link": "https://stackoverflow.com/questions/34699820/haskell-io-sum-up-all-inputs", "title": "Haskell IO Sum up all inputs", "body": "<p>I'm trying to sum up all the user inputs given via IO.\nThe sum should start with a value 0 and then add continuously the user inputs. The IO programm (main) should run until stopped and always take an input and add it to the previous sum. </p>\n\n<pre><code>print \"Welcome!\"\nprint \"Current sum is = 0\"\nmain = do putStrLn \"Current sum = \"++ read summy\n      input &lt;- getLine\n      let summy = (read summy + read input)\n      main\n</code></pre>\n\n<p>That's the code I tried to get it working. My problem is I am not able to define the sum at the beginning as 0 and I am not sure how I should solve the problem. </p>\n\n<p>How can I do that?\nthanks in advance</p>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 19, "last_activity_date": 1452842312, "last_edit_date": 1452842312, "creation_date": 1452379156, "answer_id": 34699760, "question_id": 34699716, "link": "https://stackoverflow.com/questions/34699716/illegal-type-signature-in-instance-declaration/34699760#34699760", "title": "Illegal type signature in instance declaration", "body": "<p>You have a type signature in an instance declaration. That's illegal in standard Haskell. You can enable the <code>InstanceSigs</code> extension (put <code>{-# LANGUAGE InstanceSigs #-}</code> at the top of your file) to allow it. Or just delete the type signature.</p>\n"}], "owner": {"reputation": 248, "user_id": 3657850, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/43a7448e5c53fd976f54ff0015006772?s=128&d=identicon&r=PG&f=1", "display_name": "user3657850", "link": "https://stackoverflow.com/users/3657850/user3657850"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4436, "favorite_count": 1, "accepted_answer_id": 34699760, "answer_count": 1, "score": 12, "last_activity_date": 1452842312, "creation_date": 1452378733, "question_id": 34699716, "link": "https://stackoverflow.com/questions/34699716/illegal-type-signature-in-instance-declaration", "title": "Illegal type signature in instance declaration", "body": "<p>I'm getting the Illegal type signature in instance declaration error and I have no idea why it is popping up for my program. Indentation seems right, etc.\nI hope you can help me.</p>\n\n<pre><code>class Game g s | g -&gt; s where\n  findPossibleMoves :: Player -&gt; g -&gt; [(s,g)]\n  identifyWinner :: g -&gt; Player -&gt; Maybe Player\n\ninstance Game HForest HStrategy where\n  identifyWinner :: HForest -&gt; Player -&gt; Maybe Player\n  identifyWinner ts p = getWinner $ getLeaves ts\n\n  findPossibleMoves :: Player -&gt; HForest -&gt; [(HStrategy, HForest)]\n  findPossibleMoves p ts = map (\\s -&gt; (s,move s ts)) $ getStrategies p ts\n</code></pre>\n\n<p>The error is : </p>\n\n<pre><code>Illegal type signature in instance declaration:\n  findPossibleMoves :: Player -&gt; HForest -&gt; [(HStrategy, HForest)]\n(Use InstanceSigs to allow this)\nIn the instance declaration for `Game HForest HStrategy'\n</code></pre>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1452379392, "post_id": 34699613, "comment_id": 57145672, "body": "In your definition <code>mempty x</code> works, though the type of <code>mempty</code> is <code>Monoid a =&gt; a</code>. Try replacing this definition with <code>pure x = Constant (mempty x x x x x x 127 &quot;abc&quot; () x x )</code>. Does it work? Why? ;)"}], "answers": [{"comments": [{"owner": {"reputation": 1953, "user_id": 899723, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f68bcc2d6f5196fa090d578eb8356b9c?s=128&d=identicon&r=PG", "display_name": "mac10688", "link": "https://stackoverflow.com/users/899723/mac10688"}, "edited": false, "score": 0, "creation_date": 1452384545, "post_id": 34699747, "comment_id": 57147043, "body": "All excellent answers, I chose this because &quot;f is Constant Sum&quot; puts the nail in the coffin for me. Thank you."}], "tags": [], "owner": {"reputation": 21248, "user_id": 223274, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2a6aad3c8269beb376b3e2b0bd29bec4?s=128&d=identicon&r=PG", "display_name": "Ian Henry", "link": "https://stackoverflow.com/users/223274/ian-henry"}, "is_accepted": true, "score": 3, "last_activity_date": 1452379064, "creation_date": 1452379064, "answer_id": 34699747, "question_id": 34699613, "link": "https://stackoverflow.com/questions/34699613/haskell-why-does-this-type-check/34699747#34699747", "title": "Haskell why does this type check", "body": "<p>Because you have two type variables here:</p>\n\n<pre><code>newtype Constant a b =\n    Constant { getConstant :: a }\n    deriving (Eq, Ord, Show)\n</code></pre>\n\n<p>But you only \"store\" values of the first type, and the second is a <a href=\"https://wiki.haskell.org/Phantom_type\" rel=\"nofollow\"><em>phantom</em></a>.</p>\n\n<p>But your <code>Applicative</code> instance is only concerned with the <em>second</em> type variable that you have -- the <code>b</code>, the elusive phantom.</p>\n\n<p>That means that values like <code>Constant (Sum 1)</code> can have any sort of thing as their second type variable -- it doesn't matter! You can write:</p>\n\n<pre><code>foo :: Constant Sum (a -&gt; b)\nfoo = Constant (Sum 1)\n\nbar :: Constant Sum String\nbar = Constant (Sum 1)\n\nbaz :: Constant Sum (IO [Maybe Int])\nbaz = Constant (Sum 1)\n</code></pre>\n\n<p>Because you never actually need a value of the phantom type.</p>\n\n<p>Thus when you write <code>Constant (Sum 1) &lt;*&gt; Constant (Sum 2)</code>, the type checker infers the correct types:</p>\n\n<pre><code>let foo = Constant (Sum 1) :: Constant Sum (a -&gt; b)\n    bar = Constant (Sum 2) :: Constant Sum a\n in foo &lt;*&gt; bar\n</code></pre>\n\n<p>So the left-hand side of <code>&lt;*&gt;</code> <em>does</em> have the type <code>f (a -&gt; b)</code>, but <code>f</code> is <em><code>Constant Sum</code></em>, not just <code>Constant</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": false, "score": 4, "last_activity_date": 1452379071, "creation_date": 1452379071, "answer_id": 34699750, "question_id": 34699613, "link": "https://stackoverflow.com/questions/34699613/haskell-why-does-this-type-check/34699750#34699750", "title": "Haskell why does this type check", "body": "<p>The left side <em>is</em> <code>f (a -&gt; b)</code>.  This is correct.</p>\n\n<p>Remember the type here (let's make <code>1 :: Int</code> for simplicity):</p>\n\n<pre><code>Constant (Sum 1) :: forall a. Constant (Sum Int) a\n</code></pre>\n\n<p>I've added the explicit <code>forall</code>.  The type checker can unify <code>a</code> with anything.</p>\n\n<p>Try this one:</p>\n\n<pre><code>Constant (Sum 1) :: Constant (Sum Int) (a -&gt; b)\n</code></pre>\n\n<p>Works fine.</p>\n"}, {"comments": [{"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 1, "creation_date": 1452380334, "post_id": 34699759, "comment_id": 57145924, "body": "Good catch with the Applicative laws."}, {"owner": {"reputation": 1953, "user_id": 899723, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f68bcc2d6f5196fa090d578eb8356b9c?s=128&d=identicon&r=PG", "display_name": "mac10688", "link": "https://stackoverflow.com/users/899723/mac10688"}, "edited": false, "score": 0, "creation_date": 1452389569, "post_id": 34699759, "comment_id": 57148172, "body": "It seems Constant inherently breaks that applicative law."}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "reply_to_user": {"reputation": 1953, "user_id": 899723, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f68bcc2d6f5196fa090d578eb8356b9c?s=128&d=identicon&r=PG", "display_name": "mac10688", "link": "https://stackoverflow.com/users/899723/mac10688"}, "edited": false, "score": 2, "creation_date": 1452394052, "post_id": 34699759, "comment_id": 57149060, "body": "@mac10688 not quite; it&#39;s possible to write a lawful Applicative instance for <code>Constant</code> :)"}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "reply_to_user": {"reputation": 1953, "user_id": 899723, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f68bcc2d6f5196fa090d578eb8356b9c?s=128&d=identicon&r=PG", "display_name": "mac10688", "link": "https://stackoverflow.com/users/899723/mac10688"}, "edited": false, "score": 1, "creation_date": 1452399566, "post_id": 34699759, "comment_id": 57150089, "body": "@mac10688 the main problem is that using <code>&lt;*&gt;</code> to &quot;combine&quot; effects is supposed to merge them together and also merge their effects.  The way you wrote it, your <code>&lt;*&gt;</code> loses effects/information from the left side.  How can you write it so that it incorporates both sides in the answer?"}, {"owner": {"reputation": 1953, "user_id": 899723, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f68bcc2d6f5196fa090d578eb8356b9c?s=128&d=identicon&r=PG", "display_name": "mac10688", "link": "https://stackoverflow.com/users/899723/mac10688"}, "edited": false, "score": 0, "creation_date": 1452399686, "post_id": 34699759, "comment_id": 57150102, "body": "@JustinL. yes, the problem is that I&#39;m reading the beta version of a haskell learning book. The examples given don&#39;t align with the real Const applicative instance. Someone in the IRC haskell channel demonstrated. I have written the book&#39;s authors to consider changing the examples."}], "tags": [], "owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "is_accepted": false, "score": 4, "last_activity_date": 1452379643, "last_edit_date": 1452379643, "creation_date": 1452379123, "answer_id": 34699759, "question_id": 34699613, "link": "https://stackoverflow.com/questions/34699613/haskell-why-does-this-type-check/34699759#34699759", "title": "Haskell why does this type check", "body": "<p>For <code>Const</code>:</p>\n\n<pre><code>(&lt;*&gt;) :: Const c (a -&gt; b) -&gt; Const c a -&gt; Const c b\n</code></pre>\n\n<p>Your input was a <code>Const c (a -&gt; b)</code> a <code>Const c a</code>.  You gave a <code>Const c b</code> in return -- if <code>x :: c</code>, then <code>Const x :: Const c a</code>, for any <code>a</code>.  It can be <code>Const c Int</code>, <code>Const c Bool</code>, etc.</p>\n\n<p>For example:</p>\n\n<pre><code>Const \"Hello\" :: Const String Int\nConst \"Hello\" :: Const String Bool\nConst \"Hello\" :: Const String Double\nConst \"Hello\" :: Const String a\nConst \"Hello\" :: Const String (a -&gt; b)\nConst \"Hello\" :: Const String b\n</code></pre>\n\n<p>all typecheck, because the last parameter can be anything -- <code>\"Hello\"</code> only constrains the first parameter.</p>\n\n<p>However, you should note that your <code>Applicative</code> instance doesn't obey the Applicative laws.</p>\n\n<pre><code>u &lt;*&gt; pure y = pure ($ y) &lt;*&gt; u\n</code></pre>\n\n<p>in particular is violated:</p>\n\n<pre><code>Const \"hello\" &lt;*&gt; pure 4\n== Const \"hello\" &lt;*&gt; Const \"\"\n== Const \"\"\n</code></pre>\n\n<p>but</p>\n\n<pre><code>pure ($ 4) &lt;*&gt; Const \"hello\"\n== Const \"\" &lt;*&gt; Const \"hello\"\n== Const \"hello\"\n</code></pre>\n"}], "owner": {"reputation": 1953, "user_id": 899723, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f68bcc2d6f5196fa090d578eb8356b9c?s=128&d=identicon&r=PG", "display_name": "mac10688", "link": "https://stackoverflow.com/users/899723/mac10688"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 34699747, "answer_count": 3, "score": 2, "last_activity_date": 1452379643, "creation_date": 1452377991, "question_id": 34699613, "link": "https://stackoverflow.com/questions/34699613/haskell-why-does-this-type-check", "title": "Haskell why does this type check", "body": "<pre><code>import Data.Monoid\n\nnewtype Constant a b =\n    Constant { getConstant :: a }\n    deriving (Eq, Ord, Show)\n\ninstance Functor (Constant a) where\n    fmap _ (Constant a) = Constant a\n\ninstance (Monoid a) =&gt; Applicative (Constant a) where\n    pure x = Constant (mempty x )\n    _ &lt;*&gt; (Constant a) = Constant a\n\n--:t (&lt;*&gt;)\n--(&lt;*&gt;) :: Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b\n\n--:t Constant (Sum 1)\n--Constant (Sum 1) :: Num a =&gt; Constant (Sum a) b\n\n--Constant (Sum 1) &lt;*&gt; Constant (Sum 2)\n--Constant { getConstant = Sum { getSum = 2 }}\n</code></pre>\n\n<p>My question is why does the last statement type check?</p>\n\n<p>I expected the left side of &lt;*> to be of type f ( a -> b)<br />\nWhere <br />\n  f = Constant <br />\n  (a -> b) = Sum 1?<br /></p>\n\n<p>There's nothing I can apply to (Sum 1) because it is fully applied, yet this statement compiles.</p>\n"}, {"tags": ["haskell", "types", "boolean"], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 6, "last_activity_date": 1452371468, "creation_date": 1452371468, "answer_id": 34698567, "question_id": 34698511, "link": "https://stackoverflow.com/questions/34698511/how-to-use-haskell-types/34698567#34698567", "title": "How to use haskell types?", "body": "<p>as <code>Person</code> is a tuple you should pattern-match it like this:</p>\n\n<pre><code>retired (_,age,_) = age &gt;= 65\n</code></pre>\n\n<p>and it should work</p>\n"}, {"tags": [], "owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "is_accepted": false, "score": 3, "last_activity_date": 1452381012, "last_edit_date": 1452381012, "creation_date": 1452377860, "answer_id": 34699585, "question_id": 34698511, "link": "https://stackoverflow.com/questions/34698511/how-to-use-haskell-types/34699585#34699585", "title": "How to use haskell types?", "body": "<p><code>type X = Y</code> defines a <em>type alias</em>. In this example, <code>X</code> is defined to be the same as <code>Y</code>. Therefore, <code>retired :: Person -&gt; Bool</code> is the same as <code>retired :: (Int, Int, Int) -&gt; Bool</code>.</p>\n\n<p>Then we can ask the question: how do we obtain a person's age? Well, <code>Person</code> is the same as <code>(Int, Int, Int)</code>, and we know the second element of the tuple is the person's age. Therefore, an equivalent question is: how do we obtain the second element of a 3-tuple?</p>\n\n<p>This is done in Haskell by <em>deconstructing</em> the tuple, which is the opposite of <em>constructing</em> the tuple. An example of constructing a tuple is <code>x = (1,2,3)</code>. To deconstruct a tuple, we use a similar notation but flip the sides: <code>(a,b,c) = x</code>. This is the same as <code>(a,b,c) = (1,2,3)</code>, and the same as the three assignments <code>a = 1; b = 2; c = 3</code>.</p>\n\n<p>Haskell allows you to use this deconstruction notation for function arguments. Therefore, <code>retired p = e</code> could be written <code>retired (ni, age, balance) = e</code>, recalling that <code>Person</code> is a 3-tuple. Now it is straight-forward that <code>e</code> should be <code>age &gt;= 65</code>.</p>\n\n<p>To elaborate further, <code>retired (ni, age, balance) = e</code> is equivalent to <code>retired p = let (ni, age, balance) = p in e</code>. This is useful to know because then function application is clearer. <code>retired x</code> is <code>let (ni, age, balance) = x in [x/p]e</code> where <code>[x/p]e</code> means \"substitute <em>x</em> for <em>p</em> in <em>e</em>\".</p>\n\n<hr>\n\n<p>Another approach is to define a data type using record notation.</p>\n\n<p><code>data Person = Person { ni :: Int, age :: Int, balance :: Int }</code></p>\n\n<p>This defines a new type called <code>Person</code>, and is not the same as the 3-tuple of type <code>(Int, Int, Int)</code>. Additionally, this defines three <em>projection</em> functions <code>ni :: Person -&gt; Int</code>, <code>age :: Person -&gt; Int</code>, and <code>balance :: Person -&gt; Int</code>.</p>\n\n<p>Now if we implement <code>retired :: Person -&gt; Bool</code> we can do so as <code>retired p = age p &gt;= 65</code>, or in point-free form <code>retired = (&gt;= 65) . age</code>.</p>\n\n<p>To reconnect with the first approach, can you also use deconstruction? Absolutely. A Person is constructed as <code>x = Person m n p</code>, and so similarly can be deconstructed as <code>Person a b c = x</code>. Therefore, another definition for <code>retired</code> is <code>retired (Person n a b) = a &gt;= 65</code>.</p>\n"}], "owner": {"reputation": 133, "user_id": 3196387, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/12bf0af12fcdc25f6ccecd1db7ce0254?s=128&d=identicon&r=PG&f=1", "display_name": "srysry", "link": "https://stackoverflow.com/users/3196387/srysry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 34698567, "answer_count": 2, "score": 0, "last_activity_date": 1452381012, "creation_date": 1452371083, "question_id": 34698511, "link": "https://stackoverflow.com/questions/34698511/how-to-use-haskell-types", "title": "How to use haskell types?", "body": "<p>Really simple question, i can't for the life of me google the info :(</p>\n\n<p>I have the following types:</p>\n\n<pre><code>type NI = Int\ntype Age = Int\ntype Balance = Int\ntype Person = (NI, Age, Balance)\n</code></pre>\n\n<p>How do I create a function that returns true if a person's age is over 65? I've tried:</p>\n\n<pre><code>retired :: Person -&gt; Bool\nretired p = p &gt;= 65\n</code></pre>\n\n<p>It doesn't work obviously, i realise that even when i tried it. I'm stumped on something so simple.</p>\n"}, {"tags": ["security", "haskell", "hackage", "haskell-stack"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1452373435, "post_id": 34698377, "comment_id": 57143824, "body": "I suggest asking on <a href=\"https://github.com/commercialhaskell/stack/issues\" rel=\"nofollow noreferrer\">the stack issue tracker</a>. They have a label <code>type: question</code>, so I guess that questions are welcome. That being said, stack has some checksum verification stuff ready, see <code>Network.HTTP.Download.Verified</code>. Unfortunately, I have no idea how and where it&#39;s used throughout the whole stack execution."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1452414185, "post_id": 34698377, "comment_id": 57152723, "body": "@Zeta Good idea, <a href=\"https://github.com/commercialhaskell/stack/issues/1636\" rel=\"nofollow noreferrer\">done</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "is_accepted": false, "score": 1, "last_activity_date": 1452732298, "creation_date": 1452732298, "answer_id": 34779788, "question_id": 34698377, "link": "https://stackoverflow.com/questions/34698377/can-stack-make-sure-that-dependencies-arent-tampered-with/34779788#34779788", "title": "Can Stack make sure that dependencies aren&#39;t tampered with?", "body": "<p>Yup, stack has had security for this for nearly half a year.  Here's a relevant blogpost: <a href=\"https://www.fpcomplete.com/blog/2015/07/package-security-in-stack\" rel=\"nofollow\">https://www.fpcomplete.com/blog/2015/07/package-security-in-stack</a></p>\n"}], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1452732298, "creation_date": 1452370257, "question_id": 34698377, "link": "https://stackoverflow.com/questions/34698377/can-stack-make-sure-that-dependencies-arent-tampered-with", "title": "Can Stack make sure that dependencies aren&#39;t tampered with?", "body": "<p>One problem with Cabal is that it pulls packages from Hackage, and as <a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2013-January/106051.html\" rel=\"nofollow\">it's been discussed</a> some time ago, there are many ways how a piece of malicious code can get in.</p>\n\n<p>Does Stack improve the situation and does it take any precautions against that? Is it possible to make sure that all code downloaded externally for a given project is verified?</p>\n\n<p>This includes extra dependencies - if there are any declared, is it possible to let stack verify them, for example to give an expected hash of the downloaded package?</p>\n"}, {"tags": ["haskell", "parallel-processing", "ghc"], "answers": [{"comments": [{"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1452413886, "post_id": 34700535, "comment_id": 57152653, "body": "Yes, you corrected my mistakes just as it should have been :), thank you! So I guess for terminating tasks I have to resort to using concurrency and manually killing threads with <code>killThread</code>."}], "tags": [], "owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "is_accepted": false, "score": 6, "last_activity_date": 1452386451, "last_edit_date": 1452386451, "creation_date": 1452385067, "answer_id": 34700535, "question_id": 34697750, "link": "https://stackoverflow.com/questions/34697750/does-haskell-discard-a-spark-when-the-thunk-is-garbage-collected/34700535#34700535", "title": "Does Haskell discard a spark when the thunk is garbage collected?", "body": "<p>Did you mean <code>fromMaybe</code> instead of <code>maybe</code>?</p>\n\n<pre><code>x `par` y `pseq` (fromMaybe y x)\n</code></pre>\n\n<p>Also you are creating a spark for evaluating <code>x</code>, not <code>y</code>. So <code>fromMaybe y x</code> will not be evaluated until <code>y</code> is evaluated. Probably you meant the opposite:</p>\n\n<pre><code>y `par` x `pseq` (fromMaybe y x)\n</code></pre>\n\n<p>If all above is true, then the answer to your question is \"no\", the spark will not be stopped when already started (though it will be discarded if not yet started.) You can check it with the following test:</p>\n\n<pre><code>import Data.Maybe\nimport Control.Concurrent\nimport Control.Parallel\nimport System.IO.Unsafe\nimport System.Mem\n\n{-# NOINLINE x #-}\nx = unsafePerformIO $ do\n  threadDelay 1000\n  return (Just 1)\n\n{-# NOINLINE y #-}\ny = unsafePerformIO $ do\n  print \"will eval y\"\n  threadDelay 3000000\n  print \"did eval y\"\n  return (2 :: Int)\n\nmain :: IO ()\nmain = do\n  print $ y `par` x `pseq` fromMaybe y x\n  print \"done\"\n  performGC\n  threadDelay 4000000\n</code></pre>\n\n<p>The output:</p>\n\n<pre><code>\"will eval y\"\n1\n\"done\"\n\"did eval y\"\n</code></pre>\n\n<p>Also you can check runtime statistics, <code>+RTS -s</code>. It contains a number of GC'd sparks.</p>\n"}], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 1, "answer_count": 1, "score": 16, "last_activity_date": 1452413781, "creation_date": 1452366730, "last_edit_date": 1452413781, "question_id": 34697750, "link": "https://stackoverflow.com/questions/34697750/does-haskell-discard-a-spark-when-the-thunk-is-garbage-collected", "title": "Does Haskell discard a spark when the thunk is garbage collected?", "body": "<p>For example:</p>\n\n<pre><code>x :: Maybe a\ny :: a\ny `par` x `pseq` (fromMaybe y x)\n</code></pre>\n\n<p>Is the spark of <code>y</code> stopped and discarded if <code>x</code> is computed (much) sooner and is <code>Just ...</code>?</p>\n\n<p>To be more specific, I want to search a list, but each comparison is quite costly. I'd like to parallelize the search, but I'd like the rest of comparisons to be discarded once a match is found.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1452355062, "post_id": 34695518, "comment_id": 57137266, "body": "<code>ghci</code> interprets Haskell expressions. <code>.&#47;Interact</code> doesn&#39;t look like one, it looks like an executable file name. To run an executable file, use a shell. In <code>ghci</code>, try typing a Haskell expression, like <code>main</code>. Or, if you want to pass arguments to <code>main</code>, try <code>:main infrank.txt outfrank.txt</code>."}, {"owner": {"reputation": 283, "user_id": 2723238, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7d3387dfb0d1396362f6ae94289b7749?s=128&d=identicon&r=PG&f=1", "display_name": "Frank  D.", "link": "https://stackoverflow.com/users/2723238/frank-d"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1452360799, "post_id": 34695518, "comment_id": 57139364, "body": "Thank   you @n.m...it   Worked  like  a charm when using :main"}], "answers": [{"comments": [{"owner": {"reputation": 283, "user_id": 2723238, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7d3387dfb0d1396362f6ae94289b7749?s=128&d=identicon&r=PG&f=1", "display_name": "Frank  D.", "link": "https://stackoverflow.com/users/2723238/frank-d"}, "edited": false, "score": 0, "creation_date": 1452360909, "post_id": 34695903, "comment_id": 57139400, "body": "Thank  you   Sibi...........i did  change InteractWith   to  Interact  myself.I think  like you pointed out  i was using wrong command in window.It worked  fine  when  i  did  use  a proper  command.Again  thank you very much"}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 5, "last_activity_date": 1452364514, "last_edit_date": 1452364514, "creation_date": 1452356609, "answer_id": 34695903, "question_id": 34695518, "link": "https://stackoverflow.com/questions/34695518/dont-know-why-am-getting-haskell-interactive481-parse-error-on-input/34695903#34695903", "title": "Dont know why am getting Haskell &quot;&lt;interactive&gt;:48:1: parse error on input \u2018./\u2019&quot; using WinGHCi 1.0.6 and", "body": "<p>I just looked on the <a href=\"http://book.realworldhaskell.org/read/functional-programming.html\" rel=\"nofollow\">chapter 4</a> and you seem to be confused between ghci prompt and shell (cmd.exe in case of Windows).</p>\n\n<p>You have to run this command in shell (For Unix systems) or <code>cmd.exe</code> in Windows:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>ghc --make Interact.hs\n./Interact \"infrank.txt\" \"outfrank.txt\"\n</code></pre>\n\n<p>Also the book seems to have some error with it as they are producing an executable named <code>InteractWith</code> using <code>ghc --make InteractWith</code> and then using <code>Interact</code> instead of <code>InteractWith</code>.</p>\n"}], "owner": {"reputation": 283, "user_id": 2723238, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7d3387dfb0d1396362f6ae94289b7749?s=128&d=identicon&r=PG&f=1", "display_name": "Frank  D.", "link": "https://stackoverflow.com/users/2723238/frank-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 34695903, "answer_count": 1, "score": 0, "last_activity_date": 1452364514, "creation_date": 1452354431, "last_edit_date": 1452355126, "question_id": 34695518, "link": "https://stackoverflow.com/questions/34695518/dont-know-why-am-getting-haskell-interactive481-parse-error-on-input", "title": "Dont know why am getting Haskell &quot;&lt;interactive&gt;:48:1: parse error on input \u2018./\u2019&quot; using WinGHCi 1.0.6 and", "body": "<p>I am a newbie in Haskell running  Below  Haskell  code  Chapter 4   of RealWorld  Haskell Book and getting</p>\n\n<pre><code> &lt;interactive&gt;:48:1: parse error on input \u2018./\u2019\n</code></pre>\n\n<p><strong>This  is  what  i  executed  on  WinGHCi 1.0.6</strong></p>\n\n<pre><code>Prelude&gt; :load Interact    \n[1 of 1] Compiling Main             ( Interact.hs, interpreted )    \nOk, modules loaded: Main.    \n*Main&gt; --make Interact    \n*Main&gt; :load Interact    \n[1 of 1] Compiling Main             ( Interact.hs, interpreted )    \nOk, modules loaded: Main.    \n*Main&gt; ./Interact \"infrank.txt\" \"outfrank.txt\"    \n    *&lt;interactive&gt;:48:1: parse error on input \u2018./\u2019*\n</code></pre>\n\n<p>Can  Anyone  please  help? as i  tried  to  google  around with no hope</p>\n\n<p><strong>Below is  the  code  from RealWorld Haskell Chapter 4</strong></p>\n\n<pre><code>-- file: ch04/Interact.hs    \n-- Save this in a source file, e.g. Interact.hs\n\nimport System.Environment (getArgs)\ninteractWith function inputFile outputFile = do\n\n  input &lt;- readFile inputFile    \n  writeFile outputFile (function input)\n\nmain = mainWith myFunction\n  where mainWith function = do\n\n          args &lt;- getArgs\n          case args of\n            [input,output] -&gt; interactWith function input output\n            _ -&gt; putStrLn \"error: exactly two arguments needed\"\n\n        -- replace \"id\" with the name of our function below\n        myFunction = id\n</code></pre>\n"}, {"tags": ["haskell", "tuples"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4709293"}, "edited": false, "score": 0, "creation_date": 1452355184, "post_id": 34695605, "comment_id": 57137310, "body": "I thought of generating a list of tuples and then use fold to sum them. But I am covering 2 lists (different, I know, but 2) anyway..."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 1, "creation_date": 1452355339, "post_id": 34695605, "comment_id": 57137357, "body": "just fold your list to the tuples. The function in fold take two arguments, the element being <i>scanned</i>  and  last tuples."}], "tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 0, "last_activity_date": 1452354944, "creation_date": 1452354944, "answer_id": 34695605, "question_id": 34695509, "link": "https://stackoverflow.com/questions/34695509/how-to-increment-tuple-recursively-in-haskell/34695605#34695605", "title": "How to increment tuple recursively in Haskell?", "body": "<p>You can't really <em>update</em> a tuple, as value are immutable in Haskell. However, you can create a new one from the previous one with the <em>updated</em> value. Hint, use <code>fold</code> or simple recursion.</p>\n"}, {"comments": [{"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 2, "creation_date": 1452355391, "post_id": 34695663, "comment_id": 57137375, "body": "Th question is obviously homework so you shouldn&#39;t if possible to reveal the solution ;-)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4709293"}, "edited": false, "score": 0, "creation_date": 1452355705, "post_id": 34695663, "comment_id": 57137478, "body": "Works like charm. Thanks. So, am I able to use any function as a parameter of fold?"}, {"owner": {"reputation": 869, "user_id": 2029548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f44dcf3e58fcd22cd857cd563402178?s=128&d=identicon&r=PG", "display_name": "obadz", "link": "https://stackoverflow.com/users/2029548/obadz"}, "edited": false, "score": 0, "creation_date": 1452355998, "post_id": 34695663, "comment_id": 57137581, "body": "Any function with the appropriate type signature: Since <code>foldl :: Foldable t =&gt; (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b</code>, the function you pass as your first argument must be of type <code>b -&gt; a -&gt; b</code>, where <code>b</code> is the same as the type of your second argument, in this case <code>(Int, Int, Int)</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452367489, "post_id": 34695663, "comment_id": 57141850, "body": "To avoid relying on compiler optimizations, you should use <code>foldl&#39;</code> and ensure that the components of the triples are forced appropriately."}], "tags": [], "owner": {"reputation": 869, "user_id": 2029548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f44dcf3e58fcd22cd857cd563402178?s=128&d=identicon&r=PG", "display_name": "obadz", "link": "https://stackoverflow.com/users/2029548/obadz"}, "is_accepted": true, "score": 0, "last_activity_date": 1452355278, "creation_date": 1452355278, "answer_id": 34695663, "question_id": 34695509, "link": "https://stackoverflow.com/questions/34695509/how-to-increment-tuple-recursively-in-haskell/34695663#34695663", "title": "How to increment tuple recursively in Haskell?", "body": "<p>This is a good use case for <code>foldl</code>:</p>\n\n<pre><code>nzp :: [Int] -&gt; (Int, Int, Int)\nnzp = foldl accountForNumber (0, 0, 0)\n      where accountForNumber (lt, eq, gt) x | x &lt; 0 = (lt + 1, eq, gt)\n            accountForNumber (lt, eq, gt) x | x &gt; 0 = (lt, eq, gt + 1)\n            accountForNumber (lt, eq, gt) _ | otherwise = (lt, eq + 1, gt)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1452366864, "creation_date": 1452366864, "answer_id": 34697775, "question_id": 34695509, "link": "https://stackoverflow.com/questions/34695509/how-to-increment-tuple-recursively-in-haskell/34697775#34697775", "title": "How to increment tuple recursively in Haskell?", "body": "<h3>The boring way</h3>\n\n<pre><code>count :: (Num a, Ord a, Foldable f) =&gt; f a -&gt; (Int, Int, Int)\ncount = foldl' go (0, 0, 0) where\n  go (!neg, !zer, !pos) x =\n    case compare x 0 of\n      LT -&gt; (neg + 1, zer, pos)\n      EQ -&gt; (neg, zer + 1, pos)\n      GT -&gt; (neg, zer, pos + 1)\n</code></pre>\n\n<h3>The fun way</h3>\n\n<p>Use the <code>foldl</code> package</p>\n\n<pre><code>import qualified Control.Foldl as Fl\nimport Control.Lens.Fold\n\ncountF :: (a -&gt; Bool) -&gt; Fl.Fold a Int\ncountF p = Fl.handles (filtered p) Fl.length\n\ncount = Fl.fold ((,,) &lt;$&gt; countF (&lt;0) &lt;*&gt; countF (==0) &lt;*&gt; countF (&gt;0))\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4709293"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1023, "favorite_count": 0, "accepted_answer_id": 34695663, "answer_count": 3, "score": 0, "last_activity_date": 1452366864, "creation_date": 1452354362, "question_id": 34695509, "link": "https://stackoverflow.com/questions/34695509/how-to-increment-tuple-recursively-in-haskell", "title": "How to increment tuple recursively in Haskell?", "body": "<p>I've been asked to create a function that calculates the number of negative, zero and positive numbers on a [Int]. The result should then be written on a tuple (nrOfNeg,nrOfZeros,nrOfPos). </p>\n\n<p>nzp [0,-1,1,2,0,3] = (1,2,3)</p>\n\n<p><strong>However, the list must be covered only once (meaning that tuple should update every element it is evaluated on [Int]).</strong></p>\n\n<p>Something like:</p>\n\n<pre><code>nzp [***0***,-1,1,2,0,3] = (0,1,0)\nnzp [0,***-1***,1,2,0,3] = (1,1,0)\nnzp [0,-1,***1***,2,0,3] = (1,1,1)\n...\n</code></pre>\n\n<p>This is what I made so far, but it \"uses\" 3 times the list to calculate.</p>\n\n<pre><code>nzp :: [Int] -&gt; (Int,Int,Int)\nnzp l = (neg,zeros,pos)\n        where neg = length (filter (&lt;0) l)\n              zeros = length (filter (==0) l)\n              pos = length (filter (&gt;0) l)\n</code></pre>\n\n<p>Is there any way to increment the tuple specific position while evaluating elements of [Int]?</p>\n"}, {"tags": ["xml", "haskell", "hxt"], "answers": [{"tags": [], "owner": {"reputation": 115, "user_id": 1056350, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2e771754034e77080eea435ede7810cd?s=128&d=identicon&r=PG", "display_name": "Iggy M", "link": "https://stackoverflow.com/users/1056350/iggy-m"}, "is_accepted": true, "score": 2, "last_activity_date": 1452352772, "creation_date": 1452352772, "answer_id": 34695233, "question_id": 34694801, "link": "https://stackoverflow.com/questions/34694801/hxt-using-orelse-to-replace-missing-attribute-value-with-default/34695233#34695233", "title": "HXT using &#39;orElse&#39; to replace missing attribute value with default", "body": "<p>Ok, that was stupid.\nI should have checked the types:</p>\n\n<pre><code>\u03bb: :t getAttrValue\ngetAttrValue :: ArrowXml a =&gt; String -&gt; a XmlTree String\n\u03bb: :t hasAttr\nhasAttr :: ArrowXml a =&gt; String -&gt; a XmlTree XmlTree\n</code></pre>\n\n<p>Now, after changing the line in question to:</p>\n\n<pre><code>getFloatAttrib attribName = (hasAttr attribName &gt;&gt;&gt; getAttrValue attribName) `orElse` constA \"0.0\"\n</code></pre>\n\n<p>Everything is fine.</p>\n"}], "owner": {"reputation": 115, "user_id": 1056350, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2e771754034e77080eea435ede7810cd?s=128&d=identicon&r=PG", "display_name": "Iggy M", "link": "https://stackoverflow.com/users/1056350/iggy-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 34695233, "answer_count": 1, "score": 1, "last_activity_date": 1452435712, "creation_date": 1452350501, "last_edit_date": 1452435712, "question_id": 34694801, "link": "https://stackoverflow.com/questions/34694801/hxt-using-orelse-to-replace-missing-attribute-value-with-default", "title": "HXT using &#39;orElse&#39; to replace missing attribute value with default", "body": "<p>I am using HXT to parse a simple XML file and need to replace missing attributes of a tag with default value. But for some reason <code>orElse</code> does not work as expected.</p>\n\n<p>Below is XML file:</p>\n\n<pre><code>&lt;!-- window_home.xml --&gt;\n&lt;elements&gt;\n  &lt;Window libraryItemName=\"panel_tabs\" name=\"panel_tabs\" selected=\"true\"&gt;\n    &lt;matrix&gt;\n      &lt;Matrix ty=\"-11.8\" /&gt;\n    &lt;/matrix&gt;\n  &lt;/Window&gt;\n  &lt;Window libraryItemName=\"home_powerup_menu\" name=\"home_powerup_menu\" selected=\"true\"&gt;\n    &lt;matrix&gt;\n      &lt;Matrix tx=\"12.4\" /&gt;\n    &lt;/matrix&gt;\n  &lt;/Window&gt;\n  &lt;Window libraryItemName=\"panel_name\" name=\"panel_name\" selected=\"true\"&gt;\n    &lt;!-- data here  --&gt;\n  &lt;/Window&gt;\n&lt;/elements&gt;\n</code></pre>\n\n<p>Tag in question is <code>Matrix</code>.\nBelow is my code:</p>\n\n<pre><code>{-# LANGUAGE Arrows, NoMonomorphismRestriction #-}\nimport Text.XML.HXT.Core\n\nparseXML = readDocument [ withValidate no\n                        , withRemoveWS yes  -- throw away formating WS\n                        ] \n\natTag tag = deep (isElem &gt;&gt;&gt; hasName tag)\n\ndata XflMatrix = XflMatrix { a, b, c, d, tx, ty :: Float } deriving (Show)\ninitXflMatrix = XflMatrix { a = 1.0, d = 1.0, b = 0.0, c = 0.0, tx = 0.0, ty = 0.0 }\n\ndata UiWindow = UiWindow {\n    wndName :: String,\n    wndNameLib :: String,\n    wndMatrix :: XflMatrix,\n    wndChildren :: [UiWindow]\n    } deriving (Show)\n\ninitUiWindow = UiWindow {\n    wndName = \"empty\",\n    wndNameLib = \"\",\n    wndMatrix = initXflMatrix,\n    wndChildren = []\n    }\n\n\nparseDoc docName = runX $ parseXML fileName &gt;&gt;&gt; getWindow\n  where\n    fileName = docName ++ \".xml\"\n\ngetMatrixFromTag = atTag \"Matrix\" &gt;&gt;&gt; proc x -&gt; do\n    tx &lt;- getFloatAttrib \"tx\" -&lt; x\n    ty &lt;- getFloatAttrib \"ty\" -&lt; x\n    returnA -&lt; initXflMatrix { tx = read tx :: Float, ty = read ty :: Float }\n        where\n            --getFloatAttrib attribName = getAttrValue attribName\n            getFloatAttrib attribName = getAttrValue attribName `orElse` constA \"0.0\"\n\ngetWindow = atTag \"Window\" &gt;&gt;&gt; proc x -&gt; do\n    libraryItemName &lt;- getAttrValue \"libraryItemName\" -&lt; x\n    name &lt;- getAttrValue \"name\" -&lt; x\n    m &lt;- getMatrixFromTag -&lt; x\n    children &lt;- arrIO parseDoc -&lt; libraryItemName\n    returnA -&lt; initUiWindow { wndName = name, wndNameLib = libraryItemName, wndChildren = children, wndMatrix = m}\n\n\ndocumentName = \"DOMDocument.xml\"        \n\nparseRoot = parseXML documentName\n--runX (parseRoot &gt;&gt;&gt; getWindow )\n</code></pre>\n\n<p>It looks like the line</p>\n\n<pre><code>getFloatAttrib attribName = getAttrValue attribName `orElse` constA \"0.0\"\n</code></pre>\n\n<p>Does not return <code>\"0.0\"</code>.</p>\n\n<p>Am I doing something wrong?</p>\n"}, {"tags": ["mysql", "postgresql", "haskell", "nixos", "stackage"], "comments": [{"owner": {"reputation": 349, "user_id": 2635503, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/795ac058dbfa6848b9b17c39adabfdd5?s=128&d=identicon&r=PG", "display_name": "Markus Barthlen", "link": "https://stackoverflow.com/users/2635503/markus-barthlen"}, "edited": false, "score": 0, "creation_date": 1481962364, "post_id": 34694130, "comment_id": 69592753, "body": "Just gave nixos another shot and it seems that nix:   enable: true   packages: [zlib] (in stack.yaml, see  <a href=\"https://github.com/commercialhaskell/stack/issues/2130\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/2130</a>) is also necessary in addition to stack --nix build and the extrac-include-dirs and extra-lib-dirs below."}], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 2635503, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/795ac058dbfa6848b9b17c39adabfdd5?s=128&d=identicon&r=PG", "display_name": "Markus Barthlen", "link": "https://stackoverflow.com/users/2635503/markus-barthlen"}, "edited": false, "score": 0, "creation_date": 1452356592, "post_id": 34695780, "comment_id": 57137798, "body": "If I do this, I am getting error: undefined variable \u2018postgresql-libpq\u2019 at /home/markus/git/haskell/karma/karma/shell.nix:35:11. Prefixing it with haskellPackages leads to no error when running &quot;nix-shell&quot;, but &quot;nix-shell --command <code>stack build</code> &quot; still doesn&#39;t work, same error as in the question."}, {"owner": {"reputation": 349, "user_id": 2635503, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/795ac058dbfa6848b9b17c39adabfdd5?s=128&d=identicon&r=PG", "display_name": "Markus Barthlen", "link": "https://stackoverflow.com/users/2635503/markus-barthlen"}, "edited": false, "score": 0, "creation_date": 1452357313, "post_id": 34695780, "comment_id": 57138051, "body": "Undefined variable-bug was due to forgetting to add postgresql-libpq to the f = {...} expression. Otherwise, the same bug as above."}, {"owner": {"reputation": 869, "user_id": 2029548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f44dcf3e58fcd22cd857cd563402178?s=128&d=identicon&r=PG", "display_name": "obadz", "link": "https://stackoverflow.com/users/2029548/obadz"}, "reply_to_user": {"reputation": 349, "user_id": 2635503, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/795ac058dbfa6848b9b17c39adabfdd5?s=128&d=identicon&r=PG", "display_name": "Markus Barthlen", "link": "https://stackoverflow.com/users/2635503/markus-barthlen"}, "edited": false, "score": 0, "creation_date": 1452363694, "post_id": 34695780, "comment_id": 57140484, "body": "I don&#39;t use <code>stack</code> on <code>nixos</code> so am a bit out of my depth. You might want to try the #nixos IRC channel on freenode"}], "tags": [], "owner": {"reputation": 869, "user_id": 2029548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f44dcf3e58fcd22cd857cd563402178?s=128&d=identicon&r=PG", "display_name": "obadz", "link": "https://stackoverflow.com/users/2029548/obadz"}, "is_accepted": false, "score": 0, "last_activity_date": 1452355879, "creation_date": 1452355879, "answer_id": 34695780, "question_id": 34694130, "link": "https://stackoverflow.com/questions/34694130/nix-shell-command-stack-build-leads-to-libpq-fe-h-no-such-file-or-directory/34695780#34695780", "title": "nix-shell --command `stack build` leads to libpq-fe.h: No such file or directory", "body": "<p>Looks like <code>stack</code> is trying to build <code>haskellPackages.postgresql-libpq</code> outside of the <code>nix</code> framework.</p>\n\n<p>You probably don't want that to happen. Maybe try to add <code>postgresql-libpq</code> to <code>libraryHaskellDepends</code>?</p>\n"}, {"comments": [{"owner": {"reputation": 349, "user_id": 2635503, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/795ac058dbfa6848b9b17c39adabfdd5?s=128&d=identicon&r=PG", "display_name": "Markus Barthlen", "link": "https://stackoverflow.com/users/2635503/markus-barthlen"}, "edited": false, "score": 0, "creation_date": 1452407961, "post_id": 34700003, "comment_id": 57151620, "body": "Hi, I have no means of checking it right now. I assume it is the missing slash at the end or something like that."}, {"owner": {"reputation": 349, "user_id": 2635503, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/795ac058dbfa6848b9b17c39adabfdd5?s=128&d=identicon&r=PG", "display_name": "Markus Barthlen", "link": "https://stackoverflow.com/users/2635503/markus-barthlen"}, "edited": false, "score": 0, "creation_date": 1452408429, "post_id": 34700003, "comment_id": 57151723, "body": "It could also be a conflict with what is stated in stack.yaml. I&#39;ll add it to the question for future visitors."}, {"owner": {"reputation": 349, "user_id": 2635503, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/795ac058dbfa6848b9b17c39adabfdd5?s=128&d=identicon&r=PG", "display_name": "Markus Barthlen", "link": "https://stackoverflow.com/users/2635503/markus-barthlen"}, "edited": false, "score": 0, "creation_date": 1452445026, "post_id": 34700003, "comment_id": 57162336, "body": "I&#39;ll mark your answer as correct just for completeness."}], "tags": [], "owner": {"reputation": 70, "user_id": 5768173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b17c7828c8b6a0d66fdb670c9a4dbad8?s=128&d=identicon&r=PG", "display_name": "xor-xor", "link": "https://stackoverflow.com/users/5768173/xor-xor"}, "is_accepted": true, "score": 2, "last_activity_date": 1452380940, "creation_date": 1452380940, "answer_id": 34700003, "question_id": 34694130, "link": "https://stackoverflow.com/questions/34694130/nix-shell-command-stack-build-leads-to-libpq-fe-h-no-such-file-or-directory/34700003#34700003", "title": "nix-shell --command `stack build` leads to libpq-fe.h: No such file or directory", "body": "<p>Funny, because I've just had a similar problem myself - solved it by adding these two lines to <code>stack.yaml</code>:</p>\n\n<pre><code>extra-include-dirs: [/nix/store/jrdvjvf0w9nclw7b4k0pdfkljw78ijgk-postgresql-9.4.5/include/]\nextra-lib-dirs: [/nix/store/jrdvjvf0w9nclw7b4k0pdfkljw78ijgk-postgresql-9.4.5/lib/]\n</code></pre>\n\n<p>You may want to check first which <code>postgresql</code>'s path from the <code>/nix/store</code> you should use with <code>include/</code> and <code>lib/</code>:</p>\n\n<pre><code>nix-build --no-out-link \"&lt;nixpkgs&gt;\" -A postgresql\n</code></pre>\n\n<p>And BTW, why do you use <code>nix-shell</code> if you are going to use <code>stack</code> <em>and</em> you have <code>project-karma.cabal</code> available..? Have you considered <a href=\"http://docs.haskellstack.org/en/stable/GUIDE.html#existing-projects\" rel=\"nofollow\">migrating your project</a> with <code>stack init</code>..?</p>\n"}], "owner": {"reputation": 349, "user_id": 2635503, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/795ac058dbfa6848b9b17c39adabfdd5?s=128&d=identicon&r=PG", "display_name": "Markus Barthlen", "link": "https://stackoverflow.com/users/2635503/markus-barthlen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1117, "favorite_count": 1, "accepted_answer_id": 34700003, "answer_count": 2, "score": 1, "last_activity_date": 1452408578, "creation_date": 1452346675, "last_edit_date": 1452408578, "question_id": 34694130, "link": "https://stackoverflow.com/questions/34694130/nix-shell-command-stack-build-leads-to-libpq-fe-h-no-such-file-or-directory", "title": "nix-shell --command `stack build` leads to libpq-fe.h: No such file or directory", "body": "<p>i am trying to compile my small project (a yesod application with lambdacms) on nixos. However, after using cabal2nix (more precisely cabal2nix project-karma.cabal --sha256=0 --shell > shell.nix) , I am still missing a dependency wrt. postgresql it seems. </p>\n\n<p>My shell.nix file looks like this:</p>\n\n<pre><code>{ nixpkgs ? import &lt;nixpkgs&gt; {}, compiler ? \"default\" }:\n\nlet\n\n inherit (nixpkgs) pkgs;\n\n f = { mkDerivation, aeson, base, bytestring, classy-prelude\n      , classy-prelude-conduit, classy-prelude-yesod, conduit, containers\n      , data-default, directory, fast-logger, file-embed, filepath\n      , hjsmin, hspec, http-conduit, lambdacms-core, monad-control\n      , monad-logger, persistent, persistent-postgresql\n      , persistent-template, random, resourcet, safe, shakespeare, stdenv\n      , template-haskell, text, time, transformers, unordered-containers\n      , uuid, vector, wai, wai-extra, wai-logger, warp, yaml, yesod\n      , yesod-auth, yesod-core, yesod-form, yesod-static, yesod-test\n      }:\n      mkDerivation {\n        pname = \"karma\";\n        version = \"0.0.0\";\n        sha256 = \"0\";\n        isLibrary = true;\n        isExecutable = true;\n        libraryHaskellDepends = [\n          aeson base bytestring classy-prelude classy-prelude-conduit\n          classy-prelude-yesod conduit containers data-default directory\n          fast-logger file-embed filepath hjsmin http-conduit lambdacms- core\n          monad-control monad-logger persistent persistent-postgresql\n          persistent-template random safe shakespeare template-haskell  text\n          time unordered-containers uuid vector wai wai-extra wai-logger      warp\n          yaml yesod yesod-auth yesod-core yesod-form yesod-static\n          nixpkgs.zlib\n          nixpkgs.postgresql\n          nixpkgs.libpqxx\n        ];\n        libraryPkgconfigDepends = [ persistent-postgresql];\n        executableHaskellDepends = [ base ];\n        testHaskellDepends = [\n          base classy-prelude classy-prelude-yesod hspec monad-logger\n          persistent persistent-postgresql resourcet shakespeare     transformers\n          yesod yesod-core yesod-test\n        ];\n        license = stdenv.lib.licenses.bsd3;\n      };\n\n  haskellPackages = if compiler == \"default\"\n                       then pkgs.haskellPackages\n                       else pkgs.haskell.packages.${compiler};\n\n  drv = haskellPackages.callPackage f {};\n\n in\n\n  if pkgs.lib.inNixShell then drv.env else drv\n</code></pre>\n\n<p>The output is as follows:</p>\n\n<pre><code>markus@nixos ~/git/haskell/karma/karma (git)-[master] % nix-shell     --command `stack build`\npostgresql-libpq-0.9.1.1: configure\nReadArgs-1.2.2: download\npostgresql-libpq-0.9.1.1: build\nReadArgs-1.2.2: configure\nReadArgs-1.2.2: build\nReadArgs-1.2.2: install\n\n--  While building package postgresql-libpq-0.9.1.1 using:\n      /run/user/1000/stack31042/postgresql-libpq-0.9.1.1/.stack-work/dist/x86_64-linux/Cabal-1.22.4.0/setup/setup --builddir=.stack-work/dist/x86_64-linux/Cabal-1.22.4.0/ build --ghc-options \" -ddump-hi -ddump-to-file\"\nProcess exited with code: ExitFailure 1\nLogs have been written to: /home/markus/git/haskell/karma/karma/.stack-work/logs/postgresql-libpq-0.9.1.1.log\n\n[1 of 1] Compiling Main             ( /run/user/1000/stack31042/postgresql-libpq-0.9.1.1/Setup.hs, /run/user/1000/stack31042/postgresql-libpq-0.9.1.1/.stack-work/dist/x86_64-linux/Cabal-1.22.4.0/setup/Main.o )\nLinking /run/user/1000/stack31042/postgresql-libpq-0.9.1.1/.stack-work/dist/x86_64-linux/Cabal-1.22.4.0/setup/setup ...\nConfiguring postgresql-libpq-0.9.1.1...\nBuilding postgresql-libpq-0.9.1.1...\nPreprocessing library postgresql-libpq-0.9.1.1...\nLibPQ.hsc:213:22: fatal error: libpq-fe.h: No such file or directory\ncompilation terminated.\ncompiling .stack-work/dist/x86_64-linux/Cabal-1.22.4.0/build/Database/PostgreSQL/LibPQ_hsc_make.c failed (exit code 1)\ncommand was: /nix/store/9fbfiij3ajnd3fs1zyc2qy0ispbszrr7-gcc-wrapper-4.9.3/bin/gcc -c .stack-work/dist/x86_64-linux/Cabal-1.22.4.0/build/Database/PostgreSQL/LibPQ_hsc_make.c -o .stack-work/dist/x86_64-linux/Cabal-1.22.4.0/build/Database/PostgreSQL/LibPQ_hsc_make.o -fno-stack-protector -D__GLASGOW_HASKELL__=710 -Dlinux_BUILD_OS=1 -Dx86_64_BUILD_ARCH=1 -Dlinux_HOST_OS=1 -Dx86_64_HOST_ARCH=1 -I/run/current-system/sw/include -Icbits -I.stack-work/dist/x86_64-linux/Cabal-1.22.4.0/build/autogen -include .stack-work/dist/x86_64-linux/Cabal-1.22.4.0/build/autogen/cabal_macros.h -I/nix/store/xphvly2zcd6jsc2xklz1zmmz4y0dh3ny-ghc-7.10.2/lib/ghc-7.10.2/bytes_6elQVSg5cWdFrvRnfxTUrH/include -I/nix/store/xphvly2zcd6jsc2xklz1zmmz4y0dh3ny-ghc-7.10.2/lib/ghc-7.10.2/base_GDytRqRVSUX7zckgKqJjgw/include -I/nix/store/6ykqcjxr74l642kv9gf1ib8v9yjsgxr9-gmp-5.1.3/include -I/nix/store/xphvly2zcd6jsc2xklz1zmmz4y0dh3ny-ghc-7.10.2/lib/ghc-7.10.2/integ_2aU3IZNMF9a7mQ0OzsZ0dS/include -I/nix/store/xphvly2zcd6jsc2xklz1zmmz4y0dh3ny-ghc-7.10.2/lib/ghc-7.10.2/include -I/nix/store/xphvly2zcd6jsc2xklz1zmmz4y0dh3ny-ghc-7.10.2/lib/ghc-7.10.2/include/\n</code></pre>\n\n<p>I assume not much is missing, so a pointer would be nice.\nWhat is also weird, that is that \"nix-shell\" works but following that up with \"stack exec yesod devel\" tells me </p>\n\n<pre><code>Resolving dependencies... \nConfiguring karma-0.0.0...\ncabal: At least the following dependencies are missing:\nclassy-prelude &gt;=0.10.2,\nclassy-prelude-conduit &gt;=0.10.2,\nclassy-prelude-yesod &gt;=0.10.2,\nhjsmin ==0.1.*,\nhttp-conduit ==2.1.*,\nlambdacms-core &gt;=0.3.0.2 &amp;&amp; &lt;0.4,\nmonad-logger ==0.3.*,\npersistent &gt;=2.0 &amp;&amp; &lt;2.3,\npersistent-postgresql &gt;=2.1.1 &amp;&amp; &lt;2.3,\npersistent-template &gt;=2.0 &amp;&amp; &lt;2.3,\nuuid &gt;=1.3,\nwai-extra ==3.0.*,\nwarp &gt;=3.0 &amp;&amp; &lt;3.2,\nyesod &gt;=1.4.1 &amp;&amp; &lt;1.5,\nyesod-auth &gt;=1.4.0 &amp;&amp; &lt;1.5,\nyesod-core &gt;=1.4.6 &amp;&amp; &lt;1.5,\nyesod-form &gt;=1.4.0 &amp;&amp; &lt;1.5,\nyesod-static &gt;=1.4.0.3 &amp;&amp; &lt;1.6\n</code></pre>\n\n<p>When using mysql instead, I am getting</p>\n\n<pre><code>pcre-light-0.4.0.4: configure\nmysql-0.1.1.8: configure\nmysql-0.1.1.8: build\nProgress: 2/59\n--  While building package mysql-0.1.1.8 using:\n          /run/user/1000/stack12820/mysql-0.1.1.8/.stack-work/dist/x86_64-linux/Cabal-1.22.4.0/setup/setup --builddir=.stack-work/dist/x86_64-    linux/Cabal-1.22.4.0/ build --ghc-options \" -ddump-hi -ddump-to-file\"\nProcess exited with code: ExitFailure 1\nLogs have been written to: /home/markus/git/haskell/karma/karma/.stack-work/logs/mysql-0.1.1.8.log\n\n[1 of 1] Compiling Main             ( /run/user/1000/stack12820/mysql-0.1.1.8/Setup.lhs, /run/user/1000/stack12820/mysql-0.1.1.8/.stack-work/dist/x86_64-linux/Cabal-1.22.4.0/setup/Main.o )\nLinking /run/user/1000/stack12820/mysql-0.1.1.8/.stack-work/dist/x86_64-linux/Cabal-1.22.4.0/setup/setup ...\nConfiguring mysql-0.1.1.8...\nBuilding mysql-0.1.1.8...\nPreprocessing library mysql-0.1.1.8...\nIn file included from C.hsc:68:0:\ninclude/mysql_signals.h:9:19: fatal error: mysql.h: No such file or directory\n #include \"mysql.h\"\n                   ^\ncompilation terminated.\ncompiling .stack-work/dist/x86_64-linux/Cabal-1.22.4.0/build/Database/MySQL/Base/C_hsc_make.c failed (exit code 1)\ncommand was: /nix/store/9fbfiij3ajnd3fs1zyc2qy0ispbszrr7-gcc-wrapper-4.9.3/bin/gcc -c .stack-work/dist/x86_64-linux/Cabal-1.22.4.0/build/Database/MySQL/Base/C_hsc_make.c -o .stack-work/dist/x86_64-linux/Cabal-1.22.4.0/build/Database/MySQL/Base/C_hsc_make.o -fno-stack-protector -D__GLASGOW_HASKELL__=710 -Dlinux_BUILD_OS=1 -Dx86_64_BUILD_ARCH=1 -Dlinux_HOST_OS=1 -Dx86_64_HOST_ARCH=1 -I/nix/store/7ppa4k2drrvjk94rb60c1df9nvw0z696-mariadb-10.0.22-lib/include -I/nix/store/7ppa4k2drrvjk94rb60c1df9nvw0z696-mariadb-10.0.22-lib/include/.. -Iinclude -I.stack-work/dist/x86_64-linux/Cabal-1.22.4.0/build/autogen -include .stack-work/dist/x86_64-linux/Cabal-1.22.4.0/build/autogen/cabal_macros.h -I/nix/store/xphvly2zcd6jsc2xklz1zmmz4y0dh3ny-ghc-7.10.2/lib/ghc-7.10.2/bytes_6elQVSg5cWdFrvRnfxTUrH/include -I/nix/store/xphvly2zcd6jsc2xklz1zmmz4y0dh3ny-ghc-7.10.2/lib/ghc-7.10.2/base_GDytRqRVSUX7zckgKqJjgw/include -I/nix/store/6ykqcjxr74l642kv9gf1ib8v9yjsgxr9-gmp-5.1.3/include -I/nix/store/xphvly2zcd6jsc2xklz1zmmz4y0dh3ny-ghc-7.10.2/lib/ghc-7.10.2/integ_2aU3IZNMF9a7mQ0OzsZ0dS/include -I/nix/store/xphvly2zcd6jsc2xklz1zmmz4y0dh3ny-ghc-7.10.2/lib/ghc-7.10.2/include -I/nix/store/xphvly2zcd6jsc2xklz1zmmz4y0dh3ny-ghc-7.10.2/lib/ghc-7.10.2/include/\n\n\n--  While building package pcre-light-0.4.0.4 using:\n  /home/markus/.stack/setup-exe-cache/setup-Simple-Cabal-1.22.4.0-x86_64-linux-ghc-7.10.2 --builddir=.stack-work/dist/x86_64-linux/Cabal-1.22.4.0/ configure --with-ghc=/run/current-system/sw/bin/ghc --user --package-db=clear --package-db=global --package-db=/home/markus/.stack/snapshots/x86_64-linux/nightly-2015-11-17/7.10.2/pkgdb/ --libdir=/home/markus/.stack/snapshots/x86_64-linux/nightly-2015-11-17/7.10.2/lib --bindir=/home/markus/.stack/snapshots/x86_64-linux/nightly-2015-11-17/7.10.2/bin --datadir=/home/markus/.stack/snapshots/x86_64-linux/nightly-2015-11-17/7.10.2/share --libexecdir=/home/markus/.stack/snapshots/x86_64-linux/nightly-2015-11-17/7.10.2/libexec --sysconfdir=/home/markus/.stack/snapshots/x86_64-linux/nightly-2015-11-17/7.10.2/etc --docdir=/home/markus/.stack/snapshots/x86_64-linux/nightly-2015-11-17/7.10.2/doc/pcre-light-0.4.0.4 --htmldir=/home/markus/.stack/snapshots/x86_64-linux/nightly-2015-11-17/7.10.2/doc/pcre-light-0.4.0.4 --haddockdir=/home/markus/.stack/snapshots/x86_64-linux/nightly-2015-11-17/7.10.2/doc/pcre-light-0.4.0.4 --dependency=base=base-4.8.1.0-4f7206fd964c629946bb89db72c80011 --dependency=bytestring=bytestring-0.10.6.0-18c05887c1aaac7adb3350f6a4c6c8ed\nProcess exited with code: ExitFailure 1\nLogs have been written to: /home/markus/git/haskell/karma/karma/.stack-work/logs/pcre-light-0.4.0.4.log\n\nConfiguring pcre-light-0.4.0.4...\nsetup-Simple-Cabal-1.22.4.0-x86_64-linux-ghc-7.10.2: The program 'pkg-config'\nversion &gt;=0.9.0 is required but it could not be found.\n</code></pre>\n\n<p>After adding pkgconfig to my global configuration, the build seems to get a little further ahead, so it seems that shell.nix is ignored somewhat.</p>\n\n<p>(Sources for what I tried so far:\n<a href=\"https://groups.google.com/forum/#!topic/haskell-stack/_ZBh01VP_fo\" rel=\"nofollow\">https://groups.google.com/forum/#!topic/haskell-stack/_ZBh01VP_fo</a>)</p>\n\n<p>Update: It seems like I overlooked this section of the manual\n<a href=\"http://nixos.org/nixpkgs/manual/#using-stack-together-with-nix\" rel=\"nofollow\">http://nixos.org/nixpkgs/manual/#using-stack-together-with-nix</a>\nHowever, the first idea that came to mind \n(stack --extra-lib-dirs=/nix/store/c6qy7n5wdwl164lnzha7vpc3av9yhnga-postgresql-libpq-0.9.1.1/lib build)\ndid not work yet, most likely I need to use \n--extra-include-dirs or try one of the variations. It seems weird that stack is still trying to build postgresql-libpq in the very same version, though.</p>\n\n<p>Update2: Currently trying out \"stack --extra-lib-dirs=/nix/store/1xf77x47d0m23nbda0azvkvj8w8y77c7-postgresql-9.4.5/lib --extra-include-dirs=/nix/store/1xf77x47d0m23nbda0azvkvj8w8y77c7-postgresql-9.4.5/include build\" which looks promising. Does not look like the nix-way, but still.</p>\n\n<p>Update3: Still getting </p>\n\n<pre><code>&lt;command line&gt;: can't load .so/.DLL for: /home/markus    /.stack/snapshots/x86_64-linux/nightly-2015-11-17/7.10.2/lib/x86_64-linux-  ghc-7.10.2/postgresql-libpq-0.9.1.1-ABGs5p1J8FbEwi6uvHaiV6/libHSpostgresql-libpq-0.9.1.1-ABGs5p1J8FbEwi6uvHaiV6-ghc7.10.2.so \n(libpq.so.5: cannot open shared object file: No such file or directory) stack   build  186.99s user 2.93s system 109% cpu 2:52.76 total\n</code></pre>\n\n<p>which is strange since libpq.so.5 is contained in /nix/store/1xf77x47d0m23nbda0azvkvj8w8y77c7-postgresql-9.4.5/lib.\nAn additional </p>\n\n<pre><code>$LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:/nix/store/1xf77x47d0m23nbda0azvkvj8w8y77c7-postgresql-9.4.5/lib\n</code></pre>\n\n<p>does not help either.</p>\n\n<p>Update4:\nBy the way, yesod devel does the same as stack exec yesod devel. My libraries are downloaded to /nix/store but they are not recognized.\nMaybe I need to make \"build-nix\" work and yesod devel does not work here?</p>\n\n<p>Just for completeness, here is stack.yaml</p>\n\n<pre><code>resolver: nightly-2015-11-17\n#run stack setup otherwise!!\n\n# Local packages, usually specified by relative directory name\npackages:\n- '.'\n\n# Packages to be pulled from upstream that are not in the resolver (e.g.,    acme-missiles-0.3)\nextra-deps: [lambdacms-core-0.3.0.2 , friendly-time-0.4, lists-0.4.2,     list-extras-0.4.1.4  ]\n\n\n # Override default flag values for local packages and extra-deps\nflags:\n  karma:\n    library-only: false\n    dev: false\n\n# Extra package databases containing global packages\nextra-package-dbs: []\n</code></pre>\n\n<p>Next weekend, I will check out \n<a href=\"https://pr06lefs.wordpress.com/2014/09/27/compiling-a-yesod-project-on-nixos/\" rel=\"nofollow\">https://pr06lefs.wordpress.com/2014/09/27/compiling-a-yesod-project-on-nixos/</a>\nand other search results.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2846, "user_id": 4347335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7e6f293a134a5defec74e12cae42cc?s=128&d=identicon&r=PG&f=1", "display_name": "cchalmers", "link": "https://stackoverflow.com/users/4347335/cchalmers"}, "edited": false, "score": 1, "creation_date": 1452348799, "post_id": 34693952, "comment_id": 57134926, "body": "If you&#39;re looking for a more accuracy than <code>Double</code> that can be unboxed, try <a href=\"https://hackage.haskell.org/package/compensated\" rel=\"nofollow noreferrer\"><code>compensated</code></a>. It already contains the <code>Unbox</code> instances."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1452348787, "post_id": 34694451, "comment_id": 57134922, "body": "Basically, only types with finite information content can be unboxed. It&#39;s the very nature of <code>CReal</code> to have possibly-infinite information content, \u201cinfinite resolution\u201d. For <code>BigFloat</code> this is not so clear \u2013 I suppose one could devise a similar type that <i>would</i>, for any given precision, be unboxable."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 2, "last_activity_date": 1452352095, "last_edit_date": 1452352095, "creation_date": 1452348465, "answer_id": 34694451, "question_id": 34693952, "link": "https://stackoverflow.com/questions/34693952/making-creal-and-bigfloat-e-in-data-number-instances-of-unbox/34694451#34694451", "title": "Making `CReal` and `BigFloat e` in Data.Number instances of `Unbox`", "body": "<p>Looking at the sources of <code>CReal</code> and <code>BigFloat</code>, it seems that neither of them can be unboxed. </p>\n\n<p><code>CReal</code> can't be unboxed because it's <a href=\"https://hackage.haskell.org/package/numbers-3000.2.0.1/docs/src/Data-Number-CReal.html#CReal\" rel=\"nofollow\">a function</a>:</p>\n\n<pre><code>data CReal = CR (Int -&gt; Integer)\n</code></pre>\n\n<p><code>BigFloat</code> <a href=\"https://hackage.haskell.org/package/numbers-3000.2.0.1/docs/Data-Number-BigFloat.html\" rel=\"nofollow\">contains</a> <code>Integer</code>, and <code>Integer</code> can't be unboxed either, because it is backed by a variable-sized bytearray. </p>\n"}], "owner": {"reputation": 117, "user_id": 5592551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d521a4021aea28572ece936720e60925?s=128&d=identicon&r=PG&f=1", "display_name": "hsk6", "link": "https://stackoverflow.com/users/5592551/hsk6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 34694451, "answer_count": 1, "score": 2, "last_activity_date": 1452352095, "creation_date": 1452345623, "question_id": 34693952, "link": "https://stackoverflow.com/questions/34693952/making-creal-and-bigfloat-e-in-data-number-instances-of-unbox", "title": "Making `CReal` and `BigFloat e` in Data.Number instances of `Unbox`", "body": "<p>If I want to use <code>CReal</code> or <code>BigFloat e</code> in Data.Number (more accuracy than <code>Double</code>) in unboxed vectors, I have to give them instances of <code>Unbox</code>. Can you tell me how to do this?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1452351920, "last_edit_date": 1452351920, "creation_date": 1452347434, "answer_id": 34694262, "question_id": 34692858, "link": "https://stackoverflow.com/questions/34692858/rewriting-pseudocode-to-haskell/34694262#34694262", "title": "rewriting pseudocode to Haskell", "body": "<p>A list can not be its own element in Haskell. Even in languages where you can construct such a construct, the only thing you could know about such a thing is that it is a list which is its own element.</p>\n\n<p>On one hand, from your 2nd equation, what <code>fillRes</code> returns is an element of a list that <code>addexam</code> returns.</p>\n\n<p>On the other hand, from your 3rd equation, what <code>addexam</code> returns is the same thing as what <code>fillRes</code> returns. Hence the error.</p>\n\n<p>You can fix it by changing <code>:</code> into <code>++</code>, as </p>\n\n<pre><code>addexam currentSchedule listOfExams = let result = []\n                                          res = fillRes currentSchedule listOfExams\n                                       in res ++ result\n</code></pre>\n\n<p>Of course <code>res ++ []</code> is just <code>res</code>, and <code>let x = ... in x</code> is just <code>...</code> (when <code>x</code> isn't referred to inside the <code>...</code> expression).</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1452360892, "post_id": 34695049, "comment_id": 57139395, "body": "Trying to add something and possibly failing typically results in a <code>Maybe</code> in idiomatic code, rather than a flagged value. Of course, it all depends on how it&#39;s to be used."}, {"owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452363437, "post_id": 34695049, "comment_id": 57140367, "body": "Good point, @dfeuer, I&#39;ve changed my answer to be a bit more idiomatic."}], "tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 2, "last_activity_date": 1452363392, "last_edit_date": 1452363392, "creation_date": 1452351761, "answer_id": 34695049, "question_id": 34692858, "link": "https://stackoverflow.com/questions/34692858/rewriting-pseudocode-to-haskell/34695049#34695049", "title": "rewriting pseudocode to Haskell", "body": "<p>There's some type confusion inside your pseudo-code which is carrying over to your Haskell example and since you have no type annotations, it makes the code hard to reason about, and makes the error messages especially opaque.</p>\n\n<p>Based on what I <em>think</em> you're trying to do, here's an attempt at refining your <code>addExam</code> function in Haskell.</p>\n\n<p>First we need to define the types. From what I infer from your description, you've got a <code>PossibleExam</code> type that will probably have things like Time and Subject fields down the road, but for the example, we only need a type constructor:</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>data PossibleExam = PossibleExam -- you'll probably have other fields like Time, Subject, etc.\n</code></pre>\n\n<p>I'm assuming that your <code>Exam</code> type is just a list of <code>PossibleExams</code>, most likely split up by common subjects.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type Exam = [PossibleExam]\n</code></pre>\n\n<p>I'm also assuming that the <code>Schedule</code> type is a list of <code>PossibleExams</code>, split up by times to avoid overlap.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type Schedule = [PossibleExam]\n</code></pre>\n\n<p>You'll avoid a lot of problems by starting off with type signatures on the functions you're creating. Based on my assumptions above, <code>addExam</code> will have a shape like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>addExam :: Schedule -&gt; [Exam] -&gt; Schedule\n</code></pre>\n\n<p>If there are no exams left to add, we can return the current Schedule:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>addExam currentSchedule [] =\n  currentSchedule\n</code></pre>\n\n<p>And if there are exams left to add, we can do so by using the yet-to-be-defined <code>tryAddExam</code> function (I'll leave it as an exercise to you to figure out what you want to do in case an exam can't be added):</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>addExam currentSchedule (doodle:examsLeft) =\n  case tryAddExam currentSchedule doodle of\n    Just newSchedule -&gt;\n      addExam newSchedule examsLeft\n    Nothing -&gt; \n      undefined -- What do you do if the exam won't fit? \n</code></pre>\n\n<p>The <code>tryAddExam</code> function can return a <code>Maybe Schedule</code> that represents success with a <code>Just Schedule</code> or failure with <code>Nothing</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>tryAddExam :: Schedule -&gt; Exam -&gt; Maybe Schedule\n</code></pre>\n\n<p>If we've exhausted all possible exams, then we return a failure:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>tryAddExam currentSchedule [] =\n  Nothing\n</code></pre>\n\n<p>Otherwise, if there are exams left to attempt, we use your <code>isValid</code> function to test whether we can add them and if so, add them to the current schedule:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>tryAddExam currentSchedule (possibleExam:rest) =\n  if isValid possibleExam currentSchedule then\n    Just $ possibleExam : currentSchedule\n  else\n    tryAddExam currentSchedule rest\n</code></pre>\n\n<p>Hopefully I'm on the right track with your intentions inside the pseudo-code, overlooking some of the array and type confusion in the example. The main thing to get across here is the importance of clearly defining your types and function signatures. Let the types guide you.</p>\n"}], "owner": {"reputation": 367, "user_id": 4716940, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/363a400a9b096b10c2ba8070f7b12f35?s=128&d=identicon&r=PG&f=1", "display_name": "demathieu", "link": "https://stackoverflow.com/users/4716940/demathieu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 34695049, "answer_count": 2, "score": 1, "last_activity_date": 1452363392, "creation_date": 1452338703, "last_edit_date": 1452347861, "question_id": 34692858, "link": "https://stackoverflow.com/questions/34692858/rewriting-pseudocode-to-haskell", "title": "rewriting pseudocode to Haskell", "body": "<p>I'm trying to write the pseudo code from beneath into a Haskell function.\nI was able to write the isValid function, which takes an exam and the current schedule and checks if it the exam would fit into the current schedule.\nThis is my current attempt:</p>\n\n<pre><code>addexam currentSchedule [] = currentSchedule\naddexam currentSchedule listOfExams = let result = []\n                                          res = fillRes currentSchedule listOfExams\n                                       in (res: result)\n\nfillRes currentSchedule (x:xs) | isValid x currentSchedule = addexam (x:currentSchedule) xs\n                               | otherwise = addexam currentSchedule []\n</code></pre>\n\n<p>I know that in my version is not correct but I completely understand what is missing. Also I get this error:</p>\n\n<pre><code> Occurs check: cannot construct the infinite type: t ~ [t]\n    Expected type: [t] -&gt; [t] -&gt; t\n      Actual type: [t] -&gt; [t] -&gt; [t]\n    Relevant bindings include\n      res :: t (bound at Server.hs:170:43)\n      listOfExams :: [t] (bound at Server.hs:169:25)\n      currentSchedule :: [t] (bound at Server.hs:169:9)\n      addexam :: [t] -&gt; [t] -&gt; [t] (bound at Server.hs:168:1)\n    In the expression: fillRes currentSchedule listOfExams\n    In an equation for \u2018res\u2019: res = fillRes currentSchedule listOfExams\n    In the expression:\n      let\n        result = []\n        res = fillRes currentSchedule listOfExams\n      in (res : result)\n</code></pre>\n\n<p>Pseudo-Code : </p>\n\n<pre><code>addExam (currentSchedule, examsLeft):\n    if examsLeft.empty():\n        return [currentSchedule]\n    doodle = examsLeft[0]\n    results = []\n    for each possible-exam in doodle\n        if is-valid (possible-exam, currentSchedule):\n            res = addExam (currentSchedule.append(possible-exam), examsLeft[1:])\n        results.append(res)\n    return results \n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "edited": false, "score": 3, "creation_date": 1452340259, "post_id": 34692809, "comment_id": 57132202, "body": "I don&#39;t get why somebody would want to close this. It&#39;s a viable question with a definite value for the beginners."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1452342299, "post_id": 34693016, "comment_id": 57132835, "body": "When you actually do need all the results, strict evaluation is <i>sometimes</i> faster. Sometimes, it loses locality and only fusion can recover it."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 13, "last_activity_date": 1452349369, "last_edit_date": 1452349369, "creation_date": 1452339767, "answer_id": 34693016, "question_id": 34692809, "link": "https://stackoverflow.com/questions/34692809/lists-boxed-vectors-and-unboxed-vectors-for-heavy-scientific-computations/34693016#34693016", "title": "Lists, boxed vectors, and unboxed vectors for heavy scientific computations", "body": "<p>A couple of things to understand. First, boxed vs unboxed:</p>\n\n<ul>\n<li><p>If you have a \"boxed\" number, basically you have a <em>pointer to</em> a number. (Or possibly a pointer to an unevaluated expression that will <em>produce</em> a number if it ever gets evaluated.)</p></li>\n<li><p>If you have an \"unboxed\" number, you have literally the number itself.</p></li>\n</ul>\n\n<p>For example, on a 64-bit platform, <code>Char</code> is a 64-bit pointer to somewhere on the Haskell heap that holds either a 32-bit Unicode codepoint, <em>or</em> an arbitrarily large unevaluated expression that produces such. On the other hand, <code>Char#</code> is <em>literally</em> just a 32-bit integer. It could be on the heap somewhere, or it could be in a CPU register or something.</p>\n\n<p>Basically <code>Char#</code> is what C would think of as an integer, whereas <code>Char</code> is what C would think of as a pointer to... actually a data structure that tells you if it's evaluated or not, and if it <em>is</em> evaluated, the integer is in there. Which is quite a bit more complicated.</p>\n\n<p>An important thing to notice is that a boxed value is potentially unevaluated; the pointer can point to the result, or the expression for producing the result. An <em>unboxed</em> value can never be unevaluated. For example, a 32-bit integer cannot possibly store an arbitrarily huge expression for calculating an integer; it can only store the integer itself. So boxed vs unboxed is unavoidably tangled up with lazy vs strict.</p>\n\n<p>Lazy evaluation can allow you to avoid calculating result you don't actually need. (Infinite lists and so forth.) But if you actually <em>do</em> always need <em>all</em> the results, strict evaluation is actually faster.</p>\n\n<p>Next, lists vs vectors:</p>\n\n<ul>\n<li><p>A Haskell list <code>[Double]</code> (or whatever) is a singly-linked list of pointers to double-precision floats. Each float could be unevaluated, and each link in the list could also be unevaluated. As you can imagine, this has no kind of cache coherence whatsoever!</p></li>\n<li><p>A vector is an <em>array</em> of stuff. This means no infinite vectors; the size of the vector must be known at creation time. It also means that to modify an immutable vector, you must <em>copy</em> the entire thing, which is very inefficient in time and space. Otherwise you must use mutable vectors, which negates some of the benefits of functional programming. <em>On the other hand</em>, vectors have awesome cache coherence!</p></li>\n</ul>\n\n<p>Now, a boxed vector is basically an array of pointers to the actual data. An unboxed vector is an array of the actual data. Wanna take a guess which of those has the best cache behaviour? As a side effect, an unboxed vector is also strict, which &mdash; <em>if</em> you need the whole vector &mdash; is going to be faster.</p>\n\n<p>So you see, unboxed vectors place certain restrictions on you, but potentially give best performance.</p>\n\n<p>Having just said all that, GHC performs all kinds of tricky optimisations that can radically alter the performance of the code versus what it \"appears\" to be doing. GHC may turn lazy code into strict code, and it may perform \"list fusion\", where chains of functions that loop over lists get turns into a single tight loop. But then again, chains of vector operations get fused as well, so... in reality, actual performance rather depends on what you're trying to do.</p>\n"}], "owner": {"reputation": 117, "user_id": 5592551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d521a4021aea28572ece936720e60925?s=128&d=identicon&r=PG&f=1", "display_name": "hsk6", "link": "https://stackoverflow.com/users/5592551/hsk6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 760, "favorite_count": 2, "accepted_answer_id": 34693016, "answer_count": 1, "score": 5, "last_activity_date": 1452349369, "creation_date": 1452338390, "last_edit_date": 1452339358, "question_id": 34692809, "link": "https://stackoverflow.com/questions/34692809/lists-boxed-vectors-and-unboxed-vectors-for-heavy-scientific-computations", "title": "Lists, boxed vectors, and unboxed vectors for heavy scientific computations", "body": "<p>I'm told that I should use unboxed vectors for heavy scientific computations (simulations that run for hours and even days) instead of lists, or even boxed vectors.</p>\n\n<ol>\n<li>Is this true?</li>\n<li>Are there other data structures than lists, boxed vectors, or unboxed vectors that are common?</li>\n<li>Can you explain the difference between boxed and unboxed vectors?</li>\n</ol>\n"}, {"tags": ["haskell", "linker-errors"], "comments": [{"owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "edited": false, "score": 0, "creation_date": 1452335934, "post_id": 34690999, "comment_id": 57130860, "body": "Some suggestions: Use a more recent ghc version. Use stack to handle your project dependencies."}], "answers": [{"tags": [], "owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "is_accepted": true, "score": 0, "last_activity_date": 1452352830, "creation_date": 1452352830, "answer_id": 34695250, "question_id": 34690999, "link": "https://stackoverflow.com/questions/34690999/linker-error-while-compiling-haskell-program/34695250#34695250", "title": "Linker error while compiling Haskell program", "body": "<p>You seem to have two <code>text</code> packages installed. Try <code>ghc-pkg list text</code> to confirm that. If it is the case, you can hide one of them, e.g. <code>ghc -hide-package=text-1.2.0.3</code>. Note: it may lead to some other packages to be hidden too, it that case you can cabalize the code or use <code>stack</code> to ensure only one version of <code>text</code> will be linked.</p>\n\n<p>The functions like <code>hs_text_memcpy</code> come from here: <a href=\"https://github.com/bos/text/blob/master/cbits/cbits.c#L14\" rel=\"nofollow\">https://github.com/bos/text/blob/master/cbits/cbits.c#L14</a></p>\n"}], "owner": {"reputation": 807, "user_id": 3797372, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b6eef1200e98f241944d00e0da915466?s=128&d=identicon&r=PG&f=1", "display_name": "siddhant", "link": "https://stackoverflow.com/users/3797372/siddhant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 34695250, "answer_count": 1, "score": 1, "last_activity_date": 1452352830, "creation_date": 1452325344, "question_id": 34690999, "link": "https://stackoverflow.com/questions/34690999/linker-error-while-compiling-haskell-program", "title": "Linker error while compiling Haskell program", "body": "<p>I am writing a web server in Haskell using happstack. The webserver takes an arithmetic equation as input, evaluates it and returns the result. On the server side I need to cache the result of any previous query. I am using redis key-value datastore for the same. Following is what I have written till now.</p>\n\n<pre><code>module Main where\n\nimport Control.Monad (msum)\nimport Control.Monad.Trans.Class\nimport Language.Haskell.Interpreter\nimport Happstack.Server (nullConf, simpleHTTP, toResponse, ok, path, dir)\nimport Happstack.Server.Internal.Monads\nimport Text.JSON.Generic\nimport qualified Database.Redis as R\nimport qualified Data.ByteString.Char8 as C\n\nmain :: IO ()\nmain = simpleHTTP nullConf $\n        msum [dir \"eval\" $ path $ \\s -&gt; handleRequest s]\n\ndata Response = Response\n        { success :: Bool\n        , cacheHit :: Bool\n        , result :: String\n        , error :: String\n        } deriving (Show, Data, Typeable)\n\nmyConnectionInfo :: R.ConnectInfo\nmyConnectionInfo = R.defaultConnectInfo\n\nhandleRequest :: String -&gt;  ServerPartT IO String\nhandleRequest exp = lift $ evalExp exp\n\nevalExp :: String -&gt; IO String\nevalExp exp = do\n    cachedResult &lt;- checkCache exp\n    -- CODE FOR CHECKING CACHED RESULT IS NOT YET COMPLETE\n    x &lt;- runInterpreter $ setImports [\"Prelude\"] &gt;&gt; eval exp\n    let (error, isSuccess, result) = case x of Left _ -&gt; (\"Parse error\", False, \"\")\n                                               Right b -&gt; (\"\", True, b)\n    let y = Response isSuccess False result error\n    return $ encodeJSON y\n\ncheckCache :: String -&gt; IO (Either R.Reply (Maybe C.ByteString))\ncheckCache exp = do\n        conn &lt;- R.connect myConnectionInfo\n        R.runRedis conn $ R.get $ C.pack exp\n</code></pre>\n\n<p>On compiling the above program I get the following error:</p>\n\n<pre><code>$ ghc calcServer.hs -XDeriveDataTypeable\nLinking calcServer ...\n/home/siddhant/.cabal/lib/text-1.2.2.0/ghc-7.6.3/libHStext-1.2.2.0.a(cbits.o): In function `_hs_text_memcpy':\ncbits.c:(.text+0x0): multiple definition of `_hs_text_memcpy'\n/usr/lib/haskell-packages/ghc/lib/text-0.11.3.1/ghc-7.6.3/libHStext-0.11.3.1.a(cbits.o):(.text+0x0): first defined here\n/home/siddhant/.cabal/lib/text-1.2.2.0/ghc-7.6.3/libHStext-1.2.2.0.a(cbits.o): In function `_hs_text_memcmp':\ncbits.c:(.text+0x20): multiple definition of `_hs_text_memcmp'\n/usr/lib/haskell-packages/ghc/lib/text-0.11.3.1/ghc-7.6.3/libHStext-0.11.3.1.a(cbits.o):(.text+0x20): first defined here\n/home/siddhant/.cabal/lib/text-1.2.2.0/ghc-7.6.3/libHStext-1.2.2.0.a(cbits.o): In function `_hs_text_decode_latin1':\ncbits.c:(.text+0x40): multiple definition of `_hs_text_decode_latin1'\n/usr/lib/haskell-packages/ghc/lib/text-0.11.3.1/ghc-7.6.3/libHStext-0.11.3.1.a(cbits.o):(.text+0x40): first defined here\n/home/siddhant/.cabal/lib/text-1.2.2.0/ghc-7.6.3/libHStext-1.2.2.0.a(cbits.o): In function `_hs_text_decode_utf8':\ncbits.c:(.text+0x2a0): multiple definition of `_hs_text_decode_utf8'\n/usr/lib/haskell-packages/ghc/lib/text-0.11.3.1/ghc-7.6.3/libHStext-0.11.3.1.a(cbits.o):(.text+0xf0): first defined here\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>I can guess that it may be because of different versions of same binaries being linked. Am I right? \nPlease help me how to correct this error</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1452318085, "post_id": 34689080, "comment_id": 57126614, "body": "Please don&#39;t try to learn about monads of any sort until you are <i>thoroughly</i> comfortable with lambda forms. Until then, you should stick to defining pure functions and evaluating expressions in GHCi. It may take you a few days or weeks before you&#39;re ready to move on to fancy things like using monads to structure interpreters. That&#39;s really okay."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1452370337, "post_id": 34689080, "comment_id": 57142903, "body": "<i>&quot; <code>eval x</code> in the line <code>eval (Div x y)</code> will return <code>Just n</code> based on the pattern <code>eval (Val n) = Just n</code>&quot;</i> -- <b><i>if</i></b> <code>x</code> itself is<code>Val n</code>. But it could also be another <code>Div p q</code> expression with some other  subexpressions <code>p</code>, <code>q</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1452370451, "post_id": 34689080, "comment_id": 57142940, "body": "<i>&quot;Because the result of bind operator  <code>&gt;&gt;=</code> is <code>f x</code> in our context, the &quot;lambda&quot;  <code>(\\n -&gt; eval y &gt;&gt;= (\\m -&gt; safediv n m))</code> will be applied on <code>n</code>&quot;</i>. Yes. But to be more precise, if <code>(eval x)</code> has produced <code>Just k</code>, then the &quot;lambda&quot; will be applied on <code>k</code>: <code>(\\n -&gt; eval y &gt;&gt;= (\\m -&gt; safediv n m)) k</code>. Because <code>(Just k) &gt;&gt;= f = f k</code>."}, {"owner": {"reputation": 367, "user_id": 4277150, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/aaeb0451b1f430b5c177aa1f5f3ea8f4?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Govind", "link": "https://stackoverflow.com/users/4277150/mahesh-govind"}, "edited": false, "score": 0, "creation_date": 1452520313, "post_id": 34689080, "comment_id": 57192102, "body": "Thanks every one . I wrote a simple lambda expression and compared it . eg:     (\\x-&gt;(\\y-&gt; (x <code>div</code> y) )4    )400       .  Here 400 is in the place of n in the monad example and 4 is in the place of m ."}], "answers": [{"tags": [], "owner": {"reputation": 32558, "user_id": 101090, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/066290971688c0a44cc4159a9f210dcf?s=128&d=identicon&r=PG", "display_name": "Jorge Israel Pe&#241;a", "link": "https://stackoverflow.com/users/101090/jorge-israel-pe%c3%b1a"}, "is_accepted": false, "score": 1, "last_activity_date": 1452313460, "creation_date": 1452313460, "answer_id": 34689649, "question_id": 34689080, "link": "https://stackoverflow.com/questions/34689080/monads-and-nested-lambdas/34689649#34689649", "title": "Monads, &gt;&gt;=, and &quot;nested lambdas&quot;", "body": "<p>Not quite sure I understand your question. The \"temporary result\" of <code>eval x</code> for example becomes <code>n</code>, and the \"temporary result\" of <code>eval y</code> becomes <code>m</code>. For <code>safediv n m</code>, both <code>n</code> and <code>m</code> are accessible in the scope, so you can refer to them, just as you can refer to any variables in any scope you are in, e.g. when you nest <code>let</code> expressions.</p>\n\n<p>Note that the value (e.g. <code>n</code>) is \"handed\" to the lambda <code>(\\n -&gt; ...)</code> by way of the bind (<code>&gt;&gt;=</code>) definition for <code>Maybe</code>, i.e. <code>(&gt;&gt;=) :: Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b</code>. So for example <code>expr x</code> evaluates to a <code>Maybe a</code> which you then apply to <code>&gt;&gt;=</code>, e.g. <code>themaybe &gt;&gt;= lambda</code>. In the definition below, the lambda corresponds to <code>f</code>, so you can see that if the <code>eval x</code> evaluated to a <code>Just a</code>, it'll apply the <code>x</code> to the lambda (i.e. <code>f x</code>). The lambda itself evaluates to a <code>Maybe a</code>, which is why you can further chain/nest another <code>&gt;&gt;= lambda</code>.</p>\n\n<pre><code> (&gt;&gt;=)   :: Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b\n m &gt;&gt;= f =  case m of\n               Nothing -&gt; Nothing\n               Just x  -&gt; f x\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 4, "last_activity_date": 1452339505, "last_edit_date": 1452339505, "creation_date": 1452316421, "answer_id": 34689952, "question_id": 34689080, "link": "https://stackoverflow.com/questions/34689080/monads-and-nested-lambdas/34689952#34689952", "title": "Monads, &gt;&gt;=, and &quot;nested lambdas&quot;", "body": "\n\n<p>I'm afraid If you don't understand the basics of lexical scoping and lexical closures, then you'll have a hard time understanding such \"state\" management in nested lambdas, especially in the case of desugared monad code. </p>\n\n<p>So the answer to your question lies really not in what you're asking but some missing prerequisites in your understanding. </p>\n\n<p>Consider</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; let f = \\x -&gt; \\y -&gt; y * 2 + x * 7\n&gt; let f' = f 3\n</code></pre>\n\n<p>now <code>f'</code> contains kind of like a closure \u2014 it's the body of the first lambda where the value of <code>x</code> has been remembered as <code>3</code>. Passing a value to <code>f'</code> in turn, also \"fills in the placeholder\" `y, after which the remembered value of x and the now available value of y are (upon demand) used to evaluate the expression 2y+7x. </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; f' 4\n29\n</code></pre>\n\n<p>Monads simply use such constructions for remembering values from previous monadic steps. Of course typically you use the <code>do</code> syntactic sugar which hides away such lambda plumbing. </p>\n\n<hr>\n\n<p>P.S. In case it might not be obvious, these two lines are equivalent:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; let f = \\x -&gt; \\y -&gt; y * 2 + x * 7\n&gt; let f x y = y * 2 + x * 7\n</code></pre>\n\n<p>I simply used the explicitly <a href=\"https://en.m.wikipedia.org/wiki/Currying\" rel=\"nofollow\">curried</a> form to draw a parallel to the monadic lambdas. </p>\n"}], "owner": {"reputation": 367, "user_id": 4277150, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/aaeb0451b1f430b5c177aa1f5f3ea8f4?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Govind", "link": "https://stackoverflow.com/users/4277150/mahesh-govind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1452370316, "creation_date": 1452306462, "last_edit_date": 1452370316, "question_id": 34689080, "link": "https://stackoverflow.com/questions/34689080/monads-and-nested-lambdas", "title": "Monads, &gt;&gt;=, and &quot;nested lambdas&quot;", "body": "<p>I think I am stuck after reading <a href=\"http://www.cs.nott.ac.uk/~pszgmh/monads\" rel=\"nofollow\">Graham Hutton's monad article</a>.\nFollowing is the brick wall. (Text from the article)</p>\n\n<blockquote>\n  <p>Using <code>&gt;&gt;=</code>, our evaluator can now be rewritten as:</p>\n\n<pre><code>eval (Val n) = Just n\neval (Div x y) = eval x &gt;&gt;= (\\n -&gt; eval y &gt;&gt;= (\\m -&gt; safediv n m))\n</code></pre>\n  \n  <p>The case for division can be read as follows: <strong>evaluate x and call\n  its result value n</strong>, then <strong>evaluate y and call its result value m</strong>,\n  and finally combine the two results by applying safediv.</p>\n</blockquote>\n\n<p>I haven't understood how the <strong>temporary results are stored</strong> from lambdas in <code>n</code> and <code>m</code>. What are the rules for \"nesting of lambdas\" and retriving its results?</p>\n\n<hr>\n\n<p><em>edit:</em></p>\n\n<p>I accept that I am a newbie and my basics are not strong .One reason for bad understanding  was the confusion with definition and result of  bind operator <code>&gt;&gt;=</code> . I   over looked the fact that bind operator will return the value of  computation </p>\n\n<pre><code>\"f applied on x\". \n</code></pre>\n\n<p>I'll try to summarize my (half- ) understanding .</p>\n\n<p>Definition of bind operator in this context:</p>\n\n<pre><code>(&gt;&gt;=) :: Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b\nNothing  &gt;&gt;=  _  = Nothing\n(Just x) &gt;&gt;=  f  = f x\n</code></pre>\n\n<p>Interpretation of the above definition:</p>\n\n<p><strong>Signature</strong> - Bind operator takes type of <code>Maybe a</code> ,another higher order function with a signature <code>((a-&gt;maybe a)</code>  and applies it on <code>a</code> and returns a resulting value with type  <code>Maybe b</code></p>\n\n<p><strong>Pattern 1</strong> - When <code>Maybe a</code>  is <code>Nothing</code>, bind operator don't care about the function with a signature <code>(a-&gt;maybe a)</code> --   returns <code>Nothing</code> .</p>\n\n<p><strong>Pattern 2</strong> - When <code>Maybe a</code> is <code>Just x</code>, bind operator cares about the function and applies the function ie ( <code>f x</code> , function <code>f</code>  gets applied with value <code>x</code> from <code>Just x</code> ) and returns the resulting value  with a type <code>Maybe b</code>.</p>\n\n<p>Here <code>a</code> and <code>b</code> can be of different types .For example <code>a</code> can be an integer <code>b</code> can be a <code>String</code> . </p>\n\n<p>Now if we apply our definition of bind in the given division example,</p>\n\n<pre><code>eval (Val n)   = Just n\neval (Div x y) = eval x &gt;&gt;= (\\n -&gt;\n                  eval y &gt;&gt;= (\\m -&gt;\n                  safediv n m))\n</code></pre>\n\n<p><code>eval x</code>   in  the line <code>eval (Div x y)</code>   <strong>will return <code>Just n</code></strong>  based on the pattern  <strong><code>eval (Val n) = Just n</code></strong> . This is the first parameter for the bind operator . hence we can re write  it as</p>\n\n<pre><code>eval (Div x y) = Maybe a &gt;&gt;= f   -- .We are applying `&gt;&gt;=` operator.\n\neval (Div x y) = Just n  &gt;&gt;= (\\n -&gt; eval y &gt;&gt;= (\\m -&gt; safediv n m)) \n</code></pre>\n\n<p>Because the result  of bind operator  <code>&gt;&gt;=</code>  is <strong><code>f x</code></strong>  in our context,  the \"lambda\"  <strong><code>(\\n -&gt; eval y &gt;&gt;= (\\m -&gt; safediv n m))</code></strong>  will be applied on <code>n</code> .</p>\n\n<p>Could you please let me know whether my understanding till this point is correct.\nIf this understanding is correct  ,I need to figure out the result of application of \"lambda\"  <strong><code>(\\n -&gt; eval y &gt;&gt;= (\\m -&gt; safediv n m))</code></strong> on <strong><code>n</code></strong>:</p>\n\n<pre><code> (\\n -&gt; eval y &gt;&gt;= (\\m -&gt; safediv n m)) n\n</code></pre>\n"}, {"tags": ["haskell", "indexing", "error-handling", "ghci"], "comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1452317535, "post_id": 34688983, "comment_id": 57126504, "body": "dependent typing would be a quick fix..."}, {"owner": {"reputation": 1476, "user_id": 700597, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/rWtor.jpg?s=128&g=1", "display_name": "runeks", "link": "https://stackoverflow.com/users/700597/runeks"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1552546215, "post_id": 34688983, "comment_id": 97052393, "body": "@ErikAllik No, adding dependent typing to Haskell is quite likely the slowest possible fix"}], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 5, "last_activity_date": 1452314918, "creation_date": 1452314918, "answer_id": 34689788, "question_id": 34688983, "link": "https://stackoverflow.com/questions/34688983/more-descriptive-error-messages-from-ghc/34689788#34689788", "title": "More Descriptive Error Messages From GHC", "body": "<p><a href=\"https://wiki.haskell.org/Debugging#Stack_trace\">You can use GHC's profiling facilities to get a kind of stack trace on errors</a>, for example, suppose this is your source file:</p>\n\n<pre><code>xs :: [Int]\nxs = [1..10]\n\nfoo :: Int -&gt; IO ()\nfoo i = print $ xs !! i\n\nmain :: IO ()\nmain = mapM_ foo [1..10]\n</code></pre>\n\n<p>If you compile this with</p>\n\n<pre><code>ghc --make -prof -fprof-auto  StackTrace.hs \n</code></pre>\n\n<p>then run it as</p>\n\n<pre><code>./StackTrace +RTS -xc\n</code></pre>\n\n<p>then you get</p>\n\n<pre><code>*** Exception (reporting due to +RTS -xc): (THUNK_1_0), stack trace: \n  GHC.List.CAF\n  --&gt; evaluated by: Main.foo,\n  called from Main.main,\n  called from Main.CAF\nStackTrace: Prelude.!!: index too large\n</code></pre>\n\n<p>which at least tells you the <code>main</code> \u2192 <code>foo</code> chain.</p>\n"}], "owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 3, "accepted_answer_id": 34689788, "answer_count": 1, "score": 7, "last_activity_date": 1452314918, "creation_date": 1452305538, "last_edit_date": 1452314360, "question_id": 34688983, "link": "https://stackoverflow.com/questions/34688983/more-descriptive-error-messages-from-ghc", "title": "More Descriptive Error Messages From GHC", "body": "<p>I ran some code through GHCI, and got this error:</p>\n\n<pre><code>*** Exception: Prelude.!!: index too large\n</code></pre>\n\n<p>After a while I went on to fix the bug (which was caused, as you might imagine, by an index that was too large), but I wish GHC would have told me at what line this large index was being evaluated.  </p>\n\n<p>Is there a way to either</p>\n\n<ul>\n<li>A) make GHCI more verbose, or </li>\n<li>B) use a common practice that avoids\nthis error somehow (shy of using smaller indexes, of course)</li>\n</ul>\n"}, {"tags": ["haskell", "wxhaskell"], "answers": [{"tags": [], "owner": {"reputation": 532, "user_id": 660339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ba401042a68ed65c16f73c8cf3a15287?s=128&d=identicon&r=PG", "display_name": "Ivan Perez", "link": "https://stackoverflow.com/users/660339/ivan-perez"}, "is_accepted": true, "score": 1, "last_activity_date": 1452366406, "creation_date": 1452366406, "answer_id": 34697689, "question_id": 34688862, "link": "https://stackoverflow.com/questions/34688862/how-do-i-focus-a-widget/34697689#34697689", "title": "How do I focus a widget?", "body": "<p>The wx library has a <a href=\"https://hackage.haskell.org/package/wx-0.92.1.0/docs/Graphics-UI-WX-Controls.html#v:focusOn\" rel=\"nofollow\"><code>focusOn</code> function</a> that allows you to focus on a control.</p>\n\n<p>It is a re-export of <a href=\"https://hackage.haskell.org/package/wxcore-0.92.2.0/docs/Graphics-UI-WXCore-WxcClassesMZ.html#v:windowSetFocus\" rel=\"nofollow\">wxcore's <code>windowSetFocus</code></a>. The type is a bit misleading: it says <code>Window a</code>, but it works for buttons because <a href=\"http://docs.wxwidgets.org/trunk/classwx_window.html\" rel=\"nofollow\">they are windows too</a>.</p>\n\n<p>The following works (note I only added the last line):</p>\n\n<pre><code>module Main where\n\nimport Graphics.UI.WX\nimport Graphics.UI.WXCore\n\nmain :: IO ()\nmain = start hello\n\nhello :: IO ()\nhello = do\n  f &lt;- frame []\n  test &lt;- button f [ text := \"button\" ]\n  set f [ layout := widget test ]\n  focusOn test                          -- Here!\n</code></pre>\n"}], "owner": {"reputation": 1189, "user_id": 348201, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b5c1cb1e1615645078717836ffc3eaf?s=128&d=identicon&r=PG", "display_name": "somesoaccount", "link": "https://stackoverflow.com/users/348201/somesoaccount"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 34697689, "answer_count": 1, "score": 0, "last_activity_date": 1452366406, "creation_date": 1452304251, "last_edit_date": 1495542211, "question_id": 34688862, "link": "https://stackoverflow.com/questions/34688862/how-do-i-focus-a-widget", "title": "How do I focus a widget?", "body": "<p>When I start my application I want to set the focus on a certain button. Currently I need to hit <code>tab</code> once to have the button focused.</p>\n\n<p>The <code>wxwidgets</code> documents mention a <code>SetFocus</code> method (<a href=\"http://docs.wxwidgets.org/trunk/classwx_window.html#a697f9f8d3ff389790f1c74b59bcb1d75\" rel=\"nofollow noreferrer\">link</a>) which doesn't seem to be available in <code>wxhaskell</code>?</p>\n\n<p>Then I found <code>MoveBeforeInTabOrder</code> (<a href=\"http://docs.wxwidgets.org/trunk/classwx_window.html#af2b92f61cd9f9e2e0efe4cce307e25b1\" rel=\"nofollow noreferrer\">link</a>) but again, I didn't find it in <code>wxhaskell</code>.</p>\n\n<p>A maintainer of <code>wxhaskell</code> <a href=\"https://stackoverflow.com/a/601996/348201\">mentioned</a> it is a 'fairly complete GUI binding' in 2009 so am I just missing something here or is it bad luck?</p>\n\n<p>Here is my minimal example:</p>\n\n<pre><code>module Main where\n\nimport Graphics.UI.WX\nimport Graphics.UI.WXCore\n\nmain :: IO ()\nmain = start hello\n\nhello :: IO ()\nhello = do\n  f &lt;- frame []\n  test &lt;- button f [ text := \"button\" ]\n  set f [ layout := widget test ]\n</code></pre>\n"}, {"tags": ["haskell", "clojure", "functional-programming", "scheme", "lazy-evaluation"], "comments": [{"owner": {"reputation": 80605, "user_id": 1281433, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/O8XCE.png?s=128&g=1", "display_name": "Joshua Taylor", "link": "https://stackoverflow.com/users/1281433/joshua-taylor"}, "edited": false, "score": 6, "creation_date": 1452287411, "post_id": 34685552, "comment_id": 57118771, "body": "It&#39;s not really clear what you&#39;re asking.  Lazy evaluation is an <b>evaluation strategy</b> (which can often be implemented in user-space through the use of lexical closures), whereas tail-recursion is just a certain kind of recursive call.  Even there, I assume you actually mean <b>tail-call elimination/tail-call optimization</b>, which allows tail-recursion to be optimized to run in less space.  This permits recursive programs to not consume all the stack space.  Can you provide any examples where you feel that lazy evaluation would remove the need for tail-call optimization, or vice versa?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1452295510, "post_id": 34685552, "comment_id": 57122191, "body": "even if lazy evaluation exists, you may still need something to be calculated eagerly. in which case you&#39;ll use tail recursion with strictly calculated accumulating arguments. when you build your result lazily, i.e. with lazy constructors, guarded recursion is the way to go, putting the recursive call behind the lazy data constructor. for a Haskell answer see <a href=\"http://stackoverflow.com/questions/13042353/does-haskell-have-tail-recursive-optimization/13052612#13052612\" title=\"does haskell have tail recursive optimization\">stackoverflow.com/questions/13042353/&hellip;</a>"}, {"owner": {"reputation": 87536, "user_id": 90801, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/6acc4764438b6f3e80e9645ec8259353?s=128&d=identicon&r=PG", "display_name": "Arthur Ulfeldt", "link": "https://stackoverflow.com/users/90801/arthur-ulfeldt"}, "edited": false, "score": 1, "creation_date": 1452297112, "post_id": 34685552, "comment_id": 57122673, "body": "@xando: I edited the question and attempted to extract answerable questions that are as close as I can think of to the intent of your original question. Could you please edit this further to make it more useful to your situation. I will then vote to re-open it."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1452302360, "post_id": 34685552, "comment_id": 57123916, "body": "Tail recursion is just a while loop, it has nothing to do with lazy evaluation. Yet, if the language has lazy evaluation, this can be utilized to implement tail call optimization. For example, <a href=\"https://github.com/Frege/frege\" rel=\"nofollow noreferrer\">github.com/Frege/frege</a> does this: instead of performing a dangerous tail call, a thunk can be returned that will perform the call when the value is needed, but then hopefully from a point where less stack space is used."}, {"owner": {"reputation": 109950, "user_id": 86989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd262de5d82a235eeb64f71e4058198?s=128&d=identicon&r=PG", "display_name": "newacct", "link": "https://stackoverflow.com/users/86989/newacct"}, "edited": false, "score": 0, "creation_date": 1452306337, "post_id": 34685552, "comment_id": 57124670, "body": "They are kind of <i>opposite</i> things. Lazy evaluation usually only works when there is <i>non-tail</i> recursion. Lazy evaluation relies on the creation of a partial result (and recursion on the rest), which is non-tail recursion. Tail recursion would force the recursion to continue and not output a partial result, thereby preventing lazy evaluation."}, {"owner": {"reputation": 7975, "user_id": 1455243, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/99716e02429624201ec8f85f820a81ce?s=128&d=identicon&r=PG", "display_name": "Mars", "link": "https://stackoverflow.com/users/1455243/mars"}, "edited": false, "score": 3, "creation_date": 1452313655, "post_id": 34685552, "comment_id": 57125750, "body": "The on hold vote is kind of puzzling to me.  OP is clearly confused about recursion and laziness, but <i>that&#39;s the point</i> of the question.  S/he is asking a legitimate question based on a confusion.  The only reason it&#39;s &quot;unclear what you&#39;re asking&quot; is that OP doesn&#39;t understand yet.  If s/he understood, there would be no question.  The right response is to explain why s/he&#39;s confused--to dispel the misunderstanding.  Some of the comments do that; to my mind they are proper answers."}, {"owner": {"reputation": 127093, "user_id": 69545, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OXXbv.jpg?s=128&g=1", "display_name": "Rainer Joswig", "link": "https://stackoverflow.com/users/69545/rainer-joswig"}, "reply_to_user": {"reputation": 7975, "user_id": 1455243, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/99716e02429624201ec8f85f820a81ce?s=128&d=identicon&r=PG", "display_name": "Mars", "link": "https://stackoverflow.com/users/1455243/mars"}, "edited": false, "score": 2, "creation_date": 1452328431, "post_id": 34685552, "comment_id": 57128885, "body": "@mars: &#39;does lazy evaluation do a better job than tail-recursion&#39; - what does that mean? what &#39;better job&#39;? what is a &#39;significant role&#39; ?  what &#39;advantages&#39; does tail recursion provide? What about the disadvantages? That&#39;s all fully vague. No examples. No specifics. It&#39;s not even made clear that the concepts are related. why are numbers needed, given that symbols exist? I would expect to have a more specific question with more work put into it. why is Lisp tagged, given that it does not use lazy evaluation? Why not Haskell, given that it uses lazy evaluation."}, {"owner": {"reputation": 127093, "user_id": 69545, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OXXbv.jpg?s=128&g=1", "display_name": "Rainer Joswig", "link": "https://stackoverflow.com/users/69545/rainer-joswig"}, "reply_to_user": {"reputation": 7975, "user_id": 1455243, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/99716e02429624201ec8f85f820a81ce?s=128&d=identicon&r=PG", "display_name": "Mars", "link": "https://stackoverflow.com/users/1455243/mars"}, "edited": false, "score": 3, "creation_date": 1452329047, "post_id": 34685552, "comment_id": 57129058, "body": "@Mars: &#39;why is A needed, given that B exists? Can A provide all the advantages of B? Does A do a better job than B? ...&#39;  That&#39;s a pattern for a multitude of useless questions, while providing ZERO context and no real programming problem. It&#39;s a low-quality question."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 80605, "user_id": 1281433, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/O8XCE.png?s=128&g=1", "display_name": "Joshua Taylor", "link": "https://stackoverflow.com/users/1281433/joshua-taylor"}, "edited": false, "score": 0, "creation_date": 1452374819, "post_id": 34685552, "comment_id": 57144265, "body": "@JoshuaTaylor <a href=\"http://www.cs.indiana.edu/cgi-bin/techreports/TRNNN.cgi?trnum=TR19\" rel=\"nofollow noreferrer\">cs.indiana.edu/cgi-bin/techreports/TRNNN.cgi?trnum=TR19</a> provides a (loose)  connection, IMO (i.e. how <a href=\"http://www.lispworks.com/documentation/lw51/CLHS/Body/m_loop.htm\" rel=\"nofollow noreferrer\"><code>LOOP</code></a> does  list accumulation, in CL). <a href=\"http://en.wikipedia.org/wiki/Tail_recursion#Tail_recursion_modulo_cons\" rel=\"nofollow noreferrer\">TRMC</a> ~~= <a href=\"http://wiki.haskell.org/Tail_recursion\" rel=\"nofollow noreferrer\">guarded-recursion</a> under lazy evaluation."}], "answers": [{"comments": [{"owner": {"reputation": 3253, "user_id": 571828, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/l07p5.jpg?s=128&g=1", "display_name": "\u8c61\u5609\u9053", "link": "https://stackoverflow.com/users/571828/%e8%b1%a1%e5%98%89%e9%81%93"}, "edited": false, "score": 0, "creation_date": 1452539804, "post_id": 34701560, "comment_id": 57204660, "body": "I think that CPS generally consumes heap resources. Is this what you mean: &quot;It can use other tricks to prevent a stack overflow like CPS&quot;?"}, {"owner": {"reputation": 2870, "user_id": 470331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/149eb8e4aa3fa2613af328ac1c2a3b3c?s=128&d=identicon&r=PG", "display_name": "jJ&#39;", "link": "https://stackoverflow.com/users/470331/jj"}, "reply_to_user": {"reputation": 3253, "user_id": 571828, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/l07p5.jpg?s=128&g=1", "display_name": "\u8c61\u5609\u9053", "link": "https://stackoverflow.com/users/571828/%e8%b1%a1%e5%98%89%e9%81%93"}, "edited": false, "score": 0, "creation_date": 1452657128, "post_id": 34701560, "comment_id": 57261730, "body": "Yes, it trades stack space for heap space by having all calls in a tail position and passing the continuation as a parameter. But this remark was not really important for answering the question, only meant to hint that there are always ways to prevent stack overflow, but in this case probably quite expensive."}], "tags": [], "owner": {"reputation": 2870, "user_id": 470331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/149eb8e4aa3fa2613af328ac1c2a3b3c?s=128&d=identicon&r=PG", "display_name": "jJ&#39;", "link": "https://stackoverflow.com/users/470331/jj"}, "is_accepted": false, "score": 5, "last_activity_date": 1452394764, "creation_date": 1452394764, "answer_id": 34701560, "question_id": 34685552, "link": "https://stackoverflow.com/questions/34685552/when-is-tail-recursion-needed-in-the-context-of-lazy-evaluation/34701560#34701560", "title": "When is tail-recursion needed, in the context of lazy evaluation?", "body": "<p><strong>TL;DR</strong> Defining functions \"tail-recursively\" is not generally useful in lazy languages. You can get a stack overflow even in those cases (as opposed to strict languages with a proper tail-call optimization).</p>\n\n<p>By using lazy evaluation of the function parameters (call by name) you lose the ability to express a simple iteration (using constant space) with a recursion.</p>\n\n<p>For example let's compare two versions of length function. First let's look at the non-tail recursive function to compare lazy and non-lazy:</p>\n\n<pre><code>length [] = 0\nlength (head:tail) = length tail + 1\n</code></pre>\n\n<p>Strict evaluation of <code>length [1, 2, 3]</code>:</p>\n\n<pre><code>length [1, 2, 3] -&gt;\n  length (1:[2, 3]) = length [2, 3] + 1 -&gt;\n    length (2:[3]) + 1 = (length [3] + 1) + 1 -&gt;\n      (length (3:[]) + 1) + 1 = ((length [] + 1) + 1) + 1 -&gt;\n        ((length [] + 1) + 1) + 1 = ((0 + 1) + 1) + 1 -&gt;\n      (1 + 1) + 1 -&gt;\n    2 + 1\n  3\n</code></pre>\n\n<p>Lazy evaluation:</p>\n\n<pre><code>length [1, 2, 3] -&gt;\nlength (1:[2, 3]) = length [2, 3] + 1 -&gt;\n</code></pre>\n\n<p>at this point reducing the <code>+</code> is needed and it needs to evaluate both arguments, the first being <code>length [2, 3]</code>, so it continues like before, but on a list with one less parameter.\nStack space is used for evaluating <code>+</code> (if we are considering a straightforward implementation).</p>\n\n<p>Both versions thus use a stack, for the lazy one though, instead of <code>length</code>, <code>+</code> is the \"recursive\" function here.</p>\n\n<p>Tail-recursive variant (using an accumulator):</p>\n\n<pre><code>length [] a = a\nlength (head:tail) a = length tail (a + 1)\n</code></pre>\n\n<p>Strict evaluation steps utilizing tail-call optimization:</p>\n\n<pre><code>length [1, 2, 3] 0 -&gt;\nlength (1:[2, 3]) 0 = length [2, 3] (0 + 1) -&gt;\nlength (2:[3]) 1 = length [3] (1 + 1) -&gt;\nlength (3:[]) 2 = length [] 2 + 1 -&gt;\nlength [] 3 = 3\n</code></pre>\n\n<p>This uses a constant space on a stack, no space on a heap</p>\n\n<p>Lazy evaluation:</p>\n\n<pre><code>length [1, 2, 3] 0 -&gt;\nlength (1:[2, 3]) 0 = length [2, 3] (0 + 1) -&gt;\nlength (2:[3]) (0 + 1) = length [3] ((0 + 1) + 1) -&gt;\nlength (3:[]) ((0 + 1) + 1) = length [] ((0 + 1) + 1) + 1 -&gt;\nlength [] (0 + 1) + 1) + 1 = ((0 + 1) + 1) + 1 -&gt;\nmagic -&gt; 3\n</code></pre>\n\n<p>This uses a constant space on a stack until \"magic\" part, but builds-up delayed computations (additions) on a heap (generally). The part marked \"magic\" is where the sum of all ones happen and in a straightforward implementation it uses a stack. (Note that in this and similar cases, the optimizing evaluator may actually do the additions during the evaluation and then just return 3, you cannot really tell the difference, but the stack is not used. It can use other tricks to prevent a stack overflow like CPS).</p>\n\n<p><strong>Summary:</strong></p>\n\n<p>Lazy evaluated functions use a stack in the end in its straightforward implementation regardless whether they are written as tail-recursive or not.</p>\n\n<p>There are however various tricks you need to apply to compilers to enable the optimizations of stack usage. They are not as straightforward as tail-call optimization in strict languages though.</p>\n\n<p>Better option is to use those languages idiomatically and utilize the variety of high order functions that significantly reduce a need for recursive function definitions (and to some degree are in the lazy languages also for that reason).</p>\n"}], "owner": {"reputation": 3253, "user_id": 571828, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/l07p5.jpg?s=128&g=1", "display_name": "\u8c61\u5609\u9053", "link": "https://stackoverflow.com/users/571828/%e8%b1%a1%e5%98%89%e9%81%93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1164, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1452540193, "creation_date": 1452285058, "last_edit_date": 1452540193, "question_id": 34685552, "link": "https://stackoverflow.com/questions/34685552/when-is-tail-recursion-needed-in-the-context-of-lazy-evaluation", "title": "When is tail-recursion needed, in the context of lazy evaluation?", "body": "<p>My understanding (which may be incorrect or incomplete) is that <em>lazy evaluation</em> can provide all the advantages of <em>tail recursion</em>, and does one better. </p>\n\n<p>If so, does it mean that <em>tail recursion</em> isn't needed in the context of lazy evaluation?</p>\n\n<p><strong><em>UPDATE</em></strong></p>\n\n<p>Specifically, let's look at the following example:</p>\n\n<pre><code>(define (foo f a)\n  (if (number? a)\n    (* a a)\n    (lazy-map foo a)))\n</code></pre>\n\n<p>This function can be easily converted to a tail-recursion one. However, if so, we will lost the advantage of lazy-evaluation.</p>\n\n<p>Actually, does this non-tail-recursive function need to consume many stacks when the input is a pretty large list (or <strong>infinite</strong>)? I don't think so. Then, are there good reasons to use <strong>tail-recursion</strong> rather than <strong>lazy evaluation</strong>?</p>\n"}, {"tags": ["haskell", "functional-programming", "pattern-matching"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1452288199, "post_id": 34685644, "comment_id": 57119167, "body": "Perhaps you should mention explicitly that Haskell and ML each use <code>|</code> in the general sense of marking &quot;cases&quot;, but Haskell uses it for boolean guards while ML uses it (among other things) for pattern matching. It also bears mentioning that non-total field selectors are generally discouraged (aside from non-exported ones used to make prisms)."}, {"owner": {"reputation": 143, "user_id": 5044727, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9e006166e4f3ec257a642305c7b1c251?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Rush", "link": "https://stackoverflow.com/users/5044727/kyle-rush"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452530106, "post_id": 34685644, "comment_id": 57198875, "body": "@dfeuer Out of curiosity then, what might be the more idiomatic way to implement the <code>PRQuadtree</code> type I have? White, Black, and Grey nodes are all types of <code>PRQuadtree</code> but have different behavior for insert, delete, etc. as well as different associated data. In Java I&#39;ve implemented this behavior with a <code>PRQuadtree</code> interface and White, Black, and Grey node concrete classes.    Since all the internal data is private (and only needed in that node) it never mattered that their implementation was different."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 143, "user_id": 5044727, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9e006166e4f3ec257a642305c7b1c251?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Rush", "link": "https://stackoverflow.com/users/5044727/kyle-rush"}, "edited": false, "score": 0, "creation_date": 1452539746, "post_id": 34685644, "comment_id": 57204629, "body": "@KyleRush, one option is to break up a sum of products into multiple types, so each product gets its own record type."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1452372857, "last_edit_date": 1452372857, "creation_date": 1452285410, "answer_id": 34685644, "question_id": 34685523, "link": "https://stackoverflow.com/questions/34685523/haskell-type-destructuring-in-guards/34685644#34685644", "title": "Haskell Type Destructuring in Guards", "body": "<p>It can be achieved as follows:</p>\n\n<pre><code>getRegion :: PRQuadtree -&gt; Region\ngetRegion (BlackNode r _) = r\ngetRegion (WhiteNode r) = r\ngetRegion GreyNode{region=r} = r\n</code></pre>\n\n<p>or even as</p>\n\n<pre><code>getRegion :: PRQuadtree -&gt; Region\ngetRegion x = case x of\n  BlackNode r _ -&gt; r\n  WhiteNode r -&gt; r\n  GreyNode{} -&gt; region x\n</code></pre>\n\n<p>In Haskell, prepending a type signature is very idiomatic.</p>\n\n<p>Another option is extending the <code>region</code> field to the other cases as well:</p>\n\n<pre><code>data PRQuadtree = WhiteNode { region :: Region }\n    | BlackNode { region :: Region , waypoint :: Waypoint }\n    | GreyNode { \n        topLeft :: PRQuadtree,\n        topRight :: PRQuadtree,\n        botLeft :: PRQuadtree,\n        botRight :: PRQuadtree,\n        region :: Region\n    } deriving (Show)\n</code></pre>\n\n<p>Now, <code>region</code> will work on all <code>PRQuadtree</code> values.</p>\n\n<p>Haskell uses <code>|</code> as ML does when defining algebraic datatypes, to separate different constructors, but does not use it to separate <code>case</code> branches, which instead follow the syntax</p>\n\n<pre><code>case .. of { pat1 -&gt; e1 ; pat2 -&gt; e2 ; ... }\n</code></pre>\n\n<p>which can be replaced by indentation</p>\n\n<pre><code>case .. of\n   pat1 -&gt; e1\n   pat2 -&gt; e2\n   ...\n</code></pre>\n\n<p>Also, note that partial field selectors are discouraged:</p>\n\n<pre><code>data A = A1 { foo :: Int } | A2\n</code></pre>\n\n<p>Above, <code>foo A2</code> type checks but crashes. On the other hand, when a field is present in all the constructors, we do not face such risk.</p>\n"}, {"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 3, "last_activity_date": 1452303213, "creation_date": 1452303213, "answer_id": 34688737, "question_id": 34685523, "link": "https://stackoverflow.com/questions/34685523/haskell-type-destructuring-in-guards/34688737#34688737", "title": "Haskell Type Destructuring in Guards", "body": "<p>You can also write:</p>\n\n<pre><code>getRegion x \n    | BlackNode y &lt;- x -&gt; ....\n    | Greynode{}  &lt;- x -&gt; ....\n</code></pre>\n\n<p>but it is quite unidiomatic in this simple case.</p>\n\n<p>However, in more complex programs, this pattern matching in guards can be very useful. You use multiple equations or case to distinguish the general cases, like shown by @chi. But then, you can detect special cases, like in the following made up example:</p>\n\n<pre><code>getRegion x = case x of\n    BlackNode{region} \n        | [(0,_)] &lt;- filter (inRegion region) interestingPoints\n            -&gt; -- region encloses exactly 1 interesting point on x axis\n               ....\n        | otherwise = ....\n        where\n           interestingPoints = .....\n           inRegion :: Region -&gt; Point -&gt; Bool\n    GreyNode{} -&gt; ....\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 5044727, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9e006166e4f3ec257a642305c7b1c251?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Rush", "link": "https://stackoverflow.com/users/5044727/kyle-rush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1352, "favorite_count": 0, "accepted_answer_id": 34685644, "answer_count": 2, "score": 3, "last_activity_date": 1452372857, "creation_date": 1452284939, "last_edit_date": 1452314293, "question_id": 34685523, "link": "https://stackoverflow.com/questions/34685523/haskell-type-destructuring-in-guards", "title": "Haskell Type Destructuring in Guards", "body": "<p>I'm playing around with a toy project in Haskell. I'm implementing some data structures I've built in other languages before to familiarize myself with how they'd be built in Haskell. This isn't my first functional language, I've built a couple of projects like a Scheme interpreter in OCaml but I think my OCaml experience is coloring how I'm approaching this problem. Its' not terribly important, but may be useful for context, to know that the data structure I'm implementing is a PR-Quadtree.</p>\n\n<p>What I want to do is match and destructure a type inside a guard, a la OCaml's match statement.</p>\n\n<pre><code>data Waypoint = WayPoint {\n    lat :: Float,\n    lon :: Float,\n    radius :: Float,\n    speed :: Float,\n    accel :: Float\n} deriving (Show)\n\ndata Region = Region {\n    x :: Float,\n    y :: Float,\n    width :: Float\n} deriving (Show)\n\ndata PRQuadtree = WhiteNode Region\n    | BlackNode Region Waypoint \n    | GreyNode { \n        topLeft :: PRQuadtree,\n        topRight :: PRQuadtree,\n        botLeft :: PRQuadtree,\n        botRight :: PRQuadtree,\n        region :: Region\n    } deriving (Show)\n\ngetRegion node \n    | BlackNode(r, _) = r\n    | WhiteNode(r) = r\n    | GreyNode = region node \n</code></pre>\n\n<p>The <code>getRegion</code> function is the one I am having problems with in particular. In case what I'm trying to do is unclear: I'd like to simple extract one element of the argument but that depends on which member of the algebraic data type the argument is. In OCaml I could do:</p>\n\n<pre><code>let getRegion node = match node with\n    | BlackNode(r, _) = r\n    | WhiteNode(r) = r\n    | GreyNode = region(node)\n</code></pre>\n\n<p>(or something very similar, my OCaml is a bit rusty now).</p>\n\n<p>In Haskell however, this doesn't appear to bind <code>r</code> in scope of the RHS of the guard branch. I've tried to look up Pattern Guards, as they sound similar to what I might want to do, but I can't really grok whats going on here. Really I just want to get a binding from the LHS of the = to the RHS of the equals (depending on which branch of the guard we've gone down). </p>\n\n<p>Whats the idiomatic Haskell way to do what I'm trying to do here?</p>\n"}, {"tags": ["function", "haskell", "functional-programming"], "answers": [{"tags": [], "owner": {"reputation": 15620, "user_id": 596361, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b7219254970581e53d3b2b162f7f50f8?s=128&d=identicon&r=PG", "display_name": "Mirzhan Irkegulov", "link": "https://stackoverflow.com/users/596361/mirzhan-irkegulov"}, "is_accepted": false, "score": 3, "last_activity_date": 1452282613, "creation_date": 1452282613, "answer_id": 34684960, "question_id": 34684915, "link": "https://stackoverflow.com/questions/34684915/applying-io-a-b-to-single-parameter-of-type-a/34684960#34684960", "title": "Applying IO [a -&gt; b] to single parameter of type a", "body": "<p><code>sequence</code> will get you from <code>[IO b]</code> to <code>IO [b]</code>, <code>join</code> will get you from <code>IO (IO [b])</code> to <code>IO [b]</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 3, "creation_date": 1452284295, "post_id": 34685321, "comment_id": 57117080, "body": "You could simply do <code>liftA2 (&lt;*&gt;) functions param</code>."}, {"owner": {"reputation": 21248, "user_id": 223274, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2a6aad3c8269beb376b3e2b0bd29bec4?s=128&d=identicon&r=PG", "display_name": "Ian Henry", "link": "https://stackoverflow.com/users/223274/ian-henry"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1452284495, "post_id": 34685321, "comment_id": 57117197, "body": "@AaditMShah That&#39;s a lot nicer!"}], "tags": [], "owner": {"reputation": 21248, "user_id": 223274, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2a6aad3c8269beb376b3e2b0bd29bec4?s=128&d=identicon&r=PG", "display_name": "Ian Henry", "link": "https://stackoverflow.com/users/223274/ian-henry"}, "is_accepted": false, "score": 4, "last_activity_date": 1452284082, "creation_date": 1452284082, "answer_id": 34685321, "question_id": 34684915, "link": "https://stackoverflow.com/questions/34684915/applying-io-a-b-to-single-parameter-of-type-a/34685321#34685321", "title": "Applying IO [a -&gt; b] to single parameter of type a", "body": "<p>This looks very much like a simple <code>&lt;*&gt;</code>, but we need to call it... deeply. Can we do this using only the <code>Applicative</code> instance, without resorting to <code>Monad</code>?</p>\n\n<p>Solving a simpler problem first:</p>\n\n<pre><code>functions :: IO (a -&gt; b)\nparam     :: IO a\n</code></pre>\n\n<p>We could use:</p>\n\n<pre><code>functions &lt;*&gt; param\n</code></pre>\n\n<p>To get an <code>IO b</code>.</p>\n\n<p>Similarly, given a list of functions and a list of values:</p>\n\n<pre><code>functions :: [a -&gt; b]\nparam     :: [a]\n</code></pre>\n\n<p>We could use:</p>\n\n<pre><code>functions &lt;*&gt; param\n</code></pre>\n\n<p>To get a <code>[b]</code>.</p>\n\n<p>But now to do both at the same time:</p>\n\n<pre><code>functions :: IO [a -&gt; b]\nparam     :: IO [a]\n</code></pre>\n\n<p>This is... trickier, because we'll have to take advantage of the <code>Applicative</code> instance for <code>IO</code> and the <code>Applicative</code> instance for <code>[]</code> at the same time. But it's still doable:</p>\n\n<pre><code>doubleAp fns x = liftedFns &lt;*&gt; x\n  where apList = (&lt;*&gt;) :: [a -&gt; b] -&gt; [a] -&gt; [b]\n        liftedFns = fmap apList fns :: IO ([a] -&gt; [b])\n</code></pre>\n\n<p>Or the more concise but harder (for me) to parse:</p>\n\n<pre><code>doubleAp fns x = ((&lt;*&gt;) &lt;$&gt; fns) &lt;*&gt; x\n</code></pre>\n\n<p>Or, according to <a href=\"https://blunt.herokuapp.com\" rel=\"nofollow\">blunt</a>:</p>\n\n<pre><code>doublAp = (&lt;*&gt;) . ((&lt;*&gt;) &lt;$&gt;)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 2, "creation_date": 1452295120, "post_id": 34685355, "comment_id": 57122070, "body": "<code>liftA2 (&lt;*&gt;)</code> is <code>(&lt;*&gt;)</code> for <code>Compose</code>, so you can write <code>result = getCompose $ Compose functions &lt;*&gt; Compose param</code>. If this pattern is used widely, It might be better to wrap everything in <code>Compose</code> (e.g <code>param : Compose IO [] a</code> and <code>result : Compose IO [] b</code>), then it&#39;s simply <code>result = functions &lt;*&gt; params</code>."}], "tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": true, "score": 7, "last_activity_date": 1452284210, "creation_date": 1452284210, "answer_id": 34685355, "question_id": 34684915, "link": "https://stackoverflow.com/questions/34684915/applying-io-a-b-to-single-parameter-of-type-a/34685355#34685355", "title": "Applying IO [a -&gt; b] to single parameter of type a", "body": "<p>By \"single parameter\" I assume you mean a one element list. If so, then here's how it's done:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>result :: IO [b]\nresult = do\n    fs &lt;- functions    -- fs :: [a -&gt; b]\n    xs &lt;- param        -- xs :: [a]\n    let ys = fs &lt;*&gt; xs -- ys :: [b]\n    return ys\n</code></pre>\n\n<p>Note that since <code>xs</code> is a one element list you're essentially applying every element of <code>fs</code> to that value.</p>\n\n<p>This is the same as:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Control.Applicative (liftA2)\n\nresult :: IO [b]\nresult = liftA2 (&lt;*&gt;) functions param\n</code></pre>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 648, "user_id": 3746344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/535099e26619eeb7031527c47b1ab665?s=128&d=identicon&r=PG&f=1", "display_name": "Savenkov Alexey", "link": "https://stackoverflow.com/users/3746344/savenkov-alexey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 34685355, "answer_count": 3, "score": 1, "last_activity_date": 1452284210, "creation_date": 1452282445, "question_id": 34684915, "link": "https://stackoverflow.com/questions/34684915/applying-io-a-b-to-single-parameter-of-type-a", "title": "Applying IO [a -&gt; b] to single parameter of type a", "body": "<p>I have</p>\n\n<pre><code>functions :: IO[a -&gt; b]   -- IO List of functions\nparam :: IO[a]            -- Single parameter\n</code></pre>\n\n<p>and I want to get</p>\n\n<pre><code>result :: IO[b]\nresult = IO[*first function* &lt;$&gt; param, *second function* &lt;$&gt; param, ...]\n</code></pre>\n\n<p>I somehow could get result of type <code>IO[IO b]</code>, but I want <code>IO[b]</code></p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 2, "creation_date": 1452280383, "post_id": 34684360, "comment_id": 57114970, "body": "You need the braces if there&#39;s more than one class constraint, just for reference."}, {"owner": {"reputation": 17, "user_id": 5764299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221e62d703bdd55cd8040aa74b2959ff?s=128&d=identicon&r=PG", "display_name": "DiogoJDO", "link": "https://stackoverflow.com/users/5764299/diogojdo"}, "edited": false, "score": 0, "creation_date": 1452280745, "post_id": 34684360, "comment_id": 57115164, "body": "Thanks very much! That solved my problem perfectly! But I don&#39;t understand why do I have to add Show a to the context in the 4th step you made."}, {"owner": {"reputation": 11066, "user_id": 147057, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cf9d83a95db2460ccb18f311fa8a766c?s=128&d=identicon&r=PG", "display_name": "max taldykin", "link": "https://stackoverflow.com/users/147057/max-taldykin"}, "edited": false, "score": 2, "creation_date": 1452281329, "post_id": 34684360, "comment_id": 57115504, "body": "To use <code>show x</code> in instance definition you need <code>x</code> to be showable. You can&#39;t show something that is not instance of <code>Show</code>. E.g. <code>Constant id</code> where <code>id</code> is a function."}], "tags": [], "owner": {"reputation": 11066, "user_id": 147057, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cf9d83a95db2460ccb18f311fa8a766c?s=128&d=identicon&r=PG", "display_name": "max taldykin", "link": "https://stackoverflow.com/users/147057/max-taldykin"}, "is_accepted": true, "score": 3, "last_activity_date": 1452280459, "last_edit_date": 1452280459, "creation_date": 1452280349, "answer_id": 34684360, "question_id": 34684207, "link": "https://stackoverflow.com/questions/34684207/instance-show-cant-get-it-to-compile/34684360#34684360", "title": "instance Show - can&#39;t get it to compile", "body": "<p>You should read compiler's messages, as it tries very hard to be helpful.</p>\n\n<pre><code>Expecting one more argument to \u2018Expression\u2019\n</code></pre>\n\n<p>Let's add some argument.</p>\n\n<pre><code>instance Show (Expression a) where\n</code></pre>\n\n<p>GHC complains again:</p>\n\n<pre><code>No instance for (Show a) arising from a use of \u2018show\u2019\nPossible fix:\n  add (Show a) to the context of the instance declaration\n</code></pre>\n\n<p>Ok, let's add <code>Show a</code> to the context:</p>\n\n<pre><code>instance Show a =&gt; Show (Expression a) where\n</code></pre>\n\n<p>Now it compiles fine. And by the way, you don't need braces around <code>show</code>:</p>\n\n<pre><code>instance Show a =&gt; Show (Expression a) where\n    show (Constant x) = show x\n    show (Simetric x) = \"-\" ++ show x\n    show (Addition x y) = show x ++ \" + \" ++ show y\n    show (Subtraction x y) = show x ++ \" - \" ++ show y\n    show (Multiplication x y) = show x ++ \" * \" ++ show y\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 5764299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221e62d703bdd55cd8040aa74b2959ff?s=128&d=identicon&r=PG", "display_name": "DiogoJDO", "link": "https://stackoverflow.com/users/5764299/diogojdo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 34684360, "answer_count": 1, "score": 1, "last_activity_date": 1452280459, "creation_date": 1452279672, "question_id": 34684207, "link": "https://stackoverflow.com/questions/34684207/instance-show-cant-get-it-to-compile", "title": "instance Show - can&#39;t get it to compile", "body": "<p>I've got this problem for college where I've got this:</p>\n\n<pre><code>data Expression a = Constant a \n                | Simetric (Expression a) \n                | Addition (Expression a) (Expression a) \n                | Subtraction (Expression a) (Expression a) \n                | Multiplication (Expression a) (Expression a)\n</code></pre>\n\n<p>and I've to write Expression a as an instance of <em>Show</em>.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>instance Show Expression where\n               show (Constant x) = (show x)\n               show (Simetric x) = \"-\" ++ (show x)\n               show (Addition x y) = (show x) ++ \" + \" ++ (show y)\n               show (Subtraction x y) = (show x) ++ \" - \" ++ (show y)\n               show (Multiplication x y) = (show x) ++ \" * \" ++ (show y)\n</code></pre>\n\n<p>And I get this error message on ghci when I try to compile:</p>\n\n<pre><code>    Expecting one more argument to \u2018Expression\u2019\nThe first argument of \u2018Show\u2019 should have kind \u2018*\u2019,\n  but \u2018Expression\u2019 has kind \u2018* -&gt; *\u2019\nIn the instance declaration for \u2018Show Expression\u2019\nFailed, modules loaded: none.\n</code></pre>\n\n<p>Can someone explain me what's wrong in my code? I've got a final exam on Monday. Thanks for the help!</p>\n"}, {"tags": ["haskell", "random", "monad-transformers", "state-monad"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1452278535, "post_id": 34683670, "comment_id": 57114031, "body": "All except the first version are sensible (that one is a misuse of PRNG - nothing to do with Haskell or Monads) - what you &quot;should&quot; be doing is what is most useful to solve your particular problem, there is no one way."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1452282523, "creation_date": 1452282523, "answer_id": 34684940, "question_id": 34683670, "link": "https://stackoverflow.com/questions/34683670/extract-a-random-element-from-a-list-and-remove-it-learning-monads/34684940#34684940", "title": "Extract a random element from a list (and remove it), learning monads", "body": "<blockquote>\n  <p>should i be using monad Transformers for the \"remove the element\" part? i've read they are used to mix monads, and i know i will be using the State monad and the List monad</p>\n</blockquote>\n\n<p>But you are not using the list monad! You are just using lists. To say you are using the list monad would mean you are using <code>(&gt;&gt;=)</code> or <code>return</code> specialized to lists (or similar <code>Monad</code>-polymorphic functions specialized to lists), which you are not doing. So I think it makes perfect sense to use <code>State</code>, and not use any transformers.</p>\n\n<blockquote>\n  <p>Other than that, any comments on my code will be gratefully recieved (the style ones the most, as monads are about writing with style? :P)</p>\n</blockquote>\n\n<p>I like your fourth attempt the best, which as a reminder was this one:</p>\n\n<pre><code>extractR'''' :: [a] -&gt; State StdGen a\nextractR'''' xs = pr1 &gt;&gt;= f\n  where\n    n   = length xs\n    pr1 = state $ randomR (0,n-1)\n    f   = \\k -&gt; state ( \\s -&gt; (xs !! k , s) )\n</code></pre>\n\n<p>The only tweak I would make is that I find your <code>f</code> a bit too complicated. Since you are not modifying the state at all, you need not use <code>State</code>-specific functions; one could write</p>\n\n<pre><code>    f   = \\k -&gt; return (xs !! k)\n</code></pre>\n\n<p>instead. And then one can apply a monad law, namely:</p>\n\n<pre><code>m &gt;&gt;= (\\x -&gt; return (f x)) = fmap f m\n</code></pre>\n\n<p>The final implementation I would want to see is thus:</p>\n\n<pre><code>extractR :: [a] -&gt; State StdGen a\nextractR xs = fmap (xs!!) pr1\n  where\n    n   = length xs\n    pr1 = state $ randomR (0,n-1)\n</code></pre>\n\n<p>(One can of course spell <code>fmap</code> in several other ways, that in this case differ primarily in aesthetics, like <code>(&lt;$&gt;)</code>, <code>liftA</code>, or <code>liftM</code>.)</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1452283772, "creation_date": 1452283772, "answer_id": 34685256, "question_id": 34683670, "link": "https://stackoverflow.com/questions/34683670/extract-a-random-element-from-a-list-and-remove-it-learning-monads/34685256#34685256", "title": "Extract a random element from a list (and remove it), learning monads", "body": "<p>You may want to take a look to the <code>MonadRandom</code> package.</p>\n\n<pre><code>import Control.Monad.Random\n\nextractR :: MonadRandom m =&gt; [a] -&gt; m a\nextractR xs = (xs !!) &lt;$&gt; getRandomR (0, length xs - 1)\n</code></pre>\n\n<p>The <code>MonadRandom</code> constraint is satisfied by <code>IO</code> and <code>RandT g m</code>, which is essentially a <code>StateT StdGen</code>-based monad, usable in pure code.</p>\n\n<p>Also, the library defines <code>uniform</code>, which is equivalent to your <code>extractR</code> (albeit its implementation is rather complex).</p>\n"}], "owner": {"reputation": 410, "user_id": 3927886, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/689a75ec29af93dcc938fdbd5f039b54?s=128&d=identicon&r=PG&f=1", "display_name": "RamiroPastor", "link": "https://stackoverflow.com/users/3927886/ramiropastor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 611, "favorite_count": 0, "accepted_answer_id": 34684940, "answer_count": 2, "score": 1, "last_activity_date": 1452283772, "creation_date": 1452277573, "last_edit_date": 1452277933, "question_id": 34683670, "link": "https://stackoverflow.com/questions/34683670/extract-a-random-element-from-a-list-and-remove-it-learning-monads", "title": "Extract a random element from a list (and remove it), learning monads", "body": "<p>Im learning monads in Haskell with the haskell wikibook and my own newbie experiments</p>\n\n<p>As my first step, i've copypasted the parts of the book related to monads to my own PDF using the great <a href=\"https://hackage.haskell.org/package/HaTeX\" rel=\"nofollow\">HaTeX</a> library (by Daniel D\u00edaz) while lightly reading such hard text (hard because of its content).</p>\n\n<p>Below is my first attempt to practice what i learned: 7 versions of a function that takes a list and returns a random element from that list</p>\n\n<p>Now my main question is, should i be using monad Transformers for the \"remove the element\" part? i've read they are used to mix monads, \n and i know i will be using the State monad and the List monad</p>\n\n<p>Other than that, any comments on my code will be gratefully recieved (the style ones the most, as monads are about writing with style? :P)</p>\n\n<pre><code>import System.Random\nimport Control.Monad.Trans.State\nimport Control.Monad\n</code></pre>\n\n<hr>\n\n<h2>------------------------ PRIMER INTENTO DE RANDOMNESS ------------------------</h2>\n\n<pre><code>extractR' :: [a] -&gt; a\nextractR' xs = xs !! randomPos\n  where\n    n         = length xs\n    randomPos = fst pareja\n    pareja    = randomR (0,n-1) stdGen\n    stdGen    = mkStdGen 0\n\n\n-- extractR' siempre devuelve la misma cosa, al llamarla sobre la misma\n-- lista   (por tanto NO SIRVE, NO ES ALEATORIO)\n-- EJ:\n-- *Deck&gt; extractR' [1..100]\n-- 46\n-- (0.00 secs, 0 bytes)\n-- *Deck&gt; extractR' [1..100]\n-- 46\n-- (0.02 secs, 0 bytes)\n-- *Deck&gt; extractR' [1..100]\n-- 46\n-- (0.00 secs, 0 bytes)\n</code></pre>\n\n<hr>\n\n<h2>------------------------ SEGUNDO INTENTO DE RANDOMNESS ------------------------</h2>\n\n<pre><code>stdGen = mkStdGen 0\n\n\nextractR'' :: StdGen -&gt; [a] -&gt; (a, StdGen)\nextractR'' gen xs = (xs !! randPos , newGen)\n  where \n    n = length xs\n    (randPos, newGen) = randomR (0,n-1) gen\n\n\n-- esta version permite arrastrar el RNGenerator, pero es incomodisima de usar:\n\n-- *Deck&gt; extractR'' stdGen [1..100]\n-- (46,40014 40692)\n-- (0.00 secs, 0 bytes)\n-- *Deck&gt; let x = snd (extractR'' stdGen [1..100]) in extractR'' x [1..100]\n-- (56,1601120196 1655838864)\n-- (0.00 secs, 0 bytes)\n</code></pre>\n\n<hr>\n\n<h2>------------------------ TERCER INTENTO DE RANDOMNESS -------------------------</h2>\n\n<pre><code>extractR''' :: [a] -&gt; State StdGen a\nextractR''' xs = state sol\n  where\n    n   = length xs\n    sol = \\s -&gt; ( xs !! (randPos s) ,  newGen s)\n    randPos st = fst $ randomR (0,n-1) st\n    newGen st  = snd $ randomR (0,n-1) st\n\n-- extractR''' xs = \n--   state ( \\s -&gt; \n--     ( xs !! (fst $ randomR (0, (length xs)-1) s ) \n--     , \n--     snd $ randomR (0, (length xs)-1) s ) )\n\n-- pruebas en pantalla:\n\n-- *Main&gt; runState (extractR ['a'..'z']) (mkStdGen 0)\n-- ('d',40014 40692)\n-- (0.00 secs, 0 bytes)\n-- *Main&gt; runState (extractR ['a'..'z']) (mkStdGen 0)\n-- ('d',40014 40692)\n-- (0.00 secs, 0 bytes)\n-- *Main&gt; runState (extractR ['a'..'z']) (mkStdGen 7854)\n-- ('n',314309970 40692)\n-- (0.00 secs, 0 bytes)\n\n-- works well, but the code is bad (non-monadic)\n-- but we are in the State monad, so the following works:\n\nextractR2 :: [a] -&gt; State StdGen (a,a)\nextractR2 xs = liftM2 (,) (extractR''' xs) (extractR''' xs)\n</code></pre>\n\n<hr>\n\n<h2>------------------------ CUARTO INTENTO DE RANDOMNESS -------------------------</h2>\n\n<pre><code>extractR'''' :: [a] -&gt; State StdGen a\nextractR'''' xs = pr1 &gt;&gt;= f\n  where\n    n   = length xs\n    pr1 = state $ randomR (0,n-1)\n    f   = \\k -&gt; state ( \\s -&gt; (xs !! k , s) )\n\n\n-- monadic code, se actualiza 1 vez el StdGen\n</code></pre>\n\n<hr>\n\n<h2>------------------------ QUINTO INTENTO DE RANDOMNESS -------------------------</h2>\n\n<pre><code>extractR_ :: [a] -&gt; State StdGen a\nextractR_ xs = pr1 &gt;&gt;= f\n  where\n    n   = length xs\n    pr1 = state $ randomR (0,n-1)\n    f   = \\k -&gt; state ( \\s -&gt; (xs !! k , g s) )  \n    g   = \\stdG -&gt; snd $ next stdG\n\n\n-- monadic code, se actualiza 2 veces el StdGen\n</code></pre>\n\n<hr>\n\n<h2>------------------------ SEXTO INTENTO DE RANDOMNESS --------------------------</h2>\n\n<pre><code>extractR_' :: [a] -&gt; State StdGen a\nextractR_' xs = \n  do\n    generator &lt;- get              -- get = state $ \\st -&gt; (st,st)\n    let n = length xs\n    let (k, newGen) = randomR (0,n-1) generator\n    put newGen\n    return (xs!!k)\n\n\n-- traduccion del codigo:\nextractR_'' xs = \n  get &gt;&gt;= \n    \\generator -&gt; let n=length xs in \n      ( let (k, newGen)=randomR (0,n-1) generator in \n        (put newGen &gt;&gt; return (xs!!k) ) )\n\n\n-- *Main&gt; :t extractR_''\n-- extractR_'' :: (RandomGen t, Monad m) =&gt; [b] -&gt; StateT t m b\n-- *Main&gt; :t extractR_\n-- extractR_ :: [a] -&gt; State StdGen a\n\n\n\n-- ======o     o======\n--    ___________\n--   |___________|    -------------------------------------------------------------------------------\n--    |\\  /\\  /\\|     ------------------------        VERSION FINAL          ------------------------\n--    |_\\/__\\/__|     -------------------------------------------------------------------------------\n--   |___________| \n\n\n\n --    ??????????????????? (dont know which to choose)\n</code></pre>\n\n<p>By the way im doing this to finish my Maths degree, and after that i'll be looking to earn my livings through Haskell :D (am i asking for a <a href=\"https://www.youtube.com/watch?v=QA8W3y5Sk18\" rel=\"nofollow\">miracle</a>?)</p>\n"}, {"tags": ["haskell", "text", "ghc"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1452275532, "post_id": 34683004, "comment_id": 57112331, "body": "I don&#39;t know much about your code but can you do an <code>import qualified Data.Text as T</code> or <code>import Data.Text hiding (Text)</code>? this is usually the choice to do qualified imports to resolve namespace conflicts"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1452275651, "post_id": 34683004, "comment_id": 57112395, "body": "If this uses OverloadedStrings, presumably the internal type which isn&#39;t exported has an <code>IsString</code> instance. In this case, you can just call the <code>fromString :: IsString a =&gt; String -&gt; a</code>. Or you could just import that type... the <code>Data.CaseInsensitive</code> module exports it."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1452277449, "post_id": 34683004, "comment_id": 57113431, "body": "That doesn&#39;t give enough information. <code>CI Text</code> differs from <code>Text</code>, as the former uses a case-insensitive <code>Eq</code> instance. How did you try to <b><i>use</i></b> <code>named</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "is_accepted": true, "score": 1, "last_activity_date": 1452601710, "creation_date": 1452601710, "answer_id": 34743718, "question_id": 34683004, "link": "https://stackoverflow.com/questions/34683004/how-to-approach-compilation-errors-with-internal-text-modules/34743718#34743718", "title": "How to approach compilation errors with internal Text modules?", "body": "<p>Thanks to commenters as I was able to find out why I'm having this problem.</p>\n\n<p><strong>Short Answer</strong>: Pay close attention to types and make sure you understand them (read documentation of any module you see in error message).</p>\n\n<p><strong>Long Answer</strong>:</p>\n\n<p>Notice that the type contains spaces and <code>GHC</code> may break them down to multiple lines. <code>CI.Text</code> is means something different than <code>CI Text</code>.</p>\n\n<pre><code>\u2018case-insensitive-1.2.0.5:Data.CaseInsensitive.Internal.CI\nText\u2019\n</code></pre>\n\n<p><code>Text</code> here is not a type synonym of re-exported internal <code>Text</code> (common practice in libraries). <code>CI</code> is a type constructor and you cannot import it (for a reason - you have to stop and read documentation of anything you touch). You will understand why you can import <code>CI</code> <strong>type</strong> and <code>smart-constructors</code> like <code>mk</code> instead.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 34743718, "answer_count": 1, "score": 0, "last_activity_date": 1452601710, "creation_date": 1452275100, "question_id": 34683004, "link": "https://stackoverflow.com/questions/34683004/how-to-approach-compilation-errors-with-internal-text-modules", "title": "How to approach compilation errors with internal Text modules?", "body": "<p>I have this problem:</p>\n\n<pre><code>Couldn't match expected type \u2018case-insensitive-1.2.0.5:Data.CaseInsensitive.Internal.CI\n                                Text\u2019\n            with actual type \u2018Text\u2019\nIn the first argument of \u2018named\u2019, namely \u2018n\u2019\n</code></pre>\n\n<p>because:</p>\n\n<pre><code>Prelude Text.XML.Lens&gt; :t named\nnamed\n  :: Applicative f =&gt;\n     case-insensitive-1.2.0.5:Data.CaseInsensitive.Internal.CI\n       Data.Text.Internal.Text\n     -&gt; (Element -&gt; f Element) -&gt; Element -&gt; f Element\n</code></pre>\n\n<p>My code imports <code>Data.Text</code> and relies on <code>OverloadedStrings</code>. What steps should I take to resolve issues like this? What are short term and long term fixes?</p>\n"}, {"tags": ["haskell", "installation", "cabal", "cabal-install"], "comments": [{"owner": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "edited": false, "score": 1, "creation_date": 1452268057, "post_id": 34680829, "comment_id": 57107264, "body": "GHC and cabal version?"}, {"owner": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "edited": false, "score": 0, "creation_date": 1452268817, "post_id": 34680829, "comment_id": 57107824, "body": "Are you using the haskell platform from the ubuntu repo? Please have a look at using a slightly more recent haskell platform/GHC."}, {"owner": {"reputation": 21, "user_id": 5703870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1145e0e7b6591d9e0ada383338f3ad42?s=128&d=identicon&r=PG&f=1", "display_name": "wizzi", "link": "https://stackoverflow.com/users/5703870/wizzi"}, "edited": false, "score": 0, "creation_date": 1452269137, "post_id": 34680829, "comment_id": 57108054, "body": "Sorry like i said i am new to this so i dant know how to check for those?"}, {"owner": {"reputation": 21, "user_id": 5703870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1145e0e7b6591d9e0ada383338f3ad42?s=128&d=identicon&r=PG&f=1", "display_name": "wizzi", "link": "https://stackoverflow.com/users/5703870/wizzi"}, "edited": false, "score": 0, "creation_date": 1452269245, "post_id": 34680829, "comment_id": 57108143, "body": "I installed the haskell platform and there it says that cabal will be installed together with it. I have run cabal update after this too."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1452269563, "post_id": 34680829, "comment_id": 57108396, "body": "Did you read the error? <code>use &#39;ghc-pkg init&#39; to create the database with the correct format</code>"}, {"owner": {"reputation": 21, "user_id": 5703870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1145e0e7b6591d9e0ada383338f3ad42?s=128&d=identicon&r=PG&f=1", "display_name": "wizzi", "link": "https://stackoverflow.com/users/5703870/wizzi"}, "edited": false, "score": 0, "creation_date": 1452269883, "post_id": 34680829, "comment_id": 57108651, "body": "if i try that as i believe it should be run: :~$ ghc-pkg init ghc-pkg: command-line syntax error For usage information see &#39;ghc-pkg --help&#39;."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1452270710, "post_id": 34680829, "comment_id": 57109248, "body": "<code>ghc --version</code>, <code>cabal --version</code>."}, {"owner": {"reputation": 21, "user_id": 5703870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1145e0e7b6591d9e0ada383338f3ad42?s=128&d=identicon&r=PG&f=1", "display_name": "wizzi", "link": "https://stackoverflow.com/users/5703870/wizzi"}, "edited": false, "score": 0, "creation_date": 1452271181, "post_id": 34680829, "comment_id": 57109579, "body": "<code>The Glorious Glasgow Haskell Compilation System, version 7.10.2.20151105</code>, <code>using version 1.16.0 of the Cabal library</code>"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1452274362, "post_id": 34680829, "comment_id": 57111593, "body": "GHC 7.10 with Cabal 1.16? That&#39;s a <i>very</i> odd combination. As far as I know, Cabal 1.16 was for GHC 7.4."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452276785, "post_id": 34680829, "comment_id": 57113032, "body": "A bunch of people ran into this when 7.10 came out, IIRC. I don&#39;t remember the right way to get everything installed. You need to update cabal-install, but the new version only works with new GHC."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1452278458, "post_id": 34680829, "comment_id": 57113997, "body": "Then you need to upgrade Cabal, or downgrade GHC."}, {"owner": {"reputation": 532, "user_id": 660339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ba401042a68ed65c16f73c8cf3a15287?s=128&d=identicon&r=PG", "display_name": "Ivan Perez", "link": "https://stackoverflow.com/users/660339/ivan-perez"}, "edited": false, "score": 1, "creation_date": 1452367114, "post_id": 34680829, "comment_id": 57141705, "body": "My setup for Ubuntu is the following:  Install cabal and GHC version from this ppa: <a href=\"https://launchpad.net/~hvr/+archive/ubuntu/ghc\" rel=\"nofollow noreferrer\">launchpad.net/~hvr/+archive/ubuntu/ghc</a>.  (For instructions, see: <a href=\"http://askubuntu.com/questions/4983/what-are-ppas-and-how-do-i-use-them\" title=\"what are ppas and how do i use them\">askubuntu.com/questions/4983/&hellip;</a>).  Adjust PATH in $HOME/.bashrc to include /opt/ghc/7.10.3/bin and /opt/cabal/1.22/bin.  For extra-points: use sandboxes for everything. Run cabal update, and then modify your $HOME/.cabal/config, adding: require-sandbox: True. Every time I want to experiment, I create a new sandbox. Every project lives in its own sandbox."}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1456433584, "creation_date": 1456433584, "answer_id": 35638112, "question_id": 34680829, "link": "https://stackoverflow.com/questions/34680829/cant-install-cabal-package/35638112#35638112", "title": "cant install cabal package", "body": "<p>This error occurs when you have a very old cabal binary compared to your version of ghc. </p>\n\n<p>You could jump through the package manager routes, or you could use the linux binary download from <a href=\"https://www.haskell.org/cabal/download.html\" rel=\"nofollow\">https://www.haskell.org/cabal/download.html</a></p>\n\n<p>That should suffice to get you off the ground...</p>\n"}], "owner": {"reputation": 21, "user_id": 5703870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1145e0e7b6591d9e0ada383338f3ad42?s=128&d=identicon&r=PG&f=1", "display_name": "wizzi", "link": "https://stackoverflow.com/users/5703870/wizzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 451, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1523242972, "creation_date": 1452267920, "last_edit_date": 1523242972, "question_id": 34680829, "link": "https://stackoverflow.com/questions/34680829/cant-install-cabal-package", "title": "cant install cabal package", "body": "<p>I have a problem with installing quickcheck from cabal on ubuntu 14.4 LTS. I have updated cabal, but when i try to install quickcheck an error comes up:</p>\n\n<pre><code>:~$ cabal install quickcheck\nResolving dependencies...\nConfiguring primitive-0.6.1.0...\nBuilding primitive-0.6.1.0...\nPreprocessing library primitive-0.6.1.0...\nghc: ghc no longer supports single-file style package databases (dist/package.conf.inplace) use 'ghc-pkg init' to create the database with the correct format.\nFailed to install primitive-0.6.1.0\nConfiguring random-1.1...\nBuilding random-1.1...\nPreprocessing library random-1.1...\nghc: ghc no longer supports single-file style package databases (dist/package.conf.inplace) use 'ghc-pkg init' to create the database with the correct format.\nFailed to install random-1.1\ncabal: Error: some packages failed to install:\nQuickCheck-2.8.1 depends on random-1.1 which failed to install.\nprimitive-0.6.1.0 failed during the building phase. The exception was:\nExitFailure 1\nrandom-1.1 failed during the building phase. The exception was:\nExitFailure 1\ntf-random-0.5 depends on random-1.1 which failed to install.\n</code></pre>\n\n<p>I am pretty new ubuntu so I still dont know what to do in a situation like this. i really hope someone can help because it is for a school project which is do soon.</p>\n"}, {"tags": ["haskell", "list-comprehension"], "comments": [{"owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "edited": false, "score": 0, "creation_date": 1452259708, "post_id": 34678133, "comment_id": 57101513, "body": "A good starting point <a href=\"https://wiki.haskell.org/List_comprehension\" rel=\"nofollow noreferrer\">wiki.haskell.org/List_comprehension</a>"}, {"owner": {"reputation": 542, "user_id": 636578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3a58bb2e3ef9f65ae8e1e1921652fac?s=128&d=identicon&r=PG", "display_name": "Andreas", "link": "https://stackoverflow.com/users/636578/andreas"}, "reply_to_user": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "edited": false, "score": 1, "creation_date": 1452260088, "post_id": 34678133, "comment_id": 57101774, "body": "Your link gave me an idea to try this with infinite lists, and did yield results. <code>take 10 [(x,y) | x &lt;- [1..10000], y &lt;- [1..], x==2000, odd y]</code> never finishes while <code>take 10 [(x,y) | x &lt;- [1..10000], x==2000, y &lt;- [1..], odd y]</code> does."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1452268450, "post_id": 34678133, "comment_id": 57107553, "body": "For the desugaring of list comprehensions, see <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-420003.11\" rel=\"nofollow noreferrer\">haskell.org/onlinereport/haskell2010/&hellip;</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1452272112, "post_id": 34678133, "comment_id": 57110199, "body": "The <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-420003.11\" rel=\"nofollow noreferrer\">Report</a> is the canonical, comprehensive resource for core language questions."}], "answers": [{"comments": [{"owner": {"reputation": 542, "user_id": 636578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3a58bb2e3ef9f65ae8e1e1921652fac?s=128&d=identicon&r=PG", "display_name": "Andreas", "link": "https://stackoverflow.com/users/636578/andreas"}, "edited": false, "score": 0, "creation_date": 1452260967, "post_id": 34678457, "comment_id": 57102333, "body": "I didn&#39;t now trace could be used like that, thank you for that! It&#39;s also interesting that this isn&#39;t explicitly written anywhere, I can easily image falling into the trap of putting predicates last and ending up with a function that never finishes. Not only that, there seems to be significant difference in the number of computations performed."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 542, "user_id": 636578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3a58bb2e3ef9f65ae8e1e1921652fac?s=128&d=identicon&r=PG", "display_name": "Andreas", "link": "https://stackoverflow.com/users/636578/andreas"}, "edited": false, "score": 0, "creation_date": 1452261115, "post_id": 34678457, "comment_id": 57102438, "body": "I changed the definition a bit and I think you can see what&#39;s going on better now - but yeah you still have to think things through ;)"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1452263590, "post_id": 34678457, "comment_id": 57104067, "body": "Using <code>trace&#39; c x = trace (c : &#39;=&#39; : show x) True</code> and therefore <code>trace&#39; &#39;x&#39; x</code> and <code>trace&#39; &#39;y&#39; y</code> would make the lines a lot shorter and probably easier to read."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 1, "last_activity_date": 1452264492, "last_edit_date": 1452264492, "creation_date": 1452260380, "answer_id": 34678457, "question_id": 34678133, "link": "https://stackoverflow.com/questions/34678133/haskell-list-comprehension-predicate-order/34678457#34678457", "title": "Haskell: List comprehension predicate order", "body": "<p>They differ in the way of how many intermediary results/lists are generated.</p>\n\n<p>You can visualize this with some <code>trace</code> - note that I modified this a bit to give reasonable results - also I replaced the return values by <code>()</code> to make it clearer:</p>\n\n<pre><code>comprehension1 = [ () | x &lt;- [1..3], trace' 'x' x, y &lt;- [1..3], trace' 'y' y, x==2, odd y]\ncomprehension2 = [ () | x &lt;- [1..3], trace' 'x' x, x==2, y &lt;- [1..3], trace' 'y' y, odd y]\n\ntrace' :: Show a =&gt; Char -&gt; a -&gt; Bool\ntrace' c x = trace (c : '=' : show x) True\n</code></pre>\n\n<p>here is the evaluation:</p>\n\n<pre><code>\u03bb&gt; comprehension1\nx=1\ny=1\ny=2\ny=3\nx=2\ny=1\n[()y=2\ny=3\n,()x=3\ny=1\ny=2\ny=3\n]\n\u03bb&gt; comprehension2\nx=1\nx=2\ny=1\n[()y=2\ny=3\n,()x=3\n]\n</code></pre>\n\n<p>now do you notice something?</p>\n\n<p>Obviously in the first example every <code>(x,y)</code> pair for <code>x=1,2,3</code> and <code>y=1,2,3</code> is generated before the filters are applied.</p>\n\n<p>But in the second example the <code>y</code>s are only generated when <code>x=2</code> - so you could say it's <em>better</em>/more performant</p>\n"}, {"tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 2, "last_activity_date": 1452267694, "creation_date": 1452267694, "answer_id": 34680745, "question_id": 34678133, "link": "https://stackoverflow.com/questions/34678133/haskell-list-comprehension-predicate-order/34680745#34680745", "title": "Haskell: List comprehension predicate order", "body": "<p>You can think of a list comprehension like</p>\n\n<pre><code>[(x,y) | x &lt;- [1..10000], y &lt;- [1..100], x==2000, odd y]\n</code></pre>\n\n<p>as corresponding to the imperative pseudo-code</p>\n\n<pre><code>for x in [1..10000]:\n    for y in [1..100];\n        if x == 2000:\n            if odd y:\n                yield (x,y)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>[(x,y) | x &lt;- [1..10000], x==2000, y &lt;- [1..100], odd y]\n</code></pre>\n\n<p>as corresponding to</p>\n\n<pre><code>for x in [1..10000]:\n    if x == 2000;\n        for y in [1..100]:\n            if odd y:\n                yield (x,y)\n</code></pre>\n\n<p>Specifically, passing the list comprehension to something like <code>mapM_ print</code> is the same operationally as replacing <code>yield</code> by <code>print</code> in the imperative version.</p>\n\n<p>Obviously, it's almost always better to \"float\" a guard/<code>if</code> out of a generator/<code>for</code> when possible. (The rare exception is when the generator is actually an empty list, and the guard condition is expensive to compute.)</p>\n"}], "owner": {"reputation": 542, "user_id": 636578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3a58bb2e3ef9f65ae8e1e1921652fac?s=128&d=identicon&r=PG", "display_name": "Andreas", "link": "https://stackoverflow.com/users/636578/andreas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1272, "favorite_count": 0, "accepted_answer_id": 34678457, "answer_count": 2, "score": 1, "last_activity_date": 1452267694, "creation_date": 1452259341, "question_id": 34678133, "link": "https://stackoverflow.com/questions/34678133/haskell-list-comprehension-predicate-order", "title": "Haskell: List comprehension predicate order", "body": "<p>After reading about the Haskell syntax for List Comprehensions online, I got the feeling that predicates always come last. Eg:</p>\n\n<pre><code>[(x,y) | x &lt;- [1..10000], y &lt;- [1..100], x==2000, odd y]\n</code></pre>\n\n<p>But the following line accomplishes the same result:</p>\n\n<pre><code>[(x,y) | x &lt;- [1..10000], x==2000, y &lt;- [1..100], odd y]\n</code></pre>\n\n<p>Normally I would just take this as a hint that the order doesn't matter and be done with it. However this is a problem that comes from an old exam, and the answer to the problem says that while the results may be the same, the way in which they are computed <em>may</em> differ.</p>\n\n<p>I'm assuming this is true but I can't find any information about it on the web. <strong>So my question is</strong>: How could the computations differ between the two list comprehensions and why? Are list comprehensions some form of syntactic sugar that I don't know about?</p>\n"}, {"tags": ["haskell", "elm"], "comments": [{"owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "edited": false, "score": 0, "creation_date": 1452252481, "post_id": 34675926, "comment_id": 57096735, "body": "This sounds like a use case for the <a href=\"http://hackage.haskell.org/package/mtl-1.1.0.1/docs/Control-Monad-Reader.html\" rel=\"nofollow noreferrer\"><code>reader monad</code></a>."}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1452252506, "post_id": 34675926, "comment_id": 57096755, "body": "you can partialy apply the apikey for all your functions, is this what you need?"}, {"owner": {"reputation": 348, "user_id": 1118408, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/4Mxbh.jpg?s=128&g=1", "display_name": "Umur Gedik", "link": "https://stackoverflow.com/users/1118408/umur-gedik"}, "reply_to_user": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1452253079, "post_id": 34675926, "comment_id": 57097146, "body": "@DanielSanchez actually I tried that (updated question). But now i have to pass makeFlickrRequest function to every module who needs to make a request. Im looking for a better option :)"}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1452253230, "post_id": 34675926, "comment_id": 57097239, "body": "make <code>&#39;</code> version of this functions, im not a pro haskeller im just saying whatever cames to my head, maybe the reader monad as sayed is an easyer aproach."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1452310615, "post_id": 34675926, "comment_id": 57125294, "body": "Another good way to pass configuration info around implicitly is to use the <code>reflection</code> library. You <code>reify</code> the configuration when calling whatever function gets things going for real, and then use <code>reflect</code> to get it back wherever you need it."}], "answers": [{"comments": [{"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1452254027, "post_id": 34676457, "comment_id": 57097754, "body": "Beautiful and elegant, must get myself onto monads, thanks for this."}, {"owner": {"reputation": 348, "user_id": 1118408, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/4Mxbh.jpg?s=128&g=1", "display_name": "Umur Gedik", "link": "https://stackoverflow.com/users/1118408/umur-gedik"}, "edited": false, "score": 0, "creation_date": 1452257604, "post_id": 34676457, "comment_id": 57100106, "body": "Thanks for the detailed explanation. I was trying to avoid using monads to keep it simple. But it seems the easiest way to handle that is using reader monad. Elm doesn&#39;t have <code>do</code> notaion unfortunately :( I will accept your answer if someone doesn&#39;t come up with alternative solution."}], "tags": [], "owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "is_accepted": false, "score": 6, "last_activity_date": 1452253804, "creation_date": 1452253804, "answer_id": 34676457, "question_id": 34675926, "link": "https://stackoverflow.com/questions/34675926/initializing-a-module-with-set-of-defaults-elm-or-haskell/34676457#34676457", "title": "Initializing a module with set of defaults (elm or haskell)", "body": "<p>With the <a href=\"http://hackage.haskell.org/package/mtl-1.1.0.1/docs/Control-Monad-Reader.html\">reader monad</a>, you can hide the common 'environment' of all your functions (the API key) away. Here's a simple example:</p>\n\n<p>First,</p>\n\n<pre><code>import Control.Monad.Reader\n</code></pre>\n\n<p>Then, some type aliases to help readability. What's noteworthy here is the <code>FlickrRequest a</code> part - it represents a flickr request which returns a value of type <code>a</code>:</p>\n\n<pre><code>type APIKey = String\ntype Photo = String\ntype PhotoInfo = String\n\ntype FlickrRequest a = Reader APIKey a\n</code></pre>\n\n<p>Here are two dummy implementations of searching for photos and getting the information for some photo:</p>\n\n<pre><code>searchPhotos :: String -&gt; FlickrRequest [Photo]\nsearchPhotos query = do\n    apiKey &lt;- ask\n    return [\"&lt;Photo for query \" ++ query ++ \" (api key \" ++ apiKey ++ \")&gt;\"]\n\ngetPhotoInfo :: Photo -&gt; FlickrRequest PhotoInfo\ngetPhotoInfo photo = do\n    apiKey &lt;- ask\n    return $ \"This is the photo information for photo \" ++ photo ++ \" (\" ++ apiKey ++ \")\"\n</code></pre>\n\n<p>Note that the API key is passed implicitly via the <code>FlickrRequest</code> reader. Within the functions, you can access that environment (you get 'read' the environment) using <a href=\"http://hackage.haskell.org/package/mtl-1.1.0.1/docs/Control-Monad-Reader-Class.html#v:ask\"><code>ask</code></a>. The beauty of this comes in when combining such functions which all operate in the same environment, e.g.:</p>\n\n<pre><code>-- This could be just `searchPhotos \"*\" &gt;&gt;= mapM getPhotoInfo` but I don't\n-- want to obscure things unnecessarily.\nallPhotoInfos :: FlickrRequest [PhotoInfo]\nallPhotoInfos = do\n    photos &lt;- searchPhotos \"*\"\n    sequence (map getPhotoInfo photos)\n</code></pre>\n\n<p>We first call <code>searchPhotos</code> and then apply <code>getPhotoInfo</code> to all the found photos. Notice how the API key is nowhere to be seen, it's implicitely passed around!</p>\n\n<p>Finally, to run the whole thing, you can use the <code>runReader</code> function. Something like</p>\n\n<pre><code>main :: IO ()\nmain = do\n    let myAPIKey = \"someAPIKey\"\n    print (runReader allPhotoInfos myAPIKey)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": false, "score": 0, "last_activity_date": 1452253928, "creation_date": 1452253928, "answer_id": 34676498, "question_id": 34675926, "link": "https://stackoverflow.com/questions/34675926/initializing-a-module-with-set-of-defaults-elm-or-haskell/34676498#34676498", "title": "Initializing a module with set of defaults (elm or haskell)", "body": "<p>Just for explaining my comments, I mean apply the apikey to every function as this <a href=\"http://goo.gl/uEdKki\" rel=\"nofollow\">example</a>:</p>\n\n<pre><code>type ApiKey = String\n\napikey::ApiKey\napikey = \"foo\"\n\n\nf1 :: ApiKey -&gt; String -&gt; String\nf1 \"foo\" _  = \"1\"\nf1 _ s =  s\n\nf2 :: ApiKey -&gt; String -&gt; String\nf2 \"foo\" _  = \"2\"\nf2 _ s =  s\n\nf1', f2':: (String -&gt; String)\n[f1', f2'] = map (\\x-&gt; x apikey) [f1, f2]\n\nmain = do\n    putStrLn $ f1 \"asdf\" \"2\"\n    putStrLn $ f1' \"2\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 4, "last_activity_date": 1452260368, "creation_date": 1452260368, "answer_id": 34678449, "question_id": 34675926, "link": "https://stackoverflow.com/questions/34675926/initializing-a-module-with-set-of-defaults-elm-or-haskell/34678449#34678449", "title": "Initializing a module with set of defaults (elm or haskell)", "body": "<p>Frerich Raabe's solution works great for Haskell but we unfortunately don't have the luxury of <code>do</code> notation in Elm or a Reader Monad equivalent.</p>\n\n<p>However, we have ports, which we can use to provide configuration data when initializing the Elm module from Javascript.</p>\n\n<p>For instance, you can have a port called <code>apiKey</code> defined in Elm. Since the value of the port comes from javascript, we only define the function signature, not the body:</p>\n\n<pre class=\"lang-elm prettyprint-override\"><code>port apiKey : String\n</code></pre>\n\n<p>In the HTML/javascript file where the Elm module gets initiated, you can pass a second parameter that contains initial port values like this:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;script&gt;\n  var app = Elm.fullscreen(Elm.Main, {\n    apiKey: \"myApiKey\"\n  });\n&lt;/script&gt;\n</code></pre>\n\n<p>Now, throughout your Elm code, you have a constant function called <code>apiKey</code> always available. You never need to pass it in as a parameter to other functions.</p>\n"}], "owner": {"reputation": 348, "user_id": 1118408, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/4Mxbh.jpg?s=128&g=1", "display_name": "Umur Gedik", "link": "https://stackoverflow.com/users/1118408/umur-gedik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 1, "accepted_answer_id": 34678449, "answer_count": 3, "score": 3, "last_activity_date": 1452260368, "creation_date": 1452252305, "last_edit_date": 1452253004, "question_id": 34675926, "link": "https://stackoverflow.com/questions/34675926/initializing-a-module-with-set-of-defaults-elm-or-haskell", "title": "Initializing a module with set of defaults (elm or haskell)", "body": "<p>Let's assume we have a module which is responsible for making api requests to <strong>Flickr</strong>. I don't want to hard code api keys into Flickr module. Api key could be get by an ajax request. </p>\n\n<p>For now every function in the Flickr module accept apiKey as its argument. But its not that cool pass that api key all around. Is there any simple way to solve that? Or is it possible to share some values between modules without passing that every single function.</p>\n\n<pre><code>module Flickr where\n\nsearchPhotos : String -&gt; String -&gt; ...\nsearchPhotos apiKey query = ...\n\ngetPhotoInfo : String -&gt; String -&gt; ...\ngetPhotoInfo apiKey photoId = ...\n\nanotherOne : String -&gt; ...\nanotherOne apiKey = ...\n</code></pre>\n\n<hr>\n\n<p><strong>UPDATE:</strong> What i have tried so far is partially applying functions. I put apiKey like arguments at the end. But now I have to pass that function all around, any other ideas?</p>\n\n<pre><code>makeFlickrRequest : (String -&gt; String -&gt; a) -&gt; a\nmakeFlickrRequest flickrMethod = flickrMethod \"myApikey\" \"mySecret\"\n\nphotosSearch : String -&gt; String -&gt; String -&gt; ...\nphotosSearch query apiKey secret =\n    makeHTTPCallhere ...\n\n-- Usage:\nmakeFlickrRequest (photosSearch \"haskell\")\n</code></pre>\n"}, {"tags": ["haskell", "yesod", "yesod-forms"], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 1, "last_activity_date": 1452362916, "creation_date": 1452362916, "answer_id": 34697101, "question_id": 34675346, "link": "https://stackoverflow.com/questions/34675346/javascript-alerts-in-yesod/34697101#34697101", "title": "Javascript Alerts in Yesod", "body": "<p>This is basically an \"outside the scope of Yesod\" issue: if you want the behavior to occur based on a user responding to an alert box, it has to be handled in Javascript, in which can your approach works quite well. Once within the Javascript world, there are dozens/hundreds of different ways of doing this (automatically using a timer? use a notification message on the page instead of a separate dialog? etc), but there's nothing you can do server side to check that the user has clicked a button without Javascript support.</p>\n"}], "owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 34697101, "answer_count": 1, "score": 0, "last_activity_date": 1452362916, "creation_date": 1452250550, "last_edit_date": 1452252281, "question_id": 34675346, "link": "https://stackoverflow.com/questions/34675346/javascript-alerts-in-yesod", "title": "Javascript Alerts in Yesod", "body": "<p>I have a program where the user can upload a file, some validation of this file takes place, and if the validation fails, I would like to provide feedback to the user via a javascript alert message, rather than via a message embedded in the html itself. </p>\n\n<p>Ideally, once the user has acknowledged the alert message (clicking the alert button), the program can redirect to another route.</p>\n\n<p>Unfortunately the redirection seems to happen right away, without pausing until the user clicks the alert button, so the alert is missed altogether. </p>\n\n<p>Here is a simple snippet which illustrates the problem : the user is asked to pick a file. If it is a text file its name is displayed, otherwise an alert is produced. </p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE QuasiQuotes #-}\n{-# LANGUAGE TemplateHaskell #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n\nimport Yesod\n\nimport Control.Concurrent.STM (TVar, newTVarIO, readTVarIO, atomically, writeTVar)\n\nimport Data.Text (Text)\n\ndata App = App (TVar Text)\n\nmkYesod \"App\" [parseRoutes|\n/ HomeR GET POST\n/alert AlertR GET\n|]\n\ninstance Yesod App\n\ninstance RenderMessage App FormMessage where\n  renderMessage _ _ = defaultFormMessage\n\ngetHomeR :: Handler Html\ngetHomeR = do\n    (formWidget, formEncType) &lt;- generateFormPost uploadForm\n\n    App ttxt &lt;- getYesod\n    txt      &lt;- liftIO $ readTVarIO ttxt\n    liftIO $ print txt\n    defaultLayout $ do\n     [whamlet| \n        &lt;h1&gt;Text file name: #{txt}\n        &lt;p&gt;\n        &lt;form method=post action=@{HomeR} enctype=#{formEncType}&gt;\n            ^{formWidget} #\n            &lt;input type=\"submit\" value=\"Upload File Name\"&gt;\n     |]\n\npostHomeR :: Handler Html\npostHomeR = do\n    ((result, _), _) &lt;- runFormPost uploadForm\n    case result of\n      FormSuccess fi -&gt; do\n        app &lt;- getYesod\n        case fileContentType fi of\n            \"text/plain\" -&gt; updateFileName app $ fileName fi\n            _            -&gt; redirect AlertR\n      _ -&gt; return ()   \n    redirect HomeR\n\nupdateFileName :: App -&gt; Text -&gt; Handler ()\nupdateFileName app@(App ttxt) txtnew = \n    liftIO . atomically $ writeTVar ttxt txtnew\n\ngetAlertR :: Handler Html\ngetAlertR = do\n    defaultLayout $ do\n        setTitle \"ALERT!\"\n        toWidgetBody [julius| \n                        alert(\"Only text files are accepted\");\n                     |]\n    redirect HomeR \n\nuploadForm = renderDivs $ fileAFormReq \"file\"\n\nmain :: IO ()\nmain = do\n    ttxt &lt;- newTVarIO \"nil\"\n    warp 3000 $ App ttxt\n</code></pre>\n\n<p>So this does not work and, in getAlertR, the <code>redirect HomeR</code> code does not \"wait\" until the user clicks the alert button (in fact the alert is not even displayed).</p>\n\n<p>To get around the issue I have changed getAlertR like that :</p>\n\n<pre><code>getAlertR :: Handler Html\ngetAlertR = do\n    defaultLayout $ do\n        setTitle \"ALERT!\"\n        toWidgetBody [julius| \n                        alert(\"Only text files are accepted\");\n                        location.assign(\"@{HomeR}\"); \n                     |]\n    -- redirect HomeR \n</code></pre>\n\n<p>... which works ok. </p>\n\n<p>But here is <strong>my question</strong> : is there a more \"Yesod-like\" way to do this without having the routing inside the julius script?</p>\n"}, {"tags": ["haskell", "types", "io", "io-monad"], "comments": [{"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1452246990, "post_id": 34673878, "comment_id": 57093235, "body": "your code compiles for me making <code>isDoesNotexistError</code> always return true, so the problem may be in the otherwise part?"}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1452247069, "post_id": 34673878, "comment_id": 57093301, "body": "yep, just checked, throwIO is returning an <code>IO a</code>, not <code>IO ()</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 4, "creation_date": 1452247208, "post_id": 34673878, "comment_id": 57093393, "body": "to me it seems that the signature you are looking for is <code>String -&gt; IO (Maybe String)</code>"}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1452247215, "post_id": 34673878, "comment_id": 57093401, "body": "check this: <a href=\"http://goo.gl/XI2N5y\" rel=\"nofollow noreferrer\">goo.gl/XI2N5y</a> it compiles, change your signature to <code>String -&gt; IO a</code>, im just testing, not sure if it is ok"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 1, "creation_date": 1452271867, "post_id": 34673878, "comment_id": 57110043, "body": "@DanielSanchez What are you on about? <code>IO a</code> unifies with <code>IO ()</code> just fine, and the code in the link you posted doesn&#39;t compile at all."}], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1452248243, "post_id": 34674412, "comment_id": 57094019, "body": "I don&#39;t think it will work this way - IMO you have to help out the compiler by giving the <code>Exception</code> instance like this: <code>handleExists :: IOException -&gt; IO (Maybe String) ...</code> ... yep - Haskell is complaining on when I try yours ;) - I allowed myself to change yours into a working condition - just roll back if you don&#39;t like it"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1452248468, "post_id": 34674412, "comment_id": 57094160, "body": "of course you probably won&#39;t need this if <code>isDooesNotExistError</code> has the right signature ... I was lazy and just did <code>isDoesNotExistError = undefined</code> ;)"}, {"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1452254630, "post_id": 34674412, "comment_id": 57098137, "body": "@Carsten I have no idea, I didn&#39;t actually compile it. <code>isDoesNotExistError</code> has the right signature, so I would assume it compiles without the signature, but it doesn&#39;t hurt either."}], "tags": [], "owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "is_accepted": true, "score": 8, "last_activity_date": 1452248346, "last_edit_date": 1452248346, "creation_date": 1452247907, "answer_id": 34674412, "question_id": 34673878, "link": "https://stackoverflow.com/questions/34673878/haskell-safe-io/34674412#34674412", "title": "Haskell Safe IO", "body": "<p>You need to figure out what you want your function to actually do.</p>\n\n<p>If it successfully reads the file, you want it to return the contents as a string.</p>\n\n<p>If it fails, what do you actually want it to do? Return an empty string or some other fallback content? Then you can just change the <code>return ()</code> to <code>return \"\"</code> in the first case of <code>handleExists</code>.</p>\n\n<p>But if you want to indicate the error in the return type, then you need to return a different type than just <code>String</code>. As Carsten said, you can return a <code>Maybe String</code> and give <code>Just theString</code> for success and <code>Nothing</code> for error. Or you could return an <code>Either</code> if you want some error message instead.</p>\n\n<p>I feel that for this particular function, <code>Maybe String</code> makes the most sense, since you only catch non-presence of the file and rethrow other errors. Then your code needs to look like this:</p>\n\n<pre><code>safeRead :: String -&gt; IO (Maybe String)\nsafeRead path = (fmap Just $ readFile path) `catch` handleExists\n  where\n    handleExists :: IOException -&gt; IO (Maybe String)\n    handleExists e\n      | isDoesNotExistError e = return Nothing\n      | otherwise = throwIO e\n</code></pre>\n\n<p>Here we wrap the result of <code>readFile</code> in a <code>Just</code> to fulfill the type requirement, and in the error case return <code>Nothing</code> instead of unit.</p>\n"}], "owner": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 569, "favorite_count": 0, "accepted_answer_id": 34674412, "answer_count": 1, "score": 1, "last_activity_date": 1452248346, "creation_date": 1452246336, "last_edit_date": 1452246980, "question_id": 34673878, "link": "https://stackoverflow.com/questions/34673878/haskell-safe-io", "title": "Haskell Safe IO", "body": "<p>I am attempting to write a simple function to safely read a file (if it exists) and do nothing if the file does not exist:</p>\n\n<pre><code>safeRead :: String -&gt; IO ()\nsafeRead path = readFile path `catch` handleExists\n  where handleExists e\n          | isDoesNotExistError e = return ()\n          | otherwise = throwIO e\n</code></pre>\n\n<p>This fails at compile time with</p>\n\n<pre><code>Couldn't match type \u2018[Char]\u2019 with \u2018()\u2019\nExpected type: IO ()\n  Actual type: IO String\nIn the first argument of \u2018catch\u2019, namely \u2018readFile path\u2019\nIn the expression: readFile path `catch` handleExists\n</code></pre>\n\n<p>This makes sense since <code>:t readFile</code> is <code>readFile :: FilePath -&gt; IO String</code>. e.g a function that returns <code>IO String</code> (and <code>IO String</code> is not the same as <code>IO ()</code>)</p>\n\n<p>Changing the signature to <code>String -&gt; IO String</code></p>\n\n<pre><code>Couldn't match type \u2018()\u2019 with \u2018[Char]\u2019\nExpected type: IOError -&gt; IO String\n  Actual type: IOError -&gt; IO ()\nIn the second argument of \u2018catch\u2019, namely \u2018handleExists\u2019\nIn the expression: readFile path `catch` handleExists\n</code></pre>\n\n<p>Which also makes sense since handleExists has type <code>IO ()</code></p>\n\n<p>To save everyone lookup, catch is imported with:\n<code>import Control.Exception</code>\n the signature of catch is:\n<code>catch :: Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a</code></p>\n\n<p>My real question is, how can I write this kind of error safe, flexible code in Haskell? More specifically what would be the change I would have to make to this function to have it handle both a success case and a failure case?</p>\n"}, {"tags": ["haskell", "io"], "answers": [{"comments": [{"owner": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "edited": false, "score": 0, "creation_date": 1452245236, "post_id": 34673441, "comment_id": 57092087, "body": "while this is obviously true (thank you for taking the time to point it out!) this does not cause my error message to go away (or even change). To avoid confusion going forward I&#39;ve edited my question to fix the syntax"}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "reply_to_user": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "edited": false, "score": 0, "creation_date": 1452245263, "post_id": 34673441, "comment_id": 57092099, "body": "let me proppercheck then"}], "tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": false, "score": 2, "last_activity_date": 1452245515, "last_edit_date": 1452245515, "creation_date": 1452245116, "answer_id": 34673441, "question_id": 34673374, "link": "https://stackoverflow.com/questions/34673374/haskell-saferead-of-file/34673441#34673441", "title": "Haskell saferead of file", "body": "<p>You missed a <code>=</code> after otherwise:</p>\n\n<pre><code>safeRead :: String -&gt; IO ()\nsafeRead path = readFile path `catch` handleExists\n    where handleExists e\n            | isDoesNotExistError e = return ()\n            | otherwise = throwIO e\n</code></pre>\n\n<p>As Sebastian said, the '|' must be pass the <code>handleExists</code> <code>h</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "edited": false, "score": 0, "creation_date": 1452246402, "post_id": 34673490, "comment_id": 57092814, "body": "Thanks for the clarification on indentation of <code>|</code>, now I know :) Also thanks for the &quot;jsfiddle of haskell&quot; link. That&#39;ll come in handy."}], "tags": [], "owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "is_accepted": true, "score": 2, "last_activity_date": 1452245260, "creation_date": 1452245260, "answer_id": 34673490, "question_id": 34673374, "link": "https://stackoverflow.com/questions/34673374/haskell-saferead-of-file/34673490#34673490", "title": "Haskell saferead of file", "body": "<p>You have two errors.</p>\n\n<p>One, as Daniel Sanchez pointed out, is that you're missing an <code>=</code> after <code>otherwise</code>.</p>\n\n<p>The other is that the cases of <code>handleExists</code> must be indented more than the function name, not the <code>where</code>. In other words, move the two <code>|</code> to the right beyond the <code>h</code> of <code>handleExists</code>.</p>\n\n<p>Demo: <a href=\"http://goo.gl/EY2c7o\" rel=\"nofollow\">http://goo.gl/EY2c7o</a></p>\n"}], "owner": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 34673490, "answer_count": 2, "score": 0, "last_activity_date": 1452245903, "creation_date": 1452244888, "last_edit_date": 1452245903, "question_id": 34673374, "link": "https://stackoverflow.com/questions/34673374/haskell-saferead-of-file", "title": "Haskell saferead of file", "body": "<p>I am attempting to write a simple Haskell function that reads a files contents, if the file exists, and does nothing otherwise.</p>\n\n<pre><code>safeRead :: String -&gt; IO ()\nsafeRead path = readFile path `catch` handleExists\n  where handleExists e\n    | isDoesNotExistError e = return ()\n    | otherwise = throwIO e\n</code></pre>\n\n<p>This, however, fails with: <code>parse error (possibly incorrect indentation or mismatched brackets)</code></p>\n\n<p>Why? I've double checked the indentation several times and all seems fine by me?</p>\n"}, {"tags": ["haskell", "data-structures", "hashtable", "time-complexity"], "comments": [{"owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "edited": false, "score": 4, "creation_date": 1452242877, "post_id": 34672529, "comment_id": 57090768, "body": "In practice you should benchmark O(1) vs O(log n) algorithms (the former may have a bigger constant), <code>Data.Map</code> or <code>Data.IntMap</code> could be a good choice. If you wish <code>Data.HashTable</code> check <a href=\"https://hackage.haskell.org/package/hashtables\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/hashtables</a> In general I think is most important the final memory usage."}], "answers": [{"comments": [{"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1452244915, "post_id": 34672918, "comment_id": 57091909, "body": "Have both large and small mutable maps generally performed worse for you?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1452246966, "post_id": 34672918, "comment_id": 57093216, "body": "Large mutable maps performed worse. In particular, the commented-out <code>trieToNode</code> <a href=\"https://hackage.haskell.org/package/packed-dawg-0.2.0.8/docs/src/Data-DAWG-Packed.html#pack\" rel=\"nofollow noreferrer\">here</a> performed significantly worse for maps with 300k-500k elements."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 6, "last_activity_date": 1452244617, "last_edit_date": 1452244617, "creation_date": 1452243307, "answer_id": 34672918, "question_id": 34672529, "link": "https://stackoverflow.com/questions/34672529/algorithmic-complexity-of-data-hashtable/34672918#34672918", "title": "Algorithmic complexity of Data.Hashtable", "body": "<p><code>Data.HashTable</code> has been deprecated and you won't find it in current <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/index.html\" rel=\"noreferrer\"><code>base</code></a>.</p>\n\n<p>It was deprecated because it performed poorly in comparison to <a href=\"https://hackage.haskell.org/package/hashtables\" rel=\"noreferrer\"><code>hashtables</code></a>.</p>\n\n<p>However, <code>hashtables</code> and <code>Data.HashTable</code> are both mutable implementations, while <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/containers-0.5.6.2/Data-Map.html\" rel=\"noreferrer\"><code>Data.Map</code></a> and <a href=\"https://hackage.haskell.org/package/unordered-containers\" rel=\"noreferrer\"><code>Data.HashMap</code></a> are immutable. </p>\n\n<p>Mutable hashmaps in Haskell are similar to the array-of-buckets or open addressing solutions in other languages. Immutable maps are based on trees or tries. In general, immutable associative containers can't be implemented with O(1) modification. </p>\n\n<p>So why use immutable maps? </p>\n\n<p>First, the API is much more convenient in Haskell. We can't use use mutable maps in pure functions, only in IO or ST actions. </p>\n\n<p>Second, immutable maps can be safely shared between threads, which is often a crucial feature. </p>\n\n<p>Third, in practice, performance difference between mutable and immutable maps can be insignificant, i. e. it doesn't noticeably impact overall program performance. O(log n) is also bounded by the available memory, so we don't get spectacular asymptotic differences compared to O(1). In particular, <code>Data.HashMap</code> uses a 16-branching trie, so trie depth can't realistically be more than 6 or 7.</p>\n\n<p>Fourth, immutable maps can be just plain faster for reasons that I don't fully understand (more optimized libraries? better optimization from GHC?); I have tried a couple of times to replace <code>Data.HashMap</code> with mutable maps from <code>hashtables</code>, but the performance was always a bit worse afterwards.</p>\n"}, {"comments": [{"owner": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "edited": false, "score": 0, "creation_date": 1452246030, "post_id": 34673737, "comment_id": 57092582, "body": "My key is of type String"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "edited": false, "score": 0, "creation_date": 1452271576, "post_id": 34673737, "comment_id": 57109843, "body": "@AbrahamP You may want to consider a (path-compressed) trie in that case."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "edited": false, "score": 0, "creation_date": 1452278018, "post_id": 34673737, "comment_id": 57113740, "body": "@AbrahamP, how long are your keys? That really does make a difference. Also, you should see if hash maps, trie variants, etc., are fast enough before you abandon purity and its advantages to use hash tables."}], "tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 3, "last_activity_date": 1452246953, "last_edit_date": 1452246953, "creation_date": 1452245980, "answer_id": 34673737, "question_id": 34672529, "link": "https://stackoverflow.com/questions/34672529/algorithmic-complexity-of-data-hashtable/34673737#34673737", "title": "Algorithmic complexity of Data.Hashtable", "body": "<blockquote>\n  <blockquote>\n    <p>Why would I ever want to use Data.Map given its inefficiency?</p>\n  </blockquote>\n</blockquote>\n\n<p>It may not be efficient, but it supports any type of key with an Ord instance, even those cannot be hashed to an integer.</p>\n\n<blockquote>\n  <blockquote>\n    <p>Is O(lookupInDataHashTable) = O(1)?</p>\n  </blockquote>\n</blockquote>\n\n<p>Generally yes. The workflow of \"lookupInDataHashTable\" and the corressponding performance in big-O notation is:</p>\n\n<ol>\n<li>Hash the key. for integer: O(1), for string: O(length of string)</li>\n<li>Access an IOArray with the hash, get a list containing all the key-value pairs which have the same hash. O(1)</li>\n<li>Look up the key in the list. O(length of the list)</li>\n</ol>\n\n<p>So unless you have very long strings as keys, the lookup function gurantees O(1) performance.</p>\n\n<blockquote>\n  <blockquote>\n    <p>Is there a better library for my data structure needs?</p>\n  </blockquote>\n</blockquote>\n\n<p>It depends on the type of your key. For distinct integers Data.IntMap bests, for other hash-able types Data.HashMap shows decent performance, otherwise you have no choice but Data.Map.</p>\n"}], "owner": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 34673737, "answer_count": 2, "score": 6, "last_activity_date": 1452246953, "creation_date": 1452241771, "question_id": 34672529, "link": "https://stackoverflow.com/questions/34672529/algorithmic-complexity-of-data-hashtable", "title": "Algorithmic complexity of Data.Hashtable", "body": "<p>I am attempting to write a function that utilizes hashes (for an implementation of A*).</p>\n\n<p>After a little bit of research, I have found that the defacto standard is <code>Data.Map</code>.</p>\n\n<p>However, when reading the API documentation, I found that: <code>O(log n). Find the value at a key.</code></p>\n\n<p><a href=\"https://downloads.haskell.org/~ghc/6.12.2/docs/html/libraries/containers-0.3.0.0/Data-Map.html\" rel=\"noreferrer\">https://downloads.haskell.org/~ghc/6.12.2/docs/html/libraries/containers-0.3.0.0/Data-Map.html</a></p>\n\n<p>In fact the documentation generally suggests big O times significantly inferior to the O(1) of a standard Hash.</p>\n\n<p>So then I found <code>Data.HashTable</code>.\n<a href=\"https://hackage.haskell.org/package/base-4.2.0.2/docs/Data-HashTable.html\" rel=\"noreferrer\">https://hackage.haskell.org/package/base-4.2.0.2/docs/Data-HashTable.html</a>\nThis documentation does not mention big O directly, leading me to believe that it probably fulfills my expectations.</p>\n\n<p>I have several questions:\n1) Is that correct? Is O(lookupInDataHashTable) = O(1)?\n2) Why would I ever want to use <code>Data.Map</code> given its inefficiency?\n3) Is there a better library for my data structure needs?</p>\n"}, {"tags": ["haskell", "lambda"], "answers": [{"tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": false, "score": 1, "last_activity_date": 1452221925, "last_edit_date": 1495540319, "creation_date": 1452221925, "answer_id": 34668806, "question_id": 34668219, "link": "https://stackoverflow.com/questions/34668219/why-does-haskells-showlist-function-return-shows/34668806#34668806", "title": "Why does Haskell&#39;s showList function return ShowS", "body": "<p><code>ShowS</code> exists to allow for optimization of concatenation and concatenation by composition. See <a href=\"https://stackoverflow.com/questions/9197913/what-is-the-shows-trick-in-haskell\">this Stack Overflow answer</a> for more information on <code>ShowS</code>.</p>\n\n<p>For your example, instead of ignoring <code>y</code>, you may want to retain the concatenation benefits with something like this:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>showList (xs) = ((intercalate \"&amp;\" $ map show xs) ++)\n</code></pre>\n"}], "owner": {"reputation": 587, "user_id": 1015602, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ea1629e2c2d1d82ab8c3645d82ecc60d?s=128&d=identicon&r=PG", "display_name": "Free_D", "link": "https://stackoverflow.com/users/1015602/free-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "closed_date": 1452222824, "answer_count": 1, "score": 2, "last_activity_date": 1452221925, "creation_date": 1452217574, "question_id": 34668219, "link": "https://stackoverflow.com/questions/34668219/why-does-haskells-showlist-function-return-shows", "closed_reason": "Duplicate", "title": "Why does Haskell&#39;s showList function return ShowS", "body": "<p>I am trying to create a type for simple key/value pairs, that can be converted to a URL query. So I created the following ADT:</p>\n\n<pre><code>data Target where\n    (:=&gt;) :: String -&gt; String -&gt; Target\n\ninstance Show Target where\n    show (a :=&gt; b) = a ++ \"=\" ++ b\n    showList (xs) = (\\y -&gt; intercalate \"&amp;\" $ map show xs)\n</code></pre>\n\n<p>When I run it in ghci it works exactly how I want:</p>\n\n<pre><code>ghci&gt;[\"id\" :=&gt; \"123\", \"color\" :=&gt; \"red\"]\nid=123&amp;color=red\nit :: [Target]\n</code></pre>\n\n<p>My question is: Why do I need the lambda in <code>showList</code>?  I tried to <code>show y</code> and it just prints an empty string.  What is the purpose of returning a <code>ShowS</code> when the argument is just empty? Or maybe a better question, to what is the <code>showS</code> function applied in this case?</p>\n"}, {"tags": ["haskell", "type-systems"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1452206933, "post_id": 34666569, "comment_id": 57079015, "body": "You at least need <code>let</code>-polymorphism for this to work.  In STLC every expression still does have a type, even if the particular language doesn&#39;t require you to write it."}, {"owner": {"reputation": 4444, "user_id": 2662193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7318fa44e2a2cf165441a765c3c4f62?s=128&d=identicon&r=PG", "display_name": "Levi Pearson", "link": "https://stackoverflow.com/users/2662193/levi-pearson"}, "edited": false, "score": 3, "creation_date": 1452207030, "post_id": 34666569, "comment_id": 57079053, "body": "The simply-typed lambda calculus is an explicitly typed language; the types are part of the syntax."}, {"owner": {"reputation": 10492, "user_id": 603688, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1058344e1b119c4d9dd3aedc5456277b?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/603688/dan"}, "edited": false, "score": 0, "creation_date": 1452208542, "post_id": 34666569, "comment_id": 57079628, "body": "I think this is possible, but it could only produce lists of fixed (ie, in the type) size: <code>\u03bb a:\u03b1. \u03bb b:\u03b2. \u03bb f:\u03b1-&gt;\u03b2-&gt;\u03b3. f a b</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1452210771, "post_id": 34666569, "comment_id": 57080380, "body": "In STLC you can&#39;t even have types of the form <code>List Int</code>, i.e. parametric types. Adding this corresponds to weak-\u03bb\u03c9 in Barendregt&#39;s &quot;lambda cube&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1452225660, "post_id": 34667076, "comment_id": 57084279, "body": "Type checking is undecidable only for Curry-style System F (no explicit types at all). For Church-style System F (explicit type annotations in the appropriate places) type checking is decidable."}], "tags": [], "owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "is_accepted": true, "score": 7, "last_activity_date": 1452209440, "creation_date": 1452209440, "answer_id": 34667076, "question_id": 34666569, "link": "https://stackoverflow.com/questions/34666569/is-it-possible-to-write-list-functions-on-the-simply-typed-lambda-calculus/34667076#34667076", "title": "Is it possible to write list functions on the simply typed lambda calculus?", "body": "<p>No, it is not possible to write polymorphic functions on STLC. In the definition of STLC there's no universally quantified types. In order to represent polymorphic lists you need some language with type abstraction, like System F.</p>\n\n<p>In your question you mixed (please correct me, if I understand it wrong) the STLC with an inference algorithm for it. If you want polymorphic types, you need a language with type abstraction and application (in order to have type instantiation). </p>\n\n<p>Type inference algorithms (like the ones used by Haskell or ML) consider a restrict version of System F, that is usually called Mini (or Core) ML. Such restrictions are motivated by the undecidability of type inference and checking for System F (details <a href=\"http://www.sciencedirect.com/science/article/pii/S0168007298000475\">here</a>). More details about this can be found on:</p>\n\n<ul>\n<li>Chapter 23 of Types and programming languages</li>\n<li><a href=\"https://hal.inria.fr/inria-00076025/file/RR-0529.pdf\">A simple applicative language: Mini-ML</a>. This article presents the language Mini-ML: its syntax, semantics, type system and type-inference algorithm. It's old, but very readable.</li>\n<li><a href=\"http://research.microsoft.com/en-us/um/people/simonpj/papers/higher-rank/putting.pdf\">Practical type inference for arbitrary rank types</a> presents a more expressive fragment of System F and discuss its implementation in Haskell.</li>\n</ul>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 34667076, "answer_count": 1, "score": 1, "last_activity_date": 1452209440, "creation_date": 1452206594, "question_id": 34666569, "link": "https://stackoverflow.com/questions/34666569/is-it-possible-to-write-list-functions-on-the-simply-typed-lambda-calculus", "title": "Is it possible to write list functions on the simply typed lambda calculus?", "body": "<p>Can you write polymorphic list functions such as <code>cons</code>, <code>nil</code> and <code>reverse</code> on the STLC?</p>\n\n<p>To elaborate the question, in order to write <code>cons</code>, in Haskell, you need polymorphic types:</p>\n\n<pre><code>cons : \u2200 a . a -&gt; List a -&gt; List a\n</code></pre>\n\n<p>There is no such thing as <code>\u2200</code> on the STLC, so I'd think it is obvious that polymorphic list functions are impossible, i.e., you need to write a new definition of <code>cons</code> for each specialized list type. But what if you leave the type annotation out, and instead have this:</p>\n\n<pre><code>cons = ...\na = cons 1 []\nb = cons \"\" []\n</code></pre>\n\n<p>The inferencer can identify that <code>cons : Int -&gt; List Int -&gt; List Int</code> on the first case, and <code>cons : String -&gt; List String -&gt; List String</code> on the second case - no <code>forall</code> needed. Under this point of view, looks like polymorphic list functions aren't a problem on the STLC - you just can't annotate their types.</p>\n"}, {"tags": ["haskell", "design-patterns", "functional-programming", "where-clause"], "comments": [{"owner": {"reputation": 23808, "user_id": 2382734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d80069e46785505b443aa9d1dd9eb3a3?s=128&d=identicon&r=PG", "display_name": "Renzo", "link": "https://stackoverflow.com/users/2382734/renzo"}, "edited": false, "score": 7, "creation_date": 1452195528, "post_id": 34663638, "comment_id": 57072870, "body": "Your question is more appropriate for <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1452205818, "post_id": 34663638, "comment_id": 57078506, "body": "I wouldn&#39;t say your code looks particularly hard to read... I think <i>I&#39;d</i> find it harder to read if you wrote this in any OO language!  Most of the reason <i>you</i> find it hard to read is certainly that you&#39;re not so firm with Haskell yet. As chi pointed out, you also did write some things in less than optimal ways, but they don&#39;t affect readability that much. \u2014 <i>However</i> it should also be emphasized that your program is very untypical for Haskell code: very little interesting logic in a whole lot of imperative interaction code. \u201cReal\u201d Haskell projects generally have it the other way around."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 3, "creation_date": 1452207436, "post_id": 34663638, "comment_id": 57079227, "body": "Small passing suggestion:  I would probably factorize <code>data Square = Empty Label | Full Player</code> instead of the large mixed enumeration you have."}], "answers": [{"comments": [{"owner": {"reputation": 2077, "user_id": 2801237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fSSw3.png?s=128&g=1", "display_name": "mawalker", "link": "https://stackoverflow.com/users/2801237/mawalker"}, "edited": false, "score": 3, "creation_date": 1452203144, "post_id": 34664061, "comment_id": 57077224, "body": "I don&#39;t know Haskell, but you make it look almost readable... (Actually not joking, your suggestions are very good and help readability quite nicely from someone who doesn&#39;t know Haskell right now) But... What about comments? His program has 0 lines of comments and I&#39;m curious as to what your suggestions would be concerning that in Haskell."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 14, "last_activity_date": 1452209767, "last_edit_date": 1452209767, "creation_date": 1452196714, "answer_id": 34664061, "question_id": 34663638, "link": "https://stackoverflow.com/questions/34663638/best-practices-for-where-clauses/34664061#34664061", "title": "Best Practices for Where clauses", "body": "<p>Code style is often a matter of personal preference, in Haskell arguably more than in other languages with a \"standard\" style guide. Still, here's a few random suggestions.</p>\n\n<hr>\n\n<p>Don't over-indent <code>case</code>s: just use another line</p>\n\n<pre><code>case gameMode of \"1\" -&gt; onePlayerMode\n                 \"2\" -&gt; twoPlayerMode\n                 gameMode -&gt; gameSelect\n</code></pre>\n\n<p>vs</p>\n\n<pre><code>case gameMode of\n   \"1\" -&gt; onePlayerMode\n   \"2\" -&gt; twoPlayerMode\n   gameMode -&gt; gameSelect\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>case gameMode of\n   \"1\" -&gt; onePlayerMode\n   \"2\" -&gt; twoPlayerMode\n   _   -&gt; gameSelect\n</code></pre>\n\n<hr>\n\n<p><code>case</code> is usually preferred to <code>if .. == Constructor</code>:</p>\n\n<pre><code>if player == PX \nthen enterMove 1 board player \nelse enterBestMove board PO\n</code></pre>\n\n<p>vs</p>\n\n<pre><code>case player of\n   PX -&gt; enterMove 1 board player \n   PY -&gt; enterBestMove board PO\n</code></pre>\n\n<hr>\n\n<p>I'd strongly recommend against using partial functions like <code>fromJust</code>, since they can crash your program if you forget to check for <code>Nothing</code> beforehand. Safer alternatives exist, which never cause such crashes -- less burden on the programmer.</p>\n\n<pre><code>if detectWin b == Nothing \nthen snd (findBestMove (if player == PX then PO else PX) b) \nelse fromJust $ detectWin b\n</code></pre>\n\n<p>vs</p>\n\n<pre><code>case detectWin b of\n   Nothing -&gt; snd $ findBestMove (if player == PX then PO else PX) b\n   Just x  -&gt; x\n</code></pre>\n\n<p>or</p>\n\n<pre><code>fromMaybe (snd $ findBestMove (if player == PX then PO else PX) b)\n  $ detectWin b\n</code></pre>\n\n<hr>\n\n<p>Try to factorize commonly used functions. For instance</p>\n\n<pre><code>nextPlayer PX = PO\nnextPlayer PO = PX\n</code></pre>\n\n<p>can replace uses of</p>\n\n<pre><code>if player == PX then PO else PX\n</code></pre>\n\n<hr>\n\n<p>No <code>do</code> is needed when there's only one statement:</p>\n\n<pre><code>if noOfPlayers == 1\nthen do putStrLn (\"Make your move. (A-I)\")    -- no need for parentheses here\nelse do putStrLn (show player ++ \", it's your turn. (A-I)\")\n</code></pre>\n\n<hr>\n\n<p>Since you mention <code>where</code> in the title, let me state that I have mixed feelings about <code>where</code>, in general. I know I often tend to avoid <code>where</code> in favor of <code>let</code>, but this feeling is not shared with many other Haskellers, so take this with some care.</p>\n\n<p>Personally, I tend to limit my <code>where</code> uses to one-liners:</p>\n\n<pre><code>foo = f x y\n   where x = ...\n         y = ...\n</code></pre>\n\n<p>Especially in <code>do</code> blocks, which might span several lines, I prefer <code>let</code>s:</p>\n\n<pre><code>foo = do\n   line\n   line using x     -- what is x ??!?\n   line\n   ...\n   line\n  where x = ...     -- ah, here it is\n</code></pre>\n\n<p>vs</p>\n\n<pre><code>foo = do\n   line\n   let x = ...\n   line using x\n   line\n   ...\n   line\n</code></pre>\n\n<p>However, feel free to adopt the style you find more readable.</p>\n\n<hr>\n\n<p>Also don't forget to add a few comments, as @mawalker points out. Some definitions are obvious and don't need any explanation. Others could benefit from a few lines explaining the purpose.</p>\n"}], "owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 34664061, "answer_count": 1, "score": 2, "last_activity_date": 1452291271, "creation_date": 1452195227, "last_edit_date": 1452291271, "question_id": 34663638, "link": "https://stackoverflow.com/questions/34663638/best-practices-for-where-clauses", "title": "Best Practices for Where clauses", "body": "<p>I wrote a simple tic-tac-toe program in Haskell.  It runs on the command line, has a one and two player mode, and implements a minimax algorithm when you play against it.</p>\n\n<p>I'm used to writing proper code in OO languages, but Haskell is new to me.  This code works reasonably well, but seems hard to read (even to me!).  Any suggestions on how to make this code more...Haskellian?</p>\n\n<pre><code>import Data.List\nimport Data.Char\nimport Data.Maybe\nimport Control.Monad\n\ndata Square = A | B | C | D | E | F | G | H | I | X | O deriving (Read, Eq, Ord)\ninstance Show Square where\n   show A = \"a\" \n   show B = \"b\" \n   show C = \"c\" \n   show D = \"d\" \n   show E = \"e\" \n   show F = \"f\" \n   show G = \"g\" \n   show H = \"h\" \n   show I = \"i\" \n   show X = \"X\" \n   show O = \"O\"\ntype Row = [Square]\ntype Board = [Row]\ndata Player = PX | PO deriving (Read, Eq)\ninstance Show Player where\n   show PX = \"Player X\"\n   show PO = \"Player O\"\ndata Result = XWin | Tie | OWin deriving (Read, Show, Eq, Ord) \n\nmain :: IO ()\nmain = do\n    putStrLn \"Let's play some tic tac toe!!!\"\n    putStrLn \"Yeeeaaaaaahh!!!\"\n    gameSelect\n\ngameSelect :: IO ()\ngameSelect = do\n    putStrLn \"Who gonna play, one playa or two??? (Enter 1 or 2)\"\n    gameMode &lt;- getLine\n    case gameMode of \"1\" -&gt; onePlayerMode\n                     \"2\" -&gt; twoPlayerMode\n                     gameMode -&gt; gameSelect\n    where onePlayerMode = do\n             putStrLn \"One playa\"\n             putStrLn \"Cool!  Get ready to play...AGAINST MY INVINCIBLE TIC TAC TOE AI!!!!! HAHAHAHA!!!\"\n             gameLoop 1 emptyBoard PX\n          twoPlayerMode = do\n             putStrLn \"Two players\"\n             gameLoop 2 emptyBoard PX\n          emptyBoard = [[A,B,C],[D,E,F],[G,H,I]]\n\ngameLoop :: Int -&gt; Board -&gt; Player -&gt; IO ()\ngameLoop noOfPlayers board player = do\n    case detectWin board of Just XWin -&gt; endgame board XWin\n                            Just OWin -&gt; endgame board OWin\n                            Just Tie -&gt; endgame board Tie\n                            Nothing -&gt; if noOfPlayers == 1\n                                       then if player == PX \n                                            then enterMove 1 board player \n                                            else enterBestMove board PO\n                                       else enterMove 2 board player\n\nenterMove :: Int -&gt; Board -&gt; Player -&gt; IO () \nenterMove noOfPlayers board player = do\n     displayBoard board\n     if noOfPlayers == 1\n     then do putStrLn (\"Make your move. (A-I)\")\n     else do putStrLn (show player ++ \", it's your turn. (A-I)\")\n     move &lt;- getLine\n     print move\n     if not $ move `elem` [\"a\",\"b\",\"c\",\"d\",\"e\",\"f\",\"g\",\"h\",\"i\"]\n         then do\n            putStrLn $ move ++ \" is not a move, doofus\"\n            gameLoop noOfPlayers board player\n         else if (read (map toUpper move) :: Square) `elem` [ sq | sq &lt;- concat board]\n            then do\n               gameLoop noOfPlayers (newBoard (read (map toUpper move) :: Square) player board) (if player == PX then PO else PX)\n            else do\n               putStrLn \"That square is already occupied\"\n               gameLoop noOfPlayers board player\n\nenterBestMove :: Board -&gt; Player -&gt; IO ()\nenterBestMove board player = gameLoop 1 (newBoard bestmove player board) PX\n    where bestmove = fst $ findBestMove PO board\n          findBestMove :: Player -&gt; Board -&gt; (Square, Result)\n          findBestMove player board\n            | player == PO = findMax results\n            | player == PX = findMin results\n            where findMin = foldl1 (\\ acc x -&gt; if snd x &lt; snd acc then x else acc)\n                  findMax = foldl1 (\\ acc x -&gt; if snd x &gt; snd acc then x else acc)\n                  results = [ (sq, getResult b) | (sq, b) &lt;- boards player board ]\n                  getResult b = if detectWin b == Nothing \n                                then snd (findBestMove (if player == PX then PO else PX) b) \n                                else fromJust $ detectWin b\n                  boards :: Player -&gt; Board -&gt; [(Square, Board)]\n                  boards player board = [(sq, newBoard sq player board) | sq &lt;- concat board, sq /= X, sq /=O]\n\ndisplayBoard :: Board -&gt; IO ()\ndisplayBoard board = do\n    mapM_ print board\n\nnewBoard :: Square -&gt; Player -&gt; Board -&gt; Board\nnewBoard move player board = [ [if sq == move then mark else sq | sq &lt;- row] | row &lt;- board]\n    where mark = if player == PX then X else O\n\ndetectWin :: Board -&gt; (Maybe Result)\ndetectWin board\n   | [X,X,X] `elem` board ++ transpose board = Just XWin\n   | [X,X,X] `elem` [diagonal1 board, diagonal2 board] = Just XWin\n   | [O,O,O] `elem` board ++ transpose board = Just OWin\n   | [O,O,O] `elem` [diagonal1 board, diagonal2 board] = Just OWin\n   | [X,X,X,X,X,O,O,O,O] == (sort $ concat board) = Just Tie\n   | otherwise = Nothing\n   where\n     diagonal1 :: Board -&gt; [Square]\n     diagonal1 bs = bs!!0!!0 : bs!!1!!1 : bs!!2!!2 : []\n     diagonal2 :: Board -&gt; [Square]\n     diagonal2 bs = bs!!0!!2 : bs!!1!!1 : bs!!2!!0 : []\n\nendgame :: Board -&gt; Result -&gt; IO ()\nendgame board result = do\n    displayBoard board\n    if result `elem` [XWin, OWin]\n        then \n            let player = if result == XWin then PX else PO\n            in do \n                putStrLn (\"The game is over, and \" ++ show player ++ \" wins!\")\n                putStrLn ((if player == PX then show PO else show PX) ++ \" is a loser lol\")\n        else do\n            putStrLn \"The game is a tie\"\n            putStrLn \"You are both losers!  Ugh!\"\n    putStrLn \"Want to play again? (y/n)\"\n    again &lt;- getLine\n    if again `elem` [\"y\", \"Y\", \"yes\", \"Yes\", \"YES\"] \n        then gameSelect \n        else do\n            putStrLn \"Goodbye\"\n</code></pre>\n\n<hr>\n\n<p>EDIT: with special thanks to @Chi and @Caridorc, I've made the following changes.  Further suggestions will be considered and updated as well</p>\n\n<pre><code>import Data.List\nimport Data.Char\nimport Data.Maybe\nimport Control.Monad\n\ndata Square = A | B | C | D | E | F | G | H | I | X | O deriving (Read, Eq, Ord)\ninstance Show Square where\n   show A = \"a\" \n   show B = \"b\" \n   show C = \"c\" \n   show D = \"d\" \n   show E = \"e\" \n   show F = \"f\" \n   show G = \"g\" \n   show H = \"h\" \n   show I = \"i\" \n   show X = \"X\" \n   show O = \"O\"\ntype Row = [Square]\ntype Board = [Row]\ndata Player = PX | PO deriving (Read, Eq)\ninstance Show Player where\n   show PX = \"Player X\"\n   show PO = \"Player O\"\ndata Result = XWin | Tie | OWin deriving (Read, Show, Eq, Ord) \n\nmain :: IO ()\nmain = do\n    putStrLn \"Let's play some tic tac toe!!!\"\n    putStrLn \"Yeeeaaaaaahh!!!\"\n    gameSelect\n\ngameSelect :: IO ()\ngameSelect = do\n    putStrLn \"Who gonna play, one playa or two??? (Enter 1 or 2)\"\n    gameMode &lt;- getLine\n    case gameMode of \n      \"1\" -&gt; onePlayerMode\n      \"2\" -&gt; twoPlayerMode\n      _ -&gt; gameSelect\n    where onePlayerMode = do\n             putStrLn \"One playa\"\n             putStrLn \"Cool!  Get ready to play...AGAINST MY INVINCIBLE TIC TAC TOE AI!!!!! HAHAHAHA!!!\"\n             gameLoop 1 emptyBoard PX\n          twoPlayerMode = do\n             putStrLn \"Two players\"\n             gameLoop 2 emptyBoard PX\n          emptyBoard = [[A,B,C],[D,E,F],[G,H,I]]\n\ndisplayBoard :: Board -&gt; IO ()\ndisplayBoard board = do\n    mapM_ print board\n\notherPlayer :: Player -&gt; Player\notherPlayer PX = PO\notherPlayer PO = PX\n\ngameLoop :: Int -&gt; Board -&gt; Player -&gt; IO ()\ngameLoop noOfPlayers board player = do\n    case detectWin board of \n      Just res -&gt; endgame board res\n      Nothing -&gt; case noOfPlayers of\n                   1 -&gt; case player of\n                          PX -&gt; enterMove 1 board player\n                          PO -&gt; enterBestMove board PO \n                   2 -&gt; enterMove 2 board player\n\nenterMove :: Int -&gt; Board -&gt; Player -&gt; IO () \nenterMove noOfPlayers board player = do\n     displayBoard board\n     case noOfPlayers of\n       1 -&gt; do putStrLn (\"Make your move. (A-I)\")\n       2 -&gt; do putStrLn (show player ++ \", it's your turn. (A-I)\")\n     move &lt;- getLine\n     print move\n     if not $ move `elem` [\"a\",\"b\",\"c\",\"d\",\"e\",\"f\",\"g\",\"h\",\"i\"] then do\n        putStrLn $ move ++ \" is not a move, doofus\"\n        gameLoop noOfPlayers board player\n     else if (read (map toUpper move) :: Square) `elem` (concat board) then do\n            gameLoop noOfPlayers (newBoard (read (map toUpper move) :: Square) player board) (otherPlayer player)\n          else do\n            putStrLn \"That square is already occupied\"\n            gameLoop noOfPlayers board player\n\nenterBestMove :: Board -&gt; Player -&gt; IO ()\nenterBestMove board player = gameLoop 1 (newBoard bestmove player board) PX\n    where bestmove = fst $ findBestMove PO board\n\nfindBestMove :: Player -&gt; Board -&gt; (Square, Result)  -- minimax algorithm\nfindBestMove player board\n  | player == PO = findMax results\n  | player == PX = findMin results\n  where findMin = foldl1 (\\ acc x -&gt; if snd x &lt; snd acc then x else acc)     \n        findMax = foldl1 (\\ acc x -&gt; if snd x &gt; snd acc then x else acc)\n        results = [ (sq, getResult b) | (sq, b) &lt;- boards player board ]\n        getResult b = case detectWin b of\n                        Nothing -&gt; snd (findBestMove (otherPlayer player) b)\n                        Just x -&gt; x\n        boards :: Player -&gt; Board -&gt; [(Square, Board)]\n        boards player board = [(sq, newBoard sq player board) | sq &lt;- concat board, sq /= X, sq /=O]\n\nnewBoard :: Square -&gt; Player -&gt; Board -&gt; Board\nnewBoard move player board = [ [if sq == move then mark else sq | sq &lt;- row] | row &lt;- board]\n    where mark = if player == PX then X else O\n\ndetectWin :: Board -&gt; (Maybe Result)\ndetectWin board\n   | [X,X,X] `elem` (triplets board) = Just XWin\n   | [O,O,O] `elem` (triplets board) = Just OWin\n   | [X,X,X,X,X,O,O,O,O] == (sort $ concat board) = Just Tie\n   | otherwise = Nothing\n\ntriplets :: Board -&gt; [[Square]]\ntriplets board = board ++ transpose board ++ [diagonal1] ++ [diagonal2]\n   where\n     flat = concat board\n     diagonal1 = [flat !! 0, flat !! 4, flat !! 8]\n     diagonal2 = [flat !! 2, flat !! 4, flat !! 6]\n\nendgame :: Board -&gt; Result -&gt; IO ()\nendgame board result = do\n    displayBoard board\n\n    putStrLn $ endGameMessage result\n\n    putStrLn \"Want to play again? (y/n)\"\n    again &lt;- getLine\n    if again `elem` [\"y\", \"Y\", \"yes\", \"Yes\", \"YES\"] \n    then gameSelect \n    else do\n        putStrLn \"Goodbye\"\n\nendGameMessage :: Result -&gt; String\nendGameMessage result\n   | result `elem` [XWin, OWin] = winnerNotice ++ loserNotice\n   | otherwise = \"The game is a tie\\n\" ++ \"You are both losers!  Ugh!\"\n   where\n     winner = case result of\n      XWin -&gt; PX\n      OWin -&gt; PO\n     winnerNotice = \"The game is over, and \" ++ show winner ++ \" wins!\\n\"\n     loserNotice = (show $ otherPlayer winner) ++ \" is a loser lol\"\n</code></pre>\n"}, {"tags": ["haskell", "monads", "do-notation"], "comments": [{"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 6, "creation_date": 1452186743, "post_id": 34661123, "comment_id": 57067690, "body": "Also, the right term is \u201clists\u201d, as \u201carrays\u201d are usually understood to be arranged consecutively in memory."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1452189575, "post_id": 34661123, "comment_id": 57069455, "body": "<code>do x &lt;- [&quot;baby, &quot;, &quot;darling, &quot;, &quot;ragtime gal&quot;]; &quot;hello my &quot; ++ x</code>"}], "answers": [{"comments": [{"owner": {"reputation": 542, "user_id": 636578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3a58bb2e3ef9f65ae8e1e1921652fac?s=128&d=identicon&r=PG", "display_name": "Andreas", "link": "https://stackoverflow.com/users/636578/andreas"}, "edited": false, "score": 0, "creation_date": 1452187220, "post_id": 34661204, "comment_id": 57068014, "body": "Wow, Thanks! Now that I knew what I was looking for it seems this is (more or less) how the bind <code>&gt;&gt;=</code> operator is defined for arrays (see <a href=\"https://en.wikipedia.org/wiki/Monad_%28functional_programming%29#Syntactic_sugar:_do-notation\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/&hellip;</a> ) The important part being <code>m &gt;&gt;= f  = concat (map f m)</code>"}, {"owner": {"reputation": 2561, "user_id": 674108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ab092f16c59df8ba1ba1e113e1d322?s=128&d=identicon&r=PG", "display_name": "Jeff Burka", "link": "https://stackoverflow.com/users/674108/jeff-burka"}, "edited": false, "score": 2, "creation_date": 1452187365, "post_id": 34661204, "comment_id": 57068117, "body": "I think the key point here is that <code>list &gt;&gt;= f</code> is defined as <code>concatMap f list</code>. The intuition is that a list represents a nondeterministic computation, so <code>[1,2,3]</code> is a computation with three possible outputs. When you bind that with a function, the result is that function applied to all possible outputs."}], "tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": true, "score": 18, "last_activity_date": 1452186715, "creation_date": 1452186715, "answer_id": 34661204, "question_id": 34661123, "link": "https://stackoverflow.com/questions/34661123/haskell-do-1-2-3-hello-behavior-clarification/34661204#34661204", "title": "Haskell: &#39;do [1,2,3]; [&quot;hello&quot;]&#39; behavior clarification", "body": "<pre><code>do [1, 2, 3]; \"hello\"\n</code></pre>\n\n<p>desugars to</p>\n\n<pre><code>[1, 2, 3] &gt;&gt; \"hello\"\n</code></pre>\n\n<p>which is the same as </p>\n\n<pre><code>[1, 2, 3] &gt;&gt;= (\\_ -&gt; \"hello\")\n</code></pre>\n\n<p>which is the same as</p>\n\n<pre><code>concatMap (\\_ -&gt; \"hello\") [1, 2, 3]\n</code></pre>\n\n<p>which is the same as</p>\n\n<pre><code>concat (map (\\_ -&gt; \"hello\") [1, 2, 3])\n</code></pre>\n\n<p>which is the same as</p>\n\n<pre><code>concat [(\\_ -&gt; \"hello\") 1, (\\_ -&gt; \"hello\") 2, (\\_ -&gt; \"hello\") 3])\n</code></pre>\n\n<p>which is the same as</p>\n\n<pre><code>concat [\"hello\",\"hello\",\"hello\"]\n</code></pre>\n\n<p>which is the same as</p>\n\n<pre><code>\"hellohellohello\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 3, "last_activity_date": 1452214685, "last_edit_date": 1452214685, "creation_date": 1452208671, "answer_id": 34666944, "question_id": 34661123, "link": "https://stackoverflow.com/questions/34661123/haskell-do-1-2-3-hello-behavior-clarification/34666944#34666944", "title": "Haskell: &#39;do [1,2,3]; [&quot;hello&quot;]&#39; behavior clarification", "body": "<p>To complement Joachim Breitner's answer, here's a look at this from another angle: </p>\n\n<pre><code>do [1, 2, 3]\n   \"hello\"\n</code></pre>\n\n<p>is</p>\n\n<pre><code>do a &lt;- [1, 2, 3]\n   b &lt;- \"hello\"\n   return b\n</code></pre>\n\n<p>is</p>\n\n<pre><code>do a &lt;- [1, 2, 3]\n   do b &lt;- \"hello\"\n      do return b\n</code></pre>\n\n<p>is</p>\n\n<pre><code>[b | a &lt;- [1,2,3], b &lt;- \"hello\"]\n</code></pre>\n\n<p>is the same as the pseudocode</p>\n\n<pre><code>for a in (a list of Nums) [1, 2, 3]:\n   -- here we have `a` (a Num)\n   for b in (a list of Chars) \"hello\":\n      -- here we have that same `a` (a Num), \n      -- and `b` (which is a Char)\n      emit b       -- whatever \"emit\" means\n</code></pre>\n\n<p>Of course, list comprehensions for <em>lists</em> (not \"arrays\") of <em>stuff</em> (whatever that stuff is, say Nums, Chars, etc.) desugar into the same <code>concatMap</code>&dash;using code; but it is sometimes easier to handle them mentally, either as is, or as a specification for some nested <em>loops</em>. </p>\n\n<p>In fact it seems that <code>do</code>-notation could as easily have been a <code>for</code>-notation in the first place.</p>\n"}], "owner": {"reputation": 542, "user_id": 636578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3a58bb2e3ef9f65ae8e1e1921652fac?s=128&d=identicon&r=PG", "display_name": "Andreas", "link": "https://stackoverflow.com/users/636578/andreas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 34661204, "answer_count": 2, "score": 3, "last_activity_date": 1452214685, "creation_date": 1452186464, "last_edit_date": 1452209959, "question_id": 34661123, "link": "https://stackoverflow.com/questions/34661123/haskell-do-1-2-3-hello-behavior-clarification", "title": "Haskell: &#39;do [1,2,3]; [&quot;hello&quot;]&#39; behavior clarification", "body": "<p>So I'm trying to understand exactly how the Haskell <code>do</code> notation works. \nI understand that it is used together with monads and that it basically expands (since it's actually syntactic sugar) into anonymous functions connected with either bind (<code>&gt;&gt;=</code>) or then (<code>&gt;&gt;</code>) as shown here <a href=\"https://en.wikibooks.org/wiki/Haskell/Syntactic_sugar#Do_notation\" rel=\"nofollow\">https://en.wikibooks.org/wiki/Haskell/Syntactic_sugar#Do_notation</a>.</p>\n\n<p>However <strong>my question is</strong> why the following command</p>\n\n<pre><code>Prelude&gt; do [1, 2, 3]; \"hello\"\n</code></pre>\n\n<p>returns</p>\n\n<pre><code>\"hellohellohello\"\n</code></pre>\n\n<p>I know that arrays are actually monads (and that strings are arrays of chars) but I fail to see how this results in the behavior above.</p>\n"}]