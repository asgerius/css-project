[{"tags": ["haskell"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1571869312, "post_id": 58531672, "comment_id": 103387145, "body": "Do you understand how <code>zip</code> could be used to create a shorter list than <code>list</code>? (Don\u2019t worry about what that list looks like for now.)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1571871568, "post_id": 58531672, "comment_id": 103387654, "body": "Hint: the list construction you want to perform could probably be done with <code>enumFromTo</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1571873760, "post_id": 58531672, "comment_id": 103388113, "body": "@chepner <code>replicate</code> seems like a simpler suggestion. What does <code>enumFromTo</code> help with?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1571878814, "post_id": 58531672, "comment_id": 103388948, "body": "@amalloy I&#39;m not sure I can answer that without giving too big a hint :) (But I mentioned it as it is intimately tied with the definition of one of the standard forms of a list literal.)"}, {"owner": {"reputation": 938, "user_id": 3894179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c6b1c2c08d1075995cb780ee8a2e36e?s=128&d=identicon&r=PG", "display_name": "Andra", "link": "https://stackoverflow.com/users/3894179/andra"}, "edited": false, "score": 0, "creation_date": 1571976259, "post_id": 58531672, "comment_id": 103424368, "body": "Why people are downvoting this posts?"}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 12265705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f3c63c490c841e2def32fbd91bb0965?s=128&d=identicon&r=PG&f=1", "display_name": "AidA", "link": "https://stackoverflow.com/users/12265705/aida"}, "is_accepted": false, "score": 2, "last_activity_date": 1571922587, "creation_date": 1571922587, "answer_id": 58542124, "question_id": 58531672, "link": "https://stackoverflow.com/questions/58531672/create-my-own-implementation-of-take-using-zip-unzip-fst-and-list-construction/58542124#58542124", "title": "Create my own implementation of take using zip, unzip, fst and list construction", "body": "<p>After some sleep and reading your pointers I've came to a solution.</p>\n\n<pre><code>main =\n    do\n    print (takeFirstNth \"test\" 3)\n\ntakeFirstNth list nth = fst (unzip (zip list [1..nth]))\n</code></pre>\n\n<p>Thanks for the nudges in the right direction :)</p>\n"}], "owner": {"reputation": 29, "user_id": 12265705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f3c63c490c841e2def32fbd91bb0965?s=128&d=identicon&r=PG&f=1", "display_name": "AidA", "link": "https://stackoverflow.com/users/12265705/aida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1571922587, "creation_date": 1571869205, "question_id": 58531672, "link": "https://stackoverflow.com/questions/58531672/create-my-own-implementation-of-take-using-zip-unzip-fst-and-list-construction", "title": "Create my own implementation of take using zip, unzip, fst and list construction", "body": "<p>I need to get the first n elements from a list in haskell but I cannot use the take function. In the example below I need to replace \"take\" using zip, unzip, fst and list construction. I'm really struggling with this, any pointers?</p>\n\n<pre><code>main = do\n    let result = takeFirstN \"test\" 2\n    putStrLn(result)\n\ntakeFirstN list nth = do\n    take nth list\n</code></pre>\n\n<p>Many thanks!</p>\n"}, {"tags": ["haskell", "functional-programming", "typeclass", "functor", "parameterized-types"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1571859102, "post_id": 58528701, "comment_id": 103383530, "body": "If you are willing to change your definition slightly, to <code>String -&gt; m (String, a)</code>, I believe you can derive it automatically using the <code>DeriveFunctor</code> instance. (This is because <code>(,) String</code> itself is a functor whose <code>fmap</code> would apply the function to your value of type <code>a</code>, and functors in general (and <code>(-&gt;) String</code>, <code>Functor m =&gt; m</code>, and <code>(,) String</code> in particular) compose."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 9, "last_activity_date": 1571854340, "creation_date": 1571854340, "answer_id": 58528769, "question_id": 58528701, "link": "https://stackoverflow.com/questions/58528701/how-can-i-instance-functor-for-a-type-with-two-parameters/58528769#58528769", "title": "How can I instance `Functor` for a type with two parameters?", "body": "<p>You can here construct a constraint that <code>m</code> should be a type that is an instance of <code>Functor</code> as well, and then <code>fmap</code> on that result:</p>\n\n<pre><code>instance <b>Functor m</b> =&gt; Functor (Parser m) where\n    fmap f (Parser p) = Parser (\\x -&gt; <b>fmap g</b> (p x))\n        where <b>g</b> (r, s) = (f r, s)</code></pre>\n\n<p>Here <code>g</code> is thus a function that performs the mapping <code>f</code> on the first element of the tuple. We thus use that <code>g</code> as a \"mapping\" function over the result.</p>\n\n<p>This will thus work for any <code>m</code> that is an instance of <code>Functor</code>, like a <code>Maybe</code>, a <code>[]</code>, a <code>Tree</code>, etc.</p>\n"}], "owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 1, "accepted_answer_id": 58528769, "answer_count": 1, "score": 4, "last_activity_date": 1571854340, "creation_date": 1571854078, "question_id": 58528701, "link": "https://stackoverflow.com/questions/58528701/how-can-i-instance-functor-for-a-type-with-two-parameters", "title": "How can I instance `Functor` for a type with two parameters?", "body": "<p><strong>Background.</strong> In one of my classes we've been exploring the <code>Parser</code> monad. The <code>Parser</code> monad is typically defined as either</p>\n\n<pre><code>newtype Parser a = Parser (String -&gt; [(a, String)])\n</code></pre>\n\n<p>Or as</p>\n\n<pre><code>newtype Parser a = Parser (String -&gt; Maybe (a, String))\n</code></pre>\n\n<p>In either case, we can instance <code>Parser</code> as a <code>Functor</code> using code that works in both cases:</p>\n\n<pre><code>instance Functor Parser where\n  fmap f (Parser p) = Parser (fmap applyF . p)\n    where applyF (result, s) = (f result, s)\n</code></pre>\n\n<p>If we have a <code>Parser</code> built to return <code>Maybe (a, String)</code>, this applies <code>f</code> to the <code>result</code> if the <code>result</code> exists. And if we have a <code>Parser</code> built to return <code>[(a, String)]</code>, this applies <code>f</code> to each of the <code>result</code>s returned in the list. </p>\n\n<p>We can instance <code>Applicative</code>, <code>Monad</code>, <code>MonadPlus</code>, and <code>Alternative</code> is similarly generic ways (so that they work either for <code>Maybe</code> or <code>[]</code>). </p>\n\n<p><strong>Question.</strong> If I parameterize <code>Parser</code> based on the type used to wrap the result, how can I instance it for <code>Functor</code> and friends?</p>\n\n<pre><code>newtype Parser m a = Parser (String -&gt; m (a, String))\n\n-- How do I instance `Parser` as a Functor if `m` is a Functor?\n</code></pre>\n"}, {"tags": ["function", "haskell", "types", "parameters"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1571847416, "post_id": 58527107, "comment_id": 103378587, "body": "It would help to provide the definition of <code>EDict</code> and <code>Expr</code>. The type of <code>evalOp</code> is probably too general; either <code>evalOp :: Num a =&gt; EDict -&gt; (a -&gt; a -&gt; a) -&gt; Expr -&gt; Expr -&gt; Maybe Double</code> or even <code>evalOp :: EDict -&gt; (Double -&gt; Double -&gt; Double) -&gt; Expr -&gt; Expr -&gt; Maybe Double</code> would probably suffice. You don&#39;t need a polymorphic callback, because <code>Expr</code> doesn&#39;t appear to be polymorphic."}, {"owner": {"reputation": 115, "user_id": 7298643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2D13T.png?s=128&g=1", "display_name": "jengels", "link": "https://stackoverflow.com/users/7298643/jengels"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1571847634, "post_id": 58527107, "comment_id": 103378683, "body": "Updated the post with the definitions for EDict and Expr. Also, these functions need to work for both Integers and Doubles so I can&#39;t cast it as just one of them."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1571848050, "post_id": 58527107, "comment_id": 103378886, "body": "They won&#39;t at the moment, because <code>Expr</code> itself can&#39;t hold an integer value."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1571855694, "post_id": 58527107, "comment_id": 103382159, "body": "Small code review: <code>evalOp</code> would be better implemented using <code>liftA2 op (eval d x) (eval d y)</code>"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1571856457, "post_id": 58527107, "comment_id": 103382478, "body": "@4castle Sure, but that&#39;s probably a bit advanced for someone new to the language."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 7298643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2D13T.png?s=128&g=1", "display_name": "jengels", "link": "https://stackoverflow.com/users/7298643/jengels"}, "edited": false, "score": 0, "creation_date": 1571848029, "post_id": 58527261, "comment_id": 103378871, "body": "Trying that gave me the following error: <code>Couldn&#39;t match expected type \u2018Double\u2019 with actual type \u2018a\u2019       \u2018a\u2019 is a rigid type variable bound by           the type signature for             evalOp :: Num a =&gt;                       EDict -&gt; (a -&gt; a -&gt; a) -&gt; Expr -&gt; Expr -&gt; Maybe Double           at src&#47;Ex02.hs:51:10</code>"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1571848048, "post_id": 58527261, "comment_id": 103378884, "body": "@Code-Apprentice Are you sure? I don&#39;t see how an <code>a -&gt; a -&gt; a</code> delivers a <code>Double</code>."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1571848183, "post_id": 58527261, "comment_id": 103378942, "body": "@pigworker I&#39;m sure that this change will solve the error which the OP asks about. There very well may be other problems in the code that will cause other errors after this change."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "reply_to_user": {"reputation": 115, "user_id": 7298643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2D13T.png?s=128&g=1", "display_name": "jengels", "link": "https://stackoverflow.com/users/7298643/jengels"}, "edited": false, "score": 0, "creation_date": 1571848276, "post_id": 58527261, "comment_id": 103378979, "body": "@JackEngels You should post a new question. The quick solution is to not use a polymorphic type here at all. Just do <code>(Double -&gt; Double -&gt; Double)</code> instead of <code>(a -&gt; a -&gt; a)</code>. The more &quot;correct&quot; solution is to make <b>all</b> of your types polymorphic, including <code>Expr</code>."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1571852674, "post_id": 58527261, "comment_id": 103380873, "body": "This answer is not much better than a compiler&#39;s. The nice thing about people is that they can understand the context of the problem."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1571853239, "post_id": 58527261, "comment_id": 103381127, "body": "@luqui This answer directly addresses the compiler error and shows how to fix it."}], "tags": [], "owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "is_accepted": false, "score": -2, "last_activity_date": 1571847897, "creation_date": 1571847897, "answer_id": 58527261, "question_id": 58527107, "link": "https://stackoverflow.com/questions/58527107/abstracting-function-in-haskell/58527261#58527261", "title": "Abstracting Function in Haskell", "body": "<p>The error is telling you that you cannot nest a type qualifier inside one of the types in your function chain. Instead, put all of the qualifiers at the beginning of the type signature:</p>\n\n<pre><code>evalOp:: (Num a) =&gt; EDict -&gt; (a -&gt; a -&gt; a) -&gt; Expr -&gt; Expr -&gt; Maybe Double\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/questions/27895196/haskell-illegal-polymorphic-type\">Haskell - Illegal Polymorphic type?</a> for a more thorough discussion.</p>\n"}, {"comments": [{"owner": {"reputation": 115, "user_id": 7298643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2D13T.png?s=128&g=1", "display_name": "jengels", "link": "https://stackoverflow.com/users/7298643/jengels"}, "edited": false, "score": 0, "creation_date": 1571848443, "post_id": 58527358, "comment_id": 103379077, "body": "Thanks, that seemed to fix it!"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 5, "last_activity_date": 1571848467, "last_edit_date": 1571848467, "creation_date": 1571848320, "answer_id": 58527358, "question_id": 58527107, "link": "https://stackoverflow.com/questions/58527107/abstracting-function-in-haskell/58527358#58527358", "title": "Abstracting Function in Haskell", "body": "<p>Right now, your <code>Expr</code> data type is constrained to <code>Double</code>-valued expressions, so there is no need to deal with polymorphism.</p>\n\n<pre><code>evalOp:: EDict -&gt; (Double -&gt; Double -&gt; Double) -&gt; Expr -&gt; Expr -&gt; Maybe Double\nevalOp d op x y =\n  let r = eval d x\n      s = eval d y\n  in case (r, s) of\n    (Just m, Just n) -&gt; Just (m `op` n)\n    _                -&gt; Nothing\n</code></pre>\n\n<p><code>(+) :: Num a =&gt; a -&gt; a -&gt; a</code> is a valid argument for <code>evalOp</code>, because its type can be \"restricted\" to <code>Double -&gt; Double -&gt; Double</code>.</p>\n\n<pre><code>&gt; let f :: Double -&gt; Double -&gt; Double; f = (+)\n&gt; f 3 5\n8.0\n</code></pre>\n\n<hr>\n\n<p>If your expression type were parameterized, <em>then</em> you would put a <code>Num a</code> constraint on your functions (not just on the arguments that involve <code>a</code>, because you want the same <code>a</code> throughout the function).</p>\n\n<pre><code>data Expr a\n  = Val a\n  | Add (Expr a) (Expr a)\n  | Mul (Expr a) (Expr a)\n  | Sub (Expr a) (Expr a)\n  | Dvd (Expr a) (Expr a)\n  | Var Id\n  | Def Id (Expr a) (Expr a)\n  deriving (Eq, Show)\n\ntype EDict a = Dict String a\n\nevalOp:: Num a =&gt; EDict a -&gt; (a -&gt; a -&gt; a) -&gt; Expr a -&gt; Expr a -&gt; Maybe a\nevalOp d op x y =\n  let r = eval d x\n      s = eval d y\n  in case (r, s) of\n    (Just m, Just n) -&gt; Just (m `op` n)\n    _                -&gt; Nothing\n\n\neval :: Num a =&gt; EDict a -&gt; Expr a -&gt; Maybe a\neval _ (Val x) = Just x\neval d (Var i) = find d i\neval d (Add x y) = evalOp d (+) x y\neval d (Mul x y) = evalOp d (*) x y\neval d (Sub x y) = evalOp d (-) x y\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 7298643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2D13T.png?s=128&g=1", "display_name": "jengels", "link": "https://stackoverflow.com/users/7298643/jengels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 58527358, "answer_count": 2, "score": 3, "last_activity_date": 1571848467, "creation_date": 1571847185, "last_edit_date": 1571847602, "question_id": 58527107, "link": "https://stackoverflow.com/questions/58527107/abstracting-function-in-haskell", "title": "Abstracting Function in Haskell", "body": "<p>I am currently taking a class in Haskell and am having a bit of trouble understanding how functions are passed as parameters. For this assignment, we were tasked with creating a program that would evaluate expressions. To reduce boiler plating, I wanted to abstract the function by creating a helper function that would take in an operator as an input and return the result </p>\n\n<p>Main Function:</p>\n\n<pre><code>eval :: EDict -&gt; Expr -&gt; Maybe Double\neval _ (Val x) = Just x\neval d (Var i) = find d i\neval d (Add x y) = evalOp d (+) x y\neval d (Mul x y) = evalOp d (*) x y\neval d (Sub x y) = evalOp d (-) x y\n</code></pre>\n\n<p>Helper Function:</p>\n\n<pre><code>evalOp:: EDict -&gt; ((Num a) =&gt; a -&gt; a -&gt; a) -&gt; Expr -&gt; Expr -&gt; Maybe Double\nevalOp d op x y =\n  let r = eval d x\n      s = eval d y\n  in case (r, s) of\n    (Just m, Just n) -&gt; Just (m `op` n)\n    _                -&gt; Nothing\n</code></pre>\n\n<p>Other definitions</p>\n\n<pre><code>data Expr\n  = Val Double\n  | Add Expr Expr\n  | Mul Expr Expr\n  | Sub Expr Expr\n  | Dvd Expr Expr\n  | Var Id\n  | Def Id Expr Expr\n  deriving (Eq, Show)\n\ntype Dict k d  =  [(k,d)]\n\ndefine :: Dict k d -&gt; k -&gt; d -&gt; Dict k d\ndefine d s v = (s,v):d\n\nfind :: Eq k =&gt; Dict k d -&gt; k -&gt; Maybe d\nfind []             _                 =  Nothing\nfind ( (s,v) : ds ) name | name == s  =  Just v\n                         | otherwise  =  find ds name\n\ntype EDict = Dict String Double\n</code></pre>\n\n<p>I looked into how +,-, and *  are to be passed into other functions and found that these operators are defined by the following definition:</p>\n\n<pre><code>ghci&gt; :t (*)\n(*) :: (Num a) =&gt; a -&gt; a -&gt; a  \n</code></pre>\n\n<p>However, when I run my code I get the following compilation error: </p>\n\n<pre><code>Illegal polymorphic or qualified type: Num a =&gt; a -&gt; a -&gt; a\n    Perhaps you intended to use RankNTypes or Rank2Types\n    In the type signature for \u2018evalOp\u2019:\n      evalOp :: EDict\n                -&gt; ((Num a) =&gt; a -&gt; a -&gt; a) -&gt; Expr -&gt; Expr -&gt; Maybe Double\n</code></pre>\n\n<p>I am not really sure why this is happening as I gave my function the proper parameters as defined by Haskell. Any help would be greatly appreciated as I am still very new to the language. </p>\n"}, {"tags": ["haskell", "random", "io", "haskell-lens", "gloss"], "answers": [{"comments": [{"owner": {"reputation": 710, "user_id": 6252787, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1cdf78c7695129916eb225138aecee61?s=128&d=identicon&r=PG&f=1", "display_name": "Thijs van der Heijden", "link": "https://stackoverflow.com/users/6252787/thijs-van-der-heijden"}, "edited": false, "score": 0, "creation_date": 1571846926, "post_id": 58527006, "comment_id": 103378338, "body": "Yes thats what I also thought, but doing that doesn\u2019t solve the original issue and creates a new one where it tells me that \u2018randomIntInRange\u2019 returns \u2018Board\u2019 instead of the expected type \u2018IO Board\u2019"}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 3, "last_activity_date": 1571847024, "last_edit_date": 1571847024, "creation_date": 1571846811, "answer_id": 58527006, "question_id": 58526654, "link": "https://stackoverflow.com/questions/58526654/couldnt-match-type-io-with/58527006#58527006", "title": "Couldn&#39;t match type \u2018IO\u2019 with \u2018[]\u2019", "body": "<p><code>randomRIO</code> has type <code>IO Int</code>, not <code>Int</code>. As long as you use any <code>IO</code> functions, your surrounding function must also be in <code>IO</code>:</p>\n\n<pre><code>randomIntInRange :: (Int, Int, Int, Int) -&gt; IO Board\nrandomIntInRange (min,max,min2,max2) = do r &lt;- randomRIO (min, max)\n                                          r2 &lt;- randomRIO (min2, max2)\n                                          pure $ randomCherryPosition (r, r2)\n</code></pre>\n\n<hr>\n\n<p><code>randomRIO</code> is not a pure function. It returns a different value every time. Haskell bans such functions. There are numerous benefits that come from banning such functions, which I'm going to go into here. But you can <em>still</em> have such function if you wrap it in <code>IO</code>. The type <code>IO Int</code> means \"<em>it's a program that, when executed, will produce an <code>Int</code></em>\". So when you call <code>randomRIO (min, max)</code>, it returns you not an <code>Int</code>, but a program, which you can then execute to get an <code>Int</code>. You do the execution via the <code>do</code> notation with left arrow, but the result of that would also be a similar program.</p>\n"}, {"tags": [], "owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "is_accepted": false, "score": 3, "last_activity_date": 1571873543, "last_edit_date": 1571873543, "creation_date": 1571873168, "answer_id": 58532178, "question_id": 58526654, "link": "https://stackoverflow.com/questions/58526654/couldnt-match-type-io-with/58532178#58532178", "title": "Couldn&#39;t match type \u2018IO\u2019 with \u2018[]\u2019", "body": "<p>Unfortunately there is no perfect solution to this problem. It has already been discussed on Stackoverflow, for example <a href=\"https://stackoverflow.com/questions/57836652/how-can-i-generate-different-random-values-in-haskell\">here</a>. </p>\n\n<p>The above solution provided by Fyodor involves IO. It works. The main drawback is that IO will propagate into your type system.</p>\n\n<p>However, it is not strictly necessary to involve IO just because you want to use random numbers. An in-depth discussion of the pros and cons involved is available <a href=\"https://en.wikibooks.org/wiki/Haskell/Understanding_monads/State\" rel=\"nofollow noreferrer\">there</a>.</p>\n\n<p>There is no perfect solution, because <em>something</em> has to take care of updating the <em>state</em> of the random number generator every time you pick a random value. In imperative languages such as C/C++/Fortran, we use <em>side effects</em> for this. But Haskell functions have no side effects. So that <em>something</em> can be:</p>\n\n<ol>\n<li>the Haskell IO subsystem (as in <code>randomRIO</code>)</li>\n<li>yourself as the programmer - see code sample #1 below</li>\n<li>a more specialized Haskell subsystem, for which you need to have: <code>import Control.Monad.Random</code> - see code sample #2 below</li>\n</ol>\n\n<p>You can solve the problem without involving IO by creating your own random number generator, using library function <code>mkStdGen</code>, and then passing the updated states of this generator manually around your computations. In your problem, this gives something like this:</p>\n\n<pre><code>-- code sample #1\n\nimport  System.Random\n\n-- just for type check:\ndata Board = Board [(Int, Int)]  deriving Show\n\ninitialBoard :: Board  \ninitialBoard = Board [(0, 0)]\n\nrandomCherryPosition :: (Int, Int) -&gt; Board\nrandomCherryPosition (x, y) =  -- just for type check\n    let ls0 = (\\(Board ls) -&gt; ls)  initialBoard\n        ls1 = (x, y) : ls0\n    in Board ls1\n\n-- initial version with IO:\nrandomIntInRange :: (Int, Int, Int, Int) -&gt; IO Board\nrandomIntInRange (min,max, min2,max2) = do  r1 &lt;- randomRIO (min, max)\n                                            r2 &lt;- randomRIO (min2, max2)\n                                            return $ randomCherryPosition (r1, r2)\n\n-- version with manual passing of state:\nrandomIntInRangeA :: RandomGen tg =&gt; (Int, Int, Int, Int) -&gt; tg -&gt; (Board, tg)\nrandomIntInRangeA  (min1,max1, min2,max2)  rng0  =\n    let (r1, rng1) = randomR (min1, max1) rng0\n        (r2, rng2) = randomR (min2, max2) rng1  -- pass the newer RNG\n        board      = randomCherryPosition (r1, r2)\n    in (board, rng2)\n\nmain = do\n    -- get a random number generator:\n    let mySeed  = 54321  -- actually better to pass seed from the command line.\n    let rng0    = mkStdGen mySeed  \n    let (board1, rng) = randomIntInRangeA (0,10, 0,100) rng0\n    putStrLn $ show board1\n</code></pre>\n\n<p>This is cumbersome but can be made to work.</p>\n\n<p>A more elegant alternative consists in using <a href=\"https://hackage.haskell.org/package/MonadRandom-0.1.3/docs/Control-Monad-Random.html\" rel=\"nofollow noreferrer\"><em>MonadRandom</em></a>.\nThe idea is to define a monadic action representing the randomness-involving computation, and then to <em>run</em> this action using the aptly named <code>runRand</code> function.\nThis gives this code instead:</p>\n\n<pre><code>-- code sample #2\n\nimport  System.Random\nimport  Control.Monad.Random\n\n-- just for type check:\ndata Board = Board [(Int, Int)]  deriving Show\n\ninitialBoard :: Board  \ninitialBoard = Board [(0, 0)]\n\n-- just for type check:\nrandomCherryPosition :: (Int, Int) -&gt; Board\nrandomCherryPosition (x, y) =  \n    let ls0 = (\\(Board ls) -&gt; ls)  initialBoard\n        ls1 = (x, y) : ls0\n    in Board ls1\n\n\n-- monadic version of randomIntInRange:\nrandomIntInRangeB :: RandomGen tg =&gt; (Int, Int, Int, Int) -&gt; Rand tg Board\nrandomIntInRangeB (min1,max1, min2,max2) =\n  do\n    r1 &lt;- getRandomR (min1,max1)\n    r2 &lt;- getRandomR (min2,max2)\n    return $ randomCherryPosition (r1, r2)\n\n\nmain = do\n    -- get a random number generator:\n    let mySeed  = 54321  -- actually better to pass seed from the command line.\n    let rng0    = mkStdGen mySeed  \n\n    -- create and run the monadic action:\n    let action = randomIntInRangeB (0,10, 0,100)  -- of type:  Rand tg Board\n    let (board1, rng) = runRand action rng0\n    putStrLn $ show board1\n</code></pre>\n\n<p>This is definitely less error prone than code sample #1, so you would  typically prefer this solution as soon as your computations become complex enough. All the functions involved are ordinary <em>pure</em> Haskell functions, which the compiler can fully optimize using its usual techniques. </p>\n"}], "owner": {"reputation": 710, "user_id": 6252787, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1cdf78c7695129916eb225138aecee61?s=128&d=identicon&r=PG&f=1", "display_name": "Thijs van der Heijden", "link": "https://stackoverflow.com/users/6252787/thijs-van-der-heijden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 58527006, "answer_count": 2, "score": 0, "last_activity_date": 1571879593, "creation_date": 1571845653, "last_edit_date": 1571879593, "question_id": 58526654, "link": "https://stackoverflow.com/questions/58526654/couldnt-match-type-io-with", "title": "Couldn&#39;t match type \u2018IO\u2019 with \u2018[]\u2019", "body": "<p>I wrote a function to generate two random numbers, which I then pass to a different function to use them there. The code for this is:</p>\n\n<pre><code>randomIntInRange :: (Int, Int, Int, Int) -&gt; Board\nrandomIntInRange (min,max,min2,max2) = do r &lt;- randomRIO (min, max)\n                                          r2 &lt;- randomRIO (min2, max2)\n                                          randomCherryPosition (r, r2)\n</code></pre>\n\n<p>And the function this function calls in its 'do' block is:</p>\n\n<pre><code>randomCherryPosition :: (Int, Int) -&gt; Board\nrandomCherryPosition (x, y) = initialBoard &amp; element y . element x .~ C\n</code></pre>\n\n<p>Where <code>initialBoard</code> is a list of lists and C is a predefined data type. I am using <code>lens</code> to change values inside the list. Running this gives me the error:</p>\n\n<pre><code>Couldn't match type \u2018IO\u2019 with \u2018[]\u2019\n      Expected type: [Int]\n        Actual type: IO Int\n</code></pre>\n\n<p>for both r and r2 lines. I have absolutely no idea what is going on here, or what i'm doing wrong, so I would greatly appreciate any help.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1571834900, "post_id": 58523226, "comment_id": 103371452, "body": "Hint: take a look at <code>inits</code> and <code>tails</code>."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 5, "creation_date": 1571839115, "post_id": 58523226, "comment_id": 103374009, "body": "I cannot understand the question. I get what <code>replacements</code> does, but I have no idea what <code>max3</code> has to do with it."}, {"owner": {"reputation": 189, "user_id": 12118780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1672f667ef2e09d09ff3f4d20079fce?s=128&d=identicon&r=PG&f=1", "display_name": "Beszteri", "link": "https://stackoverflow.com/users/12118780/beszteri"}, "edited": false, "score": 1, "creation_date": 1571839958, "post_id": 58523226, "comment_id": 103374554, "body": "Its just an example, i would like to use case selection (guard)."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1571840617, "post_id": 58523226, "comment_id": 103374968, "body": "Oh I see, so you want to write a function that looks like <code>max3</code> and works like <code>replacements</code>?"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 1, "creation_date": 1571840797, "post_id": 58523226, "comment_id": 103375083, "body": "No, he wants a function that looks like <code>minimum</code> but works like <code>foldr</code>"}], "answers": [{"tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": true, "score": 2, "last_activity_date": 1571841587, "last_edit_date": 1571841587, "creation_date": 1571841258, "answer_id": 58525250, "question_id": 58523226, "link": "https://stackoverflow.com/questions/58523226/replacements-define/58525250#58525250", "title": "Replacements define", "body": "<p>Here is one way to write <code>replacements</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>replacements :: a -&gt; [a] -&gt; [[a]]\nreplacements _ [] = []\nreplacements x (y:ys) = (x:ys) : map (y:) (replacements x ys)\n</code></pre>\n\n<p>To understand the recursion, this could be written more verbosely like:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>replacements :: a -&gt; [a] -&gt; [[a]]\nreplacements _ [] = []\nreplacements x (y:ys) =\n  let first = x:ys\n      recur = replacements x ys\n      rest = map (\\x_with_ys -&gt; y:x_with_ys) recur\n  in first : rest\n</code></pre>\n\n<p>Evaluating the former of these by hand for <code>replacements 'x' \"abc\"</code>:</p>\n\n<pre><code>   replacements 'x' \"abc\"\n~&gt; ('x':\"bc\") : map ('a':) (replacements 'x' \"bc\")\n~&gt; \"xbc\" : map ('a':) (('x':\"c\") : map ('b':) (replacements 'x' \"c\"))\n~&gt; \"xbc\" : map ('a':) (\"xc\" : map ('b':) (('x':[]) : map ('c':) (replacements 'x' \"\")))\n~&gt; \"xbc\" : map ('a':) (\"xc\" : map ('b':) (\"x\" : map ('c':) []))\n~&gt; \"xbc\" : map ('a':) (\"xc\" : map ('b':) (\"x\" : []))\n~&gt; \"xbc\" : map ('a':) (\"xc\" : map ('b':) [\"x\"])\n~&gt; \"xbc\" : map ('a':) (\"xc\" : [\"bx\"])\n~&gt; \"xbc\" : map ('a':) [\"xc\", \"bx\"]\n~&gt; \"xbc\" : [\"axc\", \"abx\"]\n~&gt; [\"xbc\", \"axc\", \"abx\"]\n</code></pre>\n\n<p>As Will Ness hinted at, you may want to express this with higher-order functions rather than explicit recursion. To elaborate on Will's hint, try and play around with <code>inits</code> and <code>tails</code>:</p>\n\n<pre><code>\u03bb&gt; import Data.List\n\u03bb&gt; inits \"abc\"\n[\"\",\"a\",\"ab\",\"abc\"]\n\u03bb&gt; tails \"abc\"\n[\"abc\",\"bc\",\"c\",\"\"]\n\u03bb&gt; zip (inits \"abc\") (tails \"abc\")\n[(\"\",\"abc\"),(\"a\",\"bc\"),(\"ab\",\"c\"),(\"abc\",\"\")]\n</code></pre>\n\n<p>Then look at <a href=\"https://hackage.haskell.org/package/base/docs/Prelude.html#v:zipWith\" rel=\"nofollow noreferrer\"><code>zipWith</code></a>. (Some coverage in <a href=\"http://learnyouahaskell.com/higher-order-functions\" rel=\"nofollow noreferrer\">LYAH</a>.)</p>\n\n<hr>\n\n<p>I also don't know what <code>max3</code> has to do with this problem, but another way to write <code>max3</code> is:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>max3 :: Ord a =&gt; a -&gt; a -&gt; a -&gt; a\nmax3 a b c = max a (max b c)\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 12118780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1672f667ef2e09d09ff3f4d20079fce?s=128&d=identicon&r=PG&f=1", "display_name": "Beszteri", "link": "https://stackoverflow.com/users/12118780/beszteri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 58525250, "answer_count": 1, "score": 0, "last_activity_date": 1571841587, "creation_date": 1571834859, "last_edit_date": 1571835363, "question_id": 58523226, "link": "https://stackoverflow.com/questions/58523226/replacements-define", "title": "Replacements define", "body": "<p>I am trying to get a program that gives all the possible ways of swapping a component to a new one, based on a new component and a list. My goal is to write something simple like:</p>\n\n<pre><code>max3 :: Ord a =&gt; a -&gt; a -&gt; a -&gt; a\nmax3 a b c\n      | a &gt; b &amp;&amp; a &gt; c = a\n      | b &gt; a &amp;&amp; b &gt; c = b\n      | c &gt; a &amp;&amp; c &gt; b = c\n      | otherwise = error \".\"\n</code></pre>\n\n<p>For instance:</p>\n\n<pre><code>replacements :: a -&gt; [a] -&gt; [[a]]\nreplacements 'x' \"abc\" == [\"xbc\",\"axc\",\"abx\"]\nreplacements 1 [] == []\n</code></pre>\n"}, {"tags": ["haskell", "recursion", "concat"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1571832267, "post_id": 58522458, "comment_id": 103370009, "body": "SInce <code>x</code> is a list, you can not here use <code>x : ...</code>, unless you again want to create a list of lists."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1571965226, "post_id": 58522458, "comment_id": 103422513, "body": "Do you mind posting the type error for future searchability?"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 6, "last_activity_date": 1571832445, "creation_date": 1571832445, "answer_id": 58522508, "question_id": 58522458, "link": "https://stackoverflow.com/questions/58522458/haskell-own-concat-method-with-recursion/58522508#58522508", "title": "Haskell own concat method with recursion", "body": "<p>Since <code>x</code> is a list here (it has type <code>[a]</code>), you can not use <code>x : &hellip;</code> here, unless you again want to create a list of lists, but then your <code>myConcat</code> would act like an <code>id</code> function for lists.</p>\n\n<p>You here need to <em>append</em> <code>x</code> with the rest of the list, so you can use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:-43--43-\" rel=\"noreferrer\"><strong><code>(++) :: [a] -&gt; [a] -&gt; [a]</code></strong></a>, indeed:</p>\n\n<pre><code>myConcat :: [[a]] -&gt; [a]\nmyConcat [] = []\nmyConcat (x:xs) = x ++ myConcat xs</code></pre>\n\n<p>Note that you forgot the base case <code>[]</code>. By writing <code>[[]]</code> you match a list with <em>one</em> element: the empty list. That is something different.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1571842658, "post_id": 58522516, "comment_id": 103376116, "body": "That&#39;s not enough. The pattern matches remain incomplete."}, {"owner": {"reputation": 488, "user_id": 3265362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXfiq.jpg?s=128&g=1", "display_name": "nader.h", "link": "https://stackoverflow.com/users/3265362/nader-h"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1571843014, "post_id": 58522516, "comment_id": 103376310, "body": "yes sure the case of empty List! My solution isnt complete, i just wanted to highlight the difference between <code>:</code>  and <code>++</code>"}], "tags": [], "owner": {"reputation": 488, "user_id": 3265362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXfiq.jpg?s=128&g=1", "display_name": "nader.h", "link": "https://stackoverflow.com/users/3265362/nader-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1571832472, "creation_date": 1571832472, "answer_id": 58522516, "question_id": 58522458, "link": "https://stackoverflow.com/questions/58522458/haskell-own-concat-method-with-recursion/58522516#58522516", "title": "Haskell own concat method with recursion", "body": "<p>hello you have just to replace your <code>x : myConcat xs</code> by <code>x ++ myConcat xs</code> </p>\n"}], "owner": {"reputation": 59, "user_id": 10889999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f32f712776594692c571d3b48d493da9?s=128&d=identicon&r=PG&f=1", "display_name": "mehukatti", "link": "https://stackoverflow.com/users/10889999/mehukatti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1571832472, "creation_date": 1571832223, "question_id": 58522458, "link": "https://stackoverflow.com/questions/58522458/haskell-own-concat-method-with-recursion", "title": "Haskell own concat method with recursion", "body": "<p>Im practicing recursion on Haskell and need to do concat method with own impelentation on a nested list.</p>\n\n<p>I've tried </p>\n\n<pre><code>    myConcat :: [[a]] -&gt; [a]\n    myConcat [[]] = []\n    myConcat ((x:xs)) = x : myConcat ((xs))\n</code></pre>\n\n<p>But it doesnt seem to work.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>myConcat [[1,2],[3,4,5],[6]] == [1,2,3,4,5,6]\n</code></pre>\n\n<p>This is the goal.</p>\n\n<p>The main problem is that i dont really know how to work with nested lists.</p>\n"}, {"tags": ["haskell", "functional-programming", "haskell-platform"], "comments": [{"owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "edited": false, "score": 2, "creation_date": 1571816248, "post_id": 58517692, "comment_id": 103361651, "body": "@Saurabhkukade Then it is a type alias instead of algebraic data type."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1571816097, "creation_date": 1571816097, "answer_id": 58517745, "question_id": 58517692, "link": "https://stackoverflow.com/questions/58517692/how-to-check-if-all-the-element-in-the-list-of-one-algebraic-type-in-haskell/58517745#58517745", "title": "How to check if all the element in the list of one algebraic type in Haskell?", "body": "<p>You can make use of the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Either.html#v:isRight\" rel=\"noreferrer\"><strong><code>isRight :: Either a b -&gt; Bool</code></strong></a> function to check if an <code>Either a b</code> value is a <code>Right x</code>.</p>\n\n<p>So you can implement this with:</p>\n\n<pre><code>import Data.Either(isRight)\n\nallRight :: Foldable f =&gt; f (Either a b) -&gt; Bool\nallRight = all <b>isRight</b></code></pre>\n\n<p>This gives us the expected output:</p>\n\n<pre><code>Prelude Data.Either&gt; allRight ls\nTrue\nPrelude Data.Either&gt; allRight xs\nFalse\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17430, "user_id": 309483, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d797538504a367f277d19bd8369e9a19?s=128&d=identicon&r=PG", "display_name": "Janus Troelsen", "link": "https://stackoverflow.com/users/309483/janus-troelsen"}, "edited": false, "score": 0, "creation_date": 1571955545, "post_id": 58519499, "comment_id": 103420524, "body": "in other words, <code>isRight . sequenceA</code> returns true when its argument doesn&#39;t contain a <code>Left</code>."}, {"owner": {"reputation": 506, "user_id": 510722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z6pTT.jpg?s=128&g=1", "display_name": "ajmccluskey", "link": "https://stackoverflow.com/users/510722/ajmccluskey"}, "edited": false, "score": 1, "creation_date": 1572148845, "post_id": 58519499, "comment_id": 103468741, "body": "Somewhat related: if you find yourself wanting to collect all of the errors encountered (I often do), and not just the first, there&#39;s the <code>validation</code> package. <a href=\"https://hackage.haskell.org/package/validation\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/validation</a>"}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": false, "score": 21, "last_activity_date": 1571822323, "creation_date": 1571822323, "answer_id": 58519499, "question_id": 58517692, "link": "https://stackoverflow.com/questions/58517692/how-to-check-if-all-the-element-in-the-list-of-one-algebraic-type-in-haskell/58519499#58519499", "title": "How to check if all the element in the list of one algebraic type in Haskell?", "body": "<p>Not to gainsay <code>all isRight</code> as a good answer to the question which was asked, I'd question the question, to some extent. What good is it to compute, as a <code>Bool</code>, whether all the <code>Either</code> values in a list are <code>Right</code>? What does it enable you to do? One answer is that it entitles you to strip the <code>Right</code> tags from the entire list, treating the whole as error free.</p>\n\n<p>A more informative option might be to construct something of type</p>\n\n<pre><code>[Either String Int] -&gt; Either String [Int]\n</code></pre>\n\n<p>so that instead of a mere <code>True</code> or <code>False</code>, you obtain all the <code>Int</code>s untagged or the message associated with the first pesky <code>Left</code>.</p>\n\n<p>And there is a standard function which does this (and many other things besides). It exploits the fact that lists are a data structure with a standard traversal pattern and that <code>Either String</code> encodes a notion of error-managing computation with standard patterns of failure and success propagation. The type has already done the hard work. All you need to say is...</p>\n\n<pre><code>sequenceA\n</code></pre>\n"}], "owner": {"reputation": 1364, "user_id": 5105791, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/54ffN.jpg?s=128&g=1", "display_name": "Saurabh kukade", "link": "https://stackoverflow.com/users/5105791/saurabh-kukade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 810, "favorite_count": 0, "accepted_answer_id": 58517745, "answer_count": 2, "score": 5, "last_activity_date": 1571822323, "creation_date": 1571815897, "last_edit_date": 1571816023, "question_id": 58517692, "link": "https://stackoverflow.com/questions/58517692/how-to-check-if-all-the-element-in-the-list-of-one-algebraic-type-in-haskell", "title": "How to check if all the element in the list of one algebraic type in Haskell?", "body": "<p>If I have following algebraic data type </p>\n\n<pre><code>type MyVal = Either String Int\n</code></pre>\n\n<p>and have a list containing element of type MyVal</p>\n\n<pre><code>ls = [Right 1, Right 2, Right 3]\nxs = [Right 1, Left \"error\", Right 3]\n</code></pre>\n\n<p>now, I want write function to  find out that is my list having all the value of 'Right' then it should return True otherwise False. </p>\n\n<p>In case of <code>ls</code> it will return True and for <code>xs</code> it will return False.</p>\n\n<p>How can I do that?</p>\n\n<p>I have tried using <code>all</code> function but could not able to use it correctly. </p>\n"}, {"tags": ["list", "haskell", "recursion", "merge"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1571783623, "post_id": 58512472, "comment_id": 103353505, "body": "if it &quot;starts with a known tuple&quot;, then simply <code>mergePoints l1 l2 o = o : mergePoints2 l1 l2</code>, isn&#39;t it?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1571813152, "post_id": 58512472, "comment_id": 103360103, "body": "<i>why the dv?</i> the OP states the problem, shows an attempt at coding a solution, the sample input and the desired output... this is a nearly perfectly asked question, I thought. In fact I should&#39;ve uv&#39;d it right away. If it&#39;s good enough to answer, it&#39;s good enough to upvote."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 9033999, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-rPJ7S6CuV-0/AAAAAAAAAAI/AAAAAAAAAA4/K2_FGLr79l0/photo.jpg?sz=128", "display_name": "Mariana Leites", "link": "https://stackoverflow.com/users/9033999/mariana-leites"}, "edited": false, "score": 0, "creation_date": 1571781097, "post_id": 58512611, "comment_id": 103352851, "body": "I understand. The new problem is that I&#39;m not really sure how to do this recursion."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 69, "user_id": 9033999, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-rPJ7S6CuV-0/AAAAAAAAAAI/AAAAAAAAAA4/K2_FGLr79l0/photo.jpg?sz=128", "display_name": "Mariana Leites", "link": "https://stackoverflow.com/users/9033999/mariana-leites"}, "edited": false, "score": 0, "creation_date": 1571781291, "post_id": 58512611, "comment_id": 103352908, "body": "here&#39;s an example: <code>foo x | x &gt; 10 = [] | otherwise = x : foo (x+1)</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 69, "user_id": 9033999, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-rPJ7S6CuV-0/AAAAAAAAAAI/AAAAAAAAAA4/K2_FGLr79l0/photo.jpg?sz=128", "display_name": "Mariana Leites", "link": "https://stackoverflow.com/users/9033999/mariana-leites"}, "edited": false, "score": 0, "creation_date": 1571781376, "post_id": 58512611, "comment_id": 103352928, "body": "here&#39;s another: <code>bar [] = [] ; bar (x:xs) | x &gt; 10 = [] | otherwise = x : bar xs</code>."}, {"owner": {"reputation": 69, "user_id": 9033999, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-rPJ7S6CuV-0/AAAAAAAAAAI/AAAAAAAAAA4/K2_FGLr79l0/photo.jpg?sz=128", "display_name": "Mariana Leites", "link": "https://stackoverflow.com/users/9033999/mariana-leites"}, "edited": false, "score": 0, "creation_date": 1571783370, "post_id": 58512611, "comment_id": 103353438, "body": "I ended up with this: <code>mergePoints [] [] o = [] ; mergePoints (x:xs) (y:ys) o | x &lt;= y = p ++ [x] ++ [y] ++ mergePoints xs ys o | x &gt; y = p ++ [y] ++ [x] ++ mergePoints xs ys o ; where p = o : [] </code> , I know where I have the error, I just don&#39;t know what to do with it"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 69, "user_id": 9033999, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-rPJ7S6CuV-0/AAAAAAAAAAI/AAAAAAAAAA4/K2_FGLr79l0/photo.jpg?sz=128", "display_name": "Mariana Leites", "link": "https://stackoverflow.com/users/9033999/mariana-leites"}, "edited": false, "score": 0, "creation_date": 1571783497, "post_id": 58512611, "comment_id": 103353473, "body": "you&#39;re almost there, just need to pick <i>just one</i> of the <code>[x] ++</code> <i>or</i> <code>[y] ++</code> in each case! If you do them both, it&#39;s again consuming the two lists at the same speed. also, try first coding this without the <code>o</code> at all."}, {"owner": {"reputation": 69, "user_id": 9033999, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-rPJ7S6CuV-0/AAAAAAAAAAI/AAAAAAAAAA4/K2_FGLr79l0/photo.jpg?sz=128", "display_name": "Mariana Leites", "link": "https://stackoverflow.com/users/9033999/mariana-leites"}, "edited": false, "score": 0, "creation_date": 1571784090, "post_id": 58512611, "comment_id": 103353637, "body": "I actually need to compare and add the first element of the 2 lists at the same time, in order."}, {"owner": {"reputation": 69, "user_id": 9033999, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-rPJ7S6CuV-0/AAAAAAAAAAI/AAAAAAAAAA4/K2_FGLr79l0/photo.jpg?sz=128", "display_name": "Mariana Leites", "link": "https://stackoverflow.com/users/9033999/mariana-leites"}, "edited": false, "score": 0, "creation_date": 1571784264, "post_id": 58512611, "comment_id": 103353679, "body": "The order in the output is exactly what I want, the problem is the last point, the first one, that I named <code>o</code>"}, {"owner": {"reputation": 69, "user_id": 9033999, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-rPJ7S6CuV-0/AAAAAAAAAAI/AAAAAAAAAA4/K2_FGLr79l0/photo.jpg?sz=128", "display_name": "Mariana Leites", "link": "https://stackoverflow.com/users/9033999/mariana-leites"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1571784357, "post_id": 58512611, "comment_id": 103353707, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/201288/discussion-between-mariana-leites-and-will-ness\">continue this discussion in chat</a>."}, {"owner": {"reputation": 69, "user_id": 9033999, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-rPJ7S6CuV-0/AAAAAAAAAAI/AAAAAAAAAA4/K2_FGLr79l0/photo.jpg?sz=128", "display_name": "Mariana Leites", "link": "https://stackoverflow.com/users/9033999/mariana-leites"}, "edited": false, "score": 1, "creation_date": 1571832716, "post_id": 58512611, "comment_id": 103370264, "body": "I got it to work, another way. What I first wanted to do is what you did in mergePoints2, but I was getting errors in the let clause, so what you did helped me understand my error and now I know how to work it. All the rest is a really good help for me to understand a bit more of Haskell and how it works. Thank you very much, this is a really good help."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 69, "user_id": 9033999, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-rPJ7S6CuV-0/AAAAAAAAAAI/AAAAAAAAAA4/K2_FGLr79l0/photo.jpg?sz=128", "display_name": "Mariana Leites", "link": "https://stackoverflow.com/users/9033999/mariana-leites"}, "edited": false, "score": 0, "creation_date": 1571840856, "post_id": 58512611, "comment_id": 103375117, "body": "you&#39;re very welcome, it&#39;s good to see someone asking a question properly and staying engaged with it. :)"}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 1, "last_activity_date": 1571840601, "last_edit_date": 1571840601, "creation_date": 1571780067, "answer_id": 58512611, "question_id": 58512472, "link": "https://stackoverflow.com/questions/58512472/merging-two-lists-of-tuples/58512611#58512611", "title": "Merging Two Lists of Tuples", "body": "<p>According to your example,</p>\n\n<pre><code>ghci&gt; mergePoints [(1, 3), (1, 4), (5, 5)] [(1, 1), (4, 4)] \n      (0, 0)\n[    (0.0, 0.0),                          (1.0, 1.0), \n               (1.0, 3.0), (1.0, 4.0),            (4.0, 4.0), \n                                  (5.0, 5.0)]\n</code></pre>\n\n<p>each of the two lists is consumed at its own pace, so <code>zip</code> won't fit here, as it consumes its argument lists at the same pace.</p>\n\n<p>The simplest way to code this is with a directly recursive definition with pattern matching that will compare the two head elements and use one or the other, depending on the result of the comparison. </p>\n\n<p>Perhaps you will also need to compare them with the supplied third point, in case it's not the smallest.</p>\n\n<hr>\n\n<p>So, about your code. </p>\n\n\n\n<p>Judging from the example input and output, the points are supposed to come out in order. We can just compare the tuples as they define a <em>lexicographical</em> ordering. You already are doing that. With a small syntactical fix your code is:</p>\n\n<pre><code>mergePoints1 l1 l2 o  =  o ++ [f | (a, b) &lt;- zip l1 l2, \n                                   let f if a &lt; b then f = [a, b] \n                                                  else f = [b, a]]\n</code></pre>\n\n<p>This is not a valid Haskell. There is no assignment in Haskell, only definition:</p>\n\n<pre><code>mergePoints2 l1 l2 o  =  o ++ [f | (a, b) &lt;- zip l1 l2, \n                                   let f = if a &lt; b then [a, b] else [b, a]]\n</code></pre>\n\n<p>But this list comprehension creates a list of lists of tuples, as we're creating them as either <code>f = [a,b]</code> or <code>f = [b,a]</code>. Using the points one by one we need to \"draw\" them from those short lists, one by one, with</p>\n\n<pre><code>mergePoints3 l1 l2 o  =  o ++ [r | (a, b) &lt;- zip l1 l2, \n                                   r &lt;- if a &lt; b then [a, b] else [b, a]]\n</code></pre>\n\n<p>(using <code>r</code> for \"result\", instead of <code>f</code>). The last error is that <code>++</code> concatenates two <em>lists</em>, but <code>o</code> isn't one. So then it must be</p>\n\n<pre><code>mergePoints4 l1 l2 o  =  [o] ++ merge1 l1 l2\n\nmerge1 l1 l2  =  [r | (a, b) &lt;- zip l1 l2, \n                      r &lt;- if a &lt; b then [a, b] else [b, a]]\n</code></pre>\n\n<p>Now it works, but doesn't do what it's supposed to. And in fact, since its output is still not guaranteed to be ordered, we could even just write this as</p>\n\n\n\n<pre><code>merge2 l1 l2  =  l1 ++ l2\n  where                     -- the definition of the built-in `++`:\n  []     ++ l2  =  l2\n  l1     ++ []  =  l1\n  (x:t1) ++ l2  =  x : (t1 ++ l2)\n</code></pre>\n\n<p>or we could pull the elements from <em>both</em> lists with </p>\n\n<pre><code>merge3 l1 l2  =  l1 ++ l2\n  where\n  []     ++ l2      =  l2\n  l1     ++ []      =  l1\n  (x:t1) ++ (y:t2)  =  x : y : (t1 ++ t2)   -- or:\n               --   =  x : ((y:t2) ++ t1)\n</code></pre>\n\n<p>Of course taking out the elements one by one <em>positionally</em> scrambles up their ordering, potentially. Your attempt to rectify this with the <code>merge1</code> can be re-written as</p>\n\n<pre><code>merge1b l1 l2  =  l1 ++ l2\n  where\n  []     ++ l2  =  l2\n  l1     ++ []  =  l1\n  (x:t1) ++ (y:t2)  =  if  x &lt; y  then  x : y : (t1 ++ t2)\n                       else             y : x : (t1 ++ t2)\n</code></pre>\n\n<p>but it still can scramble up the order. We <em>assume</em> our two inputs to be <em>ordered</em>, increasing lists where each element is smaller then the one that follows it in the list. So we just need to use that knowledge, <em>carefully</em> pulling just one of the elements:</p>\n\n<pre><code>merge4 l1 l2  =  l1 ++ l2\n  where\n  []     ++ l2      =  l2\n  l1     ++ []      =  l1\n  (x:t1) ++ (y:t2)  =  if   x &lt; y  then  x : (_ ++ (y:t2))\n                       else              _ : _\n</code></pre>\n\n<p>You need to complete this definition by replacing the <code>_</code>s with the actual code.</p>\n\n<p><sub>Bonus question: the usual definition of <code>merge</code> in Haskell prefers its \"left\" argument over the \"right\" one, in case of equality of the two elements. Make a one-character edit to the code, to achieve this.</sub></p>\n"}], "owner": {"reputation": 69, "user_id": 9033999, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-rPJ7S6CuV-0/AAAAAAAAAAI/AAAAAAAAAA4/K2_FGLr79l0/photo.jpg?sz=128", "display_name": "Mariana Leites", "link": "https://stackoverflow.com/users/9033999/mariana-leites"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 58512611, "answer_count": 1, "score": 0, "last_activity_date": 1571843244, "creation_date": 1571779249, "last_edit_date": 1571843244, "question_id": 58512472, "link": "https://stackoverflow.com/questions/58512472/merging-two-lists-of-tuples", "title": "Merging Two Lists of Tuples", "body": "<p>I need to create a recursive function that merges two lists of tuples together and it starts with a known tuple. The function receives three parameters:</p>\n\n<ul>\n<li>two lists of tuples</li>\n<li>a tuple</li>\n</ul>\n\n<p>I've tried this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>mergePoints l1 l2 o = o ++ [f | (a, b) &lt;- zip l1 l2, \n                                let f if a &lt; b then f = a, b else f = b, a]\n</code></pre>\n\n<p>I know I'm not doing it right, but I really don't know how to do it.</p>\n\n<p>The example input and output for the exercise is:</p>\n\n<pre><code>ghci&gt; mergePoints [(1, 3), (1, 4), (5, 5)] [(1, 1), (4, 4)] (0, 0)\n[(0.0, 0.0), (1.0, 1.0), (1.0, 3.0), (1.0, 4.0), (4.0, 4.0), (5.0, 5.0)]\n</code></pre>\n"}, {"tags": ["haskell", "package", "cabal"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1571779865, "post_id": 58512311, "comment_id": 103352526, "body": "Does <code>v2-install</code> not work?  The <code>install</code> aka <code>v1-install</code> is conceptually broken in that it requires you to install one version globally, locking you in and causing version conflicts between projects."}, {"owner": {"reputation": 181, "user_id": 12125886, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lL_tHSWvd4A/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf83z8SWPpiCu8AqntU5mT9fDe0kA/photo.jpg?sz=128", "display_name": "Kale Joe", "link": "https://stackoverflow.com/users/12125886/kale-joe"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1571787513, "post_id": 58512311, "comment_id": 103354398, "body": "No it did not work &#39;cabal install sort v2-install&#39;, it failed again."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1571793175, "post_id": 58512311, "comment_id": 103355408, "body": "What is the exact command you are trying? I&#39;m really struggling to connect the output shown here with what I would expect from <code>cabal install sort</code>. For one thing, there&#39;s a bunch of user goals that are not <code>sort</code>; where did those come from? For another, there&#39;s no user goal that is <code>sort</code>; why not? What&#39;s more, I&#39;ve just looked at <code>sort</code> on Hackage, and it has pretty much 0 dependencies. So all this dependency solving must be coming from somewhere else. What are you actually doing? Do you have a sandbox? Do you have a cabal file or project in the same directory? We need way more info."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1571802588, "post_id": 58512311, "comment_id": 103357152, "body": "@KaleJoe I wasn&#39;t suggesting you add <code>v2-install</code> as a package to install.  The suggestion in it&#39;s entirety is <code>cabal v2-install --lib sort</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1571830337, "post_id": 58512311, "comment_id": 103368896, "body": "@ThomasM.DuBuisson though I&#39;d agree that the new-style Cabal commands are overall much better, I&#39;ve always found the criticism of the v1-commands exaggerated. Sure, it would often cause conflicts \u2013 but it&#39;s not like those couldn&#39;t be resolved, only, it could require large-scale reinstalls. (But that&#39;s what new-install has to do as well, only it does it under the hood.) I <i>don&#39;t</i> think this problem has anything to do with v1-install, it rather looks like something is fundametally incompatible with the GHC version."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1571831833, "post_id": 58512311, "comment_id": 103369780, "body": "I face a similar problem when I try to install a package outside a project, only it objects agains <code>process</code>, rather than <code>containers</code>. Possibly me and Kale are witnessing two instances of the same bug."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1571852280, "post_id": 58512311, "comment_id": 103380723, "body": "To help we&#39;d need much more information.  You&#39;ll probably be better off starting fresh by removing <code>.ghc</code> and <code>.cabal</code>, trying again, and if you get stuck then include the version of GHC, Cabal, installation source, exact commands..  Even better if you can use a container or something transferable to others to reproduce your issue, such as <code>docker run --rm -it -u tommd tommd&#47;haskell</code> and <code>cabal update ; cabal install sort</code> or similar."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1571854974, "post_id": 58512311, "comment_id": 103381878, "body": "@ThomasM.DuBuisson Indeed this seems to be an error in the <code>.ghc&#47;...&#47;environments&#47;default</code>. It has an entry <code>package-id process-1.6.5.1-9872203aea42fb5652d0920fddefeb54b4ca067e3b28&zwnj;&#8203;7e3fad61e26e7e16d857</code>&zwnj;&#8203;. In a newly created <code>.ghc&#47;...&#47;default</code> the entry for <code>process</code> is different: <code>package-id process-1.6.5.0</code>. Possibly this is the problem. But I am not sure what to make of it."}], "owner": {"reputation": 181, "user_id": 12125886, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lL_tHSWvd4A/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf83z8SWPpiCu8AqntU5mT9fDe0kA/photo.jpg?sz=128", "display_name": "Kale Joe", "link": "https://stackoverflow.com/users/12125886/kale-joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 282, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571800782, "creation_date": 1571778341, "last_edit_date": 1571800782, "question_id": 58512311, "link": "https://stackoverflow.com/questions/58512311/what-can-i-do-to-install-sort-package-haskell-that-keeps-failing", "title": "What can I do to install sort package (Haskell) that keeps failing?", "body": "<p>I am trying to install the sort package (Haskell), but it keeps failing even though I have the latest version of cabal. </p>\n\n<p>So I updated my cabal : <code>cabal update</code>\nBut when I run <code>cabal install sort</code>, it failed. Then I tried to run it with <code>--minimize-conflict-set</code>, but it did not work as well. What can I do? </p>\n\n<pre><code>Resolving dependencies...\ncabal: Could not resolve dependencies:\n[__0] trying: base-4.12.0.0/installed-4.1... (user goal)\n[__1] next goal: binary (user goal)\n[__1] rejecting: binary-0.8.7.0 (constraint from user target requires\n==0.8.6.0)\n[__1] trying: binary-0.8.6.0/installed-0.8...\n[__2] next goal: containers (user goal)\n[__2] rejecting: containers-0.6.2.1 (conflict: binary =&gt;\ncontainers==0.6.0.1/installed-0.6...)\n[__2] rejecting: containers-0.6.1.1, containers-0.6.0.1/installed-0.6...,\ncontainers-0.6.0.1, containers-0.5.11.0, containers-0.5.10.2,\ncontainers-0.5.10.1, containers-0.5.9.2, containers-0.5.8.2,\ncontainers-0.5.7.1, containers-0.5.7.0, containers-0.5.6.3,\ncontainers-0.5.6.2, containers-0.5.6.1, containers-0.5.6.0,\ncontainers-0.5.5.1, containers-0.5.5.0, containers-0.5.4.0,\ncontainers-0.5.3.1, containers-0.5.3.0, containers-0.5.2.1,\ncontainers-0.5.2.0, containers-0.5.1.0, containers-0.5.0.0,\ncontainers-0.4.2.1, containers-0.4.2.0, containers-0.4.1.0,\ncontainers-0.4.0.0, containers-0.3.0.0, containers-0.2.0.1,\ncontainers-0.2.0.0, containers-0.1.0.1, containers-0.1.0.0,\ncontainers-0.5.9.1, containers-0.5.8.1 (constraint from user target requires\n==0.6.2.1)\n[__2] fail (backjumping, conflict set: binary, containers)\nAfter searching the rest of the dependency tree exhaustively, these were the\ngoals I've had most trouble fulfilling: binary, containers, base, ghc\nTry running with --minimize-conflict-set to improve the error message.\n</code></pre>\n\n<pre><code>Resolving dependencies...\ncabal: Could not resolve dependencies:\n[__0] trying: base-4.12.0.0/installed-4.1... (user goal)\n[__1] trying: containers-0.6.2.1 (user goal)\n[__2] next goal: ghc (user goal)\n[__2] rejecting: ghc-8.6.5/installed-8.6... (conflict: containers==0.6.2.1,\nghc =&gt; containers==0.6.0.1/installed-0.6...)\n[__2] rejecting: ghc-8.6.5 (conflict: base==4.12.0.0/installed-4.1..., ghc =&gt;\nbase&lt;0 &amp;&amp; ==4.12.*)\n[__2] rejecting: ghc-8.6.4, ghc-8.6.1, ghc-8.4.4, ghc-8.4.3, ghc-8.4.1,\nghc-8.2.2, ghc-8.2.1 (constraint from user target requires ==8.6.5)\n[__2] fail (backjumping, conflict set: base, containers, ghc)\nAfter searching the rest of the dependency tree exhaustively, these were the\ngoals I've had most trouble fulfilling: containers, base, ghc\n</code></pre>\n"}, {"tags": ["haskell", "recursion", "fold"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1571767093, "post_id": 58509133, "comment_id": 103347521, "body": "Explicit recursion usually just means you are solving a problem somebody else has already solved for you (and potentially more correctly or efficiently than you)."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1571842800, "post_id": 58509133, "comment_id": 103376213, "body": "Instead of <code>\\x -&gt; x mod 2 == 0</code> you can write <code>even</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "edited": false, "score": 0, "creation_date": 1571765758, "post_id": 58509543, "comment_id": 103346963, "body": "Sorry I was looking at the bytes allocated in the heap. What does maximum residency mean?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1571768701, "post_id": 58509543, "comment_id": 103348204, "body": "See <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/runtime_control.html#rts-options-to-produce-runtime-statistics\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/latest/docs/html/users_guide/&hellip;</a>  specifically <code>The maximum space actually used by your program is the \u201cbytes maximum residency\u201d figure. This is only checked during major garbage collections, so it is only an approximation; the number of samples tells you how many times it is checked.</code>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1571768790, "post_id": 58509543, "comment_id": 103348242, "body": "Not to be confused with <code>The \u201cbytes allocated in the heap\u201d is the total bytes allocated by the program over the whole run.</code>  Which should also note that the same bytes can be allocated/freed/re-allocated more than once - indeed that is usually the case - so you can have a constant space program that allocates terabytes of memory over its life time."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "edited": false, "score": 0, "creation_date": 1571769181, "post_id": 58509543, "comment_id": 103348394, "body": "@PKChem &quot;bytes allocated in the heap&quot; is <i>also</i> smaller for the version with <code>foldr</code>. That&#39;s the allocation I was referring to in my answer."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1571778797, "post_id": 58509543, "comment_id": 103352169, "body": "I think you got it backwards? find (with foldr): &quot;<b><i>92,081,224</i></b> bytes allocated in the heap,  9,392 bytes copied during GC, <b>58,848</b> bytes maximum residency&quot;. findRec (with recursion): &quot;<b><i>76,048,432</i></b> bytes allocated in the heap,  13,768 bytes copied during GC, <b>42,928</b> bytes maximum residency&quot;."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1571782601, "post_id": 58509543, "comment_id": 103353244, "body": "Ah, you&#39;re right. The names <code>find</code> and <code>findRec</code> are short enough and similar enough that I got them mixed up."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 11, "last_activity_date": 1571765450, "creation_date": 1571765450, "answer_id": 58509543, "question_id": 58509133, "link": "https://stackoverflow.com/questions/58509133/why-to-avoid-explicit-recursion-in-haskell/58509543#58509543", "title": "Why to avoid Explicit recursion in Haskell?", "body": "<p>You are measuring how quickly GHC can do half a million modulus operations. As you might expect, \"in the blink of an eye\" is the answer regardless of how you iterate. There is no obvious difference in speed.</p>\n\n<p>You claim that you can see that explicit recursion is using less memory, but the heap profiling data you provide shows the opposite: more allocation and higher max residency when using explicit recursion. I don't think the difference is significant, but if it were then your evidence would be contradicting your claim.</p>\n\n<p>As to the question of why to avoid explicit recursion, it's not really clear what part of that thread you read that made you come to your conclusion. You linked to a giant thread which itself links to another giant thread, with many competing opinions. The comment that stands out the most to me is <a href=\"https://www.reddit.com/r/haskell/comments/1nb80j/proper_use_of_recursion_in_haskell/cch97ts/\" rel=\"noreferrer\">it's not about efficiency, it's about levels of abstraction</a>. You are looking at this the wrong way by trying to measure its performance.</p>\n"}, {"comments": [{"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 4, "creation_date": 1571785556, "post_id": 58513312, "comment_id": 103353981, "body": "Actually, here&#39;s a better take-home lesson.  Especially when you&#39;re getting started with Haskell, make every possible effort to avoid thinking about &quot;optimizing&quot; your code.  Far more than any other language I know, there is an enormous gulf between the code you write and the code the compiler generates, so don&#39;t even try to figure it out right now.  Instead, write code that is clear, straightforward, and idiomatic.  If you try to learn the &quot;rules&quot; for high-performance code now, you&#39;ll get them all wrong and learn really bad programming style into the bargain."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1571799099, "post_id": 58513312, "comment_id": 103356557, "body": "I suggest moving this comment into the answer. Comments are ephemeral; answers are forever."}, {"owner": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "edited": false, "score": 0, "creation_date": 1571799795, "post_id": 58513312, "comment_id": 103356662, "body": "Thank you so much for enlightening me. Can you please suggest me the resource which can contain this level of explaining."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 5, "last_activity_date": 1572015799, "last_edit_date": 1572015799, "creation_date": 1571785048, "answer_id": 58513312, "question_id": 58509133, "link": "https://stackoverflow.com/questions/58509133/why-to-avoid-explicit-recursion-in-haskell/58513312#58513312", "title": "Why to avoid Explicit recursion in Haskell?", "body": "<p>First, don't try to understand the performance of GHC-compiled code using anything other than optimized compilation:</p>\n\n<pre><code>$ stack ghc -- -O2 Find.hs\n$ ./Find +RTS -s\n</code></pre>\n\n<p>With the <code>-O2</code> flag (and GHC version 8.6.4), your <code>find</code> performs as follows:</p>\n\n<pre><code>      16,051,544 bytes allocated in the heap\n          14,184 bytes copied during GC\n          44,576 bytes maximum residency (2 sample(s))\n          29,152 bytes maximum slop\n               0 MB total memory in use (0 MB lost due to fragmentation)\n</code></pre>\n\n<p>However, this is very misleading.  None of this memory usage is due to the looping performed by <code>foldr</code>.  Rather it's all due to the use of boxed <code>Integers</code>.  If you switch to using plain <code>Ints</code> which the compiler can unbox:</p>\n\n<pre><code>main = print $ find (\\x -&gt; x `mod` 2 == 0) [1::Int, 3..1000000]\n                                             ^^^^^\n</code></pre>\n\n<p>the memory performance changes drastically and demonstrates the true memory cost of <code>foldr</code>:</p>\n\n<pre><code>      51,544 bytes allocated in the heap\n       3,480 bytes copied during GC\n      44,576 bytes maximum residency (1 sample(s))\n      25,056 bytes maximum slop\n           0 MB total memory in use (0 MB lost due to fragmentation)\n</code></pre>\n\n<p>If you test <code>findRec</code> with <code>Ints</code> like so:</p>\n\n<pre><code> main = print $ findRec (\\x -&gt; x `mod` 2 == 0) [1::Int, 3..1000000]\n</code></pre>\n\n<p>you'll see much worse memory performance:</p>\n\n<pre><code>  40,051,528 bytes allocated in the heap\n      14,992 bytes copied during GC\n      44,576 bytes maximum residency (2 sample(s))\n      29,152 bytes maximum slop\n           0 MB total memory in use (0 MB lost due to fragmentation)\n</code></pre>\n\n<p>which seems to make a compelling case that recursion should be avoided in preference to <code>foldr</code>, but this, too, is very misleading.  What you are seeing here is <strong>not</strong> the memory cost of recursion, but rather the memory cost of \"list building\".</p>\n\n<p>See, <code>foldr</code> and the expression <code>[1::Int, 3..1000000]</code> both include some magic called \"list fusion\".  This means that when they are used together (i.e., when <code>foldr</code> is applied to <code>[1::Int 3..1000000]</code>), an optimization can be performed to completely eliminate the creation of a Haskell list.  Critically, the <code>foldr</code> code, even using list fusion, compiles to recursive code which looks like this:</p>\n\n<pre><code>main_go\n  = \\ x -&gt;\n      case gtInteger# x lim of {\n        __DEFAULT -&gt;\n          case eqInteger# (modInteger x lvl) lvl1 of {\n            __DEFAULT -&gt; main_go (plusInteger x lvl);\n                      -- ^^^^^^^ - SEE?  IT'S JUST RECURSION\n            1# -&gt; Just x\n          };\n        1# -&gt; Nothing\n      }\nend Rec }\n</code></pre>\n\n<p>So, it's list fusion, rather than \"avoiding recursion\" that makes  <code>find</code> faster than <code>findRec</code>.</p>\n\n<p>You can see this is true by considering the performance of:</p>\n\n<pre><code>find1 :: Int -&gt; Maybe Int\nfind1 n | n &gt;= 1000000 = Nothing\n        | n `mod` 2 == 0 = Just n\n        | otherwise = find1 (n+2)\n\nmain :: IO ()\nmain = print $ find1 1\n</code></pre>\n\n<p>Even though this uses recursion, it doesn't generate a list (or use boxed <code>Integers</code>), so it runs just like the <code>foldr</code> version:</p>\n\n<pre><code>      51,544 bytes allocated in the heap\n       3,480 bytes copied during GC\n      44,576 bytes maximum residency (1 sample(s))\n      25,056 bytes maximum slop\n           0 MB total memory in use (0 MB lost due to fragmentation)\n</code></pre>\n\n<p>So, what are the take home lessons?</p>\n\n<ul>\n<li>Always benchmark Haskell code using <code>ghc -O2</code>, never GHCi or <code>ghc</code> without optimization flags.</li>\n<li>Less than 10% of people in any Reddit thread know what they're talking about.</li>\n<li><code>foldr</code> can sometimes perform better than explicit recursion when special optimizations like list fusion can apply.</li>\n<li>But in the general case, explicit recursion performs just as well as <code>foldr</code> or other specialized constructs.</li>\n<li>Also, optimizing Haskell code is hard.</li>\n</ul>\n\n<p>Actually, here's a better (more serious) take-home lesson. Especially when you're getting started with Haskell, make every possible effort to avoid thinking about \"optimizing\" your code. Far more than any other language I know, there is an enormous gulf between the code you write and the code the compiler generates, so don't even try to figure it out right now. Instead, write code that is clear, straightforward, and idiomatic. If you try to learn the \"rules\" for high-performance code now, you'll get them all wrong and learn really bad programming style into the bargain.</p>\n"}], "owner": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 1, "accepted_answer_id": 58513312, "answer_count": 2, "score": 6, "last_activity_date": 1572015799, "creation_date": 1571763689, "question_id": 58509133, "link": "https://stackoverflow.com/questions/58509133/why-to-avoid-explicit-recursion-in-haskell", "title": "Why to avoid Explicit recursion in Haskell?", "body": "<p>I am new to Haskell.</p>\n\n<p>While studying about foldr many are suggesting to use it and avoid explicit recursion which can lead to Memory Inefficient code. \n<a href=\"https://www.reddit.com/r/haskell/comments/1nb80j/proper_use_of_recursion_in_haskell/\" rel=\"noreferrer\">https://www.reddit.com/r/haskell/comments/1nb80j/proper_use_of_recursion_in_haskell/</a></p>\n\n<p>As I was running the sample mentioned in the above link. I can see the explicit recursion is doing better in terms of memory. First I thought May be running on GHCi is not near to perfect benchmark and I tried compiling it using <code>stack ghc</code>. And btw How can I pass Compiler Optimization flags via stack ghc. What am I missing from the Expression <strong>Avoid Explicit Recursion</strong>.</p>\n\n<pre><code>find p = foldr go Nothing\n    where go x rest = if p x then Just x else rest\n\nfindRec :: (a -&gt; Bool) -&gt; [a] -&gt; Maybe a\nfindRec _ [] = Nothing\nfindRec p (x:xs) = if p x then Just x else (findRec p xs)\n\nmain :: IO ()\nmain = print $ find (\\x -&gt; x `mod` 2 == 0) [1, 3..1000000] \nmain = print $ findRec (\\x -&gt; x `mod` 2 == 0) [1, 3..1000000] \n\n-- find\nNothing\n      92,081,224 bytes allocated in the heap\n           9,392 bytes copied during GC\n          58,848 bytes maximum residency (2 sample(s))\n          26,704 bytes maximum slop\n               0 MB total memory in use (0 MB lost due to fragmentation)\n\n                                     Tot time (elapsed)  Avg pause  Max pause\n  Gen  0        87 colls,     0 par    0.000s   0.000s     0.0000s    0.0001s\n  Gen  1         2 colls,     0 par    0.000s   0.001s     0.0004s    0.0008s\n\n  INIT    time    0.000s  (  0.000s elapsed)\n  MUT     time    0.031s  (  0.043s elapsed)\n  GC      time    0.000s  (  0.001s elapsed)\n  EXIT    time    0.000s  (  0.000s elapsed)\n  Total   time    0.031s  (  0.044s elapsed)\n\n  %GC     time       0.0%  (0.0% elapsed)\n\n  Alloc rate    2,946,599,168 bytes per MUT second\n\n  Productivity 100.0% of total user, 96.8% of total elapsed\n\n-- findRec\nNothing\n      76,048,432 bytes allocated in the heap\n          13,768 bytes copied during GC\n          42,928 bytes maximum residency (2 sample(s))\n          26,704 bytes maximum slop\n               0 MB total memory in use (0 MB lost due to fragmentation)\n\n                                     Tot time (elapsed)  Avg pause  Max pause\n  Gen  0        71 colls,     0 par    0.000s   0.000s     0.0000s    0.0001s\n  Gen  1         2 colls,     0 par    0.000s   0.001s     0.0004s    0.0007s\n\n  INIT    time    0.000s  (  0.000s elapsed)\n  MUT     time    0.031s  (  0.038s elapsed)\n  GC      time    0.000s  (  0.001s elapsed)\n  EXIT    time    0.000s  (  0.000s elapsed)\n  Total   time    0.031s  (  0.039s elapsed)\n\n  %GC     time       0.0%  (0.0% elapsed)\n\n  Alloc rate    2,433,549,824 bytes per MUT second\n\n  Productivity 100.0% of total user, 96.6% of total elapsed\n</code></pre>\n"}, {"tags": ["haskell", "icons"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1571746935, "post_id": 58504153, "comment_id": 103336785, "body": "What if you include <code>&quot;$targets&quot;: Icon.o</code> in the <code>ghc-options:</code>?"}, {"owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1571748555, "post_id": 58504153, "comment_id": 103337708, "body": "Thanks! That works although there is a warning telling &quot;the following files would be used as linker inputs, but linking is not being done: Icon.o&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 14681967, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hhXUBiyg298/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucn7mjVNIDyEh7cobvvso-IjfuRaSg/s96-c/photo.jpg?sz=128", "display_name": "Johannes Green", "link": "https://stackoverflow.com/users/14681967/johannes-green"}, "edited": false, "score": 0, "creation_date": 1606847736, "post_id": 58505270, "comment_id": 115084688, "body": "I have problem creating the Icon.o file. Winres give me syntax error. My post : <a href=\"https://stackoverflow.com/questions/65095586/syntax-error-when-running-winres-trying-to-set-executable-icon\" title=\"syntax error when running winres trying to set executable icon\">stackoverflow.com/questions/65095586/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "is_accepted": false, "score": 2, "last_activity_date": 1571750418, "creation_date": 1571750418, "answer_id": 58505270, "question_id": 58504153, "link": "https://stackoverflow.com/questions/58504153/how-to-build-a-project-with-an-icon-by-cabal-build-or-stack-build/58505270#58505270", "title": "How to build a project with an icon by `cabal build` or `stack build`", "body": "<p>According to @Willem Van Onsem's suggestion, the following is the solution:</p>\n\n<ul>\n<li>for a <code>stack</code> project, add the following configure into the <code>stack.yaml</code> file</li>\n</ul>\n\n<pre><code>    ghc-options:\n\n        \"$targets\": Icon.o\n</code></pre>\n\n<ul>\n<li>for a <code>cabal</code> project, add the following <code>ghc-options</code> into the <code>.cabal</code> file</li>\n</ul>\n\n<pre><code>    ghc-options:\n\n        Icon.o\n</code></pre>\n"}], "owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1571750418, "creation_date": 1571746750, "question_id": 58504153, "link": "https://stackoverflow.com/questions/58504153/how-to-build-a-project-with-an-icon-by-cabal-build-or-stack-build", "title": "How to build a project with an icon by `cabal build` or `stack build`", "body": "<p>I want to build an executable with an icon. By googling it, I find <a href=\"https://wiki.haskell.org/Setting_an_executable_icon\" rel=\"nofollow noreferrer\">the instruction here</a>, but it only works by compiling a source file with <code>ghc</code>. </p>\n\n<p>If I want to build a project with an executable by <code>cabal build</code> or <code>stack build</code>, how should I configure the <code>.cabal</code> or <code>.yaml</code> files such that <code>cabal build</code> or <code>stack build</code> can directly create an executable with an icon? </p>\n\n<p>I've googled it for a while, but nothing useful. </p>\n\n<p>I appreciate it if any tips are given.</p>\n"}, {"tags": ["haskell", "recursion", "boolean"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1571729579, "post_id": 58499159, "comment_id": 103327256, "body": "You did not take into account the case of an empty list. Since you each time recurse on the tail, eventually you will call <code>and&#39; []</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1571729771, "post_id": 58499159, "comment_id": 103327340, "body": "If you turn on warnings, GHC will point out that you missed the base case <code>[]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1571752116, "post_id": 58499226, "comment_id": 103339702, "body": "\u201cIf you turn on the <code>-Wincomplete-patterns</code>...\u201d \u2013 or, more sensibly, <code>-Wall</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 13, "last_activity_date": 1571739145, "last_edit_date": 1571739145, "creation_date": 1571729798, "answer_id": 58499226, "question_id": 58499159, "link": "https://stackoverflow.com/questions/58499159/why-do-i-get-exception-in-my-own-implementation-of-and-function/58499226#58499226", "title": "Why do I get exception in my own implementation of and function?", "body": "<blockquote>\n  <p>If my way of thinking is correct function should return me <code>True &amp;&amp; True &amp;&amp; True</code> and when I use this combination in <code>ghci</code> it returns <code>True</code>.</p>\n</blockquote>\n\n<p>Your <code>and' [True, True, True]</code> will boil down to <code>True &amp;&amp; True &amp;&amp; True &amp;&amp; <b>and' []</b></code>. Since you did not write a clause for the empty list, it will thus fail. If there was a <code>False</code> in your list, then it would never really make that call to <code>and' []</code>, since <code>False &amp;&amp; _</code> will return <code>False</code>, but a list that contains only <code>True</code>s will thus eventually make a call with the empty list.</p>\n\n<p>You thus can fix the problem by handling the empty list case as well:</p>\n\n<pre><code>and' :: [Bool] -&gt; Bool\n<b>and' [] = True</b>\nand' (x:xs) = x && and' xs</code></pre>\n\n<p>If you turn on the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/using-warnings.html#ghc-flag--Wincomplete-patterns\" rel=\"noreferrer\"><strong><code>-Wincomplete-patterns</code></strong> warning [ghc-doc]</a>, it will list the patterns you did not implement.</p>\n"}], "owner": {"reputation": 373, "user_id": 8092450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7aa39d5104993fb35a429f0e5a379ae?s=128&d=identicon&r=PG&f=1", "display_name": "Ethr", "link": "https://stackoverflow.com/users/8092450/ethr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 58499226, "answer_count": 1, "score": 3, "last_activity_date": 1571739145, "creation_date": 1571729505, "question_id": 58499159, "link": "https://stackoverflow.com/questions/58499159/why-do-i-get-exception-in-my-own-implementation-of-and-function", "title": "Why do I get exception in my own implementation of and function?", "body": "<p>I'm trying to write my own <code>and</code> function in Haskell. It looks like:</p>\n\n<pre><code>and' :: [Bool] -&gt; Bool\nand' (x:xs) = x &amp;&amp; and' xs\n</code></pre>\n\n<p>When I use <code>and' [True, True, True]</code> it gives me exception:</p>\n\n<pre><code>*** Exception: 6.hs:27:1-26: Non-exhaustive patterns in function and'\n</code></pre>\n\n<p>I figured out that adding: <code>and' _ = True</code> fixes my problem, but actually why do I have to add this line? If my way of thinking is correct function should return me <code>True &amp;&amp; True &amp;&amp; True</code> and when I use this combination in ghci it returns <code>True</code>. Could you explain me it please? Is there a way to see implementation of function <code>and</code> in ghci?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 967, "user_id": 2738882, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c4a87b27b18de15d87de3b85a0dffa11?s=128&d=identicon&r=PG&f=1", "display_name": "user2738882", "link": "https://stackoverflow.com/users/2738882/user2738882"}, "edited": false, "score": 0, "creation_date": 1571724335, "post_id": 58497874, "comment_id": 103324889, "body": "Please add more details."}, {"owner": {"reputation": 396, "user_id": 2951059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/306b73823397b4e4e9b511229689f5e0?s=128&d=identicon&r=PG", "display_name": "Garrison", "link": "https://stackoverflow.com/users/2951059/garrison"}, "edited": false, "score": 0, "creation_date": 1571725055, "post_id": 58497874, "comment_id": 103325186, "body": "You can add formatting to your code by wrapping it between ```. It will make it easier to read. Your code is missing a lot of details, so it&#39;s difficult to understand what you are trying to do. Try adding more information, perhaps some example input and output might make it easier for us to answer your question."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1571727392, "post_id": 58497874, "comment_id": 103326246, "body": "It is not really clear to me why you wrote <code>minList</code>, <code>maxList1</code>, etc. as helper functions here."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1571749344, "post_id": 58497874, "comment_id": 103338136, "body": "It isn&#39;t clear what <code>numInMonth</code> is supposed to do, nor why it is relevant to the rest of your code."}], "answers": [{"comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1571748769, "post_id": 58498943, "comment_id": 103337828, "body": "What is <code>count</code>?"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1571758550, "post_id": 58498943, "comment_id": 103343466, "body": "I switched it to <code>length</code>, which is presumably what was intended."}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 0, "last_activity_date": 1571758530, "last_edit_date": 1571758530, "creation_date": 1571728574, "answer_id": 58498943, "question_id": 58497874, "link": "https://stackoverflow.com/questions/58497874/match-month-of-a-list-of-dates/58498943#58498943", "title": "Match month of a list of dates", "body": "<p>Assuming that tuple is a date:</p>\n\n<pre><code>type Day = Int\ntype Month = Int\ntype Year = Int\ntype Date = (Year, Month, Day)\n</code></pre>\n\n<p>We can think about the logic you want with first filtering all the dates that match  the given month, and then counting them:</p>\n\n<pre><code>numInMonth :: [Date] -&gt; Month -&gt; Int\nnumInMonth dates month = length . filter (\\(_, m, _) -&gt; m == month) $ dates\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12128442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/080cfd5e4e2df086423dabe27b6235c5?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/12128442/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1571758530, "creation_date": 1571723885, "last_edit_date": 1571725736, "question_id": 58497874, "link": "https://stackoverflow.com/questions/58497874/match-month-of-a-list-of-dates", "title": "Match month of a list of dates", "body": "<p>I am trying to write a Haskell function that takes a list of dates and a month and returns how many dates in the list match the given month. This is what I have so far and it doesn't seem to be working</p>\n\n<pre><code>numInMonth :: [(Int,Int,Int)] -&gt; Int -&gt; Int\nnumInMonth x [] = x\nnumInMonth x (y:ys)\n\nminList1 (x:xs) = currentMin x xs\n\ncurrentMax :: Int -&gt; [Int] -&gt; Int\ncurrentMax x [] = x\ncurrentMax x (y:ys)\n| x &gt;= y = currentMax x ys\n| otherwise = currentMax y ys\n\nmaxList1 :: [Int] -&gt; Int\nmaxList1 (x:xs) = currentMax x xs\n</code></pre>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1571721805, "post_id": 58497495, "comment_id": 103324151, "body": "Example of yesod with SPA: <a href=\"https://github.com/psibi/yesod-rest\" rel=\"nofollow noreferrer\">github.com/psibi/yesod-rest</a> Note that I use React as the frontend. The code is tailored for pre 1.6 versions of Yesod. But similar concepts still apply."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1571749785, "post_id": 58497495, "comment_id": 103338408, "body": "@Sibi Thanks for the example, but this doesn&#39;t seem to run them as two separate servers as best I can tell? It looks like you&#39;re still doing server side rendering of the initial react page, which doesn&#39;t work with what I&#39;m doing."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1571805209, "post_id": 58497495, "comment_id": 103357645, "body": "Ah, I see what you mean. In that case - you would need sticky sessions. If you are using Nginix, they have an appropriate configuration for that: <a href=\"https://docs.nginx.com/nginx/admin-guide/load-balancer/http-load-balancer/#enabling-session-persistence\" rel=\"nofollow noreferrer\">docs.nginx.com/nginx/admin-guide/load-balancer/&hellip;</a>"}], "owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1571721387, "creation_date": 1571721387, "question_id": 58497495, "link": "https://stackoverflow.com/questions/58497495/combine-yesod-auth-backend-with-spa-front-end", "title": "Combine yesod-auth backend with SPA front end", "body": "<p>I have a simple web app that was previously using servant that I decided to switch over to yesod to power the JSON API. My hope was to use the standard <a href=\"https://hackage.haskell.org/package/yesod-auth-1.6.8/docs/Yesod-Auth.html\" rel=\"nofollow noreferrer\"><code>yesod-auth</code></a> tools for authentication and authorization on this API, but I can't figure out how I can use that authentication scheme without also using yesod to serve my entire site. </p>\n\n<p>For instance, my site runs at<br>\n<a href=\"http://localhost:8080\" rel=\"nofollow noreferrer\">http://localhost:8080</a> for the JS frontend<br>\n<a href=\"http://localhost:3000\" rel=\"nofollow noreferrer\">http://localhost:3000</a> for the yesod backend. </p>\n\n<p>Using the yesod plugins, I get an auto-generated page for logins at <a href=\"http://localhost:3000/auth/login\" rel=\"nofollow noreferrer\">http://localhost:3000/auth/login</a>. This is great and has a convenient \"Login with Oauth2.0 partner\" button that will set the session cookie; however, that cookie is only good for the localhost:3000 site. If I embed the login link in my frontend and redirect to the frontend after authentication, I lose my session cookie. </p>\n\n<p>Is there something simple I'm missing with this? Or does <code>yesod-auth</code> only work with server-side rendered web pages? </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1571708443, "post_id": 58495015, "comment_id": 103321731, "body": "Why Witherable rather than Filterable?"}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1571728927, "post_id": 58495015, "comment_id": 103326968, "body": "There&#39;s also <code>compactable</code>: <a href=\"http://hackage.haskell.org/package/compactable\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/compactable</a>"}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 7, "last_activity_date": 1571697813, "creation_date": 1571697813, "answer_id": 58495015, "question_id": 58494904, "link": "https://stackoverflow.com/questions/58494904/functor-has-map-monad-has-bind-what-has-filter/58495015#58495015", "title": "Functor has map, Monad has bind, what has filter", "body": "<p>Three plausible candidates are <a href=\"http://hackage.haskell.org/package/witherable\" rel=\"noreferrer\">Witherable</a>, <a href=\"https://hackage.haskell.org/package/monadplus-1.4.2/docs/Control-Applicative-Alternative.html\" rel=\"noreferrer\">Alternative</a>, and <a href=\"http://hackage.haskell.org/package/monadplus-1.4.2/docs/Control-Monad-Plus.html\" rel=\"noreferrer\">MonadPlus</a>.</p>\n"}], "owner": {"reputation": 32687, "user_id": 85931, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a6d1f2e792d99695d610498b1170b6c6?s=128&d=identicon&r=PG", "display_name": "tpdi", "link": "https://stackoverflow.com/users/85931/tpdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 58495015, "answer_count": 1, "score": 3, "last_activity_date": 1571697813, "creation_date": 1571697019, "question_id": 58494904, "link": "https://stackoverflow.com/questions/58494904/functor-has-map-monad-has-bind-what-has-filter", "title": "Functor has map, Monad has bind, what has filter", "body": "<p>Functor gives us map (fmap). \nMonad gives us flatmap (bind). </p>\n\n<p>What is the Haskell name for the the typeclass that provides filter?</p>\n"}, {"tags": ["haskell", "types", "bifunctor"], "answers": [{"tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": false, "score": 3, "last_activity_date": 1571694106, "creation_date": 1571694106, "answer_id": 58494490, "question_id": 58494308, "link": "https://stackoverflow.com/questions/58494308/type-signature-mismatch-on-bifunctor-instance-definition/58494490#58494490", "title": "Type Signature Mismatch on Bifunctor instance definition", "body": "<p>The key to this is in the type signature of <code>bimap</code>:</p>\n\n<pre><code>bimap :: Bifunctor p =&gt; (a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d\n</code></pre>\n\n<p>In this particular case, if we specialise <code>p</code> to <code>SemiDrei a</code> and rename the type variables to avoid confusion with that <code>a</code>, we get:</p>\n\n<pre><code>bimap :: (b -&gt; c) -&gt; (d -&gt; e) -&gt; SemiDrei a b d -&gt; SemiDrei a c e\n</code></pre>\n\n<p>So when you attempt to implement this:</p>\n\n<pre><code>bimap f g = ...\n</code></pre>\n\n<p>The functions <code>f</code> and <code>g</code> are completely arbitrary, not just in their implementation, but in their input and return types as well. <code>f</code> has type <code>b -&gt; c</code> where <code>b</code> and <code>c</code> could be absolutely anything - similarly for <code>g</code>. The definition you give has to work for absolutely any types and functions that the caller provides - this is what being (parametrically) polymorphic means.</p>\n\n<p>If we now look at your three definitions in these terms, we can solve the apparent mystery:</p>\n\n<p>First:</p>\n\n<pre><code>bimap f g (SemiDrei a) = SemiDrei a\n</code></pre>\n\n<p>this is completely fine, as you saw. <code>SemiDrei a</code> has type <code>SemiDrei a b c</code>, where only <code>a</code> is specified. That means it can take on any type such as <code>SemiDrei a Int String</code>, or <code>SemiDrei [Bool] (Char, [Double])</code>, or whatever. <code>SemiDrei a</code> is itself polymorphic, it can be of any compatible type. This means that in particular it can act as both the <code>SemiDrei a b c</code> and the <code>SemiDrei a c e</code> in the above signature of <code>bimap</code>.</p>\n\n<p>Contrast with your other attempts:</p>\n\n<pre><code>bimap f g = id\n</code></pre>\n\n<p>The problem here is that <code>id</code>, although polymorphic, is not polymorphic <em>enough</em> for this purpose. Its type is <code>a -&gt; a</code> (for any <code>a</code>), which in particular can be specialised to <code>SemiDrei a b c -&gt; SemiDrei a b c</code>. But it can't possibly be specialised to a type <code>SemiDrei a b d -&gt; SemiDrei a c e</code> as required, because <code>b</code>, <code>c</code>, <code>d</code> and <code>e</code> will in general be completely different types. Recall that the <em>caller</em> of <code>bimap</code> gets to choose what the types are - they can easily choose functions <code>f</code> and <code>g</code> where <code>b</code> and <code>c</code> are different types, for example, and then there is no way <code>id</code> can take a <code>SemiDrei a b d</code> to <code>SemiDrei a c e</code>, because they're different types.</p>\n\n<p>At this stage you may object that the value <code>SemiDrei a</code> can be a value of all such types. That's perfectly true, but it's not relevant for type inference - the compiler only cares about the types, not what values may inhabit them. It has to consider that different types have completely different, non-intersecting, values. And, say, <code>SemiDrei a Int String</code> and <code>SemiDrei a Bool Char</code> are in fact different types. Again, the compiler doesn't know that the <code>Int</code> etc aren't actually used by any of the values of the type. That's indeed exactly why such \"phantom types\" (types which appear in a type definition but not in any of their data constructors) are used in practice - to allow the compiler to be able to differentiate them by type, even though the run-time representation might be completely equivalent.</p>\n\n<p>As for your third attempt, <code>bimap f g x = x</code>, that's exactly the same as the previous one - it constrains <code>bimap f g</code> to have its output type the same as its input. (It's in fact totally equivalent to <code>bimap f g = id</code>.)</p>\n\n<p>So the important takeaway is that, at the type-checking phase, the compiler only cares about types - and two types with different names are (and have to be) considered totally distinct, even though it may be that equivalent values can be embedded in both.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 6, "last_activity_date": 1571695068, "last_edit_date": 1571695068, "creation_date": 1571694239, "answer_id": 58494517, "question_id": 58494308, "link": "https://stackoverflow.com/questions/58494308/type-signature-mismatch-on-bifunctor-instance-definition/58494517#58494517", "title": "Type Signature Mismatch on Bifunctor instance definition", "body": "<p>This shows the same issue in a simpler case:</p>\n\n<pre><code>data T a = K\n\nfoo :: T a -&gt; T b\nfoo K = K  -- type checks\n\nbar :: T a -&gt; T b\nbar x = x  -- type error\n\n-- bar = id would also be a type error, for the same reason\n</code></pre>\n\n<p>The issue here is that the two <code>K</code> in <code>foo</code> values hide their type parameters. A more precise definition would be</p>\n\n<pre><code>-- pseudo code\nfoo (K @a) = K @b\n</code></pre>\n\n<p>Here you can see that the implicit type argument changes. GHC automatically infers those type arguments for us when we write <code>K</code> in the definition of <code>foo</code>. \nSince they are implicit, they <em>look</em> as if they are the same <code>K</code>s, but they are not to the type checker.</p>\n\n<p>Instead, when we use <code>x</code> in the definition of <code>bar</code>, there are no implicit type arguments to infer. We have that <code>x :: T a</code> and that's all. We can not use <code>x</code> and claim that has a different type <code>T b</code>.</p>\n\n<p>Finally, note that using \"safe coercions\" we can perform the intuitively correct kind-of-<code>id</code> which turns one <code>K</code> (in one type) into the other <code>K</code> of the other type:</p>\n\n<pre><code>import Data.Coerce\n\nbaz :: T a -&gt; T b\nbaz = coerce\n</code></pre>\n\n<p>Whether this is better is arguable. For simple cases, pattern matching can be easier to understand than <code>coerce</code>, since the latter can perform a vast array of (safe) coercions, possibly leaving the reader to guess about what's actually happening at the type level.</p>\n"}, {"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 7, "last_activity_date": 1571695924, "last_edit_date": 1571695924, "creation_date": 1571694383, "answer_id": 58494539, "question_id": 58494308, "link": "https://stackoverflow.com/questions/58494308/type-signature-mismatch-on-bifunctor-instance-definition/58494539#58494539", "title": "Type Signature Mismatch on Bifunctor instance definition", "body": "<p>There last argument is not, in fact, yielded unchanged: its type changes. The input is <code>SemiDrei a x y</code> and the output is <code>SemiDrei a p q</code>, where <code>f :: x -&gt; p</code> and <code>g :: y -&gt; q</code>.</p>\n\n<p>This means that you have to deconstruct the value of the original type and reconstruct a value of the new type, which is what you're doing in the original implementation.</p>\n\n<p>But your intuition is correct: the two values do have the same in-memory representation. And GHC can deduce this fact, and when it does, it will automatically solve a <a href=\"https://www.stackage.org/haddock/lts-14.11/base-4.12.0.0/Data-Coerce.html#t:Coercible\" rel=\"noreferrer\"><code>Coercible</code></a> constraint for you, which means that you can use the <code>coerce</code> function to convert one to the other:</p>\n\n<pre><code> bimap _ _ = coerce\n</code></pre>\n"}], "owner": {"reputation": 20427, "user_id": 2570261, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e71068b09fc539447a0cee3e99fc419d?s=128&d=identicon&r=PG&f=1", "display_name": "Haleemur Ali", "link": "https://stackoverflow.com/users/2570261/haleemur-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 58494539, "answer_count": 3, "score": 4, "last_activity_date": 1571695924, "creation_date": 1571692965, "last_edit_date": 1571693450, "question_id": 58494308, "link": "https://stackoverflow.com/questions/58494308/type-signature-mismatch-on-bifunctor-instance-definition", "title": "Type Signature Mismatch on Bifunctor instance definition", "body": "<p>I'm learning about Haskell by working through the book <a href=\"http://haskellbook.com/\" rel=\"nofollow noreferrer\">Haskell Programming from First Principles, Allen &amp; Moronuki</a>.</p>\n\n<p>In the exercises for the chapter on Monad Transformers, Functor &amp; Applicative composition, it asks the reader to write Bifunctor instance for the following type</p>\n\n<pre><code>data SemiDrei a b c = SemiDrei a\n</code></pre>\n\n<p>My first attempt (which compiles) was </p>\n\n<pre><code>instance Bifunctor (SemiDrei a) where\n    bimap f g (SemiDrei a) = SemiDrei a\n</code></pre>\n\n<p>But, looking at it, It seemed to me that I ought to be able to write <code>bimap f g = id</code> because the last argument is yielded unchanged or write <code>bimap f g x = x</code>. Both gave me compile errors, and I'm hoping someone can explain to me why I can't express the <code>bimap</code> with these shorter alternatives, i.e. why do I have to specify <code>(SemiDrei a)</code>.</p>\n\n<p>I ran this on Haskell 8.6.5 (in case that is relevant)</p>\n\n<p><em>attempt: id</em></p>\n\n<pre><code>instance Bifunctor (SemiDrei a) where\n    bimap f g = id\n\n-- compile error message:\n\u2022 Couldn't match type \u2018a1\u2019 with \u2018b\u2019\n  \u2018a1\u2019 is a rigid type variable bound by\n    the type signature for:\n      bimap :: forall a1 b c d.\n               (a1 -&gt; b) -&gt; (c -&gt; d) -&gt; SemiDrei a a1 c -&gt; SemiDrei a b d\n    at src/Main.hs:69:5-9\n  \u2018b\u2019 is a rigid type variable bound by\n    the type signature for:\n      bimap :: forall a1 b c d.\n               (a1 -&gt; b) -&gt; (c -&gt; d) -&gt; SemiDrei a a1 c -&gt; SemiDrei a b d\n    at src/Main.hs:69:5-9\n  Expected type: SemiDrei a a1 c -&gt; SemiDrei a b d\n    Actual type: SemiDrei a b d -&gt; SemiDrei a b d\n\u2022 In the expression: id\n  In an equation for \u2018bimap\u2019: bimap f g = id\n  In the instance declaration for \u2018Bifunctor (SemiDrei a)\u2019\n\u2022 Relevant bindings include\n    f :: a1 -&gt; b (bound at src/Main.hs:69:11)\n    bimap :: (a1 -&gt; b) -&gt; (c -&gt; d) -&gt; SemiDrei a a1 c -&gt; SemiDrei a b d\n      (bound at src/Main.hs:69:5)\n   |\n69 |     bimap f g = id\n   |                 ^^\n</code></pre>\n\n<p><em>attempt: f g x = x</em></p>\n\n<pre><code>instance Bifunctor (SemiDrei a) where\n    bimap f g x = x\n\n-- compile error message:\n\u2022 Couldn't match type \u2018a1\u2019 with \u2018b\u2019\n  \u2018a1\u2019 is a rigid type variable bound by\n    the type signature for:\n      bimap :: forall a1 b c d.\n               (a1 -&gt; b) -&gt; (c -&gt; d) -&gt; SemiDrei a a1 c -&gt; SemiDrei a b d\n    at src/Main.hs:69:5-9\n  \u2018b\u2019 is a rigid type variable bound by\n    the type signature for:\n      bimap :: forall a1 b c d.\n               (a1 -&gt; b) -&gt; (c -&gt; d) -&gt; SemiDrei a a1 c -&gt; SemiDrei a b d\n    at src/Main.hs:69:5-9\n  Expected type: SemiDrei a b d\n    Actual type: SemiDrei a a1 c\n\u2022 In the expression: x\n  In an equation for \u2018bimap\u2019: bimap f g x = x\n  In the instance declaration for \u2018Bifunctor (SemiDrei a)\u2019\n\u2022 Relevant bindings include\n    x :: SemiDrei a a1 c (bound at src/Main.hs:69:15)\n    f :: a1 -&gt; b (bound at src/Main.hs:69:11)\n    bimap :: (a1 -&gt; b) -&gt; (c -&gt; d) -&gt; SemiDrei a a1 c -&gt; SemiDrei a b d\n      (bound at src/Main.hs:69:5)\n   |\n69 |     bimap f g x = x\n   |                   ^\n</code></pre>\n"}, {"tags": ["haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1571684793, "post_id": 58492549, "comment_id": 103315302, "body": "Maybe, write an <code>uncons :: Default a =&gt; [a] -&gt; (a,[a])</code> which defaults to <code>def</code>. Or a defaulting <code>takeWithDef</code>. And/or a view pattern / pattern synonym. This requires writing some auxiliary helper code, though."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1571689472, "post_id": 58492549, "comment_id": 103317148, "body": "@chi I think that&#39;s what I&#39;ll go with. If you make it an answer, I&#39;ll accept it."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1571690271, "post_id": 58492549, "comment_id": 103317469, "body": "For what it&#39;s worth, I think the totality argument for <code>case xs ++ repeat def of a:b:c:d:e:f:_ -&gt; ...</code> is local enough that I wouldn&#39;t think twice about just using it and skipping all the extra machinery the existing answers are introducing. It is generally the more global totality arguments (which involve invariants maintained across multiple function calls, e.g.) that make me nervous."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1571690301, "post_id": 58492549, "comment_id": 103317479, "body": "Actually <code>takeWithDef</code> is not usable if it returns a regular list, since we need to pattern match that :-/ The proper solution is what Daniel wrote below in his second answer. <code>uncons</code> only gets the first element, so it&#39;s not that useful."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 8, "last_activity_date": 1571686072, "creation_date": 1571686072, "answer_id": 58492957, "question_id": 58492549, "link": "https://stackoverflow.com/questions/58492549/how-can-i-use-a-fixed-minimum-length-list-in-a-total-and-elegant-way/58492957#58492957", "title": "How can I use a fixed-minimum-length list in a total and elegant way?", "body": "<p>Using the <a href=\"http://hackage.haskell.org/package/safe\" rel=\"noreferrer\">safe</a> package, you can write, for example:</p>\n\n<pre><code>(!) = atDef def\nfoo xs = foobar (xs ! 0) (xs ! 1) (xs ! 2) (xs ! 3) (xs ! 4) (xs ! 5)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1571688914, "post_id": 58493368, "comment_id": 103316909, "body": "Oh, I like the stream idea a lot. With an infix constructor like <code>data S a = a :- S a; infixr 5 :-</code> it looks quite clean; <code>foo xs = case prepend xs (repeat def) of a:-b:-c:-d:-e:-f:-_ -&gt; foobar a b c d e f</code>."}], "tags": [], "owner": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "is_accepted": false, "score": 6, "last_activity_date": 1571688278, "creation_date": 1571688278, "answer_id": 58493368, "question_id": 58492549, "link": "https://stackoverflow.com/questions/58492549/how-can-i-use-a-fixed-minimum-length-list-in-a-total-and-elegant-way/58493368#58493368", "title": "How can I use a fixed-minimum-length list in a total and elegant way?", "body": "<p>This is at least shorter:</p>\n\n<pre><code>foo (a:b:c:d:e:f:_) = foobar a b c d e f\nfoo xs = foo (xs ++ repeat def)\n</code></pre>\n\n<p>You can easily see that the patterns are exhaustive, but now you have\nto think a bit to see that it always terminates.  So I don't know if\nyou can consider it an improvement.</p>\n\n<p>Otherwise we can do it with the state monad, although it's a bit\nheavyweight:</p>\n\n<pre><code>foo = evalState (foobar &lt;$&gt; pop &lt;*&gt; pop &lt;*&gt; pop &lt;*&gt; pop &lt;*&gt; pop &lt;*&gt; pop)\n  where\n    pop = do xs &lt;- get\n             case xs of [] -&gt; pure def\n                        y:ys -&gt; put ys &gt;&gt; pure y\n</code></pre>\n\n<p>I could also imagine using an infinite stream type like</p>\n\n<pre><code>data S a = S a (S a)\n</code></pre>\n\n<p>because then you could construct <code>foo</code> out of <code>repeat :: a -&gt; S a</code>,\n<code>prepend :: [a] -&gt; S a -&gt; S a</code>, and <code>take6 :: S a -&gt; (a,a,a,a,a,a)</code>,\nall of which could be total.  Probably not worth it if you don't\nalready have such a type handy.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1571690389, "post_id": 58493739, "comment_id": 103317523, "body": "This is my preferred approach so far. I&#39;d probably use a view pattern to complement it. (Why the &quot;not recommended&quot;? What are the cons?)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1571690537, "post_id": 58493739, "comment_id": 103317579, "body": "It embodies exactly what starts going wrong when you invest heavily in type-level programming: what was a one-line, instantly-understandable program balloons out into ten lines that require the reader to seriously engage their mental type-inference engine."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1571692836, "post_id": 58493739, "comment_id": 103318379, "body": "I see your point. I count <code>foo (takeDef -&gt; a:-b:-c:-d:-e:-f:-Nil) -&gt; foobar a b c d e f</code> as one line. I don&#39;t count the rest since it is code which should be in some library, for reuse. If it has to be written only for this case, it&#39;s clearly overkill as you say."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 4, "last_activity_date": 1571690380, "last_edit_date": 1571690380, "creation_date": 1571689942, "answer_id": 58493739, "question_id": 58492549, "link": "https://stackoverflow.com/questions/58492549/how-can-i-use-a-fixed-minimum-length-list-in-a-total-and-elegant-way/58493739#58493739", "title": "How can I use a fixed-minimum-length list in a total and elegant way?", "body": "<p>Just for fun (and not recommended, this is for funsies), here's another way:</p>\n\n<pre><code>import Data.Default\n\ndata Cons f a = a :- f a\ninfixr 5 :-\n\ndata Nil a = Nil -- or use Proxy\n\nclass TakeDef f where takeDef :: Default a =&gt; [a] -&gt; f a\ninstance TakeDef Nil where takeDef _ = Nil\ninstance TakeDef f =&gt; TakeDef (Cons f) where\n    takeDef (x:xs) = x :- takeDef xs\n    takeDef xs = def :- takeDef xs\n\nfoo xs = case takeDef xs of\n    a:-b:-c:-d:-e:-f:-Nil -&gt; foobar a b c d e f\n</code></pre>\n\n<p>The type that you use in the pattern match amounts to passing a type-level natural to <code>takeDef</code> saying how many elements to look at.</p>\n"}], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 1, "answer_count": 3, "score": 10, "last_activity_date": 1571724918, "creation_date": 1571684144, "question_id": 58492549, "link": "https://stackoverflow.com/questions/58492549/how-can-i-use-a-fixed-minimum-length-list-in-a-total-and-elegant-way", "title": "How can I use a fixed-minimum-length list in a total and elegant way?", "body": "<p>I'm currently dealing with a function that goes like this:</p>\n\n<pre><code>foo = (\\(a:b:c:d:e:f:_) -&gt; foobar a b c d e f) . (++ repeat def)\n</code></pre>\n\n<p>In other words, given a list, it uses the first six elements for something, and if the list is less than six elements long, it uses <code>def</code> as a stand-in for the missing ones. This is total, but the pieces of it aren't (just like <code>map fromJust . filter isJust</code>), so I don't like it. I tried to rewrite this so that it doesn't need to use any partiality, and got this:</p>\n\n<pre><code>foo [] = foobar def def def def def def\nfoo [a] = foobar a def def def def def\nfoo [a,b] = foobar a b def def def def\nfoo [a,b,c] = foobar a b c def def def\nfoo [a,b,c,d] = foobar a b c d def def\nfoo [a,b,c,d,e] = foobar a b c d e def\nfoo (a:b:c:d:e:f:_) = foobar a b c d e f\n</code></pre>\n\n<p>I technically did what I want, but now this is a gigantic mess. How can I do this in a more elegant and less repetitive way?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1571663448, "post_id": 58487027, "comment_id": 103304735, "body": "Please do <i>not</i> indent the part under the signature."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 4, "last_activity_date": 1571663530, "creation_date": 1571663530, "answer_id": 58487059, "question_id": 58487027, "link": "https://stackoverflow.com/questions/58487027/how-to-fix-indentation-haskell-parse-error-on-input/58487059#58487059", "title": "How to fix indentation? Haskell: parse error on input `|&#39;", "body": "<p>You should not indent the part below the signature. Just write this as:</p>\n\n<pre><code>validateCipher ::  Cipher -&gt; Bool\nvalidateCipher \"\" = False\nvalidateCipher (x:xs)\n    | x == 'a' = True\n    | otherwise = validateCipher xs</code></pre>\n\n<p>or you can just check this with:</p>\n\n<pre><code>validateCipher :: Cipher -&gt; Bool\nvalidateCipher = elem 'a'</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 6, "last_activity_date": 1571674833, "last_edit_date": 1571674833, "creation_date": 1571666497, "answer_id": 58487927, "question_id": 58487027, "link": "https://stackoverflow.com/questions/58487027/how-to-fix-indentation-haskell-parse-error-on-input/58487927#58487927", "title": "How to fix indentation? Haskell: parse error on input `|&#39;", "body": "<p>When you indent the first line of the definition, the parser (in this context) thinks you are continuing the previous line, as if you had written</p>\n\n<pre><code>validateCipher :: Cipher -&gt; Bool validateCipher \"\" = False -- etc\n</code></pre>\n\n<p>This becomes obvious with a simpler definition</p>\n\n<pre><code>validateCipher :: String -&gt; Bool\n  validateCipher _ = True\n</code></pre>\n\n<p>because the parser is able to accept this. The resulting placement of the type signature, though, is invalid.</p>\n\n<pre><code>&lt;interactive&gt;:11:1: error:\n    Illegal type signature: \u2018String -&gt; Bool validateCipher _\u2019\n      Type signatures are only allowed in patterns with ScopedTypeVariables\n</code></pre>\n\n<p>(I suspect that, if the <code>ScopedTypeVariables</code> extension did not exist, you would get a more generic parser error on the <code>=</code>. )</p>\n\n<p>In your actual definition, the parser continues trying to parse a type signature, and doesn't run into a <em>syntactic</em> problem until it sees the <code>|</code>.</p>\n\n<p>The solution is to not indent the definition:</p>\n\n<pre><code>validateCipher ::  Cipher -&gt; Bool\nvalidateCipher \"\" = False\nvalidateCipher (x:xs) \n  | x == 'a' = True\n  | otherwise = validateCipher xs\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6845164, "user_type": "registered", "profile_image": "https://graph.facebook.com/1017292374974769/picture?type=large", "display_name": "Dimitar Tonchev", "link": "https://stackoverflow.com/users/6845164/dimitar-tonchev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 58487927, "answer_count": 2, "score": 0, "last_activity_date": 1571674833, "creation_date": 1571663409, "question_id": 58487027, "link": "https://stackoverflow.com/questions/58487027/how-to-fix-indentation-haskell-parse-error-on-input", "title": "How to fix indentation? Haskell: parse error on input `|&#39;", "body": "<p>So I am getting the error:</p>\n\n<pre><code>error:\nparse error on input `|'\n\n   | x == 'a' = True\n</code></pre>\n\n<p>The code itself is:</p>\n\n<pre><code>module SubstitutionCiphers where\nimport AssignmentHelp.Cipher\n\nvalidateCipher ::  Cipher -&gt; Boolean\n  validateCipher \"\" = False\n  validateCipher (x:xs) \n    | x == 'a' = True\n    | otherwise = validateCipher xs\n</code></pre>\n\n<p>I tried alternating the indentation in various different ways but nothing seems to work. I guess it is still an indentation problem, but I have no clue how to fix it.</p>\n"}, {"tags": ["haskell", "websocket"], "answers": [{"tags": [], "owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "is_accepted": false, "score": 1, "last_activity_date": 1571673642, "creation_date": 1571673642, "answer_id": 58490039, "question_id": 58485216, "link": "https://stackoverflow.com/questions/58485216/reconnect-web-socket-haskell/58490039#58490039", "title": "Reconnect web socket [Haskell]", "body": "<p>How to \"retry\" is protocol dependent. If you literally just want to retry from start when there's a connection failure you could just do</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\nimport Control.Exception (catch)\n\n-- ...\n-- the rest of your code\n-- ...\n\nretryOnFailure ws = runSecureClient \"ws.kraken.com\" 443 \"/\" ws\n  `catch` (\\e -&gt; \n     if e == ConnectionClosed\n     then retryOnFailure ws\n     else return ())\n</code></pre>\n\n<p>but note that this is a \"dumb\" retry in that it'll literally just start over from scratch if the remote connection is closed unexpectedly (expected closes will lead to the program ending). If you want to maintain any sort of state or anything like that you'll have to figure out how to do that for whatever protocol you're following, but this should be enough if you're just listening for data over some flaky connection.</p>\n"}], "owner": {"reputation": 1083, "user_id": 5272159, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bee102cff2130800106cdd7d99db787e?s=128&d=identicon&r=PG&f=1", "display_name": "timothyylim", "link": "https://stackoverflow.com/users/5272159/timothyylim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571673642, "creation_date": 1571656818, "question_id": 58485216, "link": "https://stackoverflow.com/questions/58485216/reconnect-web-socket-haskell", "title": "Reconnect web socket [Haskell]", "body": "<p>I am using the <code>wuss</code> library ( a wrapper around <code>websockets</code>) to create a websocket connection. How would one create loop to reconnect if for whatever reason the web socket disconnects?</p>\n\n<pre><code>ws :: ClientApp ()\nws connection = do\n    putStrLn \"Connected!\"\n\n    sendTextData connection msgSubscribe -- defined elsewhere\n\n    let loop = do \n        message &lt;- receiveData connection\n        print (message)\n        loop\n\n    loop\n    sendClose connection (pack \"Bye!\")\n\nmain :: IO ()\nmain = runSecureClient \"ws.kraken.com\" 443 \"/\" ws -- retry at this point?\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 3, "creation_date": 1571661668, "post_id": 58485062, "comment_id": 103303739, "body": "Basically <code>fmap print (print &quot;Hello World&quot;)</code> applies it&#39;s first parameter, the <code>print</code> function, to the result of <code>print &quot;Hello World&quot;</code>. That&#39;s simply the equivalent of invoking <code>print ()</code> after <code>print &quot;Hello World&quot;</code> action is performed."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 1, "creation_date": 1571784320, "post_id": 58485062, "comment_id": 103353696, "body": "@Redu That is correct, but note that the invocation of <code>print ()</code> never gets evaluated, nor its action performed (which would print <code>()</code> on stdout). So, &quot;invoking <code>print ()</code> after ...&quot; is a bit misleading (IMO)."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 5, "creation_date": 1571657049, "post_id": 58485253, "comment_id": 103301363, "body": "I&#39;d add that <code>f &lt;$&gt; a \u2261 a &gt;&gt;= \\r -&gt; return $ f r</code> is not just a specific thing to this situation, but actually holds for any monad."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 21, "last_activity_date": 1571657091, "last_edit_date": 1571657091, "creation_date": 1571656920, "answer_id": 58485253, "question_id": 58485062, "link": "https://stackoverflow.com/questions/58485062/why-does-print-print-hello-print-hello/58485253#58485253", "title": "Why does `print &lt;$&gt; (print &quot;hello&quot;)` print &quot;hello&quot;?", "body": "<pre><code>main :: IO (IO ())\nmain = print &lt;$&gt; (print \"Hello, World!\")\n</code></pre>\n\n<p>is equivalent, thanks to the monad laws, to</p>\n\n<pre><code>main :: IO (IO ())\nmain = do \n   result &lt;- print \"Hello, World!\"\n   return (print result)\n</code></pre>\n\n<p>Now, <code>print</code> always returns <code>()</code> as result, so the whole code is equivalent to</p>\n\n<pre><code>main :: IO (IO ())\nmain = do \n   _ &lt;- print \"Hello, World!\"\n   return (print ())\n</code></pre>\n\n<p>Finally, the result of <code>main</code> is simply discarded. That is, the last line could be <code>return (putStrLn \"this is ignored\")</code> and have the same effect.</p>\n\n<p>Hence the code will only execute the first <code>print \"Hello, World!\"</code>.</p>\n\n<p>I would recommend that you always define <code>main :: IO ()</code>. Haskell allows us to declare <code>main :: IO AnyTypeHere</code>, but this is (IMO) confusing.</p>\n\n<p>I would also recommend you use <code>putStrLn</code>, and not <code>print</code> to print strings, since the latter will quote and escape the whole string.</p>\n"}], "owner": {"reputation": 211, "user_id": 12247319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47823af926ab4adf84cc759c26593070?s=128&d=identicon&r=PG&f=1", "display_name": "q e x y", "link": "https://stackoverflow.com/users/12247319/q-e-x-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 0, "answer_count": 1, "score": 14, "last_activity_date": 1573107107, "creation_date": 1571656231, "last_edit_date": 1571662079, "question_id": 58485062, "link": "https://stackoverflow.com/questions/58485062/why-does-print-print-hello-print-hello", "title": "Why does `print &lt;$&gt; (print &quot;hello&quot;)` print &quot;hello&quot;?", "body": "<p>When calculating <code>IO (IO ())</code>, both <code>(IO ())</code> and <code>()</code> is calculated, so why</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>main :: IO (IO ())\nmain = print &lt;$&gt; (print \"Hello, World!\")\n</code></pre>\n\n<p>print</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>\"Hello, World!\"\n</code></pre>\n\n<p>not</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>IO \"Hello, World!\" -- ??\n\"Hello, World!\"\n</code></pre>\n"}, {"tags": ["bash", "docker", "haskell", "docker-compose", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 3873750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89314858e8d627f2e647a68e6cd2f0ed?s=128&d=identicon&r=PG&f=1", "display_name": "theobat", "link": "https://stackoverflow.com/users/3873750/theobat"}, "is_accepted": false, "score": 0, "last_activity_date": 1571834316, "last_edit_date": 1571834316, "creation_date": 1571830317, "answer_id": 58521901, "question_id": 58482221, "link": "https://stackoverflow.com/questions/58482221/how-to-fix-stdin-hgetline-end-of-file-when-running-stack-build-file-watc/58521901#58521901", "title": "How to fix &quot;&lt;stdin&gt;: hGetLine: end of file&quot; when running stack build --file-watch in a docker-compose command", "body": "<p><strike>A simple workaround for my issue is to pipe cat to the stack build --file-watch.\nI got inspired by this thread on stack exchange: <a href=\"https://unix.stackexchange.com/a/103893\">https://unix.stackexchange.com/a/103893</a>.</p>\n\n<p>Thus replacing <code>stack build --verbose --file-watch</code> by <code>cat | stack build --verbose --file-watch</code>works like a charm. I do feel like this is not \"normal\" to some extent but whatever...</strike></p>\n\n<p>The thing that made it work is actually the stdin_open: true option in the docker-compose.yml, piping the <code>cat</code> command didn't do anything...</p>\n"}], "owner": {"reputation": 41, "user_id": 3873750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89314858e8d627f2e647a68e6cd2f0ed?s=128&d=identicon&r=PG&f=1", "display_name": "theobat", "link": "https://stackoverflow.com/users/3873750/theobat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 276, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1571834316, "creation_date": 1571645347, "question_id": 58482221, "link": "https://stackoverflow.com/questions/58482221/how-to-fix-stdin-hgetline-end-of-file-when-running-stack-build-file-watc", "title": "How to fix &quot;&lt;stdin&gt;: hGetLine: end of file&quot; when running stack build --file-watch in a docker-compose command", "body": "<p>I try to have an auto rebuild &amp; rexecute setup for my haskell RPC server code within a docker-compose service. The command is a bash script with <code>stack build --file-watch</code> (and another command to start the binary when it changes but this works). The problem is that, no matter what I try, the <code>stack build --file-watch</code> command fails with a cryptic error <code>&lt;stdin&gt;: hGetLine: end of file</code>.</p>\n\n<p>I do not understand why I get this error, especially because if I run the same command using <code>docker-compose run bd-service bash -l -c \"./bd-service/compile_hs_and_run.sh\"</code>, it works as expected. I believe it's a problem of how bash is handled when docker-compose up is executed rather than a problem of stack itself, but I'll admit I'm clueless.</p>\n\n<p>Also note that:</p>\n\n<ul>\n<li>removing the --file-watch option makes the script working</li>\n<li>replacing the --file-watch with --file-watch-poll does not change anything</li>\n</ul>\n\n<p>This is the service definition:</p>\n\n<pre><code>  # this is my service definition in docker-compose.yml\n  bd-service:\n    build:\n      context: '.'\n      dockerfile: 'dockerfiles/bd_heroku_service.Dockerfile'\n      args:\n        UID: \"$UID\"\n    command:  bash -l -c \"./bd-service/compile_hs_and_run.sh\"\n    user: \"$UID\"\n    volumes:\n      - .:/app/user\n\n</code></pre>\n\n<p>This is the relevant dockerfile:</p>\n\n<pre><code># Inherit from bd_heroku_node image\nFROM bd_heroku_node\n\nENV LANG en_US.UTF-8\n# Stack stores binaries in /root/.local/bin\nENV PATH /root/.local/bin:$PATH\n\n# Heroku assumes we'll put everything in /app/user\nRUN mkdir -p /app/user/bd-service\nWORKDIR /app/user\n\nUSER root\n\nARG STACK_VERSION=2.1.3\nRUN wget -qO- https://github.com/commercialhaskell/stack/releases/download/v$STACK_VERSION/stack-$STACK_VERSION-linux-x86_64.tar.gz | tar xz --wildcards --strip-components=1 -C /usr/local/bin '*/stack'\nUSER appuser\n# . here means the entire bd-bootstrap repo, context should be set accordingly (to bd-bootstrap)\nRUN stack setup --resolver lts-14.10;\n\nUSER appuser\nRUN mkdir -p /app/user/bd-common\nRUN mkdir -p /app/user/bd-service\n\nCOPY bd-common/*.yaml /app/user/bd-common/\n\nRUN cd /app/user/bd-common; stack build --only-dependencies;\n\nRUN stack install fswatcher;\n</code></pre>\n\n<p>And then my bash file compile_hs_and_run:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>#! /bin/bash\nDIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" &amp;&amp; pwd )\"\n\ncd $DIR\necho \"We are at \"\npwd\necho \"start\";\n\nstack build --verbose --file-watch\n\n# The next command is commented because it works :\n# /app/.local/bin/fswatcher --path /app/user/bd-service/.stack-work/install stack run bd-service-exe &amp;\n\n\necho \"it's over\"\n\n</code></pre>\n\n<p>When starting with <code>docker-compose up bd-service</code> it fails with these logs:</p>\n\n<pre><code>bd-service_1       | We are at \nbd-service_1       | /app/user/bd-service\nbd-service_1       | start\nbd-service_1       | Version 2.1.3, Git revision 0fa51b9925decd937e4a993ad90cb686f88fa282 (7739 commits) x86_64 hpack-0.31.2\nbd-service_1       | 2019-10-21 07:23:02.631167: [debug] Checking for project config at: /app/user/bd-service/stack.yaml\nbd-service_1       | 2019-10-21 07:23:02.634794: [debug] Loading project config file stack.yaml\nbd-service_1       | 2019-10-21 07:23:02.641395: [error] &lt;stdin&gt;: hGetLine: end of file\nbd-service_1       | it's over\n</code></pre>\n"}, {"tags": ["haskell", "bitwise-operators"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1571663228, "post_id": 58481565, "comment_id": 103304570, "body": "I wonder if GHC optimizes <code>mod 2</code> to a bitshift when appropriate?"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 12, "last_activity_date": 1571642901, "creation_date": 1571642901, "answer_id": 58481625, "question_id": 58481565, "link": "https://stackoverflow.com/questions/58481565/how-to-test-if-a-number-is-a-power-of-2/58481625#58481625", "title": "How to test if a number is a power of 2?", "body": "<p>Haskell has bitwise operations, but these have a slightly different name. Indeed, you can make a bitwise AND with the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Bits.html#v:.-38-.\" rel=\"noreferrer\"><strong><code>(.&amp;.) :: Bits a =&gt; a -&gt; a -&gt; a</code></strong></a> function.</p>\n\n<p>You thus can make such check with:</p>\n\n<pre><code>import Data.Bits(Bits, (.&.))\n\nisPower2 :: (Bits i, Integral i) =&gt; i -&gt; Bool\nisPower2 n = n .&. (n-1) == 0</code></pre>\n\n<p>Note that your proposed solution will include zero as a power of two as well. Indeed, if we evaluate the first 1'000 numbers, we get:</p>\n\n<pre><code>Prelude Data.Bits&gt; filter isPower2 [0 .. 1000]\n[0,1,2,4,8,16,32,64,128,256,512]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 132, "user_id": 12069869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3cadaa1f2741949137404bffc50711?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleRainbowZ", "link": "https://stackoverflow.com/users/12069869/doublerainbowz"}, "edited": false, "score": 0, "creation_date": 1571653699, "post_id": 58484024, "comment_id": 103299810, "body": "Would you mind explaining the code a bit please - sorry I am not very good at haskell and it looks like some high level stuff. I am mostly confused about the (RealFrac b, Floating b) bit and the 2nd line has some syntax I haven&#39;t seen before"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 132, "user_id": 12069869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3cadaa1f2741949137404bffc50711?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleRainbowZ", "link": "https://stackoverflow.com/users/12069869/doublerainbowz"}, "edited": false, "score": 0, "creation_date": 1571655362, "post_id": 58484024, "comment_id": 103300544, "body": "@DoubleRainbowZ I have edited my answer to include some explanation. It&#39;s basically very simple code if you know the Applicative functors. I have attached a link at the bottom for further guidance."}, {"owner": {"reputation": 132, "user_id": 12069869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3cadaa1f2741949137404bffc50711?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleRainbowZ", "link": "https://stackoverflow.com/users/12069869/doublerainbowz"}, "edited": false, "score": 1, "creation_date": 1571656761, "post_id": 58484024, "comment_id": 103301225, "body": "Great, thanks a lot, that definitely helps a lot :)"}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 3, "last_activity_date": 1571655642, "last_edit_date": 1571655642, "creation_date": 1571652385, "answer_id": 58484024, "question_id": 58481565, "link": "https://stackoverflow.com/questions/58481565/how-to-test-if-a-number-is-a-power-of-2/58484024#58484024", "title": "How to test if a number is a power of 2?", "body": "<p>One other way to do this would be to use the <code>logBase</code> function with base <code>2</code>.</p>\n\n<pre><code>isPot :: (RealFrac b, Floating b) =&gt; b -&gt; Bool\nisPot = ((==) &lt;*&gt; (fromInteger . round)) . logBase 2\n\nPrelude&gt; isPot 2048\nTrue\nPrelude&gt; isPot 1023\nFalse\nPrelude&gt; isPot 1\nTrue\n</code></pre>\n\n<p><strong>Edit:</strong>\nOK before evaluating the code lets get the math behind it. The idea is simple. Any number which can be expressed as power of two means it's logarithm with respect to base 2 (<code>logBase 2</code>) is a whole number.</p>\n\n<p>Accordingly we will use the <code>logBase 2</code> function. If we check it's type</p>\n\n<pre><code>Prelude&gt; :t logBase 2\nlogBase 2 :: Floating a =&gt; a -&gt; a\n</code></pre>\n\n<p>we see that the input number should be a member of the <code>Floating</code> type class. The <code>logBase 2</code> function gets composed with the previous function which is;</p>\n\n<pre><code>(==) &lt;*&gt; (fromInteger . round)\n</code></pre>\n\n<p>Now if we forget about the applicative operator <code>&lt;*&gt;</code> this can be rephrased as </p>\n\n<pre><code>\\n -&gt; n == (fromInteger. round) n\n</code></pre>\n\n<p>Now if we check the type of <code>round</code> function</p>\n\n<pre><code>Prelude&gt; :t round\nround :: (RealFrac a, Integral b) =&gt; a -&gt; b\n</code></pre>\n\n<p>we see that the input also needs to be a member of <code>RealFrac</code> type class hence the <code>(RealFrac b, Floating b) =&gt;</code> constraint in the type declaration of the <code>isPot</code> function.</p>\n\n<p>Now regarding applicative operator <code>&lt;*&gt;</code>, it's actually very handy when you have a two parameter function such as <code>(==)</code> and need to feed the left (first parameter) with <code>x</code> and right with <code>g x</code>. In other words <code>f &lt;*&gt; g = \\x -&gt; f x (g x)</code>. The type signature of <code>&lt;*&gt;</code> is</p>\n\n<pre><code>Prelude&gt; :t (&lt;*&gt;)\n(&lt;*&gt;) :: Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>I would advise you to read the <a href=\"http://learnyouahaskell.com/functors-applicative-functors-and-monoids#monoids\" rel=\"nofollow noreferrer\">Functors, Applicative Functors and Monoids</a> part of the Learn You a Haskell book.</p>\n"}], "owner": {"reputation": 132, "user_id": 12069869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3cadaa1f2741949137404bffc50711?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleRainbowZ", "link": "https://stackoverflow.com/users/12069869/doublerainbowz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 711, "favorite_count": 0, "accepted_answer_id": 58481625, "answer_count": 2, "score": 5, "last_activity_date": 1571666917, "creation_date": 1571642653, "last_edit_date": 1571666917, "question_id": 58481565, "link": "https://stackoverflow.com/questions/58481565/how-to-test-if-a-number-is-a-power-of-2", "title": "How to test if a number is a power of 2?", "body": "<p>I want to do a simple test for if a number is a power of 2 in Haskell for a case guard I am making.</p>\n\n<p>The purpose is to determine whether a number is even (and not a power of 2), whether a number is odd, or whether a number is to the power of 2.</p>\n\n<p>I want to do something like:</p>\n\n<pre><code>function n\n  | n `mod` 2 == 1 = 1\n  | if n is to the power of 2 = 2\n  | otherwise = 0\n</code></pre>\n\n<p>I have looked at some threads but they all say to use the bitwise operator: </p>\n\n<pre><code>(n &amp; (n - 1)) == 0\n</code></pre>\n\n<p>However it says</p>\n\n<blockquote>\n  <p>Not in scope: \u2018&amp;\u2019</p>\n</blockquote>\n\n<p>when I try to do so, so am not sure if that is allowed in Haskell.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1571625114, "post_id": 58479083, "comment_id": 103290435, "body": "Good answer, but it can be made a bit tidier by consolidating the last two cases to <code>trace (dir:dirs) (BNode x left right) = trace dirs $ case dir of {Lft -&gt; left; Rght -&gt; right}</code> (of course we&#39;d use whitespace instead of braces in a real source file)"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1571625172, "post_id": 58479083, "comment_id": 103290450, "body": "@amalloy I judged that to be way too advanced for an absolute novice"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1571626279, "post_id": 58479083, "comment_id": 103290606, "body": "I think it&#39;s pretty close to what chen was trying to write already, but mistakenly using <code>if</code> instead of <code>case</code>."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 53, "user_id": 7180149, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gY7w4P7PhUk/AAAAAAAAAAI/AAAAAAAAABM/zvnUk_iNJGQ/photo.jpg?sz=128", "display_name": "chen Crush", "link": "https://stackoverflow.com/users/7180149/chen-crush"}, "edited": false, "score": 0, "creation_date": 1571627665, "post_id": 58479083, "comment_id": 103290816, "body": "@chenCrush if my answer helped you, would you consider accepting it? You can do that by clicking the checkmark to the left of the answer."}, {"owner": {"reputation": 53, "user_id": 7180149, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gY7w4P7PhUk/AAAAAAAAAAI/AAAAAAAAABM/zvnUk_iNJGQ/photo.jpg?sz=128", "display_name": "chen Crush", "link": "https://stackoverflow.com/users/7180149/chen-crush"}, "edited": false, "score": 0, "creation_date": 1571629622, "post_id": 58479083, "comment_id": 103291156, "body": "Thanks again for helping me. I clicked the checkmark"}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 5, "last_activity_date": 1571624808, "creation_date": 1571624808, "answer_id": 58479083, "question_id": 58479037, "link": "https://stackoverflow.com/questions/58479037/find-subtree-by-given-trace-hakell/58479083#58479083", "title": "find subtree by given trace Hakell", "body": "<p>Operator <code>==</code> is a member of <a href=\"https://www.stackage.org/haddock/lts-14.11/base-4.12.0.0/Prelude.html#t:Eq\" rel=\"noreferrer\">type class <code>Eq</code></a>, so if you want to use operator <code>==</code> on your <code>Dir</code> type, you have to derive the <code>Eq</code> type class for it:</p>\n\n<pre><code>data Dir = Lft | Rght deriving Eq\n</code></pre>\n\n<p>However, a better way would be to use pattern matching instead of comparing with <code>==</code>:</p>\n\n<pre><code>trace  p Empty =  Empty \ntrace [] a =  a \ntrace (Lft:xs) (BNode _ left _) = trace xs left \ntrace (Rght:xs) (BNode _ _ right) = trace xs right\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7180149, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gY7w4P7PhUk/AAAAAAAAAAI/AAAAAAAAABM/zvnUk_iNJGQ/photo.jpg?sz=128", "display_name": "chen Crush", "link": "https://stackoverflow.com/users/7180149/chen-crush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 1, "accepted_answer_id": 58479083, "answer_count": 1, "score": 2, "last_activity_date": 1571624808, "creation_date": 1571624269, "last_edit_date": 1571624632, "question_id": 58479037, "link": "https://stackoverflow.com/questions/58479037/find-subtree-by-given-trace-hakell", "title": "find subtree by given trace Hakell", "body": "<p>I am stock on this problem. \nThe problem is Write a haskell function trace (including the type declaration line in your answer), which will\ntake a Path p and a BTree as input, returns the subtree that you arrive at by tracing the path in\ntree.\nNote that (trace p Empty) should always return Empty.\nHere is my solution so far </p>\n\n<pre><code>data BTree a = Empty \n             | BNode a ( BTree a ) ( BTree a ) deriving (Show)\ndata Dir = Lft |Rght\ntype Path = [Dir]\n\ntree = BNode 1 (  BNode 2 (BNode 4 (Empty) (Empty)) (BNode 5 (Empty) (Empty)) ) ( BNode 3 Empty Empty)\n\ntree1 = BNode 1 (  BNode 2 (BNode 4 (Empty) (Empty)) (BNode 5 (Empty) (Empty)) ) (  BNode 2 (BNode 4 (Empty) (Empty)) (BNode 5 (BNode 3 Empty Empty) (Empty)) )\n\n-- 1.\ntrace :: Path -&gt; BTree a -&gt; BTree a\ntrace  p Empty =  Empty \ntrace [] a =  a \ntrace  (x:xs) (BNode b left right) = if x == Lft then trace xs left else trace xs right\n</code></pre>\n\n<p>then i got  </p>\n\n<pre><code>No instance for (Eq Dir) arising from a use of \u2018==\u2019\n\n    \u2022 In the expression: x == Lft\n      In the expression:\n        if x == Lft then trace xs left else trace xs right\n      In an equation for \u2018trace\u2019:\n          trace (x : xs) (BNode b left right)\n            = if x == Lft then trace xs left else trace xs right\n   |\n14 | trace  (x:xs) (BNode b left right) = if x == Lft then trace xs left else trace xs right\n   |                                         ^^^^^^^^\n</code></pre>\n"}, {"tags": ["haskell", "monads", "monad-transformers"], "comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 2, "creation_date": 1571589718, "post_id": 58474946, "comment_id": 103283250, "body": "Yes, the <code>State</code> type constructor doesn&#39;t exist anymore. Instead you use the <code>state</code> function which resides in the <code>MonadState</code> type class. For more check <a href=\"http://hackage.haskell.org/package/mtl-2.2.2/docs/Control-Monad-State-Lazy.html\" rel=\"nofollow noreferrer\">Control.Monad.State.Lazy</a>"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1571651754, "post_id": 58474946, "comment_id": 103298901, "body": "You say that you were told the state monad \u201cdoesn\u2019t exist any more\u201d. I think it\u2019s worth pointing out that this isn\u2019t entirely correct. <code>State</code> as a standalone monad doesn\u2019t exist any more, but a <code>State</code> monad still exists; however, it\u2019s defined in terms of another <code>StateT</code> monad instead of being implemented as a separate monad of its own. This new state monad lives in the <code>Control.Monad.Trans.State</code> module, in the <code>transformers</code> library. <b>EDIT:</b> I\u2019ve just noticed you are already aware of <code>Control.Monad.Trans.State</code> \u2014 sorry for the redundant comment!"}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1571600306, "post_id": 58475157, "comment_id": 103285901, "body": "Might be worth pointing out explicitly that under the monad transformer definition, <code>runState</code> is, rather than a field name in a specific <code>State</code> type, just a function defined as <code>\\m -&gt; runIdentity . runStateT m</code>, to hide the necessary unwrapping of the <code>Identity</code> value that <code>StateT</code> produces."}, {"owner": {"reputation": 4173, "user_id": 593975, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f9550b19b4c3f1dc5b72ae7c4123d817?s=128&d=identicon&r=PG", "display_name": "guthrie", "link": "https://stackoverflow.com/users/593975/guthrie"}, "edited": false, "score": 0, "creation_date": 1602015461, "post_id": 58475157, "comment_id": 113584975, "body": "love your little mapM runstate example!"}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 13, "last_activity_date": 1571596687, "last_edit_date": 1571596687, "creation_date": 1571589941, "answer_id": 58475157, "question_id": 58474946, "link": "https://stackoverflow.com/questions/58474946/where-is-state-monad-in-haskell-and-how-can-i-use-it/58475157#58475157", "title": "Where is State Monad in Haskell, and how can I use it?", "body": "<blockquote>\n  <p>I get Ambiguous occurrence</p>\n</blockquote>\n\n<p>Really, let's try the code you posted..</p>\n\n<pre><code>cat &lt;&lt;EOF &gt;umi.hs\nimport Data.Functor.Identity\nimport Control.Monad.Trans.State\n\ntype State s = StateT s Identity\nEOF\nghci umi.hs\n</code></pre>\n\n<p>We get </p>\n\n<pre><code>Ok, one module loaded.\n</code></pre>\n\n<p>So that's actually fine.  I suspect you have more code that tries to use <code>State</code> but it is ambiguous because you have imported a <code>State</code> and do not need to define your own <code>State</code> type.</p>\n\n<blockquote>\n  <p>When I tried :t State, I find nothing. This is self-contradictory</p>\n</blockquote>\n\n<p>When you try <code>:t State</code> you get more than nothing, you get:</p>\n\n<pre><code>:t State\n\n&lt;interactive&gt;:1:1: error:\n    \u2022 Data constructor not in scope: State\n</code></pre>\n\n<p>Read that carefully, it says \"Data constructor\" not \"type\" or \"type constructor\".  You can't check the type of a type (<code>:t</code> is short of <code>:type</code>).  You can, however, use info:</p>\n\n<pre><code>&gt; :i State\ntype Control.Monad.Trans.State.State s =\n  StateT s Identity :: * -&gt; *\n        -- Defined in \u2018Control.Monad.Trans.State.Lazy\u2019\n\ntype Main.State s = StateT s Identity :: * -&gt; *\n        -- Defined at umi.hs:4:5\n</code></pre>\n\n<p>So you see, your (<code>Main</code>s) type alias is redundant of the type alias you imported from <code>Control.Monad.Trans.State</code>.  Solution? Just don't define your type alias.</p>\n\n<p>EDIT: The above was intended to clear up some misunderstandings.  Answering your actual questions here.</p>\n\n<blockquote>\n  <p>Where is state monad</p>\n</blockquote>\n\n<p>There are many State monads defined in Haskell libraries.  The most popular one is in <code>Control.Monad.Trans.State</code> from the <code>transformers</code> package which you have already found.  There's also a the <code>monadlib</code> version of State, and the entirely different <code>MonadState</code> class (in the <code>mtl</code> package) which is a pair of get and set operations for any monad that has some notion of state.</p>\n\n<blockquote>\n  <p>and how can I use it?</p>\n</blockquote>\n\n<p>Well you import the module and you can <code>runState stateMonadicOperation initialState</code>:</p>\n\n<pre><code>&gt; runState (mapM (\\x -&gt; state $ \\s -&gt; (x,s+x)) [1..4])  9\n([1,2,3,4],19)\n</code></pre>\n\n<p>There are a lot of state monad questions you can find here on stackoverflow if you have specific questions.</p>\n\n<blockquote>\n  <p>I wonder whether it exists or not?</p>\n</blockquote>\n\n<p>This depends on the <code>it</code> in your question.  There is a <code>State</code> type constructor but no <code>State</code> data constructor.</p>\n\n<blockquote>\n  <p>using :i get, I found MonadState, is this the new implement of State?</p>\n</blockquote>\n\n<p>No.  <code>State</code> the monad is defined in the tranformers as :</p>\n\n<pre><code>type State s = StateT s Data.Functor.Identity.Identity :: * -&gt; *\nnewtype StateT s (m :: * -&gt; *) a\n  = StateT {runStateT :: s -&gt; m (a, s)}\n</code></pre>\n\n<p>So there is a transformer with a data constructor and a type alias of the transformer and identity monad.</p>\n\n<p>In contrast, the MonadState is just an abstraction of the ability to get and set values:</p>\n\n<pre><code>class Monad m =&gt; MonadState s (m :: * -&gt; *) | m -&gt; s where\n  get :: m s\n  put :: s -&gt; m ()\n</code></pre>\n"}], "owner": {"reputation": 211, "user_id": 12247319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47823af926ab4adf84cc759c26593070?s=128&d=identicon&r=PG&f=1", "display_name": "q e x y", "link": "https://stackoverflow.com/users/12247319/q-e-x-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1571596687, "creation_date": 1571588667, "question_id": 58474946, "link": "https://stackoverflow.com/questions/58474946/where-is-state-monad-in-haskell-and-how-can-i-use-it", "title": "Where is State Monad in Haskell, and how can I use it?", "body": "<p>I'm learning State Monad, and was told it doesn't exist any more, the first question is why Haskell remove it?</p>\n\n<p>and when I using</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Functor.Identity\nimport Control.Monad.Trans.State\n\ntype State s = StateT s Identity\n</code></pre>\n\n<p>I get</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Ambiguous occurrence \u2018State\u2019\n    It could refer to\n       either \u2018Control.Monad.Trans.State.State\u2019\n           or \u2018Main.State\u2019,\n</code></pre>\n\n<p>but when I tried <code>:t State</code>, I find nothing. \nThis is self-contradictory, I wonder whether it exists or not?</p>\n\n<p>finally, I write it by my self</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>newtype State s a = State { runState :: s -&gt; (a, s) }\n</code></pre>\n\n<p>but I alse need some other function like <code>put</code>, <code>get</code>... where are they.</p>\n\n<p>using <code>:i get</code>, I found <code>MonadState</code>, is this the new implement of  <code>State</code>?</p>\n"}, {"tags": ["haskell", "dfa"], "answers": [{"comments": [{"owner": {"reputation": 132, "user_id": 12069869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3cadaa1f2741949137404bffc50711?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleRainbowZ", "link": "https://stackoverflow.com/users/12069869/doublerainbowz"}, "edited": false, "score": 0, "creation_date": 1571578388, "post_id": 58473259, "comment_id": 103280165, "body": "Thanks for your answer! I just have a follow up question. So I got it iterating properly with your loop like so: <code>[((x, char), x </code>mod` (n + digitToInt char)) | x &lt;- [0..n-1], char &lt;- [&#39;0&#39;, &#39;1&#39;]] ` however on the ones where the char is &#39;1&#39;, its going to the state n, when in reality I want it to go to state 0 in that case. Is there a way to add some sort of if statement where if the state is n, then its actually 0?"}, {"owner": {"reputation": 132, "user_id": 12069869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3cadaa1f2741949137404bffc50711?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleRainbowZ", "link": "https://stackoverflow.com/users/12069869/doublerainbowz"}, "edited": false, "score": 0, "creation_date": 1571579242, "post_id": 58473259, "comment_id": 103280421, "body": "Nevermind, I figured it out, didn&#39;t realise you can do &#39;if&#39; statements within lists in haskell :)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1571576607, "creation_date": 1571576607, "answer_id": 58473259, "question_id": 58473015, "link": "https://stackoverflow.com/questions/58473015/how-to-iterate-through-a-list-to-grab-values-in-an-transition-function-in-haskel/58473259#58473259", "title": "How to iterate through a list to grab values in an transition function in haskell?", "body": "<p>Hint: list comprehensions are a sort of loop. So, you can write</p>\n\n<pre><code>ts =\n    [ {- this part is your job -}\n    | x &lt;- [0..n-1]\n    , char &lt;- ['0', '1']\n    ]\n</code></pre>\n\n<p>and this will be a sort of nested loop that iterates through all numbers in the <code>0</code> to <code>n-1</code> range, and through all of the binary digits. In the <code>{- this part is your job -}</code> spot, you can use the names <code>x</code> and <code>char</code> for the current values of the two loops, respectively.</p>\n"}], "owner": {"reputation": 132, "user_id": 12069869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3cadaa1f2741949137404bffc50711?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleRainbowZ", "link": "https://stackoverflow.com/users/12069869/doublerainbowz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 58473259, "answer_count": 1, "score": 1, "last_activity_date": 1571576607, "creation_date": 1571574808, "question_id": 58473015, "link": "https://stackoverflow.com/questions/58473015/how-to-iterate-through-a-list-to-grab-values-in-an-transition-function-in-haskel", "title": "How to iterate through a list to grab values in an transition function in haskell?", "body": "<p>I am tasked with defining a (minimal) DFA in haskell. It is in the form ([states], \"language\", transition function, start state, [accept states]), and is supposed to take in an integer, and create a DFA for it for binary numbers that are divisible by that number. For example, function 4 will create a DFA for binary numbers that are divisible by 4. </p>\n\n<p>I started off with creating DFAs for 1 to 6 to kind of see the pattern that it is taking, and I have figured out that if it is in a state and receives a 0, the binary number is doubled, so it means the state is doubled, and if it receives a 1, the state is doubled and added with a 1.</p>\n\n<p>Here is an example of one I made for all numbers divisible by 4.</p>\n\n<pre><code>create 4\n  = ([0,1,2,3], \"01\", ts, 0, [0])\n    where\n      ts = [ ((0, '0'), 0)\n           , ((0, '1'), 1)\n           , ((1, '0'), 2)\n           , ((1, '1'), 3)\n           , ((2, '0'), 0)\n           , ((2, '1'), 1)\n           , ((3, '0'), 2)\n           , ((3, '1'), 3)\n           ] \n</code></pre>\n\n<p>Here is the start of my generalised DFA creator which accepts an integer n.</p>\n\n<pre><code>create n\n  = ([0..(n-1)], \"01\", ts, 0, [0])\n    where\n      ts = [ ((x, '0'), x `mod` n)\n           , ((x, '1'), (x*2 + 1) `mod` n)\n           ] \n        #where x is an iterated number through the states array\n\n</code></pre>\n\n<p>I am not sure if this is the best or correct way to do it..</p>\n\n<p>I essentially want it to iterate through the states array, and for each state, create 2 transition functions one for if it receives '0', and one for if it receives '1', and apply the logic above.</p>\n\n<p>I am new to haskell, so am not really sure how to approach this. Any advice would be greatly appreciated!</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1571565311, "post_id": 58471799, "comment_id": 103277053, "body": "Because one can not, based on the type signature, determine what <code>c</code> should be. So the &quot;user&quot; of the function, can not decide the <code>c</code>."}, {"owner": {"reputation": 743, "user_id": 7058336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8ab015fdc364a6f1fc3c17e888495568?s=128&d=identicon&r=PG&f=1", "display_name": "jam", "link": "https://stackoverflow.com/users/7058336/jam"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1571565360, "post_id": 58471799, "comment_id": 103277063, "body": "@WillemVanOnsem But it works if you dont specify h :: (F a c, G c b) =&gt; a -&gt; b. So why does it work in one case and not in the other?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1571565382, "post_id": 58471799, "comment_id": 103277069, "body": "I&#39;m no expert in these matters, but I believe that the problem is due to GHC not knowing which <code>c</code> you want to use, and that enabling functional dependencies might help."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1571566767, "post_id": 58471799, "comment_id": 103277350, "body": "If you enable <code>-XScopedTypeVariables</code> and change the signature to <code>h :: forall c b a. (F a c, G c b) =&gt; a -&gt; b</code> (to be able to refer to the intermediate type <code>c</code> in the implementation), and also enable <code>-XTypeApplications</code>, then you can write <code>h a = g @c (f a)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 743, "user_id": 7058336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8ab015fdc364a6f1fc3c17e888495568?s=128&d=identicon&r=PG&f=1", "display_name": "jam", "link": "https://stackoverflow.com/users/7058336/jam"}, "edited": false, "score": 1, "creation_date": 1571567385, "post_id": 58472008, "comment_id": 103277501, "body": "I&#39;m not sure to understand your answer. I&#39;m learning haskell also. Why does the definition h function works when I just write <code>h a = g (f a)</code> without specifying its type. Wait you just edited."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 743, "user_id": 7058336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8ab015fdc364a6f1fc3c17e888495568?s=128&d=identicon&r=PG&f=1", "display_name": "jam", "link": "https://stackoverflow.com/users/7058336/jam"}, "edited": false, "score": 0, "creation_date": 1571567451, "post_id": 58472008, "comment_id": 103277513, "body": "@J.M. I initially missed that. I&#39;m writing on that part now :)"}, {"owner": {"reputation": 743, "user_id": 7058336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8ab015fdc364a6f1fc3c17e888495568?s=128&d=identicon&r=PG&f=1", "display_name": "jam", "link": "https://stackoverflow.com/users/7058336/jam"}, "edited": false, "score": 0, "creation_date": 1571568146, "post_id": 58472008, "comment_id": 103277628, "body": "Ok I think im getting it, then my question is how can I achieve my purpose in a nice way? I thought of using parametric types, like making c a parameter of a, but then it becomes a mess, especially if i have several parameters in a type, i dont know how to optionally reorder them or drop some of them.."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 743, "user_id": 7058336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8ab015fdc364a6f1fc3c17e888495568?s=128&d=identicon&r=PG&f=1", "display_name": "jam", "link": "https://stackoverflow.com/users/7058336/jam"}, "edited": false, "score": 0, "creation_date": 1571568558, "post_id": 58472008, "comment_id": 103277721, "body": "@J.M. To disambiguate the code, the options I can see are: 1) forcing the user to annotate the intermediate type (with a type annotation, or with TypeApplications), 2) using a functional dependency like <code>class F a c | a -&gt; c</code>, 3) using type families and replacing <code>c</code> with <code>Fun a</code>. 2 and 3 can only be used assuming the fundep is actually respected by your instances. In general, convincing the type inference machinery to play the wanted tune can be nontrivial."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1571578608, "last_edit_date": 1571578608, "creation_date": 1571566720, "answer_id": 58472008, "question_id": 58471799, "link": "https://stackoverflow.com/questions/58471799/in-haskell-why-are-types-ambiguous-even-with-allowambiguoustypes-enabled/58472008#58472008", "title": "In Haskell, why are types ambiguous even with AllowAmbiguousTypes enabled?", "body": "<p>Your code is ambiguous, in a way that it can't be solved automatically by the compiler. Assume this:</p>\n\n<pre><code>class F a c where f :: a -&gt; c\nclass G c b where g :: c -&gt; b\n\ninstance F Int String where f = show\ninstance G String Bool where g = null\n\nh :: (F Int c, G c Bool) =&gt; Int -&gt; Bool\nh a = g (f a)\n</code></pre>\n\n<p>Now, which instances are used in the last line? We have two options: using the instances provided by the context <code>(F Int c, G c Bool)</code>, or ignoring that context and using the instances above, with <code>String</code> as the middle type. Both interpretations are correct, and indeed we can explicitly write</p>\n\n<pre><code>h1 :: forall c. (F Int c, G c Bool) =&gt; Int -&gt; Bool\nh1 a = (g :: c -&gt; Bool) (f a)\n\nh2 :: forall c. (F Int c, G c Bool) =&gt; Int -&gt; Bool\nh2 a = (g :: String -&gt; Bool) (f a)\n</code></pre>\n\n<p>to choose one way or the other. GHC can not do this choice for us in a reasonable way. It <em>could</em> choose one according to some heuristics, but that can cause much surprise to the programmer. Hence, we can argue that GHC <em>must not</em> choose at all, report the ambiguity, and let the programmer clarify their intent.</p>\n\n<p>Finally, note that the fact that your code does not include the two instances above is irrelevant, since those could be added later on, or even in another module, so GHC has to be conservative and avoid assuming they will never exist.</p>\n\n<blockquote>\n  <p>And why doesn't Haskell complain about this?</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE AllowAmbiguousTypes #-}\n\nclass F a c where f :: a -&gt; c\nclass G c b where g :: c -&gt; b\n\nh x = g (f x)  -- [renamed to x for clarity]\n</code></pre>\n</blockquote>\n\n<p>Good point. Here GHC can find a most general type, which is</p>\n\n<pre><code>h :: forall a b c. (F a c, G c b) =&gt; a -&gt; b\nh x = (g :: c -&gt; b) ((f :: a -&gt; b) x)\n</code></pre>\n\n<p>Since here it is GHC that added the type variable <code>c</code>, GHC can be sure that such type is the intermediate type. That type variable was created during type inference to denote the intermediate type, after all.</p>\n\n<p>Instead, when the user explicitly writes the context, GHC can not guess the intention of the user. It is possible, even if it's unlikely in practice, that the user does not want to use that instance, but another one (available in the program, and not present in the context).</p>\n\n<p>It might be helpful to think about this case as well:</p>\n\n<pre><code>data T = ....\n\nh :: forall a b c. (F a c, G c b, F a T, G T b) =&gt; a -&gt; b\nh x = g (f x)\n</code></pre>\n\n<p>I think you can agree that this code should be rejected: the intermediate type could be <code>T</code> or <code>c</code>, and there is no sane way to solve it. Now consider this case:</p>\n\n<pre><code>h :: forall a b c. (F a c, G c b) =&gt; a -&gt; b\nh x = g (f x)\n\ninstance F a T where ...\ninstance G T b where ...\n</code></pre>\n\n<p>Now, this is not too different than the previous case. Instead of having two options in the context, we have moved one outside. GHC still has two options to choose from, though. So, again, the sane thing is to reject the code, and ask the programmer for more detail.</p>\n\n<hr>\n\n<p>A simpler scenario, in GHCi:</p>\n\n<pre><code>&gt; :set -XScopedTypeVariables\n&gt; :set -XAllowAmbiguousTypes\n&gt; class C a where c :: String\n&gt; instance C Int where c = \"Int\"\n&gt; instance C Bool where c = \"Bool\"\n&gt; let g :: forall a. C a =&gt; String ; g = c\n\n&lt;interactive&gt;:7:40: error:\n    * Could not deduce (C a0) arising from a use of `c'\n</code></pre>\n\n<p>Here, how could GHC know that when I wrote <code>g = c</code> I meant \"the <code>c</code> coming from the context <code>C a</code>? I could have written that meaning \"the <code>c</code> from the instance for <code>Int</code>\". Or <code>Bool</code>.</p>\n\n<p>GHC internally generates a fresh type variable <code>a0</code> and then tries to solve the constraint <code>C a0</code>. It has three choices: choosing <code>a0 = a</code>, <code>a0 = Int</code>, or <code>a0 = Bool</code>. (And more instances could be added later on!)</p>\n\n<p>So, it is ambiguous, and there is no sane way to fix it without guessing what the programmer intended. The only safe option is to reject.</p>\n"}], "owner": {"reputation": 743, "user_id": 7058336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8ab015fdc364a6f1fc3c17e888495568?s=128&d=identicon&r=PG&f=1", "display_name": "jam", "link": "https://stackoverflow.com/users/7058336/jam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 58472008, "answer_count": 1, "score": 4, "last_activity_date": 1571578608, "creation_date": 1571564948, "last_edit_date": 1571566492, "question_id": 58471799, "link": "https://stackoverflow.com/questions/58471799/in-haskell-why-are-types-ambiguous-even-with-allowambiguoustypes-enabled", "title": "In Haskell, why are types ambiguous even with AllowAmbiguousTypes enabled?", "body": "<p>So lets assume you have two type classes defined like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE MultiParamTypeClasses #-}\n\nclass F a c where f :: a -&gt; c\nclass G c b where g :: c -&gt; b\n</code></pre>\n\n<p>And then you want to define a new function h in a general way by using f and g.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>h a = g (f a)\n</code></pre>\n\n<p>We know that this function has type <code>a -&gt; b</code> so c is implicit in there. I want to leave it to the implementer of <code>f</code> and <code>g</code> what <code>c</code> might be. Haskell complains about this saying <code>c</code> is ambiguous.</p>\n\n<p>Then as suggested by the error I turned on this extension:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE AllowAmbiguousTypes #-}\n</code></pre>\n\n<p>Now it works! Nice.</p>\n\n<p>I believe usually as a good software engineering practice, I want to write explicit specifications of my functions, to tell the compiler what I expect my functions should behave like. So that later compiler can complain about me not respecting what I set.</p>\n\n<p>So I want to add the type of my function before it:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>h :: (F a c, G c b) =&gt; a -&gt; b\nh a = g (f a)\n</code></pre>\n\n<p>And now the type ambiguousity error comes again... Why?</p>\n\n<p><strong>To summarize why does Haskell complain about this below piece of code?</strong> even if AllowAmbiguousTypes is explictly enabled. How to fix it while keeping an explicit function type definition? I know that removing the type definition of the function solves it but I don't want to underspecify things.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE AllowAmbiguousTypes #-}\n\nclass F a c where f :: a -&gt; c\nclass G c b where g :: c -&gt; b\n\nh :: (F a c, G c b) =&gt; a -&gt; b\nh a = g (f a)\n</code></pre>\n\n<p>And why <strong>doesn't</strong> Haskell complain about this?</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE AllowAmbiguousTypes #-}\n\nclass F a c where f :: a -&gt; c\nclass G c b where g :: c -&gt; b\n\nh a = g (f a)\n</code></pre>\n\n<p>Error messages:</p>\n\n<pre><code>error:\n    * Could not deduce (G c0 b) arising from a use of `g'\n      from the context: (F a c, G c b)\n        bound by the type signature for:\n                   h :: forall a c b. (F a c, G c b) =&gt; a -&gt; b\n\n      The type variable `c0' is ambiguous\n      Relevant bindings include\n        h :: a -&gt; b \n    * In the expression: g (f a)\n      In an equation for `h': h a = g (f a)\n    |\n    | h a = g (f a)\n    |       ^^^^^^^\nerror:\n    * Could not deduce (F a c0) arising from a use of `f'\n      from the context: (F a c, G c b)\n        bound by the type signature for:\n                   h :: forall a c b. (F a c, G c b) =&gt; a -&gt; b\n      The type variable `c0' is ambiguous\n      Relevant bindings include\n        a :: a \n        h :: a -&gt; b \n    * In the first argument of `g', namely `(f a)'\n      In the expression: g (f a)\n      In an equation for `h': h a = g (f a)\n    |\n    | h a = g (f a)\n    |          ^^^\n</code></pre>\n"}, {"tags": ["haskell", "ghc", "cjk"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1571560436, "post_id": 58471002, "comment_id": 103276043, "body": "This looks like an issue with the directory name, which contains non-ASCII characters. Of course, GHC should handle that just fine. One might try running <code>chcp 65001</code> before compiling to enable unicode, but I&#39;m unsure about it."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1571561574, "post_id": 58471002, "comment_id": 103276260, "body": "More specifically, this seems to be a problem with non-ASCII characters <i>in Windows</i>. On Linux, GHC does indeed not seem to have any problems with such a directory name. (Likely reason: Windows uses UTF-16 somewhere where Linux and GHC use UTF-8, and the conversion was only tested with ASCII.)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1571561758, "post_id": 58471002, "comment_id": 103276293, "body": "...but it could also be that the problem is completely unrelated to the <code>\u8521</code> character."}, {"owner": {"reputation": 99, "user_id": 10829064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5363cd15ef02e5f9dc90b3e5a011ca02?s=128&d=identicon&r=PG&f=1", "display_name": "Home3", "link": "https://stackoverflow.com/users/10829064/home3"}, "edited": false, "score": 1, "creation_date": 1571562092, "post_id": 58471002, "comment_id": 103276350, "body": "So how can I solve this problem? This path (<code>C:\\Users\\\u8521XX\\AppData\\Local\\Temp\\ghc92756_0\\ghc_6.rsp</code>) has nothing related to where my ghc is (which is at <code>D:</code>), so I think this is where <code>ghc</code> saves my Haskell projects by default. How can I change this path?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1571564292, "post_id": 58471002, "comment_id": 103276833, "body": "@Home3: you can create a directory with only ascii characters, create your file there, and compile it there. Perhaps this is a workaround for the issue. Perhaps it is also a good idea to open an issue at the GitHub repository."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1571564914, "post_id": 58471002, "comment_id": 103276978, "body": "Note that GHC is using that <code>Temp</code> directory, even if the file is elesewhere. I guess moving the file won&#39;t help. I&#39;d try to define the environment variables <code>TMP</code> or <code>TEMP</code> or whatever windows uses to prod GHC to use another temporary directory."}, {"owner": {"reputation": 99, "user_id": 10829064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5363cd15ef02e5f9dc90b3e5a011ca02?s=128&d=identicon&r=PG&f=1", "display_name": "Home3", "link": "https://stackoverflow.com/users/10829064/home3"}, "edited": false, "score": 0, "creation_date": 1571569154, "post_id": 58471002, "comment_id": 103277848, "body": "So how can I change my temporary directory? How can I define the environment variables <code>TMP</code> or <code>TEMP</code>?"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1571583220, "post_id": 58471002, "comment_id": 103281537, "body": "One question per post please. New question? New post."}, {"owner": {"reputation": 3079, "user_id": 1758363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hBUXs.jpg?s=128&g=1", "display_name": "Evgeny", "link": "https://stackoverflow.com/users/1758363/evgeny"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1592120658, "post_id": 58471002, "comment_id": 110306155, "body": "@Willem Van Onsem: <i>you can create a directory with only ascii characters, create your file there, and compile it there.</i> The location on the source file does not matter, unfortunately."}, {"owner": {"reputation": 3079, "user_id": 1758363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hBUXs.jpg?s=128&g=1", "display_name": "Evgeny", "link": "https://stackoverflow.com/users/1758363/evgeny"}, "edited": false, "score": 0, "creation_date": 1592121062, "post_id": 58471002, "comment_id": 110306264, "body": "Filled an issue here: <a href=\"https://gitlab.haskell.org/ghc/ghc/issues/18332#note_281652\" rel=\"nofollow noreferrer\">gitlab.haskell.org/ghc/ghc/issues/18332#note_281652</a>"}], "owner": {"reputation": 99, "user_id": 10829064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5363cd15ef02e5f9dc90b3e5a011ca02?s=128&d=identicon&r=PG&f=1", "display_name": "Home3", "link": "https://stackoverflow.com/users/10829064/home3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1571571917, "creation_date": 1571557696, "last_edit_date": 1571571917, "question_id": 58471002, "link": "https://stackoverflow.com/questions/58471002/failed-to-compile-haskell-project-helloworld", "title": "failed to compile Haskell project &quot;helloworld&quot;", "body": "<p>I am a beginner of Haskell and I have downloaded <code>ghc-8.8.1</code> from the official site. I tried to compile my first Haskell program with it and failed. Here is my program <code>helloworld.hs</code>:</p>\n\n<pre><code>main = putStrLn \"hello world\"\n</code></pre>\n\n<p>Then I compiled it with cmd (Windows 10):</p>\n\n<pre><code>ghc --make helloworld\n</code></pre>\n\n<p>And it failed with these words:</p>\n\n<pre><code>[1 of 1] Compiling Main             ( helloworld.hs, helloworld.o )\nLinking helloworld.exe ...\nC:\\Users\\\u8521XX\\AppData\\Local\\Temp\\ghc92756_0\\ghc_6.rsp: commitBuffer: invalid argument (invalid character)\n</code></pre>\n\n<p>(\u8521XX is my name)</p>\n\n<p>Why is it not working? How can I solve this problem?\nBTW, my <code>ghci</code> is working.</p>\n\n<p>Edit: I created a new user in my computer with English name and copied my <code>ghc</code>, and this time it worked. It turns out that this problem was due to the character \u8521 in my path, as the comments said. Thanks guys!</p>\n"}, {"tags": ["haskell", "parse-error"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 4, "creation_date": 1571538106, "post_id": 58469535, "comment_id": 103273114, "body": "<i>What</i> parse errors are you getting? And how is <code>GaussianInt</code> defined?"}, {"owner": {"reputation": 9, "user_id": 12245181, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VmXiSVCz5G8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdQCO_3_oJmEpF7jTUZh-wU4Lt2Pw/photo.jpg?sz=128", "display_name": "Jestyn Strik", "link": "https://stackoverflow.com/users/12245181/jestyn-strik"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1571538949, "post_id": 58469535, "comment_id": 103273228, "body": "GaussianInt is defined as type GaussianInt = (Integer,Integer), the error that I keep getting is Assign_2.hs:90:18: error:     parse error on input `=&#39;     Perhaps you need a &#39;let&#39; in a &#39;do&#39; block?     e.g. &#39;let x = 5&#39; instead of &#39;x = 5&#39;          | 90 |         gs == [] = m    |                  ^"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1571539192, "post_id": 58469535, "comment_id": 103273256, "body": "Did you make sure not to have mixed tabs and spaces for indentation?"}, {"owner": {"reputation": 9, "user_id": 12245181, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VmXiSVCz5G8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdQCO_3_oJmEpF7jTUZh-wU4Lt2Pw/photo.jpg?sz=128", "display_name": "Jestyn Strik", "link": "https://stackoverflow.com/users/12245181/jestyn-strik"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1571539313, "post_id": 58469535, "comment_id": 103273279, "body": "I have been only using tabs, Ill try with spaces"}, {"owner": {"reputation": 189, "user_id": 8179137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b43fe26a1b6191280614f56683525d?s=128&d=identicon&r=PG&f=1", "display_name": "Potato44", "link": "https://stackoverflow.com/users/8179137/potato44"}, "edited": false, "score": 3, "creation_date": 1571539322, "post_id": 58469535, "comment_id": 103273281, "body": "Is this the whole file? This section of code is not giving parse errors. <a href=\"https://tio.run/##y0gszk7Nyfn/Pzexwj2xtLjYL78oV8HKSiEazMtMzPPMK4lV0LVTQOJzoSiOjlWwVdAw0DHQRBVPLwaKA0UcSysUNEoSM3OAIpoKGhmpiSkgFhcXVI6AZVjsBukCmp6rwKUABjVgu2whLsmFC2qkw90Ct1VTwcYWWSJXE5sjCZlhR9gIhD///wcA\" title=\"Haskell \u2013 Try It Online\" rel=\"nofollow noreferrer\">Try it online!</a>"}, {"owner": {"reputation": 9, "user_id": 12245181, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VmXiSVCz5G8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdQCO_3_oJmEpF7jTUZh-wU4Lt2Pw/photo.jpg?sz=128", "display_name": "Jestyn Strik", "link": "https://stackoverflow.com/users/12245181/jestyn-strik"}, "edited": false, "score": 0, "creation_date": 1571539367, "post_id": 58469535, "comment_id": 103273286, "body": "I still am getting the same error"}, {"owner": {"reputation": 9, "user_id": 12245181, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VmXiSVCz5G8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdQCO_3_oJmEpF7jTUZh-wU4Lt2Pw/photo.jpg?sz=128", "display_name": "Jestyn Strik", "link": "https://stackoverflow.com/users/12245181/jestyn-strik"}, "edited": false, "score": 0, "creation_date": 1571539432, "post_id": 58469535, "comment_id": 103273297, "body": "This isnt the whole code, but its the only part that has been getting errors"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1571539671, "post_id": 58469535, "comment_id": 103273316, "body": "@JestynStrik No, tabs should work fine as well, you just need to avoid mixing them with spaces which can lead to non-obvious errors, so this was just my first guess on correct-looking code. As Potato44 said, please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 189, "user_id": 8179137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b43fe26a1b6191280614f56683525d?s=128&d=identicon&r=PG&f=1", "display_name": "Potato44", "link": "https://stackoverflow.com/users/8179137/potato44"}, "edited": false, "score": 1, "creation_date": 1571539688, "post_id": 58469535, "comment_id": 103273319, "body": "The error message in your comment earlier says it is happening on line 90. Can you post whatever is is on line 90 along with the few lines of context either side of it?"}, {"owner": {"reputation": 9, "user_id": 12245181, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VmXiSVCz5G8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdQCO_3_oJmEpF7jTUZh-wU4Lt2Pw/photo.jpg?sz=128", "display_name": "Jestyn Strik", "link": "https://stackoverflow.com/users/12245181/jestyn-strik"}, "edited": false, "score": 0, "creation_date": 1571539769, "post_id": 58469535, "comment_id": 103273334, "body": "line 90 is this      | gs == [] = m       this is supposed to return the head of the original list if the list is only one value long"}, {"owner": {"reputation": 189, "user_id": 8179137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b43fe26a1b6191280614f56683525d?s=128&d=identicon&r=PG&f=1", "display_name": "Potato44", "link": "https://stackoverflow.com/users/8179137/potato44"}, "edited": false, "score": 0, "creation_date": 1571540735, "post_id": 58469535, "comment_id": 103273457, "body": "I&#39;ve filled in some dummy definitions to make your code work: <a href=\"https://tio.run/##hU9BCoMwELznFXNMwIJnaYSeSi/9gHgIbVCpSUsSwUL/nq5WrILgXjY7O5mZrZV/6LaN0aj@rDrvr09nkGUoxqlR9mJDiUOOxcxW5KKEBE@TVKzxyhNOyKnrwYNqWkIEeK3VfXgxNu12zDa8h1@kbsAw1mf0kr8kZgZ5NWeZXQWOcrkwYivknka@L7G4cyijGks0p0PnLDih4f3SqzspFzVdaZdMnVh/G4nb0/qANMYv\" title=\"Haskell \u2013 Try It Online\" rel=\"nofollow noreferrer\">Try it online!</a>. I haven&#39;t touched your part of the code in any way but copy and paste, so the error is definitely elsewhere."}, {"owner": {"reputation": 9, "user_id": 12245181, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VmXiSVCz5G8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdQCO_3_oJmEpF7jTUZh-wU4Lt2Pw/photo.jpg?sz=128", "display_name": "Jestyn Strik", "link": "https://stackoverflow.com/users/12245181/jestyn-strik"}, "edited": false, "score": 0, "creation_date": 1571541365, "post_id": 58469535, "comment_id": 103273543, "body": "I opened the program into the online tester, how can I send you the link?"}, {"owner": {"reputation": 9, "user_id": 12245181, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VmXiSVCz5G8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdQCO_3_oJmEpF7jTUZh-wU4Lt2Pw/photo.jpg?sz=128", "display_name": "Jestyn Strik", "link": "https://stackoverflow.com/users/12245181/jestyn-strik"}, "reply_to_user": {"reputation": 189, "user_id": 8179137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b43fe26a1b6191280614f56683525d?s=128&d=identicon&r=PG&f=1", "display_name": "Potato44", "link": "https://stackoverflow.com/users/8179137/potato44"}, "edited": false, "score": 0, "creation_date": 1571541911, "post_id": 58469535, "comment_id": 103273595, "body": "@Potato44 i put the hyperlink in the top, hopefully you could access it"}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1571542930, "post_id": 58469535, "comment_id": 103273716, "body": "@JestynStrik Well in the code by the link there is not even a function <code>maxAux</code>. There is however a function <code>maxGaussNorm</code> with a subfunction <code>compareMax</code> and it needs a <code>where</code> keyword and some guards to fix its syntax."}, {"owner": {"reputation": 9, "user_id": 12245181, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VmXiSVCz5G8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdQCO_3_oJmEpF7jTUZh-wU4Lt2Pw/photo.jpg?sz=128", "display_name": "Jestyn Strik", "link": "https://stackoverflow.com/users/12245181/jestyn-strik"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1571543053, "post_id": 58469535, "comment_id": 103273738, "body": "@IgnatInsarov could you explain how i can express the function using where and the guards?"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1571583306, "post_id": 58469535, "comment_id": 103281559, "body": "Please ask new questions in a new post."}], "answers": [{"tags": [], "owner": {"reputation": 189, "user_id": 8179137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b43fe26a1b6191280614f56683525d?s=128&d=identicon&r=PG&f=1", "display_name": "Potato44", "link": "https://stackoverflow.com/users/8179137/potato44"}, "is_accepted": false, "score": 3, "last_activity_date": 1571543151, "creation_date": 1571543151, "answer_id": 58469867, "question_id": 58469535, "link": "https://stackoverflow.com/questions/58469535/how-can-i-fix-this-function/58469867#58469867", "title": "How can I fix this function", "body": "<p>The code you have posted in the link is different from what you have posted in the question body.</p>\n\n<p>Here is your code that actually has parse errors</p>\n\n<pre><code>maxGaussNorm :: [GaussianInt] -&gt; GaussianInt\nmaxGaussNorm gs = compareMax (tail gs) (head gs)\n    compareMax :: [GaussianInt] -&gt; GaussianInt -&gt; GaussianInt\n    compareMax gs m\n        gs == [] = m\n        gaussNorm(head gs) &lt;= gaussNorm m = compareMax (tail gs) m\n        gaussNorm(head gs) &gt; gaussNorm m = compareMax (tail gs) (head gs)\n</code></pre>\n\n<p>There are two things wrong with this, missing the pipe character <code>|</code> on the guards, \nand you forgot to include a <code>where</code> keyword before the definition of <code>compareMax</code>.</p>\n\n<p>Here is the code with these parse error fixed</p>\n\n<pre><code>maxGaussNorm :: [GaussianInt] -&gt; GaussianInt\nmaxGaussNorm gs = compareMax (tail gs) (head gs)\n  where\n    compareMax :: [GaussianInt] -&gt; GaussianInt -&gt; GaussianInt\n    compareMax gs m\n       | gs == [] = m\n       | gaussNorm(head gs) &lt;= gaussNorm m = compareMax (tail gs) m\n       | gaussNorm(head gs) &gt; gaussNorm m = compareMax (tail gs) (head gs)\n</code></pre>\n\n<p>The code you originally posted with the question also is a solution to the parse errors by rewriting the helper function as a top level function and including the pipes on the guards</p>\n\n<pre><code>maxGaussNorm :: [GaussianInt] -&gt; GaussianInt\nmaxGaussNorm [] = (0,0)\nmaxGaussNorm gs = maxAux (tail gs) (head gs)\n\nmaxAux :: [GaussianInt] -&gt; GaussianInt -&gt; GaussianInt\nmaxAux gs m \n      | gs == [] = m\n      | (gaussNorm (head gs)) &lt;= (gaussNorm m) = maxAux (tail gs) m\n      | (gaussNorm (head gs)) &gt; (gaussNorm m) = maxAux (tail gs) (head gs)\n</code></pre>\n\n<p>This implementation is also slightly different in that it handles empty lists instead of erroring.</p>\n"}], "owner": {"reputation": 9, "user_id": 12245181, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VmXiSVCz5G8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdQCO_3_oJmEpF7jTUZh-wU4Lt2Pw/photo.jpg?sz=128", "display_name": "Jestyn Strik", "link": "https://stackoverflow.com/users/12245181/jestyn-strik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1571543151, "creation_date": 1571537981, "last_edit_date": 1571541859, "question_id": 58469535, "link": "https://stackoverflow.com/questions/58469535/how-can-i-fix-this-function", "title": "How can I fix this function", "body": "<p>I've been working on a school assignment using Haskell and keep getting the same parse-errors over and over again. I've been looking online and have gotten no solutions to my problem. Any advice would be greatly appreciated. Here is the function...</p>\n\n<pre><code>maxGaussNorm :: [GaussianInt] -&gt; GaussianInt\nmaxGaussNorm [] = (0,0)\nmaxGaussNorm gs = maxAux (tail gs) (head gs)\n\nmaxAux :: [GaussianInt] -&gt; GaussianInt -&gt; GaussianInt\nmaxAux gs m \n      | gs == [] = m\n      | (gaussNorm (head gs)) &lt;= (gaussNorm m) = maxAux (tail gs) m\n      | (gaussNorm (head gs)) &gt; (gaussNorm m) = maxAux (tail gs) (head gs)\n</code></pre>\n\n<p><a href=\"https://tio.run/##1VdNb5tAEL3zK0Y54dgo4FutOlKUL6VSUqntLUqqDazxJuxCYWkWVf3t7syCDXacpGpwpHKBfZ6vfW9mwXNWPPAkWSx@eXBUFCJWkisNYwc8uGKST@ATL3Sl4KvOxQOhJ0wjOvYPAv9g7AcfEPvtyDQqE95E@D6GxznPueNIFooIJhPrreJmPYW9gqLd7zmOrjIO56xER6YuMPMUXLzxmOej5j5wHCzOe@tFtceU6AtnCS16iXjCizAXmRapmsCp0TkLdQF6ziHHNPCTJSWHdGaRuNkmiHpj5D/LU2l/5D9KRlHADCsxQm9d5qoAY@ld1U1cdtnyDqFhqWPjmlE1QCJNz8RdSBa/A3EC0wjF8urt7FUte1T8a@xZmyV7ldMvfceput8Neydc81wKxWv@QkxUxjilxBx7mbfNHze7z6tESyHtYAuFnWXHLqZJNiMPuawPA8DLINj2aWyxaolZ9uOee/YoinZDOgZGuh/TJxQimsYcyc1HwFS04pLonmFfJ1sVuWMFj1Cw2bLdVx3tusYfmmAwcit/WAWDQSsI1vCyHlvlIa/YhzgghTA4DIHCA8bHR8rQVcxfl8yv0WAdDWol/XUpa9sqWEeDnhW@LBO9G4kpssgSwd9P6H1k1kMi9ysS3NDdyrNf@V3hqbJ/UN66daVfSweb@f6rNrhKc/kuxyslev5kbeRV69La87Y@Ws3tmKbsdtyqaSO@8mqyNvZM7fA9sLHcDquI9MerZOZ8t9SeCRXVrGIuIUvZcqpow0IhzYko7IBr9tBIoBoJ6HnOWVTLQXb1JIapzFiOxkLjjD5xUdxoa11/YFBs8khQ5wKlC3n9asQPOAR0U0kB0bIPoifjzrIsTzNB79wtTYGfxx0mSenrjtQ3m6O6ZhwXqHmzn0tmwNVMoPLFAFy7c3yy49UxeSX@ZroNb0woLUYXZZ/C9Q3W0AGXxa0qgI/TFgX5XMUvhjj8mwjtnu3VV6N/I5mPcXKLvtq8t3Hx4KxUoZ2WermqFa5KecfzBr5QWamb51OT8VBjm34udYsehaXGQ6OL9f6XKqS6AtvyzmLxBw\" rel=\"nofollow noreferrer\" title=\"Haskell \u2013 Try It Online\">Try it online!</a></p>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 5, "last_activity_date": 1571535639, "creation_date": 1571535639, "answer_id": 58469386, "question_id": 58469305, "link": "https://stackoverflow.com/questions/58469305/cant-get-some-simple-haskell-code-to-compile-no-matter-how-many-different-ways/58469386#58469386", "title": "Can&#39;t get some simple Haskell code to compile, no matter how many different ways I try it", "body": "<p>The way to call a function with two arguments is my separating them with whitespace, like this:</p>\n\n<pre><code>f x y\n</code></pre>\n\n<p>Or in your case, this would be:</p>\n\n<pre><code>max left right\n</code></pre>\n\n<p>The way to construct a pair is with parens and a comma, like this:</p>\n\n<pre><code>(42, \"foo\")\n</code></pre>\n\n<p>Or in your case, this would be:</p>\n\n<pre><code>(max left right, x)\n</code></pre>\n\n<p>Summing all of that up, the line should be:</p>\n\n<pre><code>pairs (Bin l x r) = Bin (pairs l) (max left right, x) (pairs r)\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 11342136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74465da242c8a582db7f6f6292b5cc25?s=128&d=identicon&r=PG&f=1", "display_name": "napqueen6078", "link": "https://stackoverflow.com/users/11342136/napqueen6078"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 58469386, "answer_count": 1, "score": 1, "last_activity_date": 1571535639, "creation_date": 1571534305, "question_id": 58469305, "link": "https://stackoverflow.com/questions/58469305/cant-get-some-simple-haskell-code-to-compile-no-matter-how-many-different-ways", "title": "Can&#39;t get some simple Haskell code to compile, no matter how many different ways I try it", "body": "<p>I'm trying to write a Haskell function that takes in a tree, and replaces every node with a pair containing the height of the subtree at that node, and the original node</p>\n\n<p>Depending on where I place my parenthesis in the last line of code, I get all kinds of different errors. I know my height function works because I've used it for different functions previously. I'm clearly not grouping things together correctly, because I've gotten everything from not giving enough arguments to max, to giving too many arguments to pairs. Please help! I'm really stuck here and making no progress because I'm just moving parenthesis back and forth. </p>\n\n<pre><code>data Tree a = Tip | Bin (Tree a) a (Tree a) deriving (Show, Eq)\n\ngetHeight :: Tree a -&gt; Integer\ngetHeight Tip = 0\ngetHeight (Bin l _ r) = (max (getHeight l) (getHeight r)) +1\n\npairs :: Tree a -&gt; Tree (Integer, a)\npairs Tip = Tip\npairs (Bin l x r) = (Bin (pairs l) ((max (left right)) x) (pairs r))\n  where left = (getHeight l)\n        right = (getHeight r)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1571530814, "post_id": 58467954, "comment_id": 103272322, "body": "Also <code>Writer w</code> if <code>w</code> isn&#39;t a monoid."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1571558541, "post_id": 58467954, "comment_id": 103275752, "body": "@luqui This is unfair though as <code>Writer</code> is a <i>bi</i>-functor. By parametricity, it is impossible to define a value of its left type out of nowhere. For instance, see <a href=\"https://stackoverflow.com/questions/38415374\">how <code>Applicative</code> is done for tuples</a> <i>(which are also bifunctors)</i>. So, if <code>Writer</code> is an example, then <code>(x, y)</code> is also."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 3, "creation_date": 1571560980, "post_id": 58467954, "comment_id": 103276150, "body": "@IgnatInsarov, i agree with everything you said except &quot;this is unfair&quot;. Seems like it answers the question adequately. What&#39;s the problem?"}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1571562035, "post_id": 58467954, "comment_id": 103276338, "body": "@luqui I did not mean to be offensive. If we agree with unconstrained <code>(x, y)</code> being an example, then there is no problem. But it is then a boring question. Possibly there are better examples \u2014 such that, no matter the constraints, there is not a way to define <code>return</code> compatible with <code>ap</code>, for some fundamental reason. I am thinking even for <code>IntMap</code> we could have <code>pure</code>, just a very slow one. So, if we exclude unrestricted bifunctors, we get an interesting question back."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1571580203, "post_id": 58467954, "comment_id": 103280682, "body": "@IgnatInsarov You basically have two choices for <code>pure :: a -&gt; IntMap a</code>. Either <code>pure _ = Nil</code> or <code>pure x = Tip y x</code> for some fixed <code>y :: Int</code>. Try to prove the <a href=\"https://en.wikibooks.org/wiki/Haskell/Applicative_functors#Applicative_functor_laws\" rel=\"nofollow noreferrer\">applicative laws</a> hold for either. (We can ignore <code>Bin</code>, since choosing such a value ultimately requires either a <code>Nil</code> or a <code>Key</code> value to be constructed.)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1571581336, "post_id": 58467954, "comment_id": 103280992, "body": "Sorry, I should have said functor laws, since we do have <code>bind</code> already."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1571583153, "post_id": 58467954, "comment_id": 103281521, "body": "@chepner what if <code>pure x</code> created an <code>IntMap</code> where every possible <code>Int</code> was present and they all mapped to <code>x</code>?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1571598408, "post_id": 58467954, "comment_id": 103285431, "body": "@JosephSible True, though looking at that one specifically, it would violate the right identity, no?"}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1571600031, "post_id": 58467954, "comment_id": 103285848, "body": "@chepner My idea was the same as Joseph Sible&#39;s \u2014 to have a very large regular map for <code>pure</code>. I am thinking the laws to hold are those connecting <code>pure</code> and <code>ap</code>. I do not have a detailed proof, and, truth be told, I am not intellectually equipped to research further. Hand waving goes in the direction of a map being a <a href=\"https://www.cs.nott.ac.uk/~psztxa/publ/fossacs03.pdf\" rel=\"nofollow noreferrer\">container</a> with a shape defined by its keys, and then by analogy with a <code>ZipList</code> or some other simple container that has a <code>zip</code> applicative."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 1, "creation_date": 1571600455, "post_id": 58467954, "comment_id": 103285935, "body": "@IgnatInsarov The right identity law says that <code>m &gt;&gt;= return == m</code>. If <code>return</code> creates a &quot;full&quot; <code>IntMap</code>, then <i>some</i> value in the original <code>m</code> will get overwritten by <code>&gt;&gt;=</code>."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1571605005, "post_id": 58467954, "comment_id": 103286992, "body": "@chepner True. I also see <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Applicative.html#t:ZipList\" rel=\"nofollow noreferrer\">there is no <code>instance Monad ZipList</code></a> \u2014 with <code>pure</code> being <code>repeat</code>, <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.Base.html#line-984\" rel=\"nofollow noreferrer\">the usual monad definition</a> would hang. On the other hand, I tried to make a <i>&quot;cartesian&quot;</i> definition of <code>instance Monoid k =&gt; Applicative (Map k)</code> earlier today and I discovered that it is impossible to align it with the composition law unless the monoid is the free one. Trouble all around."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1571607164, "post_id": 58467954, "comment_id": 103287482, "body": "@chepner, I don&#39;t think so. <code>IntMap a</code> can be thought of as a different representation for <code>Int -&gt; Maybe a</code> ~= <code>MaybeT (Int -&gt;) a</code>.  So if we just follow that guide, we will get law-abiding instances.  In particular, <code>join</code> is diagonal, so each value in <code>m</code> gets mapped to a full constant intmap with that value, which is then diagonalized to get back to the original <code>m</code>."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 6, "last_activity_date": 1571519073, "creation_date": 1571519073, "answer_id": 58467991, "question_id": 58467954, "link": "https://stackoverflow.com/questions/58467954/are-there-examples-of-functors-in-haskell-which-fails-to-be-monads-because-we-ca/58467991#58467991", "title": "Are there examples of functors in Haskell which fails to be monads because we cannot implement `return`?", "body": "<p>I guess if there's no constructor, we can't call one:</p>\n\n<pre><code>{-# LANGUAGE EmptyCase #-}\ndata Whoops a\ninstance Functor Whoops where fmap f v = case v of\n</code></pre>\n\n<p><strong>EDIT</strong> In fact, this is mentioned at the linked question: have a search for the <code>Dead</code> type that pigworker uses to show how something can be a functor but not applicative.</p>\n"}, {"comments": [{"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1571558449, "post_id": 58468022, "comment_id": 103275740, "body": "This is unfair though as a map is a <i>bi</i>-functor. By parametricity, it is impossible to define a value of its left type out of nowhere. For instance, see <a href=\"https://stackoverflow.com/questions/38415374\">how <code>Applicative</code> is done for tuples</a> <i>(which are also bifunctors)</i>. So, if a map is an example, then <code>(x, y)</code> is also."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 3, "creation_date": 1571576312, "post_id": 58468022, "comment_id": 103279599, "body": "@IgnatInsarov I don&#39;t think it&#39;s unfair at all. All bifunctors are trivially also functors. And yes, both maps and tuples are examples."}, {"owner": {"reputation": 5613, "user_id": 2339708, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/dL2a0.jpg?s=128&g=1", "display_name": "Eli Rose", "link": "https://stackoverflow.com/users/2339708/eli-rose"}, "edited": false, "score": 0, "creation_date": 1571584563, "post_id": 58468022, "comment_id": 103281874, "body": "Are these maps functors?"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 5613, "user_id": 2339708, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/dL2a0.jpg?s=128&g=1", "display_name": "Eli Rose", "link": "https://stackoverflow.com/users/2339708/eli-rose"}, "edited": false, "score": 0, "creation_date": 1571588018, "post_id": 58468022, "comment_id": 103282753, "body": "@EliRose Yes, over their values."}, {"owner": {"reputation": 5613, "user_id": 2339708, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/dL2a0.jpg?s=128&g=1", "display_name": "Eli Rose", "link": "https://stackoverflow.com/users/2339708/eli-rose"}, "edited": false, "score": 0, "creation_date": 1571591045, "post_id": 58468022, "comment_id": 103283654, "body": "@JosephSible I understand you to mean that <code>HashMap Int</code> is a functor, but HashMap by itself is not (it is a bifunctor) \u2014 is that correct?"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 5613, "user_id": 2339708, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/dL2a0.jpg?s=128&g=1", "display_name": "Eli Rose", "link": "https://stackoverflow.com/users/2339708/eli-rose"}, "edited": false, "score": 1, "creation_date": 1571594357, "post_id": 58468022, "comment_id": 103284472, "body": "@EliRose <code>HashMap Int</code> is a functor, but <code>HashMap</code> is not a bifunctor for the same reason that sets aren&#39;t functors."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 5613, "user_id": 2339708, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/dL2a0.jpg?s=128&g=1", "display_name": "Eli Rose", "link": "https://stackoverflow.com/users/2339708/eli-rose"}, "edited": false, "score": 0, "creation_date": 1571623978, "post_id": 58468022, "comment_id": 103290218, "body": "@EliRose, what you&#39;d particularly want to do, I think, is consider <code>HashMap</code> a (constrained) profunctor. A <code>HashMap</code> represents a partial function from keys to values, so it&#39;s reasonable to think about composing it with functions on either side. On one side, you get <code>fmap</code>. On the other, you get nothing ... unless you have a way to calculate a (partial) inverse of the function. The partial inverse concept leads to the bifunctor idea, which itself needs to be constrained. But I see it as a pretty awkward hack from the start."}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 8, "last_activity_date": 1571588296, "last_edit_date": 1571588296, "creation_date": 1571519336, "answer_id": 58468022, "question_id": 58467954, "link": "https://stackoverflow.com/questions/58467954/are-there-examples-of-functors-in-haskell-which-fails-to-be-monads-because-we-ca/58468022#58468022", "title": "Are there examples of functors in Haskell which fails to be monads because we cannot implement `return`?", "body": "<p>This is exactly what <a href=\"https://hackage.haskell.org/package/semigroupoids-5.3.3/docs/Data-Functor-Bind.html#t:Bind\" rel=\"nofollow noreferrer\">the <code>Bind</code> typeclass</a> represents: things that have a bind operation, but not necessarily return. Here's some types that are instances of <code>Bind</code>, but aren't instances of <code>Monad</code> because they don't have <code>return</code>:</p>\n\n<ul>\n<li><code>(,) w</code>,<code>WriterT w m</code>, and <code>RWST r w s m</code>, whenever <code>w</code> is a <code>Semigroup</code> but not a <code>Monoid</code></li>\n<li><code>Map k</code>, <code>HashMap k</code>, and <code>IntMap k</code></li>\n<li><a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/GHC-Generics.html#t:V1\" rel=\"nofollow noreferrer\"><code>V1</code></a> (note: this is isomorphic to <a href=\"https://stackoverflow.com/a/58467991/7509065\">Daniel Wagner's <code>Whoops</code></a> and <a href=\"https://stackoverflow.com/a/7220865/7509065\">pigworker's <code>Dead</code></a>)</li>\n</ul>\n"}], "owner": {"reputation": 5613, "user_id": 2339708, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/dL2a0.jpg?s=128&g=1", "display_name": "Eli Rose", "link": "https://stackoverflow.com/users/2339708/eli-rose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 58468022, "answer_count": 2, "score": 5, "last_activity_date": 1571588296, "creation_date": 1571518799, "question_id": 58467954, "link": "https://stackoverflow.com/questions/58467954/are-there-examples-of-functors-in-haskell-which-fails-to-be-monads-because-we-ca", "title": "Are there examples of functors in Haskell which fails to be monads because we cannot implement `return`?", "body": "<p>Are there any examples of functors in Haskell which fail to be monads because we cannot implement <code>return</code>?</p>\n\n<p>I have seen <a href=\"https://stackoverflow.com/a/49703783/2339708\">this answer</a> and am inspired by it.</p>\n\n<p>Intuitively it seems that we can always implement <code>return</code> by using the type constructor. But I must be missing something.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1571517714, "post_id": 58467754, "comment_id": 103270076, "body": "Your current function checks all numbers up to half of <code>n</code>, and you want to change it so it checks up to the square root of <code>n</code> instead? I&#39;m pretty confident that you can work out for yourself how to change your function to do that."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": -1, "last_activity_date": 1571517824, "creation_date": 1571517824, "answer_id": 58467829, "question_id": 58467754, "link": "https://stackoverflow.com/questions/58467754/haskell-get-divisors-efficiently/58467829#58467829", "title": "Haskell get divisors efficiently", "body": "<p>Given a number <em>n</em> is dividable by <em>k</em>, then <em>n/k</em> is a divisor of <em>n</em> as well. Indeed, since <em>n/(n/k)=k</em>. If <em>k&gt;&radic;n</em>, we thus know that <em>k/n&lt;&radic;n</em>, and therefore, instead of calculating all the divisors, we can each time we find a divisor, yield the \"co-divisor\" as well.</p>\n\n<p>We thus can implement the algorithm as follows:</p>\n\n<pre><code>divisors :: Integral a =&gt; a -&gt; [a]\ndivisors n = concatMap f (filter ((==) 0 . mod n) (takeWhile (\\k -&gt; k*k &lt;= n) [1 .. n]))\n    where f k | k &lt; l = [k, l]\n              | otherwise = [k]\n              where l = div n k</code></pre>\n\n<p>Here we thus first use <code>takeWhile (\\k -&gt; k*k &lt;= n) [1 .. n]</code> to create a list from <code>1</code> until (and including if it is integral) <code>&radic;n</code>).</p>\n\n<p>Next we filter these elements, and only retain those that divide <code>n</code>. Finally for each of these elements, we check if the co-divisor is different. If that is the case, we both yield <code>k</code> and the co-divisor <code>l</code>, otherwise (this will only be the case for <code>&radic;n</code>), we only yield <code>k</code>.</p>\n\n<p>For example:</p>\n\n<pre><code>Prelude Data.List&gt; divisors 1425\n[1,1425,3,475,5,285,15,95,19,75,25,57]\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 10264600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b841979464b11a302f56ce496febbaa?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah Xoxo", "link": "https://stackoverflow.com/users/10264600/sarah-xoxo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "closed_date": 1571521844, "answer_count": 1, "score": 2, "last_activity_date": 1571522604, "creation_date": 1571517229, "question_id": 58467754, "link": "https://stackoverflow.com/questions/58467754/haskell-get-divisors-efficiently", "closed_reason": "Duplicate", "title": "Haskell get divisors efficiently", "body": "<p>I want to efficiently find the proper divisors of an integer n.</p>\n\n<p>How can I do this?</p>\n\n<p>For now I\u00b4m using the following function</p>\n\n<pre><code>divisors :: (Integral a) =&gt; a -&gt; [a]\ndivisors n = filter ((0 ==) . (n `mod`)) [1 .. (n `div` 2)]\n</code></pre>\n\n<p>But I have read that it is more efficient when I only check for the numbers until the square root of n. Have you got any suggestions how to solve it with the square root?</p>\n"}, {"tags": ["haskell", "radio-button", "haskell-miso"], "comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1571518258, "post_id": 58466586, "comment_id": 103270206, "body": "I&#39;m not a frontend or <code>miso</code> expert. But you probably can use one of the events. Like <code>onChecked</code> or <code>onClick</code>. Just need to check which one works... <a href=\"http://hackage.haskell.org/package/miso-1.2.0.0/docs/Miso-Html-Event.html#v:onChecked\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/miso-1.2.0.0/docs/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "is_accepted": false, "score": 1, "last_activity_date": 1571853781, "creation_date": 1571853781, "answer_id": 58528635, "question_id": 58466586, "link": "https://stackoverflow.com/questions/58466586/reading-radio-button-value-in-haskell-miso/58528635#58528635", "title": "Reading radio button value in Haskell Miso", "body": "<p>I got a solution thanks to <code>dmjio</code>. Here's an example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>newtype Model = Model\n  { _editorOrIde :: EditorOrIde\n  } deriving (Show, Eq)\n\ndata EditorOrIde =\n    Atom\n  | VisualStudioCode\n  | IntelliJIdeaCommunity\n  | SublimeText3\n  | Leksah\n  deriving (Show, Eq)\n\nmakeLenses ''Model\n\n-- | Sum type for application events\ndata Action\n  = NoOp\n  | SetChecked EditorOrIde Checked\n  | Install\n  deriving (Show, Eq)\n\n-- | Entry point for a miso application\nmain :: IO ()\nmain = JSaddle.run 8080 $ startApp App {..}\n  where\n    initialAction = NoOp -- initial action to be executed on application load\n    model  = Model Atom           -- initial model\n    update = updateModel          -- update function\n    view   = viewModel            -- view function\n    events = defaultEvents        -- default delegated events\n    subs   = []                   -- empty subscription list\n    mountPoint = Nothing          -- mount point for application (Nothing defaults to 'body')\n\n-- | Updates model, optionally introduces side effects\nupdateModel :: Action -&gt; Model -&gt; Effect Action Model\nupdateModel NoOp m = noEff m\nupdateModel (SetChecked editorOrIde_ (Checked True)) m = noEff $ m &amp; editorOrIde .~ editorOrIde_\nupdateModel (SetChecked _ _) m = noEff m\nupdateModel Install m = m &lt;# do\n  liftIO runSetup &gt;&gt; pure NoOp\n  where\n    runSetup = case _editorOrIde m of\n                 Atom -&gt; nixOsAtom\n                 _    -&gt; putStrLn \"Not implemented yet\"\n\nclickHandler :: action -&gt; Attribute action\nclickHandler action = onWithOptions (defaultOptions { preventDefault = True }) \"click\" emptyDecoder $ \\() -&gt; action\n\n-- | Constructs a virtual DOM from a model\nviewModel :: Model -&gt; View Action\nviewModel m = form_ [] [\n   link_ [ rel_ \"stylesheet\", href_ \"https://cdn.jsdelivr.net/npm/bulma@0.8.0/css/bulma.min.css\" ]\n , h5_ [ class_ \"title is-5\" ] [ text \"Easy Haskell Editor / IDE Setup\" ]\n , div_ [ class_ \"control\" ] [\n     \"Editor / IDE\"\n   , br_ []\n   , label_ [ class_ \"radio\" ] [\n         input_ [ type_ \"radio\", name_ \"editor\", checked_ (_editorOrIde m == Atom), onChecked (SetChecked Atom) ]\n       , \"Atom\"\n     ]\n   , label_ [ class_ \"radio\" ] [\n         input_ [ type_ \"radio\", name_ \"editor\", checked_ (_editorOrIde m == VisualStudioCode), onChecked (SetChecked VisualStudioCode) ]\n       , \"Visual Studio Code\"\n     ]\n   , label_ [ class_ \"radio\" ] [\n         input_ [ type_ \"radio\", name_ \"editor\", checked_ (_editorOrIde m == IntelliJIdeaCommunity), onChecked (SetChecked IntelliJIdeaCommunity), disabled_ True ]\n       , \"IntelliJ IDEA Community\"\n     ]\n   , label_ [ class_ \"radio\" ] [\n         input_ [ type_ \"radio\", name_ \"editor\", checked_ (_editorOrIde m == SublimeText3), onChecked (SetChecked SublimeText3), disabled_ True ]\n       , \"Sublime Text 3\"\n     ]\n   , label_ [ class_ \"radio\" ] [\n         input_ [ type_ \"radio\", name_ \"editor\", checked_ (_editorOrIde m == Leksah), onChecked (SetChecked Leksah), disabled_ True ]\n       , \"Leksah\"\n     ]\n ]\n , br_ []\n , button_ [ clickHandler Install , class_ \"button\" ] [ text \"Install\" ]\n ]\n</code></pre>\n"}], "owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1571853781, "creation_date": 1571508272, "question_id": 58466586, "link": "https://stackoverflow.com/questions/58466586/reading-radio-button-value-in-haskell-miso", "title": "Reading radio button value in Haskell Miso", "body": "<p>I added radio buttons to the miso sample-app: <a href=\"https://gist.github.com/razvan-flavius-panda/913c1e1c2a12ebd33eb33e6efb55dafe#file-main-hs-L46-L49\" rel=\"nofollow noreferrer\">https://gist.github.com/razvan-flavius-panda/913c1e1c2a12ebd33eb33e6efb55dafe#file-main-hs-L46-L49</a></p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- | Haskell language pragma\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE RecordWildCards #-}\n\n-- | Haskell module declaration\nmodule Main where\n\n-- | Miso framework import\nimport Miso\nimport Miso.String\nimport Language.Javascript.JSaddle.Warp as JSaddle\nimport Control.Monad.IO.Class (liftIO)\n\n-- | Type synonym for an application model\ntype Model = Int\n\n-- | Sum type for application events\ndata Action\n  = NoOp\n  | Install\n  deriving (Show, Eq)\n\n-- | Entry point for a miso application\nmain :: IO ()\nmain = JSaddle.run 8080 $ startApp App {..}\n  where\n    initialAction = NoOp -- initial action to be executed on application load\n    model  = 0                    -- initial model\n    update = updateModel          -- update function\n    view   = viewModel            -- view function\n    events = defaultEvents        -- default delegated events\n    subs   = []                   -- empty subscription list\n    mountPoint = Nothing          -- mount point for application (Nothing defaults to 'body')\n\n-- | Updates model, optionally introduces side effects\nupdateModel :: Action -&gt; Model -&gt; Effect Action Model\nupdateModel NoOp m = noEff m\nupdateModel Install m = m &lt;# do\n  liftIO (putStrLn \"Hello World\") &gt;&gt; pure NoOp\n\n-- | Constructs a virtual DOM from a model\nviewModel :: Model -&gt; View Action\nviewModel x = div_ [] [\n   label_ [] [ text \"Editor / IDE\" ]\n , br_ []\n , label_ [] [ text \"Atom\" ]\n , input_ [ type_ \"radio\", name_ \"editor\", value_ \"Atom\" ]\n , label_ [] [ text \"Visual Studio Code\" ]\n , input_ [ type_ \"radio\", name_ \"editor\", value_ \"VSCode\", disabled_ True ]\n , br_ []\n , text (ms x)\n , button_ [ onClick Install ] [ text \"Install\" ]\n ]\n</code></pre>\n\n<p>What changes do I need to make to be able to read the state of the selected radio button inside the <code>updateModel Install m</code> function?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1571505245, "post_id": 58466097, "comment_id": 103266913, "body": "Well the compiler hints that here you do not have a case for the emtpy list."}, {"owner": {"reputation": 2624, "user_id": 1289801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/8a1c3093e5ea650e39c4a875f62a0bd4?s=128&d=identicon&r=PG", "display_name": "TMOTTM", "link": "https://stackoverflow.com/users/1289801/tmottm"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1571505322, "post_id": 58466097, "comment_id": 103266931, "body": "OK, then I&#39;ll add <code>[] = 0</code>, but i&#39;d rather return something like an exception."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1571505797, "post_id": 58466097, "comment_id": 103267045, "body": "Don&#39;t return <code>0</code>. As you say, it&#39;s better to return <code>error &quot;getMax: empty list</code>. A crash is easier to debug than a wrong value. Alternatively, make <code>getMax :: [Int] -&gt; Maybe Int</code> so that you can return <code>Nothing</code> when the list is empty, and <code>Just theMax</code> otherwise."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1571505487, "creation_date": 1571505487, "answer_id": 58466151, "question_id": 58466097, "link": "https://stackoverflow.com/questions/58466097/haskell-why-is-the-pattern-matching-not-exhaustive-even-if-it-compiles-and-exec/58466151#58466151", "title": "Haskell: Why is the pattern matching not exhaustive even if it compiles and executes?", "body": "<blockquote>\n  <p>Does it need a pattern for the empty list?</p>\n</blockquote>\n\n<p>Not <em>per se</em>, since it is just a warning. As long as you never pass it an empty list, it will here work fine. But it is up to you to check that, and you can never be sure that somehow an empty list will be passed.</p>\n\n<blockquote>\n  <p>What's a reasonable return value then? Zero? Can I return something like <code>undefined</code>?</p>\n</blockquote>\n\n<p>That is of course up to you to decide. You probably might want to make a distinction between the result of an empty list an a non-empty list. In Haskell usually therefore a <code>Maybe</code> is used. For example:</p>\n\n<pre><code>getMax :: [Int] -&gt; <b>Maybe</b> Int\ngetMax [] = <b>Nothing</b>\ngetMax [a] = <b>Just</b> a\ngetMax (a:b:as) = getMax ((if a &gt;= b then a else b):as)</code></pre>\n\n<p>or you can change the input, such that it is for example impossible to pass a non-empty list. We can here work with two parameters, so the signature is then <code>getMax :: Int -&gt; [Int] -&gt; Int</code>. Here the first parameter is the \"head\" of the list, and the second is the tail of the list:</p>\n\n<pre><code>getMax :: <b>Int</b> -&gt; [Int] -&gt; Int\ngetMax a [] = a\ngetMax a (b:as) = getMax (if a &gt;= b then a else b) as</code></pre>\n\n<p>Using <code>undefined</code> is usually not a good idea. Yes than we no longer have a non-exhaustive pattern, but evaluating the <code>undefined</code> will raise an error. So it is only trading one problem for another one.</p>\n"}, {"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1571515565, "creation_date": 1571515565, "answer_id": 58467556, "question_id": 58466097, "link": "https://stackoverflow.com/questions/58466097/haskell-why-is-the-pattern-matching-not-exhaustive-even-if-it-compiles-and-exec/58467556#58467556", "title": "Haskell: Why is the pattern matching not exhaustive even if it compiles and executes?", "body": "<p>If your function can only work on non-empty lists, then you should indicate that in its type:</p>\n\n<pre><code>import Data.List.NonEmpty (NonEmpty(..))\n\ngetMax :: NonEmpty Int -&gt; Int\ngetMax (a:|[]) = a\ngetMax (a:|b:as) = getMax ((if a &gt;= b then a else b):|as)\n</code></pre>\n\n<p>This is strictly more useful than using <code>Maybe</code> directly, as then you don't have to handle a <code>Nothing</code> that can never happen if you're sure the list isn't empty. (And if you're not sure, then you can call <code>fmap getMax . <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List-NonEmpty.html#v:nonEmpty\" rel=\"nofollow noreferrer\">nonEmpty</a></code> instead, which is exactly the same as <code>getMax</code> would be had it used <code>Maybe</code>.)</p>\n"}], "owner": {"reputation": 2624, "user_id": 1289801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/8a1c3093e5ea650e39c4a875f62a0bd4?s=128&d=identicon&r=PG", "display_name": "TMOTTM", "link": "https://stackoverflow.com/users/1289801/tmottm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 58466151, "answer_count": 2, "score": 4, "last_activity_date": 1571515691, "creation_date": 1571505090, "last_edit_date": 1571515691, "question_id": 58466097, "link": "https://stackoverflow.com/questions/58466097/haskell-why-is-the-pattern-matching-not-exhaustive-even-if-it-compiles-and-exec", "title": "Haskell: Why is the pattern matching not exhaustive even if it compiles and executes?", "body": "<p>Learning Haskell, bit confused about the code hint here:</p>\n\n<pre><code>getMax :: [Int] -&gt; Int\ngetMax [a] = a\ngetMax (a:b:as) = getMax ((if a &gt;= b then a else b):as)\n</code></pre>\n\n\n\n<pre><code>Pattern match(es) are non-exhaustive\nIn an equation for \u2018getMax\u2019: Patterns not matched: []\n</code></pre>\n\n<p>It works and finds the max of eg <code>[5, 2, 6]</code>. Does it need a pattern for the empty list? What's a reasonable return value then? Zero? Can I return something like <code>undefined</code>?</p>\n"}, {"tags": ["haskell", "import", "ghci"], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1571504320, "creation_date": 1571504320, "answer_id": 58465972, "question_id": 58465867, "link": "https://stackoverflow.com/questions/58465867/no-instance-error-when-importing-custom-module-in-ghci/58465972#58465972", "title": "&#39;no instance&#39; error when importing custom module in ghci", "body": "<p>The type of <code>main</code> is required to be <code>IO ()</code>.</p>\n\n<p>The type of <code>sqrt 25</code> is, apparently, <code>Fractional t =&gt; t</code> (it is really advisable to always include type signatures for your top-level entities in the program; you miss those).</p>\n\n<p>To reconcile the two you can define e.g.</p>\n\n<pre><code>main :: IO ()\nmain = print (sqrt 25)\n</code></pre>\n\n<p>because the type of <code>print</code> is <code>print :: Show a =&gt; a -&gt; IO ()</code>.</p>\n"}], "owner": {"reputation": 25, "user_id": 6182137, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-iCQymWdmOLU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfZ13mOv03YzmAz7Mvnq_rAc0YsVg/mo/photo.jpg?sz=128", "display_name": "Erik", "link": "https://stackoverflow.com/users/6182137/erik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1571504320, "creation_date": 1571503604, "question_id": 58465867, "link": "https://stackoverflow.com/questions/58465867/no-instance-error-when-importing-custom-module-in-ghci", "title": "&#39;no instance&#39; error when importing custom module in ghci", "body": "<p>I am trying to import a custom module into main using ghci and I am getting this error I don't really understand.</p>\n\n<p>Main.hs</p>\n\n<pre><code>module Main where\n\nimport Newton (my_sqrt)\n\nmain = my_sqrt 25\n</code></pre>\n\n<p>Newton.hs</p>\n\n<pre><code>module Newton where\n\nderiv f x = (f(x + dx) - f(x))/dx\n    where dx = 0.0001\n\n\nnewton f = until satis improve\n    where   satis y = abs(f y) &lt; eps\n            eps = 0.0001\n            improve y = y - (f y/deriv f y)\n\n\nmy_sqrt x = newton f x\n    where f y = y^2 - x\n\nmy_cubrt x = newton f x\n    where f y = y**3 - x\n</code></pre>\n\n<p>I try to load these into ghci using</p>\n\n<pre><code>:l Main.hs\n</code></pre>\n\n<p>I get this error</p>\n\n<pre><code>Main.hs:9:8: error:\n    \u2022 No instance for (Fractional (IO t0))\n        arising from a use of \u2018my_sqrt\u2019\n    \u2022 In the expression: my_sqrt 25\n      In an equation for \u2018main\u2019: main = my_sqrt 25\n\nMain.hs:9:16: error:\n    \u2022 No instance for (Num (IO t0)) arising from the literal \u201825\u2019\n    \u2022 In the first argument of \u2018my_sqrt\u2019, namely \u201825\u2019\n      In the expression: my_sqrt 25\n      In an equation for \u2018main\u2019: main = my_sqrt 25\nFailed, modules loaded: Newton.\n\n</code></pre>\n\n<p>How do I solve this issue?</p>\n"}, {"tags": ["haskell", "math", "functional-programming"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1571501157, "post_id": 58465452, "comment_id": 103265803, "body": "@WillNess I don&#39;t think the problem says what you think it says."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1571501207, "post_id": 58465452, "comment_id": 103265815, "body": "Is this a homework? If yes, can you quote the assignment verbatim?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1571505116, "post_id": 58465452, "comment_id": 103266878, "body": "There are more problems here than you can shake a stick at. An aliquot sequence cannot continue past 1 since the sum of proper divisors of 1 is 0. Sum of proper divisors of <code>23</code> is <code>1</code>. Sum of proper divisors of <code>24</code> is <code>36</code>. An aliquot sequence is not necessarily periodic but might have an initial subsequence that does not repeat (95,25,6,6,6...)."}, {"owner": {"reputation": 145, "user_id": 5660226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1b53552f856d3d4007d66331b3b73aaf?s=128&d=identicon&r=PG&f=1", "display_name": "schoeberlt", "link": "https://stackoverflow.com/users/5660226/schoeberlt"}, "edited": false, "score": 0, "creation_date": 1571505962, "post_id": 58465452, "comment_id": 103267091, "body": "I know, this is just a starting place I found online. I could solve those problems - the problem I asked here is plain and simple. I solved it by not running into the problem in the first place."}, {"owner": {"reputation": 145, "user_id": 5660226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1b53552f856d3d4007d66331b3b73aaf?s=128&d=identicon&r=PG&f=1", "display_name": "schoeberlt", "link": "https://stackoverflow.com/users/5660226/schoeberlt"}, "edited": false, "score": 0, "creation_date": 1571506077, "post_id": 58465452, "comment_id": 103267133, "body": "I updated the code in the Q."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1571506247, "post_id": 58465452, "comment_id": 103267196, "body": "Wow. This needs to become the new textbook example of the <a href=\"https://meta.stackexchange.com/q/66377/386992\">XY problem</a>. Your &quot;x&quot; is the easy problem &quot;how do I generate an aliquot sequence&quot;, and your &quot;y&quot; is the literally impossible &quot;how do I find the period of an infinite list&quot;."}, {"owner": {"reputation": 145, "user_id": 5660226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1b53552f856d3d4007d66331b3b73aaf?s=128&d=identicon&r=PG&f=1", "display_name": "schoeberlt", "link": "https://stackoverflow.com/users/5660226/schoeberlt"}, "edited": false, "score": 0, "creation_date": 1571509921, "post_id": 58465452, "comment_id": 103268110, "body": "Thanks for the link. Wow indeed. It would be however easy to solve if I were to look for the first occurence of the original Integer, or am I missing something?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1571510791, "post_id": 58465452, "comment_id": 103268356, "body": "It is not known whether all aliquot sequences are periodic. Some of them might be infinite and unbounded. If your assignment says &quot;return the aliquot sequence&quot;, then you <i>probably</i> should return an infinite sequence without trying to cut off the repeating part. If it says something else, you might just as well tell us what it actually says. It&#39;s included in the price."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1571555131, "post_id": 58465452, "comment_id": 103275222, "body": "@n.m. I&#39;ve made an edit so the point becomes clear which I think you had in mind."}], "answers": [{"comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1571502450, "post_id": 58465648, "comment_id": 103266160, "body": "This is all fine and dandy, but all sequences in the question are finite, so let&#39;s just consider those."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 5, "creation_date": 1571502486, "post_id": 58465648, "comment_id": 103266170, "body": "@n.m. From the question: &quot;with infinite iterations&quot;"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1571502540, "post_id": 58465648, "comment_id": 103266185, "body": "I tend to trust code more than words. <code>[6,6,6,6,6]</code> is obviously finite."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1571503541, "post_id": 58465648, "comment_id": 103266456, "body": "It might be stipulated in the assignment that as soon as one of the previously seen elements is seen again, we may assume the cycle has been detected. i.e. this might be a constraint on the input numbers."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1571504113, "post_id": 58465648, "comment_id": 103266627, "body": "Or it might be that OP isn&#39;t using the word &quot;infinite&quot; properly. Perhaps the correct word is &quot;unlimited&quot;. I have no idea, maybe OP could chime in and answer the question I have asked in the comments. It&#39;s a rather futile effort otherwise. The question as it stands conflates two very different problems, one trivial (how to map through a list) and one less so (how to extract a period from a (finite?) periodic sequence). Such problems don&#39;t tend to occur as assignments in introductory courses. Perhaps OP mistranscribed it for SO."}, {"owner": {"reputation": 145, "user_id": 5660226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1b53552f856d3d4007d66331b3b73aaf?s=128&d=identicon&r=PG&f=1", "display_name": "schoeberlt", "link": "https://stackoverflow.com/users/5660226/schoeberlt"}, "edited": false, "score": 1, "creation_date": 1571504517, "post_id": 58465648, "comment_id": 103266719, "body": "It is indeed an infinite list. If you call the function in hugs, you can whatch the console printing [6,6,6,...] forever. Isn\u2018t that the definition of infinite? If I pass the list into anothjer function, it results in SO"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 145, "user_id": 5660226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1b53552f856d3d4007d66331b3b73aaf?s=128&d=identicon&r=PG&f=1", "display_name": "schoeberlt", "link": "https://stackoverflow.com/users/5660226/schoeberlt"}, "edited": false, "score": 2, "creation_date": 1571505486, "post_id": 58465648, "comment_id": 103266973, "body": "@schoeberlt hugs is obsolete for the last 10 years or so."}, {"owner": {"reputation": 145, "user_id": 5660226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1b53552f856d3d4007d66331b3b73aaf?s=128&d=identicon&r=PG&f=1", "display_name": "schoeberlt", "link": "https://stackoverflow.com/users/5660226/schoeberlt"}, "edited": false, "score": 0, "creation_date": 1571509970, "post_id": 58465648, "comment_id": 103268121, "body": "We can use ghci or whatever interpreter we want. But they require the code to run under hugs on a linux machine on campus"}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 6, "last_activity_date": 1571502165, "creation_date": 1571502165, "answer_id": 58465648, "question_id": 58465452, "link": "https://stackoverflow.com/questions/58465452/return-the-first-iteration-of-a-sequence-from-a-list-in-haskell/58465648#58465648", "title": "Return the first iteration of a sequence from a list in Haskell", "body": "<p>This isn't possible. Consider this sequence: <code>[1,1,1,1,1,1,1...</code> It looks like the answer here is <code>[1]</code>, right? Wrong. That sequence was actually the greatest common factor of (x^17 + 9) and ((x + 1)^17 + 9), which stops being all 1s once you get to the 8424432925592889329288197322308900672459420460792433rd element. Or consider this other sequence: <code>[1,1,1,1,1,1,1...</code>. The world's greatest mathematicians aren't sure what the answer is for this sequence. It's the smallest number ever reached by the Collatz sequence for each starting value, and although we've never found a number where this isn't 1, we haven't been able to actually prove that it will be 1 for all numbers.</p>\n"}], "owner": {"reputation": 145, "user_id": 5660226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1b53552f856d3d4007d66331b3b73aaf?s=128&d=identicon&r=PG&f=1", "display_name": "schoeberlt", "link": "https://stackoverflow.com/users/5660226/schoeberlt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1571555040, "creation_date": 1571500690, "last_edit_date": 1571555040, "question_id": 58465452, "link": "https://stackoverflow.com/questions/58465452/return-the-first-iteration-of-a-sequence-from-a-list-in-haskell", "title": "Return the first iteration of a sequence from a list in Haskell", "body": "<p>I have an array of sequences, with infinite iterations (e.g. [6,6,6,6,6] or [23, 24, 23, 24] or [1, 2, 3, 4, 1, 2, 3, 4])\nHow do I iterate through each such list in Haskell and return only the first iteration? In case of the above examples: [6]; [23, 24]; [1, 2, 3, 4]</p>\n\n<p>Thanks! </p>\n\n<p>Edit: Sorry, I wasn't precise. The lists are indeed infinte. My goal is to return a list of the aliquot sequence of a given Integer. I have a function which returns the sum of the dividers. I started a recursive call with the first sum, and constructed the list. That resulted in lists like [6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6...]. </p>\n\n<p>First I wanted to solve the problem by taking the first part of the list, up to the second occurrence of the original Int. But then it hit me: It's easier to check with <code>elem</code> if the sum exists in the list. If yes, return the list as-is. Otherwise, append the sum and go on. </p>\n\n<p>Edit 2: The code that produces the (in my definition at least) infinite list is the following chunk:</p>\n\n<pre><code>aliquot :: (Integral a) =&gt; a -&gt; [a]\naliquot 0 = []\naliquot 1 = [1]\naliquot n = n : (aliquot $ sum $ divisors n)\n\ndivisors :: (Integral a) =&gt; a -&gt; [a]\ndivisors n = filter ((0 ==) . (n `mod`)) [1 .. (n `div` 2)]\n</code></pre>\n"}, {"tags": ["haskell", "tree"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1571499387, "post_id": 58465208, "comment_id": 103265428, "body": "So, every path in the tree is just a permutation of <code>[1,2,3,4]</code> that starts with <code>1</code>?"}, {"owner": {"reputation": 500, "user_id": 11303290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5926bac6c5617d83b1af462ded299752?s=128&d=identicon&r=PG&f=1", "display_name": "llamaro25", "link": "https://stackoverflow.com/users/11303290/llamaro25"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1571499442, "post_id": 58465208, "comment_id": 103265439, "body": "@chepner yeah, that&#39;s right"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1571500052, "post_id": 58465208, "comment_id": 103265552, "body": "What&#39;s the trouble you&#39;re having?"}, {"owner": {"reputation": 500, "user_id": 11303290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5926bac6c5617d83b1af462ded299752?s=128&d=identicon&r=PG&f=1", "display_name": "llamaro25", "link": "https://stackoverflow.com/users/11303290/llamaro25"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1571500089, "post_id": 58465208, "comment_id": 103265557, "body": "@MichaelLitchard I&#39;m not sure how to piece the code that grows the tree downwards and sideways together to get the tree that I want"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1571500476, "post_id": 58465208, "comment_id": 103265643, "body": "The tricky part is that doing this isn&#39;t simply a composition of the two techniques. The list of integers available to choose from at each level changes from branch to branch."}, {"owner": {"reputation": 500, "user_id": 11303290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5926bac6c5617d83b1af462ded299752?s=128&d=identicon&r=PG&f=1", "display_name": "llamaro25", "link": "https://stackoverflow.com/users/11303290/llamaro25"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1571500565, "post_id": 58465208, "comment_id": 103265664, "body": "@chepner oh. do you have any ideas on how I can approach this"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1571503337, "creation_date": 1571503337, "answer_id": 58465835, "question_id": 58465208, "link": "https://stackoverflow.com/questions/58465208/how-to-build-a-tree-sideways-and-downwards/58465835#58465835", "title": "How to build a tree sideways and downwards?", "body": "<p>We can introduce a helper function <code>pick</code> that will generate a list of 2-tuples with the item we picked, and return the remaining list. We can implement this with a difference list, but a simple, less efficient implementation is:</p>\n\n<pre><code>import Data.List(tails, inits)\n\npick :: [a] -&gt; [(a, [a])]\npick vs = [(x, ws ++ xs) | (ws, (x:xs)) &lt;- zip (inits vs) (tails vs) ]\n</code></pre>\n\n<p>Then we thus retrieve:</p>\n\n<pre><code>Prelude Data.List&gt; pick [2,3,4]\n[(2,[3,4]),(3,[2,4]),(4,[2,3])]\n</code></pre>\n\n<p>Now we can change your <code>down</code> function:</p>\n\n<pre><code>down :: a -&gt; [a] -&gt; Tree a\ndown y = Node y . map (uncurry down) . pick\n</code></pre>\n\n<p>For the given sample data, we then get:</p>\n\n<pre><code>Prelude Data.List&gt; down 1 [2,3,4]\nNode 1 [Node 2 [Node 3 [Node 4 []],Node 4 [Node 3 []]],Node 3 [Node 2 [Node 4 []],Node 4 [Node 2 []]],Node 4 [Node 2 [Node 3 []],Node 3 [Node 2 []]]]\n</code></pre>\n"}], "owner": {"reputation": 500, "user_id": 11303290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5926bac6c5617d83b1af462ded299752?s=128&d=identicon&r=PG&f=1", "display_name": "llamaro25", "link": "https://stackoverflow.com/users/11303290/llamaro25"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 58465835, "answer_count": 1, "score": 2, "last_activity_date": 1571503337, "creation_date": 1571499188, "last_edit_date": 1571500389, "question_id": 58465208, "link": "https://stackoverflow.com/questions/58465208/how-to-build-a-tree-sideways-and-downwards", "title": "How to build a tree sideways and downwards?", "body": "<p>How can I build a tree downwards and horizontally? </p>\n\n<p>I current have a tree:</p>\n\n<pre><code>data Tree a = Node a [Tree a]\n</code></pre>\n\n<p>Then, I have a root <code>Int</code> and list of <code>[Int]</code></p>\n\n<pre><code>1 and [2,3,4]\n</code></pre>\n\n<p>I want to build a tree like</p>\n\n<pre><code>       1\n    /  |  \\\n   2   3   4\n  /\\  / \\  /\\\n 3  4 2 4 2  3\n |  | | | |  |\n 4  3 4 2 3  2 \n</code></pre>\n\n<p>In Haskell, it looks like </p>\n\n<pre><code>Node 1 [Node 2 [Node 3 [Node 4 []],Node 4[Node 3 []]], Node 3 [Node 2 [Node 4 []], \nNode 4 [Node 2 []]], Node 4 [Node 2 [Node 3 []], Node 3 [Node 2 []]]]\n</code></pre>\n\n<p>Here's what I've tried:\nThis code grows my tree downwards</p>\n\n<pre><code>down\u00a0::\u00a0Int\u00a0-&gt;\u00a0[Int]\u00a0-&gt;\u00a0Tree\u00a0Int\ndown\u00a0y\u00a0[]\u00a0=\u00a0Node\u00a0y\u00a0[]\ndown\u00a0y\u00a0(x:xs)\u00a0=\u00a0Node\u00a0y\u00a0[down\u00a0x\u00a0xs]\n</code></pre>\n\n<p>This code grows my tree sideways</p>\n\n<pre><code>side :: Int -&gt; [Int] -&gt; Tree Int\nside y [] = Node y []\nside y x = Node y $ map (\\x -&gt; Node x []) y\n</code></pre>\n\n<p>Now, I'm having trouble piecing it together to get the solution above. Any help is appreciated</p>\n"}, {"tags": ["haskell", "tree", "artificial-intelligence", "minimax"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1571488655, "post_id": 58463720, "comment_id": 103262885, "body": "It&#39;s hard to offer much guidance without seeing any code. But logically, if you&#39;ve got everything set up that you describe, you&#39;ve done all the hard work - all that remains is to write a recursive function which, given a tree, calculates the best move according to your heuristic."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1571488704, "post_id": 58463720, "comment_id": 103262901, "body": "Please share your attempt together with sample data and expected output."}, {"owner": {"reputation": 29, "user_id": 12097918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/119398ea7f25ffef2178febafbea11a0?s=128&d=identicon&r=PG&f=1", "display_name": "anon0987654321", "link": "https://stackoverflow.com/users/12097918/anon0987654321"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1571552052, "post_id": 58463720, "comment_id": 103274784, "body": "@RobinZigmond I edited the post to include a photo. I hope it&#39;s easier to understand. Basically need a function that turns the [Rose a ] at the top of the photo to the Rose a at the bottom."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 12097918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/119398ea7f25ffef2178febafbea11a0?s=128&d=identicon&r=PG&f=1", "display_name": "anon0987654321", "link": "https://stackoverflow.com/users/12097918/anon0987654321"}, "edited": false, "score": 0, "creation_date": 1571799845, "post_id": 58509274, "comment_id": 103356672, "body": "Thanks. I ended up figuring it out but this implementation is a lot cleaner and more efficient."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 1, "last_activity_date": 1571764307, "creation_date": 1571764307, "answer_id": 58509274, "question_id": 58463720, "link": "https://stackoverflow.com/questions/58463720/stuck-with-minimax-algorithm-what-next-haskell/58509274#58509274", "title": "stuck with minimax algorithm - what next? Haskell", "body": "<p>Well, you don't actually need to build a tree with updated scores.  You just need to calculate the best move (the one that maximizes the minimum, worst-case score).</p>\n\n<p>So, start with some preliminaries:</p>\n\n<pre><code>import Data.List\nimport Data.Ord\n\ntype Position = (Int,Int)\ntype Score = Int\ndata Rose a = Rose a [Rose a]\n</code></pre>\n\n<p>We can write a function that takes a list of move trees and selects the move (aka <code>Position</code>) that results in the maximum of the minimum scores:</p>\n\n<pre><code>maximin :: [Rose (Position, Score)] -&gt; (Position, Score)\nmaximin = maximumBy (comparing snd) . map minscore\n</code></pre>\n\n<p>The helper <code>minscore</code> calculates the minimum score for a move tree, assuming best counterplay.</p>\n\n<pre><code>minscore :: Rose (Position, Score) -&gt; (Position, Score)\n</code></pre>\n\n<p>If we're at a leaf, our best estimate of the score is the direct heuristic evaluation of the current board, so we just return that position and score:</p>\n\n<pre><code>minscore (Rose x []) = x\n</code></pre>\n\n<p>Otherwise, we calculate the score from best counterplay using the opposite of <code>maximin</code>, namely <code>minimax</code>:</p>\n\n<pre><code>minscore (Rose (pos,_) moves)\n  = let (_,score) = minimax moves in (pos,score)\n</code></pre>\n\n<p>Note that <code>minscore</code> always returns the next move (<code>pos</code>) from the root of the tree, but the score will be taken from the root (for leaves) or by further recursive calculation (for nodes).</p>\n\n<p>The full definition of <code>maximin</code> and its mirror image <code>minimax</code> is:</p>\n\n<pre><code>maximin :: [Rose (Position, Score)] -&gt; (Position, Score)\nmaximin = maximumBy (comparing snd) . map minscore\n  where minscore (Rose x []) = x\n        minscore (Rose (pos,_) moves)\n          = let (_,score) = minimax moves in (pos,score)\n\nminimax :: [Rose (Position, Score)] -&gt; (Position, Score)\nminimax = minimumBy (comparing snd) . map maxscore\n  where maxscore (Rose x []) = x\n        maxscore (Rose (pos,_) moves)\n          = let (_,score) = maximin moves in (pos,score)\n</code></pre>\n\n<p>Applied to your pictorial example:</p>\n\n<pre><code>example = maximin\n  [Rose ((1,1),2) [Rose ((1,2),3) [], Rose ((1,3),-2) [], Rose ((1,4),4) []],\n   Rose ((2,2),3) [Rose ((2,3),-7) [], Rose ((2,4),-1) []],\n   Rose ((3,3),1) [Rose ((3,4),2) []]]\n</code></pre>\n\n<p>you get:</p>\n\n<pre><code>&gt; example\n((3,3),2)\n</code></pre>\n\n<p>which looks like what you wanted.</p>\n\n<p>A few notes on performance:</p>\n\n<ul>\n<li>The minimax algorithm doesn't actually use the heuristic scores of internal nodes, only at the leaves, so you might be better off processing a <code>[Rose Position]</code> and only calculating a heuristic score where you need it (when you detect a leaf in <code>minscore</code> or <code>maxscore</code>).</li>\n<li><a href=\"https://en.wikipedia.org/wiki/Alpha%E2%80%93beta_pruning\" rel=\"nofollow noreferrer\">Alpha-beta pruning</a> is a well-known optimization of the minimax algorithm, and ought to be used in any serious implementation.</li>\n</ul>\n\n<p>Anyway, the full code is:</p>\n\n<pre><code>import Data.List\nimport Data.Ord\n\ntype Position = (Int,Int)\ntype Score = Int\ndata Rose a = Rose a [Rose a]\n\nmaximin :: [Rose (Position, Score)] -&gt; (Position, Score)\nmaximin = maximumBy (comparing snd) . map minscore\n  where minscore (Rose x []) = x\n        minscore (Rose (pos,_) moves)\n          = let (_,score) = minimax moves in (pos,score)\n\nminimax :: [Rose (Position, Score)] -&gt; (Position, Score)\nminimax = minimumBy (comparing snd) . map maxscore\n  where maxscore (Rose x []) = x\n        maxscore (Rose (pos,_) moves)\n          = let (_,score) = maximin moves in (pos,score)\n\nexample = maximin\n  [Rose ((1,1),2) [Rose ((1,2),3) [], Rose ((1,3),-2) [], Rose ((1,4),4) []],\n   Rose ((2,2),3) [Rose ((2,3),-7) [], Rose ((2,4),-1) []],\n   Rose ((3,3),1) [Rose ((3,4),2) []]]\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 12097918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/119398ea7f25ffef2178febafbea11a0?s=128&d=identicon&r=PG&f=1", "display_name": "anon0987654321", "link": "https://stackoverflow.com/users/12097918/anon0987654321"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 587, "favorite_count": 0, "accepted_answer_id": 58509274, "answer_count": 1, "score": 0, "last_activity_date": 1571764307, "creation_date": 1571488338, "last_edit_date": 1571576661, "question_id": 58463720, "link": "https://stackoverflow.com/questions/58463720/stuck-with-minimax-algorithm-what-next-haskell", "title": "stuck with minimax algorithm - what next? Haskell", "body": "<p>I'm writing a basic MiniMax algorithm for a 2 player board game. So far I have a function that evaluates a board and returns a score. I have a function that returns a rose tree of all possible moves (and moves for those moves) etc... to a given depth. I can find the leaves of that tree and give them a value based of my heuristic and my question is what do I do after that? </p>\n\n<p>Do I somehow edit the parent of the leaves and assign the parent node a new value based on the children's value and keep going until I get to the root node?</p>\n\n<p>Am I meant to create a new tree from the leaves up, picking the min / max value until i get to the root node? If so, how does the new tree remember all the moves needed to get to the leaves?</p>\n\n<p>I only want to use imports from the standard library (I don't want to have to download a package). Any suggestions would be great, been struggling with this for a few days. \nThanks</p>\n\n<hr>\n\n<p>I tried to pick out some parts of my code to give examples but there's just a lot of functions tangled together. If it helps at all here are the type signatures for the main functions and an explanation of what they do:</p>\n\n<p>This function takes in an <code>Int</code> (representing <code>Depth</code> of tree),  a <code>Game</code> (current state of board), list of immediate possible moves and returns a rose tree with each possible move (and moves to those moves) and a score associated with that move. If player is Dark its score is positive, if player is dark its score is negative - each depth in the rose tree is the next players move.</p>\n\n<pre><code>roseTreeAtDepthN :: Int-&gt; Game -&gt; [Position] -&gt; [Rose (Position,score)]\n</code></pre>\n\n<p>For example: <code>treeAtDepthN 2 initialGame [(2,3),(3,2),(4,5),(5,4)]</code> returns : </p>\n\n<pre><code>[Rose ((2,3),4) [Rose ((2,2),-3) [],Rose ((2,4),-3) [],Rose ((4,2),-3) []],\n Rose ((3,2),4) [Rose ((2,2),-3) [],Rose ((2,4),-3) [],Rose ((4,2),-3) []],\n Rose ((4,5),4) [Rose ((3,5),-3) [],Rose ((5,3),-3) [],Rose ((5,5),-3) []],\n Rose ((5,4),4) [Rose ((3,5),-3) [],Rose ((5,3),-3) [],Rose ((5,5),-3) []]]\n</code></pre>\n\n<p>I have another function which allows me to get the leaves of a tree. I use the function that evaluates the game state in <code>treeAtDepthN</code> for each move  but I realize that probably isn't necessary and should only be used on the leaves of the tree. I'm not sure if this helps at all.</p>\n\n<hr>\n\n<p><em>later edit:</em></p>\n\n<p>Not sure what to do next for my minimax algorithm. I have a function that prints all possible moves to a certain depth, I have a heuristic that evaluates those each move, I'm just not sure how I turn it into one function that returns the best move. I only want to use functions given in the Haskell library (Don't want to download any packages ect).</p>\n\n<pre><code>data Rose a = Rose a [Rose a]\n    deriving Show\n</code></pre>\n\n<p>I thought I might be easier to understand if I drew a picture explaining the functions I have. I Have two solutions I can think of which are outlined in the picture, I'm not sure which approach I should go for, if any. : </p>\n\n<p><a href=\"https://i.stack.imgur.com/URs2e.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/URs2e.png\" alt=\"Imagine\"></a></p>\n\n<p>I guess I want a function that turns the [Rose a] at the top of the picture to the rose a at the bottom of the picture. </p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell", "tree", "non-exhaustive-patterns"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1571482777, "post_id": 58462972, "comment_id": 103261517, "body": "Your <code>rosesToRose</code> only has a pattern to process a list with <i>exactly</i> one element."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1571482852, "post_id": 58462972, "comment_id": 103261534, "body": "It furthermore looks a bit &quot;odd&quot; to let <code>maxRoseNode</code> use a list of <code>Rose a</code>s."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 12097918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/119398ea7f25ffef2178febafbea11a0?s=128&d=identicon&r=PG&f=1", "display_name": "anon0987654321", "link": "https://stackoverflow.com/users/12097918/anon0987654321"}, "edited": false, "score": 0, "creation_date": 1571483677, "post_id": 58463030, "comment_id": 103261725, "body": "Thanks. Just to confirm, the lambda expression in maxRoseNode is just evaluating the root of each node tree, instead of processing the whole tree - which increases the efficiency?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 29, "user_id": 12097918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/119398ea7f25ffef2178febafbea11a0?s=128&d=identicon&r=PG&f=1", "display_name": "anon0987654321", "link": "https://stackoverflow.com/users/12097918/anon0987654321"}, "edited": false, "score": 0, "creation_date": 1571483751, "post_id": 58463030, "comment_id": 103261737, "body": "@anon0987654321: yes, but that has not much to do with the lambda-expression itself. We simply never recurse on the children of the <code>Rose</code> tree. So the maximum calculates the maximum over the values in the list, not the children (or grandchildren, etc.) of these nodes."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 1, "last_activity_date": 1571483232, "creation_date": 1571483232, "answer_id": 58463030, "question_id": 58462972, "link": "https://stackoverflow.com/questions/58462972/non-exhaustive-patterns-in-function-creating-rose-tree-haskell/58463030#58463030", "title": "Non-exhaustive patterns in function. Creating rose tree Haskell", "body": "<p>The pattern you use will only match a list with <em>exactly</em> one element. Indeed the pattern:</p>\n\n<pre><code>rosesToRose <b>[(Rose node tree)]</b> = &hellip;</code></pre>\n\n<p>matches a list with <em>one</em> <code>Rose</code> object. But in your sample data, you pass it a list with three elements. Furthermore the <code>maxRoseNode</code> does not make much sense if you pass the same list with one element.</p>\n\n<p>You can solve the problem, by just matching this with a variable (<code>rs</code> for example), and then construct a <code>Rose</code> with <code>maxRoseNode rs</code> as value, and <code>rs</code> as children:</p>\n\n<pre><code>rosesToRose :: (Ord a, Num a) =&gt; [Rose a] -&gt; Rose a\nrosesToRose <b>rs</b> = Rose (maxRoseNode <b>rs</b>) <b>rs</b></code></pre>\n\n<p>You can improve the readability (and efficiency) of <code>maxRoseNode</code>, by first checking if it is an empty list, and if not, calculate the maximum of the items wrapped in the <code>Rose</code>s:</p>\n\n<pre><code>maxRoseNode:: (Ord a, Num a) =&gt; [Rose a] -&gt; a\nmaxRoseNode [] = 0\nmaxRoseNode xs = maximum (map <b>(\\(Rose x _) -&gt; x)</b> xs)</code></pre>\n\n<p>Here <code>\\(Rose x _) -&gt; x</code> is a <em>lambda expression</em> that will map a <code>Rose x _</code> object to <code>x</code>.</p>\n\n<p>For example:</p>\n\n<pre><code>Prelude&gt; rosesToRose [Rose 1 [Rose 1 [], Rose 2 []], Rose 3 [], Rose 4 [Rose 10 []]]\nRose 4 [Rose 1 [Rose 1 [],Rose 2 []],Rose 3 [],Rose 4 [Rose 10 []]]\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 12097918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/119398ea7f25ffef2178febafbea11a0?s=128&d=identicon&r=PG&f=1", "display_name": "anon0987654321", "link": "https://stackoverflow.com/users/12097918/anon0987654321"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "closed_date": 1571484935, "accepted_answer_id": 58463030, "answer_count": 1, "score": -1, "last_activity_date": 1571483232, "creation_date": 1571482724, "question_id": 58462972, "link": "https://stackoverflow.com/questions/58462972/non-exhaustive-patterns-in-function-creating-rose-tree-haskell", "closed_reason": "Duplicate", "title": "Non-exhaustive patterns in function. Creating rose tree Haskell", "body": "<p>I'm trying to write a function that combines a list of rose trees with the their parent node being the highest values of the root nodes of the given rose trees. For example; </p>\n\n<pre><code>RosesToRose [Rose 1 [Rose 1 [], Rose 2 []], Rose 3 [], Rose 4 [Rose 10 []]]\n</code></pre>\n\n<p>should return <code>Rose 4 [Rose 1 [Rose 1 [], Rose 2 []], Rose 3 [], Rose 4 [Rose 10 []]]</code></p>\n\n<p>I'm getting an error \" Non-exhaustive patterns in function rosesToRose\" and I'm not sure whats causing it. Tried matching against an empty list as input and got the same error. Any suggestions would be appreciated. </p>\n\n<p>My code: </p>\n\n<pre><code>data Rose a = Rose a [Rose a]\n    deriving Show\n\nrosesToRose:: (Ord a, Num a )=&gt; [Rose a] -&gt; Rose a\nrosesToRose [(Rose node tree)] = Rose (maxRoseNode [(Rose node tree)]) [(Rose node tree)]\n\nmaxRoseNode:: (Ord a,Num a) =&gt;[Rose a] -&gt; a\nmaxRoseNode trs = case trs of\n    [] -&gt; 0\n    (Rose node tree):xs -&gt; maximum  ([maxRoseNode xs] ++ [node])\n</code></pre>\n"}, {"tags": ["haskell", "type-inference", "typeclass"], "answers": [{"comments": [{"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1571481502, "post_id": 58462396, "comment_id": 103261261, "body": "I see, so this is a known... <i>feature?..</i> However, this post does not explain the nature of it. Is it a side effect of type inference? Or is it intentional?"}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1571482341, "post_id": 58462396, "comment_id": 103261423, "body": "@IgnatInsarov not sure whether it&#39;s a <i>feature</i> or just an implementation detail. But I&#39;m not the blog post author. So probably you have better chances understanding this behaviour by asking GHC developers directly."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 2, "creation_date": 1571487424, "post_id": 58462396, "comment_id": 103262618, "body": "@IgnatInsarov When GHC finds a constraint <code>C t</code>, it tries to solve it. If if finds a matching <code>instance (...) =&gt; C t where ...</code>, the constraint is replaced with the context <code>(...)</code>. This is repeated as much as possible. The final constraint appears in the type (or triggers a &quot;unsolved&quot; type error). This process is justified since there can only be at most one matching instance. Overlapping instances change this, and prevent this context reduction when multiple instances (in scope!) match, roughly. It is a <i>fragile</i> extension, to be used with some care."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1571488662, "post_id": 58462396, "comment_id": 103262888, "body": "Perhaps this last comment of @chi could be integrated into the answer?"}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1571831591, "post_id": 58462396, "comment_id": 103369613, "body": "@chi I took the liberty to integrate your comment. I feel I can accept the answer this way."}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": true, "score": 7, "last_activity_date": 1571831473, "last_edit_date": 1571831473, "creation_date": 1571478499, "answer_id": 58462396, "question_id": 58462166, "link": "https://stackoverflow.com/questions/58462166/constraint-on-method-depends-on-instances-in-scope/58462396#58462396", "title": "Constraint on method depends on instances in scope?", "body": "<p>This behaviour is explained in the following blog post:</p>\n\n<ul>\n<li><a href=\"https://kcsongor.github.io/opaque-constraint-synonyms/\" rel=\"nofollow noreferrer\">Opaque constraint synonyms</a></li>\n</ul>\n\n<p>In short: GHC is smart enough to see that you have only one instance of the <code>C</code> typeclass and decided that it's the only possible instance, so every time it sees <code>C m</code> constraint, it replaces it with <code>Monoid m</code> because they are equivalent.</p>\n\n<p>&nbsp;</p>\n\n<p><strong>N.B.</strong> &nbsp; As @chi further explains in a comment:</p>\n\n<p>When GHC finds a constraint <code>C t</code>, it tries to solve it. If if finds a matching <code>instance (...) =&gt; C t where ...</code>, the constraint is replaced with the context <code>(...)</code>. This is repeated as much as possible. The final constraint appears in the type (or triggers a \"unsolved\" type error). This process is justified since there can only be at most one matching instance. Overlapping instances change this, and prevent this context reduction when multiple instances (in scope!) match, roughly. It is a <em>fragile</em> extension, to be used with some care.</p>\n"}], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 58462396, "answer_count": 1, "score": 6, "last_activity_date": 1571831473, "creation_date": 1571476528, "question_id": 58462166, "link": "https://stackoverflow.com/questions/58462166/constraint-on-method-depends-on-instances-in-scope", "title": "Constraint on method depends on instances in scope?", "body": "<p>Consider this code:</p>\n\n<pre><code>{-# language FlexibleInstances, UndecidableInstances #-}\n\nmodule Y where\n\nclass C m where\n\n    x :: m\n\ninstance {-# overlappable #-} Monoid m =&gt; C m where\n\n    x = mempty\n\ninstance C Int where\n\n    x = 53\n</code></pre>\n\n<p>What is the type of <code>x</code>?</p>\n\n<pre><code>\u03bb :type x\nx :: C m =&gt; m\n</code></pre>\n\n<p>So far \u2014 so good. Now remove the <code>Int</code> instance. What is the type of <code>x</code>?</p>\n\n<pre><code>\u03bb :type x\nx :: Monoid m =&gt; m\n</code></pre>\n\n<p>Surprise!</p>\n\n<p>&nbsp;</p>\n\n<p>Why is this happening?</p>\n"}, {"tags": ["haskell", "tree"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1571497503, "post_id": 58460946, "comment_id": 103264975, "body": "What&#39;s the point of defining <code>BsTree</code>?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1571497650, "post_id": 58460946, "comment_id": 103265004, "body": "The problem is that <code>Null</code> is not a value of type <code>a</code>; it&#39;s a value of type <code>BinaryTree a</code>. Your definition of <code>BinaryTree</code> doesn&#39;t allow you to just put &quot;holes&quot; in the tree. If you remove the root of a tree, you have to replace it with a value from one of the two subtrees, which will require some modification of that subtree as well."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1571497399, "post_id": 58461013, "comment_id": 103264951, "body": "Replacing one unknown (deleting an item) with another (defining a rotation behavior) isn&#39;t very helpful."}, {"owner": {"reputation": 380, "user_id": 1635672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd0c9e0a1fd1b3f1bb3e1184eb01b64?s=128&d=identicon&r=PG", "display_name": "Zhu Jinxuan", "link": "https://stackoverflow.com/users/1635672/zhu-jinxuan"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1571510046, "post_id": 58461013, "comment_id": 103268140, "body": "Agree, I think I shall update my answer with example code from containers later.  Thank you for amending my answer."}], "tags": [], "owner": {"reputation": 380, "user_id": 1635672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd0c9e0a1fd1b3f1bb3e1184eb01b64?s=128&d=identicon&r=PG", "display_name": "Zhu Jinxuan", "link": "https://stackoverflow.com/users/1635672/zhu-jinxuan"}, "is_accepted": false, "score": 1, "last_activity_date": 1571683967, "last_edit_date": 1571683967, "creation_date": 1571465562, "answer_id": 58461013, "question_id": 58460946, "link": "https://stackoverflow.com/questions/58460946/delete-an-element-in-a-tree-in-haskell/58461013#58461013", "title": "Delete an element in a tree in Haskell", "body": "<p>You can:</p>\n\n<ol>\n<li>Change you data structure definition as </li>\n</ol>\n\n<pre><code>data BinaryTree a = Null | Node (BinaryTree a) (Maybe a) (BinaryTree a)\n</code></pre>\n\n<p>which is a simplified trie keyed by <code>[Bool]</code>.</p>\n\n<ol start=\"2\">\n<li>Define a rotation behavior (like in Balanced Tree) to fill in the blank after delete.  The rotation is not unique.  For example, for the lazy Map in the container package, the deletion of a balanced tree is defined as:</li>\n</ol>\n\n<pre><code>data Map k a  = Bin Size k a (Map k a) (Map k a)\n              | Tip\n\ntype Size     = Int\n\ndelete :: Ord k =&gt; k -&gt; Map k a -&gt; Map k a\ndelete = go\n  where\n    go :: Ord k =&gt; k -&gt; Map k a -&gt; Map k a\n    go !_ Tip = Tip\n    go k t@(Bin _ kx x l r) =\n        case compare k kx of\n            LT | l' == l -&gt; t\n               | otherwise -&gt; balanceR kx x l' r\n               where l' = go k l\n            GT | r' == r -&gt; t\n               | otherwise -&gt; balanceL kx x l r'\n               where r' = go k r\n            EQ -&gt; glue l r\n</code></pre>\n\n<p><code>balanceR</code>, <code>balanceL</code> and <code>glue</code> are rotation to balance depth in a balanced tree.\n<a href=\"http://hackage.haskell.org/package/containers-0.6.2.1/docs/Data-Map-Lazy.html\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/containers-0.6.2.1/docs/Data-Map-Lazy.html</a></p>\n"}], "owner": {"reputation": 215, "user_id": 12036912, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Bs1MMku7W04/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcRX-T31D-fLdCF5w6i9pacNreJ9w/photo.jpg?sz=128", "display_name": "Jayyyyyy", "link": "https://stackoverflow.com/users/12036912/jayyyyyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1571786085, "creation_date": 1571464703, "last_edit_date": 1571786085, "question_id": 58460946, "link": "https://stackoverflow.com/questions/58460946/delete-an-element-in-a-tree-in-haskell", "title": "Delete an element in a tree in Haskell", "body": "<p>What I want to do is to take a binary search tree, and an element, and then remove it from the tree\n(if it is present).</p>\n\n<p>Here is my code:</p>\n\n<pre><code>data BinaryTree a = Null | Node (BinaryTree a) a (BinaryTree a)\n  deriving Show\n\ntype BSTree a = BinaryTree a\n\ntreeDelete :: (Ord a) =&gt; (BSTree a) -&gt; a -&gt; (BSTree a)\ntreeDelete a btree = case btree of\n  Null -&gt; Null\n  Node Null val Null\n     |a==val -&gt; Null\n     |otherwise -&gt; Node Null val Null\n  Node left val right\n         |a==val-&gt; Node left Null right\n         |otherwise -&gt; (treeDelete a left) val (treeDelete a right)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 3, "creation_date": 1571450290, "post_id": 58459853, "comment_id": 103256405, "body": "This is almost certainly the full laziness transform causing the giant lists to be shared. There doesn&#39;t seem to be a good reference answer on SO for working around it."}, {"owner": {"reputation": 151, "user_id": 5596542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfcc73d15575dac5dff0c4c9404fbf9e?s=128&d=identicon&r=PG&f=1", "display_name": "Truman", "link": "https://stackoverflow.com/users/5596542/truman"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 3, "creation_date": 1571459924, "post_id": 58459853, "comment_id": 103257519, "body": "Thank you @Carl, that appears to be the issue. I added <code>-fno-full-laziness</code> to the ghc options, and this problem goes away."}], "owner": {"reputation": 151, "user_id": 5596542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfcc73d15575dac5dff0c4c9404fbf9e?s=128&d=identicon&r=PG&f=1", "display_name": "Truman", "link": "https://stackoverflow.com/users/5596542/truman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 1, "answer_count": 0, "score": 7, "last_activity_date": 1571449441, "creation_date": 1571449441, "question_id": 58459853, "link": "https://stackoverflow.com/questions/58459853/why-does-this-function-blow-up-memory-when-optimized-and-called-more-than-once", "title": "Why does this function blow up memory when optimized and called more than once?", "body": "<p>I have a function that filters a few values out of a list of 1 billion integers. If I call it just once, memory use is nearly constant, but if I call it twice, it fills up over 8 gig of memory. This seems to only happen when I optimize with -O2 and when I use tuples to filter the list.</p>\n\n<p>I worked down this testcase from code that did something more useful and was more complicated, but the function findLgMod3 demonstrates this problem, and the function findLgMod3Simp does not. These functions return the largest value &lt;= 1 billion that is 3 mod the input. There are certainly better ways to do this, but they wouldn't demonstrate this problem.</p>\n\n<p>I am compiling using ghc version 8.6.5 with:</p>\n\n<p>ghc -O2 -dynamic map_mem_prob.hs</p>\n\n<p>The code commented out shows variations that do and don't use excessive memory.</p>\n\n<p>The code as written will use little memory when compiled unoptimized or with -O1, so I think it has to do with optimizing with -O2 and using tuples to filter the list, but I don't know if it is expected behavior and if so, how to re-work the function so that it still filters with tuples, but doesn't have this problem.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>findLgMod3 :: Int -&gt; Int\nfindLgMod3 modVal = maxAns\n  where\n    maxAns = if null allAns then 0 else last allAns\n    allAns = (map snd . filter (\\(three, val) -&gt; three == (val `rem` modVal))\n              . zip (repeat 3)) [1..1000000000]\n\nfindLgMod3Simp :: Int -&gt; Int\nfindLgMod3Simp modVal = maxAns\n  where\n    maxAns = if null allAns then 0 else last allAns\n    allAns = (filter ((== 3) . (`rem` modVal))) [1..1000000000]\n\nmain :: IO ()\nmain = do\n  let val1 = 600000000\n      val2 = 700000000\n  let answers = map findLgMod3 [val1, val2]  -- This blows up memory.                                                                                                                                                             \n--  let answers = [findLgMod3 val1, findLgMod3 val2]  -- This blows up memory.                                                                                                                                                    \n--  let answer1 = findLgMod3 val1  -- This blows up memory.                                                                                                                                                                       \n--      answer2 = findLgMod3 val2                                                                                                                                                                                                 \n--      answers = answer1 + answer2                                                                                                                                                                                               \n\n--  let answers = map findLgMod3Simp [val1, val2]  -- This doesn't blow up memory.                                                                                                                                                \n--  let answers = map findLgMod3 [val1]  -- This doesn't blow up memory.                                                                                                                                                          \n--  let answers = [findLgMod3 val1]  -- This doesn't blow up memory.                                                                                                                                                              \n--  let answer1 = findLgMod3Simp val1  -- This doesn't blow up memory.                                                                                                                                                            \n--      answer2 = findLgMod3Simp val2                                                                                                                                                                                             \n--      answers = [answer1, answer2]                                                                                                                                                                                              \n  putStrLn $ \"Answers: \" ++ show answers\n</code></pre>\n\n<p>The output of the program should be:</p>\n\n<p>Answers: [600000003,700000003]</p>\n\n<p>However, it runs out of memory before it can complete.</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1571469939, "post_id": 58458531, "comment_id": 103258970, "body": "For better error messages, always provide a type signature for top-level bindings. In this case, GHC found a type mismatch and wrongly blamed <code>id</code>, when the error is actually otherwise, in <code>Nothing</code>. This happened because GHC had not enough information."}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 7, "last_activity_date": 1571435468, "creation_date": 1571435468, "answer_id": 58458608, "question_id": 58458531, "link": "https://stackoverflow.com/questions/58458531/using-id-inside-do-notation/58458608#58458608", "title": "Using id inside do notation", "body": "<p>Actually, you just forgot a <code>return</code>.  The following works fine:</p>\n\n<pre><code>safeHead' = do\n  e &lt;- id\n  if (null e)\n    then return Nothing         -- need return here\n    else return $ Just (head e)\n</code></pre>\n\n<p>or you can factor the <code>return</code> out:</p>\n\n<pre><code>safeHead' = do\n  e &lt;- id\n  return $ if (null e)\n    then Nothing\n    else Just (head e)\n</code></pre>\n"}], "owner": {"reputation": 19222, "user_id": 789186, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9d232cc5abe46092d3972d4f85833e42?s=128&d=identicon&r=PG", "display_name": "user4035", "link": "https://stackoverflow.com/users/789186/user4035"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 58458608, "answer_count": 1, "score": 0, "last_activity_date": 1571435469, "creation_date": 1571434871, "question_id": 58458531, "link": "https://stackoverflow.com/questions/58458531/using-id-inside-do-notation", "title": "Using id inside do notation", "body": "<p>I am watching a Haskell online course, Reader monad chapter. The instructor gives the following example:\nthis function takes a list and returns Nothing if it's empty or (Just head) otherwise.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>safeHead = do\n  -- argument is implicit here\n  b &lt;- null\n  if b then\n    return Nothing\n  else do\n    h &lt;- head\n    return $ Just h\n\nsafeHead' = do\n  e &lt;- id -- the error\n  if (null e)\n    then Nothing\n    else return $ Just (head e)\n</code></pre>\n\n<p>The second function takes the list explicitly, using <code>e &lt;- id</code>. But, unfortunately, it doesn't work for me. ghci gives an error:</p>\n\n<pre><code>\u2022 Couldn't match expected type \u2018Maybe [a]\u2019\n              with actual type \u2018a0 -&gt; a0\u2019\n \u2022 Probable cause: \u2018id\u2019 is applied to too few arguments\n    In a stmt of a 'do' block: e &lt;- id\n    In the expression:\n      do e &lt;- id\n         if (null e) then Nothing else return $ Just (head e)\n</code></pre>\n\n<p>This example was probably tested by the authors 3 years ago, when the course was created \n(or maybe, it was wrong from the beginning).</p>\n\n<p>I have a suspicion that <code>null</code> takes a wrapped value, while <code>id</code> doesn't:</p>\n\n<pre><code>Prelude&gt; :t null\nnull :: Foldable t =&gt; t a -&gt; Bool\nPrelude&gt; :t id\nid :: a -&gt; a\n</code></pre>\n\n<p>What's wrong and how to fix?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 5, "creation_date": 1571432802, "post_id": 58457499, "comment_id": 103253308, "body": "it seems like package.cache is corrupted, or something else is deeply wrong. I suggest deleting <code>&#47;home&#47;developer&#47;.stack&#47;snapshots&#47;x86_64-linux&#47;51bdc2ae2d954d&zwnj;&#8203;767f3325ff96f951609c&zwnj;&#8203;3c121fc399b49b2efc9d&zwnj;&#8203;e026a236ec&#47;</code> and trying again"}, {"owner": {"reputation": 2891, "user_id": 135889, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6660983655e40c381d6c93a2fffd42dd?s=128&d=identicon&r=PG", "display_name": "Ruud", "link": "https://stackoverflow.com/users/135889/ruud"}, "edited": false, "score": 0, "creation_date": 1608304117, "post_id": 58457499, "comment_id": 115550036, "body": "I ran into this when using Stack with Nix, and even deleting <code>~&#47;.stack</code> did not help. Adding <code>packages: [&quot;zlib&quot;]</code> under <code>nix:</code> in <code>stack.yaml</code> finally resolved it."}, {"owner": {"reputation": 83, "user_id": 2292589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3e7ec809677d4959a427858b16f154d?s=128&d=identicon&r=PG", "display_name": "Finn Espen Gundersen", "link": "https://stackoverflow.com/users/2292589/finn-espen-gundersen"}, "edited": false, "score": 0, "creation_date": 1618265682, "post_id": 58457499, "comment_id": 118545792, "body": "I got this error message after a power outage mid-build probbaly corrupted something. The solution was to delete the offending snapshot (c:\\sr\\snapshots\\&lt;short id&gt;) and then stack build again."}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 287, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1571429110, "creation_date": 1571429110, "question_id": 58457499, "link": "https://stackoverflow.com/questions/58457499/ghc-packagedb-readpackagedb-inappropriate-type-not-enough-bytes", "title": "GHC.PackageDb.readPackageDb: inappropriate type (not enough bytes)", "body": "<p>When I try to call my project with <code>stack ghci</code>, I've got the following error message:  </p>\n\n<pre><code>~/haskell/timermachine stack ghci\nReceived ExitFailure 1 when running\nRaw command: /home/developer/.stack/programs/x86_64-linux/ghc-8.6.5/bin/ghc-pkg-8.6.5 --user --no-user-package-db --package-db /home/developer/.stack/snapshots/x86_64-linux/51bdc2ae2d954d767f3325ff96f951609c3c121fc399b49b2efc9de026a236ec/8.6.5/pkgdb dump --expand-pkgroot\nStandard error:\n\nghc-pkg: /home/developer/.stack/snapshots/x86_64-linux/51bdc2ae2d954d767f3325ff96f951609c3c121fc399b49b2efc9de026a236ec/8.6.5/pkgdb/package.cache: GHC.PackageDb.readPackageDb: inappropriate type (not enough bytes) \n</code></pre>\n\n<p>My stack version: </p>\n\n<pre><code>stack ghc -- --version\nThe Glorious Glasgow Haskell Compilation System, version 8.6.5\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["string", "list", "haskell", "tuples"], "comments": [{"owner": {"reputation": 194, "user_id": 4856316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GMUS6.jpg?s=128&g=1", "display_name": "lzbernardo", "link": "https://stackoverflow.com/users/4856316/lzbernardo"}, "edited": false, "score": 3, "creation_date": 1571416076, "post_id": 58454794, "comment_id": 103246971, "body": "My hint is to think about maps and creating a function that would convert a string to a tuple. Edit: if you&#39;ve never used a functional programming language before, studying how <code>map</code>, <code>filter</code> and <code>reduce</code> work is probably the big clue here."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1571416422, "post_id": 58454794, "comment_id": 103247107, "body": "Do you really need a list of tuples, or would a list of lists suffice?"}, {"owner": {"reputation": 19, "user_id": 12197998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b326e31e66d5f1219dc28962c3c147df?s=128&d=identicon&r=PG&f=1", "display_name": "user12197998", "link": "https://stackoverflow.com/users/12197998/user12197998"}, "edited": false, "score": 0, "creation_date": 1571416773, "post_id": 58454794, "comment_id": 103247241, "body": "Yeah, I think I definitely need tuples - thus that it would work with the rest of stuff"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1571417479, "post_id": 58454794, "comment_id": 103247527, "body": "I suggest looking into the <code>words :: String -&gt; [String]</code> function, and writing a function <code>foo :: [String] -&gt; (String, String)</code>."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1571420552, "post_id": 58454794, "comment_id": 103248738, "body": "The space between &quot;String 2&quot; is a typo? Or is it on purpose?"}], "answers": [{"tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 3, "last_activity_date": 1571426813, "last_edit_date": 1571426813, "creation_date": 1571420748, "answer_id": 58455815, "question_id": 58454794, "link": "https://stackoverflow.com/questions/58454794/conversion-of-list-of-strings-into-list-of-tuples/58455815#58455815", "title": "Conversion of list of strings into list of tuples", "body": "<p>If there is not a typo in you list, it should be simple as:</p>\n\n<pre><code>strToTuple :: [String] -&gt; [(String, String)]\nstrToTuple = map toTuple\n\ntoTuple :: String -&gt; (String, String)\ntoTuple st = joinWords $ words st\n\njoinWords :: [a] -&gt; (a, a)\njoinWords [x, y] = (x, y)\njoinWords _ = error \"bad input, list should be length 2\"\n</code></pre>\n\n<blockquote>\n  <p>Output:</p>\n</blockquote>\n\n<pre><code>strToTuple ls\n=&gt; [(\"String1\",\"String2\"),(\"String3\",\"String4\"),(\"String5\",\"String6\")]\n</code></pre>\n\n<blockquote>\n  <p>Note, your post has a \"String 2\" instead of \"String2\" I'm not sure if it is a mistake or not, but if it is, this should work</p>\n</blockquote>\n"}], "owner": {"reputation": 19, "user_id": 12197998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b326e31e66d5f1219dc28962c3c147df?s=128&d=identicon&r=PG&f=1", "display_name": "user12197998", "link": "https://stackoverflow.com/users/12197998/user12197998"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1571426813, "creation_date": 1571415905, "last_edit_date": 1571419783, "question_id": 58454794, "link": "https://stackoverflow.com/questions/58454794/conversion-of-list-of-strings-into-list-of-tuples", "title": "Conversion of list of strings into list of tuples", "body": "<p>So, I've been studying Haskell so far. I need to convert the list of strings into the list of tuples containing strings so that they would be paired respectively. </p>\n\n<p>Like this:</p>\n\n<pre><code>[\"String1 String 2\", \"String3 String4\", \"String5 String6\"] \n</code></pre>\n\n<p>into</p>\n\n<pre><code>[(\"String1\", \"String2\"), (\"String3, String4\"), (\"String3, String4\")].\n</code></pre>\n\n<p>I haven't actually imagined any code yet, but I don't have a clue how this should work, so I don't really expect anything but just a hint which I could follow.</p>\n\n<p>Anyways, I'm trying to implement it without any external libraries, so linking them wouldn't be very useful.</p>\n\n<p>Thanks for any advice!</p>\n"}, {"tags": ["haskell", "higher-order-functions", "fold"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 13, "creation_date": 1571388545, "post_id": 58443912, "comment_id": 103232493, "body": "Haskell is a language.  It has many words, and most of those words can be used in a variety of different ways.  When you are learning a new language, for years many sentences and idioms don&#39;t make sense. But the more you use it, the more you see familiar patterns, and things you once thought were intimidating and advanced come quite naturally. Relax."}], "answers": [{"tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 3, "last_activity_date": 1571383061, "creation_date": 1571383061, "answer_id": 58445769, "question_id": 58443912, "link": "https://stackoverflow.com/questions/58443912/what-kind-of-knowledge-or-training-is-necessary-for-someone-to-write-down-the-de/58445769#58445769", "title": "What kind of knowledge or training is necessary for someone to write down the definition of foldlM like this?", "body": "<p>You don't need any specific knowledge in mathematics to write a function like <code>foldM</code>. I'm using Haskell in production for 4 years already, and I'm also struggling with understanding this definition of <code>foldM</code>. But that is mostly because it's poorly written. Please, don't take it as a personal fault if you can't understand some obscure code. Here is a more readable version of <code>foldlM</code></p>\n\n<pre><code>foldlM\n    :: forall t m a b .\n       (Foldable t, Monad m)\n    =&gt; (b -&gt; a -&gt; m b)  -- ^ Monadic action\n    -&gt; b                -- ^ Starting accumulator\n    -&gt; t a              -- ^ List of values\n    -&gt; m b              -- ^ Computation result inside a monad\nfoldlM f z xs = (foldr step pure xs) z\n  where\n    step :: a -&gt; (b -&gt; m b) -&gt; b -&gt; m b\n    step cur next acc = do\n        result &lt;- f acc cur\n        next result\n</code></pre>\n\n<p>This function is still not the easiest one. Mostly because it has non-typical usage of <code>foldr</code> where the intermediate accumulator is a function. But you can see a few mays that make such definition more readable:</p>\n\n<ol>\n<li>Comments about function arguments.</li>\n<li>Better argument names (still short and idiomatic, but they are at least more readable).</li>\n<li>The explicit type signature of the function inside <code>where</code> (so you know the shape of the arguments).</li>\n</ol>\n\n<p>After seeing such function, you can now perform <em>Equational reasoning technique</em> to expand the definition step-by-step and see how it works. Ability to come up with such functions comes with experience. I don't have strong mathematician skills, and this function is not a typical Haskell function. But the more practice you have, the better it gets :)</p>\n"}, {"comments": [{"owner": {"reputation": 443, "user_id": 4183297, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/UNM2l.jpg?s=128&g=1", "display_name": "Theodora", "link": "https://stackoverflow.com/users/4183297/theodora"}, "edited": false, "score": 1, "creation_date": 1573009889, "post_id": 58445815, "comment_id": 103737406, "body": "Thank you very much, I was trying to figure out whether this definition is unique and did not expect the use of Kleisli composition here. This answer really solve my doubt."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 443, "user_id": 4183297, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/UNM2l.jpg?s=128&g=1", "display_name": "Theodora", "link": "https://stackoverflow.com/users/4183297/theodora"}, "edited": false, "score": 0, "creation_date": 1573024946, "post_id": 58445815, "comment_id": 103741540, "body": "you&#39;re welcome. :)"}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 3, "last_activity_date": 1571385329, "last_edit_date": 1571385329, "creation_date": 1571383238, "answer_id": 58445815, "question_id": 58443912, "link": "https://stackoverflow.com/questions/58443912/what-kind-of-knowledge-or-training-is-necessary-for-someone-to-write-down-the-de/58445815#58445815", "title": "What kind of knowledge or training is necessary for someone to write down the definition of foldlM like this?", "body": "<p>In general, logic etc., I would imagine. But you can also learn it by doing it. :) With time you notice some patterns, pick up some tricks. </p>\n\n<p>Like this <code>foldr</code> with an extra argument thing. Some see it as folding into functions so they can be combined through <code>.</code> and <code>id</code> (which <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Category.html#t:Category\" rel=\"nofollow noreferrer\"><em>sometimes</em></a> are really <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Monad.html#v:-60--61--60-\" rel=\"nofollow noreferrer\"><code>&lt;=&lt;</code></a> and <code>return</code>),</p>\n\n<pre><code>foldr g z xs  =  foldr ($) z . map g $ xs\n              =  foldr (.) id (map g xs) z\n         ~/=  foldr (&lt;=&lt;) return (map g xs) z\n{-\n  (\\f -&gt; f . f) :: (a -&gt; a) -&gt; (a -&gt; a)\n\n  (\\f -&gt; f &lt;=&lt; f) :: Monad m =&gt; (a -&gt; m a) -&gt; (a -&gt; m a)\n                            (still just a type, not a kind)\n-}\n</code></pre>\n\n<p>Some find it easier to understand it in simpler, syntactical terms, as</p>\n\n<pre><code>foldr g z [a,b,c,...,n] s =\n     g a (foldr g z [b,c,...,n]) s\n</code></pre>\n\n<p>so when <code>g</code> is non-strict in its second argument, <code>s</code> can serve as a state being passed along from the left, even though we're folding on the right, as one example.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1571623408, "post_id": 58447263, "comment_id": 103290124, "body": "I don&#39;t really see what makes a left fold easier to understand than a right fold here. The right fold is much more likely to produce a useful result for infinite structures and to be efficient for typical <code>Monad</code> instances."}, {"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1571640356, "post_id": 58447263, "comment_id": 103293875, "body": "@dfeuer The point of this is not to show an easier example, but to propose a suitable exercise for the OP and expose a reasoned argumentation of the solution, trying to proof that is not necessary to be a super-master haskeller in order to get such a solution. Digressions about efficiency aren&#39;t taken in account"}], "tags": [], "owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "is_accepted": false, "score": 4, "last_activity_date": 1571602442, "last_edit_date": 1571602442, "creation_date": 1571388725, "answer_id": 58447263, "question_id": 58443912, "link": "https://stackoverflow.com/questions/58443912/what-kind-of-knowledge-or-training-is-necessary-for-someone-to-write-down-the-de/58447263#58447263", "title": "What kind of knowledge or training is necessary for someone to write down the definition of foldlM like this?", "body": "<p>So the best way to understand it is by doing it. Below there's an implementation of <code>foldlM</code> using <code>foldl</code> instead of <code>foldr</code>. It is a good excercise, try it and come later to the solution I'd suggest. The example explain all the reasoning I've done to achieve it, which might be different from yours, and might be bias because I've already knew about using a function accumulator.</p>\n\n<p><strong>Step 1</strong>: Let's try to write <code>foldlM</code> in terms of <code>foldl</code></p>\n\n<pre><code>-- this doesn't compile because f returning type is (m b) and not just (b) \nfoldlM :: (Foldable t, Monad m) =&gt; (b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b\nfoldlM f z0 xs = foldl f z0 xs \n\n-- So let substitute f by some undefined f'\nfoldlM :: (Foldable t, Monad m) =&gt; (b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b\nfoldlM f z0 xs = foldl f' z0 xs\n  where f' = undefined\n\n-- cool, but f' should use f somehow in order to get the monadic behaviour\nfoldlM :: (Foldable t, Monad m) =&gt; (b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b\nfoldlM f z0 xs = foldl f' z0 xs\n  where f' b a = f somethingIDontkNow \n</code></pre>\n\n<p>Here you realize that <code>f'</code> is pure and you'd need to extract the result of <code>f</code> to type match. The only way to 'extract' a monadic value is with <code>&gt;&gt;=</code> operator, but such an operator needs to be wrap right after it is used.</p>\n\n<p>So as a conclusion: Every time you end up with <em>I'd like to fully unwrap this monad</em>, just give up. Is not the right way</p>\n\n<p><strong>Step 2</strong>: Let's try to write <code>foldlM</code> in terms of <code>foldl</code> but first using <code>[]</code> as foldable, since it is easy to pattern match (i.e. we don't actually need to use <code>fold</code>)</p>\n\n<pre><code>-- This is not very hard. It is pretty standard recursion schema. :)\nfoldlM' :: (Monad m) =&gt; (b -&gt; a -&gt; m b) -&gt; b -&gt; [a] -&gt; m b\nfoldlM' f z0 []     = return z0\nfoldlM' f z0 (x:xs) = f z0 x &gt;&gt;= \\c -&gt; foldlM' f c xs\n</code></pre>\n\n<p>Ok, that was easy. Let compare the definition with the usual <code>foldl</code> definition for lists</p>\n\n<pre><code>foldlM' :: (Monad m) =&gt; (b -&gt; a -&gt; m b) -&gt; b -&gt; [a] -&gt; m b\nfoldlM' f z0 []     = return z0\nfoldlM' f z0 (x:xs) = f z0 x &gt;&gt;= \\c -&gt; foldlM' f c xs\n\nmyfoldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b\nmyfoldl f z0 []     = z0\nmyfoldl f z0 (x:xs) = foldl f (f z0 x) xs\n</code></pre>\n\n<p>Cool!! they are pretty much the same. The trivial case is about the exact same thing. The recursive case is a little bit different, you'd like to write something more like: <code>foldlM' f (f z0 x) xs</code>. But is doesn't compile as in step 1, so you might think <em>OK, I don't want to apply <code>f</code>, just to hold such a computation and compose it with <code>&gt;&gt;=</code>. I'd like to write something more like</em> <code>foldlM' f (f z0 x &gt;&gt;=) xs</code> if it had sense...</p>\n\n<p><strong>Step 3</strong> Realize that what you want to accumulate is a function composition and not a result. (<em>here I am probably bias by the fact that I already knew it because you've posted it</em>).</p>\n\n<pre><code>foldlM :: (Foldable t, Monad m) =&gt; (b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b\nfoldlM f z0 xs = foldl f' initFunc xs\n  where initFunc = undefined :: b -&gt; m b\n        f'       = undefined :: (b -&gt; m b) -&gt; a -&gt; (b -&gt; m b) -- This type signature can be deduce because f' should be applied to initFunc and a's from t a. \n</code></pre>\n\n<p>By the type of <code>initFunc</code> and using our knowledge from step 2 (the recursive definition) we can deduce that <code>initFunc = return</code>. The definition of <code>f'</code> can be completed knowing that <code>f'</code> should use <code>f</code> and <code>&gt;&gt;=</code>.</p>\n\n<pre><code>foldlM :: (Foldable t, Monad m) =&gt; (b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b\nfoldlM f z0 xs = foldl f' return xs z0\n--                        ^^^^^^\n--                        |- Initial value\n  where f' b a = \\bvalue -&gt; b bvalue &gt;&gt;= \\bresult -&gt; f bresult a -- this is equivalent to (b &gt;=&gt; \\result -&gt; f result a) which captures the sequence behaviour of the implementation\n--         ^      ^^^^^^                  ^^^^^^^\n--         |      |                       |- This is the result of previous computation\n--         |      |- f' should return a function b -&gt; m b. Any time you have to return a function, start writing a lambda  \n--         |- This b is the accumulated value and has type b -&gt; m b\n-- Following the types you can write this with enough practise\n</code></pre>\n\n<p>As you can see, it is not soooo difficult to do it. It needs practise, but I am not a professional haskell developer and I could do it myself, It is a matter of practise</p>\n"}], "owner": {"reputation": 443, "user_id": 4183297, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/UNM2l.jpg?s=128&g=1", "display_name": "Theodora", "link": "https://stackoverflow.com/users/4183297/theodora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 3, "closed_date": 1571435109, "accepted_answer_id": 58445815, "answer_count": 3, "score": 9, "last_activity_date": 1571602442, "creation_date": 1571372441, "last_edit_date": 1571383054, "question_id": 58443912, "link": "https://stackoverflow.com/questions/58443912/what-kind-of-knowledge-or-training-is-necessary-for-someone-to-write-down-the-de", "closed_reason": "Needs more focus", "title": "What kind of knowledge or training is necessary for someone to write down the definition of foldlM like this?", "body": "<p>Recently, I am trying to use Haskell in some of my real case production system. The Haskell type system really offers me great help. For example, when I realised that I need some function of type</p>\n\n<pre><code>f :: (Foldable t, Monad m) =&gt; ( a-&gt; b -&gt; m b) -&gt; b -&gt; t a -&gt; m b\n</code></pre>\n\n<p>There are actually functions like <code>foldM</code>, <code>foldlM</code> and <code>foldrM</code>.</p>\n\n<p>However, what real shocked me is the definition of these functions, such as:</p>\n\n<pre><code>foldlM :: (Foldable t, Monad m) =&gt; (b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b\nfoldlM f z0 xs = foldr f' return xs z0\n  where f' x k z = f z x &gt;&gt;= k\n</code></pre>\n\n<p>so  function <code>f'</code> must be of type:</p>\n\n<pre><code>f' :: a -&gt; b -&gt; b\n</code></pre>\n\n<p>as required by <code>foldr</code>, then <code>b</code> must be of kind <code>*-&gt; m *</code>, so the entire definition of <code>foldlM</code> could make sense. </p>\n\n<p>Another example includes definitions of <code>liftA2</code> and <code>&lt;*&gt;</code></p>\n\n<pre><code>(&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b\n(&lt;*&gt;) = liftA2 id\n\nliftA2 :: (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c\nliftA2 f x = (&lt;*&gt;) (fmap f x)\n</code></pre>\n\n<p>I tried some of my own solutions before peeking into the source code. But the gap is so huge that I don't think I could ever come up with this solution, no matter how many lines of code I will write in future. </p>\n\n<p>So my question is, what kind of knowledge or which specific mathematics branch is necessary for someone to reasoning on such a highly abstracted level. </p>\n\n<p>I know Category theory might offer some help and I've been following <a href=\"https://www.youtube.com/watch?v=I8LbkfSSR58&amp;list=PLbgaMIhjbmEnaH_LTkxLI7FMa2HsnawM_\" rel=\"noreferrer\">this great lecture</a> for a long time and still working on it.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 4, "creation_date": 1571374570, "post_id": 58443284, "comment_id": 103227070, "body": "The Haskell expression <code>worm = 1:2:3:worm</code> is not the same as your python <code>&quot;1:2:3:worm&quot;</code>.    In python that is a string of ten characters.  In Haskell <code>worm</code> is a list of integers of infinite length.  You literally have the numbers 1, 2, and 3 appended to a list of ... the numbers 1 2 and 3 appended to a list of ... the numbers 1,2 and 3 appen..."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1571404824, "post_id": 58443284, "comment_id": 103241124, "body": "There&#39;s also no real use to returning the name of a variable as a string; what would you do with it?"}], "answers": [{"comments": [{"owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "edited": false, "score": 0, "creation_date": 1571368681, "post_id": 58443419, "comment_id": 103225940, "body": "I want my function to only return strings. just the names defined at the beginning"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "edited": false, "score": 1, "creation_date": 1571368862, "post_id": 58443419, "comment_id": 103225968, "body": "Besides &quot;F&quot;, what strings do you want it to return? That&#39;s the only string you used."}, {"owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "edited": false, "score": 0, "creation_date": 1571369002, "post_id": 58443419, "comment_id": 103225987, "body": "Oh forgot the quotes. Sorry. Edited the question"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "edited": false, "score": 1, "creation_date": 1571369076, "post_id": 58443419, "comment_id": 103226000, "body": "I find it unlikely that you still get the error that you say you get, now that you made that change. And you still didn&#39;t address my second point."}, {"owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "edited": false, "score": 0, "creation_date": 1571369119, "post_id": 58443419, "comment_id": 103226009, "body": "Yes regarding that, what infinite lists are you referring to?"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "edited": false, "score": 0, "creation_date": 1571369197, "post_id": 58443419, "comment_id": 103226025, "body": "<code>worm</code> and <code>snake</code> are both infinite. <code>worm</code> is <code>[1,2,3,1,2,3,1,2,3,...</code> forever, and similarly for <code>snake</code>."}, {"owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "edited": false, "score": 0, "creation_date": 1571369268, "post_id": 58443419, "comment_id": 103226033, "body": "Worm has 9 elements. Is there something i&#39;m missing? Also for snake, i thought it was a list of size 4?"}, {"owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "edited": false, "score": 0, "creation_date": 1571369321, "post_id": 58443419, "comment_id": 103226046, "body": "Is there another approach rather than compare then? because thats what i would do in any other languages. (C/ Python/ Java)"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "edited": false, "score": 1, "creation_date": 1571369348, "post_id": 58443419, "comment_id": 103226054, "body": "Both of those statements are wrong, and I can&#39;t even figure out what mistake you made to come to believe them. So yes, you&#39;re definitely missing something. Try looking at those things in GHCi."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "edited": false, "score": 0, "creation_date": 1571369392, "post_id": 58443419, "comment_id": 103226061, "body": "You can&#39;t compare arbitrary infinite lists in C, Python, Java, or any other programming language."}, {"owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "edited": false, "score": 0, "creation_date": 1571369500, "post_id": 58443419, "comment_id": 103226083, "body": "I wasn&#39;t referring to comparing infinite lists. Just comparison of a regular n-defined lists. And for that, my professor gave us this problem as practice for an exam and cannot solve it. He said they were defined lists thats where i&#39;m basing my information"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "edited": false, "score": 0, "creation_date": 1571369666, "post_id": 58443419, "comment_id": 103226114, "body": "You say you&#39;re not referring to infinite lists, but the lists in your code are infinite anyway. And did you just now make up the term &quot;n-defined lists&quot;? If not, can you provide a reference for it?"}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1571368135, "creation_date": 1571368135, "answer_id": 58443419, "question_id": 58443284, "link": "https://stackoverflow.com/questions/58443284/passing-variables-in-function-and-compare-each/58443419#58443419", "title": "Passing Variables in Function and compare each?", "body": "<p>Two problems:</p>\n\n<ol>\n<li>You can't have a function that returns a list of numbers sometimes and a string other times. That's literally the entire point of a strongly typed language. If you want something like that, you need to use a sum type.</li>\n<li>You can't compare infinite lists. You can try, but your program will never finish.</li>\n</ol>\n"}], "owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1571369017, "creation_date": 1571367084, "last_edit_date": 1571369017, "question_id": 58443284, "link": "https://stackoverflow.com/questions/58443284/passing-variables-in-function-and-compare-each", "title": "Passing Variables in Function and compare each?", "body": "<p>I'm trying to practice Haskell returns and datatypes. I'm trying to pass the following information into the program: </p>\n\n<pre><code>worm = 1:2:3:worm\neel = [1,2,3,1,2,3,1,2,3]\nsnake = 3:2:1:snake\nwhale = [1..100]\n</code></pre>\n\n<p>And i want to create a function that has a switch function to get the data and match it to its definition. For example, in Python:</p>\n\n<pre><code>def compare(str): #for one case and using string to clarify\n    if str == \"1:2:3:worm\":\n       return \"worm\"\n</code></pre>\n\n<p>I know the datatypes are lists but causes a lot of confusion. My code is giving me an error of <code>Could not deduce (Num Char) Arising from use of worm</code></p>\n\n<p>My code:</p>\n\n<pre><code>which :: [a] -&gt; String\nwhich x | x == [1,2,3,1,2,3,1,2,3] = \"worm\" | x == 3:2:1:snake = \"snake\" | otherwise = \"F\"\n</code></pre>\n\n<p>Is there another approach i'm missing? and why is my function giving me that error?</p>\n"}, {"tags": ["list", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "edited": false, "score": 0, "creation_date": 1571357470, "post_id": 58442176, "comment_id": 103223846, "body": "Yes that works too but kinda wanted to dig deep to Understand Haskell more"}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 11, "last_activity_date": 1571356641, "creation_date": 1571356641, "answer_id": 58442176, "question_id": 58442157, "link": "https://stackoverflow.com/questions/58442157/adding-zeros-between-elements-in-list/58442176#58442176", "title": "Adding zeros between elements in list?", "body": "<p><a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:intersperse\" rel=\"noreferrer\"><code>intersperse</code></a> is made for this. Just <code>import Data.List (intersperse)</code>, then <code>intersperse 0 yourList</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 9, "last_activity_date": 1571360510, "creation_date": 1571360510, "answer_id": 58442592, "question_id": 58442157, "link": "https://stackoverflow.com/questions/58442157/adding-zeros-between-elements-in-list/58442592#58442592", "title": "Adding zeros between elements in list?", "body": "<p>You cannot do this with <code>map</code>. One of the fundamental properties of <code>map</code> is that its output will always have exactly as many items as its input, because each output element corresponds to one input, and vice versa.</p>\n\n<p>There is a related tool with the necessary power, though:</p>\n\n<pre><code>concatMap :: (a -&gt; [b]) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>This way, each input item can produce zero or more output items. You can use this to build the function you wanted:</p>\n\n<pre><code>between :: a -&gt; [a] -&gt; [a]\nsep `between` xs = drop 1 . concatMap insert $ xs\n  where insert x = [sep, x]\n\n0 `between` [1..10]\n[1,0,2,0,3,0,4,0,5,0,6,0,7,0,8,0,9,0,10]\n</code></pre>\n\n<p>Or a more concise definition of <code>between</code>:</p>\n\n<pre><code>between sep = drop 1 . concatMap ((sep :) . pure)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 4, "last_activity_date": 1571363321, "creation_date": 1571363321, "answer_id": 58442875, "question_id": 58442157, "link": "https://stackoverflow.com/questions/58442157/adding-zeros-between-elements-in-list/58442875#58442875", "title": "Adding zeros between elements in list?", "body": "<p>With simple pattern matching it should be:</p>\n\n<pre><code>addingFunction n [] = []\naddingFunction n [x] = [x]\naddingFunction n (x:xs) = x: n : (addingFunction n xs)\n\naddingFunction 0 [1..20]\n=&gt; [1,0,2,0,3,0,4,0,5,0,6,0,7,0,8,0,9,0,10,0,11,0,12,0,13,0,14,0,15,0,16,0,17,0,18,0,19,0,20]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1571391074, "post_id": 58443833, "comment_id": 103233953, "body": "<code>foldl (++) []</code> is a bit weird. Why not just point to <code>concat</code>?"}, {"owner": {"reputation": 171, "user_id": 7734697, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qbUvpJ63STI/AAAAAAAAAAI/AAAAAAAAAYg/3M_O6a3GxSU/photo.jpg?sz=128", "display_name": "Rinne Hmm", "link": "https://stackoverflow.com/users/7734697/rinne-hmm"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1571393182, "post_id": 58443833, "comment_id": 103235040, "body": "@amalloy Yes it is. It is just that <code>concat</code> implementation itself also use some type of <code>fold</code>. So I guess using <code>foldl</code> would help other understand it a bit deeper."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1571421444, "post_id": 58443833, "comment_id": 103249129, "body": "<code>concat</code> is implemented using <code>foldr</code> rather than <code>foldl</code>. Do you understand why this is actually important?"}, {"owner": {"reputation": 171, "user_id": 7734697, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qbUvpJ63STI/AAAAAAAAAAI/AAAAAAAAAYg/3M_O6a3GxSU/photo.jpg?sz=128", "display_name": "Rinne Hmm", "link": "https://stackoverflow.com/users/7734697/rinne-hmm"}, "edited": false, "score": 0, "creation_date": 1571554721, "post_id": 58443833, "comment_id": 103275154, "body": "I do not fully understand the subject of <code>fold</code>myself. There is a whole wiki related to this subject. My simple understanding is that <code>foldr</code> is much better for lazy infinite list, and <code>foldl</code> or <code>foldl&#39;</code> (strict version) is better for general use-case."}], "tags": [], "owner": {"reputation": 171, "user_id": 7734697, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qbUvpJ63STI/AAAAAAAAAAI/AAAAAAAAAYg/3M_O6a3GxSU/photo.jpg?sz=128", "display_name": "Rinne Hmm", "link": "https://stackoverflow.com/users/7734697/rinne-hmm"}, "is_accepted": false, "score": 3, "last_activity_date": 1582102380, "last_edit_date": 1582102380, "creation_date": 1571371781, "answer_id": 58443833, "question_id": 58442157, "link": "https://stackoverflow.com/questions/58442157/adding-zeros-between-elements-in-list/58443833#58443833", "title": "Adding zeros between elements in list?", "body": "<p>If you want to use <code>map</code> to solve this, you can do something like this:</p>\n\n<p>Have a function that get a int and return 2 element list with int and zero:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>addZero :: List\naddZero a = [0, a]\n</code></pre>\n\n<p>Then you can call map with this function:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>x = map addZero [1..20] -- this will return [[0,1], [0, 2] ...] \n</code></pre>\n\n<p>You will notice that it is a nested list. That is just how <code>map</code> work. We need a way to combine the inner list together into just one list. This case we use <code>foldl</code></p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>combineList :: [[Int]] -&gt; [Int]\ncombineList list = foldl' (++) [] list \n-- [] ++ [0, 1] ++ [0, 2] ... \n</code></pre>\n\n<p>So the way foldl work in this case is that it accepts a combine function, initial value, and the list to combine. </p>\n\n<p>Since we don't need the first 0 we can drop it: </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>dropFirst :: [Int] -&gt; [Int]\ndropFirst list = case list of\n  x:xs -&gt; xs\n  [] -&gt; []\n</code></pre>\n\n<p>Final code:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>x = dropFirst $ combineList $ map addZero [1..20]\n\naddZero :: Int -&gt; [Int]\naddZero a = [0, a]\n\ncombineList :: [[Int]] -&gt; [Int]\ncombineList list = foldl (++) [] list \n\ndropFirst :: [Int] -&gt; [Int]\ndropFirst list = case list of\n  x:xs -&gt; xs\n  [] -&gt; []\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1571385622, "creation_date": 1571385622, "answer_id": 58446430, "question_id": 58442157, "link": "https://stackoverflow.com/questions/58442157/adding-zeros-between-elements-in-list/58446430#58446430", "title": "Adding zeros between elements in list?", "body": "<p>We here can make use of a <code>foldr</code> pattern where for each element in the original list, we prepend it with an <code>0</code>:</p>\n\n<pre><code>addZeros :: Num a =&gt; [a] -&gt; [a]\naddZeros [] = []\naddZeros (x:xs) = x : foldr (((0 :) .) . (:)) [] xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1571438426, "last_edit_date": 1571438426, "creation_date": 1571421948, "answer_id": 58456065, "question_id": 58442157, "link": "https://stackoverflow.com/questions/58442157/adding-zeros-between-elements-in-list/58456065#58456065", "title": "Adding zeros between elements in list?", "body": "<p>If you don't want to use <code>intersperse</code>, you can write your own.</p>\n\n<pre><code>intersperse :: a -&gt; [a] -&gt; [a]\nintersperse p as = drop 1 [x | a &lt;- as, x &lt;- [p, a]]\n</code></pre>\n\n<p>If you like, you can use <code>Applicative</code> operations:</p>\n\n<pre><code>import Control.Applicative\n\nintersperse :: a -&gt; [a] -&gt; [a]\nintersperse p as = drop 1 $ as &lt;**&gt; [const p, id]\n</code></pre>\n\n<p>This is basically the definition used in <code>Data.Sequence</code>.</p>\n"}], "owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 435, "favorite_count": 0, "answer_count": 6, "score": 8, "last_activity_date": 1582102380, "creation_date": 1571356486, "last_edit_date": 1572883193, "question_id": 58442157, "link": "https://stackoverflow.com/questions/58442157/adding-zeros-between-elements-in-list", "title": "Adding zeros between elements in list?", "body": "<p>I'm trying to change a list in haskell to include 0 between every element. If we have initial list <code>[1..20]</code> then i would like to change it to <code>[1,0,2,0,3..20]</code> </p>\n\n<p>What i thought about doing is actually using map on every function, extracting element then adding it to list and use <code>++[0]</code> to it but not sure if this is the right approach or not. Still learning haskell so might have errors.</p>\n\n<p>My code:</p>\n\n<pre><code>x = map classify[1..20] \n\nclassify :: Int -&gt; Int \naddingFunction 0 [Int]\n\n\naddingFunction :: Int -&gt; [a] -&gt; [a]\naddingFunction x xs = [a] ++ x ++ xs \n</code></pre>\n"}, {"tags": ["file", "haskell", "save", "load", "aeson"], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 0, "last_activity_date": 1571361137, "creation_date": 1571361137, "answer_id": 58442638, "question_id": 58442109, "link": "https://stackoverflow.com/questions/58442109/saving-and-loading-abstract-data-type-to-json-file-and-reading-from-file-in-the/58442638#58442638", "title": "Saving and loading abstract data type to json file and reading from file in the game for Haskell", "body": "<p>The function <code>decode</code> from <code>Data.Aeson</code>, as is clear from <a href=\"https://www.stackage.org/haddock/lts-14.10/aeson-1.4.5.0/Data-Aeson.html#v:decode\" rel=\"nofollow noreferrer\">its documentation</a>, returns not the target type (whichever type you're trying to decode), but the target type wrapped in <code>Maybe</code>. In your case, this would be <code>Maybe [Room]</code>, not just <code>[Room]</code>.</p>\n\n<p>This reflects the fact that decoding might fail (i.e. incorrect format or whatever), in which case the function returns <code>Nothing</code>.</p>\n\n<p>This is what the compiler is telling you when it says \"<em>Relevant bindings include: new :: Maybe a0</em>\" - it says that the variable <code>new</code> has been inferred to have type <code>Maybe a0</code>, where <code>a0</code> is some not yet known type. </p>\n\n<p>It then goes on to tell you that it can't pass a <code>Maybe a0</code> as argument to <code>start</code>, because <code>start</code> expects the argument of type <code>[Room]</code>: \"<em>Couldn't match expected type [Room] with actual type 'Maybe a0' ... in the first argument of 'start'</em>\"</p>\n\n<p>To fix this, you need to handle the possibility of <code>decode</code> returning <code>Nothing</code>, and if it returns <code>Just</code>, pass the contents of it to <code>start</code>. Something like this:</p>\n\n<pre><code>load =\n   do\n   lst &lt;- readFile \"savegame.txt\"\n   let new = decode lst\n   case new of\n      Nothing -&gt; \n         error \"Incorrect file format\"\n      Just n -&gt;\n         start n\n</code></pre>\n\n<p>(note that calling <code>error</code> is not a good way to handle an unexpected condition; I only used it as an example)</p>\n"}], "owner": {"reputation": 3, "user_id": 12217943, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TSd8PFlZRdw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdNpzbEwZfPpFR5A1yX_U7m2KeV2w/photo.jpg?sz=128", "display_name": "user12217943", "link": "https://stackoverflow.com/users/12217943/user12217943"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 58442638, "answer_count": 1, "score": 0, "last_activity_date": 1571361137, "creation_date": 1571355971, "question_id": 58442109, "link": "https://stackoverflow.com/questions/58442109/saving-and-loading-abstract-data-type-to-json-file-and-reading-from-file-in-the", "title": "Saving and loading abstract data type to json file and reading from file in the game for Haskell", "body": "<p>I am writing a game in Haskell in which I would like to save a list of an abstract data type to a text file in a JSON format and then reload that saved file. i.e read that file back into the list of the abstract data type, and then use that re-loaded list in my game as normal. I am quite new to Haskell and programming in general so I am a little unsure if this is possible in the first place. </p>\n\n<p>I  believe I've set up my data type (Room) correctly. But I am unsure about FromJson and toJSON (is that syntax correct?). </p>\n\n<p>Also, the way I am currently saving does not save the JSON file in the format I would like: </p>\n\n<p>[{\"reward\":\"treasure\",\"enemy\":\"enemyOne\",\"description\":\"this is a room\"}] </p>\n\n<p>whereas the description, enemy and reward should be the order. </p>\n\n<p>(I also believe the data type Room should precede everything in a JSON file correct?). </p>\n\n<p>Let me know if you need any more clarification. Thank you! </p>\n\n<pre><code>{-# LANGUAGE \n    OverloadedStrings\n  , DeriveGeneric\n #-}\n\nmodule Game where\n\n--import System.IO\nimport Text.Read\nimport Data.Char\nimport Prelude hiding (readFile, writeFile)\n\nimport Data.Aeson\nimport Data.Text as T hiding (length, tail)\nimport Data.ByteString.Lazy as B hiding (putStrLn, length, tail, writeFile, readFile)\nimport Data.ByteString.Lazy.Char8 as BC hiding (putStrLn, length, tail)\nimport GHC.Generics\n\n\ndata Room = Room\n   { description :: String\n   , enemy :: String\n   , reward :: String\n   } deriving (Show, Generic)\n\n-- is this syntax correct for parseJSON?\ninstance FromJSON Room where\n   parseJSON (Object v) =  Room &lt;$&gt; v .: \"description\" &lt;*&gt; v .: \"enemy\" &lt;*&gt; v .: \"reward\" \n\n-- is this syntax correct for toJSON? \ninstance ToJSON Room where\n    toJSON (Room desc enem reward) = object [\"description\" .= desc, \"enemy\" .= enem, \"reward\" .= reward]\n\n\n\nsave lst =\n    do\n    writeFile \"savegame.txt\" (encode lst)\n    return()\n\nload =\n   do\n   lst &lt;- readFile \"savegame.txt\"\n   let new = decode lst\n   start new \n\nstart :: [Room] -&gt; IO()\nstart lst =\n putStrLn(\"Starting the game, need to use the lst as a list of rooms\")\n</code></pre>\n\n<p>These are the error messages I'm getting:</p>\n\n<pre><code>forStackOverflow.hs:46:14:\n    No instance for (FromJSON a0) arising from a use of \u2018decode\u2019\n    The type variable \u2018a0\u2019 is ambiguous\n    Relevant bindings include\n      new :: Maybe a0 (bound at forStackOverflow.hs:46:8)\n    Note: there are several potential instances:\n      instance FromJSON DotNetTime\n        -- Defined in \u2018aeson-1.4.5.0:Data.Aeson.Types.FromJSON\u2019\n      instance FromJSON Value\n        -- Defined in \u2018aeson-1.4.5.0:Data.Aeson.Types.FromJSON\u2019\n      instance FromJSON a =&gt; FromJSON (Control.Applicative.Const a b)\n        -- Defined in \u2018aeson-1.4.5.0:Data.Aeson.Types.FromJSON\u2019\n      ...plus 89 others\n    In the expression: decode lst\n    In an equation for \u2018new\u2019: new = decode lst\n    In the expression:\n      do { lst &lt;- readFile \"savegame.txt\";\n           let new = decode lst;\n           start new }\n\nforStackOverflow.hs:47:10:\n    Couldn't match expected type \u2018[Room]\u2019 with actual type \u2018Maybe a0\u2019\n    Relevant bindings include\n      new :: Maybe a0 (bound at forStackOverflow.hs:46:8)\n    In the first argument of \u2018start\u2019, namely \u2018new\u2019\n    In a stmt of a 'do' block: start new\nFailed, modules loaded: none.\nPrelude&gt; \n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1571340583, "post_id": 58439505, "comment_id": 103218739, "body": "Hint: use <code>filter</code> <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:filter\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.12.0.0/docs/&hellip;</a> and <code>take</code>: <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:take\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.12.0.0/docs/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 12234788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207867fde03aecd6c4e308e06f7b6a36?s=128&d=identicon&r=PG&f=1", "display_name": "peter.s", "link": "https://stackoverflow.com/users/12234788/peter-s"}, "edited": false, "score": 0, "creation_date": 1571343923, "post_id": 58440011, "comment_id": 103220167, "body": "with the filter abundant [1..] I could make an infinite list, but somehow the take doesn&quot;t work. abundantnr i = take i[filter abundant [1..]]"}, {"owner": {"reputation": 665, "user_id": 10610632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb8dce0aefdec2cde25c0a79c32739?s=128&d=identicon&r=PG&f=1", "display_name": "RoyM", "link": "https://stackoverflow.com/users/10610632/roym"}, "edited": false, "score": 0, "creation_date": 1571344443, "post_id": 58440011, "comment_id": 103220376, "body": "Bracket-parens are for lists and list-comprehension. You want to do <code>abundantnr i = take i (filter abundant [1..])</code>"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 3, "last_activity_date": 1571342799, "creation_date": 1571342799, "answer_id": 58440011, "question_id": 58439505, "link": "https://stackoverflow.com/questions/58439505/how-to-create-a-special-kind-of-list/58440011#58440011", "title": "How to create a special kind of list?", "body": "<p>I like to encourage people to think through things but there isn't much to this one.</p>\n\n<pre><code>filter abundant [1..]\n</code></pre>\n\n<p>This gives you an infinite list of abundant numbers.  You can <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:take\" rel=\"nofollow noreferrer\"><code>take</code></a> from it to get a finite list.</p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 12234788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207867fde03aecd6c4e308e06f7b6a36?s=128&d=identicon&r=PG&f=1", "display_name": "peter.s", "link": "https://stackoverflow.com/users/12234788/peter-s"}, "edited": false, "score": 0, "creation_date": 1571344741, "post_id": 58440178, "comment_id": 103220491, "body": "and how should I do it if it must be written just in one line? the automathic tester doesn&#39;t execpts this version..."}, {"owner": {"reputation": 665, "user_id": 10610632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb8dce0aefdec2cde25c0a79c32739?s=128&d=identicon&r=PG&f=1", "display_name": "RoyM", "link": "https://stackoverflow.com/users/10610632/roym"}, "reply_to_user": {"reputation": 71, "user_id": 12234788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207867fde03aecd6c4e308e06f7b6a36?s=128&d=identicon&r=PG&f=1", "display_name": "peter.s", "link": "https://stackoverflow.com/users/12234788/peter-s"}, "edited": false, "score": 0, "creation_date": 1571346161, "post_id": 58440178, "comment_id": 103221023, "body": "In line with what you tried on luqui&#39;s solution, you could make a function: <code>abundantnr i = take i ([x | x &lt;- [1..], abundant x])</code>"}, {"owner": {"reputation": 71, "user_id": 12234788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207867fde03aecd6c4e308e06f7b6a36?s=128&d=identicon&r=PG&f=1", "display_name": "peter.s", "link": "https://stackoverflow.com/users/12234788/peter-s"}, "edited": false, "score": 0, "creation_date": 1571346685, "post_id": 58440178, "comment_id": 103221205, "body": "yeah I got it, these solutions work perfectly, but I mean one line, like everything in a single line, it even should work if I copy paste it in to a new interpreter without any history"}, {"owner": {"reputation": 665, "user_id": 10610632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb8dce0aefdec2cde25c0a79c32739?s=128&d=identicon&r=PG&f=1", "display_name": "RoyM", "link": "https://stackoverflow.com/users/10610632/roym"}, "reply_to_user": {"reputation": 71, "user_id": 12234788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207867fde03aecd6c4e308e06f7b6a36?s=128&d=identicon&r=PG&f=1", "display_name": "peter.s", "link": "https://stackoverflow.com/users/12234788/peter-s"}, "edited": false, "score": 0, "creation_date": 1571346826, "post_id": 58440178, "comment_id": 103221260, "body": "Then pass your <code>abundant n</code> function as a <code>where</code>-clause."}, {"owner": {"reputation": 665, "user_id": 10610632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb8dce0aefdec2cde25c0a79c32739?s=128&d=identicon&r=PG&f=1", "display_name": "RoyM", "link": "https://stackoverflow.com/users/10610632/roym"}, "reply_to_user": {"reputation": 71, "user_id": 12234788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207867fde03aecd6c4e308e06f7b6a36?s=128&d=identicon&r=PG&f=1", "display_name": "peter.s", "link": "https://stackoverflow.com/users/12234788/peter-s"}, "edited": false, "score": 0, "creation_date": 1571347500, "post_id": 58440178, "comment_id": 103221491, "body": "I&#39;ve updated the answer with it all in one function. If you need it on one line specifically, and not one function, then follow with the where-clause immediately without doing a line-break."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1571349222, "post_id": 58440178, "comment_id": 103222012, "body": "BTW parens are unnecessary in this case: <code>take 10 [x | ...]</code>"}], "tags": [], "owner": {"reputation": 665, "user_id": 10610632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb8dce0aefdec2cde25c0a79c32739?s=128&d=identicon&r=PG&f=1", "display_name": "RoyM", "link": "https://stackoverflow.com/users/10610632/roym"}, "is_accepted": true, "score": 2, "last_activity_date": 1571347418, "last_edit_date": 1571347418, "creation_date": 1571343535, "answer_id": 58440178, "question_id": 58439505, "link": "https://stackoverflow.com/questions/58439505/how-to-create-a-special-kind-of-list/58440178#58440178", "title": "How to create a special kind of list?", "body": "<p>Same answer but in the notation of list-comprehension:</p>\n\n<pre><code>[x | x &lt;- [1..], abundant x]\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>take 10 ([x | x &lt;- [1..], abundant x])\n</code></pre>\n\n<blockquote>\n  <p>Out: [12,18,20,24,30,36,40,42,48,54]</p>\n</blockquote>\n\n<p>As requested from comments, here's it all in one function:</p>\n\n<pre><code>abundantnr i = take i ([x | x &lt;- [1..], abundant x])\n                 where abundant n = sum[x | x &lt;- [1..(n-1)], n `rem` x == 0]+n&gt; 2*n\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>abundantnr 10\n</code></pre>\n\n<blockquote>\n  <p>Out: [12,18,20,24,30,36,40,42,48,54]</p>\n</blockquote>\n"}], "owner": {"reputation": 71, "user_id": 12234788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207867fde03aecd6c4e308e06f7b6a36?s=128&d=identicon&r=PG&f=1", "display_name": "peter.s", "link": "https://stackoverflow.com/users/12234788/peter-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 58440178, "answer_count": 2, "score": 1, "last_activity_date": 1571352146, "creation_date": 1571340421, "last_edit_date": 1571352146, "question_id": 58439505, "link": "https://stackoverflow.com/questions/58439505/how-to-create-a-special-kind-of-list", "title": "How to create a special kind of list?", "body": "<p>I have to create a special kind of list in Haskell. First I had to create a function whether it's an abundant number or not. \nAn abundant number is when summing the divisors of number the result is bigger then the double of the original number, for example in the case of</p>\n\n<pre><code>12-&gt; 1,2,3,4,6,12 &gt; 24\n</code></pre>\n\n<p>I had this solution:</p>\n\n<pre><code> abundant n =  sum[x | x &lt;- [1..(n-1)], n `rem` x == 0]+n&gt; 2*n\n</code></pre>\n\n<p>Now I should create a list which shows you a certain number of abundant number, how should I do it?</p>\n"}, {"tags": ["haskell", "functional-programming", "dry", "code-duplication", "recursive-type"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1571338707, "post_id": 58439124, "comment_id": 103217959, "body": "Make a &quot;lifted&quot; version of the code. Where you use parameters (functions) that decide what to do. Then you can make specific function by passing functions to the lifted version."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1571340148, "post_id": 58439124, "comment_id": 103218581, "body": "I think your language could be simplified. Define <code>Add :: Expr -&gt; Expr -&gt; Expr</code> instead of <code>Add :: [Expr] -&gt; Expr</code>, and get rid of <code>Sub</code> altogether."}, {"owner": {"reputation": 601, "user_id": 3093773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ac6fa60f1914cb78100c04afff88142?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/3093773/scott"}, "edited": false, "score": 0, "creation_date": 1571340767, "post_id": 58439124, "comment_id": 103218813, "body": "I&#39;m just using this definition as a simplified version; while that would work in this case, I need to be able to contain lists of expressions for other parts of the language as well"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1571340870, "post_id": 58439124, "comment_id": 103218859, "body": "Such as? Most, if not all, chained operators can be reduced to nested binary operators."}, {"owner": {"reputation": 601, "user_id": 3093773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ac6fa60f1914cb78100c04afff88142?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/3093773/scott"}, "edited": false, "score": 0, "creation_date": 1571341076, "post_id": 58439124, "comment_id": 103218958, "body": "I need to pattern match on a list of expressions: <a href=\"https://pastebin.com/WDZaMEFq\" rel=\"nofollow noreferrer\">pastebin.com/WDZaMEFq</a> (also instead of variables by name I&#39;m using de Bruijn indices)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1571343533, "post_id": 58439124, "comment_id": 103219996, "body": "I think your <code>recurseAfter</code> is <code>ana</code> in disguise. You might want to look at anamorphisms and <code>recursion-schemes</code>. That being said, I think your final solution is as short as it can be. Switching to the official <code>recursion-schemes</code> anamorphisms won&#39;t save much."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1571411990, "post_id": 58439124, "comment_id": 103245034, "body": "that&#39;s <a href=\"https://stackoverflow.com/questions/tagged/recursion-schemes\">recursion-schemes</a>, FYI."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1571350166, "post_id": 58440463, "comment_id": 103222269, "body": "Do you really have to define <code>Expr</code> explicitly, rather than something like <code>type Expr = Fix ExprF</code>?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1571352327, "post_id": 58440463, "comment_id": 103222775, "body": "@chepner I briefly mentioned that as an alternative. It&#39;s a bit inconvenient to have to use double constructors for everything: <code>Fix</code> + the real constructor. Using the last approach with TH automation is nicer, IMO."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 38, "last_activity_date": 1571784122, "last_edit_date": 1571784122, "creation_date": 1571344942, "answer_id": 58440463, "question_id": 58439124, "link": "https://stackoverflow.com/questions/58439124/how-to-reduce-code-duplication-when-dealing-with-recursive-sum-types/58440463#58440463", "title": "How to reduce code duplication when dealing with recursive sum types", "body": "<p>Congratulations, you just rediscovered anamorphisms!</p>\n\n<p>Here's your code, rephrased so that it works with the <code>recursion-schemes</code> package. Alas, it's not shorter, since we need some boilerplate to make the machinery work. (There might be some automagic way to avoid the boilerplate, e.g. using generics. I simply do not know.)</p>\n\n<p>Below, your <code>recurseAfter</code> is replaced with the standard <code>ana</code>.</p>\n\n<p>We first define your recursive type, as well as the functor it is the fixed point of.</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor, TypeFamilies, LambdaCase #-}\n{-# OPTIONS -Wall #-}\nmodule AnaExpr where\n\nimport Data.Functor.Foldable\n\ndata Expr\n  = Variable String\n  | Number Int\n  | Add [Expr]\n  | Sub Expr Expr\n  deriving (Show)\n\ndata ExprF a\n  = VariableF String\n  | NumberF Int\n  | AddF [a]\n  | SubF a a\n  deriving (Functor)\n</code></pre>\n\n<p>Then we connect the two with a few instances so that we can unfold <code>Expr</code> into the isomorphic <code>ExprF Expr</code>, and fold it back.</p>\n\n<pre><code>type instance Base Expr = ExprF\ninstance Recursive Expr where\n   project (Variable s) = VariableF s\n   project (Number i) = NumberF i\n   project (Add es) = AddF es\n   project (Sub e1 e2) = SubF e1 e2\ninstance Corecursive Expr where\n   embed (VariableF s) = Variable s\n   embed (NumberF i) = Number i\n   embed (AddF es) = Add es\n   embed (SubF e1 e2) = Sub e1 e2\n</code></pre>\n\n<p>Finally, we adapt your original code, and add a couple of tests.</p>\n\n<pre><code>substituteName :: String -&gt; Int -&gt; Expr -&gt; Expr\nsubstituteName name newValue = ana $ \\case\n    Variable x | x == name -&gt; NumberF newValue\n    other                  -&gt; project other\n\ntestSub :: Expr\ntestSub = substituteName \"x\" 42 (Add [Add [Variable \"x\"], Number 0])\n\nreplaceSubWithAdd :: Expr -&gt; Expr\nreplaceSubWithAdd = ana $ \\case\n    Sub x (Number y) -&gt; AddF [x, Number (-y)]\n    other            -&gt; project other\n\ntestReplace :: Expr\ntestReplace = replaceSubWithAdd \n   (Add [Sub (Add [Variable \"x\", Sub (Variable \"y\") (Number 34)]) (Number 10), Number 4])\n</code></pre>\n\n<p>An alternative could be to define <code>ExprF a</code> only, and then derive <code>type Expr = Fix ExprF</code>. This saves some of the boilerplate above (e.g. the two instances), at the cost of having to use <code>Fix (VariableF ...)</code> instead of <code>Variable ...</code>, as well as the analogous for the other constructors.</p>\n\n<p>One could further alleviate that using pattern synonyms (at the cost of a little more boilerplate, though).</p>\n\n<hr>\n\n<p>Update: I finally found the automagic tool, using template Haskell. This makes the whole code reasonably short. Note that the <code>ExprF</code> functor and the two instances above still exist under the hood, and we still have to use them. We only save the hassle of having to define them manually, but that alone saves a lot of effort.</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor, DeriveTraversable, TypeFamilies, LambdaCase, TemplateHaskell #-}\n{-# OPTIONS -Wall #-}\nmodule AnaExpr where\n\nimport Data.Functor.Foldable\nimport Data.Functor.Foldable.TH\n\ndata Expr\n  = Variable String\n  | Number Int\n  | Add [Expr]\n  | Sub Expr Expr\n  deriving (Show)\n\nmakeBaseFunctor ''Expr\n\nsubstituteName :: String -&gt; Int -&gt; Expr -&gt; Expr\nsubstituteName name newValue = ana $ \\case\n    Variable x | x == name -&gt; NumberF newValue\n    other                  -&gt; project other\n\ntestSub :: Expr\ntestSub = substituteName \"x\" 42 (Add [Add [Variable \"x\"], Number 0])\n\nreplaceSubWithAdd :: Expr -&gt; Expr\nreplaceSubWithAdd = ana $ \\case\n    Sub x (Number y) -&gt; AddF [x, Number (-y)]\n    other            -&gt; project other\n\ntestReplace :: Expr\ntestReplace = replaceSubWithAdd \n   (Add [Sub (Add [Variable \"x\", Sub (Variable \"y\") (Number 34)]) (Number 10), Number 4])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 19, "last_activity_date": 1571351494, "creation_date": 1571351494, "answer_id": 58441538, "question_id": 58439124, "link": "https://stackoverflow.com/questions/58439124/how-to-reduce-code-duplication-when-dealing-with-recursive-sum-types/58441538#58441538", "title": "How to reduce code duplication when dealing with recursive sum types", "body": "<p>As an alternative approach, this is also a typical use case for the <code>uniplate</code> package.  It can use <code>Data.Data</code> generics rather than Template Haskell to generate the boilerplate, so if you derive <code>Data</code> instances for your <code>Expr</code>:</p>\n\n<pre><code>import Data.Data\n\ndata Expr\n  = Variable String\n  | Number Int\n  | Add [Expr]\n  | Sub Expr Expr\n  deriving (Show, Data)\n</code></pre>\n\n<p>then the <code>transform</code> function from <code>Data.Generics.Uniplate.Data</code> applies a function recursively to each nested <code>Expr</code>:</p>\n\n<pre><code>import Data.Generics.Uniplate.Data\n\nsubstituteName :: String -&gt; Int -&gt; Expr -&gt; Expr\nsubstituteName name newValue = transform f\n  where f (Variable x) | x == name = Number newValue\n        f other = other\n\nreplaceSubWithAdd :: Expr -&gt; Expr\nreplaceSubWithAdd = transform f\n  where f (Sub x (Number y)) = Add [x, Number (-y)]\n        f other = other\n</code></pre>\n\n<p>Note that in <code>replaceSubWithAdd</code> in particular, the function <code>f</code> is written to perform a non-recursive substitution; <code>transform</code> makes it recursive in <code>x :: Expr</code>, so it's doing the same magic to the helper function as <code>ana</code> does in @chi's answer:</p>\n\n<pre><code>&gt; substituteName \"x\" 42 (Add [Add [Variable \"x\"], Number 0])\nAdd [Add [Number 42],Number 0]\n&gt; replaceSubWithAdd (Add [Sub (Add [Variable \"x\", \n                     Sub (Variable \"y\") (Number 34)]) (Number 10), Number 4])\nAdd [Add [Add [Variable \"x\",Add [Variable \"y\",Number (-34)]],Number (-10)],Number 4]\n&gt; \n</code></pre>\n\n<p>This is no shorter than @chi's Template Haskell solution.  One potential advantage is that <code>uniplate</code> provides some additional functions that may be helpful.  For example, if you use <code>descend</code> in place of <code>transform</code>, it transforms only the <em>immediate</em> children which can give you control over where the recursion happens, or you can use <code>rewrite</code> to re-transform the result of transformations until you reach a fixed point.  One potential disadvantage is that \"anamorphism\" sounds way cooler than \"uniplate\".</p>\n\n<p>Full program:</p>\n\n<pre><code>{-# LANGUAGE DeriveDataTypeable #-}\n\nimport Data.Data                     -- in base\nimport Data.Generics.Uniplate.Data   -- package uniplate\n\ndata Expr\n  = Variable String\n  | Number Int\n  | Add [Expr]\n  | Sub Expr Expr\n  deriving (Show, Data)\n\nsubstituteName :: String -&gt; Int -&gt; Expr -&gt; Expr\nsubstituteName name newValue = transform f\n  where f (Variable x) | x == name = Number newValue\n        f other = other\n\nreplaceSubWithAdd :: Expr -&gt; Expr\nreplaceSubWithAdd = transform f\n  where f (Sub x (Number y)) = Add [x, Number (-y)]\n        f other = other\n\nreplaceSubWithAdd1 :: Expr -&gt; Expr\nreplaceSubWithAdd1 = descend f\n  where f (Sub x (Number y)) = Add [x, Number (-y)]\n        f other = other\n\nmain = do\n  print $ substituteName \"x\" 42 (Add [Add [Variable \"x\"], Number 0])\n  print $ replaceSubWithAdd e\n  print $ replaceSubWithAdd1 e\n  where e = Add [Sub (Add [Variable \"x\", Sub (Variable \"y\") (Number 34)])\n                     (Number 10), Number 4]\n</code></pre>\n"}], "owner": {"reputation": 601, "user_id": 3093773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ac6fa60f1914cb78100c04afff88142?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/3093773/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6532, "favorite_count": 10, "accepted_answer_id": 58440463, "answer_count": 2, "score": 50, "last_activity_date": 1581236032, "creation_date": 1571338625, "last_edit_date": 1581236032, "question_id": 58439124, "link": "https://stackoverflow.com/questions/58439124/how-to-reduce-code-duplication-when-dealing-with-recursive-sum-types", "title": "How to reduce code duplication when dealing with recursive sum types", "body": "<p>I am currently working on a simple interpreter for a programming language and I have a data type like this:</p>\n\n<pre><code>data Expr\n  = Variable String\n  | Number Int\n  | Add [Expr]\n  | Sub Expr Expr\n</code></pre>\n\n<p>And I have many functions that do simple things like:</p>\n\n<pre><code>-- Substitute a value for a variable\nsubstituteName :: String -&gt; Int -&gt; Expr -&gt; Expr\nsubstituteName name newValue = go\n  where\n    go (Variable x)\n      | x == name = Number newValue\n    go (Add xs) =\n      Add $ map go xs\n    go (Sub x y) =\n      Sub (go x) (go y)\n    go other = other\n\n-- Replace subtraction with a constant with addition by a negative number\nreplaceSubWithAdd :: Expr -&gt; Expr\nreplaceSubWithAdd = go\n  where\n    go (Sub x (Number y)) =\n      Add [go x, Number (-y)]\n    go (Add xs) =\n      Add $ map go xs\n    go (Sub x y) =\n      Sub (go x) (go y)\n    go other = other\n</code></pre>\n\n<p>But in each of these functions, I have to repeat the part that calls the code recursively with just a small change to one part of the function. Is there any existing way to do this more generically? I would rather not have to copy and paste this part:</p>\n\n<pre><code>    go (Add xs) =\n      Add $ map go xs\n    go (Sub x y) =\n      Sub (go x) (go y)\n    go other = other\n</code></pre>\n\n<p>And just change a single case each time because it seems inefficient to duplicate code like this.</p>\n\n<p>The only solution I could come up with is to have a function that calls a function first on the whole data structure and then recursively on the result like this:</p>\n\n<pre><code>recurseAfter :: (Expr -&gt; Expr) -&gt; Expr -&gt; Expr\nrecurseAfter f x =\n  case f x of\n    Add xs -&gt;\n      Add $ map (recurseAfter f) xs\n    Sub x y -&gt;\n      Sub (recurseAfter f x) (recurseAfter f y)\n    other -&gt; other\n\nsubstituteName :: String -&gt; Int -&gt; Expr -&gt; Expr\nsubstituteName name newValue =\n  recurseAfter $ \\case\n    Variable x\n      | x == name -&gt; Number newValue\n    other -&gt; other\n\nreplaceSubWithAdd :: Expr -&gt; Expr\nreplaceSubWithAdd =\n  recurseAfter $ \\case\n    Sub x (Number y) -&gt;\n      Add [x, Number (-y)]\n    other -&gt; other\n</code></pre>\n\n<p>But I feel like there should probably be a simpler way to do this already. Am I missing something?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1571338008, "post_id": 58438913, "comment_id": 103217674, "body": "I&#39;m not completely sure, but I&#39;d try <a href=\"https://docs.haskellstack.org/en/stable/yaml_configuration/#system-ghc\" rel=\"nofollow noreferrer\"><code>system-ghc: true, install-ghc: false</code></a> and some LTS which uses the same GHC version as the installed one (otherwise, I think stack has to download it per-user)."}, {"owner": {"reputation": 161, "user_id": 2788803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f9e3a1ed6f74918651e4c77122a3a74?s=128&d=identicon&r=PG&f=1", "display_name": "Ben MacAdam", "link": "https://stackoverflow.com/users/2788803/ben-macadam"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1571338645, "post_id": 58438913, "comment_id": 103217929, "body": "Unfortunately, the LTS we&#39;re using doesn&#39;t have all of the packages necessary for this project."}], "owner": {"reputation": 161, "user_id": 2788803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f9e3a1ed6f74918651e4c77122a3a74?s=128&d=identicon&r=PG&f=1", "display_name": "Ben MacAdam", "link": "https://stackoverflow.com/users/2788803/ben-macadam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 6, "last_activity_date": 1571337677, "creation_date": 1571337677, "question_id": 58438913, "link": "https://stackoverflow.com/questions/58438913/how-can-i-set-up-haskell-stack-to-use-the-system-compilerlibraries", "title": "How can I set up Haskell stack to use the system compiler+libraries?", "body": "<p>More broadly, I'd like to be able to use Haskell Stack as a build tool for projects in a university class. The main issue I've run into is when students try to use Haskell stack to build their project, they very quickly run up against their space quotas, as stack installs a sandboxed GHC compiler and all of the libraries locally.</p>\n\n<p>I would like to be able to add flags to the project file so that the system GHC and libraries are used to work around this. Right now our IT department has the system GHC part working, but stack is still installing all libraries locally. </p>\n\n<p>I'm open to other solutions.</p>\n"}, {"tags": ["list", "haskell", "merge"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1571337021, "post_id": 58438743, "comment_id": 103217273, "body": "What is not working with your approach?"}, {"owner": {"reputation": 13, "user_id": 12234566, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDm4inL-roKL0CH_kZyelRo1qIXiHxJzjb3afs-Ng=k-s128", "display_name": "Tyler&#39;s ruler", "link": "https://stackoverflow.com/users/12234566/tylers-ruler"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1571337380, "post_id": 58438743, "comment_id": 103217414, "body": "I am new to haskell and don&#39;t know how to approach this problem at all, I&#39;ve tried merging these two lists in one, using 1st element from the 1st list then 2nd one form the second. I get [1,4,2,5,3,6], but then don&#39;t know how to make pairs out of that."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1571337438, "post_id": 58438743, "comment_id": 103217446, "body": "you can try to implement this with <i>explicit recursion</i>."}, {"owner": {"reputation": 13, "user_id": 12234566, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDm4inL-roKL0CH_kZyelRo1qIXiHxJzjb3afs-Ng=k-s128", "display_name": "Tyler&#39;s ruler", "link": "https://stackoverflow.com/users/12234566/tylers-ruler"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1571337559, "post_id": 58438743, "comment_id": 103217496, "body": "If you could please elaborate because I currently have no knowlede on this subject, writing me a program would be appreciated."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12234566, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDm4inL-roKL0CH_kZyelRo1qIXiHxJzjb3afs-Ng=k-s128", "display_name": "Tyler&#39;s ruler", "link": "https://stackoverflow.com/users/12234566/tylers-ruler"}, "edited": false, "score": 0, "creation_date": 1571338708, "post_id": 58439042, "comment_id": 103217960, "body": "At my college we are using notepad++ to write our programs and then execute them in ghci, but we are first writing: main :: IO(), main = do, i &lt;- getLine, let a = read i :: [Int], and print (a) for example"}, {"owner": {"reputation": 13, "user_id": 12234566, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDm4inL-roKL0CH_kZyelRo1qIXiHxJzjb3afs-Ng=k-s128", "display_name": "Tyler&#39;s ruler", "link": "https://stackoverflow.com/users/12234566/tylers-ruler"}, "edited": false, "score": 0, "creation_date": 1571338826, "post_id": 58439042, "comment_id": 103218001, "body": "Then we write before that the actual script"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 13, "user_id": 12234566, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDm4inL-roKL0CH_kZyelRo1qIXiHxJzjb3afs-Ng=k-s128", "display_name": "Tyler&#39;s ruler", "link": "https://stackoverflow.com/users/12234566/tylers-ruler"}, "edited": false, "score": 0, "creation_date": 1571338859, "post_id": 58439042, "comment_id": 103218027, "body": "@Tyler&#39;sruler: you can just load in the file in <code>ghci</code>, and use the prompt, so test it with <code>zip&#39; [1,2,3] [4,5,6]</code>."}, {"owner": {"reputation": 13, "user_id": 12234566, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDm4inL-roKL0CH_kZyelRo1qIXiHxJzjb3afs-Ng=k-s128", "display_name": "Tyler&#39;s ruler", "link": "https://stackoverflow.com/users/12234566/tylers-ruler"}, "edited": false, "score": 0, "creation_date": 1571339478, "post_id": 58439042, "comment_id": 103218330, "body": "I need to make it so that when i call main in ghci and then type any two lists to make  the third one"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 13, "user_id": 12234566, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDm4inL-roKL0CH_kZyelRo1qIXiHxJzjb3afs-Ng=k-s128", "display_name": "Tyler&#39;s ruler", "link": "https://stackoverflow.com/users/12234566/tylers-ruler"}, "edited": false, "score": 0, "creation_date": 1571339816, "post_id": 58439042, "comment_id": 103218467, "body": "@Tyler&#39;sruler: the only thing you need to do is then <code>print (zip&#39; firstlist secondlist)</code>, you probably will need to specify of the type of the items to read."}, {"owner": {"reputation": 13, "user_id": 12234566, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDm4inL-roKL0CH_kZyelRo1qIXiHxJzjb3afs-Ng=k-s128", "display_name": "Tyler&#39;s ruler", "link": "https://stackoverflow.com/users/12234566/tylers-ruler"}, "edited": false, "score": 0, "creation_date": 1571340340, "post_id": 58439042, "comment_id": 103218652, "body": "My colleagues just sent me their version of the solution: combine [] [] = [] combine (x : xs) (y : ys) = [(x,y)] ++ combine xs ys  main :: IO() main = do   i &lt;- getLine    let a = read i :: [Int]   i &lt;- getLine    let b = read i :: [Int]   print (combine a b) Unfortunatelly we can&#39;t have the same way of resolving the task"}, {"owner": {"reputation": 13, "user_id": 12234566, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDm4inL-roKL0CH_kZyelRo1qIXiHxJzjb3afs-Ng=k-s128", "display_name": "Tyler&#39;s ruler", "link": "https://stackoverflow.com/users/12234566/tylers-ruler"}, "edited": false, "score": 0, "creation_date": 1571340509, "post_id": 58439042, "comment_id": 103218714, "body": "So if i could just refrase the part before main :: IO(),.... combine [] [] = [] combine (x : xs) (y : ys) = [(x,y)] ++ combine xs ys.... this part"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 13, "user_id": 12234566, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDm4inL-roKL0CH_kZyelRo1qIXiHxJzjb3afs-Ng=k-s128", "display_name": "Tyler&#39;s ruler", "link": "https://stackoverflow.com/users/12234566/tylers-ruler"}, "edited": false, "score": 1, "creation_date": 1571341307, "post_id": 58439042, "comment_id": 103219052, "body": "@Tyler&#39;sruler: the exercise in <i>this</i> answer is different one than the one they have given, so you need to fill in the <code>...</code>s."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 4, "last_activity_date": 1571338298, "creation_date": 1571338298, "answer_id": 58439042, "question_id": 58438743, "link": "https://stackoverflow.com/questions/58438743/how-can-i-merge-two-lists-using-the-technique-below/58439042#58439042", "title": "How can i merge two lists using the technique below", "body": "<p>This is known as \"zipping\". You can use a <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:zip\" rel=\"nofollow noreferrer\"><strong><code>zip :: [a] -&gt; [b] -&gt; [(a, b)]</code></strong></a>. Indeed, for example:</p>\n\n<pre><code>Prelude&gt; zip [1,2,3] [4,5,6]\n[(1,4),(2,5),(3,6)]\n</code></pre>\n\n<p>You can implement your own <code>zip</code> through explicit recursion. If one of the two lists (or both) are empty, then the result is an empty list. If both lists are non-empty, then you should yield a 2-tuple of the two heads of the list, and recurse on the two tails.</p>\n\n<p>So a program will look like:</p>\n\n<pre><code>zip' :: [a] -&gt; [b] -&gt; [(a, b)]\nzip' [] _ = &hellip;\nzip' _ [] = &hellip;\nzip' (x:xs) (y:ys) = &hellip;</code></pre>\n\n<p>with <code>&hellip;</code> the parts you need to fill in.</p>\n"}], "owner": {"reputation": 13, "user_id": 12234566, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDm4inL-roKL0CH_kZyelRo1qIXiHxJzjb3afs-Ng=k-s128", "display_name": "Tyler&#39;s ruler", "link": "https://stackoverflow.com/users/12234566/tylers-ruler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1571338298, "creation_date": 1571336968, "last_edit_date": 1571337011, "question_id": 58438743, "link": "https://stackoverflow.com/questions/58438743/how-can-i-merge-two-lists-using-the-technique-below", "title": "How can i merge two lists using the technique below", "body": "<p>I need to take two lists and combine them making pairs of 1st element of each list, then 2nd and so on...</p>\n\n<p>Input: <code>[1,2,3] [4,5,6]</code>\nOutput: <code>[(1,4),(2,5),(3,6)]</code></p>\n"}, {"tags": ["list", "haskell", "combinations", "cartesian-product"], "comments": [{"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 3, "creation_date": 1571308193, "post_id": 58430356, "comment_id": 103201641, "body": "hint: use list comprehension ;) If you fail, edit thias question with your doubts"}, {"owner": {"reputation": 1, "user_id": 12232111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fdea5f57b4b689523a3f84cc2018e71?s=128&d=identicon&r=PG&f=1", "display_name": "Eldeguard", "link": "https://stackoverflow.com/users/12232111/eldeguard"}, "reply_to_user": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 1, "creation_date": 1571310199, "post_id": 58430356, "comment_id": 103202762, "body": "ok ive got it , thanks for the tip :D"}, {"owner": {"reputation": 271, "user_id": 3574479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef0ae971aa925ec2f6c2ff12cc99c822?s=128&d=identicon&r=PG", "display_name": "joeA", "link": "https://stackoverflow.com/users/3574479/joea"}, "edited": false, "score": 1, "creation_date": 1571310372, "post_id": 58430356, "comment_id": 103202868, "body": "Think about your function x. You say it has no inputs, but where does it get the tuples (or lists?) that you want combined? Note that you can&#39;t use parentheses and square brackets interchangeably here, so I&#39;m not 100% sure of exactly what you are looking for. Perhaps a function that takes two LISTS and produces one LIST of pairs (i.e. a list of 2-tuples)? I assume that you don&#39;t want to use exactly and only the characters x,y,z and 1,2,3 but something more flexible (e.g. any two lists of equal size?)."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 4, "creation_date": 1571312305, "post_id": 58430356, "comment_id": 103204000, "body": "<code>x :: [(Char, Int)]</code> is not a definition; it&#39;s a type annotation. Also, <code>x</code> is not a function, but a list of tuples. A function that that takes a list of characters <code>[Char]</code> and a list of integers <code>[Int]</code> to produce something with the same type of <code>x</code> would have the type <code>[Char] -&gt; [Int] -&gt; [(Char, Int)]</code>. Your job is to define some function <code>foo :: [Char] -&gt; [Int] -&gt; [(Char, Int)]</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1571316795, "post_id": 58430356, "comment_id": 103206715, "body": "@Willem corrections go to answers, not questions. :) I think your edit should be rolled back."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1571321362, "creation_date": 1571321362, "answer_id": 58434631, "question_id": 58430356, "link": "https://stackoverflow.com/questions/58430356/haskell-beginner-question-set-up-pairs-in-definition/58434631#58434631", "title": "Haskell beginner question, set up pairs in definition", "body": "<p><code>x</code> is not a function; it's a list of tuples. You can define it directly, or you can define a function of type <code>foo :: [Char] -&gt; [Int] -&gt; [(Char, Int)]</code>, then set <code>x</code> by calling <code>foo</code> with two appropriate lists.</p>\n\n<pre><code>foo :: [Char] -&gt; [Int] -&gt; [(Char, Int)]\nfoo chars ints = ...  -- You define this\n\nx :: [(Char, Int)]\nx = foo ['x', 'y', 'z'] [1, 2, 3]\n</code></pre>\n\n<p>As for how you define <code>foo</code>, I suggest you start by reading about <a href=\"https://wiki.haskell.org/List_comprehension\" rel=\"nofollow noreferrer\">list comprehensions</a>. They are not the only way to define <code>foo</code>, but they are probably the simplest. If you are familiar with list comprehensions in a language like Python, you shouldn't have a problem; Haskell is where Python got the idea.</p>\n"}], "owner": {"reputation": 1, "user_id": 12232111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fdea5f57b4b689523a3f84cc2018e71?s=128&d=identicon&r=PG&f=1", "display_name": "Eldeguard", "link": "https://stackoverflow.com/users/12232111/eldeguard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1571321362, "creation_date": 1571307851, "last_edit_date": 1571316989, "question_id": 58430356, "link": "https://stackoverflow.com/questions/58430356/haskell-beginner-question-set-up-pairs-in-definition", "title": "Haskell beginner question, set up pairs in definition", "body": "<p>So I'm really new to Haskell and have a definition called:</p>\n\n<pre><code> x :: [(char,Int)]\n</code></pre>\n\n<p><code>x</code> needs to get defined as a function that just puts the chars <code>(x,y,z)</code> together with <code>(1,2,3)</code> in every way. </p>\n\n<p>So when I call <code>x</code> I just want to get the output of <code>[x,1], [x,2], [x,3], [y,1], [y,2]</code> and so on. </p>\n\n<p>Might be some easy problem but I'm confused that there is no actual input in the <code>x</code> function. It just needs to output the lists. </p>\n\n<p>I have tried creating both lists (the number and char list) but how do I put them together in the function ?</p>\n"}, {"tags": ["haskell", "scotty", "haskell-wai"], "answers": [{"tags": [], "owner": {"reputation": 1350, "user_id": 1308616, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/04aec969ee650e180ce48f721cf37a7e?s=128&d=identicon&r=PG", "display_name": "Casper Thule Hansen", "link": "https://stackoverflow.com/users/1308616/casper-thule-hansen"}, "is_accepted": true, "score": 0, "last_activity_date": 1571341906, "creation_date": 1571341906, "answer_id": 58439824, "question_id": 58429399, "link": "https://stackoverflow.com/questions/58429399/wai-logger-filelogspec-as-scotty-middleware-reporting-openfile-resource-busy-f/58439824#58439824", "title": "wai-logger FileLogSpec as Scotty Middleware reporting openFile: resource busy (file is locked)", "body": "<p>sicklorkin from irc freenode #haskell responded with the rather obvious solution - </p>\n\n<blockquote>\n  <p>Make sure you havn't accidentally opened the logger twice</p>\n</blockquote>\n\n<p>and asked me to try passing in the logger.</p>\n\n<p>So the new and working solution is: </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>someFunc :: IO ()\nsomeFunc = do\n    appConfig &lt;- loadAppConfig\n    workingDir &lt;- Dir.getCurrentDirectory\n    putStrLn $ \"Working directory: \" &lt;&gt; workingDir\n    fileLogger &lt;- createLogger \n    case appConfig of\n        Nothing -&gt; putStrLn \"Failed to load appconfig.json\"\n        Just appConfig' -&gt;\n            let checkSizeRequirement' = checkSizeRequirement (sizeLimitGB appConfig') in\n                scotty 3000 $ do\n                    --middleware logStdoutDev\n                    middleware $ (mw fileLogger)\n</code></pre>\n\n<p>And further down the mw has been split from createLogger:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>mw :: Logger.ApacheLogger -&gt; Wai.Middleware\nmw logger (app::Wai.Application) (req::Request) (fRes::(Response -&gt; IO ResponseReceived)) =\n    app req myResponseFunction\n    where\n        myResponseFunction :: Response -&gt; IO ResponseReceived\n        myResponseFunction response = do\n            logger req (Wai.responseStatus response) Nothing\n            fRes response\n\ncreateLogger :: IO Logger.ApacheLogger\ncreateLogger = createLoggerActions &gt;&gt;= return . Logger.apacheLogger\n</code></pre>\n"}], "owner": {"reputation": 1350, "user_id": 1308616, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/04aec969ee650e180ce48f721cf37a7e?s=128&d=identicon&r=PG", "display_name": "Casper Thule Hansen", "link": "https://stackoverflow.com/users/1308616/casper-thule-hansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 58439824, "answer_count": 1, "score": 1, "last_activity_date": 1573822644, "creation_date": 1571304790, "last_edit_date": 1573822644, "question_id": 58429399, "link": "https://stackoverflow.com/questions/58429399/wai-logger-filelogspec-as-scotty-middleware-reporting-openfile-resource-busy-f", "title": "wai-logger FileLogSpec as Scotty Middleware reporting openFile: resource busy (file is locked)", "body": "<p>I am using Scotty for a backend application in Haskell and I am interested in logging all requests to a file.\nThe existing wai-middleware <a href=\"http://hackage.haskell.org/package/wai-extra-3.0.28/docs/Network-Wai-Middleware-RequestLogger.html\" rel=\"nofollow noreferrer\">requestlogger</a> is not enough as I would like the properties of <a href=\"http://hackage.haskell.org/package/wai-logger-2.3.6/docs/Network-Wai-Logger.html#t:FileLogSpec\" rel=\"nofollow noreferrer\">FileLogSpec</a>, since I like have multiple but short logfiles, which FileLogSpec permits.</p>\n\n<p>I am also open to alternative solutions on the logging issue, but I am not interested in switching from Scotty.</p>\n\n<p>My <strong>problem</strong> is, that after the first request I get this error: </p>\n\n<pre><code>openFile: resource busy (file is locked)\nopenFile: resource busy (file is locked)\n</code></pre>\n\n<p>and the application stops logging entirely.</p>\n\n<p>My current implementation making wai-logger into a middleware is: </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- type Middleware = Application -&gt; Application\n-- Type Application = Request -&gt; (Response -&gt; IO ResponseReceived) -&gt; IO ResponseReceived\nmw :: Wai.Middleware\nmw (app::Wai.Application) (req::Request) (fRes::(Response -&gt; IO ResponseReceived)) =\n    app req myResponseFunction\n    where\n        myResponseFunction :: Response -&gt; IO ResponseReceived\n        myResponseFunction response = do\n            logger' &lt;- logger\n            logger' req (Wai.responseStatus response) Nothing\n            fRes response\n        logger :: IO Logger.ApacheLogger\n        logger = createLoggerActions &gt;&gt;= return . Logger.apacheLogger\n        createLoggerActions :: IO Logger.ApacheLoggerActions\n        createLoggerActions = let\n            -- 5 MB in bytes = 5242880\n            mb5InBytes = 5242880\n            -- From fast-logger default\n            defaultBufSize = 4096 in\n                Logger.initLogger\n                Logger.FromFallback\n                (Logger.LogFile Logger.FileLogSpec {Logger.log_file = \"reqLogger\", Logger.log_file_size = mb5InBytes, Logger.log_backup_number = 5} defaultBufSize)\n                ( return $ B.pack \"%d/%b/%Y:%T %z\")\n</code></pre>\n\n<p>I have tried using bracket to clean up the logger as follows: </p>\n\n<pre><code>mw :: Wai.Middleware    \nmw (app::Wai.Application) (req::Request) (fRes::(Response -&gt; IO ResponseReceived)) =\n    let loggerActions = createLoggerActions in\n        bracket_ setup (teardown loggerActions) $ \n        app req (myResponseFunction loggerActions)\n    where\n        myResponseFunction :: IO Logger.ApacheLoggerActions -&gt; Response -&gt; IO ResponseReceived\n        myResponseFunction loggerActions response = do\n            logger' &lt;- logger loggerActions\n            logger' req (Wai.responseStatus response) Nothing\n            fRes response\n        logger :: IO Logger.ApacheLoggerActions -&gt; IO Logger.ApacheLogger\n        logger loggerActions = loggerActions &gt;&gt;= return . Logger.apacheLogger\n        createLoggerActions :: IO Logger.ApacheLoggerActions\n        createLoggerActions = let\n            -- 5 MB in bytes = 5242880\n            mb5InBytes = 5242880\n            -- From fast-logger default\n            defaultBufSize = 4096 in\n                Logger.initLogger\n                Logger.FromFallback\n                (Logger.LogFile Logger.FileLogSpec {Logger.log_file = \"reqLogger\", Logger.log_file_size = mb5InBytes, Logger.log_backup_number = 5} defaultBufSize)\n                ( return $ B.pack \"%d/%b/%Y:%T %z\")\n        setup :: IO ()\n        setup = return ()\n        teardown :: IO (Logger.ApacheLoggerActions) -&gt; IO ()\n        teardown loggerActions = loggerActions &gt;&gt;= Logger.logRemover\n</code></pre>\n\n<p>And here is how I use it:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>someFunc :: IO ()\nsomeFunc = do\n    appConfig &lt;- loadAppConfig\n    workingDir &lt;- Dir.getCurrentDirectory\n    putStrLn $ \"Working directory: \" &lt;&gt; workingDir\n    case appConfig of\n        Nothing -&gt; putStrLn \"Failed to load appconfig.json\"\n        Just appConfig' -&gt;\n            let checkSizeRequirement' = checkSizeRequirement (sizeLimitGB appConfig') in\n                scotty 3000 $ do\n                    --middleware logStdoutDev\n                    middleware $ mw\n                    middleware $ staticPolicy (addBase \"./ElmFeFMI/\")\n                    post \"/api/fmichecker\" ...\n</code></pre>\n\n<p>Unfortunately, this led to the same result.</p>\n\n<p>I have created an issue on wai logger as well: <a href=\"https://github.com/kazu-yamamoto/logger/issues/183\" rel=\"nofollow noreferrer\">https://github.com/kazu-yamamoto/logger/issues/183</a></p>\n\n<p>The full source is available here: <a href=\"https://github.com/into-cps-association/utilities_backend\" rel=\"nofollow noreferrer\">https://github.com/into-cps-association/utilities_backend</a></p>\n"}, {"tags": ["haskell", "distance", "euclidean-distance"], "comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1571301730, "post_id": 58428283, "comment_id": 103197781, "body": "Hint: calculate the distance between each pair of points, then add up all the distances you have found."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1571301690, "creation_date": 1571301690, "answer_id": 58428386, "question_id": 58428283, "link": "https://stackoverflow.com/questions/58428283/distance-between-points-on-haskell/58428386#58428386", "title": "Distance between points on haskell", "body": "<p>We can rename this function to <code>distance2</code> to specify that it calculates the distance between two points:</p>\n\n<pre><code>distance2 :: Floating a =&gt; (a, a) -&gt; (a, a) -&gt; a\ndistance2 (x1 , y1) (x2 , y2) = sqrt (x'*x' + y'*y')\n    where x' = x1 - x2\n          y' = y1 - y2</code></pre>\n\n<p>Next we can make use of <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:zipWith\" rel=\"nofollow noreferrer\"><strong><code>zipWith :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]</code></strong></a> to iterate concurrently over two lists, and apply a function to the elements. Here we iterate over the list, and its tail. This will thus produce a list of distances. We can make use of <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:sum\" rel=\"nofollow noreferrer\"><strong><code>sum :: (Num a, Foldable f) =&gt; f a -&gt; a</code></strong></a> to sum up these distances:</p>\n\n<pre><code>distance2 :: Floating a =&gt; [(a, a)] -&gt; a\ndistance [] = 0\ndistance xa@(_:xs) = sum (zipWith distance2 xa xs)</code></pre>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 4, "creation_date": 1571315594, "post_id": 58428577, "comment_id": 103205914, "body": "<code>splitPairs = zip &lt;*&gt; tail</code>; while not being immediately obvious, it&#39;s a nice idiom."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1571331249, "post_id": 58428577, "comment_id": 103214808, "body": "I think Willem&#39;s interpretation for the &lt;2elems case to give 0 is more sensible than throwing an error. Really the function should probably be called something like <code>pathLength</code>, not <code>distance</code>. In that case a path with less than 2 vertices has length 0."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1571347153, "post_id": 58428577, "comment_id": 103221370, "body": "@chepner That is a really nice definition! But I opted to use my definition for clarity \u2014 it isn\u2019t immediately obvious how <code>zip &lt;*&gt; tail</code> works."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1571347225, "post_id": 58428577, "comment_id": 103221398, "body": "@leftaroundabout Good point about &lt;2elems \u2014 I\u2019ll edit that in now. And I agree about <code>pathLength</code>, but when the question was asked it was called <code>distance</code>, and I felt that it was easier to keep the function name the same."}], "tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": false, "score": 2, "last_activity_date": 1571302302, "creation_date": 1571302302, "answer_id": 58428577, "question_id": 58428283, "link": "https://stackoverflow.com/questions/58428283/distance-between-points-on-haskell/58428577#58428577", "title": "Distance between points on haskell", "body": "<p>Firstly, like @WillemVanOnsem, I will rename <code>distance</code> to <code>distance2</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>distance2 :: Floating a =&gt; (a, a) -&gt; (a, a) -&gt; a\ndistance2 (x1 , y1) (x2 , y2) = sqrt (x'*x' + y'*y')\n    where x' = x1 - x2\n          y' = y1 - y2\n</code></pre>\n\n<p>Next, given a list, a function to split it into pairs:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>splitPairs :: [a] -&gt; [(a,a)]\nsplitPairs (x:y:xs) = (x,y) : (splitPairs (y:xs))\nsplitPairs _ = error \"can\u2019t split into pairs when &lt;2 elements!\"\n</code></pre>\n\n<p>Finally, given a list of points, split it into pairs, calculate the distance between each pair, and add them up:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>distance :: Floating a =&gt; [(a,a)] -&gt; a\ndistance = sum . map (uncurry distance2) . splitPairs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 1, "last_activity_date": 1571330897, "creation_date": 1571330897, "answer_id": 58437350, "question_id": 58428283, "link": "https://stackoverflow.com/questions/58428283/distance-between-points-on-haskell/58437350#58437350", "title": "Distance between points on haskell", "body": "<p>Without recursion it would be best to use <code>zipWith</code> and <code>sum</code> functions with the applicative operator <code>&lt;*&gt;</code>.</p>\n\n<pre><code>Prelude&gt; :{\nPrelude| dist :: Floating a =&gt; [(a, a)] -&gt; a\nPrelude| dist = sum . (ds &lt;*&gt; tail)\nPrelude|        where ds = zipWith (\\f s -&gt; sqrt ((fst f - fst s)^2 + (snd f - snd s)^2))\nPrelude| :}\nPrelude&gt; dist [(0,0),(2,0),(2,5)]\n7.0\nPrelude&gt; dist [(1,1),(3,4)]\n3.605551275463989\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 12163851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-79n3R-_C8vo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcGhYJemL5ZVEMC3anTgULEGnIAXQ/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/12163851/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 926, "favorite_count": 1, "accepted_answer_id": 58428386, "answer_count": 3, "score": 3, "last_activity_date": 1571330897, "creation_date": 1571301347, "question_id": 58428283, "link": "https://stackoverflow.com/questions/58428283/distance-between-points-on-haskell", "title": "Distance between points on haskell", "body": "<p>im new to haskell and i have to do a function that takes a list and calculates the distance recursively. </p>\n\n<pre><code>For example:\ndistance [(0,0),(2,0),(2,5)]\n-&gt;7\ndistance [(1,1),(3,4)]\n-&gt;3.6055512\n</code></pre>\n\n<p>I made the distance between just two points like this</p>\n\n<pre><code>distance (x1 , y1) (x2 , y2) = sqrt \n(x'*x' + y'*y')\nwhere\n  x' = x1 - x2\n  y' = y1 - y2\n</code></pre>\n\n<p>But dont know how do to it with a variable list size, thanks</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1571296530, "post_id": 58426471, "comment_id": 103195087, "body": "Please include the type error messages in your question"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11541253, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xzMgdCWGY30/AAAAAAAAAAI/AAAAAAAABkM/6ZdX6ESsCvw/photo.jpg?sz=128", "display_name": "Luigi Minardi Maia", "link": "https://stackoverflow.com/users/11541253/luigi-minardi-maia"}, "edited": false, "score": 0, "creation_date": 1571336775, "post_id": 58427189, "comment_id": 103217144, "body": "Your solution made it just fine. The only mistake is that, in main function, the last line must be an expression.   <code>The last statement in a &#39;do&#39; block must be an expression </code>"}], "tags": [], "owner": {"reputation": 171, "user_id": 7734697, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qbUvpJ63STI/AAAAAAAAAAI/AAAAAAAAAYg/3M_O6a3GxSU/photo.jpg?sz=128", "display_name": "Rinne Hmm", "link": "https://stackoverflow.com/users/7734697/rinne-hmm"}, "is_accepted": true, "score": 2, "last_activity_date": 1571355656, "last_edit_date": 1571355656, "creation_date": 1571297484, "answer_id": 58427189, "question_id": 58426471, "link": "https://stackoverflow.com/questions/58426471/how-can-i-create-and-kill-a-list-of-threads-in-haskell/58427189#58427189", "title": "How can I create and kill a list of threads in Haskell?", "body": "<p>I think you need to use <code>Control.Monad.mapM :: (Monad m) =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]</code></p>\n\n<p>Example: </p>\n\n<pre><code>main = do \n  ts &lt;- mapM forkIO [(write 'a'), (write 'b')]\n  putStrLn \"Stop printing as and bs!\"\n  _ &lt;- mapM killThread ts -- or use mapM_ for no returning result effect\n  pure () -- return ()\n  where\n    write c = do \n      putChar c\n      write c\n</code></pre>\n\n<p>And you don't have to use semicolon in haskell <code>;</code>. Just correction indentation is enough.</p>\n"}], "owner": {"reputation": 13, "user_id": 11541253, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xzMgdCWGY30/AAAAAAAAAAI/AAAAAAAABkM/6ZdX6ESsCvw/photo.jpg?sz=128", "display_name": "Luigi Minardi Maia", "link": "https://stackoverflow.com/users/11541253/luigi-minardi-maia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 58427189, "answer_count": 1, "score": 1, "last_activity_date": 1571355656, "creation_date": 1571294930, "question_id": 58426471, "link": "https://stackoverflow.com/questions/58426471/how-can-i-create-and-kill-a-list-of-threads-in-haskell", "title": "How can I create and kill a list of threads in Haskell?", "body": "<p>I don't know how to put the ThreadIds running in a list and, then, killing all the thread created.</p>\n\n<p>I've tried some Monads operations but I could't understand the type erros in ghci.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Control.Concurrent\n\nmain = do \n  ts &lt;- [forkIO(write 'a'), forkIO(write 'b')];\n  putStrLn \"Stop printing as and bs!\";\n  map killThread ts;\n  where\n    write c = do \n      putChar c;\n      write c;\n</code></pre>\n\n<p>I expected the code to run two other threads in parallel and then killing this two threads.</p>\n"}]