[{"tags": ["haskell", "input"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1480546353, "post_id": 40899314, "comment_id": 69013209, "body": "Your logic is just inside-out. You should be checking for the terminator in <code>main</code> not <code>readData</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7201762"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1480547075, "post_id": 40899314, "comment_id": 69013487, "body": "@ReidBarton, but then how should I pass <code>n</code> lines to my function??"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1480548564, "post_id": 40899314, "comment_id": 69014016, "body": "Not sure this question deserves two question marks. You already have the pieces <code>replicateM (head val)</code> and <code>fmap (map read . words) getLine</code> that you need."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7201762"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1480549348, "post_id": 40899314, "comment_id": 69014287, "body": "@ReidBarton, please take a look at my edit"}, {"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 1, "creation_date": 1480552900, "post_id": 40899314, "comment_id": 69015316, "body": "Should output only display after the terminating condition?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7201762"}, "reply_to_user": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 0, "creation_date": 1480552969, "post_id": 40899314, "comment_id": 69015333, "body": "@mnoronha, Yes it must"}, {"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 1, "creation_date": 1480553486, "post_id": 40899314, "comment_id": 69015459, "body": "And the print order matters?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7201762"}, "reply_to_user": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 0, "creation_date": 1480553757, "post_id": 40899314, "comment_id": 69015529, "body": "@mnoronha, thanks for your interest in helping me out. I have posted another edit in which I have made several adjustments. Yes, the order matters"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7201762"}, "reply_to_user": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 0, "creation_date": 1480555418, "post_id": 40899314, "comment_id": 69015938, "body": "@mnoronha, can you help me out with printing the case number as described in the question. And any luck on printing the output at the end? Thanks."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1480599587, "post_id": 40899314, "comment_id": 69036371, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/40901651/haskell-print-case-number\">Haskell: Print case number</a>"}], "owner": {"user_type": "does_not_exist", "display_name": "user7201762"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480555357, "creation_date": 1480544429, "last_edit_date": 1480555357, "question_id": 40899314, "link": "https://stackoverflow.com/questions/40899314/accepting-input-using-haskell", "title": "Accepting input using Haskell", "body": "<p>I have to read input as:</p>\n\n<pre><code>1 &lt;- number of lines next\n10 20 30\n2 &lt;- number of lines next\n5 5 5\n6 8 9\n0 &lt;- terminating condition\n</code></pre>\n\n<p>The output should be:</p>\n\n<pre><code>output of f[(10,20,30)]\noutput of f[(5,5,5),(6,8,9)]\n</code></pre>\n\n<p>I also need to print the case number:</p>\n\n<p>eg. </p>\n\n<pre><code>Case 1: ...\nCase 2: ...\n</code></pre>\n\n<p>The function which produces the output has type:\n<code>f :: [(Int,Int,Int)] -&gt; Int</code></p>\n\n<p>I am using it as:</p>\n\n<pre><code>loop = do\n x &lt;- getLine\n if x == \"0\"\n  then return ()\n  else do arr &lt;- replicateM (read x :: Int) getLine \n          let queries = map (read :: String -&gt; Int) $ words $ unwords arr\n          print $ f $ pairUp queries;\n          loop\n\nmain = loop\n\npairUp :: [Int] -&gt; [(Int,Int,Int)]\npairUp (0:0:0:_) = []\npairUp (n:m:o:rest) = (n,m,o) : (pairUp rest)\npairUp (_) = []\n</code></pre>\n\n<p><strong>This prints immediately after one test case but continues till 0</strong></p>\n\n<p>Is there any way I can print the output at the end?</p>\n"}, {"tags": ["java", "haskell"], "comments": [{"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 4, "creation_date": 1480533580, "post_id": 40896381, "comment_id": 69006755, "body": "Stop trying to write procedural Haskell. Instead of mutation, think about sequences of transformations of values."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480533889, "post_id": 40896381, "comment_id": 69006929, "body": "Is your Java code working? The comment in it seems to be suggesting otherwise. :)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1480534364, "post_id": 40896381, "comment_id": 69007140, "body": "Writing in language X by translating from language Y is one of the worst ways, almost always producing very unidiomatic code. Express your algorithm using what Haskell offers instead of trying to translate from another language."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7201762"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1480534384, "post_id": 40896381, "comment_id": 69007145, "body": "@Caleth, Actually, I am kind of time constrained and I don&#39;t have the required expertise. Can you please help me out in finding an alternative?"}], "answers": [{"comments": [{"owner": {"reputation": 336, "user_id": 5657031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQu61dwt0vc/AAAAAAAAAAI/AAAAAAAAAY0/ki0tUEoS0pU/photo.jpg?sz=128", "display_name": "Michael Szvetits", "link": "https://stackoverflow.com/users/5657031/michael-szvetits"}, "edited": false, "score": 1, "creation_date": 1480553921, "post_id": 40897752, "comment_id": 69015575, "body": "Note that this answer is not fully correct. <code>babyBlocks [(3,3,1), (2,2,5), (2,2,2)]</code> should not return 5."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": -1, "last_activity_date": 1480553360, "last_edit_date": 1480553360, "creation_date": 1480538319, "answer_id": 40897752, "question_id": 40896381, "link": "https://stackoverflow.com/questions/40896381/translating-a-piece-of-java-code-to-haskell/40897752#40897752", "title": "Translating a piece of Java code to Haskell", "body": "<p>The way to solve this problem (I think), is to consider every rotation of every box (so you have <code>3n</code> total rotations). Then, you order these based on increasing size of their base. The problem then is just to pick the longest subsequence of boxes that \"fit\" with each other (you don't need to worry about picking the same box twice because a box could never fit on itself). This sounds a lot like the canonical <a href=\"https://en.wikipedia.org/wiki/Longest_increasing_subsequence\" rel=\"nofollow noreferrer\">longest increasing subsequence</a> problem, which suggests we will want a dynamic programming solution. We will have an array of length <code>3n</code> where the ith element represents the maximum height of the stack you can make with the ith box at the top.</p>\n\n<pre><code>maxHeight(i) = { height(i) + max[ maxHeight(j) ] such that\n                 width(j) &gt; width(i), depth(j) &gt; depth(i), 0 &lt;= j &lt; i }\n</code></pre>\n\n<p>Now, lets get started on the Haskell solution. I will assume your input is a list of the dimensions. Notice how closely the code mirrors the solution I described - the trick is to write things declaratively.</p>\n\n   \n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.List (sortOn)\nimport Data.Vector (fromList, (!), generate)\nimport Data.Ord (Down(..))\n\nbabyBlocks :: [(Int,Int,Int)] -&gt; Int\nbabyBlocks blocks = maxHeights ! (3*n - 1)\n  where\n    -- get the number of blocks\n    n = length blocks\n\n    -- generate the `3n` blocks formed by rotating the existing blocks,\n    -- sort them by their base size, and store them in a vector for\n    -- fast retrieval\n    sortedBlocks = fromList\n                 . sortOn (\\(x,y,z) -&gt; Down (x*y))\n                 . concatMap (\\(x,y,z) -&gt; [(x,y,z),(y,z,x),(z,x,y)])\n                 $ blocks\n\n    -- we'll make ourselves a couple helper functions, just so\n    -- our translation of the recurrence relation looks better\n    height n    = let (_,_,z) = sortedBlocks ! n in z\n    width n     = let (_,y,_) = sortedBlocks ! n in y\n    depth n     = let (x,_,_) = sortedBlocks ! n in x\n    maxHeight n = maxHeights ! n\n\n    -- state the dynamic programming\n    maxHeights = generate (3*n) (\\i -&gt;\n                   height i + maximum (0 : [ maxHeight j | j&lt;-[0..(i-1)]\n                                                         , width j &gt; width i\n                                                         , depth j &gt; depth i ]))\n</code></pre>\n\n<p>The part you seemed to be having trouble with is the dynamic programming in the last part. Because Haskell is lazy, it is actually completely OK for me to use <code>maxHeight</code> while defining <code>maxHeights</code>, even if I don't know what order my vector is going to be initialized in!</p>\n"}, {"comments": [{"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 0, "creation_date": 1480592745, "post_id": 40900884, "comment_id": 69031875, "body": "Please don&#39;t do <code>== []</code>. <a href=\"http://stackoverflow.com/questions/3853922/null-instead-of\">stackoverflow.com/questions/3853922/null-instead-of</a>"}], "tags": [], "owner": {"reputation": 336, "user_id": 5657031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQu61dwt0vc/AAAAAAAAAAI/AAAAAAAAAY0/ki0tUEoS0pU/photo.jpg?sz=128", "display_name": "Michael Szvetits", "link": "https://stackoverflow.com/users/5657031/michael-szvetits"}, "is_accepted": false, "score": 0, "last_activity_date": 1480593969, "last_edit_date": 1480593969, "creation_date": 1480553768, "answer_id": 40900884, "question_id": 40896381, "link": "https://stackoverflow.com/questions/40896381/translating-a-piece-of-java-code-to-haskell/40900884#40900884", "title": "Translating a piece of Java code to Haskell", "body": "<p>This problem can be solved in a very readable way by composing very simple functions to find the overall solution. A possible strategy is as follows:</p>\n\n<ol>\n<li>Take all the available blocks and declare them as an initial set of towers.</li>\n<li>Combine each tower with each available block (if possible). This results in a new set of towers.</li>\n<li>Repeat step 2 until the set of towers does not change anymore.</li>\n<li>Extract the tower of the set which is the highest.</li>\n</ol>\n\n<p>The corresponding code is as follows (explanation below):</p>\n\n<pre><code>type Block = (Int,Int,Int)\ntype Tower = [Block]\n\nbabyBlocks :: [Block] -&gt; Int\nbabyBlocks blocks = highest $ converge allBlocks initialTowers\n    where allBlocks = possibleBlocks blocks\n          initialTowers = map (:[]) allBlocks\n\npossibleBlocks :: [Block] -&gt; [Block]\npossibleBlocks = concatMap (\\(w,d,h) -&gt; [(w,d,h),(w,h,d),(d,h,w)])\n\ncanStack :: Block -&gt; Block -&gt; Bool\ncanStack (w1,d1,_) (w2,d2,_) = w2 &lt; w1 &amp;&amp; d2 &lt; d1 || w2 &lt; d1 &amp;&amp; d2 &lt; w1\n\nexpand :: Tower -&gt; [Block] -&gt; [Tower]\nexpand tower@(top:_) = map (:tower) . filter (canStack top)\n\nconverge :: [Block] -&gt; [Tower] -&gt; [Tower]\nconverge blocks towers | null newTowers = towers\n                       | otherwise = converge blocks newTowers\n    where newTowers = concatMap (flip expand blocks) towers\n\nheight :: Tower -&gt; Int\nheight = sum . map (\\(_,_,h) -&gt; h)\n\nhighest :: [Tower] -&gt; Int\nhighest = maximum . map height\n</code></pre>\n\n<ul>\n<li><code>babyBlocks</code> : This function generates all possible blocks for the given block types (by rotating them), converts them into an initial tower set (by wrapping them into simple list with one element) and starts the convergence of the initial tower set into a final tower set.</li>\n<li><code>possibleBlocks</code> : For a given set of block types, this function returns all possible blocks by rotating them. Strictly, there should be <code>3! = 6</code> rotations (all permutations of the three coordinates), but we only need to consider half of them because we can treat rotations with swapped widths and depths as duplicates.</li>\n<li><code>canStack</code> : Checks if a given block can be placed onto another block.</li>\n<li><code>expand</code> : For a given tower, the function checks all the available blocks if they can be put on the top of the tower. A new tower is created for each compatible block that can be put on top.</li>\n<li><code>converge</code> : This function essentially repeats <code>expand</code> for a set of towers until no more block can be put on one of them. The solution must be the maximum height of the remaining towers.</li>\n<li><code>height</code> : Returns the height of a given tower by summing up its block heights.</li>\n<li><code>highest</code> : For a given set of towers, identifies the maximum height.</li>\n</ul>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7201762"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 839, "favorite_count": 0, "accepted_answer_id": 40897752, "answer_count": 2, "score": 3, "last_activity_date": 1480593969, "creation_date": 1480533245, "question_id": 40896381, "link": "https://stackoverflow.com/questions/40896381/translating-a-piece-of-java-code-to-haskell", "title": "Translating a piece of Java code to Haskell", "body": "<p>I am solving the <a href=\"http://cs.fit.edu/~ryan/fun/projects/blocks/blocks.html\" rel=\"nofollow noreferrer\">Baby Blocks</a> problem. I have a peice of java code that I want to translate to Haskell:</p>\n\n<p>Java:</p>\n\n<pre><code>for (int i = 1; i &lt;optHeight.length ; i++) {\n    int maxHeightIndex = 0;\n        for (int j = i-1; j &gt;=0 ; j--) {\n            // Need help from here\n            if(boxes[j].width&gt;boxes[i-1].width &amp;&amp; boxes[j].depth&gt;boxes[i-1].depth) {\n                if(optHeight[maxHeightIndex]&lt;optHeight[j+1]) { &lt;-- How do I write this condition\n                    maxHeightIndex = j+1;\n                }\n            }\n        }\n        optHeight[i]=optHeight[maxHeightIndex] + boxes[i-1].height;\n}\n</code></pre>\n\n<p>where <code>optHeight</code> is a 1-D array and <code>boxes</code> is an object consiting of <code>height, width, depth</code> as data members. In Haskell, it is just a list of list. Due to lack of mutable arrays / variables, I am totally helpless.</p>\n\n<p>Haskell:</p>\n\n<pre><code>b list = do\n forM_ [1..length list] $ \\i -&gt; do\n  let maxHeight = 0\n  forM_ [0..(i-1)] $ \\j  -&gt; do\n   if list!!j!!1 &gt; list!!i-1!!1 &amp;&amp; list!!j!!2 &gt; list !!j!!2 then\n    maxHeight = j + 1\n</code></pre>\n\n<p>PS: I am totally a beginner in Haskell</p>\n"}, {"tags": ["haskell", "fold", "higher-order-functions"], "comments": [{"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 5, "creation_date": 1480527550, "post_id": 40894758, "comment_id": 69003352, "body": "Define &quot;doesn&#39;t work&quot;. Do you get a compile error or a runtime error, or does it simply fail to terminate? The code you&#39;ve provided works perfectly well on my GHC."}, {"owner": {"reputation": 17, "user_id": 7232241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e2785b9ef72d42663fa108c42af5ba6?s=128&d=identicon&r=PG&f=1", "display_name": "Tina", "link": "https://stackoverflow.com/users/7232241/tina"}, "reply_to_user": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1480527823, "post_id": 40894758, "comment_id": 69003520, "body": "With myFoldl1 I get a compile error &quot;type error - unification would give infinte type&quot;"}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1480527894, "post_id": 40894758, "comment_id": 69003566, "body": "Hm... that&#39;s very odd. Is that the full error message? If so, which compiler are you using?"}, {"owner": {"reputation": 17, "user_id": 7232241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e2785b9ef72d42663fa108c42af5ba6?s=128&d=identicon&r=PG&f=1", "display_name": "Tina", "link": "https://stackoverflow.com/users/7232241/tina"}, "reply_to_user": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1480527982, "post_id": 40894758, "comment_id": 69003625, "body": "I use hugs, I have never had any problems with it, are there any differences to GHC that could cause this error?"}, {"owner": {"reputation": 17, "user_id": 7232241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e2785b9ef72d42663fa108c42af5ba6?s=128&d=identicon&r=PG&f=1", "display_name": "Tina", "link": "https://stackoverflow.com/users/7232241/tina"}, "reply_to_user": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1480528071, "post_id": 40894758, "comment_id": 69003674, "body": "Sorry the full msg is &quot;type error in application&quot; term &quot;x&quot; type &quot;a&quot; doesnt match &quot;[[a]-&gt;[b]]&quot; because &quot;unification woild give infinite type&quot;"}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 2, "creation_date": 1480528158, "post_id": 40894758, "comment_id": 69003729, "body": "Hm... I&#39;m not sure. I&#39;m quite certain that first snippet of code is correct. Is there anything else you&#39;re doing that might be unusual?"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 2, "creation_date": 1480528263, "post_id": 40894758, "comment_id": 69003805, "body": "What&#39;s <code>myFoldl1</code>?  There&#39;s nothing in what you posted with that name. You should include the code your wrote that actually causes the error, instead of the code you think you copied correctly!"}, {"owner": {"reputation": 17, "user_id": 7232241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e2785b9ef72d42663fa108c42af5ba6?s=128&d=identicon&r=PG&f=1", "display_name": "Tina", "link": "https://stackoverflow.com/users/7232241/tina"}, "reply_to_user": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1480528540, "post_id": 40894758, "comment_id": 69003968, "body": "@ Silvio Not sure ... I dont understand how it could be correct anyway, because of the missing end case (match on the singleton lost to terminate the fold). @K.A.Buhr Icopied the code and just changed the name, to not have to hide foldl1"}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 1, "creation_date": 1480528797, "post_id": 40894758, "comment_id": 69004126, "body": "You just edited your post to be incorrect. Change that <code>foldl1</code> back to a <code>foldl</code> and see if it works."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1480528851, "post_id": 40894758, "comment_id": 69004159, "body": "You don&#39;t need a base case if your function is not recursive. &quot;Icopied the code and just changed the name&quot; You should still show us the version of your code that you&#39;re actually trying to compile. You might have accidentally changed more (for example you might have replaced <code>foldl</code> by <code>myFoldl1</code> as well - in fact that seems the most likely explanation, but we won&#39;t have to speculate about that if you post your actual code)."}, {"owner": {"reputation": 17, "user_id": 7232241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e2785b9ef72d42663fa108c42af5ba6?s=128&d=identicon&r=PG&f=1", "display_name": "Tina", "link": "https://stackoverflow.com/users/7232241/tina"}, "edited": false, "score": 0, "creation_date": 1480529234, "post_id": 40894758, "comment_id": 69004373, "body": "I added the code I tried to compile (on a different machine, which is why it was copied wrongly into this question)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1480530581, "post_id": 40894758, "comment_id": 69005094, "body": "The fact that the <code>foldl1</code> implementation doesn&#39;t mirror exactly the <code>foldr1</code> one does make for a mildly confusing example. Perhaps it would even be worth adding a remark about the difference to the Wikibook."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 7232241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e2785b9ef72d42663fa108c42af5ba6?s=128&d=identicon&r=PG&f=1", "display_name": "Tina", "link": "https://stackoverflow.com/users/7232241/tina"}, "edited": false, "score": 0, "creation_date": 1480529707, "post_id": 40895320, "comment_id": 69004625, "body": "Thx for you answer, I already explained in the other comments that I am posting this question on a different machine (a tablet, where I quickly make typos) and have to write evrything again. I tried to edit it but it always shows me oriiginal post?"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 17, "user_id": 7232241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e2785b9ef72d42663fa108c42af5ba6?s=128&d=identicon&r=PG&f=1", "display_name": "Tina", "link": "https://stackoverflow.com/users/7232241/tina"}, "edited": false, "score": 8, "creation_date": 1480530311, "post_id": 40895320, "comment_id": 69004945, "body": "@Tina Please don&#39;t do that. If you retype code (especially in a way that is prone to typos), you&#39;ll just get people wasting their time (and yours) by focussing on mistakes that aren&#39;t actually in your code. In the future just copy and paste the code from the machine that it&#39;s on once you&#39;re back in front of it (it&#39;s not like you&#39;d need the answers before that anyway since they&#39;re not gonna be any use to you on your tablet). Either way I&#39;d wager that at least the second mistake I mentioned actually exists in your real code as well. The corrected code I posted definitely works."}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 6, "last_activity_date": 1480529450, "creation_date": 1480529450, "answer_id": 40895320, "question_id": 40894758, "link": "https://stackoverflow.com/questions/40894758/proper-implementation-of-foldl1/40895320#40895320", "title": "Proper implementation of foldl1", "body": "<pre><code>mFoldl1 f (x:xs)  =  myFoldl1 f x xs\n</code></pre>\n\n<p>You've made two mistakes when renaming the function: First you misspelled the function name in the definition of the above case (<code>mFoldl1</code> instead of <code>myFoldl1</code>) and secondly you replaced the call to <code>foldl</code> in the original with a recursive call to <code>myFoldl1</code>.</p>\n\n<p>The correct version would be:</p>\n\n<pre><code>myFoldl1 f (x:xs) = foldl f x xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9128671, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b1b8f8cae87300f48fdd59162db9248b?s=128&d=identicon&r=PG", "display_name": "Veryrusty", "link": "https://stackoverflow.com/users/9128671/veryrusty"}, "is_accepted": false, "score": 1, "last_activity_date": 1513888401, "creation_date": 1513888401, "answer_id": 47932342, "question_id": 40894758, "link": "https://stackoverflow.com/questions/40894758/proper-implementation-of-foldl1/47932342#47932342", "title": "Proper implementation of foldl1", "body": "<p>I too stumbled across the error in the wikibook, and found this entry.</p>\n\n<p>The answers above seem to be wrong: they are not even of the right type.</p>\n\n<pre><code>foldl1 f [x]       = x\nfold11 f [x,y]     = f x y\nfoldl1 f x:y:zs    = f (f x y) (foldl1 f zs)\nfoldl1 _ []        = error \"foldl1 undefined on []\"\n</code></pre>\n\n<p>does the job, I think. I hope there is something more elegant.</p>\n"}, {"comments": [{"owner": {"reputation": 750, "user_id": 6876037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42acf7e5bb30e124f2597567bfd9aab1?s=128&d=identicon&r=PG&f=1", "display_name": "anonymoose", "link": "https://stackoverflow.com/users/6876037/anonymoose"}, "edited": false, "score": 0, "creation_date": 1513892656, "post_id": 47932909, "comment_id": 82835368, "body": "Are you sure you don&#39;t want to edit your original answer instead of posting a new one?"}], "tags": [], "owner": {"reputation": 11, "user_id": 9128671, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b1b8f8cae87300f48fdd59162db9248b?s=128&d=identicon&r=PG", "display_name": "Veryrusty", "link": "https://stackoverflow.com/users/9128671/veryrusty"}, "is_accepted": false, "score": 0, "last_activity_date": 1513891492, "creation_date": 1513891492, "answer_id": 47932909, "question_id": 40894758, "link": "https://stackoverflow.com/questions/40894758/proper-implementation-of-foldl1/47932909#47932909", "title": "Proper implementation of foldl1", "body": "<p>Correction! Above works, but the original using a call to foldl is far better.\nThe confusion arises with fonts that don't clearly distinguish \"l\" and \"1\"! To be clear</p>\n\n<pre><code>fold1 f (x:xs) = foldl f x xs\n</code></pre>\n\n<p>is the obvious and simple original.</p>\n"}], "owner": {"reputation": 17, "user_id": 7232241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e2785b9ef72d42663fa108c42af5ba6?s=128&d=identicon&r=PG&f=1", "display_name": "Tina", "link": "https://stackoverflow.com/users/7232241/tina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1174, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1513891492, "creation_date": 1480527415, "last_edit_date": 1480530651, "question_id": 40894758, "link": "https://stackoverflow.com/questions/40894758/proper-implementation-of-foldl1", "title": "Proper implementation of foldl1", "body": "<p>The <a href=\"https://en.wikibooks.org/wiki/Haskell/Lists_III\" rel=\"nofollow noreferrer\">Haskell Wikibook</a> provides one </p>\n\n<pre><code>foldl1           :: (a -&gt; a -&gt; a) -&gt; [a] -&gt; a\nfoldl1 f (x:xs)  =  foldl f x xs\nfoldl1 _ []      =  error \"Prelude.foldl1: empty list\"\n</code></pre>\n\n<p>that doesnt work. I tried to compile this version of it: </p>\n\n<pre><code>myFoldl1           :: (a -&gt; a -&gt; a) -&gt; [a] -&gt; a\nmFoldl1 f (x:xs)  =  myFoldl1 f x xs\nmyFoldl1 _ []      =  error \"Prelude.foldl1: empty list\n</code></pre>\n\n<p>I first thought it was missing a case to end the fold and that there was a problem with the typing</p>\n\n<pre><code>foldl1 _ [x] = x\nfoldl1 f (x:xs)  =  foldl (f x) xs\n</code></pre>\n\n<p>But this wont work either. I think the type issue goes deeper, but I dont have a good enough grasp of Haskell to think further. Can someone help me out? </p>\n"}, {"tags": ["haskell", "functional-programming", "monads", "side-effects"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 6, "creation_date": 1480526968, "post_id": 40894498, "comment_id": 69002999, "body": "I think the simplest answer is that if allocation was a side-effect, very few things would be \u201cpure\u201d, which sort of reduces the concept\u2019s usefulness. Purity does not have one universal rigorous definition. I could imagine a language that <i>did</i> treat allocation as a side-effect and managed it through the type system, which could be highly useful on systems with small amounts of memory (i.e. embedded systems), but I don\u2019t know of any such language currently."}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 4, "creation_date": 1480527024, "post_id": 40894498, "comment_id": 69003035, "body": "Memory allocation is a side effect if you want to control when it happens. See IORef/STRef/FunPtr wrappers. It&#39;s just that if it&#39;s happening automatically then you can trust your compiler to be smart about it, so Haskell doesn&#39;t force you to worry about it."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1480527886, "post_id": 40894498, "comment_id": 69003561, "body": "@AlexisKing As someone who occasionally has to write code for embedded systems, that would be a really interesting language to see implemented.  I imagine it could be written as a DSL in Haskell, but it would be cool as a standalone language that compiled very efficiently."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1480528020, "post_id": 40894498, "comment_id": 69003649, "body": "What you cannot detect does not exist. You call a function, how do you detect if it allocated any memory?"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1480530289, "post_id": 40894498, "comment_id": 69004937, "body": "You&#39;ll want to take a look at <a href=\"http://stackoverflow.com/a/37265799/1048572\">this discussion</a> - the answer is &quot;<i>because we don&#39;t care</i>&quot;. Yes, it would not be useful to consider the same values in two distinct memory locations to be different from each other."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1480533418, "post_id": 40894498, "comment_id": 69006651, "body": "Related: <a href=\"http://stackoverflow.com/questions/36969344/are-side-effects-everything-that-cannot-be-found-in-a-pure-function\">Are side effects everything that cannot be found in a pure function?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1480555783, "post_id": 40894958, "comment_id": 69016031, "body": "&quot;It so happens that certain implementations of Haskell on contemporary hardware and OS will allocate stack / heap in the course of running your code&quot; - and how!"}], "tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 8, "last_activity_date": 1480528952, "last_edit_date": 1480528952, "creation_date": 1480528080, "answer_id": 40894958, "question_id": 40894498, "link": "https://stackoverflow.com/questions/40894498/what-counts-as-a-side-effect-why-isnt-memory-allocation-a-side-effect/40894958#40894958", "title": "What counts as a side-effect? Why isn&#39;t memory allocation a side-effect?", "body": "<p>Neither stack allocation nor heap allocation is something you can \"do\" or observe in Haskell. Therefore, it can't be counted as side effect. In a sense, the same goes for heating up the CPU, which is without doubt a recognizable physical effect of running pure Haskel code. </p>\n\n<p>It so happens that certain implementations of Haskell on contemporary hardware and OS will allocate stack / heap in the course of running your code, but it is not observable from your code.</p>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 1787365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a50ea393052643d652ef4b8de36eff9?s=128&d=identicon&r=PG&f=1", "display_name": "relevate", "link": "https://stackoverflow.com/users/1787365/relevate"}, "edited": false, "score": 1, "creation_date": 1480530770, "post_id": 40895117, "comment_id": 69005198, "body": "All good answers, I think I confused the spec for Haskell with its implementation. Thanks. Now I wonder if there are any low level assembly/C like languages that do specify side effect semantics for things like allocation."}, {"owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 2, "creation_date": 1480531229, "post_id": 40895117, "comment_id": 69005450, "body": "CPU instruction evaluation has a hardware implementation as well, so NOP could (equally unhelpfully) be said to mutate the instruction pointer register."}, {"owner": {"reputation": 44043, "user_id": 1565698, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7dace33805b9dcdec5aa63308daf88dc?s=128&d=identicon&r=PG", "display_name": "Sylwester", "link": "https://stackoverflow.com/users/1565698/sylwester"}, "reply_to_user": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1480531307, "post_id": 40895117, "comment_id": 69005492, "body": "@thatotherguy True, but every instruction besides NOP also mutates something else than the program counter."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1480531889, "post_id": 40895117, "comment_id": 69005821, "body": "You might want to look at Rust, which has a statically checked model of &quot;ownership&quot; for allocated memory."}], "tags": [], "owner": {"reputation": 44043, "user_id": 1565698, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7dace33805b9dcdec5aa63308daf88dc?s=128&d=identicon&r=PG", "display_name": "Sylwester", "link": "https://stackoverflow.com/users/1565698/sylwester"}, "is_accepted": true, "score": 11, "last_activity_date": 1480528686, "creation_date": 1480528686, "answer_id": 40895117, "question_id": 40894498, "link": "https://stackoverflow.com/questions/40894498/what-counts-as-a-side-effect-why-isnt-memory-allocation-a-side-effect/40895117#40895117", "title": "What counts as a side-effect? Why isn&#39;t memory allocation a side-effect?", "body": "<p>When reasoning about these things it has to be on a theoretic level and on language specification level and never on how it's actually done on hardware. </p>\n\n<p>A programming language isn't really an actual implementation so unless you think about C og C++ that has memory allocation and syscall as a part of the language, the higher level languages where this is handled by the systems primitives it's not part of the language. If it isn't part of the language it cannot be a side effect. </p>\n\n<p>Now an actual implementations machine code would never be pure since the way to pass arguments and to receive return values are to store in either registers or stack, both by mutation. Most of the concepts we use in all modern programming is translated down to arithmetic, flags, jumps, and memory access. Every CPU instruction except NOP mutates the machine. A program consisting of only NOP is not very useful.</p>\n"}], "owner": {"reputation": 83, "user_id": 1787365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a50ea393052643d652ef4b8de36eff9?s=128&d=identicon&r=PG&f=1", "display_name": "relevate", "link": "https://stackoverflow.com/users/1787365/relevate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 483, "favorite_count": 0, "accepted_answer_id": 40895117, "answer_count": 2, "score": 7, "last_activity_date": 1480528952, "creation_date": 1480526656, "question_id": 40894498, "link": "https://stackoverflow.com/questions/40894498/what-counts-as-a-side-effect-why-isnt-memory-allocation-a-side-effect", "title": "What counts as a side-effect? Why isn&#39;t memory allocation a side-effect?", "body": "<p>I understand the appeal of pure functional languages like Haskell where you can keep track of side effects like disk I/O using monads.</p>\n\n<p>Why aren't all system calls considered side effects? For example, heap memory allocation (which is automatic) in Haskell isn't tracked. And stack allocation could be a side effect, although I'm not sure it would be useful. Both of these change the overall state of the system.</p>\n\n<p>So where is the line drawn for what is a side effect and what isn't? Is it simply at what's the most \"useful\"? Or is there a more theoretical foundation?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1480526920, "post_id": 40894475, "comment_id": 69002965, "body": "Clarification: what result do you expect from <code>mapper2 (\\x -&gt; x*2) [2,4] [4,6]</code>?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1480527245, "post_id": 40894475, "comment_id": 69003174, "body": "FYI, your function is called <a href=\"http://zvon.org/other/haskell/Outputprelude/zipWith_f.html\" rel=\"nofollow noreferrer\">zipWith</a>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1480527726, "post_id": 40894475, "comment_id": 69003449, "body": "@Gloriane If you want to multiply matching elements (and thus get <code>[8, 24]</code>), you need <code>mapper2 (*) [2,4] [4,6]</code>."}, {"owner": {"reputation": 187, "user_id": 7232140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e40c09ef6af9a5e54bcf4cef1c629237?s=128&d=identicon&r=PG&f=1", "display_name": "Gloriane", "link": "https://stackoverflow.com/users/7232140/gloriane"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1480528065, "post_id": 40894475, "comment_id": 69003669, "body": "@duplode Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 7232140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e40c09ef6af9a5e54bcf4cef1c629237?s=128&d=identicon&r=PG&f=1", "display_name": "Gloriane", "link": "https://stackoverflow.com/users/7232140/gloriane"}, "edited": false, "score": 0, "creation_date": 1480527736, "post_id": 40894683, "comment_id": 69003456, "body": "I tried a function with two arguments:  mapper2 (\\x y -&gt; x * y) [2,4] [4,6]   and it worked like a charm. Thanks!"}, {"owner": {"reputation": 5825, "user_id": 631051, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/88a9701bb32b465a3b8357a2aa092815?s=128&d=identicon&r=PG", "display_name": "Ellen Spertus", "link": "https://stackoverflow.com/users/631051/ellen-spertus"}, "edited": false, "score": 0, "creation_date": 1480529359, "post_id": 40894683, "comment_id": 69004439, "body": "I didn&#39;t see the mistake until I saw Silvio&#39;s post. D&#39;oh!"}], "tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": true, "score": 13, "last_activity_date": 1480527207, "creation_date": 1480527207, "answer_id": 40894683, "question_id": 40894475, "link": "https://stackoverflow.com/questions/40894475/non-type-variable-argument-in-the-constraint-error-on-haskell-map-function/40894683#40894683", "title": "Non type-variable argument in the constraint error on Haskell map function", "body": "<p>Look at <code>mapper2</code>'s type.</p>\n\n<pre><code>mapper2 :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]\n</code></pre>\n\n<p>Now look at the type of the function you're passing in.</p>\n\n<pre><code>(\\x -&gt; x * 2) :: Num a =&gt; a -&gt; a\n</code></pre>\n\n<p>The <code>mapper2</code> function expects a function of two arguments to be passed in, but your lambda only takes one argument.</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 22, "last_activity_date": 1480529504, "last_edit_date": 1495539957, "creation_date": 1480529504, "answer_id": 40895334, "question_id": 40894475, "link": "https://stackoverflow.com/questions/40894475/non-type-variable-argument-in-the-constraint-error-on-haskell-map-function/40895334#40895334", "title": "Non type-variable argument in the constraint error on Haskell map function", "body": "<p>Silvio Mayolo has covered the main, practical part of the question, so I will stick to the technical details related to...</p>\n\n<blockquote>\n  <p>what the error means?</p>\n</blockquote>\n\n<p>To begin with, the error is a bit hairy, but one thing that you can focus on at first is the <code>Num (b -&gt; c)</code> bit. It indicates that you are somehow trying to use a function type (<code>b -&gt; c</code>) as a number (i.e. an instance of <code>Num</code>), which is something that is almost never done intentionally (as we usually do not use functions as numbers). More often than not, when such things happen it is a sign that there is a mismatch in the number of arguments somewhere (which is the case here, as explained by Silvio Mayolo's answer). That said, what follows is an explanation of how the error comes about. </p>\n\n<p>The first argument of <code>mapper2</code> has type <code>a -&gt; b -&gt; c</code> or, <a href=\"https://stackoverflow.com/questions/30440377/usefulness-of-function-arrows-associate-to-the-right\">equivalently</a>, <code>a -&gt; (b -&gt; c)</code>. When you pass...</p>\n\n<pre><code>(\\x -&gt; x * 2) :: Num z =&gt; z -&gt; z\n</code></pre>\n\n<p>... to it, <code>a -&gt; (b -&gt; c)</code> and <code>Num z =&gt; z -&gt; z</code> are matched (or, using the jargon, <em>unified</em>), so that the first <code>z</code> becomes <code>a</code> and the second <code>z</code> becomes <code>b -&gt; c</code>. Since both <code>z</code> are supposed to be the same thing, <code>a</code> becomes <code>b -&gt; c</code> as well, and so the type of <code>(\\x -&gt; x * 2)</code> is specialised to:</p>\n\n<pre><code>(\\x -&gt; x * 2) :: Num (b -&gt; c) =&gt; (b -&gt; c) -&gt; (b -&gt; c)\n</code></pre>\n\n<p>The error message <code>Non type-variable argument in the constraint: Num (b -&gt; c)\n</code> refers to how, unlike in e.g. <code>Num x</code>, there is something within the constraint that is not a type variable. In this case, it is function type constructor, <code>-&gt;</code>. While turning on the <code>FlexibleContexts</code> extension, as the error message suggests, would allow that, there is no reason to do so here, as it still wouldn't be what you want (you have no intention of using functions as numbers). Furthermore, doing so in this case would just lead to another type error.</p>\n"}], "owner": {"reputation": 187, "user_id": 7232140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e40c09ef6af9a5e54bcf4cef1c629237?s=128&d=identicon&r=PG&f=1", "display_name": "Gloriane", "link": "https://stackoverflow.com/users/7232140/gloriane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19224, "favorite_count": 3, "accepted_answer_id": 40894683, "answer_count": 2, "score": 12, "last_activity_date": 1480529504, "creation_date": 1480526568, "last_edit_date": 1480527393, "question_id": 40894475, "link": "https://stackoverflow.com/questions/40894475/non-type-variable-argument-in-the-constraint-error-on-haskell-map-function", "title": "Non type-variable argument in the constraint error on Haskell map function", "body": "<p>I am writing a function called <code>mapper2</code> that applies a function to two lists:</p>\n\n<pre><code>mapper2 :: (a-&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]\nmapper2 f (x:xs) (y:ys) = (f x y) : (mapper2 f xs ys)\nmapper2 _ _ _ = []\n</code></pre>\n\n<p>I am able to compile the function but get an error when I apply it:</p>\n\n<pre><code>*Main&gt; mapper2 (\\x -&gt; x*2) [2,4] [4,6] \n\n&lt;interactive&gt;:4:1: error:\n    \u2022 Non type-variable argument in the constraint: Num (b -&gt; c)\n      (Use FlexibleContexts to permit this)\n    \u2022 When checking the inferred type\n        it :: forall b c. (Num (b -&gt; c), Num b) =&gt; [c]\n</code></pre>\n\n<p>Can someone explain to me how to fix this and what the error means? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 3, "creation_date": 1480524827, "post_id": 40893480, "comment_id": 69001701, "body": "The code you provided does not match the code shown by the error message."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1480524913, "post_id": 40893480, "comment_id": 69001759, "body": "When I run your first code, it doesn&#39;t compile either. @somesoaccount: Laziness shouldn&#39;t prevent compilation errors."}, {"owner": {"reputation": 15633, "user_id": 2091169, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MT8tZ.jpg?s=128&g=1", "display_name": "Jivan", "link": "https://stackoverflow.com/users/2091169/jivan"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1480527317, "post_id": 40893480, "comment_id": 69003212, "body": "@ReinHenrichs thanks - please check the edit"}, {"owner": {"reputation": 15633, "user_id": 2091169, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MT8tZ.jpg?s=128&g=1", "display_name": "Jivan", "link": "https://stackoverflow.com/users/2091169/jivan"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1480527550, "post_id": 40893480, "comment_id": 69003353, "body": "@sepp2k I actually made a mistake in the first code - now corrected"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1480531834, "post_id": 40893480, "comment_id": 69005791, "body": "It still doesn&#39;t match. There is no <code>($)</code> in your example."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480533681, "post_id": 40893480, "comment_id": 69006825, "body": "@Jivan Your error message suggests you have no <code>where</code> and the contents line actually reads <code>contents &lt;- B.readFile $ head getArgs</code>. It is generally tough to debug when the error message doesn&#39;t match the code."}, {"owner": {"reputation": 15633, "user_id": 2091169, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MT8tZ.jpg?s=128&g=1", "display_name": "Jivan", "link": "https://stackoverflow.com/users/2091169/jivan"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480535556, "post_id": 40893480, "comment_id": 69007718, "body": "@Alec you&#39;re right - fixed"}], "answers": [{"comments": [{"owner": {"reputation": 15633, "user_id": 2091169, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MT8tZ.jpg?s=128&g=1", "display_name": "Jivan", "link": "https://stackoverflow.com/users/2091169/jivan"}, "edited": false, "score": 1, "creation_date": 1480535709, "post_id": 40896459, "comment_id": 69007816, "body": "It works. Honestly I can&#39;t say that I really understand exactly <b>why</b>, but I&#39;m looking forward to studying it - thanks"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 15633, "user_id": 2091169, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MT8tZ.jpg?s=128&g=1", "display_name": "Jivan", "link": "https://stackoverflow.com/users/2091169/jivan"}, "edited": false, "score": 0, "creation_date": 1480539481, "post_id": 40896459, "comment_id": 69009848, "body": "I recommend you look at some monad tutorials - it will probably be confusing at first, but at least it won&#39;t be voodoo magic. :)"}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 4, "last_activity_date": 1480533535, "creation_date": 1480533535, "answer_id": 40896459, "question_id": 40893480, "link": "https://stackoverflow.com/questions/40893480/filename-argument-in-haskell/40896459#40896459", "title": "Filename argument in Haskell", "body": "<p>Remember that <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/System-Environment.html#v:getArgs\" rel=\"nofollow noreferrer\"><code>getArgs :: IO [String]</code></a> is also monadic, so you need to extract it first in the <code>do</code> block before trying to get the head of it:</p>\n\n<pre><code>main :: IO ()\nmain = do\n    args &lt;- getArgs                      -- now `args :: [String]`\n    contents &lt;- B.readFile (head args)\n    print (parseCSV contents)\n</code></pre>\n"}], "owner": {"reputation": 15633, "user_id": 2091169, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MT8tZ.jpg?s=128&g=1", "display_name": "Jivan", "link": "https://stackoverflow.com/users/2091169/jivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 0, "accepted_answer_id": 40896459, "answer_count": 1, "score": 1, "last_activity_date": 1480535519, "creation_date": 1480523575, "last_edit_date": 1480535519, "question_id": 40893480, "link": "https://stackoverflow.com/questions/40893480/filename-argument-in-haskell", "title": "Filename argument in Haskell", "body": "<p>How comes that this is working:</p>\n\n<pre><code>module Main where\n\nimport System.Environment (getArgs)\nimport qualified Data.ByteString.Char8 as B\nimport Data.ByteString.Char8 (ByteString)\n\ntype Field = ByteString\ntype Row = [Field]\ntype CSV = [Row]\n\nmain :: IO ()\nmain = do\n    contents &lt;- B.readFile \"test.csv\"\n    print (parseCSV contents)\n\n-- used with \"./myprogram\" to read \"test.csv\"\n</code></pre>\n\n<p>But not if I replace <code>\"test.csv\"</code> with a command-line argument in <code>main</code>:</p>\n\n<pre><code>-- ... same as before ...\n\nmain :: IO ()\nmain = do\n    contents &lt;- B.readFile $ head getArgs\n    print (parseCSV contents)\n\n-- used with \"./myprogram test.csv\" to read \"test.csv\"\n</code></pre>\n\n<p>With the latter I get this error at compile time:</p>\n\n<pre><code>csv.hs:20:35: error:\n    \u2022 Couldn't match expected type \u2018[FilePath]\u2019\n                  with actual type \u2018IO [String]\u2019\n    \u2022 In the first argument of \u2018head\u2019, namely \u2018getArgs\u2019\n      In the second argument of \u2018($)\u2019, namely \u2018head getArgs\u2019\n      In a stmt of a 'do' block: contents &lt;- B.readFile $ head getArgs\n</code></pre>\n\n<p>EDIT --\nI initially omitted a part of the code, which I thought was not necessary to understand the question. It's corrected now.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "edited": false, "score": 0, "creation_date": 1480530203, "post_id": 40880310, "comment_id": 69004887, "body": "As a general tip, almost unreadable list comprehension should be avoided. Always try and use a prelude algorithm with a lambda in this sort of scenario!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1480543604, "post_id": 40880310, "comment_id": 69011976, "body": "Probably both instances of <code>s!!2</code> should be <code>s!!0+s!!1</code>. With that change (and the obvious base case) your code seems to do what you ask for."}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1480504000, "post_id": 40880417, "comment_id": 68987375, "body": "<code>negate</code> is fine, there&#39;s also <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Ord.html#t:Down\" rel=\"nofollow noreferrer\"><code>Down</code></a> which reverses an ordering and is what I would have chosen here I think."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 6, "last_activity_date": 1480480704, "creation_date": 1480480704, "answer_id": 40880417, "question_id": 40880310, "link": "https://stackoverflow.com/questions/40880310/haskell-sort-by-height-in-descending-order/40880417#40880417", "title": "Haskell: Sort by height in descending order", "body": "<p>Why not use <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html#v:sortOn\" rel=\"noreferrer\"><code>sortOn</code></a> which is made exactly for this sort (no pun intended) of thing? Then, you can do this in one line:</p>\n\n<pre><code>ghci&gt; import Data.List (sortOn)\nghci&gt; sortOn (\\[x,y,z] -&gt; negate (x+y)) [[5,8,9],[4,7,9],[9,4,7],[8,5,9],[9,5,8],[7,4,9]]\n[[9,5,8],[5,8,9],[9,4,7],[8,5,9],[4,7,9],[7,4,9]]\n</code></pre>\n\n<p>That aside, if your inner lists always have length 3, they should probably be tuples instead, in which case, you would have</p>\n\n<pre><code>ghci&gt; sortOn (\\(x,y,z) -&gt; negate (x+y)) [(5,8,9),(4,7,9),(9,4,7),(8,5,9),(9,5,8),(7,4,9)]\n[(9,5,8),(5,8,9),(9,4,7),(8,5,9),(4,7,9),(7,4,9)]\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7201762"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1528, "favorite_count": 0, "accepted_answer_id": 40880417, "answer_count": 1, "score": 1, "last_activity_date": 1480480704, "creation_date": 1480480104, "question_id": 40880310, "link": "https://stackoverflow.com/questions/40880310/haskell-sort-by-height-in-descending-order", "title": "Haskell: Sort by height in descending order", "body": "<p>I have a list of list as:</p>\n\n<p><code>[[4,7,9],[7,4,9],[9,4,7],[5,8,9],[8,5,9],[9,5,8]]</code></p>\n\n<p>I want to reverse sort them based on base area (3rd side)</p>\n\n<p>eg. <code>sort [[4,7,9],[5,8,9]]</code> should yield <code>[[5,8,9],[4,7,9]]</code>\nsince 4+7=11 &lt; 5+8=13</p>\n\n<p>I have implemented the following function:</p>\n\n<p><code>quicksort (s:xs) = quicksort[x | x &lt;- xs, x!!0+x!!1 &lt; s!!2] ++ [s] ++ quicksort[x | x &lt;- xs, x!!0+x!!1 &gt;= s!!2]</code></p>\n\n<p>But it doesn't give the correct output.</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["haskell", "pattern-matching", "ghc"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 5, "creation_date": 1480478639, "post_id": 40879983, "comment_id": 68974795, "body": "That&#39;s either a bizarre ghc bug or something really weird in your code. Please include enough code to repro. And what version of ghc are you using?"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 2, "creation_date": 1480481414, "post_id": 40879983, "comment_id": 68975560, "body": "Can you post the patterns for <code>mov1</code>, which seems to be the binding causing the error?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 3, "creation_date": 1480481461, "post_id": 40879983, "comment_id": 68975579, "body": "This seems clearly related to the pattern exhaustivity checker. Since that part of the compiler has been getting a lot of hacking lately, it&#39;s pretty critical to know the GHC version as @jberryman suggested"}], "answers": [{"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480497119, "post_id": 40884193, "comment_id": 68982604, "body": "Nice (or maybe not so nice) find. Have you made / is there already a ticket open for this?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480497521, "post_id": 40884193, "comment_id": 68982819, "body": "@Alec I didn&#39;t check. Feel free to check / add it if missing."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 3, "creation_date": 1480526336, "post_id": 40884193, "comment_id": 69002611, "body": "@Alec It looks like <a href=\"https://ghc.haskell.org/trac/ghc/ticket/11822\" rel=\"nofollow noreferrer\">this</a> is the most relevant ticket."}, {"owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "edited": false, "score": 0, "creation_date": 1480872690, "post_id": 40884193, "comment_id": 69132126, "body": "Sorry for not responding earlier. That&#39;s a good example, similar to (and simpler than) what my code did."}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1505917046, "post_id": 40884193, "comment_id": 79609716, "body": "I was trying the example out, and even if you add a line <code>f _ _ _ _ _ _ _ _ _ = ()</code> the same warning is given. I would expect that the patter match check does not kick in in this case. Is that a ghc bug?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1505934012, "post_id": 40884193, "comment_id": 79620546, "body": "@DamianNadales Hard to tell. I&#39;d tend to call it a bug, but I have no idea if the problem is solvable with an efficient algorithm in the first place."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 10, "last_activity_date": 1480497208, "last_edit_date": 1480497208, "creation_date": 1480496914, "answer_id": 40884193, "question_id": 40879983, "link": "https://stackoverflow.com/questions/40879983/what-sort-of-iterations-does-ghc-do-while-compiling-patterns/40884193#40884193", "title": "What sort of iterations does GHC do while compiling patterns?", "body": "<p>Here's a MCVE:</p>\n\n<pre><code>{-# OPTIONS -Wall #-}\ndata T = O | A | B | C | D | E\n\nf :: T -&gt; T -&gt; T -&gt; T -&gt; T -&gt; T -&gt; T -&gt; T -&gt; T -&gt; ()\nf O _ _ _ _ _ _ _ _ = ()\nf _ O _ _ _ _ _ _ _ = ()\nf _ _ O _ _ _ _ _ _ = ()\nf _ _ _ O _ _ _ _ _ = ()\nf _ _ _ _ O _ _ _ _ = ()\nf _ _ _ _ _ O _ _ _ = ()\nf _ _ _ _ _ _ O _ _ = ()\nf _ _ _ _ _ _ _ O _ = ()\nf _ _ _ _ _ _ _ _ O = ()\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>ExhaustivePattern3.hs:5:5: warning:\n    Pattern match checker exceeded (2000000) iterations in\n    an equation for \u2018f\u2019. (Use -fmax-pmcheck-iterations=n\n    to set the maximun number of iterations to n)\n</code></pre>\n\n<p>I guess the checker is trying to generate the counterexamples too eagerly: there are many unmatched patterns, exponentially growing with the number of arguments.</p>\n\n<p>Indeed, after the first match the unmatched cases are</p>\n\n<pre><code>A _ _ _ _ _ _ _ _\nB _ _ _ _ _ _ _ _\n...\nE _ _ _ _ _ _ _ _\n</code></pre>\n\n<p>Then after the second one, this expands to:</p>\n\n<pre><code>A A _ _ _ _ _ _ _\nA ...\nA E _ _ _ _ _ _ _\nB A _ _ _ _ _ _ _\nB ...\nB E _ _ _ _ _ _ _\n...\nE A _ _ _ _ _ _ _\nE ...\nE E _ _ _ _ _ _ _\n</code></pre>\n\n<p>And so on. This grows exponentially.</p>\n"}], "owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 2, "accepted_answer_id": 40884193, "answer_count": 1, "score": 8, "last_activity_date": 1480497208, "creation_date": 1480477930, "last_edit_date": 1480483587, "question_id": 40879983, "link": "https://stackoverflow.com/questions/40879983/what-sort-of-iterations-does-ghc-do-while-compiling-patterns", "title": "What sort of iterations does GHC do while compiling patterns?", "body": "<p>I just wrote a function for making a move in Tic-Tac-Toe. I wanted to push pattern matching. So I wrote 9 <code>makeAMove</code> clauses. Each has a Tic-Tac-Toe board with a different space designated by an Empty symbol. It looks something like this.</p>\n\n<pre><code>makeAMove [[E,   m12, m13],\n           [m21, m22, m23],\n           [m31, m32, m33]] X 1 1 = ...\n</code></pre>\n\n<p>This clause would put an X in the upper left corner of the board. X, O, and E are defined as Marks.</p>\n\n<pre><code>data Mark = X |  O | E deriving (Eq, Show)\n</code></pre>\n\n<p>When I load the file I get this warning message.</p>\n\n<pre><code>warning:\n    Pattern match checker exceeded (2000000) iterations in\n    an equation for \u2018mov1\u2019. (Use -fmax-pmcheck-iterations=n\n    to set the maximun number of iterations to n)\n</code></pre>\n\n<p>My question is one of curiosity. What sort of iterations is the pattern matcher doing? And why are so many required?</p>\n\n<p>When I limit the number of clauses to, say, 5 and put the rest in another function that is linked to by a default case, there is no problem.</p>\n"}, {"tags": ["list", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1480503278, "post_id": 40879832, "comment_id": 68986901, "body": "For this game, I would probably represent the board by an indexed structure rather than a list of lists. Maybe even <code>Data.Map (Int,Int) Piece</code>. Then the complexity of finding rows columns and diagonals is mainly just generating the appropriate <code>[(Int,Int)]</code> lists, which ought to be a few simple list comprehensions."}, {"owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "edited": false, "score": 0, "creation_date": 1480504646, "post_id": 40879832, "comment_id": 68987805, "body": "I would suggest to define <code>data Piece = Yellow | Red | None</code> instead of returning <code>Maybe Piece</code>"}], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 1, "last_activity_date": 1480485848, "creation_date": 1480485848, "answer_id": 40881406, "question_id": 40879832, "link": "https://stackoverflow.com/questions/40879832/haskell-how-to-return-a-list-of-a-list-of-all-of-the-rows-of-elements-in-a-gri/40881406#40881406", "title": "Haskell - how to return a list of a list of all of the rows of elements in a grid", "body": "<p>Since you are saying you're learning Haskell, I'm going to just give you some hints:</p>\n\n<ol>\n<li><p>If you have <code>[[1, 2, 3], [4, 5, 6], [7, 8, 9]]</code> as the list of columns, then the list of rows <code>[[1, 4, 7], [2, 5, 8], [3, 6, 9]]</code> is exactly the <code>transpose</code> of the columns.</p></li>\n<li><p>The main diagonal (going down-right) of columns <code>(x:_):cs</code> is <code>x</code> followed by the main diagonal of the columns <code>cs</code>, without their first row.</p></li>\n<li><p>All the (down-right going) diagonals of the columns <code>c:cs</code> is the diagonal of <code>c:cs</code> followed by all the diagonals of the columns <code>cs</code></p></li>\n<li><p>To get the diagonals going down-left, it's enough to <code>reverse</code> the order of columns and then get the down-right going diagonals of that.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "is_accepted": false, "score": 0, "last_activity_date": 1480505710, "creation_date": 1480505710, "answer_id": 40887341, "question_id": 40879832, "link": "https://stackoverflow.com/questions/40879832/haskell-how-to-return-a-list-of-a-list-of-all-of-the-rows-of-elements-in-a-gri/40887341#40887341", "title": "Haskell - how to return a list of a list of all of the rows of elements in a grid", "body": "<p>If you define the Piece as an open slot</p>\n\n<pre><code>data Piece = Yellow | Red | Empty deriving Show\nlet Board = replicate n $ replicate m Empty\n</code></pre>\n\n<p>You can test whether there are 4 in a row by pattern matching on</p>\n\n<pre><code>pre:Yellow:Yellow:Yellow:Yellow:post\n</code></pre>\n\n<p>To test if Yellow has 4 in a row</p>\n\n<p>Similar pattern matching could be done on the transpose of the list of lists.</p>\n"}], "owner": {"reputation": 37, "user_id": 4518168, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/0e8a44ce2dbb47a003534a1f0af604aa?s=128&d=identicon&r=PG&f=1", "display_name": "AndieM", "link": "https://stackoverflow.com/users/4518168/andiem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 832, "favorite_count": 0, "accepted_answer_id": 40881406, "answer_count": 2, "score": 2, "last_activity_date": 1480505710, "creation_date": 1480477047, "last_edit_date": 1480486059, "question_id": 40879832, "link": "https://stackoverflow.com/questions/40879832/haskell-how-to-return-a-list-of-a-list-of-all-of-the-rows-of-elements-in-a-gri", "title": "Haskell - how to return a list of a list of all of the rows of elements in a grid", "body": "<p>I am working on a generic version of the game connect 4 in which you can select the size of the grid as well as the number of pieces needed to connect in order to win.  I am working on a function now that will check which player won.  I am trying to break it down into four smaller parts.  I have already implemented a function to return the columns, but am stuck on rows as well as diagonals both ways across the grid.  I am new to Haskell and am struggling to stop thinking about these problems in an OO way.  Any help would be greatly appreciated as I have been stuck on this problem for quite a while now.  </p>\n\n<pre><code>import Data.Maybe\nimport Data.List\n\ndata Piece = Yellow | Red    \n\ntype Column = [Piece]   \ntype Board = [Column]\n\ndata BoardState = BS {\n  theBoard :: Board,\n  lastMove :: Piece,\n  numColumns :: Int,\n  numRows :: Int,\n  numToConnect :: Int }\n\nrepeatNothing :: Int -&gt; [Maybe a]\nrepeatNothing m = replicate m Nothing\n\npadN :: [a] -&gt; Int -&gt; [Maybe a]\npadN xs n = (map Just xs) ++ repeatNothing (n - (length xs))\n\ncolumns :: BoardState -&gt; [[Maybe Piece]]\ncolumns bs = map (\\col -&gt; padN col (numRows bs)) (theBoard bs)\n\nrows :: BoardState -&gt; [[Maybe Piece]]\nrows bs = map (\\row -&gt; padN row (numColumns bs)) (theBoard bs)\n\ndiagonalsForward :: BoardState -&gt; [[Maybe Piece]]\ndiagonalsForward = undefined\n\ndiagonalsBackward :: BoardState -&gt; [[Maybe Piece]]\ndiagonalsBackward = undefined\n</code></pre>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1480464592, "post_id": 40878039, "comment_id": 68971127, "body": "This is not pseudocode - it is just a grammar. Also, I&#39;m not sure what you mean by <code>MakeExpr: F -&gt; Expr -&gt; Expr -&gt; (Expr,Expr); MakeExpr f x y = (f,x,y)</code> - <code>MakeExpr</code> is already defined in <code>data Expr = N|V|MakeExpr F Expr Expr</code>. Also, you may want to record the actual values in the <code>N</code> and <code>V</code> variants. In any case, I&#39;m not sure what you are asking."}, {"owner": {"reputation": 333, "user_id": 3197941, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/efc22040c4e82e56c9b56c43531dcb3f?s=128&d=identicon&r=PG&f=1", "display_name": "dumb0", "link": "https://stackoverflow.com/users/3197941/dumb0"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480464841, "post_id": 40878039, "comment_id": 68971211, "body": "Fixed, should make more sense now."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1480469615, "post_id": 40878039, "comment_id": 68972457, "body": "Constructors can&#39;t begin with symbols such as <code>+</code>. Consider <code>data F = Plus | Minus | DotDotDot</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1480481717, "post_id": 40878039, "comment_id": 68975658, "body": "You can, however, use infix constructors like <code>data Foo = Int :+ Char | String :* Bool</code>"}], "answers": [{"tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": true, "score": 2, "last_activity_date": 1480472616, "creation_date": 1480472616, "answer_id": 40879227, "question_id": 40878039, "link": "https://stackoverflow.com/questions/40878039/omitting-data-type-constructors/40879227#40879227", "title": "Omitting data type constructors", "body": "<blockquote>\n  <p>The key difference between the grammar and implementation is that type constructor is implicit /omitted in the grammar. Why are type constructors compulsory in Haskell?</p>\n</blockquote>\n\n<p>.</p>\n\n<blockquote>\n  <p>Is the grammar flawed at type level? Does it make sense? All terms look like they'd type check (allowing for 0,1,... to be both Expr and N subtype, and x,y,... to be both Expr and V subtype</p>\n</blockquote>\n\n<p>The reason data constructors<sup>1</sup> are compulsory in Haskell is <em>specifically</em> to ensure that you <strong>can't</strong> have x, y, .. be both Expr and V subtypes.</p>\n\n<p>So your grammar looks like a reasonable model for how you want your language terms to work. But it doesn't make sense as a <strong>direct</strong> design for how you want to represent your language terms as Haskell data types.</p>\n\n<p>Basically, Haskell deliberately does not have subtypes. It ensures that when you create a new type (with <code>newtype</code> or <code>data</code>) that all of the values of the new type are distinct from the values of all other existing types (and all types that will be created in future). It does this by having values of user-defined types always appear inside constructors (and making it impossible to \"reuse\" constructors; you always make new ones whenever you make a new type).</p>\n\n<p>The way Haskell's type system works depends on this lack of subtyping. You could design a language that allowed subtypes (see Scala, perhaps). But it just fundamentally wouldn't be Haskell.</p>\n\n<p>But what you can do instead is define something like:</p>\n\n<pre><code>data Expr\n  = ExprN N\n  | ExprV V\n  | ExprF Expr Expr\n</code></pre>\n\n<p>You still can't have a <code>N</code> value and just use it as an <code>Expr</code>. But you can just apply <code>ExprN</code> to it, and then you have an <code>Expr</code>. And it's really no more burden than if Haskell allowed you to use some <code>n</code> of type <code>N</code> as an <code>Expr</code> as well, but only required you to add a type annotation clarifying that that's what you meant; you just have to say <code>ExprN n</code> instead of <code>n :: Expr</code>.</p>\n\n<p>Similarly when you have an <code>Expr</code> and you want to apply a function on <code>N</code> to it, the case statement to extract the <code>N</code> from the <code>ExprN</code> constructor (if it's there) isn't really any more code than you'd have to write to check if your <code>Expr</code> was actually an <code>N</code>.</p>\n\n<hr>\n\n<p><sup>1</sup> \"<strong>Type</strong> constructor\" is a specific term in Haskell, which isn't what we're talking about here. I'm pretty sure what you meant by that was \"the constructors for a type\", but to be pedantic you accidentally referred to a different thing by using that term.</p>\n\n<p>To clear it up, when you declare a type like <code>data Maybe a = Nothing | Just a</code>, <code>Nothing</code> and <code>Just</code> are new <strong>data constructors</strong> (\"constructor\" on its on is extremely likely to mean a data constructor) and <code>Maybe</code> is a new <strong>type constructor</strong>.</p>\n"}], "owner": {"reputation": 333, "user_id": 3197941, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/efc22040c4e82e56c9b56c43531dcb3f?s=128&d=identicon&r=PG&f=1", "display_name": "dumb0", "link": "https://stackoverflow.com/users/3197941/dumb0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 40879227, "answer_count": 1, "score": -2, "last_activity_date": 1480472616, "creation_date": 1480464363, "last_edit_date": 1480465045, "question_id": 40878039, "link": "https://stackoverflow.com/questions/40878039/omitting-data-type-constructors", "title": "Omitting data type constructors", "body": "<p>I'm trying to implement the following in Haskell:  </p>\n\n<pre><code>0,1,2,...:N  \nx,y,z,...:V  \n+,*,-,/,...:F    \nF alias for Expr -&gt; Expr -&gt; Expr  \nExpr := N|V|F Expr Expr\n</code></pre>\n\n<p>My question is first:<br>\n<strong>Is the grammar flawed at type level?</strong> Does it make sense? All terms look like they'd type check (allowing for 0,1,... to be both Expr and N subtype, and x,y,... to be both Expr and V subtype).</p>\n\n<p>And secondarily, what's the closest Haskell implementation? My current Haskell implementation is:  </p>\n\n<pre><code>data F = +|-|*|... \ndata Expr = N|V|MakeExpr F Expr Expr\n</code></pre>\n\n<p>Any suggestions?</p>\n\n<p>EDIT -</p>\n\n<p>The key difference between the grammar and implementation is that type constructor is implicit /omitted in the grammar. Why are type constructors compulsory in Haskell?</p>\n"}, {"tags": ["haskell", "functional-programming", "latex", "monads", "file-writing"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1480459738, "post_id": 40877181, "comment_id": 68969527, "body": "I&#39;m not sure I understand what you want. Maybe it would help if you added the expected output latex source file for your example?"}, {"owner": {"reputation": 319, "user_id": 4834745, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/447b4a70326df5c9f1c830b52ba4a1a3?s=128&d=identicon&r=PG&f=1", "display_name": "BourbonCreams", "link": "https://stackoverflow.com/users/4834745/bourboncreams"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480459884, "post_id": 40877181, "comment_id": 68969584, "body": "Well my file should look like this: Some String Some other value  Again, some value  more values Hey, a value a value appeared!  Or better said: Value1 Value2 Value3 Value4 Value5 Value6"}, {"owner": {"reputation": 319, "user_id": 4834745, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/447b4a70326df5c9f1c830b52ba4a1a3?s=128&d=identicon&r=PG&f=1", "display_name": "BourbonCreams", "link": "https://stackoverflow.com/users/4834745/bourboncreams"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480460243, "post_id": 40877181, "comment_id": 68969727, "body": "I just edited the question, it should make more sense now. Thanks"}, {"owner": {"reputation": 1473, "user_id": 204305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4fa6165d3bcb50e58e60304807f4090a?s=128&d=identicon&r=PG", "display_name": "Sage Mitchell", "link": "https://stackoverflow.com/users/204305/sage-mitchell"}, "edited": false, "score": 0, "creation_date": 1480460807, "post_id": 40877181, "comment_id": 68969947, "body": "Your input has unbalanced list delimiters (<code>[</code> and <code>]</code>) and string delimiters (<code>&quot;</code>), and the list (of lists?) containing &quot;Value4&quot; isn&#39;t a <code>Maybe [[String]]</code> like the others. Please ensure the input is valid and clarify what parts are relevant to the transformation you want."}, {"owner": {"reputation": 319, "user_id": 4834745, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/447b4a70326df5c9f1c830b52ba4a1a3?s=128&d=identicon&r=PG&f=1", "display_name": "BourbonCreams", "link": "https://stackoverflow.com/users/4834745/bourboncreams"}, "edited": false, "score": 0, "creation_date": 1480461728, "post_id": 40877181, "comment_id": 68970292, "body": "Sorry that was my bad, I just fixed it. Thanks for pointing it out"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1480461090, "creation_date": 1480461090, "answer_id": 40877489, "question_id": 40877181, "link": "https://stackoverflow.com/questions/40877181/how-do-i-write-a-latex-file-from-a-list-in-haskell/40877489#40877489", "title": "How do I write a LaTeX file from a list in Haskell?", "body": "<ol>\n<li>Simplify your input to a <code>[String]</code> of the form <code>[\"Value1\", \"Value2\", \"Value3\", \"Value4\", \"Value5\", \"Value6\"]</code>. The functions <code>catMaybes</code>, <code>concat</code>, <code>filter</code>, and <code>null</code> may be helpful.</li>\n<li>Group your values into pairs. Depending on what you want, you may like to write this by hand or use <a href=\"http://hackage.haskell.org/package/split-0.2.3.1/docs/Data-List-Split.html#v:chunksOf\" rel=\"noreferrer\"><code>chunksOf</code></a> from the <code>split</code> package.</li>\n<li>Combine pairs with <code>unwords</code>; combine sets of pairs with <code>unlines</code>.</li>\n<li>Write to your file with <code>writeFile</code>.</li>\n</ol>\n\n<p>Except where noted, all of these functions are in the standard library.</p>\n"}], "owner": {"reputation": 319, "user_id": 4834745, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/447b4a70326df5c9f1c830b52ba4a1a3?s=128&d=identicon&r=PG&f=1", "display_name": "BourbonCreams", "link": "https://stackoverflow.com/users/4834745/bourboncreams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 40877489, "answer_count": 1, "score": -3, "last_activity_date": 1480461480, "creation_date": 1480459543, "last_edit_date": 1480461480, "question_id": 40877181, "link": "https://stackoverflow.com/questions/40877181/how-do-i-write-a-latex-file-from-a-list-in-haskell", "title": "How do I write a LaTeX file from a list in Haskell?", "body": "<p>OK so I have something that looks like this:</p>\n\n<pre><code>[Just [[\"Value1\"],[\"\",\"\",\"\"]],Just [[\"Value2\"],[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"Value3\",\"\"]],Just [[\"Value4\",\"\",\"\"]],Just [[\"Value5\"],[\"\",\"\",\"\"]],Just [[\"Value6\"],[\"\",\"\",\"\"]],Just []]\n</code></pre>\n\n<p>and I need to write all of those values to a LaTeX file, ignoring the empty strings(possibly in pairs, one line per pair).</p>\n\n<p>How would I go to do that?</p>\n\n<p>Thanks</p>\n\n<p>EDIT: My file should look like this:</p>\n\n<pre><code> Value1 Value2\n Value3 Value4\n Value5 Value6\n</code></pre>\n"}, {"tags": ["haskell", "abstract-syntax-tree"], "comments": [{"owner": {"reputation": 243, "user_id": 13679816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b02acae66c6a347786eb93e8cbead85?s=128&d=identicon&r=PG", "display_name": "atravers", "link": "https://stackoverflow.com/users/13679816/atravers"}, "edited": false, "score": 0, "creation_date": 1598046625, "post_id": 40876135, "comment_id": 112341197, "body": "Related: <a href=\"https://stackoverflow.com/questions/6311512/creating-unique-labels-in-haskell\" title=\"creating unique labels in haskell\">stackoverflow.com/questions/6311512/&hellip;</a>."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 4806766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f4c8ac467d0c759b411afe338750b7?s=128&d=identicon&r=PG&f=1", "display_name": "Elldorin", "link": "https://stackoverflow.com/users/4806766/elldorin"}, "edited": false, "score": 0, "creation_date": 1480459103, "post_id": 40876681, "comment_id": 68969229, "body": "But wouldn&#39;t (map (transform&#39; freeIdx) stmt) send the same &quot;nextLabel&quot; to all the Stmt in the List? That would would possibly result several flat if&#39;s or while&#39;s with the same label?  I had not tried the State monad mainly because I did not understand it and couldn&#39;t make it work. I am really grateful for your solution, and will definitely try it out, but I would still like to know if it is possible to solve the problem without monads."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "reply_to_user": {"reputation": 69, "user_id": 4806766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f4c8ac467d0c759b411afe338750b7?s=128&d=identicon&r=PG&f=1", "display_name": "Elldorin", "link": "https://stackoverflow.com/users/4806766/elldorin"}, "edited": false, "score": 0, "creation_date": 1480459685, "post_id": 40876681, "comment_id": 68969501, "body": "You are right. First solution isn&#39;t full correct. I&#39;ll try to fix it."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "reply_to_user": {"reputation": 69, "user_id": 4806766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f4c8ac467d0c759b411afe338750b7?s=128&d=identicon&r=PG&f=1", "display_name": "Elldorin", "link": "https://stackoverflow.com/users/4806766/elldorin"}, "edited": false, "score": 0, "creation_date": 1480460433, "post_id": 40876681, "comment_id": 68969795, "body": "So, I fixed the first version."}, {"owner": {"reputation": 69, "user_id": 4806766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f4c8ac467d0c759b411afe338750b7?s=128&d=identicon&r=PG&f=1", "display_name": "Elldorin", "link": "https://stackoverflow.com/users/4806766/elldorin"}, "edited": false, "score": 0, "creation_date": 1480462265, "post_id": 40876681, "comment_id": 68970478, "body": "I get errors like &quot;Couldn&#39;t match expected type &#39;FStmt&#39; with actual type &#39;t0 &#39;FStmt&#39;, for example in (freeIdx&#39;, FWhile label1 (Jumpf cond label2) stmt&#39; (Jump label1) label2). Is that because my AST is not deriving Traversable? Once again, thank you for your help, that is exactly I was looking for, a function like mapAccumL."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "reply_to_user": {"reputation": 69, "user_id": 4806766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f4c8ac467d0c759b411afe338750b7?s=128&d=identicon&r=PG&f=1", "display_name": "Elldorin", "link": "https://stackoverflow.com/users/4806766/elldorin"}, "edited": false, "score": 0, "creation_date": 1480462842, "post_id": 40876681, "comment_id": 68970686, "body": "No, It&#39;s because I think stmt&#39; has type <code>[FStmt]</code>. So I fixed."}, {"owner": {"reputation": 69, "user_id": 4806766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f4c8ac467d0c759b411afe338750b7?s=128&d=identicon&r=PG&f=1", "display_name": "Elldorin", "link": "https://stackoverflow.com/users/4806766/elldorin"}, "edited": false, "score": 0, "creation_date": 1480463609, "post_id": 40876681, "comment_id": 68970887, "body": "It worked perfectly! I will need some time to wrap my head around it. Thank you very much for your help!"}], "tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": true, "score": 5, "last_activity_date": 1480462723, "last_edit_date": 1480462723, "creation_date": 1480457309, "answer_id": 40876681, "question_id": 40876135, "link": "https://stackoverflow.com/questions/40876135/haskell-labelling-items-in-recursive-function/40876681#40876681", "title": "Haskell labelling items in recursive function", "body": "<p>If I understand correctly your problem, you can add to the function an extra parameter <em>free-index</em> like this:</p>\n\n<pre><code>transform :: Stmt -&gt; FStmt\ntransform = snd . transform' 0\n\ntransform' :: Int -&gt; Stmt -&gt; (Int, FStmt)\ntransform' freeIdx (Seq stmt) = (freeIdx', FSeq stmt')\n  where\n    (freeIdx', stmt') = mapAccumL transform' freeIdx stmt\ntransform' freeIdx (Assign var val) = (freeIdx, FAssign var val)\ntransform' freeIdx (While cond stmt) =\n    (freeIdx', FWhile label1 (Jumpf cond label2) stmt' (Jump label1) label2)\n  where\n    label1 = \"label\" ++ show freeIdx\n    label2 = \"label\" ++ show (freeIdx + 1)\n    (freeIdx', stmt') = transform' (freeIdx + 2) stmt\ntransform' freeIdx (If cond stmt1 stmt2) =\n    (freeIdx'', FIf (Jumpf cond label) stmt1' label stmt2')\n  where\n    label = \"label\" ++ show freeIdx\n    (freeIdx', stmt1') = transform' (freeIdx + 1) stmt1\n    (freeIdx'', stmt2') = transform' freeIdx' stmt2\n</code></pre>\n\n<p>But if you known State monad, you can design like this:</p>\n\n<pre><code>transform :: Stmt -&gt; FStmt\ntransform = flip evalState 0 . transform'\n\ntransform' :: Stmt -&gt; State Int FStmt\ntransform' (Seq stmt) = FSeq &lt;$&gt; mapM transform stmt\ntransform' (Assign var val) = return $ FAssign var val\ntransform' (While cond stmt) = do\n    label1 &lt;- freeLabel\n    label2 &lt;- freeLabel\n    stmt' &lt;- transform' stmt\n    return $ FWhile label1 (Jumpf cond label2) stmt' (Jump label1) label2\ntransform' (If cond stmt1 stmt2) = do\n    label &lt;- freeLabel\n    stmt1' &lt;- transform' stmt1\n    stmt2' &lt;- transform' stmt2\n    return $ FIf (Jumpf cond label) stmt1' label stmt2'\n\nfreeLabel :: State Int String\nfreeLabel = do\n    i &lt;- get\n    put $ i + 1\n    return $ \"label\" ++ show i\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 4806766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f4c8ac467d0c759b411afe338750b7?s=128&d=identicon&r=PG&f=1", "display_name": "Elldorin", "link": "https://stackoverflow.com/users/4806766/elldorin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 40876681, "answer_count": 1, "score": 2, "last_activity_date": 1480462723, "creation_date": 1480455195, "question_id": 40876135, "link": "https://stackoverflow.com/questions/40876135/haskell-labelling-items-in-recursive-function", "title": "Haskell labelling items in recursive function", "body": "<p>I am quite new to Haskell and functional programming in general, so excuse me if the question seems straightforward or silly.</p>\n\n<p>I have a parser for a simple language that produces an abstract syntax tree. In order to flatten the AST (turn while and if statements into jumps) I need to put labels in the tree. The problem is that I do not know what the next label should be (I am still thinking imperatively, because if I had state, none of this would be a problem).</p>\n\n<p>The function that I have so far is the following:</p>\n\n<pre><code>transform :: Stmt -&gt; FStmt\ntransform (Seq stmt) = FSeq (map transform stmt)\ntransform (Assign var val) = FAssign var val\ntransform (While cond stmt) = FWhile \"label1\" (Jumpf cond \"label2\") (transform stmt) (Jump \"label1\") \"label2\"\ntransform (If cond stmt1 stmt2) = FIf (Jumpf cond \"label\") (transform stmt1) \"label\" (transform stmt2)\n</code></pre>\n\n<p>In its current state, the function \"flattens\" the AST, but does not attempt to put the correct labels (it uses the same string for every construct).</p>\n\n<p>Basically the problem is that in the case of a sequential statement (and every program is a sequential statement) I cannot think of a way to pass the next value that should be used in the labels.</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["haskell", "dependent-type"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1480442653, "post_id": 40872397, "comment_id": 68960617, "body": "You could use <code>Either</code>, with <code>Left xs</code> representing the original vector with no values removed, and <code>Right ...</code> representing a new vector with <code>x</code> removed."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1480461558, "post_id": 40872397, "comment_id": 68970241, "body": "I don&#39;t advise using Haskell to learn dependent types. Haskell was never designed as a dependently-typed language (though the progress they&#39;re making is remarkable) and tricks like singletons are nothing more than hacks to help simulate dependent types. Learn the concepts in a DT language like Agda or Idris first - then you&#39;ll find it much easier to understand the encodings in Haskell."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 1, "creation_date": 1480503128, "post_id": 40872397, "comment_id": 68986791, "body": "One might also consider the possibility that the interface chosen for Haskell library functions is a result of and intended only to be good for programming in a non-dependent way. Rather than porting that interface, one might instead think twice about it. I, for one, would never implement delete. I would implement the view which inverts insert."}, {"owner": {"reputation": 745, "user_id": 1926884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1783f4ed8a98a1a4b7a7321d4cea3fa4?s=128&d=identicon&r=PG", "display_name": "Rnhmjoj", "link": "https://stackoverflow.com/users/1926884/rnhmjoj"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1480541428, "post_id": 40872397, "comment_id": 69010908, "body": "@BenjaminHodgson I know, I wanted to go with Agda but I had some problem setting it up on NixOS (it&#39;s not much supported there) so I decided to stick with Haskell and experiment a bit."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1480448579, "post_id": 40873021, "comment_id": 68963956, "body": "The indexed <code>delete</code> just ignores the problem; instead of deleting <code>x</code> if it is present, it deletes an arbitrary value at a position <code>i</code>. It just warps the problem to defining a function that returns a <code>Maybe (Index n)</code> value to represent the position of <code>x</code> (if present), and defining what to do if that function returns <code>Nothing</code>."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1480449688, "post_id": 40873021, "comment_id": 68964568, "body": "@chepner, I&#39;ve added a hasochistic solution."}, {"owner": {"reputation": 745, "user_id": 1926884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1783f4ed8a98a1a4b7a7321d4cea3fa4?s=128&d=identicon&r=PG", "display_name": "Rnhmjoj", "link": "https://stackoverflow.com/users/1926884/rnhmjoj"}, "edited": false, "score": 0, "creation_date": 1480450316, "post_id": 40873021, "comment_id": 68964908, "body": "@user3237465 Thank you!"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1480460999, "post_id": 40873021, "comment_id": 68970029, "body": "@user3237465 The quote you have at the start no longer applies, thanks to <code>TypeInType</code>"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1480523005, "post_id": 40873021, "comment_id": 69000448, "body": "@chepner, the Agda function is just an indexed delete in disguise also, which is controlled by the structure of the <code>x \u2208 xs</code> argument. In particular, it doesn&#39;t necessarily delete the first occurrence of <code>x</code>."}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": true, "score": 4, "last_activity_date": 1480490034, "last_edit_date": 1480490034, "creation_date": 1480443685, "answer_id": 40873021, "question_id": 40872397, "link": "https://stackoverflow.com/questions/40872397/is-it-possible-to-write-this-function-in-haskell/40873021#40873021", "title": "Is it possible to write this function in Haskell?", "body": "<p>The problem is that you need a dependent quantifier which Haskell currently lacks. I.e. the <code>(x : A)(xs : Vec A (suc n)) \u2192 ...</code> part is not directly expressible. You can probably cook up something using singletons, but it'll be really ugly and complicated.</p>\n\n<p>I would just define</p>\n\n<pre><code>delete \u2237 Eq a \u21d2 a \u2192 Vec a (S n) \u2192 Maybe (Vec a n)\n</code></pre>\n\n<p>and be fine with it. I'd also change the order of arguments to <code>Vec</code> to make it possible to provide <code>Applicative</code>, <code>Traversable</code> and other instances.</p>\n\n<hr>\n\n<p>Actually, no. In order to define <code>delete</code> you just need to provide an index at which to delete:</p>\n\n<pre><code>{-# LANGUAGE GADTs, DataKinds #-}\n\ndata Nat = Z | S Nat\n\ndata Index n where\n  IZ :: Index n\n  IS :: Index n -&gt; Index (S n)\n\ndata Vec n a where\n  Nil  :: Vec Z a\n  (:-) :: a -&gt; Vec n a -&gt; Vec (S n) a\n\ndelete :: Index n -&gt; Vec (S n) a -&gt; Vec n a\ndelete  IZ    (x :-  xs)       = xs\ndelete (IS n) (x :- (y :- xs)) = x :- delete n (y :- xs)\n</code></pre>\n\n<p>Note that <code>x \u2208 xs</code> is nothing more than a richly typed index.</p>\n\n<hr>\n\n<p>Here is a solution with singletons:</p>\n\n<pre><code>{-# LANGUAGE GADTs, DataKinds, PolyKinds, KindSignatures, UndecidableInstances, TypeFamilies, RankNTypes, TypeOperators #-}\n\ninfixr 5 :-\n\ndata Nat = Z | S Nat\n\ndata family Sing (x :: a)\n\ndata instance Sing (b :: Bool) where\n  STrue  :: Sing True\n  SFalse :: Sing False\n\ndata instance Sing (n :: Nat) where\n  SZ :: Sing Z\n  SS :: Sing n -&gt; Sing (S n)\n\ntype family (:==) (x :: a) (y :: a) :: Bool\n\nclass SEq a where\n  (===) :: forall (x :: a) (y :: a). Sing x -&gt; Sing y -&gt; Sing (x :== y)\n\ntype instance Z   :== Z   = True\ntype instance S n :== Z   = False\ntype instance Z   :== S m = False\ntype instance S n :== S m = n :== m\n\ninstance SEq Nat where\n  SZ   === SZ   = STrue\n  SS n === SZ   = SFalse\n  SZ   === SS m = SFalse\n  SS n === SS m = n === m\n\ndata Vec xs a where\n  Nil  :: Vec '[] a\n  (:-) :: Sing x -&gt; Vec xs a -&gt; Vec (x ': xs) a\n\ntype family If b x y where\n  If True  x y = x\n  If False x y = y\n\ntype family Delete x xs where\n  Delete x  '[]      = '[]\n  Delete x (y ': xs) = If (x :== y) xs (y ': Delete x xs)\n\ndelete :: forall (x :: a) xs. SEq a =&gt; Sing x -&gt; Vec xs a -&gt; Vec (Delete x xs) a\ndelete x  Nil      = Nil\ndelete x (y :- xs) = case x === y of\n  STrue  -&gt; xs\n  SFalse -&gt; y :- delete x xs\n\ntest :: Vec '[S Z, S (S (S Z)), Z] Nat\ntest = delete (SS (SS SZ)) (SS SZ :- SS (SS (SS SZ)) :- SS (SS SZ) :- SZ :- Nil)\n</code></pre>\n\n<p>Here we index <code>Vec</code>s by lists of their elements and store singletons as elements of vectors. We also define <code>SEq</code> which is a type class that contains a method that receives two singletons and returns either a proof of equality of values they promote or their inequality. Next we define a type family <code>Delete</code> that is like usual <code>delete</code> for lists, but at the type level. Finally in the actual <code>delete</code> we pattern match on <code>x === y</code> and thus reveal whether <code>x</code> is equal to <code>y</code> or not, which makes the type family compute.</p>\n"}], "owner": {"reputation": 745, "user_id": 1926884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1783f4ed8a98a1a4b7a7321d4cea3fa4?s=128&d=identicon&r=PG", "display_name": "Rnhmjoj", "link": "https://stackoverflow.com/users/1926884/rnhmjoj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 2, "accepted_answer_id": 40873021, "answer_count": 1, "score": 7, "last_activity_date": 1480490034, "creation_date": 1480441638, "question_id": 40872397, "link": "https://stackoverflow.com/questions/40872397/is-it-possible-to-write-this-function-in-haskell", "title": "Is it possible to write this function in Haskell?", "body": "<p>I'm learning dependent types: In Haskell I have defined the canonical type</p>\n\n<pre><code>data Vec \u2237 Type \u2192 Nat \u2192 Type where\n  Nil  \u2237 Vec a Z\n  (:-) \u2237 a \u2192 Vec a n \u2192 Vec a (S n)\n</code></pre>\n\n<p>and implemented most of the functions from <code>Data.List</code> however I don't know how to write, if possible at all, functions like</p>\n\n<pre><code>delete \u2237 Eq a \u21d2 a \u2192 Vec a n \u2192 Vec a (??)\n</code></pre>\n\n<p>since the length of the result is not known. I have found it in Agda and it's implemented this way</p>\n\n<pre><code>delete : {A : Set}{n : Nat}(x : A)(xs : Vec A (suc n)) \u2192 x \u2208 xs \u2192 Vec A n\ndelete           .x (x \u2237 xs)  hd    = xs\ndelete {A}{zero } _  ._      (tl ())\ndelete {A}{suc _} y (x \u2237 xs) (tl p) = x \u2237 delete y xs p\n</code></pre>\n\n<p>If I understand correctly <code>delete</code> it's defined with the constrain of <code>x</code> being an element of <code>xs</code>, in that case you just remove <code>x</code> and subtract 1 from the length. Can I write something like this in Haskell?</p>\n"}, {"tags": ["algorithm", "haskell"], "comments": [{"owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "edited": false, "score": 0, "creation_date": 1480433898, "post_id": 40869752, "comment_id": 68955136, "body": "Pick a random function from the list, and call it on the return value of `randApply &lt;listWithoutThatFunction&gt;"}], "answers": [{"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1480438817, "post_id": 40869812, "comment_id": 68958605, "body": "This code runs in O(n^2), whereas shuffling a list should be O(n log n)"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1480448760, "post_id": 40869812, "comment_id": 68964065, "body": "@BenjaminHodgson Why not <a href=\"https://wiki.haskell.org/Random_shuffle\" rel=\"nofollow noreferrer\"><code>O(n)</code></a>?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480460082, "post_id": 40869812, "comment_id": 68969656, "body": "@Alec You&#39;re right! I&#39;d figured that shuffling was a pathological kind of sorting. Do you know if you can do O(n) without <code>ST</code>?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1480464452, "post_id": 40869812, "comment_id": 68971093, "body": "@BenjaminHodgson I&#39;m pretty sure you can&#39;t go lower that <code>O(nlog n)</code>, although I don&#39;t have any good reason for justifying that lower bound. The usual way with <code>ST</code> is indeed using some merge-sort like algorithm (I started by writing that up, was about to post it, then realized <code>ST</code> would let me do this is <code>O(n)</code>)."}, {"owner": {"reputation": 3967, "user_id": 3853711, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/SwXly.png?s=128&g=1", "display_name": "Rahn", "link": "https://stackoverflow.com/users/3853711/rahn"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1480465627, "post_id": 40869812, "comment_id": 68971412, "body": "@BenjaminHodgson Let me check. I didn&#39;t care much on time complexity."}], "tags": [], "owner": {"reputation": 3967, "user_id": 3853711, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/SwXly.png?s=128&g=1", "display_name": "Rahn", "link": "https://stackoverflow.com/users/3853711/rahn"}, "is_accepted": true, "score": 0, "last_activity_date": 1480470828, "last_edit_date": 1480470828, "creation_date": 1480433924, "answer_id": 40869812, "question_id": 40869752, "link": "https://stackoverflow.com/questions/40869752/nested-calling-in-random-order/40869812#40869812", "title": "Nested calling in random order", "body": "<p>First, you are not going to make a function <code>randApply :: a -&gt; [a -&gt; a] -&gt; a</code> with a random value. Instead you define one <code>randApply :: a -&gt; [a -&gt; a] -&gt; IO a</code>. Learn <code>Monad</code> at <a href=\"https://wiki.haskell.org/Monad\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Monad</a>.</p>\n\n<p>2 step for your solution:</p>\n\n<ol>\n<li>Shuffle given functions</li>\n<li>Apply random function list to the seed one by one</li>\n</ol>\n\n<p>Shuffle:</p>\n\n<pre><code>shuffle :: [a] -&gt; IO [a]\nshuffle [] = return []\nshuffle xs = do nRand &lt;- randomRIO (0, length xs - 1)\n                rest  &lt;- shuffle (erase nRand xs)\n                return (xs !! nRand : rest)\n\nerase :: Int -&gt; [a] -&gt; [a]\nerase n xs = take n xs ++ drop (n+1) xs\n</code></pre>\n\n<p>Check more effiecient shuffle program at <a href=\"https://wiki.haskell.org/Random_shuffle\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Random_shuffle</a>.</p>\n\n<p>Apply to the seed one by one:</p>\n\n<pre><code>seqApply :: a -&gt; [a -&gt; a] -&gt; a\nseqApply x []          = x\nseqApply x (f : fList) = seqApply (f x) fList\n</code></pre>\n\n<p>randApply you want:</p>\n\n<pre><code>randApply :: a -&gt; [a -&gt; a] -&gt; IO a\nrandApply x fList = do randList &lt;- shuffle fList\n                       return (seqApply x randList)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7226146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e0c3154c7ce8beb8b7549990ba32a52?s=128&d=identicon&r=PG&f=1", "display_name": "joobelian", "link": "https://stackoverflow.com/users/7226146/joobelian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 40869812, "answer_count": 1, "score": 1, "last_activity_date": 1480470828, "creation_date": 1480433695, "last_edit_date": 1480434017, "question_id": 40869752, "link": "https://stackoverflow.com/questions/40869752/nested-calling-in-random-order", "title": "Nested calling in random order", "body": "<p>How do I make a <code>randApply</code> function that take a seed <code>x</code> and a list of functions (of type <code>a -&gt; a</code>, says <code>f</code>, <code>g</code>, <code>h</code>) that return a random one from permutations of <code>f</code>, <code>g</code>, <code>h</code></p>\n\n<ul>\n<li><code>f (g (h x))</code></li>\n<li><code>f (h (g x))</code></li>\n<li><code>g (f (h x))</code></li>\n<li><code>g (h (f x))</code></li>\n<li><code>h (f (g x))</code></li>\n<li><code>h (g (f x))</code> </li>\n</ul>\n\n<p>How do I define such <code>randApply :: a -&gt; [a -&gt; a] -&gt; a</code>?</p>\n"}, {"tags": ["haskell", "nixos", "euterpea"], "comments": [{"owner": {"reputation": 2585, "user_id": 1190453, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8bc78ac3f1246f30c55f3339c3e7586f?s=128&d=identicon&r=PG", "display_name": "danbst", "link": "https://stackoverflow.com/users/1190453/danbst"}, "edited": false, "score": 0, "creation_date": 1481372877, "post_id": 40869437, "comment_id": 69357354, "body": "&gt; Euterpea-1.1.1 Looks like your <code>nixpkgs</code> is outdated, but probaly it&#39;s irrelevant to problem. I got a configure error when run your command (with Euterpea 2.0.2)"}], "answers": [{"tags": [], "owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "is_accepted": false, "score": 2, "last_activity_date": 1484403767, "creation_date": 1484403767, "answer_id": 41651016, "question_id": 40869437, "link": "https://stackoverflow.com/questions/40869437/installation-of-haskell-package-euterpea-fails-on-nixos/41651016#41651016", "title": "Installation of Haskell Package Euterpea fails on NixOs", "body": "<p>The problem here is that <code>Euterpea</code> does not compile against the more-recent versions of its dependencies available in nixpkgs. Here is an expression that can succcessfully build <code>Euterpea</code> (tested on current nixpkgs unstable):</p>\n\n<p>Write the following nix expression into a file called <code>euterpea.nix</code>:</p>\n\n<pre><code># let's get nixpkgs into scope\nwith (import &lt;nixpkgs&gt; {});\n\nlet\n  lib = haskell.lib;\n\n  # build a \"package set\" (collection of packages) that has the correct versions of the dependencies\n  # needed by Euterpea\n  customHaskellPackages = haskellPackages.override (old: {\n    overrides = self: super: {\n        heap = self.callHackage \"heap\" \"0.6.0\" {}; \n        PortMidi = self.callHackage \"PortMidi\" \"0.1.5.2\" {};\n        stm = self.callHackage \"stm\" \"2.4.2\" {};\n    };\n  });\nin {\n  # this is a ghc wrapper that has only Euterpea as its visible packages\n  ghc = customHaskellPackages.ghcWithPackages (pkgs: [ pkgs.Euterpea ]);\n\n  # this is just the output of the build for Euterpea \n  pkg = customHackagePackages.Euterpea;\n\n  # for convenience, also expose the package set that we build against\n  pkgset = customHaskellPackages;\n}\n</code></pre>\n\n<p>Then you can run the following commands:</p>\n\n<pre><code>$ nix-build euterpea.nix -A ghc # build a GHC with the Euterpea package included\n/nix/store/mjlp6rxcsiv5w8ay1qp0lrj8m40r3cyl-ghc-8.0.1-with-packages\n$ result/bin/ghci # result contains a GHC installation that has Euterpea, so we can run GHCI from it\nGHCi, version 8.0.1: http://www.haskell.org/ghc/  :? for help\nLoaded GHCi configuration from /home/.ghci\n\u03bb: import Euterpea\n\u03bb: \nLeaving GHCi.\n$ nix-env --install --file euterpea.nix -A ghc # we can also install this ghc into our user environment\ninstalling \u2018ghc-8.0.1-with-packages\u2019\nbuilding path(s) \u2018/nix/store/7jwrwxaxyig6hf747rsan5514gw7qi51-user-environment\u2019\ncreated 5840 symlinks in user environment\n$ \n</code></pre>\n"}], "owner": {"reputation": 5352, "user_id": 4896150, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/74d0c938f3f71d6ee14db4f6b9d222c2?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Harald", "link": "https://stackoverflow.com/users/4896150/anton-harald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1548904561, "creation_date": 1480432817, "last_edit_date": 1548904561, "question_id": 40869437, "link": "https://stackoverflow.com/questions/40869437/installation-of-haskell-package-euterpea-fails-on-nixos", "title": "Installation of Haskell Package Euterpea fails on NixOs", "body": "<p>Unfortunately, the installation of the haskell package 'Euterpea' fails on NixOS:</p>\n\n<p>The <a href=\"http://nixos.org/nixpkgs/manual/#users-guide-to-the-haskell-infrastructure\" rel=\"nofollow noreferrer\">Nixpkgs manual</a> states that all haskell packages registered on hackage (which the Euterpea package is) are included in the nix package manager and have to be installed like this:</p>\n\n<pre><code>nix-env -f \"&lt;nixpkgs&gt;\" -iA haskellPackages.Euterpea\n</code></pre>\n\n<p>After some downloading and compiling, the following error occurs, and the process is interrupted:</p>\n\n<pre><code>[ 7 of 46] Compiling Euterpea.IO.MIDI.MidiIO ( Euterpea/IO/MIDI/MidiIO.lhs, dist/build/Euterpea/IO/MIDI/MidiIO.o )\n\nEuterpea/IO/MIDI/MidiIO.lhs:153:25:\n    Not in scope: \u2018Heap.extractHead\u2019\n\nEuterpea/IO/MIDI/MidiIO.lhs:160:34: Not in scope: \u2018Heap.head\u2019\nbuilder for \u2018/nix/store/wc8d02s0kin4l0siwixlylssizfsrzgx-Euterpea-1.1.1.drv\u2019 failed with exit code 1\nerror: build of \u2018/nix/store/wc8d02s0kin4l0siwixlylssizfsrzgx-Euterpea-1.1.1.drv\u2019 failed\n</code></pre>\n\n<p>Does anyone have an idea how to fix this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1480432818, "post_id": 40869299, "comment_id": 68954326, "body": "<code>String</code> is just an alias for <code>[Char]</code>, and when you&#39;re using an abandonware compiler like Hugs it likely won&#39;t give you the best error messages.  I strongly advocate for using GHC over Hugs since it&#39;s still maintained."}, {"owner": {"reputation": 7488, "user_id": 2957677, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/CUuCz.jpg?s=128&g=1", "display_name": "Toby Mellor", "link": "https://stackoverflow.com/users/2957677/toby-mellor"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1480432955, "post_id": 40869299, "comment_id": 68954422, "body": "@bheklilr I&#39;ll try it out, thanks for the suggestion. I&#39;m only using this because it&#39;s what our lecturer has suggested everyone to use."}, {"owner": {"reputation": 9272, "user_id": 241544, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d27ca4e9a9a41ec8732046e6a272f091?s=128&d=identicon&r=PG", "display_name": "Matthew Walton", "link": "https://stackoverflow.com/users/241544/matthew-walton"}, "edited": false, "score": 2, "creation_date": 1480433375, "post_id": 40869299, "comment_id": 68954751, "body": "Make sure you check out ghci, which is GHC&#39;s interactive component that&#39;s much like the Hugs prompt (doesn&#39;t behave entirely the same though so do read up on it). Just bear in mind if your lecturer wants code submitted and you&#39;ve written it to work in GHC it might not run in Hugs if you accidentally used something Hugs doesn&#39;t support, so do check before you submit your coursework."}, {"owner": {"reputation": 7488, "user_id": 2957677, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/CUuCz.jpg?s=128&g=1", "display_name": "Toby Mellor", "link": "https://stackoverflow.com/users/2957677/toby-mellor"}, "reply_to_user": {"reputation": 9272, "user_id": 241544, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d27ca4e9a9a41ec8732046e6a272f091?s=128&d=identicon&r=PG", "display_name": "Matthew Walton", "link": "https://stackoverflow.com/users/241544/matthew-walton"}, "edited": false, "score": 0, "creation_date": 1480433968, "post_id": 40869299, "comment_id": 68955183, "body": "@MatthewWalton Will do!"}], "answers": [{"comments": [{"owner": {"reputation": 7488, "user_id": 2957677, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/CUuCz.jpg?s=128&g=1", "display_name": "Toby Mellor", "link": "https://stackoverflow.com/users/2957677/toby-mellor"}, "edited": false, "score": 0, "creation_date": 1480433212, "post_id": 40869487, "comment_id": 68954643, "body": "Thank you! That got rid of the syntax error. I&#39;ll definitely look into your suggestions."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 7488, "user_id": 2957677, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/CUuCz.jpg?s=128&g=1", "display_name": "Toby Mellor", "link": "https://stackoverflow.com/users/2957677/toby-mellor"}, "edited": false, "score": 3, "creation_date": 1480433322, "post_id": 40869487, "comment_id": 68954709, "body": "@Toby Take care! Your error is not a syntax one. It&#39;s a type error. Which means that your syntax was fine, but your types weren&#39;t. For example, <code>(2 :: Double) + (3 :: Int)</code> is fine syntax-wise, but <code>(+)</code> only works if both arguments use the same type wheras <code>+ 2 3</code> is a syntax error. Try both in your interpreter. Nitpicky, but important."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 4, "last_activity_date": 1480432943, "creation_date": 1480432943, "answer_id": 40869487, "question_id": 40869299, "link": "https://stackoverflow.com/questions/40869299/haskell-trying-to-generate-a-list-size-m-of-strings-size-n/40869487#40869487", "title": "Haskell - Trying to generate a list (size m) of strings (size n)", "body": "<p>Your <code>addRow</code> returns a <code>String</code>, which is a <code>[Char]</code>. However, your <code>generateRectangle</code> expects a <code>[String]</code>, which is a <code>[[Char]]</code>:</p>\n\n<pre><code>    generateRectangle m n (addRow m \"\") : currentRectangle\n                          ^^^^^^^^^^^^^\n                          this is a String, not a [String]\n</code></pre>\n\n<p>That's the same as</p>\n\n<pre><code>    (generateRectangle m n (addRow m \"\")) : currentRectangle\n</code></pre>\n\n<p>and the types don't match.</p>\n\n<p>You probably meant this instead:</p>\n\n<pre><code>    generateRectangle m n ((addRow m \"\") : currentRectangle)\n</code></pre>\n\n<p>Remember, function application has the highest precedence.</p>\n\n<hr>\n\n<p>That being said, try to write a function</p>\n\n<pre><code>repeatNTimes :: Int -&gt; a -&gt; [a]\n</code></pre>\n\n<p>instead. Then, you can write <code>rectangle</code> using that function two times:</p>\n\n<pre><code>rectangle n m = repeatNTimes ??? (repeatNTimes ??? ???)\n</code></pre>\n\n<p>Maybe you even know a function that acts like <code>repeatNTimes</code>, but try to figure it out on your own first.</p>\n"}], "owner": {"reputation": 7488, "user_id": 2957677, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/CUuCz.jpg?s=128&g=1", "display_name": "Toby Mellor", "link": "https://stackoverflow.com/users/2957677/toby-mellor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 40869487, "answer_count": 1, "score": 3, "last_activity_date": 1480432943, "creation_date": 1480432402, "question_id": 40869299, "link": "https://stackoverflow.com/questions/40869299/haskell-trying-to-generate-a-list-size-m-of-strings-size-n", "title": "Haskell - Trying to generate a list (size m) of strings (size n)", "body": "<p>I'm trying to define a function that takes two integer values m and n. It returns a value that can be displayed as a rectangle.</p>\n\n<pre><code>e.g. rectangle 3 4\n****\n****\n****\n</code></pre>\n\n<p>In my code, I'm getting a syntax error saying I have the wrong type [Char], but I'm not using a char anywhere.</p>\n\n<p>The code:</p>\n\n<pre><code>rectangle :: Int -&gt; Int -&gt; [String]\nrectangle m n = generateRectangle m n []\n\ngenerateRectangle :: Int -&gt; Int -&gt; [String] -&gt; [String]\ngenerateRectangle m n currentRectangle =\n    if length currentRectangle &lt; n then\n        generateRectangle m n (addRow m \"\"):currentRectangle\n    else\n        currentRectangle\n\naddRow :: Int -&gt; String -&gt; String\naddRow size currentRow =\n    if length currentRow &lt; size then\n        addRow size currentRow++\"*\"\n    else\n        currentRow\n</code></pre>\n\n<p>The error:</p>\n\n<pre><code>    ERROR file:test.hs:8 - Type error in application\n*** Expression     : generateRectangle m n (addRow m \"\")\n*** Term           : addRow m \"\"\n*** Type           : [Char]\n*** Does not match : [String]\n</code></pre>\n"}, {"tags": ["haskell", "coroutine", "state-monad", "io-monad", "st-monad"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480413253, "post_id": 40862227, "comment_id": 68940903, "body": "In introducing <code>MyType</code>, you seem to be using a new <code>MyState</code> (one with kind <code>* -&gt; *</code> as opposed to just <code>*</code>). Is that <code>data MyState s = MyState s</code>? Also, <code>initialState</code> is fine, it just has the wrong signature (<code>Num a =&gt; ST s (MyState (STRef s a))</code>). You may want to clarify what exactly you are asking there. That said, the last question is very interesting - you will want to read up on rankNTypes."}, {"owner": {"reputation": 550, "user_id": 3809223, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a86c2d7227577450956bbbe1ea6662d8?s=128&d=identicon&r=PG&f=1", "display_name": "ksaveljev", "link": "https://stackoverflow.com/users/3809223/ksaveljev"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480415413, "post_id": 40862227, "comment_id": 68942469, "body": "@alec, you are correct, it is <code>data MyState s = MyState s</code>. What I am asking for (sorry if it is unclear) is how (if possible) to implement <code>runMyType</code> with new <code>MyType s</code> because I need to run some actions in ST monad there but at the same time the requests from <code>Coroutine</code> are <code>IO</code>"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1480472005, "post_id": 40862227, "comment_id": 68973022, "body": "I don&#39;t think you can do that, short of using <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Monad-ST-Unsafe.html\" rel=\"nofollow noreferrer\">unsafe operations</a>. Your <code>runMyType</code> depends crucially on the ability to suspend the state of the computation and then feed it back in to the next round of <code>runState</code>, but with <code>ST</code>, once you <code>runST</code> up to a <code>RunIO</code> request, you won&#39;t be able to go back to &quot;the same <code>s</code>&quot;."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1480509594, "post_id": 40862227, "comment_id": 68990828, "body": "You&#39;re getting this error because of the way how <code>ST</code> works. Try to read this explanation: <a href=\"https://en.wikibooks.org/wiki/Haskell/Existentially_quantified_types#Example:_runST\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/Haskell/&hellip;</a> You basically can&#39;t return <code>MyState s</code> from <code>ST s</code> inside <code>runST</code>. If you clarify why you need <code>ST</code> and give some example, then, probably, another solution can be found or your current may be patched."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1480542886, "post_id": 40862227, "comment_id": 69011646, "body": "<code>data MyState s = MyState s</code> simply doesn&#39;t make sense - the state token <code>s</code> which is passed to <code>ST</code> is not a &#39;real&#39; type, it should only ever be instantiated with type variables, so using it in a relevant position (like as the type of a value) is simply a semantic error. Maybe you want <code>data MyState s = MyState (STRef s Int)</code> or <code>initialState :: ST s (STRef s MyState)</code> (in the latter case, with the original <code>data MyState = MyState Int</code> type)."}, {"owner": {"reputation": 550, "user_id": 3809223, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a86c2d7227577450956bbbe1ea6662d8?s=128&d=identicon&r=PG&f=1", "display_name": "ksaveljev", "link": "https://stackoverflow.com/users/3809223/ksaveljev"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1480598112, "post_id": 40862227, "comment_id": 69035366, "body": "Yes, my mistake about <code>MyState</code>. It is supposed to be something like <code>data MyState s = MyState { tmp :: STRef s Int, ... }</code> (basically huge deeply nested state with some STRefs, STUArrays and ST vectors. @Shersh I was experimenting with coroutine to have pure logic which requests to perfom IO outside of coroutine. At some point it became clear that for some parts STRefs would be desired. That is why I tried to see if something with ST and Coroutine would work"}], "owner": {"reputation": 550, "user_id": 3809223, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a86c2d7227577450956bbbe1ea6662d8?s=128&d=identicon&r=PG&f=1", "display_name": "ksaveljev", "link": "https://stackoverflow.com/users/3809223/ksaveljev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1480411940, "creation_date": 1480411940, "question_id": 40862227, "link": "https://stackoverflow.com/questions/40862227/coroutine-with-statet-and-st-and-io", "title": "Coroutine with StateT and ST and IO", "body": "<p>having some trouble with a group of monads I'm trying to combine.</p>\n\n<p>I'm using <a href=\"https://hackage.haskell.org/package/monad-coroutine\" rel=\"nofollow noreferrer\">monad-coroutine</a>, State and lens (as I have deeply nested state).</p>\n\n<p>I had an initial approach where there was a working solution. The main point here is that I can request to execute <code>IO</code> tasks outside of Coroutine.</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\n{-# LANGUAGE FlexibleInstances         #-}\n{-# LANGUAGE MultiParamTypeClasses     #-}\n{-# LANGUAGE UndecidableInstances      #-}\n\nmodule Main where\n\nimport           Control.Monad.Coroutine      (Coroutine(..), suspend, resume)\nimport           Control.Monad.State          (State, MonadState, MonadIO)\nimport           Control.Monad.State          (lift, get, put, liftIO, runState)\nimport           System.Environment           (getArgs)\n\ntype MyType = Coroutine IORequest (State MyState)\n\ninstance (MonadState s m) =&gt; MonadState s (Coroutine IORequest m) where\n    get = lift get\n    put = lift . put\n\nio :: MonadIO m =&gt; IO a -&gt; m a\nio = liftIO\n\ndata IORequest x = forall a. RunIO (IO a) (a -&gt; x)\n\ninstance Functor IORequest where\n    fmap f (RunIO x g) = RunIO x (f . g)\n\ndata MyState = MyState { _someInt :: Int }\n\ninitialState :: MyState\ninitialState = MyState 1\n\nrequest :: Monad m =&gt; IO a -&gt; Coroutine IORequest m a\nrequest x = suspend (RunIO x return)\n\nmyLogic :: MyType [String]\nmyLogic = do\n    args &lt;- request (io getArgs)\n    request (io (print args))\n    -- do a lot of useful stuff here\n    return args\n\nrunMyType :: MyType [String] -&gt; MyState -&gt; IO ()\nrunMyType logic state = do\n    let (req, state') = runState (resume logic) state\n    case req of\n        Left (RunIO cmd q') -&gt; do\n            result &lt;- cmd\n            runMyType (q' result) state'\n        Right _ -&gt; return ()\n\nmain :: IO ()\nmain = runMyType myLogic initialState\n</code></pre>\n\n<p>Now, at some point a simple State became not enough and I am in a need of ST. I started to try to get the <code>ST</code> inside <code>StateT</code> but for some reason cannot come up with an idea how to properly handle <code>IO</code> outside of coroutine. Is there any way to come up with similar <code>runMyType</code> when there is a change in the <code>Coroutine</code>?</p>\n\n<pre><code>type MyType s = Coroutine IORequest (StateT (MyState s) (ST s))\n\ninitialState :: ST s (MyState s)\ninitialState = do\n    a &lt;- newSTRef 0\n    return (MyState a)\n</code></pre>\n\n<p>Whatever I try to come up with throws some error about <code>s</code> escaping or <code>Couldn't match type \u2018s\u2019 with \u2018s2\u2019</code> and so on... Maybe some other order of monad stacking will help? Or is it at all possible?</p>\n\n<p>And another question if you have some time: what is the difference between the above <code>MyType s</code> and this one:</p>\n\n<pre><code>type MyType = forall s. Coroutine IORequest (StateT (MyState s) (ST s))\n</code></pre>\n"}, {"tags": ["haskell", "memoization"], "answers": [{"comments": [{"owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "edited": false, "score": 0, "creation_date": 1480410668, "post_id": 40861562, "comment_id": 68939153, "body": "Thanks, it does work well. The solution is very subtle ; how does it prevent GHC to make thunks early?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "edited": false, "score": 0, "creation_date": 1480411847, "post_id": 40861562, "comment_id": 68939917, "body": "Even if we pretend that currying makes all functions just take one argument, that isn&#39;t how it actually works (that would be horribly inefficient). GHC generates functions with as many arguments as you specify and figures out all the currying under the hood with thunks. So there is a distinction between a function that takes 4 arguments and a function that takes 3 arguments and returns a function that takes one argument."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1480432758, "post_id": 40861562, "comment_id": 68954294, "body": "&quot;it isn&#39;t under the hood&quot; the behavior here is likely due to inlining and subsequent simple optimizations (only functions with syntactically fully-applied right hand sides can be inlined), rather than something more spooky about how ghc treats functions."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 4, "last_activity_date": 1480410321, "last_edit_date": 1480410321, "creation_date": 1480410007, "answer_id": 40861562, "question_id": 40861099, "link": "https://stackoverflow.com/questions/40861099/performance-issue/40861562#40861562", "title": "Performance issue", "body": "<p>The problem is indeed related to memoization. The problem is that you call <code>mapDays1</code> and <code>mapDays2</code> without passing them all their arguments, so those calls only create thunks.</p>\n\n<h2>The problem</h2>\n\n<p>That means that the thunks only get completed inside the <code>map</code>, so the different calls to <code>mapDays2</code> can't share their results for <code>d0 = minimum $ map fst ts</code> and <code>d1 = maximum $ map fst ts</code> and <strong>the maximum and minimum get re-evaluated every time</strong>. One could imagine a situation where <code>d0</code> and <code>d1</code> depending on the last <code>Day</code> argument, in which case it would be incorrect <em>not</em> to re-evaluate <code>d0</code> and <code>d1</code> every time.</p>\n\n<p>By contrast, it should be quite clear that <code>mindate = minimum $ map fst ts</code> and <code>maxdate = maximum $ map fst ts</code> need to be calculated only once.</p>\n\n<h2>Fixing <code>mapDays2</code></h2>\n\n<p>Although we like to pretend that <code>f x y = e</code> is the same as <code>f x = \\y -&gt; e</code>, it isn't under the hood. You want GHC to avoid making a thunk when passed all but the last argument. Just move the <code>d</code> over the equal sign. Then, the function you return will calculate only once <code>d0</code> and <code>d1</code>:</p>\n\n<pre><code>-- Day to Double mapping function - slow\nmapDays2 :: TSeries -&gt; Double -&gt; Double -&gt; Day -&gt; Double\nmapDays2 ts x0 x1 = \\d -&gt; mapDays1 (d0,x0) (d1,x1) d\n    where d0 = minimum $ map fst ts\n          d1 = maximum $ map fst ts\n</code></pre>\n"}], "owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 40861562, "answer_count": 1, "score": 5, "last_activity_date": 1480410321, "creation_date": 1480408385, "last_edit_date": 1480408967, "question_id": 40861099, "link": "https://stackoverflow.com/questions/40861099/performance-issue", "title": "Performance issue", "body": "<p>I am working with times series, <code>type TSeries = [(Day, Double)]</code>, but need to translate the first <code>Day</code> element into Double for further processing (eg plots, etc...). </p>\n\n<p>Mapping the date range to a corresponding Double range [lobound, upbound], where the earliest date maps to lobound and the latest date maps to upbound, is a basic transformation. In order to implement it I need first to get the minimum and maximum of the date range. I ran into performance issue, but I am not sure exactly why and how to fix it.</p>\n\n<p>Here is the code (the time-series is not assumed to be sorted):</p>\n\n<pre><code>module Main where\n\nimport Data.Time (Day, fromGregorian, diffDays)\n\ntype TSeries = [(Day, Double)]\n\n-- time-series to (Double, Double) mapping function\ntoDbl :: (Day -&gt; Double) -&gt; TSeries -&gt; [(Double, Double)]\ntoDbl mapX ts = map (\\(d,x) -&gt; (mapX d, x)) ts\n\n-- Day to Double mapping function - fast\nmapDays1 :: (Day, Double) -&gt; (Day, Double) -&gt; Day -&gt; Double\nmapDays1 (d0,x0) (d1,x1) d = ((fromIntegral $ diffDays d d0) * x1 + (fromIntegral $ diffDays d1 d) * x0) / diff10\n    where diff10 = fromIntegral $ diffDays d1 d0\n\n-- Day to Double mapping function - slow\nmapDays2 :: TSeries -&gt; Double -&gt; Double -&gt; Day -&gt; Double\nmapDays2 ts x0 x1 d = mapDays1 (d0,x0) (d1,x1) d\n    where d0 = minimum $ map fst ts\n          d1 = maximum $ map fst ts\n\n-- example time-series\nfunc :: Int -&gt; Double\nfunc d = sin $ pi / 14 * (fromIntegral d)\nts = [(fromGregorian y m d, func d) | y &lt;- [2000..2016], m &lt;- [1..12], d &lt;- [1..28]] :: TSeries\n\n-- speed test\nmain = do\n    let mindate = minimum $ map fst ts\n        maxdate = maximum $ map fst ts\n        test1 = toDbl (mapDays1 (mindate,0.0) (maxdate,100.0)) ts\n        test2 = toDbl (mapDays2 ts 0.0 100.0) ts\n\n    -- print $ sum $ map fst test1 -- this is fast\n    print $ sum $ map fst test2 -- this is slow\n</code></pre>\n\n<p>The test that I perform (summing the X axis, first, elements) is not relevant but it is simple and illustrates the performance issue well.</p>\n\n<p>Essentially mapDays1 and mapDays2 are the same except that in order to get the proper scaling I need to compute the minimum and maximum dates externally and pass them to mapDays1, while this is done \"internally\" within mapDays2. </p>\n\n<p>The issue is that mapDays2 is very slow compared to the mapDays1 version. I suspect that the minimum and maximum calculations are called many times (as opposed to once), but I do not understand why and I am not sure how to fix mapDays2 to get a performance similar to mapDays1.</p>\n"}, {"tags": ["haskell", "code-coverage", "haskell-stack"], "comments": [{"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1480680271, "post_id": 40859405, "comment_id": 69074433, "body": "Is there anything relevant in <a href=\"https://docs.haskellstack.org/en/latest/coverage/\" rel=\"nofollow noreferrer\">the documentation for <code>--coverage</code></a> (may only apply to current dev version of stack)?"}, {"owner": {"reputation": 1070, "user_id": 1461430, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a5f25d8b93603aece2130069a2c759ec?s=128&d=identicon&r=PG", "display_name": "rlpowell", "link": "https://stackoverflow.com/users/1461430/rlpowell"}, "reply_to_user": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1480984305, "post_id": 40859405, "comment_id": 69181071, "body": "If there is, I don&#39;t get it."}, {"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1481044874, "post_id": 40859405, "comment_id": 69211273, "body": "Ok, I&#39;m not very familiar with stack&#39;s coverage functionality. I suggest you make a feature request on the <a href=\"https://github.com/commercialhaskell/stack/issues\" rel=\"nofollow noreferrer\">stack issue tracker</a>, ideally with a sample project that can be used to reproduce the issue. That should also have a good chance of producing a temporary workaround for you."}], "answers": [{"tags": [], "owner": {"reputation": 8047, "user_id": 565879, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/de9dab7c27809643dc51c5193d58429c?s=128&d=identicon&r=PG", "display_name": "Buttons840", "link": "https://stackoverflow.com/users/565879/buttons840"}, "is_accepted": false, "score": 1, "last_activity_date": 1501038889, "creation_date": 1501038889, "answer_id": 45316825, "question_id": 40859405, "link": "https://stackoverflow.com/questions/40859405/in-the-meantime-how-do-i-get-executable-coverage-with-stack/45316825#45316825", "title": "In the meantime, how do I get executable coverage with stack?", "body": "<p>On my computer the .hpc files ended up in <code>.stack-work/dist/x86_64-linux/Cabal-1.24.2.0/hpc/</code> and the .tix file was in the working directory.</p>\n\n<p>This is a bash script I use for testing an executable with no library code:</p>\n\n<pre><code>#!/usr/bin/env bash\nstack build --coverage\nstack exec tests\n\nwhile getopts \":r\" opt; do\n    case $opt in\n        r)\n            hpc markup --hpcdir=.stack-work/dist/x86_64-linux/Cabal-1.24.2.0/hpc/ --destdir=coverage_markup tests.tix\n            firefox coverage_markup/hpc_index.html\n            sleep 120\n    esac\ndone\n\nrm -rf coverage_markup\nrm tests.tix\n</code></pre>\n"}], "owner": {"reputation": 1070, "user_id": 1461430, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a5f25d8b93603aece2130069a2c759ec?s=128&d=identicon&r=PG", "display_name": "rlpowell", "link": "https://stackoverflow.com/users/1461430/rlpowell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1501038889, "creation_date": 1480402000, "last_edit_date": 1480477731, "question_id": 40859405, "link": "https://stackoverflow.com/questions/40859405/in-the-meantime-how-do-i-get-executable-coverage-with-stack", "title": "In the meantime, how do I get executable coverage with stack?", "body": "<p>My program consists of 4 executables, and basically zero library code.  My tests work by running the executables with various input files.</p>\n\n<p>\"stack test --coverage\" apparently doesn't handle executables.  OK, fine, but I can't figure out how to do it \"by hand\", as it were.</p>\n\n<p>I've tried adding -fhpc to my cabal files, and it appears to work:</p>\n\n<pre><code>  /home/rlpowell/.stack/programs/x86_64-linux/ghc-8.0.1/lib/ghc-8.0.1/bin/ghc -B/home/rlpowell/.stack/programs/x86_64-linux/ghc-8.0.1/lib/ghc-8.0.1 --make -no-link -fbuilding-cabal-package -O -static -outputdir .stack-work/dist/x86_64-linux/Cabal-1.24.0.0/build/unphone/unphone-tmp -odir .stack-work/dist/x86_64-linux/Cabal-1.24.0.0/build/unphone/unphone-tmp -hidir .stack-work/dist/x86_64-linux/Cabal-1.24.0.0/build/unphone/unphone-tmp -stubdir .stack-work/dist/x86_64-linux/Cabal-1.24.0.0/build/unphone/unphone-tmp -i -i.stack-work/dist/x86_64-linux/Cabal-1.24.0.0/build/unphone/unphone-tmp -iapp -i.stack-work/dist/x86_64-linux/Cabal-1.24.0.0/build/autogen -I.stack-work/dist/x86_64-linux/Cabal-1.24.0.0/build/autogen -I.stack-work/dist/x86_64-linux/Cabal-1.24.0.0/build/unphone/unphone-tmp -optP-include -optP.stack-work/dist/x86_64-linux/Cabal-1.24.0.0/build/autogen/cabal_macros.h -hide-all-packages -no-user-package-db -package-db /home/rlpowell/.stack/snapshots/x86_64-linux/lts-7.4/8.0.1/pkgdb -package-db /dropbox/src/hblog/.stack-work/install/x86_64-linux/lts-7.4/8.0.1/pkgdb -package-db .stack-work/dist/x86_64-linux/Cabal-1.24.0.0/package.conf.inplace -package-id base-4.9.0.0 -package-id directory-1.2.6.2 -package-id filemanip-0.3.6.3-DFENeGbODv96RwGywUxkEu -package-id filepath-1.4.1.0 -package-id hblog-0.1.0.0-5BseEsncIi47yHhFL2tGbM -package-id pcre-heavy-1.0.0.2-ncNpc9J5vG8YMUKvU47xG -package-id pcre-light-0.4.0.4-IQAaYrFkWFB49U9V8o5b8j -package-id unix-2.7.2.0 -XHaskell2010 app/unphone.hs -threaded -Wall -fhpc -Wall -fhpc -ddump-hi -ddump-to-file\n</code></pre>\n\n<p>but after running the programs thus generated, I can't find a .hpc directory or any .tix files.</p>\n"}, {"tags": ["debugging", "haskell", "bittorrent"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480389524, "post_id": 40857017, "comment_id": 68930826, "body": "I guess this is slightly off topic from the question, but given you are working with binary data, using <code>readFile</code> and <code>String</code> might not be the best idea. I&#39;d stick to <a href=\"https://hackage.haskell.org/package/bytestring-0.10.8.1/docs/Data-ByteString.html\" rel=\"nofollow noreferrer\"><code>ByteString</code></a> instead, and all its corresponding functions (it has a version of <a href=\"http://hackage.haskell.org/package/bytestring-0.10.8.1/docs/Data-ByteString-Char8.html#v:readFile\" rel=\"nofollow noreferrer\"><code>readFile</code></a> too)."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480389741, "post_id": 40857017, "comment_id": 68930878, "body": "Also, trying out your code with the file specified in point 2 gives me <code>hGetContents: invalid argument (invalid byte sequence)</code> (which is probably related to my first comment). What output are you seeing?"}, {"owner": {"reputation": 1247, "user_id": 3169543, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7416c0dca5630ff1c31b955e185e955b?s=128&d=identicon&r=PG&f=1", "display_name": "user3169543", "link": "https://stackoverflow.com/users/3169543/user3169543"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480390491, "post_id": 40857017, "comment_id": 68931073, "body": "I had tried this a windows machine. Not sue if that would matter, let me try this out on a different OS and get back. Thanks."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1480390574, "post_id": 40857017, "comment_id": 68931103, "body": "I usually debug by simplification.  I&#39;ve never really parsed binary data, but I&#39;d get one of those real world torrents and simplify it little by little until my parser passes.  That will show me what kind of thing it&#39;s failing on, and how to take the next step.  Haskell doesn&#39;t really have a usable &quot;debugger&quot; like imperative languages often do, unfortunately (lazy evaluation makes it very hard to give a good experience here)."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480390879, "post_id": 40857017, "comment_id": 68931181, "body": "@user3169543 Oh darn. I know the problem. I think most windows machines default to latin1 encoding while most *nix default to utf8. <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/System-IO.html#v:hSetEncoding\" rel=\"nofollow noreferrer\">Changing the encoding</a> fixed it. I&#39;ve hit myself on this one a couple times."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480391877, "post_id": 40857017, "comment_id": 68931416, "body": "@user3169543 Do you have a specific example that does not work with your parser?"}, {"owner": {"reputation": 1247, "user_id": 3169543, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7416c0dca5630ff1c31b955e185e955b?s=128&d=identicon&r=PG&f=1", "display_name": "user3169543", "link": "https://stackoverflow.com/users/3169543/user3169543"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480393109, "post_id": 40857017, "comment_id": 68931678, "body": "@Alec : Debian: debian-8.6.0-amd64-CD-1.iso.torrent  Same torrent on OS-X work! while on Windows it fails! Can not edit the question, pls see my next comment."}, {"owner": {"reputation": 1247, "user_id": 3169543, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7416c0dca5630ff1c31b955e185e955b?s=128&d=identicon&r=PG&f=1", "display_name": "user3169543", "link": "https://stackoverflow.com/users/3169543/user3169543"}, "edited": false, "score": 0, "creation_date": 1480393301, "post_id": 40857017, "comment_id": 68931724, "body": "14    handle &lt;- openFile fileName ReadMode                                                                          15    hSetEncoding handle latin1                                                                                    16    contents &lt;- hGetContents handle                                                                               17    download . parse $ contents                                                                                   18    hClose handle"}, {"owner": {"reputation": 1247, "user_id": 3169543, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7416c0dca5630ff1c31b955e185e955b?s=128&d=identicon&r=PG&f=1", "display_name": "user3169543", "link": "https://stackoverflow.com/users/3169543/user3169543"}, "edited": false, "score": 0, "creation_date": 1480393336, "post_id": 40857017, "comment_id": 68931740, "body": "with the changes above, I&#39;m able to see this decoded on OS-X, but fails on Windows!, need to figure out the right encoding?"}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 3, "last_activity_date": 1480393741, "creation_date": 1480393741, "answer_id": 40857840, "question_id": 40857017, "link": "https://stackoverflow.com/questions/40857017/debugging-a-haskell-application/40857840#40857840", "title": "debugging a Haskell application", "body": "<p>Because Haskell code is pure, \"stepping\" through it is less essential than in other languages. When I step through some Java code, I am often trying to see where a certain variable gets changed. That is obviously a non-issue in Haskell given that things are immutable.</p>\n\n<p>That means we can also run snippets of code in GHCi to debug what is happening without worrying that what we run is going to change some global state, or what we run will work any differently than how it would if called deep inside our program. This mode of work benefits from iterating your design slowly building it to work on the full range of expected inputs.</p>\n\n<p>Parsing is always a bit unpleasant - even in imperative languages. Nobody wants to run a parser just to get back <code>Nothing</code> - you want to know <em>why</em> you got back nothing. To that effect, most parsers libraries are helpful in giving you some information about what went wrong. That is a point for using a parser like <a href=\"https://hackage.haskell.org/package/attoparsec-0.13.1.0\" rel=\"nofollow noreferrer\"><code>attoparsec</code></a>. Also, <code>attoparsec</code> works with <a href=\"https://hackage.haskell.org/package/bytestring-0.10.8.1\" rel=\"nofollow noreferrer\"><code>ByteString</code></a> by default - perfect for binary data. If you want to roll your own parser implementation, you'll have to debug it too.</p>\n\n<p>Finally, based on your comments, it looks like you are having issues with character encodings. This is exactly the reason why we have <a href=\"https://hackage.haskell.org/package/bytestring-0.10.8.1\" rel=\"nofollow noreferrer\"><code>ByteString</code></a> - it represents a packed sequence of bytes - no encodings. The extension <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#overloaded-string-literals\" rel=\"nofollow noreferrer\"><code>OverloadedStrings</code></a> even makes it pretty easy to make <code>ByteString</code> literals that look just like regular strings.</p>\n"}], "owner": {"reputation": 1247, "user_id": 3169543, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7416c0dca5630ff1c31b955e185e955b?s=128&d=identicon&r=PG&f=1", "display_name": "user3169543", "link": "https://stackoverflow.com/users/3169543/user3169543"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 1, "accepted_answer_id": 40857840, "answer_count": 1, "score": 4, "last_activity_date": 1480393741, "creation_date": 1480388068, "question_id": 40857017, "link": "https://stackoverflow.com/questions/40857017/debugging-a-haskell-application", "title": "debugging a Haskell application", "body": "<p>After learning few basics I wanted to try a \"real world application\" in Haskell, started with a Bittorrent client. Following through the explanation from this <a href=\"https://blog.chaps.io/2015/10/05/torrent-client-in-haskell-1.html\" rel=\"nofollow noreferrer\">blog post</a>, I did NOT use the <a href=\"https://hackage.haskell.org/package/attoparsec\" rel=\"nofollow noreferrer\">Attoparsec parser combinator</a> library. Instead following through <a href=\"https://rads.stackoverflow.com/amzn/click/com/1316626229\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">Huttons book</a>, I started writing the Parser Combinators. This is the code that I have so far (Still at the parsing stage, a long journey ahead):</p>\n\n<pre><code>module Main where\n\nimport System.Environment (getArgs)\nimport qualified Data.Map as Map\nimport Control.Monad (liftM, ap)\nimport Data.Char (isDigit, isAlpha, isAlphaNum, ord)\nimport Data.List(foldl')\n\nmain :: IO ()\nmain = do\n    [fileName] &lt;- getArgs\n    contents &lt;- readFile fileName\n    download . parse $ contents\n\nparse :: String -&gt; Maybe BenValue\nparse s = case runParser value s of\n    []       -&gt; Nothing\n    [(p, _)] -&gt; Just p\n\ndownload :: Maybe BenValue -&gt; IO ()\ndownload (Just p) = print p\ndownload _        = print \"Oh!! Man!!\"\n\ndata BenValue = BenString String\n    | BenNumber Integer\n    | BenList [BenValue]\n    | BenDict (Map.Map String BenValue)\n    deriving(Show, Eq)\n\n-- From Hutton, this follows: a Parser is a function \n-- that takes a string and returns a list of results\n-- each containing a pair : a result of type a and \n-- an output string. (the string is the unconsumed part of the input).\nnewtype Parser a = Parser (String -&gt; [(a, String)])\n\n-- Unit takes a value and returns a Parser (a function)\nunit :: a -&gt; Parser a\nunit v = Parser (\\inp -&gt; [(v, inp)])\n\nfailure :: Parser a\nfailure = Parser (\\inp -&gt; [])\n\none :: Parser Char\none = Parser $ \\inp -&gt; case inp of\n        []      -&gt; []\n        (x: xs) -&gt; [(x, xs)]\n\nrunParser :: Parser a -&gt; String -&gt; [(a, String)]\nrunParser (Parser p) inp = p inp\n\nbind :: Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b\nbind (Parser p) f = Parser $ \\inp -&gt; case p inp of\n    []         -&gt; []\n    [(v, out)] -&gt; runParser (f v) out\n\ninstance Monad Parser where\n    return  = unit\n    p &gt;&gt;= f = bind p f\n\ninstance Applicative Parser where\n    pure  = unit\n    (&lt;*&gt;) = ap\n\ninstance Functor Parser where\n    fmap = liftM\n\nchoice :: Parser a -&gt; Parser a -&gt; Parser a\nchoice p q = Parser $ \\inp -&gt; case runParser p inp of\n    [] -&gt; runParser q inp\n    x  -&gt; x\n\nsatisfies :: (Char -&gt; Bool) -&gt; Parser Char\nsatisfies p = do\n    x &lt;- one\n    if p x \n    then unit x\n    else failure\n\ndigit :: Parser Char\ndigit = satisfies isDigit\n\nletter :: Parser Char\nletter = satisfies isAlpha\n\nalphanum :: Parser Char\nalphanum = satisfies isAlphaNum\n\nchar :: Char -&gt; Parser Char\nchar x = satisfies (== x)\n\nmany :: Parser a -&gt; Parser [a]\nmany p = choice (many1 p) (unit [])\n\nmany1 :: Parser a -&gt; Parser [a]\nmany1 p = do\n    v &lt;- p\n    vs &lt;- many p\n    unit (v:vs)\n\npeek :: Parser Char\npeek = Parser $ \\inp -&gt; case inp of\n    []       -&gt; []\n    v@(x:xs) -&gt; [(x, v)]    \n\ntaken :: Int -&gt; Parser [Char]\ntaken n = do\n    if n &gt; 0\n    then do\n        v &lt;- one\n        vs &lt;- taken (n-1)\n        unit (v:vs)\n    else unit []\n\ntakeWhile1 :: (Char -&gt; Bool) -&gt; Parser [Char]\ntakeWhile1 pred = do\n    v &lt;- peek\n    if pred v\n    then do\n        one\n        vs &lt;- takeWhile1 pred\n        unit (v:vs)\n    else unit []\n\ndecimal :: Integral a =&gt; Parser a\ndecimal = foldl' step 0 `fmap` takeWhile1 isDigit\n    where step a c = a * 10 + fromIntegral (ord c - 48)\n\nstring :: Parser BenValue\nstring = do\n    n &lt;- decimal\n    char ':'\n    BenString &lt;$&gt; taken n\n\nsigned :: Num a =&gt; Parser a -&gt; Parser a\nsigned p = (negate &lt;$&gt; (char '-' *&gt; p) )\n    `choice` (char '+' *&gt; p)\n    `choice` p\n\nnumber :: Parser BenValue\nnumber = BenNumber &lt;$&gt; (char 'i' *&gt; (signed decimal) &lt;* char 'e')\n\nlist :: Parser BenValue\nlist = BenList &lt;$&gt; (char 'l' *&gt; (many value) &lt;* char 'e')\n\ndict :: Parser BenValue\ndict = do\n    char 'd'\n    pair &lt;- many ((,) &lt;$&gt; string &lt;*&gt; value)\n    char 'e'\n    let pair' = (\\(BenString s, v) -&gt; (s,v)) &lt;$&gt; pair\n    let map' = Map.fromList pair'\n    unit $ BenDict map'\n\nvalue = string `choice` number `choice` list `choice` dict\n</code></pre>\n\n<p>The above is a mix of code read/understood from the source code of the three sources <a href=\"https://blog.chaps.io/2015/10/05/torrent-client-in-haskell-1.html\" rel=\"nofollow noreferrer\">the blog</a>, <a href=\"https://hackage.haskell.org/package/attoparsec\" rel=\"nofollow noreferrer\">the library</a>, and <a href=\"https://rads.stackoverflow.com/amzn/click/com/1316626229\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">the book</a>. the <code>download</code> function just prints the \"parse tree\", obtained from the parser, Once I get the parser working will fill in the <code>download</code> function and test it out. </p>\n\n<ol>\n<li>The parser is NOT working on few of the torrent files. :( There is definitely  chance that I might have used code from the references incorrectly. And would like to know if there is anything obvious.</li>\n<li>It works on \"toy\" examples and also on the test file picked from <a href=\"https://github.com/jlouis/combinatorrent/blob/master/testsuite/testfile.txt.torrent\" rel=\"nofollow noreferrer\">combinatorrent</a></li>\n<li>When I pick a real world torrent like the Debian/Ubuntu etc, this fails.</li>\n<li>I would like to debug and see what is happening, debugging with  GHCI does not seem straight forward, I've tried <code>:trace</code> / <code>:history</code> style debugging mentioned in this <a href=\"https://downloads.haskell.org/~ghc/7.6.2/docs/html/users_guide/ghci-debugger.html\" rel=\"nofollow noreferrer\">document</a>, but looks very primitive :-) .</li>\n<li>My question to the experts out there is: \"how to debug!!\" :-) </li>\n<li>Would really appreciate any hints on approaching how to debug this.</li>\n</ol>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell", "callstack"], "answers": [{"comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1480378373, "post_id": 40855696, "comment_id": 68927966, "body": "Ahh, of course, that makes sense. My intuition about implicit parameters in Haskell is clearly not the best, since this would apply to any implicit parameter, not just <code>HasCallStack</code>. Anyway, thank you."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1480378614, "post_id": 40855696, "comment_id": 68928037, "body": "Almost, but not quite. With a normal implicit parameter, you would get an error if it is not explicitly bound where you stop using the constraint. But with <code>HasCallStack</code> the compiler detects that and magically binds the initial call stack."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1480378733, "post_id": 40855696, "comment_id": 68928072, "body": "Aha, yes, that makes sense\u2014you\u2019re right again. :) The magical nature of <code>HasCallStack</code> is certainly a little confusing. I still don\u2019t think I completely understand the intricacies of how <code>HasCallStack</code> constraints are inferred, but fortunately that doesn\u2019t seem to be too much of an issue for me in practice, haha."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1480381475, "post_id": 40855696, "comment_id": 68928810, "body": "@AlexisKing The documentation <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/GHC-Stack.html#t:CallStack\" rel=\"nofollow noreferrer\">here</a> describes this particular magic."}], "tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": true, "score": 2, "last_activity_date": 1480378182, "creation_date": 1480378182, "answer_id": 40855696, "question_id": 40855484, "link": "https://stackoverflow.com/questions/40855484/why-does-hascallstack-still-add-stack-frames-when-using-withfrozencallstack/40855696#40855696", "title": "Why does HasCallStack still add stack frames when using withFrozenCallStack?", "body": "<p>In your code, <code>foo</code> is a static value of type <code>CallStack</code>. Note that it does <em>not</em> have an <code>HasCallStack</code> constraint.</p>\n\n<p>It does not matter how and where you use <code>foo</code>, it will always refer to this particular <code>CallStack</code>. It does not matter that <code>foo</code> itself is defined using <code>bar</code> which uses the <code>HasCallStack</code> machinery \u2013 you could just statically define <code>foo = [(\"bar\",\u2026</code>.</p>\n\n<p>Try adding <code>HasCallStack =&gt;</code> to <code>foo</code>\u2019s type signature. Does it now behave the way you expect?</p>\n"}], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 668, "favorite_count": 2, "accepted_answer_id": 40855696, "answer_count": 1, "score": 7, "last_activity_date": 1480378207, "creation_date": 1480376835, "last_edit_date": 1480378207, "question_id": 40855484, "link": "https://stackoverflow.com/questions/40855484/why-does-hascallstack-still-add-stack-frames-when-using-withfrozencallstack", "title": "Why does HasCallStack still add stack frames when using withFrozenCallStack?", "body": "<p>GHC 8 provides <code>HasCallStack</code> from the <code>GHC.Stack</code> module, which allows functions to request a stack frame be recorded when they are called. It also provides the <code>withFrozenCallStack</code> function, which \u201cfreezes\u201d the call stack so that no further frames can be added to it.</p>\n\n<p>In simple scenarios, this works as I would expect. For example:</p>\n\n<pre><code>ghci&gt; let foo :: HasCallStack =&gt; CallStack\n          foo = callStack\nghci&gt; foo\n[(\"foo\",SrcLoc {srcLocPackage = \"interactive\", srcLocModule = \"Ghci2\", srcLocFile = \"&lt;interactive&gt;\", srcLocStartLine = 8, srcLocStartCol = 1, srcLocEndLine = 8, srcLocEndCol = 4})]\nghci&gt; withFrozenCallStack foo\n[]\n</code></pre>\n\n<p>When I call <code>foo</code> normally, I get a stack frame, but when I wrap it with <code>withFrozenCallStack</code>, I don\u2019t. Perfect. However, when the example gets only slightly more complicated, it stops behaving like I expect:</p>\n\n<pre><code>ghci&gt; let foo :: CallStack\n          foo = bar\n          bar :: HasCallStack =&gt; CallStack\n          bar = callStack\nghci&gt; foo\n[(\"bar\",SrcLoc {srcLocPackage = \"interactive\", srcLocModule = \"Ghci9\", srcLocFile = \"&lt;interactive&gt;\", srcLocStartLine = 24, srcLocStartCol = 11, srcLocEndLine = 24, srcLocEndCol = 14})]\nghci&gt; withFrozenCallStack foo\n[(\"bar\",SrcLoc {srcLocPackage = \"interactive\", srcLocModule = \"Ghci9\", srcLocFile = \"&lt;interactive&gt;\", srcLocStartLine = 24, srcLocStartCol = 11, srcLocEndLine = 24, srcLocEndCol = 14})]\n</code></pre>\n\n<p>By adding this simple layer of indirection, the stack frame still gets included, despite my use of <code>withFrozenCallStack</code>. Why?</p>\n\n<p>Conceptually, my understanding of <code>HasCallStack</code> is that it is like an implicit use of <code>pushCallStack</code> on the current call stack, and <code>pushCallStack</code> has no effect on a frozen call stack. Why, then, does <code>withFrozenCallStack</code> not prevent the above stack frame from being added to the call stack?</p>\n"}, {"tags": ["haskell", "ghc", "typeclass"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1480353693, "post_id": 40849936, "comment_id": 68916551, "body": "Out of curiosity, does it work if you change the <code>m</code> in the default signature to another type variable, like <code>n</code>, or add an explicit <code>forall</code>? I\u2019m wondering if GHC is treating <code>m</code> as a scoped type variable here for some reason."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1480353697, "post_id": 40849936, "comment_id": 68916555, "body": "Your code also typechecks in the stable release of GHC 8.0.1 ."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 2, "creation_date": 1480354286, "post_id": 40849936, "comment_id": 68916885, "body": "@AlexisKing, that&#39;s essentially the issue. Occurrences of the head of the class declaration (here <code>m</code>) are always scoped in the body, otherwise there would be no relation between <code>m</code> and the type of the methods!"}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1480354994, "post_id": 40849936, "comment_id": 68917283, "body": "@ReidBarton Right, of course, that makes sense\u2014it seems obvious in retrospect. :)"}], "answers": [{"tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 9, "last_activity_date": 1480353741, "creation_date": 1480353741, "answer_id": 40850053, "question_id": 40849936, "link": "https://stackoverflow.com/questions/40849936/why-does-this-code-that-type-checked-in-ghc-7-10-no-longer-type-check-in-ghc-8-0/40850053#40850053", "title": "Why does this code that type-checked in GHC 7.10 no longer type check in GHC 8.0.1?", "body": "<p>Despite GHC 7.10 accepting it, your code actually makes no sense. See <a href=\"https://ghc.haskell.org/trac/ghc/ticket/12784\" rel=\"nofollow noreferrer\">https://ghc.haskell.org/trac/ghc/ticket/12784</a> for discussion.</p>\n"}], "owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 40850053, "answer_count": 1, "score": 10, "last_activity_date": 1480353741, "creation_date": 1480353378, "question_id": 40849936, "link": "https://stackoverflow.com/questions/40849936/why-does-this-code-that-type-checked-in-ghc-7-10-no-longer-type-check-in-ghc-8-0", "title": "Why does this code that type-checked in GHC 7.10 no longer type check in GHC 8.0.1?", "body": "<p>I have the following code:</p>\n\n<pre><code>{-# LANGUAGE DefaultSignatures#-}\n\nimport Control.Monad.Trans.Class\nimport Control.Monad.Trans.Maybe\n\nclass Monad m =&gt; MonadMaybe m where\n  liftMaybe :: Maybe a -&gt; m a\n  default liftMaybe :: (MonadTrans t, MonadMaybe m) =&gt; Maybe a -&gt; t m a\n  liftMaybe = lift . liftMaybe\n\ninstance MonadMaybe m =&gt; MonadMaybe (MaybeT m)\n</code></pre>\n\n<p>Using The Glorious Glasgow Haskell Compilation System, version 8.0.1.20161117, this fails to compile:</p>\n\n<pre><code>foo.hs:11:10: error:\n    \u2022 Couldn't match type \u2018m\u2019 with \u2018MaybeT m\u2019\n      \u2018m\u2019 is a rigid type variable bound by\n        the instance declaration at foo.hs:11:10\n      Expected type: Maybe a -&gt; MaybeT m a\n        Actual type: Maybe a -&gt; MaybeT (MaybeT m) a\n    \u2022 In the expression: Main.$dmliftMaybe @MaybeT m\n      In an equation for \u2018liftMaybe\u2019:\n          liftMaybe = Main.$dmliftMaybe @MaybeT m\n      In the instance declaration for \u2018MonadMaybe (MaybeT m)\u2019\n    \u2022 Relevant bindings include\n        liftMaybe :: Maybe a -&gt; MaybeT m a (bound at foo.hs:11:10)\n</code></pre>\n\n<p>However in GHC 7.10, this compiles without a problem.</p>\n\n<p>Is GHC 8 correct, or have I found a bug?</p>\n"}, {"tags": ["algorithm", "haskell", "time-complexity", "big-o"], "answers": [{"tags": [], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "is_accepted": true, "score": 3, "last_activity_date": 1480355592, "last_edit_date": 1480355592, "creation_date": 1480355069, "answer_id": 40850407, "question_id": 40849893, "link": "https://stackoverflow.com/questions/40849893/analysing-running-time-big-o/40850407#40850407", "title": "Analysing running time, Big O", "body": "<p><code>isSorted</code> is indeed <code>O(n)</code>, since it's dominated by <code>zipWith</code> which in turn is <code>O(n)</code> since it does a linear pass over its argument.</p>\n\n<p><code>check</code> itself is <code>O(n)</code>, since it only calls itself once per execution, and it always removes a constant number of elements from the list. The fastest sorting algorithm (without knowing something more about the list) runs in <code>O(n*log(n))</code> (equivalent to <code>O(log(n!))</code> time). There's a mathematical proof of this, and this algorithm is faster, so it cannot possibly be sorting the whole list.</p>\n\n<p><code>check</code> only moves things one step; it's effectively a single pass of bubble sort. </p>\n\n<p>Consider sorting this list: <code>[3,2,1]</code></p>\n\n<pre><code>check [3,2,1] = 2:(check [3,1]) -- since 3 &gt; 2\ncheck [3,1] = 1:(check [3]) -- since 3 &gt; 1\ncheck [3] = [3] \n</code></pre>\n\n<p>which would return the \"sorted\" list <code>[2,1,3]</code>. </p>\n\n<p>Then, as long as the list is not sorted, we loop. Since we might only put one element in its correct position (as <code>3</code> did in the example above), we might need <code>O(n)</code> loop iterations.</p>\n\n<p>This totals at a time complexity of <code>O(n) * O(n) = O(n^2)</code></p>\n"}, {"tags": [], "owner": {"reputation": 17464, "user_id": 2040251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UsW2G.jpg?s=128&g=1", "display_name": "kraskevich", "link": "https://stackoverflow.com/users/2040251/kraskevich"}, "is_accepted": false, "score": 1, "last_activity_date": 1480355609, "creation_date": 1480355609, "answer_id": 40850553, "question_id": 40849893, "link": "https://stackoverflow.com/questions/40849893/analysing-running-time-big-o/40850553#40850553", "title": "Analysing running time, Big O", "body": "<p>The time complexity is <code>O(n^2)</code>. </p>\n\n<p>You're right, one step takes <code>O(n)</code> time (for both <code>isSorted</code> and <code>check</code> functions). It is called no more than <code>n</code> times (maybe even <code>n - 1</code>, it doesn't really matter for time complexity) (after the first call the largest element is guaranteed to be the last one, the same is the case for the second largest after the second call. We can prove that the last <code>k</code> elements are the largest and sorted properly after <code>k</code> calls). It swaps only adjacent elements, so it removes at most one inversion per step. As the number of inversions is <code>O(n^2)</code> in the worst case (namely, <code>n * (n - 1) / 2</code>), the time complexity is <code>O(n^2)</code>. </p>\n"}], "owner": {"reputation": 99, "user_id": 6414566, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5ed1971c96d5d73a8d964ea4c8a99799?s=128&d=identicon&r=PG&f=1", "display_name": "SOAP", "link": "https://stackoverflow.com/users/6414566/soap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 40850407, "answer_count": 2, "score": 1, "last_activity_date": 1480355609, "creation_date": 1480353238, "question_id": 40849893, "link": "https://stackoverflow.com/questions/40849893/analysing-running-time-big-o", "title": "Analysing running time, Big O", "body": "<p>I am having problems with anyalysing the  time complexity of an algorithm. </p>\n\n<p>For example the following Haskell code, which will sort a list.</p>\n\n<pre><code>sort xs\n|isSorted xs= xs\n|otherwise= sort (check xs)\n    where \n    isSorted xs=all (==True) (zipWith (&lt;=) xs ( drop 1 xs))\n    check [] =[]\n    check [x]=[x]\n    check (x:y:xs) \n        |x&lt;=y = x:check (y:xs)\n        |otherwise=y:check (x:xs)\n</code></pre>\n\n<p>So for n being the length of the list and  t_isSorted(n) the running time function:  there is an constant t_drop(n) =c and t_all(n)=n, t_zipWith(n)=n :</p>\n\n<pre><code>   t_isSorted(n)= c + n +n\n</code></pre>\n\n<p>For t_check:</p>\n\n<pre><code>   t_check(1)=c1\n\n   t_check(n)=c2 + t_check(n-1), c2= for comparing and changing an element\n          .\n          .\n          .\n   t_check(n)=i*c2 + tcheck_(n-i), with i=n-1\n            =(n-1)*c2 + t_check(1)\n            =n*c2 - c2 + c1\n</code></pre>\n\n<p>And how exactly do I have to combine those to get t_sort(n)? I guess in the worst- case, sort xs has to run n-1 times.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1480354900, "post_id": 40849692, "comment_id": 68917222, "body": "You are missing a big opportunity to simplify your code. You do not need to check explicitly what values <code>initAdd</code> and <code>normalAdd</code> have; just define <code>fm = \\add -&gt; followMenu crib (tail menu) add offsets</code>, then call <code>fmap fm initAdd</code> and <code>fmap fm normalAdd</code> depending on the length of <code>stecker</code>."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1480388200, "post_id": 40849692, "comment_id": 68930531, "body": "Also pattern matching on <code>stecker</code> instead of checking length and indexing will clean things up too, I think it will even address your question."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7183869"}, "edited": false, "score": 1, "creation_date": 1480355242, "post_id": 40850028, "comment_id": 68917424, "body": "When I try a 2 element <code>stecker</code> it works fine but when I try 1 element <code>stecker</code>, I got this error <code>*** Exception: Prelude.!!: index too large</code> so I guess it&#39;s because of <code>(filter (\\(a,b) -&gt; b == cipherChar0) stecker)!!0</code> returns an empty list for 1 element <code>stecker</code>"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1480355785, "post_id": 40850028, "comment_id": 68917701, "body": "Well that&#39;s impossible if you really don&#39;t use <code>enigmaInput</code> in either of the first two cases. It&#39;s more likely one of the many other uses of <code>!!</code> in your program."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 1, "last_activity_date": 1480353669, "creation_date": 1480353669, "answer_id": 40850028, "question_id": 40849692, "link": "https://stackoverflow.com/questions/40849692/where-clause-for-particular-guard/40850028#40850028", "title": "Where clause for particular guard", "body": "<p>You don't really need to, since <code>(filter (\\(a,b) -&gt; b == cipherChar0) stecker)!!0</code> won't be evaluated until the value of <code>enigmaInput</code> is needed, and you don't use <code>enigmaInput</code> in the first two guard cases. This is a nice feature of lazy evaluation.</p>\n\n<p>There is no way to attach a <code>where</code> clause to some but not all of a set of guarded equations, besides restructuring your pattern matches and guards of course.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7183869"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 40850028, "answer_count": 1, "score": 1, "last_activity_date": 1480354032, "creation_date": 1480352536, "last_edit_date": 1480354032, "question_id": 40849692, "link": "https://stackoverflow.com/questions/40849692/where-clause-for-particular-guard", "title": "Where clause for particular guard", "body": "<p>I have a piece of Haskell code below. The problem is the clause <code>(enigmaInput,_) = (filter (\\(a,b) -&gt; b == cipherChar0) stecker)!!0</code> will fail for the first 2 guards. How can I assign it for the last 2 guards only. Thanks!</p>\n\n<pre><code> followMenu :: Crib-&gt;Menu-&gt;Stecker-&gt;Offsets-&gt;Maybe Stecker\n followMenu c [] s o = Just s\n followMenu crib menu stecker offsets \n  | (length stecker) == 1 &amp;&amp; initAdd == Nothing = Nothing\n  | (length stecker) == 1 &amp;&amp; initAdd /= Nothing = followMenu crib (tail menu) (fromMb initAdd) offsets\n  | (length stecker) /= 1 &amp;&amp; normalAdd == Nothing = Nothing\n  | otherwise = followMenu crib (tail menu) (fromMb normalAdd) offsets\n  where (_,_,cipherChar0) =  crib!!(menu!!0)\n        (_,_,cipherChar1) =  crib!!(menu!!1)\n        (enigmaInput,_) = (filter (\\(a,b) -&gt; b == cipherChar0) stecker)!!0\n        enigmaOutput = enigmaEncode enigmaInput (SimpleEnigma rotor3 rotor2 rotor1 reflector1) offsets\n        (_,initInput) = stecker!!0\n        initOutput = enigmaEncode initInput (SimpleEnigma rotor3 rotor2 rotor1 reflector1) offsets\n        (_,_,initCipher) = crib!!(menu!!0)\n        initAdd = steckerAdd initOutput initCipher stecker\n        normalAdd = steckerAdd enigmaOutput cipherChar1 stecker\n</code></pre>\n"}, {"tags": ["sorting", "haskell"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1480345742, "post_id": 40847373, "comment_id": 68911556, "body": "There is no <code>Name</code> field in <code>FS</code>. Your implementation of <code>orderFS</code> suggests you intend <code>FS</code> to be a union instead of a record?"}, {"owner": {"reputation": 3370, "user_id": 722938, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MtO4E.jpg?s=128&g=1", "display_name": "is7s", "link": "https://stackoverflow.com/users/722938/is7s"}, "edited": false, "score": 0, "creation_date": 1480350347, "post_id": 40847373, "comment_id": 68914477, "body": "I don&#39;t see any reason for this question, in its current form, to be downvoted."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 3370, "user_id": 722938, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MtO4E.jpg?s=128&g=1", "display_name": "is7s", "link": "https://stackoverflow.com/users/722938/is7s"}, "edited": false, "score": 0, "creation_date": 1480351729, "post_id": 40847373, "comment_id": 68915393, "body": "@is7s, I suspect it&#39;s a reaction to the <code>Prelude</code>-only requirement, which tends to signal that the OP wants us to do their homework for them."}, {"owner": {"reputation": 85, "user_id": 4061741, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-jTyCiIFoD0g/AAAAAAAAAAI/AAAAAAAAC-o/3StRToY78t4/photo.jpg?sz=128", "display_name": "Chapi", "link": "https://stackoverflow.com/users/4061741/chapi"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1480366876, "post_id": 40847373, "comment_id": 68923520, "body": "@dfeuer I don&#39;t understand what&#39;s with people getting pissed if a question comes from homework.. This is a site for people to ask questions on subjects they couldn&#39;t find the answer for, weather the question came from a homework problem, a text book or simply someone trying to code something in Haskell. Yes, this question came to me from homework but instead of copying some quicksort code from the internet I rather ask here for an actual explanation on how the solution could be achieved."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1480379702, "post_id": 40847373, "comment_id": 68928324, "body": "@Chapi, the problem is not that the question arose in the process of you doing your homework. The problems is that you recognized that the key challenge was writing a sorting function, and then you stopped short. You give no indication of what your attempts to overcome this challenge looked like. If you&#39;d posted a buggy or incomplete sorting routine, and explained why it was buggy or what trouble you were having completing it, then the question would have been much better received. Instead, you posted all sorts of irrelevant information about why you wanted a list-sorting function."}], "answers": [{"tags": [], "owner": {"reputation": 1435, "user_id": 6676199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21f60cb3880bf43a7c74ffeecbf996e1?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Amidon", "link": "https://stackoverflow.com/users/6676199/peter-amidon"}, "is_accepted": true, "score": 1, "last_activity_date": 1480351143, "last_edit_date": 1480351143, "creation_date": 1480350502, "answer_id": 40849111, "question_id": 40847373, "link": "https://stackoverflow.com/questions/40847373/sort-file-system-data-without-using-anything-else-than-prelude/40849111#40849111", "title": "Sort file system data without using anything else than Prelude", "body": "<p>I do not believe that there are any sorting functions in Prelude but not in a module like <code>Data.List</code>.  Note that <code>Data.List</code> is in the base package that is part of GHC, so in basically any situation where <code>Prelude</code> is available, I would imagine that <code>Data.List</code> would be as well---you shouldn't need to download/include any other packages in order to use it.</p>\n\n<p>That said, if you do want to write your own sorting function, you are probably best off taking an existing simple sorting algorithm and using it.  There are very neat/simple ways of writing quicksorts and merge sorts in Haskell, although the obvious implementations sometimes don't have the same exact performance characteristics as you would expect.  Merge sort, for example, has roughly the same asymptotics, but partitioning the list into two actually takes some time, since the list is singly-linked and you therefore have to walk through half of it in order to split it.  But, it can be a very nice short function that looks a lot like the algorithm, and is probably worth doing as a learning exercise.</p>\n\n<p>Also, I noticed that you are defining your <code>Ext</code> and <code>FS</code> types as GADTs, which I'm not really sure about the motivation for; I would suggest using the non-GADT syntax, which is much simpler for this example:</p>\n\n<pre><code>type Name = String\ndata Ext = Txt | Mp3 | Jar | Doc | Hs deriving (Eq, Show)\ndata FS = A Name Ext | Dir Name [FS] deriving (Eq, Show)\n</code></pre>\n\n<p>In order to sort them by name, it would probably be worth writing a simple accessor function that can get the name of an FS:</p>\n\n<pre><code>name :: FS -&gt; Name\nname (A   n _) = n\nname (Dir n _) = n\n</code></pre>\n\n<p>Another approach would be to factor out the thing (Name) that is common to both cases:</p>\n\n<pre><code>data FS = NamedFS { name :: Name, fs :: UnnamedFS }\ndata UnnamedFS = A Ext | Dir [FS]\n</code></pre>\n\n<p>The first entry here uses record syntax, which, among other things, will automatically make a <code>name :: FS -&gt; Name</code> accessor, as well as an <code>fs :: FS -&gt; UnnamedFS</code>.</p>\n\n<p>For the actual sort, it looks a lot like the algorithmic description of merge sort.  To start with, let's write a function to divide a list in two:</p>\n\n<pre><code>split :: [a] -&gt; ([a], [a])\nsplit xs = splitAt (length xs `div` 2) xs\n</code></pre>\n\n<p>We also need a function to merge two sorted lists:</p>\n\n<pre><code>merge :: Ord a =&gt; [a] -&gt; [a] -&gt; [a]\nmerge [] x = x\nmerge x [] = x\nmerge (x:xs) (y:ys) | x &lt; y     = x:merge xs (y:ys)\n                    | otherwise = y:merge (x:xs) ys\n</code></pre>\n\n<p>Actually, this is not what we want, because it always uses the <code>&lt;</code> from the Ord instance; instead, we want something that takes in a comparison function.  In this case, we assume that if the comparison function returns true when called with x and y, x is conceptually less than y.</p>\n\n<pre><code>merge :: (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [a] -&gt; [a]\nmerge _ [] x = x\nmerge _ x [] = x\nmerge le (x:xs) (y:ys) | x `le` y  = x:merge le xs (y:ys)\n                       | otherwise = y:merge le (x:xs) ys\n</code></pre>\n\n<p>Now, we can implement mergesort like usual:</p>\n\n<pre><code>mergeSort :: (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [a]\nmergeSort _ []  = []\nmergeSort _ [x] = [x]\nmergeSort f l   = merge f (mergeSort f left) (mergeSort f right)\n  where (left, right) = split l\n</code></pre>\n\n<p>And just call it like:</p>\n\n<pre><code>-- fss is some [FS]\nmergeSort (\\x y -&gt; name x &lt; name y) fss\n</code></pre>\n\n<p>If we could use <code>Data.Ord</code>, this could be further reduced to:</p>\n\n<pre><code>mergeSort (comparing name) fss\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1480351997, "post_id": 40849133, "comment_id": 68915564, "body": "I&#39;m guessing the OP&#39;s class introduced the &quot;GADT&quot; syntax first; it&#39;s a lot more self-explanatory than the traditional syntax."}], "tags": [], "owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "is_accepted": false, "score": 1, "last_activity_date": 1480350574, "creation_date": 1480350574, "answer_id": 40849133, "question_id": 40847373, "link": "https://stackoverflow.com/questions/40847373/sort-file-system-data-without-using-anything-else-than-prelude/40849133#40849133", "title": "Sort file system data without using anything else than Prelude", "body": "<p>The function in <code>Data.List</code> that could help you is <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html#v:sortOn\" rel=\"nofollow noreferrer\"><code>sortOn</code></a>\nthis together with a function <code>getName :: FS -&gt; Name</code> would allow you to sort by comparing the <code>Name</code>s.</p>\n\n<p>If you cannot use functions from <code>Data.List</code> you will have to implement a sorting algorithm yourself (of which there are many to choose from). One example is \"QuickSort\" as implemented in the <a href=\"http://learnyouahaskell.com/recursion#quick-sort\" rel=\"nofollow noreferrer\">Learn you a Haskell</a> book:</p>\n\n<pre><code>quicksort :: [FS] -&gt; [FS]\nquicksort [] = []  \nquicksort (x:xs) =   \n    let smallerSorted = quicksort [a | a &lt;- xs, getName a &lt;= getName x]  \n        biggerSorted = quicksort [a | a &lt;- xs, getName a &gt; getName x]  \n    in  smallerSorted ++ [x] ++ biggerSorted\n</code></pre>\n\n<p>Note that I changed the comparisons to compare the <code>getName</code>s instead of the whole nodes.</p>\n\n<p>Another thing: you are using GADT syntax to define your datatypes and I cannot see any reason for you to do so. Here is how I would write them instead using ordinary datatype declarations:</p>\n\n<pre><code>data Ext\n  = Txt\n  | Mp3\n  | Jar\n  | Doc\n  | Hs\n  deriving (Eq, Show)\n\ndata FS\n  = File Name Ext\n  | Dir Name [FS]\n  deriving (Eq, Show)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 0, "last_activity_date": 1480389196, "last_edit_date": 1480389196, "creation_date": 1480387969, "answer_id": 40857004, "question_id": 40847373, "link": "https://stackoverflow.com/questions/40847373/sort-file-system-data-without-using-anything-else-than-prelude/40857004#40857004", "title": "Sort file system data without using anything else than Prelude", "body": "<p>In my opinion, the most natural list-sorting function in Haskell is the bottom-up mergesort (Peter Amidon's answer gives a top-down mergesort). Suppose you're starting with the list</p>\n\n<pre><code>[25,1,22,2,10,8,6,20,13,28,5,3,11]\n</code></pre>\n\n<p>The first step is to turn the list into a list of lists. The simplest way is with <code>map (:[])</code>, which yields</p>\n\n<pre><code>[[25],[1],[22],[2],[10],[8],[6],[20],[13],[28],[5],[3],[11]]\n</code></pre>\n\n<p>Next, you merge lists pairwise:</p>\n\n<pre><code>[[1,25],[2,22],[8,10],[6,20],[13,28],[3,5],[11]]\n</code></pre>\n\n<p>Repeat!</p>\n\n<pre><code>[[1,2,22,25],[6,8,10,20],[3,5,13,28],[11]]\n</code></pre>\n\n<p>And again!</p>\n\n<pre><code>[[1,2,6,8,10,20,22,25],[3,5,11,13,28]]\n</code></pre>\n\n<p>And once more:</p>\n\n<pre><code>[[1,2,3,5,6,8,10,11,13,20,22,25,28]]\n</code></pre>\n\n<p>As we now have just one list, we extract it.</p>\n\n<hr>\n\n<p>To implement this, I think it's best to use a custom type for the lists of lists in this case, to express the appropriate strictness:</p>\n\n<pre><code>infixr 5 :::\ndata LL a = ![a] ::: LL a | Nil\n</code></pre>\n\n<p>Implementation proceeds step by step. While breaking the list up into singletons is the <em>simplest</em> way to start off the process, it's a bit wasteful and will slow down access to the first few elements. So let's go by pairs there too:</p>\n\n<pre><code>breakUp :: (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; LL a\nbreakUp _cmp [] = Nil\nbreakUp _cmp xs@[a] = xs ::: Nil\nbreakUp cmp (x1 : x2 : xs)\n  | GT &lt;- cmp x1 x2 = [x2,x1] ::: breakUp cmp xs\n  | otherwise = [x1,x2] ::: breakUp cmp xs\n</code></pre>\n\n<p>Now we need to write a <code>merge</code> function:</p>\n\n<pre><code>merge :: (a -&gt; a -&gt; Ordering)\n      -&gt; [a] -&gt; [a] -&gt; [a]\nmerge _cmp [] ys = ys\nmerge _cmp xs [] = xs\nmerge cmp xss@(x:xs) yss@(y:ys)\n  | GT &lt;- cmp x y = y : merge cmp xss ys\n  | otherwise = x : merge cmp xs yss\n</code></pre>\n\n<p>Next we need to be able to merge a list of lists pairwise:</p>\n\n<pre><code>mergePairwise :: (a -&gt; a -&gt; Ordering)\n              -&gt; LL a -&gt; LL a\nmergePairwise _cmp Nil = Nil\nmergePairwise _cmp xs@(_ ::: Nil) = xs\nmergePairwise cmp (xs1 ::: xs2 ::: xss)\n  = merge cmp xs1 xs2 ::: mergePairwise cmp xss\n</code></pre>\n\n<p>Then we must merge up until done:</p>\n\n<pre><code>mergeAll :: (a -&gt; a -&gt; Ordering)\n         -&gt; LL a -&gt; [a]\nmergeAll _cmp Nil = []\nmergeAll _cmp (xs ::: Nil) = xs\nmergeAll cmp xss = mergeAll cmp (mergePairwise cmp xss)\n</code></pre>\n\n<p>Now we're cooking with <strike>glass</strike> <strike>grass</strike> bass!</p>\n\n<pre><code>sortBy :: (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]\nsortBy cmp = mergeAll cmp . breakUp cmp\n\nsort :: Ord a =&gt; [a] -&gt; [a]\nsort = sortBy compare\n</code></pre>\n\n<hr>\n\n<p>There's a bit of room to improve the above implementation by recognizing that the lists stored in the lists of lists are never empty. So we <em>might</em> get a small performance improvement using</p>\n\n<pre><code>data NonEmpty a = a :| [a]\ndata LL a = (:::) {-# UNPACK #-} !(NonEmpty a) (LL a) | Nil\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 4061741, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-jTyCiIFoD0g/AAAAAAAAAAI/AAAAAAAAC-o/3StRToY78t4/photo.jpg?sz=128", "display_name": "Chapi", "link": "https://stackoverflow.com/users/4061741/chapi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 40849111, "answer_count": 3, "score": 0, "last_activity_date": 1480389196, "creation_date": 1480345326, "last_edit_date": 1480345657, "question_id": 40847373, "link": "https://stackoverflow.com/questions/40847373/sort-file-system-data-without-using-anything-else-than-prelude", "title": "Sort file system data without using anything else than Prelude", "body": "<p>I have defined a data type called FS the following way:</p>\n\n<pre><code>type Name= String\n\ndata Ext where { Txt::Ext ; Mp3::Ext ; Jar::Ext ; Doc::Ext ; Hs::Ext }\n  deriving (Eq, Show)\n\n\ndata FS where {  A :: (Name,Ext) -&gt; FS;\n                 Dir :: Name-&gt; [FS] -&gt; FS }\n  deriving (Eq, Show)\n</code></pre>\n\n<p>(A stands for file and Dir for directory)<br>\nAnd I'm trying to make a function that given a <code>FS</code> (directory) it returns the same <code>FS</code> but ordered alphabetically at all levels, my attempt so far is the following:</p>\n\n<pre><code>orderFS :: FS-&gt; FS\norderFS (Dir x y) = Dir x (map orderFS (sort y));\norderFS (A (x,y)) = A (x,y);\n</code></pre>\n\n<p>The only piece I'm missing is a function called \"sort\" that takes a <code>[FS]</code> and returns it ordered alphabetically by the <code>Name</code> field.<br>\nI read that there are functions like sort from <code>Data.List</code> that can help, but I have to do this without using anything else than <code>Prelude</code>.</p>\n\n<p>So how should I implement such function? Thanks in advance</p>\n"}, {"tags": ["haskell", "nix"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1480347125, "post_id": 40846965, "comment_id": 68912514, "body": "I know nothing about Nix, but for the package to be installed as far as GHC is concerned, there needs to be a file <code>package.conf.d&#47;aeson-0.11.2.1.conf</code>."}, {"owner": {"reputation": 95982, "user_id": 17279, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a08771c878da3724492f3056d5eca168?s=128&d=identicon&r=PG", "display_name": "zoul", "link": "https://stackoverflow.com/users/17279/zoul"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1480347393, "post_id": 40846965, "comment_id": 68912706, "body": "I resigned and humbly returned to Homebrew."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480360600, "post_id": 40846965, "comment_id": 68920238, "body": "@zoul You could use <a href=\"https://docs.haskellstack.org/en/stable/README/\" rel=\"nofollow noreferrer\"><code>stack</code></a> instead. Not only is it one line to install, but upgrading and indeed just running multiple GHC versions at the same time is seamless."}, {"owner": {"reputation": 95982, "user_id": 17279, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a08771c878da3724492f3056d5eca168?s=128&d=identicon&r=PG", "display_name": "zoul", "link": "https://stackoverflow.com/users/17279/zoul"}, "edited": false, "score": 0, "creation_date": 1480363364, "post_id": 40846965, "comment_id": 68921739, "body": "Thank you! I have used stack previously (with success) and will do it again. It just felt interesting to have everything under one roof \u2013 maybe later."}], "answers": [{"tags": [], "owner": {"reputation": 1484, "user_id": 2541778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930c28082137d9918a90608c665c5af2?s=128&d=identicon&r=PG", "display_name": "Peter Simons", "link": "https://stackoverflow.com/users/2541778/peter-simons"}, "is_accepted": true, "score": 8, "last_activity_date": 1484837987, "last_edit_date": 1484837987, "creation_date": 1484836267, "answer_id": 41744312, "question_id": 40846965, "link": "https://stackoverflow.com/questions/40846965/haskell-packages-not-listed-in-ghc-pkg-when-installed-through-nix/41744312#41744312", "title": "Haskell packages not listed in ghc-pkg when installed through Nix", "body": "<p>You cannot install Haskell libraries in Nix that way because the <code>ghc</code> compiler you're using does not search your user's profile for libraries. Consequently, installing a library there has no effect. This topic is explained in great detail in the <a href=\"http://nixos.org/nixpkgs/manual/#users-guide-to-the-haskell-infrastructure\" rel=\"noreferrer\">Nixpkgs user manual</a>. I'm citing the relevant bit from \"8.5.2.2. How to install a compiler with libraries\":</p>\n\n<blockquote>\n  <p>GHC expects to find all installed libraries inside of its own lib directory. This approach works fine on traditional Unix systems, but it doesn\u2019t work for Nix, because GHC\u2019s store path is immutable once it\u2019s built. We cannot install additional libraries into that location. As a consequence, our copies of GHC don\u2019t know any packages except their own core libraries, like base, containers, Cabal, etc.</p>\n  \n  <p>We can register additional libraries to GHC, however, using a special build function called ghcWithPackages. That function expects one argument: a function that maps from an attribute set of Haskell packages to a list of packages, which determines the libraries known to that particular version of GHC. For example, the Nix expression ghcWithPackages (pkgs: [pkgs.mtl]) generates a copy of GHC that has the mtl library registered in addition to its normal core packages:</p>\n\n<pre><code>$ nix-shell -p \"haskellPackages.ghcWithPackages (pkgs: [pkgs.mtl])\"\n\n [nix-shell:~]$ ghc-pkg list mtl\n /nix/store/zy79...-ghc-7.10.2/lib/ghc-7.10.2/package.conf.d:\n     mtl-2.2.1\n</code></pre>\n  \n  <p>This function allows users to define their own development environment by means of an override. After adding the following snippet to ~/.nixpkgs/config.nix,</p>\n\n<pre><code>{\n  packageOverrides = super: let self = super.pkgs; in\n  {\n    myHaskellEnv = self.haskell.packages.ghc7102.ghcWithPackages\n                     (haskellPackages: with haskellPackages; [\n                       # libraries\n                       arrows async cgi criterion\n                       # tools\n                       cabal-install haskintex\n                     ]);\n  };\n}\n</code></pre>\n  \n  <p>it\u2019s possible to install that compiler with nix-env -f \"&lt;nixpkgs>\" -iA myHaskellEnv.</p>\n</blockquote>\n"}], "owner": {"reputation": 95982, "user_id": 17279, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a08771c878da3724492f3056d5eca168?s=128&d=identicon&r=PG", "display_name": "zoul", "link": "https://stackoverflow.com/users/17279/zoul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 580, "favorite_count": 0, "accepted_answer_id": 41744312, "answer_count": 1, "score": 2, "last_activity_date": 1560108159, "creation_date": 1480344202, "last_edit_date": 1560108159, "question_id": 40846965, "link": "https://stackoverflow.com/questions/40846965/haskell-packages-not-listed-in-ghc-pkg-when-installed-through-nix", "title": "Haskell packages not listed in ghc-pkg when installed through Nix", "body": "<p>I have installed GHC through Nix:</p>\n\n<pre><code>$ nix-env -i ghc\n</code></pre>\n\n<p>Then I have installed the aeson package:</p>\n\n<pre><code>$ nix-env -f \"&lt;nixpkgs&gt;\" -iA haskellPackages.aeson\n</code></pre>\n\n<p>And pointed GHC to the Nix package folder:</p>\n\n<pre><code>$ export GHC_PACKAGE_PATH=~/.nix-profile/lib/ghc-8.0.1/package.conf.d/\n</code></pre>\n\n<p>Which seems to work:</p>\n\n<pre><code>$ ghc-pkg list\n/Users/zoul/.nix-profile/lib/ghc-8.0.1/package.conf.d\n    Cabal-1.24.0.0\n    array-0.5.1.1\n    \u2026\n</code></pre>\n\n<p>But the aeson package is missing from the list of packages above and can\u2019t be loaded. Even though there\u2019s clearly something there:</p>\n\n<pre><code>$ ls /Users/zoul/.nix-profile/lib/ghc-8.0.1/ | grep ^ae\naeson-0.11.2.1\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 5, "last_activity_date": 1480334766, "creation_date": 1480334766, "answer_id": 40843896, "question_id": 40843813, "link": "https://stackoverflow.com/questions/40843813/converting-floating-to-integer/40843896#40843896", "title": "Converting Floating to Integer", "body": "<p>Haskell has multiple exponent functions with different types:</p>\n\n<ul>\n<li><a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#v:-94-\" rel=\"nofollow noreferrer\"><code>(^) :: (Num a, Integral b) =&gt; a -&gt; b -&gt; a</code></a></li>\n<li><a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#v:-94--94-\" rel=\"nofollow noreferrer\"><code>(^^) :: (Fractional a, Integral b) =&gt; a -&gt; b -&gt; a</code></a></li>\n<li><a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#v:-42--42-\" rel=\"nofollow noreferrer\"><code>(**) :: Floating a =&gt; a -&gt; a -&gt; a</code></a></li>\n</ul>\n\n<p>The one you are looking for is just <code>(^)</code>. With it, you don't even need <code>round</code>:</p>\n\n<pre><code>square :: Integer -&gt; Integer \nsquare = (^ 2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 5, "last_activity_date": 1480336025, "last_edit_date": 1480336025, "creation_date": 1480335446, "answer_id": 40844127, "question_id": 40843813, "link": "https://stackoverflow.com/questions/40843813/converting-floating-to-integer/40844127#40844127", "title": "Converting Floating to Integer", "body": "<p>This is an appendix to Alec's answer, which is correct, to help you understand the error message.  The type of <code>(**)</code> is</p>\n\n<pre><code>(**) :: (Floating a) =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>So</p>\n\n<pre><code>(** 2) :: (Floating a) =&gt; a -&gt; a\n</code></pre>\n\n<p>(because the literal <code>2</code> can be any numeric type we need).  But <code>a</code> is <code>Integer</code> because your function is declared to take an <code>Integer</code> as an input.  So now</p>\n\n<pre><code>(** 2) :: Integer -&gt; Integer  --provided that there is a `Floating Integer` instance\n</code></pre>\n\n<p>This explains your second error, because there is no <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Floating\" rel=\"nofollow noreferrer\"><code>Floating</code></a><code>Integer</code> instance -- <code>Integer</code>s do not support floating point operations like <code>sin</code> (and exponentiating with an arbitrary real number).</p>\n\n<p>Then you pass the output of this function, which is an <code>Integer</code>, along to <code>round</code> which has type</p>\n\n<pre><code>round :: (RealFrac a, Integral b) =&gt; a -&gt; b\n</code></pre>\n\n<p>We know the input, <code>a</code>, is <code>Integer</code> because it's coming from <code>(** 2)</code> as we discussed, and the output <code>b</code> is also <code>Integer</code> because the output of your function is declared to be <code>Integer</code>.  So now you have</p>\n\n<pre><code>round :: Integer -&gt; Integer  \n    --provided there are `Integral Integer` and `RealFrac Integer` instaces\n</code></pre>\n\n<p>There is an <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Integral\" rel=\"nofollow noreferrer\"><code>Integral</code></a><code>Integer</code> instance, so that is used, but there is no <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:RealFrac\" rel=\"nofollow noreferrer\"><code>RealFrac</code></a><code>Integer</code> instance, and that explains your first error. <code>Integer</code>s do not support rational-like operations like extracting the numerator (though I suppose they could...).</p>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1480342250, "post_id": 40844747, "comment_id": 68909364, "body": "It is debatable whether luqui&#39;s answer could have been condensed to a comment on Alec&#39;s answer, but this certainly could have been a comment on luqui&#39;s answer."}], "tags": [], "owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "is_accepted": false, "score": 1, "last_activity_date": 1480337285, "creation_date": 1480337285, "answer_id": 40844747, "question_id": 40843813, "link": "https://stackoverflow.com/questions/40843813/converting-floating-to-integer/40844747#40844747", "title": "Converting Floating to Integer", "body": "<p>As an appendix to @luqui's answer, if you wanted to fix the error (rather than just follow @Alec's excellent solution), you could convert the <code>Integer</code> parameter to a <code>Floating</code> instance first:</p>\n\n<pre><code>square :: Integer -&gt; Integer \nsquare = round . (** 2) . fromInteger\n</code></pre>\n"}], "owner": {"reputation": 23573, "user_id": 330889, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/daacb6d0a16d95a3858ccae59b44860d?s=128&d=identicon&r=PG", "display_name": "Pedro Rolo", "link": "https://stackoverflow.com/users/330889/pedro-rolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 810, "favorite_count": 0, "accepted_answer_id": 40843896, "answer_count": 3, "score": 2, "last_activity_date": 1480337285, "creation_date": 1480334529, "question_id": 40843813, "link": "https://stackoverflow.com/questions/40843813/converting-floating-to-integer", "title": "Converting Floating to Integer", "body": "<p>I am trying to define:</p>\n\n<pre><code>square :: Integer -&gt; Integer \nsquare = round . (** 2)\n</code></pre>\n\n<p>and I am getting:</p>\n\n<pre><code>&lt;interactive&gt;:9:9: error:\n    \u2022 No instance for (RealFrac Integer) arising from a use of \u2018round\u2019\n    \u2022 In the first argument of \u2018(.)\u2019, namely \u2018round\u2019\n      In the expression: round . (** 2)\n      In an equation for \u2018square\u2019: square = round . (** 2)\n\n&lt;interactive&gt;:9:18: error:\n    \u2022 No instance for (Floating Integer)\n        arising from an operator section\n    \u2022 In the second argument of \u2018(.)\u2019, namely \u2018(** 2)\u2019\n      In the expression: round . (** 2)\n      In an equation for \u2018square\u2019: square = round . (** 2)\n</code></pre>\n\n<p>I am still new in this language and I seem to be unable to convert an instance of Floating to an Integer. Does anybody know how can I do so?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1480339459, "post_id": 40843403, "comment_id": 68907569, "body": "I wish GHC would allow one to specify user-programmed warnings/errors for cases like these. As in, &quot;if after type checking/inference you find <code>Num (a-&gt;b)</code> suggest that ...&quot;."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 5, "last_activity_date": 1480333550, "last_edit_date": 1480333550, "creation_date": 1480333078, "answer_id": 40843403, "question_id": 40843004, "link": "https://stackoverflow.com/questions/40843004/haskell-no-instance-for-arising/40843403#40843403", "title": "Haskell No instance for \u2026 arising", "body": "<p>The short answer is that you're getting this \"ambiguous type variable\" error because your constraints <code>(Integral a, Floating a)</code> are inconsistent. There is no type that satisfies this, so when defaulting tries to find a type for <code>1</code> (in your input expression), it can't.</p>\n\n<p>It gets these constraints from the power operator <code>(^)</code> taking an integral argument on the left (<code>2.5 ^ 2</code> is not valid, use <code>(^^)</code> for that), and from comparing with the float <code>1.0e-10</code>.  I'm guessing  just want to use <code>(^^)</code> instead of <code>(^)</code> and remove the <code>Integral</code> constraint.  </p>\n\n<p>If you're doing numerics, you will almost certainly need <code>fromIntegral</code> and <code>realToFrac</code> eventually, which are the sledgehammer conversion functions between different numeric types. Just preparing you for what's ahead.</p>\n\n<p>There is one more exponential operator, <code>(**)</code>, which takes fractional numbers both on the left and right. The reason Haskell has three different exponentiation operators is fodder for another question if you are curious.</p>\n"}], "owner": {"reputation": 11, "user_id": 7219763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d31111fcdeca421cc63dd56933856d9?s=128&d=identicon&r=PG&f=1", "display_name": "Maxim Tsyganov", "link": "https://stackoverflow.com/users/7219763/maxim-tsyganov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1480333550, "creation_date": 1480331794, "question_id": 40843004, "link": "https://stackoverflow.com/questions/40843004/haskell-no-instance-for-arising", "title": "Haskell No instance for \u2026 arising", "body": "<p>I'm trying to write a function that recursive counts a Taylor:</p>\n\n<pre><code>mcloren x = log (1+x)/(1-x)\n\ncompareWithDelta' :: (Num a, Floating a, Integral a, Ord a) =&gt; a -&gt; a -&gt; Bool\ncompareWithDelta' x acc = abs (acc - mcloren x) &lt; 1.0e-10\n\nmcl :: (Floating a, Integral a, Num a) =&gt; a -&gt; a\nmcl x =\n let \n  mcl' x acc y\n   | compareWithDelta' x acc = acc\n   | otherwise = mcl' x (2*(x^(2*y+1)/(2*y+1))) (y+1)\n in \n  mcl' x 0 0\n</code></pre>\n\n<p>But i have these error messages:</p>\n\n<pre><code>No instance for (Num a0) arising from a use of 'mcl'\nThe type variable 'a0' is ambiguous\nPossible fix: add a type signature that fixes these type variable(s)\nNote: there are several potential instances:\n  instance Num Double \u2014 Defined in 'GHC.Float'\n  instance Num Float \u2014 Defined in 'GHC.Float'\n  instance Integral a =&gt; Num (GHC.Real.Ratio a)\n    \u2014 Defined in 'GHC.Real'\n  ...plus three others\nIn the expression: mcl 1\nIn an equation for 'it': it = mcl 1\n</code></pre>\n\n<p>What does it mean and how to fix it ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 3, "creation_date": 1480317603, "post_id": 40838942, "comment_id": 68894967, "body": "<code>(head (pack xs))</code> will be <code>[1]</code>, not <code>1</code>. Then, it makes sense to check <code>1 `elem` [1]</code>."}, {"owner": {"reputation": 75, "user_id": 6724755, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7ade53fcaa81cddafd5d65f3e955e774?s=128&d=identicon&r=PG&f=1", "display_name": "Arushi", "link": "https://stackoverflow.com/users/6724755/arushi"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480317781, "post_id": 40838942, "comment_id": 68895053, "body": "But, head always returns a single element then how will it return [1] in this case ?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1480318094, "post_id": 40838942, "comment_id": 68895202, "body": "@Arushi That single element can be a list (if the input is a list of lists)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1480339305, "post_id": 40838942, "comment_id": 68907476, "body": "This is a paragon example of how <code>head,tail</code> can produce code which is 1) hard to read and 2) hard to evaluate (can you state its complexity? how long it takes to check that there will be no runtime errors?). Using a simple <code>case</code> and pattern matching would greatly improve it, IMO."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 6724755, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7ade53fcaa81cddafd5d65f3e955e774?s=128&d=identicon&r=PG&f=1", "display_name": "Arushi", "link": "https://stackoverflow.com/users/6724755/arushi"}, "edited": false, "score": 0, "creation_date": 1480321568, "post_id": 40839086, "comment_id": 68896781, "body": "That means if I take an input <code>pack [1,1,2,2,3,4]</code> then x is 1 and Haskell converts the list to <b>[[1,1,2,2,3,4]]</b> , takes out its head which is <b>[1,1,2,2,3,4]</b>. Please explain the recursion as well with the same example. Thank you"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 75, "user_id": 6724755, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7ade53fcaa81cddafd5d65f3e955e774?s=128&d=identicon&r=PG&f=1", "display_name": "Arushi", "link": "https://stackoverflow.com/users/6724755/arushi"}, "edited": false, "score": 2, "creation_date": 1480338955, "post_id": 40839086, "comment_id": 68907243, "body": "@Arushi No, Haskell does not wrap the list, <code>pack</code> does. When <code>x</code> is 1 we have that <code>xs</code> is <code>[1,2,2,3,4]</code> and pack is called on that, returning <code>[[1],[2,2],[3],[4]]</code> whose head is <code>[1]</code> and tail <code>[[2,2],[3],[4]</code>."}, {"owner": {"reputation": 75, "user_id": 6724755, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7ade53fcaa81cddafd5d65f3e955e774?s=128&d=identicon&r=PG&f=1", "display_name": "Arushi", "link": "https://stackoverflow.com/users/6724755/arushi"}, "edited": false, "score": 0, "creation_date": 1480471101, "post_id": 40839086, "comment_id": 68972818, "body": "Is there any simple way of doing this using pattern matching and not using <code>elem</code> ? @K. A. Buhr"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1480527577, "post_id": 40839086, "comment_id": 69003370, "body": "Yes, but you should probably post that as a separate question, since it&#39;s getting off-topic from the original.  Asking and answering questions in the comments makes it harder for others to benefit from the answer in the future."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 7, "last_activity_date": 1480382984, "last_edit_date": 1480382984, "creation_date": 1480317949, "answer_id": 40839086, "question_id": 40838942, "link": "https://stackoverflow.com/questions/40838942/how-is-elem-working-with-a-single-element/40839086#40839086", "title": "How is Elem working with a single element", "body": "<p>In your example, <code>x</code> will be 1, but <code>head (pack xs)</code> is <em>not</em> 1.  In fact, you can see from it's type signature that the type of <code>pack xs</code> must be <code>[[Int]]</code> (or at least <code>[[a]]</code> for some kind of number <code>a</code>) namely a list <em>of lists</em> of numbers, so <code>head (pack xs)</code> has type <code>[Int]</code>, not type <code>Int</code>.  Whatever its value is, it can't be <code>1</code>.</p>\n\n<p>If that's still not clear, look at the shorter example <code>pack [1,2]</code>.  It will match the pattern <code>pack (x:xs)</code> with <code>x=1</code> and <code>xs=[2]</code>, so the right side of the <code>elem</code> call will be <code>head (pack [2])</code>.  You can verify that this is equivalent to <code>head [[2]]</code> which evaluates to <code>[2]</code>, and now the expression:</p>\n\n<pre><code>1 `elem` [2]\n</code></pre>\n\n<p>makes perfect sense.</p>\n\n<p>Remember, even though <code>head</code> returns the first element of a  list, Haskell allows lists of lists, and the first element of a list of lists is another list.</p>\n\n<p><strong>Edit:  To explain the recursion,</strong> let's go through a full example of <code>pack [1,1,2]</code> in detail.  Every time we try to evaluate a <code>pack</code> call, we'll use one of the patterns for <code>pack</code> which I've numbered:</p>\n\n<pre><code>pack [] = []               -- #1\npack [x] = [[x]]           -- #2\npack (x:xs) = if x `elem` (head (pack xs))    -- #3\n              then (x:(head (pack xs))):(tail (pack xs))\n              else [x]:(pack xs)\n</code></pre>\n\n<p>When Haskell tries to evaluate <code>pack [1,1,2]</code>, because <code>[1,1,2]</code> is equivalent to <code>1:[1,2]</code> (if you don't see why, look up the definition of the <code>:</code> operator and try it out on a few examples!), it matches pattern #3 with <code>x=1</code> and <code>xs=[1,2]</code>.  So, Haskell can evaluate this using the right hand side of pattern #3 with these substituted values for <code>x</code> and <code>xs</code>.  Just to be totally clear, the RHS with those substitutions looks like the following, which we'll call \"expression (A)\":</p>\n\n<pre><code>if 1 `elem` (head (pack [1,2]))\nthen (1:(head (pack [1,2]))):(tail (pack [1,2]))\nelse [1]:(pack [1,2])\n</code></pre>\n\n<p>Make sure you believe this is right before continuing!  Now, the hardest part of evaluating this expression is figuring out how to evaluate <code>pack [1,2]</code>, which is used in several places.  So, let's figure out how Haskell evaluates <code>pack [1,2]</code>.  Again, because <code>[1,2]</code> is equivalent to <code>1:[2]</code> (check it!), this matches pattern #3 with <code>x=1</code> and <code>xs=[2]</code>.  The RHS of pattern #3 with these substitutions is the following, which we'll call \"expression (B)\":</p>\n\n<pre><code>if 1 `elem` (head (pack [2]))\nthen (1:(head (pack [2]))):(tail (pack [2]))\nelse [1]:(pack [2])\n</code></pre>\n\n<p>To evaluate expression (B), we need to figure out the value of <code>pack [2]</code>.  This time, this expression matches pattern #2 with <code>x=2</code>.  (Actually, it would match pattern #3, too, with <code>x=2</code> and <code>xs=[]</code> but Haskell uses the first pattern that matches, so it never considers this possibility.)  Substituting <code>x=2</code> into the RHS of pattern #2 we get the following equivalent value for <code>pack [2]</code>, which we'll call \"expression (C)\", even though it's so short it probably doesn't deserve a name.</p>\n\n<pre><code>[[2]]\n</code></pre>\n\n<p>Taking this and substituting it back into expression (B) above, we literally get:</p>\n\n<pre><code>if 1 `elem` (head [[2]])\nthen (1:(head [[2]])):(tail [[2]])\nelse [1]:[[2]]\n</code></pre>\n\n<p>All I've done here is replaced <code>pack [2]</code> with <code>[[2]]</code> everywhere it appears, and then I removed some extra parentheses that didn't change the meaning.  The condition in the <code>if</code> statement is the same as <code>1 `elem` [2]</code>, which is false, so the value is <code>[1]:[[2]]</code> which can be rewritten as <code>[[1],[2]]</code>.  (Again, check if you don't see why.)  This, then is the final value for expression (B) and so the final value of <code>pack [1,2]</code>.  Now, we can substitute this value into expression (A) to get:</p>\n\n<pre><code>if 1 `elem` (head [[1],[2]])\nthen (1:(head [[1],[2]])):(tail [[1],[2]])\nelse [1]:[[1],[2]]\n</code></pre>\n\n<p>Now, because <code>head [[1],[2]]</code> is just <code>[1]</code>, the condition in the <code>if</code> statement is <code>1 `elem` [1]</code> which is true, so Haskell evaluates the part given by the <code>then</code> clause.  This is ugly, but you should be able to convince yourself that it's value is:</p>\n\n<pre><code>(1:(head [[1],[2]])):(tail [[1],[2]])\n= (1:[1]):[[2]]\n= [1,1]:[[2]]\n= [[1,1],[2]]\n</code></pre>\n\n<p>This is the final value of expression (A), but of course that was the value of <code>pack [1,1,2]</code>, so you can see that it all worked out.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1480351385, "post_id": 40846041, "comment_id": 68915153, "body": "<code>head</code> and <code>tail</code> are not responsible for this complexity problem; the failure to pull out an expensive common subexpression is to blame. They certainly do make the code much harder to understand, however. They also may slow down the code by a constant factor by introducing excessive laziness."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 1, "last_activity_date": 1480341363, "creation_date": 1480341363, "answer_id": 40846041, "question_id": 40838942, "link": "https://stackoverflow.com/questions/40838942/how-is-elem-working-with-a-single-element/40846041#40846041", "title": "How is Elem working with a single element", "body": "<p>As chi already commented, using <code>head</code> and <code>tail</code> is generally problematic and obscuring. In your example it also creates a gigantic performance problem, since in each recursion step you evaluate <code>pack xs</code> over and over again \u2013 unless the compiler steps in with some nontrivial optimisation, this has exponential complexity!</p>\n\n<p>I'd recommend the following instead, using <code>case</code> and guards:</p>\n\n<pre><code>pack (x:xs) = case pack xs of\n   thisPack : packs\n     | x `elem` thisPack -&gt; (x:thisPack) : packs\n   otherPacks            -&gt; [x] : otherPacks\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 6724755, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7ade53fcaa81cddafd5d65f3e955e774?s=128&d=identicon&r=PG&f=1", "display_name": "Arushi", "link": "https://stackoverflow.com/users/6724755/arushi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 40839086, "answer_count": 2, "score": 2, "last_activity_date": 1480382984, "creation_date": 1480317327, "last_edit_date": 1480337145, "question_id": 40838942, "link": "https://stackoverflow.com/questions/40838942/how-is-elem-working-with-a-single-element", "title": "How is Elem working with a single element", "body": "<p>The problem is to pack consecutive duplicates of list elements into sublists.\nI do not understand how <code>elem</code> is working with a single element here,</p>\n\n<p>For Example,</p>\n\n<pre><code>pack [1,1,2,2,3,4]\n</code></pre>\n\n<p>Then <code>x</code> will be 1 and <code>(head (pack xs))</code> will be 1.\nHow can: </p>\n\n<pre><code>1 `elem`  1\n</code></pre>\n\n<p>work when <code>elem</code> is of type <code>a -&gt; [a] -&gt; Bool</code>? </p>\n\n<p>Also, please explain the recursion.</p>\n\n<pre><code>pack :: (Eq a) =&gt; [a] -&gt; [[a]]\npack [] = []\npack [x] = [[x]]\npack (x:xs) = if x `elem` (head (pack xs))\n              then (x:(head (pack xs))):(tail (pack xs))\n              else [x]:(pack xs)\n</code></pre>\n"}, {"tags": ["haskell", "types", "unwrap"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1480313676, "post_id": 40838053, "comment_id": 68893381, "body": "You can write <code>data Something = Foo { getInteger :: Integer } | Bar { getBool :: Bool }</code> and get the functions <code>getInteger :: Something -&gt; Integer</code> and <code>getBool :: Something -&gt; Bool</code> for free (but they will fail horribly if you give them the wrong input)."}], "answers": [{"tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": true, "score": 7, "last_activity_date": 1480313859, "last_edit_date": 1480313859, "creation_date": 1480313510, "answer_id": 40838114, "question_id": 40838053, "link": "https://stackoverflow.com/questions/40838053/haskell-unwrap-data/40838114#40838114", "title": "Haskell unwrap data", "body": "<p>Well, firstly you have a typo: data constructors must be uppercase:</p>\n\n<pre><code>data Something = Foo Integer\n               | Bar Bool\n</code></pre>\n\n<p>What you are asking for is exactly what pattern matching is for. If you have a <code>Something</code> value called <code>s</code>:</p>\n\n<pre><code>case s of\n  Foo f -&gt; ... -- f is of type Integer in this \"block\"\n  Bar b -&gt; ... -- b is of type Bool in this \"block\"\n</code></pre>\n\n<p>This is how you generally approach this problem, because any kind of getter on this sort of data type will throw an error if it is constructed with the \"wrong\" constructor, and this allows you to handle that case. You <em>can</em> make a safe getter with something like <code>Maybe</code>, but a lot of times this will end up involving more boilerplate anyway.</p>\n"}], "owner": {"reputation": 73, "user_id": 3732143, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/707865780/picture?type=large", "display_name": "Umar Farooq", "link": "https://stackoverflow.com/users/3732143/umar-farooq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 0, "accepted_answer_id": 40838114, "answer_count": 1, "score": 1, "last_activity_date": 1480336246, "creation_date": 1480313181, "question_id": 40838053, "link": "https://stackoverflow.com/questions/40838053/haskell-unwrap-data", "title": "Haskell unwrap data", "body": "<p>If you have a data type</p>\n\n<pre><code>data Something = foo Integer \n               | bar Bool\n</code></pre>\n\n<p>Is there anyway I define \"getters\" that unwrap the Something type to get just the Integer or Bool? Right now it would be like (foo Integer) and (bar Bool). I just want the Integer or Boolean values. </p>\n"}, {"tags": ["haskell", "conduit"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1480304952, "post_id": 40836795, "comment_id": 68890969, "body": "Do you actually need to stream this? (So are you getting a sufficiently large amount of data at once that having it all in memory is unacceptable?)"}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480305075, "post_id": 40836795, "comment_id": 68890998, "body": "Yes please, I am."}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480310055, "post_id": 40836795, "comment_id": 68892262, "body": "I probably should have chosen a more sensible number of bytes, like some 2^n..."}], "answers": [{"comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 1, "creation_date": 1480309948, "post_id": 40837552, "comment_id": 68892225, "body": "Actually, takeCE will take exactly give elements of the stream, aka five bytes."}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1480310003, "post_id": 40837552, "comment_id": 68892245, "body": "Sorry, still learning conduit and this whole way of thinking: What modification to kind of tee this to /both/ stream the takeC5 to stdout and also sink to file?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1480312562, "post_id": 40837552, "comment_id": 68893068, "body": "@Mittenchops Updated the answer. <code>ZipSource</code>,  <code>ZipSink</code>, and <code>ZipConduit</code> are your friends for forking/joining."}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1480399517, "post_id": 40837552, "comment_id": 68933612, "body": "Thanks, @Alec.  I was a little confused in how to get the resolver set up, but I got this running and the forking of multiple sinks makes a lot of sense to me, more than the liftIO and mapM_ in my original example.  This is very helpful!"}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1480899533, "post_id": 40837552, "comment_id": 69140790, "body": "The type signature on main here is: main :: IO ((), ()) ?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 1, "creation_date": 1480900070, "post_id": 40837552, "comment_id": 69140923, "body": "@Mittenchops Yeah - I left it as that because it looked nicer (and technically <code>main</code> can have <code>IO a</code>). If you want to force <code>main :: IO ()</code>, just add <code>() &lt;$</code> right after the <code>main = </code> and add parens around the whole <code>runConduitRes ... &quot;data_file&quot;)</code> body."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 5, "last_activity_date": 1480334057, "last_edit_date": 1480334057, "creation_date": 1480309874, "answer_id": 40837552, "question_id": 40836795, "link": "https://stackoverflow.com/questions/40836795/haskell-streaming-download/40837552#40837552", "title": "Haskell streaming download", "body": "<p>You are probably looking for <a href=\"https://www.stackage.org/haddock/nightly-2016-11-26/http-conduit-2.2.3/Network-HTTP-Simple.html#v:httpSource\" rel=\"nofollow noreferrer\"><code>httpSource</code></a> from the latest version of <code>http-conduit</code>. It behaves pretty much exactly like Python's requests: you get back a stream of chunks.</p>\n\n<blockquote>\n  <p>save to file</p>\n</blockquote>\n\n<p>This is easy, just redirect the source straight into a file sink.</p>\n\n<pre><code>#!/usr/bin/env stack\n{- stack --install-ghc --resolver nightly-2016-11-26 runghc --package http-conduit -}\n\n{-# LANGUAGE OverloadedStrings #-}\nimport Network.HTTP.Simple (httpSource, getResponseBody)\nimport Conduit\n\nmain = runConduitRes $ httpSource \"http://httpbin.org/get\" getResponseBody\n                    .| sinkFile \"data_file\"\n</code></pre>\n\n<blockquote>\n  <p>print only a (take 5) of the byte response</p>\n</blockquote>\n\n<p>Once we have the source, we take the first 5 bytes with <code>takeCE 5</code> and then print these via <code>printC</code>.</p>\n\n<pre><code>#!/usr/bin/env stack\n{- stack --install-ghc --resolver nightly-2016-11-26 runghc --package http-conduit -}\n\n{-# LANGUAGE OverloadedStrings #-}\nimport Network.HTTP.Simple (httpSource, getResponseBody)\nimport Data.ByteString (unpack)\nimport Conduit\n\nmain = runConduitRes $ httpSource \"http://httpbin.org/get\" getResponseBody\n                    .| takeCE 5\n                    .| printC\n</code></pre>\n\n<blockquote>\n  <p>save to file <em>and</em> print only a (take 5) of the byte response</p>\n</blockquote>\n\n<p>To do this, you want <a href=\"https://hackage.haskell.org/package/conduit-1.2.8/docs/Data-Conduit-Internal.html#v:zipSinks\" rel=\"nofollow noreferrer\"><code>zipSinks</code></a> or, for more general cases that involve zipping multiple sinks <a href=\"http://hackage.haskell.org/package/conduit-1.2.5/docs/Data-Conduit.html#t:ZipSink\" rel=\"nofollow noreferrer\"><code>ZipSink</code></a>:</p>\n\n<pre><code>#!/usr/bin/env stack\n{- stack --install-ghc --resolver nightly-2016-11-26 runghc --package http-conduit -}\n\n{-# LANGUAGE OverloadedStrings #-}\nimport Network.HTTP.Simple (httpSource, getResponseBody)\nimport Data.ByteString (unpack)\nimport Data.Conduit.Internal (zipSinks)\nimport Conduit\n\nmain = runConduitRes $ httpSource \"http://httpbin.org/get\" getResponseBody\n                    .| zipSinks (takeCE 5 .| printC)\n                                (sinkFile \"data_file\")\n</code></pre>\n"}], "owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 634, "favorite_count": 0, "accepted_answer_id": 40837552, "answer_count": 1, "score": 4, "last_activity_date": 1482858916, "creation_date": 1480303999, "last_edit_date": 1495542824, "question_id": 40836795, "link": "https://stackoverflow.com/questions/40836795/haskell-streaming-download", "title": "Haskell streaming download", "body": "<p>The two resources I found that suggested recipes for streaming downloads using popular Haskell libraries were:</p>\n\n<ul>\n<li><a href=\"https://haskell-lang.org/library/http-client#Streaming\" rel=\"nofollow noreferrer\">https://haskell-lang.org/library/http-client#Streaming</a></li>\n<li><a href=\"http://www.alfredodinapoli.com/posts/2013-07-20-slick-http-download-in-haskell.html\" rel=\"nofollow noreferrer\">http://www.alfredodinapoli.com/posts/2013-07-20-slick-http-download-in-haskell.html</a></li>\n</ul>\n\n<p>How would I modify the code in the former to (a) save to file, and (b) print only a (take 5) of the byte response, rather than the whole response to stdout?</p>\n\n<p>My attempt at (b) is:</p>\n\n<pre><code>#!/usr/bin/env stack\n{- stack --install-ghc --resolver lts-5.13 runghc\n   --package http-conduit\n -}\n{-# LANGUAGE OverloadedStrings #-}\nimport           Control.Monad.IO.Class (liftIO)\nimport qualified Data.ByteString        as S\nimport qualified Data.Conduit.List      as CL\nimport           Network.HTTP.Simple\nimport           System.IO              (stdout)\n\nmain :: IO ()\nmain = httpSink \"http://httpbin.org/get\" $ \\response -&gt; do\n    liftIO $ putStrLn\n           $ \"The status code was: \"\n          ++ show (getResponseStatusCode response)\n\n    CL.mapM_ (take 5) (S.hPut stdout)\n</code></pre>\n\n<p>Which fails to map the (take 5), and suggests to me among other things I still don't understand how mapping over monads works, or liftIO.</p>\n\n<p>Also, this resource:</p>\n\n<p><a href=\"http://haskelliseasy.readthedocs.io/en/latest/#note-on-streaming\" rel=\"nofollow noreferrer\">http://haskelliseasy.readthedocs.io/en/latest/#note-on-streaming</a></p>\n\n<p>...gave me a warning, \"I know what I'm doing and I'd like more fine-grained control over resources, such as streaming\" that this not easily or generally supported.</p>\n\n<p>Other places I looked:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/24718873/downloading-large-files-from-the-internet-in-haskell\">Downloading large files from the Internet in Haskell</a></li>\n<li><a href=\"https://hackage.haskell.org/package/wreq\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/wreq</a></li>\n<li><a href=\"https://hackage.haskell.org/package/pipes-http\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/pipes-http</a></li>\n</ul>\n\n<p>If there's anything in the Haskellverse that makes this easier, more like Python's requests:</p>\n\n<pre><code>response = requests.get(URL, stream=True)\nfor i,chunk in enumerate(response.iter_content(BLOCK)):\n  f.write(chunk)\n</code></pre>\n\n<p>I'd appreciate the tip there, too, or pointers towards the 2016 state of the art.</p>\n"}, {"tags": ["haskell", "pattern-guards"], "answers": [{"comments": [{"owner": {"reputation": 1893, "user_id": 6153683, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/433c8247303c42b6fe5cef5821f79a5a?s=128&d=identicon&r=PG", "display_name": "skgbanga", "link": "https://stackoverflow.com/users/6153683/skgbanga"}, "edited": false, "score": 5, "creation_date": 1480308885, "post_id": 40836465, "comment_id": 68891895, "body": "Great answer! especially the line <code>Guards are simply constraints for patterns</code>"}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 63, "last_activity_date": 1480301197, "creation_date": 1480301197, "answer_id": 40836465, "question_id": 40836222, "link": "https://stackoverflow.com/questions/40836222/haskell-guard-inside-case-statement/40836465#40836465", "title": "Haskell - guard inside case statement", "body": "<p>There are two places guards are allowed: function definitions and <code>case</code> expressions. In both contexts, guards appear <em>after</em> a pattern and <em>before</em> the body, so you use <code>=</code> in functions and <code>-&gt;</code> in <code>case</code> branches, as usual:</p>\n\n<pre><code>divide x y\n  | y == 0 = Nothing\n  --------\n  | otherwise = Just (x / y)\n  -----------\n\npositively mx = case mx of\n  Just x | x &gt; 0 -&gt; Just x\n         -------\n  _ -&gt; Nothing\n</code></pre>\n\n<p>Guards are simply <em>constraints</em> for patterns, so <code>Just x</code> matches any non-<code>Nothing</code> value, but <code>Just x | x &gt; 0</code> only matches a <code>Just</code> whose wrapped value is also positive.</p>\n\n<p>I suppose the definitive reference is the <a href=\"https://www.haskell.org/onlinereport/haskell2010/\" rel=\"noreferrer\">Haskell Report</a>, specifically &sect;3.13 Case Expressions and &sect;4.4.3 Function and Pattern Bindings, which describe the syntax of guards and specify where they\u2019re allowed.</p>\n\n<p>In your code, you want:</p>\n\n<pre><code>Just (state, code)\n  | state == Taken -&gt; Left \"LockerNumber already taken!\"\n  | otherwise -&gt; Right code\n</code></pre>\n\n<p>This is also expressible with patterns alone:</p>\n\n<pre><code>Just (Taken, _) -&gt; Left \"LockerNumber already taken!\"\nJust (_, code) -&gt; Right code\n</code></pre>\n"}], "owner": {"reputation": 1893, "user_id": 6153683, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/433c8247303c42b6fe5cef5821f79a5a?s=128&d=identicon&r=PG", "display_name": "skgbanga", "link": "https://stackoverflow.com/users/6153683/skgbanga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16155, "favorite_count": 5, "accepted_answer_id": 40836465, "answer_count": 1, "score": 28, "last_activity_date": 1480301197, "creation_date": 1480299205, "last_edit_date": 1495535487, "question_id": 40836222, "link": "https://stackoverflow.com/questions/40836222/haskell-guard-inside-case-statement", "title": "Haskell - guard inside case statement", "body": "<p>I am going through <a href=\"http://learnyouahaskell.com/chapters\" rel=\"noreferrer\">Learn you a haskell</a> book, and in Chapter 8 there is a snippet of code which looks like this</p>\n\n<pre><code>data LockerState = Taken | Free deriving (Eq, Show)\ntype Code = String\ntype LockerMap = Map.Map Int (LockerState, Code)\n\nlookup' :: Int -&gt; LockerMap -&gt; Either String Code\nlookup' num_ map_ =\n   case (Map.lookup num_ map_) of\n      Nothing -&gt; Left $ \"LockerNumber doesn't exist!\"\n      Just (state, code) -&gt; if state == Taken\n                              then Left $ \"LockerNumber already taken!\"\n                              else Right $ code\n</code></pre>\n\n<p>This works. However, I wanted to convert if/else block to guard statements like this:</p>\n\n<pre><code>lookup' :: Int -&gt; LockerMap -&gt; Either String Code\nlookup' num_ map_ =\n   case (Map.lookup num_ map_) of\n      Nothing -&gt; Left $ \"LockerNumber doesn't exist!\"\n      Just (state, code) -&gt;\n         | state == Taken = Left $ \"LockerNumber already taken!\"\n         | otherwise = Right $ Code\n</code></pre>\n\n<p>This doesn't compile. It seems that usage of guards in Haskell is very restrictive/non intuitive. <a href=\"https://stackoverflow.com/questions/34124558/is-it-possible-to-nest-guards-in-haskell/34124909#34124909\">SO Ex1</a> <a href=\"https://stackoverflow.com/questions/13327374/haskell-defining-a-function-with-guards-inside-a-where\">SO Ex2</a>. Is there a definite source which I can read which tells at which places I can use guards? </p>\n"}, {"tags": ["c#", "string", "linq", "haskell", "random"], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 7, "last_activity_date": 1480303766, "last_edit_date": 1480303766, "creation_date": 1480301552, "answer_id": 40836503, "question_id": 40836139, "link": "https://stackoverflow.com/questions/40836139/trouble-translating-small-c-random-string-function-to-haskell/40836503#40836503", "title": "Trouble translating small C# &quot;Random String&quot; function to Haskell", "body": "<p>The natural translation to Haskell involves having some sort of <code>IO</code> (as you need randomness). Since you are essentially trying to perform the action of choosing a character <code>n</code> times, you want to use <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Monad.html#v:replicateM\" rel=\"nofollow noreferrer\"><code>replicateM</code></a>. Then, for getting a random number in a range, you can use <a href=\"http://hackage.haskell.org/package/random-1.1/docs/System-Random.html#v:randomRIO\" rel=\"nofollow noreferrer\"><code>randomRIO</code></a>.</p>\n\n<pre><code>import Control.Monad (replicateM)\nimport System.Random (randomRIO)\n\nrandomString :: Int -&gt; IO String\nrandomString n = replicateM n (do r &lt;- randomRIO (0,m); pure (chars !! r))\n  where\n    chars = ['A'..'Z'] ++ ['0'..'9']\n    m = length chars\n</code></pre>\n\n<p>This is somewhat complicated by the fact you want a string of only characters in a certain range. otherwise, you'd have a one liner: <code>randomString n = replicateM n randomIO</code>.</p>\n\n<hr>\n\n<p>That said, the more faithful translation would use <a href=\"https://www.stackage.org/haddock/lts-7.10/conduit-combinators-1.0.8.2/Data-Conduit-Combinators.html\" rel=\"nofollow noreferrer\"><code>conduit</code></a>. I'm not going to include imports and language pragmas (because they are a bit painful). This looks a lot more like what you would write in C#:</p>\n\n<pre><code>randomString' :: Int -&gt; IO String\nrandomString' n = runConduit $ replicate n chars\n                            .| mapM (\\cs -&gt; do r &lt;- randomRIO (0,m); pure (cs !! r))\n                            .| sinkList\n  where\n    chars = ['A'..'Z'] ++ ['0'..'9']\n    m = length chars\n</code></pre>\n"}], "owner": {"reputation": 6986, "user_id": 877603, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ecf2008864ba219bf52317d2ff31ffe2?s=128&d=identicon&r=PG", "display_name": "TheIronKnuckle", "link": "https://stackoverflow.com/users/877603/theironknuckle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 40836503, "answer_count": 1, "score": 2, "last_activity_date": 1480303766, "creation_date": 1480298344, "last_edit_date": 1480300701, "question_id": 40836139, "link": "https://stackoverflow.com/questions/40836139/trouble-translating-small-c-random-string-function-to-haskell", "title": "Trouble translating small C# &quot;Random String&quot; function to Haskell", "body": "<p>I saw the following code in my companies codebase and thought to myself \"Damn that's a fine line of linq, I'd like to translate that to Haskell to see what it's like in an actual functional language\"</p>\n\n<pre><code>static Random random = new Random();\nstatic string RandomString(int length)\n{\n    const string chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\";\n    return new string(Enumerable.Repeat(chars, length)\n                                .Select(s =&gt; s[random.Next(s.Length)])\n                                .ToArray());\n}\n</code></pre>\n\n<p>However I'm having a bit of trouble getting a concise and direct translation to Haskell because of how awkward it is to generate random numbers in this language.</p>\n\n<p>I've considered a couple of approaches. The most direct translation of the C# code only generates a single random index and then uses that in place of the <code>random.Next(s.Length)</code>. But I need to generate multiple indexes, not a single one.</p>\n\n<p>Then I considered doing a list of <code>IO Int</code> random number actions, but I can't work out how to go through and convert the list of <code>IO</code> actions into actual random numbers.</p>\n\n<p>So the Haskell code that I end up writing ends up looking quite convoluted compared to the C# (which I wasn't expecting in this case) and I haven't even got it to work anyway.</p>\n\n<p>My question, what would be a natural translation of the C# to Haskell? Or more generally, how would you go about generating a random String of a specified length in Haskell (because this C# way doesn't seem to translate well to Haskell)?</p>\n\n<p>Note: I'm mainly interested in what the algorithm to generate a random string looks like in Haskell. I'm not really interested in any standard libraries which do the job for me</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 4, "creation_date": 1480296497, "post_id": 40835811, "comment_id": 68889118, "body": "A hint: in a way, <code>Maybe a</code> can be thought of as a list of either 0 or 1 elements, and <code>fold</code> <i>is</i> clearly defined over each of those things."}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1480306811, "post_id": 40835811, "comment_id": 68891380, "body": "To make this more explicit, note that anything <code>Foldable</code> can be converted to a list; <code>toList &lt;$&gt; [Nothing, Just True] == [[], [True]]</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1480326581, "post_id": 40835811, "comment_id": 68899720, "body": "I wonder which kind of &quot;fold&quot; you are actually required to implement. In Haskell, we have the <code>Foldable</code> class whose <code>foldr</code> is equivalent to list-ifying the data type and then using <code>foldr</code> on the resulting list. In other contexts, &quot;fold&quot; is a term for an <i>eliminator</i>, as in <code>cata</code> from <code>recursion-schemes</code>. In my very first CS exam, I was asked to produce a &quot;fold on binary trees&quot; during an oral test, and that was meant to be something like <code>cata</code>."}], "answers": [{"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1480303717, "post_id": 40835908, "comment_id": 68890645, "body": "I think it is far from obvious that <code>foldMaybe</code> should have this type - I would say that <code>b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b</code> is more &#39;obvious&#39;, as the type of <code>foldList</code> corresponds (almost) to the natural eliminator for lists, and <code>b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b</code> is the natural eliminator for <code>Maybe</code> - indeed there is a function of this type in <code>Data.Maybe</code> (<code>maybe</code>). There is no <code>foldMaybe</code> with that type, excluding <code>Data.Foldable.foldr</code>, which has a much more general type (and the type of this function has little to do with <code>Maybe</code>, or even <code>List</code>)"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1480383432, "post_id": 40835908, "comment_id": 68929333, "body": "Good point, but to clarify, I meant that it was obvious that <code>foldr</code> should have that type for Maybes by an obvious parallel with its type for Lists, not necessarily that the most natural fold for a Maybe should look like <code>foldr</code>.  I&#39;ve edited the answer to make that clearer.  In fact, <code>Data.Foldable.foldr</code> is <code>Prelude.foldr</code> in current versions of Haskell, and its type does specialize to Lists and Maybes in this manner, even if <code>foldr</code> isn&#39;t the &quot;natural&quot; fold for a Maybe."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 3, "last_activity_date": 1480383400, "last_edit_date": 1480383400, "creation_date": 1480296314, "answer_id": 40835908, "question_id": 40835811, "link": "https://stackoverflow.com/questions/40835811/fold-on-non-lists/40835908#40835908", "title": "Fold on non-lists?", "body": "<p>As \"basic concepts\" go, this is pretty mind-bending, so don't feel too bad.</p>\n\n<p>It may help to set aside your intuition about what a fold does to a list and think about what <em>type</em> a specific folding function (let's use <code>foldr</code>) should have if applied to a <code>Maybe</code>.  Writing <code>List a</code> in place of <code>[a]</code> to make it clearer, the standard <code>foldr</code> on a list has type:</p>\n\n<pre><code>foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; List a -&gt; b\n</code></pre>\n\n<p>Obviously, the corresponding fold on a Maybe must have type:</p>\n\n<pre><code>foldrMaybe :: (a -&gt; b -&gt; b) -&gt; b -&gt; Maybe a -&gt; b\n</code></pre>\n\n<p>Think about what definition this could possibly have, given that it must be defined for all <code>a</code> and <code>b</code> without knowing anything else about the types.  As a further hint, see if there's a function already defined in <code>Data.Maybe</code> that has a similar type -- maybe (ha ha) that'll give you some ideas.</p>\n"}, {"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1480336636, "post_id": 40837567, "comment_id": 68905814, "body": "This seems maybe a bit high level for the OP.   It&#39;s a good answer anyway, just some feedback."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 6, "last_activity_date": 1480310040, "creation_date": 1480310040, "answer_id": 40837567, "question_id": 40835811, "link": "https://stackoverflow.com/questions/40835811/fold-on-non-lists/40837567#40837567", "title": "Fold on non-lists?", "body": "<p><code>Foldable</code> is a pretty confusing class, to be honest, because it doesn't have an awful lot of laws and it's quite possible to write quite a lot of different <code>Foldable</code> instances for almost any given type. Fortunately, it's possible to figure out what a <code>Foldable</code> instance should do in a purely mechanical way based on a <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Traversable.html\" rel=\"nofollow noreferrer\"><code>Traversable</code></a> instance for the same type&mdash;if there is one.</p>\n\n<p>We have</p>\n\n<pre><code>class (Functor t, Foldable t) =&gt; Traversable t where\n  traverse :: Applicative f =&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)\n</code></pre>\n\n<p><code>Traversable</code> has several different laws, but it turns out the most important one is <code>traverse Identity = Identity</code>. Let's see how this applies to <code>Maybe</code>:</p>\n\n<pre><code>traverse :: Applicative f =&gt; (a -&gt; f b) -&gt; Maybe a -&gt; f (Maybe b)\ntraverse g Nothing = _none\ntraverse g (Just a) = _some\n</code></pre>\n\n<p>Now in the first case, you need to produce <code>f (Maybe b)</code>, and all you have is <code>g :: a -&gt; f b</code>. Since you don't have any <code>f</code> values, and you don't have any <code>a</code> values, the only thing you can produce is <code>pure Nothing</code>.</p>\n\n<p>In the second case, you have to produce <code>f (Maybe b)</code> and you have <code>g :: a -&gt; f b</code> and <code>a</code>. So the only interesting way to start is to apply <code>g</code> to <code>a</code>, getting <code>g a :: f b</code>. Now you have two options to consider: you could throw away this value, and just return <code>Nothing</code>, or you can wrap it up in <code>Just</code>.</p>\n\n<p>By the identity law, <code>traverse Identity (Just a) = Identity (Just a)</code>. So you're not allowed to return <code>Nothing</code>. The <em>only</em> legal definition is</p>\n\n<pre><code>traverse _ Nothing = pure Nothing\ntraverse g (Just a) = Just &lt;$&gt; g a\n</code></pre>\n\n<p>The <code>Traversable</code> instance for <code>Maybe</code> is completely determined by the <code>Traversable</code> laws and parametricity.</p>\n\n<p>Now it's possible to fold using <code>traverse</code>:</p>\n\n<pre><code>foldMapDefault :: (Traversable t, Monoid m)\n               =&gt; (a -&gt; m) -&gt; t a -&gt; m\nfoldMapDefault f xs =\n  getConst (traverse (Const . f) xs)\n</code></pre>\n\n<p>As this applies to <code>Maybe</code>,</p>\n\n<pre><code>foldMapDefault f Nothing =\n  getConst (traverse (Const . f) Nothing)\nfoldMapDefault f (Just a) =\n  getConst (traverse (Const . f) (Just a))\n</code></pre>\n\n<p>Expanding our definitions,</p>\n\n<pre><code>foldMapDefault f Nothing = getConst (pure Nothing)\nfoldMapDefault f (Just a) = getConst (Just &lt;$&gt; (Const (f a)))\n</code></pre>\n\n<p>By the definitions of <code>pure</code> and <code>&lt;$&gt;</code> for <code>Const</code>, these are</p>\n\n<pre><code>foldMapDefault f Nothing = getConst (Const mempty)\nfoldMapDefault f (Just a) = getConst (Const (f a))\n</code></pre>\n\n<p>Unwrapping the constructor,</p>\n\n<pre><code>foldMapDefault f Nothing = mempty\nfoldMapDefault f (Just a) = f a\n</code></pre>\n\n<p>And this is indeed exactly how <code>foldMap</code> is defined for <code>Maybe</code>.</p>\n"}], "owner": {"reputation": 421, "user_id": 2938375, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5271f0057ed876c78f7d725a4aab1e59?s=128&d=identicon&r=PG&f=1", "display_name": "CowNorris", "link": "https://stackoverflow.com/users/2938375/cownorris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 40837567, "answer_count": 2, "score": 4, "last_activity_date": 1480383400, "creation_date": 1480295436, "last_edit_date": 1480312476, "question_id": 40835811, "link": "https://stackoverflow.com/questions/40835811/fold-on-non-lists", "title": "Fold on non-lists?", "body": "<p>In a recent assignment I have been asked to define fold functions for some non-list types. I'm still not quite able to wrap my head around this concept yet. Thus far, I have understood <code>fold</code> as performing over subsequent elements in the <code>list</code>. <code>fold</code> on <code>Tree</code> still do make intuitive sense, since one is able to apply some function recursively over the root's sub-trees.</p>\n\n<p>However, on a datatype like:</p>\n\n<pre><code>Maybe a :: Nothing | Just a\n</code></pre>\n\n<p>There is no <code>list</code> (as it seems to me) to perform the fold action on. </p>\n\n<p>I'm sure I have some issue with understanding the basic concepts here, and I would greatly appreciate some clearing up. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 181, "user_id": 4633831, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cc93c4479491b84c5a3d1ebcb3fdd68?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Wilson", "link": "https://stackoverflow.com/users/4633831/danny-wilson"}, "edited": false, "score": 2, "creation_date": 1480291626, "post_id": 40835394, "comment_id": 68888112, "body": "Aim your arrow the other way, so <code>&lt;-</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3967, "user_id": 3853711, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/SwXly.png?s=128&g=1", "display_name": "Rahn", "link": "https://stackoverflow.com/users/3853711/rahn"}, "is_accepted": false, "score": 1, "last_activity_date": 1480295758, "creation_date": 1480295758, "answer_id": 40835850, "question_id": 40835394, "link": "https://stackoverflow.com/questions/40835394/divide-the-even-number-in-the-list/40835850#40835850", "title": "divide the even number in the list", "body": "<pre><code>halfEvens :: [Int] -&gt; [Int]\nhalfEvens xs = [x `div` 2 | x &lt;- xs, even x]\n</code></pre>\n\n<p><code>x &lt;- xs</code> is read as <code>x</code> <em>is drawn from</em> <code>xs</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1212, "user_id": 2455145, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kazBZ.jpg?s=128&g=1", "display_name": "AlexJ136", "link": "https://stackoverflow.com/users/2455145/alexj136"}, "is_accepted": false, "score": 2, "last_activity_date": 1480329198, "creation_date": 1480329198, "answer_id": 40842111, "question_id": 40835394, "link": "https://stackoverflow.com/questions/40835394/divide-the-even-number-in-the-list/40842111#40842111", "title": "divide the even number in the list", "body": "<p>If you want to keep the odd numbers in the list:</p>\n\n<pre><code>halfEvens :: [Int] -&gt; [Int]\nhalfEvens = map (\\x -&gt; if (x `mod` 2) == 0 then x `div` 2 else x)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 494, "user_id": 5447207, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d96199ece7ba3bc4f3c1d97d645f5fad?s=128&d=identicon&r=PG", "display_name": "Bargros", "link": "https://stackoverflow.com/users/5447207/bargros"}, "is_accepted": false, "score": 0, "last_activity_date": 1518568358, "last_edit_date": 1518568358, "creation_date": 1480432979, "answer_id": 40869500, "question_id": 40835394, "link": "https://stackoverflow.com/questions/40835394/divide-the-even-number-in-the-list/40869500#40869500", "title": "divide the even number in the list", "body": "<p>It has to do with your application of <strong>-></strong>, basically -> is an infix type operator also known as the function arrow(function builder), who's purpose is to apply the arguments on the left to the right so \n<code>from -&gt; to</code> but list comprehension works with <strong>&lt;-</strong> which takes an IO action and binds it to the left argument so <code>to &lt;- from</code>, a small fix to your function:</p>\n\n<pre><code>halfEvens :: [Int] -&gt; [Int]\nhalfEvens xs = [x `div` 2 | x &lt;- xs, even x]\n</code></pre>\n\n<p><strong>[Edit: Ignore anything else from here]</strong>\n<strong>=========================================================================</strong></p>\n\n<p>But if what you're trying is to divide all even numbers by 2 then you are doing it wrong, as this function would return only even numbers, while discarding all others.</p>\n\n<pre><code>halfEvens :: [Int] -&gt; [Int]\nhalfEvens [] = []\nhalfEvens (x:xs) = if even x then x `div` 2 : halfEvens else x : halfEvens\n</code></pre>\n\n<p>Would be the correct way to do  it, @AlexJ136 answer is also straight to the point, which seems much more efficient than mine, so I would go for it.</p>\n"}], "owner": {"reputation": 29, "user_id": 7209970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f93acd0ae2539c73637ac67cb63b614?s=128&d=identicon&r=PG&f=1", "display_name": "mdlvnadnfad", "link": "https://stackoverflow.com/users/7209970/mdlvnadnfad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 867, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1518568358, "creation_date": 1480291512, "question_id": 40835394, "link": "https://stackoverflow.com/questions/40835394/divide-the-even-number-in-the-list", "title": "divide the even number in the list", "body": "<p>I was trying to half the even numbers in the list </p>\n\n<pre><code>halfEvens :: [Int] -&gt; [Int]\nhalfEvens xs = [x `div` 2 | x -&gt; xs, even x]\n</code></pre>\n\n<p>the error is \n       <strong>error: parse error on input \u2018->\u2019</strong></p>\n\n<p>what does this mean and how to fix it? \nthanks </p>\n"}, {"tags": ["haskell", "category-theory", "comonad", "bifunctor"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1480329689, "post_id": 40835094, "comment_id": 68901601, "body": "Not an answer, but: A (co)monad is just a (co)monoid (with functor composition as the tensor product) in the category of <b>endo</b>functors, right? Haskell bifunctors aren&#39;t endofunctors. So I&#39;m not sure what a real bi(co)monad would look like, or even if it makes sense to build such a thing on top of bifunctors. But perhaps there&#39;s still something useful that looks &quot;kinda like&quot; a bicomonad, so it&#39;s still an interesting question."}, {"owner": {"reputation": 155, "user_id": 3289389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gRhdh.jpg?s=128&g=1", "display_name": "Jo Mo", "link": "https://stackoverflow.com/users/3289389/jo-mo"}, "edited": false, "score": 0, "creation_date": 1572346366, "post_id": 40835094, "comment_id": 103522900, "body": "Also not an answer, but I come from the math side. For us, a bimonad is a a comonoidal monad, i.e. it is a monad on a monoidal category whose category of modules is again monoidal category. (Recall that modules over an algebra form a monoidal category iff the algebra is a bialgebra). Likewise, a bicomonad is a monoidal comonad."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 155, "user_id": 3289389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gRhdh.jpg?s=128&g=1", "display_name": "Jo Mo", "link": "https://stackoverflow.com/users/3289389/jo-mo"}, "edited": false, "score": 0, "creation_date": 1572347304, "post_id": 40835094, "comment_id": 103523357, "body": "@JoBe very interesting! Could you elaborate that as an answer in math notation?"}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1480294396, "post_id": 40835640, "comment_id": 68888728, "body": "Not sure; this looks a lot like the ordinary <code>Monad</code> restricted to tuple arguments (which are then curried)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1480295439, "post_id": 40835640, "comment_id": 68888927, "body": "@leftaroundabout Agreed. I do wonder, though, if/how your bicomonad differs from a comonad restricted to tuple arguments."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1480297808, "post_id": 40835640, "comment_id": 68889366, "body": "@leftaroundabout, isn&#39;t that almost true of <code>Biapplicative</code> as well (if you exclude boring functors like <code>Const</code>)?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1480335744, "post_id": 40835640, "comment_id": 68905249, "body": "@dfeuer, I consider <code>Const</code> one of the more important applicatives, if you&#39;re in the business of composing them which is what applicatives are good at.  Just sayin..."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1480293857, "creation_date": 1480293857, "answer_id": 40835640, "question_id": 40835094, "link": "https://stackoverflow.com/questions/40835094/what-would-be-the-methods-of-a-bi-comonad/40835640#40835640", "title": "What would be the methods of a bi-comonad?", "body": "<p>This is not an answer, but for <code>Bimonad</code>, how about this?</p>\n\n<pre><code>class Biapplicative p =&gt; Bimonad p where\n  (&gt;&gt;==) :: p a b -&gt; (a -&gt; b -&gt; p c d) -&gt; p c d\n\nbiap :: Bimonad p =&gt; p (a -&gt; b) (c -&gt; d) -&gt; p a c -&gt; p b d\nbiap p q = p &gt;&gt;== \\ab cd -&gt; q &gt;&gt;== \\a c -&gt; bipure (ab a) (cd c)\n\ninstance Bimonad (,) where\n  (a,b) &gt;&gt;== f = f a b\n</code></pre>\n\n<p>I don't know if this is categorically right/interesting, or even remotely useful, but it smells right from a Haskell perspective. Does it match your <code>Bicomonad</code> or something similar?</p>\n"}], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 2, "answer_count": 1, "score": 11, "last_activity_date": 1480325215, "creation_date": 1480289206, "last_edit_date": 1495542274, "question_id": 40835094, "link": "https://stackoverflow.com/questions/40835094/what-would-be-the-methods-of-a-bi-comonad", "title": "What would be the methods of a bi-comonad?", "body": "<p>While musing what more useful standard class to suggest <a href=\"https://stackoverflow.com/a/40833245/745903\">to this one</a></p>\n\n<pre><code>class Coordinate c where\n  createCoordinate :: x -&gt; y -&gt; c x y\n  getFirst :: c x y -&gt; x\n  getSecond :: c x y -&gt; y\n  addCoordinates :: (Num x, Num y) =&gt; c x y -&gt; c x y -&gt; c x y\n</code></pre>\n\n<p>it occured me that instead of something <a href=\"http://hackage.haskell.org/package/vector-space-0.10.4/docs/Data-VectorSpace.html#t:VectorSpace\" rel=\"nofollow noreferrer\"><code>VectorSpace</code>-y</a> or <a href=\"http://hackage.haskell.org/package/linear-1.20.5/docs/Linear-V2.html#t:R2\" rel=\"nofollow noreferrer\"><code>R2</code></a>, a rather more general beast might lurk here: a <code>Type -&gt; Type -&gt; Type</code> whose two contained types can both be extracted. Hm, perhaps they can be <em><a href=\"http://hackage.haskell.org/package/comonad-5/docs/Control-Comonad.html#v:extract\" rel=\"nofollow noreferrer\"><code>extract</code></a>ed</em>?</p>\n\n<p>Turns out neither the <code>comonad</code> nor <a href=\"https://hackage.haskell.org/package/bifunctors\" rel=\"nofollow noreferrer\"><code>bifunctors</code></a> package contains something called <code>Bicomonad</code>. Question is, would such a class even make sense, category-theoretically? Unlike <code>Bimonad</code> (which also isn't defined, and I couldn't really see how might look), a na\u00efve definition seems plausible:</p>\n\n<pre><code>class Bifunctor c =&gt; Bicomonad c where\n  fst :: c x y -&gt; x\n  snd :: c x y -&gt; y\n  bidup :: c x y -&gt; c (c x y) (c x y)\n</code></pre>\n\n<p>probably with the laws</p>\n\n<pre><code>fst . bidup \u2261 id\nsnd . bidup \u2261 id\nbimap fst snd . bidup \u2261 id\nbimap bidup bidup . bidup \u2261 bidup . bidup\n</code></pre>\n\n<p>but I find it disquieting that both fields of the result of <code>bidup</code> contain the same type, and there are quite a number of other, perhaps \u201cbetter\u201d conceivable signatures.</p>\n\n<p>Any thoughts?</p>\n"}, {"tags": ["haskell", "applicative"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1480276445, "post_id": 40833051, "comment_id": 68884030, "body": "Just because applicative functors expose an interface that can be used for independent computations doesn&#39;t mean that everything that satisfies this interface is parallelizable. Parsers are inherently sequential."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 5, "creation_date": 1480277793, "post_id": 40833051, "comment_id": 68884473, "body": "I guess your intuition about &quot;independent&quot; has to do with the fact that, unlike <code>Monad</code>, your <code>parseName</code> parser cannot make use of the <i>parsed</i> email &quot;returned&quot; by <code>parseEmail</code>. But of course what <code>Applicative</code> <i>is</i> is nothing more than the class and its associated laws."}], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 17, "last_activity_date": 1480278982, "creation_date": 1480278982, "answer_id": 40833608, "question_id": 40833051, "link": "https://stackoverflow.com/questions/40833051/are-applicative-functors-composed-with-the-applicative-style-really-independent/40833608#40833608", "title": "Are applicative functors composed with the applicative style really independent?", "body": "<p>The independence here is not saying that one computation cannot detect what other computations have been run - that is, it's not supposed to be the case that parseName has no effect on parseEmail. Rather, you cannot make use of the applicative <em>value</em> (the name parsed by parseName) to choose what applicative <em>computation</em> to run next: you can only ever parse a generic email, rather than, say, parsing an email address while checking that it does not contain the parsed name.</p>\n\n<p>Another way of putting it is that if you use only applicative functions, the overall \"shape\" of your computation is predetermined ahead of time: you will always parse a name, followed by an email address. If you used monadic functions, you could make decisions about what to parse next based on the results of previous parses, letting you change the shape of your computation as it is running.</p>\n"}], "owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 1, "accepted_answer_id": 40833608, "answer_count": 1, "score": 5, "last_activity_date": 1480278982, "creation_date": 1480275266, "last_edit_date": 1480276292, "question_id": 40833051, "link": "https://stackoverflow.com/questions/40833051/are-applicative-functors-composed-with-the-applicative-style-really-independent", "title": "Are applicative functors composed with the applicative style really independent?", "body": "<p>I've come to understand functors, applicative functors, and monads as follows:</p>\n\n<ul>\n<li>Functors: computations that can be mapped over.</li>\n<li>Applicative functors: <em>independent</em> computations whose results can be combined together.</li>\n<li>Monad: (possibly, but not necessarily) dependent computations that can be chained.</li>\n</ul>\n\n<p>However, there is something about Applicative that conflicts with my understanding... Here is a Haskell example of a parser defined on the basis of more basic parsers using the applicative style:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>(,) &lt;$&gt; parseName &lt;*&gt; parseEmail\n</code></pre>\n\n<p>The <em>effects</em> of the two parsers, <code>parseName</code> and <code>parseEmail</code>, are not independent, because they both consume tokens from the same input stream, e.g.</p>\n\n<pre><code>Jubobs jubobs@jubobs.io\n</code></pre>\n\n<p><code>parseEmail</code> can only consume what hasn't been consumed by <code>parseName</code>. How, then, can the two computations be said to be independent?</p>\n"}, {"tags": ["haskell", "interface", "typeclass", "abstraction"], "answers": [{"comments": [{"owner": {"reputation": 663, "user_id": 1376095, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/884037b1b8e55abaacc5c6a20a8829d5?s=128&d=identicon&r=PG&f=1", "display_name": "jackb", "link": "https://stackoverflow.com/users/1376095/jackb"}, "edited": false, "score": 0, "creation_date": 1480276488, "post_id": 40832957, "comment_id": 68884046, "body": "I have a question concerning the last solution, which I prefer the most. If I have the following data  <code>data MemoryMonad a b =  Lift b | Guard b | Elem a (MemoryMonad a b)</code>  how can I make it an instance of this typeclass?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 663, "user_id": 1376095, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/884037b1b8e55abaacc5c6a20a8829d5?s=128&d=identicon&r=PG&f=1", "display_name": "jackb", "link": "https://stackoverflow.com/users/1376095/jackb"}, "edited": false, "score": 2, "creation_date": 1480279150, "post_id": 40832957, "comment_id": 68884893, "body": "@jackb <code>instance MF (MemoryMonad a b) where type ValType (MemoryMonad a b) = a; type ErrType (MemoryMonad a b) = b</code>"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 5, "last_activity_date": 1480275531, "last_edit_date": 1480275531, "creation_date": 1480274740, "answer_id": 40832957, "question_id": 40832800, "link": "https://stackoverflow.com/questions/40832800/haskell-typeclasses-with-parametric-types/40832957#40832957", "title": "Haskell Typeclasses with parametric types", "body": "<p>The most direct way to do this, starting from your code, would be to add <em>functional dependencies</em> to your type class:</p>\n\n<pre><code>{-# LANGUAGE FunctionalDependencies #-}\nclass MF c a b | c -&gt; a, c -&gt; b where\n  ...\n</code></pre>\n\n<p>This essentially just tells the compiler that the type information of <code>a</code> and <code>b</code> is already contained in <code>c</code> (and can thus be extracted at the call site, so <code>a2</code>, <code>b3</code> etc. won't be ambiguous). How exactly to extract this information can be determined be GHC when you define an <code>instance MF</code>. Though usually this works quite well, I find it a bit questionable why you want to do it this way: if <code>c</code> always has the form <code>X a b</code> anyway (and <code>X</code> is a proper <code>data</code>-type-function that can be partially applied), then why even mention <code>a</code> and <code>b</code> in the class head? They're basically redundant. Why not just give the class a single parameter (of kind <code>Type -&gt; Type -&gt; Type</code>) which can then be <em>applied</em> to <code>a</code> and <code>b</code>?</p>\n\n<pre><code>class MF x where\n  mcons :: a -&gt; x a b -&gt; x a b\n  merr :: b -&gt; x a b\n  mhead :: x a b -&gt; ValOrError a b\n  mtail :: x a b -&gt; ValOrError (x a b) b\n</code></pre>\n\n<p>Alternatively, if you really want <code>c</code> to have kind <code>Type</code> (which can indeed make sense!), I should recommend stowing the <code>a</code> and <code>b</code> types in the <em>class definition</em> as type families:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\nclass MF c where\n  type ValType c :: *\n  type ErrType c :: *\n  mcons :: ValType c -&gt; c -&gt; c\n  merr :: ErrType c -&gt; c\n  mhead :: c -&gt; ValOrError (ValType c) (ErrType c)\n  mtail :: c -&gt; ValOrError c (ErrType c)\n</code></pre>\n\n<p>This is basically equivalent to the <code>TypeFamilies</code> solution, but gives a more explicit, less cryptic (albeit also rather more verbose) interface.</p>\n"}], "owner": {"reputation": 663, "user_id": 1376095, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/884037b1b8e55abaacc5c6a20a8829d5?s=128&d=identicon&r=PG&f=1", "display_name": "jackb", "link": "https://stackoverflow.com/users/1376095/jackb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 1, "accepted_answer_id": 40832957, "answer_count": 1, "score": 3, "last_activity_date": 1480275531, "creation_date": 1480273723, "last_edit_date": 1592644375, "question_id": 40832800, "link": "https://stackoverflow.com/questions/40832800/haskell-typeclasses-with-parametric-types", "title": "Haskell Typeclasses with parametric types", "body": "<p>I want to define a specific functor as follows:</p>\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FlexibleInstances #-}\n\ndata ValOrError a b = Val a | Error b\n\nclass MF c a b where\n  mcons :: a -&gt; c -&gt; c\n  merr :: b -&gt; c\n  mhead :: c -&gt; ValOrError a b\n  mtail :: c -&gt; ValOrError c b\n</code></pre>\n<p>I want that my typeclass <code>MF</code> on type <code>c</code> has type parameters <code>a</code> and <code>b</code>. I tried to define a filter function on such data structure as follows:</p>\n<pre><code>mfilter f e =\n  let h = mhead e in\n  let t = mtail e in\n  case h of\n    Error b -&gt; e\n    Val a -&gt; case (f a) of\n      True -&gt; case t of\n        Error d -&gt; mcons a (merr d)\n        Val b -&gt; mcons a (mfilter f b)\n      False -&gt; case t of\n        Error d -&gt; merr d\n        Val b -&gt; mfilter f b\n</code></pre>\n<p>But I got the following error:</p>\n<blockquote>\n<p>haskell.hs:24:1:</p>\n<pre><code>Could not deduce (MF c a2 b3)\n  arising from the ambiguity check for \u2018mfilter\u2019\nfrom the context (MF c a5 b6,\n                  MF c a4 b5,\n                  MF c a4 b4,\n                  MF c a4 b,\n                  MF c a3 b6,\n                  MF c a b6)\n  bound by the inferred type for \u2018mfilter\u2019:\n             (MF c a5 b6, MF c a4 b5, MF c a4 b4,\n              MF c a4 b, MF c a3 b6, MF c a b6) =&gt;\n             (a4 -&gt; Bool) -&gt; c -&gt; c\n  at haskell.hs:(24,1)-(35,28)\nThe type variables \u2018a2\u2019, \u2018b3\u2019 are ambiguous\nWhen checking that \u2018mfilter\u2019\n  has the inferred type \u2018forall b c a b1 a1 a2 b2 a3 b3.\n                         (MF c a3 b3, MF c a2 b2, MF c a2 b1,\n                          MF c a2 b, MF c a1 b3, MF c a b3) =&gt;\n                         (a2 -&gt; Bool) -&gt; c -&gt; c\u2019\nProbable cause: the inferred type is ambiguous\n</code></pre>\n</blockquote>\n<p>I'm wondering if there is a better way in haskell to state that the type <code>c</code> always has <code>a</code> and <code>b</code> as type parameters. Using a Java-like syntax:</p>\n<pre><code>public interface MF&lt;A,B&gt; {\n   MF&lt;A,B&gt; mcons(A head, MF&lt;A,B&gt; tail);\n   MF&lt;A,B&gt; merr(B error);\n   ValOrError&lt;A,B&gt; head(MF&lt;A,B&gt; e);\n   ValOrError&lt;MF&lt;A,B&gt;,B&gt; tail(MF&lt;A,B&gt; e);\n}\n</code></pre>\n<p>Plus, on the other hand, the filter function should have a type:</p>\n<pre><code>mfilter :: (a -&gt; Bool) -&gt; MF c a b -&gt; MF c a b\n</code></pre>\n"}, {"tags": ["haskell", "luhn"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1480271874, "post_id": 40832422, "comment_id": 68882497, "body": "And your <code>if</code> expression appears invalid. You&#39;re missing an &quot;else&quot; case."}, {"owner": {"reputation": 376, "user_id": 4782402, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/yJy6f.png?s=128&g=1", "display_name": "TheCoolFrood", "link": "https://stackoverflow.com/users/4782402/thecoolfrood"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1480271942, "post_id": 40832422, "comment_id": 68882520, "body": "Oh yeah, sorry i forgot. I&#39;ll add it in now!"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 4, "creation_date": 1480272024, "post_id": 40832422, "comment_id": 68882548, "body": "And you&#39;re using <code>mod</code> as infix, but don&#39;t have it wrapped in backticks, so it&#39;s being treated as an argument. That&#39;s probably your error."}], "answers": [{"comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1480272377, "post_id": 40832531, "comment_id": 68882667, "body": "I added an edit. Sorry if it conflicts with your intent."}], "tags": [], "owner": {"reputation": 3967, "user_id": 3853711, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/SwXly.png?s=128&g=1", "display_name": "Rahn", "link": "https://stackoverflow.com/users/3853711/rahn"}, "is_accepted": true, "score": 3, "last_activity_date": 1480279780, "last_edit_date": 1480279780, "creation_date": 1480272111, "answer_id": 40832531, "question_id": 40832422, "link": "https://stackoverflow.com/questions/40832422/luhn-function-in-haskell/40832531#40832531", "title": "Luhn function in Haskell", "body": "<pre><code>luhn :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Bool\nluhn w x y z = if (((luhnDouble w) + x + (luhnDouble y) + z) mod 10) == 0 then True\n</code></pre>\n\n<ol>\n<li>You didn't give it an <code>else</code> after <code>if</code>.</li>\n<li>You are calling prefix <code>mod</code>, not infix <code>`mod`</code>.</li>\n</ol>\n\n<p>Fix:</p>\n\n<pre><code>luhn :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Bool\nluhn w x y z = if (((luhnDouble w) + x + (luhnDouble y) + z) `mod` 10) == 0\n                  then True\n                  else False\n</code></pre>\n\n<p>or</p>\n\n<pre><code>luhn :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Bool\nluhn w x y z = if (mod ((luhnDouble w) + x + (luhnDouble y) + z) 10) == 0\n                  then True\n                  else False\n</code></pre>\n\n<p>or, a less redundant version:</p>\n\n<pre><code>luhn :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Bool\nluhn w x y z = (mod ((luhnDouble w) + x + (luhnDouble y) + z) 10) == 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 12889081, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBq78xsaP8x8I9J1f78Umh8-U5x0B-r64d2rcKb7w=k-s128", "display_name": "Eric Kwarteng", "link": "https://stackoverflow.com/users/12889081/eric-kwarteng"}, "is_accepted": false, "score": 1, "last_activity_date": 1581567086, "last_edit_date": 1581567086, "creation_date": 1581555496, "answer_id": 60199034, "question_id": 40832422, "link": "https://stackoverflow.com/questions/40832422/luhn-function-in-haskell/60199034#60199034", "title": "Luhn function in Haskell", "body": "<pre><code>luhn :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Bool\nluhn w x y z = (luhnDouble w + x + luhnDouble y + z) `mod` 10 == 0\n</code></pre>\n\n<p>This will work</p>\n"}], "owner": {"reputation": 376, "user_id": 4782402, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/yJy6f.png?s=128&g=1", "display_name": "TheCoolFrood", "link": "https://stackoverflow.com/users/4782402/thecoolfrood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 668, "favorite_count": 1, "accepted_answer_id": 40832531, "answer_count": 2, "score": 4, "last_activity_date": 1581567086, "creation_date": 1480271550, "last_edit_date": 1480284208, "question_id": 40832422, "link": "https://stackoverflow.com/questions/40832422/luhn-function-in-haskell", "title": "Luhn function in Haskell", "body": "<p>I'm currently working through the book <a href=\"http://www.cs.nott.ac.uk/~pszgmh/pih.html\" rel=\"nofollow noreferrer\">Programming in Haskell</a> (which is absolutely amazing so far), but ran into a problem in exercise 4.8.8.</p>\n\n<p>The task is to implement the <em><a href=\"https://en.wikipedia.org/wiki/Luhn_algorithm\" rel=\"nofollow noreferrer\">Luhn algorithm</a></em> in Haskell, using a help function <code>luhnDouble :: Int -&gt; Int</code> (which doubles a digit and subtracts 9 if the result is greater than 9) and the <code>mod</code> funcion.</p>\n\n<p>Implementing the <code>luhnDouble</code> function was no problem, but I'm struggling to bring both of them into a function of type <code>Int -&gt; Int -&gt; Int -&gt; Int -&gt; Bool</code>.</p>\n\n<p>I have tried doing it two ways:</p>\n\n<pre><code>luhn :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Bool\nluhn w x y z = if (((luhnDouble w) + x + (luhnDouble y) + z) mod 10) == 0 then True\n               else False\n</code></pre>\n\n<p>I receive a type error. </p>\n\n<pre><code>* Couldn't match expected type `(Integer -&gt; Integer -&gt; Integer)\n                                -&gt; Integer -&gt; Integer'\n              with actual type `Int'\n* The function `(luhnDouble w) + x + (luhnDouble y) + z'\n  is applied to two arguments,\n  but its type `Int' has none\n  In the first argument of `(==)', namely\n    `(((luhnDouble w) + x + (luhnDouble y) + z) mod 10)'\n  In the expression:\n    (((luhnDouble w) + x + (luhnDouble y) + z) mod 10) == 0\n</code></pre>\n\n<p>But am I not giving the functions 4 <code>Int</code>s as arguments and getting a <code>Bool</code> as a result?</p>\n\n<p>I then tried currying the function and using <em>lambda expressions</em>:</p>\n\n<pre><code>luhn :: Int -&gt; (Int -&gt; (Int -&gt; Bool))\nluhn = \\w -&gt;(\\x -&gt;(\\y -&gt; (\\z -&gt; ((luhnDouble w) + x + (luhnDouble y) + z mod 10))))\n</code></pre>\n\n<p>But I'm not sure how to bring in the <code>if</code> expression in here to get a <code>Bool</code> value as a result.</p>\n\n<p>Could anyone help me out, and give me a tip how I could solve this?</p>\n"}, {"tags": ["haskell", "scope", "ml"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 3, "creation_date": 1480271860, "post_id": 40832421, "comment_id": 68882493, "body": "What do you mean by &quot;implement&quot;? Do you want code samples that are themselves with static scope, dynamic scope, or lazy evaluation, or do you want to implement an interpreter in ml or Haskell that has these features? In either case, the question is a bit broad."}, {"owner": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "edited": false, "score": 0, "creation_date": 1480272447, "post_id": 40832421, "comment_id": 68882690, "body": "<a href=\"http://okmij.org/ftp/Computation/dynamic-binding.html\" rel=\"nofollow noreferrer\">okmij.org/ftp/Computation/dynamic-binding.html</a>"}, {"owner": {"reputation": 9, "user_id": 5713003, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KUIhb.jpg?s=128&g=1", "display_name": "Mike Harris", "link": "https://stackoverflow.com/users/5713003/mike-harris"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480272834, "post_id": 40832421, "comment_id": 68882808, "body": "@Alec the first option"}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1480290596, "post_id": 40834365, "comment_id": 68887896, "body": "There is an extension for dynamically scoped variables: <code>ImplicitParams</code>. For example, if you have <code>pr :: (?currentOutputHandle :: Handle, Show a) =&gt; a -&gt; IO (); pr x = hPrint ?currentOutputHandle x</code>, then you can locally redirect the output with e.g. <code>let ?currentOutputHandle = stderr in pr &quot;foo&quot;</code>."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1480290943, "post_id": 40834365, "comment_id": 68887972, "body": "You&#39;re right!  And I was just looking at this extensions a few hours ago without making the connection."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 2, "last_activity_date": 1480291837, "last_edit_date": 1480291837, "creation_date": 1480283640, "answer_id": 40834365, "question_id": 40832421, "link": "https://stackoverflow.com/questions/40832421/how-to-implement-static-scope-dynamic-scope-and-lazy-evaluation-in-ml-and-hask/40834365#40834365", "title": "How to implement static scope, dynamic scope, and lazy evaluation in ml and haskell?", "body": "<p>Haskell variables (top level definitions, variables in patterns, etc.) are all statically scoped.  For example, the program:</p>\n\n<pre><code>y = \"global value\"\nf = print y\ng = let y = \"local value\" in f\n\nmain = g\n</code></pre>\n\n<p>will print \"global value\".  Even though, in the definition of <code>g</code>, the function <code>f</code> is used after \"redefining\" <code>y</code>, this redefinition doesn't affect the definition of <code>f</code> which uses the statically (AKA lexically) scoped definition of <code>y</code> in force where <code>f</code> was defined.</p>\n\n<p>If you want to \"implement\" dynamic scope, you have to be more specific about what you really mean.  If you're wondering if you can write a function in plain Haskell, like:</p>\n\n<pre><code>addY :: Int -&gt; Int\naddY x = x + y\n</code></pre>\n\n<p>such that <code>y</code> might refer to a different variable from one call to the next, then the answer is no.  In this definition, <code>y</code> always refers to the same variable (which, in Haskell, means the same, immutable value) which can be determined by static analysis of the program and cannot be dynamically redefined.</p>\n\n<p>[[Edit:  As @Jon Purdy points out, though, there's a Haskell extension that supports a form of dynamic scope such that the following prints various dynamically scoped local values with the same function.</p>\n\n<pre><code>{-# LANGUAGE ImplicitParams #-}\nf :: (?y :: String) =&gt; IO ()\nf = print ?y\ng = let ?y = \"g's local value\" in f\nh = let ?y = \"h's local value\" in f\nmain = do\n  g                -- prints g's local value\n  h                -- prints h's local value\n  let ?y = \"main's local value\" in f  -- prints main's value\n</code></pre>\n\n<p>--end of edit--]]</p>\n\n<p>For lazy evaluation, there are many examples, such as the following entered into an interactive GHCi session:</p>\n\n<pre><code>take 3 [1,2..]    -- gives [1,2,3]\n\nlet x = (15^2, 6 `div` 0)\nfst x             -- gives 225\nlet y = snd x\ny                 -- *** Exception: divide by zero\n</code></pre>\n\n<p>In the first line, if the evaluation was strict, the attempt to fully evaluate the infinite list <code>[1,2..]</code> (can also be written <code>[1..]</code> -- just counts up 1,2,3,.. forever) would go into an infinite loop, and the <code>take</code> function would never be called.  In the second example, if evaluation was strict, the division by zero error would occur when <code>x</code> was defined, not only after we tried to print its second component.</p>\n"}], "owner": {"reputation": 9, "user_id": 5713003, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KUIhb.jpg?s=128&g=1", "display_name": "Mike Harris", "link": "https://stackoverflow.com/users/5713003/mike-harris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1031, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1480291837, "creation_date": 1480271550, "question_id": 40832421, "link": "https://stackoverflow.com/questions/40832421/how-to-implement-static-scope-dynamic-scope-and-lazy-evaluation-in-ml-and-hask", "title": "How to implement static scope, dynamic scope, and lazy evaluation in ml and haskell?", "body": "<p>I understand conceptually what all of these are, I'm just hoping for some code examples of how to implement them in ML and Haskell.</p>\n"}, {"tags": ["haskell", "syntax", "io", "main", "keyword"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1480270833, "post_id": 40832232, "comment_id": 68882196, "body": "I think this question is too broad, and you would do better to read the <code>Monad</code> chapter in a haskell book. You might be able to answer your question by searching &quot;desugaring do notation haskell&quot; on this site or google, but you are likely to need more background"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 3, "creation_date": 1480271041, "post_id": 40832232, "comment_id": 68882260, "body": "<a href=\"https://en.wikibooks.org/wiki/Haskell/do_notation\" rel=\"nofollow noreferrer\"><code>do</code> notation</a> is sugar for common monadic code. Without <code>do</code>, you could write <code>main = print (isEven 2) &gt;&gt; print (isOdd 2)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 796, "user_id": 3124459, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/P0T9Y.jpg?s=128&g=1", "display_name": "Dovahkiin", "link": "https://stackoverflow.com/users/3124459/dovahkiin"}, "edited": false, "score": 1, "creation_date": 1480271418, "post_id": 40832326, "comment_id": 68882355, "body": "Can you use the &quot;do&quot; syntax with more then two statements?"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1480290808, "post_id": 40832326, "comment_id": 68887938, "body": "You might want to add <code>hFlush stdout</code> after the <code>putStr</code> calls to ensure the prompt is displayed if line-buffering is on."}], "tags": [], "owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "is_accepted": false, "score": 5, "last_activity_date": 1480335841, "last_edit_date": 1480335841, "creation_date": 1480271042, "answer_id": 40832326, "question_id": 40832232, "link": "https://stackoverflow.com/questions/40832232/what-does-haskells-do-keyword-do/40832326#40832326", "title": "What does Haskell&#39;s &quot;do&quot; keyword do?", "body": "<p>I think for the time being you will just have to accept it. Yes, the <code>do</code>-notation is syntactic sugar for the monad type class. Your code could be desugared to the following:</p>\n\n<pre><code>main = print (isEven 2) &gt;&gt; print (isOdd 2)\n</code></pre>\n\n<p><code>(&gt;&gt;)</code> means something like do this after that in this particular case. However there is really no good in trying to explain Haskell IO and monads in a StackOverflow answer. Instead I recommend you to just keep learning until your book or whatever you use as a learning resource covers the topic.</p>\n\n<p>Here is however a quick example of what you can do inside of <code>IO</code>-<code>do</code>. Don't bother about the syntax too much.</p>\n\n<pre><code>import System.IO\nmain = do\n  putStr \"What's your name? \"  -- Print strings\n  hFlush stdout                -- Flush output\n  name &lt;- getLine              -- Get input and save into variable name\n  putStrLn (\"Hello \" ++ name)\n  putStr \"What's your age? \"\n  hFlush stdout\n  age &lt;- getLine\n  putStr \"In one year you will be \"\n  print (read age + 1)         -- convert from string to other things with read\n                               -- use print to print things that are not strings\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4150, "user_id": 1698736, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d4a0d13ad1606bcbd222a01471aee065?s=128&d=identicon&r=PG", "display_name": "cowlinator", "link": "https://stackoverflow.com/users/1698736/cowlinator"}, "edited": false, "score": 0, "creation_date": 1594079509, "post_id": 40832398, "comment_id": 110995016, "body": "<code>there&#39;s no meaningful concept of calling one function after another</code>... except in <code>do</code> blocks, right?  Inside a <code>do</code> block, there is a concept of calling one function after another.  So, does that mean that Haskell is only purely functional outside of <code>do</code> blocks?"}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 16, "last_activity_date": 1565981888, "last_edit_date": 1565981888, "creation_date": 1480271398, "answer_id": 40832398, "question_id": 40832232, "link": "https://stackoverflow.com/questions/40832232/what-does-haskells-do-keyword-do/40832398#40832398", "title": "What does Haskell&#39;s &quot;do&quot; keyword do?", "body": "<blockquote>\n  <p>Why doesn't the first code snippet work?</p>\n</blockquote>\n\n<p>Outside of a <code>do</code> block, line breaks don't have any significance. So your first definition of <code>main</code> is equivalent to <code>main = print (isEven 2) print (isOdd 2)</code>, which fails because <code>print</code> only takes one argument.</p>\n\n<p>Now you may wonder why we can't just use line breaks to signify that one function should be called after another. The problem with that is that Haskell is (usually) lazy and purely functional, so functions don't have side-effects and there's no meaningful concept of calling one function after another.</p>\n\n<p>So then how does <code>print</code> work at all? <code>print</code> is a function that takes a string and produces a result of type <code>IO ()</code>. <code>IO</code> is a type that represents possibly side-effecting operations. <code>main</code> produces a value of this type and the operations described by that value will then be executed. And while there's no meaningful concept of calling one function after another, there is a meaningful concept of executing one IO value's operation after another one's. For this we use the <code>&gt;&gt;</code> operator, which chains two IO values together.</p>\n\n<blockquote>\n  <p>I saw something about \"monads\" on the internet related to the \"do\" keyword, does that have something to do with this?</p>\n</blockquote>\n\n<p>Yes, <code>Monad</code> is a type class (if you don't know what those are yet: they're similar to interfaces in OO languages), which (among others) provides the functions <code>&gt;&gt;</code> and <code>&gt;&gt;=</code>. <code>IO</code> is one instance of that type class (in OO terms: one type that implements that interface), which uses those methods to chain multiple operations after each other.</p>\n\n<p>The <code>do</code> syntax is a more convenient way of using <code>&gt;&gt;</code> and <code>&gt;&gt;=</code>. Specifically your definition of main is equivalent to the following without <code>do</code>:</p>\n\n<pre><code>main = (print (isEven 2)) &gt;&gt; (print (isOdd 2))\n</code></pre>\n\n<p>(The extra parentheses aren't necessary, but I added them to avoid any confusion about precedence.)</p>\n\n<p>So <code>main</code> produces an IO value that executes the steps of <code>print (isEven 2)</code>, followed by those of <code>print (isOdd 2)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "is_accepted": false, "score": 0, "last_activity_date": 1480272863, "last_edit_date": 1480272863, "creation_date": 1480271988, "answer_id": 40832508, "question_id": 40832232, "link": "https://stackoverflow.com/questions/40832232/what-does-haskells-do-keyword-do/40832508#40832508", "title": "What does Haskell&#39;s &quot;do&quot; keyword do?", "body": "<p>You know that the result of a function should only depend on its input, so let's model <code>print</code> to reflect that:</p>\n\n<pre><code>print :: String -&gt; RealWorld -&gt; (RealWorld, ())\n</code></pre>\n\n<p><code>main</code> would then look like this:</p>\n\n<pre><code>main rw0 = let (rw1, _) = print (isEven 2) rw0 in\n                          print (isOdd 2) rw1\n</code></pre>\n\n<p>Now let's define <code>bind f g rw = let (rw', ret) = f rw in g rw'</code> which does this handing through of the <code>RealWorld</code> state and rewrite the snippet to use it:</p>\n\n<pre><code>main = bind (print (isEven 2))\n            (print (isOdd 2))\n</code></pre>\n\n<p>Now let's introduce some syntax sugar that does the <code>bind</code>ing for us</p>\n\n<pre><code>main = do print (isEven 2)\n          print (isOdd 2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 3, "last_activity_date": 1480272425, "creation_date": 1480272425, "answer_id": 40832577, "question_id": 40832232, "link": "https://stackoverflow.com/questions/40832232/what-does-haskells-do-keyword-do/40832577#40832577", "title": "What does Haskell&#39;s &quot;do&quot; keyword do?", "body": "<p>Haskell functions are \"pure\" and have no notion of sequencing apart from \"data dependencies\": the result value of a function used as argument to another. At the basic level, there are no statements to be sequenced, only values.</p>\n\n<p>There is a type constructor called <code>IO</code>. It can be applied to other types: <code>IO Int</code>, <code>IO Char</code>, <code>IO String</code>. <code>IO sometype</code> means: \"this value is a recipe for doing some stuff in the real world and returning a value of <code>sometype</code>, once the recipe is executed by the runtime\". </p>\n\n<p>That's why <code>main</code> has type <code>IO ()</code>. You give a recipe for doing stuff in the real world. <code>()</code> is a type with only one value, which provides no information. <code>main</code> is executed only for its effects in the real world.</p>\n\n<p>There are a number of operators for combining <code>IO</code> recipes. A simple one is <code>&gt;&gt;</code> that takes two recipes and returns a recipe for executing the first recipe, then the second. Notice that the combination is done in a pure way, using mere functions, even if the composite recipe actually resembles the sequential statements of imperative programming (\"Print this message, then this other message\").</p>\n\n<p>To simplify the construction of these \"imperative recipes\", <em>do-notation</em> was created. It lets you write something resembling the sequential statements of an imperative language, but then it desugars to function applications. Everything you can write in do-notation, you can write (sometimes less clearly) with regular function application.</p>\n"}], "owner": {"reputation": 796, "user_id": 3124459, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/P0T9Y.jpg?s=128&g=1", "display_name": "Dovahkiin", "link": "https://stackoverflow.com/users/3124459/dovahkiin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1592, "favorite_count": 0, "accepted_answer_id": 40832398, "answer_count": 4, "score": 7, "last_activity_date": 1565981888, "creation_date": 1480270456, "last_edit_date": 1480275469, "question_id": 40832232, "link": "https://stackoverflow.com/questions/40832232/what-does-haskells-do-keyword-do", "title": "What does Haskell&#39;s &quot;do&quot; keyword do?", "body": "<p>I'm a C++/Java programmer, and I'm trying to learn Haskell (and functional programming in general), and I've been having a rough go at it. One thing I tried was this:</p>\n\n<pre><code>isEven :: Int -&gt; Bool\nisEven x =\n    if mod x 2 == 0 then True\n    else False\n\nisOdd :: Int -&gt; Bool\nisOdd x =\n    not (isEven x)\n\nmain =\n    print (isEven 2)\n    print (isOdd 2)\n</code></pre>\n\n<p>But this failed with this error during compilation:</p>\n\n<pre><code>ghc --make doubler.hs -o Main\n[1 of 1] Compiling Main             ( doubler.hs, doubler.o )\n\ndoubler.hs:11:5: error:\n    \u2022 Couldn't match expected type \u2018(a0 -&gt; IO ()) -&gt; Bool -&gt; t\u2019\n              with actual type \u2018IO ()\u2019\n    \u2022 The function \u2018print\u2019 is applied to three arguments,\n      but its type \u2018Bool -&gt; IO ()\u2019 has only one\n      In the expression: print (isEven 2) print (isOdd 2)\n      In an equation for \u2018main\u2019: main = print (isEven 2) print (isOdd 2)\n    \u2022 Relevant bindings include main :: t (bound at doubler.hs:10:1)\nmake: *** [all] Error 1\n</code></pre>\n\n<p>So, I saw some code online with the \"do\" keyword, so I tried it like this:</p>\n\n<pre><code>isEven :: Int -&gt; Bool\nisEven x =\n    if mod x 2 == 0 then True\n    else False\n\nisOdd :: Int -&gt; Bool\nisOdd x =\n    not (isEven x)\n\nmain = do\n    print (isEven 2)\n    print (isOdd 2)\n</code></pre>\n\n<p>And it worked exactly like I thought it should.</p>\n\n<p>What's going on here? Why doesn't the first code snippet work? And what does adding \"do\" actually do?</p>\n\n<p>PS. I saw something about \"monads\" on the internet related to the \"do\" keyword, does that have something to do with this?</p>\n"}, {"tags": ["haskell", "ocaml", "ffi"], "answers": [{"tags": [], "owner": {"reputation": 8612, "user_id": 939931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caf7789eb96131e90e62cc808e8a079c?s=128&d=identicon&r=PG", "display_name": "camlspotter", "link": "https://stackoverflow.com/users/939931/camlspotter"}, "is_accepted": true, "score": 1, "last_activity_date": 1480298643, "last_edit_date": 1480298643, "creation_date": 1480298258, "answer_id": 40836126, "question_id": 40831945, "link": "https://stackoverflow.com/questions/40831945/linking-ocaml-code-with-shared-library/40836126#40836126", "title": "linking OCaml code with shared library", "body": "<p>It seems <code>Quelea.Shim</code> is a module of Haskell.  OCaml is a different language from Haskell and therefore cannot understand Haskell module paths.</p>\n\n<p>I have never tried something like this but possible scenario is:</p>\n\n<ul>\n<li>Understand how to load Haskell modules and call functions from ordinary C programs.</li>\n<li>Write a small C function to load the Haskell modules you want. Probably it must prepare entry points of Haskell functions for OCaml.</li>\n<li>Call the loader from OCaml</li>\n</ul>\n"}], "owner": {"reputation": 313, "user_id": 3703378, "user_type": "registered", "accept_rate": 61, "profile_image": "https://graph.facebook.com/100001130222980/picture?type=large", "display_name": "Kapil", "link": "https://stackoverflow.com/users/3703378/kapil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 40836126, "answer_count": 1, "score": 4, "last_activity_date": 1480298643, "creation_date": 1480268744, "question_id": 40831945, "link": "https://stackoverflow.com/questions/40831945/linking-ocaml-code-with-shared-library", "title": "linking OCaml code with shared library", "body": "<p>I compiled a Haskell source package implementing an FFI as a (.so) dynamic library. I would like to call the functions exported via the FFI in OCaml. For this I implemented a simple driver file as follows</p>\n\n<pre><code>open Quelea.Shim\nopen Ctypes\nopen PosixTypes\nopen Foreign\n\nlet readEffects = \n    foreign \"readEffects\" (ptr char @-&gt; ptr char @-&gt; returning ptr string)\n\nlet effects = readEffects \"csasc\" \"saxasxas\"\n\nprint_list effects\n\nlet rec print_list = function \n                [] -&gt; ()\n                | e::l -&gt; print_int e ; print_string \" \" ; print_list l\n</code></pre>\n\n<p>Where readEffects is a function in the Quelea.Shim module of the Haskell source exported via the FFI with the following signature</p>\n\n<pre><code>foreign export ccall readEffects :: CString -&gt; CString -&gt; IO (Ptr CString)\n</code></pre>\n\n<p>I tried compiling the file above (main.ml) as follows</p>\n\n<pre><code> ocamlc -dllpath /home/parallels/.cabal/lib/Quelea-0.0.1/ghc-7.6.3 main.ml\n</code></pre>\n\n<p>The directory <code>/home/parallels/.cabal/lib/Quelea-0.0.1/ghc-7.6.3</code> contains the library file <code>libHSQuelea-0.0.1-ghc7.6.3.so</code>. </p>\n\n<p>I get the error <code>Error: Unbound module Quelea</code>. How do I link the library with the driver file correctly?</p>\n"}, {"tags": ["haskell", "monads", "functor"], "answers": [{"tags": [], "owner": {"reputation": 4337, "user_id": 649727, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1cb3b3d7e0ccce5f039c37f9bd85de11?s=128&d=identicon&r=PG", "display_name": "phynfo", "link": "https://stackoverflow.com/users/649727/phynfo"}, "is_accepted": false, "score": 1, "last_activity_date": 1480261394, "creation_date": 1480261394, "answer_id": 40830718, "question_id": 40830567, "link": "https://stackoverflow.com/questions/40830567/monad-unboxing/40830718#40830718", "title": "Monad &quot;unboxing&quot;", "body": "<p>What \"unwrap\" means depends on the container. <code>Maybe</code> is just one example. \"Unwrapping\" means something completely different when the container is <code>[]</code> instead of <code>Maybe</code>.</p>\n\n<p>The magical about the whole unwrapping thing is the abstraction: In a Monad we have a notion of \"unwrapping\" which abstracts the nature of the container; and then it starts to get \"magical\"...</p>\n\n<p>You ask what <code>Just</code> means: Just is nothing but a Datatype constructor in Haskell defined via a data declaration like :</p>\n\n<pre><code> data Maybe a = Just a | Nothing\n</code></pre>\n\n<p><code>Just</code> take a value of type <code>a</code> and creates a value of type <code>Maybe a</code>. It's Haskell's way to distinguigh values of type <code>a</code> from values of type <code>Maybe a</code></p>\n"}, {"tags": [], "owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "is_accepted": true, "score": 7, "last_activity_date": 1480772798, "last_edit_date": 1480772798, "creation_date": 1480261495, "answer_id": 40830740, "question_id": 40830567, "link": "https://stackoverflow.com/questions/40830567/monad-unboxing/40830740#40830740", "title": "Monad &quot;unboxing&quot;", "body": "<p>First of all, I don't think you can understand Monads and the like without understanding a Haskell like type system (i.e. without learning a language like Haskell). Yes, there are many tutorials that claim otherwise, but I've read a lot of them before learning Haskell and I didn't get it. So my advice: If you want to understand Monads learn at least some Haskell.</p>\n\n<p>To your question \"Why do we distinguish <code>Just 5</code> from <code>5</code> on the programming language level?\". For type safety. In most languages that happen not to be Haskell <code>null</code>, <code>nil</code>, <code>whatever</code>, is often used to represent the absence of a value. This however often results in things like <code>NullPointerExceptions</code>, because you didn't anticipate that a value may not be there.</p>\n\n<p>In Haskell there is no <code>null</code>. So if you have a value of type <code>Int</code>, or anything else, that value can not be <code>null</code>. You are guarantied that there is a value. Great! But sometimes you actually want/need to encode the absence of a value. In Haskell we use <code>Maybe</code> for that. So something of type <code>Maybe Int</code> can either be something like <code>Just 5</code> or <code>Nothing</code>. This way it is explicit that the value may not be there and you can not accidentally forget that it might be <code>Nothing</code> because you have to explicitly unwrap the value.</p>\n\n<p>This has nothing really to do with Monads, except that <code>Maybe</code> happens to implement the Monad type class (a type class is a bit like a Java interface, if you are familiar with Java). That is Maybe is not primarily a Monad, but just happens to also be a Monad.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1480267040, "creation_date": 1480267040, "answer_id": 40831636, "question_id": 40830567, "link": "https://stackoverflow.com/questions/40830567/monad-unboxing/40831636#40831636", "title": "Monad &quot;unboxing&quot;", "body": "<p>A possible example is this: consider the Haskell type <code>Maybe (Maybe Int)</code>. Its values can be of the following form</p>\n\n<ul>\n<li><code>Nothing</code></li>\n<li><code>Just Nothing</code></li>\n<li><code>Just (Just n)</code> for some integer <code>n</code></li>\n</ul>\n\n<p>Without the <code>Just</code> wrapper we couldn't distinguish between the first two.</p>\n\n<p>Indeed, the whole point of the optional type <code>Maybe a</code> is to add a new value (<code>Nothing</code>) to an existing type <code>a</code>. To ensure such <code>Nothing</code> is indeed a fresh value, we wrap the other values inside <code>Just</code>.</p>\n\n<p>It also helps during type inference. When we see the function call <code>f 'a'</code> we can see that <code>f</code> is called at the type <code>Char</code>, and not at type <code>Maybe Char</code> or <code>Maybe (Maybe Char)</code>. The typeclass system would allow <code>f</code> to have a different implementation in each of these cases (this is similar to \"overloading\" in some OOP languages).</p>\n"}, {"tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": false, "score": 4, "last_activity_date": 1480268852, "creation_date": 1480268852, "answer_id": 40831969, "question_id": 40830567, "link": "https://stackoverflow.com/questions/40830567/monad-unboxing/40831969#40831969", "title": "Monad &quot;unboxing&quot;", "body": "<p>I think you're looking at this from the wrong direction.  <code>Monad</code> is explicitly <em>not</em> about unwrapping.  <code>Monad</code> is about composition.</p>\n\n<p>It lets you combine (not necessarily apply) a function of type <code>a -&gt; m b</code> with a value of type <code>m a</code> to get a value of type <code>m b</code>.  I can understand where you might think the obvious way to do that is unwrapping the value of type <code>m a</code> into an value of type <code>a</code>.  But very few <code>Monad</code> instances work that way.  In fact, the only ones that can work that way are the ones that are equivalent to the <code>Identity</code> type.  For nearly all instances of <code>Monad</code>, it's just not possible to unwrap a value.</p>\n\n<p>Consider <code>Maybe</code>.  Unwrapping a value of type <code>Maybe a</code> into a value of type <code>a</code> is impossible when the starting value is <code>Nothing</code>.  Monadic composition has to do something more interesting than just unwrapping.</p>\n\n<p>Consider <code>[]</code>.  Unwrapping a value of type <code>[a]</code> into a value of type <code>a</code> is impossible unless the input just happens to be a list of length 1. In every other case, monadic composition is doing something more interesting than unwrapping.</p>\n\n<p>Consider <code>IO</code>.  A value like <code>getLine :: IO String</code> doesn't contain a <code>String</code> value.  It's plain impossible to unwrap, because it isn't wrapping something.  Monadic composition of <code>IO</code> values doesn't unwrap anything. It combines <code>IO</code> values into more complex <code>IO</code> values.</p>\n\n<p>I think it's worthwhile to adjust your perspective on what <code>Monad</code> means. If it were only an unwrapping interface, it would be pretty useless. It's more subtle, though. It's a composition interface.</p>\n"}, {"tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1480269922, "creation_date": 1480269922, "answer_id": 40832142, "question_id": 40830567, "link": "https://stackoverflow.com/questions/40830567/monad-unboxing/40832142#40832142", "title": "Monad &quot;unboxing&quot;", "body": "<p>First of all, you need to remove monads from your question. They have nothing to do this. Treat this articles as one of the points of view on the monads, maybe it does not suit you, you may still little understood in the type system that would understand monads in haskell.</p>\n\n<p>And so, your question can be rephrased as: Why is there no implicit conversion <code>Just 5 =&gt; 5</code>? But answer is very simple. Because value <code>Just 5</code> has type <code>Maybe Integer</code>, so this value may would be <code>Nothing</code>, but what must do compiler in this case? Only programmer can resolve this situation.</p>\n\n<p>But there is more uncomfortable question. There are types, for example, <code>newtype Identity a = Identity a</code>. It's just wrapper around some value. So, why is there no impliciti conversion <code>Identity a =&gt; a</code>?</p>\n\n<p>The simple answer is - an attempt to realize this would lead to a different system types, which would not have had many fine qualities that exist in the current. According to this, it can be sacrificed for the benefit of other possibilities.</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 2, "last_activity_date": 1480719403, "last_edit_date": 1495540903, "creation_date": 1480276777, "answer_id": 40833282, "question_id": 40830567, "link": "https://stackoverflow.com/questions/40830567/monad-unboxing/40833282#40833282", "title": "Monad &quot;unboxing&quot;", "body": "<blockquote>\n  <p>My question is, what is so magical about the whole unwrapping thing?</p>\n</blockquote>\n\n<p>There is nothing magical about it. You can use garden-variety pattern matching (here in the shape of a <code>case</code> expression) to define...</p>\n\n<pre><code>mapMaybe :: (a -&gt; b) -&gt; Maybe a -&gt; Maybe b\nmapMaybe f mx = case mx of\n    Just x -&gt; Just (f x)\n    _ -&gt; mx\n</code></pre>\n\n<p>... which is exactly the same than <code>fmap</code> for <code>Maybe</code>. The only thing the <code>Functor</code> class adds -- and it is a very useful thing, make no mistake -- is an extra level of abstraction that covers various structures that can be mapped over.</p>\n\n<blockquote>\n  <p>Why do we distinguish <code>Just 5</code> from <code>5</code> on programming language level?</p>\n</blockquote>\n\n<p>More meaningful than the distinction between <code>Just 5</code> and <code>5</code> is the one between their <em>types</em> -- e.g. between <code>Maybe Int</code>and <code>Int</code>. If you have <code>x :: Int</code>, you can be certain <code>x</code> is an <code>Int</code> value you can work with. If you have <code>mx :: Maybe Int</code>, however, you have no such certainty, as the <code>Int</code> might be missing (i.e. <code>mx</code> might be <code>Nothing</code>), and the type system forces you to acknowledge and deal with this possibility.</p>\n\n<p>See also: <a href=\"https://stackoverflow.com/a/40830740/2751851\">jpath's answer</a> for further comments on the usefulness of <code>Maybe</code> (which isn't necessarily tied to classes such as <code>Functor</code> and <code>Monad</code>); <a href=\"https://stackoverflow.com/a/40831969/2751851\">Carl's answer</a> for further comments on the usefulness of classes like <code>Functor</code> and <code>Monad</code> (beyond the <code>Maybe</code> example).</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3292534"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 642, "favorite_count": 1, "accepted_answer_id": 40830740, "answer_count": 6, "score": 0, "last_activity_date": 1480772798, "creation_date": 1480260434, "last_edit_date": 1495542273, "question_id": 40830567, "link": "https://stackoverflow.com/questions/40830567/monad-unboxing", "title": "Monad &quot;unboxing&quot;", "body": "<p>My question came up while following the tutorial <a href=\"http://adit.io/posts/2013-04-17-functors,_applicatives,_and_monads_in_pictures.html\" rel=\"nofollow noreferrer\"><em>Functors, Applicatives, And Monads In Pictures</em></a> and its <a href=\"https://medium.com/@tzehsiang/javascript-functor-applicative-monads-in-pictures-b567c6415221#.rdwll124i\" rel=\"nofollow noreferrer\">JavaScript version</a>.</p>\n\n<p>When the text says that functor unwraps value from the context, I understand that a <code>Just 5</code> -> <code>5</code> transformation is happening. As per <a href=\"https://stackoverflow.com/questions/18808258/what-does-the-just-syntax-mean-in-haskell\">What does the &quot;Just&quot; syntax mean in Haskell?</a> , Just is \"defined in scope\" of the <code>Maybe</code> monad.</p>\n\n<p>My question is what is so magical about the whole unwrapping thing? I mean, what is the problem of having some language rule which automatically unwraps the \"scoped\" variables? It looks to me that this action is merely a lookup in some kind of a table where the symbol <code>Just 5</code> corresponds to the integer <code>5</code>.</p>\n\n<p>My question is inspired by the JavaScript version, where <code>Just 5</code> is prototype array instance. So unwrapping is, indeed, not rocket science at all.</p>\n\n<p>Is this a \"for-computation\" type of reason or a \"for-programmer\" one? Why do we distinguish <code>Just 5</code> from <code>5</code> on the programming language level?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 1, "creation_date": 1480255965, "post_id": 40829832, "comment_id": 68877517, "body": "Type in question: &quot;Maybe :: [[Maybe a]] -&gt; [[a]]&quot; should be <code>Maybe [[Maybe a]] -&gt; [[a]]</code>. Also you can use backticks (`) for inline code."}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1480256107, "post_id": 40829832, "comment_id": 68877563, "body": "How do you want the <code>ex</code> function to work? You declare <code>list</code> to be a <code>Maybe [[Maybe a]]</code> but you are trying to treat it as a list by applying <code>(!!)</code>"}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 3, "creation_date": 1480256185, "post_id": 40829832, "comment_id": 68877589, "body": "Try not to use methods like <code>(!!)</code>, <code>head</code> or <code>tail</code>. Instead pattern match on your arguments. Not only is it good practice, it will also aid you in understanding the problem. You know pattern matching right?"}, {"owner": {"reputation": 481, "user_id": 5787123, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tlxfJ.jpg?s=128&g=1", "display_name": "pticawr", "link": "https://stackoverflow.com/users/5787123/pticawr"}, "edited": false, "score": 0, "creation_date": 1480256396, "post_id": 40829832, "comment_id": 68877637, "body": "Check the definition of the <code>Maybe</code> type.  Use pattern matching to extract the list and the list entries, but also handle the <code>Nothing</code> case."}, {"owner": {"reputation": 715, "user_id": 3450934, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b86877d91f74ab9ca8d230961c7c86c4?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/3450934/nick"}, "edited": false, "score": 0, "creation_date": 1480256607, "post_id": 40829832, "comment_id": 68877693, "body": "I am trying now to pattern match it ! Thanks ! I will get back to this !"}, {"owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "edited": false, "score": 0, "creation_date": 1480263992, "post_id": 40829832, "comment_id": 68879976, "body": "What is it supposed to do? Is <code>ex ignored = Nothing</code> any good? :)"}], "answers": [{"tags": [], "owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "is_accepted": false, "score": 1, "last_activity_date": 1480257457, "creation_date": 1480257457, "answer_id": 40830125, "question_id": 40829832, "link": "https://stackoverflow.com/questions/40829832/how-to-implement-a-ex-maybe-maybe-a-a-method/40830125#40830125", "title": "How to implement a &#39;ex :: Maybe [[Maybe a]] -&gt; [[a]] &#39; method", "body": "<p>Looking at the signature <code>ex :: Maybe [[Maybe a]] -&gt; [[a]]</code>. The first thing you will want to do is pattern match on the different constructors of your argument:</p>\n\n<pre><code>ex :: Maybe [[Maybe a]] -&gt; [[a]]\nex (Just list) = undefined\nex Nothing = undefined\n</code></pre>\n\n<p>So there are two cases we have to handle. For <code>Nothing</code> you will most likely just return <code>[]</code>. For the <code>Just</code> case you will probably want to get out all the <code>Just</code> elements in the inner list:</p>\n\n<pre><code>ex :: Maybe [[Maybe a]] -&gt; [[a]]\nex (Just list) = catInnerMaybes list\nex Nothing = []\n\ncatInnerMaybes :: [[Maybe a]] -&gt; [[a]]\ncatInnerMaybes (xs:xss) = undefined\ncatInnerMaybes [] = undefined\n</code></pre>\n\n<p>Again for <code>catInnerMaybes</code> we want to pattern match on our argument instead of using methods like <code>(!!)</code>. I will leave the rest to you for now but here are some more tips:</p>\n\n<ul>\n<li>Try to use <code>:</code> instead of <code>++</code> as it is the more natural, idiomatic way to work with lists and because <code>++</code> gets slow quickly.</li>\n<li>I don't think you want <code>sequence</code>. You may depending on what exactly you are trying to do, but I think you are more likely to be looking for <code>catMaybes</code> in <code>Data.Maybe</code>. However I would recommend you don't use that either, but implement it yourself for the learning effect.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 0, "last_activity_date": 1480261615, "last_edit_date": 1495535373, "creation_date": 1480261615, "answer_id": 40830749, "question_id": 40829832, "link": "https://stackoverflow.com/questions/40829832/how-to-implement-a-ex-maybe-maybe-a-a-method/40830749#40830749", "title": "How to implement a &#39;ex :: Maybe [[Maybe a]] -&gt; [[a]] &#39; method", "body": "<p><a href=\"https://stackoverflow.com/users/2246434/jpath\">jpath</a> said that you can look for <code>catMaybes</code> function but it's better for you to implement by yourself to learn. But if somebody went here not to learn and just to get complete solution then here it is:</p>\n\n<pre><code>import Data.Maybe (catMaybes)\n\nex :: [[Maybe a]] -&gt; [[a]]\nex = map catMaybes\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 689, "user_id": 6217179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633461a7b7bd893feebbc9285d0fb049?s=128&d=identicon&r=PG&f=1", "display_name": "sapanoia", "link": "https://stackoverflow.com/users/6217179/sapanoia"}, "is_accepted": true, "score": 3, "last_activity_date": 1480269805, "last_edit_date": 1480269805, "creation_date": 1480269440, "answer_id": 40832059, "question_id": 40829832, "link": "https://stackoverflow.com/questions/40829832/how-to-implement-a-ex-maybe-maybe-a-a-method/40832059#40832059", "title": "How to implement a &#39;ex :: Maybe [[Maybe a]] -&gt; [[a]] &#39; method", "body": "<p>One possible solution is:</p>\n\n<pre><code>ex = maybe [] (map catMaybes)\n</code></pre>\n\n<p><strong>Approach:</strong></p>\n\n<p>One way to solve such a problem is to follow the types from the outermost to the innermost, and pick appropriate conversion functions along the way. Here, we will work step by step to modify the expression on the left of the <code>::</code> until its type on the right looks like the type you want:</p>\n\n<ol>\n<li><p>We start with <code>id</code> as a placeholder for further conversion functions, because it always has the correct type and does nothing:<br>\n<code>id :: a -&gt; a</code></p></li>\n<li><p>Strip off the outer <code>Maybe</code>. If the value is <code>Nothing</code>, we default to <code>[]</code>:<br>\n<code>maybe [] id :: Maybe [a] -&gt; [a]</code></p></li>\n<li><p>We want to convert the inner <code>[Maybe a]</code> to <code>[a]</code>.<br>\nThis can be done with the help of <code>catMaybes :: [Maybe a] -&gt; [a]</code>:<br>\n<code>maybe [] catMaybes :: Maybe [Maybe a] -&gt; [a]</code></p></li>\n<li><p>Actually, we want <code>[[Maybe a]] -&gt; [[a]]</code> rather than <code>[Maybe a] -&gt; [a]</code>.<br> We can use <code>map :: (a -&gt; a) -&gt; [a] -&gt; [a]</code> to push a function one level deeper into the list:<br>\n<code>maybe [] (map catMaybes) :: Maybe [[Maybe a]] -&gt; [[a]]</code></p></li>\n</ol>\n\n<p><strong>Tools:</strong></p>\n\n<ul>\n<li>Use <strong>GHCi</strong> for experimentation. You can ask it for the type of an expression with the <code>:t</code> command, for example: <code>:t maybe [] id</code>.</li>\n<li>Use API search engines for finding conversions functions. For example <a href=\"http://hayoo.fh-wedel.de/\" rel=\"nofollow noreferrer\">Hayoo</a> or Hoogle. You can enter a type signature as a search query. For example, <code>[Maybe a] -&gt; [a]</code> will return <code>catMaybes</code> among others.</li>\n</ul>\n"}], "owner": {"reputation": 715, "user_id": 3450934, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b86877d91f74ab9ca8d230961c7c86c4?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/3450934/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 40832059, "answer_count": 3, "score": 2, "last_activity_date": 1480446544, "creation_date": 1480255675, "last_edit_date": 1480446544, "question_id": 40829832, "link": "https://stackoverflow.com/questions/40829832/how-to-implement-a-ex-maybe-maybe-a-a-method", "title": "How to implement a &#39;ex :: Maybe [[Maybe a]] -&gt; [[a]] &#39; method", "body": "<p>I am trying to implement a function of type <code>Maybe [[Maybe a]] -&gt; [[a]]</code> in Haskell. I've tried a number of methods, but the closest I have gotten is:</p>\n\n<pre><code>ex :: Maybe [[Maybe a]] -&gt; [[a]]\nex list = let l=list!!0 \n          in []++(sequence l)\n</code></pre>\n\n<p>That gives me the following error:</p>\n\n<pre><code>Couldn't match expected type `[a0]'\n                with actual type `Maybe [[Maybe a]]'\n    In the first argument of `(!!)', namely `list'\n    In the expression: list !! 0\n    In an equation for `l': l = list !! 0\n</code></pre>\n\n<p>I know the error has problem with the first argument to <code>!!</code> argument not being a normal list, but can't get my head around it.</p>\n"}, {"tags": ["haskell", "typeclass", "associated-types"], "comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1480254128, "post_id": 40829314, "comment_id": 68876969, "body": "You can write <code>class Show (Foo a) =&gt; Test a where type Foo a</code>, but I don&#39;t know whether it&#39;s possible to emulate something like <code>class (forall a. Show (Foo a)) =&gt; Test a where type Foo a</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4937, "user_id": 636917, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/448671f42e8558317c85fe67e26c4bee?s=128&d=identicon&r=PG", "display_name": "Shea Levy", "link": "https://stackoverflow.com/users/636917/shea-levy"}, "is_accepted": true, "score": 1, "last_activity_date": 1480256544, "creation_date": 1480256544, "answer_id": 40829966, "question_id": 40829314, "link": "https://stackoverflow.com/questions/40829314/require-a-typeclass-instance-for-a-haskell-associated-type-synonym/40829966#40829966", "title": "Require a typeclass instance for a haskell associated type synonym", "body": "<p>Found the answer, thanks to lyxia on #haskell:</p>\n\n<pre><code>class (Show (Foo a)) =&gt; Test a where\n  type Foo a\n</code></pre>\n"}], "owner": {"reputation": 4937, "user_id": 636917, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/448671f42e8558317c85fe67e26c4bee?s=128&d=identicon&r=PG", "display_name": "Shea Levy", "link": "https://stackoverflow.com/users/636917/shea-levy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 40829966, "answer_count": 1, "score": 2, "last_activity_date": 1480260230, "creation_date": 1480252141, "question_id": 40829314, "link": "https://stackoverflow.com/questions/40829314/require-a-typeclass-instance-for-a-haskell-associated-type-synonym", "title": "Require a typeclass instance for a haskell associated type synonym", "body": "<p>Is it possible to require that an associated type synonym of some class be an instance of some other class? E.g. with something like the following code (doesn't compile!):</p>\n\n<pre><code>class Test a where\n  type Foo a\n  instance Show (Foo a)\n</code></pre>\n\n<p>I would be able to rely on the fact that a <code>Foo a</code> is <code>Show</code>able regardless of the particular <code>a</code> in question.</p>\n\n<p>Obviously I can just add more methods to the class to ensure operations I want on <code>Foo a</code>s, but it would be nice to be able to just reuse existing classes.</p>\n"}, {"tags": ["haskell", "types", "typeclass"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 3, "creation_date": 1480223025, "post_id": 40825878, "comment_id": 68870245, "body": "This is possible, but is almost never what you should do. It is generally much better to put the <code>Num s</code> constraint only at the functions that actually need the it."}, {"owner": {"reputation": 337, "user_id": 4807549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://lh3.googleusercontent.com/-zRbnN_A_wy0/AAAAAAAAAAI/AAAAAAAAAB0/1IyAlZ4V9jY/photo.jpg?sz=128", "display_name": "Avi Caspe", "link": "https://stackoverflow.com/users/4807549/avi-caspe"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1480223525, "post_id": 40825878, "comment_id": 68870329, "body": "Alec, all of my functions using the scale will need the num constraint."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1480225650, "post_id": 40825878, "comment_id": 68870646, "body": "@AviCaspe There are very good reasons not to do this. The answer contains one, but there are others.  You should really consider just putting the constraints where they are needed."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 27, "last_activity_date": 1480223042, "creation_date": 1480223042, "answer_id": 40825913, "question_id": 40825878, "link": "https://stackoverflow.com/questions/40825878/type-constraints-in-data-declaration-haskell/40825913#40825913", "title": "Type Constraints in Data Declaration Haskell", "body": "<p>Yes:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\ndata Scale s where\n    Scale :: Num s =&gt; s -&gt; s -&gt; Scale s\n</code></pre>\n\n<p>However, it's generally considered best practice <em>not</em> to do this. Instead, put the <code>Num</code> constraint only on the functions that use <code>Scale</code>s and <em>need</em> the <code>Num</code> constraint. Being relaxed about such constraints allows you to temporarily break the invariant where appropriate; e.g. it's common to wish for a <code>Functor</code> instance for such a type, which is impossible if you constrain the constructor as above.</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1480276650, "post_id": 40827012, "comment_id": 68884082, "body": "Indeed, you can even make a <a href=\"http://hackage.haskell.org/package/transformers-0.5.1.0/docs/src/Data-Functor-Product.html#line-126\" rel=\"nofollow noreferrer\">Monad instance</a> for <a href=\"http://hackage.haskell.org/package/transformers-0.5.1.0/docs/Data-Functor-Product.html\" rel=\"nofollow noreferrer\">such a type</a>."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1480276822, "post_id": 40827012, "comment_id": 68884149, "body": "Yes, I known, you are right. But I thing it is not intrestiing for this example :)"}], "tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": false, "score": 8, "last_activity_date": 1480255549, "last_edit_date": 1480255549, "creation_date": 1480234676, "answer_id": 40827012, "question_id": 40825878, "link": "https://stackoverflow.com/questions/40825878/type-constraints-in-data-declaration-haskell/40827012#40827012", "title": "Type Constraints in Data Declaration Haskell", "body": "<p>I had a similar situation with <code>Point</code> type. But I thought not about constraints, I thought about how to do generalizing element type of my point. Then I understood if I'll have point type like this <code>data Point a = Point a a</code> then I can do it instance of Functor, Applicative, Foldable and Traversable. And I'll can design function by standart general way. For example:</p>\n\n<pre><code>dist :: Floating a =&gt; Point a -&gt; Point a -&gt; a\ndist a b = sqrt $ sum $ (^2) &lt;$&gt; ((-) &lt;$&gt; a &lt;*&gt; b)\n</code></pre>\n\n<p>And I had question. What is going on? :) If I add constraint (as you asked) I would not can design by this way and I would need to implement a lot of functions like <code>pointSub</code>.</p>\n\n<p>So, there is something to think about :)</p>\n"}], "owner": {"reputation": 337, "user_id": 4807549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://lh3.googleusercontent.com/-zRbnN_A_wy0/AAAAAAAAAAI/AAAAAAAAAB0/1IyAlZ4V9jY/photo.jpg?sz=128", "display_name": "Avi Caspe", "link": "https://stackoverflow.com/users/4807549/avi-caspe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4595, "favorite_count": 1, "accepted_answer_id": 40825913, "answer_count": 2, "score": 13, "last_activity_date": 1480255549, "creation_date": 1480222562, "question_id": 40825878, "link": "https://stackoverflow.com/questions/40825878/type-constraints-in-data-declaration-haskell", "title": "Type Constraints in Data Declaration Haskell", "body": "<p>I'm using Haskell and trying to write the following:</p>\n\n<pre><code>data Scale s = Scale s s\n</code></pre>\n\n<p>However, I want to make it so that <code>s</code> must be something that of the Num type class, like Int or Double. Is that possible to do using Haskell and GHC?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7215398"}, "is_accepted": false, "score": 2, "last_activity_date": 1480231345, "creation_date": 1480231345, "answer_id": 40826669, "question_id": 40825652, "link": "https://stackoverflow.com/questions/40825652/find-factor-primes-in-haskell/40826669#40826669", "title": "Find factor primes in haskell", "body": "<p>Use <code>nub :: Eq a =&gt; [a] -&gt; [a]</code>, which removes duplicate elements from lists.\n<a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html#v:nub\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html#v:nub</a></p>\n"}], "owner": {"reputation": 13, "user_id": 6047181, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e105cd40f3c2a23c578641fcaf1c0661?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmad Aldaihani", "link": "https://stackoverflow.com/users/6047181/ahmad-aldaihani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1558273730, "creation_date": 1480219454, "last_edit_date": 1558273730, "question_id": 40825652, "link": "https://stackoverflow.com/questions/40825652/find-factor-primes-in-haskell", "title": "Find factor primes in haskell", "body": "<p>Write a function called factor that will take an Integer and determine its prime factors (called prime factorization). The function should take an integer and return a list of integers. This list should be the prime factors of the number, not including multiplicity. For example, the prime factors of 56 are 2 and 7 (even though the full multiplication is 56 = 2<sup>3</sup> \u00d7 7 = 2 \u00d7  2 \u00d7 2 \u00d7 7). What are the prime factors of 175561 and 62451532000?</p>\n\n<p>So far, what I got is:</p>\n\n<pre><code>factor :: Int -&gt; [Int]\nfactor n\n  | factors == []  = [n]\n  | otherwise = (factors ++ factor (n `div` (head factors)))\n  where factors = take 1 $ filter (\\x -&gt; (n `mod` x) == 0) [2 .. n-1]\n</code></pre>\n\n<p>but this print the full multiplication, when plug 56 it gives 2.2.2.7 and I want it with no duplication like 2, 7.\nHow can I filter?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 3115, "user_id": 325247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/77d35dfcee05f849af85a26461ae93a7?s=128&d=identicon&r=PG", "display_name": "muhmuhten", "link": "https://stackoverflow.com/users/325247/muhmuhten"}, "is_accepted": false, "score": 1, "last_activity_date": 1480416247, "last_edit_date": 1480416247, "creation_date": 1480215016, "answer_id": 40825307, "question_id": 40825222, "link": "https://stackoverflow.com/questions/40825222/find-primes-number-starting-at-2-haskell/40825307#40825307", "title": "find primes number starting at 2 Haskell", "body": "<p>Instead of generating primes up to 1020, to emit the 1000th through 1020th primes, you can generate the first 1020 primes and emit only the last 21 of them.</p>\n\n<p>Using <a href=\"https://wiki.haskell.org/Prime_numbers#Sieve_of_Eratosthenes\" rel=\"nofollow noreferrer\">a naive unbounded sieve</a>, we can write the following</p>\n\n<pre><code>minus :: Ord a =&gt; [a] -&gt; [a] -&gt; [a]\nminus (x:xs) (y:ys) = case (compare x y) of\n           LT -&gt; x : minus  xs  (y:ys)\n           EQ -&gt;     minus  xs     ys\n           GT -&gt;     minus (x:xs)  ys\nminus  xs     _     = xs\n\nprimes :: [Integer]\nprimes = eratos [2..]\n  where\n    eratos []     = []\n    eratos (p:xs) = p : eratos (xs `minus` [p, p+p..])\n\nprimesFromTo from to = drop (from-1) $ take to primes\n</code></pre>\n\n<p>Then find <code>primesFromTo 1000 1020</code>:</p>\n\n<pre><code>*Main&gt; primesFromTo 1000 1020\n[7919,7927,7933,7937,7949,7951,7963,7993,8009,8011,8017,8039,8053,8059,8069,8081,8087,8089,8093,8101,8111]\n</code></pre>\n\n<p>As an aside, the naming (<code>isPrimes</code>) is a bit questionable for a list of primes...</p>\n"}], "owner": {"reputation": 13, "user_id": 6047181, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e105cd40f3c2a23c578641fcaf1c0661?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmad Aldaihani", "link": "https://stackoverflow.com/users/6047181/ahmad-aldaihani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480416247, "creation_date": 1480213869, "question_id": 40825222, "link": "https://stackoverflow.com/questions/40825222/find-primes-number-starting-at-2-haskell", "title": "find primes number starting at 2 Haskell", "body": "<p>Write a function called isPrime that determines if an Integer is a prime number (evenly\ndivisible only by itself and one). For reference, here\u2019s a list of the primes less than 100:\n[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97]\nWhat are the 1000th through 1020th prime numbers? (starting at 2)</p>\n\n<pre><code>isPrime :: [Integer] \nisPrime = sieve [2..1020]\n  where\n    sieve (p:xs)\n    | p*p &lt;= 1020 = p : sieve [x|x &lt;- xs, x `mod` p &gt; 0] \n    | otherwise = (p:xs)\n</code></pre>\n\n<p>I tried this code, but it prints primes 2 through 1020.\nI want to show 1000 through 1020 starting at 2</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 4, "creation_date": 1480202900, "post_id": 40824216, "comment_id": 68867176, "body": "<code>:</code> doesn&#39;t mean &quot;concatenate&quot;. It specifically takes a single element (on the left) and a list (on the right) and produces a new list."}, {"owner": {"reputation": 291, "user_id": 4147379, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6b76214d2d39fd445bc4fe125206f80f?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen-Wisniewski", "link": "https://stackoverflow.com/users/4147379/stephen-wisniewski"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1480203030, "post_id": 40824216, "comment_id": 68867195, "body": "@melpomene I see. So how do you suggest I properly concatenate this?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 4, "creation_date": 1480203209, "post_id": 40824216, "comment_id": 68867245, "body": "I&#39;d suggest something like <code>func (x : xs) = xs ++ [x]</code>. Note that <code>++</code> is linear in the length of its left argument so you probably don&#39;t want to do this in a loop."}], "answers": [{"comments": [{"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1480203864, "post_id": 40824294, "comment_id": 68867384, "body": "This won&#39;t work because <code>tail x:[head x]</code> is still a type error."}, {"owner": {"reputation": 291, "user_id": 4147379, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6b76214d2d39fd445bc4fe125206f80f?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen-Wisniewski", "link": "https://stackoverflow.com/users/4147379/stephen-wisniewski"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1480204022, "post_id": 40824294, "comment_id": 68867407, "body": "@DietrichEpp Edited."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1480205400, "post_id": 40824294, "comment_id": 68867642, "body": "You probably also want an empty list case, as there seems to be no need for this function to fail on an empty list."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1480206403, "post_id": 40824294, "comment_id": 68867787, "body": "<code>tail</code> and <code>head</code>, being partial, should be avoided in most common cases, preferring pattern matching to them."}], "tags": [], "owner": {"reputation": 291, "user_id": 4147379, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6b76214d2d39fd445bc4fe125206f80f?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen-Wisniewski", "link": "https://stackoverflow.com/users/4147379/stephen-wisniewski"}, "is_accepted": false, "score": 0, "last_activity_date": 1480203998, "last_edit_date": 1480203998, "creation_date": 1480203501, "answer_id": 40824294, "question_id": 40824216, "link": "https://stackoverflow.com/questions/40824216/why-doesnt-tail-x-head-x-work/40824294#40824294", "title": "Why doesn&#39;t &#39;tail x : head x&#39; work?", "body": "<p><b>Solution:</b></p>\n\n<p>Change</p>\n\n<pre><code>func :: [String] -&gt; [String]\nfunc x = tail x:head x\n</code></pre>\n\n<p>to</p>\n\n<pre><code>func :: [String] -&gt; [String]\nfunc x = tail x++[head x]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 7, "last_activity_date": 1480206140, "creation_date": 1480206140, "answer_id": 40824557, "question_id": 40824216, "link": "https://stackoverflow.com/questions/40824216/why-doesnt-tail-x-head-x-work/40824557#40824557", "title": "Why doesn&#39;t &#39;tail x : head x&#39; work?", "body": "<p>Lets work through the types to understand why this didn't work before we focus on the proper solution.</p>\n\n<p>You presented:</p>\n\n<pre><code>func :: [String] -&gt; [String]\nfunc x = tail x:head x\n</code></pre>\n\n<p>We know:</p>\n\n<pre><code>tail x :: [String]\nhead x :: String\n(:)    :: String -&gt; [String] -&gt; [String]\n            ^          ^ the 'head' argument's position\n            ^---the 'tail' argument's position\n</code></pre>\n\n<p>So clearly the types aren't matching up - a list where an element is expected and an element where a list is expected.</p>\n\n<p>It's worth noting that there isn't any default <code>snoc</code> operator, which cons's an element to the end of a list.  What you can do is append to lists via <code>(++) :: [String] -&gt; [String] -&gt; [String]</code>. Since the <code>head xs</code> isn't a <code>[String]</code> we could make it one via square brackets: <code>[head xs]</code>.</p>\n\n<p>More-over, the use of <code>head</code> and <code>tail</code> are not safe - they'll throw an exception if the list is empty.  It is better to use pattern matching so the compiler can warn you about partial functions in addition to them being more visibly obvious.  In this case we'd match the first element and the rest of the list:</p>\n\n<pre><code>func (firstElement : restOfList) = restOfList ++ [firstElement]\n</code></pre>\n\n<p>And looking at this it should be obvious <code>func</code> isn't yet defined for empty lists so we can add one more case:</p>\n\n<pre><code>func [] = []\n</code></pre>\n"}], "owner": {"reputation": 291, "user_id": 4147379, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6b76214d2d39fd445bc4fe125206f80f?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen-Wisniewski", "link": "https://stackoverflow.com/users/4147379/stephen-wisniewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 40824557, "answer_count": 2, "score": 1, "last_activity_date": 1480206140, "creation_date": 1480202826, "last_edit_date": 1480205334, "question_id": 40824216, "link": "https://stackoverflow.com/questions/40824216/why-doesnt-tail-x-head-x-work", "title": "Why doesn&#39;t &#39;tail x : head x&#39; work?", "body": "<p>New to Haskell. Why does the following code <b>not</b> work? How do I concatenate the tail and the head like this?     </p>\n\n<pre><code>func :: [String] -&gt; [String]\nfunc x = tail x:head x\n</code></pre>\n"}, {"tags": ["database", "haskell", "yesod", "template-haskell", "hamlet"], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 2395870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/652437711761fc77465e03be05600bbd?s=128&d=identicon&r=PG&f=1", "display_name": "thelostlambda", "link": "https://stackoverflow.com/users/2395870/thelostlambda"}, "edited": false, "score": 0, "creation_date": 1480318124, "post_id": 40827111, "comment_id": 68895210, "body": "Thank you! I think if I can solve at least part of this problem without TH that is most definitely the way to go about it! I was unaware that Persistent provided this sort of type information! As a quick follow up question, where does the parameter <code>getColumn</code> come from? I presume I can do something like <code>(runDB $ selectList [] [])</code> to obtain I list of all the <code>entities</code> from a certain column, but what does <code>(FieldDef -&gt; Text)</code> do? Also, could you link me to the module where these Persistent functions are defined? Thank you for all of your help!"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 329, "user_id": 2395870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/652437711761fc77465e03be05600bbd?s=128&d=identicon&r=PG&f=1", "display_name": "thelostlambda", "link": "https://stackoverflow.com/users/2395870/thelostlambda"}, "edited": false, "score": 0, "creation_date": 1480323475, "post_id": 40827111, "comment_id": 68897843, "body": "<code>getColumn :: FieldDef -&gt; Text</code> is just a function which extract the name from the column definition to use it for the column name. I personally use <code>unDBName . fieldDB</code> but you can change to change the case for example."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 329, "user_id": 2395870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/652437711761fc77465e03be05600bbd?s=128&d=identicon&r=PG&f=1", "display_name": "thelostlambda", "link": "https://stackoverflow.com/users/2395870/thelostlambda"}, "edited": false, "score": 0, "creation_date": 1480323511, "post_id": 40827111, "comment_id": 68897861, "body": "<a href=\"https://hackage.haskell.org/package/persistent-2.6/docs/Database-Persist-Types.html\" rel=\"nofollow noreferrer\">there</a>"}, {"owner": {"reputation": 329, "user_id": 2395870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/652437711761fc77465e03be05600bbd?s=128&d=identicon&r=PG&f=1", "display_name": "thelostlambda", "link": "https://stackoverflow.com/users/2395870/thelostlambda"}, "edited": false, "score": 0, "creation_date": 1480381045, "post_id": 40827111, "comment_id": 68928715, "body": "Awesome! Thank you for the swift reply! I think that is all I needed! Thanks again!"}], "tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": true, "score": 1, "last_activity_date": 1480287632, "last_edit_date": 1480287632, "creation_date": 1480235653, "answer_id": 40827111, "question_id": 40823443, "link": "https://stackoverflow.com/questions/40823443/can-i-use-template-haskell-to-generate-hamlet-code/40827111#40827111", "title": "Can I Use Template Haskell to Generate Hamlet Code?", "body": "<p>To answer your question : Yes you can, however I wouldn't recommend it. A quasi quoter is just a function which take a string and generate some code, so you when you see</p>\n\n<pre><code>[hamlet|blah blah|]\n</code></pre>\n\n<p>You could replace it with (or equivalent)</p>\n\n<pre><code>$(hamlet \"blah blah\")\n</code></pre>\n\n<p>So nothing stops you in TH to generate a string an call hamlet to it. However, one of the point of TH is type safety.\nGenerating a string to then parse kind of defeat the object of it. Also, this 2 steps code generation will probably be hard to debug.</p>\n\n<p>Anyway, if your problem is to generate table for Persistent entities, I don't think you need TH at all and just use Persistent fields information. I had a similar problem and writen some code which generate an Html table for a list of entities. It shouldn't be hard to modify it do input.</p>\n\n<pre><code>entitiesToTable :: PersistEntity a =&gt; (FieldDef -&gt; Text) -&gt; [Entity a] -&gt; Html\nentitiesToTable getColumn entities = do\n  let eDef = entityDef (map entityVal entities)\n  [shamlet|\n&lt;table.table.table-bordered.table-striped class=\"#{unHaskellName $ entityHaskell eDef}\"&gt;\n  &lt;tr&gt;\n    &lt;th&gt; Id\n    $forall field &lt;- entityFields eDef\n      &lt;th&gt; #{getColumn field}\n  $forall Entity eit entity  &lt;- entities\n    &lt;tr&gt;\n      &lt;td.id&gt; #{renderPersistValue $ toPersistValue eit}\n      $forall (pfield, fieldDef) &lt;- zip (toPersistFields entity) (entityFields eDef)\n        &lt;td class=\"#{getHaskellName fieldDef}\" &gt; #{renderPersistValue $ toPersistValue pfield}\n|]\n</code></pre>\n\n<p>Writing the code to process the form and update the database might be more tricky and need TH, however there is no Hamlet involved in this step.</p>\n"}], "owner": {"reputation": 329, "user_id": 2395870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/652437711761fc77465e03be05600bbd?s=128&d=identicon&r=PG&f=1", "display_name": "thelostlambda", "link": "https://stackoverflow.com/users/2395870/thelostlambda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 40827111, "answer_count": 1, "score": 1, "last_activity_date": 1480287632, "creation_date": 1480196438, "question_id": 40823443, "link": "https://stackoverflow.com/questions/40823443/can-i-use-template-haskell-to-generate-hamlet-code", "title": "Can I Use Template Haskell to Generate Hamlet Code?", "body": "<p>I have come across an interesting problem that I thought might be a pertinent place for Template Haskell. I'm working on a web front-end to a database using yesod and yesod-persistant. I am generating my database types using <code>mkPerist</code> function and the <code>persistLowerCase</code> quasi-quoter.\nMy problem is, I need a way to edit fields of the database but writing the hamlet code for six different pages for each of the columns seems incredibly repetitive. I figured I could use Template Haskell to automatically generating the text fields and checkboxes for editing that column of the database given the type. Ideally I would just pass the name of the type to the Template Haskell function and then TH would take care of generating all of the Hamlet for the page. My question is, can I use Template Haskell in this case? Is it the best solution? Particularly, can Template Haskell generate code for other quasi-quoters? Particularly Hamlet? Here is a link to my project as of now: <a href=\"https://github.com/ProspectRidgeTech/PRADatabase\" rel=\"nofollow noreferrer\">https://github.com/ProspectRidgeTech/PRADatabase</a> Thanks in advance! (PS. Let me know if there is a better way to approach this problem and if you have any suggested edits to my question.)</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 4337, "user_id": 649727, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1cb3b3d7e0ccce5f039c37f9bd85de11?s=128&d=identicon&r=PG", "display_name": "phynfo", "link": "https://stackoverflow.com/users/649727/phynfo"}, "is_accepted": true, "score": 1, "last_activity_date": 1480196281, "last_edit_date": 1480196281, "creation_date": 1480194902, "answer_id": 40823229, "question_id": 40823151, "link": "https://stackoverflow.com/questions/40823151/transpose-a-length-and-filter-to-just-a-foldr/40823229#40823229", "title": "Transpose a length and filter to just a foldr", "body": "<p>Try this:</p>\n\n<pre><code>count n = foldr (\\(f,i) j -&gt; if (i==n) then j+1 else j) 0\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6540722"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 40823229, "answer_count": 1, "score": 0, "last_activity_date": 1480196281, "creation_date": 1480194387, "last_edit_date": 1480194639, "question_id": 40823151, "link": "https://stackoverflow.com/questions/40823151/transpose-a-length-and-filter-to-just-a-foldr", "title": "Transpose a length and filter to just a foldr", "body": "<p>I have this function : </p>\n\n<pre><code>count :: Int -&gt; [(Float,Int)] -&gt; Int\ncount n p = length $ filter ((==n).snd) p\n</code></pre>\n\n<p>and I want to transpose it to a foldr but im having troubles with the lambda function </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 17, "user_id": 7214145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5920b0948eaf8344f03329a086eec7?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell Sean", "link": "https://stackoverflow.com/users/7214145/haskell-sean"}, "edited": false, "score": 0, "creation_date": 1480189376, "post_id": 40822310, "comment_id": 68863749, "body": "Yeah, I&#39;m very new to Haskell. My previous programming experience would have been with Java. Is there something specific I could clarify for you?"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1480189574, "post_id": 40822310, "comment_id": 68863808, "body": "Why do all your class&#39;s function work on tuples rather than coordinates? What&#39;s the purpose of the <code>b</code> type variable that most of your methods have - like why do you work with tuples where the first element is a coordinate and the second element is arbitrary? And how does it make sense for the unit value to be a coordinate?"}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1480189612, "post_id": 40822310, "comment_id": 68863822, "body": "I don&#39;t think you want a <code>class</code> here.  You don&#39;t want to make arbitrary types behave as coordinates.  You want a data type that contains a pair of values."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1480189618, "post_id": 40822310, "comment_id": 68863824, "body": "Oh and on a more general level: Why have a coordinate class at all (as opposed to just a data type)?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1480189724, "post_id": 40822310, "comment_id": 68863852, "body": "You probably don&#39;t want to create any classes just yet. If you want to add two 2-tuples, try this function: <code>addCoordinates (x,y) (x&#39;,y&#39;) = (x+x&#39;,y+y&#39;)</code> (remove the class definition and the instance definition you have, this is a standalone function). Use GHCi to examine its type."}, {"owner": {"reputation": 17, "user_id": 7214145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5920b0948eaf8344f03329a086eec7?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell Sean", "link": "https://stackoverflow.com/users/7214145/haskell-sean"}, "edited": false, "score": 0, "creation_date": 1480190091, "post_id": 40822310, "comment_id": 68863929, "body": "Well the coordinate is an X and a Y value so I thought I should represent it as a tuple. The b represents the Y part of the coordinate but could be of a different type then that of the a which represents the X value. I don&#39;t really understand what you mean by unit value though."}, {"owner": {"reputation": 17, "user_id": 7214145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5920b0948eaf8344f03329a086eec7?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell Sean", "link": "https://stackoverflow.com/users/7214145/haskell-sean"}, "edited": false, "score": 0, "creation_date": 1480190491, "post_id": 40822310, "comment_id": 68864040, "body": "The reason I didn&#39;t use a datatype was because I was trying to use this as an exercise for learning about classes and creating instances of them. I agree it would make more sense to use a data type though."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1480203557, "post_id": 40822310, "comment_id": 68867318, "body": "@HaskellSean You wrote <code>Coordinate a</code>, so <code>a</code> is the type that implements the <code>Coordinate</code> class. So <code>a</code> is not the first part of your coordinate, it <i>is</i> your coordinate. So <code>(a, b)</code> is a tuple that contains a coordinate and an arbitrary type. By the &quot;unit value&quot; I mean <code>()</code>. That is, the value <code>()</code> the only value of the type <code>()</code> (also called the unit type). When you write <code>instance Coordinate ()</code>, you&#39;re saying &quot;the type <code>()</code> implements <code>Coordinate</code>&quot;, which makes the <code>()</code> value a coordinate. But that makes no sense."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 4, "creation_date": 1480225650, "post_id": 40822310, "comment_id": 68870647, "body": "You don&#39;t use type classes for modeling data, so you&#39;ve started with completely the wrong kind of task to use for learning classes. If that&#39;s your main goal you&#39;ll be <b>much</b> better served by giving up and finding a different exercise. Classes in Haskell are not like classes in OO languages, they&#39;re much more similar to OO interfaces. You use data types to model data. Classes are for modeling abstract interfaces that many different types might want to implement (each in their own unique way)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1480225752, "post_id": 40822310, "comment_id": 68870655, "body": "You should not start defining your own classes until you have plenty of experience using classes others have defined. Whereas Haskell programmers will often define loads of data types, we tend to be much more restrained about classes. Making one &quot;for practice&quot; that doesn&#39;t capture a real abstraction may not be so helpful. Practice using, and writing instances for, <code>Show</code>, <code>Read</code>, <code>Ord</code>, <code>Functor</code>, <code>Applicative</code>, <code>Monad</code>, <code>Traversable</code>, <code>Monoid</code>,  <code>Category</code>, etc. Then try to formulate a class that expresses a specific concept involving one or more operations. Try writing a <code>Ring</code> class, say."}, {"owner": {"reputation": 17, "user_id": 7214145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5920b0948eaf8344f03329a086eec7?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell Sean", "link": "https://stackoverflow.com/users/7214145/haskell-sean"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1480263186, "post_id": 40822310, "comment_id": 68879665, "body": "@sepp2k Ah ok I understand what you mean now. However, I don&#39;t understand how I would go about having what I want for the definition of the class. How I would have an (a,b) and no just an a."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1480263603, "post_id": 40822310, "comment_id": 68879821, "body": "@HaskellSean It is not yet clear to me what you want. If you want coordinates to always be tuples of integers, you don&#39;t want a class at all. A class only makes sense if you have more than one instance (in OO terms: there&#39;s no need to implement an interface if you only one class to implement it - note that in this analogy OO classes map to Haskell data types and OO interfaces map to Haskell type classes)."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1480263625, "post_id": 40822310, "comment_id": 68879828, "body": "If you want tuples to be one possible instance of Coordinates, the tuples should only appear in the instance definition (which should look something like <code>instance Coordinate (Integer, Integer) where ...</code>), not in the class definition."}, {"owner": {"reputation": 17, "user_id": 7214145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5920b0948eaf8344f03329a086eec7?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell Sean", "link": "https://stackoverflow.com/users/7214145/haskell-sean"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1480264615, "post_id": 40822310, "comment_id": 68880163, "body": "@sepp2k I updated my original post to be a bit more specific about what I was trying to accomplish"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1480264998, "post_id": 40822310, "comment_id": 68880288, "body": "@HaskellSean There&#39;s a big terminology mix up here: In Haskell there are type classes, types and values. A type can be an instance of a type class (or multiple type classes or none) and a value has a type. So a phrase like &quot;add two instances of a class&quot; does not make sense because an instance of a class is a type and you can&#39;t add types. Once you understand that, you need to decide which types you want to be instances of your class."}, {"owner": {"reputation": 17, "user_id": 7214145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5920b0948eaf8344f03329a086eec7?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell Sean", "link": "https://stackoverflow.com/users/7214145/haskell-sean"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1480265663, "post_id": 40822310, "comment_id": 68880501, "body": "@sepp2k When I say &quot;add two instances of a class&quot; I mean adding the first value of an instance of a Coordinate with the first value of another instance of a Coordinate (Both of these instances to be added will be of the same type but other Coordinates may differ in type)  eg. adding (1,2.1) and (2, 1.3) would return (3,3.4) and adding (2.1,-1) and (1.3,-2) would return (3.4,-3)"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1480266019, "post_id": 40822310, "comment_id": 68880610, "body": "@HaskellSean Please read carefully what I wrote about the terminology in Haskell. <code>(1,2.1)</code> is not an instance of the Coordinate class and it can&#39;t possibly be. Only types can be instances of a type class, values can&#39;t."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 7214145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5920b0948eaf8344f03329a086eec7?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell Sean", "link": "https://stackoverflow.com/users/7214145/haskell-sean"}, "edited": false, "score": 0, "creation_date": 1480190385, "post_id": 40822494, "comment_id": 68864007, "body": "I was trying to to this as an exercise to learn about classes, I think the above would probably be a good solution though but I don&#39;t know if it really helps me learning about polymorphic classes and implementing instances of those classes. Thanks for your help though."}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "reply_to_user": {"reputation": 17, "user_id": 7214145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5920b0948eaf8344f03329a086eec7?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell Sean", "link": "https://stackoverflow.com/users/7214145/haskell-sean"}, "edited": false, "score": 0, "creation_date": 1480190543, "post_id": 40822494, "comment_id": 68864054, "body": "You could create a class for things that can be default initialized, and use it to implement createCoordinate (assuming a and b are default initializable)."}, {"owner": {"reputation": 17, "user_id": 7214145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5920b0948eaf8344f03329a086eec7?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell Sean", "link": "https://stackoverflow.com/users/7214145/haskell-sean"}, "edited": false, "score": 0, "creation_date": 1480190803, "post_id": 40822494, "comment_id": 68864125, "body": "I&#39;m not really sure I understand what you mean by default initialized, could you explain that please?"}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "reply_to_user": {"reputation": 17, "user_id": 7214145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5920b0948eaf8344f03329a086eec7?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell Sean", "link": "https://stackoverflow.com/users/7214145/haskell-sean"}, "edited": false, "score": 1, "creation_date": 1480190806, "post_id": 40822494, "comment_id": 68864127, "body": "Think of classes more like collections of verbs that you would like to apply to arbitrary nouns, and data types as the nouns.  A Coordinate is a noun.  DefaultInitializable has a verb, <code>default</code> which can return a noun"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480191168, "post_id": 40822494, "comment_id": 68864224, "body": "Why not just bundle the field accessors with the data type? <code>data Coordinate a b = Coordinate { getFirst  :: a, getSecond :: b } deriving (Eq, Ord, Show)</code>?"}, {"owner": {"reputation": 17, "user_id": 7214145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5920b0948eaf8344f03329a086eec7?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell Sean", "link": "https://stackoverflow.com/users/7214145/haskell-sean"}, "edited": false, "score": 0, "creation_date": 1480192771, "post_id": 40822494, "comment_id": 68864690, "body": "I tried to use this and got an error.  parse error on input &quot;::&quot;  which is in relation to <code>default :: a</code>."}, {"owner": {"reputation": 17, "user_id": 7214145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5920b0948eaf8344f03329a086eec7?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell Sean", "link": "https://stackoverflow.com/users/7214145/haskell-sean"}, "edited": false, "score": 0, "creation_date": 1480193835, "post_id": 40822494, "comment_id": 68865030, "body": "So for your implementation how would I go about implementing the functions I want? If I want to have a class that defines those different functions."}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1480195401, "post_id": 40822494, "comment_id": 68865407, "body": "<code>default</code> is a keyword in Haskell. Use a different name."}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1480224131, "post_id": 40822494, "comment_id": 68870426, "body": "What functions do you want to add?  You only need a class if you want them to apply to arbitrary types.  If you&#39;re OK with them only applying to Coordinates, then no class is needed."}, {"owner": {"reputation": 17, "user_id": 7214145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5920b0948eaf8344f03329a086eec7?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell Sean", "link": "https://stackoverflow.com/users/7214145/haskell-sean"}, "edited": false, "score": 0, "creation_date": 1480262863, "post_id": 40822494, "comment_id": 68879571, "body": "I do want to apply them to arbitrary types. The functions i want to implement are:     <code>createCoordinate :: a -&gt; b -&gt; (a,b)</code>      <code>getFirst :: (a,b) -&gt; a</code>      <code>getSecond :: (a,b) -&gt; b</code>      <code>addCoordinates </code>  Where addCoordinates is a function that will take the first element of an instance of a Coordinate and add it in a pairwise manner to the first element of another instance of a Coordinate."}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1480265403, "post_id": 40822494, "comment_id": 68880404, "body": "But you don&#39;t want different types to be Coordinates. A Coordinate is always a pair of values of arbitrary types.   You have changed the type of <code>createCoordinate</code> from your original post.  Given that you intend to provide values for <code>a</code> and <code>b</code>, it no longer needs to be default initializable."}, {"owner": {"reputation": 17, "user_id": 7214145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5920b0948eaf8344f03329a086eec7?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell Sean", "link": "https://stackoverflow.com/users/7214145/haskell-sean"}, "edited": false, "score": 0, "creation_date": 1480265986, "post_id": 40822494, "comment_id": 68880597, "body": "@pat I was just playing around with things to see what worked and that was  what I had at the time. The edited version of my post is what I actually what I just am not sure on how to go about it in haskell."}], "tags": [], "owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "is_accepted": false, "score": 4, "last_activity_date": 1480270941, "last_edit_date": 1480270941, "creation_date": 1480189960, "answer_id": 40822494, "question_id": 40822310, "link": "https://stackoverflow.com/questions/40822310/creating-a-coordinate-class-in-haskell/40822494#40822494", "title": "Creating a Coordinate class in Haskell", "body": "<p>You probably want a data type, not a class:</p>\n\n<pre><code>data Coordinate a b = Coordinate { getFirst :: a, getSecond :: b }\n    deriving (Eq, Ord, Show)\n</code></pre>\n\n<p>Your functions would then become:</p>\n\n<pre><code>createCoordinate :: a -&gt; b -&gt; Coordinate a b\ncreateCoordinate a b = Coordinate a b\n\naddCoordinates :: (Num a, Num b) =&gt; Coordinate a b -&gt; Coordinate a b -&gt; Coordinate a b\naddCoordinates (Coordinate a1 b1) (Coordinate a2 b2) = Coordinate (a1+a2) (b1+b2)\n</code></pre>\n\n<p>Note that <code>a</code> and <code>b</code> can be of any type, but <code>addCoordinates</code> only works if they are instances of <code>Num</code>, because we wish to apply <code>+</code> to them.  You do not need a typeclass to define <code>Coordinate</code>.</p>\n\n<p>A typeclass would allow you to define things that can be initialized to default values for instance:</p>\n\n<pre><code>class DefaultInitializable a where\n    defaultInit :: a\n</code></pre>\n\n<p>We can then make <code>Int</code> an instance of this class:</p>\n\n<pre><code>instance DefaultInitializable Int where\n    defaultInit = 0\n</code></pre>\n\n<p>And we can make <code>Coordinate</code> an instance as long as its parameters are also instances:</p>\n\n<pre><code>instance (DefaultInitializable a, DefaultInitializable b) =&gt; DefaultInitializable (Coordinate a b) where\n    defaultInit = Coordinate default default\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1480289529, "post_id": 40833245, "comment_id": 68887700, "body": "But the question stands, <i>what does this class gain you</i> over simply using suitable functions on plain monomorphic <code>(a,b)</code> tuples? Or indeed a <i>vector class</i> like <a href=\"http://hackage.haskell.org/package/linear-1.20.5/docs/Linear-V2.html#t:R2\" rel=\"nofollow noreferrer\"><code>R2</code></a>, even better <a href=\"http://hackage.haskell.org/package/vector-space-0.10.4/docs/Data-VectorSpace.html#t:VectorSpace\" rel=\"nofollow noreferrer\"><code>VectorSpace</code></a>, which ensure that the elements are treated in a uniform way. Nevertheless I think the idea might be useful for entirely different applications; it inspired me <a href=\"http://stackoverflow.com/questions/40835094/\">to a new question</a>."}], "tags": [], "owner": {"reputation": 17, "user_id": 7214145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5920b0948eaf8344f03329a086eec7?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell Sean", "link": "https://stackoverflow.com/users/7214145/haskell-sean"}, "is_accepted": false, "score": 0, "last_activity_date": 1480276572, "creation_date": 1480276572, "answer_id": 40833245, "question_id": 40822310, "link": "https://stackoverflow.com/questions/40822310/creating-a-coordinate-class-in-haskell/40833245#40833245", "title": "Creating a Coordinate class in Haskell", "body": "<p>I feel this might be a solution to what I wanted   </p>\n\n<pre><code>module Main where\n\nclass Coordinate c where\n\n    createCoordinate :: x -&gt; y -&gt; c x y\n\n    getFirst :: c x y -&gt; x\n\n    getSecond :: c x y -&gt; y\n\n    addCoordinates :: (Num x) =&gt; (Num y) =&gt; c x y -&gt; c x y -&gt; c x y\n\ninstance Coordinate (,) where\n\n    createCoordinate a b = (a,b)\n\n    getFirst (a,_) = a\n\n    getSecond (_,b) = b\n\n    addCoordinates a b = (getFirst a + getFirst b, getSecond a + getSecond b)\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7214145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5920b0948eaf8344f03329a086eec7?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell Sean", "link": "https://stackoverflow.com/users/7214145/haskell-sean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1480286836, "creation_date": 1480188768, "last_edit_date": 1480286836, "question_id": 40822310, "link": "https://stackoverflow.com/questions/40822310/creating-a-coordinate-class-in-haskell", "title": "Creating a Coordinate class in Haskell", "body": "<p>I'm attempting to add two polymorphic tuples together in a pairwise manner. (The types of the first element in one tuple should be the same as the first in the second and likewise for the second element)\nHere's my code:</p>\n\n<pre><code>module Main where\n\nclass Coordinate a where\n\n    createCoordinate :: a\n\n    getFirst :: (a,b) -&gt; a\n\n    getSecond :: (a,b) -&gt; b\n\n    addCoordinates :: (a,b) -&gt; (a,b) -&gt; (a,b)\n\ninstance Coordinate () where\n\n    createCoordinate = ()\n\n    getFirst (a,b) = a\n\n    getSecond (a,b) = b\n\n    addCoordinates a b = (getFirst a + getFirst b, getSecond a + getSecond b)\n</code></pre>\n\n<p>So, the problem is with my addCoordinates function. I was wondering if anyone could offer me any help with how to go about implementing the function.\nThanks! :)</p>\n"}, {"tags": ["haskell", "haskell-stack", "intero"], "comments": [{"owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 1, "creation_date": 1480181493, "post_id": 40820871, "comment_id": 68861226, "body": "It might have to do with what you have in your <code>stack.yaml</code>, like the <code>resolver</code> entry for example"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1480209426, "post_id": 40820871, "comment_id": 68868253, "body": "According to the error message, you seem to be using a nightly snapshot of GHC from ten days ago (8.0.1.20161117) rather than e.g. the latest stable version (8.0.1). Is that expected?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1480209457, "post_id": 40820871, "comment_id": 68868262, "body": "(By the way: please don&#39;t post code or error messages as images. Paste them as text instead.)"}, {"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1483468779, "post_id": 40820871, "comment_id": 70106833, "body": "Basically the same issue issue can arise <a href=\"https://github.com/commercialhaskell/stack/issues/2524\" rel=\"nofollow noreferrer\">with hoogle</a>. <a href=\"https://github.com/commercialhaskell/stack/issues/2643\" rel=\"nofollow noreferrer\">This is the proposed fix</a>."}], "owner": {"reputation": 181, "user_id": 3511511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f695d53cc3acd300a9e119b40c9d7ac?s=128&d=identicon&r=PG", "display_name": "user12457", "link": "https://stackoverflow.com/users/3511511/user12457"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480287803, "creation_date": 1480180248, "last_edit_date": 1480287803, "question_id": 40820871, "link": "https://stackoverflow.com/questions/40820871/intero-emacs-error", "title": "Intero Emacs error", "body": "<p>I am getting the following error. Anyone knows how to solve it?<a href=\"https://i.stack.imgur.com/G7XTG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/G7XTG.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["sorting", "haskell", "lazy-evaluation", "mergesort"], "answers": [{"tags": [], "owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "is_accepted": true, "score": 4, "last_activity_date": 1480177139, "last_edit_date": 1480177139, "creation_date": 1480176681, "answer_id": 40820298, "question_id": 40820093, "link": "https://stackoverflow.com/questions/40820093/haskell-head-mergesort-for-min-element-in-linear-time/40820298#40820298", "title": "Haskell: head . mergeSort (for min element) in linear time?", "body": "<blockquote>\n  <p>But lazyness still comes into play with the definitions like min xs = head . merge_sort $ xs. In finding the minimal element this way <strong>only the necessary amount of comparisons</strong> between elements will be performed (O(n) a.o.t. O(nlogn) comparisons needed to fully sort the whole list).</p>\n</blockquote>\n\n<p>You are right, it will have a time complexity of <em>O(n log(n))</em>, however if you read the above paragraph carefully you will see, that it is talking about the amount of comparisons. Only <em>O(n)</em> comparisions will be performed, because every <code>merge</code> application only has to produce one element, so it only has to compare the first two elements of it's arguments. So you get <em>n/2</em> comparisons at the leaves of the recursion plus <em>n/4</em> one level up, then <em>n/4</em>,... all the way up to the top-level of the recursion. If you work it out you get <em>n-1</em> comparisons.</p>\n"}], "owner": {"reputation": 47, "user_id": 6827687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b4132b6dc0e0f9cb83fb791c5d7578c?s=128&d=identicon&r=PG&f=1", "display_name": "eternalStudent", "link": "https://stackoverflow.com/users/6827687/eternalstudent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 40820298, "answer_count": 1, "score": 2, "last_activity_date": 1480177139, "creation_date": 1480175383, "question_id": 40820093, "link": "https://stackoverflow.com/questions/40820093/haskell-head-mergesort-for-min-element-in-linear-time", "title": "Haskell: head . mergeSort (for min element) in linear time?", "body": "<p>In the HaskellWiki <a href=\"https://wiki.haskell.org/Performance/Laziness\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Performance/Laziness</a> they introduce the merge-sort function as non-lazy</p>\n\n<pre><code>merge_sort []  = []\nmerge_sort [x] = [x]\nmerge_sort lst = let (e,o) = cleave lst \n              in merge (merge_sort e) (merge_sort o) where\n merge :: (Ord a) =&gt; [a] -&gt; [a] -&gt; [a]\n merge xs [] = xs\n merge [] ys = ys\n merge xs@(x:t) ys@(y:u)\n     | x &lt;= y    = x : merge t ys\n     | otherwise = y : merge xs u\n</code></pre>\n\n<p>since you first have to recursively cleave the list </p>\n\n<pre><code> cleave = cleave' ([],[]) where\n cleave' (eacc,oacc) [] = (eacc,oacc)\n cleave' (eacc,oacc) [x] = (x:eacc,oacc)\n cleave' (eacc,oacc) (x:x':xs) = cleave' (x:eacc,x':oacc) xs\n</code></pre>\n\n<p>and then, going up the reduction layers, merge these. So a merge-sort runs in n(log n) time. But the composition </p>\n\n<pre><code>min xs = head . merge_sort $ xs\n</code></pre>\n\n<p>supposedly runs in linear time. I can't see why, as you still have to cleave every sublist until you arrive at the singleton/empty lists and then merge these to guarantee the first element of the returned list is the smallest of all. What am I missing? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480185594, "post_id": 40818976, "comment_id": 68862520, "body": "Do you think you could post the code in <code>iCreateTable</code> too? That way, we will know if we have evaded  your error."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1480267867, "post_id": 40818976, "comment_id": 68881223, "body": "Since you have a class <code>TableCreate</code>, you can simply put these constraints in the class instances - <code>instance (Code a ~ &#39;[x0, x1], DynamoScalar x0, DynamoScalar x1) =&gt; TableCreate WithRange a where ...</code>. In this case, you simply remove <code>MinimumRecordSize</code> altogether. The instance <code>MinimumRecordSize NoRange &#39;[ hash &#39;: rest ] = ()</code> simply doesn&#39;t do what you think it does - it does not <i>provide</i> this constraint, but rather <i>require</i> it."}, {"owner": {"reputation": 7714, "user_id": 149901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1a6db7a9fb5385fde6ba426e27d5ac6?s=128&d=identicon&r=PG", "display_name": "ondra", "link": "https://stackoverflow.com/users/149901/ondra"}, "edited": false, "score": 0, "creation_date": 1480274923, "post_id": 40818976, "comment_id": 68883525, "body": "I am doing that - in this case it is not so bad as I can kind of assume the structure will have more fields even if not strictly needed, however it fails in other situations, see edit."}, {"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 0, "creation_date": 1480323391, "post_id": 40818976, "comment_id": 68897796, "body": "Re edit 2: Perhaps define a class <code>class HasHashAndRange (a :: [[*]]) where mkSomething&#39; :: ...</code> and then <code>instance HasHashAndRange &#39;[ hash &#39;: range &#39;: rest ] where mkSomething&#39; = ...</code>. Define <code>f</code> over codes rather than original types, and with <code>f :: (SListI tables, All HasHashAndRange tables) =&gt; ...</code>. But more information would help. As it is, the question is not very concrete."}, {"owner": {"reputation": 7714, "user_id": 149901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1a6db7a9fb5385fde6ba426e27d5ac6?s=128&d=identicon&r=PG", "display_name": "ondra", "link": "https://stackoverflow.com/users/149901/ondra"}, "edited": false, "score": 0, "creation_date": 1480546503, "post_id": 40818976, "comment_id": 69013268, "body": "I have simplified the question. I need the constraint in the <code>class</code> - having it only as one of the <code>instance</code> doesn&#39;t help."}], "owner": {"reputation": 7714, "user_id": 149901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1a6db7a9fb5385fde6ba426e27d5ac6?s=128&d=identicon&r=PG", "display_name": "ondra", "link": "https://stackoverflow.com/users/149901/ondra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1480546414, "creation_date": 1480167977, "last_edit_date": 1480546414, "question_id": 40818976, "link": "https://stackoverflow.com/questions/40818976/constraint-type-list-length-with-a-type-family-function", "title": "Constraint type-list length with a type family function", "body": "<p>EDIT: I think I need to simplify this question: </p>\n\n<p>I am using <code>generic-sop</code> library. I need to have a constraint '<code>a</code> has one constructor with at least 2 fields'. My functions look like this:</p>\n\n<pre><code>myFunction :: (Code a ~ '[ f1 ': f2 ': rest ]) =&gt; a -&gt; something\n</code></pre>\n\n<p>However, I'd like to have this constraint as a 'type family'; i.e. I'd like to use e.g.</p>\n\n<pre><code>class (Code a ~ '[ f1 ': f2 ': rest) =&gt; Has2Records a\ninstance (Code a ~ '[ f1 ': f2 ': rest) =&gt; Has2Records a\nmyFunction :: Has2Records a =&gt; a -&gt; something\n</code></pre>\n\n<p>Unfortunately, it doesn't work - the variables in the <code>class</code> should appear as parameters to the <code>Has2Records</code>.</p>\n\n<p>This simplifies the code; also, if I could do something like this, I could use it in the type family:</p>\n\n<pre><code>type family HowMany a r :: Constraint\ntype instance HowMany a Need1 = (Has1Record a)\ntype instance HowMany a Need2 = (Has2Records a)\n\nclass MyGreatClass a need where\n  doSomething :: HowMany a need =&gt; a -&gt; Something\ninstance MyGreatClass a Need1 where\n  doSomething = (fneed1 :: (Code a ~ '[ f1 ': rest ]) =&gt; a -&gt; Something)\ninstance MyGreatClass a Need2\n  doSomething = (fneed1 :: (Code a ~ '[ f1 ': f2 ': rest ]) =&gt; a -&gt; Something)\n</code></pre>\n"}, {"tags": ["algorithm", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 3, "creation_date": 1480165022, "post_id": 40818498, "comment_id": 68856470, "body": "Instead of <code>(==1) . length</code> I would use <code>null . drop 1</code>, because it is lazier. That is it doesn&#39;t have to walk the whole list if it already found a <code>True</code> and a <code>False</code>. Note that this change will also return <code>True</code> for <code>[]</code> instead of <code>False</code>, which may or may not be desired."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1480165172, "post_id": 40818498, "comment_id": 68856504, "body": "Wow. One of the rare cases where <code>head xs</code> will not error out on the empty list. It took a few seconds to me to realize that it was indeed safe :-)"}, {"owner": {"reputation": 3967, "user_id": 3853711, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/SwXly.png?s=128&g=1", "display_name": "Rahn", "link": "https://stackoverflow.com/users/3853711/rahn"}, "reply_to_user": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1480165423, "post_id": 40818498, "comment_id": 68856571, "body": "@jpath His own code trigger exception on an empty list"}, {"owner": {"reputation": 3967, "user_id": 3853711, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/SwXly.png?s=128&g=1", "display_name": "Rahn", "link": "https://stackoverflow.com/users/3853711/rahn"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1480165627, "post_id": 40818498, "comment_id": 68856611, "body": "@chi 2 <code>sameBool</code> return differently for <code>[]</code>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1480192739, "post_id": 40818498, "comment_id": 68864680, "body": "<i>allSame</i> means <i>noneDifferent</i>, so <code>sameBool []</code> <i>must</i> be <code>True</code>."}], "tags": [], "owner": {"reputation": 3967, "user_id": 3853711, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/SwXly.png?s=128&g=1", "display_name": "Rahn", "link": "https://stackoverflow.com/users/3853711/rahn"}, "is_accepted": true, "score": 7, "last_activity_date": 1480165552, "last_edit_date": 1480165552, "creation_date": 1480164713, "answer_id": 40818498, "question_id": 40818480, "link": "https://stackoverflow.com/questions/40818480/how-do-i-check-if-a-list-of-bool-value-contain-the-same-value/40818498#40818498", "title": "How do I check if a list of Bool value contain the same value?", "body": "<p>With <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#v:all\" rel=\"nofollow noreferrer\">all</a>:</p>\n\n<pre><code>sameBool :: [Bool] -&gt; Bool\nsameBool xs = all (== head xs) xs\n</code></pre>\n\n<p>With <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html#v:nub\" rel=\"nofollow noreferrer\">nub</a> from <code>Data.List</code>:</p>\n\n<pre><code>import Data.List\n\nsameBool :: [Bool] -&gt; Bool\nsameBool = (== 1) . length . nub\n</code></pre>\n\n<p>Actually, they works for any instance of <code>Eq</code>:</p>\n\n<pre><code>sameBool :: Eq a =&gt; [a] -&gt; Bool\nsameBool xs = all (== head xs) xs\n-- Note: return True for []\n\nsameBool :: Eq a =&gt; [a] -&gt; Bool\nsameBool = (== 1) . length . nub\n-- Note: return False for []\n</code></pre>\n\n<p>Check <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html#v:nubBy\" rel=\"nofollow noreferrer\">nubBy</a> for types that aren't instances of <code>Eq</code>.</p>\n"}], "owner": {"reputation": 35, "user_id": 7213073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395ec7963deeb4111f938ffdf34aa4cf?s=128&d=identicon&r=PG&f=1", "display_name": "Kakalaki", "link": "https://stackoverflow.com/users/7213073/kakalaki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 40818498, "answer_count": 1, "score": 3, "last_activity_date": 1539826924, "creation_date": 1480164593, "last_edit_date": 1539826924, "question_id": 40818480, "link": "https://stackoverflow.com/questions/40818480/how-do-i-check-if-a-list-of-bool-value-contain-the-same-value", "title": "How do I check if a list of Bool value contain the same value?", "body": "<p>I want to write a function like:</p>\n\n<pre><code>sameBool :: [Bool] -&gt; Bool\n</code></pre>\n\n<p>for example:</p>\n\n<pre><code>[True, False, True] =&gt; False\n[True, True] =&gt; True\n</code></pre>\n\n<p>Here's my solution:</p>\n\n<pre><code>sameBool :: [Bool] -&gt; Bool\nsameBool xs = if head xs == True\n                  then length (filter (== False) xs) == 0\n                  else length (filter (== True)  xs) == 0\n</code></pre>\n\n<p>Effective though not elegant. I'm looking for some more elegant solution.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2399, "user_id": 3065657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XDEr0.jpg?s=128&g=1", "display_name": "lycuid", "link": "https://stackoverflow.com/users/3065657/lycuid"}, "edited": false, "score": 1, "creation_date": 1480144649, "post_id": 40815883, "comment_id": 68851724, "body": "I am confused, 1) What do you mean by &quot;Empty&quot;. 2) you wanna check if the column is full? of what? 3) the board is supposed to be a list of rows or columns?"}, {"owner": {"reputation": 15, "user_id": 7212344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/315546f6a4a6ea0e7e64d86474d57687?s=128&d=identicon&r=PG&f=1", "display_name": "J. Wu", "link": "https://stackoverflow.com/users/7212344/j-wu"}, "reply_to_user": {"reputation": 2399, "user_id": 3065657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XDEr0.jpg?s=128&g=1", "display_name": "lycuid", "link": "https://stackoverflow.com/users/3065657/lycuid"}, "edited": false, "score": 0, "creation_date": 1480174795, "post_id": 40815883, "comment_id": 68859093, "body": "1) The board (like any real life game of Tic Tac Toe) will start off obviously as  [empty,empty,empty][empty,empty,empty][empty,empty,empty]  or it will start off as the empty list and a function needs to transform it to  [empty,empty,empty][empty,empty,empty][empty,empty,empty]  2) I want to check if the column is full, so to error check.  3) The board is a list of lists. Columns by human interpretation are merely lists  So in a tic tac toe board that is ALL X&#39;s EXCEPT the middle being an O, is  [X,X,X][X.O,X][X,X,X]"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7212344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/315546f6a4a6ea0e7e64d86474d57687?s=128&d=identicon&r=PG&f=1", "display_name": "J. Wu", "link": "https://stackoverflow.com/users/7212344/j-wu"}, "edited": false, "score": 0, "creation_date": 1480174680, "post_id": 40817005, "comment_id": 68859058, "body": "Thank you, but what if I need to check if the 1 dimensional list is full in general??   So say it is [X,X,O], and the player tries to play X or O in it (anywhere, or lets just say the tail of the list or head to make it simple), then how does one error check and prevent players from playing in these full lists?  The solution above only checks for homogeneous type lists, which would help me check for win conditions though haha."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 1, "last_activity_date": 1480200442, "last_edit_date": 1480200442, "creation_date": 1480153734, "answer_id": 40817005, "question_id": 40815883, "link": "https://stackoverflow.com/questions/40815883/check-if-a-particular-list-in-a-list-of-lists-is-full-or-not-in-haskell/40817005#40817005", "title": "Check if a particular list in a &quot;list of lists&quot; is full or not in Haskell", "body": "<p>You can check if a given (1-dimensional) list is all <code>X</code> with</p>\n\n<pre><code>all (== X) list\n</code></pre>\n\n<p>(As long as your data type has an <code>Eq</code> instance, which you can give it with e.g.</p>\n\n<pre><code>data Square = X | O | Empty\n    deriving (Eq)\n</code></pre>\n\n<p>).</p>\n\n<p>Similarly, you can check if every element is non-empty with</p>\n\n<pre><code>all (/= Empty) list\n</code></pre>\n\n<p>or by defining your own function <code>isFull :: Square -&gt; Bool</code> and using <code>all isFull list</code>.</p>\n\n<p>You can extract a column from a list by mapping a list index operator over it.</p>\n\n<pre><code>column n xss = map (!! n) xss\n</code></pre>\n\n<p>Another way, which is arguably more elegant, is to <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html#v:transpose\" rel=\"nofollow noreferrer\"><code>transpose</code></a> it and then look at the rows.</p>\n"}], "owner": {"reputation": 15, "user_id": 7212344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/315546f6a4a6ea0e7e64d86474d57687?s=128&d=identicon&r=PG&f=1", "display_name": "J. Wu", "link": "https://stackoverflow.com/users/7212344/j-wu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 0, "accepted_answer_id": 40817005, "answer_count": 1, "score": -2, "last_activity_date": 1480200442, "creation_date": 1480143849, "last_edit_date": 1480174842, "question_id": 40815883, "link": "https://stackoverflow.com/questions/40815883/check-if-a-particular-list-in-a-list-of-lists-is-full-or-not-in-haskell", "title": "Check if a particular list in a &quot;list of lists&quot; is full or not in Haskell", "body": "<p>I'm playing Tic Tac Toe and the columns are represented by lists, \nso classic 3x3 Tic Tac full of alternating X and O, from bottom to up, for three columns, would be [X,O,X][X,O,X][X,O,X]. Empty would be represented by Empty I guess (is that a good idea or bad idea)</p>\n\n<p>How would I check if a selected column X, is full?</p>\n\n<p>I want to have a function called Checker :: board -> Int -> Bool</p>\n\n<p>Not really sure where to begin on defining the function Checker.</p>\n\n<p>Edit: Clarifications</p>\n\n<p>1) The board (like any real life game of Tic Tac Toe) will start off obviously as\n [empty,empty,empty][empty,empty,empty][empty,empty,empty]</p>\n\n<p>or it will start off as the empty list and a function needs to transform it to \n[empty,empty,empty][empty,empty,empty][empty,empty,empty]</p>\n\n<p>2) I want to check if the column is full, so to error check. I do not want players to add X's or O's to full columns. Columns could be filled up with any combination of X's and O's, just like mid way in a real life game of Tic-Tac-Toe.</p>\n\n<p>3) The board is a list of lists. Columns by human interpretation are merely lists</p>\n\n<p>So in a tic tac toe board that is ALL X's EXCEPT the middle being an O, is \n[X,X,X][X.O,X][X,X,X]</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1480134784, "post_id": 40814440, "comment_id": 68849872, "body": "Step through the evaluation of <code>la[1]</code>."}, {"owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 1, "creation_date": 1480136548, "post_id": 40814440, "comment_id": 68850144, "body": "<code>la (x:xs)</code> is easier to read since <code>head (x:xs) = x</code> and <code>tail (x:xs) = xs</code>"}], "answers": [{"tags": [], "owner": {"reputation": 555, "user_id": 1505475, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bc72887d0b9f71cdbc2eeb5f9899d8f?s=128&d=identicon&r=PG", "display_name": "simon1505475", "link": "https://stackoverflow.com/users/1505475/simon1505475"}, "is_accepted": false, "score": 6, "last_activity_date": 1480136224, "creation_date": 1480136224, "answer_id": 40815075, "question_id": 40814440, "link": "https://stackoverflow.com/questions/40814440/list-of-each-numbers-not-equal-false-working-but-on-equal-number-its-not-working/40815075#40815075", "title": "List of each numbers not equal False working but on equal number its not working", "body": "<p>The problem is that in the second branch, you only know that the list has size at least 1 but you're looking for the second argument. I recommend you replace head and tail (which are partial functions) with a pattern matching:</p>\n\n<pre><code>la [] = True\nla (x0:x1:xs) =\n      if (x0 == x1)\n          then la (x1:xs)\n          else False\n</code></pre>\n\n<p>If you call ghc with -W, you'll get the warning that your patterns don't cover x:[]. You probably want to add this branch:</p>\n\n<pre><code>la (x0:[]) = True\n</code></pre>\n\n<p>In passing, you should simplify your expression: </p>\n\n<pre><code>      if (x0 == x1)\n          then la (x1:xs)\n          else False\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>(x0 == x1) &amp;&amp; la (x1:xs)\n</code></pre>\n\n<p>To get a bit more technical about your problem, the issue arises when <code>a = [x]</code> for some <code>x</code>. First, <code>head</code> and <code>tail</code> are defined as:</p>\n\n<pre><code>head (x:xs) = x\nhead [] = undefined\n\ntail (x:xs) = xs\ntail [] = undefined\n</code></pre>\n\n<p>Then, the expression <code>head (tail a)</code> evaluates as follows:</p>\n\n<pre><code>  head (tail a)\n=  { value of a }\n  head (tail (x:[]))\n=  { first equation of tail }\n  head []\n=  { second equation of head }\n  undefined\n</code></pre>\n\n<p>And this is why you get an error.</p>\n"}], "owner": {"reputation": 21, "user_id": 7211916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a78c67694f8498ffde7e117e678d40b0?s=128&d=identicon&r=PG&f=1", "display_name": "sudokhan", "link": "https://stackoverflow.com/users/7211916/sudokhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1480136224, "creation_date": 1480128363, "question_id": 40814440, "link": "https://stackoverflow.com/questions/40814440/list-of-each-numbers-not-equal-false-working-but-on-equal-number-its-not-working", "title": "List of each numbers not equal False working but on equal number its not working", "body": "<p>Below I show the output. I gave a list of numbers if they are not equal then return False and its working correctly. But If the list of numbers equal then its not return True. Can you check this code?</p>\n\n<pre><code>la [] = True\nla a =\n      if ((head a )==head (tail a))\n          then la (tail a)\n          else False\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>Cw2016&gt; la [1,2,2]\nFalse\nCw2016&gt; la [2,2,2]\n\nProgram error: pattern match failure: head []\n\nCw2016&gt; la [2,2,3]\nFalse\nCw2016&gt; la [0,1,3]\nFalse\nCw2016&gt; la [0,0,3]\nFalse\nCw2016&gt; la [0,0,0]\n\nProgram error: pattern match failure: head []\n\nCw2016&gt; \n</code></pre>\n"}, {"tags": ["haskell", "types"], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 12, "last_activity_date": 1480117914, "creation_date": 1480117914, "answer_id": 40813590, "question_id": 40813463, "link": "https://stackoverflow.com/questions/40813463/haskell-multiple-type-classes-for-one-argument/40813590#40813590", "title": "Haskell, multiple type classes for one argument", "body": "<p>That's not the only possible signature for this signature. It happens to be the <em>most general</em> one. <code>compareWithHundred :: Int -&gt; Ordering</code> is actually a possible instantiation \u2013 the polymorphic <code>a</code> argument can be instatiated with any orderable number type, which does sure enough include <code>Int</code>, but also <code>Integer</code>, <code>Rational</code>, <code>Double</code>...</p>\n\n<pre><code>Prelude&gt; let compareWithHundred :: (Num a, Ord a) =&gt; a -&gt; Ordering; compareWithHundred x = compare 100 x\nPrelude&gt; compareWithHundred (99 :: Int)\nGT\nPrelude&gt; compareWithHundred (100.3 :: Double)\nLT\n</code></pre>\n\n<p>Not <em>all number types</em> permit you to order-compare them though \u2013 the classical example where this is not possible are complex numbers (which have \u201cmore than one direction\u201d in which you could order them).</p>\n\n<pre><code>Prelude Data.Complex&gt; compareWithHundred (100 :+ 30 :: Complex Double)\n\n&lt;interactive&gt;:10:1:\n    No instance for (Ord (Complex Double))\n      arising from a use of \u2018compareWithHundred\u2019\n    In the expression: compareWithHundred (100 :+ 30 :: Complex Double)\n    In an equation for \u2018it\u2019:\n        it = compareWithHundred (100 :+ 30 :: Complex Double)\n</code></pre>\n\n<p>Hence you need to require both that the argument is a number (so there exists a value 100 which to compare with) and that the argument is in the <code>Ord</code> class. This combined constrained is written <code>(Num a, Ord a)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 8, "last_activity_date": 1480125671, "creation_date": 1480125671, "answer_id": 40814236, "question_id": 40813463, "link": "https://stackoverflow.com/questions/40813463/haskell-multiple-type-classes-for-one-argument/40814236#40814236", "title": "Haskell, multiple type classes for one argument", "body": "<p>I have something to add, in case you couldn't gather something from leftaroundabout's thorough answer.</p>\n\n<p>Everything to the left of <code>=&gt;</code> in a type signature is a <em>constraint</em>.  Read the type like this:</p>\n\n<pre><code>compareWithHundred :: (Num a, Ord a) =&gt; a -&gt; Ordering\n                      ^^^^^^^^^^^^^^    ^    ^^^^^^^^\n                       constraints      |         |\n                                 argument type    |\n                                             result type\n</code></pre>\n\n<p>So you only pass one argument to the function because there is only one argument in the type signature, <code>a</code>.  <code>a</code> is a type variable, and can be replaced with any type <em>as long as that type satisfies the constraints</em>.  </p>\n\n<p>The <code>Num a</code> says that whatever you replace <code>a</code> with has to be numeric (so it can be <code>Int</code>, <code>Integer</code>, <code>Double</code>, ...), and the <code>Ord a</code> says that it has to be comparable.  leftroundabout's answer goes into more detail about why you need both, I just wanted to make sure you knew how to read the signature.</p>\n\n<p>So it's perfectly legal in one sense to say <code>compareWithHundred \"foobar\"</code>, the type checker says that that expression's type is <code>Ordering</code>, but then it will fail later when it tries to check that there is a <code>Num String</code> instance.</p>\n\n<p>I hope this helps.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3292534"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5038, "favorite_count": 1, "accepted_answer_id": 40813590, "answer_count": 2, "score": 6, "last_activity_date": 1480125671, "creation_date": 1480116895, "question_id": 40813463, "link": "https://stackoverflow.com/questions/40813463/haskell-multiple-type-classes-for-one-argument", "title": "Haskell, multiple type classes for one argument", "body": "<p>This is an example in Learn You A Haskell, chapter on higher order functions:</p>\n\n<pre><code>compareWithHundred :: (Num a, Ord a) =&gt; a -&gt; Ordering  \ncompareWithHundred x = compare 100 x  \n</code></pre>\n\n<p>While the idea of the function is clear for me, I'm not sure why type signature is (Num a, Ord a). We only pass integer that is to be compared to the function, of type Int. What <code>Ord</code> stands for here, and why is implicitly passed argument in type signature?</p>\n"}, {"tags": ["haskell", "arrows"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1480116750, "post_id": 40813355, "comment_id": 68847041, "body": "You do know how to implement <code>&amp;&amp;</code> in terms of <code>||</code> and <code>not</code>?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480118770, "post_id": 40813355, "comment_id": 68847500, "body": "@Alec: <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Category.html#v:id\" rel=\"nofollow noreferrer\"><code>wire = id</code></a> is actually fine."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1480119495, "post_id": 40813355, "comment_id": 68847642, "body": "@leftaroundabout Ah yes. I wish we had only one version of <code>(.)</code> and <code>id</code>. :("}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480120032, "post_id": 40813355, "comment_id": 68847735, "body": "@Alec I don&#39;t. I myself use almost only the polymorphic versions, but it&#39;s probably good that the prelude keeps it more simple for beginners."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 7211601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afece1f9f264a0f6db001600155556?s=128&d=identicon&r=PG&f=1", "display_name": "Martin R.", "link": "https://stackoverflow.com/users/7211601/martin-r"}, "edited": false, "score": 0, "creation_date": 1480122494, "post_id": 40813668, "comment_id": 68848165, "body": "Great answer, I understand now how this work, and the do notation is even better. AND is correct? Should be NOT (a OR b), right?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 63, "user_id": 7211601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afece1f9f264a0f6db001600155556?s=128&d=identicon&r=PG&f=1", "display_name": "Martin R.", "link": "https://stackoverflow.com/users/7211601/martin-r"}, "edited": false, "score": 1, "creation_date": 1480123936, "post_id": 40813668, "comment_id": 68848415, "body": "No, I think it is right. Might want to check <a href=\"https://en.wikipedia.org/wiki/De_Morgan&#39;s_laws\" rel=\"nofollow noreferrer\">this</a> again."}, {"owner": {"reputation": 63, "user_id": 7211601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afece1f9f264a0f6db001600155556?s=128&d=identicon&r=PG&f=1", "display_name": "Martin R.", "link": "https://stackoverflow.com/users/7211601/martin-r"}, "edited": false, "score": 0, "creation_date": 1480125760, "post_id": 40813668, "comment_id": 68848692, "body": "now if you want to do something more complicated like:  (A and B) or (C and D)  With the awesome do notation is a breeze:  parallel = proc ((a, b), (c,d)) -&gt; do                    e &lt;- andGate -&lt; (a,b)                    f &lt;- andGate -&lt; (c,d)                    orGate -&lt; (f,f)  But how you do it with the other notation?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 63, "user_id": 7211601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afece1f9f264a0f6db001600155556?s=128&d=identicon&r=PG&f=1", "display_name": "Martin R.", "link": "https://stackoverflow.com/users/7211601/martin-r"}, "edited": false, "score": 0, "creation_date": 1480133192, "post_id": 40813668, "comment_id": 68849666, "body": "@MartinR. You&#39;ll have to sprinkle the expression with &#39;let&#39;s"}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 3, "last_activity_date": 1480181137, "last_edit_date": 1480181137, "creation_date": 1480118694, "answer_id": 40813668, "question_id": 40813355, "link": "https://stackoverflow.com/questions/40813355/modeling-a-circuit-with-arrows/40813668#40813668", "title": "Modeling a circuit with arrows", "body": "<p>I recommend you look at <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Arrow.html\" rel=\"nofollow noreferrer\"><code>Control.Arrow</code></a>, in particular <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Arrow.html#v:-42--42--42-\" rel=\"nofollow noreferrer\"><code>(***)</code>, <code>(&amp;&amp;&amp;)</code>, and <code>(&gt;&gt;&gt;)</code></a>. <a href=\"https://en.wikibooks.org/wiki/Haskell/Understanding_arrows\" rel=\"nofollow noreferrer\">This tutorial</a> is also really good. </p>\n\n<ul>\n<li><p><code>(***)</code> allows you to take two arrows and put them side by side into an arrow that has both inputs and outputs (as tuples):</p>\n\n<pre><code>(***) :: Arrow a =&gt; a b c -&gt; a b' c' -&gt; a (b, b') (c, c')\n</code></pre></li>\n<li><p><code>(&amp;&amp;&amp;)</code> lets you again combine two arrows and get a tuple of their output, but this time both of the arrows will consume the <em>same</em> input:</p>\n\n<pre><code>(&amp;&amp;&amp;) :: Arrow a =&gt; a b c -&gt; a b c' -&gt; a b (c, c')\n</code></pre></li>\n<li><p><code>(&gt;&gt;&gt;)</code> lets you sequence (compose) two arrows. This is very similar to function composition. In fact, <code>(&gt;&gt;&gt;)</code> is just the generalized <code>(.)</code> from <code>Control.Category</code> with its arguments flipped.</p>\n\n<pre><code>(&gt;&gt;&gt;) :: Arrow a =&gt; a b c -&gt; a c d -&gt; a b d\n</code></pre>\n\n<p>(Actually, the constraint only needs to be <code>Category</code>, but that is beside the point here.)</p></li>\n</ul>\n\n<p>Then, we can use some common logical equivalences to get <code>andGate</code>, <code>nandGate</code> and <code>xorGate</code>:</p>\n\n<pre><code>-- Use (x NAND y) === ((NOT x) OR (NOT y))\nnandGate :: Circuit circ =&gt; circ (Bool, Bool) Bool\nnandGate = (notGate *** notGate) &gt;&gt;&gt; orGate\n\n-- Use (x NAND y) === (NOT (x NAND y))\nandGate :: Circuit circ =&gt; circ (Bool, Bool) Bool\nandGate = nandGate &gt;&gt;&gt; notGate\n\n-- Use (x XOR y) === ((x OR y) AND (x NAND y))\nxorGate :: Circuit circ =&gt; circ (Bool, Bool) Bool\nxorGate = (orGate &amp;&amp;&amp; nandGate) &gt;&gt;&gt; andGate\n</code></pre>\n\n<h3>Aside on <code>-XArrows</code></h3>\n\n<p>There is a really neat syntax extension that let you write <code>Arrow</code>s using a special <code>do</code>-like notation. This is somewhat more readable than the cryptic <code>Control.Arrow</code> operators, especially when you have a bunch of arrows interacting.</p>\n\n<pre><code>{-# LANGUAGE Arrows #-}\n\n nandGate :: Circuit circ =&gt; circ (Bool , Bool ) Bool\n nandGate = proc (x,y) -&gt; do\n              x' &lt;- notGate -&lt; x\n              y' &lt;- notGate -&lt; y\n              orGate -&lt; (x',y')\n\n andGate :: Circuit circ =&gt; circ (Bool, Bool) Bool\n andGate = proc (x,y) -&gt; do\n              z &lt;- nandGate -&lt; (x,y)\n              notGate -&lt; z\n\n xorGate :: Circuit circ =&gt; circ (Bool, Bool) Bool\n xorGate = proc (x,y) -&gt; do\n              z &lt;- orGate -&lt; (x,y)\n              w &lt;- nandGate -&lt; (x,y)\n              andGate -&lt; (z,w)\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 7211601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5afece1f9f264a0f6db001600155556?s=128&d=identicon&r=PG&f=1", "display_name": "Martin R.", "link": "https://stackoverflow.com/users/7211601/martin-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 2, "accepted_answer_id": 40813668, "answer_count": 1, "score": 4, "last_activity_date": 1480181137, "creation_date": 1480116114, "last_edit_date": 1480120956, "question_id": 40813355, "link": "https://stackoverflow.com/questions/40813355/modeling-a-circuit-with-arrows", "title": "Modeling a circuit with arrows", "body": "<p>I have:</p>\n\n<pre><code>class Arrow circ \u21d2 Circuit circ where\n    wire    :: circ Bool Bool\n    notGate :: circ Bool Bool\n    orGate  :: circ (Bool , Bool ) Bool\n\n    wire = id\n    notGate = arr not\n    orGate = arr $ uncurry (||)\n</code></pre>\n\n<p>I want to implement:</p>\n\n<pre><code>-- A and B\nandGate :: Circuit circ \u21d2 circ (Bool , Bool ) Bool\n-- not (A and B)\nnandGate :: Circuit circ \u21d2 circ (Bool , Bool ) Bool\n-- A xor B\nxorGate :: Circuit circ \u21d2 circ (Bool , Bool ) Bool\n</code></pre>\n\n<p>I don't want to use something so simple as (arr and) but combine the function that already have. I fail to grasp how compose arrows as you do with functions.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["haskell", "types"], "answers": [{"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 4, "last_activity_date": 1480114121, "creation_date": 1480114121, "answer_id": 40813119, "question_id": 40812907, "link": "https://stackoverflow.com/questions/40812907/explicit-type-conversion/40813119#40813119", "title": "Explicit type conversion?", "body": "<p>The notation <code>x :: T</code> reads <em>expression x has type T</em></p>\n\n<p>This may be necessary in the presence of type classes and higher ranked types to enable the compiler to type check the program. For example:</p>\n\n<pre><code>main = print . show . read $ \"1234\"\n</code></pre>\n\n<p>is ambiguous, since the compiler cannot know which of the overloaded <code>read</code> functions to use.</p>\n\n<p>In addition, it is possible to narrow the type the compiler would infer. Example:</p>\n\n<pre><code>1 :: Int\n</code></pre>\n\n<p>Finally, a type signature like this is often used to make the program more readable. </p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 6, "last_activity_date": 1480114337, "creation_date": 1480114337, "answer_id": 40813145, "question_id": 40812907, "link": "https://stackoverflow.com/questions/40812907/explicit-type-conversion/40813145#40813145", "title": "Explicit type conversion?", "body": "<p>Yes, this is just explicitly stating that the type must be <code>CHA.ByteString</code>. This does (by itself) <em>not</em> incur any sort of conversion, it's just a hint for the compiler (and/or the reader) that <code>res</code> must have this type.</p>\n\n<p>These kinds of local annotations are needed when a value is both produced from a function with <em>polymorphic result</em>, and only consumed by functions with polymorphic argument. A simple example:</p>\n\n<pre><code>f :: Int -&gt; Int\nf = fromEnum . toEnum\n</code></pre>\n\n<p>Here, <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#v:toEnum\" rel=\"nofollow noreferrer\"><code>toEnum</code></a> converts an integer to a arbitrary enumerable type \u2013 could for instance be <code>Char</code>. Whatever type you'd choose, <code>fromEnum</code> would be able to convert it back... trouble is, there is no way to decide which type should be used for the intermediate result!</p>\n\n<pre><code>No instance for (Enum a0) arising from a use of \u2018fromEnum\u2019\nThe type variable \u2018a0\u2019 is ambiguous\nNote: there are several potential instances:\n  instance Integral a =&gt; Enum (GHC.Real.Ratio a)\n    -- Defined in \u2018GHC.Real\u2019\n  instance Enum Ordering -- Defined in \u2018GHC.Enum\u2019\n  instance Enum Integer -- Defined in \u2018GHC.Enum\u2019\n  ...plus 7 others\nIn the first argument of \u2018(.)\u2019, namely \u2018fromEnum\u2019\nIn the expression: fromEnum . toEnum\nIn an equation for \u2018f\u2019: f = fromEnum . toEnum\n</code></pre>\n\n<p>For some simple number classes, Haskell has <em>defaults</em>, so e.g. <code>fromIntegral . round</code> will automatically use <code>Integer</code>. But there are no defaults for types like <code>ByteString</code>, so with a polymorphic-result function like <a href=\"http://hackage.haskell.org/package/wreq-0.4.1.0/docs/Network-Wreq.html#v:responseBody\" rel=\"nofollow noreferrer\"><code>responseBody</code></a>, you either need to pass the result to a monomorphic function that <em>can</em> only accept <code>CHA.ByteString</code>, or you need to add an explicit annotation that this should be the type.</p>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 1, "accepted_answer_id": 40813145, "answer_count": 2, "score": 4, "last_activity_date": 1480121930, "creation_date": 1480112579, "last_edit_date": 1480121930, "question_id": 40812907, "link": "https://stackoverflow.com/questions/40812907/explicit-type-conversion", "title": "Explicit type conversion?", "body": "<p>This is an example function:</p>\n\n<pre><code>import qualified Data.ByteString.Lazy as LAZ\nimport qualified Data.ByteString.Lazy.Char8 as CHA\nimport Network.Wreq\n\nmakeRequest :: IO (Network.Wreq.Response LAZ.ByteString)\nmakeRequest = do \n   res &lt;- get \"http://www.example.com\" \n   let resBody = res ^. responseBody :: CHA.ByteString\n   --Do stuff....\n   return (res)\n</code></pre>\n\n<p>I'm struggling to understand the exact purpose of CHA.ByteString in this line:</p>\n\n<pre><code>let resBody = res ^. responseBody :: CHA.ByteString\n</code></pre>\n\n<p>Is this explicitly stating the type must be CHA.ByteString? Or does it serve another role?</p>\n"}, {"tags": ["haskell", "functional-programming", "dependent-type", "idris"], "comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1480111546, "post_id": 40812689, "comment_id": 68845764, "body": "I wasn&#39;t sure if questions asking for examples fall under the &quot;too broad&quot; rule, but I&#39;ve and found several highly voted questions similar to this one, so I guessed it was OK? <a href=\"http://stackoverflow.com/questions/171653/examples-of-requirement-documents\">A</a>, <a href=\"http://stackoverflow.com/questions/1085083/regular-expressions-in-c-examples\">B</a>, <a href=\"http://stackoverflow.com/questions/5004233/jquery-ajax-post-example-with-php\">C</a>, <a href=\"http://stackoverflow.com/questions/2271156/chrome-desktop-notification-example\">D</a>, etc..."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480111890, "post_id": 40812689, "comment_id": 68845870, "body": "Enforcing invariants in types for data-structures. The invariants may be easy to state, but tracking them through the code is tougher. <a href=\"http://stackoverflow.com/questions/36611533/total-real-time-persistent-queues\">This</a> question about queues comes to mind."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 3, "creation_date": 1480114148, "post_id": 40812689, "comment_id": 68846417, "body": "What do you mean by &quot;hard to implement&quot;? If I interpret this directly, then we can have things like termination of Collatz sequences, which is a expressed as a few lines of types in Agda."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1480114251, "post_id": 40812689, "comment_id": 68846445, "body": "@Andr&#225;sKov&#225;cs noo! I just mean daily programming stuff that take a ton of bug-prone lines but you can express important invariants as dependent types so when it compiles you can feel safe it doesn&#39;t have that particular bug. Just looking for some inspiration. No hard math things."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1480114353, "post_id": 40812689, "comment_id": 68846471, "body": "OK, but then what&#39;s &quot;hard to implement&quot;?"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1480114783, "post_id": 40812689, "comment_id": 68846575, "body": "Hard isn&#39;t the best choice of word when it comes to daily programming, complex maybe fits better. One obvious example I can think of is using an invariant to determine that a huge banking library will never have an account with negative balance; that looks easy to express as a type, and <b>I believe</b> that is one of the things an experienced Idris programmer would encode as such. But the point is, I&#39;m not quite sure this is actually the case, and I&#39;m not sure how I&#39;d do it. That is why I feel like I&#39;m missing some practical examples. Sadly there aren&#39;t many &quot;real-world app&quot; Idris repos around!"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1480115937, "post_id": 40812689, "comment_id": 68846833, "body": "@Andr&#225;sKov&#225;cs maybe this question isn&#39;t so good after all. Is anyone replying it? I&#39;ll delete it but will wait for tomorrow just in case"}], "answers": [{"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1480283498, "post_id": 40816124, "comment_id": 68886233, "body": "<i>&quot;no need to invent where to apply dependent types: the task loudly requires them&quot;</i> can&#39;t argue with that. I&#39;m glad I didn&#39;t remove the question."}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": false, "score": 4, "last_activity_date": 1480148818, "last_edit_date": 1480148818, "creation_date": 1480146101, "answer_id": 40816124, "question_id": 40812689, "link": "https://stackoverflow.com/questions/40812689/what-are-good-examples-of-programs-that-are-simple-to-specify-as-dependent-types/40816124#40816124", "title": "What are good examples of programs that are simple to specify as dependent types, but complex to implement?", "body": "<p>I'll answer this:</p>\n\n<blockquote>\n  <p>often it leaves the programmer wandering through old concepts, without knowing where to apply dependent types</p>\n</blockquote>\n\n<p>Sure types can be used to eliminate certain types of silly bugs, like when you apply a function to its arguments in a wrong order, but this is not what types are really for. Types structure your reasoning and allow to zoom into the structure of your computation.</p>\n\n<p>Say you process lists and use <code>head</code> and <code>tail</code> a lot, but these are partial functions, so you decide to switch to something safer and now you process <code>NonEmpty a</code> instead of <code>[a]</code>. Then you realize that you also do a lot of <code>lookup</code>s (a partial function again) and that it won't be too troublesome to maintain lengths of your lists statically in this particular case, so you switch to something like <code>NonEmptyVec n a</code>, where <code>n</code> is the statically known length of a vector. Now you have eliminated lots of possible bugs, but this is <strong>not</strong> the most important thing that happened.</p>\n\n<p>The most important thing is that now you look at the type signatures and see what kind of input functions expect and what kind of output they produce. Possible behaviour of a function has been narrowed by its type signature and now it's much easier to identify where in the pipeline the function belongs. But also the more detailed types you have, the more encapsulated your entity is: a function of type <code>NonEmpty a -&gt; b</code> no longer relies on the assumption that a non-empty list will be passed to it, instead it explicitly requires this invariant to hold. You've turned a jelly-like tightly coupled computation into a fine-grained one.</p>\n\n<p>What rich types are for is to guide humans (before code writing, during code writing, after code writing) and reduce their ability to produce bugs in the first place \u2014 not for spotting them a posteriori. Simple types I consider unavoidable, because even if you write code in a dynamically typed language, you still distinguish between a string and a picture.</p>\n\n<hr>\n\n<p>Enough chit-chat, here is a real world example of usefulness and, more importantly, naturalness of dependent types. I'm targeting an API with the help from the <code>Servant</code> library (which is an amazing piece of code and is dependently typed also, so you might want to check it):</p>\n\n<pre><code>type API a r = ReqBody '[JSON] (Operation a) :&gt; Post '[JSON] (Result r)\n</code></pre>\n\n<p>So we send a request of type <code>Operation a</code> (automatically encoded to JSON by Servant) and receive a <code>Result r</code> response (automatically decoded from JSON by Servant). <code>Operation</code> and <code>Result</code> are defined like this:</p>\n\n<pre><code>data Method = Add | Get\n\ndata Operation a = Operation\n  { method :: !Method\n  , params :: !a\n  }\n\ndata Result a = Result\n  { result :: !a\n  }\n</code></pre>\n\n<p>The task is to perform operations and receive responses from a server. The problem however is that when we <code>Add</code> things, the server responses with a <code>AddResults</code>, and when we <code>Get</code> things, the server's response depends on what we passed together with the <code>Get</code> method. So we write a type family:</p>\n\n<pre><code>type family ResultOf m a where\n  ResultOf Add a               = AddResults\n  ResultOf Get DictionaryNames = Dictionaries\n</code></pre>\n\n<p>The code reads better than my description above. It only remains to lift <code>Method</code>s to the type level, so we define an appropriate singleton (which is the way to emulate dependent types in Haskell currently):</p>\n\n<pre><code>data SMethod m where\n  SAdd :: SMethod Add\n  SGet :: SMethod Get\n</code></pre>\n\n<p>And here is the type signature of the main function (omitted lots of unrelated things):</p>\n\n<pre><code>perform :: SMethod m -&gt; a -&gt; ClientM (ResultOf m a)\n</code></pre>\n\n<p><code>perform</code> receives a method in a singleton form and some value and returns a computation in the Servant's <code>ClientM</code> monad. This computation returns a result which type depends on both the method and the type of the value: if we <code>SAdd</code>, we get <code>AddResults</code>; if we <code>SGet</code> <code>DictionaryNames</code>, we get <code>Dictionaries</code>. Very sensible and very natural \u2014 no need to invent where to apply dependent types: the task loudly requires them.</p>\n"}, {"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1488950088, "post_id": 42662960, "comment_id": 72452482, "body": "I love your point of view. It is simple and extremely meaningful."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1488953353, "post_id": 42662960, "comment_id": 72453585, "body": "@MaiaVictor, dependent types are not about proving. Dependent types are about well-structuredness \u2014 this is what I explain in the first part of my answer. Yes, it&#39;s true that you can write proofs in a type theory, but this is just one particular use case, which you can practically cover only because of all the abstraction and zooming facilities type theories provide. <a href=\"http://stackoverflow.com/questions/12961651/why-not-be-dependently-typed\">Quoting</a> pigworker: &quot;indeed I usually take the presence of any proofs in my code as the cue to question my definitions&quot;."}, {"owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1488960615, "post_id": 42662960, "comment_id": 72457204, "body": "@user3237465 you can write code that is not used by the program but rather invokes the compiler to check some properties for you. If that is the kind of use you are warning against then I agree; I do not want asides. Well-structuredness is a better descriptor. My main point is that the potential uses are everywhere but overlooked."}], "tags": [], "owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "is_accepted": true, "score": 3, "last_activity_date": 1488946771, "creation_date": 1488946771, "answer_id": 42662960, "question_id": 40812689, "link": "https://stackoverflow.com/questions/40812689/what-are-good-examples-of-programs-that-are-simple-to-specify-as-dependent-types/42662960#42662960", "title": "What are good examples of programs that are simple to specify as dependent types, but complex to implement?", "body": "<p>This is odd to me because my problem is that dependent types are needed everywhere. If you do not see that then look at programs this way.</p>\n\n<p>Say we have <code>f :: Ord a =&gt; [a] -&gt; [a]</code> (I will use the Haskell notations). What do we know about this function <code>f</code>? In other words, what can you predict about applications such as <code>f []</code>, <code>f [5,8,7]</code>, <code>f [1,1,2,2]</code>? Say you know <code>f x = [4,6,8]</code> then what can you say about <code>x</code>? As you can observe, we know little.</p>\n\n<p>Then suppose I told you the real name of <code>f</code> is <code>sort</code>. What can you tell me then about those same examples? What can you tell me about <code>ys</code> in relation to <code>xs</code> in <code>f xs = ys</code>? Now you know a lot, but where did this information come from? All I did was change the name of the function; this has no significance in the formal meaning of the program.</p>\n\n<p>All this new information came from what you know about sorting. You know two defining characteristics:</p>\n\n<ol>\n<li><code>sort xs</code> is a permutation of <code>xs</code>.</li>\n<li><code>sort xs</code> is monotonically increasing.</li>\n</ol>\n\n<p>We can use dependent typing to prove both of these properties for <code>sort</code>. Then, it isn't just a matter of our extrinsic understanding of sorting; the meaning of sorting becomes an intrinsic part of the program.</p>\n\n<p>Catching bugs is a side effect. The real objective is to specify and formalise what we have to know in our heads anyways as part of the program.</p>\n\n<p>Carefully reconsider the programs you have already written. What are the facts that make your program work that are only known in your head? These are all candidate examples.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 2, "accepted_answer_id": 42662960, "answer_count": 2, "score": 6, "last_activity_date": 1488946771, "creation_date": 1480111044, "last_edit_date": 1495540825, "question_id": 40812689, "link": "https://stackoverflow.com/questions/40812689/what-are-good-examples-of-programs-that-are-simple-to-specify-as-dependent-types", "title": "What are good examples of programs that are simple to specify as dependent types, but complex to implement?", "body": "<p>Last year I asked \"<a href=\"https://stackoverflow.com/questions/33065965/dependent-types-can-prove-your-code-is-correct-up-to-a-specification-but-how-do\">Dependent types can prove your code is correct up to a specification. But how do you prove the specification is correct?</a>\". The most voted answer presents the following reasoning:</p>\n\n<blockquote>\n  <p>The hope is that your specification is simple and small enough to judge by examination, while your implementation of that might be far larger.</p>\n</blockquote>\n\n<p>That line of reasoning makes sense to me. Idris is the most accessible language to test those concepts; yet, since it can be used pretty much as Haskell, often it leaves the programmer wandering through old concepts, without knowing where to apply dependent types. Some real world examples could help on that, so, <strong>what are good, concrete examples of programs that happen in practice, are simple to express as types, but complex to implement?</strong></p>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 2, "last_activity_date": 1480106767, "creation_date": 1480106767, "answer_id": 40812086, "question_id": 40811973, "link": "https://stackoverflow.com/questions/40811973/how-to-use-these-functions-for-a-list-type/40812086#40812086", "title": "How to use these functions for a &#39;List&#39; type", "body": "<p>You are supposed to build your custom <code>List</code>s using the <code>Cons</code> and <code>Nil</code> <em>data constructors</em> that are defined by:</p>\n\n<pre><code>data List a = Nil\n            | Cons a (List a)\n</code></pre>\n\n<p>The first error, <code>Not in scope: data constructor `List'</code>, happened because you can't use <code>List</code> to build values (<code>List</code> is a type constructor, and <code>List a</code> is a type). What you actually want is:</p>\n\n<pre><code>listHead (Cons 1 (Cons 2 Nil)))\n</code></pre>\n\n<p>The second error, <code>Couldn't match expected type `List a0' with actual type `[Char]'</code>, happened because you are trying to use the regular list constructors, <code>(:)</code> and <code>[]</code>, to build <code>List Char</code> values. You should use <code>Cons</code> instead of <code>(:)</code> and <code>Nil</code> instead of <code>[]</code>.  </p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1480107929, "creation_date": 1480107929, "answer_id": 40812269, "question_id": 40811973, "link": "https://stackoverflow.com/questions/40811973/how-to-use-these-functions-for-a-list-type/40812269#40812269", "title": "How to use these functions for a &#39;List&#39; type", "body": "<p>The <code>:</code> operator and the <code>[]</code> construct are specific to Haskell's built-in list type, i.e. you can only use them to construct values of some type <code>[a]</code>. But the functions you have here don't deal with this standard list type, but with the locally defined <code>List</code> container. To construct such lists, you need to replace each <code>:</code> with <code>Cons</code> and each <code>[]</code> with <code>Nil</code>. It's complicated a bit by the fact that <code>Cons</code> is not an infix operator, so you first need to rewrite <code>a:b</code> as <code>(:) a b</code>. For example, the <code>[Int]</code> list <code>1:2:[]</code> becomes <code>(:) 1 ((:) 2 [])</code>, and that is equivalent to <code>Cons 1 (Cons 2 Nil)</code>.</p>\n\n<p>Those custom-lists can then be fed to any of those functions.</p>\n\n<pre><code>*List&gt; listHead $ Cons 1 (Cons 2 Nil)\n1\n</code></pre>\n\n<p>Of course this is ugly, but that <code>List</code> type is only introduced for educational purposes. In practice, you would use the standard <code>[]</code> type, or use nicer constructors. For instance, you can define infix constructors like <code>:</code> yourself:</p>\n\n<pre><code>infixr 6 :&amp;\ndata List' a = N | a :&amp; List' a\n</code></pre>\n\n<p>With that you could just do</p>\n\n<pre><code>*List&gt; list'Head $ 1 :&amp; 2 :&amp; N\n</code></pre>\n\n<p>Alternatively, you could make GHC accept the <code>[]</code> syntax for your custom list type:</p>\n\n<pre><code>{-# LANGUAGE OverloadedLists, TypeFamilies #-}\n\nimport GHC.Exts (IsList(..))\n\ninstance  IsList (List l) where\n  type Item (List l) = l\n  fromList [] = Nil\n  fromList (a:l) = Cons a $ fromList l\n</code></pre>\n\n<p>And then</p>\n\n<pre><code>*List&gt; listHead [1,2]\n1\n</code></pre>\n"}], "owner": {"reputation": 762, "user_id": 2155026, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/74f90f8ee0116e12bc6f44d9371ed09b?s=128&d=identicon&r=PG", "display_name": "Omar Shehab", "link": "https://stackoverflow.com/users/2155026/omar-shehab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 40812086, "answer_count": 2, "score": 0, "last_activity_date": 1480107929, "creation_date": 1480106122, "last_edit_date": 1480106828, "question_id": 40811973, "link": "https://stackoverflow.com/questions/40811973/how-to-use-these-functions-for-a-list-type", "title": "How to use these functions for a &#39;List&#39; type", "body": "<p>I am trying to understand how to use the functions defined in the following Haskell code (available <a href=\"http://d.hatena.ne.jp/Horiuchi_H/touch/searchdiary?word=*%5BHaskell%5D&amp;of=5\" rel=\"nofollow noreferrer\">here</a>) in Prelude.</p>\n\n<pre><code>module List\n    where\n\ndata List a = Nil\n            | Cons a (List a)\n\nlistLength :: List a -&gt; Int\nlistLength Nil = 0\nlistLength (Cons x xs) = 1 + listLength xs\n\n{-\nlistHead :: List a -&gt; Maybe a\nlistHead Nil = Nothing\nlistHead (Cons x xs) = Just x\n\nlistTail :: List a -&gt; Maybe (List a)\nlistTail Nil = Nothing\nlistTail (Cons x xs) = Just xs\n-}\nlistHead :: List a -&gt; a\nlistHead (Cons x xs) = x\n\nlistTail :: List a -&gt; List a\nlistTail (Cons x xs) = xs\n\nlistFoldl :: (a -&gt; b -&gt; a) -&gt; a -&gt; List b -&gt; a\nlistFoldl f c Nil = c\nlistFoldl f c (Cons x xs) = listFoldl f (f c x) xs\n\nlistFoldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; List a -&gt; b\nlistFoldr f c Nil = c\nlistFoldr f c (Cons x xs) = f x (listFoldr f c xs)\n</code></pre>\n\n<p>I have loaded it using <code>ghci List.hs</code> command.</p>\n\n<p>Then following is the way I am trying to use <code>listHead</code>.</p>\n\n<pre><code>*List&gt; listHead (List 1:2:[])\n\n&lt;interactive&gt;:7:11: Not in scope: data constructor `List'\n</code></pre>\n\n<p>Or like the following:</p>\n\n<pre><code>*List&gt; listHead ('a':'b':[])\n\n&lt;interactive&gt;:11:11:\n    Couldn't match expected type `List a0' with actual type `[Char]'\n    In the first argument of `listHead', namely `('a' : 'b' : [])'\n    In the expression: listHead ('a' : 'b' : [])\n    In an equation for `it': it = listHead ('a' : 'b' : [])\n</code></pre>\n\n<p>Could anyone please explain how to use this code in ghci? Thanks!</p>\n"}, {"tags": ["haskell", "dependent-type", "free-monad"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 4178284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/526a1f5d689479a6fd867fbbf6e2e2c9?s=128&d=identicon&r=PG&f=1", "display_name": "JesseC", "link": "https://stackoverflow.com/users/4178284/jessec"}, "edited": false, "score": 1, "creation_date": 1480118342, "post_id": 40813065, "comment_id": 68847417, "body": "Thanks! I am familiar with your <code>NS</code>. The trouble is that extending it to work with indexed functors is not obvious to me.  <code>data NS (fs :: [* -&gt; *]) is os (a :: *)</code>  What should the kinds of <code>is</code> and <code>os</code> be (if we want to support indexed functors where each functor can be indexed by types of a different kind)? A type-level hlist? A list of open unions?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1480123572, "post_id": 40813065, "comment_id": 68848351, "body": "By the way, it&#39;s possible to give the <code>Functor (NS fs)</code> instance directly in terms of a claim that all the <code>fs</code> are functors: <a href=\"http://lpaste.net/5782847892658061312\" rel=\"nofollow noreferrer\">lpaste.net/5782847892658061312</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1480124051, "post_id": 40813065, "comment_id": 68848431, "body": "Could you possibly explain how it helps to give a <i>traversal</i> of the type, rather than just a tree representing it or the type itself?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 123, "user_id": 4178284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/526a1f5d689479a6fd867fbbf6e2e2c9?s=128&d=identicon&r=PG&f=1", "display_name": "JesseC", "link": "https://stackoverflow.com/users/4178284/jessec"}, "edited": false, "score": 0, "creation_date": 1480151554, "post_id": 40813065, "comment_id": 68853198, "body": "@JesseC OK, I understand now that you&#39;d like to get coproducts of indexed functors that are indexed by the product of indices. That takes some extra work indeed. I&#39;ll edit the answer."}, {"owner": {"reputation": 3603, "user_id": 165806, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c889e0a95a3bb07f90ab28ad442f1127?s=128&d=identicon&r=PG", "display_name": "Iceland_jack", "link": "https://stackoverflow.com/users/165806/iceland-jack"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1480158873, "post_id": 40813065, "comment_id": 68854935, "body": "@dfeuer Going further we can use <code>StandaloneDeriving</code> to avoid writing the instance \u2014 <code>deriving instance All Functor fs =&gt; Functor (NS fs)</code>"}, {"owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "edited": false, "score": 0, "creation_date": 1480161505, "post_id": 40813065, "comment_id": 68855591, "body": "@Andr&#225;sKov&#225;cs Sorry for the slightly OT question but I&#39;m wondering about the usefulness of this when used for extensible effects. Wouldn&#39;t most functions have a type with a polymorphic effect list so that they can be combined? Does this trick help with inference when your type is something like <code>Elem (State s) effs =&gt; Eff effs ()</code> instead of <code>Eff [State s] ()</code>?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "edited": false, "score": 1, "creation_date": 1480166375, "post_id": 40813065, "comment_id": 68856782, "body": "@LukaHorvat it solves all the type inference problems with extensible effects, in comparison to <code>mtl</code> (and also supports multiple effects of the same type and labelled effects). See <a href=\"https://github.com/AndrasKovacs/misc-stuff/blob/master/haskell/Eff/EffInference.hs\" rel=\"nofollow noreferrer\">this</a> for example. It&#39;s probably worth a writeup or a pull request. I haven&#39;t yet gotten around to promote it in any way."}, {"owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "edited": false, "score": 0, "creation_date": 1480168845, "post_id": 40813065, "comment_id": 68857454, "body": "@Andr&#225;sKov&#225;cs I&#39;ve tried this <code>f :: (Num s, Elem (State s) effs) =&gt; Eff effs ()</code> <code>f = do { put 5; modify (+1) }</code> and it doesn&#39;t infer. Your examples work because the <code>run</code> function forces the effects into a concrete list. I was hoping that what you showed somehow magically helps in these cases as well."}, {"owner": {"reputation": 3603, "user_id": 165806, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c889e0a95a3bb07f90ab28ad442f1127?s=128&d=identicon&r=PG", "display_name": "Iceland_jack", "link": "https://stackoverflow.com/users/165806/iceland-jack"}, "edited": false, "score": 0, "creation_date": 1480169330, "post_id": 40813065, "comment_id": 68857610, "body": "Kinds can be polymorphic (<code>NS :: [\u0138 -&gt; Type] -&gt; (\u0138 -&gt; Type)</code> \u2014 and \u2014 <code>Elem&#39; :: Nat -&gt; (\u0138 -&gt; Type) -&gt; [\u0138 -&gt; Type] -&gt; Constraint</code>). <code>inj&#39;</code>, <code>prj&#39;</code> can be combined into a <code>Prism&#39; (NS fs x) (f x)</code> and the <code>==</code> type family is available from <code>Data.Type.Equality</code>."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "edited": false, "score": 0, "creation_date": 1480169495, "post_id": 40813065, "comment_id": 68857657, "body": "@LukaHorvat: delete the type annotation, then it works, with a more general type. A general GHC  bug/limitation prevents us from annotating that example correctly."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 3603, "user_id": 165806, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c889e0a95a3bb07f90ab28ad442f1127?s=128&d=identicon&r=PG", "display_name": "Iceland_jack", "link": "https://stackoverflow.com/users/165806/iceland-jack"}, "edited": false, "score": 0, "creation_date": 1480169534, "post_id": 40813065, "comment_id": 68857672, "body": "@Iceland_jack: <code>Data.Type.Equality</code> equality is kind homogeneous, so does not work in this case."}, {"owner": {"reputation": 3603, "user_id": 165806, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c889e0a95a3bb07f90ab28ad442f1127?s=128&d=identicon&r=PG", "display_name": "Iceland_jack", "link": "https://stackoverflow.com/users/165806/iceland-jack"}, "edited": false, "score": 0, "creation_date": 1480170085, "post_id": 40813065, "comment_id": 68857787, "body": "Yeah noticed that after I posted"}, {"owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "edited": false, "score": 0, "creation_date": 1480176438, "post_id": 40813065, "comment_id": 68859599, "body": "@Andr&#225;sKov&#225;cs Yeah, it does but only with AllowAmbiguousTypes enabled. Is this generally ok?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "edited": false, "score": 0, "creation_date": 1480177195, "post_id": 40813065, "comment_id": 68859799, "body": "@LukaHorvat <code>AllowAmbiguousTypes</code> is OK and essential with <code>TypeApplications</code>. However, to be clear, I think that GHC type checking performance and error messages aren&#39;t nearly good enough to make this thing practical. I don&#39;t think extensible effects are particularly good in practice either."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 123, "user_id": 4178284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/526a1f5d689479a6fd867fbbf6e2e2c9?s=128&d=identicon&r=PG&f=1", "display_name": "JesseC", "link": "https://stackoverflow.com/users/4178284/jessec"}, "edited": false, "score": 0, "creation_date": 1480179870, "post_id": 40813065, "comment_id": 68860653, "body": "@JesseC: <a href=\"http://lpaste.net/346426\" rel=\"nofollow noreferrer\">here&#39;s</a> some code with indexing in the way you&#39;d like to have. It does involve lifted heterogeneous lists. Unfortunately GHC bugs prevented me from writing interpreters for effects. This seems to be beyond the scope of things that can be written with GHC while preserving our sanity."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1480192335, "post_id": 40813065, "comment_id": 68864566, "body": "Oh, now I understand, I think. You want to match on the outermost part of the outermost part, etc., first, and only narrow till you get down to one. I guess that&#39;s the Right Thing for certain uses, though surely not all."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1480193164, "post_id": 40813065, "comment_id": 68864815, "body": "@dfeuer the question is which traversal to precommit to, given that encountering any type variable on the way makes us stuck. Generally, outer type constructors are less polymorhpic. Preorder bfs and dfs seem the best, with bfs being probably better, but the problem with bfs is that it always gets stuck if there&#39;s a variable at the head of an application spine. Hence I chose preorder dfs. For realistic (extensible-effects etc.) use cases, we rarely get to the point where dfs versus bfs makes a difference."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1480193319, "post_id": 40813065, "comment_id": 68864861, "body": "@dfeuer ofc, ideal would be full access to term structure including variables, similarly to reflection in Agda and Coq."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1480195344, "post_id": 40813065, "comment_id": 68865392, "body": "@Andr&#225;sKov&#225;cs, which tree are you talking about BFS in? The tree that strikes me as most natural is <code>data Ent where Ap :: a -&gt; [Ent] -&gt; Ent; Co :: a -&gt; Ent</code>, which represents <code>f a b</code> as <code>Ap f [Co a, Co b]</code>. Is that the one you&#39;re talking about?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1480196115, "post_id": 40813065, "comment_id": 68865580, "body": "@dfeuer yes, that&#39;s it."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 6, "last_activity_date": 1480144431, "last_edit_date": 1480144431, "creation_date": 1480113737, "answer_id": 40813065, "question_id": 40811452, "link": "https://stackoverflow.com/questions/40811452/injecting-indexed-functor-into-functor-coproduct/40813065#40813065", "title": "Injecting Indexed Functor into Functor Coproduct", "body": "<p>I shall present first the currently standard way of handling open sums. I do it for plain non-indexed functors for the sake of simplicity and because the construction is the same for indexed ones. Then I'll introduce some enhancements enabled by GHC 8.</p>\n\n<p>First, we define n-ary functor sums as a GADT indexed by a list of functors. This is more convenient and cleaner than using binary sums.</p>\n\n<pre><code>{-# language\n  RebindableSyntax, TypeInType, TypeApplications,\n  AllowAmbiguousTypes, GADTs, TypeFamilies, ScopedTypeVariables,\n  UndecidableInstances, LambdaCase, EmptyCase, TypeOperators, ConstraintKinds,\n  FlexibleContexts, MultiParamTypeClasses, FlexibleInstances #-}\n\nimport Data.Kind\n\ndata NS :: [* -&gt; *] -&gt; * -&gt; * where\n  Here  :: f x -&gt; NS (f ': fs) x\n  There :: NS fs x -&gt; NS (f ': fs) x\n\ninstance Functor (NS '[]) where\n  fmap _ = \\case {}\n\ninstance (Functor f, Functor (NS fs)) =&gt; Functor (NS (f ': fs)) where\n  fmap f (Here fx)  = Here  (fmap f fx)\n  fmap f (There ns) = There (fmap f ns)\n</code></pre>\n\n<p>Projecting and injecting can be either done</p>\n\n<ul>\n<li>Directly with a class, but this needs overlapping or incoherent instances.</li>\n<li>Indirectly, first computing the index of the element where we'd like to inject, then using the (natural number) index to define class instances without overlapping. </li>\n</ul>\n\n<p>The latter solution is the preferable one, so let's see that:</p>\n\n<pre><code>data Nat = Z | S Nat\n\ntype family Find (x :: a) (xs :: [a]) :: Nat where\n  Find x (x ': xs) = Z\n  Find x (y ': xs) = S (Find x xs)\n\nclass Elem' (n :: Nat) (f :: * -&gt; *) (fs :: [* -&gt; *]) where\n  inj' :: forall x. f x -&gt; NS fs x\n  prj' :: forall x. NS fs x -&gt; Maybe (f x)\n\ninstance (gs ~ (f ': gs')) =&gt; Elem' Z f gs where\n  inj'           = Here\n  prj' (Here fx) = Just fx\n  prj' _         = Nothing\n\ninstance (Elem' n f gs', (gs ~ (g ': gs'))) =&gt; Elem' (S n) f gs where\n  inj'            = There . inj' @n\n  prj' (Here _)   = Nothing\n  prj' (There ns) = prj' @n ns\n\ntype Elem f fs = (Functor (NS fs), Elem' (Find f fs) f fs)  \n\ninj :: forall fs f x. Elem f fs =&gt; f x -&gt; NS fs x\ninj = inj' @(Find f fs)\n\nprj :: forall f x fs. Elem f fs =&gt; NS fs x -&gt; Maybe (f x)\nprj = prj' @(Find f fs)\n</code></pre>\n\n<p>Now in ghci:</p>\n\n<pre><code>&gt; :t inj @[Maybe, []] (Just True)\ninj @[Maybe, []] (Just True) :: NS '[Maybe, []] Bool\n</code></pre>\n\n<p>However, our <code>Find</code> type family is somewhat problematic because its reduction is often blocked by type variables. GHC disallows branching on inequality of type variables, because unification can possibly instantiate different variables to equal types later (and making premature decisions based on inequality can lead to loss of solutions). </p>\n\n<p>For example:</p>\n\n<pre><code>&gt; :kind! Find Maybe [Maybe, []]\nFind Maybe [Maybe, []] :: Nat\n= 'Z  -- this works\n&gt; :kind! forall (a :: *)(b :: *). Find (Either b) [Either a, Either b]\nforall (a :: *)(b :: *). Find (Either b) [Either a, Either b] :: Nat\n= Find (Either b) '[Either a, Either b] -- this doesn't\n</code></pre>\n\n<p>In the second example GHC doesn't commit to the inequality of <code>a</code> and <code>b</code> so it can't step over the first list element.</p>\n\n<p>This historically caused rather annoying type inference deficiencies in Data Types a la Carte and extensible effects libraries. For example, even if we have just a single <code>State s</code> effect in a functor sum, writing <code>(x :: n) &lt;- get</code> in a context where only <code>Num n</code> is known results in type inference failure, because GHC can't compute the index of the <code>State</code> effect when the state parameter is a type variable.</p>\n\n<p>However, with GHC 8 we can write a significantly more powerful <code>Find</code> type family, which looks into type expressions to see if there's a unique possible position index. For example, if we're trying to find a <code>State s</code> effect, if there's only a single <code>State</code> in the effect list, we can safely return its position without looking at the <code>s</code> parameter, and subsequently GHC will be able to unify <code>s</code> with the other state parameter contained in the list.</p>\n\n<p>First, we need a generic traversal of type expressions:</p>\n\n<pre><code>import Data.Type.Bool\n\ndata Entry = App | forall a. Con a\n\ntype family (xs :: [a]) ++ (ys :: [a]) :: [a] where\n  '[]       ++ ys = ys\n  (x ': xs) ++ ys = x ': (xs ++ ys)\n\ntype family Preord (x :: a) :: [Entry] where\n  Preord (f x) = App ': (Preord f ++ Preord x)\n  Preord x     = '[ Con x]\n</code></pre>\n\n<p><code>Preord</code> converts an arbitrary type into a list of its sub-expressions in preorder. <code>App</code> denotes the places where type constructor application occurs. For example:</p>\n\n<pre><code>&gt; :kind! Preord (Maybe Int)\nPreord (Maybe Int) :: [Entry]\n= '['App, 'Con Maybe, 'Con Int]\n&gt; :kind! Preord [Either String, Maybe]\nPreord [Either String, Maybe] :: [Entry]\n= '['App, 'App, 'Con (':), 'App, 'Con Either, 'App, 'Con [],\n   'Con Char, 'App, 'App, 'Con (':), 'Con Maybe, 'Con '[]]\n</code></pre>\n\n<p>After this, writing the new <code>Find</code> is just a matter of functional programming. My implementation below converts the list of types into a list of index-traversal pairs, and successively filters out entries from the list by comparing the traversals of the list elements and the to-be-found element. </p>\n\n<pre><code>type family (x :: a) == (y :: b) :: Bool where\n  x == x = True\n  _ == _ = False\n\ntype family PreordList (xs :: [a]) (i :: Nat) :: [(Nat, [Entry])] where\n  PreordList '[]       _ = '[]\n  PreordList (a ': as) i = '(i, Preord a) ': PreordList as (S i)\n\ntype family Narrow (e :: Entry) (xs :: [(Nat, [Entry])]) :: [(Nat, [Entry])] where\n  Narrow _ '[]                     = '[]\n  Narrow e ('(i, e' ': es) ': ess) = If (e == e') '[ '(i, es)] '[] ++ Narrow e ess\n\ntype family Find_ (es :: [Entry]) (ess :: [(Nat, [Entry])]) :: Nat where\n  Find_ _        '[ '(i, _)] = i\n  Find_ (e ': es) ess        = Find_ es (Narrow e ess)\n\ntype Find x ys = Find_ (Preord x) (PreordList ys Z)\n</code></pre>\n\n<p>Now we have:</p>\n\n<pre><code>&gt; :kind! forall (a :: *)(b :: *). Find (Either a) [Maybe, [], Either b]\nforall (a :: *)(b :: *). Find (Either a) [Maybe, [], Either b] :: Nat\n= 'S ('S 'Z)\n</code></pre>\n\n<p>This <code>Find</code> can be used in any code involving open sums, and it works for indexed and non-indexed types all the same. </p>\n\n<p><a href=\"https://github.com/AndrasKovacs/misc-stuff/blob/master/haskell/Eff/EffInference.hs\" rel=\"nofollow noreferrer\">Here's</a> some example code with the kind of injection/projection presented above, for non-indexed extensible effects. </p>\n"}, {"comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1480279304, "post_id": 40826277, "comment_id": 68884921, "body": "In the meantime I&#39;ve found the issue with my code which was my fault rather than GHC&#39;s (just mixing up indices in constraints). Now everything works fine, <a href=\"http://lpaste.net/347242\" rel=\"nofollow noreferrer\">here&#39;s the code</a>."}, {"owner": {"reputation": 123, "user_id": 4178284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/526a1f5d689479a6fd867fbbf6e2e2c9?s=128&d=identicon&r=PG&f=1", "display_name": "JesseC", "link": "https://stackoverflow.com/users/4178284/jessec"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1500753896, "post_id": 40826277, "comment_id": 77480886, "body": "@Andr&#225;sKov&#225;cs Ooh, interesting. I finally got around to looking at this again and I&#39;m running into an inconvenience. If you don&#39;t want the union to be &quot;concrete&quot;, which is important for compositionality, you end up having to do the first approach here: <a href=\"http://lpaste.net/357141\" rel=\"nofollow noreferrer\">lpaste.net/357141</a> It seems like you ought to be able to do just the second. Can you think of a way of encoding it so that the second is possible?"}, {"owner": {"reputation": 123, "user_id": 4178284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/526a1f5d689479a6fd867fbbf6e2e2c9?s=128&d=identicon&r=PG&f=1", "display_name": "JesseC", "link": "https://stackoverflow.com/users/4178284/jessec"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1500755841, "post_id": 40826277, "comment_id": 77481391, "body": "@Andr&#225;sKov&#225;cs The other problem I encounter when trying to write <code>runFile</code>. I can get it to work, but only with the help of <code>unsafeCoerce</code>. Is there some way to avoid it? <a href=\"http://lpaste.net/357146\" rel=\"nofollow noreferrer\">lpaste.net/357146</a>"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1500766104, "post_id": 40826277, "comment_id": 77483764, "body": "I&#39;ll look at it. You can read <a href=\"http://docs.idris-lang.org/en/latest/st/index.html\" rel=\"nofollow noreferrer\">this</a> if you haven&#39;t already, for hints; it&#39;s a library in Idris with a superset of our features (much more powerful, in fact)."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1500810928, "post_id": 40826277, "comment_id": 77492437, "body": "I&#39;m not very motivated though. We need proper proofs and/or reflection and proof search, which is absent or crap in Haskell. E. g. we need that <code>(Elem x (y : ys) \u2227 (x &#47;= y) =&gt; Elem x ys)</code>, or that <code>(forall ys. Elem x xs =&gt; Elem x (xs ++ ys))</code> and so on."}, {"owner": {"reputation": 123, "user_id": 4178284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/526a1f5d689479a6fd867fbbf6e2e2c9?s=128&d=identicon&r=PG&f=1", "display_name": "JesseC", "link": "https://stackoverflow.com/users/4178284/jessec"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1500828185, "post_id": 40826277, "comment_id": 77497742, "body": "Yeah. I also came across <a href=\"http://okmij.org/ftp/Haskell/extensible/ParamEff1.hs\" rel=\"nofollow noreferrer\">okmij.org/ftp/Haskell/extensible/ParamEff1.hs</a> which is relevant but doesn&#39;t happen to confront either of the two present issues."}], "tags": [], "owner": {"reputation": 123, "user_id": 4178284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/526a1f5d689479a6fd867fbbf6e2e2c9?s=128&d=identicon&r=PG&f=1", "display_name": "JesseC", "link": "https://stackoverflow.com/users/4178284/jessec"}, "is_accepted": false, "score": 1, "last_activity_date": 1480227184, "creation_date": 1480227184, "answer_id": 40826277, "question_id": 40811452, "link": "https://stackoverflow.com/questions/40811452/injecting-indexed-functor-into-functor-coproduct/40826277#40826277", "title": "Injecting Indexed Functor into Functor Coproduct", "body": "<p>Aha, I got it to work! The key thing I took from Andr\u00e1s Kov\u00e1cs second attempt (linked in a comment) is the trick with leaving the instance head general and then refining with an equality constraint.</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances, GADTs, MultiParamTypeClasses,\n  RankNTypes, RebindableSyntax, TypeFamilies, TypeInType,\n  TypeOperators, UndecidableInstances #-}\n\nmodule Example2 (res, prog') where\n\nimport Control.Monad.Indexed\nimport Data.TASequence.FastCatQueue\nimport Prelude hiding ((&gt;&gt;), (&gt;&gt;=))\n\n-- * Indexed free machinery\n\n(&gt;&gt;=)\n  :: (IxMonad m)\n  =&gt; m s1 s2 a -&gt; (a -&gt; m s2 s3 b) -&gt; m s1 s3 b\n(&gt;&gt;=) = (&gt;&gt;&gt;=)\n(&gt;&gt;)\n  :: (IxApplicative m)\n  =&gt; m s1 s2 a -&gt; m s2 s3 b -&gt; m s1 s3 b\nf &gt;&gt; g = imap (const id) f `iap` g\n\ntype family Fst x where\n  Fst '(a, b) = a\ntype family Snd x where\n  Snd '(a, b) = b\n\nnewtype IKleisliTupled m ia ob = IKleisliTupled\n  { runIKleisliTupled :: Snd ia -&gt; m (Fst ia) (Fst ob) (Snd ob)\n  }\n\ntApp :: (TASequence s, IxMonad m) =&gt; s (IKleisliTupled m) x y -&gt; (IKleisliTupled m) x y\ntApp fs =\n  case tviewl fs of\n    TAEmptyL -&gt; IKleisliTupled ireturn\n    f :&lt; fs' -&gt;\n      IKleisliTupled\n        (\\a -&gt; runIKleisliTupled f a &gt;&gt;= runIKleisliTupled (tApp fs'))\n\ndata Free f s1 s2 a where\n  Pure :: a -&gt; Free f s s a\n  Impure ::\n    f s1 s2 a -&gt;\n      FastTCQueue (IKleisliTupled (Free f)) '(s2, a) '(s3, b) -&gt;\n        Free f s1 s3 b\n\ninstance IxFunctor (Free f) where\n  imap f (Pure a) = Pure $ f a\n  imap f (Impure a g) = Impure a (g |&gt; IKleisliTupled (Pure . f))\ninstance IxPointed (Free f) where\n  ireturn = Pure\ninstance IxApplicative (Free f) where\n  iap (Pure f) (Pure a) = ireturn $ f a\n  iap (Pure f) (Impure a g) = Impure a (g |&gt; IKleisliTupled (Pure . f))\n  iap (Impure a f) m = Impure a (f |&gt; IKleisliTupled (`imap` m))\ninstance IxMonad (Free f) where\n  ibind f (Pure a) = f a\n  ibind f (Impure a g) = Impure a (g |&gt; IKleisliTupled f)\n\n-- * Example application\n\ndata FileStatus\n  = FileOpen\n  | FileClosed\ndata File i o a where\n  Open :: FilePath -&gt; File 'FileClosed 'FileOpen ()\n  Close :: File 'FileOpen 'FileClosed ()\n  Read :: File 'FileOpen 'FileOpen String\n  Write :: String -&gt; File 'FileOpen 'FileOpen ()\n\nfoldFile :: File i o a -&gt; a\nfoldFile (Open _) = ()\nfoldFile Close = ()\nfoldFile Read = \"demo\"\nfoldFile (Write _) = ()\n\ndata MayFoo\n  = YesFoo\n  | NoFoo\ndata Foo i o a where\n  Foo :: Foo 'NoFoo 'YesFoo ()\n\ndata MayBar\n  = YesBar\n  | NoBar\ndata Bar i o a where\n  Bar :: Bar 'YesBar 'NoBar ()\n\n-- * Coproduct of indexed functors\n\ninfixr 5 `SumP`\ndata SumP f1 f2 t1 t2 x where\n  LP :: f1 sl1 sl2 x -&gt; SumP f1 f2 '(sl1, sr) '(sl2, sr) x\n  RP :: f2 sr1 sr2 x -&gt; SumP f1 f2 '(sl, sr1) '(sl, sr2) x\n\nnewtype VoidFunctor is os a = VoidFunctor (VoidFunctor is os a)\nabsurd :: VoidFunctor is os a -&gt; b\nabsurd a = a `seq` spin a where\n   spin (VoidFunctor b) = spin b\n\nextract :: Free VoidFunctor '() '() a -&gt; a\nextract (Pure a) = a\nextract (Impure f _) = absurd f\n\nrunPure\n  :: (forall j p b. f j p b -&gt; b)\n  -&gt; Free (f `SumP` fs) '(i, is) '(o, os) a\n  -&gt; Free fs is os a\nrunPure _ (Pure a) = Pure a\nrunPure f (Impure (RP cmd) q) = Impure cmd (tsingleton k)\n  where k = IKleisliTupled $ \\a -&gt; runPure f $ runIKleisliTupled (tApp q) a\nrunPure f (Impure (LP cmd) q) = runPure f $ runIKleisliTupled (tApp q) (f cmd)\n\n-- * Injection\n\nclass Inject l b where\n  inj :: forall a. l a -&gt; b a\n\ninstance Inject (f i o) (f i o) where\n  inj = id\n\ninstance {-# OVERLAPPING #-}\n  (is ~ '(il, s), os ~ '(ol, s)) =&gt;\n  Inject (fl il ol) (SumP fl fr is os) where\n  inj = LP\n\ninstance (Inject (f i' o') (fr is' os'), is ~ '(s, is'), os ~ '(s, os')) =&gt;\n         Inject (f i' o') (SumP fl fr is os) where\n  inj = RP . inj\n\nsend\n  :: Inject (t i o) (f is os)\n  =&gt; t i o b -&gt; Free f is os b\nsend t = Impure (inj t) (tsingleton (IKleisliTupled Pure))\n\n-- * In use\n\nprog = do\n  send (Open \"/tmp/foo.txt\")\n  x &lt;- send Read\n  send Foo\n  send (Write x)\n  send Bar\n  send Close\n  ireturn x\n\nprog' ::\n  Free\n    (File `SumP` Foo `SumP` Bar `SumP` VoidFunctor)\n    '( 'FileClosed, '( 'NoFoo, '( 'YesBar, '())))\n    '( 'FileClosed, '( 'YesFoo, '( 'NoBar, '())))\n    String\nprog' = prog\n\nres :: String\nres = extract . runPure (\\Bar -&gt; ()) . runPure (\\Foo -&gt; ()) . runPure foldFile $ prog\n</code></pre>\n\n<p>P.S. I'll see if I can move toward the nicer open union encoding or if I too will run into inscrutable GHC problems.</p>\n"}], "owner": {"reputation": 123, "user_id": 4178284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/526a1f5d689479a6fd867fbbf6e2e2c9?s=128&d=identicon&r=PG&f=1", "display_name": "JesseC", "link": "https://stackoverflow.com/users/4178284/jessec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 978, "favorite_count": 4, "answer_count": 2, "score": 9, "last_activity_date": 1480227184, "creation_date": 1480102956, "last_edit_date": 1480103941, "question_id": 40811452, "link": "https://stackoverflow.com/questions/40811452/injecting-indexed-functor-into-functor-coproduct", "title": "Injecting Indexed Functor into Functor Coproduct", "body": "<p>I'm trying to work with an indexed free monad (Oleg Kiselyov has <a href=\"http://okmij.org/ftp/Haskell/extensible/ParamEff1.hs\" rel=\"nofollow noreferrer\">an intro</a>). I also want that free monad to be built from a from a coproduct of functors a la <a href=\"http://www.cs.ru.nl/~W.Swierstra/Publications/DataTypesALaCarte.pdf\" rel=\"nofollow noreferrer\">Data Types a la carte</a>. However, I'm having trouble getting the coproduct injection type class to work out. Here's what I have so far:</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE GADTs #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE PolyKinds #-}\n{-# LANGUAGE RankNTypes #-}\n{-# LANGUAGE RebindableSyntax #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE UndecidableInstances #-}\n\nmodule Example where\n\nimport Control.Monad.Indexed\nimport Data.Kind\nimport Data.TASequence.FastCatQueue\nimport Prelude hiding ((&gt;&gt;), (&gt;&gt;=))\n\n-- * Indexed free machinery\n\n-- For use with `RebindableSyntax`\n(&gt;&gt;=)\n  :: (IxMonad m)\n  =&gt; m s1 s2 a -&gt; (a -&gt; m s2 s3 b) -&gt; m s1 s3 b\n(&gt;&gt;=) = (&gt;&gt;&gt;=)\n(&gt;&gt;)\n  :: (IxApplicative m)\n  =&gt; m s1 s2 a -&gt; m s2 s3 b -&gt; m s1 s3 b\nf &gt;&gt; g = imap (const id) f `iap` g\n\ntype family Fst x where\n  Fst '(a, b) = a\ntype family Snd x where\n  Snd '(a, b) = b\n\nnewtype IKleisliTupled m ia ob = IKleisliTupled\n  { runIKleisliTupled :: Snd ia -&gt; m (Fst ia) (Fst ob) (Snd ob)\n  }\n\ndata Free f s1 s2 a where\n  Pure :: a -&gt; Free f s s a\n  Impure ::\n    f s1 s2 a -&gt;\n      FastTCQueue (IKleisliTupled (Free f)) '(s2, a) '(s3, b) -&gt;\n        Free f s1 s3 b\n\ninstance IxFunctor (Free f) where\n  imap f (Pure a) = Pure $ f a\n  imap f (Impure a g) = Impure a (g |&gt; IKleisliTupled (Pure . f))\ninstance IxPointed (Free f) where\n  ireturn = Pure\ninstance IxApplicative (Free f) where\n  iap (Pure f) (Pure a) = ireturn $ f a\n  iap (Pure f) (Impure a g) = Impure a (g |&gt; IKleisliTupled (Pure . f))\n  iap (Impure a f) m = Impure a (f |&gt; IKleisliTupled (`imap` m))\ninstance IxMonad (Free f) where\n  ibind f (Pure a) = f a\n  ibind f (Impure a g) = Impure a (g |&gt; IKleisliTupled f)\n\n-- * Example application\n\ndata FileStatus\n  = FileOpen\n  | FileClosed\ndata File i o a where\n  Open :: FilePath -&gt; File 'FileClosed 'FileOpen ()\n  Close :: File 'FileOpen 'FileClosed ()\n  Read :: File 'FileOpen 'FileOpen String\n  Write :: String -&gt; File 'FileOpen 'FileOpen ()\n\ndata MayFoo\n  = YesFoo\n  | NoFoo\ndata Foo i o a where\n  Foo :: Foo 'NoFoo 'YesFoo ()\n\ndata MayBar\n  = YesBar\n  | NoBar\ndata Bar i o a where\n  Bar :: Bar 'YesBar 'NoBar ()\n\n-- * Coproduct of indexed functors\n\ninfixr 5 `SumP`\ndata SumP f1 f2 t1 t2 x where\n  LP :: f1 sl1 sl2 x -&gt; SumP f1 f2 '(sl1, sr) '(sl2, sr) x\n  RP :: f2 sr1 sr2 x -&gt; SumP f1 f2 '(sl, sr1) '(sl, sr2) x\n\n-- * Attempt 1\n\nclass Inject l b where\n  inj :: forall a. l a -&gt; b a\n\ninstance Inject (f i o) (f i o) where\n  inj = id\n\ninstance Inject (fl il ol) (SumP fl fr '(il, s) '(ol, s)) where\n  inj = LP\n\ninstance (Inject (f i' o') (fr is os)) =&gt;\n         Inject (f i' o') (SumP fl fr '(s, is) '(s, os)) where\n  inj = RP . inj\n\nsend\n  :: Inject (t i o) (f is os)\n  =&gt; t i o b -&gt; Free f is os b\nsend t = Impure (inj t) (tsingleton (IKleisliTupled Pure))\n\n-- Could not deduce `(Inject (Bar 'YesBar 'NoBar) f s30 s40)`\nprog\n  :: (Inject (File 'FileClosed 'FileOpen) (f s1 s2)\n     ,Inject (Foo 'NoFoo 'YesFoo) (f s2 s3)\n     ,Inject (Bar 'YesBar 'NoBar) (f s3 s4)\n     ,Inject (File 'FileOpen 'FileClosed) (f s4 s5))\n  =&gt; Free f s1 s5 ()\nprog = do\n  send (Open \"/tmp/foo.txt\")\n  x &lt;- send Read\n  send Foo\n  send (Write x)\n  send Bar\n  send Close\n\n-- * Attempt 2\n\nbsend :: (t i o b -&gt; g is os b) -&gt; t i o b -&gt; Free g is os b\nbsend f t = Impure (f t) (tsingleton (IKleisliTupled Pure))\n\n-- Straightforward but not very usable\n\nbprog\n  ::\n    Free\n      (File `SumP` Bar `SumP` Foo)\n      '( 'FileClosed, '( 'YesBar, 'NoFoo))\n      '( 'FileClosed, '( 'NoBar, 'YesFoo))\n      ()\nbprog = do\n  bsend LP (Open \"/tmp/foo.txt\")\n  x &lt;- bsend LP Read\n  bsend (RP . RP) Foo\n  bsend (RP . LP) Bar\n  bsend LP (Write x)\n  bsend LP Close\n\n-- * Attempt 3\n\nclass Inject' f i o (fs :: j -&gt; j -&gt; * -&gt; *) where\n  type I f i o fs :: j\n  type O f i o fs :: j\n  inj' :: forall x. f i o x -&gt; fs (I f i o fs) (O f i o fs) x\n\ninstance Inject' f i o f where\n  type I f i o f = i\n  type O f i o f = o\n  inj' = id\n\n-- Illegal polymorphic type: forall (s :: k1). '(il, s)\n\ninstance Inject' fl il ol (SumP fl fr) where\n  type I fl il ol (SumP fl fr) = forall s. '(il, s)\n  type O fl il ol (SumP fl fr) = forall s. '(ol, s)\n  inj' = LP\n\ninstance (Inject' f i' o' fr) =&gt;\n         Inject' f i' o' (SumP fl fr) where\n  type I f i' o' (SumP fl fr) = forall s. '(s, I f i' o' fr)\n  type O f i' o' (SumP fl fr) = forall s. '(s, O f i' o' fr)\n  inj' = RP . inj\n</code></pre>\n\n<p>So Attempt 1 destroys type inference. Attempt 2 has bad ergonomics for the user. Attempt 3 seems like the right approach, but I can't quite figure out how to make the associated type instances work out. What should this injection look like?</p>\n"}, {"tags": ["python", "haskell", "iterator", "lazy-sequences"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1480100671, "post_id": 40810875, "comment_id": 68842490, "body": "<a href=\"http://hackage.haskell.org/package/discrimination-0.2.1/docs/Data-Discrimination.html#v:groupWith\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/discrimination-0.2.1/docs/&hellip;</a>"}, {"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1480102183, "post_id": 40810875, "comment_id": 68843023, "body": "@leftaroundabout Yeah, that basically the same, but the type is <code>a-&gt;b-&gt;[[a]]</code>. How would I know which equivalence class is which? You see, I&#39;ve search on hoogle for type <code>a-&gt;b-&gt;[(b, [a])]</code>"}, {"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1480102877, "post_id": 40810875, "comment_id": 68843221, "body": "@leftaroundabout On the second hand I could probably try to read the sources and figure how to change it so that it would return names of equivalence classes. I&#39;ve skimmed through sources, judging by imports it uses mutable state, right? Do you think this is possible without mutable state?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1480105557, "post_id": 40810875, "comment_id": 68844083, "body": "Clearly the type <code>[(b, [a])]</code> is not the one you want - Haskell linked lists are not python dictionaries! You simply will not get the performance you seek, as you&#39;ve seen in the answer below. It does not matter that your python function consumes and yields a list - it uses mutability internally, and so will your Haskell function have to - you can still produce a pure value at the end if you work entirely in <code>ST</code>."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1480108155, "post_id": 40810875, "comment_id": 68844813, "body": "@user1685095 If you want type <code>[(b, [a])]</code> you can then just map over result list to convert <code>[a]</code> into <code>(b, [a])</code>. Just using <code>map (\\l -&gt; (key $ head l, l))</code>"}, {"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1480111822, "post_id": 40810875, "comment_id": 68845838, "body": "@Shersh Oh, that would work!"}, {"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1480112012, "post_id": 40810875, "comment_id": 68845903, "body": "@user2407038 Clearly the type <code>[(b, [a])]</code> is the type I want, because I&#39;ve said so. Of course linked list is not a dictionary haskell or not. It would be more usefull if you would show how the guys from discrimination package have done it at least conceptually."}, {"owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "edited": false, "score": 0, "creation_date": 1575458657, "post_id": 40810875, "comment_id": 104571460, "body": "You are comparing apples with oranges here. Your function implements something totally different than <code>itertools.groupby</code>. E.g. <code>[list(v) for k, v in itertools.groupby([1,2,1])]</code> gives <code>[[1],[2],[1]]</code> whereas your function gives <code>[[1,1],[2]]</code>."}, {"owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "edited": false, "score": 0, "creation_date": 1575459040, "post_id": 40810875, "comment_id": 104571654, "body": "I think a simpler definition of your <code>groupby</code> function would be: <code>result = defaultdict(list); for k, v in [key(v), v in sequence]: result[k].append(v); return result.items()</code>."}, {"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "reply_to_user": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "edited": false, "score": 0, "creation_date": 1575459062, "post_id": 40810875, "comment_id": 104571667, "body": "@FrerichRaabe I know. Sometimes what <code>itertools.groupby</code> does called <code>groupUntilChanged</code>. If you sorted the sequence before doing that then result would be the same as real <code>groupby</code> should produce (equivalence classes) of a set."}], "answers": [{"comments": [{"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1480103452, "post_id": 40811479, "comment_id": 68843386, "body": "Well, that&#39;s obvious solution, but it&#39;s running time is <code>O(n*log(n))</code>. Maybe that wasn&#39;t clear enough, but I want a solution that is lazy and have <code>O(n)</code> running time."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "reply_to_user": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 1, "creation_date": 1480103660, "post_id": 40811479, "comment_id": 68843444, "body": "I don&#39;t see how you can get that given the need to sort the elements into key order. Maybe I have misunderstood what you want. I can see how using a table of keys would give you O(n log k). Is that it?"}, {"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1480103762, "post_id": 40811479, "comment_id": 68843483, "body": "Well, you see how I&#39;ve already done that in python? My implementation doesn&#39;t specifies the key order that would be emited, but it could be modified to output pairs in certain order. The key is buffering of elements. Also there is useful link from @leftaroundabout. The guy who wrote discrimination package already basically done that, so It&#39;s possible in haskell also."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "reply_to_user": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1480103893, "post_id": 40811479, "comment_id": 68843531, "body": "Actually the sort function bundled with GHC uses run identification, so I&#39;m pretty certain my version is O(n log k) too."}, {"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1480103992, "post_id": 40811479, "comment_id": 68843574, "body": "And <code>k</code> is what exactly? And still <code>O(n*log k)</code> is not <code>O(n)</code>"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "reply_to_user": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1480104225, "post_id": 40811479, "comment_id": 68843652, "body": "Its the number of different key values. Inserting an element into a table of size n is O(log n). If I understand your Python correctly, it builds up a table of lists indexed by key. Given n items with k different keys, this is going to be O(n * log k)."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "reply_to_user": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1480105070, "post_id": 40811479, "comment_id": 68843926, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/129071/discussion-between-paul-johnson-and-user1685095\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 0, "last_activity_date": 1480103078, "creation_date": 1480103078, "answer_id": 40811479, "question_id": 40810875, "link": "https://stackoverflow.com/questions/40810875/analog-of-python-groupby-in-haskell/40811479#40811479", "title": "Analog of python groupby in haskell", "body": "<p>If I understand this correctly, the type you want is </p>\n\n<pre><code>(a -&gt; k) -&gt; [a] -&gt; [(k, [a])]\n</code></pre>\n\n<p>That is, given a key function and a list of items, group the items by the key.</p>\n\n<p>In Haskell there is a library function <code>groupBy</code> which does something similar. It assumes you have a sorted list, and it groups items that meet a Boolean condition into sublists. We can use it to do what you want:</p>\n\n<pre><code>import Data.List\nimport Data.Ord\n\ngroupByKey :: (a -&gt; k) -&gt; [a] -&gt; [(k, [a])]\ngroupByKey keyF xs = map getResult groups\n   where\n      keyPairs = map (\\v -&gt; (keyF v, v)) xs\n      groups = groupBy (\\v1 v2 -&gt; fst v1 == fst v2) \n                  $ sortBy (comparing fst) keyPairs\n      getResult xs = (fst $ head xs, map snd xs)\n</code></pre>\n\n<p><code>keyPairs</code> is the pair <code>(key, value)</code> for each element in the argument. <code>groups</code> first sorts this into key order using <code>sortBy</code> and then groups the results into sublists that share the same key. <code>getResult</code> converts a sublist into a pair containing the key (taken from the head element) and a list of the original values.\nWe are safe to use <code>head</code> because <code>groupBy</code> never gives an empty sublist.</p>\n"}], "owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1480103078, "creation_date": 1480099621, "question_id": 40810875, "link": "https://stackoverflow.com/questions/40810875/analog-of-python-groupby-in-haskell", "title": "Analog of python groupby in haskell", "body": "<p>In python there is <a href=\"https://docs.python.org/3/library/itertools.html#itertools.groupby\" rel=\"nofollow noreferrer\">groupby</a> function.</p>\n\n<p>It's type can be expressed in haskell like this <code>groupby :: a-&gt;b-&gt;[a]-&gt;[(b, [a])]</code>\nBecause it need data to be sorted we can think of it's running time as <code>O(n*log(n))</code>.</p>\n\n<p>I was probably not the only one dissatisfied with this, so I found this <a href=\"https://bitbucket.org/astanin/python-split\" rel=\"nofollow noreferrer\">library</a>\nThis implementation of groupby need two passes over the input sequence. So I think its running time is <code>O(n)</code>, but as it says in the docs it isn't really lazy, because if you don' pass keys to it it would need to make a pass over sequence to collect all unique keys from items.</p>\n\n<p>So I thought, citing Raymond Hetttinger</p>\n\n<blockquote>\n  <p>There must be a better way!</p>\n</blockquote>\n\n<p>So I wrote this</p>\n\n<pre><code>from collections import defaultdict, deque\n\n\ndef groupby(sequence, key=lambda x: x):\n    buffers = defaultdict(deque)\n    kvs = ((key(item), item) for item in sequence)\n    seen_keys = set()\n    def subseq(k):\n        while True:\n            buffered = buffers[k]\n            if buffered:\n                yield buffered.popleft()\n            else:\n                next_key, value = next(kvs)\n                buffers[next_key].append(value)\n    while True:\n        try:\n            k, value = next(kvs)\n        except StopIteration:\n            for bk, group in buffers.items():\n                if group and bk not in seen_keys:\n                    yield (bk, group)\n            raise StopIteration()\n        else:\n            buffers[k].append(value)\n        if k not in seen_keys:\n            seen_keys.add(k)\n            yield k, subseq(k)\n</code></pre>\n\n<p>In case you aren't familiar with python the idea is very simple.\nCreate a mutable dictionary of <code>key -&gt; queue of elements</code>\nTry take next element of sequence and its key value.\nIf sequence isn't empty add this value to the group queue according to its key. If we haven't seen this key yield a pair (key, iterable group ) latter one would take keys either from buffer or from sequence. If we already seen this this key do nothing more and loop.</p>\n\n<p>If sequence is ended it means all its element already either have put in buffers (and probably consumed). In case buffers aren't empty we iterate over them and yield renaming (key, iterable) pairs.</p>\n\n<p>I've already unit tested it and its works. And it's truly lazy (meaning it wouldn't take any value from sequence until consumer haven't asked for it) and it's running time should be <code>O(n)</code>.</p>\n\n<p>I've tried to haskell analog of this function and haven't found any.</p>\n\n<p>Is it possible to write such thing in haskell? If so, please show the solution, if not, then explain why.</p>\n"}, {"tags": ["http", "haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1480097962, "post_id": 40810422, "comment_id": 68841602, "body": "Hard to tell - maybe those messages are supposed to be hidden by Javascript one it is run? Try opening the same web page in a browser and inspect the source to see if it is different. The web server might also generate a different page for every user-agent (which is very very bad, if that&#39;s the case)."}, {"owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1480098149, "post_id": 40810422, "comment_id": 68841672, "body": "@chi I&#39;ve tested the site using &#39;request&#39; library in Node.js and it works fine. So I assume its to do with the http driver Network.HTTP is using. Perhaps I can try Network.Wreq, but the documentation is based on lens&#39; which i haven&#39;t covered yet!"}, {"owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1480111781, "post_id": 40810422, "comment_id": 68845826, "body": "@chi turns out only very very basic understanding of lens is required for Wreq, and I&#39;ve found my solution :)"}], "answers": [{"tags": [], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "is_accepted": true, "score": 2, "last_activity_date": 1480102235, "creation_date": 1480102235, "answer_id": 40811328, "question_id": 40810422, "link": "https://stackoverflow.com/questions/40810422/simplehttp-causing-unsupported-browser-response/40811328#40811328", "title": "simpleHttp causing &#39;unsupported browser response?&#39;", "body": "<p><a href=\"http://www.serpentine.com/wreq/tutorial.html\" rel=\"nofollow noreferrer\">Wreq</a> provides a very easy to follow tutorial on http/s requests using basic lens syntax. </p>\n\n<p>A https compatible request is as simple as:</p>\n\n<pre><code>main = do\n  r &lt;- get \"https://www.example.com\"\n</code></pre>\n\n<p>Response statuses and bodies can be accessed respectively:</p>\n\n<pre><code>  r ^. responseStatus . statusCode\n  r ^. responseBody\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": false, "score": 0, "last_activity_date": 1480235675, "creation_date": 1480235675, "answer_id": 40827115, "question_id": 40810422, "link": "https://stackoverflow.com/questions/40810422/simplehttp-causing-unsupported-browser-response/40827115#40827115", "title": "simpleHttp causing &#39;unsupported browser response?&#39;", "body": "<p>This code doesn't compile. Even adding in the <code>LAZ</code> import, the <code>Network.HTTP.Simple</code> module does not provide the <code>simpleHttp</code> function. You can do this with <code>httpLBS</code>:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport Network.HTTP.Simple\nimport qualified Data.ByteString.Lazy as LAZ\n\nmakeRequest :: IO LAZ.ByteString\nmakeRequest = do\nresponse &lt;- httpLBS \"https://www.example.com\"\nreturn (getResponseBody response)\n\nmain :: IO ()\nmain = makeRequest &gt;&gt;= LAZ.putStr\n</code></pre>\n\n<p>Or by using the <code>simpleHttp</code> function from <code>Network.HTTP.Conduit</code>:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport Network.HTTP.Conduit\nimport qualified Data.ByteString.Lazy as LAZ\n\nmakeRequest :: IO LAZ.ByteString\nmakeRequest = simpleHttp \"https://www.example.com\"\n\nmain :: IO ()\nmain = makeRequest &gt;&gt;= LAZ.putStr\n</code></pre>\n\n<p>Note that <code>wreq</code> uses the same HTTP engine under the surface as http-conduit (http-client). My guess is that you were originally trying to use one of the functions from http-client itself, but I'm not sure what that code would have looked like.</p>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 40811328, "answer_count": 2, "score": 1, "last_activity_date": 1480235675, "creation_date": 1480097076, "last_edit_date": 1480097765, "question_id": 40810422, "link": "https://stackoverflow.com/questions/40810422/simplehttp-causing-unsupported-browser-response", "title": "simpleHttp causing &#39;unsupported browser response?&#39;", "body": "<p>I'm executing a simpleHttp request to a https domain, yet the response html is showing 'unsupported browser' messages -- i believe this is because simpleHttp does not support HTTPS. </p>\n\n<p>My function:</p>\n\n<pre><code>import Network.HTTP.Simple\n\nmakeRequest :: IO LAZ.ByteString\nmakeRequest = do\n  response &lt;- simpleHttp \"https://www.example.com\"\n  return (response)\n</code></pre>\n\n<p>Which haskell libraries support https?</p>\n"}, {"tags": ["list", "function", "haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1480092446, "post_id": 40809435, "comment_id": 68839514, "body": "Also, stackoverflow told me to not post that comment and just downvote instead. Real nice, SO."}, {"owner": {"reputation": 11, "user_id": 7186293, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f3dacaf6a900c79f2fca64a88f6a5fa4?s=128&d=identicon&r=PG&f=1", "display_name": "SilverA", "link": "https://stackoverflow.com/users/7186293/silvera"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1480092755, "post_id": 40809435, "comment_id": 68839651, "body": "yeah thanks, downvoting is the solution... *****"}, {"owner": {"reputation": 11, "user_id": 7186293, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f3dacaf6a900c79f2fca64a88f6a5fa4?s=128&d=identicon&r=PG&f=1", "display_name": "SilverA", "link": "https://stackoverflow.com/users/7186293/silvera"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1480092819, "post_id": 40809435, "comment_id": 68839680, "body": "have tried [a] [a] -&gt; [a] and some other stuff that was impossible to"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1480092854, "post_id": 40809435, "comment_id": 68839696, "body": "It&#39;s <code>[a] -&gt; [a] -&gt; [a]</code>."}, {"owner": {"reputation": 11, "user_id": 7186293, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f3dacaf6a900c79f2fca64a88f6a5fa4?s=128&d=identicon&r=PG&f=1", "display_name": "SilverA", "link": "https://stackoverflow.com/users/7186293/silvera"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1480093044, "post_id": 40809435, "comment_id": 68839779, "body": "But why didn`t this work? (I tried this already...) When I continued with the code I wrote listreverse [] [] = [] and there was a type error... like expected type [[a]] but..."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1480093259, "post_id": 40809435, "comment_id": 68839863, "body": "&quot;There was a type error&quot; doesn&#39;t tell us much. Show your code and the exact error you get if you want help."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 4, "creation_date": 1480093391, "post_id": 40809435, "comment_id": 68839910, "body": "Well, sorry if it feels bad to get downvoted as a newbie, but the way you&#39;ve posted this question just isn&#39;t fine. StackOverflow expects some demonstrated effort at solving the problem yourself."}, {"owner": {"reputation": 11, "user_id": 7186293, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f3dacaf6a900c79f2fca64a88f6a5fa4?s=128&d=identicon&r=PG&f=1", "display_name": "SilverA", "link": "https://stackoverflow.com/users/7186293/silvera"}, "edited": false, "score": 0, "creation_date": 1480093599, "post_id": 40809435, "comment_id": 68839991, "body": "It does not &quot;feel bad&quot;. It just is not of any help. I ignore questions if I do not like them and dont downvote a new question, that has no answers yet..."}, {"owner": {"reputation": 11, "user_id": 7186293, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f3dacaf6a900c79f2fca64a88f6a5fa4?s=128&d=identicon&r=PG&f=1", "display_name": "SilverA", "link": "https://stackoverflow.com/users/7186293/silvera"}, "edited": false, "score": 0, "creation_date": 1480093644, "post_id": 40809435, "comment_id": 68840010, "body": "I have found another mistake. Program is running now with [a] -&gt; [a] -&gt; [a] so thanks!"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1480103983, "post_id": 40809435, "comment_id": 68843570, "body": "&quot;It just is not of any help&quot; -- The primary goal of downvoting is not to help the asker, but to improve the content of the site by encouraging people to ask better questions and making downvoted questions available for further moderation mechanisms. That said, you may well find the feedback useful for preparing your future questions."}], "answers": [{"tags": [], "owner": {"reputation": 1839, "user_id": 637596, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7315e751540cc141ff8c139e524e2e2f?s=128&d=identicon&r=PG", "display_name": "Daniel Wehner", "link": "https://stackoverflow.com/users/637596/daniel-wehner"}, "is_accepted": false, "score": 2, "last_activity_date": 1482148071, "creation_date": 1482148071, "answer_id": 41221915, "question_id": 40809435, "link": "https://stackoverflow.com/questions/40809435/can-anyone-tell-me-how-to-give-to-lists-as-arguments-to-a-function-in-haskell/41221915#41221915", "title": "Can anyone tell me how to give to lists as arguments to a function in Haskell? (type declaration)", "body": "<p>Let's show you how I think about haskell\nSo let's think about the types first. You have a 2 lists of something and return a list of these thing. In the language of types this is looking like this: <code>[a] -&gt; [a] -&gt; [a]</code>.</p>\n\n<p>Once you know the type you can ask hoogle: <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow noreferrer\">https://www.haskell.org/hoogle/</a> which should give you everything you need :)</p>\n"}, {"tags": [], "owner": {"reputation": 850, "user_id": 3560671, "user_type": "registered", "accept_rate": 97, "profile_image": "https://graph.facebook.com/1078263042/picture?type=large", "display_name": "Thomas Vanhelden", "link": "https://stackoverflow.com/users/3560671/thomas-vanhelden"}, "is_accepted": false, "score": 0, "last_activity_date": 1482169814, "creation_date": 1482169814, "answer_id": 41228281, "question_id": 40809435, "link": "https://stackoverflow.com/questions/40809435/can-anyone-tell-me-how-to-give-to-lists-as-arguments-to-a-function-in-haskell/41228281#41228281", "title": "Can anyone tell me how to give to lists as arguments to a function in Haskell? (type declaration)", "body": "<p>Let's see... </p>\n\n<p>Your function has two parameters: <code>list1</code> and <code>list2</code>.\nThe result of your function is a list of the same type. This means that your function is dealing with three lists. Two of which are parameters, the third one is the result. </p>\n\n<p>To keep it simple, let's say you're dealing with lists of <code>Integers</code>. The type declaration would look like this:</p>\n\n<pre><code>fuse :: [Int] -&gt; -- The first list\n        [Int] -&gt; -- The second list\n        [Int]    -- The result fusion\n</code></pre>\n\n<p>Where <code>[Int]</code> represents a list of <code>Integers</code>. Of course, the function doesn't have to be lists of <code>Integers</code>. It could be applied to lists that contain elements of any type:</p>\n\n<pre><code>fuse :: [a] -&gt; -- The first list\n        [a] -&gt; -- The second list\n        [a]    -- The result of the fusion\n</code></pre>\n\n<p>A quick search on <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow noreferrer\">Hoogle</a>  for <code>[a] -&gt; [a] -&gt; [a]</code> will give you the <code>(++)</code> function as the top result:</p>\n\n<pre><code>(++) :: [a] -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>This function appends two lists. In your case, you could use the function like this:</p>\n\n<pre><code>fuse :: [a] -&gt; -- The first list\n        [a] -&gt; -- The second list\n        [a]    -- The result\nfuse list1 list2 = list2 ++ list1\n</code></pre>\n\n<p>Or in point-free style:</p>\n\n<pre><code>fuse :: [Int] -&gt; -- The first list\n        [Int] -&gt; -- The second list\n        [Int]    -- The result\nfuse = flip (++)\n</code></pre>\n\n<p>The flip function reverses the arguments. </p>\n"}], "owner": {"reputation": 11, "user_id": 7186293, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f3dacaf6a900c79f2fca64a88f6a5fa4?s=128&d=identicon&r=PG&f=1", "display_name": "SilverA", "link": "https://stackoverflow.com/users/7186293/silvera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1482169814, "creation_date": 1480092294, "question_id": 40809435, "link": "https://stackoverflow.com/questions/40809435/can-anyone-tell-me-how-to-give-to-lists-as-arguments-to-a-function-in-haskell", "title": "Can anyone tell me how to give to lists as arguments to a function in Haskell? (type declaration)", "body": "<p>I want to write a function that gets two lists and fuses them to one list but in the reverse order so [1,2,3] and [4,5,6] become [4,5,6,1,2,3] and well I am kind of stuck at the type declaration ... </p>\n"}, {"tags": ["haskell", "ocaml", "ffi"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1480093525, "post_id": 40807783, "comment_id": 68839956, "body": "Probably one needs to use C as a lingua franca, and doing all the required marshalling Haskell&lt;-&gt;C&lt;-&gt;Ocaml. I don&#39;t think there&#39;s anything easier, as Haskell and Ocaml have quite different runtime systems. For instance, a pair of integers has a very different representation in the two languages, so one needs to convert accordingly."}, {"owner": {"reputation": 3431, "user_id": 2482998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afd7c230e485da1a1ecfa351bd3744d9?s=128&d=identicon&r=PG", "display_name": "antron", "link": "https://stackoverflow.com/users/2482998/antron"}, "edited": false, "score": 0, "creation_date": 1480106846, "post_id": 40807783, "comment_id": 68844484, "body": "See <a href=\"http://caml.inria.fr/pub/docs/manual-ocaml/intfc.html\" rel=\"nofollow noreferrer\">interfacing C with OCaml</a> in the manual and the <a href=\"https://github.com/ocamllabs/ocaml-ctypes\" rel=\"nofollow noreferrer\"><code>ctypes</code> library</a>."}], "answers": [{"tags": [], "owner": {"reputation": 857, "user_id": 1030453, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcc819c9bce12893784f16bd63f581db?s=128&d=identicon&r=PG", "display_name": "chrismamo1", "link": "https://stackoverflow.com/users/1030453/chrismamo1"}, "is_accepted": false, "score": 0, "last_activity_date": 1580775910, "creation_date": 1580775910, "answer_id": 60048939, "question_id": 40807783, "link": "https://stackoverflow.com/questions/40807783/calling-haskell-code-from-ocaml-using-ffi/60048939#60048939", "title": "Calling haskell code from OCaml using FFI", "body": "<p>If this <code>foreign export ccall</code> works as I think it should, then you should end up with a shared object file roughly identical to what would be generated by a C compiler. Just pretend that's the case and feed that object file to your linker.</p>\n"}], "owner": {"reputation": 313, "user_id": 3703378, "user_type": "registered", "accept_rate": 61, "profile_image": "https://graph.facebook.com/100001130222980/picture?type=large", "display_name": "Kapil", "link": "https://stackoverflow.com/users/3703378/kapil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 227, "favorite_count": 1, "answer_count": 1, "score": 7, "last_activity_date": 1580775910, "creation_date": 1480086204, "question_id": 40807783, "link": "https://stackoverflow.com/questions/40807783/calling-haskell-code-from-ocaml-using-ffi", "title": "Calling haskell code from OCaml using FFI", "body": "<p>I would like to expose a function from a Haskell source library using FFI and use it in OCaml code. I saw various examples using the <code>foreign export ccall</code>syntax in Haskell which I believe exports the function for usage in C. Is there something similar for OCaml? What would be the best approach to achieve this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1480091024, "post_id": 40807020, "comment_id": 68838788, "body": "In future questions, please don&#39;t use images for code or error messages. Paste them as text instead."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1480085361, "creation_date": 1480085361, "answer_id": 40807537, "question_id": 40807020, "link": "https://stackoverflow.com/questions/40807020/how-to-insert-an-integer-into-a-sorted-list/40807537#40807537", "title": "How to insert an integer into a sorted list", "body": "<p>You are treating <code>y</code> as a function, not an element. You need to use <code>:</code> to construct a new list. Also, for a list, you use <code>[...]</code> <em>or</em> <code>x:xs</code>, not both. <code>[x,y]</code> is syntactic sugar for <code>x:y:[]</code>.</p>\n\n<pre><code>insert x [] = x\ninsert x (y:ys) = if x &lt;= y\n                  then x:y:ys\n                  else y : insert x ys\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 0, "last_activity_date": 1480091830, "creation_date": 1480091830, "answer_id": 40809326, "question_id": 40807020, "link": "https://stackoverflow.com/questions/40807020/how-to-insert-an-integer-into-a-sorted-list/40809326#40809326", "title": "How to insert an integer into a sorted list", "body": "<p>Another solution, probably not most efficient but still should be good (w/o explicit recursion and pattern matching on list):</p>\n\n<pre><code>insert :: Int -&gt; [Int] -&gt; [Int]\ninsert x l = let (lower, greater) = span (&lt; x) l in lower ++ x : greater\n</code></pre>\n\n<p>And this solution is also lazy as you can see:</p>\n\n<pre><code>\u03bb: insert 3 [1,2,4]\n[1,2,3,4]\n\u03bb: take 10 $ insert 5 $ repeat 1\n[1,1,1,1,1,1,1,1,1,1]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "is_accepted": false, "score": 3, "last_activity_date": 1480094847, "creation_date": 1480094847, "answer_id": 40809979, "question_id": 40807020, "link": "https://stackoverflow.com/questions/40807020/how-to-insert-an-integer-into-a-sorted-list/40809979#40809979", "title": "How to insert an integer into a sorted list", "body": "<p>You have several errors here.</p>\n\n<ul>\n<li><p>In the argument list, <code>y:ys</code> is already a list, there is no need in wrapping it again like <code>[y:ys]</code>, - this has type <code>[[Int]]</code>, that is, a list of lists. Note that we still have to put brackets here, to tell Haskell that this is a single function agument: <code>(y:ys)</code>. </p></li>\n<li><p>In your \"then\" clause, again, <code>x:y:ys</code> is already a list, - don't wrap it into <code>[x:y:ys]</code>.</p></li>\n<li><p>In your \"else\" clause, <code>y insert x [ys]</code> is <em>function application</em> - Haskell thinks that <code>y</code> is a function that you are applying to arguments <code>insert</code>, <code>x</code> and <code>[ys]</code>. You need operator <code>:</code> here, like <code>y : insert ...</code></p></li>\n<li><p>Again, in your \"else\" clause, you repeat the first error: <code>ys</code> is already a list, don't wrap it into <code>[ys]</code>.</p></li>\n</ul>\n\n<p>So, a fixed solution would be:</p>\n\n<pre><code>insert :: Int -&gt; [Int] -&gt; [Int]\ninsert x [] = [x] \ninsert x (y:ys) = if x &lt;= y\n                  then x:y:ys\n                  else y : insert x ys\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7209970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f93acd0ae2539c73637ac67cb63b614?s=128&d=identicon&r=PG&f=1", "display_name": "mdlvnadnfad", "link": "https://stackoverflow.com/users/7209970/mdlvnadnfad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3682, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1480094847, "creation_date": 1480083549, "last_edit_date": 1480090922, "question_id": 40807020, "link": "https://stackoverflow.com/questions/40807020/how-to-insert-an-integer-into-a-sorted-list", "title": "How to insert an integer into a sorted list", "body": "<p>I tried to insert an integer at the correct position into a sorted list of integers. </p>\n\n<pre><code>insert :: Int -&gt; [Int] -&gt; [Int]\ninsert x [] = [x] \ninsert x [y:ys] = if x &lt;= y\n                  then [x:y:ys]\n                  else y insert x [ys]\n</code></pre>\n\n<p>Can anyone tell me what's wrong here and how to fix it? Here are the errors I have encountered:</p>\n\n<p><a href=\"https://i.stack.imgur.com/uTekZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uTekZ.png\" alt=\"Error output\"></a></p>\n"}, {"tags": ["list", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7209823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4752355857e89cb9cbfe8df3563cd928?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Hill", "link": "https://stackoverflow.com/users/7209823/matt-hill"}, "edited": false, "score": 0, "creation_date": 1480082057, "post_id": 40806063, "comment_id": 68833937, "body": "This makes me feel a bit better. I was on the right lines, but had the syntax incorrect."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1480080140, "creation_date": 1480080140, "answer_id": 40806063, "question_id": 40805962, "link": "https://stackoverflow.com/questions/40805962/concatenating-a-string-onto-all-elements-of-string-haskell/40806063#40806063", "title": "concatenating a string onto all elements of [string] haskell", "body": "<pre><code>map (\"aaa\"++) [\"bbb\", \"ccc\"]\n==&gt; [ \"aaabbb\", \"aaaccc\" ]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1480089684, "post_id": 40806114, "comment_id": 68838113, "body": "If you don&#39;t know the <code>mappend</code> function, how can you possibly be expected to come up with the type signature <code>Monoid a =&gt; a -&gt; a -&gt; a</code>? And in this case, typing in the natural type signature search of <code>String -&gt; String -&gt; String</code> doesn&#39;t list the right function until quite late in the list of results."}], "tags": [], "owner": {"reputation": 83, "user_id": 5440214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469ab9579220e66421a1af3bf0b69e6d?s=128&d=identicon&r=PG", "display_name": "Pete", "link": "https://stackoverflow.com/users/5440214/pete"}, "is_accepted": false, "score": 0, "last_activity_date": 1480080302, "creation_date": 1480080302, "answer_id": 40806114, "question_id": 40805962, "link": "https://stackoverflow.com/questions/40805962/concatenating-a-string-onto-all-elements-of-string-haskell/40806114#40806114", "title": "concatenating a string onto all elements of [string] haskell", "body": "<p>You want to traverse your list of extensions and apply a function to each, so some kind of <code>map</code> is required.</p>\n\n<p>The function you want to apply is to append the <code>websiteURL</code> string, so the answer is:</p>\n\n<pre><code>map (mappend websiteURL) result\n</code></pre>\n\n<p>If you didn't know the <code>mappend</code> function, you could find it by searching hoogle for <code>Monoid a =&gt; a -&gt; a -&gt; a</code>.</p>\n\n<p>(I'll let other people generalize to more abstract types if they want...)</p>\n"}], "owner": {"reputation": 1, "user_id": 7209823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4752355857e89cb9cbfe8df3563cd928?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Hill", "link": "https://stackoverflow.com/users/7209823/matt-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1480085369, "creation_date": 1480079790, "last_edit_date": 1480085369, "question_id": 40805962, "link": "https://stackoverflow.com/questions/40805962/concatenating-a-string-onto-all-elements-of-string-haskell", "title": "concatenating a string onto all elements of [string] haskell", "body": "<p>I'm new to haskell and can't seem to figure this out. I've been using the scalpel web scraping tool and want to concatenate a bunch of URL extensions with a URL.</p>\n\n<p>For example, lets say we have scraped some URL extensions into a list of strings </p>\n\n<pre><code>result =[\"/contact\",\"/content\"] \n</code></pre>\n\n<p>and we have let </p>\n\n<pre><code>websiteURL = \"www.website.com\"\n</code></pre>\n\n<p>how do I arrive at the list ?</p>\n\n<pre><code>[\"www.website.com/contact\", \"www.website.com/content\"]\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": false, "score": 6, "last_activity_date": 1480071177, "creation_date": 1480071177, "answer_id": 40803283, "question_id": 40802746, "link": "https://stackoverflow.com/questions/40802746/haskell-operator/40803283#40803283", "title": "Haskell (&gt;&gt;) operator", "body": "<p>The <code>&gt;&gt;</code> operator is not <code>flip const</code>, even if it has a similar type signature. If you look at the default implementation, you can see it actually calls <code>&gt;&gt;=</code> on its first argument:</p>\n\n<pre><code>a &gt;&gt; b = a &gt;&gt;= \\_ -&gt; b\n</code></pre>\n\n<p>For that reason, you can think of <code>&gt;&gt;</code> as <strong>running a monadic action for its \u201cside-effects\u201d but discarding the result</strong>. If you inline the above definition of <code>&gt;&gt;</code> in place of your example, the result you get becomes quite clear:</p>\n\n<pre><code>runState (modify (+1) &gt;&gt;= \\_ -&gt; modify (+1)) 0\n</code></pre>\n\n<p>This will obviously run <code>modify (+1)</code> twice in the context of the state monad, so the resulting state will be <code>2</code>, not <code>1</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": false, "score": 2, "last_activity_date": 1480081246, "last_edit_date": 1480081246, "creation_date": 1480080016, "answer_id": 40806027, "question_id": 40802746, "link": "https://stackoverflow.com/questions/40802746/haskell-operator/40806027#40806027", "title": "Haskell (&gt;&gt;) operator", "body": "<p>You can thing about <code>State s</code> monad as:</p>\n\n<pre><code>newtype State s a = State { runState :: s -&gt; (a, s) }\n</code></pre>\n\n<p>And let's see how operator (>>) is implemented for this monad:</p>\n\n<pre><code>(State f) &gt;&gt; (State g) = State (g . snd . f)\n</code></pre>\n\n<p>And how modify work:</p>\n\n<pre><code>modify f = State $ \\s -&gt; ((), f s)\n</code></pre>\n\n<p>So compose all together:</p>\n\n<pre><code>modify (+1) &gt;&gt; modify (+1) =&gt; (State $ \\s -&gt; ((), s + 1)) &gt;&gt; ((State $ \\s -&gt; ((), s + 1)) =&gt; State (\\s -&gt; ((), (s + 1) + 1))\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>runState (State (\\s -&gt; ((), (s + 1) + 1))) 0 =&gt; (\\s -&gt; ((), (s + 1) + 1)) 0 =&gt; ((), (0 + 1) + 1) =&gt; ((), 2)\n</code></pre>\n"}], "owner": {"reputation": 409, "user_id": 1897830, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4bb6f01afcee8d6fd59ccb93499732d6?s=128&d=identicon&r=PG", "display_name": "user1897830", "link": "https://stackoverflow.com/users/1897830/user1897830"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1480081246, "creation_date": 1480069637, "question_id": 40802746, "link": "https://stackoverflow.com/questions/40802746/haskell-operator", "title": "Haskell (&gt;&gt;) operator", "body": "<pre><code>runState (modify (+1) &gt;&gt; modify (+1)) 0\n</code></pre>\n\n<p>Can somebody explain how the above code produces ((),2)? Given <code>(&gt;&gt;) :: Monad m =&gt; m a -&gt; m b -&gt; m b</code> I would have thought the first \"modify (+1)\" would be dropped resulting in ((),1). </p>\n"}, {"tags": ["haskell", "nested", "algebraic-data-types"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 3316136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fb34eb1ac5b899442d2d02e4b548083?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3316136/alexander"}, "edited": false, "score": 0, "creation_date": 1480068186, "post_id": 40802000, "comment_id": 68825541, "body": "Thanks! This makes sense."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 2, "last_activity_date": 1480067966, "last_edit_date": 1480067966, "creation_date": 1480067365, "answer_id": 40802000, "question_id": 40801860, "link": "https://stackoverflow.com/questions/40801860/type-casting-when-working-with-nested-data-structures/40802000#40802000", "title": "Type casting when working with nested data structures", "body": "<p>A value can't have two different types at the same time. If <code>x</code> is a <code>CVO</code> you can't use <code>==</code> to compare it to <code>Plus</code> which is an <code>Operator</code>.</p>\n\n<p>At the moment the type <code>CVO</code> consists of three <em>constant values</em> called <code>Const</code>, <code>Variable</code> and <code>Operator</code>. I'm guessing you actually wanted it to contain values of the type <code>Const</code>, <code>Variable</code> or <code>Operator</code>. You do that by declaring arguments to the constructors.</p>\n\n<pre><code>data CVO = Const Const  -- a constructor whose name is Const and contains a value of type Const\n         | Var Variable  -- a constructor named Var containing a Variable\n         | Op Operator  -- a constructor named Op containing an Operator\n</code></pre>\n\n<p>A given value of type <code>CVO</code> must have been built from one of those three constructors, containing a value of the correct type. You can test which constructor was used to create the <code>CVO</code>, and simultaneously unpack the value, using <em>pattern matching</em>. Something like this:</p>\n\n<pre><code>helper :: Expr -&gt; Integer\nhelper [] = 0\nhelper (Op o:xs)  -- because we matched Op, we know o :: Operator\n    | o == Plus = 1\n    | otherwise = 2\nhelper _ = 3\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 3316136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fb34eb1ac5b899442d2d02e4b548083?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3316136/alexander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 40802000, "answer_count": 1, "score": 0, "last_activity_date": 1480067966, "creation_date": 1480067010, "last_edit_date": 1480067324, "question_id": 40801860, "link": "https://stackoverflow.com/questions/40801860/type-casting-when-working-with-nested-data-structures", "title": "Type casting when working with nested data structures", "body": "<p>I have the following data structures defined:</p>\n\n<pre><code>data Operator = Plus | Times | Minus deriving (Eq,Show)\ndata Variable = A | B | C deriving (Eq,Show)\nnewtype Const = D Numeral deriving (Eq,Show)\ndata CVO = Const | Variable | Operator deriving (Eq,Show)\ntype Expr = [CVO]\n</code></pre>\n\n<p>I have defined the following function:</p>\n\n<pre><code>eval2 :: Expr -&gt; Integer\neval2 x = helper x\n</code></pre>\n\n<p>I would like to check if an element of the CVO list (Expr) is either an instance of Const, Variable or Operator (this works) and I would like to implement varying code for the specific type of the instance (e.g. Plus, Times, Minus for Operator).</p>\n\n<pre><code>helper :: Expr -&gt; Integer\nhelper [] = 2\nhelper (x:xs) \n    | x == Operator &amp;&amp; x == Plus = 1\n</code></pre>\n\n<p>I cannot compare x to Plus, because it expects x to be of type CVO.</p>\n\n<pre><code>Couldn't match expected type \u2018CVO\u2019 with actual type \u2018Operator\u2019\n</code></pre>\n\n<p>Is it somehow possible to cast x to be an instance of Operator in order to do the comparison?</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 2, "creation_date": 1480064643, "post_id": 40800895, "comment_id": 68823495, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/10161009/input-checks-in-haskell-data-constructors\">Input checks in Haskell data constructors</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1480065066, "post_id": 40800895, "comment_id": 68823705, "body": "Please refrain from asking two questions at once. Your second question is answered by the Q&amp;A linked above. The short answer to the subtyping question is &quot;no, Haskell does not support subtyping&quot;. You could get around it with typeclasses, but then your question needs to be much more specific about how you <i>use</i> those types, instead of just what they <i>are</i>. There are some questions about it already on this website, and <a href=\"https://www.reddit.com/r/haskell/comments/423o0c/why_no_subtypingsubtype_polymorphism/\" rel=\"nofollow noreferrer\">this Reddit thread</a> provides some good arguments why subtyping isn&#39;t part of Haskell."}], "answers": [{"comments": [{"owner": {"reputation": 401, "user_id": 1985931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cda15456fc1622e0855b351c6f2854de?s=128&d=identicon&r=PG", "display_name": "iluvAS", "link": "https://stackoverflow.com/users/1985931/iluvas"}, "edited": false, "score": 0, "creation_date": 1480091290, "post_id": 40801370, "comment_id": 68838933, "body": "Thanks for the insight, I&#39;m guessing i would still have to make checks via guards. I was hoping to make a &#39;closed type&#39; where there are no operations that will lead to an &#39;invalid&#39; value i.e. Nothing."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 401, "user_id": 1985931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cda15456fc1622e0855b351c6f2854de?s=128&d=identicon&r=PG", "display_name": "iluvAS", "link": "https://stackoverflow.com/users/1985931/iluvas"}, "edited": false, "score": 1, "creation_date": 1480091723, "post_id": 40801370, "comment_id": 68839163, "body": "Yes, if you don&#39;t export the constructors then you can make a type \u201cclosed\u201d in this sense allright. Just make sure all the functions you do export obey the invariances."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 3, "last_activity_date": 1480077444, "last_edit_date": 1480077444, "creation_date": 1480065474, "answer_id": 40801370, "question_id": 40800895, "link": "https://stackoverflow.com/questions/40800895/defining-a-new-haskell-type/40801370#40801370", "title": "Defining a new haskell type", "body": "<p>The <code>type doublePair</code> of these really doesn't make sense. If the <code>snd</code> is always twice the <code>fst</code>, then it doesn't actually contain any information! So, this type is definitely better expressed as</p>\n\n<pre><code>newtype DoubleableInt = DoubleableInt {getDoubleableInt :: Int}\n</code></pre>\n\n<p>The others do make some sense, but I think you're still a bit missing the <em>point of an abstraction</em>. The type <code>validDDMMYYYY</code> is probably supposed to express a <em>date</em>, i.e. a point in time. How it <em>respresents</em> this shouldn't really be the user's concern: if a library depends on a certain representation, it should simply should offer specialised \u201csmart constructors\u201d to ensure well-formedness. Like</p>\n\n<pre><code>newtype AllIntsButZero = AllIntsButZero {getNonzeroInt :: Int}\n\nmkNonzeroInt :: Int -&gt; Maybe AllIntsButZero\nmkNonzeroInt 0 = Nothing\nmkNonzeroInt n = AllIntsButZero n\n</code></pre>\n\n<p>You may then refuse to export the <code>AllIntsButZero</code> constructor (which would allow users to form incorrect <code>AllIntsButZero 0</code>):</p>\n\n<pre><code>module RestrictedNumbers (AllIntsButZero, getNonzeroInt, mkNonzeroInt) where\n</code></pre>\n\n<p>This way, users will only see <code>AllIntsButZero</code> as a \u201cblack box\u201d, and the <em>functions</em> they can use with it are guaranteed to yield well-formed values.</p>\n"}], "owner": {"reputation": 401, "user_id": 1985931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cda15456fc1622e0855b351c6f2854de?s=128&d=identicon&r=PG", "display_name": "iluvAS", "link": "https://stackoverflow.com/users/1985931/iluvas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 40801370, "answer_count": 1, "score": 0, "last_activity_date": 1480077444, "creation_date": 1480063770, "question_id": 40800895, "link": "https://stackoverflow.com/questions/40800895/defining-a-new-haskell-type", "title": "Defining a new haskell type", "body": "<p>I'm new to haskell. I've two questions but they're somewhat related.</p>\n\n<p>Is it possible to define a type of Integers excluding specific integers for example zero. Or just positive numbers.</p>\n\n<pre><code>data allIntsButZero = ..? { a /= 0 | for all a in Int} ??\ndata positiveInts   = ..? { a &gt;= 0 | for all a in Int} ??\n</code></pre>\n\n<p>In short, can I define a type as a subset of another type?</p>\n\n<p>Secondly, can i define a type where there is a logic imposed? e.g.</p>\n\n<pre><code>type doublePair = (Int, Int * 2) {- where snd is always 2 times of fst -}\ndata validDDMMYYYY = G Int Int Int {- where complies to gregorian calendar -}\n</code></pre>\n"}, {"tags": ["haskell", "io", "monads"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1480068328, "post_id": 40795502, "comment_id": 68825622, "body": "Be careful here. A byte-string is NOT actually convertible to a list of characters, unless we know its encoding. <code>Char8</code> assumes latin-1, which is arbitrary. AFAICS, the general trend is using utf8 for most of the text around the net. In html for instance, the encoding is sometimes declared inside the html itself, which makes everything a bit more complex. I hope there is a library that handles this semi-transparently somewhere."}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 3, "last_activity_date": 1480035420, "last_edit_date": 1480035420, "creation_date": 1480035014, "answer_id": 40796272, "question_id": 40795502, "link": "https://stackoverflow.com/questions/40795502/i-o-monad-and-bytestring-to-char-conversion/40796272#40796272", "title": "I/O Monad and ByteString to Char conversion?", "body": "<p>To answer your first question, note that there's a different \"unpack\" in Data.ByteString.Lazy.Char8 with the signature you want:</p>\n\n<pre><code>unpack :: ByteString -&gt; String\n</code></pre>\n\n<p>It's not unusual for people to import both modules:</p>\n\n<pre><code>import qualified Data.ByteString.Lazy as B\nimport qualified Data.ByteString.Lazy.Char8 as C\n</code></pre>\n\n<p>and mix and match functions from each.</p>\n\n<p>To answer your second question, yes that's more or less it.  For example:</p>\n\n<pre><code>redund = do x &lt;- getLine\n            y &lt;- return x\n            z &lt;- return y\n            u &lt;- return z\n            return u\n</code></pre>\n\n<p>is all equivalent to <code>redund = getLine</code> with a bunch of re-wrapping and extracting of pure values into an out of an IO monad.</p>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "accepted_answer_id": 40796272, "answer_count": 1, "score": 2, "last_activity_date": 1480035655, "creation_date": 1480028114, "last_edit_date": 1480035655, "question_id": 40795502, "link": "https://stackoverflow.com/questions/40795502/i-o-monad-and-bytestring-to-char-conversion", "title": "I/O Monad and ByteString to Char conversion?", "body": "<p>I'm testing some HTTP requests in haskell and have the below methods:</p>\n\n<pre><code>import qualified Data.ByteString.Lazy as LAZ\nimport  Language.Haskell.TH.Ppr\nimport System.IO\nimport Data.Word (Word8)\n\nrequest :: IO LAZ.ByteString\nrequest = do\n     response &lt;- simpleHttp \"https://www.url.com\"\n     return (response)\n\nexampleFunctionOne:: IO LAZ.ByteString -&gt; IO LAZ.ByteString\nexampleFunctionOne bytes = do \n     html &lt;- bytes\n     let bytesToChars = bytesToString $ LAZ.unpack html\n     let x = exampleFunctionTwo bytesToChars\n     bytes\n\nexampleFunctionTwo :: [Char] -&gt; [Char]\nexampleFunctionTwo chars = --Do stuff...\n\nmain = do\n  exampleFunctionOe $ request\n</code></pre>\n\n<p>My questions are:</p>\n\n<ol>\n<li><p>Is there a more straight forward way to convert the ByteString to [Char]? Currently I've having to convert to perform (ByteString -> Word8) and then (Word8 -> Char)</p></li>\n<li><p>Am I correct in saying the 'return ()' statement in my request function is simply re-applying the monad context (in this case IO) to the value I've extracted (response &lt;- simpleHttp)? Or does it have an additional purpose?</p></li>\n</ol>\n"}, {"tags": ["haskell", "applicative"], "comments": [{"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 1, "creation_date": 1480021275, "post_id": 40791733, "comment_id": 68811028, "body": "do you have some computation in mind which will benefit from this? There is <a href=\"http://hackage.haskell.org/package/these-0.7.2/docs/Data-Align.html\" rel=\"nofollow noreferrer\"><code>Data.Align</code></a> which is container-oriented (and not computaton/context), which might be what you are looking for?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1480024652, "post_id": 40791733, "comment_id": 68812110, "body": "Defining such a type is far from your biggest issue (you can define <code>Functor</code> for any type with the <a href=\"https://hackage.haskell.org/package/kan-extensions-5.0.1/docs/Data-Functor-Kan-Lan.html\" rel=\"nofollow noreferrer\">left Kan extension</a>). You must decide on a semantics which is consistent with the Applicative laws - for example, what is <code>pure</code>? <code>pure id &lt;*&gt; a</code> must equal <code>a</code> - so <code>pure</code> would have to take as a parameter something indicating the length of the list to which it will be applied in the future - otherwise you cannot produce a list of precisely <code>length a</code> from <code>pure</code>."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1480047800, "post_id": 40791733, "comment_id": 68817172, "body": "The definition of the typeclass that will allow this is known as the <a href=\"http://ku-fpg.github.io/practice/constrainedTypeClassInstances/\" rel=\"nofollow noreferrer\">Constrained Typeclass Problem</a>, and there have been a few approaches."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1480056816, "post_id": 40791733, "comment_id": 68819999, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/21349408/zip-with-default-value-instead-of-dropping-values\">Zip with default value instead of dropping values?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1480047973, "post_id": 40792705, "comment_id": 68817207, "body": "This doesn&#39;t actually work as we would probably like.  Consider <code>(*) &lt;$&gt; ZipList [1,1,1] &lt;#&gt; ZipList [4]</code> which evaluates to <code>ZipList [4,0,0]</code>, when it seems like it should be <code>ZipList [4,1,1]</code>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1480048524, "post_id": 40792705, "comment_id": 68817334, "body": "@luqui Isn&#39;t that a problem inherent in trying to solve this in the applicative &quot;format&quot;? Your assumption that you should get back <code>ZipList [4,1,1]</code> implies something about the fact <code>(*)</code> forms a monoid with identity <code>1</code>, which is much more information than we get in the <code>(&lt;#&gt;)</code> operator."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1480050169, "post_id": 40792705, "comment_id": 68817760, "body": "yes I think it probably is.  I&#39;m trying to give a satisfying explanation now, but I might abort the task :-P"}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 2, "last_activity_date": 1480039138, "last_edit_date": 1480039138, "creation_date": 1480011925, "answer_id": 40792705, "question_id": 40791733, "link": "https://stackoverflow.com/questions/40791733/ziplists-with-longest-style-applicative-behaviour/40792705#40792705", "title": "Ziplists with longest-style applicative behaviour", "body": "<p>First, what you really want is probably <a href=\"https://hackage.haskell.org/package/data-default-0.7.1.1/docs/Data-Default.html#t:Default\" rel=\"nofollow noreferrer\"><code>Default</code></a>, not <code>Monoid</code> - you have no use for <code>mappend</code>.</p>\n\n<p>I don't think anything useful is possible in <code>Applicative</code> itself. That said, I can define a version of <code>(&lt;*&gt;)</code> (called <code>(&lt;#&gt;)</code>) with extra constraints that lets me do what I think you have in mind.</p>\n\n<h2>Why there is no point in making a new data type</h2>\n\n<p>First, suppose we <em>were</em> to take the <code>ExistentialQuantification</code> route in hopes of pushing our constraints into the <code>data</code> and having legitimate instances of <code>Functor</code> and <code>Applicative</code>.  That blows up as soon as we try to define <code>fmap</code>:</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\ndata ZipMonList a = Default a =&gt; ZipMonList [a]\n\n-- Woops, we still need a constraint for `Default b`\nfmap :: Default b =&gt; (a -&gt; b) -&gt; ZipMonList a -&gt; ZipMonList b\nfmap f (ZipMonList xs) = ZipMonList (f xs)\n</code></pre>\n\n<p>So, with that settled, let's stick to the <code>ZipList</code> type (since we want the same <code>(&lt;$&gt;)</code> anyways) and just define our new constrained version of <code>(&lt;*&gt;)</code>, called <code>(&lt;#&gt;)</code>.</p>\n\n<h2>Make <code>(&lt;#&gt;)</code> for <code>ZipList</code></h2>\n\n<p>Underlying <code>ZipList</code>s <code>(&lt;*&gt;)</code> is the <code>zipWith</code> function. We need something similar for <code>(&lt;#&gt;)</code>, but that extends lists. Then, <code>(&lt;#&gt;)</code> looks a lot like <code>(&lt;*&gt;)</code>:</p>\n\n<pre><code>import Control.Applicative (ZipList(..))\nimport Data.Default\n\n-- Like 'zipWith', but has maximum length\nzipWith' :: (Default a, Default b) =&gt; (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]\nzipWith' f []     []     = []\nzipWith' f (x:xs) []     = f x   def : zipWith' f xs []\nzipWith' f []     (y:ys) = f def y   : zipWith' f [] ys\nzipWith' f (x:xs) (y:ys) = f x   y   : zipWith' f xs ys\n\n-- same fixity as &lt;*&gt;\ninfixl 4 &lt;#&gt; \n\n-- like '(&lt;*&gt;)', but uses 'zipWith'' instead of 'zipWith'\n(&lt;#&gt;) :: (Default a, Default b) =&gt; ZipList (a -&gt; b) -&gt; ZipList a -&gt; ZipList b\nZipList fs &lt;#&gt; ZipList xs = ZipList (zipWith' id fs xs)\n</code></pre>\n\n<p>And I can do a test run on tuples:</p>\n\n<pre><code>ghci&gt; (,,) &lt;$&gt; ZipList [1.2,3.4,5.6,7.8,9.1] &lt;#&gt; ZipList [[(),()],[()],[(),(),()]] &lt;#&gt; ZipList [1,2,3,4]\nZipList {getZipList = [(1.2,[(),()],1),(3.4,[()],2),(5.6,[(),(),()],3),(7.8,[],4),(9.1,[],0)]}\n</code></pre>\n\n<p>Key takeaway point: this is <em>not</em> an <code>Applicative</code>, but still doable.</p>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 1, "last_activity_date": 1480093312, "last_edit_date": 1480093312, "creation_date": 1480051113, "answer_id": 40798166, "question_id": 40791733, "link": "https://stackoverflow.com/questions/40791733/ziplists-with-longest-style-applicative-behaviour/40798166#40798166", "title": "Ziplists with longest-style applicative behaviour", "body": "<p>I just have a few notes for you, things to think about.</p>\n\n<p>The definition of the typeclass that will allow this is known as the <a href=\"http://ku-fpg.github.io/practice/constrainedTypeClassInstances/\" rel=\"nofollow noreferrer\">Constrained Typeclass Problem</a>, and there have been a few approaches.</p>\n\n<p>I notice that you have only specified that the resulting list should be as long as the longer of the two lists, but you haven't said what the remaining elements should be.  At that point you might as well use the applicative</p>\n\n<pre><code>ZipList :*: Const (MaxPos Int)\n</code></pre>\n\n<p>(where <a href=\"https://hackage.haskell.org/package/TypeCompose-0.9.12/docs/Control-Compose.html#t::-42-:\" rel=\"nofollow noreferrer\"><code>:*:</code> is functor product</a>, and <code>MaxPos</code> is a monoid I just made up taking the maximum on nonnegative numbers) which keeps track of the \"length\" separately, because the remaining elements will be meaningless.  </p>\n\n<p>Rather, I suspect you mean something where the remaining elements are preserved in some sense, i.e. so</p>\n\n<pre><code>(*) &lt;$&gt; [2,3,4] &lt;*&gt; [4] = [8,3,4]\n</code></pre>\n\n<p>and also</p>\n\n<pre><code>(+) &lt;$&gt; [2,3,4] &lt;*&gt; [4] = [6,3,4]\n</code></pre>\n\n<p>So if we were to \"fill in\" missing elements in the former case we should fill them in with 1, and in the latter we should fill them in with 0.  This starts to show us a different aspect of the problem; we need to pick identity elements based on the operation, or just \"leave alone\" the remaining elements (which constrains the operations to type <code>a -&gt; a -&gt; a</code>).  This is looking less possible, it'd be interesting to explore more.  That's all I've got for now, sorry.</p>\n"}], "owner": {"reputation": 11, "user_id": 7205830, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002074843432/picture?type=large", "display_name": "Bogdan Chornomaz", "link": "https://stackoverflow.com/users/7205830/bogdan-chornomaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1480093312, "creation_date": 1480007284, "question_id": 40791733, "link": "https://stackoverflow.com/questions/40791733/ziplists-with-longest-style-applicative-behaviour", "title": "Ziplists with longest-style applicative behaviour", "body": "<p>Is it possible in Haskell do define a type similar to ziplist, in which operation <code>a &lt;*&gt; b</code> will produce list which is as long as the <em>longest</em> of <code>a</code> and <code>b</code>.</p>\n\n<p>It is clear that in this case we must assume that <code>a</code> and <code>b</code> are lists over something like Monoid, so tentative declaration is:</p>\n\n<pre><code>   instance Monoid a =&gt; Applicative (ZList a) where ...\n</code></pre>\n\n<p>which clearly will not typecheck. Another tentative approach is to use GADTs with constrained constructors, something like</p>\n\n<pre><code>   data ZList a where \n     Z:: ZList a\n     S:: Monoid a =&gt; a-&gt; (ZList a) -&gt; (ZList a)\n</code></pre>\n\n<p>but then I stuck on a stage of making it Functor because we cannot guarantee that in <code>fmap::(a -&gt; b) -&gt; f a -&gt; f b</code>, b will be Monoid. </p>\n\n<p>Clearly, this question extends to wider class of algebraic datatypes for which we want to define \"pointwise\" applicative behavior in which we produce output with shape similar to the <em>union</em> of shapes of the arguments. </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1661, "user_id": 2092686, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/106a013afd3c8f6a2bcde0c1adc5b715?s=128&d=identicon&r=PG&f=1", "display_name": "godzsa", "link": "https://stackoverflow.com/users/2092686/godzsa"}, "edited": false, "score": 0, "creation_date": 1480002155, "post_id": 40790175, "comment_id": 68802765, "body": "Thanks for your answer, then I will go with map g $ chunksOf n"}, {"owner": {"reputation": 1970, "user_id": 4195825, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d5a6be8edab9c465df099f8c74b3f576?s=128&d=identicon&r=PG&f=1", "display_name": "px06", "link": "https://stackoverflow.com/users/4195825/px06"}, "edited": false, "score": 0, "creation_date": 1480003084, "post_id": 40790175, "comment_id": 68803336, "body": "I would just like to ask a sub-question to this as I&#39;m new to Haskell also... Following up on the OPs question I agree that using something like <code>g :: [Int] -&gt; [Int]</code> and doing <code>g(a:b:c:d:xs)</code> is a good way of extracting the elements, but isn&#39;t possible for <code>n</code> elements right? I came up with this but I&#39;m not sure if it would be a viable option in this scenario: <code>g xs = [x*2 | x &lt;- take 4 xs] ++ [x*3 | x &lt;- drop 4 xs]</code> where <code>g :: [Int] -&gt; [Int]</code> and I&#39;m applying basic multiplication to the elements as an example. Of course <code>4</code> will be replaced by <code>n</code>."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 1970, "user_id": 4195825, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d5a6be8edab9c465df099f8c74b3f576?s=128&d=identicon&r=PG&f=1", "display_name": "px06", "link": "https://stackoverflow.com/users/4195825/px06"}, "edited": false, "score": 0, "creation_date": 1480007329, "post_id": 40790175, "comment_id": 68805646, "body": "@px06 Right, you can&#39;t use pattern matching when you want to extract a non-constant number of elements. You&#39;ll have to use <code>take</code> and <code>drop</code> like you did."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 1970, "user_id": 4195825, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d5a6be8edab9c465df099f8c74b3f576?s=128&d=identicon&r=PG&f=1", "display_name": "px06", "link": "https://stackoverflow.com/users/4195825/px06"}, "edited": false, "score": 0, "creation_date": 1480014190, "post_id": 40790175, "comment_id": 68808489, "body": "@px06 You could do it directly in one pass by subtracting one from <code>n</code> each recursive call and then applying the appropriate operation depending on whether <code>n == 0</code> or not."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1480017712, "post_id": 40790175, "comment_id": 68809768, "body": "Better <code>splitAt</code> than <code>take</code> and <code>drop</code>, no?"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1480017806, "post_id": 40790175, "comment_id": 68809809, "body": "@dfeuer Or that, yes."}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 6, "last_activity_date": 1480017794, "last_edit_date": 1480017794, "creation_date": 1480001777, "answer_id": 40790175, "question_id": 40789682, "link": "https://stackoverflow.com/questions/40789682/how-to-take-the-first-n-items-and-proceed-with-remaining-in-recursion/40790175#40790175", "title": "How to take the first n items and proceed with remaining in recursion?", "body": "<p><code>p1 : p2</code> is a pattern that matches a non-empty list if the list's head matches the pattern <code>p1</code> and its tail matches <code>p2</code>. <code>[p1, p2, p3, p4]</code> is a pattern that matches a four-element list if its elements match p1, p2, p3 and p4 respectively. Thus <code>[_, _, _, _]:xs</code> matches a non-empty list if its first element is a four-element list. Since <code>f</code> takes a list of ints, not a list of lists, this pattern leads to a type error in your function.</p>\n\n<p>What you want can be expressed as <code>x1 : x2 : x3 : x4 : xs</code> and then <code>where x = [x1, x2, x3, x4]</code>. Of course that's not particularly pretty and it might be more convenient to just use <code>take</code> and <code>drop</code> or <code>splitAt</code> instead (if you really want to do your own recursion, that is).</p>\n\n<blockquote>\n  <p>I just thought it would look much more \"haskelly\" with recursion</p>\n</blockquote>\n\n<p>I would disagree with that. I'd say it's generally preferable in Haskell to use and combine existing standard library functions instead of writing your own recursive functions.</p>\n"}], "owner": {"reputation": 1661, "user_id": 2092686, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/106a013afd3c8f6a2bcde0c1adc5b715?s=128&d=identicon&r=PG&f=1", "display_name": "godzsa", "link": "https://stackoverflow.com/users/2092686/godzsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1174, "favorite_count": 0, "accepted_answer_id": 40790175, "answer_count": 1, "score": 0, "last_activity_date": 1480017794, "creation_date": 1480000177, "question_id": 40789682, "link": "https://stackoverflow.com/questions/40789682/how-to-take-the-first-n-items-and-proceed-with-remaining-in-recursion", "title": "How to take the first n items and proceed with remaining in recursion?", "body": "<p>I want to achieve something like this:</p>\n\n<pre><code>f :: [Int] -&gt; [Int]\nf (x@[_,_,_,_]:xs) = g x : f xs\n\ng :: [Int] -&gt; Int\ng = ...\n</code></pre>\n\n<p>So I want to take the first four items in a list calculate something on them and then do the same thing with the remaining items creating a new list of calculated values. It is like a combination of map and take I guess. Is there something like this in haskell?</p>\n\n<p>I know I could do something like: </p>\n\n<pre><code>map g . chunksOf 4\n</code></pre>\n\n<p>I just thought it would look much more \"haskelly\" with recursion</p>\n"}, {"tags": ["sorting", "haskell"], "comments": [{"owner": {"reputation": 4589, "user_id": 5612096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51821186ffde540f4d10b86544ca1a7d?s=128&d=identicon&r=PG", "display_name": "Adirio", "link": "https://stackoverflow.com/users/5612096/adirio"}, "edited": false, "score": 1, "creation_date": 1479999097, "post_id": 40789334, "comment_id": 68800918, "body": "Not sure if you want Python or Haskell"}, {"owner": {"reputation": 31, "user_id": 7205710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e02fd310b546812bcf5b680f10934ff?s=128&d=identicon&r=PG&f=1", "display_name": "CreZce", "link": "https://stackoverflow.com/users/7205710/crezce"}, "reply_to_user": {"reputation": 4589, "user_id": 5612096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51821186ffde540f4d10b86544ca1a7d?s=128&d=identicon&r=PG", "display_name": "Adirio", "link": "https://stackoverflow.com/users/5612096/adirio"}, "edited": false, "score": 0, "creation_date": 1479999268, "post_id": 40789334, "comment_id": 68801029, "body": "@Adirio I want it Haskell"}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1479999835, "post_id": 40789365, "comment_id": 68801383, "body": "Or, if you want it point-free:  <code>sortBy (comparing sum) . map sort</code>."}, {"owner": {"reputation": 3967, "user_id": 3853711, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/SwXly.png?s=128&g=1", "display_name": "Rahn", "link": "https://stackoverflow.com/users/3853711/rahn"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1480000005, "post_id": 40789365, "comment_id": 68801478, "body": "@Zeta Thanks! That&#39;s more elegant."}], "tags": [], "owner": {"reputation": 3967, "user_id": 3853711, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/SwXly.png?s=128&g=1", "display_name": "Rahn", "link": "https://stackoverflow.com/users/3853711/rahn"}, "is_accepted": true, "score": 3, "last_activity_date": 1480001373, "last_edit_date": 1495542899, "creation_date": 1479999107, "answer_id": 40789365, "question_id": 40789334, "link": "https://stackoverflow.com/questions/40789334/how-do-i-sort-a-list-of-lists-by-their-sum-and-inner-elements/40789365#40789365", "title": "How do I sort a list of lists by their sum and inner elements?", "body": "<ol>\n<li>Sort sub-list: <code>map sort</code>. You get a list of sorted list</li>\n<li>Sort it by sum of sub-lsit <code>sortOn sum</code></li>\n</ol>\n\n<p><code>sortOn</code> is the counterpart of <code>sort(list, key=sum)</code> in Haskell:</p>\n\n<p><code>sortOn :: Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]</code></p>\n\n<p>Sorting:</p>\n\n<pre><code>import Data.List\n\ndoubleSort :: (Ord a, Num a) =&gt; [[a]] -&gt; [[a]]\ndoubleSort = sortOn sum . map sort\n</code></pre>\n\n<p>or</p>\n\n<pre><code>doubleSort dlist = sortOn sum (map sort dlist)\n</code></pre>\n\n<p>Thanks, <a href=\"https://stackoverflow.com/users/1139697/zeta\">Zeta</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 7205710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e02fd310b546812bcf5b680f10934ff?s=128&d=identicon&r=PG&f=1", "display_name": "CreZce", "link": "https://stackoverflow.com/users/7205710/crezce"}, "edited": false, "score": 0, "creation_date": 1480002005, "post_id": 40790062, "comment_id": 68802673, "body": "I think he just have his answer modified, a bit earlier than yours."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1480002682, "post_id": 40790062, "comment_id": 68803078, "body": "Keep in mind that <code>sortOn</code> is only available for GHC 7.10+ (base-4.8.0.0)."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1480013590, "post_id": 40790062, "comment_id": 68808278, "body": "&gt; 2016 &gt; use GHC below 7.10"}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 2, "last_activity_date": 1480001419, "last_edit_date": 1495535579, "creation_date": 1480001419, "answer_id": 40790062, "question_id": 40789334, "link": "https://stackoverflow.com/questions/40789334/how-do-i-sort-a-list-of-lists-by-their-sum-and-inner-elements/40790062#40790062", "title": "How do I sort a list of lists by their sum and inner elements?", "body": "<p>If you want to sort all inner lists then you can just apply <code>sort</code> function to each inner list, which is just <code>map sort</code> in <em>Haskell</em>.</p>\n\n<p>If you then want to sort all lists by some comparator, you can use very understandable function <code>sortBy</code>. But <code>sortBy</code> function example from <a href=\"https://stackoverflow.com/users/3853711/wentao\">wentao</a> answer is not efficient because it will calculate sum of each sublist every time. Instead it is better to use <code>sortOn</code> function which uses memoization of results. And it is even shorter. So correct solution is next:</p>\n\n<pre><code>import Data.List (sortOn)\n\nsumSort :: (Ord a, Num a) =&gt; [[a]] -&gt; [[a]]\nsumSort = sortOn sum . map sort\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7205710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e02fd310b546812bcf5b680f10934ff?s=128&d=identicon&r=PG&f=1", "display_name": "CreZce", "link": "https://stackoverflow.com/users/7205710/crezce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 0, "accepted_answer_id": 40789365, "answer_count": 2, "score": 2, "last_activity_date": 1480001419, "creation_date": 1479998998, "last_edit_date": 1479999616, "question_id": 40789334, "link": "https://stackoverflow.com/questions/40789334/how-do-i-sort-a-list-of-lists-by-their-sum-and-inner-elements", "title": "How do I sort a list of lists by their sum and inner elements?", "body": "<p>How do I sort <code>[[2,3,1], [0,0], [1,0,4,3]]</code> so that I get  <code>[[0,0], [1,2,3], [0,1,3,4]]</code>?</p>\n\n<p>I want to</p>\n\n<ol>\n<li>sort each sub-list and then</li>\n<li>sort total list by sum of their item</li>\n</ol>\n\n<p>I have some Python experience, and there are builtin-functions like <code>sort(list, key=sum)</code>. However, I don't know how to do the same in Haskell. Could someone help me out of here?</p>\n"}, {"tags": ["haskell", "functional-programming", "monads", "composition", "functor"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 4, "creation_date": 1479998469, "post_id": 40788848, "comment_id": 68800532, "body": "<code>fmap (map (&quot;http:&#47;&#47;www.google.com&#47;&quot; ++))  scrapeLink</code>, but you should probably have a look at the typeclassopedia. This question is more or less asking for a monad tutorial, which is off-topic on SO."}, {"owner": {"reputation": 319, "user_id": 4834745, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/447b4a70326df5c9f1c830b52ba4a1a3?s=128&d=identicon&r=PG&f=1", "display_name": "BourbonCreams", "link": "https://stackoverflow.com/users/4834745/bourboncreams"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1480014484, "post_id": 40788848, "comment_id": 68808616, "body": "That worked! I will look at some monad tutorials. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 1, "last_activity_date": 1506553199, "last_edit_date": 1506553199, "creation_date": 1480484850, "answer_id": 40881196, "question_id": 40788848, "link": "https://stackoverflow.com/questions/40788848/how-can-you-add-a-string-to-a-list-of-monads-in-haskell/40881196#40881196", "title": "How can you add a String to a list of Monads in Haskell", "body": "<p>You have</p>\n\n<pre><code>attrs \"href\" \"a\" :: Scraper String [String]\n</code></pre>\n\n<p>and </p>\n\n<pre><code>(\"http://www.google.com/\" ++) :: String -&gt; String\n</code></pre>\n\n<p>and you'd like to apply the latter to all the <code>String</code> elements in the former's result list.</p>\n\n<p>First of all, applying it to lists is a matter of</p>\n\n<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>so in your case, you have</p>\n\n<pre><code>map (\"http://www.google.com/\" ++) :: [String] -&gt; [String]\n</code></pre>\n\n<p>Which gets us one step closer.</p>\n\n<p>Now the next problem is that instead of a pure <code>[String]</code> value, you have a computation <code>Scraper String [String]</code>. However, <a href=\"https://hackage.haskell.org/package/scalpel-0.4.0/docs/Text-HTML-Scalpel.html#t:Scraper\" rel=\"nofollow noreferrer\"><code>Scraper str</code> is an instance of <code>Functor</code></a> for any choice of <code>str</code>, in particular, for <code>str ~ String</code>, i.e. <code>Scraper String</code> is a <code>Functor</code>.</p>\n\n<p>What that gives us is a way of applying pure functions to <code>Scraper String</code>s:</p>\n\n<pre><code>fmap :: (a -&gt; b) -&gt; Scraper String a -&gt; Scraper b\n</code></pre>\n\n<p>in particular, we have</p>\n\n<pre><code>fmap (map (\"http://www.google.com/\" ++)) :: Scraper String [String]\n</code></pre>\n\n<p>leading to</p>\n\n<pre><code>scrapeLink :: Scraper String [String]\nscrapeLink = fmap (map (\"http://www.google.com/\" ++)) (attrs \"href\" \"a\")\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 4834745, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/447b4a70326df5c9f1c830b52ba4a1a3?s=128&d=identicon&r=PG&f=1", "display_name": "BourbonCreams", "link": "https://stackoverflow.com/users/4834745/bourboncreams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 40881196, "answer_count": 1, "score": 1, "last_activity_date": 1506553199, "creation_date": 1479997542, "last_edit_date": 1480484909, "question_id": 40788848, "link": "https://stackoverflow.com/questions/40788848/how-can-you-add-a-string-to-a-list-of-monads-in-haskell", "title": "How can you add a String to a list of Monads in Haskell", "body": "<p>I am a new to functional programming. I am scraping a website using <a href=\"https://hackage.haskell.org/package/scalpel\" rel=\"nofollow noreferrer\">Scalpel</a> and I need to extract information from links contained in that website. What I can extrapolate though is just part of the link and I need to add to the String <code>\"http://www.google.com/\"</code> to each of these links. I can't do a normal <code>++</code> because I don't have a list of <code>String</code>s.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Text.HTML.Scalpel\n\nmain :: IO ()\nmain = do\n  res &lt;- scrapeURL \"http://www.whateverLink/\" scrapeComic\n  print res\n\nscrapeComic :: Scraper String [[String]]\nscrapeComic =\n  chroots (\"ul\" @: [\"id\" @= \"research-teachinglist\"]) scrapeLink\n\nscrapeLink :: Scraper String [String]\n-- This returns me the parts of the links I want \nscrapeLink = (attrs \"href\" \"a\")\n\n-- I tried this, but it doesn't work\n-- scrapeLink = mapM_ (\"http://www.google.com/\" ++) (attrs \"href\" \"a\")\n</code></pre>\n\n<p>Any ideas?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["haskell", "syntax", "gadt"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1479995108, "post_id": 40787526, "comment_id": 68798462, "body": "Excellent question. This is a pet peeve of mine -- I always wondered why we need to name the indexes when the names seem to be irrelevant elsewhere. This is very unlike indices vs parameters in the inductive types used in dependent systems like Agda/Coq for instance."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1479995515, "post_id": 40787526, "comment_id": 68798747, "body": "Note that, on the contrary, in type families we do have a difference between <code>type family A :: * -&gt; * -&gt; *</code> and <code>type family A a :: * -&gt; *</code> -- the first one allows instances like <code>A Int Bool = Char ; A Int Char = Bool</code> while the latter does not, only allowing e.g. <code>A Int = Maybe</code>. (the name <code>a</code> is still irrelevant, though in <code>type family A a :: * -&gt; *</code>)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1480018902, "post_id": 40787526, "comment_id": 68810193, "body": "...whereas <code>type family B b :: *</code> doesn&#39;t allow you to use e.g. <code>MaybeT B a</code>, which is possible with <code>type family B :: * -&gt; *</code>. The former would be a <a href=\"http://stackoverflow.com/a/4923883/745903\">partial type synonym application</a>. (<code>LiberalTypeSynonyms</code> can sometimes circumvent this restriction.)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1480035404, "post_id": 40787526, "comment_id": 68814513, "body": "There is a difference with <code>TypeInType</code> enabled - you cannot write e.g <code>X :: (a :: k) -&gt; P a -&gt; *</code> while <code>X (a :: k) (p :: P a)</code> is valid. There is also a difference in terms of which <i>kind</i> parameters are actually indices (again only with <code>TypeInType</code>) - the declaration <code>data X0 :: Fin n -&gt; * where X0 :: X0 Fz</code> is invalid (because the <code>n</code> is actually a parameter, and <code>X0</code> is not parametric in <code>n</code>), while <code>data X0 (q :: Fin n) where X0 :: X0 Fz</code> is valid. However, <code>data X0 :: forall n . Fin n -&gt; *</code> makes the <code>n</code> an index as well."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1480036231, "post_id": 40787526, "comment_id": 68814686, "body": "Here is another strange discrepancy.. with TypeInType enabled, <code>data X1 :: k -&gt; *</code> is parametric on the kind <code>k</code>, but without TypeInType, it is indexed on the kind <code>k</code>. And yet another... <code>data X2 :: forall k . k -&gt; forall k&#39; . k&#39; -&gt; *</code> and <code>data X2 :: forall k . k -&gt; forall k&#39; . k&#39; -&gt; *</code> have <i>completely different kinds</i> - the judgment <code>X1 ~ X2</code> is not even well typed! But it isn&#39;t even possible to express <code>X2</code> with the first syntax. Everywhere else in Haskell (except perhaps TypeApplications), the order of <code>forall</code> bound type variables does not matter."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1480069250, "post_id": 40787526, "comment_id": 68826169, "body": "@user2407038 Interesting. I&#39;m not too familiar with the consequences of <code>TypeInType</code>. You could turn your comments into an expanded answer."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1479995303, "post_id": 40788038, "comment_id": 68798604, "body": "Indeed, I like the first one the most, but always end up writing the second since it&#39;s shorter and I&#39;m lazy. I <i>guess</i> it could be useful for documentation to give them evocative names."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1479996239, "post_id": 40788038, "comment_id": 68799207, "body": "I prefer the second style because I don&#39;t like writing kind signatures."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1480017318, "post_id": 40788038, "comment_id": 68809615, "body": "I guess it would&#39;ve been possible to omit the type variables from the syntax, but then we would&#39;ve wanted partial kind signatures."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 8, "last_activity_date": 1479997824, "last_edit_date": 1479997824, "creation_date": 1479995117, "answer_id": 40788038, "question_id": 40787526, "link": "https://stackoverflow.com/questions/40787526/are-type-variables-in-gadt-heads-meaningful/40788038#40788038", "title": "Are type variables in GADT heads meaningful?", "body": "<p>There is no difference. One might think that not mentioning the type variables in the header would be needed to use different names for them in the constructor signatures, as in:</p>\n\n<pre><code>data A :: * -&gt; * -&gt; * where\n    AN :: Num x =&gt; x -&gt; b -&gt; A x b\n    AS :: IsString s =&gt; s -&gt; b -&gt; A s b\n</code></pre>\n\n<p>However, as <a href=\"https://downloads.haskell.org/~ghc/8.0.1/docs/html/users_guide/glasgow_exts.html#declaring-data-types-with-explicit-constructor-signatures\" rel=\"nofollow noreferrer\">the GHC Users Guide</a> says...</p>\n\n<blockquote>\n  <p>Unlike a Haskell-98-style data type declaration, the type variable(s) in the <code>data Set a where</code> header have no scope.</p>\n</blockquote>\n\n<p>... and so this also works:</p>\n\n<pre><code>data A a b where\n    AN :: Num x =&gt; x -&gt; b -&gt; A x b\n    AS :: IsString s =&gt; s -&gt; b -&gt; A s b\n</code></pre>\n"}], "owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 40788038, "answer_count": 1, "score": 8, "last_activity_date": 1479997824, "creation_date": 1479993677, "last_edit_date": 1479994106, "question_id": 40787526, "link": "https://stackoverflow.com/questions/40787526/are-type-variables-in-gadt-heads-meaningful", "title": "Are type variables in GADT heads meaningful?", "body": "<p>Is there a difference between these two GADT declarations?</p>\n\n<pre><code>data A a b where\n    ...\n\ndata A :: * -&gt; * -&gt; * where\n    ...\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 2, "creation_date": 1479978470, "post_id": 40781861, "comment_id": 68786979, "body": "It could be. The second type you provided is a more specific type than the inferred type, but it would be accepted. Similarly, Haskell will infer the type <code>a -&gt; a</code> for the function <code>f x = x</code>, but you could give it a more specific type like <code>Int -&gt; Int</code>, and it would be accepted."}, {"owner": {"reputation": 627, "user_id": 634615, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/5d0319056378070fa0eea3a731fb173c?s=128&d=identicon&r=PG", "display_name": "user634615", "link": "https://stackoverflow.com/users/634615/user634615"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1479978744, "post_id": 40781861, "comment_id": 68787144, "body": "I exptected type inference engine to derive the second type instead of first."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1479989214, "post_id": 40781861, "comment_id": 68794450, "body": "@user634615: why would it infer that the argument and result must be the same type, if that&#39;s not actually required for the definition? Mind, it doesn&#39;t infer that the types <i><b>must</b> be different</i>, just that they <i><b>can</b> be different</i>. You can still use this function in a context where the result happens to have the same type as the argument."}], "answers": [{"tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 6, "last_activity_date": 1479980665, "creation_date": 1479980665, "answer_id": 40782799, "question_id": 40781861, "link": "https://stackoverflow.com/questions/40781861/inferred-type-of-function-in-haskell/40782799#40782799", "title": "inferred type of function in Haskell", "body": "<p>The type <code>func :: (Ord a, Num a) =&gt; a -&gt; a</code> means that returned type should match with one you passed in. But since you are returning a constant and it doesn't depend on input, its type can be any type of class <code>Num</code>. Thus, compiler infers <code>func :: (Ord a, Num a, Num t) =&gt; a -&gt; t</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 4, "last_activity_date": 1479980707, "creation_date": 1479980707, "answer_id": 40782817, "question_id": 40781861, "link": "https://stackoverflow.com/questions/40781861/inferred-type-of-function-in-haskell/40782817#40782817", "title": "inferred type of function in Haskell", "body": "<p>The inferred type is correct. Let's see how it gets inferred. We will only look at the returned value first:</p>\n\n<pre><code>func x | \u2026 = 4\n       | \u2026 = error \"\u2026\"\n</code></pre>\n\n<p>The latter term, <code>error \"\u2026\" :: a</code>, is unconstrained. However, <code>4</code> has the type <code>Num a =&gt; a</code>, therefore your function will have type</p>\n\n<pre><code>func :: (Num result) =&gt; ????? -&gt; result\n</code></pre>\n\n<p>Now let's have a look at <code>x</code>:</p>\n\n<pre><code>func x | x &gt; 0 = \u2026\n       | \u2026   \n</code></pre>\n\n<p>Due to the use of <code>(&gt;) :: Ord a =&gt; a -&gt; a- &gt; Bool</code> and <code>0 :: Num a</code>, <code>x</code>'s has to be an instance of both <code>Num</code> and <code>Ord</code>. So from that point of perspective, we have</p>\n\n<pre><code>func :: (Num a, Ord a) =&gt; a -&gt; ????\n</code></pre>\n\n<p>The important part is that <code>4</code> and <code>x</code> don't interact. Therefore <code>func</code> has</p>\n\n<pre><code>func :: (Num a, Ord a, Num result) =&gt; a -&gt; result\n</code></pre>\n\n<p>Of course, <code>result</code> and <code>a</code> could be the same type. By the way, as soon as you connect <code>x</code> and <code>4</code>, the type will get more specific:</p>\n\n<pre><code>func x | x &gt; 0 = 4 + x - x\n       | \u2026\n</code></pre>\n\n<p>will have type <code>(Num a, Ord a) =&gt; a -&gt; a</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": false, "score": 2, "last_activity_date": 1479980840, "last_edit_date": 1495535418, "creation_date": 1479980840, "answer_id": 40782877, "question_id": 40781861, "link": "https://stackoverflow.com/questions/40781861/inferred-type-of-function-in-haskell/40782877#40782877", "title": "inferred type of function in Haskell", "body": "<p>As you may or may not be aware, <a href=\"https://stackoverflow.com/a/14667944/465378\">Haskell\u2019s numeric literals are polymorphic</a>. That means that a number literal, like <code>0</code> or <code>4</code>, has the type <code>Num a =&gt; a</code>. You seem to already understand this, since the type signature you expect includes a <code>Num</code> constraint.</p>\n\n<p>And indeed, the type signature you have provided <em>is</em> a valid one. If you included it, it would be accepted by the compiler, and if it\u2019s the type you actually want, by all means include it. However, the reason it is different from the inferred type is that Haskell will attempt to infer the <em>most general</em> type possible, and the inferred type is more general than the one you\u2019ve written.</p>\n\n<p>The question is, why is the inferred type permitted? Well, consider this similar but distinct function:</p>\n\n<pre><code>func' x | x &gt; 0 = \"ok\"\n        | otherwise = error \"Non positive number\"\n</code></pre>\n\n<p>This function\u2019s type is <code>(Ord a, Num a) =&gt; a -&gt; String</code>. Notably, the input of the function has absolutely no bearing on the output, aside from whether or not the result is \u22a5. For this reason, the result can be absolutely anything, including a string.</p>\n\n<p>However, consider yet another function, again similar but distinct:</p>\n\n<pre><code>func'' x | x &gt; 0 = x - 1\n         | otherwise = error \"Non positive number\"\n</code></pre>\n\n<p>This function <em>must</em> have the type you described, since it uses <code>x</code> to produce a new value.</p>\n\n<p>However, look again at the original <code>func</code> definition. Note how the literal on the right hand side, the <code>4</code>, does not have anything to do with <code>x</code>. That definition is actually quite a bit closer to <code>func'</code> than <code>func''</code>, so the numeric literal has the type <code>Num t =&gt; t</code>, and it never needs to be specialized. Therefore, the inferred type allows the two numeric types to be separate, and you have the more general type written in your question.</p>\n"}], "owner": {"reputation": 627, "user_id": 634615, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/5d0319056378070fa0eea3a731fb173c?s=128&d=identicon&r=PG", "display_name": "user634615", "link": "https://stackoverflow.com/users/634615/user634615"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1479980916, "creation_date": 1479978062, "last_edit_date": 1479980916, "question_id": 40781861, "link": "https://stackoverflow.com/questions/40781861/inferred-type-of-function-in-haskell", "title": "inferred type of function in Haskell", "body": "<p>I defined a function as follows in Haskell</p>\n\n<pre><code>func x | x &gt; 0 = 4\n       | otherwise = error \"Non positive number\"\n</code></pre>\n\n<p>Its inferred type is </p>\n\n<pre><code>func :: (Ord a, Num a, Num t) =&gt; a -&gt; t\n</code></pre>\n\n<p>Why can't its type be</p>\n\n<pre><code>func :: (Ord a, Num a) =&gt; a -&gt; a\n</code></pre>\n"}, {"tags": ["haskell", "list-comprehension", "pointfree"], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 5, "last_activity_date": 1479968634, "creation_date": 1479968634, "answer_id": 40779333, "question_id": 40779160, "link": "https://stackoverflow.com/questions/40779160/how-to-write-a-function-using-list-comprehension-in-haskell/40779333#40779333", "title": "how to write a function using list comprehension in haskell?", "body": "<p>You can't write it point-free using list comprehension:</p>\n\n<pre><code>alter xs = [if x == 0 then 1 else 0 | x &lt;- xs]\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 4501633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/62a9f530c8d8dc1ec09f6c442d0d74f9?s=128&d=identicon&r=PG&f=1", "display_name": "USERSFU", "link": "https://stackoverflow.com/users/4501633/usersfu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 40779333, "answer_count": 1, "score": 0, "last_activity_date": 1479993760, "creation_date": 1479967872, "last_edit_date": 1479976614, "question_id": 40779160, "link": "https://stackoverflow.com/questions/40779160/how-to-write-a-function-using-list-comprehension-in-haskell", "title": "how to write a function using list comprehension in haskell?", "body": "<p>I've written this function using <code>map</code>, but I need to write this using list comprehension: </p>\n\n<pre><code>alter = map (\\x -&gt; if x == 0 then 1 else 0)\n</code></pre>\n\n<p>it gives e.g. </p>\n\n<pre><code>alter [1,1,0]  \n&gt; [0,0,1]\n</code></pre>\n"}, {"tags": ["haskell", "tree"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1479953069, "post_id": 40776462, "comment_id": 68777597, "body": "Well... what&#39;s your proposal for doing it without recursion?"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 2, "creation_date": 1479953085, "post_id": 40776462, "comment_id": 68777603, "body": "It&#39;s really hard to explain why it&#39;s using recursion without falling back on &quot;What else could it do?&quot; unless you explain why you think it doesn&#39;t need recursion."}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 6, "last_activity_date": 1479954109, "creation_date": 1479954109, "answer_id": 40777121, "question_id": 40776462, "link": "https://stackoverflow.com/questions/40776462/tree-traversal-confusion/40777121#40777121", "title": "Tree traversal confusion?", "body": "<p>This may not be the simple explanation you were hoping for, but it may help to try working through a short example.  Read the following with pencil and paper handy and try to verify everything for yourself:</p>\n\n<pre><code>changeNode [L,R]\n  (Node 'A' (Node 'B' Empty (Node 'C' Empty Empty)) (Node 'D' Empty Empty))\n</code></pre>\n\n<p>I assume you'll agree that this <em>should</em> go left into the Node 'B' branch and then right into the Node 'C' branch, eventually replacing the 'C' with a 'P', right?</p>\n\n<p>How does it do this?  Well, the above expression matches the first pattern for changeNode, the one right after its type declaration.  Specifically, it matches with variable assignments: ds=[R], x='A', l=the whole Node 'B' branch, and r=the whole Node 'D' branch.  Therefore, we can rewrite it using the right hand side corresponding to that matching pattern.  The right hand side for the pattern is:</p>\n\n<pre><code>Node x (changeNode ds l) r\n</code></pre>\n\n<p>and substituting the matched variables gives:</p>\n\n<pre><code>Node 'A' (changeNode [R] (Node 'B' Empty (Node 'C' Empty Empty)))\n         (Node 'D' Empty Empty)    -- (1)\n</code></pre>\n\n<p>Now do you see what's happened?  The first pattern for changeNode operates by \"consuming\" the first letter of the direction list (which has changed from [L,R] to [R]) and sort of pushing the changeNode call down into the left branch.</p>\n\n<p>Now, concentrate on the value of this recursive changeNode call.  This time it matches the second pattern for changeNode (with ds=[], x='B', l=Empty, and r=(Node 'C' Empty Empty)).  The RHS for this pattern is:</p>\n\n<pre><code>Node x l (changeNode ds r)\n</code></pre>\n\n<p>which becomes (with the appropriate subtitutions):</p>\n\n<pre><code>Node 'B' Empty (changeNode [] (Node 'C' Empty Empty))\n</code></pre>\n\n<p>and substituting this value back into line (1), we get:</p>\n\n<pre><code>Node 'A' (Node 'B' Empty (changeNode [] (Node 'C' Empty Empty)))\n         (Node 'D' Empty Empty)   -- (2)\n</code></pre>\n\n<p>Again, see how this second call has consumed the 'R' from the direction vector and pushed the changeNode call into the right branch of Node 'B'.  Finally, what's the value of this last recursive changeNode call?  Well, it matches the third pattern with l=Empty and r=Empty giving the RHS value:</p>\n\n<pre><code>Node 'P' Empty Empty\n</code></pre>\n\n<p>and substituting in to line (2), we get:</p>\n\n<pre><code>Node 'A' (Node 'B' Empty (Node 'P' Empty Empty)) (Node 'D' Empty Empty)\n</code></pre>\n\n<p>which was exactly what we wanted.</p>\n\n<p>Contrast all this to what would have happened if the definition had been non-recursive:</p>\n\n<pre><code>changeNode' :: Directions -&gt; Tree Char -&gt; Tree Char\nchangeNode' (L : ds) (Node x l r) = Node x l r\nchangeNode' (R : ds) (Node x l r) = Node x l r\nchangeNode' [] (Node _ l r) = Node 'P' r l\n</code></pre>\n\n<p>In this case, our simple example would have matched the first pattern, again, with ds=[R], x='A', l=all of Node 'B' branch, r=all of Node 'D' branch, but instead of line (1), we would have used the non-recursive right hand side \"Node x l r\" to get the following in place of line (1):</p>\n\n<pre><code>Node 'A' (Node 'B' Empty (Node 'C' Empty Empty)) (Node 'D' Empty Empty)\n</code></pre>\n\n<p>See?  Without the recursive call, after changeNode' consumes the 'L', it's finished.  It returns the original tree with no further processing.  The recursive call is needed to keep the process moving along until the direction vector is empty and the third pattern (the only one that actually changes a node) can be applied at the right place in the tree.</p>\n\n<p>So, the short explanation (which doesn't really make sense until you've worked through the above example) is that the first two, recursive patterns for changeNode are used to move the changeNode call through the tree structure to the final target node where the final pattern is applied to change the node value.</p>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 40777121, "answer_count": 1, "score": 2, "last_activity_date": 1479954109, "creation_date": 1479948394, "last_edit_date": 1479951669, "question_id": 40776462, "link": "https://stackoverflow.com/questions/40776462/tree-traversal-confusion", "title": "Tree traversal confusion?", "body": "<p>I have the following data type (source: <a href=\"http://learnyouahaskell.com/zippers\" rel=\"nofollow noreferrer\">http://learnyouahaskell.com/zippers</a>):</p>\n\n<pre><code>data Tree a = Empty | Node a (Tree a) (Tree a) deriving (Show, Eq, Ord)\n</code></pre>\n\n<p>I then have the following function, that traverses the tree and replaces a Node based on directional instructions:</p>\n\n<pre><code>data Direction = L | R deriving (Show, Eq, Ord)\ntype Directions = [Direction]\n\nchangeNode :: Directions -&gt; Tree Char -&gt; Tree Char\nchangeNode (L : ds) (Node x l r) = Node x (changeNode ds l) r\nchangeNode (R : ds) (Node x l r) = Node x l (changeNode ds r)\nchangeNode [] (Node _ l r) = Node 'P' r l\n</code></pre>\n\n<p>However I don't understand this aspect of the function:</p>\n\n<pre><code>changeNode (L : ds) (Node x l r) = Node x (changeNode ds l) r\n</code></pre>\n\n<p>I see that this is using recursion (changeNode ds l), but I don't understand <strong>why</strong> this is using recursion.</p>\n\n<p>Does anyone have a simple explanation? </p>\n"}, {"tags": ["haskell", "custom-data-type"], "comments": [{"owner": {"reputation": 181, "user_id": 4633831, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cc93c4479491b84c5a3d1ebcb3fdd68?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Wilson", "link": "https://stackoverflow.com/users/4633831/danny-wilson"}, "edited": false, "score": 1, "creation_date": 1479948951, "post_id": 40776444, "comment_id": 68776620, "body": "Could you not just use ++? You are already using a Haskell list in your definition, so if you gave <code>(&#39;a&#39;, [&quot;1&quot;,&quot;2&quot;])</code> as a list, e.g. <code>[(&#39;a&#39;, [&quot;1&quot;,&quot;2&quot;])]</code>, then your function can just take the two lists, use ++, and return a new list that will contain both.   <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html</a>"}, {"owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "reply_to_user": {"reputation": 181, "user_id": 4633831, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cc93c4479491b84c5a3d1ebcb3fdd68?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Wilson", "link": "https://stackoverflow.com/users/4633831/danny-wilson"}, "edited": false, "score": 0, "creation_date": 1479955528, "post_id": 40776444, "comment_id": 68778159, "body": "@DannyWilson, sorry probably I didn&#39;t formulate the question right, the add function receives element and a List (LT) and not exactly a tuple and a list, so ++ doesn&#39;t work."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1479993068, "post_id": 40776444, "comment_id": 68797062, "body": "You example should then be <code>add &#39;a&#39; [(&#39;x&#39;, [&quot;1&quot;])]</code>. It&#39;s not clear what list should be associated with <code>&#39;a&#39;</code> in the result, though. Is it just the same list associated with the previous last value, but with one more number-turned-string added to the end?"}], "answers": [{"comments": [{"owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "edited": false, "score": 0, "creation_date": 1479955966, "post_id": 40777291, "comment_id": 68778271, "body": "It kind of does,  here is what I tried to do <code>add:: Ord a =&gt; a -&gt; List a -&gt; List a</code>    <code>add _ (LT[]) = empty</code>    <code>add x (LT(y:ys))</code>    <code>| belongs x (LT(y:ys)) = (LT(y:ys))</code>    <code>| otherwise = (LT(y:ys)) ++ (LT(x))</code>  But it doesn&#39;t work (<code>belongs</code> and <code>empty</code> are two functions I made)."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "edited": false, "score": 0, "creation_date": 1479956143, "post_id": 40777291, "comment_id": 68778337, "body": "Yeah, there&#39;s a type error at <code>LT(x)</code>, because <code>x</code> isn&#39;t a list.  Try <code>LT [x]</code> (making it into a one-element list first, and we never needed parentheses there).   Note that the way this is specified, adding something to an empty list will always be empty, which ... doesn&#39;t quite seem right.  But your first goal should be to get it to compile without type errors."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "edited": false, "score": 0, "creation_date": 1479956264, "post_id": 40777291, "comment_id": 68778366, "body": "Oh there&#39;s another type error when you say <code>(LT ...) ++ (LT ...)</code>. <code>++</code> takes two haskell lists, not two of your <code>List</code>s (which are made with <code>LT</code>).  You need to put the <code>++</code> <i>inside</i> the <code>LT</code> constructor."}, {"owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "edited": false, "score": 0, "creation_date": 1479956500, "post_id": 40777291, "comment_id": 68778428, "body": "Like this <code>(LT (y:ys) ++ x)</code>??"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "edited": false, "score": 0, "creation_date": 1479956590, "post_id": 40777291, "comment_id": 68778455, "body": "<code>LT ((y:ys) ++ [x])</code>.  Function application (what <code>LT</code> is doing) is tighter than any other operator, so it only applies to <code>(y:ys)</code> and not the <code>++ x</code> part.  And we needed to make a singleton list out of <code>x</code> like I keep saying"}, {"owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "edited": false, "score": 0, "creation_date": 1479956786, "post_id": 40777291, "comment_id": 68778510, "body": "Still doesn&#39;t work... this is what shows up <code>Couldn&#39;t match expected type \u2018[(a, [String])]\u2019 with actual type \u2018a\u2019</code>."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "edited": false, "score": 0, "creation_date": 1479957005, "post_id": 40777291, "comment_id": 68778559, "body": "Yeah, your type signature is wrong.  You don&#39;t seem to have any idea what you&#39;re doing, you&#39;re just trying things randomly.   Back up to earlier in a tutorial (e.g. <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow noreferrer\">LYAH</a>) or ask your professor for help if you&#39;re in a class.  This problem is currently too hard for you."}, {"owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "edited": false, "score": 0, "creation_date": 1479957248, "post_id": 40777291, "comment_id": 68778612, "body": "Yup, I&#39;ve been trying to figure it out using that book learnyouahaskell.com, but it came to random tries, type signature was given by the professor as the data type, just wanted to figure it out to work with data types and how I can &quot;access&quot; the elements in it. But thanks anyway."}, {"owner": {"reputation": 181, "user_id": 4633831, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cc93c4479491b84c5a3d1ebcb3fdd68?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Wilson", "link": "https://stackoverflow.com/users/4633831/danny-wilson"}, "edited": false, "score": 1, "creation_date": 1479981976, "post_id": 40777291, "comment_id": 68789360, "body": "Just to clear things up, your data type and type signature are very different things. Your data type is <code>data List x = LT [(x,[String])]</code>, which defines the data you want to process, kind of like an object in OO. Think of it like this, you have the data type <code>data Circle = Float Float Float</code>, which defines a circle with 3 float values. Then, when you wish to operate on it, you write a function. The first line is the Type Definition. So, e.g., <code>addInts :: Int -&gt; Int -&gt; Int</code>, which takes two ints and returns an Int. If you&#39;re unsure about the type, leave the line out..."}, {"owner": {"reputation": 181, "user_id": 4633831, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cc93c4479491b84c5a3d1ebcb3fdd68?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Wilson", "link": "https://stackoverflow.com/users/4633831/danny-wilson"}, "edited": false, "score": 0, "creation_date": 1479982031, "post_id": 40777291, "comment_id": 68789407, "body": "Let Haskell guess, which most of the time it will be able to. This will get you past your error, then call <code>:t addInts</code>, and it will tell you the type signature of <code>addInt :: Int -&gt; Int -&gt; Int</code>."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 1, "last_activity_date": 1479955505, "creation_date": 1479955505, "answer_id": 40777291, "question_id": 40776444, "link": "https://stackoverflow.com/questions/40776444/work-with-custom-data-type-haskell/40777291#40777291", "title": "Work with custom data type haskell", "body": "<p>As Danny Wilson pointed out, you can use the <code>++</code> operator to concatenate two lists:</p>\n\n<pre><code>ghci&gt; [1,2] ++ [3,4]\n[1,2,3,4]\n</code></pre>\n\n<p>Do keep in mind that both sides of a <code>++</code> need to be lists, and you have one list and one non-list, so you'll need to make one of those into a list first.</p>\n\n<p>I have a wild guess based on some details in your phrasing that you are having trouble with data constructors.  A <code>List x</code> does not take the form</p>\n\n<pre><code>[('x',[\"1\"])]\n</code></pre>\n\n<p>But rather</p>\n\n<pre><code>LT [('x',[\"1\"])]\n</code></pre>\n\n<p>which is just a regular list \"wrapped\" with the <code>LT</code> <em>constructor</em>.  If you want to write a function <code>add</code>, you need to pattern match on this constructor.  Every value of type <code>List</code> \"starts with\" <code>LT</code>:</p>\n\n<pre><code>add :: (x, [String]) -&gt; List x -&gt; List x\nadd elem (LT list) = LT (...)\n</code></pre>\n\n<p>(You need to fill in the <code>...</code> yourself)</p>\n\n<p>You only need to put the <code>LT</code> when you need to access the guts of the type, the list inside.  So this function returns the list unmodified, and it does not need the <code>LT</code>:</p>\n\n<pre><code>doNothing :: List x -&gt; List x\ndoNothing a = a\n</code></pre>\n\n<p>But as soon as you need to know that a <code>List x</code> is represented by a list of some stuff, you need to use the <code>LT</code> constructor.</p>\n\n<p>Does that help?</p>\n"}], "owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1485, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1479956372, "creation_date": 1479948176, "last_edit_date": 1479956372, "question_id": 40776444, "link": "https://stackoverflow.com/questions/40776444/work-with-custom-data-type-haskell", "title": "Work with custom data type haskell", "body": "<p>I've this data type <code>data List x = LT [(x,[String])]</code>\nand I'm been trying to create a function that would add a new element to the <code>List</code>.</p>\n\n<p>For example by using function <code>add</code>:</p>\n\n<p><code>add ('a', [\"1\",\"2\"]) [('x',[\"1\"])]</code></p>\n\n<p>result would be:</p>\n\n<p><code>[('x',[\"1\"]), ('a', [\"1\",\"2\"])]</code></p>\n\n<p>It doesn't matter what is the order.\nI've tried a lot, still don't understand much.</p>\n\n<p>This is what I tried</p>\n\n<pre><code>`add:: Ord a =&gt; a -&gt; List a -&gt; List a \n add _ (LT[]) = empty \n add x (LT(y:ys))\n     | belongs x (LT(y:ys)) = (LT(y:ys)) \n     | otherwise = (LT(y:ys)) ++ (LT(x))`\n</code></pre>\n\n<p>Can someone help?\nThanks in advance.</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"tags": [], "owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "is_accepted": true, "score": 2, "last_activity_date": 1479946004, "creation_date": 1479946004, "answer_id": 40776168, "question_id": 40776167, "link": "https://stackoverflow.com/questions/40776167/with-yesod-how-can-one-send-defaultlayout-with-a-custom-http-status-code/40776168#40776168", "title": "With yesod, how can one send defaultLayout with a custom HTTP status code?", "body": "<p>It turns out that <code>sendResponseStatus</code> is not expecting <code>Handler Html</code>, but plain <code>Html</code> works instead: </p>\n\n<pre><code>html &lt;- defaultLayout [whamlet|Foo|]\nsendResponseStatus status403 html\n</code></pre>\n\n<p>Which compiles and executes as expected for me.</p>\n\n<p>It may also make sense to encapsulate this logic as such:</p>\n\n<pre><code>sendResponseStatusHandler :: (ToTypedContent c, MonadHandler m) =&gt; Status -&gt; m c -&gt; m b\nsendResponseStatusHandler status handler = do\n  response &lt;- handler\n  sendResponseStatus status response\n</code></pre>\n\n<p>Since being able to pass in a <code>Handler</code> seems quite a bit more powerful to me.</p>\n"}], "owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 40776168, "answer_count": 1, "score": 1, "last_activity_date": 1479946004, "creation_date": 1479946004, "question_id": 40776167, "link": "https://stackoverflow.com/questions/40776167/with-yesod-how-can-one-send-defaultlayout-with-a-custom-http-status-code", "title": "With yesod, how can one send defaultLayout with a custom HTTP status code?", "body": "<p>I've tried the following:</p>\n\n<pre><code>sendResponseStatus status403 $ (defaultLayout [whamlet|Foo|] :: Handler Html)\n</code></pre>\n\n<p>Which gives me this type error:</p>\n\n<pre><code>&lt;interactive&gt;:1:1: Warning:\n    Could not deduce (ToTypedContent (Handler Html))\n      arising from a use of \u2018sendResponseStatus\u2019\n    from the context (MonadHandler m)\n      bound by the inferred type of it :: MonadHandler m =&gt; m a\n      at &lt;interactive&gt;:1:1\n    In the expression: sendResponseStatus status403\n    In the expression:\n      sendResponseStatus status403\n      $ (defaultLayout\n           ((asWidgetT . toWidget)\n              ((blaze-markup-0.7.0.3:Text.Blaze.Internal.preEscapedText\n                . Data.Text.pack)\n                 \"Foo\")) ::\n           Handler Html)\n</code></pre>\n"}]