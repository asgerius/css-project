[{"tags": ["haskell", "types", "dsl", "gadt"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1456953946, "post_id": 35757157, "comment_id": 59190168, "body": "<code>mean &quot;a&quot;</code> typechecks just fine with this code, and the inferred type of the <code>&quot;a&quot;</code> is precisely <code>Column &#39;Selection</code>. Then the type of <code>Select [mean &quot;a&quot;]</code> is <code>Query b -&gt; Query &#39;Selection</code>. If something doesn&#39;t work, please include precisely which expression causes the ambiguity and what the actual error is. You have not defined <code>from</code> or <code>tbl</code> anywhere, so perhaps the error is related to those functions."}, {"owner": {"reputation": 705, "user_id": 1121705, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c723ca9f7ba138b9df58d93e100d7146?s=128&d=identicon&r=PG", "display_name": "Brandon Ogle", "link": "https://stackoverflow.com/users/1121705/brandon-ogle"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1456955474, "post_id": 35757157, "comment_id": 59191040, "body": "right but <code>select [&quot;a&quot;] $ from tbl</code> does <i>not</i> typecheck."}, {"owner": {"reputation": 705, "user_id": 1121705, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c723ca9f7ba138b9df58d93e100d7146?s=128&d=identicon&r=PG", "display_name": "Brandon Ogle", "link": "https://stackoverflow.com/users/1121705/brandon-ogle"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1456955792, "post_id": 35757157, "comment_id": 59191215, "body": "<code>from = Table</code> and <code>tbl = Schema {name= Just &quot;tbl&quot;, spec= [Column &quot;a&quot;, Column &quot;b&quot;]}</code>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1456956392, "post_id": 35757157, "comment_id": 59191541, "body": "Perhaps: <code>select :: [Column Selection] -&gt; Query b -&gt; Query Selection; reduce :: [Column Reduction] -&gt; Query b -&gt; Query Selection; select = Select; reduce = Select</code>."}], "answers": [{"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 6, "last_activity_date": 1456983336, "last_edit_date": 1456983336, "creation_date": 1456956508, "answer_id": 35759128, "question_id": 35757157, "link": "https://stackoverflow.com/questions/35757157/how-to-resolve-ambiguity-in-my-gadts/35759128#35759128", "title": "How to resolve ambiguity in my GADTs", "body": "<p>The compiler is correct to give you an ambiguous type error for <code>Select [\"a\"]</code> - the <code>IsString (Column Selection)</code> instance can be chosen <em>only</em> if <em>a priori</em> the argument to <code>Column</code> is known to be <code>Selection</code>. This is exactly the intended behaviour.</p>\n\n<p>What you want is the following:</p>\n\n<pre><code>instance (x ~ Selection) =&gt; IsString (Column x) where\n    fromString = Column \n</code></pre>\n\n<p>This will allow the compiler to infer that <code>\"x\" :: Column _</code> must actually be <code>\"x\" :: Column Selection</code>, as opposed to <em>requiring</em> it. </p>\n\n<p><code>Select [mean \"a\"]</code> is a completely different situation - since <code>mean :: Column Selection -&gt; Column Reduction</code>, the compiler knows, before instance selection happens, that <code>\"a\" :: Column Selection</code>, because the type of <code>mean</code> forces this to be the case. </p>\n"}], "owner": {"reputation": 705, "user_id": 1121705, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c723ca9f7ba138b9df58d93e100d7146?s=128&d=identicon&r=PG", "display_name": "Brandon Ogle", "link": "https://stackoverflow.com/users/1121705/brandon-ogle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 1, "accepted_answer_id": 35759128, "answer_count": 1, "score": 9, "last_activity_date": 1456983336, "creation_date": 1456949479, "last_edit_date": 1456974305, "question_id": 35757157, "link": "https://stackoverflow.com/questions/35757157/how-to-resolve-ambiguity-in-my-gadts", "title": "How to resolve ambiguity in my GADTs", "body": "<p>I have two GADTs I am using to model a SQL EDSL. To keep the client facing api clean and simple I want to use <code>OverloadedStrings</code> to cast string literals to a <code>Column Selection</code>. </p>\n\n<p>Therefore you can simply type</p>\n\n<pre><code>select [\"a\", \"b\"] $ from tbl\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>select [Column \"a\", Column \"b\"] $ from tbl\n</code></pre>\n\n<p>The problem is that select allows for both <code>Column Selection</code>s and <code>Reduction</code>s\nto allow for queries that perform aggregations. </p>\n\n<pre><code>mean :: Column Selection -&gt; Column Reduction\n\nselect :: [Column a] -&gt; Query b -&gt; Query Selection\nselect [mean \"a\"] $ from tbl\n</code></pre>\n\n<p>and thus the strings are ambiguous in this context of <code>[Column a]</code>.\nBut <code>select [mean \"a\"] $ from tbl</code> is valid since <code>mean</code> provides the necessary context to infer that the string literal is a Column Selection. </p>\n\n<p>Can anyone recommend a way out of this mess?</p>\n\n<p><strong>My current code below (irrelevant instances omitted)</strong></p>\n\n<pre><code>{-# LANGUAGE \n    GADTs\n  , RankNTypes\n  , DataKinds\n  , TypeFamilies\n  , FlexibleContexts\n  , FlexibleInstances\n  , OverloadedStrings #-}\n\ndata Sz = Selection | Reduction deriving Show\ndata Schema = Schema{name :: Maybe String, spec :: [Column Selection]} \n\ntype family ColOp (a :: Sz) (b :: Sz) where\n    ColOp Selection Selection = Selection\n    ColOp Selection Reduction = Selection\n    ColOp Reduction Selection = Selection\n    ColOp Reduction Reduction = Reduction\n\ndata Column (a :: Sz) where\n    Column  :: String -&gt; Column Selection\n    Assign  :: String -&gt; Column a -&gt; Column a\n    FKey    :: String -&gt; Schema -&gt; Column Selection\n    BinExpr :: BinOp  -&gt; Column a -&gt; Column b -&gt; Column (ColOp a b)\n    LogExpr :: LogOp  -&gt; Column a -&gt; Column b -&gt; Column Selection\n    AggExpr :: AggOp  -&gt; Column Selection -&gt; Column Reduction\n\ninstance IsString (Column Selection) where\n    fromString s = Column s\n\ndata Query (a :: Sz) where\n    Table  :: Schema -&gt; Query Selection\n    Select :: [Column a] -&gt; Query b -&gt; Query Selection\n    Update :: [Column a] -&gt; Query b -&gt; Query Selection\n    Where  :: [Column Selection] -&gt; Query Selection -&gt; Query Selection\n    Group  :: [Column Selection] -&gt; Query Selection -&gt; Query Reduction\n</code></pre>\n\n<p>I would also like to make the following signature fail for <code>Select</code>/<code>Update</code>:</p>\n\n<pre><code>[Column Selection] -&gt; Query Reduction -&gt; Query Selection\n</code></pre>\n\n<p>But that's a whole other can of worms...</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1456946830, "post_id": 35756175, "comment_id": 59185960, "body": "The version appears to be a number. But versions in general are strings, not numbers. What are you going to do about something at version 1.2.3A?"}, {"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 1, "creation_date": 1456947227, "post_id": 35756175, "comment_id": 59186188, "body": "If you know the key before you start parsing, you could define a function that takes the key in as a parameter and returns the parser."}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 3, "last_activity_date": 1456947809, "creation_date": 1456947809, "answer_id": 35756642, "question_id": 35756175, "link": "https://stackoverflow.com/questions/35756175/parse-json-with-aeson-when-first-key-is-variable/35756642#35756642", "title": "parse json with aeson when first key is variable", "body": "<p>JSON objects in Aeson are just hash maps.  You can extract all the keys if you desire.  In this case you can't have a datatype with a field named after your JSON key because that isn't consistent, but you can still parse and use the JSON just fine.  Untested code follows.</p>\n\n<pre><code>import Data.Aeson\nimport Data.Text (Text)\nimport Data.HashMap.Strict as HMap\n\nparseMyJSON :: Value -&gt; Parser (Text,Value)\nparseMyJSON (Object v) =\n     case HMap.toList v of\n        [(k,v)] -&gt; (k, v)\n        _       -&gt; fail \"More than one key - who sent this thing?\"\nparseMyJSON _ = fail \"Incorrect JSON - expected an object.\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 143, "user_id": 907035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba2647baa2c0c947164ab1219c6de590?s=128&d=identicon&r=PG", "display_name": "Jeffery Utter", "link": "https://stackoverflow.com/users/907035/jeffery-utter"}, "edited": false, "score": 0, "creation_date": 1464150868, "post_id": 35756748, "comment_id": 62360372, "body": "Hi. Thanks for this reply. I am new to haskell and have been fighting neary this exact problem for a couple days (Except I am using YAML). I seem to be running into a problem with the types of v and v2. Any chance you could offer some pointers? Code and errors over at this <a href=\"https://gist.github.com/jeffutter/4133c49d8dd52ce36d8efb0b6be8ac4f\" rel=\"nofollow noreferrer\">gist</a>. Thanks"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "reply_to_user": {"reputation": 143, "user_id": 907035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba2647baa2c0c947164ab1219c6de590?s=128&d=identicon&r=PG", "display_name": "Jeffery Utter", "link": "https://stackoverflow.com/users/907035/jeffery-utter"}, "edited": false, "score": 0, "creation_date": 1464200151, "post_id": 35756748, "comment_id": 62391737, "body": "There are a number of things going on here. First, my mistake, I forgot that H.mapWithKey returns a new hashmap, not a list, and also that Aeson uses strict hashmaps. See the updated text above, including the change to parseItem. Apart from that, the code in your Gist seems to be parsing groups that have a &quot;name&quot; field in the object rather than the variable key you described, so this isn&#39;t solving your problem."}, {"owner": {"reputation": 143, "user_id": 907035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba2647baa2c0c947164ab1219c6de590?s=128&d=identicon&r=PG", "display_name": "Jeffery Utter", "link": "https://stackoverflow.com/users/907035/jeffery-utter"}, "edited": false, "score": 0, "creation_date": 1464221611, "post_id": 35756748, "comment_id": 62400818, "body": "Thanks for the update. Its starting to make sense now and nearly works. I&#39;ve updated the gist and added sample YAML. I&#39;m getting some error about something expecting a group but is getting a list instead."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "reply_to_user": {"reputation": 143, "user_id": 907035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba2647baa2c0c947164ab1219c6de590?s=128&d=identicon&r=PG", "display_name": "Jeffery Utter", "link": "https://stackoverflow.com/users/907035/jeffery-utter"}, "edited": false, "score": 1, "creation_date": 1464285259, "post_id": 35756748, "comment_id": 62434339, "body": "You need to make it &quot;instance FromJSON [Group] where&quot;. You will need to enable FlexibleInstances for this."}], "tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 6, "last_activity_date": 1464200046, "last_edit_date": 1464200046, "creation_date": 1456948160, "answer_id": 35756748, "question_id": 35756175, "link": "https://stackoverflow.com/questions/35756175/parse-json-with-aeson-when-first-key-is-variable/35756748#35756748", "title": "parse json with aeson when first key is variable", "body": "<p>First, you need to declare a data type that models what your data actually is. I presume that the \"NW011\" is effectively acting as a kind of field, albeit one that the JSON format in question has promoted to look like a record name. So:</p>\n\n<pre><code>data Thing = Thing {\n   thingName :: Text,  -- E.g. \"NW011\"\n   thingVersion :: Text, -- I'm assuming that \"Version\" could include \"1.2.3A\" and hence should be a string, not a number.\n   thingCompatible :: [Text],\n   thingDescription :: Text\n}\n</code></pre>\n\n<p>Now the instance. Normally when you parse JSON you would have an object with fixed field names, so you can use \".:\" to extract them. In this case your outermost structure is a one-field object, where the field is called \"NW011\" and contains a more traditional object.</p>\n\n<p>So you need to write an instance that retrieves this raw object. I'll assume that you could have several such objects with different names like \"NW012\" etc, so actually your outer structure is a list of these things. If you parse the example you gave then you will get a one-element list.</p>\n\n<p>In Aeson an \"Object\" is a wrapper around a look-up table (i.e. a HashMap). So all you need to do is iterate through the HashMap extracting the objects by name. So the answer should look something like this (although I haven't tried compiling it):</p>\n\n<pre><code>import qualified Data.HashMap.Strict as H\n\ninstance FromJSON [Thing] where\n   parseJSON (Object v) = mapM parseItem $ H.toList v\n      -- 'v' is a HashMap containing a key \"NW011\".\n   where\n      parseItem (k, Object v2) = \n         -- \"v2\" is a HashMap containing keys for the fixed field names (\"version\" etc.)\n         Thing k &lt;$&gt; \n         v .: \"version\" &lt;*&gt;\n         v .: \"compatiblehardware\" &lt;*&gt;\n         v .: \"description\"\n</code></pre>\n\n<p>Note that this just gives the success cases. Your code should also include cases where the arguments to parseJSON and parseItem are not objects.</p>\n"}, {"tags": [], "owner": {"reputation": 1369, "user_id": 509928, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57d816a396798416d079c92adbabdbf3?s=128&d=identicon&r=PG", "display_name": "Dave Compton", "link": "https://stackoverflow.com/users/509928/dave-compton"}, "is_accepted": true, "score": 1, "last_activity_date": 1456975600, "creation_date": 1456975600, "answer_id": 35762627, "question_id": 35756175, "link": "https://stackoverflow.com/questions/35756175/parse-json-with-aeson-when-first-key-is-variable/35762627#35762627", "title": "parse json with aeson when first key is variable", "body": "<p>You can parse your JSON as a (Map Text Thing) where Thing is your record type.  Tested code follows:</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\n\nimport Data.ByteString.Lazy as BSL\nimport Data.Text (Text)\nimport Data.Aeson \nimport Data.Map (Map)\nimport GHC.Generics\n\n-- Record representing a single thing\ndata Thing =\n    Thing { \n        version             :: Float,\n        compatiblehardware  :: [Text],\n        description         :: Text\n    } deriving (Show, Generic)\n\ninstance FromJSON Thing\n\nmain :: IO()\nmain = do\n    inh &lt;- BSL.readFile \"json.txt\" \n    case decode inh :: Maybe (Map Text Thing) of\n        Just parsed -&gt; print parsed\n        Nothing -&gt; print \"Unparsable\"\n</code></pre>\n\n<p>Here's the test data, \"json.txt\":</p>\n\n<pre><code>{\n   \"NW011\": {\n        \"version\": 1.0,\n        \"compatiblehardware\": [\"N21\"],\n        \"description\": \"TWIN\"\n   },\n   \"NW012\": {\n        \"version\": 2.4,\n        \"compatiblehardware\": [\"N21\", \"N22\"],\n        \"description\": \"TURBO\"\n   }\n}\n</code></pre>\n"}], "owner": {"reputation": 2963, "user_id": 1528246, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/f76f3e46a94eb011d85d14bf54425950?s=128&d=identicon&r=PG", "display_name": "rogergl", "link": "https://stackoverflow.com/users/1528246/rogergl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 736, "favorite_count": 0, "accepted_answer_id": 35762627, "answer_count": 3, "score": 2, "last_activity_date": 1464200046, "creation_date": 1456946193, "question_id": 35756175, "link": "https://stackoverflow.com/questions/35756175/parse-json-with-aeson-when-first-key-is-variable", "title": "parse json with aeson when first key is variable", "body": "<p>My json looks like this</p>\n\n<pre><code>{\n    \"NW011\": {\n        \"version\": 1.0,\n        \"compatiblehardware\": [\"N21\"],\n        \"description\": \"TWIN\"\n   }\n}\n</code></pre>\n\n<p>The problem is that the key NW011 is variable. I know this key when I start parsing but I have no idea how to declare the data type and instance for aeson.</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 0, "creation_date": 1456947393, "post_id": 35756153, "comment_id": 59186297, "body": "Please post your cabal file and the exact command that Travis is running."}, {"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "reply_to_user": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 0, "creation_date": 1456947667, "post_id": 35756153, "comment_id": 59186456, "body": "@WillSewell, Added commands that are run on the CI server. What do you expect to figure out from cabal file?"}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1456960897, "post_id": 35756153, "comment_id": 59193565, "body": "Travis can work with stack, btw."}, {"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1456980028, "post_id": 35756153, "comment_id": 59199446, "body": "@PyRulez, Of course it can, but I need make sure it builds even with Cabal."}], "answers": [{"comments": [{"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 0, "creation_date": 1456984422, "post_id": 35757030, "comment_id": 59200898, "body": "No way. It doesn&#39;t work for me. Results are printed only when entire test suite finishes."}, {"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "reply_to_user": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 0, "creation_date": 1456993460, "post_id": 35757030, "comment_id": 59205440, "body": "Where did you set the <code>-threaded</code> flag? And what do you see if you run the same commands that are run on Travis locally?"}, {"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 0, "creation_date": 1456994430, "post_id": 35757030, "comment_id": 59206037, "body": "In <code>ghc-options: -threaded</code> in cabal file, test suite section. This may be just something related to Travis, maybe it has something to do with buffering, I don&#39;t know. To test this locally I need to setup the whole sandbox thing. I will do this if <code>travis_wait</code> does not work for me. This problem has already caused painful delay in my work, so if <code>travis_wait</code> works out, I won&#39;t spend any extra minute thinking what&#39;s wrong with Cabal this time, enough of this hairy stuff. I accept your answer, I think it&#39;s correct in general."}, {"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "reply_to_user": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 0, "creation_date": 1456998219, "post_id": 35757030, "comment_id": 59208666, "body": "Thanks. <code>travis_wait</code> should do it, but it&#39;s a shame that it doesn&#39;t fix the root of the problem. I think the only way to narrow it down further would be to try and reproduce it locally. Good luck."}], "tags": [], "owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "is_accepted": true, "score": 1, "last_activity_date": 1456949103, "creation_date": 1456949103, "answer_id": 35757030, "question_id": 35756153, "link": "https://stackoverflow.com/questions/35756153/is-there-a-way-to-make-cabal-print-test-cases-in-real-time/35757030#35757030", "title": "Is there a way to make Cabal print test cases in real time?", "body": "<p>It looks like you aren't compiling your program with the <code>-threaded</code> flag. This is required, otherwise it will behave as if you had set <code>--show-details=always</code>, even if you had set <code>--show-details=streaming</code>.</p>\n\n<p>The reason I wanted to look at your cabal file is you might have set <code>-threaded</code> there.</p>\n"}], "owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 35757030, "answer_count": 1, "score": 0, "last_activity_date": 1456949103, "creation_date": 1456946141, "last_edit_date": 1456948115, "question_id": 35756153, "link": "https://stackoverflow.com/questions/35756153/is-there-a-way-to-make-cabal-print-test-cases-in-real-time", "title": "Is there a way to make Cabal print test cases in real time?", "body": "<p>When I use stack locally with test suite (Hspec), it prints tests cases\n(their names, contexts) in real time. Now I need to force this behavior on\nTravis CI (where I use Cabal) because my test suite has begun to take\nlonger than 10 minutes and I end up with:</p>\n\n<blockquote>\n  <p>No output has been received in the last 10 minutes, this potentially\n  indicates a stalled build or something wrong with the build itself.</p>\n</blockquote>\n\n<p>Tried <code>--show-details=streaming</code> without success (also in combination with\n<code>--test-option=--format=progress</code>).</p>\n\n<hr>\n\n<p>Commands that are executed (a variant):</p>\n\n<pre><code>cabal install --only-dependencies --enable-tests\ncabal configure --enable-tests --enable-coverage -v2\ncabal build\ncabal test --show-details=streaming --test-option=--format=progress\n</code></pre>\n"}, {"tags": ["templates", "haskell", "handler", "yesod"], "answers": [{"comments": [{"owner": {"reputation": 468, "user_id": 1581353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc121f3c3780a4b7aa802414995a0208?s=128&d=identicon&r=PG", "display_name": "Ren&#233; Martin", "link": "https://stackoverflow.com/users/1581353/ren%c3%a9-martin"}, "edited": false, "score": 0, "creation_date": 1457013927, "post_id": 35759735, "comment_id": 59219943, "body": "this is the solution to the first question, but is it typesafe though? I think the package could be improved if at least javascript checks for primitive types were introduced (like .isNumber(...))"}, {"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "reply_to_user": {"reputation": 468, "user_id": 1581353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc121f3c3780a4b7aa802414995a0208?s=128&d=identicon&r=PG", "display_name": "Ren&#233; Martin", "link": "https://stackoverflow.com/users/1581353/ren%c3%a9-martin"}, "edited": false, "score": 0, "creation_date": 1457014752, "post_id": 35759735, "comment_id": 59220625, "body": "This isn&#39;t typesafe, no. It&#39;s tricky to be fully typesafe because you can introduce arbitrary types as route parameters, but you could add some basic type safety to the generated code. If you were really serious about type safety, you might look into a different frontend language than Javascript, though"}, {"owner": {"reputation": 7054, "user_id": 1313611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9ee895c4ad3fa29cf3aaa4abddda289f?s=128&d=identicon&r=PG", "display_name": "pyrospade", "link": "https://stackoverflow.com/users/1313611/pyrospade"}, "reply_to_user": {"reputation": 468, "user_id": 1581353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc121f3c3780a4b7aa802414995a0208?s=128&d=identicon&r=PG", "display_name": "Ren&#233; Martin", "link": "https://stackoverflow.com/users/1581353/ren%c3%a9-martin"}, "edited": false, "score": 0, "creation_date": 1457016870, "post_id": 35759735, "comment_id": 59222363, "body": "@Ren&#233;Martin - Even if you did &quot;type checking&quot; in javascript, it wouldn&#39;t be typesafe since the assertions would throw exceptions.  If you want typesafe frontend code, I&#39;d recommend PureScript."}], "tags": [], "owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "is_accepted": true, "score": 1, "last_activity_date": 1456959162, "last_edit_date": 1456959162, "creation_date": 1456958819, "answer_id": 35759735, "question_id": 35756020, "link": "https://stackoverflow.com/questions/35756020/yesod-parametric-handler-in-julius-templates/35759735#35759735", "title": "Yesod: parametric handler in julius templates", "body": "<p>I haven't used this package much, but <a href=\"https://github.com/carymrobbins/yesod-js-routes\" rel=\"nofollow\"><code>yesod-js-routes</code></a> seems like it fits the bill. Basically the package takes your routes file and generates Javascript functions you can use to create the URLs. </p>\n\n<p>The package hasn't seen active development in awhile, but based on testing it still works fine. It's not on Hackage, but it's one file, so I just copied it into my project (I also needed to add <code>import Prelude</code> to that file, and add <code>mtl</code> to my build-depends section of the Cabal file). The README of the project covers the basic integration of the package you need to do. </p>\n\n<p>Here's some example output. For this routes file:</p>\n\n<pre><code>/static StaticR Static appStatic\n/auth   AuthR   Auth   getAuth\n\n/favicon.ico FaviconR GET\n/robots.txt RobotsR GET\n\n/ HomeR GET POST\n\n/comments CommentR POST\n/jsRoutes JSRoutesR GET\n/test/#Text/#Integer TestR GET POST\n</code></pre>\n\n<p>I got this Javascript:</p>\n\n<pre><code>;\nvar jsRoutes = {}; /* Subsite not supported */ ; /* Subsite not supported */ ;\njsRoutes.FaviconR = {\n    get: function() {\n        return {\n            method: \"get\",\n            url: \"/favicon.ico/\"\n        };\n    }\n};\njsRoutes.RobotsR = {\n    get: function() {\n        return {\n            method: \"get\",\n            url: \"/robots.txt/\"\n        };\n    }\n};\njsRoutes.HomeR = {\n    get: function() {\n        return {\n            method: \"get\",\n            url: \"/\"\n        };\n    },\n    post: function() {\n        return {\n            method: \"post\",\n            url: \"/\"\n        };\n    }\n};\njsRoutes.CommentR = {\n    post: function() {\n        return {\n            method: \"post\",\n            url: \"/comments/\"\n        };\n    }\n};\njsRoutes.JSRoutesR = {\n    get: function() {\n        return {\n            method: \"get\",\n            url: \"/jsRoutes/\"\n        };\n    }\n};\njsRoutes.TestR = {\n    get: function() {\n        return {\n            method: \"get\",\n            url: \"/test/\" + arguments[0] + \"/\" + arguments[1] + \"/\"\n        };\n    },\n    post: function() {\n        return {\n            method: \"post\",\n            url: \"/test/\" + arguments[0] + \"/\" + arguments[1] + \"/\"\n        };\n    }\n};\n</code></pre>\n\n<p>For a route like <code>TestR</code>, you can call:</p>\n\n<pre><code>jsRoutes.TestR.get(\"a\",2).url\n</code></pre>\n\n<p>to return</p>\n\n<pre><code>\"/test/a/2/\"\n</code></pre>\n\n<p>Unfortunately, neither the generated Javascript nor Javascript the language is doing anything to protect against e.g. passing 3 arguments to that function, or passing arguments of the wrong type. I don't know what your expectations are, but the Javascript code generation looks simple enough that you could improve what's generated.</p>\n"}], "owner": {"reputation": 468, "user_id": 1581353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc121f3c3780a4b7aa802414995a0208?s=128&d=identicon&r=PG", "display_name": "Ren&#233; Martin", "link": "https://stackoverflow.com/users/1581353/ren%c3%a9-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 35759735, "answer_count": 1, "score": 2, "last_activity_date": 1483541393, "creation_date": 1456945723, "last_edit_date": 1483541393, "question_id": 35756020, "link": "https://stackoverflow.com/questions/35756020/yesod-parametric-handler-in-julius-templates", "title": "Yesod: parametric handler in julius templates", "body": "<p>I am quite new to Yesod and currently try to develop a frontend website and a backend restful webservice. To access the API from the website I use AJAX requests. For the URLs of the requests I want to use shakespearean template like calls:</p>\n\n<pre><code>$.ajax({\n  url: '@{PersonR}',\n  type: 'GET',\n  contentType: \"application/json\",\n  data: JSON.stringify({...}),\n  success: function (data) {...}\n});\n</code></pre>\n\n<p>On the backend site the route to my PersonR handler is defined as follows:</p>\n\n<pre><code>/api/person/#Int/get PersonR GET\n</code></pre>\n\n<p>For this to work the handler has a signature like</p>\n\n<pre><code>getPersonR :: Int -&gt; Handler Value\n</code></pre>\n\n<p>However now the julius template needs a parameter to be a valid. I experimented a bit and found that I can directly use haskell code also in @{...}. Maybe I missed that point in the doku.\nQuestion 1: Is there a way to tell that one of the parameters could be given in JavaScript? Maybe with a renderer to output something like this:</p>\n\n<pre><code>function(var1){return '/api/person/'+var1+'/get';}\n</code></pre>\n\n<p>I think this lacks the point of type safety though. Which leads to my second question (which kinda negates the first): Is there any other way to achieve getting data into the URLs on the client side?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1456945425, "post_id": 35755837, "comment_id": 59185062, "body": "@Zeta: well that spoils the exercise :-)"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1456945634, "post_id": 35755837, "comment_id": 59185195, "body": "Well, that&#39;s only 5 patterns of at least 26 ones :D (unless we include non-ASCII characters). But seriously, at least two examples (like <code>toCapital &#39;3&#39;</code> and <code>toCapital &#39;c&#39;</code>) would help any reader. It&#39;s strange that they didn&#39;t get included."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1456991028, "post_id": 35755837, "comment_id": 59204011, "body": "There&#39;s nothing missing in the quoted text: it&#39;s perhaps not as clear as it could be, but it is a perfectly fine sentence that means the same thing as your corrected version. Try parsing it instead like this: Define a function to convert small letters to capitals, which returns (unchanged) characters which are not small letters. The extra punctuation should make it more clear, but again is not necessary."}], "tags": [], "owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "is_accepted": true, "score": 3, "last_activity_date": 1456945446, "last_edit_date": 1456945446, "creation_date": 1456945111, "answer_id": 35755837, "question_id": 35755796, "link": "https://stackoverflow.com/questions/35755796/converting-small-letters-to-capitals/35755837#35755837", "title": "Converting small letters to capitals", "body": "<p>Looks like there's a bit missing:</p>\n\n<blockquote>\n  <p>Define a function to convert small letters to capitals <strong>and</strong> which returns unchanged characters <strong>for those</strong> which are not small letters</p>\n</blockquote>\n\n<p>For example:</p>\n\n<pre><code>toCapital 'c' == 'C' -- lower case c to upper case C\ntoCapital 'o' == 'O' -- lower case o to upper case O\ntoCapital 'C' == 'C' -- upper case C gets returned without change\ntoCapital '3' == '3' -- numbers get returned without change\ntoCapital '_' == '_' -- other things also get returned without change\n</code></pre>\n"}], "owner": {"reputation": 333, "user_id": 6009572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7899bee63fefec4974ebc4e92809e695?s=128&d=identicon&r=PG&f=1", "display_name": "w13rfed", "link": "https://stackoverflow.com/users/6009572/w13rfed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "accepted_answer_id": 35755837, "answer_count": 1, "score": 1, "last_activity_date": 1456945446, "creation_date": 1456944978, "last_edit_date": 1456945006, "question_id": 35755796, "link": "https://stackoverflow.com/questions/35755796/converting-small-letters-to-capitals", "title": "Converting small letters to capitals", "body": "<p>I'm stuck on a question in the book, 'Haskell - The Craft of Functional Programming'. Ex 3.16:</p>\n\n<blockquote>\n  <p>Define a function to convert small letters to capitals which returns unchanged characters which are not small letters.</p>\n</blockquote>\n\n<p>Is there something I'm missing? If I convert small letters to capitals how can I return a character that is unchanged?</p>\n"}, {"tags": ["list", "haskell", "primes", "lazy-evaluation", "counting"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 5, "creation_date": 1456941941, "post_id": 35754806, "comment_id": 59182902, "body": "I don&#39;t understand what you are saying about &quot;stopping inside the function&quot;. You could simply define <code>generatePrimes n = take n allPrimes</code>. Due to lazyness this will stop after finding <code>n</code> primes, there&#39;s no real overhead. The result <i>is</i> a list of the first <code>n</code> primes. Please clarify that requirement."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 1, "creation_date": 1456941953, "post_id": 35754806, "comment_id": 59182912, "body": "<code>take</code> will &#39;stop&#39; once it has pulled the desired number of elements from the list. Why doesn&#39;t that fit your requirements?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1456942309, "post_id": 35754806, "comment_id": 59183108, "body": "Explicitly testing each number for being prime isn&#39;t a very good way to generate a list of primes. For one thing, the tests on the even numbers after 2 are pointless."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1456942766, "post_id": 35754806, "comment_id": 59183399, "body": "Somewhat related, for those of you who haven&#39;t already read it, is this wonderful Functional Pearl: <a href=\"https://www.cs.hmc.edu/~oneill/papers/Sieve-JFP.pdf\" rel=\"nofollow noreferrer\">cs.hmc.edu/~oneill/papers/Sieve-JFP.pdf</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 3247014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f4AgB.jpg?s=128&g=1", "display_name": "user3247014", "link": "https://stackoverflow.com/users/3247014/user3247014"}, "edited": false, "score": 0, "creation_date": 1456942598, "post_id": 35754890, "comment_id": 59183298, "body": "Couldn&#39;t match expected type <code>Int&#39; with actual type </code>a&#39;       <code>a&#39; is a rigid type variable bound by           the type signature for generatePrimes :: Integral a =&gt; a -&gt; [a]           at Primes.hs:53:19     Relevant bindings include       n :: a (bound at Primes.hs:54:16)       generatePrimes :: a -&gt; [a] (bound at Primes.hs:54:1)     In the first argument of </code>take&#39;, namely `n&#39;     In the expression: take n [i | i &lt;- [2 .. ], isPrime i]"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 11, "user_id": 3247014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f4AgB.jpg?s=128&g=1", "display_name": "user3247014", "link": "https://stackoverflow.com/users/3247014/user3247014"}, "edited": false, "score": 0, "creation_date": 1456942641, "post_id": 35754890, "comment_id": 59183320, "body": "@user3247014 Ah. You may use <code>Data.List.genericTake</code> instead of <code>take</code>, or change the type signature. I will update my answer shortly."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 5, "last_activity_date": 1456942759, "last_edit_date": 1495542224, "creation_date": 1456942095, "answer_id": 35754890, "question_id": 35754806, "link": "https://stackoverflow.com/questions/35754806/generate-first-n-primes-haskell/35754890#35754890", "title": "Generate First n Primes (Haskell)", "body": "<p>The answer to your question as stated is to simply move <code>take</code> into the definition of <code>generatePrimes</code>, thus:</p>\n\n<pre><code>generatePrimes :: Integral a =&gt; Int -&gt; [a]\ngeneratePrimes n = take n [i | i &lt;- [2..], isPrime i]\n</code></pre>\n\n<p>If it is important that you keep the exact same type signature as in the question, you may use the more polymorphic version of <code>take</code> available in <code>Data.List</code>:</p>\n\n<pre><code>import Data.List\ngeneratePrimes :: Integral a =&gt; a -&gt; [a]\ngeneratePrimes n = genericTake n [i | i &lt;- [2..], isPrime i]\n</code></pre>\n\n<p>(Indeed, this implementation has the even more general type <code>generatePrimes :: (Integral a, Integral i) =&gt; i -&gt; [a]</code>.)</p>\n\n<p>However, this is <a href=\"https://stackoverflow.com/a/7868790/791604\">anti-modular in the presence of lazy evaluation</a>; you should leave control over how much of the list is consumed to the consumer rather than the producer.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13225876, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TWbLlt0FAow/AAAAAAAAAAI/AAAAAAAAAAA/AAKWJJPA09Lelm-ELfh2MO9J6_Gs1PhV1Q/photo.jpg?sz=128", "display_name": "Juan Carlos Ramirez", "link": "https://stackoverflow.com/users/13225876/juan-carlos-ramirez"}, "is_accepted": false, "score": 0, "last_activity_date": 1586478534, "creation_date": 1586478534, "answer_id": 61132324, "question_id": 35754806, "link": "https://stackoverflow.com/questions/35754806/generate-first-n-primes-haskell/61132324#61132324", "title": "Generate First n Primes (Haskell)", "body": "<p>Another implementation of printing the first <strong>n</strong> prime numbers can be done with pattern matching. Given as input a list that its range is from <strong>2</strong> to <strong>n</strong>, the function <em>isPrime</em> returns all the values that are prime numbers.</p>\n\n<pre><code>isPrime [p] = if null ([x | x &lt;- [2.. p - 1], mod p x == 0])\n              then show p \n              else \"\"\n\nisPrime (p:ps) = if null ([x | x &lt;- [2.. p - 1], mod p x == 0])\n                 then show p ++ \", \" ++ isPrime(ps)\n                 else \"\" ++ isPrime(ps)\n</code></pre>\n\n<p>In order to execute the first <strong>n</strong> numbers, we can use ranges and just type: <code>isPrime[2..n]</code>. We consider number 2 to be the first prime number.</p>\n"}], "owner": {"reputation": 11, "user_id": 3247014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f4AgB.jpg?s=128&g=1", "display_name": "user3247014", "link": "https://stackoverflow.com/users/3247014/user3247014"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2823, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1586478534, "creation_date": 1456941804, "last_edit_date": 1456960103, "question_id": 35754806, "link": "https://stackoverflow.com/questions/35754806/generate-first-n-primes-haskell", "title": "Generate First n Primes (Haskell)", "body": "<p>I have this function:</p>\n\n<pre><code>generatePrimes :: Integral a =&gt; a -&gt; [a]\ngeneratePrimes n = [i | i &lt;- [2..], isPrime i]\n</code></pre>\n\n<p>I am trying to get the first <em>n</em> primes. I know that I can call the function in <code>main</code> by using the <code>take</code> function (and get the first <em>n</em> elements of the list), but I want to be able to have the function stop when it reaches <em>n</em> primes (inside the function), so that when it is called in <code>main</code> such as:</p>\n\n<pre><code>generatePrimes 8\n</code></pre>\n\n<p>it will display a list with only the first 8 primes.</p>\n"}, {"tags": ["json", "haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1456941302, "post_id": 35754183, "comment_id": 59182486, "body": "Your edited in error is just telling you the decode expected a JSON list, so test.json would look like <code>[ ... ]</code> and not <code>{ ... }</code>.  The reason your decoder expected a list is your explicit type <code>[JSON&#39;]</code> instead of just <code>JSON&#39;</code>, which would work."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1456941312, "post_id": 35754183, "comment_id": 59182495, "body": "You ask for <code>[JSON&#39;]</code>, but provide a json file with a value of type <code>JSON&#39;</code>. Perhaps you wanted more square brackets in your json file or fewer in your Haskell file."}], "answers": [{"tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 1, "last_activity_date": 1456940668, "creation_date": 1456940668, "answer_id": 35754463, "question_id": 35754183, "link": "https://stackoverflow.com/questions/35754183/trying-to-read-json-from-file-using-aeson/35754463#35754463", "title": "Trying to read JSON from file using Aeson", "body": "<p>Add this to the top of the file</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\n</code></pre>\n\n<p>The ability to use <code>derive (Generic)</code> is a language extension, and you have to tell GHC that you want this to be turned on.</p>\n"}, {"comments": [{"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1456940826, "post_id": 35754474, "comment_id": 59182161, "body": "This <a href=\"https://www.schoolofhaskell.com/school/starting-with-haskell/libraries-and-frameworks/text-manipulation/json\" rel=\"nofollow noreferrer\">link</a> is able to read the JSON without adding a <code>toEncoding</code> function"}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1456940912, "post_id": 35754474, "comment_id": 59182209, "body": "Event after adding the extension declaration Im getting an error. Please see edits."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1456940915, "post_id": 35754474, "comment_id": 59182210, "body": "Every example using <code>deriving (Generic)</code> in the Data.Aeson documentation includes this language pragma.  @dopatraman What additional info should be present in the &quot;not helpful at all&quot; documentation to help here?"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 3, "last_activity_date": 1456945203, "last_edit_date": 1456945203, "creation_date": 1456940696, "answer_id": 35754474, "question_id": 35754183, "link": "https://stackoverflow.com/questions/35754183/trying-to-read-json-from-file-using-aeson/35754474#35754474", "title": "Trying to read JSON from file using Aeson", "body": "<p>you need to put <code>{-# LANGUAGE DeriveGeneric #-}</code> on the top of your file.</p>\n\n<p>On a side note the documentation of <a href=\"https://hackage.haskell.org/package/aeson-0.11.1.0/docs/Data-Aeson.html\" rel=\"nofollow\">aeson</a> says</p>\n\n<blockquote>\n<pre><code>instance ToJSON Person where\n    -- ...\n    toEncoding = genericToEncoding defaultOptions\n\ninstance FromJSON Person\n    -- No need to provide a parseJSON implementation.\n</code></pre>\n</blockquote>\n\n<p>I think you probably also forgot the <code>toEncoding</code> line in your <code>ToJSON</code>.</p>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 849, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1456945203, "creation_date": 1456939835, "last_edit_date": 1456940908, "question_id": 35754183, "link": "https://stackoverflow.com/questions/35754183/trying-to-read-json-from-file-using-aeson", "title": "Trying to read JSON from file using Aeson", "body": "<p>Here's my code:</p>\n\n<pre><code>import Data.Aeson\nimport Control.Applicative\nimport Control.Monad\nimport Data.Text\nimport GHC.Generics\nimport qualified Data.ByteString.Lazy as B\n\ndata JSON' = \n    JSON' { \n        foo :: !Text,\n        int :: Int\n        } deriving (Show, Generic)\n\ninstance FromJSON JSON'\ninstance ToJSON JSON'\n\njsonFile :: FilePath\njsonFile = \"test.json\"\n\ngetJSON :: IO B.ByteString\ngetJSON = B.readFile jsonFile\n\nmain :: IO ()\nmain = do\n    -- Get JSON data and decode it\n    d &lt;- (eitherDecode &lt;$&gt; getJSON) :: IO (Either String [JSON'])\n    -- If d is Left, the JSON was malformed.\n    -- In that case, we report the error.\n    -- Otherwise, we perform the operation of\n    -- our choice. In this case, just print it.\n    case d of\n        Left err -&gt; putStrLn err\n        Right ps -&gt; print ps\n</code></pre>\n\n<p><code>test.json</code> looks liket his:</p>\n\n<pre><code>-- test.json\n{\n    \"foo\": \"bar\",\n    \"int\": 1\n}\n</code></pre>\n\n<p>When I run this code I get this error:</p>\n\n<pre><code>Can't make a derived instance of \u2018Generic JSON'\u2019:\n  You need DeriveGeneric to derive an instance for this class\nIn the data declaration for \u2018JSON'\u2019\n</code></pre>\n\n<p>So far the documentation for <code>Aeson</code>, like all documentation on Hackage, is not helpful at all. I have no idea what I'm doing wrong. So far it seems like I'm reading a file into a bytestring, transforming it into a \"tree\" like data structure, and then printing one leaf per node. My code is straight from <a href=\"https://www.schoolofhaskell.com/school/starting-with-haskell/libraries-and-frameworks/text-manipulation/json\" rel=\"nofollow\">this link</a></p>\n\n<p>What am I doing wrong?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>After adding the language extension declaration to the top of the file</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\n</code></pre>\n\n<p>I'm getting this error:</p>\n\n<pre><code>Error in $: expected [a], encountered Object\n</code></pre>\n\n<p>Not sure what this means.</p>\n"}, {"tags": ["haskell", "stackage"], "comments": [{"owner": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "edited": false, "score": 2, "creation_date": 1456936958, "post_id": 35753092, "comment_id": 59179563, "body": "As the ghc provides it&#39;s runtime to each executable statically by default, you should be fine, if you use no FFI-bindings to external libraries."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1456937718, "post_id": 35753092, "comment_id": 59180090, "body": "Except for libgmp. IIRC that one is always dynamically linked. You can <a href=\"https://stackoverflow.com/questions/10539857/statically-link-gmp-to-an-haskell-application-using-ghc-llvm\">link that one statically too</a>."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1456939861, "post_id": 35753092, "comment_id": 59181558, "body": "You can also avoi dusing libgmp entirely, but that takes a specially compiled ghc."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 3, "creation_date": 1456942390, "post_id": 35753092, "comment_id": 59183159, "body": "You should also be aware that even programs statically linked against glibc still have runtime dependencies on system files for things like locales and <code>dlopen</code>."}, {"owner": {"reputation": 831, "user_id": 3371760, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09370cd5d499c9f0f75b54aa1b4daa17?s=128&d=identicon&r=PG", "display_name": "Fried Brice", "link": "https://stackoverflow.com/users/3371760/fried-brice"}, "edited": false, "score": 0, "creation_date": 1535736712, "post_id": 35753092, "comment_id": 91191665, "body": "While googling the same problem, i found both your question and this answer: <a href=\"https://ro-che.info/articles/2015-10-26-static-linking-ghc\" rel=\"nofollow noreferrer\">ro-che.info/articles/2015-10-26-static-linking-ghc</a>. I haven&#39;t had a chance to try it out, though."}], "owner": {"reputation": 323, "user_id": 450583, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/018ad0db1f28ed72e4a1277d58959810?s=128&d=identicon&r=PG", "display_name": "flightlessbird", "link": "https://stackoverflow.com/users/450583/flightlessbird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 834, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1456936704, "creation_date": 1456936704, "question_id": 35753092, "link": "https://stackoverflow.com/questions/35753092/how-can-i-produce-a-statically-linked-haskell-binary-with-stack", "title": "How can I produce a statically linked Haskell binary with stack?", "body": "<p>I want to build a static binary executable for a Haskell (it is important not to depend on any system libraries in my case). I use stack as my preferred build tool. Which flags should be set to achieve this? Bonus points for a brief explanation of each one.</p>\n"}, {"tags": ["list", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "is_accepted": false, "score": 2, "last_activity_date": 1456935321, "creation_date": 1456935321, "answer_id": 35752576, "question_id": 35752255, "link": "https://stackoverflow.com/questions/35752255/edit-every-nth-item-in-a-list/35752576#35752576", "title": "Edit every Nth item in a list", "body": "<pre><code>mapIf :: (Int -&gt; Bool) -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]\nmapIf pred f l = map (\\(value,index) -&gt; if (pred index) then f value else value) $ zip l [1..]\n\nmapEveryN :: Int -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]\nmapEveryN n = mapIf (\\x -&gt; x `mod` n == 0)\n</code></pre>\n\n<p><a href=\"http://ideone.com/kSQwdE\" rel=\"nofollow\">Live on Ideone</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 0, "creation_date": 1456935625, "post_id": 35752592, "comment_id": 59178520, "body": "Yes please, if you want, add more details. I&#39;m an absolute newcomer of haskell. Thanks!"}, {"owner": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 0, "creation_date": 1456939691, "post_id": 35752592, "comment_id": 59181442, "body": "I think yatima&#39;s answer is more elegant, If I may say so. But yours is theaching me more, as it would do to any absolute beginner. I&#39;ll accept yours."}, {"owner": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 0, "creation_date": 1456966547, "post_id": 35752592, "comment_id": 59195459, "body": "Thanks for the explanation about lambdas, very very useful. Let me ask you just one more question: Why you wrote <code>let mycalculation</code> instead of defining a proper function with type declaration, etc cetera?"}, {"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "reply_to_user": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 0, "creation_date": 1456998087, "post_id": 35752592, "comment_id": 59208565, "body": "@MadHatter I was writing the function in GHCi, and in you need to define functions with <code>let</code> before them (Code you run in GHCi is like code you add to your <code>main</code> function, not like a top-level definition of a function). If I was writing the code in a file I would have had a type declaration and such."}], "tags": [], "owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "is_accepted": true, "score": 9, "last_activity_date": 1456936857, "last_edit_date": 1456936857, "creation_date": 1456935347, "answer_id": 35752592, "question_id": 35752255, "link": "https://stackoverflow.com/questions/35752255/edit-every-nth-item-in-a-list/35752592#35752592", "title": "Edit every Nth item in a list", "body": "<p>A common way to get indexes for values in a list is to <code>zip</code> the list into tuples of <code>(value, index)</code>. </p>\n\n<pre><code>ghci &gt; let zipped = zip [1,2,3,4,5,6,7] [1..]\nghci &gt; zipped\n[(1,1),(2,2),(3,3),(4,4),(5,5),(6,6),(7,7)]\n</code></pre>\n\n<p>Then you just need to <code>map</code> over that list and return a new one. If index is divisible by 3 (<code>index `rem` 3 == 0</code>), we'll double the value, otherwise we'll return the same value:</p>\n\n<pre><code>ghci &gt; map (\\(value, index) -&gt; if index `rem` 3 == 0 then value*2 else value) zipped\n[1,2,6,4,5,12,7]\n</code></pre>\n\n<p>Tell me if that all makes sense\u2014I can add more detail if you aren't familiar with <code>zip</code> and <code>map</code> and such.</p>\n\n<h3>Zip</h3>\n\n<p>You can find documentation on <code>zip</code> by looking at its <a href=\"http://haddock.stackage.org/lts-5.5/base-4.8.2.0/Prelude.html#v:zip\">Haddocks</a>, which say: \"zip takes two lists and returns a list of corresponding pairs.\" (Docs are hosted in several places, but I went to <a href=\"https://www.stackage.org\">https://www.stackage.org</a> and searched for <code>zip</code>). </p>\n\n<h3>Map</h3>\n\n<p>The <a href=\"http://haddock.stackage.org/lts-5.5/base-4.8.2.0/Prelude.html#v:map\"><code>map</code></a> function applies a function to each item in a list, generating a new value for each element.</p>\n\n<h3>Lambdas</h3>\n\n<p>Lambdas are just functions without a specific name. We used one in the first argument to <code>map</code> to say what we should do to each element in the list. You may have seen these in other languages like Python, Ruby, or Swift.</p>\n\n<p>This is the syntax for lambdas:</p>\n\n<pre><code>(\\arg1, arg2 -&gt; functionBodyHere)\n</code></pre>\n\n<p>We could have also written it without a lambda:</p>\n\n<pre><code>ghci &gt; let myCalculation (value, index) = if index `rem` 3 == 0 then value*2 else value\nghci &gt; map myCalculation zipped\n[1,2,6,4,5,12,7]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 2, "creation_date": 1456939517, "post_id": 35752643, "comment_id": 59181322, "body": "May I ask what <code>($)</code> stands for? I thought that <code>$</code> would be useful just to get rid of parentheses.."}, {"owner": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 2, "creation_date": 1456939847, "post_id": 35752643, "comment_id": 59181546, "body": "Btw, your answer is very elegant and &quot;haskelish&quot;.. I&#39;m accepting Gabriel&#39;s just because is perhaps more suited for an absolute beginner like me. But, If you want, you can explain yours step by step, in further advantage of any beginner that should catch this post."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 1, "creation_date": 1456947181, "post_id": 35752643, "comment_id": 59186167, "body": "@MadHatter <code>f $ x = f x</code> - that is, <code>$</code> takes a function and a value, and calls the function with the value. It&#39;s often used in place of parentheses because <code>$</code> has a very low precedence when used as an infix operator. But it can be used as an ordinary function, as here, and in that case it&#39;s the same as writing <code>zipWith (\\f x -&gt; f x) (...)</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1456954282, "post_id": 35752643, "comment_id": 59190359, "body": "Isn&#39;t it cleaner to write <code>tail . cycle $ f : replicate (n-1) id</code>, instead of <code>cycle ((replicate (n-1) id) ++ [f])</code>? You avoid having to use <code>(++ [x])</code> to add to the end of a list, which is a good thing to avoid."}, {"owner": {"reputation": 6500, "user_id": 57879, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/419a88bdf20aeaa3fb2de53ca0f4d836?s=128&d=identicon&r=PG", "display_name": "yatima2975", "link": "https://stackoverflow.com/users/57879/yatima2975"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1456955153, "post_id": 35752643, "comment_id": 59190864, "body": "@amalloy: Yeah, that&#39;s actually better! It both looks nicer and is a bit more efficient. <code>concat . intersperse f $ replicate (n-1) id</code> would also do the trick, now that I think of it, but that needs <code>Data.List</code>."}, {"owner": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 0, "creation_date": 1456955977, "post_id": 35752643, "comment_id": 59191326, "body": "Definitely great explanation! Thanks a lot!!"}, {"owner": {"reputation": 6500, "user_id": 57879, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/419a88bdf20aeaa3fb2de53ca0f4d836?s=128&d=identicon&r=PG", "display_name": "yatima2975", "link": "https://stackoverflow.com/users/57879/yatima2975"}, "edited": false, "score": 0, "creation_date": 1457169730, "post_id": 35752643, "comment_id": 59292882, "body": "<code>xs ++ ys</code> takes time proportional to the number of elements in xs to fully evaluate, so you have to pay attention to not let your algorithm runtime become quadratic if there&#39;s a better way. In this case it&#39;s not going to hurt for smallish values of <code>n</code> though, but seeing <code>++[x]</code> should trigger you to look for an alternate solution."}, {"owner": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 0, "creation_date": 1457206057, "post_id": 35752643, "comment_id": 59305056, "body": "I know one should not use comments just to say thanks, but in this case I feel compelled to thank you all for all those instructive explanations."}], "tags": [], "owner": {"reputation": 6500, "user_id": 57879, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/419a88bdf20aeaa3fb2de53ca0f4d836?s=128&d=identicon&r=PG", "display_name": "yatima2975", "link": "https://stackoverflow.com/users/57879/yatima2975"}, "is_accepted": false, "score": 13, "last_activity_date": 1456948371, "last_edit_date": 1456948371, "creation_date": 1456935466, "answer_id": 35752643, "question_id": 35752255, "link": "https://stackoverflow.com/questions/35752255/edit-every-nth-item-in-a-list/35752643#35752643", "title": "Edit every Nth item in a list", "body": "<pre><code>applyEvery :: Int -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]\napplyEvery n f = zipWith ($) (cycle (replicate (n-1) id ++ [f]))\n</code></pre>\n\n<p>The <code>cycle</code> subexpression builds a list of functions <code>[id,id,...,id,f]</code> with the correct number of elements and repeats it ad nauseam, while the <code>zipWith ($)</code> applies that list of functions to the argument list.</p>\n\n<hr>\n\n<p>Since you asked for it, more detail! Feel free to ask for more explanation.</p>\n\n<p>The main idea is maybe best explained with an ASCII picture (which won't stop me from writing <strike>a thousand</strike> a lot of ASCII words!):</p>\n\n<pre><code>functions : [ id, id, f  , id, id, f  , id, id, f, ... \ninput list: [  1,  2,   3,  4,  5,   6,  7 ]\n-----------------------------------------------------\nresult    : [  1,  2, f 3,  4,  5, f 6,  7 ]\n</code></pre>\n\n<p>Just like there's no reason to hardcode the fact that you want to double every third element in the list, there's nothing special about <code>f</code> (which in your example is doubling), except that it should have the same result type as doing nothing. So I made these the parameters of my function. It's even not important that you operate on a list of numbers, so the function works on lists of <code>a</code>, as long as it's given an 'interval' and an operation. That gives us the type signature <code>applyEvery :: Int -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]</code>. I put the input list last, because then a partial application like <code>doubleEveryThird = applyEvery 3 (*2)</code> is something that returns a new list, a so-called <em>combinator</em>. I picked the order of the other two arguments basically at random :-) </p>\n\n<p>To build the list of functions, we first assemble the basic building block, consisting of n-1 <code>id</code>s, followed by an <code>f</code> as follows: <code>replicate (n-1) id ++ [f]</code>. <code>replicate m x</code> makes a list containing <code>m</code> repetitions of the <code>x</code>argument, e.g. <code>replicate 5 'a' = \"aaaaa\"</code>, but it also works for functions. We have to append the <code>f</code> wrapped in a list of its own, instead of using <code>:</code> because you can only prepend single elements at the front - Haskell's lists are singly-linked. </p>\n\n<p>Next, we keep on repeating the basic building block with <code>cycle</code> (not <code>repeat</code> as I first had mistakenly). <code>cycle</code> has type <code>[a] -&gt; [a]</code> so the result is a list of \"the same level of nested-ness\". Example <code>cycle [1,2,3]</code> evaluates to <code>[1,2,3,1,2,3,1,2,3,...]</code></p>\n\n<p>[ Side note: the only repeat-y function we <em>haven't</em> used is <code>repeat</code> itself: that forms an infinite list consisting of its argument ]</p>\n\n<p>With that out of the way, the slightly tricky <code>zipWith ($)</code> part. You might already know the plain <code>zip</code> function, which takes two lists and puts elements in the same place in a tuple in the result, terminating when either list runs out of elements. Pictorially:</p>\n\n<pre><code>    xs   : [ a  , b    , c   , d, e] \n       ys: [   x,    y ,   z ]\n------------------------------\nzip xs ys: [(a,x),(b,y),(c,z)]\n</code></pre>\n\n<p>This already looks an awful lot like the first picture, right? The only thing is that we don't want to put the individual elements together in a tuple, but apply the first element (which is a function) to the second instead. Zipping with a custom combining function is done with <code>zipWith</code>. Another picture (the last one, I promise!):</p>\n\n<pre><code>          xs   : [   a  ,   b  ,   c   , d, e] \n             ys: [     x,     y,     z ]\n----------------------------------------\nzipWith f xs ys: [ f a x, f b y, f c z ]\n</code></pre>\n\n<p>Now, what should we choose to <code>zipWith</code> with? Well, we want to apply the first argument to the second, so <code>(\\f x -&gt; f x)</code> should do the trick. If lambdas make you uncomfortable, you can also define a top-level function <code>apply f x = f x</code> and use that instead. However, this already a standard operator in the Prelude, namely <code>$</code>! Since you can't use a infix operator as a standalone function, we have to use the syntactic sugar <code>($)</code> (which really just means <code>(\\f x -&gt; f $ x)</code>)</p>\n\n<p>Putting all of the above together, we get:</p>\n\n<pre><code>applyEvery :: Int -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]\napplyEvery n f xs = zipWith ($) (cycle (replicate (n-1) id ++ [f])) xs\n</code></pre>\n\n<p>But we can get rid of the <code>xs</code> at the end, leading to the definition I gave.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1456955363, "creation_date": 1456955363, "answer_id": 35758782, "question_id": 35752255, "link": "https://stackoverflow.com/questions/35752255/edit-every-nth-item-in-a-list/35758782#35758782", "title": "Edit every Nth item in a list", "body": "<p>Note: this code is not yet tested.</p>\n\n<p>In <code>lens</code> land, this is called a <code>Traversal</code>. <code>Control.Lens</code> gives you these:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes, ScopedTypeVariables #-}\n\ntype Traversal s t a b =\n  forall f . Applicative f =&gt; (a -&gt; f b) -&gt; s -&gt; f t\n\ntype Traversal' s a = Traversal s s a a\n</code></pre>\n\n<p>We can use <code>lens</code>'s <code>itraverse</code> from <code>Control.Lens.Indexed</code>:</p>\n\n<pre><code>-- everyNth :: (TraversableWithIndex i t, Integral i)\n            =&gt; i -&gt; Traversal' (t a) a\neveryNth :: (TraversableWithIndex i t, Integral i, Applicative f)\n         =&gt; i -&gt; (a -&gt; f a) -&gt; t a -&gt; f (t a)\neveryNth n f = itraverse f where\n  g i x | i `rem` n == n - 1 = f x\n        | otherwise = pure x\n</code></pre>\n\n<p>This can be specialized to your specific purpose:</p>\n\n<pre><code>import Data.Profunctor.Unsafe\nimport Data.Functor.Identity\n\neveryNthPureList :: Int -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]\neveryNthPureList n f = runIdentity #. everyNth n (Identity #. f)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "is_accepted": false, "score": 1, "last_activity_date": 1456960400, "creation_date": 1456960400, "answer_id": 35760103, "question_id": 35752255, "link": "https://stackoverflow.com/questions/35752255/edit-every-nth-item-in-a-list/35760103#35760103", "title": "Edit every Nth item in a list", "body": "<p>A simple recursive approach:</p>\n\n<pre><code>everyNth n f xs = igo n xs where\n    igo 1 (y:ys) = f y : igo n     ys\n    igo m (y:ys) =   y : igo (m-1) ys\n    igo _ [] = []\n\ndoubleEveryThird = everyNth 3 (*2)\n</code></pre>\n\n<p>Basically, igo starts at <code>n</code>, counts down until it reaches <code>1</code>, where it will apply the function, and go back up to <code>n</code>. <code>doubleEveryThird</code> is partially applied: <code>everyNth</code> expects three arguments, but we only gave it two, so <code>dougleEveryThird</code> will expect that final argument.</p>\n"}], "owner": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1340, "favorite_count": 2, "accepted_answer_id": 35752592, "answer_count": 5, "score": 4, "last_activity_date": 1456960400, "creation_date": 1456934560, "last_edit_date": 1456946927, "question_id": 35752255, "link": "https://stackoverflow.com/questions/35752255/edit-every-nth-item-in-a-list", "title": "Edit every Nth item in a list", "body": "<p>I want to perform an arithmetic operation (e.g. doubling the value) on a list of integers, every n places.</p>\n\n<p>For example, given the list <code>[1,2,3,4,5,6,7]</code>, I want to double values every three places. In that case, we would have <code>[1,2,6,4,5,12,7]</code>.</p>\n\n<p>How can I do it? </p>\n"}, {"tags": ["haskell", "types", "unfold"], "comments": [{"owner": {"reputation": 1281, "user_id": 5600363, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d820760191b1bb057846d5a06c2bf5b6?s=128&d=identicon&r=PG", "display_name": "hkBst", "link": "https://stackoverflow.com/users/5600363/hkbst"}, "reply_to_user": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "edited": false, "score": 0, "creation_date": 1456934120, "post_id": 35751328, "comment_id": 59177355, "body": "@jwodder, both fragments result in [10,9,8,7,6,5,4,3,2,1] when I test in ghci..."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1456937769, "post_id": 35751328, "comment_id": 59180128, "body": "<a href=\"http://stackoverflow.com/questions/28652452/what-is-the-correct-definition-of-unfold-for-an-untagged-tree/28653008\">Related question</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1281, "user_id": 5600363, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d820760191b1bb057846d5a06c2bf5b6?s=128&d=identicon&r=PG", "display_name": "hkBst", "link": "https://stackoverflow.com/users/5600363/hkbst"}, "edited": false, "score": 0, "creation_date": 1456934343, "post_id": 35751416, "comment_id": 59177506, "body": "The question I have is whether this theoretically more general type serves any practical purpose or not and if yes if you can give a good example. Certainly the standard example does not make the usefulness of the more elaborate type apparent, as I showed in my question."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 1281, "user_id": 5600363, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d820760191b1bb057846d5a06c2bf5b6?s=128&d=identicon&r=PG", "display_name": "hkBst", "link": "https://stackoverflow.com/users/5600363/hkbst"}, "edited": false, "score": 3, "creation_date": 1456935510, "post_id": 35751416, "comment_id": 59178420, "body": "@hkBst Replace <code>Just (b, b-1)</code> with <code>Just (show b, b-1)</code>."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 1281, "user_id": 5600363, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d820760191b1bb057846d5a06c2bf5b6?s=128&d=identicon&r=PG", "display_name": "hkBst", "link": "https://stackoverflow.com/users/5600363/hkbst"}, "edited": false, "score": 6, "creation_date": 1456935677, "post_id": 35751416, "comment_id": 59178564, "body": "@hkBst A more useful example is: <code>repeat n x = unfoldr (\\b -&gt; if b == 0 then Nothing else Just (x, b-1)) n</code>.  The type of <code>repeat</code> is <code>Int -&gt; a -&gt; [a]</code>, so that <code>repeat 5 1 == [1,1,1,1,1]</code> but also <code>repeat 5 &#39;a&#39; == &quot;aaaaa&quot;</code>.   With your version of <code>unfoldr</code> you cannot implement <code>repeat</code> as a simple call to <code>unfoldr</code>."}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 13, "last_activity_date": 1456932439, "creation_date": 1456932439, "answer_id": 35751416, "question_id": 35751328, "link": "https://stackoverflow.com/questions/35751328/what-is-the-justification-for-the-type-of-unfoldr-in-haskell/35751416#35751416", "title": "What is the justification for the type of unfoldr in Haskell?", "body": "<p>A function with type</p>\n\n<pre><code>(a -&gt; Maybe a) -&gt; a -&gt; [a]\n</code></pre>\n\n<p>restricts the output list element type to be the same as the state which is threaded through the generation process. <code>unfoldr</code> is more general in that it allows an independent type of state to be used.</p>\n"}, {"comments": [{"owner": {"reputation": 1281, "user_id": 5600363, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d820760191b1bb057846d5a06c2bf5b6?s=128&d=identicon&r=PG", "display_name": "hkBst", "link": "https://stackoverflow.com/users/5600363/hkbst"}, "edited": false, "score": 0, "creation_date": 1456994836, "post_id": 35755337, "comment_id": 59206341, "body": "Certainly very interesting, but I feel that you have not given enough attention to the part where you introduce the initial types of folds and unfolds. How do those types follow from the (co)induction principles?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1281, "user_id": 5600363, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d820760191b1bb057846d5a06c2bf5b6?s=128&d=identicon&r=PG", "display_name": "hkBst", "link": "https://stackoverflow.com/users/5600363/hkbst"}, "edited": false, "score": 0, "creation_date": 1457000866, "post_id": 35755337, "comment_id": 59210640, "body": "@hkBst True. Edited to shed some light."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1457000850, "last_edit_date": 1457000850, "creation_date": 1456943500, "answer_id": 35755337, "question_id": 35751328, "link": "https://stackoverflow.com/questions/35751328/what-is-the-justification-for-the-type-of-unfoldr-in-haskell/35755337#35755337", "title": "What is the justification for the type of unfoldr in Haskell?", "body": "<p>Leveraging a bit of theory, one can recover the types for folds/unfolds of a recursive type, including lists, understanding why they are what they are.</p>\n\n<p>Let <code>A</code> be a fixed type. The type \"list of <code>A</code>s\" satisfies the isomorphism</p>\n\n<pre><code>List ~~ Either () (A, List)\n</code></pre>\n\n<p>which can be read \"a list value is either a special value (the empty list), or a value of type <code>A</code> followed by a list value\". </p>\n\n<p>In a more succinct notation we could write <code>Either</code> as an infix <code>+</code>:</p>\n\n<pre><code>List ~~ () + (A, List)\n</code></pre>\n\n<p>Now, if we let <code>F b = () + (A, b)</code>, we have that</p>\n\n<pre><code>List ~~ F List\n</code></pre>\n\n<p>The above is a fixed point equation, which always arises when using recursive types. For any recursive type defined by <code>T ~~ F T</code> we can \nderive the type of the related folds/unfolds (also known as <code>cata/ana</code> or induction/coinduction principles)</p>\n\n<pre><code>fold   :: (F b -&gt; b) -&gt; T -&gt; b\nunfold :: (b -&gt; F b) -&gt; b -&gt; T\n</code></pre>\n\n<p>In the case of lists, we then obtain</p>\n\n<pre><code>fold    :: ((() + (A, b)) -&gt; b) -&gt; List -&gt; b\nunfoldr :: (b -&gt; (() + (A, b))) -&gt; b -&gt; List \n</code></pre>\n\n<p>The unfold can also be rewritten noting that <code>Maybe c ~~ () + c</code>:</p>\n\n<pre><code>unfoldr :: (b -&gt; Maybe (A, b)) -&gt; b -&gt; List \n</code></pre>\n\n<p>The fold can instead be rewritten using</p>\n\n<pre><code>((x + y) -&gt; z) ~~ (x -&gt; z, y -&gt; z)\n</code></pre>\n\n<p>getting</p>\n\n<pre><code>foldr :: (() -&gt; b, (A, b) -&gt; b) -&gt; List -&gt; b\n</code></pre>\n\n<p>then, since <code>() -&gt; b ~~ b</code>,</p>\n\n<pre><code>foldr :: (b, (A, b) -&gt; b) -&gt; List -&gt; b\n</code></pre>\n\n<p>finally, since <code>(x, y) -&gt; z ~~ x -&gt; y -&gt; z</code> (currying), we have</p>\n\n<pre><code>foldr :: b -&gt; ((A, b) -&gt; b) -&gt; List -&gt; b\n</code></pre>\n\n<p>and again:</p>\n\n<pre><code>foldr :: b -&gt; (A -&gt; b -&gt; b) -&gt; List -&gt; b\n</code></pre>\n\n<p>and with a final flip <code>x -&gt; y -&gt; z ~~ y -&gt; x -&gt; z</code>:</p>\n\n<pre><code>foldr :: (A -&gt; b -&gt; b) -&gt; b -&gt; List -&gt; b\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>How do those types follow from the (co)induction principles?</p>\n</blockquote>\n\n<p>Domain theory states that least fixed points (<code>F(T)=T</code>) coincide with least\nprefixed points (<code>F(T)&lt;=T</code>), when <code>F</code> is monotonic over a certain poset.</p>\n\n<p>The induction principle simple states that, if <code>T</code> is the least prefixed point, and <code>F(U)&lt;=U</code>, then <code>T&lt;=U</code>. (Proof. It is the <em>least</em>!. QED.)\nIn formulae,</p>\n\n<pre><code>(F(U) &lt;= U)  ==&gt;  (T &lt;= U)\n</code></pre>\n\n<p>To deal with fixed points over types, we need to switch from posets to categories, which makes everything more complex. Very, very roughly, every <code>&lt;=</code> is replaced with some morphism. For instance, <code>F(U)&lt;=U</code> now means that there is some morphism <code>F U -&gt; U</code>. \"Monotonic <code>F</code>\" means that <code>F</code> is a functor (since <code>a&lt;=b</code> implying <code>F(a)&lt;=F(b)</code> now becomes <code>(a-&gt;b)</code> implying <code>F a -&gt; F b</code>). Prefixed points are F-algebras (<code>F u -&gt; u</code>). \"Least\" becomes \"initial\". And so on.</p>\n\n<p>Hence the type of fold: (implication is <code>-&gt;</code> as well)</p>\n\n<pre><code>fold   :: (F u -&gt; u) -&gt; (T -&gt; u)\n</code></pre>\n\n<p>Unfold derives from the coinduction principle, which deals with greatest postfix points <code>T</code> (which become coalgebras)</p>\n\n<pre><code>(U &lt;= F(U)) ==&gt; (U &lt;= T)\n</code></pre>\n"}], "owner": {"reputation": 1281, "user_id": 5600363, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d820760191b1bb057846d5a06c2bf5b6?s=128&d=identicon&r=PG", "display_name": "hkBst", "link": "https://stackoverflow.com/users/5600363/hkbst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1038, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1478637443, "creation_date": 1456932160, "last_edit_date": 1478637443, "question_id": 35751328, "link": "https://stackoverflow.com/questions/35751328/what-is-the-justification-for-the-type-of-unfoldr-in-haskell", "title": "What is the justification for the type of unfoldr in Haskell?", "body": "<p>The example given in the documentation of <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Data-List.html#v:unfoldr\" rel=\"nofollow\"><code>unfoldr :: (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]</code></a>:</p>\n\n<pre><code>unfoldr (\\b -&gt; if b == 0 then Nothing else Just (b, b-1)) 10\n</code></pre>\n\n<p>can easily be written with a redundant pair:</p>\n\n<pre><code>unfoldr (\\b -&gt; if b == 1 then Nothing else Just (b-1, b-1)) 11\n</code></pre>\n\n<p>What does <code>unfoldr</code> need the pair <code>(a,b)</code> for? Why is its type not <code>(a -&gt; Maybe a) -&gt; a -&gt; [a]</code>?</p>\n"}, {"tags": ["haskell", "recursion", "fixpoint-combinators"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1456934860, "post_id": 35750749, "comment_id": 59177889, "body": "I think you are assuming that because the type variable in both types is called <code>a</code>, it must be the same type. This is not the case - when you have a function <code>fix :: (a -&gt; a) -&gt; a</code> what you really have is <code>forall a . (a -&gt; a) -&gt; a</code>. Here <code>a</code> can be instantiated to any type at all. In this case, you have <code>a ~ (x -&gt; x)</code> so <code>fix :: ((x -&gt; x) -&gt; (x -&gt; x)) -&gt; x -&gt; x</code> takes two arguments."}], "answers": [{"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 1, "last_activity_date": 1456931032, "creation_date": 1456931032, "answer_id": 35750875, "question_id": 35750749, "link": "https://stackoverflow.com/questions/35750749/haskell-type-and-fix-recursion-examples/35750875#35750875", "title": "Haskell type and fix recursion examples", "body": "<p>You can read the type of the lambda as:</p>\n\n<pre><code>(b -&gt; b) -&gt; (b -&gt; b)\n</code></pre>\n\n<p>which may make it clearer what happens when you provide it to <code>fix</code>. The returned value is another function <code>b -&gt; b</code> which it then immediately applied with the argument <code>5</code> in your example.</p>\n"}], "owner": {"reputation": 25, "user_id": 6008385, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153918442768798/picture?type=large", "display_name": "Jean-Baptiste Zeller", "link": "https://stackoverflow.com/users/6008385/jean-baptiste-zeller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 35750875, "answer_count": 1, "score": 1, "last_activity_date": 1563169639, "creation_date": 1456930699, "last_edit_date": 1563169639, "question_id": 35750749, "link": "https://stackoverflow.com/questions/35750749/haskell-type-and-fix-recursion-examples", "title": "Haskell type and fix recursion examples", "body": "<p>When reading about fix because I was interested in having recursive lambdas in my code I came upon this particular example of code (from <a href=\"https://en.wikibooks.org/wiki/Haskell/Fix_and_recursion\" rel=\"nofollow\">Here</a>):</p>\n\n<pre><code>fix (\\rec n -&gt; if n == 0 then 1 else n * rec (n-1)) 5\n</code></pre>\n\n<p>Now ignoring the type signature of fix I feel something's wrong with that piece of code :</p>\n\n<p>The type of fix is <code>(a -&gt; a) -&gt; a</code> while the type of the lambda is <code>(a -&gt; a) -&gt; a -&gt; a</code> I'm sure I'm reading this piece of code wrong but the way I first read it was \"fix is applied to two argument\" which is wrong because fix only accept one argument, a function (a -> a), there must be something I'm clearly missing.</p>\n\n<p>I then looked at the type of the lambda, and the type of fix and it seemed to me \"hang on, isn't there a huge mismatch? I can understand that with curried function you can feed a function of type <code>a -&gt; a -&gt; a</code> not enough argument to create a new function, but here I'm feeding <code>(a -&gt; a) -&gt; a -&gt; a</code> to a <code>(a -&gt; a) -&gt; a</code> functions, it seems like I'm trying to pass an elephant through a pinhole, feeding the wrong argument to the fix function.</p>\n\n<p>Where did my internal parser and type checker (brain 1.0) go wrong in evaluating this line?</p>\n"}, {"tags": ["haskell", "recursion", "sudoku", "backtracking"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1456929629, "post_id": 35750123, "comment_id": 59173731, "body": "You have a list of candidate boards, and a function that solves.."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4424299"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1456931879, "post_id": 35750123, "comment_id": 59175605, "body": "@n.m. Yes I know, I&#39;m not quite sure what you mean?"}, {"owner": {"reputation": 86, "user_id": 4456770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9939c63a637b6b1d01f386aa28785a42?s=128&d=identicon&r=PG&f=1", "display_name": "isanco", "link": "https://stackoverflow.com/users/4456770/isanco"}, "edited": false, "score": 0, "creation_date": 1456932584, "post_id": 35750123, "comment_id": 59176154, "body": "Further hint:  <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:filter\" rel=\"nofollow noreferrer\">filter</a>"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1456934244, "last_edit_date": 1456934244, "creation_date": 1456933859, "answer_id": 35751990, "question_id": 35750123, "link": "https://stackoverflow.com/questions/35750123/backtrack-sudoku-in-haskell/35751990#35751990", "title": "Backtrack sudoku in haskell", "body": "<p>You could implement a backtracking solution over a (partial) solution space (like all possible <code>Board</code>s) <code>S</code> with a type signature like:</p>\n\n<pre><code>backtrack :: S -&gt; [S]\n</code></pre>\n\n<p>With <code>S</code> the current state, and <code>[S]</code> the list of all valid boards. Now there are in general three possible options:</p>\n\n<ul>\n<li><p>We have found a state that is <code>solved</code>, we return a list (<em>singleton</em>) containing our solution:</p>\n\n<pre><code>backtrack s | solved s = [s]\n</code></pre></li>\n<li><p>We have found a dead trail, in that case we no longer put effort into it, and return an empty list:</p>\n\n<pre><code>            | invalid s = []\n</code></pre></li>\n<li><p>or it is possible we have to deploy our solution further, we generate <code>children</code>: states that have advanced one step from <code>s</code>, and call backtrack recursively, we return the <code>concat</code> of all the <code>backtrack</code>s of these children:</p>\n\n<pre><code>            | otherwise = concatMap backtrack $ children s\n</code></pre></li>\n</ul>\n\n<p>Or putting it all together:</p>\n\n<pre><code>backtrack :: S -&gt; [S]\nbacktrack s | solved s = [s]\n            | invalid s = []\n            | otherwise = concatMap backtrack $ children s\n</code></pre>\n\n<p>The <code>invalid</code> guard can be omitted by simply generating an empty list of <code>children</code> for <code>invalid</code> states (as your solution will probably do) or by preventing to ever generate invalid <code>Board</code>s.</p>\n\n<p>Now grounding this for your problem, generating <code>children</code> would come down to your <code>nextBoards</code> function:</p>\n\n<pre><code>children = nextBoards\n</code></pre>\n\n<p>or prettifying your function a bit:</p>\n\n<pre><code>children :: Board -&gt; [Board]\nchildren s = [update s y x v | v &lt;- options s y x]\n    where (x,y) = findFirstEmpty s\n</code></pre>\n\n<p>Now the solve (or <code>backtrack</code>) method is defined as:</p>\n\n<pre><code>backtrack :: Board -&gt; [Board]\nbacktrack s | not (notEmpty s) = [s]\n            | otherwise = concatMap backtrack $ children s\n</code></pre>\n\n<p><code>backtrack</code> will generate a list of <em>all</em> valid solved Sudoku boards (where the originally places filled in, remain filled in). The list is generated lazily, so if you want <em>one</em> valid solution, you can simply use <code>head</code>:</p>\n\n<pre><code>solve :: Board -&gt; Board\nsolve = head . backtrack\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4424299"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1251, "favorite_count": 1, "accepted_answer_id": 35751990, "answer_count": 1, "score": 2, "last_activity_date": 1456934244, "creation_date": 1456929207, "question_id": 35750123, "link": "https://stackoverflow.com/questions/35750123/backtrack-sudoku-in-haskell", "title": "Backtrack sudoku in haskell", "body": "<p>I'm trying to build a backtrack sudoku solver in Haskell. But I'm stuck at one of the final points. I created a function called nextBoards which returns all possible soduko boards where the next empty place is filled in with the possible values. Now I'm trying to use backtracking in Haskell, but I cannot use things like while-loops and now I'm really confused on how to do this. I've made a sudoku solver before in Java, but I'm completely stuck on how to do it in Haskell for the moment.</p>\n\n<pre><code>-- Generate the next boards for a given board\nnextBoards :: Board -&gt; [Board]\nnextBoards b = \n    let position = findFirstEmpty b\n    in [update z (snd position) (fst position) b | z &lt;- options b (snd position) (fst position)]\n\n-- We found the real solution\nsolve :: Board -&gt; [Board] -&gt; Board\nsolve focus options\n    | not (notEmpty focus) = focus\n-- We hit a dead path try the next option\nsolve focus options\n    | solve (head options) (tail options)\n-- We are solving the focus, generate the next boards\n-- and save the rest in the options\nsolve focus options\n    | solve (head (nextBoards focus)) (tail (nextBoards focus))\n</code></pre>\n\n<p>I really don't know on how to proceed.</p>\n"}, {"tags": ["haskell", "type-kinds", "haskell-ivory"], "comments": [{"owner": {"reputation": 773, "user_id": 1133157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c2925a7b468041c60bb15e20f79d058?s=128&d=identicon&r=PG", "display_name": "grwlf", "link": "https://stackoverflow.com/users/1133157/grwlf"}, "edited": false, "score": 1, "creation_date": 1456928294, "post_id": 35749491, "comment_id": 59172600, "body": "I&#39;ve also tried rewriting AreaStorage as GADT with the same result"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 1, "creation_date": 1456929630, "post_id": 35749491, "comment_id": 59173733, "body": "I can&#39;t reproduce your result: <code>f :: forall t . (IvoryArea t) =&gt; t </code> get rejected by GHC for the same reason on my machine. Would you consider posting the implementation of it?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1456941867, "post_id": 35749491, "comment_id": 59182838, "body": "Most likely your <code>f</code> actually has a type like <code>forall t. (IvoryArea t) =&gt; Proxy t -&gt; ...</code>."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1456957854, "post_id": 35749491, "comment_id": 59192294, "body": "So... you write that you &quot;want to store instances of IvoryArea&quot;. consider what an instance would be. In particular <code>IvoryArea :: Area * -&gt; GHC.Prim.Constraint</code>. But what is a value level inhabitant of <code>Area *</code> ? Types that are of kinds created by <code>DataKinds</code> don&#39;t have inhabitants..."}, {"owner": {"reputation": 773, "user_id": 1133157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c2925a7b468041c60bb15e20f79d058?s=128&d=identicon&r=PG", "display_name": "grwlf", "link": "https://stackoverflow.com/users/1133157/grwlf"}, "edited": false, "score": 0, "creation_date": 1456993342, "post_id": 35749491, "comment_id": 59205360, "body": "Looks like you are right. f :: forall t . (IvoryArea t) =&gt; t  is rejected actually. I&#39;ll fix the question."}, {"owner": {"reputation": 773, "user_id": 1133157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c2925a7b468041c60bb15e20f79d058?s=128&d=identicon&r=PG", "display_name": "grwlf", "link": "https://stackoverflow.com/users/1133157/grwlf"}, "edited": false, "score": 0, "creation_date": 1456993390, "post_id": 35749491, "comment_id": 59205396, "body": "By &quot;storing the instances&quot; I mean I want to store datatypes which are instances of IvoryArea"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1456994002, "post_id": 35749491, "comment_id": 59205785, "body": "So... what datatype could possibly be an instance of IvoryArea? Remember, values are inhabitants of kind <code>*</code> not kind <code>Area *</code>..."}, {"owner": {"reputation": 773, "user_id": 1133157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c2925a7b468041c60bb15e20f79d058?s=128&d=identicon&r=PG", "display_name": "grwlf", "link": "https://stackoverflow.com/users/1133157/grwlf"}, "edited": false, "score": 0, "creation_date": 1456996240, "post_id": 35749491, "comment_id": 59207244, "body": "Lets see how they do it. <a href=\"https://github.com/GaloisInc/ivory/blob/master/ivory/src/Ivory/Language/Struct.hs\" rel=\"nofollow noreferrer\">Struct.hs</a>  contains the definition of type which are IvoryArea. Another example is <a href=\"https://github.com/GaloisInc/ivory/blob/master/ivory/src/Ivory/Language/CArray.hs\" rel=\"nofollow noreferrer\">CArray.hs</a> . They indeed do it in a tricky way: a) derive helper <code>instance (IvoryStruct sym, ASymbol sym) =&gt; IvoryArea (&#39;Struct sym)</code>  b) derive helper class  <code>IvoryStruct</code> and only <i>then</i> c) gain access to <code>ivoryArea</code> function in <code>(~&gt;)</code> definition. Looks like I don&#39;t understand completely how do kinds work."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 4, "creation_date": 1456996290, "post_id": 35749491, "comment_id": 59207285, "body": "&quot;I mean I want to store datatypes which are instances of IvoryArea&quot; - You can only &quot;store&quot; values. There seems to be some critical misunderstanding about what a &quot;value&quot; is. There are no values of type <code>&#39;Stored Int</code>, for example. Not even <code>undefined</code>, whose type is <code>forall (a :: *) . a</code>. Strictly speaking, values are not inhabitants of kind <code>*</code> - types of kind <code>*</code> are inhabitants of kind <code>*</code>. Values are inhabitants of types of kind <code>*</code>. You probably want to define a type indexed on Area (whose kind will be <code>Area * -&gt; *</code>, perhaps, or maybe even <code>Area k -&gt; *</code>)."}, {"owner": {"reputation": 773, "user_id": 1133157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c2925a7b468041c60bb15e20f79d058?s=128&d=identicon&r=PG", "display_name": "grwlf", "link": "https://stackoverflow.com/users/1133157/grwlf"}, "edited": false, "score": 0, "creation_date": 1456996860, "post_id": 35749491, "comment_id": 59207669, "body": "I thought that <code>class IvoryArea (a :: Area *)</code> differs from <code>class IvoryType a</code> in that we accept not every type (*) but only a type of specific kind (Area *). But still we are speaking about <i>types</i> which can have values in both cases.. Looks like it was the source of my mistake."}, {"owner": {"reputation": 773, "user_id": 1133157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c2925a7b468041c60bb15e20f79d058?s=128&d=identicon&r=PG", "display_name": "grwlf", "link": "https://stackoverflow.com/users/1133157/grwlf"}, "edited": false, "score": 0, "creation_date": 1456997047, "post_id": 35749491, "comment_id": 59207819, "body": "Actually I want to express a type-level constraint which would filter for me all types for which <code>ivoryArea</code>  function is defined. The presence of typeclass <code>IvoryArea</code> tells me that in runtime there will be some types which have <code>ivoryArea</code> function associated with them. I&#39;d like to separate them from any others. The question is how to express it in Haskell"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1456997062, "post_id": 35749491, "comment_id": 59207828, "body": "<i>Only</i> the kind <code>*</code> has values. No other kind has values (ignoring primitive stuff). <code>Area *</code> is not a &quot;subkind&quot; of <code>*</code> or anything of the sort - they are distinct kinds. See <a href=\"http://stackoverflow.com/questions/27924699/unusual-kinds-and-data-constructors?rq=1\">this</a> question."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1456997193, "post_id": 35749491, "comment_id": 59207921, "body": "&quot;I want to express a type-level constraint which would filter for me all types for which ivoryArea function is defined.&quot; Unfortunately this is impossible, but for a completely different reason. You cannot, in any fashion, retrieve &quot;all the instances of a class&quot;. Classes are open, so anyone can one day come along and add a new instance."}, {"owner": {"reputation": 773, "user_id": 1133157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c2925a7b468041c60bb15e20f79d058?s=128&d=identicon&r=PG", "display_name": "grwlf", "link": "https://stackoverflow.com/users/1133157/grwlf"}, "edited": false, "score": 0, "creation_date": 1456997424, "post_id": 35749491, "comment_id": 59208083, "body": "&quot;..tells me that in runtime there will be some types which have ivoryArea function associated with them.. &quot;  s/types/values"}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 2, "last_activity_date": 1457031757, "creation_date": 1457031757, "answer_id": 35780758, "question_id": 35749491, "link": "https://stackoverflow.com/questions/35749491/creating-haskell-datatype-accepting-type-of-non-kind-in-one-of-its-constructor/35780758#35780758", "title": "Creating Haskell datatype accepting type of non-* kind in one of its constructors", "body": "<p>Now that we've established in the comments that you can't do what you want directly, which is create a special \"subkind\" of all types, we <em>can</em> use a bit more legwork to get what you want.</p>\n\n<p>We just use a (closed) type family to interpret your <code>Area *</code> kind into something of kind <code>*</code> and then GADT, indexed by <code>Area *</code>, to hold such values. We can then wrap the whole shebang up in an existential to store arbitrary values of such a kind, if so desired.</p>\n\n<p>Consider this cut down example:</p>\n\n<pre><code>data Area k\n  = Stored k\n  | List (Area k)\n\ntype family InterpIvoryArea a :: * where\n    InterpIvoryArea (Stored k) = k\n    InterpIvoryArea (List a) = [InterpIvoryArea a]\n\ndata AreaStorage a where\n    AreaStorage :: InterpIvoryArea a -&gt; AreaStorage a\n\ndata AreaStorageExistential where\n    AreaStorageExistential :: AreaStorage a -&gt; AreaStorageExistential\n\ntestValue :: AreaStorageExistential\ntestValue = AreaStorageExistential (AreaStorage [1,2,3] :: AreaStorage (List (Stored Int)))\n</code></pre>\n"}], "owner": {"reputation": 773, "user_id": 1133157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c2925a7b468041c60bb15e20f79d058?s=128&d=identicon&r=PG", "display_name": "grwlf", "link": "https://stackoverflow.com/users/1133157/grwlf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 1, "accepted_answer_id": 35780758, "answer_count": 1, "score": 4, "last_activity_date": 1459423699, "creation_date": 1456927674, "last_edit_date": 1459423699, "question_id": 35749491, "link": "https://stackoverflow.com/questions/35749491/creating-haskell-datatype-accepting-type-of-non-kind-in-one-of-its-constructor", "title": "Creating Haskell datatype accepting type of non-* kind in one of its constructors", "body": "\n\n<p>Hello. I am playing with Ivory library which relies heavily on modern features of Haskell. Among others, it defines the typeclasses <code>IvoryType</code> accepting all types and <code>IvoryArea</code> accepting types of special kind <code>Area</code>. The definitions look like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE ExistentialQuantification #-}\n\n-- | Proxy datatype with a phantom arbitrary-kinded type\n-- and a single constructor \ndata Proxy (a :: k) = Proxy\n\n-- | The kind of memory-area types.\ndata Area k\n  = Struct Symbol\n  | Array Nat (Area k)\n  | CArray (Area k)\n  | Stored k\n    -- ^ This is lifting for a *-kinded type\n\nclass IvoryType t where\n  ivoryType :: Proxy t -&gt; I.Type {- arguments are not important -}\n\n-- | Guard the inhabitants of the Area type, as not all *s are Ivory *s.\nclass IvoryArea (a :: Area *) where\n  ivoryArea :: Proxy a -&gt; I.Type {- arguments are not important -}\n</code></pre>\n\n<p>OK. Now let's try to express the fact that we are going to store values with <code>ivoryType</code> function defined. Obviously, they <em>are</em> the memebers of <code>IvoryType</code> class, so the answer is</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data TypeStorage = TypeStorage (forall t . IvoryType t =&gt; t)\n</code></pre>\n\n<p>So far so good. Now we want to store values which have <code>ivoryArea</code> function defined. Let's use the <code>IvoryArea</code> class as a filter condition, like in the prevoius case: </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data AreaStorage = AreaStorage (forall t . IvoryArea t =&gt; t)\n</code></pre>\n\n<p>Surprisingly, the compiler (ghc version 7.8.4) outputs an error</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>src/IvoryLL/Types.hs:59:45:\n    Expected a type, but \u2018t\u2019 has kind \u2018Area *\u2019\n    In the type \u2018forall t. IvoryArea t =&gt; t\u2019\n    In the definition of data constructor \u2018AreaBase\u2019\n    In the data declaration for \u2018Area\n</code></pre>\n\n<p>Could you please explain, how to express the ownership of <code>ivoryArea</code> function in Haskell properly ?</p>\n\n<p><strong>Edit</strong>\nSome links to the original declarations:</p>\n\n<ul>\n<li><a href=\"https://github.com/GaloisInc/ivory/blob/master/ivory/src/Ivory/Language/Type.hs\" rel=\"nofollow\">https://github.com/GaloisInc/ivory/blob/master/ivory/src/Ivory/Language/Type.hs</a></li>\n<li><a href=\"https://github.com/GaloisInc/ivory/blob/master/ivory/src/Ivory/Language/Area.hs\" rel=\"nofollow\">https://github.com/GaloisInc/ivory/blob/master/ivory/src/Ivory/Language/Area.hs</a></li>\n</ul>\n"}, {"tags": ["haskell", "standard-library", "haskell-platform"], "answers": [{"comments": [{"owner": {"reputation": 597, "user_id": 2157021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5f361d3bd72832787dc2b79ce78de71?s=128&d=identicon&r=PG", "display_name": "amar47shah", "link": "https://stackoverflow.com/users/2157021/amar47shah"}, "edited": false, "score": 1, "creation_date": 1456931323, "post_id": 35749543, "comment_id": 59175165, "body": "And of course, you can do <code>iterateMaybe f x = x : helper f x</code> where <code>helper</code> has the definition of <code>iterateMaybe</code> given in the answer. That gives you the list starting at the initial element."}], "tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 13, "last_activity_date": 1456928295, "last_edit_date": 1456928295, "creation_date": 1456927803, "answer_id": 35749543, "question_id": 35749318, "link": "https://stackoverflow.com/questions/35749318/is-there-a-standard-haskell-function-like-iterate-that-stops-for-nothing/35749543#35749543", "title": "Is there a standard Haskell function like iterate that stops for Nothing?", "body": "<p>It's a special case of <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Data-List.html#v:unfoldr\" rel=\"noreferrer\"><code>unfoldr</code></a>.</p>\n\n<pre><code>iterateMaybe f = unfoldr (fmap (\\s -&gt; (s,s)) . f)\n</code></pre>\n\n<p>The difference is list returned by <code>unfoldr</code> won't include the initial element.</p>\n"}], "owner": {"reputation": 1281, "user_id": 5600363, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d820760191b1bb057846d5a06c2bf5b6?s=128&d=identicon&r=PG", "display_name": "hkBst", "link": "https://stackoverflow.com/users/5600363/hkbst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 566, "favorite_count": 0, "accepted_answer_id": 35749543, "answer_count": 1, "score": 3, "last_activity_date": 1456928295, "creation_date": 1456927209, "question_id": 35749318, "link": "https://stackoverflow.com/questions/35749318/is-there-a-standard-haskell-function-like-iterate-that-stops-for-nothing", "title": "Is there a standard Haskell function like iterate that stops for Nothing?", "body": "<p>I am wondering if there is a standard function that iterates a function that returns a (Maybe value) over an initial value, collecting the values in a list, but ending the list when it gets to Nothing.  This function can be implemented for example like so:</p>\n\n<pre><code>iterateMaybe f a = a : iterMaybe (f a) where\n  iterMaybe Nothing = []\n  iterMaybe (Just a) = a : iterMaybe (f a)\n</code></pre>\n\n<p>or slightly differently like so:</p>\n\n<pre><code>iterateMaybe' f Nothing = []\niterateMaybe' f (Just a) = a : iterateMaybe' f (f a)\n</code></pre>\n\n<p>None of <a href=\"https://www.haskell.org/hoogle/?hoogle=%28a%20-%3E%20%28Maybe%20a%29%29%20-%3E%20a%20-%3E%20[a]\" rel=\"nofollow\">the functions that Hoogle finds</a> match.</p>\n"}, {"tags": ["haskell", "amazon-web-services", "amazon-s3", "cors", "elm"], "comments": [{"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 0, "creation_date": 1456962885, "post_id": 35748838, "comment_id": 59194341, "body": "I would recommend splitting these into two separate questions."}, {"owner": {"reputation": 2387, "user_id": 54024, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/5b42865e660a167f7021ba5ff2d9b8c9?s=128&d=identicon&r=PG", "display_name": "Chad Brewbaker", "link": "https://stackoverflow.com/users/54024/chad-brewbaker"}, "reply_to_user": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 0, "creation_date": 1456963211, "post_id": 35748838, "comment_id": 59194446, "body": "Translating the Python Boto S3 URI signing logic into Haskell isn&#39;t that big of a deal. Might even be quicker to code than shelling out to Boto."}], "answers": [{"tags": [], "owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "is_accepted": false, "score": 1, "last_activity_date": 1463337716, "creation_date": 1463337716, "answer_id": 37242251, "question_id": 35748838, "link": "https://stackoverflow.com/questions/35748838/file-uploads-in-elm-using-pre-signed-uris-to-s3/37242251#37242251", "title": "File uploads in Elm using pre-signed URIs to S3", "body": "<p>Since the 0.17.0 update, this is pretty straightforward. In fact, the documentation has an example that does a CORS post in it.</p>\n\n<p><a href=\"http://package.elm-lang.org/packages/evancz/elm-http/3.0.1/Http\" rel=\"nofollow\">http://package.elm-lang.org/packages/evancz/elm-http/3.0.1/Http</a></p>\n\n<p>... search for <code>corsPost</code></p>\n"}], "owner": {"reputation": 2387, "user_id": 54024, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/5b42865e660a167f7021ba5ff2d9b8c9?s=128&d=identicon&r=PG", "display_name": "Chad Brewbaker", "link": "https://stackoverflow.com/users/54024/chad-brewbaker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1463337716, "creation_date": 1456925945, "last_edit_date": 1495540790, "question_id": 35748838, "link": "https://stackoverflow.com/questions/35748838/file-uploads-in-elm-using-pre-signed-uris-to-s3", "title": "File uploads in Elm using pre-signed URIs to S3", "body": "<p>Is there an Elm library that does CORS signed uploads to AWS S3? Motivation is you want media uploads to go straight to your S3 buckets, not hammer your web/app server.</p>\n\n<p>Here is how you do it <a href=\"https://stackoverflow.com/questions/10044151/how-to-generate-a-temporary-url-to-upload-file-to-amazon-s3-with-boto-library?rq=1\">over curl</a>.</p>\n\n<p>One answer on doing <a href=\"https://stackoverflow.com/questions/35329962/file-upload-in-elm\">regular file uploads in Elm</a>.</p>\n\n<p>Answer on how to do it <a href=\"http://pjambet.github.io/blog/direct-upload-to-s3/\" rel=\"nofollow noreferrer\">with JQuery File Upload</a>.</p>\n\n<p>Also looking for a Haskell library on the server side to do the signing, as it doesn't seem that Amazonka's S3 does the CORS signing yet. Looks like I might have to FFI or shell out for that part just to get going.</p>\n"}, {"tags": ["haskell", "polymorphism"], "comments": [{"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 2, "creation_date": 1456920762, "post_id": 35746742, "comment_id": 59167001, "body": "One simple solution is to evaluate the function without type signature and let ghci infer the type for you. It should generalize <code>Int</code> to <code>Ord a =&gt; a</code>."}, {"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1456920820, "post_id": 35746742, "comment_id": 59167046, "body": "What does it mean: &quot;Ord a =&gt; a&quot;?"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 1, "creation_date": 1456920917, "post_id": 35746742, "comment_id": 59167115, "body": "It&#39;s any type <code>a</code> with an instance of <code>Ord</code>. It&#39;s needed for the use of <code>&lt;=</code> in your function."}], "answers": [{"comments": [{"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1456920796, "post_id": 35746876, "comment_id": 59167029, "body": "OK, after it I got a compilation error ( It is obvious becasue Haskell doesn&#39;t know what does it mean: ((&lt;=) e n). But how to repair it?"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 1, "creation_date": 1456920817, "post_id": 35746876, "comment_id": 59167042, "body": "This type signature is too polymorphic -- you need an <code>Ord a</code> instance for the <code>e &lt;= n</code> bit."}, {"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1456920881, "post_id": 35746876, "comment_id": 59167085, "body": "Ok. How to define my own type and amke him Ord?"}, {"owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "reply_to_user": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 1, "creation_date": 1456921102, "post_id": 35746876, "comment_id": 59167256, "body": "@Gilgamesz Well, that&#39;s a completely different question then the original one. I advise you to search for the answer online. I&#39;m sure you&#39;ll find plenty of useful information to solve your issue."}], "tags": [], "owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "is_accepted": true, "score": 3, "last_activity_date": 1456920920, "last_edit_date": 1456920920, "creation_date": 1456920650, "answer_id": 35746876, "question_id": 35746742, "link": "https://stackoverflow.com/questions/35746742/generalization-of-arguments-types/35746876#35746876", "title": "Generalization of argument&#39;s types", "body": "<p>In order to make a function polymorphic, you need to specify a <em>type variable</em> in the function's signature. Type variables must be specified in lower-case to distinguish them from specific types, which are specified in upper-case.</p>\n\n<pre><code> divide_list :: a -&gt; [a] -&gt; [a] -&gt; [a] -&gt; ([a], [a])\n</code></pre>\n\n<p>Quote from <em>A Gentle Introduction to Haskell</em> tutorial:</p>\n\n<blockquote>\n  <p>Haskell also incorporates polymorphic types---types that are\n  universally quantified in some way over all types. Polymorphic type\n  expressions essentially describe families of types. For example,\n  (forall a)[a] is the family of types consisting of, for every type a,\n  the type of lists of a. Lists of integers (e.g. [1,2,3]), lists of\n  characters (['a','b','c']), even lists of lists of integers, etc., are\n  all members of this family.</p>\n</blockquote>\n\n<p><strong>EDIT after question in comment:</strong></p>\n\n<p>Note that in your function definition you use <code>&lt;=</code>. This is a function defined in the <code>Ord</code> typeclass, so you have to constraint the polymorphic type to be an instance of this typeclass.</p>\n\n<pre><code>divide_list :: (Ord a) =&gt; a -&gt; [a] -&gt; [a] -&gt; [a] -&gt; ([a], [a])\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1456921234, "post_id": 35746996, "comment_id": 59167369, "body": "What does it mean &#39;=&gt;&#39;?"}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 1, "last_activity_date": 1456920982, "creation_date": 1456920982, "answer_id": 35746996, "question_id": 35746742, "link": "https://stackoverflow.com/questions/35746742/generalization-of-arguments-types/35746996#35746996", "title": "Generalization of argument&#39;s types", "body": "<p>The only aspect of <code>Int</code>s you use is that given <code>h</code> and <code>n</code>, you can compute <code>h &lt;= n</code>. This is generalized in the <code>Ord</code> typeclass, so your function can be polymorphic over any choice of type variable <code>a</code>, as long as there is an <code>Ord a</code> instance:</p>\n\n<pre><code>divide_list :: (Ord a) =&gt; a -&gt; [a] -&gt; [a] -&gt; [a] -&gt; ([a], [a])\n</code></pre>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 35746876, "answer_count": 2, "score": 1, "last_activity_date": 1456920982, "creation_date": 1456920336, "last_edit_date": 1456920895, "question_id": 35746742, "link": "https://stackoverflow.com/questions/35746742/generalization-of-arguments-types", "title": "Generalization of argument&#39;s types", "body": "<pre><code>divide_list :: Int -&gt; [Int] -&gt; [Int] -&gt; [Int] -&gt; ([Int], [Int])\n\ndivide_list n [] l r = (l,r)\ndivide_list n (h:t) l r =\n    if h &lt;= n\n      then divide_list n t (h:l) r\n      else divide_list n t l (h:r)\n</code></pre>\n\n<p>As you can see my function takes list of <code>Int</code>. How to modify this code to get more general type? I mean for example list of String etc.</p>\n"}, {"tags": ["haskell", "generics", "polymorphism", "parsec"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1456935228, "post_id": 35746661, "comment_id": 59178168, "body": "<code>many1 (noneOf &quot;\\n&quot;) :: Parser String</code>. You can convert this to an Int in many ways - for example <code>read &lt;$&gt; many1 (noneOf &quot;\\n&quot;) :: Parser Int</code> - but note that the string parsed by <code>many1 (noneOf &quot;\\n&quot;)</code> might not be a number at all. There is a <a href=\"https://hackage.haskell.org/package/parsec-numbers-0.1.0/docs/Text-ParserCombinators-Parsec-Number.html\" rel=\"nofollow noreferrer\">package</a> which provides numeric parsers for Parsec, but if you want to roll your own you&#39;ll have to do something like <code>read &lt;$&gt; many1 (oneOf [&#39;0&#39;..&#39;9&#39;]) :: Parser Int</code>."}], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 1, "last_activity_date": 1456921419, "creation_date": 1456921419, "answer_id": 35747165, "question_id": 35746661, "link": "https://stackoverflow.com/questions/35746661/parsec-intuit-type-from-parsed-string/35747165#35747165", "title": "Parsec: intuit type from parsed string", "body": "<p>The type <code>Parser (Vertex a)</code> is shorthand for <code>forall a. Parser (Vertex a)</code>, i.e. its type states that for <em>any</em> choice of <code>a</code>, it can have type <code>Parser (Vertex a)</code>. This is clearly not what you want: you want to say that <code>parseVertex</code> will always have type <code>Parser (Vertex a)</code> for <em>some</em> choice of <code>a</code>, but this choice is to be made by <code>parseVertex</code>, not at its call site.</p>\n\n<p>What you should do, is use a type <code>T</code> such that <code>Parser (Vertex T)</code> covers all possible return values of <code>parseVertex</code>. For example, if you use <code>Parser (Vertex (Either Int String))</code>, then <code>parseVertex</code> can choose based on the parse results so far if it will return something of the form <code>(s, Left x)</code>, or <code>(s, Right t)</code>, where <code>s :: String</code>, <code>x :: Int</code> and <code>t :: String</code>. </p>\n\n<p>Of course, that also means that consumers of <code>parseVector</code> now have to be able to handle both cases.</p>\n"}], "owner": {"reputation": 2379, "user_id": 5045375, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17ed0af705e0449fe49b74d8814a8ce2?s=128&d=identicon&r=PG", "display_name": "Filip Allberg", "link": "https://stackoverflow.com/users/5045375/filip-allberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 35747165, "answer_count": 1, "score": 0, "last_activity_date": 1456921419, "creation_date": 1456920139, "question_id": 35746661, "link": "https://stackoverflow.com/questions/35746661/parsec-intuit-type-from-parsed-string", "title": "Parsec: intuit type from parsed string", "body": "<p>Is it possible to infer the type from <code>many1</code>?</p>\n\n<h1>MWE</h1>\n\n<pre><code>module Main where\n\nimport System.Environment (getArgs)\nimport Text.ParserCombinators.Parsec\nimport Data.Either (rights)\n\ntype Vertex vertexWeight = (String, vertexWeight)\n\nparseVertex :: Parser (Vertex a)\nparseVertex = do\n  name &lt;- many1 (noneOf \"/\")\n  char '/'\n  weight &lt;- many1 (noneOf \"\\n\")\n  return $ (name, weight)\n\nmain :: IO ()\nmain = do\n     putStrLn $ rights $ [parse parseVertex \"test\" \"a/2\"]\n</code></pre>\n\n<p>In the above example, I'd like for the <code>weight</code> parameter to get outputted as an Int, but this does not type-check.</p>\n\n<p>Would it be wiser to represent a vertex as <code>(String, String)</code> and define parsers for the weight?</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 2, "creation_date": 1456940148, "post_id": 35746328, "comment_id": 59181727, "body": "You may need to solve it with a custom <code>Setup.hs</code> file and a post-install hook. Though in that case, I&#39;d probably just modify your code to set the executable bit before calling <code>createProcess</code>, since custom <code>Setup.hs</code> files can be a PITA"}, {"owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1456940889, "post_id": 35746328, "comment_id": 59182194, "body": "@MichaelSnoyman: But I think that my code wouldn&#39;t necessarily have the permissions to set the executable bit, if it is installed in system dirs and executed by a user"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1456974552, "post_id": 35746328, "comment_id": 59197738, "body": "You&#39;re correct. In that case, you may need to use the Setup.hs option, or resort to ugly tricks like copying the file to a temporary location and then setting the executable bit."}, {"owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1457118933, "post_id": 35746328, "comment_id": 59277838, "body": "@MichaelSnoyman: I now tried using the custom <code>Setup.hs</code> option, but it seems like it can&#39;t be done currently due to Cabal not calling the hooks - <a href=\"https://github.com/haskell/cabal/issues/1805\" rel=\"nofollow noreferrer\">github.com/haskell/cabal/issues/1805</a>"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 1, "creation_date": 1457337333, "post_id": 35746328, "comment_id": 59343514, "body": "How about using the <code>copy</code> hook instead of an <code>install</code> hook?"}], "answers": [{"comments": [{"owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "edited": false, "score": 0, "creation_date": 1457948067, "post_id": 35967464, "comment_id": 59620672, "body": "Regarding the second solution - @MichaelSnoyman also suggested that above but we concluded that it won&#39;t necessarily work since the app may be ran by a user without permissions to change the globally installed data files."}, {"owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "edited": false, "score": 0, "creation_date": 1458737083, "post_id": 35967464, "comment_id": 59992162, "body": "I edited your answer to remove the problematic second solution, to accept the first one as the answer."}, {"owner": {"reputation": 384, "user_id": 4098149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4eff262713ed007414ceb4e35f6b63f5?s=128&d=identicon&r=PG&f=1", "display_name": "Schoon", "link": "https://stackoverflow.com/users/4098149/schoon"}, "edited": false, "score": 0, "creation_date": 1599128359, "post_id": 35967464, "comment_id": 112680433, "body": "I&#39;m a bit lost. I was googling for a working example but no luck. Has this changed in the meantime? Thanks!"}], "tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 3, "last_activity_date": 1458737043, "last_edit_date": 1458737043, "creation_date": 1457852042, "answer_id": 35967464, "question_id": 35746328, "link": "https://stackoverflow.com/questions/35746328/cabal-executable-data-files/35967464#35967464", "title": "Cabal: executable data-files", "body": "<p>As summarized in some <a href=\"https://github.com/haskell/cabal/commit/dda6ffed28f10f521f9c0d3cb0773a46ae3940f1\" rel=\"nofollow\">discussion</a> on cabal patches, the current (underdocumented) state of play is that one should use both a copy <em>and</em> an install hook, since one or the other will get executed.</p>\n\n<p>Edit: After some digging, there's an <a href=\"https://github.com/haskell/cabal/issues/708\" rel=\"nofollow\">old ticket on libexec support</a> in cabal, which would be a very nice solution if it were implemented.</p>\n"}], "owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 0, "accepted_answer_id": 35967464, "answer_count": 1, "score": 5, "last_activity_date": 1458737043, "creation_date": 1456919220, "question_id": 35746328, "link": "https://stackoverflow.com/questions/35746328/cabal-executable-data-files", "title": "Cabal: executable data-files", "body": "<p>I want to include an executable file in the cabal <code>data-files</code> section to execute it as a subprocess in my Haskell program.</p>\n\n<p>The file's there, <code>getDataFileName</code> works for it, but it lacks the executable bit and so trying to run it with <code>System.Process.createProcess</code> fails with <code>permission denied</code>.</p>\n\n<p>Is there a way for cabal to preserve the execution permission of the file? Is there another clean way to solve this?</p>\n"}, {"tags": ["haskell", "overloading"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1456916570, "post_id": 35745191, "comment_id": 59163976, "body": "You want to use <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/type-families.html\" rel=\"nofollow noreferrer\">type families</a> for that."}], "answers": [{"comments": [{"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1456972399, "post_id": 35746641, "comment_id": 59197087, "body": "Thanks for the thorough response!  Do you have anything to add regarding how the &quot;type families&quot; affect this in terms of what they offer, regarding what Bakuriu&#39;s answer demonstrates?"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "reply_to_user": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1457002160, "post_id": 35746641, "comment_id": 59211613, "body": "@HostileFork Type family is crucial, even necessary once you want the return type of <code>adjust</code> to follow some rules instead of simply matching the input type, e.g. <code>adjust :: AdjusterType Int -&gt; Double</code> and <code>adjust  :: AdjusterType Double -&gt; Int</code>, in that case type family is usually either the only solution or the best regarding type inference, code style etc. For your current use case it&#39;s a possible (maybe more extensible) solution among others."}], "tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 3, "last_activity_date": 1456933192, "last_edit_date": 1456933192, "creation_date": 1456920098, "answer_id": 35746641, "question_id": 35745191, "link": "https://stackoverflow.com/questions/35745191/can-overloading-via-flexibleinstances-return-different-types-or-match-on-type/35746641#35746641", "title": "Can &quot;overloading&quot; via FlexibleInstances return different types, or match on typeclasses?", "body": "<blockquote>\n  <p>Is it possible to make the Integer version of adjust return an Integer, and the Double version return a Double?</p>\n</blockquote>\n\n<p>You can make the <code>Adjustable</code> type class accept two type parameters instead of one, so it will know what's inside the <code>AdjusterType</code>:</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n\nclass Adjustable f a where\n    adjust :: f a -&gt; a\n</code></pre>\n\n<p>Then the instances should be:</p>\n\n<pre><code>instance Adjustable AdjusterType Int where\n    adjust (Adjuster a) = a + 20\n\ninstance Adjustable AdjusterType Double where\n    adjust (Adjuster a) = a + 0.04\n</code></pre>\n\n<p>And some results from ghci:</p>\n\n<pre><code>&gt; :set +t\n\n&gt; adjust (Adjuster (100 :: Int))\n&lt; 120\n&lt; it :: Int\n&gt; adjust (Adjuster (100 :: Double))\n&lt; 100.04\n&lt; it :: Double\n</code></pre>\n\n<blockquote>\n  <p>What type was it expecting here that Integer isn't matching...or would no type actually work and it's just a weird error message?</p>\n</blockquote>\n\n<p>The return type of <code>adjust</code> is of type <code>forall n . Num n =&gt; n</code>, a polymorphic type with a single constraint <code>Num</code>, so your function returning a concrete type won't type check. Wrap your function with <code>fromIntegral</code> will solve the problem since <code>fromIntegral :: (Integral a, Num b) =&gt; a -&gt; b</code>.</p>\n\n<blockquote>\n  <p>Is there any way to provide an overloaded behavior like above to a type class, or must it always be to a specific instance?</p>\n</blockquote>\n\n<p>If you expect the function to behave differently for every distinct type, yes you have to add an instance for each. You may add some default behavior though, by restricting the type parameters of the class:</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor         #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n\nclass Extract f where\n  extract :: f a -&gt; a\n\nclass (Extract f, Functor f, Num a) =&gt; Adjustable f a where\n  adjust :: f a -&gt; a\n  adjust = extract . fmap (+20)\n\ndata AdjusterType a = Adjuster a\n  deriving (Functor)\n\ninstance Extract AdjusterType where\n  extract (Adjuster a) = a\n\ninstance Adjustable AdjusterType Int where\n-- don't have to write any code here\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1456972258, "post_id": 35757712, "comment_id": 59197046, "body": "Interesting, thanks for the example.  Okay, of the questions asked...this appears to be able to address <i>&quot;Is it possible to make the Integer version of adjust return an Integer, and the Double version return a Double?&quot;</i>, this accomplishes that without parameterizing Adjustable with another type.  Is this required for that, or is there something like <code>adjust (Adjuster a) = a + (20 :: Integer)</code> which could do the same trick?  That doesn&#39;t work (complains about Double, even though it&#39;s the Integer case)...is the purpose of this to fix that?"}], "tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": false, "score": 2, "last_activity_date": 1456951600, "creation_date": 1456951600, "answer_id": 35757712, "question_id": 35745191, "link": "https://stackoverflow.com/questions/35745191/can-overloading-via-flexibleinstances-return-different-types-or-match-on-type/35757712#35757712", "title": "Can &quot;overloading&quot; via FlexibleInstances return different types, or match on typeclasses?", "body": "<p>A solution using type families, in particular associated data types, is the following:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies, FlexibleInstances #-}\n\nclass Adjustable a where\n    type Elem a :: *\n    adjust :: a -&gt; Elem a\n\n\ndata AdjusterType a = Adjuster a\n    deriving (Show)\n\n\ninstance Adjustable (AdjusterType Integer) where\n    type Elem (AdjusterType Integer) = Integer\n\n    adjust (Adjuster a) = a + 20\n\ninstance Adjustable (AdjusterType Double) where\n    type Elem (AdjusterType Double) = Double\n\n    adjust (Adjuster a) = a + 0.04\n\nmain = do\n    let x = Adjuster 1 :: AdjusterType Integer\n        y = Adjuster 1 :: AdjusterType Double\n    print $ adjust x\n    print $ adjust y\n</code></pre>\n\n<p>It compiles and the output is:</p>\n\n<pre><code>21\n1.04\n</code></pre>\n"}], "owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 1, "accepted_answer_id": 35746641, "answer_count": 2, "score": 3, "last_activity_date": 1456951600, "creation_date": 1456916156, "question_id": 35745191, "link": "https://stackoverflow.com/questions/35745191/can-overloading-via-flexibleinstances-return-different-types-or-match-on-type", "title": "Can &quot;overloading&quot; via FlexibleInstances return different types, or match on typeclasses?", "body": "<p>I'm curious about what kind of \"overloading\" can be accomplished in Haskell's type classes via \"FlexibleInstances\".</p>\n\n<p>As a simple test, here is a case of an AdjusterType datatype.  It defines an <code>adjust</code> operation that will add a different amount to its value based on whether it contains an Integer or a Double:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n\nclass Adjustable a where\n    adjust :: a -&gt; Double\n\ndata AdjusterType a = Adjuster a\n    deriving Show\n\ninstance Adjustable (AdjusterType Integer) where\n    adjust (Adjuster a) = fromIntegral (a + 20)\n\ninstance Adjustable (AdjusterType Double) where\n    adjust (Adjuster a) = a + 0.04\n</code></pre>\n\n<p>That much works as expected:</p>\n\n<pre><code>Prelude&gt; adjust (Adjuster (1000 :: Integer))\n1020.0\n\nPrelude&gt; adjust (Adjuster (3 :: Double))\n3.04\n</code></pre>\n\n<p><strong>Is it possible to make the Integer version of <code>adjust</code> return an Integer, and the Double version return a Double?</strong></p>\n\n<p>Generalizing the signature of <code>adjust</code> and removing the <code>fromIntegral</code> on the integer case doesn't work:</p>\n\n<pre><code>class Adjustable a where\n    adjust :: Num n =&gt; a -&gt; n\n\ninstance Adjustable (AdjusterType Integer) where\n    adjust (Adjuster a) = a + 20\n</code></pre>\n\n<p>This produces an error saying that \"n\" is a rigid type variable that doesn't match Integer:</p>\n\n<pre><code>Couldn't match expected type \u2018n\u2019 with actual type \u2018Integer\u2019\n    \u2018n\u2019 is a rigid type variable bound by\n       the type signature for adjust :: Num n =&gt; AdjusterType Integer -&gt; n\nRelevant bindings include\n    adjust :: AdjusterType Integer -&gt; n\nIn the first argument of \u2018(+)\u2019, namely \u2018a\u2019\nIn the expression: a + 20\n</code></pre>\n\n<p><strong>What type was it expecting here that Integer isn't matching...or would no type actually work and it's just a weird error message?</strong>  <em>(n is lowercase, so presumably it knows it's not a datatype)</em></p>\n\n<p>Type constraints in the instance specifications also don't appear to participate in the matching resolution:</p>\n\n<pre><code>instance Integral i =&gt; Adjustable (AdjusterType i) where\n    adjust (Adjuster a) = fromIntegral (a + 20)\n\ninstance RealFloat r =&gt; Adjustable (AdjusterType r) where\n    adjust (Adjuster a) = a + 0.04\n</code></pre>\n\n<p>So these act like duplicates, as if they were both <code>Adjustable (AdjusterType x))</code>.  The constraint only applies after the resolution is done.</p>\n\n<p><strong>Is there any way to provide an overloaded behavior like above to a type class, or must it always be to a specific instance?</strong></p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 4, "creation_date": 1456913059, "post_id": 35742643, "comment_id": 59161396, "body": "This would lead to recursive definitions: the <code>Monad</code> instance functions are defined in terms of the <code>Applicative</code> instance functions, so you can&#39;t also go the other way."}], "answers": [{"tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 7, "last_activity_date": 1456929994, "last_edit_date": 1456929994, "creation_date": 1456916908, "answer_id": 35745477, "question_id": 35742643, "link": "https://stackoverflow.com/questions/35742643/ghc-7-10-x-migration-why-cant-one-write-pure-return-in-the-instance-applic/35745477#35745477", "title": "GHC 7.10.x migration: why can&#39;t one write &quot;pure = return&quot; in the instance Applicative?", "body": "<p>As @WillSewell hinted in the comment, from <code>base-4.8.0.0</code> now <code>return</code> in type class <code>Monad</code> has a default implementation:</p>\n\n<pre><code>class Applicative m =&gt; Monad m where\n    return      :: a -&gt; m a\n    return      = pure\n</code></pre>\n\n<p>By defining <code>pure = return</code> and forget to implement <code>return</code> manually one may create an infinite loop of definition which will pass the compilation and can only be detected at runtime.</p>\n\n<hr>\n\n<p><code>&gt;&gt;</code> is a different story for now. It has a default implementation relays on <code>&gt;&gt;=</code> only:</p>\n\n<pre><code>(&gt;&gt;) :: forall a b. m a -&gt; m b -&gt; m b\nm &gt;&gt; k = m &gt;&gt;= \\_ -&gt; k\n</code></pre>\n\n<p>and by <code>*&gt; = &gt;&gt;</code> you won't create an infinite loop unless you use <code>*&gt;</code> in the definition of <code>&gt;&gt;=</code>, but there are <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Proposal/MonadOfNoReturn\" rel=\"nofollow\">some concern</a> about the possible next major change in <code>base</code> (which may change the default implementation of <code>&gt;&gt;</code> to <code>&gt;&gt; = *&gt;</code>) so <code>*&gt; = &gt;&gt;</code> is discouraged for forward compatibility.</p>\n"}], "owner": {"reputation": 331, "user_id": 5377701, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/osnHj.jpg?s=128&g=1", "display_name": "O.Phillips", "link": "https://stackoverflow.com/users/5377701/o-phillips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 1, "accepted_answer_id": 35745477, "answer_count": 1, "score": 9, "last_activity_date": 1456929994, "creation_date": 1456909518, "question_id": 35742643, "link": "https://stackoverflow.com/questions/35742643/ghc-7-10-x-migration-why-cant-one-write-pure-return-in-the-instance-applic", "title": "GHC 7.10.x migration: why can&#39;t one write &quot;pure = return&quot; in the instance Applicative?", "body": "<p>I was reading an article about <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Migration/7.10\">GHC 7.10.x Migration</a>. There are some suggestions for fixing errors. </p>\n\n<blockquote>\n  <p>GHC says <code>No instance for (Applicative ...)</code></p>\n  \n  <p>If GHC complains that</p>\n  \n  <p>Foo.hs:7:10:\n      No instance for (Applicative Foo) arising from the superclasses of an instance declaration\n      In the instance declaration for \u2018Monad Foo\u2019 then an easy way to fix this error is by defining an Applicative (and possibly a Functor)\n  instance: instance Functor Foo where\n          fmap  = liftM\n          -- or alternatively:\n          --  fmap = m >>= pure . f</p>\n\n<pre><code>instance Applicative Foo where\n    -- NB: DO NOT USE `pure = return`\n    pure  = {- move the definition of `return` from the `Monad` instance here -}\n\n    (&lt;*&gt;) = ap  {- defined in Control.Monad -}\n    -- or alternatively:\n    --  f1 &lt;*&gt; f2 = f1 &gt;&gt;= \\v1 -&gt; f2 &gt;&gt;= (pure . v1)\n\n    -- NB: DO NOT USE `(*&gt;) = (&gt;&gt;)`\n    (*&gt;) = {- move the definition of `&gt;&gt;` from the `Monad` instance here -}\n\ninstance Monad Foo where\n    return = pure {- definition moved to `Applicative(pure)` -}\n\n    (&gt;&gt;) = (*&gt;) {- definition moved to `Applicative((*&gt;))` -}\n\n    {- ...retain other previous definitions... -}\n</code></pre>\n</blockquote>\n\n<p>There are the NBs: <code>DO NOT USE `pure = return`</code> and <code>DO NOT USE `(*&gt;) = (&gt;&gt;)</code>. Why can't one use it?</p>\n\n<p>P.S. I tried to use it and it has been compiled.</p>\n"}, {"tags": ["haskell", "division"], "comments": [{"owner": {"reputation": 580, "user_id": 4442322, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/318fd0b0565227bb0b89a3fd11d4097f?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Ali", "link": "https://stackoverflow.com/users/4442322/muhammad-ali"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456928155, "post_id": 35741030, "comment_id": 59172480, "body": "Hey @Carsten thanks for your response. Isn&#39;t Fractional a subclass of Num?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456930196, "post_id": 35741030, "comment_id": 59174213, "body": "I totally missed the point there <b>sorry</b> - to answer your question: you can combine those if you create a type-class around <code>toVal</code> and then declare instances almost exactly like you did here - right now I cannot test it and I admit that I did not think it through but it should work ... I think"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456930327, "post_id": 35741030, "comment_id": 59174314, "body": "btw: did you look at <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Ratio.html\" rel=\"nofollow noreferrer\"><code>Ratio</code></a> - it seems that you try to implement something very similar"}, {"owner": {"reputation": 86, "user_id": 4456770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9939c63a637b6b1d01f386aa28785a42?s=128&d=identicon&r=PG&f=1", "display_name": "isanco", "link": "https://stackoverflow.com/users/4456770/isanco"}, "edited": false, "score": 0, "creation_date": 1456932457, "post_id": 35741030, "comment_id": 59176067, "body": "In <code>Ratio</code>, the concrete type is constrained to be Integral. Here, it mixes Fractional and Integral. I believe that it is more related to  <a href=\"https://wiki.haskell.org/Generic_number_type\" rel=\"nofollow noreferrer\">generic number types</a>, with all standard caveats that apply."}, {"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1456972535, "post_id": 35741030, "comment_id": 59197121, "body": "You might find <a href=\"http://stackoverflow.com/q/35745191/211160\">this question I asked</a> and its answers to be useful.  <i>(I&#39;m trying to learn the language, and asked that after seeing your question and trying out some things myself.)</i>"}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 3, "last_activity_date": 1456937549, "last_edit_date": 1456937549, "creation_date": 1456933002, "answer_id": 35751643, "question_id": 35741030, "link": "https://stackoverflow.com/questions/35741030/division-in-haskell-for-numeric-class/35751643#35751643", "title": "Division in Haskell for Numeric class", "body": "<p>No, since <code>Num</code> has no notion of division, or, to say it in C++ terms, because there's no <code>dynamic_cast&lt;...&gt;</code> in Haskell.</p>\n\n<p>You could introduce your own typeclass:</p>\n\n<pre><code>class HasDivOp a where\n  divOp :: a -&gt; a -&gt; a\n\ninstance HasDivOp Int     where divOp = div\ninstance HasDivOp Integer where divOp = div\ninstance HasDivOp Double  where divOp = (/)\ninstance HasDivOp Float   where divOp = (/)\n</code></pre>\n\n<p>And then have a single function that takes the correct <code>divOp</code>:</p>\n\n<pre><code>toVal :: (Num a, HasDivOp a) =&gt; (Fraction a) -&gt; a\ntoVal (Constant a)   = a\ntoVal (Rational a b) = toVal a `divOp` toVal b\n</code></pre>\n\n<p>An alternative way to reduce the code duplication is to add an additional function:</p>\n\n<pre><code>divG :: (a -&gt; b) -&gt; (a -&gt; a -&gt; b) -&gt; Fraction a -&gt; b\ndivG p _ (Constant x)       = p x\ndivG p f (Rational num den) = f (divG p f num) (divF p f den)\n</code></pre>\n\n<p>That is, for fixed <code>a</code>s and <code>b</code>s tell <code>divF</code> how to combine two <code>a</code>s into a <code>b</code>, or how to transform an <code>a</code> to a <code>b</code>, you can reduce two <code>Fraction a</code>s into a single <code>b</code>. In all your cases <code>a = b</code>, so we can define another helper:</p>\n\n<pre><code>divF :: (a -&gt; a -&gt; a) -&gt; Fraction a -&gt; a\ndivF = divG id\n</code></pre>\n\n<p>Now we can define both <code>toVal1</code> and <code>toVal2</code> in terms of <code>divF</code>:</p>\n\n<pre><code>toVal1 :: Integral n =&gt; Fraction n -&gt; Fraction n -&gt; n\ntoVal1 = divF div\n\ntoVal2 :: Fractional n =&gt; Fraction n -&gt; Fraction n -&gt; n\ntoVal2 = divF (/)\n</code></pre>\n\n<p>That being said, both <code>toVal</code> and <code>toVal1</code> lead to interesting behaviour on integral numbers:</p>\n\n<pre><code>toVal1 (Rational (Rational 2 3) (Rational 2 3)) = 0 :: Int\n</code></pre>\n\n<p>But <code>x <code>div</code> x</code> should be 1 for any <code>x /= 0</code>. If you preprocess your integral <code>Fraction</code>s this problem won't occur: </p>\n\n<pre><code>rationalDiv :: Integral n =&gt; Fraction a -&gt; Fraction a -&gt; Fraction a\nrationalDiv (Constant a  ) (Constant c  ) = Rational a       c\nrationalDiv (Constant a  ) (Rational c d) = Rational (a * d) c\nrationalDiv (Rational a b) (Constant c  ) = Rational a       (b * c)\nrationalDiv (Rational a b) (Rational c d) = Rational (a * d) (b * c)\n</code></pre>\n\n<p>Note that this needs a <code>Num</code> instance for <code>Fraction</code> due to <code>*</code>. That way you have the most control about the actual division and just need to transform the elements at the end:</p>\n\n<pre><code>toVal3 :: Integral n =&gt; Fraction n -&gt; n\ntoVal3 = divF div . divF rationalDiv\n</code></pre>\n\n<p>Which correctly leads to <code>1</code> in our upper example. But to get back to the topic: no, you cannot use only <code>Num</code> as a constraint, you need to use another one that actually has a notion of division.</p>\n"}], "owner": {"reputation": 580, "user_id": 4442322, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/318fd0b0565227bb0b89a3fd11d4097f?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Ali", "link": "https://stackoverflow.com/users/4442322/muhammad-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 613, "favorite_count": 1, "accepted_answer_id": 35751643, "answer_count": 1, "score": 4, "last_activity_date": 1456937549, "creation_date": 1456903943, "last_edit_date": 1456919296, "question_id": 35741030, "link": "https://stackoverflow.com/questions/35741030/division-in-haskell-for-numeric-class", "title": "Division in Haskell for Numeric class", "body": "<p>I am trying to define a function <code>toVal :: (Num a) =&gt; (Fraction a) -&gt; a</code>. The function takes a fraction and evaluates its numeric value. But since the function uses division, I can do the following since division is defined by different functions on the subclasses of <code>Num a</code>:</p>\n\n<pre><code>data Fraction a = Constant a\n    |Rational{numerator :: (Fraction a), denominator :: (Fraction a)}\n\n\ntoVal1 :: (Integral a) =&gt; (Fraction a) -&gt; a\ntoVal1 (Constant a) = a\ntoVal1 (Rational num den) = (toVal1 num) `div` (toVal1 den)\n\ntoVal2 :: (Fractional a) =&gt; (Fraction a) -&gt; a\ntoVal2 (Constant a) = a\ntoVal2 (Rational num den) = (toVal2 num) / (toVal2 den)\n</code></pre>\n\n<p>Is there a way I can combine the two functions so that I can have a generic function <code>toVal :: (Num a) =&gt; (Fraction a) -&gt; a</code>?</p>\n"}, {"tags": ["function", "haskell", "combinations"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1456900465, "post_id": 35738856, "comment_id": 59153848, "body": "You cannot do this for a very very simple reason:  <code>++ &quot;x&quot;</code> is not an expression. In contrast, <code>(++ &quot;x&quot;)</code> <i>is</i> an expression."}], "answers": [{"tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": false, "score": 0, "last_activity_date": 1456895374, "creation_date": 1456895374, "answer_id": 35738974, "question_id": 35738856, "link": "https://stackoverflow.com/questions/35738856/map-2-function-combination-fails-syntax-error/35738974#35738974", "title": "map 2 function combination fails: syntax error?", "body": "<p>Infix operators like parentheses.</p>\n\n<pre><code>Prelude&gt; map ((++ \" world\") . (++ \"xyz\")) [\"hello\", \"abc\"]\n</code></pre>\n\n\n"}, {"tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 1, "last_activity_date": 1456895609, "creation_date": 1456895609, "answer_id": 35739007, "question_id": 35738856, "link": "https://stackoverflow.com/questions/35738856/map-2-function-combination-fails-syntax-error/35739007#35739007", "title": "map 2 function combination fails: syntax error?", "body": "<p><code>++</code> is an infix operator, and the rules of how you can use it are different than that of normal functions.</p>\n\n<p>You can use it sandwiched between two values, like this</p>\n\n<pre><code>x ++ y\n</code></pre>\n\n<p>or convert it to a normal function using parenthesis</p>\n\n<pre><code>(++) x y --same as above\n</code></pre>\n\n<p>There are two ways to partially apply values to an infix operator</p>\n\n<pre><code>(x ++) --same as \\y -&gt; x ++ y\n(++ y) --same as \\x -&gt; x ++ y\n</code></pre>\n\n<p>Both of these require the outer parentheses, else Haskell would try to parse the expression as the normal infix case</p>\n\n<pre><code>++ x . ++ y -- will confuse the parser\n</code></pre>\n\n<p>but</p>\n\n<pre><code>(++ x) . (++ y)\n</code></pre>\n\n<p>will work</p>\n"}, {"tags": [], "owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "is_accepted": true, "score": 3, "last_activity_date": 1456898090, "last_edit_date": 1456898090, "creation_date": 1456896258, "answer_id": 35739129, "question_id": 35738856, "link": "https://stackoverflow.com/questions/35738856/map-2-function-combination-fails-syntax-error/35739129#35739129", "title": "map 2 function combination fails: syntax error?", "body": "<p>The name for the thing you are doing when you say <code>(++ \"world\")</code> is that you are using what is called a \"right section\" of a \"partially applied infix operator\":</p>\n\n<p><a href=\"https://wiki.haskell.org/Section_of_an_infix_operator\" rel=\"nofollow\">https://wiki.haskell.org/Section_of_an_infix_operator</a></p>\n\n<p>What that means for <code>(++ \"world\")</code> is that the left hand side will be the parameter for the generated function, which will pre-fill the right hand side with \"world\".</p>\n\n<p>So it's not just a use of parentheses for precedence... it's a special syntax.  When you omit the parentheses on the second <code>++</code>, that means you aren't invoking the syntax there.  It tries to interpret it as normal infix.</p>\n\n<p>If you want to compose two functions of this type inlined like this, you have them each in parentheses:</p>\n\n<pre><code>Prelude&gt; map ((++\" world\") . (++\"xyz\"))[\"hello\",\"abc\"]\n[\"helloxyz world\",\"abcxyz world\"]\n</code></pre>\n\n<p>Note the effects on the result if you merely convert the ++ operators to prefix, with the non-partially-applied syntax:</p>\n\n<pre><code>Prelude&gt; map ((++) \" world\" . (++) \"xyz\")[\"hello\",\"abc\"]\n[\" worldxyzhello\",\" worldxyzabc\"]\n</code></pre>\n\n<p>There you don't have to group them, but now you are providing the first argument instead.  Your list's data winds up at the end of the output.  This would be the same as if you used the infix partial application syntax with left sections:</p>\n\n<pre><code>Prelude&gt; map ((\" world\" ++) . (\"xyz\" ++))[\"hello\",\"abc\"]\n[\" worldxyzhello\",\" worldxyzabc\"]\n</code></pre>\n\n<p>FYI: if you want the composition to be in the reverse order (world first, then xyz) you could use <code>&gt;&gt;&gt;</code> from Control.Arrow</p>\n\n<pre><code>Prelude&gt; import Control.Arrow\nPrelude Control.Arrow&gt; map ((++\" world\") &gt;&gt;&gt; (++\"xyz\")[\"hello\",\"abc\"]\n[\"hello worldxyz\",\"abc worldxyz\"]\n</code></pre>\n"}], "owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 35739129, "answer_count": 3, "score": 0, "last_activity_date": 1456898090, "creation_date": 1456894755, "question_id": 35738856, "link": "https://stackoverflow.com/questions/35738856/map-2-function-combination-fails-syntax-error", "title": "map 2 function combination fails: syntax error?", "body": "<p>I just know in Haskell \".\" could be used to combine functions, so I tried:</p>\n\n<pre><code>Prelude&gt; map (++\" world\")[\"hello\",\"abc\"]\n[\"hello world\",\"abc world\"]\nPrelude&gt; map (++\" world\". ++\"xyz\")[\"hello\",\"abc\"]\n\n&lt;interactive&gt;:3:18: parse error on input `++'\n</code></pre>\n\n<p>Why I cannot do this? I tried named function, it's OK:</p>\n\n<pre><code>Prelude&gt; map (head.tail)[\"hello\",\"abc\"]\n\"eb\"\n</code></pre>\n\n<p>So how to correct my case? Thanks.</p>\n"}, {"tags": ["haskell", "scripting", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1456900780, "post_id": 35738724, "comment_id": 59153997, "body": "You can &quot;run&quot; an arbitrary expression defined at the top level (i.e. evaluate and print) with <code>ghc -e &quot;expr&quot; file.hs</code>. The expression can be a pure value, or an IO value. If the type inside the IO value is anything but <code>()</code> (i.e. <code>IO Int</code>, <code>IO Bool</code>, etc) then the IO action is run, and its result is printed."}], "tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 8, "last_activity_date": 1456895653, "last_edit_date": 1456895653, "creation_date": 1456894066, "answer_id": 35738724, "question_id": 35738612, "link": "https://stackoverflow.com/questions/35738612/does-haskells-ghci-support-running-a-script-and-then-quit-like-python-or-perl/35738724#35738724", "title": "Does Haskell&#39;s ghci support running a script and then quit, like python or perl?", "body": "<p>Use <code>runghc</code> to get the same behavior. You will indeed need a <code>main :: IO ()</code> function still.</p>\n"}], "owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 35738724, "answer_count": 1, "score": 4, "last_activity_date": 1456895748, "creation_date": 1456893419, "last_edit_date": 1456895748, "question_id": 35738612, "link": "https://stackoverflow.com/questions/35738612/does-haskells-ghci-support-running-a-script-and-then-quit-like-python-or-perl", "title": "Does Haskell&#39;s ghci support running a script and then quit, like python or perl?", "body": "<p>Python or Perl supports:</p>\n\n<pre><code>python xxx.py\nperl xxx.pl\npowershell xxx.ps1\n</code></pre>\n\n<p>Execute the script and quit with an exit code. When I tried GHCi (as <code>ghci xxx.hs</code>) it seems to load the <code>xxx.hs</code> file and enter interactive mode, without quiting.</p>\n\n<ol>\n<li>Does the GHC interpreter support such operations?</li>\n<li>Does this \"interpreting\" require to have a <code>main</code> function like the GHC compiler does?</li>\n</ol>\n"}, {"tags": ["parsing", "haskell", "compilation", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 5, "last_activity_date": 1456892904, "creation_date": 1456892904, "answer_id": 35738522, "question_id": 35738315, "link": "https://stackoverflow.com/questions/35738315/why-ghc-give-me-a-parse-error-when-i-wish-to-simply-print-out-a-value/35738522#35738522", "title": "Why ghc give me a parse error when I wish to simply print out a value?", "body": "<p>There are a number of problems here.</p>\n\n<p>First, if you want to sequence expressions in <code>IO</code> you need to place them in a <code>do</code> block. Second, you need to use indentation (spaces only, no tabs!) to delimit the do block, like so:</p>\n\n<pre><code>main = do\n   putStrLn \"hello world\"\n   let a=1\n   show a\n</code></pre>\n\n<p>Finally, <code>show a</code> will return a string, but you want an IO action that <em>prints</em> a string, so it should be <code>putStrLn (show a)</code>, or you can use <code>print a</code> as the print function is the composition of <code>show</code>ing (turning into a string) and then printing out to the console.</p>\n"}], "owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 35738522, "answer_count": 1, "score": -2, "last_activity_date": 1456892904, "creation_date": 1456891551, "question_id": 35738315, "link": "https://stackoverflow.com/questions/35738315/why-ghc-give-me-a-parse-error-when-i-wish-to-simply-print-out-a-value", "title": "Why ghc give me a parse error when I wish to simply print out a value?", "body": "<p>I've got a haskell file:</p>\n\n<pre><code>main = putStrLn \"hello world\"\nlet a=1\nshow a\n</code></pre>\n\n<p>and ghc says:</p>\n\n<pre><code>main.hs:3:1:                                                                                                                            \nparse error (possibly incorrect indentation or mismatched brackets) \n</code></pre>\n"}, {"tags": ["haskell", "filter", "list-comprehension"], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 6, "last_activity_date": 1456891050, "creation_date": 1456891050, "answer_id": 35738240, "question_id": 35738219, "link": "https://stackoverflow.com/questions/35738219/haskells-subset-operation-doesnt-give-me-all-results-only-part-of-it-is-shown/35738240#35738240", "title": "Haskell&#39;s subset operation doesn&#39;t give me all results, only part of it is shown?", "body": "<p>You guard for <code>a^2 + b^2 == c^2</code>, but for e.g. <code>(8, 10, 6)</code>, it is not true that <code>8^2 + 10^2 == 6^2</code>. Hence, they are not included in the result.</p>\n"}], "owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 35738240, "answer_count": 1, "score": -2, "last_activity_date": 1456891100, "creation_date": 1456890949, "last_edit_date": 1456891100, "question_id": 35738219, "link": "https://stackoverflow.com/questions/35738219/haskells-subset-operation-doesnt-give-me-all-results-only-part-of-it-is-shown", "title": "Haskell&#39;s subset operation doesn&#39;t give me all results, only part of it is shown?", "body": "<p>I've learning LYAH and the last question from Chapter 1 is to find <code>a</code>,<code>b</code> and <code>c</code> where <code>(a,b,c)</code> form a right triangle, and their sum is 24. <code>a</code>,<code>b</code>,<code>c</code> are all <code>Int</code>s.</p>\n\n<p>So I have the code below(not the same from the book).</p>\n\n<pre><code>Prelude&gt; [(a,b,c)|c&lt;-[1..10],b&lt;-[1..10],a&lt;-[1..10],a^2+b^2==c^2,a+b+c==24]\n[(8,6,10),(6,8,10)]\n</code></pre>\n\n<p>I expect to get all possible combinations like</p>\n\n<pre><code>[(8,6,10),(6,8,10),(8,10,6),(6,10,8),(10,6,8),(10,8,6)]\n</code></pre>\n\n<p>Why only part of it is shown? I tried different versions of ghci but got same results. Thanks.</p>\n"}, {"tags": ["list", "haskell", "sieve"], "comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 1, "creation_date": 1456887907, "post_id": 35737686, "comment_id": 59149567, "body": "<code>take n $ expression</code>? Note <code>[2] ++ s</code> == <code>2 : s</code>."}, {"owner": {"reputation": 11, "user_id": 3247014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f4AgB.jpg?s=128&g=1", "display_name": "user3247014", "link": "https://stackoverflow.com/users/3247014/user3247014"}, "reply_to_user": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1456888531, "post_id": 35737686, "comment_id": 59149736, "body": "I&#39;ve tried that, but am getting compilation errors."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 5, "creation_date": 1456889021, "post_id": 35737686, "comment_id": 59149841, "body": "@user3247014 If you get compilation errors for a particular piece of code, you should include precisely the code which gives the error, and the actual error. Note that <code>e where x = t</code> is <i>not</i> a valid expression - <code>where</code> is only valid in declarations. However, <code>let x = y in e</code> <i>is</i> a valid expression."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1456899579, "post_id": 35737686, "comment_id": 59153455, "body": "<a href=\"http://ideone.com/v2t6Mh\" rel=\"nofollow noreferrer\">ideone.com/v2t6Mh</a>"}, {"owner": {"reputation": 11, "user_id": 3247014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f4AgB.jpg?s=128&g=1", "display_name": "user3247014", "link": "https://stackoverflow.com/users/3247014/user3247014"}, "edited": false, "score": 0, "creation_date": 1456933866, "post_id": 35737686, "comment_id": 59177176, "body": "I see that works, n.m. But how would you go about taking say the first 1000 primes by only changing something inside a function?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1456957346, "post_id": 35737686, "comment_id": 59192043, "body": "@user3247014 Change <code>primes = ...</code> to <code>primes = take 1000 $ ...</code>? Keep in mind that due to laziness, there really is no difference between taking 1000 elements inside the <code>primes</code> function or outside."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1457749231, "post_id": 35737686, "comment_id": 59562137, "body": "@n.m. you should post your code sample as an answer..."}], "owner": {"reputation": 11, "user_id": 3247014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f4AgB.jpg?s=128&g=1", "display_name": "user3247014", "link": "https://stackoverflow.com/users/3247014/user3247014"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1456895799, "creation_date": 1456887661, "last_edit_date": 1456895799, "question_id": 35737686, "link": "https://stackoverflow.com/questions/35737686/haskell-sieve-of-eratothenese-getting-the-first-n-primes-of-the-sieve", "title": "Haskell: (Sieve of Eratothenese) Getting the first n primes of the sieve", "body": "<p>Let's say I have an expression such as:</p>\n\n<pre><code>[2] ++ sieve [3,5..] where\n    sieve (p:xs) = p : sieve [i | i &lt;- xs, i `mod` p /= 0]\n</code></pre>\n\n<p>How would I go about (in a function) taking the first <em>n</em> elements of this list? I'm aware of the <code>take</code> function but I can't figure out how to use it in this context. </p>\n\n<p>I'm aware this expression creates an infinite list of primes. I'm trying to figure out to extract the first <em>n</em> primes. </p>\n"}, {"tags": ["swift", "haskell", "list-comprehension"], "comments": [{"owner": {"reputation": 790, "user_id": 334632, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/SL2Mb.jpg?s=128&g=1", "display_name": "Joe Hillenbrand", "link": "https://stackoverflow.com/users/334632/joe-hillenbrand"}, "edited": false, "score": 0, "creation_date": 1456883877, "post_id": 35736898, "comment_id": 59148363, "body": "FYI, list comprehensions are not haskell exclusive. Python has them as well."}], "answers": [{"comments": [{"owner": {"reputation": 38873, "user_id": 2415822, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zxy7G.jpg?s=128&g=1", "display_name": "JAL", "link": "https://stackoverflow.com/users/2415822/jal"}, "edited": false, "score": 1, "creation_date": 1456931937, "post_id": 35737269, "comment_id": 59175643, "body": "This should have been marked as a duplicate, rather than posting an answer that links to another post on Stack Overflow."}, {"owner": {"reputation": 80721, "user_id": 797049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5f4f7a23e3d0134123a66015bdc4edd1?s=128&d=identicon&r=PG", "display_name": "Mark Reed", "link": "https://stackoverflow.com/users/797049/mark-reed"}, "reply_to_user": {"reputation": 38873, "user_id": 2415822, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zxy7G.jpg?s=128&g=1", "display_name": "JAL", "link": "https://stackoverflow.com/users/2415822/jal"}, "edited": false, "score": 0, "creation_date": 1456936039, "post_id": 35737269, "comment_id": 59178851, "body": "I voted to close it as a duplicate of that question.  I submitted the answer in case there weren&#39;t four other votes agreeing with me.."}], "tags": [], "owner": {"reputation": 80721, "user_id": 797049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5f4f7a23e3d0134123a66015bdc4edd1?s=128&d=identicon&r=PG", "display_name": "Mark Reed", "link": "https://stackoverflow.com/users/797049/mark-reed"}, "is_accepted": true, "score": 3, "last_activity_date": 1456885377, "last_edit_date": 1495542665, "creation_date": 1456885377, "answer_id": 35737269, "question_id": 35736898, "link": "https://stackoverflow.com/questions/35736898/can-the-concept-of-list-comprehension-be-implemented-in-swift/35737269#35737269", "title": "Can the concept of list comprehension be implemented in Swift?", "body": "<p>As a general rule, list comprehensions are a syntactic feature that a language either has or doesn't have.  Swift doesn't have them.  For some concise ways of achieving similar results, see <a href=\"https://stackoverflow.com/questions/24003584/list-comprehension-in-swift\">this question</a>.</p>\n"}], "owner": {"reputation": 63, "user_id": 4917455, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e2949009b853a30dab2479b04f25f5ae?s=128&d=identicon&r=PG&f=1", "display_name": "The Legendary Programmer", "link": "https://stackoverflow.com/users/4917455/the-legendary-programmer"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 0, "closed_date": 1457004895, "accepted_answer_id": 35737269, "answer_count": 1, "score": -1, "last_activity_date": 1456885377, "creation_date": 1456882804, "last_edit_date": 1456883216, "question_id": 35736898, "link": "https://stackoverflow.com/questions/35736898/can-the-concept-of-list-comprehension-be-implemented-in-swift", "closed_reason": "Duplicate", "title": "Can the concept of list comprehension be implemented in Swift?", "body": "<p>I've been studying the Swift programming language for iOS, and I have a very small Haskell background. I'm very curious to know if the concept of list comprehension can be implemented in Swift?</p>\n\n<p>Any thoughts, advice, etc., would be greatly appreciated!</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 1, "creation_date": 1456881344, "post_id": 35736542, "comment_id": 59147675, "body": "Stating the obvious: anything <code>IO</code> falls under &quot;magic&quot; for any reasonable definition of &quot;magic&quot;: <a href=\"https://www.reddit.com/r/haskell/comments/450baq/is_it_just_me_or_does_ios_definition_give_you_the/\" rel=\"nofollow noreferrer\">reddit.com/r/haskell/comments/450baq/&hellip;</a>. Also the <code>ST</code> monad, which is probably even more magic."}, {"owner": {"reputation": 12990, "user_id": 138830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f9474b14f9de5e2ae59b969ec2d328d6?s=128&d=identicon&r=PG", "display_name": "gawi", "link": "https://stackoverflow.com/users/138830/gawi"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 1, "creation_date": 1456882725, "post_id": 35736542, "comment_id": 59148036, "body": "What about STM? And stream fusion?"}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1456883118, "post_id": 35736542, "comment_id": 59148138, "body": "yeah those too, but STM gets its magic from IO, and steam fusion is rewrite rules, which is itself magic."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1456883500, "post_id": 35736542, "comment_id": 59148255, "body": "I&#39;m not sure I&#39;d call stream fusion magic. You can create your own rewrite rules, so that is more a tool of the language than magic (in GHC extended Haskell at least). Also if things are indirectly, vicariously magic just because they use something else that&#39;s magic, then it seems like pretty much everything is magic because you generally ultimately end up at <code>IO</code>. Granted, <code>STM</code> probably falls a bit more on the magic side because it probably directly uses stuff like <code>State# RealWorld</code> internally at some point."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1456885478, "post_id": 35736542, "comment_id": 59148830, "body": "The things the GHC developers typically call &quot;magic&quot; are ones that get special treatment from the compiler. <code>Coercible</code> (defined as <code>data</code> and with its kind magically changed to <code>k -&gt; k -&gt; Constraint</code>) and <code>lazy</code> (which &quot;magically&quot; makes GHC consider a function lazy) are good examples."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1456887035, "post_id": 35736542, "comment_id": 59149289, "body": "I guess the answer is &quot;a lot of stuff.&quot; Actually, given how concise Haskell&#39;s definition is, it might be easier to list what <i>isn&#39;t</i> magic (which is really what made Haskell magic in the first place :))."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1456889322, "post_id": 35736542, "comment_id": 59149925, "body": "See <a href=\"https://github.com/ghc/ghc/blob/master/compiler/basicTypes/MkId.hs#L121\" rel=\"nofollow noreferrer\">here</a> for the part of the GHC source which defines primitive identifiers (i.e. functions). Perhaps the only surprising thing that is primitive is <code>($) :: (a -&gt; b) -&gt; (a -&gt; b)</code>."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1456911576, "post_id": 35736542, "comment_id": 59160286, "body": "You can implement STM as normal user code. It all lives in the <code>IO</code> monad of course, but STM itself isn&#39;t particularly magic; the magic is in <code>MVar</code>, <code>forkIO</code>, et al."}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 5, "last_activity_date": 1456893704, "creation_date": 1456893704, "answer_id": 35738659, "question_id": 35736542, "link": "https://stackoverflow.com/questions/35736542/haskell-compiler-magic-what-requires-a-special-treatment-from-the-compiler/35738659#35738659", "title": "Haskell compiler magic: what requires a special treatment from the compiler?", "body": "<p>Nearly all the ghc primitives that cannot be implemented in userland are in the <a href=\"https://hackage.haskell.org/package/ghc-prim\" rel=\"noreferrer\">ghc-prim</a> package. (it even has a module called <code>GHC.Magic</code> there!)</p>\n\n<p>So browsing it will give a good sense.</p>\n\n<p>Note that you should <em>not</em> use this module in userland code unless you know exactly what you are doing. Most of the usable stuff from it is exported in downstream modules in <code>base</code>, sometimes in modified form. Those downstream locations and APIs are considered more stable, while <code>ghc-prim</code> makes no guarantees as to how it will act from version to version.</p>\n\n<p>The GHC-specific stuff is reexported in <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/GHC-Exts.html\" rel=\"noreferrer\"><code>GHC.Exts</code></a>, but plenty of other things go into the Prelude (such as basic data types, as well as <code>seq</code>) or the concurrency libraries, etc.</p>\n"}, {"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 1, "last_activity_date": 1456915078, "creation_date": 1456915078, "answer_id": 35744770, "question_id": 35736542, "link": "https://stackoverflow.com/questions/35736542/haskell-compiler-magic-what-requires-a-special-treatment-from-the-compiler/35744770#35744770", "title": "Haskell compiler magic: what requires a special treatment from the compiler?", "body": "<p>Polymorphic <code>seq</code> is definitely magic. You <em>can</em> implement <code>seq</code> for any <em>specific</em> type, but only the compiler can implement one function for <em>all</em> possible types [and avoid optimising it away even though it looks no-op].</p>\n\n<p>Obviously the entire <code>IO</code> monad is deeply magic, as is everything to with concurrency and parallelism (<code>par</code>, <code>forkIO</code>, <code>MVar</code>), mutable storage, exception throwing and catching, querying the garbage collector and run-time stats, etc.</p>\n\n<p>The <code>IO</code> monad can be considered a special case of the <code>ST</code> monad, which is also magic. (It allows truly mutable storage, which requires low-level stuff.)</p>\n\n<p>The <code>State</code> monad, on the other hand, is completely ordinary user-level code that anybody can write. So is the <code>Cont</code> monad. So are the various exception / error monads.</p>\n\n<p>Anything to do with syntax (do-blocks, list comprehensions) is hard-wired into the language definition. (Note, though, that some of these respond to <code>LANGUAGE RebindableSyntax</code>, which lets you change what functions it binds to.) Also the <code>deriving</code> stuff; the compiler \"knows about\" a handful of special classes and how to auto-generate instances for them. Deriving for <code>newtype</code> works for <em>any</em> class though. (It's just copying an instance from one type to another identical copy of that type.)</p>\n\n<p>Arrays are hard-wired. Much like every other programming language.</p>\n\n<p>All of the foreign function interface is clearly hard-wired.</p>\n\n<p>STM <em>can</em> be implemented in user code (I've done it), but it's currently hard-wired. (I imagine this gives a significant performance benefit. I haven't tried actually measuring it.) But, conceptually, that's just an optimisation; you <em>can</em> implement it using the existing lower-level concurrency primitives.</p>\n"}], "owner": {"reputation": 12990, "user_id": 138830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f9474b14f9de5e2ae59b969ec2d328d6?s=128&d=identicon&r=PG", "display_name": "gawi", "link": "https://stackoverflow.com/users/138830/gawi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 35738659, "answer_count": 2, "score": 7, "last_activity_date": 1456915078, "creation_date": 1456880176, "last_edit_date": 1456895864, "question_id": 35736542, "link": "https://stackoverflow.com/questions/35736542/haskell-compiler-magic-what-requires-a-special-treatment-from-the-compiler", "title": "Haskell compiler magic: what requires a special treatment from the compiler?", "body": "<p>When trying to learn Haskell, one of the difficulties that arise is the ability when something requires special magic from the compiler.  One exemple that comes in mind is the <code>seq</code> function which can't be defined i.e. you can't make a <code>seq2</code> function behaving exactly as the built-in <code>seq</code>. Consequently, when teaching someone about <code>seq</code>, you need to mention that <code>seq</code> is special because it's a special symbol for the compiler.</p>\n\n<p>Another example would be the <code>do</code>-notation which only works with instances of the <code>Monad</code> class.</p>\n\n<p>Sometimes, it's not always obvious. For instance, continuations. Does the compiler knows about <code>Control.Monad.Cont</code> or is it plain old Haskell that you could have invented yourself? In this case, I think nothing special is required from the compiler even if continuations are a very strange kind of beast.</p>\n\n<p>Language extensions set aside, what other compiler magic Haskell learners should be aware of? </p>\n"}, {"tags": ["haskell", "pattern-matching", "lazy-evaluation", "strictness"], "answers": [{"comments": [{"owner": {"reputation": 417, "user_id": 771575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf835477d3bb66573a3d05ecf613522?s=128&d=identicon&r=PG", "display_name": "Mike Nunan", "link": "https://stackoverflow.com/users/771575/mike-nunan"}, "edited": false, "score": 0, "creation_date": 1520351896, "post_id": 35736935, "comment_id": 85274729, "body": "With belated thanks for your helpful answer and apologies for any other breaches of etiquette in returning here over 2 years later, I&#39;ve been looking again at the final part of your answer and am at a loss to find any way of obtaining a different result from partialId versus partialId&#39; for any input I can think of. Would you be able to point out the difference to me please? (I see the difference between the two konst variants clearly enough.)"}], "tags": [], "owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "is_accepted": true, "score": 7, "last_activity_date": 1456883113, "creation_date": 1456883113, "answer_id": 35736935, "question_id": 35736535, "link": "https://stackoverflow.com/questions/35736535/irrefutable-lazy-pattern-exercise-in-haskell-wikibook/35736935#35736935", "title": "Irrefutable/lazy pattern exercise in Haskell wikibook", "body": "<p>I'm not sure what the wikibook means by \"help\".  You are correct that changing the order will make it behave essentially like the normal <code>head</code>.  Similarly, you are correct that making the first pattern refutable would also make it behave like <code>head</code>.  I'm going to say that these questions are confused; they are definitely confusing.</p>\n\n<p>We can verify these answers by calculation (including calculation with GHC):</p>\n\n<pre><code>head [] = \u22a5\nhead (x:xs) = x\nhead \u22a5 = \u22a5\n\nhead' [] = \u22a5\nhead' (x:xs) = \u22a5\nhead' \u22a5 = \u22a5\n\nhead1 [] = \u22a5\nhead1 (x:xs) = x\nhead1 \u22a5 = \u22a5\n\nhead2 [] = \u22a5\nhead2 (x:xs) = x\nhead2 \u22a5 = \u22a5\n</code></pre>\n\n<p><code>head</code> is the standard library version. <code>head'</code> is the version from the wikibook. <code>head1</code> is the version with the clauses swapped. <code>head2</code> is the version with the first pattern being a refutable match against <code>[]</code>. \u22a5 is read as \"bottom\" and represents a non-terminating or exceptional computation, i.e. <code>undefined</code>.</p>\n\n<p>What I would've expected is examples like the following where there are subtle but significant differences between refutable and irrefutable patterns:</p>\n\n<pre><code>konst ~() = ()\n\nkonst' () = ()\n\npartialId ~(x:xs) = x:xs\n\npartialId' (x:xs) = x:xs\n</code></pre>\n"}], "owner": {"reputation": 417, "user_id": 771575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf835477d3bb66573a3d05ecf613522?s=128&d=identicon&r=PG", "display_name": "Mike Nunan", "link": "https://stackoverflow.com/users/771575/mike-nunan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 1, "accepted_answer_id": 35736935, "answer_count": 1, "score": 2, "last_activity_date": 1456896252, "creation_date": 1456880137, "last_edit_date": 1456896252, "question_id": 35736535, "link": "https://stackoverflow.com/questions/35736535/irrefutable-lazy-pattern-exercise-in-haskell-wikibook", "title": "Irrefutable/lazy pattern exercise in Haskell wikibook", "body": "<p>Half way down here...</p>\n\n<p><a href=\"https://en.wikibooks.org/wiki/Haskell/Laziness\" rel=\"nofollow\">https://en.wikibooks.org/wiki/Haskell/Laziness</a></p>\n\n<p>...is an exercise asking about the effects of changes to an alternative implementation of the <code>head</code> function that uses irrefutable patterns. It provides a definition of <code>head'</code> as follows, noting that it will always return <code>undefined</code> due to irrefutable matching of the first equation:</p>\n\n<pre><code>head' :: [a] -&gt; a\nhead' ~[]     = undefined\nhead' ~(x:xs) = x\n</code></pre>\n\n<p>Then it asks:</p>\n\n<ul>\n<li>Why won't changing the order of the equations to <code>head'</code> help here?</li>\n<li>If the first equation is changed to use an ordinary refutable pattern,\nwill the behavior of <code>head'</code> still be different from that of <code>head</code>? If\nso, how?</li>\n</ul>\n\n<p>In GHC 7.8.4 it seems that changing the order \"helps\" at least to the extent of making this function behave like the regular partial version of <code>head</code>, albeit with a different exception in the empty list case. The answer to the second question would appear to me to be \"no\", but given the \"if so, how\" addendum, it feels like I must be missing something here too. Can anyone enlighten me? The solutions link on the page does not cover this exercise unfortunately.</p>\n"}, {"tags": ["linux", "haskell", "window-managers", "xmonad"], "comments": [{"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1456875951, "post_id": 35735836, "comment_id": 59146084, "body": "Indentation matters in Haskell. Make sure the everything is indented at least as much as the equals sign."}, {"owner": {"reputation": 11, "user_id": 6005138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e98dcaed19c05519c52b9efe8a3947?s=128&d=identicon&r=PG&f=1", "display_name": "Tim70", "link": "https://stackoverflow.com/users/6005138/tim70"}, "reply_to_user": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1456877321, "post_id": 35735836, "comment_id": 59146513, "body": "@SebastianRedl It was just an extra comma, indentation was fine."}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 5864821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9ROlt.png?s=128&g=1", "display_name": "SANK", "link": "https://stackoverflow.com/users/5864821/sank"}, "is_accepted": true, "score": 2, "last_activity_date": 1456876026, "creation_date": 1456876026, "answer_id": 35735893, "question_id": 35735836, "link": "https://stackoverflow.com/questions/35735836/haskell-parse-error-in-my-xmonad-hs-config-that-i-dont-understand/35735893#35735893", "title": "Haskell parse error in my xmonad.hs config that i don&#39;t understand?", "body": "<p>This should work.</p>\n\n<pre><code>addedKeys = [ (\"M-&lt;Return&gt;\"  , spawn myTerm),\n              (\"M-e\"         , spawn \"gedit\"),\n              (\"M-i\"         , spawn \"firefox\"),\n              (\"M-S-t\"       , spawn \"nemo\"),\n              (\"M-&lt;Left&gt;\"    , windows W.swapMaster &gt;&gt; windows W.focusDown)]\n</code></pre>\n\n<p>There was a comma after the last item in the list which caused the error.</p>\n"}], "owner": {"reputation": 11, "user_id": 6005138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e98dcaed19c05519c52b9efe8a3947?s=128&d=identicon&r=PG&f=1", "display_name": "Tim70", "link": "https://stackoverflow.com/users/6005138/tim70"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 569, "favorite_count": 0, "accepted_answer_id": 35735893, "answer_count": 1, "score": 0, "last_activity_date": 1456876026, "creation_date": 1456875711, "question_id": 35735836, "link": "https://stackoverflow.com/questions/35735836/haskell-parse-error-in-my-xmonad-hs-config-that-i-dont-understand", "title": "Haskell parse error in my xmonad.hs config that i don&#39;t understand?", "body": "<p>So i downloaded a xmonad wm config off of github that I thought looked nice, tried to use it and I got a parse error. I don't have too much Haskell knowledge but nothing looks wrong?</p>\n\n<pre><code>xmonad.hs:72:13: parse error on input \u2018]\u2019\n</code></pre>\n\n<p>Area in question:</p>\n\n<pre><code>addedKeys = [ (\"M-&lt;Return&gt;\"  , spawn myTerm),\n          (\"M-e\"         , spawn \"gedit\"),\n          (\"M-i\"         , spawn \"firefox\"),\n          (\"M-S-t\"       , spawn \"nemo\"),\n          (\"M-&lt;Left&gt;\"    , windows W.swapMaster &gt;&gt; windows W.focusDown),\n        ]\n</code></pre>\n"}, {"tags": ["haskell", "type-parameter"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1456874997, "post_id": 35735358, "comment_id": 59145739, "body": "Your example shows how one could construct an <code>Obj</code> value. What about elimination/destruction? I.e., how do you expect to <i>use</i> a value of type <code>Obj</code>? If you access its innermost elements, they are of an unknown type, so you can&#39;t do anything with them which requires static types (i.e. everything). So, you either need to use <code>Dynamic</code> types, or some more precise <code>Obj&#47;Fluent</code> types which keep some type information (possibly with a GADT, but it&#39;s hard to tell)."}], "answers": [{"comments": [{"owner": {"reputation": 676, "user_id": 161104, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7bb3f29d02f3cb9e350616b849452b7b?s=128&d=identicon&r=PG", "display_name": "BinRoot", "link": "https://stackoverflow.com/users/161104/binroot"}, "edited": false, "score": 0, "creation_date": 1456873955, "post_id": 35735472, "comment_id": 59145263, "body": "I don&#39;t want the same type for each <code>Fluent</code> in the list"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 676, "user_id": 161104, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7bb3f29d02f3cb9e350616b849452b7b?s=128&d=identicon&r=PG", "display_name": "BinRoot", "link": "https://stackoverflow.com/users/161104/binroot"}, "edited": false, "score": 2, "creation_date": 1456874113, "post_id": 35735472, "comment_id": 59145338, "body": "@BinRoot Try this experiment: pretend someone has fixed Obj for you already, and then write out a sample expression you wish you could use, along with its type. Notice I did the same in my example. If we knew how you wished your type behaved, it would be less guesswork to try to provide solutions."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 676, "user_id": 161104, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7bb3f29d02f3cb9e350616b849452b7b?s=128&d=identicon&r=PG", "display_name": "BinRoot", "link": "https://stackoverflow.com/users/161104/binroot"}, "edited": false, "score": 1, "creation_date": 1456874589, "post_id": 35735472, "comment_id": 59145558, "body": "@BinRoot If you completely lose the information about what <code>t</code> is, an <code>Obj</code> becomes a list of lists of unknown things. There&#39;s not much you can do with such a list. In your example, assuming it worked, no one can actually access <code>o</code> beyond counting the number of elements. This is because e.g. <code>head (head o)</code> would be of an unknown type, so you can not use it anywhere."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1456874783, "post_id": 35735472, "comment_id": 59145646, "body": "If you really want, you can use an <code>HList</code> or some such, but that&#39;s a big hammer. What&#39;s your actual purpose?"}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 3, "last_activity_date": 1456873853, "creation_date": 1456873853, "answer_id": 35735472, "question_id": 35735358, "link": "https://stackoverflow.com/questions/35735358/how-to-create-a-data-type-with-value-constructor-containing-list-of-type-paramet/35735472#35735472", "title": "How to create a data type with value constructor containing list of type parameter types", "body": "<p>You have to propagate the type parameter <code>t</code> up to the Obj type:</p>\n\n<pre><code>data Fluent t = Fluent [t]\ndata Obj t = Obj [Fluent t]\n\n:t Obj $ map Fluent [\"a\", \"bcd\"] -- Obj Char\n</code></pre>\n"}], "owner": {"reputation": 676, "user_id": 161104, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7bb3f29d02f3cb9e350616b849452b7b?s=128&d=identicon&r=PG", "display_name": "BinRoot", "link": "https://stackoverflow.com/users/161104/binroot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456874534, "creation_date": 1456873360, "last_edit_date": 1456874534, "question_id": 35735358, "link": "https://stackoverflow.com/questions/35735358/how-to-create-a-data-type-with-value-constructor-containing-list-of-type-paramet", "title": "How to create a data type with value constructor containing list of type parameter types", "body": "<p>I have a data structure with a type parameter called <code>Fluent</code>.\nI want a list of these. What's the most elegant way to fix this code?</p>\n\n<pre><code>data Fluent t = Fluent [t]\ndata Obj = Obj [Fluent]\n</code></pre>\n\n<p>Edit: I want to be able to do this:</p>\n\n<pre><code>f1 = Fluent [True, False]\nf2 = Fluent [1, 2, 3, 4]\nlet o = Obj [f1, f2]\n</code></pre>\n"}, {"tags": ["haskell", "unsafe-perform-io"], "comments": [{"owner": {"reputation": 374, "user_id": 1465449, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8d5d5d4b1efba2d0396ceac6e67a0d6f?s=128&d=identicon&r=PG", "display_name": "heisenbug", "link": "https://stackoverflow.com/users/1465449/heisenbug"}, "edited": false, "score": 0, "creation_date": 1456873347, "post_id": 35735061, "comment_id": 59145013, "body": "How is it more unsafe than the readLn action. After all the result is IO [a]"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 4, "creation_date": 1456873599, "post_id": 35735061, "comment_id": 59145134, "body": "I wouldn&#39;t be so sure that this is legitimate use of the F\u1d1c\u0274\u1d04\u1d1b\u026a\u1d0f\u0274 \u1d1b\u029c\u1d00\u1d1b \ua731\u029c\u1d00\u029f\u029f \u0274\u1d0f\u1d1b \u0299\u1d07 \u0274\u1d00\u1d0d\u1d07\u1d05. With concurrency in the game, there&#39;s all kinds of things that could go wrong if the compiler messes up with referential transparancy assumptions. If <code>sample</code> worked really safely, then it would probably be in the library already."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1456889750, "post_id": 35735061, "comment_id": 59150033, "body": "If you are going to go with the <code>unsafe</code> route, you should at least use <code>unsafeInterleaveIO</code> here, which is the intended method of implementing lazy IO. Note that <code>getChanContents</code> itself uses <code>unsafeInterleaveIO</code> in order to lazily produce the entire contents of the Chan."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1456873852, "post_id": 35735357, "comment_id": 59145216, "body": "I agree with this, in all aspects."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1456874944, "post_id": 35735357, "comment_id": 59145713, "body": "could you explain in which way <code>getChanContents</code> is more predictable than using <code>unsafePerformIO</code>. I guess with other approaches than lazy IO you refer to things like <a href=\"https://hackage.haskell.org/package/pipes\" rel=\"nofollow noreferrer\"><code>pipes</code></a> or <a href=\"https://hackage.haskell.org/package/conduit\" rel=\"nofollow noreferrer\"><code>conduit</code></a>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1456875317, "post_id": 35735357, "comment_id": 59145854, "body": "@epsilonhalbe One (admittedly non-technical) advantage of <code>getChanContents</code> over manually using <code>unsafePerformIO</code>: it is maintained by experts in both GHC and concurrency; it is also more widely used than a homebrew solution and therefore more likely to be the scrutinee if/when a bug in its implementation creeps in."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1456875421, "post_id": 35735357, "comment_id": 59145891, "body": "@epsilonhalbe It&#39;s the <code>forever</code> loops that makes that approach more predictable, not the <code>getChanContents</code>. Even if no one demands elements in the returned list, <code>forever</code> will continuously take the MVar and buffer the read values in the channel. So, each <code>putMVar v</code> used elsewhere is guaranteed to always eventually find <code>v</code> empty."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 7, "last_activity_date": 1456873999, "last_edit_date": 1456873999, "creation_date": 1456873359, "answer_id": 35735357, "question_id": 35735061, "link": "https://stackoverflow.com/questions/35735061/sampling-an-mvar-can-i-avoid-unsafeperformio/35735357#35735357", "title": "Sampling an MVar, can I avoid unsafePerformIO?", "body": "<p>You can implement a similar function using a thread, a <code>Chan</code> and <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Concurrent-Chan.html#v:getChanContents\" rel=\"nofollow\"><code>getChanContents</code></a>:</p>\n\n<pre><code>sample :: MVar a -&gt; IO [a]\nsample v = do\n   c &lt;- newChan\n   forkIO $ forever $ takeMVar v &gt;&gt;= writeChan c\n   getChanContents c   \n</code></pre>\n\n<p>The thread/<code>getChanContents</code> approach is slightly better, since at least you can rely on the <code>MVar</code> being continuously taken. Instead, the <code>unsafePerformIO</code> approach will run <code>takeMVar</code> at impredictable points, making the <code>putMVar</code>s blocking in a similarly impredictable way. Of course, the <code>getChanContents</code> approach will buffer all the data, possibly requiring more memory.</p>\n\n<p>However, both approaches are essentially similar to lazy IO, which is best to be avoided, in my opinion.</p>\n"}], "owner": {"reputation": 374, "user_id": 1465449, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8d5d5d4b1efba2d0396ceac6e67a0d6f?s=128&d=identicon&r=PG", "display_name": "heisenbug", "link": "https://stackoverflow.com/users/1465449/heisenbug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 35735357, "answer_count": 1, "score": 0, "last_activity_date": 1456898934, "creation_date": 1456872072, "last_edit_date": 1456898934, "question_id": 35735061, "link": "https://stackoverflow.com/questions/35735061/sampling-an-mvar-can-i-avoid-unsafeperformio", "title": "Sampling an MVar, can I avoid unsafePerformIO?", "body": "<p>I have</p>\n\n<pre><code>sample :: MVar a -&gt; IO [a]\nsample v = do\n   a &lt;- takeMVar v\n   pure (a:unsafePerformIO (sample v))\n</code></pre>\n\n<p>which appears to be a legitimate use of <code>unsafePerformIO</code> to me. But I am very interested to know how to avoid it! Is there a pattern for this use already?</p>\n"}, {"tags": ["haskell", "haskell-lens"], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 5, "last_activity_date": 1456869076, "creation_date": 1456869076, "answer_id": 35734268, "question_id": 35733921, "link": "https://stackoverflow.com/questions/35733921/compose-lenses-with-accessing-outer-type-during-getter-and-setter/35734268#35734268", "title": "Compose lenses with accessing outer type during getter and setter", "body": "<p>Let's unshorten the types...</p>\n\n<pre><code>existingLensFunc\n   :: Inner2 -&gt; (\u2200 f . Functor f =&gt; (Result -&gt; f Result) -&gt; Outer -&gt; f Outer)\n   \u2261  \u2200 f . Functor f =&gt; Inner2 -&gt; (Result -&gt; f Result) -&gt; Outer -&gt; f Outer\n\nfinalLens\n   :: \u2200 f . Functor f =&gt; Inner1 -&gt; (Result -&gt; f Result) -&gt; Outer -&gt; f Outer\n</code></pre>\n\n<p>There's an evident place to &ldquo;grab off&rdquo; an <code>Outer</code> here: from the last argument.</p>\n\n<pre><code>finalLens inner1 fres outer = existingLensFunc (func outer inner1) fres outer\n</code></pre>\n"}], "owner": {"reputation": 1980, "user_id": 1773231, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa583dce412cb12defd92d6c18700df6?s=128&d=identicon&r=PG", "display_name": "Martin Kolinek", "link": "https://stackoverflow.com/users/1773231/martin-kolinek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 35734268, "answer_count": 1, "score": 1, "last_activity_date": 1456869076, "creation_date": 1456867808, "question_id": 35733921, "link": "https://stackoverflow.com/questions/35733921/compose-lenses-with-accessing-outer-type-during-getter-and-setter", "title": "Compose lenses with accessing outer type during getter and setter", "body": "<p>Suppose I have a function which extracts some inner value using other inner value from an outer value</p>\n\n<pre><code>func :: outer -&gt; inner1 -&gt; inner2\n</code></pre>\n\n<p>Then I have a function which cretes a lens between outer value and some other value using this inner2 value</p>\n\n<pre><code>existingLensFunc :: inner2 -&gt; Lens' outer result\n</code></pre>\n\n<p>Is there a way to create another function which creates a lens betwee outer value and result value using inner1 value? </p>\n\n<pre><code>finalLens :: inner1 -&gt; Lens' outer result\n</code></pre>\n\n<p>In other words, is there a better way to write this?</p>\n\n<pre><code>finalLens inner1 = lens getter setter\n  where setter outer result = let inner2 = func outer inner1 in set (existingLens inner2) result outer\n        getter outer = let inner2 = func outer inner1 in view (existingLens inner2) outer\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1456866150, "post_id": 35733219, "comment_id": 59141255, "body": "Wait. Did this actually compile? You&#39;re missing the indentation of your <code>show</code> lines."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1456866498, "post_id": 35733219, "comment_id": 59141472, "body": "The fact that you explicitly say not to use <code>Data.Tree</code> suggests you already know about <code>drawTree</code>. I can understand why you might want to avoid looking at the source of <code>drawTree</code> while building your own solution: for the joy of inventing the ideas yourself. What I can&#39;t understand is then why you would ask for a solution from elsewhere. What&#39;s better about learning the ideas from some random person on StackOverflow compared to learning the ideas from the author of the <code>containers</code> package?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457041867, "post_id": 35733219, "comment_id": 59238930, "body": "This is not actually a good <code>Show</code> instance. You should generally be able to copy the result of <code>show</code> and use it as Haskell source code (perhaps with added type annotations). This would be better as an independent <code>showTree</code> function."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 3324236, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a735a27a91e2a327a09b873e6cad27a7?s=128&d=identicon&r=PG&f=1", "display_name": "user3324236", "link": "https://stackoverflow.com/users/3324236/user3324236"}, "edited": false, "score": 0, "creation_date": 1456870743, "post_id": 35733802, "comment_id": 59143823, "body": "thanks dude that was correct. I couldn&#39;t figure out how to take indentation as a parameter"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1456997640, "post_id": 35733802, "comment_id": 59208242, "body": "There are several weird things going on here. For one, <code>concat (replicate n &quot;&lt;space&gt;&quot;)</code> is <code>replicate n &#39;&lt;space&gt;&#39;</code>."}, {"owner": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "edited": false, "score": 0, "creation_date": 1457028217, "post_id": 35733802, "comment_id": 59230870, "body": "Yeah, but it&#39;s easy to change to 2-space indentation, or <code>&quot;---[&quot;</code>, or whatever.  Anyway, the important thing is:  does it answer the question effectively?  It&#39;s often easier to be clever than to be clear..."}], "tags": [], "owner": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "is_accepted": false, "score": 4, "last_activity_date": 1456893344, "last_edit_date": 1456893344, "creation_date": 1456867399, "answer_id": 35733802, "question_id": 35733219, "link": "https://stackoverflow.com/questions/35733219/haskell-display-tree-without-data-tree-or-derivingshow/35733802#35733802", "title": "Haskell display Tree without Data.Tree or deriving(show)", "body": "<p>Your display function has no way of knowing how deeply to indent each line.  Prepending a space to your subtrees won't work because they will generally have more than one line.</p>\n\n<p>You need to define an auxiliary function which takes the indentation as a parameter:</p>\n\n<pre><code>indent n x = concat (replicate n \" \") ++ show x ++ \"\\n\"\n\nf n (Leaf x) = indent n x\nf n (Branch val l r) = indent n val ++ f (n+1) l ++ f (n+1) r\n\ninstance (Show a, Show b) =&gt; Show (Tree a b) where\n  show tree = f 0 tree\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "is_accepted": false, "score": 2, "last_activity_date": 1456867586, "creation_date": 1456867586, "answer_id": 35733864, "question_id": 35733219, "link": "https://stackoverflow.com/questions/35733219/haskell-display-tree-without-data-tree-or-derivingshow/35733864#35733864", "title": "Haskell display Tree without Data.Tree or deriving(show)", "body": "<p>Consider the following:</p>\n\n<pre><code>putStrLn (\"First line\" ++ \"   \" ++ \"\\n\" ++ \"Second line\")\n</code></pre>\n\n<p>The output is</p>\n\n<pre><code>First line   \nSecond line\n</code></pre>\n\n<p>because newline character doesn't keep indentation. You need to find a way to inform <code>show</code> how big of an indent you need for each item you want to print out.</p>\n"}, {"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1457002108, "post_id": 35769949, "comment_id": 59211575, "body": "For those waiting for another poem: nah. I had one this week, it wasn&#39;t that good / as a result I&#39;m not in a mood / to write another one that soon. Next poem probably next Wednesday, depending on the questions."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457044024, "post_id": 35769949, "comment_id": 59239986, "body": "The downside of this technique, as currently implemented, is that the <code>map</code> calls stack up. In this particular application, that&#39;s just fine, but in general that pattern is something to watch out for to avoid serious performance problems. I noticed that the implementation of <code>inits</code> in <code>base-4.7.0.1</code> (essentially the same as the reference implementation in the Haskell 98 Report) did something similar, which led me to discover that it was horribly slow. The new implementation is rather complicated for speed, but there&#39;s a simple way to do it by counting."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457044137, "post_id": 35769949, "comment_id": 59240058, "body": "You could fix the problem without counting, I think, by passing an indentation string around, adding spaces to it on the recursive calls."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457077045, "post_id": 35769949, "comment_id": 59251099, "body": "@dfeuer I thought of something like that, but I didn&#39;t have time to check it; will try on Sunday and benchmark/profile both variants, don&#39;t have access to a PC at the moment."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 1, "last_activity_date": 1457001908, "creation_date": 1457001908, "answer_id": 35769949, "question_id": 35733219, "link": "https://stackoverflow.com/questions/35733219/haskell-display-tree-without-data-tree-or-derivingshow/35769949#35769949", "title": "Haskell display Tree without Data.Tree or deriving(show)", "body": "<p><sup>Note: This post is written in literate Haskell. Copy it into your favourite editor, save it as Tree.lhs or similar and load it in GHCi.</sup></p>\n\n<p>Let's try a slightly other approach. Instead of showing the tree as a single string, we create the lines of our string:</p>\n\n<pre><code>&gt; data Tree a b = Branch b (Tree a b) (Tree a b) | Leaf a\n\n&gt; instance (Show a, Show b) =&gt; Show (Tree a b) where\n&gt;   show tree = magic (go tree)\n&gt;      where\n&gt;        go :: (Show a, Show b) =&gt; Tree a b -&gt; [String]\n</code></pre>\n\n<p>Don't worry about <code>magic</code> yet, it's going to have the type <code>magic :: [String] -&gt; String</code>.\nLet us focus on <code>go</code> first. If we want to show a single <code>Leaf</code>, we only have to concern a single value:</p>\n\n<pre><code>&gt;        go (Leaf v)       = [show v]\n</code></pre>\n\n<p>Now about the branches and their indentation. We can still show the value as in the <code>Leaf</code> case:</p>\n\n<pre><code>&gt;        go (Branch v l r) = show v\n</code></pre>\n\n<p>but we have to make sure that the actual branches have the correct amount of whitespace in front. We use a (yet to be defined) function called <code>indent</code>:</p>\n\n<pre><code>&gt;                        : indent (go l ++ go r)\n</code></pre>\n\n<p>Now we've got almost everything in place: if <code>indent</code> does what its name suggests, it's going to indent all the strings in the <code>[String]</code> returned by <code>go l ++ go r</code> by a single space. Therefore, the branches of a tree will always have one more space in the front as the root itself. All that's missing is now <code>indent</code> and <code>magic</code>:</p>\n\n<pre><code>&gt;        indent :: [String] -&gt; [String]\n&gt;        indent = map (' ':)\n</code></pre>\n\n<p>That was rather easy. You can of course exchange <code>(' ':)</code> with something else.</p>\n\n<p>It's now <code>magic</code>'s job to take all the strings and glue them together. Since you want to indent the whole tree by a single space, let's use <code>indent</code> a last time:</p>\n\n<pre><code>&gt;        magic = unlines . indent\n</code></pre>\n\n<p>And that's it. Here's the whole code for a better overview:</p>\n\n<pre><code>instance (Show a, Show b) =&gt; Show (Tree a b) where\n  show tree = magic (go tree)\n    where\n      go (Leaf v)       = [show v]\n      go (Branch v l r) = show v : indent (go l ++ go r)\n      indent            = map (' ':)\n      magic             = unlines . indent\n</code></pre>\n\n<p>The nice part about this technique is that we never have to use explicit levels or state the number of spaces somewhere. We can just walk the tree, create our <code>[String]</code>, and have <code>magic</code> and <code>indent</code> do the rest for us.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 0, "last_activity_date": 1457113797, "creation_date": 1457113797, "answer_id": 35802791, "question_id": 35733219, "link": "https://stackoverflow.com/questions/35733219/haskell-display-tree-without-data-tree-or-derivingshow/35802791#35802791", "title": "Haskell display Tree without Data.Tree or deriving(show)", "body": "<p>Your <code>Tree</code> type annoys me a little bit because it's a monad but can't be a <code>Monad</code>. Let me fix that for you by flipping the type arguments:</p>\n\n<pre><code>data Tree b a = Branch b (Tree a b) (Tree a b)\n              | Leaf a\n\ndisplay' :: (Show a, Show b) =&gt; String -&gt; Tree b a -&gt; String -&gt; String\ndisplay' prefix (Leaf a) =\n  (prefix ++) . shows a . ('\\n' :)\ndisplay' prefix (Branch v l r) =\n  (prefix ++) . shows v . ('\\n' :) . display' prefix' l . display' prefix' r\n  where prefix' = ' ' : prefix\n\ndisplay :: (Show a, Show b) =&gt; Tree b a -&gt; String\ndisplay t = display' ' ' t \"\"\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 3324236, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a735a27a91e2a327a09b873e6cad27a7?s=128&d=identicon&r=PG&f=1", "display_name": "user3324236", "link": "https://stackoverflow.com/users/3324236/user3324236"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 582, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1457113797, "creation_date": 1456865471, "question_id": 35733219, "link": "https://stackoverflow.com/questions/35733219/haskell-display-tree-without-data-tree-or-derivingshow", "title": "Haskell display Tree without Data.Tree or deriving(show)", "body": "<p>Hi guys I'm having an issue with my instance to show a tree in Haskell: here is my code:</p>\n\n<pre><code>data Tree a b = Branch b (Tree a b) (Tree a b)\n          | Leaf a\ninstance  (Show a, Show b) =&gt;Show (Tree a b) where\nshow (Leaf x) = \" \"++show x ++\"\\n\"\nshow (Branch val l r) = show val ++ \"\\n\" ++\" \" ++ show l ++ \" \" ++ show r\n</code></pre>\n\n<p>here is my test case and output( which is wrong):</p>\n\n<pre><code> Branch \"&lt;\" (Branch \"&lt;\" (Leaf 'a') (Leaf 'c')) (Branch \"&lt;\" (Leaf 'g') (Branch     \"&lt;\" (Leaf 'n') (Leaf 'y'))))\n \"&lt;\"\n  \"&lt;\"\n    'a'\n    'c'\n  \"&lt;\"\n    'g'\n  \"&lt;\"\n    'n'\n    'y'\n</code></pre>\n\n<p>the right output</p>\n\n<pre><code> \"&lt;\"\n  \"&lt;\"\n    'a'\n    'c'\n  \"&lt;\"\n    'g'\n    \"&lt;\"\n      'n'\n      'y'\n</code></pre>\n\n<p>any help would be great!</p>\n"}, {"tags": ["list", "haskell", "recursion"], "comments": [{"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 0, "creation_date": 1456860785, "post_id": 35731776, "comment_id": 59138238, "body": "Test for <code>0</code> to end the recursion. Something like <code>numba2listInReverse 0 = []</code> (haven&#39;t tested it, but it&#39;s the basic idea)"}, {"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 0, "creation_date": 1456860875, "post_id": 35731776, "comment_id": 59138284, "body": "A different way to solve this problem would be to use <code>reverse $ show x</code>."}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 1, "creation_date": 1456860991, "post_id": 35731776, "comment_id": 59138363, "body": "I have to mention that there is a quick one-liner involving show and reverse that solves this problem.  Also, note that your output is correct, if you recognize that 1234 can also be written as ..00001234."}, {"owner": {"reputation": 897, "user_id": 1755520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mqzKa.jpg?s=128&g=1", "display_name": "bartavelle", "link": "https://stackoverflow.com/users/1755520/bartavelle"}, "edited": false, "score": 1, "creation_date": 1456861338, "post_id": 35731776, "comment_id": 59138569, "body": "<code>dropLastDigit</code> could be written as <code>dropLastDigit = flip div 10</code>, you don&#39;t need the substraction."}, {"owner": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 0, "creation_date": 1456869180, "post_id": 35731776, "comment_id": 59142980, "body": "Thanks for your feedback, mates. Now, in order: 1) I didn&#39;t know neither &quot;show&quot; nor &quot;reverse&quot;. But I&#39;ll investigate, it sound interesting, thanks! The same stands for &quot;flip&quot;. 2) What if I have a number like 0000123 and want to put ALL of it in the list? Checking for zero would exclude the initial zero(es)."}], "answers": [{"comments": [{"owner": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 0, "creation_date": 1456869185, "post_id": 35732048, "comment_id": 59142983, "body": "Thanks for your exhaustive reply. While I&#39;m a haskell newcomer, I was however aware of guards and, believe it or not, I imagined exactly your solution. But I dropped it since I thought it would have stopped if at least one of the digits would have been zero. Now, I understand my mistake, but a problem still stands: if the number <b>begins</b> with a zero, that zero will not be put in the list. May you suggest a workaround?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 0, "creation_date": 1456869920, "post_id": 35732048, "comment_id": 59143426, "body": "@MadHatter: see updated answer in case you want to map <code>0</code> onto <code>[0]</code>. What do you mean with <i>begins</i>, Haskell interprets <code>042</code> as <code>42</code>, you cannot know how the user has written a number."}, {"owner": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 0, "creation_date": 1456870635, "post_id": 35732048, "comment_id": 59143760, "body": "I wasn&#39;t aware of that. Very well, understood..!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 1, "last_activity_date": 1456869773, "last_edit_date": 1456869773, "creation_date": 1456861469, "answer_id": 35732048, "question_id": 35731776, "link": "https://stackoverflow.com/questions/35731776/haskell-list-generation/35732048#35732048", "title": "Haskell List Generation", "body": "<blockquote>\n  <p>It continues to put zeroes in the list even once the number is exhausted. </p>\n</blockquote>\n\n<p>That's because you did not tell Haskell to stop when the number is exhausted.</p>\n\n<p>You define a <em>recursive</em> function. In order to write good (read <em>terminating</em>) recursive functions, you need a <strong>stop condition</strong>: a condition for which you stop calling the recursion.</p>\n\n<p>You can do this by using a <a href=\"http://learnyouahaskell.com/syntax-in-functions#guards-guards\" rel=\"nofollow\"><em>guard</em></a>:</p>\n\n<pre>\nnumba2listInReverse :: Integer -> [Integer]\nnumba2listInReverse x <b>| x == 0</b> = []\n                      <b>| otherwise</b> = lastDigit x : numba2listInReverse (dropLastDigit x)\n</pre>\n\n<p>The guards are denoted with pipe characters (<code>|</code>) and are followed by conditions (like <code>x == 0</code> and <code>otherwise</code>). After the condition, the \"assignment\" operator is written followed by the expression to be evaluated if the condition holds. The conditions are tested in the <em>order you have written them</em>. In case of overlap, the first condition that succeeds will thus be \"fired\" (so to speak). <code>otherwise</code> is equal to <code>True</code> (you can test this for instance is <code>ghci</code>) and thus will always be fired if none of the above guards fired.</p>\n\n<p>If zero (<code>0</code>) is thus given to the <code>numba2listInReverse</code> function, it will return the empty list (and no more recursion is done). Otherwise (<code>otherwise</code>) it will perform the recursion you've defined: \"emit\" the last digit as first symbol from the list, followed by the recursive step.</p>\n\n<blockquote>\n  <p><strong>Note</strong>: strictly speaking, in Haskell recursive functions do not necessarily need a <em>stop condition</em>: because of lazy evaluation, some recursive functions can exists that have no stop condition, for instance to define a list containing \"<em>all</em>\" prime numbers.</p>\n</blockquote>\n\n<hr>\n\n<p><strong>EDIT</strong>: In case you want to map <code>0</code> onto <code>[0]</code>, you <strong>cannot</strong> simply modify the above code to:</p>\n\n<pre><code>numba2listInReverse :: Integer -&gt; [Integer]\nnumba2listInReverse x | x == 0 = [0]\n                      | otherwise = lastDigit x : numba2listInReverse (dropLastDigit x)\n</code></pre>\n\n<p>Indeed, this would result in <code>42</code> being mapped on <code>[2,4,0]</code>. Now you can solve the problem by introducing a helper function, that will for instance handle the recursive case:</p>\n\n<pre><code>numba2listInReverse :: Integer -&gt; [Integer]\nnumba2listInReverse x | x == 0 = [0]\n                      | otherwise = help x\n    where help x | x == 0 = []\n                 | otherwise = lastDigit x : help (dropLastDigit x)\n</code></pre>\n\n<p>Here you thus leave the non-zero case to the <code>help</code> function.</p>\n"}], "owner": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 35732048, "answer_count": 1, "score": 0, "last_activity_date": 1456869773, "creation_date": 1456860707, "last_edit_date": 1456862082, "question_id": 35731776, "link": "https://stackoverflow.com/questions/35731776/haskell-list-generation", "title": "Haskell List Generation", "body": "<p>I found an interesting exercise and tried to solve it.</p>\n\n<p>It requires that, given a number, its digits should be put in a list in reverse order.</p>\n\n<p>Now, I almost managed to do it:</p>\n\n<pre><code>lastDigit :: Integer -&gt; Integer\nlastDigit x = x `mod` 10\n\ndropLastDigit :: Integer -&gt; Integer\ndropLastDigit x = (x - lastDigit x) `div` 10\n\nnumba2listInReverse :: Integer -&gt; [Integer]\nnumba2listInReverse x = lastDigit x : numba2listInReverse (dropLastDigit x)\n</code></pre>\n\n<p>The first function simply returns the last digit. The second returns the number deprived of its last digit. Finally, the last function generates the list. My problem is I cannot find a way to <em>stop</em> the recursion. Look at the output:</p>\n\n<pre><code>Ok, modules loaded: Main.\n*Main&gt; dropLastDigit 123\n12\n*Main&gt; numba2listInReverse 12345\n[5,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0Interrupted.\n*Main&gt; \n</code></pre>\n\n<p>It continues to put zeroes in the list even once the number is exhausted. How to solve this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 3, "creation_date": 1456859481, "post_id": 35731286, "comment_id": 59137449, "body": "What do you expect as a result of zip when the first list is empty and the second is not"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1456860603, "post_id": 35731286, "comment_id": 59138127, "body": "<code>-Wall</code> would have warned that your patterns are not exhaustive. I recommend turning that on."}, {"owner": {"reputation": 897, "user_id": 1755520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mqzKa.jpg?s=128&g=1", "display_name": "bartavelle", "link": "https://stackoverflow.com/users/1755520/bartavelle"}, "edited": false, "score": 1, "creation_date": 1456861221, "post_id": 35731286, "comment_id": 59138501, "body": "I find it surprising that you get this output, as I would have expected the result to be of type <code>[(Char,String)]</code>!"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1456861562, "post_id": 35731286, "comment_id": 59138729, "body": "btw if you are interested in efficiency take a look at <code>:</code>, it can be used (with slight modifications) in the place of <code>++</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1456864565, "post_id": 35731286, "comment_id": 59140398, "body": "@epsilonhalbe GHC is smart enough to do the <code>[x] ++ y =&gt; x:y</code> transformation for you; this is nice, as it means you can use the two different forms to give subtle hints about what the author &quot;meant&quot;. For example, <code>b ++ [m] ++ e</code> makes the symmetry between <code>b</code> and <code>e</code> more clear than <code>b ++ m : e</code>. However, I agree that the author should mean to use <code>:</code> here. =)"}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1456866833, "post_id": 35733380, "comment_id": 59141673, "body": "I suggest your stackoverflow account be linked to <a href=\"https://poetry.stackexchange.com\" rel=\"nofollow noreferrer\">poetry.stackexchange.com</a>."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456905564, "post_id": 35733380, "comment_id": 59156427, "body": "you should make a living out of this ... please keep me subscribed for the third week ;)"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 3, "user_id": 5987739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b90dd9020e10261049713490f0e5ff56?s=128&d=identicon&r=PG&f=1", "display_name": "S Kilborn", "link": "https://stackoverflow.com/users/5987739/s-kilborn"}, "edited": false, "score": 0, "creation_date": 1456937235, "post_id": 35733380, "comment_id": 59179786, "body": "@SKilborn: You&#39;re welcome. Since you&#39;re new, you&#39;re probably want to <a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\">learn how to accept an answer</a>. Otherwise your question will come up as &quot;unanswered&quot; in some filters."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456940040, "post_id": 35733380, "comment_id": 59181665, "body": "@Carsten Sure, just let me start a kickstarter campaign and/or a patreon account, some etsy page with Haskell stories like &quot;The boy who cried bottom&quot;, &quot;MultiParamTypeclasses and the seven Functional Dependencies&quot;, &quot;The Prism and the Lens&quot; and then I wait for the money. That&#39;s how it works, right? :D"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 4, "last_activity_date": 1456865980, "creation_date": 1456865980, "answer_id": 35733380, "question_id": 35731286, "link": "https://stackoverflow.com/questions/35731286/chaos-while-converting-strings-from-files-to-tuple/35733380#35733380", "title": "Chaos while converting Strings (from files) to Tuple", "body": "<p>An exception! How can that be?<br>\nIsn't that quite a quip.<br>\nBut there's a message, telling ye,<br>\na non-exhaustive pattern<br>\nin this very matter<br>\nwas found in your <code>myZip</code>.</p>\n\n<hr>\n\n<p>You're missing the pattern for the following case:</p>\n\n<pre><code>myZip [] [1] = ???\n</code></pre>\n\n<p>If you had used <code>-Wall</code>, the compiler would have given the following warning:</p>\n\n<pre>\nCode.hs:2:1: Warning:\n    Pattern match(es) are non-exhaustive\n    In an equation for `myZip': Patterns not matched: [] (_ : _)\n</pre>\n\n<p>If your function is going to return the same value for almost all patterns except one, it's often easier to define that one first and then match all others:</p>\n\n<pre><code>myZip (x:xs) (y:ys) = [(x,y)] ++ myZip xs ys\nmyZip _      _      = []\n</code></pre>\n\n<p>That way you don't miss a pattern by accident too.</p>\n"}], "owner": {"reputation": 3, "user_id": 5987739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b90dd9020e10261049713490f0e5ff56?s=128&d=identicon&r=PG&f=1", "display_name": "S Kilborn", "link": "https://stackoverflow.com/users/5987739/s-kilborn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 35733380, "answer_count": 1, "score": 0, "last_activity_date": 1456865980, "creation_date": 1456859120, "last_edit_date": 1456859723, "question_id": 35731286, "link": "https://stackoverflow.com/questions/35731286/chaos-while-converting-strings-from-files-to-tuple", "title": "Chaos while converting Strings (from files) to Tuple", "body": "<p>I'm trying to convert two textfiles into strings, and then adding them together in double-tuples, in  a list. like this: <code>[(_,_),(_,_)]</code>\nThis is my function:</p>\n\n<pre><code>testa = do  \n    questions &lt;- readFile \"questionsQ.txt\" \n    category &lt;- readFile \"category.txt\"\n    print (myZip category (lines questions))\n\nmyZip :: [a] -&gt; [b] -&gt; [(a, b)]\nmyZip [] [] = []\nmyZip _ [] = []\nmyZip (x:xs) (y:ys) = [(x,y)] ++ myZip xs ys\n</code></pre>\n\n<p><code>questions.txt</code> contains one question per row</p>\n\n<p><code>categories.txt</code> contains a line of 50 numbers in a long row, each one representing one of the 5 categories</p>\n\n<p>(Note &ndash; it may work at Mac computers, but I don't know why)\nThis is my error message when I try to run the program (some of it at least):</p>\n\n<pre><code>[(\"0\",\"I prefer variety to routine\"),(\"0\",\"\"),(\"0\",\"I'm an innovative person with a vivid imagination\"),(\"0\",\"\"),(\"0\",\"I enjoy wild flights of fantasy\")....\nghci&gt;\n*** Exception: todo.hs:(35,1)-(37,44): Non-exhaustive patterns in function myZip\n</code></pre>\n\n<p>Why does it combine tuples with empty strings? And why is an error message occuring?</p>\n"}, {"tags": ["haskell", "quickcheck"], "comments": [{"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 0, "creation_date": 1456845016, "post_id": 35726256, "comment_id": 59127663, "body": "It looks like you are not using <code>ThePlayers</code> in <code>checkWin</code>. Why not just check for a win on only the <code>Int</code> values? You could convert <code>[(Int, ThePlayers)]</code> to <code>[Int]</code> with <code>map fst</code>."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1456845338, "creation_date": 1456845338, "answer_id": 35726592, "question_id": 35726256, "link": "https://stackoverflow.com/questions/35726256/quickcheck-on-custom-datatype/35726592#35726592", "title": "Quickcheck on custom datatype", "body": "<p><a href=\"http://hackage.haskell.org/package/QuickCheck-2.8.2/docs/Test-QuickCheck-Arbitrary.html#v:arbitrary\" rel=\"nofollow\"><code>Arbitrary</code></a> is a typeclass with one function <code>arbitrary</code> you have to implement. As the documentation says:</p>\n\n<blockquote>\n<pre><code>arbitrary :: Gen a\n</code></pre>\n  \n  <p>A generator for values of the given type.</p>\n</blockquote>\n\n<p><code>Gen</code> is a monad that allows you to construct a \"<em>random</em>\" value. <em>QuickCheck</em> will use this to generate random instances in order to generate random lists <code>[(Int, ThePlayers)]</code> to test the property.</p>\n\n<p>Since you do not show the definition for <code>data ThePlayers</code> we can only guess how to generate an arbitrary value.</p>\n\n<p>An example might be:</p>\n\n<pre><code>data Foo = Positive Int | Coordinate Int Int | Character Char\n\ninstance Arbitrary Foo where\n    arbitrary = oneof [arbitraryPositive,arbitraryCoordinate,arbitraryCharacter]\n        where arbitraryPositive = do\n                  p &lt;- arbitrary\n                  return $ Positive $ abs p\n              arbitraryCoordinate = do\n                  x &lt;- arbitrary\n                  y &lt;- arbitrary\n                  return $ Coordinate x y\n              arbitraryCharachter = do\n                  c &lt;- arbitrary\n                  return $ Character c\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 4, "last_activity_date": 1456847235, "last_edit_date": 1456847235, "creation_date": 1456845733, "answer_id": 35726739, "question_id": 35726256, "link": "https://stackoverflow.com/questions/35726256/quickcheck-on-custom-datatype/35726739#35726739", "title": "Quickcheck on custom datatype", "body": "<p>QuickCheck has to generate random cases to test against your property, by</p>\n\n<pre><code>No instance for (Arbitrary ThePlayers)\n</code></pre>\n\n<p>It basically said it doesn't know how to generate a random <code>ThePlayers</code> value for the tests and you should implement an instance <code>Arbitrary ThePlayers</code>.</p>\n\n<hr>\n\n<p>Also the type of <code>quickCheck</code> is</p>\n\n<pre><code>quickCheck :: Testable prop =&gt; prop -&gt; IO () \n</code></pre>\n\n<p>Even if the module can generate random arguments for you, the function <code>removeFromList</code> doesn't look like a <code>Testable</code> (a property), neither <code>checkWin</code>: A property of a function is about: what is supposed to be the right result of it? What should the results satisfy? What's the relationship between arguments and the results? The QuickCheck module won't and can't generate property from your functions, you have to specify it yourself.</p>\n\n<p>(BTW your first test on <code>checkWin</code> got compiled only because it have a return type <code>Bool</code> by chance, it isn't indicating any property of your program and will fail almost every time)</p>\n\n<p>For example one property of <code>reverse</code> function from <code>Data.List</code> is: <em>the <code>reverse</code> function should not change the length of the list</em>, so a check based on this fact shoud be:</p>\n\n<pre><code>prop_length :: [Int] -&gt; Bool\nprop_length as = length as == length (reverse as)\n</code></pre>\n\n<p>and then you can build a test based on it:</p>\n\n<pre><code>test_propLength = quickCheck prop_length\n</code></pre>\n\n<hr>\n\n<p>You may try <a href=\"https://www.schoolofhaskell.com/user/pbv/an-introduction-to-quickcheck-testing\" rel=\"nofollow\">some tutorials</a> for more information.</p>\n"}], "owner": {"reputation": 311, "user_id": 3296768, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1f31f7a7524e7628dd45c356a788ac98?s=128&d=identicon&r=PG&f=1", "display_name": "darrrrUC", "link": "https://stackoverflow.com/users/3296768/darrrruc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 756, "favorite_count": 0, "accepted_answer_id": 35726739, "answer_count": 2, "score": 2, "last_activity_date": 1456847235, "creation_date": 1456844477, "last_edit_date": 1456845481, "question_id": 35726256, "link": "https://stackoverflow.com/questions/35726256/quickcheck-on-custom-datatype", "title": "Quickcheck on custom datatype", "body": "<p>I succesfully run a quickcheck on this:</p>\n\n<pre><code>testaroo = quickCheck $ checkWin\n\ncheckWin :: [(Int, ThePlayers)] -&gt; Bool\ncheckWin [(1,_),(2,_),(3,_)] = True\ncheckWin [(4,_),(5,_),(6,_)] = True\ncheckWin [(7,_),(8,_),(9,_)] = True\ncheckWin [(1,_),(5,_),(9,_)] = True\ncheckWin [(3,_),(5,_),(7,_)] = True\ncheckWin [(1,_),(4,_),(7,_)] = True\ncheckWin [(2,_),(5,_),(8,_)] = True\ncheckWin [(3,_),(6,_),(9,_)] = True\ncheckWin _ = False\n</code></pre>\n\n<p>but when i try to run </p>\n\n<pre><code>testaroo = quickCheck $ removeFromList\n\nremoveFromList :: (Int, ThePlayers) -&gt; [(Int, ThePlayers)] -&gt; [(Int, ThePlayers)]\nremoveFromList tuple list = delete tuple list\n</code></pre>\n\n<p>I run into the following:</p>\n\n<pre><code>No instance for (Arbitrary ThePlayers)\n      arising from a use of `quickCheck'\n    Possible fix:\n      add an instance declaration for (Arbitrary ThePlayers)\n    In the expression: quickCheck\n    In the expression: quickCheck $ removeFromList\n    In an equation for `testaroo':\n        testaroo = quickCheck $ removeFromList\nFailed, modules loaded: none.\n</code></pre>\n\n<p>What I did to run my quickCheck on checkWin successfully I added</p>\n\n<pre><code>instance Arbitrary BoardState\n    where\n    arbitrary  = arbitrary\n</code></pre>\n\n<p>But in all honesty I'm not quite sure what this does :). Is there anyway I can make the test run on my <code>removeFromList</code> function?</p>\n"}, {"tags": ["list", "haskell", "typeclass"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1456861052, "post_id": 35720366, "comment_id": 59138399, "body": "<a href=\"http://hackage.haskell.org/package/these-0.6.2.1/docs/Data-Align.html#t:Unalign\" rel=\"nofollow noreferrer\">Data.Align.Unalign</a>"}, {"owner": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1465123385, "post_id": 35720366, "comment_id": 62761802, "body": "Related: The &quot;deeper meaning&quot; behind <i>zip</i> is being a <a href=\"https://hackage.haskell.org/package/adjunctions-4.3/docs/Data-Functor-Adjunction.html\" rel=\"nofollow noreferrer\">right adjoint</a>."}], "answers": [{"comments": [{"owner": {"reputation": 44721, "user_id": 546084, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/wMoWk.jpg?s=128&g=1", "display_name": "Chris Taylor", "link": "https://stackoverflow.com/users/546084/chris-taylor"}, "edited": false, "score": 1, "creation_date": 1456832478, "post_id": 35721429, "comment_id": 59118531, "body": "Good answer. I think it&#39;s also worth noting that <code>gunzip</code> specialized to <code>[]</code> is less efficient than <code>unzip</code> (it takes two passes instead of one)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456852278, "post_id": 35721429, "comment_id": 59133120, "body": "I gather it can sometimes be faster, but memory leaks bite."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1456853791, "post_id": 35721429, "comment_id": 59134063, "body": "You can do this in one pass, most easily using <code>Control.Arrow</code>: <code>gunzip = fmap (fst &amp;&amp;&amp; snd)</code>."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1456854598, "post_id": 35721429, "comment_id": 59134578, "body": "@chepner, it doesn&#39;t typecheck. <code>fst &amp;&amp;&amp; snd \u2257 id</code> and <code>fmap id \u2257 id</code>. Hence your definition is <code>gunzip = id</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1456855271, "post_id": 35721429, "comment_id": 59134999, "body": "Sorry, I oversimplified and didn&#39;t look closely at my test result. <code>(fmap fst) &amp;&amp;&amp; (fmap snd)</code> should work."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1456855471, "post_id": 35721429, "comment_id": 59135128, "body": "@chepner, this function is pointfree, but it doesn&#39;t mean that it traverses lists once. <code>(fmap fst &amp;&amp;&amp; fmap snd) ps</code> immediately reduces to <code>(fmap fst ps, fmap snd ps)</code>, so it&#39;s the same function."}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": true, "score": 7, "last_activity_date": 1456833492, "last_edit_date": 1456833492, "creation_date": 1456830982, "answer_id": 35721429, "question_id": 35720366, "link": "https://stackoverflow.com/questions/35720366/what-is-the-generalisation-of-unzip/35721429#35721429", "title": "What is the generalisation of unzip?", "body": "<p>You can simply take first and second projections:</p>\n\n<pre><code>gunzip :: Functor f =&gt; f (a, b) -&gt; (f a, f b)\ngunzip ps = (fmap fst ps, fmap snd ps)\n</code></pre>\n\n<p>But note that <code>gunzip</code> traverses <code>ps</code> twice unlike the usual <code>zip</code> for lists, so it's troublesome, because <code>ps</code> is not garbage collected after the first pass and stays in the memory, which causes memory leaks on big lists.</p>\n"}, {"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1456836943, "post_id": 35722784, "comment_id": 59121511, "body": "But <code>unzip&#39;</code> &quot;linearizes&quot; a structure: unzipping of a tree doesn&#39;t result in a tuple of trees but rather in a tuple of lists in disguise."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1456839243, "post_id": 35722784, "comment_id": 59123302, "body": "@user3237465 If the tree is a properly defined instance of <code>Functor</code>, then <code>fmap</code> will produce a tree, not a list. The type of <code>fmap</code> is <code>a -&gt; b -&gt; f a -&gt; f b</code>, not <code>a -&gt; b -&gt; f a -&gt; [b]</code>."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1456841471, "post_id": 35722784, "comment_id": 59124983, "body": "@chepner, I meant the second <code>unzip&#39; = foldr f</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1456845789, "post_id": 35722784, "comment_id": 59128296, "body": "That&#39;s not <code>Prelude.foldr</code>; it works with any <code>Foldable</code> type, not just lists."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1456849712, "post_id": 35722784, "comment_id": 59131254, "body": "There does seem to be a problem with the second <code>unzip&#39;</code>, though; it only takes one argument, but it needs to supply two in addition to the function <code>f</code> passed to <code>foldr</code>."}, {"owner": {"reputation": 44721, "user_id": 546084, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/wMoWk.jpg?s=128&g=1", "display_name": "Chris Taylor", "link": "https://stackoverflow.com/users/546084/chris-taylor"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1456849890, "post_id": 35722784, "comment_id": 59131396, "body": "@chepner I corrected that in the most recent edit (about 5 min ago!)"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1456854425, "post_id": 35722784, "comment_id": 59134467, "body": "@chepner, it works with any <code>Foldable</code> like it&#39;s a list, i.e. <code>Foldable.foldr f z \u2257 Prelude.foldr f z . toList</code>. But that doesn&#39;t matter, because when you return a <code>MonadPlus</code>, your structure is flat anyway. Though, it&#39;s possible to represent non-flat structures using flat <code>Monoid</code>s like <a href=\"https://hackage.haskell.org/package/fmlist-0.9/docs/Data-FMList.html\" rel=\"nofollow noreferrer\">this</a> and hence this is probably possible with <code>MonadPlus</code>, but then you need a smarter recursor than just <code>foldr</code>, which is far to generic to be easily expressible."}, {"owner": {"reputation": 44721, "user_id": 546084, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/wMoWk.jpg?s=128&g=1", "display_name": "Chris Taylor", "link": "https://stackoverflow.com/users/546084/chris-taylor"}, "edited": false, "score": 0, "creation_date": 1456904539, "post_id": 35722784, "comment_id": 59155840, "body": "Yeah, I agree that this will always return flat structures."}, {"owner": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "edited": false, "score": 0, "creation_date": 1456914501, "post_id": 35722784, "comment_id": 59162374, "body": "This could still be useful if the <code>Foldable</code> and the <code>MonadPlus</code> are the same type!"}], "tags": [], "owner": {"reputation": 44721, "user_id": 546084, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/wMoWk.jpg?s=128&g=1", "display_name": "Chris Taylor", "link": "https://stackoverflow.com/users/546084/chris-taylor"}, "is_accepted": false, "score": 6, "last_activity_date": 1456849127, "last_edit_date": 1456849127, "creation_date": 1456834855, "answer_id": 35722784, "question_id": 35720366, "link": "https://stackoverflow.com/questions/35720366/what-is-the-generalisation-of-unzip/35722784#35722784", "title": "What is the generalisation of unzip?", "body": "<p>Intuitively, the <code>unzip'</code> function has to tear down a structure holding <code>(a,b)</code> , and then build it up into two copies of the structure, the first of which contains the <code>a</code> and the second of which contains the <code>b</code>.</p>\n\n<p>One possible generalization, already mentioned in another answer, is</p>\n\n<pre><code>unzip' :: (Functor t) =&gt; t (a, b) -&gt; (t a, t b)\nunzip' xs = (fmap fst xs, fmap snd xs)\n</code></pre>\n\n<p>This fits the bill, but one disadvantage is that it has to pass over the initial structure twice - once for each call to <code>fmap</code>.</p>\n\n<hr>\n\n<p>The <code>Foldable</code> class describes structures which can be iterated over, building a result as we go. We can take advantage of this property to ensure that we only pass over the initial structure once (one call to <code>foldr</code>) but we still need to know how to build up copies of the structures again.</p>\n\n<p>The <code>MonadPlus</code> type class provides ways to get an empty structure, and to combined two structures (a bit like higher-order <code>Monoid</code>) -</p>\n\n<pre><code>class Monad m =&gt; MonadPlus m where\n  mzero :: m a\n  mplus :: m a -&gt; m a -&gt; m a\n</code></pre>\n\n<p>With this, we can write</p>\n\n<pre><code>import Control.Monad\nimport Data.Foldable (foldr)\n\nunzip' :: (Foldable t, MonadPlus m) =&gt; t (a, b) -&gt; (m a, m b)\nunzip' = foldr f (mzero, mzero)\n  where\n    f (a,b) (as, bs) = (mplus (return a) as, mplus (return b) bs)\n</code></pre>\n\n<p>We can then do things like</p>\n\n<pre><code>&gt;&gt; unzip' [(1,2), (3,4)] :: ([Int], [Int])\n([1,3],[2,4])\n</code></pre>\n\n<p>but also</p>\n\n<pre><code>&gt;&gt; unzip' (Right (1,2)) :: ([Int], Maybe Int)\n([1],Just 2)\n</code></pre>\n\n<hr>\n\n<p>One final thought - it's a bit ugly that we need to call <code>mplus (return a) as</code>. It might be nicer to have a class like</p>\n\n<pre><code>class Listish m where\n  null :: m a\n  cons :: a -&gt; m a -&gt; m a\n</code></pre>\n\n<p>but I haven't really explored this bit of the design space.</p>\n"}], "owner": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 1, "accepted_answer_id": 35721429, "answer_count": 2, "score": 7, "last_activity_date": 1456849127, "creation_date": 1456827912, "question_id": 35720366, "link": "https://stackoverflow.com/questions/35720366/what-is-the-generalisation-of-unzip", "title": "What is the generalisation of unzip?", "body": "<p>Most methods I know from lists are actually special cases of some well-known type classes. Some examples of methods and the related type class:</p>\n\n<ul>\n<li><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]</code> and <code>Functor</code></li>\n<li><code>foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b</code> and <code>Foldable</code></li>\n<li><code>forM :: Monad m =&gt; [a] -&gt; (a -&gt; m b) -&gt; m [b]</code> and <code>Traversable</code></li>\n<li><code>concat :: [[a]] -&gt; [a]</code> and <code>Monad</code></li>\n</ul>\n\n<p>Possibly the list goes on (pardon the pun).</p>\n\n<p>I'm wondering about the \"deeper meaning\" behind <code>unzip :: [(a, b)] -&gt; ([a], [b])</code>. Can it be implemented using some famous instances of <code>[]</code> and, e.g., the functor instance of <code>(,a)</code>? Or some other instances? Ideally, I'd want to have a more abstract function with this type: <code>SomeClass m =&gt; unzip :: m (a, b) -&gt; (m a, m b)</code>. Is there a class that will make this work?</p>\n"}, {"tags": ["haskell", "monads"], "answers": [{"tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 1, "last_activity_date": 1456821003, "creation_date": 1456821003, "answer_id": 35717951, "question_id": 35717861, "link": "https://stackoverflow.com/questions/35717861/dealing-with-io-action/35717951#35717951", "title": "Dealing with IO action", "body": "<p>Both the <code>then</code> and <code>else</code> value in an <code>if</code> need to have the same type.  You need to convert <code>String</code> to <code>IO String</code>.</p>\n\n<p>The <code>return</code> function will do this for you.</p>\n\n<pre><code>main:: IO()\nmain = do\n    retval &lt;- if something\n                 then return \"foo\"\n                 else getLine\n     print retval\n</code></pre>\n\n<p>Note that because the this is of type IO a, you also need to assign the value of retVal using \"&lt;-\", not <code>let .. = ..</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 5965348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d481c77e43f88fac1d056c7da032948?s=128&d=identicon&r=PG&f=1", "display_name": "Sho", "link": "https://stackoverflow.com/users/5965348/sho"}, "edited": false, "score": 0, "creation_date": 1456821832, "post_id": 35717971, "comment_id": 59111959, "body": "Thanks for kind reply :) I understand now"}], "tags": [], "owner": {"reputation": 14704, "user_id": 908515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f1L9v.png?s=128&g=1", "display_name": "undur_gongor", "link": "https://stackoverflow.com/users/908515/undur-gongor"}, "is_accepted": true, "score": 2, "last_activity_date": 1456828544, "last_edit_date": 1456828544, "creation_date": 1456821055, "answer_id": 35717971, "question_id": 35717861, "link": "https://stackoverflow.com/questions/35717861/dealing-with-io-action/35717971#35717971", "title": "Dealing with IO action", "body": "<p>Both branches of <code>if</code> have to have the same type. Since <code>\"foo\"</code> is <code>String</code>, the <code>else</code> part has to be a <code>String</code> too (but not an <code>IO String</code>).</p>\n\n<p>You can do</p>\n\n<pre><code>retval = if something\n           then return \"foo\"\n           else getLine\n</code></pre>\n\n<p>in order to make all parts of the <code>if</code> of type <code>IO String</code>. Here, <code>return</code> converts the string <code>\"foo\"</code> to an <code>IO</code> action which just returns <code>\"foo\"</code>.</p>\n\n<p>Then, you need to extract the <code>String</code> back out of the <code>IO String</code> because <code>print</code> expects a string (i.e. you carry out the <code>IO</code> action):</p>\n\n<pre><code>retval &lt;- if something\n            then return \"foo\"\n            else getLine\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5965348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d481c77e43f88fac1d056c7da032948?s=128&d=identicon&r=PG&f=1", "display_name": "Sho", "link": "https://stackoverflow.com/users/5965348/sho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 1, "accepted_answer_id": 35717971, "answer_count": 2, "score": 2, "last_activity_date": 1456828544, "creation_date": 1456820628, "question_id": 35717861, "link": "https://stackoverflow.com/questions/35717861/dealing-with-io-action", "title": "Dealing with IO action", "body": "<p>I'm a haskell beginner and got stuck with IO action behavior.</p>\n\n<pre><code>main() :: IO()\n  retval = if something\n             then \"foo\"\n             else `return value of IO String action` i.e getLine\n  print retval\n</code></pre>\n\n<p>How can I make this code work??</p>\n"}, {"tags": ["haskell", "ghcjs"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1456810458, "post_id": 35715256, "comment_id": 59107028, "body": "Interesting question. Note, however, that you may well be better off using Frege if you want a Haskell-like language targeting the JVM."}, {"owner": {"reputation": 12143, "user_id": 367649, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HNrje.jpg?s=128&g=1", "display_name": "Marimuthu Madasamy", "link": "https://stackoverflow.com/users/367649/marimuthu-madasamy"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456810851, "post_id": 35715256, "comment_id": 59107194, "body": "@dfeuer yes, Frege is my language of choice on the JVM currently. I also think this is an interesting option as so I am just exploring how far it goes :) Here is another example I tried that converts between Haskell and Java list: <a href=\"https://gist.github.com/mmhelloworld/240ec2c13310eef14a51\" rel=\"nofollow noreferrer\">gist.github.com/mmhelloworld/240ec2c13310eef14a51</a>"}, {"owner": {"reputation": 6033, "user_id": 2684760, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f646c557146dbe635a3ece4f0c5830cd?s=128&d=identicon&r=PG", "display_name": "ForNeVeR", "link": "https://stackoverflow.com/users/2684760/fornever"}, "edited": false, "score": 0, "creation_date": 1456900729, "post_id": 35715256, "comment_id": 59153968, "body": "Maybe you&#39;ll want to check <a href=\"https://github.com/apigee/trireme\" rel=\"nofollow noreferrer\">Trireme</a>. It provides a nodejs-compatible environment on top of the JVM."}, {"owner": {"reputation": 12143, "user_id": 367649, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HNrje.jpg?s=128&g=1", "display_name": "Marimuthu Madasamy", "link": "https://stackoverflow.com/users/367649/marimuthu-madasamy"}, "reply_to_user": {"reputation": 6033, "user_id": 2684760, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f646c557146dbe635a3ece4f0c5830cd?s=128&d=identicon&r=PG", "display_name": "ForNeVeR", "link": "https://stackoverflow.com/users/2684760/fornever"}, "edited": false, "score": 1, "creation_date": 1456932060, "post_id": 35715256, "comment_id": 59175729, "body": "@ForNeVeR Thanks! That looks interesting but it is unfortunately still using Rhino, the old JS engine for the JVM: <a href=\"https://github.com/apigee/trireme#rhino\" rel=\"nofollow noreferrer\">github.com/apigee/trireme#rhino</a>"}, {"owner": {"reputation": 6033, "user_id": 2684760, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f646c557146dbe635a3ece4f0c5830cd?s=128&d=identicon&r=PG", "display_name": "ForNeVeR", "link": "https://stackoverflow.com/users/2684760/fornever"}, "edited": false, "score": 0, "creation_date": 1456977887, "post_id": 35715256, "comment_id": 59198791, "body": "@MarimuthuMadasamy, I had a feeling that you want the code to be running in principle, and not necessarily with good performance. I would <i>love</i> to see Trireme implementation with Nashorn, but unfortunately this is not something actively worked on. Check this: <a href=\"https://github.com/apigee/rowboat\" rel=\"nofollow noreferrer\">github.com/apigee/rowboat</a>"}, {"owner": {"reputation": 12143, "user_id": 367649, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HNrje.jpg?s=128&g=1", "display_name": "Marimuthu Madasamy", "link": "https://stackoverflow.com/users/367649/marimuthu-madasamy"}, "reply_to_user": {"reputation": 6033, "user_id": 2684760, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f646c557146dbe635a3ece4f0c5830cd?s=128&d=identicon&r=PG", "display_name": "ForNeVeR", "link": "https://stackoverflow.com/users/2684760/fornever"}, "edited": false, "score": 0, "creation_date": 1456980381, "post_id": 35715256, "comment_id": 59199540, "body": "@ForNeVeR I actually did try out <code>trireme</code> but got this error from ghcjs: <code>setErrno not yet implemented: Error: EBADF</code>. I also tried out <code>rowboat</code> now. I tried to build it from sources but the tests are failing. At the moment, plain Nashorn is the best option as with Nashorn, the program actually works."}, {"owner": {"reputation": 6033, "user_id": 2684760, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f646c557146dbe635a3ece4f0c5830cd?s=128&d=identicon&r=PG", "display_name": "ForNeVeR", "link": "https://stackoverflow.com/users/2684760/fornever"}, "edited": false, "score": 0, "creation_date": 1456987912, "post_id": 35715256, "comment_id": 59202376, "body": "@MarimuthuMadasamy, I had no intention to switch you to some another solution or tell you that you&#39;re doing something wrong, I was just trying to show you another options. I actually like your idea of running ghcjs code on JVM, it&#39;s very fun. I hope you&#39;ll find a reliable Nashorn-powered solution."}, {"owner": {"reputation": 12143, "user_id": 367649, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HNrje.jpg?s=128&g=1", "display_name": "Marimuthu Madasamy", "link": "https://stackoverflow.com/users/367649/marimuthu-madasamy"}, "reply_to_user": {"reputation": 6033, "user_id": 2684760, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f646c557146dbe635a3ece4f0c5830cd?s=128&d=identicon&r=PG", "display_name": "ForNeVeR", "link": "https://stackoverflow.com/users/2684760/fornever"}, "edited": false, "score": 0, "creation_date": 1457156546, "post_id": 35715256, "comment_id": 59289896, "body": "@ForNeVeR Nashorn works in the end with few shims for the JVM as shown in my answer below!"}], "answers": [{"comments": [{"owner": {"reputation": 12143, "user_id": 367649, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HNrje.jpg?s=128&g=1", "display_name": "Marimuthu Madasamy", "link": "https://stackoverflow.com/users/367649/marimuthu-madasamy"}, "edited": false, "score": 1, "creation_date": 1457078458, "post_id": 35790720, "comment_id": 59251836, "body": "Yes, I asked it there. I will post an answer here later with my findings once I have a fully working example after adding the necessary support for JVM in ghcjs."}], "tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1457077831, "creation_date": 1457077831, "answer_id": 35790720, "question_id": 35715256, "link": "https://stackoverflow.com/questions/35715256/running-the-haskell-compiled-to-javascript-on-the-jvm/35790720#35790720", "title": "Running the Haskell compiled to JavaScript on the JVM", "body": "<p>Just for the record, this was also asked on <a href=\"https://github.com/ghcjs/ghcjs/issues/472\" rel=\"nofollow\">github</a></p>\n\n<p>The answer there pointed to <a href=\"https://github.com/ghcjs/shims/blob/master/src/platform.js\" rel=\"nofollow\">existing</a> platform detection code, as well as process exit <a href=\"https://github.com/ghcjs/shims/blob/4df1808d03117ddcd45f276f0ddd85c73e59506a/src/thread.js#L1097-L1119\" rel=\"nofollow\">functionality</a>. These and related areas would provide the points where ghcjs could be extended to support the jvm as a particular platform.</p>\n"}, {"tags": [], "owner": {"reputation": 12143, "user_id": 367649, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HNrje.jpg?s=128&g=1", "display_name": "Marimuthu Madasamy", "link": "https://stackoverflow.com/users/367649/marimuthu-madasamy"}, "is_accepted": false, "score": 2, "last_activity_date": 1457157576, "last_edit_date": 1457157576, "creation_date": 1457155702, "answer_id": 35810452, "question_id": 35715256, "link": "https://stackoverflow.com/questions/35715256/running-the-haskell-compiled-to-javascript-on-the-jvm/35810452#35810452", "title": "Running the Haskell compiled to JavaScript on the JVM", "body": "<p>With the help from <a href=\"https://github.com/luite\" rel=\"nofollow\">luite</a>, I have finally got it working with a little bit of <a href=\"https://github.com/ghcjs/shims/pull/31\" rel=\"nofollow\">shims for the JVM</a>:</p>\n\n<ol>\n<li><h2>Platform detection (shims/src/platform.js)</h2>\n\n<p>Java's Nashorn provides the global <code>Java</code> variable which can be used to detect if we are running under JVM. If this variable is defined, a global variable <code>h$isJvm</code> is set similar to <code>h$isNode</code> for the ghcjs runtime. This variable will then be used to provide JVM specific code in other places. We can also define <code>console.log</code> here so that writing to console works out of the box on the JVM without having to define it in the user program:</p>\n\n<pre><code>if(typeof Java !== 'undefined') {\n    h$isJvm = true;\n    this.console = {\n      log: function(s) {\n        java.lang.System.out.print(s);\n      }\n    };\n}\n</code></pre></li>\n<li><h2>Exiting JVM normally (shims/src/thread.js)</h2>\n\n<p>GHCJS has a method called <code>h$exitProcess</code> which is used to exit the process. With the variable we defined in the previous step, <code>h$isJvm</code>, we can add the following code for the JVM to exit:</p>\n\n<pre><code>if (h$isJvm) {\n   java.lang.System.exit(code);\n}\n</code></pre></li>\n<li><h2>Command line arguments (shims/src/environment.js)</h2>\n\n<p>Nashorn provides a global <code>arguments</code> variable that contains the command line parameter values passed to <code>jjs</code>. We can add a shim using this variable:</p>\n\n<pre><code>if(h$isJvm) {\n    h$programArgs = h$getGlobal(this).arguments;\n}\n</code></pre></li>\n</ol>\n\n<p>With these shims, we can run most Haskell out of the box on the JVM. Here is the original program in the question with the above shims added in GHCJS:</p>\n\n<pre><code>module Main where\n\nmain = putStrLn \"Hello from Haskell!\"\n</code></pre>\n\n<p>This regular Haskell code now runs out of the box in the JVM. Even the little non-trivial ones run directly on the JVM. For example, the following code taken from <a href=\"http://www.haskellforall.com/2016/02/auto-generate-command-line-interface.html\" rel=\"nofollow\">here</a>:</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric     #-}\n{-# LANGUAGE OverloadedStrings #-}\n\nimport Options.Generic\n\ndata Example = Example { foo :: Int, bar :: Double }\n    deriving (Generic, Show)\n\ninstance ParseRecord Example\n\nmain = do\n    x &lt;- getRecord \"Test program\"\n    print (x :: Example)\n</code></pre>\n\n<p>We can build it with <code>stack</code> and run with <code>jjs</code> passing command line arguments:</p>\n\n<pre><code>haskell-jvm-hello$ stack build\n\nhaskell-jvm-hello$ jjs ./.stack-work/dist/x86_64-linux/Cabal-1.22.4.0_ghcjs/build/haskell-jvm-hello-exe/haskell-jvm-hello-exe.jsexe/all.js -- --help\nTest program\n\nUsage: a.js --foo INT --bar DOUBLE\n\nAvailable options:\n  -h,--help                Show this help text\n\nhaskell-jvm-hello$ jjs ./.stack-work/dist/x86_64-linux/Cabal-1.22.4.0_ghcjs/build/haskell-jvm-hello-exe/haskell-jvm-hello-exe.jsexe/all.js -- --foo 1 --bar 2.5\nExample {foo = 1, bar = 2.5}\n</code></pre>\n"}], "owner": {"reputation": 12143, "user_id": 367649, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HNrje.jpg?s=128&g=1", "display_name": "Marimuthu Madasamy", "link": "https://stackoverflow.com/users/367649/marimuthu-madasamy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 403, "favorite_count": 2, "answer_count": 2, "score": 11, "last_activity_date": 1457157576, "creation_date": 1456809800, "question_id": 35715256, "link": "https://stackoverflow.com/questions/35715256/running-the-haskell-compiled-to-javascript-on-the-jvm", "title": "Running the Haskell compiled to JavaScript on the JVM", "body": "<p>Java 8 has an inbuilt JavaScript engine called Nashorn so it is actually possible to run Haskell compiled to JavaScript on the JVM.</p>\n\n<p>The following program works:</p>\n\n<pre><code>{-# LANGUAGE JavaScriptFFI #-}\n\nmodule Main where\n\nforeign import javascript unsafe \"console={log: function(s) { java.lang.System.out.print(s); }}\"\n  setupConsole :: IO ()\n\nforeign import javascript unsafe \"java.lang.System.exit($1)\"\n  sysexit :: Int -&gt; IO ()\n\nmain = do\n  setupConsole\n  putStrLn \"Hello from Haskell!\"\n  sysexit 0\n</code></pre>\n\n<p>We can run it with: (<em>Side note:</em> It is possible to run this as a normal Java program.<code>jjs</code> is just a convenient way to run pure JavaScript code on the JVM)</p>\n\n<pre><code>$ ghcjs -o Main Main.hs\n[1 of 1] Compiling Main             ( Main.hs, Main.js_o )\nLinking Main.jsexe (Main)\n\n$ which jjs\n~/bin/jdk/bin/jjs\n\n$ jjs Main.jsexe/all.js\nHello from Haskell!\n</code></pre>\n\n<p>In the above code, <code>console.log</code> needs to be defined using <code>java.lang.System.print</code> as Nashorn doesn't provide the default global <code>console</code> object and Haskell's <code>putStrLn</code> otherwise doesn't seem to be printing anything.</p>\n\n<p>The other thing is that the JVM needs to be exited with <code>sysexit</code> FFI function implemented with <code>java.lang.System.exit</code>. </p>\n\n<p>I have 2 questions:</p>\n\n<ol>\n<li>Similar to <code>console.log</code>, what other host dependencies are assumed in ghcjs that have to be defined?</li>\n<li>Is the JVM not shutting down normally because of ghcjs creating an event loop in the background or some other reason? Is there any way to avoid that and make the program exit normally?</li>\n</ol>\n"}, {"tags": ["haskell", "generic-programming"], "comments": [{"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 3, "creation_date": 1456782266, "post_id": 35709737, "comment_id": 59097331, "body": "You can&#39;t do this with generics, but the template haskell for this should be straightforward."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1456783187, "post_id": 35709737, "comment_id": 59097862, "body": "@sclv, why can&#39;t I do it with generics?"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 2, "creation_date": 1456786712, "post_id": 35709737, "comment_id": 59099613, "body": "Because you want to generate functions whose <i>type</i> is determined by the shape of the data structure. Generics let you provide functions which essentially have &quot;one hole in the type&quot; which is the type of the data structure with an instance of Generic that they are operating on."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1456787384, "post_id": 35709737, "comment_id": 59099913, "body": "@sclv, right. But why is that beyond the ability of associated types and closed type families? I&#39;m not saying you&#39;re wrong; I just can&#39;t follow your argument."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1456787565, "post_id": 35709737, "comment_id": 59099981, "body": "I think this is doable. We can compute types from generic Rep-s as we like."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 5, "creation_date": 1456789308, "post_id": 35709737, "comment_id": 59100635, "body": "This is a typical example of needing to find functoriality which hasn&#39;t been helpfully pointed out in a datatype declaration, i.e. the way in which a <code>Foo a</code> structure can be seen as functorial in its substructures. Recursion schemes can often be given once and for all in terms of the functors whose fixpoints are the datatypes we&#39;re trying to work with. It may be worth considering that an easy way to get your hands on this functoriality is not to let go of it in the first place."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1456799416, "post_id": 35709737, "comment_id": 59103775, "body": "@pigworker, how do you think this should be done from the standpoint of language design? Should algebraic datatypes be less general? Should the compiler provide some kind of special insight into the structure?"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 3, "creation_date": 1456834545, "post_id": 35709737, "comment_id": 59119841, "body": "@dfeuer I&#39;d like to see datatypes being characterised by first class data descriptions, effectively making typereps the organizing principle, rather than a subsequent rationalization. One can compute lots of useful generic operations on data if you have their descriptions to hand in inspectable form."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1456806666, "post_id": 35711960, "comment_id": 59105770, "body": "I have the sinking feeling the pain will come with recursive vs. non-recursive instances of <code>Rec1</code> (<code>data X a = X a (X a)</code> vs. <code>data Y a = X (Maybe a)</code>), which I predict will lead to horrors of overlapping instances and such. <i>shiver</i>. I&#39;m still going to study your code for a while, because it looks like it has a lot of neat ideas for me to think about."}], "tags": [], "owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "is_accepted": false, "score": 7, "last_activity_date": 1456848587, "last_edit_date": 1456848587, "creation_date": 1456789134, "answer_id": 35711960, "question_id": 35709737, "link": "https://stackoverflow.com/questions/35709737/is-it-possible-to-derive-recursion-principles-generically/35711960#35711960", "title": "Is it possible to derive recursion principles generically?", "body": "<p>Here's a start of doing this using <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/GHC-Generics.html\" rel=\"nofollow\">GHC Generics</a>.  Adding some code to reassociate the <code>(:+:)</code> would make this nicer.  A few more instances are required and this probably has ergonomic problems.</p>\n\n<p><strong>EDIT</strong>: Bah, I got lazy and fell back to a data family to get injectivity for my type equality dispatch.  This mildly changes the interface.  I suspect with enough <a href=\"http://okmij.org/ftp/Haskell/typeEQ.html\" rel=\"nofollow\">trickery</a>, and/or using injective type families this can be done without a data family or overlapping instances.</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE EmptyDataDecls #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE UndecidableInstances #-}\nmodule Main where\nimport Data.Function (fix)\nimport GHC.Generics\n\ndata Foo a = No | Yes | Perhaps (Foo a) | Extra a Int Bool\n    deriving (Show, Generic1)\n\ndata Bar a = Bar (Maybe a)\n    deriving (Show, Generic1)\n\ngcata :: (GCata (f a) (Rep1 f a), Generic1 f) =&gt; Alg (f a) (Rep1 f a) r -&gt; f a -&gt; r\ngcata f = fix(\\w -&gt; gcata' w f . from1)\n\nex' :: Show a =&gt; Foo a -&gt; String\nex' = gcata ((\"No\",\"Yes\"),(\\(Rec s) -&gt; \"Perhaps (\"++s++\")\", \\a i b -&gt; \"Extra (\"++show a++\") (\"++show i++\") (\"++show b++\")\"))\n\nex1 = ex' (Perhaps (Perhaps Yes) :: Foo Int)\nex2 = ex' (Perhaps (Perhaps (Extra 'a' 2 True)) :: Foo Char)\n\nex3 :: Foo a -&gt; Foo a\nex3 = gcata ((No, Yes), (Perhaps . unRec, Extra))\n\nex4 = gcata (\\(K m) -&gt; show m) (Bar (Just 3))\n\nclass GCata rec f where\n    type Alg (rec :: *) (f :: *) (r :: *) :: *\n    gcata' :: (rec -&gt; r) -&gt; Alg rec f r -&gt; f -&gt; r\n\ninstance (GCata rec (f p)) =&gt; GCata rec (M1 i c f p) where\n    type Alg rec (M1 i c f p) r = Alg rec (f p) r\n    gcata' w f (M1 x) = gcata' w f x\n\ninstance (GCata rec (f p), GCata rec (g p)) =&gt; GCata rec ((f :+: g) p) where\n    type Alg rec ((f :+: g) p) r = (Alg rec (f p) r, Alg rec (g p) r)\n    gcata' w (l,_) (L1 x) = gcata' w l x\n    gcata' w (_,r) (R1 x) = gcata' w r x\n\ninstance GCata rec (U1 p) where\n    type Alg rec (U1 p) r = r\n    gcata' _ f U1 = f\n\ninstance (Project rec (f p), GCata rec (g p)) =&gt; GCata rec ((f :*: g) p) where\n    type Alg rec ((f :*: g) p) r = Prj rec (f p) r -&gt; Alg rec (g p) r\n    gcata' w f (x :*: y) = gcata' w (f (prj w x)) y\n\nclass Project rec f where\n    type Prj (rec :: *) (f :: *) (r :: *) :: *\n    prj :: (rec -&gt; r) -&gt; f -&gt; Prj rec f r\n\ninstance (Project rec (f p)) =&gt; Project rec (M1 i c f p) where\n    type Prj rec (M1 i c f p) r = Prj rec (f p) r\n    prj w (M1 x) = prj w x\n\ninstance Project rec (K1 i c p) where\n    type Prj rec (K1 i c p) r = c\n    prj _ (K1 x) = x\n\ninstance (RecIfEq (TEq rec (f p)) rec (f p)) =&gt; Project rec (Rec1 f p) where\n    type Prj rec (Rec1 f p) r = Tgt (TEq rec (f p)) rec (f p) r\n    prj w (Rec1 x) = recIfEq w x\n\ninstance Project rec (Par1 p) where\n    type Prj rec (Par1 p) r = p\n    prj _ (Par1 x) = x\n\ninstance GCata rec (K1 i c p) where\n    type Alg rec (K1 i c p) r = c -&gt; r\n    gcata' _ f (K1 x) = f x\n\ninstance GCata rec (Par1 p) where\n    type Alg rec (Par1 p) r = p -&gt; r\n    gcata' _ f (Par1 x) = f x\n\ninstance (Project rec (Rec1 f p)) =&gt; GCata rec (Rec1 f p) where\n    type Alg rec (Rec1 f p) r = Prj rec (Rec1 f p) r -&gt; r\n    gcata' w f = f . prj w \n\ndata HTrue; data HFalse\n\ntype family TEq x y where\n    TEq x x = HTrue\n    TEq x y = HFalse\n\nclass RecIfEq b rec t where\n    data Tgt b rec t r :: *\n    recIfEq :: (rec -&gt; r) -&gt; t -&gt; Tgt b rec t r\n\ninstance RecIfEq HTrue rec rec where\n    newtype Tgt HTrue rec rec r = Rec { unRec :: r }\n    recIfEq w = Rec . w\n\ninstance RecIfEq HFalse rec t where\n    newtype Tgt HFalse rec t r = K { unK :: t }\n    recIfEq _ = K\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457121667, "post_id": 35804233, "comment_id": 59279458, "body": "I haven&#39;t worked through most of this yet, but I noticed only one hole for recursion. What about mutually recursive types?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1457122103, "post_id": 35804233, "comment_id": 59279689, "body": "Mutual recursion is possible, we need <a href=\"https://www.reddit.com/r/haskell/comments/3sm1j1/how_to_mix_the_base_functorrecursion_scheme_stuff/cwyr61h\" rel=\"nofollow noreferrer\">indexed functors</a> for that. Maybe I&#39;ll do the indexed version too."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1458445606, "post_id": 35804233, "comment_id": 59861876, "body": "That&#39;s a really beautiful effort!"}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 5, "last_activity_date": 1461588199, "last_edit_date": 1461588199, "creation_date": 1457118759, "answer_id": 35804233, "question_id": 35709737, "link": "https://stackoverflow.com/questions/35709737/is-it-possible-to-derive-recursion-principles-generically/35804233#35804233", "title": "Is it possible to derive recursion principles generically?", "body": "<p>As pigworker remarked in the question comments, using the default <code>Generic</code> representation leads to great ugliness, since we don't have prior information about recursion in our type, and we have to dig out recursive occurrences by manually checking for type equality. I'd like to present here alternative solutions with explicit f-algebra-style recursion. For this, we need an alternative generic <code>Rep</code>. Sadly, this means we can't easily tap into <code>GHC.Generics</code>, but I hope this will be edifying nonetheless. </p>\n\n<p>In my first solution I aim for a presentation that is as simple as possible within current GHC capabilities. The second solution is a <code>TypeApplication</code>-heavy GHC 8-based one with more sophisticated types.</p>\n\n<p>Starting out as usual:</p>\n\n<pre><code>{-# language\n  TypeOperators, DataKinds, PolyKinds,\n  RankNTypes, EmptyCase, ScopedTypeVariables,\n  DeriveFunctor, StandaloneDeriving, GADTs,\n  TypeFamilies, FlexibleContexts, FlexibleInstances #-}\n</code></pre>\n\n<p>My generic representation is a fixpoint of a sum-of-products. It slightly extends the basic model of <a href=\"https://hackage.haskell.org/package/generics-sop-0.2.1.0\" rel=\"nofollow\"><code>generics-sop</code></a>, which is also a sum-of-products but not functorial and therefore ill-equipped for recursive algorithms. I think SOP is  overall a much better practical representation than arbitrarily nested types; you can find extended arguments as to why this is the case in the <a href=\"https://www.andres-loeh.de/TrueSumsOfProducts/\" rel=\"nofollow\">paper</a>. In short, SOP removes unnecessary nesting information and lets us separate metadata from basic data. </p>\n\n<p>But before anything else, we should decide on a code for generic types. In vanilla <code>GHC.Generics</code> there isn't a well-defined kind of codes, as the type constructors of sums, products etc. form an ad-hoc type-level grammar, and we can dispatch on them using type classes. We adhere more closely to usual presentations in dependently typed generics, and use explicit codes, interpretations and functions. Our codes shall be of kind:</p>\n\n<pre><code>[[Maybe *]]\n</code></pre>\n\n<p>The outer list encodes a sum of constructors, with each inner <code>[Maybe *]</code> encoding a constructor. A <code>Just *</code> is just a constructor field, while <code>Nothing</code> denotes a recursive field. For example, the code of <code>[Int]</code> is <code>['[], [Just Int, Nothing]]</code>. </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type Rep a = Fix (SOP (Code a)) \n\nclass Generic a where\n  type Code a :: [[Maybe *]]\n  to   :: a -&gt; Rep a\n  from :: Rep a -&gt; a\n\ndata NP (ts :: [Maybe *]) (k :: *) where\n  Nil  :: NP '[] k\n  (:&gt;) :: t -&gt; NP ts k -&gt; NP (Just t ': ts) k\n  Rec  :: k -&gt; NP ts k -&gt; NP (Nothing ': ts) k\ninfixr 5 :&gt;  \n\ndata SOP (code :: [[Maybe *]]) (k :: *) where\n  Z :: NP ts k -&gt; SOP (ts ': code) k\n  S :: SOP code k -&gt; SOP (ts ': code) k\n</code></pre>\n\n<p>Note that <code>NP</code> has different constructors for recursive and non-recursive fields. This is quite important, because we want codes to be unambiguously reflected in the type indices. In other words, we would like <code>NP</code> to also act as a singleton for <code>[Maybe *]</code> (although we remain parametric in <code>*</code> for good reasons). </p>\n\n<p>We use a <code>k</code> parameter in the definitions to leave a hole for recursion. We set up recursion as usual, leaving the <code>Functor</code> instances to GHC:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>deriving instance Functor (SOP code)\nderiving instance Functor (NP code)\n\nnewtype Fix f = In {out :: f (Fix f)}\n\ncata :: Functor f =&gt; (f a -&gt; a) -&gt; Fix f -&gt; a\ncata phi = go where go = phi . fmap go . out\n</code></pre>\n\n<p>We have two type families:</p>\n\n<pre><code>type family CurryNP (ts :: [Maybe *]) (r :: *) :: * where\n  CurryNP '[]             r = r\n  CurryNP (Just t  ': ts) r = t -&gt; CurryNP ts r\n  CurryNP (Nothing ': ts) r = r -&gt; CurryNP ts r\n\ntype family Alg (code :: [[Maybe *]]) (r :: *) :: * where\n  Alg '[]         r = ()\n  Alg (ts ': tss) r = (CurryNP ts r, Alg tss r)\n</code></pre>\n\n<p><code>CurryNP ts r</code> curries <code>NP ts</code> with result type <code>r</code>, and it also plugs in <code>r</code> in the recursive occurrences. </p>\n\n<p><code>Alg code r</code> computes the type of an algebra on <code>SOP code r</code>. It tuples together the eliminators for the individual constructors. Here we use plain nested tuples, but of course <code>HList</code>-s would be adequate too. We could also reuse <code>NP</code> here as a <code>HList</code>, but I find that too kludgy. </p>\n\n<p>All that's left is to implement the functions:</p>\n\n<pre><code>uncurryNP :: CurryNP ts a -&gt; NP ts a -&gt; a\nuncurryNP f Nil        = f\nuncurryNP f (x :&gt; xs)  = uncurryNP (f x) xs\nuncurryNP f (Rec k xs) = uncurryNP (f k) xs\n\nalgSOP :: Alg code a -&gt; SOP code a -&gt; a\nalgSOP fs (Z np)  = uncurryNP (fst fs) np\nalgSOP fs (S sop) = algSOP (snd fs) sop\n\ngcata :: Generic a =&gt; Alg (Code a) r -&gt; a -&gt; r\ngcata f = cata (algSOP f) . to\n</code></pre>\n\n<p>The key point here is that we have to convert the curried eliminators in <code>Alg</code> into a \"proper\" <code>SOP code a -&gt; a</code> algebra, since that is the form that can be directly used in <code>cata</code>. </p>\n\n<p>Let's define some sugar and instances:</p>\n\n<pre><code>(&lt;:) :: a -&gt; b -&gt; (a, b)\n(&lt;:) = (,)\ninfixr 5 &lt;:\n\ninstance Generic (Fix (SOP code)) where\n  type Code (Fix (SOP code)) = code\n  to   = id\n  from = id  \n\ninstance Generic [a] where\n  type Code [a] = ['[], [Just a, Nothing]]  \n  to   = foldr (\\x xs -&gt; In (S (Z (x :&gt; Rec xs Nil)))) (In (Z Nil))\n  from = gcata ([] &lt;: (:) &lt;: ()) -- note the use of \"Generic (Rep [a])\"\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>&gt; gcata (0 &lt;: (+) &lt;: ()) [0..10]\n55\n</code></pre>\n\n<p><a href=\"https://github.com/AndrasKovacs/misc-stuff/blob/master/haskell/GenericFold/Simple.hs\" rel=\"nofollow\">Full code.</a> </p>\n\n<hr>\n\n<p>However, it would be nicer if we had currying and didn't have to use <code>HList</code>-s or tuples to store eliminators. The most convenient way is to have the same order of arguments as in standard library folds, such as <code>foldr</code> or <code>maybe</code>. In this case the return type of <code>gcata</code> is given by a type family that computes from the generic code of a type.</p>\n\n<pre><code>type family CurryNP (ts :: [Maybe *]) (r :: *) :: * where\n  CurryNP '[]             r = r\n  CurryNP (Just t  ': ts) r = t -&gt; CurryNP ts r\n  CurryNP (Nothing ': ts) r = r -&gt; CurryNP ts r\n\ntype family Fold' code a r where\n  Fold' '[]         a r = r\n  Fold' (ts ': tss) a r = CurryNP ts a -&gt; Fold' tss a r\n\ntype Fold a r = Fold' (Code a) r (a -&gt; r)\n\ngcata :: forall a r. Generic a =&gt; Fold a r\n</code></pre>\n\n<p>This <code>gcata</code> is highly (fully) ambiguous. We need either explicit application or <code>Proxy</code>, and I opted for the former, incurring a GHC 8 dependence. However, once we supply an <code>a</code> type, the result type reduces, and we can easily curry:</p>\n\n<pre><code>&gt; :t gcata @[_] \ngcata @[_] :: Generic [t] =&gt; r -&gt; (t -&gt; r -&gt; r) -&gt; [t] -&gt; r\n&gt; :t gcata @[_] 0\ngcata @[_] 0 :: Num t1 =&gt; (t -&gt; t1 -&gt; t1) -&gt; [t] -&gt; t1\n&gt; gcata @[_] 0 (+) [0..10]\n55\n</code></pre>\n\n<p>I used above a partial type signature in <code>[_]</code>. We can also create a shorthand for this:</p>\n\n<pre><code>gcata1 :: forall f a r. Generic (f a) =&gt; Fold (f a) r\ngcata1 = gcata @(f a) @r\n</code></pre>\n\n<p>Which can be used as <code>gcata1 @[]</code>. </p>\n\n<p>I'd rather not elaborate the <a href=\"https://github.com/AndrasKovacs/misc-stuff/blob/master/haskell/GenericFold/TypeApp.hs\" rel=\"nofollow\">implementation of the above <code>gcata</code></a> here. It's not much longer than the simple version, but the <code>gcata</code> implementation is pretty hairy (embarrassingly, it's responsible for my delayed answer). Right now I couldn't explain it very well, since I wrote it with Agda aid, which entails plenty of automatic search and type tetris. </p>\n"}, {"tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": false, "score": 1, "last_activity_date": 1459421165, "creation_date": 1459421165, "answer_id": 36331160, "question_id": 35709737, "link": "https://stackoverflow.com/questions/35709737/is-it-possible-to-derive-recursion-principles-generically/36331160#36331160", "title": "Is it possible to derive recursion principles generically?", "body": "<p>As has been said in the comments and other answers, it's best to start from a generic representation that has access to the recursive positions.</p>\n\n<p>One library that works with such a representation is <code>multirec</code> (another is <code>compdata</code>):</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n{-# LANGUAGE GADTs, TypeFamilies, MultiParamTypeClasses, RankNTypes #-}\nmodule FooFold where\n\nimport Generics.MultiRec.FoldAlgK\nimport Generics.MultiRec.TH\n\ndata Foo a = No | Yes a | Perhaps (Foo a)\n\ndata FooF :: * -&gt; * -&gt; * where\n  Foo :: FooF a (Foo a)\n\nderiveAll ''FooF\n\nfoldFoo :: (r, (a -&gt; r, r -&gt; r)) -&gt; Foo a -&gt; r\nfoldFoo phi = fold (const phi) Foo\n</code></pre>\n\n<p>The <code>FoldAlgK</code> module provides a fold with a single result type and computes the algebra type as a nested pair. It would be relatively easy to additionally curry that. There are some other variants offered by the library.</p>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 3, "answer_count": 3, "score": 10, "last_activity_date": 1461588199, "creation_date": 1456780331, "question_id": 35709737, "link": "https://stackoverflow.com/questions/35709737/is-it-possible-to-derive-recursion-principles-generically", "title": "Is it possible to derive recursion principles generically?", "body": "<p>In Idris, there's some magical machinery to automatically create (dependent) eliminators for user-defined types. I'm wondering if it's possible to do something (perhaps less dependent) with Haskell types. For instance, given</p>\n\n<pre><code>data Foo a = No | Yes a | Perhaps (Foo a)\n</code></pre>\n\n<p>I want to generate</p>\n\n<pre><code>foo :: b -&gt; (a -&gt; b) -&gt; (b -&gt; b) -&gt; Foo a -&gt; b\nfoo b _ _ No = b\nfoo _ f _ (Yes a) = f a\nfoo b f g (Perhaps c) = g (foo b f g x)\n</code></pre>\n\n<p>I'm pretty weak on polyvariadic functions and generics, so I could use a bit of help getting started.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 3, "creation_date": 1456771609, "post_id": 35707148, "comment_id": 59090942, "body": "This. If a <code>LANGUAGE</code> pragma is present, it must always be the <i>first</i> line of code in the file. (There are probably others, but I can&#39;t think of any off-hand.)"}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 1, "creation_date": 1456776920, "post_id": 35707148, "comment_id": 59094206, "body": "@MathematicalOrchid: It can follow comments and whitespace-only lines, too; it just has to be the first <i>meaningful</i> line.  (So it&#39;s not quite as restrictive as a shebang)."}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 1, "creation_date": 1456777585, "post_id": 35707148, "comment_id": 59094589, "body": "Actually, <code>LANGUAGE</code> pragmas and <code>OPTIONS_GHC</code> pragmas must occur in a block as the first non-comment non-whitespace thing in the file.  You can of course have more than one such line, and they can&#39;t all be first :-)"}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": true, "score": 10, "last_activity_date": 1456771612, "last_edit_date": 1456771612, "creation_date": 1456771526, "answer_id": 35707148, "question_id": 35707093, "link": "https://stackoverflow.com/questions/35707093/why-is-this-indentation-wrong/35707148#35707148", "title": "Why is this indentation wrong?", "body": "<p>The line</p>\n\n<pre><code>{-# LANGUAGE QuasiQuotes #-}\n</code></pre>\n\n<p>is supposed to come on the first line in the program, before</p>\n\n<pre><code>module Main where\n</code></pre>\n\n<p>These language extensions are supposed to be meta information, external to the program itself (they can also be included as command line options to ghc).</p>\n"}], "owner": {"reputation": 2963, "user_id": 1528246, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/f76f3e46a94eb011d85d14bf54425950?s=128&d=identicon&r=PG", "display_name": "rogergl", "link": "https://stackoverflow.com/users/1528246/rogergl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 35707148, "answer_count": 1, "score": 3, "last_activity_date": 1456771612, "creation_date": 1456771302, "question_id": 35707093, "link": "https://stackoverflow.com/questions/35707093/why-is-this-indentation-wrong", "title": "Why is this indentation wrong?", "body": "<p>This code gives the following compile error:</p>\n\n<pre><code>Error:(17, 1) ghc: parse error (possibly incorrect indentation or mismatched brackets)\n</code></pre>\n\n<p>but if I remove </p>\n\n<pre><code>module Main where\n</code></pre>\n\n<p>it works. Since I'm just starting to use Haskell I would like to know why ? </p>\n\n<pre><code>module Main where\n\n{-# LANGUAGE QuasiQuotes #-}\n\nimport Text.Hamlet (shamlet)\nimport Text.Blaze.Html.Renderer.String (renderHtml)\nimport Data.Char (toLower)\nimport Data.List (sort)\n\ndata Person = Person\n    { name :: String\n    , age  :: Int\n    }\n\nmain :: IO ()\nmain = putStrLn $ renderHtml [shamlet|\n&lt;p&gt;Hello, my name is #{name person} and I am #{show $ age person}.\n&lt;p&gt;\n    Let's do some funny stuff with my name: #\n    &lt;b&gt;#{sort $ map toLower (name person)}\n&lt;p&gt;Oh, and in 5 years I'll be #{show ((+) 5 (age person))} years old.\n|]\n  where\n    person = Person \"Michael\" 26\n</code></pre>\n"}, {"tags": ["haskell", "instance"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1456770321, "post_id": 35706732, "comment_id": 59090155, "body": "Why should this problem require typeclasses/instances? What about <code>if answer==&quot;yes&quot; then ... else ...</code> ?"}, {"owner": {"reputation": 33, "user_id": 5772142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f95222cc03a2d8e225acfb93be2fa6?s=128&d=identicon&r=PG&f=1", "display_name": "user35053", "link": "https://stackoverflow.com/users/5772142/user35053"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1456774053, "post_id": 35706732, "comment_id": 59092455, "body": "I need to write this at least 20 times so was wondering if I could it with instances instead and make my code shorter."}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 2, "creation_date": 1456774303, "post_id": 35706732, "comment_id": 59092593, "body": "@user35053 just wrap it in a function you can call 20 times?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456813987, "post_id": 35706732, "comment_id": 59108441, "body": "If one of the answers satisfies you, you should click the check mark to accept it. Otherwise, you should comment on them and/or edit your question to explain what&#39;s missing."}], "answers": [{"tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": true, "score": 1, "last_activity_date": 1456772047, "creation_date": 1456772047, "answer_id": 35707314, "question_id": 35706732, "link": "https://stackoverflow.com/questions/35706732/use-instance-for-input-checking/35707314#35707314", "title": "Use instance for input checking?", "body": "<p>I think this is what you want</p>\n\n<pre><code>main = do\n    putStrLn \"type yes or no\"\n    response &lt;- getLine\n    if response == \"yes\"\n        then putStrLn \"You typed yes\"\n        else putStrLn \"You didn't type yes\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "is_accepted": false, "score": 0, "last_activity_date": 1456795974, "creation_date": 1456795974, "answer_id": 35713112, "question_id": 35706732, "link": "https://stackoverflow.com/questions/35706732/use-instance-for-input-checking/35713112#35713112", "title": "Use instance for input checking?", "body": "<p>It sounds like you want something like this instead:</p>\n\n<pre><code>import Data.Char\n\ngetStatus :: String -&gt; IO Bool\ngetStatus question = do\n    putStrLn (question ++ \" YES or NO?\")\n    response &lt;- getLine\n    return (toLower response == \"y\")\n\nmain = do\n   res1 &lt;- getStatus \"question1?\"\n   res2 &lt;- getStatus \"question2?\"\n   .\n   .\n   .\n   res20 &lt;- getStatus \"question20?\"\n   doSomething [res1, ..., res20]\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5772142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f95222cc03a2d8e225acfb93be2fa6?s=128&d=identicon&r=PG&f=1", "display_name": "user35053", "link": "https://stackoverflow.com/users/5772142/user35053"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 35707314, "answer_count": 2, "score": 0, "last_activity_date": 1456795974, "creation_date": 1456770175, "question_id": 35706732, "link": "https://stackoverflow.com/questions/35706732/use-instance-for-input-checking", "title": "Use instance for input checking?", "body": "<p>I am trying to make a game and I want to ask the player a question. If their answer is yes, something happens or no something else happens.</p>\n\n<pre><code>class Status a where\n    stat :: a -&gt; String\n\ninstance  Status Char where\n    stat _ =  \"Would you like to drink a potion? YES or NO?\"\n</code></pre>\n\n<p>Doing this way will check all Char types but I can't use String. Can I do this in a different way?</p>\n"}, {"tags": ["haskell", "syntax", "currying", "partial-application"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456774654, "post_id": 35705787, "comment_id": 59092806, "body": "I find <code>subtract</code> is pretty counter-intuitive, so I generally avoid it."}, {"owner": {"reputation": 431, "user_id": 5186934, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aEulW.jpg?s=128&g=1", "display_name": "HandsomeGorilla", "link": "https://stackoverflow.com/users/5186934/handsomegorilla"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456841184, "post_id": 35705787, "comment_id": 59124771, "body": "It is a little weird, but if you read <code>subtract x y</code> like <b>subtract x <i>from</i>  y</b> then it makes perfect sense."}, {"owner": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "edited": false, "score": 0, "creation_date": 1456856901, "post_id": 35705787, "comment_id": 59135940, "body": "It makes most sense to me when mapping, e.g. <code>map (subtract 5) [1..10]</code> as opposed to <code>map (+(-5)) [1..10]</code>."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 8, "last_activity_date": 1456767778, "last_edit_date": 1456767778, "creation_date": 1456767473, "answer_id": 35705880, "question_id": 35705787, "link": "https://stackoverflow.com/questions/35705787/is-there-a-way-to-predict-infix-function-behavior-for-partially-applied-function/35705880#35705880", "title": "Is there a way to predict infix function behavior for partially applied functions in Haskell?", "body": "<p>There is no contradiction, it's just that <code>subtract = flip (-)</code>. I.e.</p>\n\n<pre><code>partialSubtractionWith5' x \u2261 (`subtract` 5) x\n                           \u2261 x `subtract` 5\n                           \u2261 5 - x\n</code></pre>\n\n<p>and, likewise,</p>\n\n<pre><code>isUpperAlphanum '\u25a1' \u2261 '\u25a1' `elem` ['A'..'B']\n</code></pre>\n\n<p>OTOH,</p>\n\n<pre><code>partialSubtractionWith5 x \u2261 (subtract 5) x\n                          \u2261 (5`subtract`) x\n                          \u2261 5 `subtract` x\n                          \u2261 x - 5\n</code></pre>\n"}], "owner": {"reputation": 431, "user_id": 5186934, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aEulW.jpg?s=128&g=1", "display_name": "HandsomeGorilla", "link": "https://stackoverflow.com/users/5186934/handsomegorilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 35705880, "answer_count": 1, "score": 0, "last_activity_date": 1478374223, "creation_date": 1456767220, "last_edit_date": 1478374223, "question_id": 35705787, "link": "https://stackoverflow.com/questions/35705787/is-there-a-way-to-predict-infix-function-behavior-for-partially-applied-function", "title": "Is there a way to predict infix function behavior for partially applied functions in Haskell?", "body": "<p>I have two functions--</p>\n\n<pre><code>partialSubtractionWith5 :: (Num a) =&gt; a -&gt; a\npartialSubtractionWith5 = (subtract 5)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>partialSubtractionWith5' :: (Num a) =&gt; a-&gt; a\npartialSubtractionwith5' = (`subtract` 5)\n</code></pre>\n\n<p>calling <code>partialSubtractionWith5 x</code> returns the equivalent of <em>x</em> - 5, while calling <code>partialSubtractionWith5' x</code> returns the equivalent of 5 - <em>x</em>.</p>\n\n<p>In <a href=\"http://learnyouahaskell.com/higher-order-functions#curried-functions\" rel=\"nofollow\">Learn You a Haskell</a>, Lipova\u010da defines the following function--</p>\n\n<pre><code>isUpperAlphanum :: Char -&gt; Bool\nisUpperAlphanum = (`elem` ['A'..'B'])\n</code></pre>\n\n<p>Which (based on my experiments with <code>subtract</code>) I would have thought would have behaved like so when called as <code>isUpperAlphanum 'some char'</code>:</p>\n\n<pre><code>Prelude&gt; ['A'..'B'] `elem` 'some char'\nFalse\n</code></pre>\n\n<p>Clearly, this is not the case.  But why? And is there a way to predict what functions will reverse their arguments when partially applied?</p>\n"}, {"tags": ["haskell", "grid"], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 3063152, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/db8a9921c49e3308f176fac904d316ec?s=128&d=identicon&r=PG&f=1", "display_name": "ProtectorOfUbi", "link": "https://stackoverflow.com/users/3063152/protectorofubi"}, "edited": false, "score": 0, "creation_date": 1456765189, "post_id": 35705133, "comment_id": 59086989, "body": "yeah I am having problems with the correct syntax. So that fixes one part. But also how can i define N which is the size of the grid?"}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 197, "user_id": 3063152, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/db8a9921c49e3308f176fac904d316ec?s=128&d=identicon&r=PG&f=1", "display_name": "ProtectorOfUbi", "link": "https://stackoverflow.com/users/3063152/protectorofubi"}, "edited": false, "score": 0, "creation_date": 1456765265, "post_id": 35705133, "comment_id": 59087048, "body": "xMax and yMax are the width and height of the rectangle....  This will return all x,y integer points in that rectangle."}, {"owner": {"reputation": 197, "user_id": 3063152, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/db8a9921c49e3308f176fac904d316ec?s=128&d=identicon&r=PG&f=1", "display_name": "ProtectorOfUbi", "link": "https://stackoverflow.com/users/3063152/protectorofubi"}, "edited": false, "score": 0, "creation_date": 1456765280, "post_id": 35705133, "comment_id": 59087061, "body": "will this work <code>grid x y n = [(x, y)| x&lt;- [0..n], y&lt;-[0..n]]</code>"}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 197, "user_id": 3063152, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/db8a9921c49e3308f176fac904d316ec?s=128&d=identicon&r=PG&f=1", "display_name": "ProtectorOfUbi", "link": "https://stackoverflow.com/users/3063152/protectorofubi"}, "edited": false, "score": 0, "creation_date": 1456765338, "post_id": 35705133, "comment_id": 59087082, "body": "you don&#39;t need the x and y on the left side of the definition....  Let me edit my answer."}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 197, "user_id": 3063152, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/db8a9921c49e3308f176fac904d316ec?s=128&d=identicon&r=PG&f=1", "display_name": "ProtectorOfUbi", "link": "https://stackoverflow.com/users/3063152/protectorofubi"}, "edited": false, "score": 0, "creation_date": 1456765909, "post_id": 35705133, "comment_id": 59087466, "body": "Just add a condition <code>[(x, y)| x &lt;- [0..n], y&lt;-[0..n], x &#47;= y]</code>."}, {"owner": {"reputation": 197, "user_id": 3063152, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/db8a9921c49e3308f176fac904d316ec?s=128&d=identicon&r=PG&f=1", "display_name": "ProtectorOfUbi", "link": "https://stackoverflow.com/users/3063152/protectorofubi"}, "edited": false, "score": 0, "creation_date": 1456766584, "post_id": 35705133, "comment_id": 59087882, "body": "lol i didn&#39;t see your comment took me time to work this out. But thanks"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 197, "user_id": 3063152, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/db8a9921c49e3308f176fac904d316ec?s=128&d=identicon&r=PG&f=1", "display_name": "ProtectorOfUbi", "link": "https://stackoverflow.com/users/3063152/protectorofubi"}, "edited": false, "score": 0, "creation_date": 1456813798, "post_id": 35705133, "comment_id": 59108347, "body": "@ProtectorOfUbi, you can highlight the independence of <code>x</code> and <code>y</code> by using <code>grid n = (,) &lt;$&gt; [0..n] &lt;*&gt; [0..n]</code> instead."}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": true, "score": 1, "last_activity_date": 1456765383, "last_edit_date": 1456765383, "creation_date": 1456765028, "answer_id": 35705133, "question_id": 35705034, "link": "https://stackoverflow.com/questions/35705034/how-to-create-coordinates-for-a-grid-in-haskell/35705133#35705133", "title": "How to create coordinates for a grid in Haskell", "body": "<p>Is this what you are trying to do?</p>\n\n<pre><code> grid n = [(x, y)| x&lt;- [0..n], y&lt;-[0..n]]\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 3063152, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/db8a9921c49e3308f176fac904d316ec?s=128&d=identicon&r=PG&f=1", "display_name": "ProtectorOfUbi", "link": "https://stackoverflow.com/users/3063152/protectorofubi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2172, "favorite_count": 1, "accepted_answer_id": 35705133, "answer_count": 1, "score": 0, "last_activity_date": 1456809292, "creation_date": 1456764758, "last_edit_date": 1456809292, "question_id": 35705034, "link": "https://stackoverflow.com/questions/35705034/how-to-create-coordinates-for-a-grid-in-haskell", "title": "How to create coordinates for a grid in Haskell", "body": "<p>Im attempting to define a function <code>grid :: Int -&gt; [(Int,Int)]</code> that returns a list of all (x, y) coordinate pairs on an n \u00d7 n square grid.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>    grid :: Int -&gt; [(Int,Int)]\n    grid x y = [x y| |(x &lt;- [1..x] y &lt;- [1..y])]\n</code></pre>\n\n<p>GHCi tells me</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>    parse error on input \u2018&lt;-\u2019\n    Perhaps this statement should be within a 'do' block?\nFailed, modules loaded: none.\nPrelude&gt;\n</code></pre>\n"}, {"tags": ["json", "haskell", "generics", "aeson", "custom-data-type"], "comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1456819580, "post_id": 35702440, "comment_id": 59110925, "body": "The upcoming GHC 8.0 will have a DuplicateRecordFields extension <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Records/OverloadedRecordFields/DuplicateRecordFields\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/wiki/Records/OverloadedRecordFields&zwnj;&#8203;/&hellip;</a> that will alleviate this problem."}], "answers": [{"tags": [], "owner": {"reputation": 1354, "user_id": 3027554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a52e97f946b17d363caca57df2692b0?s=128&d=identicon&r=PG&f=1", "display_name": "Christoph Hegemann", "link": "https://stackoverflow.com/users/3027554/christoph-hegemann"}, "is_accepted": false, "score": 3, "last_activity_date": 1456759346, "creation_date": 1456759346, "answer_id": 35703161, "question_id": 35702440, "link": "https://stackoverflow.com/questions/35702440/handling-id-in-derived-aeson-fromjson-instances-with-aeson-json/35703161#35703161", "title": "Handling `id` in derived Aeson FromJSON instances with Aeson/JSON", "body": "<p>The problem isn't that GHC can't provide Generics, but that in Haskell record labels are also accessor functions and thus you get a name clash if you try to use the same label for two different records.</p>\n\n<p>If you use the the functions from <code>Data.Aeson.TH</code> you can use <code>fieldLabelModifier</code> option to eg. remove prefixes from your labels.</p>\n\n<pre><code>data Identity = Identity\n{ identitysku       :: String\n, identityean       :: String\n, identitybarcode   :: String\n} deriving (Show)\n\n$(deriveJSON defaultOptions{fieldLabelModifier = drop (length \"identity\")} ''Identity)\n</code></pre>\n\n<p>This code requires the <code>{-# LANGUAGE TemplateHaskell #-}</code> pragma.</p>\n"}, {"comments": [{"owner": {"reputation": 1354, "user_id": 3027554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a52e97f946b17d363caca57df2692b0?s=128&d=identicon&r=PG&f=1", "display_name": "Christoph Hegemann", "link": "https://stackoverflow.com/users/3027554/christoph-hegemann"}, "edited": false, "score": 0, "creation_date": 1456759675, "post_id": 35703235, "comment_id": 59083076, "body": "Nice! I didn&#39;t know you could provide options for the generic instances."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1456786636, "post_id": 35703235, "comment_id": 59099573, "body": "This is what I needed. Thank you for your help!."}], "tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 12, "last_activity_date": 1456759517, "creation_date": 1456759517, "answer_id": 35703235, "question_id": 35702440, "link": "https://stackoverflow.com/questions/35702440/handling-id-in-derived-aeson-fromjson-instances-with-aeson-json/35703235#35703235", "title": "Handling `id` in derived Aeson FromJSON instances with Aeson/JSON", "body": "<p>When deriving FromJSON instances you can pass an option to the <code>genericParseJSON</code> function. It's usually</p>\n\n<pre><code>data Foo = {- ... -} deriving (Show, Generic)\n\ninstance FromJSON Foo where\n    parseJSON = genericParseJSON defaultOptions\n    -- defaultOptions :: Options\n</code></pre>\n\n<p>while you can replace <code>defaultOptions</code> with an <code>Option</code> you constructed manually. The <code>Option</code> type have a field <code>fieldLabelModifier</code> that can preprocess the field name of your data type. You can define your data type as </p>\n\n<pre><code>data Body = Body\n  { body_id :: Int\n  ...\n</code></pre>\n\n<p>And write a helper function which maps <code>\"body_id\"</code> to <code>\"id\"</code> and anything else unchanged:</p>\n\n<pre><code>body_noprefix \"body_id\" = \"id\"\nbody_noprefix s = s\n</code></pre>\n\n<p>Then define the instance as</p>\n\n<pre><code>instance FromJSON Body where\n  parseJSON = genericParseJSON (defaultOptions { fieldLabelModifier = body_noprefix })\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1456788326, "creation_date": 1456788326, "answer_id": 35711788, "question_id": 35702440, "link": "https://stackoverflow.com/questions/35702440/handling-id-in-derived-aeson-fromjson-instances-with-aeson-json/35711788#35711788", "title": "Handling `id` in derived Aeson FromJSON instances with Aeson/JSON", "body": "<p>Others have given great ways to modify the generated instances, which will sometimes be the best thing to do. It's not, however, your only choice. You also have the option of defining one or more of the types in separate modules, generating instances in those modules, and then importing the modules qualified or otherwise using qualified names to refer to the overlapping field names.</p>\n"}], "owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 1, "accepted_answer_id": 35703235, "answer_count": 3, "score": 6, "last_activity_date": 1456788326, "creation_date": 1456757104, "question_id": 35702440, "link": "https://stackoverflow.com/questions/35702440/handling-id-in-derived-aeson-fromjson-instances-with-aeson-json", "title": "Handling `id` in derived Aeson FromJSON instances with Aeson/JSON", "body": "<p>If I have <code>JSON</code> and I try to derive the <code>FromJSON</code> instances automatically with <code>Generics</code>, I run into problems with <code>id</code> existing in more than one place in the <code>JSON</code>. </p>\n\n<p>Is there a way for me to override just the <code>id</code> part or do I have to write the whole instance in order to change those particular entries? The <code>JSON</code> actually has more fields, but I have left most of it out in this example. So it is actually rather tedious to write out the whole <code>FromJSON</code> instance.</p>\n\n<p>JSON:</p>\n\n<pre><code>{\n  \"response\": [\n    {\n      \"id\": 1,\n      \"brandId\": 1,\n      \"productTypeId\": 1,\n      \"identity\": {\n        \"sku\": \"x\",\n        \"barcode\": \"Ax\"\n      },\n      \"stock\": {\n        \"stockTracked\": false,\n        \"weight\": {\n          \"magnitude\": 0\n        },\n        \"dimensions\": {\n          \"length\": 0,\n          \"height\": 0,\n          \"width\": 0,\n          \"volume\": 0\n        }\n      },\n      \"financialDetails\": {\n        \"taxable\": false,\n        \"taxCode\": {\n          \"id\": 1,\n          \"code\": \"x\"\n        }\n      },\n... etc\n  ]\n}\n</code></pre>\n\n<p>CODE So far:</p>\n\n<pre><code>data Response = Response\n    { response :: [Body]\n    } deriving (Show,Generic)\n\ndata Body = Body\n    { id                    :: Int\n    , brandId               :: Int\n    , productTypeId         :: Int\n    , identity              :: Identity\n    , productGroupId        :: Int\n    , stock                 :: Stock\n    , financialDetails      :: FinancialDetails\n    } deriving (Show,Generic)                  \n\ndata Identity = Identity\n    { sku       :: String\n    , ean       :: String\n    , barcode   :: String\n    } deriving (Show,Generic)                  \n\ndata Stock = Stock\n    { stockTracked  :: Bool\n    , weight        :: Weight\n    , dimensions    :: Dimensions\n    } deriving (Show,Generic)                  \n\ndata Weight = Weight\n    { magnitude  :: Int\n    } deriving (Show,Generic)                  \n\ndata Dimensions = Dimensions\n    { length :: Int\n    , height :: Int\n    , width  :: Int\n    , volume :: Int\n    } deriving (Show,Generic)                  \n\ndata FinancialDetails = FinancialDetails\n     { taxable :: Bool\n     , taxCode :: TaxCode\n     } deriving (Show,Generic)                  \n\ndata TaxCode = TaxCode\n     { id      :: Int\n     , code    :: String \n     } deriving (Show,Generic)                  \n\n\ninstance FromJSON Response\ninstance FromJSON Body\ninstance FromJSON Identity\ninstance FromJSON Stock\ninstance FromJSON Weight\ninstance FromJSON Dimensions\ninstance FromJSON FinancialDetails\n</code></pre>\n\n<p>This gives the error:</p>\n\n<pre><code>[1 of 1] Compiling Main             ( reponse.hs, interpreted )\n\nresponse.hs:73:8:\n    Multiple declarations of `id'\n    Declared at: response.hs:19:7\n                 response.hs:73:8\nFailed, modules loaded: none.\n</code></pre>\n\n<p>Ideally I would like to change the first <code>id</code> to <code>body_id</code> and the second to <code>taxCode_id</code> without having to write out the whole instance.</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 1, "creation_date": 1456757219, "post_id": 35702416, "comment_id": 59081162, "body": "The problem is your <code>resolveName</code> should return <code>IO String</code>, not <code>String</code>. This is because it is operating in the <code>IO</code> monad, i.e. you are chaining <code>IO</code> actions in it, so it must return <code>IO</code>."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1456757573, "post_id": 35702416, "comment_id": 59081433, "body": "Possible duplicate: <a href=\"http://stackoverflow.com/q/15641584/1523776\">convert IO String to \u201cOther type\u201d</a>"}, {"owner": {"reputation": 25, "user_id": 5965348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d481c77e43f88fac1d056c7da032948?s=128&d=identicon&r=PG&f=1", "display_name": "Sho", "link": "https://stackoverflow.com/users/5965348/sho"}, "edited": false, "score": 2, "creation_date": 1456757963, "post_id": 35702416, "comment_id": 59081765, "body": "Oh that makes sense! Thank you very much."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "reply_to_user": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 0, "creation_date": 1456894757, "post_id": 35702416, "comment_id": 59151497, "body": "@WillSewell since your comment resolved the question, perhaps it should be posted as an answer?"}, {"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "reply_to_user": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1456913135, "post_id": 35702416, "comment_id": 59161446, "body": "@sclv ok I&#39;ll post it as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "is_accepted": true, "score": 1, "last_activity_date": 1456913163, "creation_date": 1456913163, "answer_id": 35744003, "question_id": 35702416, "link": "https://stackoverflow.com/questions/35702416/type-errors-when-using-io-action-in-haskell/35744003#35744003", "title": "Type errors when using IO action in Haskell", "body": "<p>The problem is your resolveName should return <code>IO String</code>, not <code>String</code>. This is because it is operating in the <code>IO</code> monad, i.e. you are chaining <code>IO</code> actions in it, so it must return <code>IO</code>.</p>\n"}], "owner": {"reputation": 25, "user_id": 5965348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d481c77e43f88fac1d056c7da032948?s=128&d=identicon&r=PG&f=1", "display_name": "Sho", "link": "https://stackoverflow.com/users/5965348/sho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 1, "accepted_answer_id": 35744003, "answer_count": 1, "score": 0, "last_activity_date": 1521434984, "creation_date": 1456757029, "last_edit_date": 1521434984, "question_id": 35702416, "link": "https://stackoverflow.com/questions/35702416/type-errors-when-using-io-action-in-haskell", "title": "Type errors when using IO action in Haskell", "body": "<p>I just started learning Haskell and now got stuck in dealing with IO action.</p>\n\n<p>Here's the code.</p>\n\n<pre><code>parseDnsMessage :: BG.BitGet DnsMessage\n\nrecQuery :: BS.ByteString -&gt; String -&gt; IO BS.ByteString\n\nresolveName :: [Word8] -&gt; [Word8] -&gt; BS.ByteString -&gt; String\nresolveName qname name bstr = do\n  let newbstr = BSL.toStrict $ replace (BS.pack qname) (BS.pack name) bstr\n  retbstr &lt;- recQuery newbstr (head rootServers4)\n  let msg = BG.runBitGet retbstr parseDnsMessage\n  case msg of\n    Right m -&gt; (intercalate \".\" $ map show (rdata $ head $ answer $ m))\n</code></pre>\n\n<p>---Error Message---</p>\n\n<pre><code>Couldn't match expected type \u2018[BSI.ByteString]\u2019\n            with actual type \u2018IO BSI.ByteString\u2019\nIn a stmt of a 'do' block:\n  retbstr &lt;- recQuery newbstr (head rootServers4)\nIn the expression:\n  do { let newbstr\n             = BSL.toStrict $ replace (BS.pack qname) (BS.pack name) bstr;\n       retbstr &lt;- recQuery newbstr (head rootServers4);\n       let msg = BG.runBitGet retbstr parseDnsMessage;\n       case msg of {\n         Right m\n           -&gt; (intercalate \".\" $ map show (rdata $ head $ answer $ m)) } }\n</code></pre>\n\n<p>I just want to retrieve <code>BS.ByteString</code> from the <code>recQuery</code> <code>IO action</code>.</p>\n\n<p>How can I fix this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1456752931, "post_id": 35700358, "comment_id": 59078159, "body": "Look into the&#39;open world&#39; assumption."}, {"owner": {"reputation": 3485, "user_id": 1483503, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/652348761699d4193e073409caa287d6?s=128&d=identicon&r=PG", "display_name": "mljrg", "link": "https://stackoverflow.com/users/1483503/mljrg"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1456755786, "post_id": 35700358, "comment_id": 59080137, "body": "@ThomasM.DuBuisson Can you be more specific / clear?"}, {"owner": {"reputation": 3485, "user_id": 1483503, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/652348761699d4193e073409caa287d6?s=128&d=identicon&r=PG", "display_name": "mljrg", "link": "https://stackoverflow.com/users/1483503/mljrg"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1456756922, "post_id": 35700358, "comment_id": 59080932, "body": "@ThomasM.DuBuisson The &quot;open world assumption&quot; tells that a typeclass can have any number of instances defined anywhere. Thus this means that the functional dependency is always necessary, even when there is only one instance, because no one knows if more instances will be added in the future, and so, to prevent future ambiguity GHC forces who defines the typeclass to provide a fundep &quot;&#224; priori&quot; so that he or she will not have to change the typeclass later to accomodate the new instances, and doing so, avoid also the need to change the first instance?"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1456774645, "post_id": 35700358, "comment_id": 59092798, "body": "@mljrg Why the accent in <i>a priori</i>? It&#39;s a latin locution, not a french one."}], "answers": [{"tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 2, "last_activity_date": 1456821036, "creation_date": 1456821036, "answer_id": 35717963, "question_id": 35700358, "link": "https://stackoverflow.com/questions/35700358/why-does-ghc-needs-a-functional-dependency-to-infer-the-type-of-this-expression/35717963#35717963", "title": "Why does GHC needs a functional dependency to infer the type of this expression", "body": "<p>I find it helpful to use <code>:t</code> when the typechecker runs into ambiguity.</p>\n\n<pre><code>:set -XMultiParamTypeClasses \n:set -XFunctionalDependencies \n:set -XFlexibleContexts \n:set -XFlexibleInstances \n\nclass Extract big small where extract :: big -&gt; small\ninstance Extract (a, b) a where extract = fst\n</code></pre>\n\n<p>So, with that out of the way:</p>\n\n<pre><code>:t let oneTwo = (1, 2) :: (Int, Int)\n:t extract oneTwo\nextract oneTwo :: Extract (Int, Int) small =&gt; small\n</code></pre>\n\n<p>Note! Even though the compiler knows that <code>Extract (Int, Int) small</code> is the only instance it doesn't <em>use</em> that information for type resolution. In order words:</p>\n\n<pre><code>:t {- in an alternate universe -} extract oneTwo\nextract oneTwo :: Int\n</code></pre>\n\n<p>The reason is subtle: you actually wouldn't <em>want</em> that behavior. If that information were used, this compiler or the binary might do something come Friday that it wasn't doing on Monday. Because I could define</p>\n\n<pre><code>{- in an alternate universe -}\ninstance Extract (a, b) a where\n  extract = fst\ninstance Extract (a, b) String where\n  extract = const \"hey girl\"\n</code></pre>\n\n<p>Now <code>extract oneTwo</code> could do one of two things:</p>\n\n<ul>\n<li><p>Arbitrarily pick between <code>:: Int</code> or <code>:: String</code>. This violates the principle of least surprise. An instance defined at point A managed to act on code defined all the way over at point B.</p></li>\n<li><p>Error out! This <em>also</em> violates the principle of least surprise. An instance defined at point A made code all the way over at point B stop type-checking.</p></li>\n</ul>\n\n<p>So, in the face of two evils, what we can do is just not use instances to resolve types.</p>\n\n<h2>Promises, promises</h2>\n\n<p>Now, what if you <em>promised</em> that a second instance could never come along?</p>\n\n<pre><code>class Extract' big small | big -&gt; small where\n  extract' :: big -&gt; small\n\ninstance Extract' (a, b) a where\n  extract' = fst\n\n:t extract' oneTwo\nextract oneTwo :: Int\n</code></pre>\n\n<p>Now there are exactly one or zero instances of <code>Extract' big small</code> for every choice of <code>big</code>. It's now valid to use the instance for type resolution. For this, and more cartwheels, see <a href=\"https://ocharles.org.uk/blog/posts/2014-12-14-functional-dependencies.html\" rel=\"nofollow\">24 Days of GHC Extensions</a>.</p>\n"}], "owner": {"reputation": 3485, "user_id": 1483503, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/652348761699d4193e073409caa287d6?s=128&d=identicon&r=PG", "display_name": "mljrg", "link": "https://stackoverflow.com/users/1483503/mljrg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 1, "accepted_answer_id": 35717963, "answer_count": 1, "score": 1, "last_activity_date": 1456821036, "creation_date": 1456751155, "question_id": 35700358, "link": "https://stackoverflow.com/questions/35700358/why-does-ghc-needs-a-functional-dependency-to-infer-the-type-of-this-expression", "title": "Why does GHC needs a functional dependency to infer the type of this expression", "body": "<p>Consider the example of functional dependencies taken from <a href=\"https://wiki.haskell.org/Functional_dependencies\" rel=\"nofollow\">here</a></p>\n\n<pre><code>class Extract container elem | container -&gt; elem where\n  extract :: container -&gt; elem\n\ninstance Extract (a,b) a where\n  extract (x,_) = x\n</code></pre>\n\n<p>I understand why a functional dependency between <code>container</code>and <code>elem</code> is needed to avoid ambiguity with </p>\n\n<pre><code>instance Extract (a,b) b where\n  extract (x,_) = x\n</code></pre>\n\n<p>However, if we do not have this latter instance, why can't the compiler figure the type of <code>extract ('x', 3)</code> instead of returning the following error?</p>\n\n<pre><code>&lt;interactive&gt;:408:1:\nCould not deduce (Num t0)\nfrom the context (Num t, Extract (Char, t) elem)\n  bound by the inferred type for \u2018it\u2019:\n             (Num t, Extract (Char, t) elem) =&gt; elem\n  at &lt;interactive&gt;:408:1-20\nThe type variable \u2018t0\u2019 is ambiguous\nWhen checking that \u2018it\u2019 has the inferred type\n  it :: forall elem t. (Num t, Extract (Char, t) elem) =&gt; elem\nProbable cause: the inferred type is ambiguous\n</code></pre>\n\n<p>I tried to do <code>extract('x', 3 :: Int)</code> and in this case it generates the error:</p>\n\n<pre><code>&lt;interactive&gt;:409:1:\nNo instance for (Show a0) arising from a use of \u2018print\u2019\nThe type variable \u2018a0\u2019 is ambiguous\nNote: there are several potential instances:\n  instance Show a =&gt; Show (Control.Applicative.Const a b)\n    -- Defined in \u2018Control.Applicative\u2019\n  instance Show a =&gt; Show (Control.Applicative.ZipList a)\n    -- Defined in \u2018Control.Applicative\u2019\n  instance Show a =&gt; Show (Data.Complex.Complex a)\n    -- Defined in \u2018Data.Complex\u2019\n  ...plus 149 others\nIn a stmt of an interactive GHCi command: print it\n</code></pre>\n\n<p>What are the limitations of GHC that requires a functional dependency in this case?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "frege"], "comments": [{"owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "edited": false, "score": 0, "creation_date": 1456758913, "post_id": 35699500, "comment_id": 59082474, "body": "Read more about what actually <code>let</code> means, and what actually <code>&lt;-</code> does. And, probably, about the <code>do</code> notaion."}], "answers": [{"tags": [], "owner": {"reputation": 14545, "user_id": 42188, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0b0abbefc6a9375882ea3cc0c6da61c8?s=128&d=identicon&r=PG", "display_name": "muhuk", "link": "https://stackoverflow.com/users/42188/muhuk"}, "is_accepted": false, "score": 3, "last_activity_date": 1456775549, "last_edit_date": 1456775549, "creation_date": 1456758921, "answer_id": 35703015, "question_id": 35699500, "link": "https://stackoverflow.com/questions/35699500/what-is-the-difference-between-and-let-inside-do-blocks/35703015#35703015", "title": "What is the difference between &lt;- and &quot;let&quot; inside do blocks?", "body": "<p><code>&lt;-</code> is to <code>&gt;&gt;=</code> (<code>bind</code>) where <code>let</code> is to <code>fmap</code> in a <code>do</code> block.</p>\n\n<p>Stealing an example from <a href=\"https://en.wikibooks.org/wiki/Haskell/do_notation\" rel=\"nofollow\">here</a>:</p>\n\n<pre><code>do x1 &lt;- action1 x0\n   x2 &lt;- action2 x1\n   action3 x1 x2\n\n-- is equivalent to:\naction1 x0 &gt;&gt;= \\ x1 -&gt; action2 x1 &gt;&gt;= \\ x2 -&gt; action3 x1 x2\n</code></pre>\n\n<p><code>action1</code>, <code>action2</code> &amp; <code>action3</code> all return some sort of monad, say:</p>\n\n<pre><code>action1 :: (Monad m) =&gt; a -&gt; m b\naction2 :: (Monad m) =&gt; b -&gt; m c\naction3 :: (Monad m) =&gt; b -&gt; c -&gt; m d\n</code></pre>\n\n<p>You can rewrite let bindings as such:</p>\n\n<pre><code>-- assume action1 &amp; action3 are the same\n-- but action2 is thus:\naction2 :: b -&gt; c\n\ndo\n    x1 &lt;- action1 x0\n    let x2 = action2 x1\n    action3 x1 x2\n\ndo\n    x1 &lt;- action1 x0\n    x2 &lt;- return &amp; action2 x1\n    action3 x1 x2\n\n-- of course it doesn't make sense to call action2\n-- an action anymore, it's just a pure function.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9272, "user_id": 241544, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d27ca4e9a9a41ec8732046e6a272f091?s=128&d=identicon&r=PG", "display_name": "Matthew Walton", "link": "https://stackoverflow.com/users/241544/matthew-walton"}, "is_accepted": false, "score": 5, "last_activity_date": 1456763520, "creation_date": 1456763520, "answer_id": 35704630, "question_id": 35699500, "link": "https://stackoverflow.com/questions/35699500/what-is-the-difference-between-and-let-inside-do-blocks/35704630#35704630", "title": "What is the difference between &lt;- and &quot;let&quot; inside do blocks?", "body": "<p><code>let</code> gives a name to the result of a function call.</p>\n\n<p><code>&lt;-</code> binds the result of a monadic operation in the current monad to a name.</p>\n\n<p>They're quite different. Use <code>let</code> for the results of functions outside the monad, i.e. normal pure functions. Use <code>&lt;-</code> for anything monadic, as it \"unwraps\" the monad result and lets you get at the value inside it.</p>\n\n<p>For example:</p>\n\n<p>assume an IO function with the following signature</p>\n\n<pre><code>frobnicate :: String -&gt; IO Bool\n</code></pre>\n\n<p>and a pure function</p>\n\n<pre><code>dothing :: Bool -&gt; Bool\n</code></pre>\n\n<p>we can do this</p>\n\n<pre><code>main :: IO ()\nmain = do\n  x &lt;- frobnicate \"Hello\"\n  let y = frobnicate \"Hello\"\n  -- z &lt;- dothing x\n  let z = dothing x\n  return ()\n</code></pre>\n\n<p>And we know that <code>x :: Bool</code> because the <code>Bool</code> has been extracted from the <code>IO</code> operation result for us (the operation runs, and the result is called <code>x</code> so we can use it later).</p>\n\n<p>We also know that <code>y :: IO Bool</code> - the operation hasn't been run, it's the <em>potential</em> for an IO operation in the future. So the only useful thing we can do with <code>y</code> is run it later, bind the result and get at the <code>Bool</code> inside that way, but after a <code>let</code> that <code>Bool</code> doesn't even exist yet.</p>\n\n<p>The third line is commented out because it won't compile - you can't do a monadic bind on an operation which is not in the relevant monad. <code>dothing</code> doesn't return an <code>IO</code> anything, so you can't bind it inside an <code>IO ()</code> function.</p>\n\n<p>The fourth line is straightforward - <code>z</code> is made to be the result of <code>dothing x</code>, where <code>x</code> was the value unwrapped from running <code>frobnicate \"Hello\"</code> earlier.</p>\n\n<p>All of this is just syntactic sugar for the 'real' monad operations underneath, so that expands (without the commented out part) to something like</p>\n\n<pre><code>main = frobnicate \"Hello\" &gt;&gt;= (\\x -&gt; let y = frobnicate \"Hello\"\n                                         z = dothing x\n                                      in return ())\n</code></pre>\n\n<p>The example of course makes no sense at all, but hopefully it illustrates where <code>let</code> and <code>&lt;-</code> differ within <code>do</code> notation.</p>\n\n<p>TL;DR: use <code>&lt;-</code> for giving names to the results of monadic operations, <code>let</code> for giving names to everything else.</p>\n"}, {"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 1, "last_activity_date": 1456782735, "last_edit_date": 1456782735, "creation_date": 1456773535, "answer_id": 35707753, "question_id": 35699500, "link": "https://stackoverflow.com/questions/35699500/what-is-the-difference-between-and-let-inside-do-blocks/35707753#35707753", "title": "What is the difference between &lt;- and &quot;let&quot; inside do blocks?", "body": "<p>A good example to visualize what <code>&lt;-</code> does:</p>\n\n<pre><code>do\n    a &lt;- ['a'..'z']\n    b &lt;- [1..3]\n    pure (a,b)\n</code></pre>\n\n<p>You can try this in the online REPL at <a href=\"http://try.frege-lang.org/\" rel=\"nofollow\">try.frege-lang.org</a>\n(You can enter this as a single line:</p>\n\n<pre><code>do { a &lt;- ['a'..'z']; b &lt;- [1..3]; pure (a,b) }\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 5976895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da21ed9c2477a09c57e4c95e8908f3d0?s=128&d=identicon&r=PG", "display_name": "E.F", "link": "https://stackoverflow.com/users/5976895/e-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1412, "favorite_count": 0, "closed_date": 1456775089, "answer_count": 3, "score": 3, "last_activity_date": 1456782735, "creation_date": 1456748628, "last_edit_date": 1456758653, "question_id": 35699500, "link": "https://stackoverflow.com/questions/35699500/what-is-the-difference-between-and-let-inside-do-blocks", "closed_reason": "Duplicate", "title": "What is the difference between &lt;- and &quot;let&quot; inside do blocks?", "body": "<p>I don't understand when do I have to use <code>let</code> and when do I have to use the <code>&lt;-</code> binding.</p>\n"}, {"tags": ["haskell", "optimization", "ghci"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 4, "creation_date": 1456748150, "post_id": 35699231, "comment_id": 59074992, "body": "probably a slight rewrite in the optimization yielding the usual float-point arithmetic issues (btw: a small example producing this type of issue would help a lot - as it is we can obviously only guess)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 5, "creation_date": 1456748559, "post_id": 35699231, "comment_id": 59075223, "body": "Er, <i>of course</i> code does matter! Please post a minimal reproducible example. (Carsten is right, this is probably a floating-point associativity issue... but that hardly constitutes a proper answer.)"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 2, "creation_date": 1456756120, "post_id": 35699231, "comment_id": 59080360, "body": "Quoting from the close reason: &quot;Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce <b>it in the question itself</b>. &quot;  So, no a link to a github repository isn&#39;t enough. Moreover if you have 5k lines of code <b>you</b> should first try to obtain a minimal example that displays the problem."}, {"owner": {"reputation": 129, "user_id": 834108, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bedf8b7464b132ea229ff4ebd3fb2ba?s=128&d=identicon&r=PG", "display_name": "meownoid", "link": "https://stackoverflow.com/users/834108/meownoid"}, "edited": false, "score": 0, "creation_date": 1456757672, "post_id": 35699231, "comment_id": 59081519, "body": "Added example as minimum as possible in this situation."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1456759131, "post_id": 35699231, "comment_id": 59082633, "body": "Right, this looks <i>ok</i> now. Still quite a lot of code; you have tried to boil it down <i>as much as possible</i>, right?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1456759374, "post_id": 35699231, "comment_id": 59082831, "body": "Unfortunately I can&#39;t reproduce your problem, I get 11.530136779081658 as the result no matter how I compile and/or run your code (with GHC-7.10.2)."}, {"owner": {"reputation": 129, "user_id": 834108, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bedf8b7464b132ea229ff4ebd3fb2ba?s=128&d=identicon&r=PG", "display_name": "meownoid", "link": "https://stackoverflow.com/users/834108/meownoid"}, "edited": false, "score": 0, "creation_date": 1456759438, "post_id": 35699231, "comment_id": 59082889, "body": "Sure. The discrepancy arises only in interpolation integration method, which depends on gauss method and I need hypergeometric function to calculate k-th moment. So, that&#39;s why I need all this code."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1456760200, "post_id": 35699231, "comment_id": 59083491, "body": "What&#39;s weirder is that <a href=\"http://ideone.com/urDT55\" rel=\"nofollow noreferrer\">ideone</a> and <a href=\"http://codepad.org/SXSDw8V2\" rel=\"nofollow noreferrer\">codepad</a> both fail to give proper results at all (with different errors!). It seems some call to a built-in maths function you do there is massively unstable... very strange."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1456763328, "post_id": 35699231, "comment_id": 59085736, "body": "@leftaroundabout Interesting, I get <code>11.580918029081658</code> (ghc 7.10.3, x86_64, os x)"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1456764099, "post_id": 35699231, "comment_id": 59086245, "body": "@devmeow, it&#39;s not a question of dead code, but of things like: if you just don&#39;t call <code>triangulate</code> (set <code>ts = xs&#39;</code>), will you still get a different result in ghci than in compiled code? Most likely you can do a whole lot of that sort of simplification."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1456764225, "post_id": 35699231, "comment_id": 59086343, "body": "Anyways my guess is that you are using a 32-bit GHC and this is just a classic 80-bit vs. 64-bit issue, though I don&#39;t understand @ThomasM.DuBuisson&#39;s result on x86_64."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1456764410, "post_id": 35699231, "comment_id": 59086471, "body": "@ReidBarton bit number doesn&#39;t seem to be the reason. GHC-7.10.2 gives me the 11.53 result both on x86_64 (Ubuntu14.04) and armv6l (Debian7.8 32-bit)."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1456764469, "post_id": 35699231, "comment_id": 59086497, "body": "armv6l is not x87... so it doesn&#39;t have 80-bit doubles."}, {"owner": {"reputation": 129, "user_id": 834108, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bedf8b7464b132ea229ff4ebd3fb2ba?s=128&d=identicon&r=PG", "display_name": "meownoid", "link": "https://stackoverflow.com/users/834108/meownoid"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1456764964, "post_id": 35699231, "comment_id": 59086842, "body": "@reid-barton Ok. I&#39;ve deleted hypergeometric function with saving the issue. Any other reductions results in same answers. Also, how to determine if ghc is 32-bit?"}, {"owner": {"reputation": 129, "user_id": 834108, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bedf8b7464b132ea229ff4ebd3fb2ba?s=128&d=identicon&r=PG", "display_name": "meownoid", "link": "https://stackoverflow.com/users/834108/meownoid"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1456765359, "post_id": 35699231, "comment_id": 59087093, "body": "@reid-barton And ghci using the same ghc binary, isn&#39;t it?"}, {"owner": {"reputation": 129, "user_id": 834108, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bedf8b7464b132ea229ff4ebd3fb2ba?s=128&d=identicon&r=PG", "display_name": "meownoid", "link": "https://stackoverflow.com/users/834108/meownoid"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1456765535, "post_id": 35699231, "comment_id": 59087226, "body": "@leftaroundabout the new version of code works on <a href=\"https://ideone.com/6V3Fkz\" rel=\"nofollow noreferrer\">ideone</a>"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1456765950, "post_id": 35699231, "comment_id": 59087486, "body": "Run <code>ghc --info</code> and look at the lines &quot;target arch&quot; and &quot;target word size&quot;."}, {"owner": {"reputation": 129, "user_id": 834108, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bedf8b7464b132ea229ff4ebd3fb2ba?s=128&d=identicon&r=PG", "display_name": "meownoid", "link": "https://stackoverflow.com/users/834108/meownoid"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1456766151, "post_id": 35699231, "comment_id": 59087607, "body": "@reid-barton, target arch: ArchX86_64, target word size: 8"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1456766396, "post_id": 35699231, "comment_id": 59087762, "body": "...and Ideone gives 5.783052853587137 as the result, which matches neither your 5.783052922423153 nor 5.7830528964079235, nor the correct result 3.675. \u2014 But really, these discrepancies look not so appalling anymore, this is the kind of error a badly-ordered floating-point summation may well give you. It seems to be the instability of your algorithm that blows up the deviations to anything between 1% and NaN. Still \u2013 I don&#39;t think GHC should reorder summations <i>at all</i>..."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1456791658, "post_id": 35699231, "comment_id": 59101518, "body": "@devmeow, in that case, I don&#39;t know what&#39;s going on. Please file a bug (<a href=\"https://ghc.haskell.org/trac/ghc/newticket\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/newticket</a>)."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1456855089, "post_id": 35699231, "comment_id": 59134878, "body": "This is why floating numbers are terrible. See if using <code>Rational</code> helps."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1456896245, "post_id": 35699231, "comment_id": 59152049, "body": "@devmeow one way to ensure ghci is using the same ghc binary is just to run <code>ghc -i</code> to boot it into interactive mode."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1458416780, "post_id": 35699231, "comment_id": 59854643, "body": "One more hunch would be that it arises from compiled code using <code>sse</code> while interpreted code doesn&#39;t? But I think on 64 bit sse is used unconditionally, so it is only possible to toggle this on 32 bit arches."}], "owner": {"reputation": 129, "user_id": 834108, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bedf8b7464b132ea229ff4ebd3fb2ba?s=128&d=identicon&r=PG", "display_name": "meownoid", "link": "https://stackoverflow.com/users/834108/meownoid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1456764908, "creation_date": 1456747867, "last_edit_date": 1456764908, "question_id": 35699231, "link": "https://stackoverflow.com/questions/35699231/why-numeric-results-in-ghci-and-compiled-code-are-different", "title": "Why numeric results in ghci and compiled code are different?", "body": "<p>I have a haskell code calculating defined integrals. When I run it from ghci I get:</p>\n\n<pre><code>tol = 1.0e-12 :: 11.83933789116509 :: 0.0\n</code></pre>\n\n<p>Where first column is tolerance, second column is an integral value and third column is an error.</p>\n\n<p>But when I run absolutely same code, compiled with -O0 only I get:</p>\n\n<pre><code>tol = 1.0e-12 :: 11.839337891165126 :: 3.552713678800501e-14\n</code></pre>\n\n<p>Why is this happening?</p>\n\n<p>P.S: code doesn't matter I guess. Just a lot of double arithmetic.</p>\n\n<p><strong>UPD</strong>: Here is the minimal example:</p>\n\n<pre><code>type R = Double\ntype F = R -&gt; R\n\nlinearScale :: Fractional a =&gt; Int -&gt; a -&gt; a -&gt; [a]\nlinearScale n x0 x1 = let h = x1 - x0 in\n   map (\\m -&gt; x0 + h * fromIntegral m / fromIntegral n) [0 .. n]\n\ntriangulate :: [[Double]] -&gt; [[Double]]\ntriangulate [] = []\ntriangulate (x:xs) = x : (triangulate xs')\n    where xs' = map f xs\n          f ys\n            | head ys == 0 = drop 1 ys\n            | otherwise = drop 1 $ zipWith (-) (map (* c) ys) x\n            where c = (head x) / (head ys)\n\nsolve :: [[Double]] -&gt; [Double] -&gt; [Double]\nsolve ms bs = f (reverse ms) (reverse bs) []\n    where f [] _ zs = zs\n          f _ [] zs = zs\n          f (x:xs) (y:ys) zs = f xs ys (z:zs)\n            where z = (y - (sum $ zipWith (*) (tail x) zs)) / head x\n\ngauss :: [[Double]] -&gt; [Double] -&gt; [Double]\ngauss xs ys = solve ms bs\n    where xs' = zipWith (\\a b -&gt; a ++ [b]) xs ys\n          ts = triangulate xs'\n          ms = map init ts\n          bs = map last ts\n\nintegrateWithN :: Int -&gt; F -&gt; (Int -&gt; R -&gt; R -&gt; R) -&gt; R -&gt; R -&gt; R\nintegrateWithN n f mu a b = sum . zipWith (*) rs $ map f xs\n    where xs = linearScale n a b\n          mus = [mu s a b | s &lt;- [0 .. n - 1]]\n          xss = [map (^ i) xs | i &lt;- [0 .. n - 1]]\n          rs = gauss xss mus\n\nmain :: IO ()\nmain = print $ integrateWithN 60 f mu a b\n    where\n    f x = x\n    intp k x = -0.39876 * exp(1.16315 * fromIntegral k) * (16 - 5 * x) ** (3/4)\n    mu k a b = intp k b - intp k a\n    a = 1.7\n    b = 3.2\n</code></pre>\n\n<p>You'll get the different results running this code compiled with -O0 and from ghci.</p>\n\n<p><strong>UPD:</strong> ghc 7.10.3</p>\n\n<p>My results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/q45mh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/q45mh.png\" alt=\"results\"></a></p>\n"}, {"tags": ["http", "haskell", "url", "wreq"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4156211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ElvSP.jpg?s=128&g=1", "display_name": "Simone Trubian", "link": "https://stackoverflow.com/users/4156211/simone-trubian"}, "edited": false, "score": 0, "creation_date": 1456760668, "post_id": 35696222, "comment_id": 59083835, "body": "Thank you so much Zeta, who would have thought it would be so simple! The usual me, trying to overcomplicate easy things -_- !"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 23, "user_id": 4156211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ElvSP.jpg?s=128&g=1", "display_name": "Simone Trubian", "link": "https://stackoverflow.com/users/4156211/simone-trubian"}, "edited": false, "score": 0, "creation_date": 1456836005, "post_id": 35696222, "comment_id": 59120852, "body": "@SimoneTrubian You&#39;re welcome. If this answer satisfies you, make sure <a href=\"http://meta.stackexchange.com/a/5235/191939\">to accept it</a>, otherwise it will stay as &quot;unanswered&quot; in several filters."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 3, "last_activity_date": 1456738933, "creation_date": 1456738933, "answer_id": 35696222, "question_id": 35695843, "link": "https://stackoverflow.com/questions/35695843/haskell-wreq-param-list/35696222#35696222", "title": "haskell wreq param list", "body": "<p>Both <code>param &lt;key&gt;</code> and <code>params</code> are lenses:</p>\n\n<pre><code>param  :: Text -&gt; Lens' Options [Text] \nparams ::         Lens' Options [(Text, Text)]\n</code></pre>\n\n<p>Without going too much into details, you can think of a lens focusing something, e.g. <code>param \"foo\"</code> focuses on some <code>[Text]</code> in <code>Options</code> that belong to the parameter <code>foo</code> (*). You can then change/query/manipulate those values with the correct function (see the <a href=\"https://hackage.haskell.org/package/lens\" rel=\"nofollow\">lens</a> package).</p>\n\n<p>You've already used <code>(.~)</code> to replace the current values, and you can use it again with <code>params</code>:</p>\n\n<pre><code>default &amp; params .~ [(\"key1\", \"value1\"), (\"key2\", \"value2\"), (\"key3\", \"value3\")]\n</code></pre>\n\n<p>You can think of <code>(.~)</code> in this context as</p>\n\n<pre><code>(.~) :: Lens' a b -&gt; b -&gt; a -&gt; a\n-- concrete:\n(.~) :: Lens' Options [(Text, Text)] -&gt; [(Text, Text)] -&gt; Options -&gt; Options\n</code></pre>\n\n<p><sub>(*) That's not 100% true, since lenses allow you to do all kinds of stuff, but good enough for this context.</sub></p>\n"}], "owner": {"reputation": 23, "user_id": 4156211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ElvSP.jpg?s=128&g=1", "display_name": "Simone Trubian", "link": "https://stackoverflow.com/users/4156211/simone-trubian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 1, "accepted_answer_id": 35696222, "answer_count": 1, "score": 2, "last_activity_date": 1513715267, "creation_date": 1456737895, "last_edit_date": 1513715267, "question_id": 35695843, "link": "https://stackoverflow.com/questions/35695843/haskell-wreq-param-list", "title": "haskell wreq param list", "body": "<p>In the excellent <code>wreq</code> Haskell library it is easy to add one or more query parameters to an URL:</p>\n\n<p><code>opts = defaults &amp; param \"key\" .~ [\"value\"]</code></p>\n\n<p>however what I'm struggling to do is adding a <em>list</em> of parameters at a time:</p>\n\n<p><code>params = [(\"key1\", \"value1\"), (\"key2\", \"value2\"), (\"key3\", \"value3\")]</code></p>\n\n<p>I know that there is function <code>params</code> but I could not find any example on how to use it.</p>\n"}, {"tags": ["json", "haskell", "generics", "aeson", "custom-data-type"], "answers": [{"comments": [{"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1456731026, "post_id": 35693562, "comment_id": 59065061, "body": "Thanks! that fixed it. and also thanks for editing my post."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 1, "creation_date": 1456731530, "post_id": 35693562, "comment_id": 59065272, "body": "one more thing. You will notice the &quot;id&quot; in <code>raw = &quot;{\\&quot;response\\&quot;:[{\\&quot;id\\&quot;:5977,\\&quot;brandId\\&quot;:87}]}&quot;</code> ; is it possible to overwrite part of the automatically derived instance? id is obviously reserved and the JSON that is retrieved has  &quot;id&quot;s in it and I would prefer not to us id in my data type."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1456731838, "post_id": 35693562, "comment_id": 59065422, "body": "@matthias I doubt you can do that. But I&#39;m not an expert of aeson. You may try to open a new question about that problem."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1456731885, "post_id": 35693562, "comment_id": 59065445, "body": "Thank you, I will do that."}], "tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": true, "score": 13, "last_activity_date": 1456728951, "creation_date": 1456728951, "answer_id": 35693562, "question_id": 35693520, "link": "https://stackoverflow.com/questions/35693520/automatically-deriving-instance-for-custom-data-type-with-aeson-json/35693562#35693562", "title": "Automatically deriving instance for custom data type with Aeson/JSON", "body": "<p>What the error is telling you is that you have to enable the <code>DeriveGeneric</code> extension in order for this to work. So you have to add:</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\n</code></pre>\n\n<p>right at the top of your file, or compile using the <code>-XDeriveGeneric</code> flag.</p>\n"}], "owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1365, "favorite_count": 2, "accepted_answer_id": 35693562, "answer_count": 1, "score": 2, "last_activity_date": 1456729064, "creation_date": 1456728715, "last_edit_date": 1456729064, "question_id": 35693520, "link": "https://stackoverflow.com/questions/35693520/automatically-deriving-instance-for-custom-data-type-with-aeson-json", "title": "Automatically deriving instance for custom data type with Aeson/JSON", "body": "<p>If I have a custom data type for parsing JSON with Aeson</p>\n\n<pre><code>data Response = Response\n    { response :: [Body]\n    } deriving (Show)\n\ninstance FromJSON Response where\n    parseJSON (Object v) = Response &lt;$&gt; v .: \"response\"\n    parseJSON _ = mzero\n\ndata Body = Body\n    { body_id               :: Int\n    , brandId               :: Int\n    } deriving (Show)\n\ninstance FromJSON Body where\n    parseJSON (Object v) = Body\n        &lt;$&gt; v .: \"id\"\n        &lt;*&gt; v .: \"brandId\"\n    parseJSON _ = mzero\n\nraw :: BS.ByteString\nraw = \"{\\\"response\\\":[{\\\"id\\\":5977,\\\"brandId\\\":87}]}\"\n</code></pre>\n\n<p>giving:</p>\n\n<pre><code>\u03bb&gt; decode raw :: Maybe Response\nJust (Response {response = [Body {body_id = 5977, brandId = 87}]})\n</code></pre>\n\n<p>How do I derive the instances for <code>FromJSON</code> automatically?</p>\n\n<p>I have tried:</p>\n\n<pre><code>data Response = Response\n    { response :: [Body]\n    } deriving (Show,Generic)\n\ndata Body = Body\n    { body_id               :: Int\n    , brandId               :: Int\n    } deriving (Show,Generic)\n\ninstance FromJSON Response\ninstance FromJSON Body\n</code></pre>\n\n<p>as has been suggested from some tutorials, but that gives:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>\u03bb&gt; :l response.hs\n[1 of 1] Compiling Response         ( response.hs, interpreted )\n\nresponse.hs:19:22:\n    Can't make a derived instance of `Generic Response':\n      You need DeriveGeneric to derive an instance for this class\n    In the data declaration for `Response'\n\nresponse.hs:24:22:\n    Can't make a derived instance of `Generic Body':\n      You need DeriveGeneric to derive an instance for this class\n    In the data declaration for `Body'\nFailed, modules loaded: none.\n</code></pre>\n\n<p>what am I doing wrong?</p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 1, "creation_date": 1456749584, "post_id": 35692972, "comment_id": 59075848, "body": "This is correct. The copy in <code>install</code> is placed there by calling the <code>Cabal</code> library&#39;s <code>copy</code> command, which is necessary when a library is present and will be registered (with the <code>register</code> command)."}, {"owner": {"reputation": 222, "user_id": 3438721, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/hc759.jpg?s=128&g=1", "display_name": "dacDave", "link": "https://stackoverflow.com/users/3438721/dacdave"}, "edited": false, "score": 0, "creation_date": 1456752813, "post_id": 35692972, "comment_id": 59078070, "body": "OK, I have now read the cabal user&#39;s guide section labeled &quot;Building and Installing Packages,&quot; and I am still not entirely clear. My goal here is to build a standalone executable on a virtual Ubuntu machine that is running on my Windows development machine and then copy and run the image on another Ubuntu server.  So which of these output executables should I copy to the target environment?  Thanks for the insights."}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 222, "user_id": 3438721, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/hc759.jpg?s=128&g=1", "display_name": "dacDave", "link": "https://stackoverflow.com/users/3438721/dacdave"}, "edited": false, "score": 0, "creation_date": 1456763899, "post_id": 35692972, "comment_id": 59086117, "body": "@dacDave - Both will work (I tried them), but the one in install/.... is the more &quot;complete&quot; one, so copy that."}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": true, "score": 5, "last_activity_date": 1456726146, "creation_date": 1456726146, "answer_id": 35692972, "question_id": 35692651, "link": "https://stackoverflow.com/questions/35692651/stack-build-creates-two-copies-of-the-output-executable/35692972#35692972", "title": "stack build creates two copies of the output executable", "body": "<p>I also had the same two executables created on my machine....  It was also a mystery for me, but I think I know the answer.</p>\n\n<p>After a little detective work, I found that the executable in ~/.stack-work/install/.... can be identically created from the executable in ~/.stack-work/dist/.... by running <a href=\"https://en.wikipedia.org/wiki/Strip_(Unix)\" rel=\"noreferrer\">strip</a>.  Therefore I believe it is pretty clear that dist/.... is one step in the process of creating the final simplified version, which is stored in install/.... (and later copied again to ~/.local/bin/).</p>\n"}], "owner": {"reputation": 222, "user_id": 3438721, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/hc759.jpg?s=128&g=1", "display_name": "dacDave", "link": "https://stackoverflow.com/users/3438721/dacdave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 1, "accepted_answer_id": 35692972, "answer_count": 1, "score": 3, "last_activity_date": 1456726146, "creation_date": 1456724251, "question_id": 35692651, "link": "https://stackoverflow.com/questions/35692651/stack-build-creates-two-copies-of-the-output-executable", "title": "stack build creates two copies of the output executable", "body": "<p>I am new to stack and not all that proficient with cabal.</p>\n\n<p>I have converted a cabal project to stack. It seems to be building fine. I like it so far.</p>\n\n<p>But I have observed something that I do not understand. When I execute a stack build command I see two output executables get created. Both are in the .stack-work path with one under dist and the other under install. They have radically different sizes. The file in the dist path is almost twice the size of the one in the install path.</p>\n\n<p>The only thing I can think of to explain this is the possibility that the executable file in the dist path includes (embeds within itself) all of the package dependencies required to run this code on a different machine (it is complete and ready for distribution to a different machine), while the file in the install path expects that it is running on the same machine where it was built and where those dependent libraries are installed external to the main application code.</p>\n\n<p>Does that make sense?</p>\n\n<p>Any alternative explanations?</p>\n\n<p>Dave Smith</p>\n"}, {"tags": ["haskell", "math", "vector", "transformation", "n-dimensional"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456723499, "post_id": 35691774, "comment_id": 59062353, "body": "do these even compile? Right now I do not see the neither the <i>sum-symbol</i> nor the <code>x</code> in scope if you look at the definition of <code>dot</code> - also: is this about implementation only or do you have trouble finding the math of said operations? If so can you add the expected signatures?"}, {"owner": {"reputation": 56, "user_id": 5864821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9ROlt.png?s=128&g=1", "display_name": "SANK", "link": "https://stackoverflow.com/users/5864821/sank"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456724104, "post_id": 35691774, "comment_id": 59062571, "body": "it should be:     sum . zipWith (*)  (fromVector v).\u2218 fromVector my editor defaults it to unicode sorry"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456724338, "post_id": 35691774, "comment_id": 59062646, "body": "well you should convince your editor to have a nicer copy&amp;paste behavior - still: are you looking for the math or do you have difficulties translating it?"}, {"owner": {"reputation": 56, "user_id": 5864821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9ROlt.png?s=128&g=1", "display_name": "SANK", "link": "https://stackoverflow.com/users/5864821/sank"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456724810, "post_id": 35691774, "comment_id": 59062810, "body": "I&#39;m having problems with both. I don&#39;t understand the maths (I&#39;ve looked at affine spaces, bivecotrs, ect... but none make sense currently)  and I wanted to see if there was a way of defining it in haskell as that&#39;s my entry point to mathematics  (+ need vectors to complete SICM)."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456725762, "post_id": 35691774, "comment_id": 59063127, "body": "for the math there is an <a href=\"https://math.stackexchange.com/questions/197772/generalized-rotation-matrix-in-n-dimensional-space-around-n-2-unit-vector\">nice answer on Math.Stackexchange</a>"}, {"owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 0, "creation_date": 1456748665, "post_id": 35691774, "comment_id": 59075287, "body": "Why are you trying so hard to use point-free style? That&#39;s really going to make your life harder."}, {"owner": {"reputation": 56, "user_id": 5864821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9ROlt.png?s=128&g=1", "display_name": "SANK", "link": "https://stackoverflow.com/users/5864821/sank"}, "edited": false, "score": 0, "creation_date": 1456818815, "post_id": 35691774, "comment_id": 59110602, "body": "The point free style is just to excersise my mind and it&#39;s easier to simplify the functions as everything has to be planned out properly. I&#39;ll write it with do notation and let bindings when I do the actual implementation with Data.Array.Unboxed as I want that to be clear."}], "answers": [{"tags": [], "owner": {"reputation": 181, "user_id": 1780578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca1dc16a4d53afa55da6ba0cbc68229?s=128&d=identicon&r=PG", "display_name": "B. Elliott", "link": "https://stackoverflow.com/users/1780578/b-elliott"}, "is_accepted": false, "score": -1, "last_activity_date": 1456723142, "creation_date": 1456723142, "answer_id": 35692448, "question_id": 35691774, "link": "https://stackoverflow.com/questions/35691774/how-to-define-n-dimensional-vector-rotation-and-reflection-in-haskell/35692448#35692448", "title": "how to define n-dimensional vector rotation and reflection in haskell?", "body": "<p>The mathematics should be able to get us most of the way here; a rotation in n-dimensional space can be thought of as a transformation based about an n-2 dimensional object (ie. a point on a plane, or a line in 3-space. Similarly, a reflection can be thought of as a transformation based around an n-1 dimensional object.</p>\n\n<p>You'll have trouble trying to define rotations for anything less than a 3d vector, and reflections in anything less than a 2d vector. The general approach may be to define a function of two parameters; one for the vector you're rotating, and one \"axis\" representation (a point for a 2d vector).</p>\n\n<p>Since the length of the vector (and the object it's transforming about)  is important in determining whether a rotation or reflection even make sense, this would be a good use case for dependent typing (you could specify the relative length of the vectors in the type signatures). Unfortunately, Haskell doesn't support that in full yet (though some experimental languages like Idris do), so your options amount to:</p>\n\n<ul>\n<li>Implement reflections and rotations as partial functions that fail when the sizes of the vectors are wrong,</li>\n<li>Implement a single more general function for transformations about any smaller dimensional \"axis\" (not actually sure if this is possible),</li>\n<li>Try a language with dependent types (if you want those guarantees of type safety, or</li>\n<li>Get creative with your implementations</li>\n</ul>\n\n<p>I'd say in most cases, Haskell's academic pedigree makes it useful for exploratory mathematics, but it ain't perfect yet.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 2181898, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000012220328/picture?type=large", "display_name": "Bert Sierra", "link": "https://stackoverflow.com/users/2181898/bert-sierra"}, "is_accepted": false, "score": 1, "last_activity_date": 1498611672, "creation_date": 1498611672, "answer_id": 44792116, "question_id": 35691774, "link": "https://stackoverflow.com/questions/35691774/how-to-define-n-dimensional-vector-rotation-and-reflection-in-haskell/44792116#44792116", "title": "how to define n-dimensional vector rotation and reflection in haskell?", "body": "<p>Regarding the mathematical aspects of n-dimensional rotations, I might recommend the publications of Andrew J. Hanson of the Computer Science Department of the University of Indiana.  In particular:</p>\n\n<p>\u201cRotations for N-Dimensional Computer Graphics\u201d\n<a href=\"https://www.cs.indiana.edu/pub/techreports/TR406.pdf\" rel=\"nofollow noreferrer\">https://www.cs.indiana.edu/pub/techreports/TR406.pdf</a></p>\n\n<p>That paper is a successor to \u201cGeometry for N-Dimensional Computer Graphics\u201d\n<a href=\"https://classes.soe.ucsc.edu/cmps161/Winter14/papers/pv/ggndgeom.pdf\" rel=\"nofollow noreferrer\">https://classes.soe.ucsc.edu/cmps161/Winter14/papers/pv/ggndgeom.pdf</a></p>\n\n<p>The mathematics require a knowledge of vector arithmetic and linear algebra, but if you\u2019re going to be performing N-dimensional transformations, this is the recommended way to do the math.</p>\n"}], "owner": {"reputation": 56, "user_id": 5864821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9ROlt.png?s=128&g=1", "display_name": "SANK", "link": "https://stackoverflow.com/users/5864821/sank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1498611672, "creation_date": 1456718536, "last_edit_date": 1456724538, "question_id": 35691774, "link": "https://stackoverflow.com/questions/35691774/how-to-define-n-dimensional-vector-rotation-and-reflection-in-haskell", "title": "how to define n-dimensional vector rotation and reflection in haskell?", "body": "<p>How do I define vector rotation and reflection in general where the function would work in <em>n</em> dimensions in Haskell?</p>\n\n<p>Currently I have the dot product, normalization and projection done but stuck on reflection and rotation.</p>\n\n<pre><code>data Vector s a = Vector {len::s,arr::a}\n\nnormalize :: Vector s a \u2192 Vector s a\nnormalize =  toVector . uncurry (zipWith (/))\n                      . (id&amp;&amp;&amp;(repeat . sqrt . sum . map (^2)))\n                      . fromVector\n\ndot        :: Vector s a \u2192 Vector s a \u2192 a\ndot v = sum \u2218 zipWith (*) (fromVector v) \u2218 fromVector\n\nproject    :: Vector s a \u2192 Vector s a \u2192 Vector s a\nproject v = toVector \u2218 uncurry (zipWith (*))\n                     \u2218 (fromVector&amp;&amp;&amp;(repeat \u2218 (v`dot`)))\n</code></pre>\n\n<p>I've been searhing for days now but it seems that using Haskell to understand mathematics can sometimes cause problems when there is no clear code (or no code at all) and the only tutorials on n-dimensional vectors go past my knowledge in mathematics.</p>\n"}, {"tags": ["haskell", "cabal", "haskell-diagrams"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1456709427, "post_id": 35690532, "comment_id": 59058956, "body": "cabal-install is reinstalling bytes because it depends on binary; binary\u2019s version is being changed from 0.8 to 0.6 because linear depends on binary&lt;0.8. bytes is apparently misreporting its binary dependency because it\u2019s using functions that aren\u2019t present in 0.6. (Welcome to Haskell!) Try explicitly installing previous versions of bytes (0.15, 0.15.0.1, 0.15.1); since the maintainers of linear have set bytes&gt;=0.15, it must not have always been broken."}, {"owner": {"reputation": 12714, "user_id": 505306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TjIHR.png?s=128&g=1", "display_name": "smilingbuddha", "link": "https://stackoverflow.com/users/505306/smilingbuddha"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1456709775, "post_id": 35690532, "comment_id": 59059026, "body": "@RyanO&#39;Hara Thank you for the response! Can you tell me how to do that? Do I need to modify my cabal command to install diagrams for this?"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1456709823, "post_id": 35690532, "comment_id": 59059036, "body": "<code>cabal install bytes==0.15.1 diagrams</code> should do it."}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 2, "creation_date": 1456710012, "post_id": 35690532, "comment_id": 59059081, "body": "You can also use stack to install diagrams; it&#39;s just <code>stack install diagrams</code>. Cabal-install is lovely in many ways, but it often breaks in the face of older packages with loose bounds. (If you do stick with cabal-install, I also recommend that you use a sandbox.) <a href=\"https://github.com/commercialhaskell/stack\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack</a>"}, {"owner": {"reputation": 12714, "user_id": 505306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TjIHR.png?s=128&g=1", "display_name": "smilingbuddha", "link": "https://stackoverflow.com/users/505306/smilingbuddha"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1456710401, "post_id": 35690532, "comment_id": 59059159, "body": "@RyanO&#39;Hara Nope! Got the same error message with 0.15.1 in place of 0.15.2"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1456710598, "post_id": 35690532, "comment_id": 59059202, "body": "@smilingbuddha: So try 0.15.0.1, then 0.15."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "reply_to_user": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1456768891, "post_id": 35690532, "comment_id": 59089275, "body": "@haoformayor I think the underlying problem here is that the user is running ghc 7.6. Stackage isn&#39;t compat with that stuff -- the advantage for the user with stack would just be that it would install a more recent ghc..."}], "owner": {"reputation": 12714, "user_id": 505306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TjIHR.png?s=128&g=1", "display_name": "smilingbuddha", "link": "https://stackoverflow.com/users/505306/smilingbuddha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476901459, "creation_date": 1456709020, "last_edit_date": 1476901459, "question_id": 35690532, "link": "https://stackoverflow.com/questions/35690532/how-to-fix-these-cabal-installation-errors-while-installing-diagrams", "title": "How to fix these cabal installation errors while installing diagrams?", "body": "<p>I am trying to install the diagrams package written in haskell using Cabal. \nI get the following errors when I run <code>cabal install diagrams</code></p>\n\n<pre><code>[~]$ cabal install diagrams\nResolving dependencies...\nIn order, the following will be installed:\nbytes-0.15.2 (via: linear-1.20.4) (reinstall) (changes: binary-0.8.2.1 -&gt; 0.6.4.0)\nlinear-1.20.4 (via: diagrams-contrib-1.3.0.8 force-layout-0.4.0.3 diagrams-lib-1.3.1.1 diagrams-core-1.3.0.6 active-0.2.0.8) (new package)\nactive-0.2.0.8 (via: diagrams-lib-1.3.1.1) (new package)\ndiagrams-core-1.3.0.6 (via: diagrams-1.3.0.1 diagrams-contrib-1.3.0.8 diagrams-svg-1.4 diagrams-lib-1.3.1.1) (new package)\ndiagrams-lib-1.3.1.1 (via: diagrams-1.3.0.1 diagrams-contrib-1.3.0.8 diagrams-svg-1.4) (new package)\ndiagrams-svg-1.4 (via: diagrams-1.3.0.1) (new package)\nforce-layout-0.4.0.3 (via: diagrams-contrib-1.3.0.8) (new package)\ndiagrams-contrib-1.3.0.8 (via: diagrams-1.3.0.1) (new package)\ndiagrams-1.3.0.1 (new package)\nWarning: Note that reinstalls are always dangerous. Continuing anyway...\n[1 of 1] Compiling Main             ( /tmp/cabal-tmp-12921/bytes-0.15.2/dist/setup/setup.hs, /tmp/cabal-tmp-12921/bytes-0.15.2/dist/setup/Main.o )\nLinking /tmp/cabal-tmp-12921/bytes-0.15.2/dist/setup/setup ...\nConfiguring bytes-0.15.2...\nBuilding bytes-0.15.2...\nPreprocessing library bytes-0.15.2...\n[1 of 5] Compiling Data.Bytes.Signed ( src/Data/Bytes/Signed.hs, dist/build/Data/Bytes/Signed.o )\n[2 of 5] Compiling Data.Bytes.VarInt ( src/Data/Bytes/VarInt.hs, dist/build/Data/Bytes/VarInt.o )\n[3 of 5] Compiling Data.Bytes.Put   ( src/Data/Bytes/Put.hs, dist/build/Data/Bytes/Put.o )\n[4 of 5] Compiling Data.Bytes.Get   ( src/Data/Bytes/Get.hs, dist/build/Data/Bytes/Get.o )\n\nsrc/Data/Bytes/Get.hs:205:15:\n    Not in scope: `B.lookAhead'\n    Perhaps you meant one of these:\n      `S.lookAhead' (imported from Data.Serialize.Get),\n      `S.lookAheadM' (imported from Data.Serialize.Get),\n      `S.lookAheadE' (imported from Data.Serialize.Get)\n\nsrc/Data/Bytes/Get.hs:207:16:\n    Not in scope: `B.lookAheadM'\n    Perhaps you meant one of these:\n      `S.lookAheadM' (imported from Data.Serialize.Get),\n      `S.lookAhead' (imported from Data.Serialize.Get),\n      `S.lookAheadE' (imported from Data.Serialize.Get)\n\nsrc/Data/Bytes/Get.hs:209:16:\n    Not in scope: `B.lookAheadE'\n    Perhaps you meant one of these:\n      `S.lookAheadE' (imported from Data.Serialize.Get),\n      `S.lookAhead' (imported from Data.Serialize.Get),\n      `S.lookAheadM' (imported from Data.Serialize.Get)\nFailed to install bytes-0.15.2\ncabal: Error: some packages failed to install:\nactive-0.2.0.8 depends on bytes-0.15.2 which failed to install.\nbytes-0.15.2 failed during the building phase. The exception was:\nExitFailure 1\ndiagrams-1.3.0.1 depends on bytes-0.15.2 which failed to install.\ndiagrams-contrib-1.3.0.8 depends on bytes-0.15.2 which failed to install.\ndiagrams-core-1.3.0.6 depends on bytes-0.15.2 which failed to install.\ndiagrams-lib-1.3.1.1 depends on bytes-0.15.2 which failed to install.\ndiagrams-svg-1.4 depends on bytes-0.15.2 which failed to install.\nforce-layout-0.4.0.3 depends on bytes-0.15.2 which failed to install.\nlinear-1.20.4 depends on bytes-0.15.2 which failed to install.\n</code></pre>\n\n<p>I have installed bytes-0.15.2 separately with cabal using the command \n<code>cabal install bytes</code>. What could be going wrong? When installing diagrams cabal seems to be needlessly trying to install bytes again. </p>\n\n<p>What can I do to fix these compilation errors? </p>\n\n<p>I am running this on an Ubuntu 14.04 with ghc version 7.6.3 and cabal version 1.22.7.0</p>\n"}, {"tags": ["haskell", "command", "history", "haskell-prelude"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 3, "creation_date": 1456707430, "post_id": 35690333, "comment_id": 59058457, "body": "Do you mean in GHCi?"}], "answers": [{"comments": [{"owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "edited": false, "score": 0, "creation_date": 1456711246, "post_id": 35690346, "comment_id": 59059348, "body": "I don&#39;t seem to have a hidden .ghc under my home directory. Do I have to setup Prelude to make it record my commands?"}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "edited": false, "score": 1, "creation_date": 1456717716, "post_id": 35690346, "comment_id": 59060791, "body": "What OS are you using?  I actually found the file in question by typing something large and unique in ghci, then doing a grep for that word at the command line....  You could also do a &quot;locate ghci_history&quot;, or even &quot;find . | grep ghci_history&quot; in your home directory."}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": true, "score": 4, "last_activity_date": 1456707419, "creation_date": 1456707419, "answer_id": 35690346, "question_id": 35690333, "link": "https://stackoverflow.com/questions/35690333/haskell-how-to-view-command-history-inside-prelude/35690346#35690346", "title": "Haskell: how to view command history inside &quot;Prelude&quot;?", "body": "<p>Mine appears at ~/.ghc/ghci_history, although depending on your machine, it could be at a different place.</p>\n"}], "owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 35690346, "answer_count": 1, "score": 0, "last_activity_date": 1512974097, "creation_date": 1456707315, "last_edit_date": 1512974097, "question_id": 35690333, "link": "https://stackoverflow.com/questions/35690333/haskell-how-to-view-command-history-inside-prelude", "title": "Haskell: how to view command history inside &quot;Prelude&quot;?", "body": "<p>Hello: I wish to list all historical command in Prelude, in the way that any unix shell could in \"history\" command. I tried several guesses but failed. How can I do that?</p>\n"}, {"tags": ["parsing", "haskell", "let"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1456706634, "post_id": 35690218, "comment_id": 59058261, "body": "Type signatures can appear on the own line (in let, where, or top level declarations) or in expressions.  Type signatures are not for the left hand side of a binding."}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 0, "creation_date": 1456709633, "post_id": 35690218, "comment_id": 59059001, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/8443035/multi-line-commands-in-ghci\">Multi-line commands in GHCi</a>"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1456711855, "post_id": 35690218, "comment_id": 59059477, "body": "&quot;How to correct it?&quot; - the error says how - &quot;Perhaps you intended to use ScopedTypeVariables&quot;. Enable ScopedTypeVariables in ghci with <code>:set -XScopedTypeVariables</code>. That is, if you want to use this particular syntax."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1456757705, "post_id": 35690218, "comment_id": 59081553, "body": "I came here thinking somebody wanted to put a <code>type</code> declaration inside a <code>let</code> block. I just went to check the Report to see if you can legally do that... You can&#39;t. (You <i>can</i>, however, put a fixity declaration in there... Weird, eh?)"}], "answers": [{"tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": true, "score": 5, "last_activity_date": 1456707290, "creation_date": 1456707290, "answer_id": 35690329, "question_id": 35690218, "link": "https://stackoverflow.com/questions/35690218/how-do-i-define-a-value-with-type-in-haskells-let-expression/35690329#35690329", "title": "How do I define a value with &quot;type&quot; in Haskell&#39;s &quot;let&quot; expression?", "body": "<p>This will do it</p>\n\n<pre><code>let x = 1::Int\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "is_accepted": false, "score": 6, "last_activity_date": 1456709614, "last_edit_date": 1495540017, "creation_date": 1456709614, "answer_id": 35690595, "question_id": 35690218, "link": "https://stackoverflow.com/questions/35690218/how-do-i-define-a-value-with-type-in-haskells-let-expression/35690595#35690595", "title": "How do I define a value with &quot;type&quot; in Haskell&#39;s &quot;let&quot; expression?", "body": "<p>In a Haskell file, type declarations are provided separately from definitions, usually on the line before:</p>\n\n<pre><code>c :: Int    -- Type declaration\nc = 4       -- Definition\n</code></pre>\n\n<p>This holds true for local definitions, as well as global ones; you just need to make sure the indentation lines up.  So in that case, we have</p>\n\n<pre><code>let c :: Int\n    c = 4\nin c + c\n</code></pre>\n\n<p>In Haskell, newlines and indentation can be replaced with braces and semicolons, and sometimes the braces can be elided.  In GHCi, where entering multiple-line input requires <a href=\"https://stackoverflow.com/q/8443035/237428\">some extra machinery</a>, you'll usually want the semicolon-separated variant; to wit, that'll be</p>\n\n<pre><code>let c :: Int ; c = 4\n</code></pre>\n\n<p>(The lack of an <code>in</code> is because GHCi behaves a bit like a <code>do</code> block; <a href=\"https://stackoverflow.com/q/8274650/237428\">this Stack Overflow question</a> has more information.)</p>\n\n<p>However, it looks from your prompt like you have <code>:set +m</code> turned on, so you can use the multi-line option too:</p>\n\n<pre><code>Prelude&gt; let c :: Int\nPrelude|     c = 4\nPrelude|\nPrelude&gt;\n</code></pre>\n\n<p>(Also, if you want to add a type annotation afterward, <code>let c = 4 ; c :: Int</code> works fine; it's just not the best style for a file you're working on.)</p>\n\n<hr>\n\n<p>Also, an important note: you aren't using \"Prelude\", you're using <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html#idp46760125594256\" rel=\"nofollow noreferrer\">GHCi</a>, GHC's interactive Haskell environment.  <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html\" rel=\"nofollow noreferrer\"><code>Prelude</code></a> is the module that is imported by default in all Haskell programs (it provides the definitions of <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#t:Bool\" rel=\"nofollow noreferrer\"><code>Bool</code></a>, <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#t:Eq\" rel=\"nofollow noreferrer\"><code>Eq</code></a>, <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:.\" rel=\"nofollow noreferrer\"><code>(.)</code></a>, and so on).  GHCi's default prompt contains the list of all modules currently imported, so by default it's <code>Prelude&gt;</code>; however, if you type <code>import Data.Function</code>, the prompt will change to <code>Prelude Data.Function&gt;</code>.</p>\n"}], "owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1010, "favorite_count": 0, "accepted_answer_id": 35690329, "answer_count": 2, "score": 1, "last_activity_date": 1456709614, "creation_date": 1456706530, "question_id": 35690218, "link": "https://stackoverflow.com/questions/35690218/how-do-i-define-a-value-with-type-in-haskells-let-expression", "title": "How do I define a value with &quot;type&quot; in Haskell&#39;s &quot;let&quot; expression?", "body": "<p>I was trying to define a value with specific type like \"Int\", but seems Prelude doesn't support it? </p>\n\n<pre><code>Prelude&gt; let c::Int = 4\nPrelude| \n\n&lt;interactive&gt;:49:8:\n    Illegal type signature: \u2018Int\u2019\n      Perhaps you intended to use ScopedTypeVariables\n    In a pattern type-signature\nPrelude&gt; let [Int]c=4\nPrelude| \n\n&lt;interactive&gt;:51:5: Parse error in pattern: [Int]\n</code></pre>\n\n<p>How to correct it?</p>\n"}, {"tags": ["haskell", "lazy-evaluation", "evaluation", "eager"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1456706705, "post_id": 35690203, "comment_id": 59058276, "body": "Haskell doesn&#39;t the concept of &quot;variables&quot;. Names for values are not the same thing as variables."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 3, "creation_date": 1456707472, "post_id": 35690203, "comment_id": 59058470, "body": "@JohnColeman, I beg to differ. A variable in Haskell is like a variable in mathematics, not like a variable in a typical imperative language."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456707645, "post_id": 35690203, "comment_id": 59058524, "body": "@dfeuer Fair enough -- but I find thinking of Haskell identifiers as being names is a good way to emphasize how they differ from the usual notion of mutable variables in most programming languages"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1456707842, "post_id": 35690203, "comment_id": 59058580, "body": "@JohnColeman, in fact, many are familiar with C-like <code>const</code> declarations, which make things similar to haskell variables."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1456708430, "post_id": 35690203, "comment_id": 59058728, "body": "And no, not everything is a function in Haskell. See <a href=\"http://conal.net/blog/posts/everything-is-a-function-in-haskell\" rel=\"nofollow noreferrer\">conal.net/blog/posts/everything-is-a-function-in-haskell</a>"}], "owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 1, "closed_date": 1456707667, "answer_count": 0, "score": 0, "last_activity_date": 1505485781, "creation_date": 1456706420, "last_edit_date": 1505485781, "question_id": 35690203, "link": "https://stackoverflow.com/questions/35690203/is-haskells-variable-eager-evaluated", "closed_reason": "Duplicate", "title": "Is Haskell&#39;s &quot;variable&quot; eager evaluated?", "body": "<p>I define a value \"x\" to be 2 </p>\n\n<pre><code>Prelude&gt; let x=2\nPrelude&gt; :sprint x\nx = _\nPrelude&gt; show x\n\"2\"\nPrelude&gt; :sprint x\nx = _\nPrelude&gt; x\n2\nPrelude&gt; :sprint x\nx = _\n</code></pre>\n\n<ol>\n<li>Does Haskell uses the concept \"variable\" at all? In FP like Haskell, everything is a function, but is \"x\" a function?</li>\n<li>if \"let x=2\" is only a name binding, without evaluation, and then \"x\" command shows \"2\", so it has been evaluated right? Why \":sprint x\" still prints \"_\"?</li>\n</ol>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1456703563, "post_id": 35689788, "comment_id": 59057537, "body": "Do you actually need <code>AgentSpec Java</code> and <code>AgentSpec Php</code> to be distinct types? You could just do <code>data Handler = Java | Php</code>"}, {"owner": {"reputation": 1105, "user_id": 241601, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/aceccfd23c96ea1522106f06da01bdad?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/241601/jay"}, "reply_to_user": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1456703811, "post_id": 35689788, "comment_id": 59057604, "body": "@SebastianRedl I&#39;m writing it as a library. So If someone were to use my library, wouldn&#39;t it be easier for them to just create their own type instead of messing with the abstractions used in the library? Because if I do as you suggested, then they will have to modify the library by adding their custom <code>Handler</code> with <code>data Handler = Java | Php | Custom</code>"}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 1, "creation_date": 1456703958, "post_id": 35689788, "comment_id": 59057645, "body": "See <a href=\"https://wiki.haskell.org/Existential_type#Dynamic_dispatch_mechanism_of_OOP\" rel=\"nofollow noreferrer\">wiki.haskell.org/&hellip;</a>"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 2, "creation_date": 1456706009, "post_id": 35689788, "comment_id": 59058130, "body": "On a side note I would use <code>data AgentSpec a = AS {events :: [ByteString]} deriving (Show)</code> with <code>a</code> being a phantom type so you don&#39;t have to drag the agent parameter around."}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 1, "creation_date": 1456742799, "post_id": 35689788, "comment_id": 59071736, "body": "If the definition is really something like <code>allEvents aspec = concatMap events aspec</code>, then the application of every call to <code>events</code> must be independent i.e. do not rely on any additional information but a single <code>AgentSpec</code>, so why you need such a function in your library at first place?"}], "answers": [{"comments": [{"owner": {"reputation": 1105, "user_id": 241601, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/aceccfd23c96ea1522106f06da01bdad?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/241601/jay"}, "edited": false, "score": 0, "creation_date": 1456713226, "post_id": 35689910, "comment_id": 59059763, "body": "this could work but is this an idiomatic way to accomplish this? Meaning, would a professional Haskeller, with the same problem, choose your solution as a possible way to solve the problem?"}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": false, "score": 2, "last_activity_date": 1456705423, "last_edit_date": 1456705423, "creation_date": 1456703916, "answer_id": 35689910, "question_id": 35689788, "link": "https://stackoverflow.com/questions/35689788/overcoming-limitation-with-polymorphic-type-in-haskell/35689910#35689910", "title": "Overcoming limitation with polymorphic type in haskell", "body": "<p>There are some techniques to <a href=\"https://wiki.haskell.org/Heterogenous_collections\" rel=\"nofollow\">implement heterogenous lists in Haskell</a>. One thing you can do is:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n\ndata SomeAgentSpec where\n    SAS :: AgentSpec a -&gt; SomeAgentSpec\n\nallEvents :: [SomeAgentSpec] -&gt; [ByteString]\nallEvents aspec = concatMap ev aspec\n    where ev (SAS a) = events a\n</code></pre>\n\n<p>then, </p>\n\n<pre><code>\\&gt; let a = AgentSpec Java [\"1.\", \"java\"]\n\\&gt; let b = AgentSpec Php  [\"2.\", \"php\" ]\n\\&gt; allEvents [SAS a, SAS b]\n[\"1.\",\"java\",\"2.\",\"php\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1105, "user_id": 241601, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/aceccfd23c96ea1522106f06da01bdad?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/241601/jay"}, "edited": false, "score": 0, "creation_date": 1456704286, "post_id": 35689921, "comment_id": 59057724, "body": "The library is very simple. This is all it does. You give me a CSV file and an <code>AgentSpec</code>. I will read the CSV file and get only those columns specified in the <code>events</code> field of the <code>AgentSpec</code>. It&#39;s a very simple thing to do I&#39;m sure. I&#39;m using this as an exercise to learn how to build libraries in Haskell. I&#39;m beginning to realize that writing binaries and libraries are slightly different, because in the case of a library you have to provide the user of your library with an appropriate abstraction. Whereas this is not required for a binary that you simply run."}, {"owner": {"reputation": 1105, "user_id": 241601, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/aceccfd23c96ea1522106f06da01bdad?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/241601/jay"}, "edited": false, "score": 0, "creation_date": 1456713074, "post_id": 35689921, "comment_id": 59059733, "body": "In the example you gave, if the user of my library wants to create a new constructor for the <code>Language</code> type, the user will have to edit the library source. That is what I am trying to avoid."}], "tags": [], "owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "is_accepted": false, "score": 3, "last_activity_date": 1456703981, "creation_date": 1456703981, "answer_id": 35689921, "question_id": 35689788, "link": "https://stackoverflow.com/questions/35689788/overcoming-limitation-with-polymorphic-type-in-haskell/35689921#35689921", "title": "Overcoming limitation with polymorphic type in haskell", "body": "<p>This code:</p>\n\n<pre><code>allEvents [AgentSpec Java [\"event1, \"event2\"], AgentSpec Php [\"event3, \"event4\"]]\n</code></pre>\n\n<p>doesn't compile because <code>AgentSpec Java [\"event1, \"event2\"]</code> and <code>AgentSpec Php [\"event3\", \"event4\"]</code>are of different types, and lists in Haskell can only contain one type. An <code>AgentSpec a [ByteString]</code> can be created for any type <code>a</code>, but once created it can't be mixed with values of a different type.</p>\n\n<p>I don't know what exactly you're modeling, but typically I'd recommend something like this:</p>\n\n<pre><code>data Language = Java | Php\n\ndata AgentSpec = AgentSpec \n                     { agent :: Language\n                     , events :: [ByteString] \n                     } deriving (Show)\n\nallEvents = [AgentSpec Java [\"event1\", \"event2\"], AgentSpec Php [\"event3\", \"event4\"]]\n</code></pre>\n\n<p>Based on your comment about writing a library, though, it doesn't sound like this would work. Can you elaborate on what you're trying to achieve?</p>\n"}], "owner": {"reputation": 1105, "user_id": 241601, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/aceccfd23c96ea1522106f06da01bdad?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/241601/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1456705423, "creation_date": 1456703121, "question_id": 35689788, "link": "https://stackoverflow.com/questions/35689788/overcoming-limitation-with-polymorphic-type-in-haskell", "title": "Overcoming limitation with polymorphic type in haskell", "body": "<p>I have a type like so,</p>\n\n<pre><code>data AgentSpec a = AgentSpec \n                     { agent :: a\n                     , events :: [ByteString] \n                     } deriving (Show)\n</code></pre>\n\n<p>and other types like so,</p>\n\n<pre><code>data Java = Java\ndata Php = Php\n</code></pre>\n\n<p>I am trying to create a function of type,</p>\n\n<pre><code>allEvents :: [AgentSpec a] -&gt; [ByteString]\nallEvents aspec = concatMap events aspec\n</code></pre>\n\n<p>But I am unable to create values of type <code>[AgentSpec a]</code></p>\n\n<p>If I do,</p>\n\n<pre><code>allEvents [AgentSpec Java [\"event1, \"event2\"], AgentSpec Php [\"event3, \"event4\"]]\n</code></pre>\n\n<p>it does not typecheck and understandably so. It doesn't type check because, <code>AgentSpec Java</code> is not <code>AgentSpec a</code></p>\n\n<p>So I understand why it does not work. But I do not know how to overcome this limitation without writing a lot of duplicate code.</p>\n\n<p>One alternatve is to manually construct a list of type,</p>\n\n<pre><code>allEvents :: [ByteString]\nallEvents = [\"event1\", \"event2\", \"event3\", \"event4\"].\n</code></pre>\n\n<p>But I feel like I'm simply rewriting things I've already modelled in my types. Is there any way to make use of my existing types to get what I want? Which is just a concatenated list of bytestrings of all the AgentSpecs</p>\n"}, {"tags": ["haskell", "unicode", "bytestring"], "comments": [{"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1456699322, "post_id": 35689193, "comment_id": 59056251, "body": "Is this Windows? The Windows console has very poor support for Unicode, especially UTF-8."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1456699344, "post_id": 35689193, "comment_id": 59056260, "body": "no i am on a linux (mint), and if i work on windows i use a virtual linux"}, {"owner": {"reputation": 695068, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 0, "creation_date": 1456699355, "post_id": 35689193, "comment_id": 59056267, "body": "What charset did you save the file in?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1456699406, "post_id": 35689193, "comment_id": 59056293, "body": "vim says encoding is utf-8"}, {"owner": {"reputation": 695068, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 1, "creation_date": 1456699461, "post_id": 35689193, "comment_id": 59056310, "body": "I think Haskell is choking on the characters internally, since it&#39;s returning the last byte of the characters encoded as UTF-16 (or first as UTF-16LE)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1456700956, "post_id": 35689193, "comment_id": 59056782, "body": "Could not reproduce: on my machine, all the bytes are correctly sent to the terminal for the first line, and the &quot;p&quot; of the second line appears correctly. What version of GHC, what terminal, and what is your locale? It is possible, but in my opinion less likely, that library versions may play a role as well."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1456701024, "post_id": 35689193, "comment_id": 59056808, "body": "To rule out the possibility that this is a terminal thing, you could try <code>myprogram | xxd</code>, which will show which bytes your program is outputting in an ASCII-clean format."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1456771565, "post_id": 35689193, "comment_id": 59090915, "body": "As I suspected, from the xxd output you can see that all the correct bytes are getting sent -- this is a terminal problem."}], "answers": [{"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1456706482, "post_id": 35690177, "comment_id": 59058243, "body": "this only answers my question in parts - why does the <i>p</i> on the next line is not printed, but thanks for enlighten me on the behavior of <code>fromString</code> - i kind of suspected something like this."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1456771612, "post_id": 35690177, "comment_id": 59090945, "body": "&quot;It is not a terminal problem&quot; -- yes it is. His program is printing all the bytes he expected it to print (namely, the bytes of the first line and the <code>p</code> of the second line), but the terminal isn&#39;t showing him those bytes."}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1456771825, "post_id": 35690177, "comment_id": 59091079, "body": "@DanielWagner - I am assuming that he wants the output to be utf8, and that the terminal is correct....  But you are correct, it could be the other way around, the program had the correct encoding, and he could set the terminal to that encoding (not sure what default encoding it was using).  At any rate, I think my assumption was correct, because converting to utf8 fixed his problem."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1456772107, "post_id": 35690177, "comment_id": 59091272, "body": "@jamshidh Yeah, perhaps it&#39;s just best to say the two things (program+terminal) didn&#39;t agree in the expected way, and leave it at that without trying to sort out which one to blame. =P"}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": true, "score": 1, "last_activity_date": 1456707067, "last_edit_date": 1456707067, "creation_date": 1456706147, "answer_id": 35690177, "question_id": 35689193, "link": "https://stackoverflow.com/questions/35689193/console-output-of-bytestrings-deletes-first-character-of-next-line/35690177#35690177", "title": "Console Output of bytestrings - deletes first character of next line", "body": "<p>It is not a terminal problem, rather, the problem happens early in the conversion to ByteString.  Remember, because you used OverloadedStrings</p>\n\n<pre><code>inputB = \"\u0414\u0415\u0416\u0417\u0418\u0419\u041a\u041b\u041c\u041d\u041e\u041f\u0420\u0421\u0422\u0423\u0424\"\n</code></pre>\n\n<p>is really shorthand for</p>\n\n<pre><code>inputB = fromString \"\u0414\u0415\u0416\u0417\u0418\u0419\u041a\u041b\u041c\u041d\u041e\u041f\u0420\u0421\u0422\u0423\u0424\"::ByteString\n</code></pre>\n\n<p>which does not convert to a bytestring using UTF8.</p>\n\n<p>If, instead, you want the bytestring to contain utf8 encoded chars, use</p>\n\n<pre><code>import qualified Data.ByteString.UTF8 as BU\n\ninputB = BU.fromString \"\u0414\u0415\u0416\u0417\u0418\u0419\u041a\u041b\u041c\u041d\u041e\u041f\u0420\u0421\u0422\u0423\u0424\"\n</code></pre>\n\n<p>then this will work</p>\n\n<pre><code>B.putStrLn inputB\n</code></pre>\n\n<hr>\n\n<p>Why is the \"p\" on line two missing?</p>\n\n<p>I won't go into detail (because I don't know them), but the behavior is expected....  Because your terminal is expecting UTF8, and the Russian string is not UTF8.</p>\n\n<p>UTF8 uses variable length byte character encodings....  Depending on the first byte in a char, it might expect more.  Clearly the last byte in the Russian string started a UTF8 encoding that required more bytes, and the \"p\" was read in to that char.  Your terminal seems to just ignore chars it can't print (mine prints garbage), so both the Russian string and the next char were lost.</p>\n\n<p>You will note that the \"p\" is in the xxd output....  The terminal just considering it to be part of the unknown chars and not printing it.</p>\n"}, {"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1456758995, "post_id": 35701946, "comment_id": 59082525, "body": "In general handling textual information that is not ascii, I agree using <code>Text</code> is the best and safest choice."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1456755794, "creation_date": 1456755794, "answer_id": 35701946, "question_id": 35689193, "link": "https://stackoverflow.com/questions/35689193/console-output-of-bytestrings-deletes-first-character-of-next-line/35701946#35701946", "title": "Console Output of bytestrings - deletes first character of next line", "body": "<p>Quoting from the documentation of <a href=\"http://hackage.haskell.org/package/bytestring-0.10.6.0/docs/Data-ByteString-Char8.html\" rel=\"nofollow\"><code>Data.ByteString.Char8</code></a>\n(emphasis mine)</p>\n\n<blockquote>\n  <p>Manipulate ByteStrings using Char operations. <strong>All Chars will be\n  truncated to 8 bits.</strong> It can be expected that these functions will run\n  at identical speeds to their Word8 equivalents in Data.ByteString.</p>\n  \n  <p>More specifically these byte strings are taken to be in the subset of\n  Unicode covered by code points 0-255. This covers Unicode Basic Latin,\n  Latin-1 Supplement and C0+C1 Controls.</p>\n</blockquote>\n\n<p>Cyrillic is not allocated in code points 0x00-0xFF, so encoding issues are to be expected.</p>\n\n<p>I would recommend <em>against</em> <code>Data.ByteString.Char8</code> unless you are dealing with plain ASCII. Even if latin-1 encoded texts may work in certain environment, the latin-1 encoding is obsolescent and should die.</p>\n\n<p>For handling general strings, use <code>Data.Text</code> instead. Conversion functions from <code>ByteString</code>s to <code>Text</code>, and vice versa, <a href=\"http://hackage.haskell.org/package/text-1.2.2.0/docs/Data-Text-Encoding.html\" rel=\"nofollow\">are provided</a>. Of course, these functions have to depend on some encoding.</p>\n"}], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 35690177, "answer_count": 2, "score": 0, "last_activity_date": 1456755794, "creation_date": 1456699124, "last_edit_date": 1456701347, "question_id": 35689193, "link": "https://stackoverflow.com/questions/35689193/console-output-of-bytestrings-deletes-first-character-of-next-line", "title": "Console Output of bytestrings - deletes first character of next line", "body": "<p>Answering <a href=\"https://stackoverflow.com/questions/35687685/haskell-convert-unicode-sequence-to-utf-8\">haskell-convert-unicode-sequence-to-utf-8</a> I came upon some strange behaviour of <code>ByteString.putStrLn</code></p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nmodule Main where\n\nimport           Data.Text (Text)\nimport           Data.ByteString (ByteString)\nimport qualified Data.ByteString.Char8 as B\n\n\ninputB, inputB' :: ByteString\ninputB = \"\u0414\u0415\u0416\u0417\u0418\u0419\u041a\u041b\u041c\u041d\u041e\u041f\u0420\u0421\u0422\u0423\u0424\"\ninputB' = \"test\"\n\n\nmain :: IO ()\nmain = do putStr \"B.putStrLn inputB: \"; B.putStrLn inputB\n          putStr \"print inputB: \"; print inputB\n          putStr \"B.putStrLn inputB': \"; B.putStrLn inputB'\n          putStr \"print inputB': \"; print inputB'\n</code></pre>\n\n<p>which yields </p>\n\n<pre><code>B.putStrLn inputB:\nrint inputB: \"\\DC4\\NAK\\SYN\\ETB\\CAN\\EM\\SUB\\ESC\\FS\\GS\\RS\\US !\\\"#$\"\nB.putStrLn inputB': test\nprint inputB': \"test\"\n</code></pre>\n\n<p>what I do not understand here is - why the first output line is missing <em>and</em> the <em>p</em> in print on the second line is missing.</p>\n\n<p>My guess would be that this has something to do with the russian letters leading to malformed input. Because with the simple case of \"test\" it just works.</p>\n\n<hr>\n\n<h2>Edit</h2>\n\n<ul>\n<li>Platform: Linux Mint 17.3</li>\n<li>file-encoding: UTF-8</li>\n<li>terminal: gnome-terminal/tmux/zsh</li>\n<li>ghc: 7.10.3</li>\n<li>stack: 1.0.4</li>\n</ul>\n\n<p>xxd output</p>\n\n<pre><code>&gt; stack exec -- unicode | xxd\n00000000: 422e 7075 7453 7472 4c6e 2069 6e70 7574  B.putStrLn input\n00000010: 423a 2014 1516 1718 191a 1b1c 1d1e 1f20  B: ............\n00000020: 2122 2324 0a70 7269 6e74 2069 6e70 7574  !\"#$.print input\n00000030: 423a 2022 5c44 4334 5c4e 414b 5c53 594e  B: \"\\DC4\\NAK\\SYN\n00000040: 5c45 5442 5c43 414e 5c45 4d5c 5355 425c  \\ETB\\CAN\\EM\\SUB\\\n00000050: 4553 435c 4653 5c47 535c 5253 5c55 5320  ESC\\FS\\GS\\RS\\US\n00000060: 215c 2223 2422 0a42 2e70 7574 5374 724c  !\\\"#$\".B.putStrL\n00000070: 6e20 696e 7075 7442 273a 2074 6573 740a  n inputB': test.\n00000080: 7072 696e 7420 696e 7075 7442 273a 2022  print inputB': \"\n00000090: 7465 7374 220a                           test\".\n</code></pre>\n\n<p>libraries</p>\n\n<pre><code>&gt; stack exec -- ghc-pkg list\n/opt/ghc/7.10.3/lib/ghc-7.10.3/package.conf.d\n   Cabal-1.22.5.0\n   array-0.5.1.0\n   base-4.8.2.0\n   bin-package-db-0.0.0.0\n   binary-0.7.5.0\n   bytestring-0.10.6.0\n   containers-0.5.6.2\n   deepseq-1.4.1.1\n   directory-1.2.2.0\n   filepath-1.4.0.0\n   ghc-7.10.3\n   ghc-prim-0.4.0.0\n   haskeline-0.7.2.1\n   hoopl-3.10.0.2\n   hpc-0.6.0.2\n   integer-gmp-1.0.0.0\n   pretty-1.1.2.0\n   process-1.2.3.0\n   rts-1.0\n   template-haskell-2.10.0.0\n   terminfo-0.4.0.1\n   time-1.5.0.1\n   transformers-0.4.2.0\n   unix-2.7.1.0\n   xhtml-3000.2.1\n/home/epsilonhalbe/.stack/snapshots/x86_64-linux/lts-5.5/7.10.3/pkgdb\n   text-1.2.2.0\n/home/epsilonhalbe/programming/unicode/.stack-work/install/x86_64-linux/lts-5.5/7.10.3/pkgdb\n</code></pre>\n\n<p>and the locale</p>\n\n<pre><code>&gt; locale\nLANG=en_US.UTF-8\nLANGUAGE=\nLC_CTYPE=\"en_US.UTF-8\"\nLC_NUMERIC=de_AT.UTF-8\nLC_TIME=\"en_US.UTF-8\"\nLC_COLLATE=\"en_US.UTF-8\"\nLC_MONETARY=de_AT.UTF-8\nLC_MESSAGES=\"en_US.UTF-8\"\nLC_PAPER=de_AT.UTF-8\nLC_NAME=de_AT.UTF-8\nLC_ADDRESS=de_AT.UTF-8\nLC_TELEPHONE=de_AT.UTF-8\nLC_MEASUREMENT=de_AT.UTF-8\nLC_IDENTIFICATION=de_AT.UTF-8\nLC_ALL=\n</code></pre>\n"}, {"tags": ["haskell", "testing", "quickcheck"], "answers": [{"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 3409, "user_id": 3105485, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b4c41125ff9c7b20ca07d0845e7af7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Caridorc", "link": "https://stackoverflow.com/users/3105485/caridorc"}, "edited": false, "score": 0, "creation_date": 1456700598, "post_id": 35689263, "comment_id": 59056665, "body": "I just saw your code in the pastebin - please name your functions <code>encode</code>/<code>decode</code> and have some <code>newtype</code>-aliases for <code>Brainf***</code> and <code>OoO</code> for <code>String</code> to go along with it."}, {"owner": {"reputation": 3409, "user_id": 3105485, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b4c41125ff9c7b20ca07d0845e7af7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Caridorc", "link": "https://stackoverflow.com/users/3105485/caridorc"}, "edited": false, "score": 0, "creation_date": 1456701413, "post_id": 35689263, "comment_id": 59056916, "body": "I am in fact worried about the quality of the code I wrote. I would be grateful if you could give me some advice at Codereview -&gt; <a href=\"http://codereview.stackexchange.com/questions/121393/convert-ooo-to-brainfuck-and-viceversa\">Convert oOo to Brainfuck and viceversa</a>"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 2, "last_activity_date": 1456699555, "creation_date": 1456699555, "answer_id": 35689263, "question_id": 35689180, "link": "https://stackoverflow.com/questions/35689180/quickcheck-generate-a-string-made-of-chars-from-a-given-pool/35689263#35689263", "title": "Quickcheck: generate a string made of chars from a given pool", "body": "<p>i think you can use</p>\n\n<pre><code>elements :: [a] -&gt; Gen a\n</code></pre>\n\n<p>in combination with</p>\n\n<pre><code>listOf :: Gen a -&gt; Gen [a]\n</code></pre>\n\n<p>so your <code>String</code> generator could look something like</p>\n\n<pre><code>vowels :: Gen String\nvowels = listOf (elements \"aeiou\")\n</code></pre>\n"}], "owner": {"reputation": 3409, "user_id": 3105485, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b4c41125ff9c7b20ca07d0845e7af7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Caridorc", "link": "https://stackoverflow.com/users/3105485/caridorc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 35689263, "answer_count": 1, "score": 0, "last_activity_date": 1456699555, "creation_date": 1456699034, "last_edit_date": 1495540765, "question_id": 35689180, "link": "https://stackoverflow.com/questions/35689180/quickcheck-generate-a-string-made-of-chars-from-a-given-pool", "title": "Quickcheck: generate a string made of chars from a given pool", "body": "<pre><code>propertyForStringsFromMyCharPool :: String -&gt; Bool\n-- implementation\n\nmain = T.quickCheck propertyForStringsFromMyCharPool\n</code></pre>\n\n<p>Right now QuickCheck generates all kinds of strings, but I want to test my property only for strings from my pool of characters.</p>\n\n<p>My output now is:</p>\n\n<pre><code>*** Failed! Falsifiable (after 3 tests and 2 shrinks):    \n\"-\"\n</code></pre>\n\n<p>But it is not a real failure because <code>-</code> is not included in my charset and no string containing it should have been generated in the first place.</p>\n\n<hr>\n\n<ul>\n<li><p>I have tried to read the read <a href=\"https://hackage.haskell.org/package/QuickCheck-2.8.2/docs/Test-QuickCheck-Arbitrary.html\" rel=\"nofollow noreferrer\">the docs of  QuickCheck</a> but they are very abstract and hard, I did not find a sloution.</p></li>\n<li><p>I have seen <a href=\"https://stackoverflow.com/questions/20934506/haskell-quickcheck-how-to-generate-only-printable-strings\">a solution on StackOverflow</a> but it seems so much code for what looks like an easy problem, that I fear it is over-engineered.</p></li>\n</ul>\n"}, {"tags": ["list", "haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 2745, "user_id": 682446, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kchQ7.jpg?s=128&g=1", "display_name": "Eli Braginskiy", "link": "https://stackoverflow.com/users/682446/eli-braginskiy"}, "edited": false, "score": 0, "creation_date": 1456695996, "post_id": 35688494, "comment_id": 59055027, "body": "@EliBraginskiy No it would be <code>imapF f (g x)</code>. The <code>.</code> is function composition so <code>f . g = \\x -&gt; f (g x)</code>."}], "tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": true, "score": 3, "last_activity_date": 1456695950, "last_edit_date": 1456695950, "creation_date": 1456694878, "answer_id": 35688494, "question_id": 35688404, "link": "https://stackoverflow.com/questions/35688404/get-function-as-parameter-in-haskell/35688494#35688494", "title": "Get function as parameter in haskell", "body": "<p>You cannot pattern match over a function, but you don't have to do that:</p>\n\n<pre><code>&gt; imapE :: (a -&gt; b) -&gt; Enumeration a -&gt; Enumeration b\n&gt; imapE f g = (imapF f) . g\n</code></pre>\n\n<p>(Well, <code>imapF</code> is just <code>map</code> really).</p>\n\n<p>Without using <code>.</code>:</p>\n\n<pre><code>&gt; imapE :: (a -&gt; b) -&gt; Enumeration a -&gt; Enumeration b\n&gt; imapE f g = \\n -&gt; imapF f (g n)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1456696566, "last_edit_date": 1456696566, "creation_date": 1456695920, "answer_id": 35688665, "question_id": 35688404, "link": "https://stackoverflow.com/questions/35688404/get-function-as-parameter-in-haskell/35688665#35688665", "title": "Get function as parameter in haskell", "body": "<p>A possible solution could be</p>\n\n<pre><code>imapE :: (a -&gt; b) -&gt; Enumeration a -&gt; Enumeration b\nimapE = map . map\n</code></pre>\n\n<p>Indeed, the above is equivalent to</p>\n\n<pre><code>imapE f = map (map f)\n</code></pre>\n\n<p>where</p>\n\n<pre><code>f :: a -&gt; b\nmap f :: [a] -&gt; [b]\nmap (map f) :: (Int -&gt; [a]) -&gt; (Int -&gt; [b])\n</code></pre>\n\n<p>since both <code>[]</code> and <code>(-&gt;) Int</code> are functors.</p>\n\n<p>The main \"trick\" to this kind of exercises is to think more about the types than the actual values.</p>\n\n<p>This might feel a bit obscure if you're a beginner. Once you'll get more familiar with functors, however, this will become quite natural. </p>\n\n<p>(People very accustomed to this style could even hint to this solution with some cryptic note \"functors compose\", and leaving you to figure out what's really going on. When that happens, don't give up -- eventually it will make sense ;-))</p>\n"}], "owner": {"reputation": 2745, "user_id": 682446, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kchQ7.jpg?s=128&g=1", "display_name": "Eli Braginskiy", "link": "https://stackoverflow.com/users/682446/eli-braginskiy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 35688494, "answer_count": 2, "score": 0, "last_activity_date": 1456696566, "creation_date": 1456694385, "question_id": 35688404, "link": "https://stackoverflow.com/questions/35688404/get-function-as-parameter-in-haskell", "title": "Get function as parameter in haskell", "body": "<p>I can't figure this, I have a type called Enumeration</p>\n\n<pre><code>&gt; type Enumeration a = Int -&gt; [a]\n</code></pre>\n\n<p>And I need to map over it. I wrote this following function:</p>\n\n<pre><code>&gt; imapE :: (a -&gt; b) -&gt; Enumeration a -&gt; Enumeration b\n&gt; imapE f (m fa) = \\n -&gt; imapF f fa\n</code></pre>\n\n<p>where <code>imapF</code> is defined like this:</p>\n\n<pre><code>&gt; imapF :: (a -&gt; b) -&gt; [a] -&gt; [b] \n&gt; imapF _ [] = []\n&gt; imapF f (x:xs) = f x : imapF f xs\n</code></pre>\n\n<p>but when I try to load my code I get the following error <code>BinaryTrees.lhs:91:14: Parse error in pattern: m</code> regarding my <code>imapE</code> function.</p>\n\n<p>I am trying to get the first enumeration <code>Enumeration a</code> as the function it is (Int and [a])</p>\n"}, {"tags": ["python", "haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1456692674, "post_id": 35688087, "comment_id": 59053752, "body": "could you give some example of what input/output you would expect?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1456692759, "post_id": 35688087, "comment_id": 59053795, "body": "first guesses would be <code>pack</code>/<code>unpack</code> in <code>Data.Bytestring.Lazy</code>"}, {"owner": {"reputation": 2098, "user_id": 2896874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc8dd5a8776e9c69d58e2b97f2ba16ed?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav Sagar", "link": "https://stackoverflow.com/users/2896874/vaibhav-sagar"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1456693011, "post_id": 35688087, "comment_id": 59053899, "body": "Edited with example."}], "answers": [{"comments": [{"owner": {"reputation": 2098, "user_id": 2896874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc8dd5a8776e9c69d58e2b97f2ba16ed?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav Sagar", "link": "https://stackoverflow.com/users/2896874/vaibhav-sagar"}, "edited": false, "score": 0, "creation_date": 1456742997, "post_id": 35688227, "comment_id": 59071847, "body": "I think this is slightly different to what I am looking for."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 2098, "user_id": 2896874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc8dd5a8776e9c69d58e2b97f2ba16ed?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav Sagar", "link": "https://stackoverflow.com/users/2896874/vaibhav-sagar"}, "edited": false, "score": 0, "creation_date": 1456748114, "post_id": 35688227, "comment_id": 59074975, "body": "@VaibhavSagar: I have written an example to show you how it works."}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": true, "score": 6, "last_activity_date": 1456748091, "last_edit_date": 1456748091, "creation_date": 1456693370, "answer_id": 35688227, "question_id": 35688087, "link": "https://stackoverflow.com/questions/35688087/what-is-the-haskell-equivalent-of-pythons-hexlify-and-unhexlify/35688227#35688227", "title": "What is the Haskell equivalent of Python&#39;s hexlify and unhexlify?", "body": "<p>I normally call this base-16 encoding, and it is also available in Python as <code>base64.b16decode()</code> and <code>base64.b16encode()</code>.  The terms \"hexlify\" and \"unhexlify\" seem to be a bit idiosyncratic.</p>\n\n<p>Using these search terms, I was able to find <a href=\"https://hackage.haskell.org/package/base16-bytestring\" rel=\"nofollow\"><code>base16-bytestring</code></a> in Hackage.  It consumes and returns <code>ByteString</code>, not <code>String</code>, so you will need to pack if you have <code>String</code>.</p>\n\n<p>Here is how you use it.  You can see that it has a slightly different interface, and Haskell escapes strings differently, but it gives the same results that you give in your example.</p>\n\n<pre><code>&gt; decode \"95d09f2b10159347eece71399a7e2e907ea3df4f\"\n(\"\\149\\208\\159+\\DLE\\NAK\\147G\\238\\206q9\\154~.\\144~\\163\\223O\",\"\")\n&gt; encode \"\\x95\\xd0\\x9f+\\x10\\x15\\x93G\\xee\\xceq9\\x9a~.\\x90~\\xa3\\xdfO\"\n\"95d09f2b10159347eece71399a7e2e907ea3df4f\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 803, "user_id": 5773596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a8e4e9aa8c1f3d041e830308107182?s=128&d=identicon&r=PG", "display_name": "Ar\u0125imede\u03c2 \u2133ontegaspp\u03b1 \u212dacilh\u03b1\u03c2", "link": "https://stackoverflow.com/users/5773596/ar%c4%a5imede%cf%82-%e2%84%b3ontegaspp%ce%b1-%e2%84%adacilh%ce%b1%cf%82"}, "reply_to_user": {"reputation": 2098, "user_id": 2896874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc8dd5a8776e9c69d58e2b97f2ba16ed?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav Sagar", "link": "https://stackoverflow.com/users/2896874/vaibhav-sagar"}, "edited": false, "score": 0, "creation_date": 1456797256, "post_id": 35690115, "comment_id": 59103161, "body": "@VaibhavSagar Oh, sorry. I read too quickly and understood exactly the opposite."}], "tags": [], "owner": {"reputation": 803, "user_id": 5773596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a8e4e9aa8c1f3d041e830308107182?s=128&d=identicon&r=PG", "display_name": "Ar\u0125imede\u03c2 \u2133ontegaspp\u03b1 \u212dacilh\u03b1\u03c2", "link": "https://stackoverflow.com/users/5773596/ar%c4%a5imede%cf%82-%e2%84%b3ontegaspp%ce%b1-%e2%84%adacilh%ce%b1%cf%82"}, "is_accepted": false, "score": -1, "last_activity_date": 1456705583, "creation_date": 1456705583, "answer_id": 35690115, "question_id": 35688087, "link": "https://stackoverflow.com/questions/35688087/what-is-the-haskell-equivalent-of-pythons-hexlify-and-unhexlify/35690115#35690115", "title": "What is the Haskell equivalent of Python&#39;s hexlify and unhexlify?", "body": "<pre><code>from encodings.hex_codec import binascii\n\nvalue = binascii.a2b_hex('95d09f2b10159347eece71399a7e2e907ea3df4f')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2098, "user_id": 2896874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc8dd5a8776e9c69d58e2b97f2ba16ed?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav Sagar", "link": "https://stackoverflow.com/users/2896874/vaibhav-sagar"}, "is_accepted": false, "score": 1, "last_activity_date": 1456742855, "creation_date": 1456742855, "answer_id": 35697602, "question_id": 35688087, "link": "https://stackoverflow.com/questions/35688087/what-is-the-haskell-equivalent-of-pythons-hexlify-and-unhexlify/35697602#35697602", "title": "What is the Haskell equivalent of Python&#39;s hexlify and unhexlify?", "body": "<p>I couldn't find a package that did this for me, so I rolled my own:</p>\n\n<pre><code>import Data.ByteString (pack, unpack)\nimport Numeric (showHex, readHex)\n\nunhexlify :: String -&gt; ByteString\nunhexlify hexstr = let bytes = pairs hexstr\n                       nums  = map fst $ concatMap readHex bytes\n                   in pack nums\n\nhexlify :: ByteString -&gt; String\nhexlify binstr = let nums = unpack binstr\n                     hex  = map showHex nums\n                 in foldr ($) \"\" hex\n\npairs :: String -&gt; [String]\npairs [] = []\npairs (x:y:xs) = [x,y]:pairs xs\n</code></pre>\n"}], "owner": {"reputation": 2098, "user_id": 2896874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc8dd5a8776e9c69d58e2b97f2ba16ed?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav Sagar", "link": "https://stackoverflow.com/users/2896874/vaibhav-sagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 35688227, "answer_count": 3, "score": 2, "last_activity_date": 1456748091, "creation_date": 1456692601, "last_edit_date": 1456692982, "question_id": 35688087, "link": "https://stackoverflow.com/questions/35688087/what-is-the-haskell-equivalent-of-pythons-hexlify-and-unhexlify", "title": "What is the Haskell equivalent of Python&#39;s hexlify and unhexlify?", "body": "<p>I have code that looks a little like</p>\n\n<pre><code>module Lib where\n\nimport Data.ByteString (ByteString)\nimport Data.ByteString.Lazy (fromStrict)\nimport Data.Digest.Pure.SHA (sha1, showDigest)\n\nhash :: ByteString -&gt; String\nhash bstring = showDigest $ sha1 $ fromStrict bstring\n</code></pre>\n\n<p>which gives me a hexadecimal string representation of a SHA1 hash. How would I convert between this hexadecimal representation and the binary representation? In python I would use <code>binascii.hexlify</code> and <code>binascii.unhexlify</code>. For example:</p>\n\n<pre><code>'95d09f2b10159347eece71399a7e2e907ea3df4f' &lt;=&gt; '\\x95\\xd0\\x9f+\\x10\\x15\\x93G\\xee\\xceq9\\x9a~.\\x90~\\xa3\\xdfO'\n</code></pre>\n"}, {"tags": ["haskell", "unicode", "utf-8"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 3086763, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/050ed9d5eb3b17115c7b248ca1981e47?s=128&d=identicon&r=PG&f=1", "display_name": "capgelka", "link": "https://stackoverflow.com/users/3086763/capgelka"}, "edited": false, "score": 0, "creation_date": 1456692967, "post_id": 35687829, "comment_id": 59053879, "body": "I saw that link, maybe I an wrong but it looks like there is the different situation. I got a <code>ByteString</code>, not <code>Text</code> from api. And that <code>ByteString</code> consist of sequences of six bytes <code>\\uxxxx</code> for every non ascii letter. So I just even can&#39;t use <code>Text -&gt; ByteString</code> function."}, {"owner": {"reputation": 69, "user_id": 3086763, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/050ed9d5eb3b17115c7b248ca1981e47?s=128&d=identicon&r=PG&f=1", "display_name": "capgelka", "link": "https://stackoverflow.com/users/3086763/capgelka"}, "edited": false, "score": 0, "creation_date": 1456702507, "post_id": 35687829, "comment_id": 59057214, "body": "Thanks for such complete example! It looks like it just an error in my function implementation somewhere, I&#39;ll try to find and fix it"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 1, "last_activity_date": 1456697219, "last_edit_date": 1456697219, "creation_date": 1456691106, "answer_id": 35687829, "question_id": 35687685, "link": "https://stackoverflow.com/questions/35687685/haskell-convert-unicode-sequence-to-utf-8/35687829#35687829", "title": "haskell convert unicode sequence to utf 8", "body": "<p>I am not sure if you are falling in the \"print unicode\" trap (see <a href=\"https://stackoverflow.com/questions/24953125/how-to-convert-unicode-escape-sequence-to-unicode-string-in-haskell\">here</a>) - for en/decoding there already exists <a href=\"https://hackage.haskell.org/package/text-1.2.2.0/docs/Data-Text-Encoding.html\" rel=\"nofollow\">hackage: Data.Text.Encoding</a> <code>decodeUtf8 :: ByteString -&gt; Text</code> and <code>encodeUtf8 :: Text -&gt; ByteString</code> should do the task.</p>\n\n<h2>Edit:</h2>\n\n<p>I have played around with text/bytestring for some time to reproduce your \"\\u1234\" characters - well i couldn't</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nmodule Main where\n\nimport           Data.Text (Text)\nimport qualified Data.Text.Encoding as E\nimport qualified Data.Text.IO as T\nimport           Data.ByteString (ByteString)\nimport qualified Data.ByteString.Char8 as B\n\n\ninputB :: ByteString\ninputB = \"\u0414\u0415\u0416\u0417\u0418\u0419\u041a\u041b\u041c\u041d\u041e\u041f\u0420\u0421\u0422\u0423\u0424\"\n\ninputT :: Text\ninputT = \"\u0414\u0415\u0416\u0417\u0418\u0419\u041a\u041b\u041c\u041d\u041e\u041f\u0420\u0421\u0422\u0423\u0424\"\n\n\nmain :: IO ()\nmain = do putStr \"T.putStrLn inputT: \"                ; T.putStrLn inputT\n          putStr \"B.putStrLn inputB: \"                ; B.putStrLn inputB\n          putStr \"print inputB: \"                     ; print inputB\n          putStr \"print inputT: \"                     ; print inputT\n          putStr \"B.putStrLn $ E.encodeUtf8 inputT: \" ; B.putStrLn $ E.encodeUtf8 inputT\n          putStr \"T.putStrLn $ E.decodeUtf8 inputB: \" ; T.putStrLn $ E.decodeUtf8 inputB\n          putStr \"print $ E.decodeUtf8 inputB: \"      ; print $ E.decodeUtf8 inputB\n          putStr \"print $ E.encodeUtf8 inputT: \"      ; print $ E.encodeUtf8 inputT\n</code></pre>\n\n<p>here is the result of it:</p>\n\n<pre><code>T.putStrLn inputT: \u0414\u0415\u0416\u0417\u0418\u0419\u041a\u041b\u041c\u041d\u041e\u041f\u0420\u0421\u0422\u0423\u0424\nB.putStrLn inputB:\nrint inputB: \"\\DC4\\NAK\\SYN\\ETB\\CAN\\EM\\SUB\\ESC\\FS\\GS\\RS\\US !\\\"#$\"\nprint inputT: \"\\1044\\1045\\1046\\1047\\1048\\1049\\1050\\1051\\1052\\1053\\1054\\1055\\1056\\1057\\1058\\1059\\1060\"\nB.putStrLn $ E.encodeUtf8 inputT: \u0414\u0415\u0416\u0417\u0418\u0419\u041a\u041b\u041c\u041d\u041e\u041f\u0420\u0421\u0422\u0423\u0424\nT.putStrLn $ E.decodeUtf8 inputB:\nrint $ E.decodeUtf8 inputB: \"\\DC4\\NAK\\SYN\\ETB\\CAN\\EM\\SUB\\ESC\\FS\\GS\\RS\\US !\\\"#$\"\nprint $ E.encodeUtf8 inputT: \"\\208\\148\\208\\149\\208\\150\\208\\151\\208\\152\\208\\153\\208\\154\\208\\155\\208\\156\\208\\157\\208\\158\\208\\159\\208\\160\\208\\161\\208\\162\\208\\163\\208\\164\"\n</code></pre>\n\n<p>honestly I don't know why I get the \"rint\" lines after the bytestring printlines that yield no result.</p>\n"}], "owner": {"reputation": 69, "user_id": 3086763, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/050ed9d5eb3b17115c7b248ca1981e47?s=128&d=identicon&r=PG&f=1", "display_name": "capgelka", "link": "https://stackoverflow.com/users/3086763/capgelka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "accepted_answer_id": 35687829, "answer_count": 1, "score": 0, "last_activity_date": 1456702068, "creation_date": 1456690352, "last_edit_date": 1456702068, "question_id": 35687685, "link": "https://stackoverflow.com/questions/35687685/haskell-convert-unicode-sequence-to-utf-8", "title": "haskell convert unicode sequence to utf 8", "body": "<p>I am working on http client in haskell (that's my first \"non exersize\" project).</p>\n\n<p>There is an api which returns json with all text using unicode, something like</p>\n\n<pre><code>\\u041e\\u043d\\u0430 \\u043f\\u0440\\u0438\\u0432\\u0435\\u0434\\u0435\\u0442 \\u0432\\u0430\\u0441 \\u0432 \\u0434\\u043b\\u0438\\u043d\\u043d\\u044b\\u0439 \\u0441\\u043f\\u0438\\u0441\\u043e\\u043a\n</code></pre>\n\n<p>I want to decode this json to utf-8, to print some data from json message.</p>\n\n<p>I searched for existing libraries, but find Nothing for this purpose.</p>\n\n<p>So I wrote function to convert data (I am using lazy bytestrings because I got data with this type from wreq lib)</p>\n\n<pre><code>ununicode :: BL.ByteString -&gt; BL.ByteString \nununicode s = replace s where\n\n    replace :: BL.ByteString -&gt; BL.ByteString\n    replace str = case (Map.lookup (BL.take 6 str) table) of\n              (Just x) -&gt; BL.append x (replace $ BL.drop 6 str)\n              (Nothing) -&gt; BL.cons (BL.head str)  (replace $ BL.tail str)\n\n      table = Map.fromList $ zip letters rus\n\n      rus = [\"\u0401\", \"\u0451\", \"\u0410\", \"\u0411\", \"\u0412\", \"\u0413\", \"\u0414\", \"\u0415\", \"\u0416\", \"\u0417\", \"\u0418\", \"\u0419\", \"\u041a\", \"\u041b\", \"\u041c\",\n             \"\u041d\", \"\u041e\", \"\u041f\", \"\u0420\", \"\u0421\", \"\u0422\", \"\u0423\", \"\u0424\", \"\u0425\", \"\u0426\", \"\u0427\", \"\u0428\", \"\u0429\", \"\u042a\", \"\u042b\",\n             \"\u042c\", \"\u042d\", \"\u042e\", \"\u042f\", \"\u0430\", \"\u0431\", \"\u0432\", \"\u0433\", \"\u0434\", \"\u0435\", \"\u0436\", \"\u0437\", \"\u0438\", \"\u0439\", \"\u043a\",\n             \"\u043b\", \"\u043c\", \"\u043d\", \"\u043e\", \"\u043f\", \"\u0440\", \"\u0441\", \"\u0442\", \"\u0443\", \"\u0444\", \"\u0445\", \"\u0446\", \"\u0447\", \"\u0448\", \"\u0449\",\n             \"\u044a\", \"\u044b\", \"\u044c\", \"\u044d\", \"\u044e\", \"\u044f\"] \n\n      letters = [\"\\\\u0401\", \"\\\\u0451\", \"\\\\u0410\", \"\\\\u0411\", \"\\\\u0412\", \"\\\\u0413\", \n                 \"\\\\u0414\", \"\\\\u0415\", \"\\\\u0416\", \"\\\\u0417\", \"\\\\u0418\", \"\\\\u0419\",\n                 \"\\\\u041a\", \"\\\\u041b\", \"\\\\u041c\", \"\\\\u041d\", \"\\\\u041e\", \"\\\\u041f\",\n                 \"\\\\u0420\", \"\\\\u0421\", \"\\\\u0422\", \"\\\\u0423\", \"\\\\u0424\", \"\\\\u0425\",\n                 \"\\\\u0426\", \"\\\\u0427\", \"\\\\u0428\", \"\\\\u0429\", \"\\\\u042a\", \"\\\\u042b\",\n                 \"\\\\u042c\", \"\\\\u042d\", \"\\\\u042e\", \"\\\\u042f\", \"\\\\u0430\", \"\\\\u0431\",\n                 \"\\\\u0432\", \"\\\\u0433\", \"\\\\u0434\", \"\\\\u0435\", \"\\\\u0436\", \"\\\\u0437\",\n                 \"\\\\u0438\", \"\\\\u0439\", \"\\\\u043a\", \"\\\\u043b\", \"\\\\u043c\", \"\\\\u043d\",\n                 \"\\\\u043e\", \"\\\\u043f\", \"\\\\u0440\", \"\\\\u0441\", \"\\\\u0442\", \"\\\\u0443\",\n                 \"\\\\u0444\", \"\\\\u0445\", \"\\\\u0446\", \"\\\\u0447\", \"\\\\u0448\", \"\\\\u0449\",\n                 \"\\\\u044a\", \"\\\\u044b\", \"\\\\u044c\", \"\\\\u044d\", \"\\\\u044e\", \"\\\\u044f\"]\n</code></pre>\n\n<p>But it doesn't work as I expected. It replaces text, but instead of cyrrilic letters I got something like \n    345 ?C1;8:C5&lt; 8=B5@2LN A @4=52=8:>2F0&lt;8 8=B5@5A=KE ?@>D5AA89 8 E>118</p>\n\n<p>The second problem that I can't debug my function.\nWhen I try just call it with custom string I got error <code>Data.ByteString.Lazy.head: empty ByteString</code>\nI gave no idea about reason why it's empty.</p>\n\n<p>It work's fine during normal program execution:</p>\n\n<pre><code>umailGet env params = do\n    r &lt;- apiGet env ((\"method\", \"umail.get\"):params)\n    x &lt;- return $ case r of\n          (Right a) -&gt; a\n          (Left a)  -&gt; \"\"\n    return $ ununicode $ x\n</code></pre>\n\n<p>and than in Main</p>\n\n<pre><code>  r2 &lt;- umailGet client []\n  print $  r2\n</code></pre>\n\n<p>And the last problem is that all api can return any unicode symbol, so this solution is bad by design.</p>\n\n<p>Of course function implementation seems to be bad to, so after solving the main problem, I am going to rewrite it using foldr.</p>\n\n<p><strong>UPDATED:</strong>\nIt seems like I had desribed problem not enough clear.</p>\n\n<p>So I am sending request via wreq lib, and get a json answer. For example</p>\n\n<pre><code>{\"result\":\"12\",\"error\":\"\\u041d\\u0435\\u0432\\u0435\\u0440\\u043d\\u044b\\u0439 \\u0438\\u0434\\u0435\\u043d\\u0442\\u0438\\u0444\\u0438\\u043a\\u0430\\u0442\\u043e\\u0440 \\u0441\\u0435\\u0441\\u0441\\u0438\\u0438\"}\n</code></pre>\n\n<p>That's not the result of haskell representetion of result, thare are real ascii symbols. I got the same text using curl or firefox. 190 bytes/190 ascii symbols.</p>\n\n<p>Using this site for example <a href=\"http://unicode.online-toolz.com/tools/text-unicode-entities-convertor.php\" rel=\"nofollow\">http://unicode.online-toolz.com/tools/text-unicode-entities-convertor.php</a> I can convert it to cyrrilic text <code>{\"result\":\"12\",\"error\":\"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0441\u0435\u0441\u0441\u0438\u0438\"}</code></p>\n\n<p>And I need to implement something like this service using haskell (or find a package where it had been already implemented), where response like this has type Lazy Bytestring.</p>\n\n<p>I also tried to change types to use Text instead of ByteString (both Lazy and strict), changed first line to <code>ununicode s = encodeUtf8 $ replace $ L.toStrict $ LE.decodeUtf8 s</code></p>\n\n<p>And with that new implementation I am getting an error when executing my program \n<code>Data.Text.Internal.Fusion.Common.head: Empty stream</code>. Sot it looks like I have error in my replacing function, maybe if I fix it, it also will fix the main problem. </p>\n"}, {"tags": ["haskell", "ghc", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 3063152, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/db8a9921c49e3308f176fac904d316ec?s=128&d=identicon&r=PG&f=1", "display_name": "ProtectorOfUbi", "link": "https://stackoverflow.com/users/3063152/protectorofubi"}, "edited": false, "score": 0, "creation_date": 1456685728, "post_id": 35686750, "comment_id": 59051069, "body": "How can i specify the file path for the source file test.hs?"}, {"owner": {"reputation": 197, "user_id": 3063152, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/db8a9921c49e3308f176fac904d316ec?s=128&d=identicon&r=PG&f=1", "display_name": "ProtectorOfUbi", "link": "https://stackoverflow.com/users/3063152/protectorofubi"}, "edited": false, "score": 0, "creation_date": 1456688522, "post_id": 35686750, "comment_id": 59052211, "body": "I found the problem. I was using TextEdit to save my source file and the .sh extension was not being applied. Got text wrangler and now it works."}], "tags": [], "owner": {"reputation": 128, "user_id": 4005637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8a38b7eb7601568d46f0688eb2c793?s=128&d=identicon&r=PG", "display_name": "Joan Marc&#232; i Igual", "link": "https://stackoverflow.com/users/4005637/joan-marc%c3%a8-i-igual"}, "is_accepted": true, "score": 2, "last_activity_date": 1456685317, "creation_date": 1456685317, "answer_id": 35686750, "question_id": 35686669, "link": "https://stackoverflow.com/questions/35686669/error-loading-hs-file-using-ghc/35686750#35686750", "title": "Error loading .hs file using GHC", "body": "<p>Have you checked that you are on the correct folder before loading it and the file exists? <code>ghci</code> is the command line interpreter so you can load a file after calling it by typing <code>:l test.hs</code> .</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1456686365, "creation_date": 1456686365, "answer_id": 35686960, "question_id": 35686669, "link": "https://stackoverflow.com/questions/35686669/error-loading-hs-file-using-ghc/35686960#35686960", "title": "Error loading .hs file using GHC", "body": "<p>If the file is on your desktop, use</p>\n\n<pre><code>ghci ~/Desktop/test.hs\n</code></pre>\n\n<p>Note that this is not really a Haskell question, but a shell question (and the path is specific to Mac OS X).</p>\n"}], "owner": {"reputation": 197, "user_id": 3063152, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/db8a9921c49e3308f176fac904d316ec?s=128&d=identicon&r=PG&f=1", "display_name": "ProtectorOfUbi", "link": "https://stackoverflow.com/users/3063152/protectorofubi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 1, "accepted_answer_id": 35686750, "answer_count": 2, "score": 1, "last_activity_date": 1456686365, "creation_date": 1456684922, "question_id": 35686669, "link": "https://stackoverflow.com/questions/35686669/error-loading-hs-file-using-ghc", "title": "Error loading .hs file using GHC", "body": "<p>I'm a complete beginner with Haskell. So far I've downloaded the GHC. I know how to use it via the terminal by typing </p>\n\n<pre><code>$ ghci\n</code></pre>\n\n<p>also I have made a file called test.hs with my own code. I would like to run the file in ghci via terminal but i keep getting this error.</p>\n\n<p><a href=\"https://i.stack.imgur.com/P2ZZi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/P2ZZi.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have saved the test.hs on a file on my desktop. Im assuming i have to state the file path but i don't know how!.</p>\n"}, {"tags": ["mongodb", "haskell", "custom-data-type"], "comments": [{"owner": {"reputation": 15004, "user_id": 562906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a15f15ed0023f4177a518b6c15ca4b6?s=128&d=identicon&r=PG", "display_name": "sinelaw", "link": "https://stackoverflow.com/users/562906/sinelaw"}, "edited": false, "score": 1, "creation_date": 1456682981, "post_id": 35686151, "comment_id": 59049995, "body": "Why do you mean &quot;for mongodb&quot;? Do you want to convert to json? If yes there&#39;s the aeson package. More information can help."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "reply_to_user": {"reputation": 15004, "user_id": 562906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a15f15ed0023f4177a518b6c15ca4b6?s=128&d=identicon&r=PG", "display_name": "sinelaw", "link": "https://stackoverflow.com/users/562906/sinelaw"}, "edited": false, "score": 0, "creation_date": 1456683365, "post_id": 35686151, "comment_id": 59050132, "body": "@sinelaw the field syntax for Database.MongoDB is  as I posted above. I don&#39;t know ; their example is  <code>access pipe master &quot;dbname&quot; $ insert &quot;collection&quot; [&quot;author&quot; =: &quot;Mike&quot;]</code> . So I am trying to figure out how to convert on datatype to fit that field format."}], "answers": [{"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1456687559, "post_id": 35687158, "comment_id": 59051841, "body": "the <code>fromIntegral</code> are necessary as Value only knows <code>Int32</code> and <code>Int64</code> so you need to convert them"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1456688525, "post_id": 35687158, "comment_id": 59052213, "body": "the second version of <code>cast&#39;</code> is one of the many reasons why i really like haskell - short, elegant and pretty understandable even if you don&#39;t know the language, even though producing it as a newcomer is not trivial"}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1456724979, "post_id": 35687158, "comment_id": 59062855, "body": "thank you. I am learning Haskell and finding it really hard at the moment; but people like you are a great help. That works beautifully."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1456725232, "post_id": 35687158, "comment_id": 59062940, "body": "could you explain why <code>Doc [ &quot;bodyID&quot;  := (Int64 $ fromIntegral body),                   &quot;brandID&quot; := (Int64 $ fromIntegral brand)] </code> becomes ` Doc [ &quot;bodyID&quot;  := (val body) , &quot;brandID&quot; := (val brand)]` ? Thanks!"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 4, "last_activity_date": 1457539903, "last_edit_date": 1457539903, "creation_date": 1456687460, "answer_id": 35687158, "question_id": 35686151, "link": "https://stackoverflow.com/questions/35686151/haskell-convert-string-to-field-for-mongodb/35687158#35687158", "title": "Haskell: convert String to Field for mongoDB", "body": "<p>If I understand this correctly you are using <a href=\"https://hackage.haskell.org/package/mongoDB\" rel=\"nofollow\">hackage: mongoDB</a> to interact with a database.</p>\n\n<p>So the only thing to do is convert a haskell value to a BSON-value this is what <a href=\"https://hackage.haskell.org/package/bson\" rel=\"nofollow\">hackage: bson</a> provides, notably in the typeclass <a href=\"https://hackage.haskell.org/package/bson-0.3.2.1/docs/Data-Bson.html#t:Val\" rel=\"nofollow\">Val</a></p>\n\n<blockquote>\n<pre><code>class (Typeable a, Show a, Eq a) =&gt; Val a where\n\nHaskell types of this class correspond to BSON value types\n\nMinimal complete definition\nval, cast'\n\nMethods\nval :: a -&gt; Value \n...\ncast' :: Value -&gt; Maybe a \n...\n</code></pre>\n</blockquote>\n\n<p>so it remains to implement <code>val</code> and <code>cast'</code></p>\n\n<p>but first of all we need to derive a few more properties than you have:</p>\n\n<p><code>Body.hs</code></p>\n\n<pre><code>{-# LANGUAGE DeriveDataTypeable #-}\n{-# LANGUAGE OverloadedStrings #-}\nmodule Body where\n\nimport Data.Bson\nimport Data.Typeable\n\ndata Body = Body { bodyID :: Int\n                 , brandID :: Int }\n                 deriving (Show,Typeable,Eq)\n\n\ninstance Val Body where\n  val (Body body brand) = Doc [ \"bodyID\"  := (Int64 $ fromIntegral body)\n                              , \"brandID\" := (Int64 $ fromIntegral brand)]\n\n  cast' (Doc bson) = case (bson !? \"bodyID\") of\n                          Just (Int64 x) -&gt;\n                               case (bson !? \"brandID\") of\n                                         Just (Int64 y) -&gt; Just (Body (fromIntegral x)\n                                                                      (fromIntegral y))\n                                         Just _  -&gt; Nothing\n                                         Nothing -&gt; Nothing\n                          Just _ -&gt; Nothing\n                          Nothing -&gt; Nothing\n  cast' (Array x) = undefined\n  cast' _ = Nothing\n</code></pre>\n\n<p>this is a bit clustered but rather straightforward.</p>\n\n<hr>\n\n<p>Now I gave this thing a bit more thought - the previous <code>cast'</code> is really clustered and haskell having nice abstractions should do better</p>\n\n<pre><code>  val (Body body brand) = Doc [ \"bodyID\"  := (val body)\n                              , \"brandID\" := (val brand)]\n  cast' (Doc bson) = do body  &lt;- (bson !? \"bodyID\")\n                        brand &lt;- (bson !? \"brandID\")\n                        Body &lt;$&gt; cast' body &lt;*&gt; cast' brand\n\n  cast' _ = Nothing\n</code></pre>\n\n<p>So you really could write this a bit shorter accepting that <code>&lt;$&gt;</code> (called <code>fmap</code>) and <code>&lt;*&gt;</code> (called <code>ap</code> do the \"right\" thing.</p>\n\n<p>Moreover I used <code>do</code> notation to simplify the job, now using this</p>\n\n<pre><code>&gt; cast' $ val (Body 30 4) :: Maybe Body\nJust (Body {bodyID = 30, brandID = 4})\n</code></pre>\n\n<p><em>Note</em> in the last example you really need the annotation <code>:: Maybe Body</code> otherwise the compiler cannot figure out what to cast and you'll get a <code>Nothing</code>.</p>\n"}], "owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 35687158, "answer_count": 1, "score": 0, "last_activity_date": 1457539903, "creation_date": 1456682313, "question_id": 35686151, "link": "https://stackoverflow.com/questions/35686151/haskell-convert-string-to-field-for-mongodb", "title": "Haskell: convert String to Field for mongoDB", "body": "<p>What is the best way to convert a string <code>\"[\\\"id\\\"=:5977, \\\"brandId\\\"=:87]\"</code> to a field for mongoDB <code>[\"id\"=:5977, \"brandId\"=:87]</code></p>\n\n<p>or even better if I have a datatype </p>\n\n<pre><code>data Body = Body\n { body_id :: int\n   brandId :: Int } deriving (Show)\n</code></pre>\n\n<p>giving </p>\n\n<p><code>Body {body_id = 5977, brandId = 87}</code></p>\n\n<p>What is the best way to convert that to </p>\n\n<p><code>[\"id\"=:5977, \"brandId\"=:87]</code></p>\n\n<p>Thanks.</p>\n"}, {"tags": ["list", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1456674817, "post_id": 35684605, "comment_id": 59046769, "body": "There are many different ways to do that \u2013 what <i>properties</i> do you wish the enumeration to have? (Should the integer determine the list length, the <i>maximum</i> length, the starting position, ... or something completely different?)"}, {"owner": {"reputation": 2745, "user_id": 682446, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kchQ7.jpg?s=128&g=1", "display_name": "Eli Braginskiy", "link": "https://stackoverflow.com/users/682446/eli-braginskiy"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1456675532, "post_id": 35684605, "comment_id": 59047033, "body": "@leftaroundabout from the exercise (the previous type &#39;Finite&#39; is also referred to as a &#39;bucket&#39;): <code>An enumeration is an infinite sequence of finite buckets, indexed by natural numbers.</code>  And the function single : <code>I suggest for simplicity that you put the sole item in bucket 0</code>, So I&#39;m thinking that the <code>int</code> is the index of the bucket in the enumeration."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1456675775, "post_id": 35684605, "comment_id": 59047129, "body": "You should edit that information into the question."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1456675792, "post_id": 35684605, "comment_id": 59047134, "body": "You would want <code>singleE :: Enumeration a</code> anyway."}, {"owner": {"reputation": 2745, "user_id": 682446, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kchQ7.jpg?s=128&g=1", "display_name": "Eli Braginskiy", "link": "https://stackoverflow.com/users/682446/eli-braginskiy"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1456675831, "post_id": 35684605, "comment_id": 59047145, "body": "@chepner the exercise clearly states that singleE is defined as I wrote above <code>singleE :: a -&gt; Enumeration a</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1456676002, "post_id": 35684605, "comment_id": 59047210, "body": "You also said &quot;reimplement the singleton function&quot;, which takes an Int and returns a singleton list. <code>singleE</code> as typed would take an Int and return a <i>function</i> that returns a list."}, {"owner": {"reputation": 2745, "user_id": 682446, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kchQ7.jpg?s=128&g=1", "display_name": "Eli Braginskiy", "link": "https://stackoverflow.com/users/682446/eli-braginskiy"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1456676098, "post_id": 35684605, "comment_id": 59047251, "body": "@chepner What I meant in &quot;reimplement&quot; is that I already implemented the singleton function for a bucket (Finite), and now have to do it for the <code>Enumeration</code> type. I think that I should take an Int and return a function, thats the part I don&#39;t understand completely."}], "answers": [{"comments": [{"owner": {"reputation": 2745, "user_id": 682446, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kchQ7.jpg?s=128&g=1", "display_name": "Eli Braginskiy", "link": "https://stackoverflow.com/users/682446/eli-braginskiy"}, "edited": false, "score": 0, "creation_date": 1456676161, "post_id": 35684913, "comment_id": 59047277, "body": "isn&#39;t <code>singleE</code> defined in such a way that its a function that takes an <code>a</code> and returns a function that returns a list?"}, {"owner": {"reputation": 2745, "user_id": 682446, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kchQ7.jpg?s=128&g=1", "display_name": "Eli Braginskiy", "link": "https://stackoverflow.com/users/682446/eli-braginskiy"}, "edited": false, "score": 2, "creation_date": 1456676280, "post_id": 35684913, "comment_id": 59047313, "body": "Oh I think I understand now! I can substitute like so <code>singleE :: a -&gt; Int -&gt; Finite a</code> and that means I can now get the <code>Int</code> as well! thank you so much!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 2745, "user_id": 682446, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kchQ7.jpg?s=128&g=1", "display_name": "Eli Braginskiy", "link": "https://stackoverflow.com/users/682446/eli-braginskiy"}, "edited": false, "score": 0, "creation_date": 1456682031, "post_id": 35684913, "comment_id": 59049588, "body": "@EliBraginskiy An alternative could be to return a lambda: <code>singleE a = \\n -&gt; if n==0 then singleF a else []</code> (you can also use a <code>case</code> instead of <code>if</code>)"}, {"owner": {"reputation": 2745, "user_id": 682446, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kchQ7.jpg?s=128&g=1", "display_name": "Eli Braginskiy", "link": "https://stackoverflow.com/users/682446/eli-braginskiy"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1456696147, "post_id": 35684913, "comment_id": 59055074, "body": "@chi I really like this solution. Is there any way to replace it with a <code>.</code> syntax instead though?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 2745, "user_id": 682446, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kchQ7.jpg?s=128&g=1", "display_name": "Eli Braginskiy", "link": "https://stackoverflow.com/users/682446/eli-braginskiy"}, "edited": false, "score": 1, "creation_date": 1456696947, "post_id": 35684913, "comment_id": 59055380, "body": "@EliBraginskiy Yes, but I don&#39;t think it&#39;s actually more readable. <code>singleE a = bool (singleF a) [] . (==0)</code> (import <code>Data.Bool</code> first). You could also remove the <code>a</code> argument, but things would get <i>really</i> messy. Point-free style should not be followed at all costs."}], "tags": [], "owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "is_accepted": true, "score": 5, "last_activity_date": 1456675954, "creation_date": 1456675954, "answer_id": 35684913, "question_id": 35684605, "link": "https://stackoverflow.com/questions/35684605/function-that-gets-an-int-and-returns-a-list/35684913#35684913", "title": "function that gets an Int and returns a list", "body": "<p>Off the top of my head:</p>\n\n<pre><code>singleE :: a -&gt; Enumeration a\nsingleE a 0 = singleF a\nsingleE _ _ = []\n\nmain :: IO ()\nmain = do\n  let s=singleE 'a'\n  print $ s 0\n  print $ s 5\n</code></pre>\n\n<p>Gives</p>\n\n<pre><code>\"a\"\n\"\"\n</code></pre>\n\n<p>singleE gives you a function that takes an Int and returns a Finite. If you pass 0, you get a Finite with the single element, otherwise an empty one.</p>\n"}], "owner": {"reputation": 2745, "user_id": 682446, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kchQ7.jpg?s=128&g=1", "display_name": "Eli Braginskiy", "link": "https://stackoverflow.com/users/682446/eli-braginskiy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 35684913, "answer_count": 1, "score": -2, "last_activity_date": 1456675954, "creation_date": 1456674347, "last_edit_date": 1456675868, "question_id": 35684605, "link": "https://stackoverflow.com/questions/35684605/function-that-gets-an-int-and-returns-a-list", "title": "function that gets an Int and returns a list", "body": "<p>I have an exercise in Haskell where I need to create various types.The first type is called Finite which is defined like this:</p>\n\n<pre><code>type Finite a = [a]\n</code></pre>\n\n<p>and then I need to return a singleton which is defined like this</p>\n\n<pre><code>singleF :: a -&gt; Finite a\n</code></pre>\n\n<p>so I implemented it like so:</p>\n\n<pre><code>single n = [n]\n</code></pre>\n\n<p>Then later I create another type</p>\n\n<pre><code>type Enumeration a = Int -&gt; Finite a\n</code></pre>\n\n<p>then I need to reimplement the singleton function</p>\n\n<pre><code>singleE :: a -&gt; Enumeration a\n</code></pre>\n\n<p>In my understanding the type <code>Enumeration</code> is a synonym for a function from an Int to a list of type <code>a</code>, but I can't understand how exactly I can implement that.</p>\n\n<p>From the exercise (the previous type 'Finite' is also referred to as a 'bucket'): <code>An enumeration is an infinite sequence of finite buckets, indexed by natural numbers</code>. </p>\n\n<p>And the function single : <code>I suggest for simplicity that you put the sole item in bucket 0</code>, So I'm thinking that the int is the index of the bucket in the enumeration</p>\n"}, {"tags": ["haskell", "haskell-zlib"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1456675556, "post_id": 35683896, "comment_id": 59047042, "body": "btw. you can <code>import Data.ByteString.Lazy.Char8 as BS</code> so you can later write <code>BS.putStrLn</code> which is a bit more readable."}], "answers": [{"comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1456676154, "post_id": 35684811, "comment_id": 59047274, "body": "Any reason why changing the import causes the default parameter to work ?"}], "tags": [], "owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "is_accepted": true, "score": 2, "last_activity_date": 1456675427, "creation_date": 1456675427, "answer_id": 35684811, "question_id": 35683896, "link": "https://stackoverflow.com/questions/35683896/decompress-zlib-data-in-haskell-incorrect-header-check/35684811#35684811", "title": "Decompress zlib data in Haskell -- Incorrect header check", "body": "<p>Change your ZLib import to</p>\n\n<pre><code>import Codec.Compression.Zlib.Raw\n</code></pre>\n\n<p>And even the default params work on my machine:</p>\n\n<pre><code>body &lt;- simpleHTTP (getRequest $ commentURL arg) &gt;&gt;= getResponseBody\nlet p = decompress (pack body)\nData.ByteString.Lazy.Char8.putStrLn p\n</code></pre>\n\n<p>give me</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;i&gt;&lt;chatserver&gt;chat.bilibili.com&lt;/chatserver&gt;&lt;chatid&gt;4750304&lt;/chatid&gt;&lt;mission&gt;...\n</code></pre>\n\n<p>Note: you can avoid packing the string, add network-uri to your cabal file, add the <code>import Network.URI (parseURI)</code> import and</p>\n\n<pre><code>let Just u = parseURI $ commentURL arg\ndo\n    body &lt;- simpleHTTP (mkRequest GET u) &gt;&gt;= getResponseBody\n    let p = decompress body\n</code></pre>\n\n<p>To work only with ByteStrings.</p>\n"}], "owner": {"reputation": 95, "user_id": 5691005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9556814c9b7e1a180bcc0f0032c6a77?s=128&d=identicon&r=PG", "display_name": "0xBBC", "link": "https://stackoverflow.com/users/5691005/0xbbc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3005, "favorite_count": 0, "accepted_answer_id": 35684811, "answer_count": 1, "score": 1, "last_activity_date": 1456675427, "creation_date": 1456670602, "last_edit_date": 1456671388, "question_id": 35683896, "link": "https://stackoverflow.com/questions/35683896/decompress-zlib-data-in-haskell-incorrect-header-check", "title": "Decompress zlib data in Haskell -- Incorrect header check", "body": "<p>I wrote a simple Haskell program that fetches some compressed data from a certain website and then decompress it, but I always get an error said 'incorrect header check'. </p>\n\n<p>I've wrote the same program in D lang and it works fine. </p>\n\n<p>For now, I can fetch the raw compressed data in Haskell, the only problem seems to be the window bits and buffer size in DecompressParams. (DecompressParam in Haskell doesn't accept negative value)</p>\n\n<p>FYI: You can pass '4750304' to the program for testing. </p>\n\n<p>Here is my Haskell code</p>\n\n<pre><code>module Main where\n\nimport Codec.Compression.Zlib\nimport Network.HTTP\nimport System.Environment (getArgs)\nimport Data.ByteString.Lazy.Char8\n\ncommentURL :: [Char] -&gt; [Char]\ncommentURL cid = do\n    \"http://comment.bilibili.com/\" ++ cid ++ \".xml\"\n\nmain :: IO ()\nmain = do\n    (arg:_) &lt;- getArgs\n    do\n        body &lt;- simpleHTTP (getRequest $ commentURL arg) &gt;&gt;= getResponseBody\n        let params = DecompressParams {\n                        decompressWindowBits = WindowBits 15, \n                        decompressBufferSize = 0, \n                        decompressDictionary = Nothing\n                     }\n        let p = decompressWith params (pack body)\n        Data.ByteString.Lazy.Char8.putStrLn p\n</code></pre>\n\n<p>And the working code in D lang</p>\n\n<pre><code>import std.stdio;\nimport std.net.curl;\nimport std.array;\nimport std.string;\nimport std.zlib;\n\nvoid main(string[] args) {\n    if (args[1].length &lt;= 14 &amp;&amp; args[1].isNumeric) {\n        auto url = appender!string;\n        url.put(\"comment.bilibili.com/\");\n        url.put(args[1]);\n        url.put(\".xml\");\n\n        auto deflate = get(url.data);\n        auto data = cast(char[])uncompress(deflate, 0, -15);\n        // DecompressParam in Haskell doesn't accept negative value\n\n        File file = File(args[1]~\".xml\", \"wb\");\n        file.write(data);\n        file.close();\n    } else {\n        writeln(\"Usage: \"~args[0]~\" [cid]\");\n    }\n}\n</code></pre>\n"}, {"tags": ["haskell", "stream", "functional-programming"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1456670313, "post_id": 35683672, "comment_id": 59045040, "body": "(<a href=\"http://learnyouahaskell.com/input-and-output#files-and-streams\" rel=\"nofollow noreferrer\">relevant section</a>). The first quote from a section concerned with <b>buffering</b>. <code>hGetContents</code> still gets all content from the file (lazily)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1456691722, "post_id": 35683672, "comment_id": 59053360, "body": "That snippet uses a concept named  &quot;lazy IO&quot; to return something which looks as a string, but is actually more like a string-producer which will read from the file as soon as more characters are accessed in the string. While convenient, this feature is considered a wart by some Haskellers, since it allows to mix pure computation and side effects (file reading) in a possibly fragile way. For the time being, you can ignore this problem, but know that for non-toy programs, much better libraries exist (e.g. conduit or pipes)."}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 2, "last_activity_date": 1456710253, "last_edit_date": 1456710253, "creation_date": 1456673474, "answer_id": 35684420, "question_id": 35683672, "link": "https://stackoverflow.com/questions/35683672/how-to-understand-stream-in-haskell/35684420#35684420", "title": "How to understand stream in Haskell", "body": "<blockquote>\n  <p><strong>why we can take contents as the whole contents if it reads one line in one time?</strong> </p>\n</blockquote>\n\n<p>First note that it is not necessary that the content is being read line by line (although it can be possible, I will come to that later). What the author meant is that even though the entire file is not loaded to the memory, you can <em>assume</em> conceptually that the variable <code>contents</code> has the whole content of the file. This is possible because of the lazy streaming of the file (If you are more interested, you can see the <a href=\"http://haddock.stackage.org/lts-5.4/base-4.8.2.0/src/GHC-IO-Handle.html#hGetBuffering\" rel=\"nofollow\">source</a> to see the low level details. It basically uses <code>unsafeInterleaveIO</code> to achieve this).</p>\n\n<blockquote>\n  <p><strong>does Haskell save the content of every line into temporary memory or something else?</strong></p>\n</blockquote>\n\n<p>That depends on the type of buffering used. According to the documentation it depends on the underlying file system:</p>\n\n<blockquote>\n  <p>The default buffering mode when a handle is opened is\n  implementation-dependent and may depend on the file system object\n  which is attached to that handle. For most implementations, physical\n  files will normally be block-buffered and terminals will normally be\n  line-buffered.</p>\n</blockquote>\n\n<p>But you can use <code>hGetBuffering :: Handle -&gt; IO BufferMode</code> to see yourself what buffering mode you are in.</p>\n"}, {"tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": false, "score": 3, "last_activity_date": 1456678156, "creation_date": 1456678156, "answer_id": 35685352, "question_id": 35683672, "link": "https://stackoverflow.com/questions/35683672/how-to-understand-stream-in-haskell/35685352#35685352", "title": "How to understand stream in Haskell", "body": "<blockquote>\n  <p>How to understand stream in Haskell</p>\n</blockquote>\n\n<p>You can think of it <em>as a function</em> which when invoked, returns <em>some</em> of the result (<em>not all of it</em>) along with a <em>call back function</em> to get the rest when you <em>need it</em>. So technically it gives you the entire content, but one chunk at a time, and only if you ask for the rest of it.</p>\n\n<p>If Haskell did not have <a href=\"https://wiki.haskell.org/Non-strict_semantics\" rel=\"nofollow\"><em>non-strict semantics</em></a>, you could implement this concept by something like:</p>\n\n<pre><code>data Stream a = Stream [a] (() -&gt; Stream a)\n\ninstance (Show a) =&gt; Show (Stream a) where\n    show (Stream xs _) = show xs ++ \" ...\"\n\nrest :: Stream a -&gt; Stream a -- ask for the rest of the stream\nrest (Stream _ f) = f ()\n</code></pre>\n\n<p>Then say you want a stream which iterates integers. You can return the first 3 and postpone the rest until the user asks for it:</p>\n\n<pre><code>iter :: Int -&gt; Stream Int\niter x = Stream [x, x + 1, x + 2] (\\_ -&gt; iter (x + 3))\n</code></pre>\n\n<p>then,</p>\n\n<pre><code>\\&gt; iter 0\n[0,1,2] ...\n</code></pre>\n\n<p>but if you keep asking for the rest, you get the entire content</p>\n\n<pre><code>\\&gt; take 5 $ iterate rest (iter 0)\n[[0,1,2] ...,[3,4,5] ...,[6,7,8] ...,[9,10,11] ...,[12,13,14] ...]\n</code></pre>\n\n<p>or</p>\n\n<pre><code>\\&gt; let go (Stream [i, j, k] _) acc = i:j:k:acc\n\\&gt; take 20 . foldr go [] $ iterate rest (iter 0)\n[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]\n</code></pre>\n\n<p>That is the same story with <em>line buffering</em> under the hood. It reads and returns the first line, but then you can ask for the next line, and the next line, ... So technically you get the entire content even though it only reads one line at a time.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 0, "last_activity_date": 1456680911, "creation_date": 1456680911, "answer_id": 35685874, "question_id": 35683672, "link": "https://stackoverflow.com/questions/35683672/how-to-understand-stream-in-haskell/35685874#35685874", "title": "How to understand stream in Haskell", "body": "<p>Note that <code>hGetHandle</code> itself never reads <em>anything</em>; it simply returns an <code>IO</code> action that, when ultimately executed, will read from the file. When combined with <code>putStr</code> with <code>hGetContents handle &gt;&gt;= putStr</code> (which is simply the <code>do</code> notation desugared), you get an IO action that takes a handle and outputs its contents to the screen. At no point in the Haskell program itself do you ever specify <em>how</em> that happens; it is entirely up to the Haskell runtime and how it executes the <code>IO</code> action you create.</p>\n"}], "owner": {"reputation": 145, "user_id": 3404325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f3c207f41ff6a694ae6611550989ef6?s=128&d=identicon&r=PG", "display_name": "wwayne", "link": "https://stackoverflow.com/users/3404325/wwayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 531, "favorite_count": 0, "accepted_answer_id": 35684420, "answer_count": 3, "score": 2, "last_activity_date": 1456710253, "creation_date": 1456669465, "last_edit_date": 1456670208, "question_id": 35683672, "link": "https://stackoverflow.com/questions/35683672/how-to-understand-stream-in-haskell", "title": "How to understand stream in Haskell", "body": "<p>I'm reading \u300aLearn you a Haskell for Great Good\u300bchapter 9: Input and Output. There is an example code for explaining stream:</p>\n\n<pre><code>main = do   \n  withFile \"something.txt\" ReadMode (\\handle -&gt; do  \n    contents &lt;- hGetContents handle  \n    putStr contents) \n</code></pre>\n\n<p>The books says :</p>\n\n<blockquote>\n  <p>That's why in this case it actually reads a line, prints it to the\n  output, reads the next line, prints it, etc.</p>\n</blockquote>\n\n<p>But in previous content, for the same example, it also says:</p>\n\n<blockquote>\n  <p>That's really cool because we can treat contents as the whole contents\n  of the file, but it's not really loaded in memory.</p>\n</blockquote>\n\n<p>I'm new to functional programming and I'm really confused about this, why we can take <code>contents</code> as the whole contents if it reads one line in one time? I though the <code>contents</code> in <code>contents &lt;- hGetContents handle</code> is just the content of one line, does Haskell save the content of every line into temporary memory or something else?</p>\n"}, {"tags": ["haskell", "type-families", "data-kinds"], "answers": [{"comments": [{"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1456665782, "post_id": 35683042, "comment_id": 59043480, "body": "Thanks. Just curious, is <code>&#39;True</code> and <code>&#39;False</code> magic or can I define <code>()</code> likewise?"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "reply_to_user": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1456666246, "post_id": 35683042, "comment_id": 59043662, "body": "@Clinton <code>True</code> and <code>False</code> are type synonyms of <code>&#39;True</code> and <code>&#39;False</code>, defined by <code>DataKinds</code> language extension for convenience. It&#39;s OK for Bool but when the type and the constructor have the same name there is ambiguity, so the usually optional single-quote is necessary."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1456679210, "post_id": 35683042, "comment_id": 59048423, "body": "There&#39;s even a fifth <code>()</code> for extra confusion: the empty constraint."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1456679316, "post_id": 35683042, "comment_id": 59048458, "body": "@Clinton, note that it&#39;s considered good style to use the single quote even when it&#39;s optional."}], "tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 6, "last_activity_date": 1456673723, "last_edit_date": 1456673723, "creation_date": 1456665653, "answer_id": 35683042, "question_id": 35682969, "link": "https://stackoverflow.com/questions/35682969/data-type-thats-promotable-to-the-kind-level-with-only-one-value/35683042#35683042", "title": "Data type that&#39;s promotable to the kind level with only one value", "body": "<p>Try use <code>'()</code> instead of <code>()</code> at type level:</p>\n\n<pre><code>type family ToNull t :: ()\ntype instance ToNull Int = '()\ntype instance ToNull Bool = '()\n</code></pre>\n\n<p>Also <code>True</code> and <code>False</code> are actually shorthands for <code>'True</code> and <code>'False</code> at type level.</p>\n\n<p>The problem is there are four <code>()</code> in the scope:</p>\n\n<ol>\n<li>the ordinary type <code>()</code> of kind <code>*</code></li>\n<li>the only constructor of 1 which is also <code>()</code></li>\n<li>the kind <code>()</code> promoted from 1</li>\n<li>the type <code>'()</code> of kind <code>()</code> promoted from 2, which has a type synonym <code>()</code> by default</li>\n</ol>\n\n<p>without the sometimes optional single quote, 1 and 4 are ambiguous.</p>\n\n<p>You may check the user guide of GHC for details:<a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/promotion.html\" rel=\"nofollow\">7.9. Datatype promotion</a></p>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 1, "accepted_answer_id": 35683042, "answer_count": 1, "score": 3, "last_activity_date": 1456673723, "creation_date": 1456665247, "question_id": 35682969, "link": "https://stackoverflow.com/questions/35682969/data-type-thats-promotable-to-the-kind-level-with-only-one-value", "title": "Data type that&#39;s promotable to the kind level with only one value", "body": "<p>I understand I can promote <code>Bool</code> to the kind level like so, where <code>Bool</code> can potentially be <code>True</code> or <code>False</code>:</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE TypeFamilies #-}\n\ntype family TF t :: Bool\ntype instance TF Int = True\ntype instance TF Bool = False\n</code></pre>\n\n<p>I wanted instead to promote <code>()</code>, which of course only has one value <code>()</code>. But this doesn't seem to work:</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE TypeFamilies #-}\n\ntype family TF t :: ()\ntype instance TF Int = ()\ntype instance TF Bool = ()\n</code></pre>\n\n<p>I guess I could just use <code>Bool</code> and <code>True</code>, but is there a one valued type that can be promoted to the kind level?</p>\n"}, {"tags": ["haskell", "text", "encoding", "bytestring"], "comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1456660587, "post_id": 35681771, "comment_id": 59041871, "body": "What about the text <a href=\"https://hackage.haskell.org/package/text-1.2.2.0/docs/Data-Text-Lazy-Builder.html\" rel=\"nofollow noreferrer\"><code>Builder</code></a>?"}], "answers": [{"comments": [{"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 0, "creation_date": 1456660868, "post_id": 35682215, "comment_id": 59041971, "body": "What if I want to construct strict <code>Text</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 0, "creation_date": 1456661488, "post_id": 35682215, "comment_id": 59042160, "body": "@Mark <a href=\"http://hackage.haskell.org/package/text-1.2.2.0/docs/Data-Text-Lazy.html#toStrict\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/text-1.2.2.0/docs/&hellip;</a>"}, {"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 0, "creation_date": 1456661709, "post_id": 35682215, "comment_id": 59042223, "body": "Yes I know about <code>toStrict</code>, but that&#39;s another pass over entire data. Looks like this is the only option, though. Thanks."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1456660640, "creation_date": 1456660640, "answer_id": 35682215, "question_id": 35681771, "link": "https://stackoverflow.com/questions/35681771/how-to-approach-writing-of-custom-decoding-function-from-bytestring-to-text/35682215#35682215", "title": "How to approach writing of custom decoding function from `ByteString` to `Text`", "body": "<p>You can use the <a href=\"http://hackage.haskell.org/package/text-1.2.2.0/docs/Data-Text-Lazy-Builder.html\" rel=\"nofollow\">Builder</a> API, which offers O(1) <code>singleton :: Char -&gt; Builder</code> and O(1) <code>(&lt;&gt;) :: Builder -&gt; Builder -&gt; Builder</code> for efficient construction operations.</p>\n"}], "owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "accepted_answer_id": 35682215, "answer_count": 1, "score": 0, "last_activity_date": 1456662018, "creation_date": 1456658144, "last_edit_date": 1456662018, "question_id": 35681771, "link": "https://stackoverflow.com/questions/35681771/how-to-approach-writing-of-custom-decoding-function-from-bytestring-to-text", "title": "How to approach writing of custom decoding function from `ByteString` to `Text`", "body": "<p>Suppose I wish to write something like this:</p>\n\n<pre><code>-- | Decode a 'ByteString' containing Code Page 437 encoded text.\n\ndecodeCP437 :: ByteString -&gt; Text\ndecodeCP437 = undefined\n</code></pre>\n\n<p>(I know about <code>encoding</code> package, but its dependency list is ridiculous price to pay for this single, and I believe quite trivial function.)</p>\n\n<p>My question is how to construct <code>Text</code> from <code>ByteString</code> with reasonable efficiency, in particular without using lists. It seems to me that <code>Data.Text.Encoding</code> should be a good source for inspiration, but at first sight it uses <code>withForeignPtr</code> and I guess it's too low level for my use case.</p>\n\n<p>How the problem should be approached? In a nutshell, I guess I need to continuously take bytes (<code>Word8</code>) from <code>ByteString</code>, translate every byte to corresponding <code>Char</code>, and somehow efficiently build <code>Text</code> from them. Complexity of <a href=\"http://haddock.stackage.org/lts-5.4/text-1.2.2.0/Data-Text.html#g:6\" rel=\"nofollow\">basic building functions</a> in <code>Data.Text</code> for <code>Text</code> construction not surprisingly indicates that appending characters one by one is not the best idea, but I don't see better tools for this available.</p>\n\n<hr>\n\n<p>Update: I want to create strict <code>Text</code>. It seems that the only option is to create builder then get lazy <code>Text</code> from it (O(n)) and then convert to strict <code>Text</code> (O(n)).</p>\n"}, {"tags": ["parsing", "haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 6, "creation_date": 1456620070, "post_id": 35677210, "comment_id": 59033224, "body": "As I understand, you want <code>biggerThanOne</code> to succeed precisely if both <code>digitChar</code> and <code>notZeroOne</code> would succeed starting from precisely the same point? This is possible (see lookAhead), but in general not really sound - in this case, both parsers parse a single char, and return precisely that char. What if one parser did something with the char first? The output of both parsers would not be the same - which output is returned? What if one consumes more or less output than the other, but both succeed? Where is the final position? You should solve this problem with <code>oneOf [&#39;2&#39;..&#39;9&#39;]</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": true, "score": 7, "last_activity_date": 1456640715, "last_edit_date": 1456640715, "creation_date": 1456640341, "answer_id": 35679447, "question_id": 35677210, "link": "https://stackoverflow.com/questions/35677210/in-megaparsec-is-there-a-way-of-anding-2-parsers/35679447#35679447", "title": "In MegaParsec is there a way of anding 2 parsers?", "body": "<p>As user2407038 suggests in the comments, it's achievable using the <code>lookAhead</code> function.</p>\n\n<pre><code>biggerThanOne :: Parser Char\nbiggerThanOne =\n  lookAhead digitChar *&gt; notZeroOrOne\n</code></pre>\n\n<p>However, the parsers are sequential by nature, so it's both more efficient and comprehendable to apply the sequential logic. E.g., using the <code>Monad</code> instance of <code>Parser</code>:</p>\n\n<pre><code>biggerThanOne :: Parser Char\nbiggerThanOne =\n  do\n    c &lt;- digitChar\n    if c /= '0' &amp;&amp; c /= '1'\n      then return c\n      else unexpected \"Not bigger than one\"\n</code></pre>\n\n<p>Or <code>MonadPlus</code>:</p>\n\n<pre><code>biggerThanOne :: Parser Char\nbiggerThanOne =\n  mfilter (\\c -&gt; c /= '0' &amp;&amp; c /= '1') digitChar\n</code></pre>\n\n<p>which can be refactored to use the <code>Ord</code> instance of <code>Char</code> and pretty much clearly express your intent:</p>\n\n<pre><code>biggerThanOne :: Parser Char\nbiggerThanOne =\n  mfilter (&gt; '1') digitChar\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 334, "user_id": 2685223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI7IO.jpg?s=128&g=1", "display_name": "Doaitse Swierstra", "link": "https://stackoverflow.com/users/2685223/doaitse-swierstra"}, "is_accepted": false, "score": 2, "last_activity_date": 1456667179, "creation_date": 1456667179, "answer_id": 35683296, "question_id": 35677210, "link": "https://stackoverflow.com/questions/35677210/in-megaparsec-is-there-a-way-of-anding-2-parsers/35683296#35683296", "title": "In MegaParsec is there a way of anding 2 parsers?", "body": "<p>In the uu-parsinglib there is an amb combinator, which gives you all possible parses. You can use this to see whether you get both parses. If you get only a single parse you can use a monad to fail</p>\n\n<p>p <code>pAnd</code> q = amb (p &lt;|> q) >>= \\ r -> if length r == 2 then return ... else pFail</p>\n"}], "owner": {"reputation": 371, "user_id": 5589037, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8e0afcaf170b7c13a53093cf2f5f84c?s=128&d=identicon&r=PG&f=1", "display_name": "John Walker", "link": "https://stackoverflow.com/users/5589037/john-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 35679447, "answer_count": 2, "score": 4, "last_activity_date": 1456667179, "creation_date": 1456618982, "question_id": 35677210, "link": "https://stackoverflow.com/questions/35677210/in-megaparsec-is-there-a-way-of-anding-2-parsers", "title": "In MegaParsec is there a way of anding 2 parsers?", "body": "<p>If I have a parser like:</p>\n\n<pre><code>notZeroOrOne :: Parser Char\nnotZeroOrOne = noneOf ['0' , '1'] \n</code></pre>\n\n<p>Is there a way I can combine the rules of another parser like digitChar so I can get a parser that will only pass if both parsers would pass?</p>\n\n<p>Something like</p>\n\n<pre><code>biggerThanOne :: Parser Char\nbiggerThanOne  = digitChar &amp;&amp; notZeroOrOne \n</code></pre>\n"}, {"tags": ["json", "haskell", "haskell-persistent", "servant"], "answers": [{"comments": [{"owner": {"reputation": 6788, "user_id": 1748754, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jjk7p.jpg?s=128&g=1", "display_name": "erewok", "link": "https://stackoverflow.com/users/1748754/erewok"}, "edited": false, "score": 0, "creation_date": 1456621505, "post_id": 35677153, "comment_id": 59033514, "body": "Wow. Thank you for the answer and the explanation. I had an aborted attempt in this direction, but I just kept assuming that my Post object would be able to do the <code>JOIN</code> somehow because the FK is non-nullable. I totally understand what you have written here. Still, it seems a bit inefficient: two queries to update one <code>Article</code> object? Is there a better way?"}, {"owner": {"reputation": 6788, "user_id": 1748754, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jjk7p.jpg?s=128&g=1", "display_name": "erewok", "link": "https://stackoverflow.com/users/1748754/erewok"}, "edited": false, "score": 0, "creation_date": 1456621800, "post_id": 35677153, "comment_id": 59033569, "body": "Actually, I think I can imagine how I might do it. By the way, I had two minor corrections here to get it to compile. I&#39;ll post the corrected version as an edit, above. Thanks again."}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "reply_to_user": {"reputation": 6788, "user_id": 1748754, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jjk7p.jpg?s=128&g=1", "display_name": "erewok", "link": "https://stackoverflow.com/users/1748754/erewok"}, "edited": false, "score": 0, "creation_date": 1456622297, "post_id": 35677153, "comment_id": 59033660, "body": "you&#39;ll have to use esqueleto, the companion sql library, for that. persistent is a generic datastore library and its design simply lacks joins"}, {"owner": {"reputation": 6788, "user_id": 1748754, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jjk7p.jpg?s=128&g=1", "display_name": "erewok", "link": "https://stackoverflow.com/users/1748754/erewok"}, "edited": false, "score": 0, "creation_date": 1456623401, "post_id": 35677153, "comment_id": 59033870, "body": "Ah. Thank you for the suggestion."}], "tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 4, "last_activity_date": 1456618591, "creation_date": 1456618591, "answer_id": 35677153, "question_id": 35676855, "link": "https://stackoverflow.com/questions/35676855/represent-foreign-key-relationship-in-json-using-servant-and-persistent/35677153#35677153", "title": "Represent Foreign Key Relationship in JSON using Servant and Persistent", "body": "<p>For some record type <code>r</code>, <a href=\"https://hackage.haskell.org/package/persistent-2.2.4/docs/Database-Persist-Types.html#t:Entity\" rel=\"nofollow\"><code>Entity r</code></a> is the datatype containing <code>Key r</code> and <code>r</code>. You can think of it as a dollied-up tuple <code>(Key r, r)</code>. </p>\n\n<p>(You might wonder what <code>Key r</code> is. Different backends have different kinds of <code>Key r</code>. For Postgres it'll be a 64-bit integer. For MongoDB there are object IDs. The <a href=\"https://hackage.haskell.org/package/persistent-2.2.4/docs/Database-Persist-Class.html#t:Key\" rel=\"nofollow\">documentation goes into more detail</a>. It's an abstraction that allows Persistent to support multiple datastores.)</p>\n\n<p>Your problem here is that you have a <code>Key User</code>. Our strategy will be to get you an <code>Entity User</code>, from which we'll be able to pull out a <code>User</code>. Fortunately, going from <code>Key User</code> to <code>Entity User</code> is easy with a <code>selectFirst</code> \u2013 a trip to the database. And going from <code>Entity User</code> to <code>User</code> is one pattern match.</p>\n\n\n\n<pre><code>postToArticle :: MonadIO m =&gt; Post -&gt; SqlPersistT m (Maybe Article)\npostToArticle Post{..} = do\n  authorMaybe &lt;- selectFirst [UserId ==. postUser] []\n  return $ case authorMaybe of\n    Just (Entity _ author) -&gt;  \n      Article {\n          title = postTitle\n        , author = author\n        , summary = postSummary\n        , content = postContent\n        }\n    Nothing -&gt;\n      Nothing\n</code></pre>\n\n<h2>Gross, more generic version</h2>\n\n<p>We assumed a SQL backend above, but that function also has the more generic type</p>\n\n<pre><code>postToArticle ::\n  (MonadIO m, PersistEntity val, backend ~ PersistEntityBackend val) =&gt;\n  Post -&gt; ReaderT backend m (Maybe Article)\n</code></pre>\n\n<p>Which you might need if you're not using a SQL backend.</p>\n"}, {"comments": [{"owner": {"reputation": 6788, "user_id": 1748754, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jjk7p.jpg?s=128&g=1", "display_name": "erewok", "link": "https://stackoverflow.com/users/1748754/erewok"}, "edited": false, "score": 0, "creation_date": 1456721095, "post_id": 35687865, "comment_id": 59061589, "body": "I completely agree that we&#39;d ideally want the <code>postToArticle</code> function to be a pure function. I like all of the options you have presented here. They seem much nicer than the direction I was headed in before. Thank you for adding all of this commentary and helping me flesh it out."}], "tags": [], "owner": {"reputation": 2567, "user_id": 3780203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3f3f9ab585dc56fa27e203ce4eb27fd?s=128&d=identicon&r=PG&f=1", "display_name": "ephrion", "link": "https://stackoverflow.com/users/3780203/ephrion"}, "is_accepted": false, "score": 2, "last_activity_date": 1456691336, "creation_date": 1456691336, "answer_id": 35687865, "question_id": 35676855, "link": "https://stackoverflow.com/questions/35676855/represent-foreign-key-relationship-in-json-using-servant-and-persistent/35687865#35687865", "title": "Represent Foreign Key Relationship in JSON using Servant and Persistent", "body": "<p>You don't really need to create a separate data type for each model. It can be helpful to decouple the database model and the API model, especially if the database model has stuff you don't sending over the wire. I didn't want passwords to be included with Users, so I made the Person data type. </p>\n\n<p>The Yesod book has a good explanation of the <code>Entity</code> stuff <a href=\"http://www.yesodweb.com/book/persistent#persistent_insert\" rel=\"nofollow\">here</a>.</p>\n\n<p>If you just want to get a single item and you have a key for it, the <a href=\"https://hackage.haskell.org/package/persistent-2.2.4/docs/Database-Persist-Class.html\" rel=\"nofollow\">Persistent type class haddocks</a> tell us about a <code>get</code> method that does precisely that.</p>\n\n<p>So, if you do want to make the <code>Article</code> type, then there are a few options. You could change the <code>articleUser</code> to be a <code>Key User</code> or <code>Int64</code> or whatever. This is probably what I'd do -- if I wanted to send a list of articles, I wouldn't want to include the user information for each one!</p>\n\n<p>If you want to keep it as an actual user object, then we'll want to extract the query out of the <code>postToArticle</code> function. Ideally that should be a pure function: <code>postToArticle :: Post -&gt; Article</code>. We can do that by also passing in the <code>Person</code>:</p>\n\n<pre><code>postToArticle :: Person -&gt; Post -&gt; Article\npostToArticle person Post{..} = Article\n    { ...\n    }\n</code></pre>\n\n<p>Of course, this function can't verify that you passed in the <em>right</em> person. You could do:</p>\n\n<pre><code>postToArticle' :: Entity User -&gt; Post -&gt; Maybe Article\npostToArticle' (Entity userKey user) post\n    | userKey /= postUser post =\n        Nothing\n    | otherwise =\n        Just (postToArticle (userToPerson user) post)\n</code></pre>\n\n<p>as a safer option.</p>\n"}], "owner": {"reputation": 6788, "user_id": 1748754, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jjk7p.jpg?s=128&g=1", "display_name": "erewok", "link": "https://stackoverflow.com/users/1748754/erewok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 1, "accepted_answer_id": 35677153, "answer_count": 2, "score": 3, "last_activity_date": 1456691336, "creation_date": 1456616324, "last_edit_date": 1495542225, "question_id": 35676855, "link": "https://stackoverflow.com/questions/35676855/represent-foreign-key-relationship-in-json-using-servant-and-persistent", "title": "Represent Foreign Key Relationship in JSON using Servant and Persistent", "body": "<p>This morning I was following along with <a href=\"http://www.parsonsmatt.org/2015/06/07/servant-persistent.html\" rel=\"nofollow noreferrer\">this interesting tutorial</a> on using Servant to build a simple API server.</p>\n\n<p>At the end of the tutorial, the author suggests adding a Blog type, so I figured I would give it a shot, but I got stuck trying to implement and serialize a foreign key relationship that extends upon the logic in the tutorial (perhaps an important disclosure here: I'm new to both Servant and Persistent).</p>\n\n<p>Here are my Persistent definitions (I added the <code>Post</code>):</p>\n\n<pre><code>share [mkPersist sqlSettings, mkMigrate \"migrateAll\"] [persistLowerCase|\nUser\n    name String\n    email String\n    deriving Show\nPost\n    title String\n    user UserId\n    summary String\n    content String\n    deriving Show\n|]\n</code></pre>\n\n<p>The tutorial builds a separate <code>Person</code> data type for the Servant API, so I added one called <code>Article</code> as well:</p>\n\n<pre><code>-- API Data Types\ndata Person = Person\n    { name :: String\n    , email :: String\n    } deriving (Eq, Show, Generic)\n\ndata Article = Article\n    { title :: String\n    , author :: Person\n    , summary :: String\n    , content :: String\n    } deriving (Eq, Show, Generic)\n\ninstance ToJSON Person\ninstance FromJSON Person\n\ninstance ToJSON Article\ninstance FromJSON Article\n\nuserToPerson :: User -&gt; Person\nuserToPerson User{..} = Person { name = userName, email = userEmail }\n</code></pre>\n\n<p>Now, however, when I attempt to create a function that turns a <code>Post</code> into an <code>Article</code>, I get stuck trying to deal with the <code>User</code> foreign key:</p>\n\n<pre><code>postToArticle :: Post -&gt; Article\npostToArticle Post{..} = Article {\n  title = postTitle\n  , author = userToPerson postUser -- this fails\n  , summary = postSummary\n  , content = postContent\n  }\n</code></pre>\n\n<p>I tried a number of things, but the above seemed to be close to the direction I'd like to go in. It doesn't compile, however, due to the following the error:</p>\n\n<pre><code>Couldn't match expected type \u2018User\u2019\n            with actual type \u2018persistent-2.2.2:Database.Persist.Class.PersistEntity.Key\n                                User\u2019\nIn the first argument of \u2018userToPerson\u2019, namely \u2018postUser\u2019\nIn the \u2018author\u2019 field of a record\n</code></pre>\n\n<p>Ultimately, I'm not really sure what a <code>PersistEntity.Key User</code> really is and my errant googling has not gotten me much closer. </p>\n\n<p>How do I deal with this foreign-key relationship?</p>\n\n<hr>\n\n<p><strong>Working Version</strong></p>\n\n<p>Edited with an answer thanks to <a href=\"https://stackoverflow.com/users/3963/haoformayor\">haoformayor</a></p>\n\n<pre><code>postToArticle :: MonadIO m =&gt; Post -&gt; SqlPersistT m (Maybe Article)\npostToArticle Post{..} = do\n  authorMaybe &lt;- selectFirst [UserId ==. postUser] []\n  return $ case authorMaybe of\n    Just (Entity _ author) -&gt;\n      Just Article {\n          title = postTitle\n        , author = userToPerson author\n        , summary = postSummary\n        , content = postContent\n        }\n    Nothing -&gt;\n      Nothing\n</code></pre>\n"}, {"tags": ["unix", "haskell", "vim", "ghci", "hdevtools"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 2, "creation_date": 1456614848, "post_id": 35676312, "comment_id": 59031973, "body": "make sure  <code>which hdevtools</code> shows <code>~&#47;.local&#47;bin&#47;hdevtools</code>, make sure to load a new shell or do an <code>export PATH...</code> in your old shell"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3773571"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1456638985, "post_id": 35676312, "comment_id": 59036571, "body": "@jberryman <code>which hdevtools</code> shows nothing so it looks like I&#39;ve done something wrong; I&#39;m not sure why though as <code>ls ~&#47;.local&#47;bin</code> outputs <code>hdevtools</code> and I have <code>export PATH=&quot;~&#47;.stack&#47;programs&#47;x86_64-osx&#47;ghc-7.10.3&#47;bin&#47;ghc:~&#47;.loc&zwnj;&#8203;al&#47;bin:$PATH&quot;</code> in my <code>.bash_profile</code>. Any ideas?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456661945, "post_id": 35676312, "comment_id": 59042275, "body": "have you started a new bash since? (<code>source ~&#47;.bash_profile</code> should do as well)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3773571"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456688769, "post_id": 35676312, "comment_id": 59052277, "body": "@Carsten Yep. No dice."}, {"owner": {"reputation": 2838, "user_id": 4959010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2QtsW.png?s=128&g=1", "display_name": "Sato Katsura", "link": "https://stackoverflow.com/users/4959010/sato-katsura"}, "edited": false, "score": 1, "creation_date": 1456691591, "post_id": 35676312, "comment_id": 59053305, "body": "Try <code>export PATH=&quot;$HOME&#47;...&quot;</code> instead of <code>export PATH=&quot;~&#47;...&quot;</code>.  <code>~</code> is not expanded inside double quotes."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3773571"}, "reply_to_user": {"reputation": 2838, "user_id": 4959010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2QtsW.png?s=128&g=1", "display_name": "Sato Katsura", "link": "https://stackoverflow.com/users/4959010/sato-katsura"}, "edited": false, "score": 0, "creation_date": 1456700265, "post_id": 35676312, "comment_id": 59056566, "body": "@SatoKatsura Yay! That did the trick. Thank you. If you want to re-post this as an &quot;Answer&quot;, I&#39;ll pick it so you get the points."}], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 1, "last_activity_date": 1456669885, "creation_date": 1456669885, "answer_id": 35683743, "question_id": 35676312, "link": "https://stackoverflow.com/questions/35676312/haskell-hdevtools-is-not-executable-error/35683743#35683743", "title": "Haskell `hdevtools is not executable!` error", "body": "<p>I am not sure but I had a similar issue using the ghc provided by the ppa:hvr package which installs the ghc in <code>/usr/opt/ghc/</code> </p>\n\n<p>I linked</p>\n\n<ul>\n<li><code>/opt/ghc/7.10.3/bin/</code> -> <code>/home/epsilonhalbe/bin/ghc/</code></li>\n<li><code>/home/epsilonhalbe/.local/bin</code> -> <code>/home/epsilonhalbe/bin/util</code></li>\n</ul>\n\n<p>then i added the following to my <code>.vimrc</code></p>\n\n<pre><code>\" ADJUST PATH {{{\nif (index(split($PATH,':'),'/home/epsilonhalbe/bin') &lt; 0)\n    let $PATH = '/home/epsilonhalbe/bin' . ':' . $PATH\nendif\nif (index(split($PATH,':'),'/home/epsilonhalbe/bin/ghc') &lt; 0)\n    let $PATH = '/home/epsilonhalbe/bin/ghc' . ':' . $PATH\nendif\nif (index(split($PATH,':'),'/home/epsilonhalbe/bin/util') &lt; 0)\n    let $PATH = '/home/epsilonhalbe/bin/util' . ':' . $PATH\nendif\n\" }}}\n</code></pre>\n\n<p>maybe this helps.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3773571"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1456669885, "creation_date": 1456612537, "question_id": 35676312, "link": "https://stackoverflow.com/questions/35676312/haskell-hdevtools-is-not-executable-error", "title": "Haskell `hdevtools is not executable!` error", "body": "<h1>Problem</h1>\n\n<p>I'm trying to set up hdevtools for piping GHC errors into my editor linter (so that you don\u2019t have to continually run <code>:r</code> in GHCi to see errors). I have run into a <code>hdevtools is not executable!</code> error.</p>\n\n<h1>Question</h1>\n\n<p>Does anyone know what I\u2019ve done wrong or what I can do to get this working? I'm not sure if this is a problem with the way I set up GHC and/or hdevtools, or if this is a problem with the permission settings of my directories or something...</p>\n\n<h1>Background info</h1>\n\n<ul>\n<li>Here is what the error and setup looks like:\n<a href=\"https://i.stack.imgur.com/KWo6u.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KWo6u.png\" alt=\"enter image description here\"></a></li>\n<li>To get to this point, I followed the the instructions from <a href=\"http://seanhess.github.io/2015/08/05/practical-haskell-editors.html\" rel=\"nofollow noreferrer\">http://seanhess.github.io/2015/08/05/practical-haskell-editors.html</a>. Basically, I ran <code>brew install ghc</code>, <code>brew install haskell-stack</code>, <code>stack setup</code>, <code>stack install hdevtools</code>, and updated my path as show in the picture above ^</li>\n<li>I'm brand new to Haskell. Been tinkering for a couple weeks.</li>\n<li>I'm on OSX</li>\n<li>It should be unrelated, but I\u2019m using Syntastic with Vim + <a href=\"https://github.com/bitc/vim-hdevtools\" rel=\"nofollow noreferrer\">vim-hdevtools</a>.</li>\n</ul>\n"}, {"tags": ["haskell", "leksah"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1456598202, "post_id": 35673617, "comment_id": 59026456, "body": "could you show us your <code>ghc --version</code>, <code>cabal --version</code>, <code>ghc-pkg list</code>, did you try to use <code>stack</code>?"}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1456598814, "post_id": 35673617, "comment_id": 59026707, "body": "seconding the above suggestion. there&#39;s a <code>stack.yaml</code> which means it should Just Work if you hit <code>stack build</code> after installing <a href=\"https://github.com/commercialhaskell/stack\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack</a>"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1456607689, "post_id": 35673617, "comment_id": 59029746, "body": "Somehow the package <code>webkit-javascriptcore</code> managed to sneak into the build plan, but it doesn&#39;t appear to be a dependency (or transitive dependency) of the latest version of leksah. At the very least, you should install in a cabal sandbox - the state of your global package database is simply incompatible with leksah. There is pretty much never any reason to <i>not</i> use a sandbox (or stack) anymore - installing anything in the global package db (especially when it&#39;s something with 100+ dependencies) is just <i>asking</i> for trouble."}], "owner": {"reputation": 480, "user_id": 2681876, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fe6ef986f3390388cf5c6b527b31cd5d?s=128&d=identicon&r=PG&f=1", "display_name": "BillyBadBoy", "link": "https://stackoverflow.com/users/2681876/billybadboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1456597379, "creation_date": 1456597379, "question_id": 35673617, "link": "https://stackoverflow.com/questions/35673617/cannot-build-leksah-0-15-2-0-on-linux", "title": "Cannot build leksah 0.15.2.0 on linux", "body": "<p>When I try to build the latest leksah (using <a href=\"https://github.com/leksah/leksah#building-on-linux\" rel=\"nofollow\">these instructions</a>), I get this error:</p>\n\n<pre><code>src/IDE/TextEditor/CodeMirror.hs:225:38-56:\n    Couldn't match type \u2018Graphics.UI.Gtk.WebKit.JavaScriptCore.JSBase.OpaqueJSContext\u2019\n                   with \u2018webkit-javascriptcore-0.13.1.1:Graphics.UI.Gtk.WebKit.JavaScriptCore.JSBase.OpaqueJSContext\u2019\n    NB: \u2018Graphics.UI.Gtk.WebKit.JavaScriptCore.JSBase.OpaqueJSContext\u2019\n          is defined in \u2018Graphics.UI.Gtk.WebKit.JavaScriptCore.JSBase\u2019\n              in package \u2018webkitgtk3-javascriptcore-0.13.1.0\u2019\n        \u2018webkit-javascriptcore-0.13.1.1:Graphics.UI.Gtk.WebKit.JavaScriptCore.JSBase.OpaqueJSContext\u2019\n          is defined in \u2018Graphics.UI.Gtk.WebKit.JavaScriptCore.JSBase\u2019\n              in package \u2018webkit-javascriptcore-0.13.1.1\u2019\n    Expected type: JSContextRef\n      Actual type: Graphics.UI.Gtk.WebKit.JavaScriptCore.JSBase.JSGlobalContextRef\n    In the \u2018cmContext\u2019 field of a record\n    In the second argument of \u2018($)\u2019, namely \u2018CodeMirrorState {..}\u2019\ncabal: Error: some packages failed to install:\nleksah-0.15.2.0 failed during the building phase. The exception was:\nExitFailure 1\n</code></pre>\n\n<p>Does anyone know how to fix this?</p>\n"}, {"tags": ["haskell", "null", "runtime", "ghc"], "answers": [{"comments": [{"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1456591649, "post_id": 35672239, "comment_id": 59023858, "body": "So GHC does not give <code>Void</code> any run time representation at all? What if I ask GHC how much space <code>Void</code> is supposed to take?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 4, "creation_date": 1456592552, "post_id": 35672239, "comment_id": 59024161, "body": "There can be <code>t :: Void</code> but all such <code>t</code> terms throw or loop or are unsafely coerced from something else. We don&#39;t define a <code>Void</code> constructor, so naturally there&#39;s no such thing. You can&#39;t ask GHC about <code>Void</code>&#39;s size as it is, because all unlifted values have the exact same size. What we can do is <a href=\"https://hackage.haskell.org/package/ghc-datasize-0.1.2/docs/GHC-DataSize.html\" rel=\"nofollow noreferrer\">inspect</a> runtime closures/objects and compute sizes in various ways. Runtime computed sizes for <code>t :: Void</code> would dependent on the specific object behind <code>t</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 1, "creation_date": 1456596585, "post_id": 35672239, "comment_id": 59025882, "body": "@PyRulez How do you plan to ask that question?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1456599572, "post_id": 35672239, "comment_id": 59026964, "body": "Edit: I mean <i>lifted</i> values have the same size."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1456603998, "post_id": 35672239, "comment_id": 59028498, "body": "@PyRulez The representation of <code>Void</code> is identical to that of any other lifted type: a pointer to some sort of heap object. The only special thing about <code>Void</code> is that that heap object will never turn out to be a data constructor, since <code>Void</code> has none."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1456605433, "post_id": 35672239, "comment_id": 59029027, "body": "It&#39;s only semi-special; you can make all sorts of similarly bottom-only types. <code>data Zero</code>, <code>Int :~: Bool</code>, etc."}], "tags": [], "owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "is_accepted": false, "score": 14, "last_activity_date": 1456590414, "creation_date": 1456590414, "answer_id": 35672239, "question_id": 35672193, "link": "https://stackoverflow.com/questions/35672193/how-does-ghc-represent-undefined-void-at-run-time/35672239#35672239", "title": "How does GHC represent `undefined :: Void` at run-time?", "body": "<p>The same way all unevaluated expressions are represented, namely with a pointer to a thunk.  When the thunk is evaluated it will throw an exception. </p>\n"}, {"tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": false, "score": 2, "last_activity_date": 1456596678, "last_edit_date": 1456596678, "creation_date": 1456596141, "answer_id": 35673400, "question_id": 35672193, "link": "https://stackoverflow.com/questions/35672193/how-does-ghc-represent-undefined-void-at-run-time/35673400#35673400", "title": "How does GHC represent `undefined :: Void` at run-time?", "body": "<p>Unlike C++ and some other modern OO languages, Haskell with GHC does not bring types to runtime, type information was used in type checks during compilation then lost. <code>Void</code> doesn't have any constructors or meaningful inhabitants so it simply doesn't exist at runtime.</p>\n\n<p><code>undefined</code> is of bottom type, as bottom is the inhabitant of every data type (or bottom is the subtype of every data type), it will pass the compilation regardless of its expected type, therefore <code>undefined :: Void</code> and any other <code>undefined :: T</code> are the same thing at runtime namely a pointer to an thunk that raises exception when evaluated.</p>\n"}], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1456604500, "creation_date": 1456590188, "last_edit_date": 1456604500, "question_id": 35672193, "link": "https://stackoverflow.com/questions/35672193/how-does-ghc-represent-undefined-void-at-run-time", "title": "How does GHC represent `undefined :: Void` at run-time?", "body": "<p>The <a href=\"https://hackage.haskell.org/package/void/docs/Data-Void.html#t:Void\" rel=\"nofollow\"><code>Void</code></a> type has no values, besides <code>undefined</code>. How does GHC represent <code>undefined :: Void</code> at runtime?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 1676, "user_id": 1945967, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c6e835f2923067903af0e8972fe64e88?s=128&d=identicon&r=PG", "display_name": "tomdavies", "link": "https://stackoverflow.com/users/1945967/tomdavies"}, "reply_to_user": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 1, "creation_date": 1456590751, "post_id": 35671876, "comment_id": 59023522, "body": "No. I stumbled upon those expressions in multiple contexts referring to (I think) the same thing. I just want to make sure."}, {"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 4, "creation_date": 1456591139, "post_id": 35671876, "comment_id": 59023670, "body": "&quot;function literal&quot; is not a term that&#39;s really used in the Haskell world, but yes they are essentially the same things if you take their meanings from the JavaScript."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1456592845, "post_id": 35671876, "comment_id": 59024280, "body": "X literal means a simple expression with type X, excluding composite expressions (like <code>1+2</code>) and variables. A lambda expression/anonymous function fits exactly this definition."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1456593095, "post_id": 35671876, "comment_id": 59024364, "body": "Also, with constructs such as higher-order functions like <code>compose</code>, pattern matching, and partial application, there is less need for explicit lambda expressions."}, {"owner": {"reputation": 1676, "user_id": 1945967, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c6e835f2923067903af0e8972fe64e88?s=128&d=identicon&r=PG", "display_name": "tomdavies", "link": "https://stackoverflow.com/users/1945967/tomdavies"}, "edited": false, "score": 0, "creation_date": 1456596714, "post_id": 35671876, "comment_id": 59025933, "body": "@all Thank you very much :)."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 5, "last_activity_date": 1456604634, "creation_date": 1456604634, "answer_id": 35675017, "question_id": 35671876, "link": "https://stackoverflow.com/questions/35671876/is-function-literal-the-same-thing-as-lambda-expression-and-anonymous-function/35675017#35675017", "title": "Is function literal the same thing as Lambda expression and anonymous function?", "body": "<p>This is adequately answered in the comments:</p>\n\n<p>\"function literal\" is not a term that's really used in the Haskell world, but yes they are essentially the same things if you take their meanings from the JavaScript. \u2013 Will Sewell 3 hours ago</p>\n\n<p><code>X</code> literal means a simple expression with type <code>X</code>, excluding composite expressions (like <code>1+2</code>) and variables. A lambda expression/anonymous function fits exactly this definition. \u2013 Bakuriu 3 hours ago</p>\n"}], "owner": {"reputation": 1676, "user_id": 1945967, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c6e835f2923067903af0e8972fe64e88?s=128&d=identicon&r=PG", "display_name": "tomdavies", "link": "https://stackoverflow.com/users/1945967/tomdavies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 35675017, "answer_count": 1, "score": 3, "last_activity_date": 1456604634, "creation_date": 1456588634, "last_edit_date": 1456589741, "question_id": 35671876, "link": "https://stackoverflow.com/questions/35671876/is-function-literal-the-same-thing-as-lambda-expression-and-anonymous-function", "title": "Is function literal the same thing as Lambda expression and anonymous function?", "body": "<p>Is <strong>function literal</strong> the same thing as <strong>Lambda expression</strong> and <strong>anonymous function</strong>?</p>\n"}, {"tags": ["json", "haskell", "aeson"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 6, "creation_date": 1456580578, "post_id": 35669080, "comment_id": 59020076, "body": "I would recommend you parse the literal json object, references and all, then convert it to whichever form you like. You can do this easily by making <code>House</code> parameterized: <code>data House a = House { a :: person, ..}</code>. You then write a parser for <code>City PersonId</code> and have a function <code>City PersonId -&gt; City Person</code>. What advantage will you gain from writing code which simultaneously tries to do these two things? I can&#39;t see any. There are at least two disadvantages: wildly increased code complexity, and reduced maintainability."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1456580875, "post_id": 35669080, "comment_id": 59020203, "body": "Why not place all persons in an imap by ID, which you can just look up."}], "answers": [{"tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": true, "score": 1, "last_activity_date": 1456645546, "last_edit_date": 1456645546, "creation_date": 1456645193, "answer_id": 35679992, "question_id": 35669080, "link": "https://stackoverflow.com/questions/35669080/resolving-references-while-parsing-a-json-document-with-aeson/35679992#35679992", "title": "Resolving references while parsing a JSON document with Aeson", "body": "<p>This untrivial task makes a perfect opportunity to exhibit the power and flexibility of the alternative <a href=\"http://hackage.haskell.org/package/aeson-value-parser\" rel=\"nofollow\">\"aeson-value-parser\" library</a>, which provides a DSL based around the typical Monadic/Applicative parsers.</p>\n\n<p>The following output:</p>\n\n<pre><code>Right (City {cityPersons = [Person {personId = \"343\", personName = \"John\"}], cityHouses = [House {houseOwner = Person {personId = \"343\", personName = \"John\"}, houseAddress = \"Charing Cross\"}]})\n</code></pre>\n\n<p>is what the following program produces:</p>\n\n<pre><code>{-# LANGUAGE NoImplicitPrelude #-}\n\n-- A richer prelude from \"rebase\"\nimport Rebase.Prelude\n-- The parser API from \"aeson-value-parser\"\nimport Aeson.ValueParser\n-- A reexport of the original API of \"unordered-containers\" from \"rebase\"\nimport qualified Rebase.Data.HashMap.Strict\n-- From \"aeson\"\nimport qualified Data.Aeson\n\n\nmain =\n  print $\n  run city $\n  fromJust $\n  Data.Aeson.decode $\n  \"{\\\"persons\\\":[{\\\"id\\\":\\\"343\\\",\\\"name\\\":\\\"John\\\",\\\"age\\\":\\\"45\\\"}],\\\"houses\\\":[{\\\"owner_id\\\":\\\"343\\\",\\\"address\\\":\\\"Charing Cross\\\"}]}\"\n\n\n-- * Model\n-------------------------\n\ndata City =\n  City { cityPersons :: [Person], cityHouses :: [House] }\n  deriving (Show)\n\ndata Person =\n  Person { personId :: Text, personName :: Text }\n  deriving (Show)\n\ndata House =\n  House { houseOwner :: Person, houseAddress :: Text }\n  deriving (Show)\n\n\n-- * Parsers\n-------------------------\n\ncity :: Value City\ncity =\n  object $ do\n    theTable &lt;- field \"persons\" personsLookupTable\n    theHouses &lt;- field \"houses\" (houses theTable)\n    return (City (Rebase.Data.HashMap.Strict.elems theTable) theHouses)\n\n-- |\n-- &gt;[  \n-- &gt;  { \"id\":\"343\", \"name\":\"John\", \"age\":\"45\" }\n-- &gt;]\npersonsLookupTable :: Value (HashMap Text Person)\npersonsLookupTable =\n  array $\n  foldlElements step init personsLookupTableRow\n  where\n    init =\n      Rebase.Data.HashMap.Strict.empty\n    step table (key, person) =\n      Rebase.Data.HashMap.Strict.insert key person table\n\n-- |\n-- &gt;{ \"id\":\"343\", \"name\":\"John\", \"age\":\"45\" }\npersonsLookupTableRow :: Value (Text, Person)\npersonsLookupTableRow =\n  object $\n  (\\id name -&gt; (id, Person id name)) &lt;$&gt; id &lt;*&gt; name\n  where\n    id =\n      field \"id\" string\n    name =\n      field \"name\" string\n\n-- |\n-- &gt;[  \n-- &gt;  { \"owner_id\":\"343\" \"address\":\"Charing Cross\" }\n-- &gt;]\nhouses :: HashMap Text Person -&gt; Value [House]\nhouses personsLookupTable =\n  array $\n  foldrElements (:) [] (house personsLookupTable)\n\n-- |\n-- Parses the \\\"house\\\" object, using a 'Person' lookup table. \n-- E.g.,\n-- &gt;{ \"owner_id\":\"343\" \"address\":\"Charing Cross\" }\nhouse :: HashMap Text Person -&gt; Value House\nhouse personsLookupTable =\n  object $\n  House &lt;$&gt; owner &lt;*&gt; address\n  where\n    owner =\n      field \"owner_id\" (personByID personsLookupTable)\n    address =\n      field \"address\" string\n\n-- |\n-- Given an ID-lookup table consumes the ID and produces the lookup result.\n-- Fails if any of those operations fail.\npersonByID :: HashMap Text Person -&gt; Value Person\npersonByID lookupTable =\n  string &gt;&gt;= lookup\n  where\n    lookup key =\n      maybe mzero return $\n      Rebase.Data.HashMap.Strict.lookup key lookupTable\n</code></pre>\n"}], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 35679992, "answer_count": 1, "score": 1, "last_activity_date": 1456645546, "creation_date": 1456572142, "last_edit_date": 1456572466, "question_id": 35669080, "link": "https://stackoverflow.com/questions/35669080/resolving-references-while-parsing-a-json-document-with-aeson", "title": "Resolving references while parsing a JSON document with Aeson", "body": "<p>I have a JSON document like the following:</p>\n\n<pre><code>{  \n   \"persons\":[  \n      {  \"id\":\"343\", \"name\":\"John\", \"age\":\"45\" }\n   ],\n   \"houses\":[  \n      {  \"owner_id\":\"343\" \"address\":\"Charing Cross\" }\n   ]\n}\n</code></pre>\n\n<p>And Haskell datatypes like the following:</p>\n\n<pre><code>data City = City { persons :: [Person], houses :: [Houses] }\n\ndata Person = Person { personId :: Text, name :: Text }\n\ndata House = House { owner :: Person, address :: Text }\n</code></pre>\n\n<p>While parsing Aeson's <a href=\"http://hackage.haskell.org/package/aeson-0.11.0.0/docs/Data-Aeson.html#t:Value\" rel=\"nofollow\"><code>Value</code></a> object, I want to resolve the <code>owner_id</code> references in <code>houses</code> and turn them into full-fledged <code>Person</code> values.</p>\n\n<p>Usually I construct Aeson parsers with nice operators like <a href=\"http://hackage.haskell.org/package/aeson-0.11.0.0/docs/Data-Aeson.html#v:.:\" rel=\"nofollow\"><code>(.:)</code></a>, but the need to resolve references seems to complicate things here. </p>\n\n<p>Is there a way to define a <code>Parser City</code> implementation that does not resort to looking up keys in the underlying <code>HashMap</code> of the JSON object?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "is_accepted": true, "score": 9, "last_activity_date": 1456564722, "last_edit_date": 1456564722, "creation_date": 1456556787, "answer_id": 35666848, "question_id": 35666703, "link": "https://stackoverflow.com/questions/35666703/how-do-we-concisely-define-eq-based-on-a-function/35666848#35666848", "title": "How do we concisely define Eq based on a function?", "body": "<p>The way this is done is to reproduce your <code>equalityOn</code> function inline, using <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Function.html#v:on\" rel=\"nofollow noreferrer\"><code>Data.Function.on</code></a>, which has the type</p>\n\n<pre><code>on :: (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c\n</code></pre>\n\n<p>This function generalizes <code>comparing</code>:</p>\n\n<pre><code>(.*.) `on` f = \\x y -&gt; f x .*. f y\n</code></pre>\n\n<p>(which is <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/src/Data.Function.html#on\" rel=\"nofollow noreferrer\">literally the implementation</a> from base).  Thus, we have <code>comparing = (compare `on`)</code>; <code>on</code> lifts any binary function by applying it to the results of a unary function.</p>\n\n<p>So <code>equalityOn</code> is just <code>((==) `on`)</code>, and your example instance becomes</p>\n\n<pre><code>import Data.Function\n\ninstance Eq A =&gt; Eq B where\n  (==) = (==) `on` f\n</code></pre>\n\n<hr>\n\n<p>The proposal to add an <code>equating :: Eq a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Bool</code> (the more common name for your <code>equalityOn</code>) apparently comes up periodically; <a href=\"https://mail.haskell.org/pipermail/libraries/2014-July/023283.html\" rel=\"nofollow noreferrer\">here's an example thread from July 2014</a>.  The general consensus seems to be (repeatedly) that <code>((==) `on`)</code> is preferable instead, although not necessarily by a huge margin.  Indeed, apparently <code>comparing</code> predates <code>on</code>, and I recall once seeing someone argue that if the library were designed today, we would have <em>neither</em> <code>comparing</code> nor <code>equating</code> and just use <code>on</code> everywhere!  But: your mileage may vary :-)  (I'm staying neutral here.)</p>\n"}], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 35666848, "answer_count": 1, "score": 2, "last_activity_date": 1456564722, "creation_date": 1456555661, "question_id": 35666703, "link": "https://stackoverflow.com/questions/35666703/how-do-we-concisely-define-eq-based-on-a-function", "title": "How do we concisely define Eq based on a function?", "body": "<p>We can use <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Ord.html#v:comparing\" rel=\"nofollow\"><code>Data.Ord.comparing</code></a> to write nicely concise <code>Ord</code> instances:</p>\n\n<pre><code>comparing :: Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering\ncomparing p x y = compare (p x) (p y)\n\nf :: b -&gt; a\n\ninstance Ord a =&gt; Ord b where compare = comparing f\n</code></pre>\n\n<p>I would expect to find some similar function that would help to define <code>Eq</code> instances:</p>\n\n<pre><code>-- Does something like this exist?\nequalityOn :: Eq a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Bool\nequalityOn p a b = p a == p b\n\ninstance Eq a =&gt; Eq b where (==) = equalityOn f\n</code></pre>\n\n<p>Hoogle doesn't turn up anything with this signature, so I'm guessing this isn't a common way to define <code>Eq</code>. Obviously this is not a difficult problem to solve, but what is the idiomatic approach?</p>\n"}, {"tags": ["haskell", "generics", "types", "automata"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1456661480, "post_id": 35664081, "comment_id": 59042156, "body": "n.m.&#39;s answer is correct, but your reason why you&#39;re not satisfied with the functional-dependency approach doesn&#39;t make sense to me."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1456540177, "post_id": 35664153, "comment_id": 59010133, "body": "Perhaps you mean that classes can abstract over arbitrary kinds, which is the correct foil to concrete types. Type constructors are the foil to arbitrary type-level terms. e.g. <code>Bool</code>, <code>Maybe</code>, and <code>State</code> are type constructors, but <code>State s</code> -- though it is not a concrete type and has a higher kind -- is <i>not</i> a type constructor."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1456556488, "post_id": 35664153, "comment_id": 59013229, "body": "@DanielWagner You can call it a type constructor expression. See <a href=\"http://www.cs.tufts.edu/comp/150GIT/archive/mark-jones/fpca93.pdf\" rel=\"nofollow noreferrer\">the article that started it all</a> (pdf). But maybe you are right and this is an outdated term."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 5, "last_activity_date": 1456557100, "last_edit_date": 1456557100, "creation_date": 1456532829, "answer_id": 35664153, "question_id": 35664081, "link": "https://stackoverflow.com/questions/35664081/type-variables-in-type-classes/35664153#35664153", "title": "Type Variables in type classes", "body": "<p>Haskell type classes can abstract over arbitrary kinds. This means parameters o type classes can themselves have parameters. Familiar examples include <code>Functor</code> and <code>Monad</code>, that accept arguments like <code>[]</code> or <code>Maybe</code>. Here's a way to write write it with a type of <code>*\u2192*</code> kind:</p>\n\n<pre><code>class Automata machine where\n    isDeterministic :: machine alphabet -&gt; Bool\n    acceptsInput :: machine alphabet -&gt; [alphabet] -&gt; Bool\n\ndata FSM alphabet = FSM [alphabet] -- just an example, you need more \n                                   -- stuff to define a real FSM...\n\ninstance Automata FSM where \n    ...\n</code></pre>\n\n<p>Using <code>{-# LANGUAGE KindSignatures #-}</code> the kind of <code>machine</code> can be made explicit:</p>\n\n<pre><code>class Automata (machine :: * -&gt; *) where\n</code></pre>\n"}], "owner": {"reputation": 385, "user_id": 5725848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1086e1b40cdecc9467217bd45406c126?s=128&d=identicon&r=PG&f=1", "display_name": "44701", "link": "https://stackoverflow.com/users/5725848/44701"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 35664153, "answer_count": 1, "score": 0, "last_activity_date": 1456557100, "creation_date": 1456532360, "question_id": 35664081, "link": "https://stackoverflow.com/questions/35664081/type-variables-in-type-classes", "title": "Type Variables in type classes", "body": "<p>I have a strange question in relation to type classes. So you can define a basic type class like this:</p>\n\n<pre><code>class Property x where\n    checkThing :: x -&gt; Int -&gt; Bool\n    transformThing :: x -&gt; x\n</code></pre>\n\n<p>If you want to have a type class with multiple parameters you can enable:</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n</code></pre>\n\n<p>This will let you do things like:</p>\n\n<pre><code>class Property x y where\n    checkThing :: x -&gt; Int -&gt; Bool\n    transformThing :: x -&gt; y -&gt; Int\n</code></pre>\n\n<p>Here is my problem: So imagine I wanted to write a type class for automata (The kind that accept a language). I would write a type class that looked something like this:</p>\n\n<pre><code>class Automata machine where\n    isDeterministic :: machine -&gt; Bool\n    acceptsInput :: machine -&gt; String -&gt; Bool\n</code></pre>\n\n<p>A automata takes in an input and decides if that input is part of a language. The above class would work for this. But wait this is limited to lists of characters (String) what if I want to generalize by Automata? Well I could add another variable to my class definition:</p>\n\n<pre><code>class Automata machine alphabet where\n    isDeterministic :: machine -&gt; Bool\n    acceptsInput :: machine -&gt; [alphabet] -&gt; Bool\n</code></pre>\n\n<p>Hmm that is okay. But alphabet may have no direct relation to machine. Im in luck though! I can enable:</p>\n\n<pre><code>{-# LANGUAGE FunctionalDependencies #-}\n</code></pre>\n\n<p>And force language to depend on machine</p>\n\n<pre><code>class Automata machine alphabet | machine -&gt; alphabet where\n</code></pre>\n\n<p>Ok now when I make an instance of Automata I can require alphabet to be related to the machine. For example:</p>\n\n<pre><code>instance Automata (FSM alphabet) alphabet where\n</code></pre>\n\n<p>works, and this correctly</p>\n\n<pre><code>instance Automata (FSM alphabet) othertypevariable where\n</code></pre>\n\n<p>gives an error. This is ok but not very generic. For example I have to define an instance for every type of automata, and every type of alphabet they can take. Thats horrible. In addition the functional dependencies does not actually force a relation. You can write:</p>\n\n<pre><code> instance Automata (FSM alphabet) Int where\n</code></pre>\n\n<p>without a compiler error. Here is what would be ideal.</p>\n\n<pre><code>class Automata (machine alphabet) where\n    isDeterministic :: machine alphabet -&gt; Bool\n    acceptsInput :: machine alphabet -&gt; [alphabet] -&gt; Bool\n</code></pre>\n\n<p>If I could specify a particular type parameter on the data instances are being defined for. For example the data that automata could be defined for would look like:</p>\n\n<pre><code>data FSM alphabet = FSM [alphabet]\n</code></pre>\n\n<p>or something like that. This would also allow defining single generic instances such as:</p>\n\n<pre><code>instance Automata (FSM alphabet) where\n</code></pre>\n\n<p>These examples are a simplified version I am trying to do but a solution for this problem would solve my problem. How could I go about expressing something this? Can I bend type classes to my will? Language extensions are acceptable.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 6, "creation_date": 1456528782, "post_id": 35663371, "comment_id": 59007196, "body": "I bet it&#39;s the <a href=\"https://wiki.haskell.org/Monomorphism_restriction\" rel=\"nofollow noreferrer\">monomorphism restriction</a> at work. Try enabling the <code>NoMonomorphismRestriction</code> language extension (or, in other words, disabling the enabled-by-default <code>MonomorphismRestriction</code> language extension)."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1456529606, "post_id": 35663371, "comment_id": 59007468, "body": "Thanks; that was it. I&#39;d heard that term before, but had forgotten it. I found what I think is a duplicate of this question."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1456615856, "post_id": 35663371, "comment_id": 59032257, "body": "The monomorphism restriction is disabled by default in more recent versions of GHCi (but not GHC)"}], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "closed_date": 1456542706, "answer_count": 0, "score": 0, "last_activity_date": 1456528650, "creation_date": 1456528068, "last_edit_date": 1456528650, "question_id": 35663371, "link": "https://stackoverflow.com/questions/35663371/point-free-wrapper-around", "closed_reason": "Duplicate", "title": "Point-free wrapper around =&lt;&lt;", "body": "<p>Suppose I define a function in GHCi 7.6.3</p>\n\n<pre><code>&gt; let fstM xs = ((=&lt;&lt;) (return . fst)) xs\n&gt; :t fstM\nfstM :: Monad m =&gt; m (b, b1) -&gt; m b\n&gt; fstM [(1,2), (3,4)]\n[1,3]\n&gt; fstM (Just (1,2))\nJust 1\n</code></pre>\n\n<p>This is not an exciting function; it's basically just <code>liftM fst</code>. However, if I try to define it in point-free style, I get the following error:</p>\n\n<pre><code>&gt; let fstM = ((=&lt;&lt;) (return . fst))\n\n&lt;interactive&gt;:8:13:\n    No instance for (Monad m0) arising from a use of `=&lt;&lt;'\n    The type variable `m0' is ambiguous\n    Possible fix: add a type signature that fixes these type variable(s)\n    Note: there are several potential instances:\n      instance Monad ((-&gt;) r) -- Defined in `GHC.Base'\n      instance Monad IO -- Defined in `GHC.Base'\n      instance Monad [] -- Defined in `GHC.Base'\n      ...plus two others\n    In the expression: ((=&lt;&lt;) (return . fst))\n    In an equation for `fstM': fstM = ((=&lt;&lt;) (return . fst))\n</code></pre>\n\n<p>The expression itself seems to be fine</p>\n\n<pre><code>&gt; :t ((=&lt;&lt;) (return . fst))\n((=&lt;&lt;) (return . fst)) :: Monad m =&gt; m (b, b1) -&gt; m b\n</code></pre>\n\n<p>but trying to give it a name fails.</p>\n\n<p>Apparently there is a gap in my understanding; I don't see how the first definition can infer the type constraint, while the second on says it is ambiguous. That is, I know I can write</p>\n\n<pre><code>fstM :: Monad m =&gt; m (a, b) -&gt; m a\nfstM = ((=&lt;&lt;) (return . fst))\n</code></pre>\n\n<p>to resolve the ambiguity, but what is special about the seemingly unnecessary argument that makes the type declaration unnecessary?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1456529286, "post_id": 35663007, "comment_id": 59007366, "body": "If you&#39;re using Stack, why do you have version numbers in the cabal file at all? (I&#39;m a haskell newb myself, so that&#39;s an actual question, not a criticism)"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 1, "creation_date": 1456538813, "post_id": 35663007, "comment_id": 59009893, "body": "@ChrisMartin if you want to package a project up as a library, it needs to have the proper dependency ranges in the cabal file."}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1456539161, "post_id": 35663007, "comment_id": 59009949, "body": "I think it&#39;s fine to ship a library with unbounded dependencies in the .cabal file, as long as you ship a stack.yaml file as well.If you distribute your package through Stackage, a build server will keep compiling your project and checking for errors. That&#39;s pretty OK. (And it&#39;s not like bounding your dependencies doesn&#39;t have problems of its own.)"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "reply_to_user": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1456643437, "post_id": 35663007, "comment_id": 59037557, "body": "@haoformayor shipping packages with entirely unbounded dependencies is considered very bad form. The check for errors is only against the latest stackage range. For everyone else, including people perhaps pinned to older stackage versions, the package will be nearly unusable. The policy recommended for <i>all</i> hackage packages is to use the package version policy. As libraries on stackage are a subset of hackage, they are no exception."}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1456643558, "post_id": 35663007, "comment_id": 59037582, "body": "packages already become unusable; there are so many SO posts about people who can&#39;t build old packages. the whole thing, bound or stackage, is half-baked"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1456782466, "post_id": 35663007, "comment_id": 59097437, "body": "Your personal opinions on what is or isn&#39;t technically half-baked aside, the policy is that bounds should be placed on packages shared to the world."}], "answers": [{"tags": [], "owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "is_accepted": false, "score": 0, "last_activity_date": 1461438389, "creation_date": 1461438389, "answer_id": 36815194, "question_id": 35663007, "link": "https://stackoverflow.com/questions/35663007/how-to-update-cabal-file-using-stack/36815194#36815194", "title": "How to update .cabal file using Stack?", "body": "<p>You could simply delete (some of) the (upper) bounds of the <code>build-depends</code> in your cabal file.</p>\n\n<p>When it comes to distributing your package, stack can automatically add dependency bounds if you use the <code>--pvp-bounds</code> flag, e.g. <code>stack sdist --pvp-bounds upper</code>, <code>stack upload --pvp-bounds both</code> etc.</p>\n\n<p>There's a <a href=\"https://www.fpcomplete.com/blog/2015/09/stack-pvp\" rel=\"nofollow\">blog post by Michael Snoyman</a> on this feature.</p>\n"}], "owner": {"reputation": 71, "user_id": 3550758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd786a4db46ac35360b1447054d859d0?s=128&d=identicon&r=PG&f=1", "display_name": "user3550758", "link": "https://stackoverflow.com/users/3550758/user3550758"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 911, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1461438389, "creation_date": 1456526173, "question_id": 35663007, "link": "https://stackoverflow.com/questions/35663007/how-to-update-cabal-file-using-stack", "title": "How to update .cabal file using Stack?", "body": "<p>I have an older project that I created with Stack. I want to move my project to the latest LTS set from Stackage.</p>\n\n<p>When I change the resolver in the stack.yaml file, the problem is that the versions in the extra-deps in the .cabal file are still for the old LTS set. Is there a way to automatically update the version numbers in the .cabal file using Stack?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 3, "creation_date": 1456523087, "post_id": 35662237, "comment_id": 59004794, "body": "Two words: <code>map fst</code>"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 3, "creation_date": 1456523402, "post_id": 35662237, "comment_id": 59004935, "body": "Your <code>first</code> is wrong."}], "answers": [{"tags": [], "owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "is_accepted": true, "score": 9, "last_activity_date": 1456523412, "creation_date": 1456523412, "answer_id": 35662408, "question_id": 35662237, "link": "https://stackoverflow.com/questions/35662237/first-elements-of-each-pair-from-a-list/35662408#35662408", "title": "first elements of each pair from a list", "body": "<p>In functional languages, one does uses recursion or high order functions like map or fold to iterate over a list. Below, I present some ways of doing it:</p>\n\n<p>1 - List comprehension:</p>\n\n<pre><code>firsts :: [(a,b)] -&gt; [a]\nfirsts xs = [x | (x,_) &lt;- xs]\n</code></pre>\n\n<p>2 - Using map</p>\n\n<pre><code>firsts = map fst \n</code></pre>\n\n<p>3 - Using foldr</p>\n\n<pre><code>firsts = foldr (\\x ac -&gt; (fst x) : ac) [] \n</code></pre>\n\n<p>Have some fun!</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 0, "last_activity_date": 1456525901, "creation_date": 1456525901, "answer_id": 35662953, "question_id": 35662237, "link": "https://stackoverflow.com/questions/35662237/first-elements-of-each-pair-from-a-list/35662953#35662953", "title": "first elements of each pair from a list", "body": "<p>Fun with monads:</p>\n\n<pre><code>firsts xs = do x &lt;- xs; return (fst x)\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 5865871, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4e206c4171c12bb43a0e13140a07abcd?s=128&d=identicon&r=PG&f=1", "display_name": "Chase", "link": "https://stackoverflow.com/users/5865871/chase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 996, "favorite_count": 0, "accepted_answer_id": 35662408, "answer_count": 2, "score": -3, "last_activity_date": 1456525901, "creation_date": 1456522743, "question_id": 35662237, "link": "https://stackoverflow.com/questions/35662237/first-elements-of-each-pair-from-a-list", "title": "first elements of each pair from a list", "body": "<p>I know how to get the first element of a single pair <code>first (x:_) = x</code></p>\n\n<p>but how do I take a list of pairs and return a list of each first item? Do I use a loop or is there any other syntax?</p>\n\n<pre><code>[(1,2),(3,4),(5,6)] gives [1,3,5]\n</code></pre>\n"}, {"tags": ["parsing", "haskell", "applicative", "higher-rank-types", "alternative-functor"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1456521170, "post_id": 35661060, "comment_id": 59003852, "body": "Doesn&#39;t the end of the gist you linked to give two examples of what <code>f</code> could be?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1456526655, "post_id": 35661060, "comment_id": 59006349, "body": "&quot;In particular, I do not understand what Char -&gt; f () should/could be&quot; - it isn&#39;t <i>just</i> <code>Char -&gt; f ()</code>, it is <code>forall f . Alternative f =&gt; (Char -&gt; f ()) -&gt; f a</code>. You cannot consider &quot;something&quot; of type <code>Char -&gt; f()</code> in isolation here - you must consider the entire function at once (because of the universal quantification). You can view this <code>Parser</code> as a least upper bound of all (alternative) parsers - it doesn&#39;t implement any functionality, instead it relies on the semantics of whichever type <code>f</code> is eventually instantiated to."}], "answers": [{"tags": [], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "is_accepted": false, "score": -1, "last_activity_date": 1456522361, "creation_date": 1456522361, "answer_id": 35662153, "question_id": 35661060, "link": "https://stackoverflow.com/questions/35661060/purely-applicative-parser-using-alternative/35662153#35662153", "title": "Purely Applicative Parser using Alternative", "body": "<p>The <code>Char -&gt; f ()</code> part represents matching on a single character. Namely, if you do <code>char 'c'</code>, it will match on <code>'c'</code> and fail on everything else.</p>\n\n<p>To use it, you can convert it to, say Parsec:</p>\n\n<pre><code>convert :: Parser a -&gt; Parsec a\nconvert p = run p anyChar\n</code></pre>\n\n<p><code>p</code> is essentially of the type <code>forall f. Alternative f =&gt; (Char -&gt; f ()) -&gt; f a</code>, which specializes to <code>(Char -&gt; Parsec ()) -&gt; Parsec a</code>. We pass in <code>anyChar</code>, and it will produce a <code>Parsec a</code> value by using <code>anyChar</code> and any <code>Alternative</code> operations.</p>\n\n<p>Basically, a <code>Parser a</code> it is a function that, given away to match on a single character, and an <code>Alternative</code> instance, it will produce an <code>Alternative</code> value.</p>\n"}, {"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 2, "last_activity_date": 1456717809, "creation_date": 1456717809, "answer_id": 35691673, "question_id": 35661060, "link": "https://stackoverflow.com/questions/35661060/purely-applicative-parser-using-alternative/35691673#35691673", "title": "Purely Applicative Parser using Alternative", "body": "<p>In <code>forall f. Alternative f =&gt; (Char -&gt; f ()) -&gt; f a</code>, the <code>Char -&gt; f ()</code> is something that you are <em>provided</em> with. Your mission, should you choose to accept it, is to then turn that into an <code>f a</code> using only these two bits:</p>\n\n<ul>\n<li>The <code>Char -&gt; f ()</code> function (i.e. a way to parse a single character: if the next character matches the argument, the parsing succeeds; otherwise it doesn't.)</li>\n<li>The <code>Alternative</code> instance of <code>f</code></li>\n</ul>\n\n<p>So how would you parse a single digit into an <code>Int</code>? It would have to be of the form</p>\n\n<pre><code>digit :: Parser Int\ndigit = Parser $ \\parseChar -&gt; _\n</code></pre>\n\n<p>In <code>_</code>, we have to create an <code>f Int</code> using the kit <code>parseChar :: Char -&gt; f ()</code> and <code>Alternative f</code>. We know how to parse a single <code>'0'</code> character: <code>parseChar '0'</code> succeds iff the next character is <code>'0'</code>. We can turn it into a value of <code>Int</code> via <code>f</code>'s <code>Functor</code> instance, arriving at</p>\n\n<pre><code>digit0 :: Parser Int\ndigit0 = Parser $ \\parseChar -&gt; fmap (const 0) (parseChar '0')\n</code></pre>\n\n<p>But <code>f</code> is not just <code>Functor</code>, it is also <code>Alternative</code>, so we can write <code>digit</code> in long-form as</p>\n\n<pre><code>digit :: Parser Int\ndigit = Parser $ \\parseChar -&gt; fmap (const 0) (parseChar '0') &lt;|&gt;\n                               fmap (const 1) (parseChar '1') &lt;|&gt;  \n                               fmap (const 2) (parseChar '2') &lt;|&gt;  \n                               fmap (const 3) (parseChar '3') &lt;|&gt;  \n                               fmap (const 4) (parseChar '4') &lt;|&gt;  \n                               fmap (const 5) (parseChar '5') &lt;|&gt;  \n                               fmap (const 6) (parseChar '6') &lt;|&gt;  \n                               fmap (const 7) (parseChar '7') &lt;|&gt;  \n                               fmap (const 8) (parseChar '8') &lt;|&gt;  \n                               fmap (const 9) (parseChar '9')\n</code></pre>\n\n<p>And from here, it is merely a matter of pedestrian Haskell programming to cut down on the cruft, arriving at something like</p>\n\n<pre><code>digit :: Parser Int\ndigit = Parser $ \\parseChar -&gt; asum [fmap (const d) (parseChar c) | d &lt;- [0..9], let [c] = show d]\n</code></pre>\n\n<p>which we can further simplify by noting that <code>fmap (const x) f</code> can be written as <code>x &lt;$ f</code>, giving</p>\n\n<pre><code>digit :: Parser Int\ndigit = Parser $ \\parseChar -&gt; asum [d &lt;$ parseChar c | d &lt;- [0..9], let [c] = show d]\n</code></pre>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1614317599, "creation_date": 1456518276, "last_edit_date": 1614317599, "question_id": 35661060, "link": "https://stackoverflow.com/questions/35661060/purely-applicative-parser-using-alternative", "title": "Purely Applicative Parser using Alternative", "body": "<p>In a previous <a href=\"https://stackoverflow.com/questions/35639893/minimal-purely-applicative-parser\">post</a>, a user offered an implementation of a purely applicative parser for Haskell (code originally from <a href=\"https://gist.github.com/ChristopherKing42/cb30809332ccb9d7a6bd\" rel=\"nofollow noreferrer\">here</a>). Below is the partial implementation of that parser:</p>\n\n<pre><code>{-# LANGUAGE Rank2Types #-}\n\nimport Control.Applicative (Alternative(..))\nimport Data.Foldable (asum, traverse_)\n</code></pre>\n\n<p>The type:</p>\n\n<pre><code>newtype Parser a = Parser {run :: forall f. Alternative f =&gt; (Char -&gt; f ()) -&gt; f a}\n</code></pre>\n\n<p>The instances:</p>\n\n<pre><code>instance Functor Parser where\n    fmap f (Parser cont) = Parser $ \\char -&gt; f &lt;$&gt; cont char\n\ninstance Applicative Parser where\n    pure a = Parser $ \\char -&gt; pure a\n    (Parser contf) &lt;*&gt; (Parser cont) = Parser $ \\char -&gt; (contf char) &lt;*&gt; (cont char)\n\ninstance Alternative Parser where\n    empty = Parser $ \\char -&gt; empty\n    (Parser cont) &lt;|&gt; (Parser cont') = Parser $ \\char -&gt; (cont char) &lt;|&gt; (cont' char)\n    some (Parser cont) = Parser $ \\char -&gt; some $ cont char\n    many (Parser cont) = Parser $ \\char -&gt; many $ cont char\n</code></pre>\n\n<p>Some example parsers:</p>\n\n<pre><code>item = Parser $ \\char -&gt; asum $ map (\\c -&gt; c &lt;$ char c) ['A'..'z']\ndigit = Parser $ \\char -&gt; asum $ map (\\c -&gt; c &lt;$ char (head $ show c)) [0..9]\nstring s = Parser $ \\char -&gt; traverse_ char s\n</code></pre>\n\n<p>Unfortunately, I'm having a hard time trying to understand how I might use this parser implementation. In particular, I do not understand what <code>Char -&gt; f ()</code> should/could be and how I could use this to do simple parsing, e.g. to extra a digit out of an input string. I'd like a concrete example if possible. Could someone please shed some light?</p>\n"}, {"tags": ["haskell", "applicative"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1456514954, "post_id": 35659896, "comment_id": 59000379, "body": "It <i>should</i> actually work with a custom <code>++</code> operator (which BTW would best be realised <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Monoid.html#v:-60--62-\" rel=\"nofollow noreferrer\">as a <code>Monoid</code> instance</a>). What error are you getting?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1456515072, "post_id": 35659896, "comment_id": 59000436, "body": "If you don&#39;t get a compiler error, what is your expected behaviour, and what behaviour do you observe?"}, {"owner": {"reputation": 511, "user_id": 4749225, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/188b44414a78278355aeb7dc088ce680?s=128&d=identicon&r=PG&f=1", "display_name": "S. Salman", "link": "https://stackoverflow.com/users/4749225/s-salman"}, "edited": false, "score": 0, "creation_date": 1456515542, "post_id": 35659896, "comment_id": 59000690, "body": "(++) :: (MyList a) -&gt; a -&gt; (MyList a) (++) Nil item = (Cons item Nil) (++) (Cons val other) item = (Cons val (other ++ item))  (This is my custom ++ operator)"}], "answers": [{"comments": [{"owner": {"reputation": 511, "user_id": 4749225, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/188b44414a78278355aeb7dc088ce680?s=128&d=identicon&r=PG&f=1", "display_name": "S. Salman", "link": "https://stackoverflow.com/users/4749225/s-salman"}, "edited": false, "score": 1, "creation_date": 1456516088, "post_id": 35660369, "comment_id": 59000990, "body": "It should be:  (Prelude.++) :: [a] -&gt; [a] -&gt; [a],  (George.++) :: (MyList a) -&gt; (MyList a) -&gt; (MyList a)  And I think I got it. Let me try and comment back. Thanks. :)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1456515952, "creation_date": 1456515952, "answer_id": 35660369, "question_id": 35659896, "link": "https://stackoverflow.com/questions/35659896/how-can-i-implement-applicative-on-my-list-modelling-non-determinism/35660369#35660369", "title": "How can I implement Applicative on my list, modelling non-determinism?", "body": "<p>Compare the following two types:</p>\n\n<pre><code>(Prelude.++) :: []     a -&gt; [] a -&gt; []     a\n(George.++)  :: MyList a -&gt;    a -&gt; MyList a\n</code></pre>\n\n<p>Can you spot the problem?</p>\n"}], "owner": {"reputation": 511, "user_id": 4749225, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/188b44414a78278355aeb7dc088ce680?s=128&d=identicon&r=PG&f=1", "display_name": "S. Salman", "link": "https://stackoverflow.com/users/4749225/s-salman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 396, "favorite_count": 0, "accepted_answer_id": 35660369, "answer_count": 1, "score": 1, "last_activity_date": 1456515985, "creation_date": 1456514124, "last_edit_date": 1456515985, "question_id": 35659896, "link": "https://stackoverflow.com/questions/35659896/how-can-i-implement-applicative-on-my-list-modelling-non-determinism", "title": "How can I implement Applicative on my list, modelling non-determinism?", "body": "<p>I was practicing Functor / Applicative Functors + Monads in Haskell when I came across <a href=\"https://www.fer.unizg.hr/_download/repository/puh-2015-ha6.pdf\" rel=\"nofollow\">this assignment</a>:</p>\n\n<blockquote>\n  <p>4) You have seen how a Monad instance can be used to handle things that can\n  fail. Another use case for a Monad is dealing with non-determinism. The simplest\n  way to model non-deterministic computation is using a list. Think of the list as\n  holding all possible results of some computation. When you use the well known map\n  function, the function you are applying produces the outputs for all the possible\n  inputs. [...]</p>\n  \n  <p>Define your list type like so:</p>\n\n<pre><code>data MyList a = Cons a (MyList a) | Nil deriving Show\n</code></pre>\n  \n  <p>(a) Make your list an instance of Functor.<br>\n  (b) Make your list an instance of Applicative.<br>\n  (c) Make your list an instance of Monad.</p>\n</blockquote>\n\n<p>I am having some trouble with it. This is my current solution:</p>\n\n<pre><code>instance Functor MyList where\n    fmap f (Nil) = Nil\n    fmap f (Cons item other) = (Cons (f item) (fmap f other))\n\ninstance Applicative MyList where\n    pure item = (Cons item Nil)\n    Nil &lt;*&gt; _ = Nil\n    _ &lt;*&gt; Nil = Nil\n    (Cons f item) &lt;*&gt; something = (fmap f something) ++ (item &lt;*&gt; something)\n</code></pre>\n\n<p>Problem is with <code>(item &lt;*&gt; something)</code>. With a list the <code>++</code> operator would have made this possible but I even made a function that had a <code>++</code> operator but this method still does not work. How can I implement the Applicative for this type?</p>\n\n<p>This is my ++ implementation: </p>\n\n<pre><code>(++) :: (MyList a) -&gt; a -&gt; (MyList a)\n(++) Nil item = (Cons item Nil)\n(++) (Cons val other) item = (Cons val (other ++ item))\n</code></pre>\n\n<p>This is the error I get:</p>\n\n<pre><code>Couldn't match expected type \u2018a -&gt; b\u2019\n            with actual type \u2018MyList (a -&gt; b)\u2019\nRelevant bindings include\n  something :: MyList a (bound at Assignment_6.hs:13:23)\n  item :: MyList (a -&gt; b) (bound at Assignment_6.hs:13:13)\n  f :: a -&gt; b (bound at Assignment_6.hs:13:11)\n  (&lt;*&gt;) :: MyList (a -&gt; b) -&gt; MyList a -&gt; MyList b\n    (bound at Assignment_6.hs:11:5)\nIn the second argument of \u2018(++)\u2019, namely \u2018item\u2019\nIn the first argument of \u2018(&lt;*&gt;)\u2019, namely\n  \u2018(fmap f something) ++ item\u2019\n</code></pre>\n"}, {"tags": ["haskell", "if-statement", "boolean"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1456511103, "creation_date": 1456511103, "answer_id": 35659022, "question_id": 35658802, "link": "https://stackoverflow.com/questions/35658802/how-do-i-transform-a-pattern-on-booleans-to-an-if-condition/35659022#35659022", "title": "How do I transform a pattern on booleans to an if condition?", "body": "<p>Something like this?</p>\n\n<pre><code>bool_or x y = if x\n              then ...          -- x is true\n              else if y\n                   then ...     -- y is true\n                   else ...     -- both false\n</code></pre>\n\n<p>Pattern matching is much more readable, anyway.</p>\n\n<p>Exercise: you do not really <em>need</em> the second <code>if y</code>.</p>\n"}], "owner": {"reputation": 35, "user_id": 5987497, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207394001623000/picture?type=large", "display_name": "Nicholas Cik", "link": "https://stackoverflow.com/users/5987497/nicholas-cik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 35659022, "answer_count": 1, "score": 1, "last_activity_date": 1456512627, "creation_date": 1456510279, "last_edit_date": 1456512627, "question_id": 35658802, "link": "https://stackoverflow.com/questions/35658802/how-do-i-transform-a-pattern-on-booleans-to-an-if-condition", "title": "How do I transform a pattern on booleans to an if condition?", "body": "<p>I'm new to Haskell and I'm trying to transform the pattern matching below to an if condition:</p>\n\n<pre><code>myOr :: Bool -&gt; Bool -&gt; Bool\nmyOr False False = False\nmyOr _     _     = True\n</code></pre>\n\n<p>This is what I came up with, but it doesn't even compile:</p>\n\n<pre><code>myOr2 :: Bool -&gt; Bool -&gt; Bool\nmyOr2 False False = False\nmyOr2 _     _     = True\nmyOr2 If False False Then False Else True\n</code></pre>\n\n<p>I think I'm doing something wrong here, but what is it?</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1456508739, "post_id": 35658083, "comment_id": 58997034, "body": "Note that it&#39;s probably easier to work with reversed, &quot;low-endian&quot; lists, and only display them as &quot;big-endian&quot;."}, {"owner": {"reputation": 95, "user_id": 3026400, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3c65792eccc875eb9befc142f5a417a4?s=128&d=identicon&r=PG&f=1", "display_name": "Harris M Snyder", "link": "https://stackoverflow.com/users/3026400/harris-m-snyder"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1456508831, "post_id": 35658083, "comment_id": 58997095, "body": "Noted, good catch. thanks."}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 1, "creation_date": 1456508933, "post_id": 35658083, "comment_id": 58997156, "body": "Why in your last example the last digit can&#39;t be 4 but the first digit can be 2?"}, {"owner": {"reputation": 95, "user_id": 3026400, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3c65792eccc875eb9befc142f5a417a4?s=128&d=identicon&r=PG&f=1", "display_name": "Harris M Snyder", "link": "https://stackoverflow.com/users/3026400/harris-m-snyder"}, "edited": false, "score": 0, "creation_date": 1456509273, "post_id": 35658083, "comment_id": 58997359, "body": "that was an error, fixed."}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 1, "creation_date": 1456515277, "post_id": 35658083, "comment_id": 59000541, "body": "You may enjoy reading this: <a href=\"http://conal.net/blog/posts/adding-numbers\" rel=\"nofollow noreferrer\">conal.net/blog/posts/adding-numbers</a>"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 3026400, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3c65792eccc875eb9befc142f5a417a4?s=128&d=identicon&r=PG&f=1", "display_name": "Harris M Snyder", "link": "https://stackoverflow.com/users/3026400/harris-m-snyder"}, "edited": false, "score": 0, "creation_date": 1456508515, "post_id": 35658213, "comment_id": 58996887, "body": "well maxes and lst do have to be the same length for this logic to be right, so there&#39;s slightly more to it than that, but i was talking more about the if then else let in if then else stuff, than about the guards."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 95, "user_id": 3026400, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3c65792eccc875eb9befc142f5a417a4?s=128&d=identicon&r=PG&f=1", "display_name": "Harris M Snyder", "link": "https://stackoverflow.com/users/3026400/harris-m-snyder"}, "edited": false, "score": 0, "creation_date": 1456508589, "post_id": 35658213, "comment_id": 58996934, "body": "True; I&#39;ll put that back as an explicit check."}, {"owner": {"reputation": 95, "user_id": 3026400, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3c65792eccc875eb9befc142f5a417a4?s=128&d=identicon&r=PG&f=1", "display_name": "Harris M Snyder", "link": "https://stackoverflow.com/users/3026400/harris-m-snyder"}, "edited": false, "score": 0, "creation_date": 1456508787, "post_id": 35658213, "comment_id": 58997059, "body": "Great, thanks. is the nested if in the body of the function itself really idiomatic haskell, or is it better to use Maybe or something?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 95, "user_id": 3026400, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3c65792eccc875eb9befc142f5a417a4?s=128&d=identicon&r=PG&f=1", "display_name": "Harris M Snyder", "link": "https://stackoverflow.com/users/3026400/harris-m-snyder"}, "edited": false, "score": 0, "creation_date": 1456511672, "post_id": 35658213, "comment_id": 58998667, "body": "You could probably use <code>Maybe [a]</code> or <code>Either String [a]</code> to indicate a failed update, but I&#39;m not the one to show you an example :)"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1456513422, "last_edit_date": 1456513422, "creation_date": 1456508194, "answer_id": 35658213, "question_id": 35658083, "link": "https://stackoverflow.com/questions/35658083/idiomatic-haskell-way-of-termination-recursion-in-this-functoin/35658213#35658213", "title": "Idiomatic Haskell way of termination recursion in this functoin", "body": "<p>Your <code>if</code> expression is simply hiding the real base case, which is that if <em>either</em> argument is empty, return the empty list.</p>\n\n<pre><code>nextcomb [] [] = []\nnextcomb lst maxes | length lst != length maxes = []\nnextcomb lst maxes = let lastel = last lst\n                     in if    lastel &lt; last maxes\n                        then (init lst) ++ [lastel+1]\n                        else let higherbit = (nextcomb (init lst) (init maxes)) \n                             in if   higherbit == [] \n                                then []\n                                else higherbit ++ [1]\n</code></pre>\n\n<p>I would probably rework the logic like this. (Note, I'm far from a Haskell expert and tend to answer these questions as an exercise for myself :)</p>\n\n<pre><code>-- Reversing the arguments and the ultimate return value\n-- lets you work with the head of each list, rather than the last\n-- element\nnextcomb lst maxes = reverse $ nextcomb' (reverse lst) (reverse maxes)\n-- The real work. The base case is two empty lists\nnextcomb' [] [] = []\n-- If one list runs out before the other, it's an error. I think\n-- it's faster to check if one argument is empty when the other is not\n-- than to check the length of each at each level of recursion.\nnextcomb' [] _ = error \"maxes too long\"\nnextcomb' _ [] = error \"maxes too short\"\n-- Otherwise, it's just a matter of handling the least-significant\n-- bit correctly. Either abort, increment, or reset and recurse\nnextcomb' (x:xs)  (m:ms) | x &gt; m = error \"digit too large\"\n                         | x &lt; m = (x+1):xs  -- just increment\n                         | otherwise = 0:(nextcomb' xs ms) -- reset and recurse\n</code></pre>\n\n<p>(Actually, note that <code>nextcomb' [] _</code> won't trigger if you don't recurse after the last digit. You could argue that a too-long <code>maxes</code> isn't a big deal. I'll leave this unfixed, as the next part handles it correctly.)</p>\n\n<p>Alternately, you could verify the lengths match in the initial call; then you can assume that both will become empty at the same time.</p>\n\n<pre><code>nextcomb lst maxes | length lst == length maxes = reverse $ nextcomb' (reverse lst) (reverse maxes)\n                   | otherwise = error \"length mixmatch\"\n\nnextcomb' [] [] = []\nnextcomb' (x:xs)  (m:ms) | x &gt; m = error \"digit too large\"\n                         | x &lt; m = (x+1):xs\n                         | otherwise = 0:(nextcomb' xs ms)\n</code></pre>\n\n<hr>\n\n<p>Here's an example using <code>Either</code> to report errors. I won't vouch for the design other than to say it does type check and run. It's not too different from the previous code; it just uses <code>&lt;$&gt;</code> to lift <code>reverse</code> and <code>(0:)</code> to work with arguments of type <code>Either String [a]</code> instead of arguments of type <code>[a]</code>.</p>\n\n<pre><code>import Control.Applicative\nnextcombE lst maxes = reverse &lt;$&gt; nextcombE' (reverse lst) (reverse maxes)\n\nnextcombE' [] [] = Right []\nnextcombE' [] _ = Left \"maxes too long\"\nnextcombE' _ [] = Left \"maxes too short\"\nnextcombE' (x:xs) (m:ms) | x &gt; m = Left \"digit too large\"\n                         | x &lt; m = Right ((x+1):xs)\n                         | otherwise = (0:) &lt;$&gt; (nextcombE' xs ms)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 328, "user_id": 315925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1qC3G.jpg?s=128&g=1", "display_name": "Ivan David", "link": "https://stackoverflow.com/users/315925/ivan-david"}, "is_accepted": false, "score": 2, "last_activity_date": 1456522396, "last_edit_date": 1456522396, "creation_date": 1456516871, "answer_id": 35660668, "question_id": 35658083, "link": "https://stackoverflow.com/questions/35658083/idiomatic-haskell-way-of-termination-recursion-in-this-functoin/35660668#35660668", "title": "Idiomatic Haskell way of termination recursion in this functoin", "body": "<p>Please check if next implementation is useful for you, because a more \"haskellish\" way (at least for me), is using built in recursive functions to achieve the same goal</p>\n\n<pre><code>nextcomb [] [] = []\nnextcomb lst maxes\n  | length lst /= length maxes = []\n  | lst == maxes = []\n  | otherwise = fst $ foldr f ([],True) $ zip lst maxes\n  where\n    f (l,m) (acc, mustGrow)\n      | mustGrow &amp;&amp; l &lt; m  = (l + 1:acc, False)\n      | mustGrow = (1:acc, True)\n      | otherwise = (l:acc, False)\n</code></pre>\n\n<p>(Edited) If need catch errors then can try this:</p>\n\n<pre><code>nextcomb [] _ = Left \"Initial is empty\"\nnextcomb _ [] = Left \"Maximus size are empty\"\nnextcomb lst maxes\n  | length lst /= length maxes = Left \"List must be same length\"\n  | lst == maxes = Left \"Initial already reach the limit given by Maximus\"\n  | otherwise = Right $ fst $ foldr f ([],True) $ zip lst maxes\n  where\n    f (l,m) (acc, mustGrow)\n      | mustGrow &amp;&amp; l &lt; m  = (l + 1:acc, False)\n      | mustGrow = (1:acc, True)\n      | otherwise = (l:acc, False)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1456703074, "post_id": 35661358, "comment_id": 59057407, "body": "Keeping them separate has its benefits, too. If you swap <code>lst</code> and <code>maxes</code> (or just use <code>flip nextcomb</code>), you can define things like <code>binary8bit = nextcomb (take 8 repeat 2)</code>."}], "tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 3, "last_activity_date": 1456519388, "creation_date": 1456519388, "answer_id": 35661358, "question_id": 35658083, "link": "https://stackoverflow.com/questions/35658083/idiomatic-haskell-way-of-termination-recursion-in-this-functoin/35661358#35661358", "title": "Idiomatic Haskell way of termination recursion in this functoin", "body": "<p>You should make illegal states <strong>unrepresentable</strong></p>\n\n<p>So, instead of using two lists, use a list of tuples. For example, the first  value in each tuple could be the maximum, the second one the actual value. </p>\n\n<p>This also simplifies the logic dramatically, as the errors \"maxes too long\" and \"maxes too short\" can not happen.</p>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 1, "last_activity_date": 1456523344, "last_edit_date": 1456523344, "creation_date": 1456520738, "answer_id": 35661729, "question_id": 35658083, "link": "https://stackoverflow.com/questions/35658083/idiomatic-haskell-way-of-termination-recursion-in-this-functoin/35661729#35661729", "title": "Idiomatic Haskell way of termination recursion in this functoin", "body": "<p>Let's draw a diagram!  I'm going to make slightly different assumptions than the initial problem:</p>\n\n<ol>\n<li>A little-endian representation like chepner suggested;</li>\n<li>Instead of inclusive maximum values, I'm going to go with exclusive <strong>bases</strong> to make things more similar to addition-with-carry.</li>\n<li>I'm going to use digits in the range <code>[0, base)</code>.</li>\n</ol>\n\n<p>Here's the diagram:</p>\n\n<pre><code> digits = [d0, d1, ..., dn]\n bases  = [b0, b1, ..., bn]\n --------------------------\n result = [r0, r1, ..., rn]\n</code></pre>\n\n<p>Now we can ask: for each digit <code>ri</code> of the result, what does its value depend on?  Well, these things:</p>\n\n<ol>\n<li>The value of <code>di</code></li>\n<li>The value of <code>bi</code></li>\n<li>Whether the previous <code>r</code> resulted in a carry</li>\n</ol>\n\n<p>So we can write this as a function:</p>\n\n<pre><code>import Control.Monad.State  -- gonna use this a bit later\n\ntype Base = Int\ntype Digit = Int\ntype Carry = Bool\n\n-- | Increment a single digit, given all the contextual information.\nsingleDigit' :: Base -&gt; Digit -&gt; Carry -&gt; (Digit, Carry)\nsingleDigit' base digit carry = (digit', carry')\n    where sum = digit + if carry then 1 else 0\n          digit' = if sum &lt; base then sum else sum - base\n          carry' = base &lt;= sum\n</code></pre>\n\n<p>Note that I took care to make sure that the <code>singleDigit'</code> function's type ends with <code>Carry -&gt; (Digit, Carry)</code>.  This is because that fits the <code>state -&gt; (result, state)</code> pattern that is typical of the state monad:</p>\n\n<pre><code>-- | Wrap the `singleDigit'` function into the state monad.\nsingleDigit :: Base -&gt; Digit -&gt; State Carry Digit\nsingleDigit base digit = state (singleDigit' base digit)\n</code></pre>\n\n<p>Now with that we can write the following function:</p>\n\n<pre><code>increment :: [Base] -&gt; [Digit] -&gt; [Digit]\nincrement bases digits = evalState (sequence steps) True\n    where steps :: [State Carry Digit]\n          steps = zipWith singleDigit bases digits\n</code></pre>\n\n<p>What we're doing here is:</p>\n\n<ol>\n<li>Using <code>zipWith</code> to \"sew\" the bases and digits list together on corresponding elements.  The elements of this list correspond to the individual <code>steps</code> of the computation.</li>\n<li>Using <code>sequence :: [State Carry Digit] -&gt; State Carry [Digit]</code> to chain all the individual steps into one big step that passes the intermediate <code>Carry</code> state around.</li>\n<li>Feeding <code>True</code> as the initial <code>Carry</code> input to that big chain of steps (which causes the chain to increment).</li>\n</ol>\n\n<p>Example invocation:</p>\n\n<pre><code>&gt;&gt;&gt; take 20 (iterate (increment [3,4,5,10]) [0,0,0,0])\n[[0,0,0,0],[1,0,0,0],[2,0,0,0]\n,[0,1,0,0],[1,1,0,0],[2,1,0,0]\n,[0,2,0,0],[1,2,0,0],[2,2,0,0]\n,[0,3,0,0],[1,3,0,0],[2,3,0,0]\n,[0,0,1,0],[1,0,1,0],[2,0,1,0]\n,[0,1,1,0],[1,1,1,0],[2,1,1,0]\n,[0,2,1,0],[1,2,1,0]\n]\n</code></pre>\n\n<p>The lessons I'd stress:</p>\n\n<ol>\n<li>Break problems into smaller pieces.  Don't try solve too much in one function!  In this case, the trick was to split off the solution for single digits into its own function.</li>\n<li>It pays very much to think carefully about the <em>data flow</em> in a problem: what information is needed at each step of the problem?  In this case, the diagram helped reason that out, which led to the <code>singleDigit'</code> function.</li>\n<li>One of the big ideas of functional programming is to separate the \"shape\" of the computation from its \"content\".  In this case, the \"content\" is the <code>singleDigit</code> operation, and the \"shape\" of the computation\u2014how to combine the individual steps into a big solution\u2014is provided by the <code>State</code> monad and the <code>sequence</code> operation.</li>\n<li>I did not write a single recursive function; instead, I made ample use of library functions like <code>zipWith</code>, <code>sequence</code>, <code>take</code> and <code>iterate</code>.  You ask for a more idiomatic Haskell solution, so well, here goes: complicated recursive functions definitions are not as idiomatic as using library functions that encapsulate common recursive patterns.</li>\n<li>This hopefully will encourage you to study monads some more.  There are many, many problems out there where, if you express them in terms of one of the standard monads like <code>State</code>, you can reuse generic functions like <code>sequence</code> to solve them very easily.  It's a tall learning curve but the results are worth it!</li>\n</ol>\n"}], "owner": {"reputation": 95, "user_id": 3026400, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3c65792eccc875eb9befc142f5a417a4?s=128&d=identicon&r=PG&f=1", "display_name": "Harris M Snyder", "link": "https://stackoverflow.com/users/3026400/harris-m-snyder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1456523344, "creation_date": 1456507794, "last_edit_date": 1456509131, "question_id": 35658083, "link": "https://stackoverflow.com/questions/35658083/idiomatic-haskell-way-of-termination-recursion-in-this-functoin", "title": "Idiomatic Haskell way of termination recursion in this functoin", "body": "<p>What is the more haskellish way to stop the recursion of this function? Currently I'm using a nested if/else, and returning an empty list if the next combination \"overflows\".</p>\n\n<pre><code>nextcomb [] []     = []\nnextcomb lst maxes | length lst == length maxes = \nlet lastel = last lst\nin if    lastel &lt; last maxes\n   then (init lst) ++ [lastel+1]\n   else let higherbit = (nextcomb (init lst) (init maxes)) \n        in if   higherbit == [] \n           then []\n           else higherbit ++ [1]\nnextcomb lst maxes | otherwise = []\n</code></pre>\n\n<p>To clarify, what it does is it takes a list of numbers like [1,1,1,1] and increments it like:</p>\n\n<p>[1,1,1,1] -> [1,1,1,2]</p>\n\n<p>...</p>\n\n<p>[1,1,1,9] -> [1,1,2,1]</p>\n\n<p>...</p>\n\n<p>[1,1,9,9] -> [1,2,1,1]</p>\n\n<p>etc.</p>\n\n<p>BUT, the second argument is a list that indicates the maxmum value for each column. So if the maxes were [2,3], and the initial list was [1,1], then the progression woudld be:</p>\n\n<p>[1,1] -> [1,2]</p>\n\n<p>[1,2] -> [1,3]</p>\n\n<p>[1,3] -> [2,1]</p>\n\n<p>[2,1] -> [2,2]</p>\n\n<p>[2,2] -> [2,3]</p>\n\n<p>[2,3] -> []</p>\n\n<hr>\n\n<p>Edit: \"Little Endian\" version as recommended by chepner</p>\n\n<pre><code>nextcomb' [] [] = []\nnextcomb' lst maxes | length lst /= length maxes = []\nnextcomb' lst maxes =\n    let firstel = head lst\n    in if    firstel &lt; head maxes\n       then (firstel+1) : (tail lst)\n       else let higherbit = (nextcomb' (tail lst) (tail maxes))\n            in if   higherbit == []\n               then []\n               else 1 : higherbit\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "is_accepted": false, "score": 2, "last_activity_date": 1456504717, "last_edit_date": 1456504717, "creation_date": 1456504644, "answer_id": 35657089, "question_id": 35656975, "link": "https://stackoverflow.com/questions/35656975/how-do-i-read-numbers-from-a-file-sum-them-and-print-them-in-haskell/35657089#35657089", "title": "How do I read numbers from a file, sum them and print them in Haskell?", "body": "<p>There is sum in Data.List and the Prelude (<a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:sum\" rel=\"nofollow\">http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:sum</a>)</p>\n\n<pre><code>sum :: (Foldable t, Num a) =&gt; t a -&gt; a Source\n</code></pre>\n\n<blockquote>\n  <p>The sum function computes the sum of the numbers of a structure.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 269, "user_id": 4038547, "user_type": "registered", "accept_rate": 18, "profile_image": "https://graph.facebook.com/100006406093905/picture?type=large", "display_name": "Rodrigo Stv", "link": "https://stackoverflow.com/users/4038547/rodrigo-stv"}, "edited": false, "score": 0, "creation_date": 1456505233, "post_id": 35657140, "comment_id": 58994944, "body": "I don&#39;t. But we are both Rodrigos so thank you =). Why can&#39;t I map the square function over a IO [String] type?"}], "tags": [], "owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "is_accepted": false, "score": 2, "last_activity_date": 1456506987, "last_edit_date": 1456506987, "creation_date": 1456504796, "answer_id": 35657140, "question_id": 35656975, "link": "https://stackoverflow.com/questions/35656975/how-do-i-read-numbers-from-a-file-sum-them-and-print-them-in-haskell/35657140#35657140", "title": "How do I read numbers from a file, sum them and print them in Haskell?", "body": "<p>Your problem is that you probably don't understand the concept of <a href=\"http://learnyouahaskell.com/a-fistful-of-monads\" rel=\"nofollow\">Monad</a> and how Haskell use them to control side-effects in programs.</p>\n\n<p>Since your objective is just to sum the read numbers, you can do the following:</p>\n\n<pre><code>f = do\n      xs &lt;- read_numbers\n      return (sum xs)\n</code></pre>\n\n<p>where <code>sum</code> has its obvious meaning and type:</p>\n\n<pre><code>sum :: (Num a, Foldable t) =&gt; t a -&gt; a\n</code></pre>\n\n<p><strong>EDIT</strong>: Answer to Rodrigo Stv commentary.</p>\n\n<p>When you check <code>map</code> type you get: </p>\n\n<pre><code> map :: (a -&gt; b) -&gt; [a] -&gt; [b] \n</code></pre>\n\n<p>When you try to map your square function which has type </p>\n\n<pre><code> square :: Int -&gt; IO Int\n</code></pre>\n\n<p>you got: </p>\n\n<pre><code> map square :: [Int] -&gt; [IO Int]. \n</code></pre>\n\n<p>That is a type from list of <code>Int</code> to a list of I/O operations that can return an <code>Int</code> and you cannot <code>sum</code> I/O operations. :)</p>\n\n<p>As I told you, the problem here is to understand how to work with monads.</p>\n"}], "owner": {"reputation": 269, "user_id": 4038547, "user_type": "registered", "accept_rate": 18, "profile_image": "https://graph.facebook.com/100006406093905/picture?type=large", "display_name": "Rodrigo Stv", "link": "https://stackoverflow.com/users/4038547/rodrigo-stv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1456506987, "creation_date": 1456504341, "question_id": 35656975, "link": "https://stackoverflow.com/questions/35656975/how-do-i-read-numbers-from-a-file-sum-them-and-print-them-in-haskell", "title": "How do I read numbers from a file, sum them and print them in Haskell?", "body": "<p>How do I read numbers from a file, sum them and print them in Haskell?</p>\n\n<p>I've been trying the following: I can read the numbers, but can't get them to sum.</p>\n\n<pre><code>square x = do\n    return x\n\n\nread_numbers = do\n    contents &lt;- readFile \"numbers.txt\"\n    let linesOfFile = map (\\x -&gt; read x :: Integer) (lines $ contents)\n    return linesOfFile\n\nf = do\n    map square read_numbers\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1804, "user_id": 1260229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a918b56d3f83f46ced68b33737396b87?s=128&d=identicon&r=PG", "display_name": "sn&#248;reven", "link": "https://stackoverflow.com/users/1260229/sn%c3%b8reven"}, "edited": false, "score": 0, "creation_date": 1456504730, "post_id": 35657068, "comment_id": 58994621, "body": "I want to be able to restrict type <code>T</code> in other data types, though. I wouldn&#39;t be able to require all <code>Integral</code> types (for example) without a type variable."}, {"owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "reply_to_user": {"reputation": 1804, "user_id": 1260229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a918b56d3f83f46ced68b33737396b87?s=128&d=identicon&r=PG", "display_name": "sn&#248;reven", "link": "https://stackoverflow.com/users/1260229/sn%c3%b8reven"}, "edited": false, "score": 0, "creation_date": 1456504925, "post_id": 35657068, "comment_id": 58994743, "body": "@sn&#248;reven You cannot hide polymorphic types under a concrete one in Haskell. Either you will have type variables everywhere, or you have to stick to concrete types. In your example, <code>fun</code> returns different types depending on the argument, which is also not possible (without some new dependent-types extensions)."}], "tags": [], "owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "is_accepted": false, "score": 0, "last_activity_date": 1456505295, "last_edit_date": 1456505295, "creation_date": 1456504590, "answer_id": 35657068, "question_id": 35656962, "link": "https://stackoverflow.com/questions/35656962/let-function-return-arbitrary-instances-of-type/35657068#35657068", "title": "Let function return arbitrary instances of type", "body": "<p>The usual solution to this are simply <a href=\"https://wiki.haskell.org/Algebraic_data_type\" rel=\"nofollow\">algebraic data types</a>.</p>\n\n<pre><code>data T = TInt Int | TStr String\n\nfun :: Int -&gt; T\nfun a | a &gt;= 5   = TStr \"a lot\"\n      | othrwise = TInt a\n</code></pre>\n\n<hr>\n\n<p>However, your exact problem can be solved, using typeclasses for ad-hoc polymorphic behavior:</p>\n\n<pre><code>class TT a where\n    tt :: a -&gt; T a\n\ninstance TT Int where\n    tt = TInt\n\ninstance TT String where\n    tt = TString\n\nfun :: (TT a) =&gt; Int -&gt; T a\nfun a | a &gt;= 5    = tt \"a lot\"\n      | otherwise = tt a\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1456505533, "creation_date": 1456505533, "answer_id": 35657381, "question_id": 35656962, "link": "https://stackoverflow.com/questions/35656962/let-function-return-arbitrary-instances-of-type/35657381#35657381", "title": "Let function return arbitrary instances of type", "body": "<p>You could use an existential type wrapper.</p>\n\n<pre><code>data T a where\n    TInt :: Int -&gt; T Int\n    TStr :: String -&gt; T String\n\ndata SomeT where\n    S :: T a -&gt; SomeT\n\nfun :: Int -&gt; SomeT\nfun a | a &gt;= 5    = S $ TStr \"a lot\"\n      | otherwise = S $ TInt a\n\nfoo :: SomeT -&gt; Maybe (T Int)\nfoo (S x@(TInt _)) = Just x\nfoo _              = Nothing\n</code></pre>\n"}], "owner": {"reputation": 1804, "user_id": 1260229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a918b56d3f83f46ced68b33737396b87?s=128&d=identicon&r=PG", "display_name": "sn&#248;reven", "link": "https://stackoverflow.com/users/1260229/sn%c3%b8reven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 35657381, "answer_count": 2, "score": 1, "last_activity_date": 1456505533, "creation_date": 1456504307, "question_id": 35656962, "link": "https://stackoverflow.com/questions/35656962/let-function-return-arbitrary-instances-of-type", "title": "Let function return arbitrary instances of type", "body": "<p>I want a function to be able to return all possible instances (not sure if that's the right word) of a type. Like this (<code>fun</code> not working):</p>\n\n<pre><code>data T a where\n    TInt :: Int -&gt; T Int\n    TStr :: String -&gt; T String\n\nfun :: Int -&gt; T (forall a. a)\nfun a | a &gt;= 5    = TStr \"a lot\"\n      | otherwise = TInt a\n</code></pre>\n\n<p>My end goal is to have an alias type <code>SomeT</code> that stands for arbitrary <code>T</code>. </p>\n\n<p>I want to use this to parse type declarations of a DSL. I have int and string types and want to have one parsing function that parses them all.</p>\n\n<p>Is this possible?</p>\n"}, {"tags": ["haskell", "ghc", "cabal", "eclipse-fp"], "comments": [{"owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 0, "creation_date": 1456505125, "post_id": 35656855, "comment_id": 58994883, "body": "EclipseFP is not maintained anymore, so I&#39;d recommend you use another IDE for Haskell. If you keep seeing this error, it&#39;s because the configuration of the project doesn&#39;t succeed, which is often because of some mismatch between cabal versions, etc."}, {"owner": {"reputation": 1, "user_id": 4954504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tHshH.jpg?s=128&g=1", "display_name": "scaredl", "link": "https://stackoverflow.com/users/4954504/scaredl"}, "reply_to_user": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 0, "creation_date": 1456505961, "post_id": 35656855, "comment_id": 58995414, "body": "Hm, thanks for the quick response. Could you tell me some good IDE for Haskell?"}, {"owner": {"reputation": 1, "user_id": 4954504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tHshH.jpg?s=128&g=1", "display_name": "scaredl", "link": "https://stackoverflow.com/users/4954504/scaredl"}, "reply_to_user": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 0, "creation_date": 1456506146, "post_id": 35656855, "comment_id": 58995551, "body": "IDE, supported by Ubuntu*"}, {"owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 0, "creation_date": 1456512027, "post_id": 35656855, "comment_id": 58998852, "body": "I use Leksah or Atom with the Haskell plugins."}], "owner": {"reputation": 1, "user_id": 4954504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tHshH.jpg?s=128&g=1", "display_name": "scaredl", "link": "https://stackoverflow.com/users/4954504/scaredl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1456504003, "creation_date": 1456504003, "last_edit_date": 1592644375, "question_id": 35656855, "link": "https://stackoverflow.com/questions/35656855/eclipsefp-configuring-because-setup-config-not-present", "title": "EclipseFP - configuring because setup_config not present", "body": "<p>I have installed Haskell platform and I wanted to also install EclipseFP. I followed some instructions online and I thought it was done, but when I type any character i get the following message:</p>\n<blockquote>\n<p>configuring because setup_config not present</p>\n<p>Resolving dependencies...</p>\n<p>Configuring proj1-0.1...</p>\n</blockquote>\n<p>I have no idea what I must do now, but I hope somebody does.</p>\n"}, {"tags": ["haskell", "haskell-snap-framework", "heist"], "answers": [{"tags": [], "owner": {"reputation": 635, "user_id": 860338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/782e20b78bb80f4207cbea38f88c922a?s=128&d=identicon&r=PG", "display_name": "ImAlsoGreg", "link": "https://stackoverflow.com/users/860338/imalsogreg"}, "is_accepted": true, "score": 2, "last_activity_date": 1456692237, "creation_date": 1456692237, "answer_id": 35688024, "question_id": 35655761, "link": "https://stackoverflow.com/questions/35655761/working-with-routes-and-html-heist-in-snap/35688024#35688024", "title": "Working with routes and html (Heist) in Snap", "body": "<p>The Heist snaplet has a function <a href=\"http://hackage.haskell.org/package/snap-0.14.0.6/docs/Snap-Snaplet-Heist.html#v:heistServe\" rel=\"nofollow\"><code>serveHeist</code></a> that acts a lot like <a href=\"http://hackage.haskell.org/package/snap-core-0.9.8.0/docs/Snap-Util-FileServe.html#v:serveDirectory\" rel=\"nofollow\"><code>serveDirectory</code></a>. That will serve all of the templates in templates/ at routes. The haddocks have some more details about, e.g. hiding certain templates that don't make sense on their own.</p>\n\n<p>For composing different templates together, think of templates like functions - you can apply them to other templates, and the result is itself a template. These things all happen in Heist itself, rather than in snap.</p>\n\n<p>The <code>&lt;apply&gt;</code> tag performs the function application. The argument is the content inside of <code>&lt;apply&gt;</code>, for example, in <code>page1.tpl</code>:</p>\n\n<pre><code>&lt;apply&gt;\n  &lt;h1&gt;I'm a function parameter&lt;/h1&gt;\n&lt;/apply&gt;\n</code></pre>\n\n<p>The function being applied is <code>main.tpl</code>, and the parameter is <code>&lt;apply-content&gt;</code>:</p>\n\n<pre><code>&lt;html&gt;&lt;head&gt;&lt;/head&gt;\n  &lt;body&gt;\n    &lt;h1&gt;Main template.&lt;/h1&gt;\n    &lt;apply-content/&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>The use of <code>&lt;apply&gt;</code> and <code>&lt;apply-content&gt;</code> perform the function application and compute a full page, which would be available at the <code>/page1</code> route.</p>\n\n<p>There is a lot more explanation in the <a href=\"http://snapframework.com/docs/tutorials/heist\" rel=\"nofollow\">Heist Tutorial</a>. I wonder if the function-application analogy is useful for remembering more of the heist API.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user266003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 35688024, "answer_count": 1, "score": 2, "last_activity_date": 1456718561, "creation_date": 1456500933, "last_edit_date": 1456718561, "question_id": 35655761, "link": "https://stackoverflow.com/questions/35655761/working-with-routes-and-html-heist-in-snap", "title": "Working with routes and html (Heist) in Snap", "body": "<p>I have templates (<code>*.tpl</code>) in <code>my-snap-app/snaplets/heist/templates</code> (<code>main.tpl</code>, <code>page1.tpl</code>, <code>page2.tpl</code>, <code>page3.tpl</code>). \nAnd here's my <code>Main.hs</code>:</p>\n\n<pre><code>import Snap.Http.Server\nimport Snap.Core\nimport Snap.Snaplet\nimport Snap.Snaplet.Heist\nimport Snap.Util.FileServe\nimport Snap.Util.GZip\nimport Heist.Interpreted\nimport Heist\n\n--.......\n\ndata App = App { _heist :: Snaplet (Heist App) }\nmakeLenses ''App\n\ninstance HasHeist App where \n  heistLens = subSnaplet heist\n</code></pre>\n\n<p>How can I:</p>\n\n<p>a) Make all the templates available in my web app? Meaning, I want to be able to access <code>page1.tpl</code>, <code>page2.tpl</code>, <code>page3.tpl</code> on\n  <code>localhost://page1</code>, <code>localhost://page2</code>, <code>localhost://page3</code>. Should I <strong>necessarily</strong> add a route for <strong>each</strong> page or can I add a route to make them accessible <strong>all at once</strong>?</p>\n\n<p>2) <code>main.tpl</code> is a main template (layout). How can I make <code>page[123]</code> use  <code>main.tpl</code> as a master layout template?</p>\n"}, {"tags": ["haskell", "functional-programming", "pattern-matching", "wildcard"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5818725"}, "edited": false, "score": 0, "creation_date": 1456503879, "post_id": 35653682, "comment_id": 58993997, "body": "Well i&#39;m sorry for that rant, but i&#39;ve had it in the past before where people litrally downvote for no reason. I&#39;m under the impression this community is very elitist, so I felt the need to protect myself and my reputation."}], "answers": [{"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1456495914, "post_id": 35653775, "comment_id": 58988055, "body": "Also, the compiler will tell you about this if you enable <code>-Wall</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5818725"}, "edited": false, "score": 0, "creation_date": 1456579649, "post_id": 35653775, "comment_id": 59019704, "body": "@Lee Ahhh ok that makes perfect sense, thank you. So, am I right in saying that if the first pattern was removed and there was only the bottom two patterns remaining, the same question of fun 00 + fun 1 0 would equal to 4? Since both inputs generate the top pattern which is 2?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1456703293, "post_id": 35653775, "comment_id": 59057462, "body": "@Lee Note that if you don&#39;t use a variable used in a pattern match on the right-hand side, you can replace it with <code>_</code>. <code>fun x _ = 1</code> is equivalent to <code>fun _ _ = 1</code>."}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 6, "last_activity_date": 1456495474, "creation_date": 1456495474, "answer_id": 35653775, "question_id": 35653682, "link": "https://stackoverflow.com/questions/35653682/haskell-pattern-matching-how-to-determine-what-pattern-to-use-based-on-two-in/35653775#35653775", "title": "Haskell - Pattern matching: How to determine what pattern to use based on two input values", "body": "<p>Patterns are matched in order from top to bottom, so <code>fun x _</code> matches anything. The variable <code>x</code> is bound to the first argument unconditionally, and the <code>_</code> is also matched unconditionally without binding. The other two patterns are not attempted since the first pattern matches.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5818725"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 619, "favorite_count": 0, "accepted_answer_id": 35653775, "answer_count": 1, "score": 0, "last_activity_date": 1456496031, "creation_date": 1456495218, "last_edit_date": 1456496031, "question_id": 35653682, "link": "https://stackoverflow.com/questions/35653682/haskell-pattern-matching-how-to-determine-what-pattern-to-use-based-on-two-in", "title": "Haskell - Pattern matching: How to determine what pattern to use based on two input values", "body": "<p>Okay so I'm learning the basics of Haskell and I recently did a mock exam with a question that used pattern matching and wildcards as part of the function to generate different results. The function created was the following:</p>\n\n<pre><code>fun x _ = 1\nfun _ 0 = 2\nfun x y = 3\n</code></pre>\n\n<p>Now the question was to add <strong>fun 0 0 + fun 1 0</strong> Which both apparently match the pattern that generates 1. </p>\n\n<p>However I can't see how this works, the way I see it, is that any input value could use any of them patterns.</p>\n\n<p>I'm probaly looking at it wrong, so can anyone talk me through this question and why both <strong>fun 0 0</strong> and <strong>fun 1 0</strong> both generate 1? Which when added together gives the result 2 of course. </p>\n"}, {"tags": ["database", "haskell", "field", "records", "typesafe"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1456491030, "post_id": 35651252, "comment_id": 58984505, "body": "I think <code>aeson</code> does something similar when serializing to JSON maybe you will find something useful in there"}, {"owner": {"reputation": 2535, "user_id": 634020, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/044be669886e6b2e625776ff8be167b7?s=128&d=identicon&r=PG", "display_name": "Philip Kamenarsky", "link": "https://stackoverflow.com/users/634020/philip-kamenarsky"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1456506388, "post_id": 35651252, "comment_id": 58995710, "body": "@epsilonhalbe: look at my comment below."}], "answers": [{"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1456495649, "post_id": 35653668, "comment_id": 58987839, "body": "side note: you&#39;ll need <code>{-# LANGUAGE DeriveDataTypeable #-}</code> to make that work"}, {"owner": {"reputation": 2535, "user_id": 634020, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/044be669886e6b2e625776ff8be167b7?s=128&d=identicon&r=PG", "display_name": "Philip Kamenarsky", "link": "https://stackoverflow.com/users/634020/philip-kamenarsky"}, "edited": false, "score": 0, "creation_date": 1456506363, "post_id": 35653668, "comment_id": 58995686, "body": "Unfortunately, I need a textual representation for every <i>specific</i> field, not all fields at once, i.e. I literally need something like <code>fieldName :: Field -&gt; String</code>, where <code>Field</code> is somehow derived from the data type definition."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 2535, "user_id": 634020, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/044be669886e6b2e625776ff8be167b7?s=128&d=identicon&r=PG", "display_name": "Philip Kamenarsky", "link": "https://stackoverflow.com/users/634020/philip-kamenarsky"}, "edited": false, "score": 0, "creation_date": 1456506554, "post_id": 35653668, "comment_id": 58995825, "body": "@PhilipKamenarsky I don&#39;t know if that&#39;ll be possible without writing some TemplateHaskell.  GHC really only sees your accessors as functions, really what you get is syntax sugar for <code>data Sleep = Sleep (Maybe Int) Bool; _duration :: Sleep -&gt; Maybe Int; _drunk :: Sleep -&gt; Bool</code> with the implementations just accessing the positions for you.  There&#39;s some extra magic going on, but without some TH to generate <code>duration</code> for you as some <code>Field</code> type (maybe some kind of tagged Lens?) you won&#39;t be able to."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 2, "last_activity_date": 1456495689, "last_edit_date": 1456495689, "creation_date": 1456495189, "answer_id": 35653668, "question_id": 35651252, "link": "https://stackoverflow.com/questions/35651252/get-textual-representation-of-record-field/35653668#35653668", "title": "Get textual representation of record field?", "body": "<p>You can do this using <code>Data.Data</code>:</p>\n\n<pre><code>{-# LANGUAGE DeriveDataTypeable #-}\nimport Data.Data\n\ndata Sleep = Sleep\n    { _duration :: Maybe Int\n    , _drunk :: Bool\n    } deriving (Typeable, Data)\n\nfieldNames :: Data a =&gt; a -&gt; [String]\nfieldNames = constrFields . toConstr\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>&gt; fieldNames (Sleep undefined undefined)\n[\"_duration\", \"_drunk\"]\n</code></pre>\n\n<p>You'll have to decide how you want to transform the names to database columns after that, but that should be fairly easy.</p>\n\n<p>This requires a value created using a particular constructor, remember that data types can have many constructors.  There isn't really a way around this, but you could have something like</p>\n\n<pre><code>sleepFieldNames :: [String]\nsleepFieldNames = fieldNames (Sleep undefined undefined)\n</code></pre>\n\n<p>So that you don't have to keep recalculating it.</p>\n"}], "owner": {"reputation": 2535, "user_id": 634020, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/044be669886e6b2e625776ff8be167b7?s=128&d=identicon&r=PG", "display_name": "Philip Kamenarsky", "link": "https://stackoverflow.com/users/634020/philip-kamenarsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1456495689, "creation_date": 1456488317, "question_id": 35651252, "link": "https://stackoverflow.com/questions/35651252/get-textual-representation-of-record-field", "title": "Get textual representation of record field?", "body": "<p>Having the following record:</p>\n\n<pre><code>data Sleep = Sleep\n   { _duration :: Maybe Int\n   , _drunk :: Bool\n   }\n</code></pre>\n\n<p>Is there a way to do the following:</p>\n\n<pre><code>deriveSomething ''Sleep\n\nfieldName duration :: String -- \"duration\"\n</code></pre>\n\n<p>I need this for typesafe DB specific field updates, i.e:</p>\n\n<pre><code>setField connection key duration (Just 50)\n</code></pre>\n\n<p>It needs to be DB-agnostic though (thus <code>opaleye</code> etc. is out).</p>\n\n<p>(If this can be achieved with a standard package like <code>lens</code> even better, but I wasn't able to find anything.)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 3, "creation_date": 1456487014, "post_id": 35650696, "comment_id": 58981796, "body": "<code>fmap (\\c -&gt; foo getA getB c getD) getC</code>?"}, {"owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 1, "creation_date": 1456487961, "post_id": 35650696, "comment_id": 58982411, "body": "Or the slight variant on that given by using the inline form of fmap: <code>(\\c -&gt; foo getA getB c getD) &lt;$&gt; getC</code>"}, {"owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "edited": false, "score": 0, "creation_date": 1456491661, "post_id": 35650696, "comment_id": 58984967, "body": "I don&#39;t see &quot;any&quot; difference between these three variants. Exists? Or is a merely clean code question?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1456524191, "post_id": 35650696, "comment_id": 59005329, "body": "Your types in your last example don&#39;t add up."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1456521994, "creation_date": 1456521994, "answer_id": 35662045, "question_id": 35650696, "link": "https://stackoverflow.com/questions/35650696/uplifting-strategies-when-working-with-functors/35662045#35662045", "title": "Uplifting strategies when working with Functors", "body": "<p>You can use <code>do</code> syntax:</p>\n\n<pre><code>do\n    c &lt;- getC\n    return (foo getA getB c getD)\n</code></pre>\n\n<p>If you turn on <code>ApplicativeDo</code>, this will use the efficient <code>fmap</code> form rather than the potentially inefficient <code>&gt;&gt;=</code> and <code>return</code> form.</p>\n\n<p>There is a <a href=\"http://hackage.haskell.org/package/applicative-quoters-0.1.0.8/docs/Control-Applicative-QQ-Idiom.html\" rel=\"nofollow\">quasiquoter on Hackage for idiom brackets</a> which would let you write</p>\n\n<pre><code>[i| foo (pure getA) (pure getB) getC (pure getD) |]\n</code></pre>\n\n<p>Otherwise, there is little sugar available. There are many ways to spell your operation with existing combinators, which generally trade off between being generically applicable in all situations and being compact. Some examples include:</p>\n\n<pre><code>flip (foo getA getB) getD &lt;$&gt; getC\n(\\c -&gt; foo getA getB c getD) &lt;$&gt; getC\nfoo getA getB &lt;$&gt; getC &lt;*&gt; pure getD\nfoo &lt;$&gt; pure getA &lt;*&gt; pure getB &lt;*&gt; getC &lt;*&gt; pure getD\n</code></pre>\n"}], "owner": {"reputation": 8452, "user_id": 621427, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/0eFAm.png?s=128&g=1", "display_name": "robkuz", "link": "https://stackoverflow.com/users/621427/robkuz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1456521994, "creation_date": 1456486605, "question_id": 35650696, "link": "https://stackoverflow.com/questions/35650696/uplifting-strategies-when-working-with-functors", "title": "Uplifting strategies when working with Functors", "body": "<p>Assume that I have a function </p>\n\n<pre><code>foo :: a -&gt; b -&gt; c -&gt; d -&gt; e\nfoo a b c d = somefn a b c d\n</code></pre>\n\n<p>and some functions that return me <code>a, b, c and d</code> repsectively </p>\n\n<pre><code>getA :: a\ngetB :: b\ngetC :: f c\ngetD :: d\n</code></pre>\n\n<p>only that the function returning <code>c</code> is return a functor with c</p>\n\n<p>now I have call site like     </p>\n\n<pre><code>callfoo = foo getA getB getC getD\n</code></pre>\n\n<p>obviously that wont work as getC returns a functor of c and not c itself. So the only way seems to be</p>\n\n<pre><code>callfoo = (foo getA getB) &lt;$&gt; getC &lt;*&gt; getD\n</code></pre>\n\n<p>Apart from the fact that the <em>simple</em> call to <code>foo</code> gets lost here the signature changes as well to <code>callfoo :: f e</code>.\nOne way to keep it simple is to <code>(extract getC)</code> but this is evil and will get you in a special compartment in Haskell-hell. I know.</p>\n\n<p><strong>My general question is:</strong>\nHow do I handle situations where I mostly work with non-functorial values but then suddenly one of the values forces me to uplift all the other values as well?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 26541, "user_id": 1532460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dc5b338bf194a9e117af20bd9b2e4edb?s=128&d=identicon&r=PG", "display_name": "awesoon", "link": "https://stackoverflow.com/users/1532460/awesoon"}, "is_accepted": false, "score": 9, "last_activity_date": 1456477335, "last_edit_date": 1456477335, "creation_date": 1456475961, "answer_id": 35647036, "question_id": 35646956, "link": "https://stackoverflow.com/questions/35646956/remove-blank-entries-in-list/35647036#35647036", "title": "Remove Blank Entries in List", "body": "<p><a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:dropWhile\" rel=\"noreferrer\"><code>dropWhile</code></a> drops elements while given predicate is <code>True</code>. <code>null \"hello\"</code> is <code>False</code>, so, it should'n drop anything.</p>\n\n<p>You are probably looking for a <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:filter\" rel=\"noreferrer\"><code>filter</code></a>:</p>\n\n<pre><code>Prelude&gt; filter (not . null) [\"hello\",\"goodbye\",\"\",\"sup\",\"bye\",\"hi\",\"cat\",\"dog\"]\n[\"hello\",\"goodbye\",\"sup\",\"bye\",\"hi\",\"cat\",\"dog\"]\n</code></pre>\n"}], "owner": {"reputation": 180, "user_id": 4698343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ff444d9049be8f74851c91f75bbd48?s=128&d=identicon&r=PG&f=1", "display_name": "Dakota Trotter", "link": "https://stackoverflow.com/users/4698343/dakota-trotter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1456478299, "creation_date": 1456475677, "last_edit_date": 1456478299, "question_id": 35646956, "link": "https://stackoverflow.com/questions/35646956/remove-blank-entries-in-list", "title": "Remove Blank Entries in List", "body": "<p>Let's say that I declare a variable in GHCI</p>\n\n<pre><code>let a = [\"hello\",\"goodbye\",\"\",\"sup\",\"bye\",\"hi\",\"cat\",\"dog\"]\n</code></pre>\n\n<p>And I want to go about removing that pesky \"\" from the list.  From my understanding, I should be able to use dropWhile to do so, like this</p>\n\n<pre><code>dropWhile null a\n</code></pre>\n\n<p>But this doesn't remove the pesky \"\".  Why is this?  How can I fix this issue?</p>\n\n<p>Ah, now I understand.  I completely misunderstood how dropWhile works.  So then to make this question a little different - how do I remove blank entries in a list?</p>\n"}, {"tags": ["parsing", "haskell", "jpeg", "attoparsec"], "comments": [{"owner": {"reputation": 7979, "user_id": 104109, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1ef4d8fdadddc19a7314267a649bc10c?s=128&d=identicon&r=PG", "display_name": "BitBank", "link": "https://stackoverflow.com/users/104109/bitbank"}, "edited": false, "score": 0, "creation_date": 1456474428, "post_id": 35646260, "comment_id": 58973553, "body": "The compressed image data is sandwiched between FFDA and FFD9. The problem is that the FFD9 may be missing and the file should end there anyway. I don&#39;t understand your purpose in &quot;jumping &#39;through&#39; a SOS_MT&#39; block. There is no &#39;through&#39; and nothing &#39;on the other side&#39;."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1456474541, "post_id": 35646260, "comment_id": 58973616, "body": "Firstly, (potentially) by using a library designed for binary serialization (I&#39;m partial to <a href=\"https://hackage.haskell.org/package/cereal\" rel=\"nofollow noreferrer\">cereal</a>). Secondly, each branch parses a word unconditionally. Instead of parsing that word, and backtracking if you fail later, you should parse that word and decide what you are going to do next based on its value. Lastly (not certain about this one) instead of computing and summing the length, use <a href=\"https://hackage.haskell.org/package/attoparsec-0.13.0.1/docs/Data-Attoparsec-ByteString.html\" rel=\"nofollow noreferrer\"><code>match</code></a> to get the parsed string, them simply compute its length."}, {"owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "reply_to_user": {"reputation": 7979, "user_id": 104109, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1ef4d8fdadddc19a7314267a649bc10c?s=128&d=identicon&r=PG", "display_name": "BitBank", "link": "https://stackoverflow.com/users/104109/bitbank"}, "edited": false, "score": 0, "creation_date": 1456474874, "post_id": 35646260, "comment_id": 58973789, "body": "@BitBank Forgive me if I didn&#39;t understand correctly, but what about multiple passes for progressive .JPEG? Don&#39;t each pass uses a different SOS_MT block?"}, {"owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1456474983, "post_id": 35646260, "comment_id": 58973852, "body": "Thanks @user2407038, your suggestion about factoring out the word parsing is good."}, {"owner": {"reputation": 7979, "user_id": 104109, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1ef4d8fdadddc19a7314267a649bc10c?s=128&d=identicon&r=PG", "display_name": "BitBank", "link": "https://stackoverflow.com/users/104109/bitbank"}, "edited": false, "score": 1, "creation_date": 1456478413, "post_id": 35646260, "comment_id": 58975846, "body": "For progressive images, there&#39;s a SOS (FFDA) at the start of each scan. This byte sequence (FFDA) can only be interpreted as an SOS marker; compressed data with a sequence of FFDA would be encoded as FF00DA."}], "answers": [{"tags": [], "owner": {"reputation": 18530, "user_id": 3344003, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/988af95d5692ee66b1fc2fe725ba738e?s=128&d=identicon&r=PG&f=1", "display_name": "user3344003", "link": "https://stackoverflow.com/users/3344003/user3344003"}, "is_accepted": true, "score": 3, "last_activity_date": 1456518853, "creation_date": 1456518853, "answer_id": 35661211, "question_id": 35646260, "link": "https://stackoverflow.com/questions/35646260/how-to-parse-an-entropy-coded-jpeg-block-efficiently/35661211#35661211", "title": "How to parse an entropy-coded JPEG block efficiently?", "body": "<p>If you want to skip over an SOS market, just look for the next marker that is not a restart marker.</p>\n\n<p>Read bytes until you find and FF. If the next value 00, it is a compressed FF value and skip over it. If it's a restart marker skip over it. Otherwise, FF should start the next block.</p>\n"}, {"tags": [], "owner": {"reputation": 188, "user_id": 4592616, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KThLn.png?s=128&g=1", "display_name": "ThatsMe", "link": "https://stackoverflow.com/users/4592616/thatsme"}, "is_accepted": false, "score": 1, "last_activity_date": 1542431424, "creation_date": 1542431424, "answer_id": 53348436, "question_id": 35646260, "link": "https://stackoverflow.com/questions/35646260/how-to-parse-an-entropy-coded-jpeg-block-efficiently/53348436#53348436", "title": "How to parse an entropy-coded JPEG block efficiently?", "body": "<p>a small addition to the previous answer, according to the <a href=\"https://www.w3.org/Graphics/JPEG/itu-t81.pdf#page=37\" rel=\"nofollow noreferrer\">ISO/IEC 10918-1 : 1993(E)</a> standard:</p>\n\n<blockquote>\n  <p>B.1.1.5 Entropy-coded data segments</p>\n  \n  <p>An entropy-coded data segment contains the output of an entropy-coding procedure. It consists of an integer number of bytes, whether the entropy-coding procedure used is Huffman or arithmetic.</p>\n  \n  <p>NOTE 1</p>\n  \n  <p>Making entropy-coded segments an integer number of bytes is performed as follows: for Huffman coding, 1-bits are used, if necessary, to pad the end of the compressed data to complete the final byte of a segment. For arithmetic coding, byte alignment\n  is performed in the procedure which terminates the entropy-coded segment (see D.1.8).</p>\n  \n  <p>NOTE 2</p>\n  \n  <p>In order to ensure that a marker does not occur within an entropy-coded segment, any X'FF' byte generated by either a Huffman or arithmetic encoder, or an X'FF' byte that was generated by the padding of 1-bits described in NOTE 1 above, is followed\n  by a \"stuffed\" zero byte (see D.1.6 and F.1.2.3).</p>\n</blockquote>\n\n<p>so, when you enconter <em>0xFF</em> in the entropy-encoded part at position <em>N</em>, read forward one more byte. if the next byte is <em>0x00</em> then it's a \"stuffed\" zero. if it's another <em>0xFF</em> then there is a padding, re-check from <em>N+1</em>. every other byte (<em>0x01-0xFE</em>) is part of the next marker.</p>\n"}], "owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "accepted_answer_id": 35661211, "answer_count": 2, "score": 1, "last_activity_date": 1542431424, "creation_date": 1456473012, "question_id": 35646260, "link": "https://stackoverflow.com/questions/35646260/how-to-parse-an-entropy-coded-jpeg-block-efficiently", "title": "How to parse an entropy-coded JPEG block efficiently?", "body": "<p>I'm just trying to jump through a SOS_MT block in a .JPEG file, I don't want to use the data for anything, I just want to know where it ends. According to what I understand from  <a href=\"https://en.wikipedia.org/wiki/JPEG#Syntax_and_structure\" rel=\"nofollow\">JPEG's article in Wikipedia</a>, while all other blocks in the JPEG file start with a few bytes that indicate the blocks's length, a SOS_MT block is ... well, an evil swamp that you have no option but to parse byte-by-byte until you get to the end of it. </p>\n\n<p>So I came with the following code to do just that:</p>\n\n<pre><code>entropyCoded :: Parser Int\nentropyCoded = do\n    list_of_lengths &lt;-  many' $\n         (\n           do\n             _ &lt;- notWord8 0xFF\n             return 1\n         )\n         &lt;|&gt;\n         (\n           do\n             _ &lt;- word8 0xFF\n             _ &lt;- word8 0\n             return 2\n         )\n         &lt;|&gt;\n         (\n           do\n             l &lt;- many1 (word8 0xFF)\n             _ &lt;- satisfy (\\x -&gt; ( x &gt;= 0xD0 &amp;&amp; x &lt; 0xD7 ))\n             return $ 1 + length l\n         )\n         &lt;|&gt;\n         (\n           do\n             _ &lt;- word8 0xFF\n             maybe_ff &lt;- peekWord8'\n             if maybe_ff == 0xFF\n               then\n                 return 1\n               else\n                 fail \"notthere\"\n         )\n    foldM (\\ nn n -&gt; nn `seq` return (nn + n) ) 0 list_of_lengths\n</code></pre>\n\n<p>This code uses <a href=\"https://hackage.haskell.org/package/attoparsec\" rel=\"nofollow\">Atoparsec</a> and as far as I have had the chance to verify it, it is correct. It is just slow. Any tips on how to improve, performance-wise, this parser?</p>\n"}, {"tags": ["haskell", "hakyll"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 1218066, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3ba4285ca136e6bbf80c600722f1a977?s=128&d=identicon&r=PG&f=1", "display_name": "nesqi", "link": "https://stackoverflow.com/users/1218066/nesqi"}, "edited": false, "score": 0, "creation_date": 1456491225, "post_id": 35651294, "comment_id": 58984656, "body": "Given that the &quot;titleLine&quot; version uses the same routing the url will be correct."}, {"owner": {"reputation": 1070, "user_id": 1461430, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a5f25d8b93603aece2130069a2c759ec?s=128&d=identicon&r=PG", "display_name": "rlpowell", "link": "https://stackoverflow.com/users/1461430/rlpowell"}, "edited": false, "score": 0, "creation_date": 1509638552, "post_id": 35651294, "comment_id": 81108305, "body": "I can confirm this worked for me; see also <a href=\"https://stackoverflow.com/questions/47067851/how-do-i-avoid-a-dependency-cycle-when-generating-a-list-of-recent-posts-on-post\" title=\"how do i avoid a dependency cycle when generating a list of recent posts on post\">stackoverflow.com/questions/47067851/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": false, "score": 3, "last_activity_date": 1456496221, "last_edit_date": 1456496221, "creation_date": 1456488421, "answer_id": 35651294, "question_id": 35645525, "link": "https://stackoverflow.com/questions/35645525/hakyll-says-dependency-cycle-detected/35651294#35651294", "title": "Hakyll says &quot;Dependency cycle detected: ...&quot;", "body": "<p>By calling <code>loadAll \"posts/*\"</code> you load every fully compiled post before compile the current one, so it's a cycle dependency.</p>\n\n<p>The most straightforward solution is to define another version of your posts:</p>\n\n<pre><code>match \"posts/*\" $ version \"titleLine\" $ do\n  -- route\n  -- compiler, maybe generate a link to real page here from file path\n</code></pre>\n\n<p>Then you can load them all without triggering a cycle dependency:</p>\n\n<pre><code>match \"posts/*\" $ do\n  -- route\n  compile $ do\n    postList &lt;- loadAll (\"posts/*\" .&amp;&amp;. hasVersion \"titleLine\")\n    -- render the page\n</code></pre>\n\n<p>But you may have to manually generate the correct url from file path, after all a different version is a different page with different url. If you set the same routing for more than one page, the last one compiled will overwrite all the others. </p>\n\n<p>It's OK in your case since the non-tagged version depends on the \"titleLine\" version so is compiled later, but generally it's dangerous to have same routing for different pages, without such a dependency <code>version</code> tagged page is always compiled later.</p>\n"}], "owner": {"reputation": 97, "user_id": 1218066, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3ba4285ca136e6bbf80c600722f1a977?s=128&d=identicon&r=PG&f=1", "display_name": "nesqi", "link": "https://stackoverflow.com/users/1218066/nesqi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 564, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1456496221, "creation_date": 1456470235, "last_edit_date": 1456472614, "question_id": 35645525, "link": "https://stackoverflow.com/questions/35645525/hakyll-says-dependency-cycle-detected", "title": "Hakyll says &quot;Dependency cycle detected: ...&quot;", "body": "<p>I'm trying to construct a site with 7 pages. Each page is defined using a .markdown input. On each page I want a header with links to all the other pages.</p>\n\n<p>Now, this seems to be impossible since Hakyll tells me that I have a recursive dependency.</p>\n\n<pre><code>[ERROR] Hakyll.Core.Runtime.chase: Dependency cycle detected: posts/page1.markdown depends on posts/page1.markdown\n</code></pre>\n\n<p>I have identified the recursive dependency to this snippet.</p>\n\n<pre><code>match \"posts/*\" $ do\n    route $ setExtension \"html\"\n    compile $ do\n        posts &lt;- loadAll \"posts/*\"\n        let indexCtx =\n                listField \"posts\" postCtx (return posts) `mappend`\n                constField \"title\" \"Home\"                `mappend`\n                defaultContext\n\n        pandocCompiler &gt;&gt;= loadAndApplyTemplate \"templates/post.html\" indexCtx\n              &gt;&gt;= loadAndApplyTemplate \"templates/default.html\" indexCtx\n              &gt;&gt;= relativizeUrls\n</code></pre>\n\n<p>I guess the problem is that I'm not allowed to match on the same template that a do a load on.</p>\n\n<p>So how can I construct a context with a listField for all posts to be used when generating posts.</p>\n\n<p>I guess an alternative would be to generate the links first, store them somehow and then include them in the posts. But how would I do that?</p>\n"}, {"tags": ["haskell", "haskell-snap-framework"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1456469724, "post_id": 35645033, "comment_id": 58971231, "body": "I&#39;m not familiar with Snap or Heist (?) but <a href=\"http://hackage.haskell.org/package/snap-0.14.0.6\" rel=\"nofollow noreferrer\">Snap itself already depends on lens</a>. If you are using Snap, you are using <code>lens</code> - there is no way around this other than to fork the library and modify it to not use <code>lens</code>. Furthermore, while many <code>lens</code> types are simply type synonyms (so you don&#39;t need actually use <code>lens</code> to use lenses), <code>SnapletLens</code> contains a concrete type from <code>lens</code>, meaning you really have to use lens here."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1456471171, "post_id": 35645576, "comment_id": 58971938, "body": "Note that any <code>Lens</code> can function as an <code>ALens</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user266003"}, "edited": false, "score": 0, "creation_date": 1456472332, "post_id": 35645576, "comment_id": 58972519, "body": "there&#39;s no lens here &quot;<a href=\"https://github.com/cakesolutions/the-pragmatic-haskeller/blob/e1251bfd8ec00d88fd817527db3ed7ad03e14fa6/07-forms/src/Pragmatic/Server/Site.hs\" rel=\"nofollow noreferrer\">github.com/cakesolutions/the-pragmatic-haskeller/blob/&hellip;</a>&quot;"}, {"owner": {"reputation": 3609, "user_id": 2565354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/590ed3229d95cdcaa05a96028c586165?s=128&d=identicon&r=PG", "display_name": "badcook", "link": "https://stackoverflow.com/users/2565354/badcook"}, "edited": false, "score": 0, "creation_date": 1456472584, "post_id": 35645576, "comment_id": 58972651, "body": "It&#39;s imported by an <code>import Pragmatic.Server.Application</code> statement. If you go to that <a href=\"https://github.com/cakesolutions/the-pragmatic-haskeller/blob/e1251bfd8ec00d88fd817527db3ed7ad03e14fa6/07-forms/src/Pragmatic/Server/Application.hs\" rel=\"nofollow noreferrer\">file</a>, you&#39;ll see exactly the same pattern of <code>data Pragmatic = { _heist :: Snaplet (Heist App) ...}</code> followed by <code>makeLenses &#39;&#39;Pragmatic</code>"}, {"owner": {"reputation": 3609, "user_id": 2565354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/590ed3229d95cdcaa05a96028c586165?s=128&d=identicon&r=PG", "display_name": "badcook", "link": "https://stackoverflow.com/users/2565354/badcook"}, "edited": false, "score": 0, "creation_date": 1456473038, "post_id": 35645576, "comment_id": 58972905, "body": "Also @OskarK., your hyperlink has an extra quotation mark at the end that makes it 404."}, {"owner": {"user_type": "does_not_exist", "display_name": "user266003"}, "edited": false, "score": 0, "creation_date": 1456478057, "post_id": 35645576, "comment_id": 58975608, "body": "it complains &quot;Parse error: naked expression at top level&quot; for <b>makeLenses &#39;&#39;App</b>"}, {"owner": {"reputation": 3609, "user_id": 2565354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/590ed3229d95cdcaa05a96028c586165?s=128&d=identicon&r=PG", "display_name": "badcook", "link": "https://stackoverflow.com/users/2565354/badcook"}, "edited": false, "score": 0, "creation_date": 1456478581, "post_id": 35645576, "comment_id": 58975962, "body": "Assuming you&#39;ve imported Control.Lens.TH, you&#39;ll need to enable Template Haskell. The easiest way is to specify in a pragma at the top of the file <code>{-# LANGUAGE TemplateHaskell #-}</code>."}], "tags": [], "owner": {"reputation": 3609, "user_id": 2565354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/590ed3229d95cdcaa05a96028c586165?s=128&d=identicon&r=PG", "display_name": "badcook", "link": "https://stackoverflow.com/users/2565354/badcook"}, "is_accepted": true, "score": 1, "last_activity_date": 1456470435, "creation_date": 1456470435, "answer_id": 35645576, "question_id": 35645033, "link": "https://stackoverflow.com/questions/35645033/not-in-scope-heist-im-not-using-lens/35645576#35645576", "title": "Not in scope: \u2018heist\u2019 (I&#39;m not using Lens)", "body": "<p>I'm not familiar with Snap, but judging from the type signature of <code>nestSnaplet</code>, it looks like you're going to need to use a lens of some sort. <code>nestSnaplet</code> has the signature</p>\n\n<pre><code>nestSnaplet :: ByteString -&gt; SnapletLens v v1 -&gt; SnapletInit b v1-&gt; Initializer b v (Snaplet v1)\n</code></pre>\n\n<p>where <code>SnapletLens</code> is just a type synonym for an <code>Alens</code> from <code>lens</code>.</p>\n\n<p>That also leads me to suspect that <code>heist</code> was originally a Template Haskell derived function made using <code>lens</code>. Probably what happened is that <code>App</code> used to look like this:</p>\n\n<pre><code>-- You may need to import Contol.Lens.TH\ndata App = App { _heist :: Snaplet (Heist App) }\nmakeLenses ''App\n</code></pre>\n\n<p>which would have made <code>heist</code> a lens.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user266003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "accepted_answer_id": 35645576, "answer_count": 1, "score": 0, "last_activity_date": 1456470435, "creation_date": 1456468363, "question_id": 35645033, "link": "https://stackoverflow.com/questions/35645033/not-in-scope-heist-im-not-using-lens", "title": "Not in scope: \u2018heist\u2019 (I&#39;m not using Lens)", "body": "<p>I have an error in this code in Snap haskell app:</p>\n\n<pre><code>import Snap.Http.Server\nimport Snap.Core\nimport Snap.Snaplet\nimport Snap.Snaplet.Heist\nimport Snap.Util.FileServe\nimport Snap.Util.GZip\nimport Heist.Interpreted\nimport Heist\n\ndata App = App { appHeist :: Snaplet (Heist App) }\n\nroutes :: [(ByteString, Handler App App ())]\nroutes = [(\"\", serveDirectory \"static\")]\n\nappInit :: SnapletInit App App\nappInit = makeSnaplet \"app\" \"An snaplet example application.\" Nothing $ do\n    h &lt;- nestSnaplet \"\" heist $ heistInit \"templates\"\n    addRoutes routes\n    return $ App h\n</code></pre>\n\n<p>The error is:</p>\n\n<pre><code>Not in scope: \u2018heist\u2019\n</code></pre>\n\n<p>and I can't find in what package the function \"heist\" is. </p>\n\n<p><strong>Note that I'm not using Lens and don't want to.</strong>\nIs there any way not to use them and make my code compile?</p>\n"}, {"tags": ["list", "function", "haskell"], "comments": [{"owner": {"reputation": 3609, "user_id": 2565354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/590ed3229d95cdcaa05a96028c586165?s=128&d=identicon&r=PG", "display_name": "badcook", "link": "https://stackoverflow.com/users/2565354/badcook"}, "edited": false, "score": 2, "creation_date": 1456458457, "post_id": 35643045, "comment_id": 58967124, "body": "Your <code>maxOfTwoLists</code> pattern matches on two lists of one element each"}, {"owner": {"reputation": 21, "user_id": 5983921, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205917323676135/picture?type=large", "display_name": "LukeshotFirst", "link": "https://stackoverflow.com/users/5983921/lukeshotfirst"}, "reply_to_user": {"reputation": 3609, "user_id": 2565354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/590ed3229d95cdcaa05a96028c586165?s=128&d=identicon&r=PG", "display_name": "badcook", "link": "https://stackoverflow.com/users/2565354/badcook"}, "edited": false, "score": 0, "creation_date": 1456503760, "post_id": 35643045, "comment_id": 58993918, "body": "ahhh that makes sense. How do i make it match on an entire list?"}, {"owner": {"reputation": 3609, "user_id": 2565354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/590ed3229d95cdcaa05a96028c586165?s=128&d=identicon&r=PG", "display_name": "badcook", "link": "https://stackoverflow.com/users/2565354/badcook"}, "edited": false, "score": 0, "creation_date": 1456505078, "post_id": 35643045, "comment_id": 58994843, "body": "Remove the square brackets (both on the arguments and in the function body)"}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 3, "creation_date": 1456467427, "post_id": 35643959, "comment_id": 58970297, "body": "If you&#39;re going to use <code>++</code>, don&#39;t bother with the patterns for the <code>[]</code> cases. Just the third case is plenty on its own."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1456478555, "post_id": 35643959, "comment_id": 58975950, "body": "The same holds when using <code>merge</code>: there&#39;s no need to handle empty lists since <code>merge</code> is handling those. (Of course, if both lists are empty, <code>maximum</code> will still raise an exception)"}, {"owner": {"reputation": 21, "user_id": 5983921, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205917323676135/picture?type=large", "display_name": "LukeshotFirst", "link": "https://stackoverflow.com/users/5983921/lukeshotfirst"}, "edited": false, "score": 1, "creation_date": 1456503670, "post_id": 35643959, "comment_id": 58993847, "body": "i knew this was a solution! Im just a newbie to haskell. Thanks so much!"}], "tags": [], "owner": {"reputation": 19188, "user_id": 390708, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/34539ce56dfaf01d34a91861205f379d?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/390708/brian"}, "is_accepted": false, "score": 1, "last_activity_date": 1456468069, "last_edit_date": 1456468069, "creation_date": 1456463560, "answer_id": 35643959, "question_id": 35643045, "link": "https://stackoverflow.com/questions/35643045/finding-the-highest-number-of-two-lists-haskell/35643959#35643959", "title": "Finding the Highest number of two lists-haskell", "body": "<p>As @badcook notes the pattern match isn't quite right.</p>\n\n<pre><code>merge :: [a] -&gt; [a] -&gt; [a]\nmerge xs [] = xs\nmerge [] ys = ys\nmerge (x:xs) (y:ys) = x : y : merge xs ys\n\nmaxOfTwoLists :: (Ord a) =&gt; [a] -&gt; [a] -&gt; a\nmaxOfTwoLists [] ys = maximum ys\nmaxOfTwoLists xs [] = maximum xs\nmaxOfTwoLists xs ys = maximum (merge xs ys)\n</code></pre>\n\n<p>I'll guess you wrote the <code>merge</code> function as an exercise but you can also use <code>++</code> from <code>Prelude</code> to append one list to another.</p>\n\n<pre><code>maxOfTwoLists :: (Ord a) =&gt; [a] -&gt; [a] -&gt; a\nmaxOfTwoLists xs ys = maximum (xs ++ ys)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>\u03bb&gt; maxOfTwoLists [1,2,3] [4,5,6]\n6\n\u03bb&gt; maxOfTwoLists [1,2,3] []\n3\n\u03bb&gt; maxOfTwoLists [] [1,2,3]\n3\n\u03bb&gt; \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 5983921, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205917323676135/picture?type=large", "display_name": "LukeshotFirst", "link": "https://stackoverflow.com/users/5983921/lukeshotfirst"}, "edited": false, "score": 0, "creation_date": 1456503886, "post_id": 35644101, "comment_id": 58994003, "body": "that $ sign will be usefull later on as well. Thank you very much."}], "tags": [], "owner": {"reputation": 106, "user_id": 5266305, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lAIMQBXKBjc/AAAAAAAAAAI/AAAAAAAAEcs/RtovU0j9N2U/photo.jpg?sz=128", "display_name": "Austin", "link": "https://stackoverflow.com/users/5266305/austin"}, "is_accepted": false, "score": 1, "last_activity_date": 1456464214, "creation_date": 1456464214, "answer_id": 35644101, "question_id": 35643045, "link": "https://stackoverflow.com/questions/35643045/finding-the-highest-number-of-two-lists-haskell/35644101#35644101", "title": "Finding the Highest number of two lists-haskell", "body": "<p>If you're looking to merge two lists, the builtin <code>concat</code> would help. It flattens a list, so we could do the following:</p>\n\n<pre><code>maxOfTwoLists :: (Ord a) =&gt; [a] -&gt; [a] -&gt; a\nmaxOfTwoLists xs ys = maximum $ concat [xs,ys]\n</code></pre>\n\n<p>In which, <code>$</code> means to evaluate the result of the right side function before applying it to the left side function.</p>\n"}], "owner": {"reputation": 21, "user_id": 5983921, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205917323676135/picture?type=large", "display_name": "LukeshotFirst", "link": "https://stackoverflow.com/users/5983921/lukeshotfirst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1456468069, "creation_date": 1456458342, "last_edit_date": 1456460058, "question_id": 35643045, "link": "https://stackoverflow.com/questions/35643045/finding-the-highest-number-of-two-lists-haskell", "title": "Finding the Highest number of two lists-haskell", "body": "<pre><code>merge :: [a] -&gt; [a] -&gt; [a]\n\nmerge xs     []     = xs\n\nmerge []     ys     = ys\n\nmerge (x:xs) (y:ys) = x : y : merge xs ys\n\nmaxOfTwoLists  [x] [y]  = maximum (merge [x] [y])\n</code></pre>\n\n<p>I am trying to combine the two lists then find the max value in the single list. It compiles but when i call <code>maxOfTwoLists</code> it gives me a non-exhaustive patterns error. My merge returns a single list just fine, and maximum takes a single list. So it feels like it should be working.</p>\n"}, {"tags": ["haskell", "functor", "quickcheck"], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 5, "last_activity_date": 1456447685, "creation_date": 1456447685, "answer_id": 35641316, "question_id": 35641067, "link": "https://stackoverflow.com/questions/35641067/quickchecking-simple-functors-is-defining-an-arbitrary-instance-necessary-why/35641316#35641316", "title": "QuickChecking simple Functors: Is defining an Arbitrary instance necessary ? Why ? How?", "body": "<p>You sure need the instance in order to work with quickcheck.</p>\n\n<p>But, <em>because</em> this functor is so simple, that's pretty trivial: <code>Identity A</code> is isomorphic to <code>A</code> itself, so it also permits the exact same <code>Arbitrary</code> instance. It's basically the same deal as with your <code>Eq</code> instance.</p>\n\n<pre><code>instance (Arbitrary a) =&gt; Arbitrary (Identity a) where\n    arbitrary = Identity &lt;$&gt; arbitrary\n    shrink (Identity v) = Identity &lt;$&gt; shrink v\n</code></pre>\n"}], "owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 1, "accepted_answer_id": 35641316, "answer_count": 1, "score": 1, "last_activity_date": 1456447685, "creation_date": 1456446157, "question_id": 35641067, "link": "https://stackoverflow.com/questions/35641067/quickchecking-simple-functors-is-defining-an-arbitrary-instance-necessary-why", "title": "QuickChecking simple Functors: Is defining an Arbitrary instance necessary ? Why ? How?", "body": "<p>I'm doing exercise with Functors and QuickCheck.</p>\n\n<p>I have a super simple Functor, whose composition law I wish to quickCheck.\nThe Functor is simply an <code>Identity a</code>.\nThis is the code I have so far:</p>\n\n<pre><code>import Data.Functor\nimport Test.QuickCheck\n\nnewtype Identity a = Identity a\n\ninstance (Eq a) =&gt; Eq (Identity a) where\n    (==) (Identity x) (Identity y) = x == y\n    (/=) (Identity x) (Identity y) = x /= y\n\ninstance Functor Identity where\n    fmap f (Identity x) = Identity (f x)\n\npropertyFunctorCompose ::(Eq (f c), Functor f) =&gt; (a -&gt; b) -&gt; (b -&gt; c) -&gt; f a -&gt; Bool\npropertyFunctorCompose f g fr = (fmap (g . f) fr) == (fmap g . fmap f) fr\n\nmain = do\n    quickCheck $ \\x -&gt; propertyFunctorCompose (+1) (*2) (x :: Identity Int) \n</code></pre>\n\n<p>Unfortunately this code does not compile, and ghc complains with this compilation error:</p>\n\n<pre><code>functor_exercises.hs:43:5:\n    No instance for (Arbitrary (Identity Int))\n      arising from a use of `quickCheck'\n    Possible fix:\n      add an instance declaration for (Arbitrary (Identity Int))\n    In the expression: quickCheck\n    In a stmt of a 'do' block:\n      quickCheck $ \\ x -&gt; propertyFunctorId (x :: Identity Int)\n    In the expression:\n      do { quickCheck $ \\ x -&gt; propertyFunctorId (x :: [Int]);\n           quickCheck\n           $ \\ x -&gt; propertyFunctorCompose (+ 1) (* 2) (x :: [Int]);\n           quickCheck (propertyFunctorCompose' :: IntFC);\n           quickCheck $ \\ x -&gt; propertyFunctorId (x :: Identity Int);\n           .... }\n</code></pre>\n\n<p>So I have started to look at the QuickCheck Arbitrary typeclass, and it needs to define <code>arbitrary :: Gen a</code> and <code>shrink :: a -&gt; [a]</code>.</p>\n\n<p>I have the (maybe false) feeling, that I should not need to define the Arbitrary instance for such a simple functor.</p>\n\n<p>And if I really need to define the instance Arbitrary for Identity, then I have no idea what <code>arbitrary</code> and <code>shrink</code> should look like and how they should behave.</p>\n\n<p>Could you guide me on this ?</p>\n"}]