[{"tags": ["haskell", "module", "version", "cabal"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1455146119, "post_id": 35326937, "comment_id": 58364235, "body": "<a href=\"http://stackoverflow.com/questions/6526353/package-versioning-clashes-in-cabal\">Related question</a> (if not duplicate)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1455147137, "post_id": 35326937, "comment_id": 58364669, "body": "You may think reimplementing <code>readCreateProcess</code> yourself is painful; you may think updating your dependencies to work with <code>process-1.2.3</code> is painful; but those are mere hangnails -- sharp, one-time pains that end quickly and never resurface -- compared to the appendicitis of having two versions of the same package in your dependency tree -- a random, unpredictable time-bomb that completely incapacitates you at the worst possible moment."}, {"owner": {"reputation": 4009, "user_id": 1549476, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dxQHN.png?s=128&g=1", "display_name": "k_g", "link": "https://stackoverflow.com/users/1549476/k-g"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1455148568, "post_id": 35326937, "comment_id": 58365137, "body": "@Daniel I realize the risks, but I was thinking I could import and re-export it from a small module solely used for that purpose. I also do not need to use it in conjunction with other functions, I&#39;m effectively using it as a black box string in, string out function."}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1455159098, "post_id": 35326937, "comment_id": 58368066, "body": "Is there any complexity in your use case preventing you from using plain <code>readProcess</code>?"}, {"owner": {"reputation": 4009, "user_id": 1549476, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dxQHN.png?s=128&g=1", "display_name": "k_g", "link": "https://stackoverflow.com/users/1549476/k-g"}, "edited": false, "score": 0, "creation_date": 1455159181, "post_id": 35326937, "comment_id": 58368091, "body": "@zakyggapps yes. I need to pass user input, which is a shell command. If there is a portable unescaping function, I can use that instead."}, {"owner": {"reputation": 4009, "user_id": 1549476, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dxQHN.png?s=128&g=1", "display_name": "k_g", "link": "https://stackoverflow.com/users/1549476/k-g"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1455169615, "post_id": 35326937, "comment_id": 58371233, "body": "@DanielWagner updating dependencies is almost impossible, I have a lot of packages that require the old process.  Unless you mean manual rebuilding."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1455215344, "post_id": 35326937, "comment_id": 58401536, "body": "@zakyggaps It probably makes more sense to suggest using <code>createProcess</code> as the replacement for <code>readCreateProcess</code> than it does to suggest using <code>readProcess</code> as the replacement."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1455215795, "post_id": 35326937, "comment_id": 58401818, "body": "@k_g Out of curiosity, which packages are requiring <code>process &lt;= 1.2</code>? <code>process-1.2</code> was released in 2013! Additionally, I find your claim that it is &quot;almost impossible&quot; to update the dependencies strange; the API has been pretty stable, so I would expect that in almost all cases the fix is changing just one character in the appropriate cabal file."}, {"owner": {"reputation": 4009, "user_id": 1549476, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dxQHN.png?s=128&g=1", "display_name": "k_g", "link": "https://stackoverflow.com/users/1549476/k-g"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1455237760, "post_id": 35326937, "comment_id": 58412910, "body": "@DanielWagner Thanks for asking all those questions, I figured out how to fix the problem myself (see answer)"}], "answers": [{"tags": [], "owner": {"reputation": 4009, "user_id": 1549476, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dxQHN.png?s=128&g=1", "display_name": "k_g", "link": "https://stackoverflow.com/users/1549476/k-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1455237900, "creation_date": 1455237900, "answer_id": 35352881, "question_id": 35326937, "link": "https://stackoverflow.com/questions/35326937/how-to-import-a-specific-version-of-a-module/35352881#35352881", "title": "How to import a specific version of a module", "body": "<p>I realized that the fastest thing would be to fork <code>process-1.4</code>. I then renamed the package <code>processnew</code> and all the files within <code>System.ProcessNew</code> and <code>System.CmdNew</code>.</p>\n\n<p>I then set it up as a submodule.</p>\n\n<p>I then installed this package, added <code>processnew &gt;= 1.4</code> to my <code>.cabal</code>, and imported <code>System.ProcessNew(readCreateProcess, shell)</code>.</p>\n"}], "owner": {"reputation": 4009, "user_id": 1549476, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dxQHN.png?s=128&g=1", "display_name": "k_g", "link": "https://stackoverflow.com/users/1549476/k-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 0, "accepted_answer_id": 35352881, "answer_count": 1, "score": 1, "last_activity_date": 1455237900, "creation_date": 1455142140, "question_id": 35326937, "link": "https://stackoverflow.com/questions/35326937/how-to-import-a-specific-version-of-a-module", "title": "How to import a specific version of a module", "body": "<p>I have a project where I want to use <code>readCreateProcess</code> (I need the ability to portably pass a command to the default shell with input and read its output).</p>\n\n<p>However, this function was only added in process-1.2.3 and several other packages I use (all newest versions) require <code>process &lt;=1.2</code>.</p>\n\n<p>I was wondering if I could import <code>readCreateProcess</code> from the newer package while still using the other packages.</p>\n\n<p>I am using ghc/cabal for building and testing, if that is at all relevant.</p>\n"}, {"tags": ["haskell", "ghc", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 1, "last_activity_date": 1455459945, "creation_date": 1455459945, "answer_id": 35392862, "question_id": 35325651, "link": "https://stackoverflow.com/questions/35325651/how-to-get-stack-to-always-use-the-latest-lts-when-starting-a-new-project/35392862#35392862", "title": "How to get stack to always use the latest LTS when starting a new project?", "body": "<p>Yes, you can use:</p>\n\n<pre><code>stack new projectname --resolver=lts\n</code></pre>\n\n<p>Similarly, you can use <code>--resolver=lts-5</code> to get the latest in the 5 series, or <code>--resolver=nightly</code> for the latest nightly. For more information, see <a href=\"http://docs.haskellstack.org/en/stable/GUIDE.html#resolvers-and-changing-your-compiler-version\" rel=\"nofollow\">the Stack user guide</a>.</p>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 35392862, "answer_count": 1, "score": 0, "last_activity_date": 1455459945, "creation_date": 1455137476, "last_edit_date": 1455399350, "question_id": 35325651, "link": "https://stackoverflow.com/questions/35325651/how-to-get-stack-to-always-use-the-latest-lts-when-starting-a-new-project", "title": "How to get stack to always use the latest LTS when starting a new project?", "body": "<p>It is a bit of a hassle to always have to go to <a href=\"http://stackage.org\" rel=\"nofollow\">stackage.org</a> to check what the latest LTS version is and then type in the command:</p>\n\n<pre><code>stack new projectname --resolver=lts-X.XX\n</code></pre>\n\n<p>Is there a way to get stack to always discover the latest LTS and use that for new projects?</p>\n"}, {"tags": ["haskell", "state-monad", "frege"], "answers": [{"comments": [{"owner": {"reputation": 811, "user_id": 4515400, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/JjvHb.png?s=128&g=1", "display_name": "libnull-dev", "link": "https://stackoverflow.com/users/4515400/libnull-dev"}, "edited": false, "score": 0, "creation_date": 1455134430, "post_id": 35323162, "comment_id": 58358411, "body": "Yes, this solution seems to mimic  <code>state</code> function from Haskell <code>Control.Monad.Trans.State</code> as explained in Wikibook <a href=\"https://en.wikibooks.org/wiki/Haskell/Understanding_monads/State\" rel=\"nofollow noreferrer\">here.</a>"}], "tags": [], "owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "is_accepted": true, "score": 3, "last_activity_date": 1455129013, "creation_date": 1455129013, "answer_id": 35323162, "question_id": 35321657, "link": "https://stackoverflow.com/questions/35321657/creating-instance-of-state-in-frege/35323162#35323162", "title": "Creating instance of State in Frege", "body": "<p>Can't you just write a smart constructor?</p>\n\n<pre><code>state :: (s -&gt; (a, s)) -&gt; State s a\nstate f = do\n    s &lt;- State.get\n    let (x, s') = f s\n    State.put s'\n    return x\n</code></pre>\n\n<p>Write it once (maybe in a library you make available for download?) and then use it anywhere you need it.</p>\n"}, {"comments": [{"owner": {"reputation": 811, "user_id": 4515400, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/JjvHb.png?s=128&g=1", "display_name": "libnull-dev", "link": "https://stackoverflow.com/users/4515400/libnull-dev"}, "edited": false, "score": 0, "creation_date": 1455190563, "post_id": 35325247, "comment_id": 58383667, "body": "That sounds reasonably, but I still don&#39;t get how having constructor would break anything."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 811, "user_id": 4515400, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/JjvHb.png?s=128&g=1", "display_name": "libnull-dev", "link": "https://stackoverflow.com/users/4515400/libnull-dev"}, "edited": false, "score": 0, "creation_date": 1455193441, "post_id": 35325247, "comment_id": 58385774, "body": "@libnull-dev Because the constructor reveals implementation details like that State s a is isomorphic with s-&gt;(a,s) , but as I tried to explain this is not necessarily the best implementation. the implementation can&#39;t change in a backwards compatible way when you - the stdlib consumer - know the constructor."}, {"owner": {"reputation": 811, "user_id": 4515400, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/JjvHb.png?s=128&g=1", "display_name": "libnull-dev", "link": "https://stackoverflow.com/users/4515400/libnull-dev"}, "edited": false, "score": 0, "creation_date": 1455273865, "post_id": 35325247, "comment_id": 58427062, "body": "OK, so does it mean that <code>State</code> can have different than <code>State s a</code> representation?"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 811, "user_id": 4515400, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/JjvHb.png?s=128&g=1", "display_name": "libnull-dev", "link": "https://stackoverflow.com/users/4515400/libnull-dev"}, "edited": false, "score": 0, "creation_date": 1455274174, "post_id": 35325247, "comment_id": 58427272, "body": "The type is of course always State s a. But it doesn&#39;t have to be isomorphic with a s -&gt; (a,s) function. And there need not be a constructor with the name State."}], "tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 1, "last_activity_date": 1455136066, "creation_date": 1455136066, "answer_id": 35325247, "question_id": 35321657, "link": "https://stackoverflow.com/questions/35321657/creating-instance-of-state-in-frege/35325247#35325247", "title": "Creating instance of State in Frege", "body": "<p>Indeed, the construction of some specific state instance with</p>\n\n<pre><code>State random\n</code></pre>\n\n<p>is quite elegant, and it's impossible in Frege because the <code>State</code> data constructor is not accessible. This is unfortunate, but it also protects you from writing code that depends on some implementation details.</p>\n\n<p>For example, I'm currectly working on a new backend for Frege that utilizes Java lambdas and tries to emit typesafe generic Java code, and in the course of doing this it turned out that I need another representation for State. Thus, in the next Frege release, there simply is no <code>State</code> constructor anymore that would take a function as argument.</p>\n\n<p>Despite of this change and the fact that big parts of the compiler consist of State operations, I didn't had to change any single line in the compiler code because of this. And I can alos be sure hat I won't hurt anybody else's code. Big win!</p>\n\n<p>Anyway, I feel like we could include @jcast's smart state constructor in the standard library. (I'd just rewrite the let into a case.)</p>\n"}], "owner": {"reputation": 811, "user_id": 4515400, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/JjvHb.png?s=128&g=1", "display_name": "libnull-dev", "link": "https://stackoverflow.com/users/4515400/libnull-dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 35323162, "answer_count": 2, "score": 3, "last_activity_date": 1455136066, "creation_date": 1455124407, "question_id": 35321657, "link": "https://stackoverflow.com/questions/35321657/creating-instance-of-state-in-frege", "title": "Creating instance of State in Frege", "body": "<p>In <a href=\"https://github.com/y-taka-23/learn-you-a-frege\" rel=\"nofollow\">y-taka-23 adaptation of LYAH</a> I found that most of snippets for Chapter 13 must deal with lack of <code>State</code> constructor, for example original Haskell code:</p>\n\n<pre><code>randomSt = State random \n</code></pre>\n\n<p>is rewritten as:</p>\n\n<pre><code>randomSt = do\n    gen &lt;- State.get\n    let (x, newGen) = random gen\n    State.put newGen\n    return x \n</code></pre>\n\n<p>This of course has its own didactic merits! But I wonder if there is another way of creating instance of <code>State</code>. I know that this discrepancy between  Frege and Haskell comes from the fact that <code>State s a</code> in Frege's <code>Control.monad.State</code> module is an abstract data type.  Is it possible to define new concrete data type which derives from it and use its constructor instead?</p>\n"}, {"tags": ["haskell", "random"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1455122194, "post_id": 35320680, "comment_id": 58350383, "body": "Remark: If code already works and you&#39;re interested in a review, it might be a candidate for <a href=\"https://codereview.stackexchange.com\">Code Review</a>."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1455122445, "post_id": 35320680, "comment_id": 58350575, "body": "Not really. If all this explicit passing is bothering you you could wrap it in <code>State</code>, then your signature would look like <code>genRandomSeq :: (RandomGen g, Random a) =&gt; Int -&gt; (a,a) -&gt; State g [a]</code>, you be the judge of if you like that better."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1455124004, "post_id": 35320680, "comment_id": 58351756, "body": "MonadRandom (and MonadCryptoRandom) are two packages that keep the generator in a state monad for you and provide easy routines in the form <code>get me random(s) of type X</code>."}], "answers": [{"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": true, "score": 1, "last_activity_date": 1455133268, "last_edit_date": 1455133268, "creation_date": 1455132716, "answer_id": 35324271, "question_id": 35320680, "link": "https://stackoverflow.com/questions/35320680/haskell-generating-random-sequence-and-passing-the-generator/35324271#35324271", "title": "haskell generating random sequence and passing the generator", "body": "<p>I find that passing seeds explicitly is clunky, annoying and leads to poor composability.  My favored approach is to use a custom monad for random number generation.  <a href=\"https://hackage.haskell.org/package/MonadRandom\" rel=\"nofollow\">The <code>MonadRandom</code> library</a> is the granddaddy of them all, I understand, but there's also <a href=\"https://hackage.haskell.org/package/random-fu\" rel=\"nofollow\"><code>random-fu</code></a> which is more featureful but a bit harder to get started with.</p>\n\n<p>Using <code>MonadRandom</code> and similar tools your function can be written this way (not tested, but it should be about right):</p>\n\n<pre><code>import Control.Monad (replicateM)\nimport Control.Monad.Random\n\ngenRandomSeq :: Random a =&gt; Int -&gt; (a,a) -&gt; Rand g [a]\ngetRandomSeq n range = replicateM n (getRandomR range)\n\n-- Your function is this, but in practice I might not bother writing it\n-- out as its own definition\u2014basically, I'd work in the `Rand` monad as \n-- much as possible and only `runRand` where I really need to.\nrunIt :: (RandomGen g, Random a) =&gt; Int -&gt; (a,a) -&gt; g -&gt; ([a], g)\nrunIt n range g = runRand (getRandomSeq n range) g\n</code></pre>\n\n<p>If you haven't studied the <code>State</code> monad this would be a good point for you to do so.  The <code>Rand</code> monad is just a specialized state monad with a few utility functions to make it easier to work with random generation.</p>\n\n<p><strong>EXERCISE:</strong> Write your own version of the <code>Rand</code> type, its <code>Functor</code>, <code>Applicative</code> and <code>Monad</code> instances, and the <code>getRandomR</code> operation.</p>\n"}], "owner": {"reputation": 5013, "user_id": 969617, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/2412de50d273085f5dcf3f2101c3996e?s=128&d=identicon&r=PG", "display_name": "beoliver", "link": "https://stackoverflow.com/users/969617/beoliver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 35324271, "answer_count": 1, "score": 2, "last_activity_date": 1455133268, "creation_date": 1455121811, "last_edit_date": 1455122119, "question_id": 35320680, "link": "https://stackoverflow.com/questions/35320680/haskell-generating-random-sequence-and-passing-the-generator", "title": "haskell generating random sequence and passing the generator", "body": "<p>I would like to create random sequences while still passing the randomGenerator <code>mkStdGen</code></p>\n\n<p>I have come up with the following, which seems to work, but I am wondering if there is a better/proper way of doing this? </p>\n\n<pre><code>genRandomSeq :: (RandomGen g, Random a) =&gt; Int -&gt; (a,a) -&gt; g -&gt; ([a], g)\ngenRandomSeq n rng g =\n  foldr (\\_ (acc,g') -&gt; (\\(a,g'') -&gt; (a:acc, g'')) (randomR rng g')) ([],g) [0..n]\n\n\n-- which is basically the same as\ngenRandomSeq 0 rng g collected = (collected, g)\ngenRandomSeq n rng g collected =\n  let (a,g') = randomR rng g in\n  genRandomSeq (n - 1) rng g' (a : collected)\n\n\n(xs,g)  = genRandomSeq 5 ('a','z') (mkStdGen 10)\n(ys,g') = genRandomSeq 5 ('a','z') g\n\nzs = \"my nice string: \" ++ xs ++ ys :: String\n</code></pre>\n\n<p>in use</p>\n\n<pre><code>*Main&gt; genRandomSeq 5 ('a','z') (mkStdGen 10)\n(\"rrsvfx\",1928412403 1780294415)\n*Main&gt; zs\n\"my nice string: rrsvfxyaygon\"\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 3, "creation_date": 1455125981, "post_id": 35320323, "comment_id": 58353062, "body": "First thing you need to do is figure out how each new fold changes what was there before. Can you see any patterns? Can you write down an informal description of those patterns?"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1455127548, "post_id": 35320323, "comment_id": 58354048, "body": "I suggest working through this by hand...with an actual piece of paper. This will help you to find the patterns. For example, how does <code>fold 2</code> result in <code>&quot;mvv&quot;</code>?"}, {"owner": {"reputation": 4459, "user_id": 471614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea9a366a11e2e425394cf168c21034d8?s=128&d=identicon&r=PG", "display_name": "bdecaf", "link": "https://stackoverflow.com/users/471614/bdecaf"}, "edited": false, "score": 2, "creation_date": 1455177278, "post_id": 35320323, "comment_id": 58374820, "body": "This is known as dragon curve. <a href=\"https://en.m.wikipedia.org/wiki/Dragon_curve\" rel=\"nofollow noreferrer\">wikipedia</a> has a quite complte treatment including the algorithm. It&#39;s also in oeis as <a href=\"https://oeis.org/A014577\" rel=\"nofollow noreferrer\">oeis.org/A014577</a> including codes in various languages that can easily be translated."}], "answers": [{"tags": [], "owner": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "is_accepted": false, "score": 1, "last_activity_date": 1455175904, "last_edit_date": 1455175904, "creation_date": 1455126294, "answer_id": 35322304, "question_id": 35320323, "link": "https://stackoverflow.com/questions/35320323/haskell-paperfolding/35322304#35322304", "title": "Haskell Paperfolding", "body": "<p>Given an existing sequence of folds, adding a fold needs to intersperse an alternating sequence of characters <code>'m'</code> and <code>'v'</code>, starting before the first, and ending after the last.</p>\n\n<p>As it happens, Haskell has a function called <code>intersperse</code>, but it inserts the <em>same</em> element between values, not including the beginning or end; you will have to roll your own.</p>\n\n<p>In the functional style, you can do this with mutually recursive functions:</p>\n\n<pre><code>add_fold_m (first : rest) = 'm' : first : add_fold_v rest\nadd_fold_m [] = \"m\"\n-- note that \"m\" is a string of one char, while 'm' is that char itself\n\nadd_fold_v (first : rest) = 'v' : first : add_fold_m rest\nadd_fold_v [] = \"v\"\n</code></pre>\n\n<p>Then, you can start with a <code>\"v\"</code>, and apply <code>add_fold_m</code> as many times as you have folds.  You can use the Haskell prelude function <code>iterate</code> here:</p>\n\n<pre><code>fold n = iterate add_fold_m \"v\" !! n\n</code></pre>\n\n<p>The function <code>iterate</code> actually generates a list, of the results of applying a function (its first argument) multiple times to a value (its second argument):</p>\n\n<pre><code>iterate f x\n--&gt; [x, f x, f (f x), f (f (f x)), ...]\n</code></pre>\n\n<p>Note that the result is an infinite list.  Haskell is lazy by default, so this is fine unless you try to demand the whole list -- <code>iterate</code> will only generate list items on demand.</p>\n\n<p>The <code>!!</code> operator is the list-indexing operator:  <code>(list !! n)</code> returns the <code>n</code>th element of <code>list</code>.</p>\n"}], "owner": {"reputation": 51, "user_id": 5909310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845ad750860534f6b68f67619d31b501?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/5909310/alec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1455175904, "creation_date": 1455120876, "last_edit_date": 1455175835, "question_id": 35320323, "link": "https://stackoverflow.com/questions/35320323/haskell-paperfolding", "title": "Haskell Paperfolding", "body": "<p>I am trying to write a function, <code>fold n</code>, where <code>n</code> is the number of times a piece of paper is folded in the same direction. The function should output a string of <code>\"m\"</code>'s (mountain) and <code>\"v\"</code>'s (valley) representing the folds in the paper. For example, <code>fold 1</code> would output <code>\"v\"</code>, <code>fold 2</code> would output <code>\"mvv\"</code>, and so on. I'm pretty new to Haskell and was looking for any suggestions as to how to approach this.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 3, "creation_date": 1455125946, "post_id": 35320729, "comment_id": 58353034, "body": "&quot;handling both kinds of kinds&quot; :)"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 4, "creation_date": 1455133473, "post_id": 35320729, "comment_id": 58357817, "body": "Huh. I think I&#39;d prefer an ugly hack that kept this stuff hidden."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 3, "creation_date": 1455155733, "post_id": 35320729, "comment_id": 58367205, "body": "Why is it not <code>($) :: forall (w1 w2 :: Levity) (a :: TYPE w1) (b :: TYPE w2). (a -&gt; b) -&gt; a -&gt; b</code>, i.e. why is <code>($)</code> not supposed to be usable with functions with unlifted arguments?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 3, "creation_date": 1455165665, "post_id": 35320729, "comment_id": 58369897, "body": "@Cactus that&#39;s discussed in the &quot;bug&quot;, see this comment by SPJ: <a href=\"https://ghc.haskell.org/trac/ghc/ticket/8739#comment:6\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/ticket/8739#comment:6</a>"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1455172110, "post_id": 35320729, "comment_id": 58372296, "body": "The documentation for the upcoming GHC 8.0 release is quite behind. I think the main reason for this is that so many new features are planned for 8.0 and obviously documentation takes a backseat to actually implementing things. This is a fantastic explanation that certainly elucidated the topic for me so you should consider contributing it to the official docs!"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1455229238, "post_id": 35320729, "comment_id": 58409717, "body": "@jberryman: <a href=\"https://ghc.haskell.org/trac/ghc/ticket/11549\" rel=\"nofollow noreferrer\">#11549</a> will hide the <code>RuntimeRep</code> (replaces <code>Levity</code>)."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 81, "last_activity_date": 1480356092, "last_edit_date": 1480356092, "creation_date": 1455121904, "answer_id": 35320729, "question_id": 35318562, "link": "https://stackoverflow.com/questions/35318562/what-is-levity-polymorphism/35320729#35320729", "title": "What is Levity polymorphism", "body": "<p><strong>Note:</strong> This answer is based on very recent observations on Levity discussions. Everything concerning Levity polymorphism is currently only implemented in the GHC 8.0 release candidates and as such subject to change (see <a href=\"https://ghc.haskell.org/trac/ghc/ticket/11471\" rel=\"noreferrer\">#11471</a> for example).</p>\n\n<hr>\n\n<p><strong>TL;DR</strong>: It's a way to make functions polymorphic over lifted and unlifted types, which is not possible with regular functions. For example the following code doesn't type check with regular poly&shy;mor&shy;phi&shy;sms, since <code>Int#</code> has kind <code>#</code>, but the type variables in <code>id</code> have kind <code>*</code>:</p>\n\n<pre><code>{-# LANGUAGE MagicHash #-}\n\nimport GHC.Prim\n\nexample :: Int# -&gt; Int# \nexample = id            -- does not work, since id :: a -&gt; a\n</code></pre>\n\n\n\n<pre><code>Couldn't match kind \u2018*\u2019 with \u2018#\u2019\nWhen matching types\n  a0 :: *\n  Int# :: #\nExpected type: Int# -&gt; Int#\n  Actual type: a0 -&gt; a0\nIn the expression: id\n</code></pre>\n\n<p>Note that <code>(-&gt;)</code> still uses some magic.</p>\n\n<hr>\n\n<p>Before I start to answer this question, let us take a step back and go to one of the most often used functions, <code>($)</code>.</p>\n\n<p>What is <code>($)</code>'s type? Well, according to Hackage and the report, it's</p>\n\n<pre><code>($) :: (a -&gt; b) -&gt; a -&gt; b\n</code></pre>\n\n<p>However, that's not 100% complete. It's a convenient little lie. The problem is that polymorphic types (like <code>a</code> and <code>b</code>) have kind <code>*</code>. However, (library) developers wanted to use <code>($)</code> not only for types with kind <code>*</code>, but also for those of kind <code>#</code>, e.g.</p>\n\n<pre><code>unwrapInt :: Int -&gt; Int#\n</code></pre>\n\n<p>While <code>Int</code> has kind <code>*</code> (it can be bottom), <code>Int#</code> has kind <code>#</code> (and cannot be bottom at all). Still, the following code typechecks:</p>\n\n<pre><code>unwrapInt $ 42\n</code></pre>\n\n<p>That shouldn't work. Remember the return type of <code>($)</code>? It was polymorphic, and polymorphic types have kind <code>*</code>, not <code>#</code>! So why did it work? First, it was <a href=\"https://ghc.haskell.org/trac/ghc/ticket/8739\" rel=\"noreferrer\">a bug</a>, and then it was a <a href=\"https://github.com/ghc/ghc/commit/5dd1cbbfc0a19e92d7eeff6f328abc7558992fd6\" rel=\"noreferrer\">hack</a> (excerpt of <a href=\"https://mail.haskell.org/pipermail/ghc-devs/2016-February/011269.html\" rel=\"noreferrer\">a mail by Ryan Scott</a> on the ghc-dev mailing list):</p>\n\n<blockquote>\n  <p>So why is this happening?</p>\n  \n  <p>The long answer is that prior to GHC 8.0, in the type signature <code>($) :: (a -&gt; b) -&gt; a -&gt; b</code>, <code>b</code> actually wasn't in kind <code>*</code>, but rather <code>OpenKind</code>.\n  <code>OpenKind</code> is an awful hack that allows both lifted (kind <code>*</code>) and\n  unlifted (kind <code>#</code>) types to inhabit it, which is why <code>(unwrapInt $ 42)</code>\n  typechecks.</p>\n</blockquote>\n\n<p>So what is <code>($)</code>'s new type in GHC 8.0? It's</p>\n\n<pre><code>($) :: forall (w :: Levity) a (b :: TYPE w). (a -&gt; b) -&gt; a -&gt; b\n-- will likely change according to Richard E.\n</code></pre>\n\n<p>To understand it, we must look at <code>Levity</code>:</p>\n\n<pre><code>data Levity = Lifted | Unlifted\n</code></pre>\n\n<p>Now, we can think of <code>($)</code> as having either one of the following types, since there are only two choices of <code>w</code>:</p>\n\n<pre><code>-- pseudo types\n($) :: forall a (b :: TYPE   Lifted). (a -&gt; b) -&gt; a -&gt; b\n($) :: forall a (b :: TYPE Unlifted). (a -&gt; b) -&gt; a -&gt; b\n</code></pre>\n\n<p><code>TYPE</code> is a magical constant, and it redefines the kinds <code>*</code> and <code>#</code> as</p>\n\n<pre><code>type * = TYPE Lifted\ntype # = TYPE Unlifted\n</code></pre>\n\n<p>The quantification over kinds <a href=\"https://ghc.haskell.org/trac/ghc/wiki/DependentHaskell\" rel=\"noreferrer\">is also fairly new</a> and part of the <a href=\"https://ghc.haskell.org/trac/ghc/wiki/DependentHaskell/Phase1\" rel=\"noreferrer\">integration of dependent types in Haskell</a>.</p>\n\n<p>The name <em>Levity polymorphism</em> comes from the fact that you now can write polymorphic functions over both lifted and unlifted types, something that wasn't allowed/possible with the previous poly&shy;mor&shy;phism restrictions. It also gets rid of the <code>OpenKind</code> hack at the same time. It's really \"just\" about this, handling both kinds of kinds.</p>\n\n<p><sub>By the way, you're not alone with your question. Even <a href=\"https://ghc.haskell.org/trac/ghc/ticket/11471#comment:7\" rel=\"noreferrer\">Simon Peyton Jones said that there's a need for a Levity wiki page</a>, and Richard E. (the current implementer of this) <a href=\"https://ghc.haskell.org/trac/ghc/ticket/11471#comment:8\" rel=\"noreferrer\">stated that the wiki page needs an update</a> on the current process.</sub></p>\n\n<h3>References</h3>\n\n<ul>\n<li><a href=\"https://www.youtube.com/watch?v=bDdkeKr9vVw\" rel=\"noreferrer\">Levity Polymorphism In Dependent Haskell</a>; talk by Richard A. Eisenberg on ICFP 2015. Very recommended.</li>\n<li><a href=\"https://www.microsoft.com/en-us/research/wp-content/uploads/2016/11/levity-1.pdf\" rel=\"noreferrer\">Levity Polymorphism (extended version)</a> by Richard A. Eisenberg and Simon Peyton Jones</li>\n<li><a href=\"https://github.com/ghc/ghc/blob/master/libraries/ghc-prim/GHC/Types.hs\" rel=\"noreferrer\"><code>GHC.Types</code></a>, part of the <code>ghc-prim</code> library that's shipped with GHC.</li>\n<li>Discussions:\n\n<ul>\n<li>The discussion on <a href=\"https://mail.haskell.org/pipermail/ghc-devs/2016-February/011268.html\" rel=\"noreferrer\">ghc-dev</a>.</li>\n<li>The discussion on <a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2016-February/122914.html\" rel=\"noreferrer\">haskell-cafe</a>.</li>\n</ul></li>\n</ul>\n"}], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5481, "favorite_count": 16, "accepted_answer_id": 35320729, "answer_count": 1, "score": 81, "last_activity_date": 1480356092, "creation_date": 1455116360, "last_edit_date": 1455361838, "question_id": 35318562, "link": "https://stackoverflow.com/questions/35318562/what-is-levity-polymorphism", "title": "What is Levity polymorphism", "body": "<p>As the title of the question indicates, I want to know what is Levity polymorphism and what is its motivation ? I know <a href=\"https://ghc.haskell.org/trac/ghc/wiki/NoSubKinds\">this page</a> has some details in it, but most of the explanations there go over the top of my head. :)</p>\n\n<p>While <a href=\"http://ezyang.tumblr.com/post/127984263867/richard-eisenberg-levity-polymorphism-hiw\">this page</a> is a little friendlier, I'm still not able to understand the motivation behind it.</p>\n"}, {"tags": ["sockets", "haskell", "websocket", "server", "haskell-snap-framework"], "answers": [{"tags": [], "owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "is_accepted": true, "score": 1, "last_activity_date": 1455117349, "last_edit_date": 1455117349, "creation_date": 1455116510, "answer_id": 35318613, "question_id": 35317043, "link": "https://stackoverflow.com/questions/35317043/limit-connections-to-server/35318613#35318613", "title": "Limit connections to server", "body": "<p>I see two different questions here:</p>\n\n<ol>\n<li><p>how to limit number of connections, so there is at most N clients at the same time;</p></li>\n<li><p>make sure old connection will not live forever after browser refresh;</p></li>\n</ol>\n\n<p>I think you mean #2. In that case you should check that the connection is alive. The best way to do that is to ping the client periodically, e.g. using <a href=\"http://hackage.haskell.org/package/websockets-0.9.6.1/docs/Network-WebSockets.html#v:forkPingThread\" rel=\"nofollow\">forkPingThread</a>.</p>\n\n<p>If you really need #1, then you should establish shared <code>MVar</code> with <code>ThreadId</code> of the current client in it. When new client connects, just <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Concurrent.html#v:killThread\" rel=\"nofollow\">kill</a> the old one.</p>\n"}], "owner": {"reputation": 2442, "user_id": 3666302, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e9aed854fcd666aba1316ef908ad5913?s=128&d=identicon&r=PG&f=1", "display_name": "TomTom", "link": "https://stackoverflow.com/users/3666302/tomtom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 1, "accepted_answer_id": 35318613, "answer_count": 1, "score": 0, "last_activity_date": 1455117349, "creation_date": 1455112238, "question_id": 35317043, "link": "https://stackoverflow.com/questions/35317043/limit-connections-to-server", "title": "Limit connections to server", "body": "<p>I'd like to limit the connections to the websocket server. Namely to 1. The new client kicks the old client out.</p>\n\n<p>This somewhat represents what I want to do. Taking what is in <code>messages</code> and sending it through the websocket. If another client connects or the browser refreshes (which should close the old connection, but doesn't for some reason) there are suddenly 2 connections and only every second message receives at the new client.</p>\n\n<p>I use the snap framework for this.</p>\n\n<pre><code>createServer = forkIO $ httpServe defaultConfig app\n\napp = route [(\"/\", runWebSocketsSnap handler)]\n\nhandler pending = do\n    connection &lt;- acceptRequest pending\n    loop connection\n\nloop connection = do\n    msg &lt;- takeMVar messages\n    sendTextData connection msg\n\n{-# NOINLINE messages #-}\nmessages = unsafePerformIO newEmptyMVar\n\nsendMessage = putMVar messages\n</code></pre>\n"}, {"tags": ["haskell", "lambda", "currying"], "comments": [{"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 1, "creation_date": 1455097651, "post_id": 35311494, "comment_id": 58332607, "body": "Yes, in Haskell <code>f x y = ...</code> is defined to mean <code>f = \\x -&gt; \\ y -&gt; ...</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1455168568, "post_id": 35311494, "comment_id": 58370824, "body": "Can you clarify what you&#39;re asking, exactly?"}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1455142462, "post_id": 35311746, "comment_id": 58362678, "body": "The equality holds just fine with the monomorphism restriction. You just have to give both functions type signatures."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1455167393, "post_id": 35311746, "comment_id": 58370448, "body": "@amalloy I probably should have mentioned this yes - but the OP did not and I just wanted to comment on the comment by augustss"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 5, "last_activity_date": 1455167441, "last_edit_date": 1455167441, "creation_date": 1455097839, "answer_id": 35311746, "question_id": 35311494, "link": "https://stackoverflow.com/questions/35311494/is-currying-implemented-using-lambdas-in-haskell/35311746#35311746", "title": "Is currying implemented using lambdas in haskell?", "body": "<p>Currying is:</p>\n\n<blockquote>\n  <p>In mathematics and computer science, currying is the technique of translating the evaluation of a function that takes multiple arguments (or a tuple of arguments) into evaluating a sequence of functions, each with a single argument. It was introduced by Gottlob Frege, developed by Moses Sch\u00f6nfinkel, and further developed by Haskell Curry.</p>\n</blockquote>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Currying\" rel=\"nofollow\">source Wikipedia</a></p>\n\n<p>now you could argue that in Haskell there is <strong>never</strong> more than one argument to a function (you can of course have <em>tuples</em> - see below) - so in a sense <strong>all</strong> functions in Haskell are already <em>curried</em> (or can only be defined in such a way).</p>\n\n<p>Of course there are <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:curry\" rel=\"nofollow\"><code>curry</code></a> and <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:uncurry\" rel=\"nofollow\"><code>uncurry</code></a> - but those <em>act on tuples</em>:</p>\n\n<pre><code>curry                   :: ((a, b) -&gt; c) -&gt; a -&gt; b -&gt; c\ncurry f x y             =  f (x, y)\n</code></pre>\n\n<p>and I could argue that a tuple is just <em>one argument</em> too ;)</p>\n\n<hr>\n\n<p>On a conceptual level you are of course right as augustss pointed out!</p>\n\n<p>But sadly there are some problems (<a href=\"https://wiki.haskell.org/Monomorphism_restriction\" rel=\"nofollow\">see Monomorphism Restriction</a> for example) where this equality does not hold (if you don't add a type signature):</p>\n\n<pre><code>add x y = x + y === add = \\x -&gt; \\y -&gt; x + y\n</code></pre>\n"}], "owner": {"reputation": 627, "user_id": 634615, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/5d0319056378070fa0eea3a731fb173c?s=128&d=identicon&r=PG", "display_name": "user634615", "link": "https://stackoverflow.com/users/634615/user634615"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1455167441, "creation_date": 1455097274, "last_edit_date": 1455105307, "question_id": 35311494, "link": "https://stackoverflow.com/questions/35311494/is-currying-implemented-using-lambdas-in-haskell", "title": "Is currying implemented using lambdas in haskell?", "body": "<p>Is following code right way to think about currying in Haskell. Following is an example of addition in haskell</p>\n\n<pre><code>f = \\x -&gt; \\y -&gt; x + y\n</code></pre>\n\n<p>In general is currying realized using lamdbas in functional programming?</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1455098102, "post_id": 35311122, "comment_id": 58332895, "body": "It&#39;s called &quot;equality constraint&quot;."}, {"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 1, "creation_date": 1455098271, "post_id": 35311122, "comment_id": 58333008, "body": "And the reason it is used here instead of simply <code>instance IsString (JSValue JSTypeString)</code> is probably related to this answer: <a href=\"http://stackoverflow.com/questions/11553705/haskell-equality-constraint-in-instance\" title=\"haskell equality constraint in instance\">stackoverflow.com/questions/11553705/&hellip;</a> - though I can&#39;t claim to really understand it."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1455098790, "post_id": 35311122, "comment_id": 58333364, "body": "The instance <code>IsString (JSValue JSTypeString)</code> will only ever be selected if the type is known to be precisely <code>JSValue JSTypeString</code>. If it is <code>JSValue x</code> for some type variable <code>x</code>, then this instance will not be selected. However, the <code>(JSTypeString ~ jstype) =&gt; IsString (JSValue jstype)</code> instance will be selected for <code>JSValue x</code> for any x, <i>after</i> which the compiler will throw an error if <code>x</code> is not <code>JSTypeString</code>."}, {"owner": {"reputation": 764, "user_id": 3529754, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a8311cc9fdf0e052da7367ae79775c1c?s=128&d=identicon&r=PG&f=1", "display_name": "bash0r", "link": "https://stackoverflow.com/users/3529754/bash0r"}, "reply_to_user": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1455101885, "post_id": 35311122, "comment_id": 58335456, "body": "@SebastianRedl Ah yes it&#39;s a duplicate. I just couldn&#39;t find anything on Google to get a grip of it&#39;s name. Thanks a lot!"}, {"owner": {"reputation": 764, "user_id": 3529754, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a8311cc9fdf0e052da7367ae79775c1c?s=128&d=identicon&r=PG&f=1", "display_name": "bash0r", "link": "https://stackoverflow.com/users/3529754/bash0r"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1455101889, "post_id": 35311122, "comment_id": 58335458, "body": "@user2407038 Thanks for explanation. I was looking for this feature for some time now and stumbled upon it by accident. Thanks for explanation. :)"}], "owner": {"reputation": 764, "user_id": 3529754, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a8311cc9fdf0e052da7367ae79775c1c?s=128&d=identicon&r=PG&f=1", "display_name": "bash0r", "link": "https://stackoverflow.com/users/3529754/bash0r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "closed_date": 1455101960, "answer_count": 0, "score": 0, "last_activity_date": 1455096187, "creation_date": 1455096187, "question_id": 35311122, "link": "https://stackoverflow.com/questions/35311122/haskell-instance-constraint-jstypestring-jstype", "closed_reason": "Duplicate", "title": "Haskell instance constraint (JSTypeString ~ jstype) =&gt;", "body": "<p>I was reading some blog post related to Yesod (<a href=\"http://www.yesodweb.com/blog/2012/04/client-side\" rel=\"nofollow\">http://www.yesodweb.com/blog/2012/04/client-side</a>) from 2012 when a wild instance declaration with constraint appeared I don't even know how to name.</p>\n\n<pre><code>instance (JSTypeString ~ jstype) =&gt; IsString (JSValue jstype) where\n</code></pre>\n\n<p>Can anybody tell me what exactly the tilde does in constraint place? I guessed it means something like <code>jstype</code> must be of type <code>JSTypeString</code> but I'm not sure. A name for this would be nice to know, too.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["haskell", "syntax", "higher-kinded-types"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1455094235, "post_id": 35310208, "comment_id": 58330351, "body": "You define <code>Writer</code> for the explicit purpose of having a <code>Monad</code> instance. There&#39;s no point of defining it with swapped arguments. And you cannot write such type-level functions if you want decidable type checking."}], "answers": [{"comments": [{"owner": {"reputation": 5386, "user_id": 288091, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3194291b923afe52e71f2338b0e90977?s=128&d=identicon&r=PG", "display_name": "Ilya Smagin", "link": "https://stackoverflow.com/users/288091/ilya-smagin"}, "edited": false, "score": 0, "creation_date": 1455096899, "post_id": 35310521, "comment_id": 58332090, "body": "So, thats&#39;s what lambda types in scala are for!.. Right?"}, {"owner": {"reputation": 3116, "user_id": 353187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfdc97f71e1b8c257ae1bbd52989785d?s=128&d=identicon&r=PG", "display_name": "xnyhps", "link": "https://stackoverflow.com/users/353187/xnyhps"}, "reply_to_user": {"reputation": 5386, "user_id": 288091, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3194291b923afe52e71f2338b0e90977?s=128&d=identicon&r=PG", "display_name": "Ilya Smagin", "link": "https://stackoverflow.com/users/288091/ilya-smagin"}, "edited": false, "score": 0, "creation_date": 1455097990, "post_id": 35310521, "comment_id": 58332827, "body": "Indeed, there&#39;s an example in the Related Work on how that works in Scala. The trade-off for Scala is that you almost always need to give type annotations when using type classes."}], "tags": [], "owner": {"reputation": 3116, "user_id": 353187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfdc97f71e1b8c257ae1bbd52989785d?s=128&d=identicon&r=PG", "display_name": "xnyhps", "link": "https://stackoverflow.com/users/353187/xnyhps"}, "is_accepted": true, "score": 9, "last_activity_date": 1455096703, "last_edit_date": 1455096703, "creation_date": 1455094314, "answer_id": 35310521, "question_id": 35310208, "link": "https://stackoverflow.com/questions/35310208/does-higher-order-polymorphism-require-strict-order-of-arguments/35310521#35310521", "title": "Does Higher order polymorphism require strict order of arguments?", "body": "<p>This is not possible in Haskell, what you'd need is a type-level lambda function, which does not exist.</p>\n\n<p>There are type synonyms which you can use to define reorderings of type variables:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type Writer'' a w = Writer' a w\n</code></pre>\n\n<p>but you can not give class instances for partially applied type synonyms (even with the <code>TypeSynonymInstances</code> extension).</p>\n\n<p>I wrote my MSc thesis about the subject of how type-level lambdas can be added to GHC: <a href=\"https://xnyhps.nl/~thijs/share/paper.pdf\" rel=\"noreferrer\">https://xnyhps.nl/~thijs/share/paper.pdf</a> to be used in type-class instances without sacrificing type inference.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1455136091, "post_id": 35324976, "comment_id": 58359324, "body": "What do you mean by &quot;parochial&quot; here?"}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1455139725, "post_id": 35324976, "comment_id": 58361362, "body": "Specific to Haskell and its community.   Some of the category theory notation does show a different convention\u2014people talk about things like &quot;the <i>\u2014 &#215; B</i> functor&quot; where the dash refers to a &quot;hole&quot; in an expression like <i>A &#215; B</i>.  Maybe somebody could come up with a language design where you could say <code>instance Monoid m =&gt; Monad (Writer&#39; _ m)</code> or <code>instance Monoid m =&gt; Monad (\\a -&gt; Writer&#39; a m)</code> or something. The main reason we don&#39;t have this in Haskell, I&#39;d contend, is because what we do have works fine!"}], "tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 5, "last_activity_date": 1455144062, "last_edit_date": 1455144062, "creation_date": 1455135193, "answer_id": 35324976, "question_id": 35310208, "link": "https://stackoverflow.com/questions/35310208/does-higher-order-polymorphism-require-strict-order-of-arguments/35324976#35324976", "title": "Does Higher order polymorphism require strict order of arguments?", "body": "<p>What you are seeing here is a parochial design choice of Haskell.  It makes perfect sense, conceptually speaking, to say that your <code>Writer'</code> type is a functor if you \"leave out\" its first parameter.  And a programming language syntax could be invented to allow such declarations.</p>\n\n<p>The Haskell community hasn't done so, because what they have is relatively simple and it works well enough.  This isn't to say that alternative designs aren't possible, but to be adopted such a design would have to:</p>\n\n<ol>\n<li>Be no more complex to use in practice than what we already have;</li>\n<li>Offer functionality or advantage that would be worth the switch.</li>\n</ol>\n\n<p>This generalizes to many other ways that the Haskell community uses types; often the choice to represent something as a type distinction is tied to some artifact of the language's design.  Many monad transformers are good examples, like <code>MaybeT</code>:</p>\n\n<pre><code>newtype MaybeT m a = MaybeT { runMaybeT :: m (Maybe a) }\n\ninstance Functor m =&gt; Functor (MaybeT m) where ...\ninstance Applicative m =&gt; Applicative (MaybeT m) where ...\ninstance Monad m =&gt; Monad (MaybeT m) where ...\ninstance MonadTrans MaybeT where ...\n</code></pre>\n\n<p>Since it's a <code>newtype</code>, this means that <code>MaybeT IO String</code> is <strong>isomorphic</strong> to <code>IO (Maybe String)</code>; you can think of the two types as being two \"perspectives\" on the same set of values:</p>\n\n<ol>\n<li><code>IO (Maybe String)</code> is an <code>IO</code> action that produces values of type <code>Maybe String</code>;</li>\n<li><code>MaybeT IO String</code> is a <code>MaybeT IO</code> action that produces values of type <code>String</code>.</li>\n</ol>\n\n<p>The difference between the perspectives is that they imply different implementations of the <code>Monad</code> operations.  In Haskell then this is also tied to the following parochial technical facts:</p>\n\n<ul>\n<li>In one <code>String</code> is the last type parameter (the \"values\") and in the other <code>Maybe String</code> is;</li>\n<li><code>IO</code> and <code>MaybeT IO</code> have different instances for the <code>Monad</code> class.</li>\n</ul>\n\n<p>But maybe there is a language design where you could say that the type <code>IO (Maybe a)</code> can have a monad specific to it, and distinct from the monad for the more general <code>IO a</code> type.  That language would incur <em>some</em> complexity to make that distinction consistently (e.g., rules to determine which <code>Monad</code> instance to by default for <code>IO (Maybe String)</code> and rules to allow the programmer to override the default choice).  And I'd wager modestly that the end result would be no less complex than what we do have.  <strong>TL;DR:</strong> Meh.</p>\n"}], "owner": {"reputation": 5386, "user_id": 288091, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3194291b923afe52e71f2338b0e90977?s=128&d=identicon&r=PG", "display_name": "Ilya Smagin", "link": "https://stackoverflow.com/users/288091/ilya-smagin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 3, "accepted_answer_id": 35310521, "answer_count": 2, "score": 7, "last_activity_date": 1455144062, "creation_date": 1455093352, "question_id": 35310208, "link": "https://stackoverflow.com/questions/35310208/does-higher-order-polymorphism-require-strict-order-of-arguments", "title": "Does Higher order polymorphism require strict order of arguments?", "body": "<p>Reading <a href=\"http://learnyouahaskell.com/for-a-few-monads-more#writer\">LYAH</a>, I stumbled upon this piece of code:</p>\n\n<pre><code>newtype Writer w a = Writer { runWriter :: (a, w) }\n\ninstance (Monoid w) =&gt; Monad (Writer w) where  \n  return x = Writer (x, mempty)  \n  (Writer (x,v)) &gt;&gt;= f = let (Writer (y, v')) = f x in Writer (y, v `mappend` v')  \n</code></pre>\n\n<p>While trying to understand what the heck is <code>Writer w</code> in the first line, I discovered this not being a full type, but a sort of type constructor with 1 argument, like <code>Maybe</code> for <code>Maybe String</code></p>\n\n<p>Looks great, but what if the initial type if <code>Writer'</code> is defined with swapped type arguments, like this:</p>\n\n<pre><code>newtype Writer' a w = Writer' { runWriter :: (a, w) } \n</code></pre>\n\n<p><strong>Is it possible to implement Monad instance now?</strong> Something like this, but what could actually be compiled:</p>\n\n<pre><code>instance (Monoid w) =&gt; Monad (\\* -&gt; Writer' * monoid) where\n</code></pre>\n\n<p>The idea of <code>\\* -&gt; Writer' * monoid</code> is the same as <code>Writer w</code> :\nA type constructor with one type argument missing -- this time first one.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 4805466, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07b55e090f6da07d81e357292ca1c6d0?s=128&d=identicon&r=PG&f=1", "display_name": "N....F", "link": "https://stackoverflow.com/users/4805466/n-f"}, "edited": false, "score": 0, "creation_date": 1455121686, "post_id": 35310457, "comment_id": 58350013, "body": "ok i see what you are saying, but then how do you check if list is empty, or it contains only one point?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1455142533, "post_id": 35310457, "comment_id": 58362702, "body": "There is no list at all! You&#39;ve defined your function so that it can only ever receive exactly two pairs of numbers."}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 5, "last_activity_date": 1455094130, "creation_date": 1455094130, "answer_id": 35310457, "question_id": 35310190, "link": "https://stackoverflow.com/questions/35310190/error-equations-for-det-have-different-numbers-of-arguments/35310457#35310457", "title": "error: Equations for \u2018det\u2019 have different numbers of arguments", "body": "<p>First of all, the type <code>(Double, Double)</code> is always a pair of two <code>Double</code>s, never an empty or a singleton list. Second, like the error message says, your cases for <code>det</code> need to have the same number of arguments, but one are given for the first three, and two for the fourth.</p>\n\n<p>Fixing all these, you get</p>\n\n<pre><code>det :: (Double, Double) -&gt; (Double, Double) -&gt; Double \ndet (x1, y1) (x2, y2) = (x1 * y2 + x2 * y1)\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 4805466, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07b55e090f6da07d81e357292ca1c6d0?s=128&d=identicon&r=PG&f=1", "display_name": "N....F", "link": "https://stackoverflow.com/users/4805466/n-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 1, "accepted_answer_id": 35310457, "answer_count": 1, "score": 1, "last_activity_date": 1455094130, "creation_date": 1455093303, "last_edit_date": 1455094001, "question_id": 35310190, "link": "https://stackoverflow.com/questions/35310190/error-equations-for-det-have-different-numbers-of-arguments", "title": "error: Equations for \u2018det\u2019 have different numbers of arguments", "body": "<p>I'm trying to calculate the determinant and I have the <code>det</code> function defined as below:</p>\n\n<pre><code>det :: (Double,Double) -&gt; (Double,Double) -&gt; Double\ndet _ = 0.0\ndet [] = error \"its Empty!\"\ndet [x] = error \"contains only one point!\"\ndet (x1, y1) (x2, y2) = (x1*y2 + x2*y1)\n</code></pre>\n\n<p>i get the following error</p>\n\n<pre><code>Equations for \u2018det\u2019 have different numbers of arguments\n      PolygonArea.hs:11:1-11\n      PolygonArea.hs:14:1-39\nFailed, modules loaded: none.\n</code></pre>\n"}, {"tags": ["eclipse", "haskell", "eclipse-fp"], "comments": [{"owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "edited": false, "score": 0, "creation_date": 1455118438, "post_id": 35309218, "comment_id": 58347449, "body": "Repost here: <a href=\"https://sourceforge.net/p/eclipsefp/discussion/371922/thread/d0945a3c/\" rel=\"nofollow noreferrer\">sourceforge.net/p/eclipsefp/discussion/371922/thread/d0945a3&zwnj;&#8203;c</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 0, "creation_date": 1455177602, "post_id": 35319792, "comment_id": 58375015, "body": "see <a href=\"https://www.haskell.org/haddock/doc/html/markup.html\" rel=\"nofollow noreferrer\">haskell.org/haddock/doc/html/markup.html</a> the pipe character should only be on the first comment line, not repeated."}], "tags": [], "owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "is_accepted": false, "score": 1, "last_activity_date": 1455119563, "creation_date": 1455119563, "answer_id": 35319792, "question_id": 35309218, "link": "https://stackoverflow.com/questions/35309218/eclipse-fp-cannot-get-documentation-to-appear/35319792#35319792", "title": "Eclipse FP Cannot Get Documentation to Appear", "body": "<p>I got it working! </p>\n\n<p><a href=\"https://i.stack.imgur.com/lTzUy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lTzUy.png\" alt=\"enter image description here\"></a></p>\n\n<p>After cabal installing every Helper executable (except for Web dev and SourceGraph) under \"Window > Preferences > Haskell > Helper executables\", I could get documentation on my own methods if they were written like this...</p>\n\n<pre><code>--\n-- | Documentation appears in Haskell!!!\n--\nfunction signature\nfunction\n</code></pre>\n\n<p>Note that if you try to write documentation like this, it doesn't render properly...</p>\n\n<pre><code>--\n-- | Documentation\n-- | a is the Int being returned\nreturnInt :: Int -&gt; Int\nreturnInt(a) = a\n</code></pre>\n\n<p>^ Instead, it just prints \"a is the Int being returned\"</p>\n"}], "owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1455119563, "creation_date": 1455089395, "last_edit_date": 1455090582, "question_id": 35309218, "link": "https://stackoverflow.com/questions/35309218/eclipse-fp-cannot-get-documentation-to-appear", "title": "Eclipse FP Cannot Get Documentation to Appear", "body": "<p>In the website <a href=\"http://eclipsefp.github.io/features.html\" rel=\"nofollow noreferrer\">here</a>, it shows pictures of EclipseFP plugin with pop-up documentation.</p>\n\n<p><a href=\"https://i.stack.imgur.com/FtEHw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FtEHw.png\" alt=\"No documentation\"></a></p>\n\n<p>^ All I get is the type signature - \"putChar :: Char -> IO()\". </p>\n\n<p>I have all the <a href=\"http://eclipsefp.github.io/install.html\" rel=\"nofollow noreferrer\">helper executables</a> other than the ones for web frameworks and SourceGraph and UUAGC. Sourcegraph not installing is <a href=\"https://github.com/ivan-m/SourceGraph/issues/3\" rel=\"nofollow noreferrer\">something else</a>.</p>\n\n<p>Anyway, I'm not getting pop up documentation for any of the standard library functions or my own user-defined functions. Also, I installed Hoogle...</p>\n\n<p><a href=\"https://i.stack.imgur.com/GHjOo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GHjOo.png\" alt=\"Hoogle\"></a></p>\n\n<p>and after installation I re-opened EclipseFP and it made no difference - no documentation for any function.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1455070090, "post_id": 35304910, "comment_id": 58321590, "body": "For an explanation of why <code>length</code> does what it does for pairs, see <a href=\"https://m.youtube.com/watch?v=87re_yIQMDw\" rel=\"nofollow noreferrer\">The Not-a-Wat in Haskell</a>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1455230171, "post_id": 35304910, "comment_id": 58410183, "body": "<a href=\"https://www.destroyallsoftware.com/talks/wat\" rel=\"nofollow noreferrer\">destroyallsoftware.com/talks/wat</a>  :)"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 3629095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1731018398/picture?type=large", "display_name": "Callum McKinnon-Snell", "link": "https://stackoverflow.com/users/3629095/callum-mckinnon-snell"}, "edited": false, "score": 0, "creation_date": 1455222475, "post_id": 35305229, "comment_id": 58405953, "body": "I&#39;ve tried this and it doesn&#39;t work for me :(. Couldn&#39;t match expected type [Char] with actual type Char"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 55, "user_id": 3629095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1731018398/picture?type=large", "display_name": "Callum McKinnon-Snell", "link": "https://stackoverflow.com/users/3629095/callum-mckinnon-snell"}, "edited": false, "score": 0, "creation_date": 1455228866, "post_id": 35305229, "comment_id": 58409533, "body": "@CallumMcKinnon-Snell I didn&#39;t test it originally since I lacked an implementation of your <code>formatPence</code> function. When I looked at it more closely just now  I noticed that there was a problem with your <code>rep</code> function."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 3, "last_activity_date": 1455229268, "last_edit_date": 1455229268, "creation_date": 1455066899, "answer_id": 35305229, "question_id": 35304910, "link": "https://stackoverflow.com/questions/35304910/force-string-to-given-length-in-haskell/35305229#35305229", "title": "Force String to given length in Haskell", "body": "<p>I think that your intention with <code>length(a,b)</code> is to sum the length of <code>a</code> and the string representation of <code>b</code>. <code>length</code> doesn't work like that. Instead you should do something like</p>\n\n<pre><code>formatLine (a, b) = a ++ (rep (30 - length a - length (formatPence b)) '.') ++ formatPence b  ++ \"\\n\"\n</code></pre>\n\n<p>Also -- your definition of <code>rep</code> is off. It should be</p>\n\n<pre><code>rep n x = [x | r &lt;- [1..n]] \n</code></pre>\n\n<p>if your intention is to take an Integer and a Char and get a string of length n consisting of the character x repeated n times. Since in Haskell a string <em>is</em> a list of chars you don't need anything like <code>concat</code> -- a simple list comprehension will do. Furthermore, your <code>rep</code> itself seems a bit pointless in view of the Standard Prelude function <code>replicate</code>.</p>\n"}], "owner": {"reputation": 55, "user_id": 3629095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1731018398/picture?type=large", "display_name": "Callum McKinnon-Snell", "link": "https://stackoverflow.com/users/3629095/callum-mckinnon-snell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 1, "accepted_answer_id": 35305229, "answer_count": 1, "score": 1, "last_activity_date": 1455229268, "creation_date": 1455064703, "question_id": 35304910, "link": "https://stackoverflow.com/questions/35304910/force-string-to-given-length-in-haskell", "title": "Force String to given length in Haskell", "body": "<p>so I want this function:</p>\n\n<pre><code>&gt;formatLine :: (String, Int) -&gt; String\n&gt;formatLine (a, b) = a ++ (rep (30 - length(a, b)) '.') ++ formatPence(b) ++ \"\\n\"\n</code></pre>\n\n<p>and the rep function is as follows:</p>\n\n<pre><code>&gt;rep :: Int -&gt; Char -&gt; String\n&gt;rep x n = concat[\".\" | r &lt;- [0..x]]\n</code></pre>\n\n<p>the idea being it would put the right number of dots to make the time of length 30. </p>\n\n<p>And it's always making a line 50 long, no matter if I change 30.</p>\n\n<p>I'm a real Haskell newbie, forgive me for the simple question, this has been annoying me for hours!</p>\n"}, {"tags": ["haskell", "command-line", "binding", "ghc"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 5905842, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72a475cb0ae5799b68eaf7006bf00c1b?s=128&d=identicon&r=PG&f=1", "display_name": "something", "link": "https://stackoverflow.com/users/5905842/something"}, "edited": false, "score": 0, "creation_date": 1455066855, "post_id": 35304937, "comment_id": 58320760, "body": "This was really helpful and I thank you alot. It is hard starting out and people like me really appreciate back to basics stuff like this, I did try and research the answer but docs are hard to follow when you don&#39;t really understand anything at all."}], "tags": [], "owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "is_accepted": true, "score": 5, "last_activity_date": 1455064890, "creation_date": 1455064890, "answer_id": 35304937, "question_id": 35304656, "link": "https://stackoverflow.com/questions/35304656/ghci-haskell-not-remembering-bindings-in-command-line/35304937#35304937", "title": "GHCI Haskell not remembering bindings in command line", "body": "<p>What did you expect your example to do?  From what you've presented, I don't see anything surprising.</p>\n\n<hr>\n\n<p>Of course, that answer is probably surprising to you, or you wouldn't have asked.  And I'll be honest: I <em>can</em> guess what you were expecting.  If I'm right, you thought the output would be:</p>\n\n<pre><code>&gt; let b = []\n&gt; b\n[]\n&gt; 1:b\n[1]\n&gt; b\n[1]\n</code></pre>\n\n<p>Am I right?  Supposing I am, then the question is: why isn't it?</p>\n\n<p>Well, the short version is \"that's not what <code>(:)</code> does\".  Instead, <code>(:)</code> creates a new list out of its arguments; <code>x:xs</code> is a new list whose first element is <code>x</code> and the rest of which is identical to <code>xs</code>.  But it creates a <em>new</em> list.  It's just like how <code>+</code> creates a new number that's the sum of its arguments: is the behavior</p>\n\n<pre><code>&gt; let b = 0\n&gt; b\n0\n&gt; 1+b\n1\n&gt; b\n0\n</code></pre>\n\n<p>surprising, too?  (Hopefully not!)</p>\n\n<hr>\n\n<p>Of course, this opens up the next question of \"well, how do I update <code>b</code>, then?\".  And this is where Haskell shows its true colors: <em>you don't</em>.  In Haskell, once a variable is bound to a value, that value will never change; it's as though all variables and all data types are <code>const</code> (in C-like languages or the latest Javascript standard) or <code>val</code> (in Scala).</p>\n\n<p><em>This</em> feature of Haskell \u2013 it's called being <em>purely functional</em> \u2013 is possibly the single biggest difference between Haskell and every single mainstream language out there.  You have to think about writing programs in a very different way when you aren't working with mutable state everywhere.</p>\n\n<p>For example, to go a bit further afield, it's quite possible the next thing you'll try will be something like this:</p>\n\n<pre><code>&gt; let b = []\n&gt; b\n[]\n&gt; let b = 1 : b\n</code></pre>\n\n<p>In that case, what do you think is going to be printed out when you type <code>b</code>?</p>\n\n<p>Well, remember, variables don't change!  So the answer is:</p>\n\n<pre><code>[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,\u2026\n</code></pre>\n\n<p>forever \u2013 or until you hit control-C and abort.</p>\n\n<p>This is because <code>let b = 1 : b</code> defines a <em>new</em> variable named <code>b</code>; you might as well have written <code>let c = 1 : c</code>.  Thus, you're saying \"<code>b</code> is a list which is <code>1</code> followed by <code>b</code>\"; since we know what <code>b</code> is, we can substitute and get \"<code>b</code> is a list which is <code>1</code> followed by <code>1</code> followed by <code>b</code>\", and so on forever.  Or: <code>b = 1 : b</code>, so substituting in for <code>b</code> we get <code>b = 1 : 1 : b</code>, and substituting in we get <code>b = 1 : 1 : 1 : 1 : \u2026</code>.</p>\n\n<p>(The fact that Haskell produces an infinite list, rather than going into an infinite loop, is because Haskell is <em>non-strict</em>, more popularly referred to as <em>lazy</em> \u2013 this is <em>also</em> possibly the single biggest difference between Haskell and every single mainstream language out there.  For further information, search for \"lazy evaluation\" on Google or Stack Overflow.)</p>\n\n<hr>\n\n<p>So, in the end, I hope you can see why I wasn't surprised: Haskell can't possibly update variable bindings.  So since your definition was <code>let b = []</code>, then of course the final result was still <code>[]</code> :-)</p>\n"}], "owner": {"reputation": 103, "user_id": 5905842, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72a475cb0ae5799b68eaf7006bf00c1b?s=128&d=identicon&r=PG&f=1", "display_name": "something", "link": "https://stackoverflow.com/users/5905842/something"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 35304937, "answer_count": 1, "score": -2, "last_activity_date": 1455064890, "creation_date": 1455063122, "question_id": 35304656, "link": "https://stackoverflow.com/questions/35304656/ghci-haskell-not-remembering-bindings-in-command-line", "title": "GHCI Haskell not remembering bindings in command line", "body": "<p>I am trying to learn Haskell but it is a little hard as non of my bindings are remembered from the command line; output from my terminal below.</p>\n\n<pre><code>&gt; let b = []\n&gt; b\n[]\n&gt; 1:b\n[1]\n&gt; b\n[]\n</code></pre>\n\n<p>I have no idea why this is like this can anyone please help.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1455085536, "post_id": 35304585, "comment_id": 58326138, "body": "Exactly what do you want the result to look like when there are multiple start/stop pairs? What do you want to happen when pairs are mismatched? There are several reasonable answers to each of these questions."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1455099659, "post_id": 35304585, "comment_id": 58333939, "body": "<code>dropWhile, takeWhile</code> can be useful here. Drop everything until you find the start, and then take everything until you find the end."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1455145197, "post_id": 35304585, "comment_id": 58363862, "body": "Your update does not address either of my questions. What should I get from <code>[&quot;x&quot;,&quot;start&quot;,&quot;y&quot;,&quot;stop&quot;,&quot;z&quot;,&quot;start&quot;,&quot;w&quot;,&quot;stop&quot;]</code>? What should I get from <code>[&quot;stop&quot;,&quot;x&quot;,&quot;start&quot;,&quot;y&quot;,&quot;stop&quot;]</code> and from <code>[&quot;start&quot;,&quot;x&quot;,&quot;start&quot;,&quot;y&quot;,&quot;stop&quot;,&quot;stop&quot;]</code> and from <code>[&quot;start&quot;,&quot;x&quot;,&quot;start&quot;,&quot;y&quot;,&quot;stop&quot;]</code>?"}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1455146317, "post_id": 35304585, "comment_id": 58364329, "body": "@dfeuer I&#39;ve updated my question. Please have a look."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1455147330, "post_id": 35304585, "comment_id": 58364725, "body": "So you&#39;re saying the result for your original <code>listA</code> example should actually be <code>[&quot;stuff&quot;]</code>, rather than <code>[&quot;start&quot;, &quot;stuff&quot;, &quot;stop&quot;]</code> as you wrote in your question?"}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1455147630, "post_id": 35304585, "comment_id": 58364835, "body": "@dfeuer Sorry, the results should be wrapped by the tokens. I&#39;ve updated the question."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1455149381, "post_id": 35304585, "comment_id": 58365386, "body": "The approach I outlined in my answer should be pretty easy for you to complete without using <i>any</i> library functions whatsoever. Just pattern matching and data constructors. If you want to use library functions, your output format will likely make that a bit tricky. The ones I&#39;d suggest looking at are <code>break</code> and <code>span</code>, but I wouldn&#39;t personally bother; the explicit state machine will be easier."}], "answers": [{"comments": [{"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1455117458, "post_id": 35305944, "comment_id": 58346627, "body": "<code>I urge you to write the function without ever using a number.</code> This is the ideal scenario. I don&#39;t know how to do this without storing the current state of the parser as a flag. OOP has taken over my brain =/..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1455125821, "post_id": 35305944, "comment_id": 58352956, "body": "@dopatraman, the helper function I suggested is one of the functional approaches to &quot;storing the current state of the parser as a flag&quot;. In a more general situation, you&#39;d likely need a different technique to make the parser state available to the various parser pieces, but that&#39;s not necessary here."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1455144101, "post_id": 35305944, "comment_id": 58363412, "body": "i updated my answer... could use your help figuring this out."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1455206928, "post_id": 35305944, "comment_id": 58395752, "body": "Thank you very much for your update.  I manage to solve the problem, but have one final question. I&#39;ve added it to the original post. How do I include the helper function <code>takeBetweens&#39;</code> in a <code>where</code> clause? I&#39;d rather do that than use two separate functions."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1455147709, "last_edit_date": 1455147709, "creation_date": 1455072248, "answer_id": 35305944, "question_id": 35304585, "link": "https://stackoverflow.com/questions/35304585/filter-list-by-start-and-end-tokens/35305944#35305944", "title": "Filter list by start and end tokens", "body": "<p>Your mistake was in thinking about indices. Don't! Lists are not arrays, and pretending they are will lead to code that is both complicated and slow.</p>\n\n<p>I suggest you use a helper function:</p>\n\n<pre><code>data Status = NotBetween | Between\n\ntakeBetweens' :: Status -&gt; [String] -&gt; [String]\n</code></pre>\n\n<p>The idea is that <code>takeBetweens' NotBetween s</code> should look for a <code>\"start\"</code> dropping everything on the way, then call itself with <code>Between</code> while <code>takeBetweens Between s</code> should grab everything till it sees <code>\"stop\"</code> then call itself with <code>NotBetween</code>.</p>\n\n<p>I urge you to write the function without ever using a number.</p>\n\n<h3>A bigger hint</h3>\n\n<pre><code>takeBetweens :: [String] -&gt; [String]\ntakeBetweens = takeBetweens' NotBetween\n\ntakeBetweens' :: Status -&gt; [String] -&gt; [String]\ntakeBetweens' _ [] = ?\ntakeBetweens' NotBetween (\"start\" : xs) = ?\ntakeBetweens' NotBetween (x : xs) = ?\ntakeBetweens' Between (\"stop\" : xs) = ?\ntakeBetweens' Between (x : xs) = ?\n</code></pre>\n\n<p>Can you see how this is basically a state machine? Can you see when and how to change state?</p>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 2, "last_activity_date": 1455073271, "creation_date": 1455073271, "answer_id": 35306085, "question_id": 35304585, "link": "https://stackoverflow.com/questions/35304585/filter-list-by-start-and-end-tokens/35306085#35306085", "title": "Filter list by start and end tokens", "body": "<p>This may give you an idea...</p>\n\n<pre><code>Prelude&gt; let f x = reverse . dropWhile (/=x)                                                                          \nPrelude&gt; let between s e = f e . f s\nPrelude&gt; between 3 5 [1..10]\n[3,4,5]\n</code></pre>\n\n<p>obviously has no error handling, what should happen if there is no end specified?</p>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 2, "answer_count": 2, "score": 0, "last_activity_date": 1455206869, "creation_date": 1455062685, "last_edit_date": 1495540347, "question_id": 35304585, "link": "https://stackoverflow.com/questions/35304585/filter-list-by-start-and-end-tokens", "title": "Filter list by start and end tokens", "body": "<p>Say I have a list of strings:</p>\n\n<pre><code>let listA = [\"hello\", \"start\", \"stuff\", \"end\", \"boo\"]\n</code></pre>\n\n<p>I want to filter this list according to start and end tokens <code>\"start\"</code> and <code>\"end\"</code>. So my end result should be:</p>\n\n<pre><code>[\"start\", \"stuff\", \"end\"]\n</code></pre>\n\n<p>I need a function <code>filterByTokens</code> that will do this. This is what I have so far but I'm hitting a wall:</p>\n\n<pre><code>slice :: Int -&gt; Int -&gt; [a] -&gt; [a]\nslice _ _ [] = []\nslice from to list = take (to - from + 1) rest\n    where rest = drop from list\n\nfilterByTokens :: a -&gt; a -&gt; [a] -&gt; [a]\nfilterByTokens start end list = \n    sIndex = elemIndex start list\n    eIndex = elemIndex end list\n    slice sIndex eIndex list\n</code></pre>\n\n<p><code>filterRange</code> will work on a single block, but what if I have multiple? Also, <code>elemIndex</code> returns a <code>Maybe</code> type so how do I convert this to an <code>Int</code>? Please help.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I've updated my function to <code>take</code> recursively but I'm still hitting a wall:</p>\n\n<pre><code>takeBetween :: (Eq a) =&gt; a -&gt; a -&gt; [a] -&gt; [a]\ntakeBetween _ _ [] = []\ntakeBetween start end (x:xs)\n    | x == start    = takeIt True (x:xs)\n    | x == end      = takeIt False (x:xs)\n    | otherwise     = takeIt _ (x:xs)\n    where takeIt status\n        | status = x : takeBetween start end xs\n        | otherwise = takeBetween start end xs\n</code></pre>\n\n<p>But I can't pass in a <code>_</code> for the status boolean. Please help me figure out what I'm doing wrong.</p>\n\n<p><strong>NOTE</strong></p>\n\n<p>If there are multiple start stop pairs the resulting list should be made up of whatever is between each of them. For example:</p>\n\n<p><code>[\"x\",\"start\",\"y\",\"stop\",\"z\",\"start\",\"w\",\"stop\"]</code> should return <code>[\"start\", \"y\", \"stop\", \"start\", \"w\", \"stop\"]</code></p>\n\n<p>If a stop token is before a start token it is ignored.</p>\n\n<p><code>[\"stop\",\"x\",\"start\",\"y\",\"stop\"]</code> returns <code>[\"start\", \"y\", \"stop\"]</code></p>\n\n<p>Ideally only the first start and the first stop tokens will have value:</p>\n\n<p><code>[\"start\",\"x\",\"start\",\"y\",\"stop\",\"stop\"]</code> returns <code>[\"start\", \"x\", \"start\", \"y\", \"stop\"]</code></p>\n\n<p><code>[\"start\",\"x\",\"start\",\"y\",\"stop\"]</code> returns <code>[\"start\", \"x\", \"start\", \"y\", \"stop\"]</code></p>\n\n<p><strong>UPDATE 2</strong></p>\n\n<p>I've also tried a simpler approach using just a drop, to no avail:</p>\n\n<pre><code>takeByToken :: (Eq a) =&gt; a -&gt; a -&gt; [a] -&gt; [a]\ntakeByToken start end (x:xs) = dropWhile (\\x -&gt; not $ x == start) xs\n</code></pre>\n\n<p>Please help me figure this out.</p>\n\n<p><strong>Update 3</strong></p>\n\n<p>With much help from <a href=\"https://stackoverflow.com/users/1477667/dfeuer\">dfeuer</a> I came up with this solution:</p>\n\n<pre><code>data Status = Between | NotBetween\ntakeBetweens :: [String] -&gt; [String]\ntakeBetweens = takeBetweens' NotBetween\n\ntakeBetweens' :: Status -&gt; String -&gt; String -&gt; [String] -&gt; [String]\ntakeBetweens' _ _ _ [] = []\ntakeBetweens' NotBetween s e (x : xs)\n    | s == x = x : takeBetweens' Between s e xs\n    | otherwise = takeBetweens' NotBetween s e xs\ntakeBetweens' Between s e (x : xs)\n    | e == x = x : takeBetweens' NotBetween s e xs\n    | otherwise = x : takeBetweens' Between s e xs\n</code></pre>\n\n<p>However, this solution still requires me to use 2 functions. I've tried to include the helper <code>takeBetweens'</code> function in a <code>where</code> clause but am running into syntax errors (noob i know).</p>\n\n<pre><code>data Status = Between | NotBetween\n\ntakeBetweens :: [String] -&gt; [String]\ntakeBetweens = takeBetweens' NotBetween \"start\" \"end\"\n    where takeBetweens' _ _ _ [] = []\n    takeBetweens' NotBetween s e (x : xs)\n        | s == x = x : takeBetweens' Between s e xs\n        | otherwise = takeBetweens' NotBetween s e xs\n    takeBetweens' Between s e (x : xs)\n        | e == x = x : takeBetweens' NotBetween s e xs\n        | otherwise = x : takeBetweens' Between s e xs\n\n\n\ntest.hs:5:9: parse error on input \u2018takeBetweens'\u2019\n</code></pre>\n\n<p>How do I include the helper function in a <code>where</code> clause?</p>\n"}, {"tags": ["parsing", "haskell", "parser-combinators", "attoparsec"], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 3932019, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caa87dc02ccd35f92887caca786e866e?s=128&d=identicon&r=PG&f=1", "display_name": "DanielRS", "link": "https://stackoverflow.com/users/3932019/danielrs"}, "edited": false, "score": 0, "creation_date": 1455250040, "post_id": 35302838, "comment_id": 58416102, "body": "The code required makes you think if the trade of performance over simplicity is worth it"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 3, "last_activity_date": 1455054481, "creation_date": 1455054481, "answer_id": 35302838, "question_id": 35300812, "link": "https://stackoverflow.com/questions/35300812/fast-parsing-of-string-that-allows-escaped-characters/35302838#35302838", "title": "Fast parsing of string that allows escaped characters?", "body": "<p>It is possible writing some escaping code, <code>attoparsec</code> and <code>text</code> - altogether it is pretty straightforward - seeing you have already worked with parsers</p>\n\n<pre><code>import Data.Attoparsec.Text as AT\nimport qualified Data.Text as T\nimport Data.Text (Text)\n\nescaped, quoted, brackted :: Parser Text\nnormal =  AT.takeWhile (/= '\\\\')\nescaped = do r &lt;- normal\n             rs &lt;- many escaped'\n             return $ T.concat $ r:rs\n  where escaped' = do r1 &lt;- normal\n                      r2 &lt;- quoted &lt;|&gt; brackted\n                      return $ r1 &lt;&gt; r2\n\nquoted = do string \"\\\\\\\"\"\n            res &lt;- normal\n            string \"\\\\\\\"\"\n            return $ \"\\\"\"&lt;&gt;res &lt;&gt;\"\\\"\"\n\nbrackted = do string \"\\\\[\"\n              res &lt;- normal\n              string \"\\\\]\"\n              return $ \"[\"&lt;&gt;res&lt;&gt;\"]\"\n</code></pre>\n\n<p>then you can use it to parse the following test cases</p>\n\n<pre><code>Prelude &gt;: MyModule\nPrelude MyModule&gt; import Data.Attoparsec.Text as AT\nPrelude MyModule AT&gt; import Data.Text.IO as TIO\nPrelude MyModule AT TIO&gt;:set -XOverloadedStrings\nPrelude MyModule AT TIO&gt; TIO.putStrLn $ parseOnly escaped \"test\"\ntest\nPrelude MyModule AT TIO&gt; TIO.putStrLn $ parseOnly escaped \"\\\\\\\"test\\\\\\\"\"\n\"test\"\nPrelude MyModule AT TIO&gt; TIO.putStrLn $ parseOnly escaped \"\\\\[test\\\\]\"\n[test]\nPrelude MyModule AT TIO&gt; TIO.putStrLn $ parseOnly escaped \"test \\\\\\\"test\\\\\\\" \\\\[test\\\\]\"\ntest \"test\" [test]\n</code></pre>\n\n<p>note you have to escape the escapes - that's why you see <code>\\\\\\\"</code> instead of <code>\\\"</code></p>\n\n<p>Also if you just parse it will print the <code>Text</code> values escaped, like</p>\n\n<pre><code>Right \"test \\\"text\\\" [test]\"\n</code></pre>\n\n<p>for the last example.</p>\n\n<p>If you parse a file you write simpley escaped text in the file.</p>\n\n<p><code>test.txt</code></p>\n\n<pre><code>I \\[like\\] \\\"Haskell\\\"\n</code></pre>\n\n<p>then you can</p>\n\n<pre><code>Prelude MyModule AT TIO&gt; file &lt;- TIO.readFile \"test.txt\" \nPrelude MyModule AT TIO&gt; TIO.putStrLn $ parseOnly escaped file\nI [like] \"Haskell\"\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 3932019, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caa87dc02ccd35f92887caca786e866e?s=128&d=identicon&r=PG&f=1", "display_name": "DanielRS", "link": "https://stackoverflow.com/users/3932019/danielrs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 539, "favorite_count": 0, "accepted_answer_id": 35302838, "answer_count": 1, "score": 6, "last_activity_date": 1455255345, "creation_date": 1455046959, "last_edit_date": 1455255345, "question_id": 35300812, "link": "https://stackoverflow.com/questions/35300812/fast-parsing-of-string-that-allows-escaped-characters", "title": "Fast parsing of string that allows escaped characters?", "body": "<p>I'm trying to parse a string that can contain escaped characters, here's an example:</p>\n\n<pre><code>import qualified Data.Text as T\n\nexampleParser :: Parser T.Text\nexampleParser = T.pack &lt;$&gt; many (char '\\\\' *&gt; escaped &lt;|&gt; anyChar)\n  where escaped = satisfy (\\c -&gt; c `elem` ['\\\\', '\"', '[', ']'])\n</code></pre>\n\n<p>The parser above creates a <code>String</code> and then packs it into <code>Text</code>. Is there any way to parse a string with escapes like the above using the functions for efficient string handling that attoparsec provides? Like <code>string</code>, <code>scan</code>, <code>runScanner</code>, <code>takeWhile</code>, <code>...</code></p>\n\n<p>Parsing something like <code>\"one \\\"two\\\" \\[three\\]\"</code> would produce <code>one \"two\" [three]</code>.</p>\n\n<p><strong>Update</strong>:</p>\n\n<p>Thanks to @epsilonhalbe I was able to come out with a generalized solution perfect for my needs; note that the following function doesn't look for matching escaped characters like <code>[..]</code>, <code>\"..\"</code>, <code>(..)</code>, etc; and also, if it finds an escaped character that is not valid it treats <code>\\</code> as a literal character.</p>\n\n<pre><code>takeEscapedWhile :: (Char -&gt; Bool) -&gt; (Char -&gt; Bool) -&gt; Parser Text\ntakeEscapedWhile isEscapable while = do\n  x &lt;- normal\n  xs &lt;- many escaped\n  return $ T.concat (x:xs)\n  where normal = Atto.takeWhile (\\c -&gt; c /= '\\\\' &amp;&amp; while c)\n        escaped = do\n          x &lt;- (char '\\\\' *&gt; satisfy isEscapable) &lt;|&gt; char '\\\\'\n          xs &lt;- normal\n          return $ T.cons x xs\n</code></pre>\n"}, {"tags": ["haskell", "quickcheck", "test-framework"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1455035419, "post_id": 35296165, "comment_id": 58304484, "body": "<a href=\"https://github.com/haskell/test-framework/blob/master/quickcheck2/Test/Framework/Providers/QuickCheck2.hs\" rel=\"nofollow noreferrer\">As far as I can see</a> the seed gets only reported on error, never on success."}], "answers": [{"comments": [{"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 0, "creation_date": 1519206837, "post_id": 48832978, "comment_id": 84810873, "body": "So is each element of that list the test seed?"}, {"owner": {"reputation": 121, "user_id": 9371011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ff8901c388adaa7ca9cef2545056072?s=128&d=identicon&r=PG", "display_name": "Josef Klotzner", "link": "https://stackoverflow.com/users/9371011/josef-klotzner"}, "reply_to_user": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 0, "creation_date": 1519312470, "post_id": 48832978, "comment_id": 84868381, "body": "&quot;So is each element of that list the test seed? \u2013 Will Sewell&quot;  ... when You write your own Generator, you can see by yourself: .. charGen :: Gen Char charGen = elements &quot;abcd&quot; .. prop_charToNumAndBackAgain :: Property prop_charToNumAndBackAgain = forAll charGen      (\\c -&gt; chr (fromEnum c)  == c) .. main :: IO () main = do     verboseCheck prop_charToNumAndBackAgain .. *Tests&gt; main Passed:   &#39;d&#39;  Passed:   &#39;c&#39;  Passed:   &#39;a&#39;  Passed:   &#39;d&#39;"}], "tags": [], "owner": {"reputation": 121, "user_id": 9371011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ff8901c388adaa7ca9cef2545056072?s=128&d=identicon&r=PG", "display_name": "Josef Klotzner", "link": "https://stackoverflow.com/users/9371011/josef-klotzner"}, "is_accepted": true, "score": 1, "last_activity_date": 1518807457, "last_edit_date": 1518807457, "creation_date": 1518806387, "answer_id": 48832978, "question_id": 35296165, "link": "https://stackoverflow.com/questions/35296165/how-to-print-the-test-seed-in-haskells-test-framework/48832978#48832978", "title": "How to print the test seed in Haskell&#39;s test-framework?", "body": "<p>As i also was interested in the answer of this question it came to my mind, that result, searched for, is verbosed output of the test. This brought me to the answer on hoogle:\n<a href=\"https://www.haskell.org/hoogle/?hoogle=verboseCheck\" rel=\"nofollow noreferrer\" title=\"verboseCheck\">https://www.haskell.org/hoogle/?hoogle=verboseCheck</a></p>\n\n<p>So instead of using <code>quickCheck :: Testable prop =&gt; prop -&gt; IO ()</code></p>\n\n<pre><code>main = quickCheck propertyToTest\n</code></pre>\n\n<p>giving just an output of:</p>\n\n<blockquote>\n  <p>+++ OK, passed 100 tests.</p>\n</blockquote>\n\n<p>use <code>verboseCheck :: Testable prop =&gt; prop -&gt; IO ()</code></p>\n\n<pre><code>main = verboseCheck propertyToTest\n</code></pre>\n\n<p>giving verbosed, detailed output like this example for each test (Passed: for 100 times):</p>\n\n<blockquote>\n  <p>Passed:<br>\n  [-83,-52,7,-3,-92,-52,21,18,48,-72,-93,74,-30,-1,88,57,39,-20,-92,-98,-85,8,-92,22,-83,82,-39,49,70,65,-35,-7,66,38,-76,92,0,-94,-28,68,43,21,-70,25,76,39,-31,-37,-30,-1,-39,-34,14,-5,-19,54,-21,-19,-3,10,68,74,50,13,-9,54,41,-78,-77,28,-17,76,-41,-51,17,-90,56,25,58,90]</p>\n  \n  <p>...  99 others ...</p>\n  \n  <p>+++ OK, passed 100 tests.</p>\n</blockquote>\n\n<p>As there was no answer to this question and i got it by my own, i created an account here and share it </p>\n"}], "owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "accepted_answer_id": 48832978, "answer_count": 1, "score": 1, "last_activity_date": 1518807457, "creation_date": 1455032642, "question_id": 35296165, "link": "https://stackoverflow.com/questions/35296165/how-to-print-the-test-seed-in-haskells-test-framework", "title": "How to print the test seed in Haskell&#39;s test-framework?", "body": "<p>The <a href=\"https://batterseapower.github.io/test-framework/\" rel=\"nofollow\"><code>test-framework</code> docs</a> state that it supports \"Reporting of the seed used upon a failed QuickCheck run, so you can reproduce the failure if necessary.\" However the default output does not display this, and I cannot find any command line option that will turn this on.</p>\n\n<p>Is there a way of doing this in <code>test-framework</code>, or will I have to manually print the <a href=\"http://haddock.stackage.org/lts-5.2/QuickCheck-2.8.1/Test-QuickCheck.html#v:usedSeed\" rel=\"nofollow\"><code>usedSeed</code></a> from QuickCheck?</p>\n"}, {"tags": ["haskell", "generics", "programming-languages"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 7, "creation_date": 1455019785, "post_id": 35291304, "comment_id": 58293128, "body": "I&#39;m not sure whether this is on topic on SO. <a href=\"https://cs.stackexchange.com\">Computer Science</a> or <a href=\"https://softwareengineering.stackexchange.com\">Software Engineering</a> might be better places, but I&#39;m not sure on that either."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1455021207, "post_id": 35291304, "comment_id": 58294090, "body": "The haskell type system can only do things like arithmetic if you enable an extension to allow it. Generally this will be Undecidable Instances or the like. Otherwise the compiler will reject anything that could be non-terminating, which is any type family application withing a type family definition, or an instance constraint which is no smaller than the instance head. These are two very specific metrics for the Haskell (GHC) type system in particular - I&#39;m not sure to which degree they will generalize."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 5, "creation_date": 1455021800, "post_id": 35291304, "comment_id": 58294478, "body": "Ensuring termination will surely make it non Turing complete. However, this does not imply that the system is &quot;simple&quot; or efficiently implementable -- e.g. Agda&#39;s type system is not Turing complete, yet in practice you can write almost everything in that."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 2, "creation_date": 1455042538, "post_id": 35291304, "comment_id": 58309071, "body": "I&#39;m voting to close this question as off-topic because it is about theoretical computer science, in particular type system design, which is a topic suited for either <a href=\"http://cs.stackexchange.com/\">cs.SE</a> or <a href=\"http://cstheory.stackexchange.com/\">cstheory.SE</a>"}, {"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 1, "creation_date": 1455049330, "post_id": 35291304, "comment_id": 58313041, "body": "The answer is ... anything that would prevent it from simulating an arbitrary Turing machine. It&#39;s not quite clear where you want to go with this question, so I&#39;m voting to close it as &quot;too broad&quot;. Although you may want to look at existing non-Turing complete systems, like Coq, Agda, and BlooP (the latter likely being the easiest to comprehend), and what restrictions they enforce."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1455052641, "post_id": 35291304, "comment_id": 58315000, "body": "Look at <a href=\"https://en.wikipedia.org/wiki/Theory_of_computation\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Theory_of_computation</a>. You want something weaker than a Turing machine."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1455059254, "post_id": 35291304, "comment_id": 58318282, "body": "The simplest ways are explicitly limiting time or space to some arbitrary number of steps or bytes. These restrictions will lead to ill-behaved systems, but they are useful in practice nonetheless."}, {"owner": {"reputation": 313, "user_id": 1138184, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4c1da1245346b963e05f5ac8ad60bbcf?s=128&d=identicon&r=PG", "display_name": "user1138184", "link": "https://stackoverflow.com/users/1138184/user1138184"}, "edited": false, "score": 0, "creation_date": 1455190681, "post_id": 35291304, "comment_id": 58383764, "body": "After researching BlooP, I found another language with a simple implementation: PL-{GOTO}. It is also a primitive recursive function language. However, it looks like such a function can indeed have a lot of non-simple behavior."}], "owner": {"reputation": 313, "user_id": 1138184, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4c1da1245346b963e05f5ac8ad60bbcf?s=128&d=identicon&r=PG", "display_name": "user1138184", "link": "https://stackoverflow.com/users/1138184/user1138184"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "closed_date": 1455080499, "answer_count": 0, "score": 2, "last_activity_date": 1455018522, "creation_date": 1455018522, "question_id": 35291304, "link": "https://stackoverflow.com/questions/35291304/how-to-restrict-prevent-turing-completeness-in-a-generics-system", "closed_reason": "Not suitable for this site", "title": "How to restrict/prevent turing completeness in a generics system", "body": "<p>I want to write a generics system for a simple programming language. I do not want to deal with complex generics that can compute things. For example the C++ templating language is accidentally turing complete, and haskell with fundeps can do type level arithmetic. What restrictions on the generics system would I need to place to make it non turing complete?</p>\n"}, {"tags": ["haskell", "typeclass", "type-families"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 4, "creation_date": 1455021403, "post_id": 35290516, "comment_id": 58294216, "body": "You cannot, unless you change the second instance to have a newtype wrapper, or change <code>GroundField</code> to a data family. I doubt either of these are what you are looking for. The approach which is generally taken in this sort of situation is to have a &quot;default&quot; implementation which corresponds to this &quot;trivial&quot; vector space, and then you simply write <code>instance VectorSpace Float; instance VectorSpace Double;...</code>. You will probably need <code>DefaultSignatures</code> for this."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1455023247, "post_id": 35290516, "comment_id": 58295440, "body": "That&#39;s how <a href=\"http://hackage.haskell.org/package/vector-space-0.10.2/docs/Data-VectorSpace.html\" rel=\"nofollow noreferrer\">the standard vector space class does it</a>: it gives individual \u201cprimitive instances\u201d for <code>Float</code>, <code>Double</code>, ... <code>CIntMax</code> and only makes the compound instances polymorphic."}, {"owner": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1455053931, "post_id": 35290516, "comment_id": 58315699, "body": "@leftaroundabout, yes, that&#39;s when I started forking and thought to myself &quot;This is a lot of repetition. Let&#39;s improve.&quot;"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1455108604, "post_id": 35290516, "comment_id": 58340147, "body": "@Turion: yeah, it&#39;s really very mechanical repetition, you could well implement it with a simple CPP macro. I agree this isn&#39;t so nice... basically what we want is a single instance that works for a <i>closed set</i> of types. <a href=\"http://stackoverflow.com/questions/17849870/closed-type-classes\">See this post</a>, perhaps you can use it for a better implementation of the instances."}], "answers": [{"comments": [{"owner": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "edited": false, "score": 0, "creation_date": 1457774730, "post_id": 35952703, "comment_id": 59567325, "body": "Wow! But what if the two instances are in separate modules?"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "reply_to_user": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "edited": false, "score": 1, "creation_date": 1457814743, "post_id": 35952703, "comment_id": 59580828, "body": "The closed type family forces all the instances of Groundfield to be declared at once. But instances of VectorSpace can be declared anywhere."}], "tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 1, "last_activity_date": 1457746715, "creation_date": 1457746715, "answer_id": 35952703, "question_id": 35290516, "link": "https://stackoverflow.com/questions/35290516/how-to-define-these-overlapping-instances-with-type-families/35952703#35952703", "title": "How to define these overlapping instances with type families?", "body": "<p>With the help of GHC's (relatively) new closed type families, I think we can pull it off. The following all typechecks:</p>\n\n<pre><code>type family Groundfield v where\n    Groundfield (a,a) = a\n    Groundfield a = a\n\nclass Fractional (Groundfield v) =&gt; VectorSpace v where\n    (^+^)      :: v -&gt; v -&gt; v\n    zeroVector :: v\n    (^*)       :: v -&gt; Groundfield v -&gt; v\n\ninstance (Fractional (Groundfield a), Num a, a ~ Groundfield a) =&gt; VectorSpace a where\n    (^+^)              = (+)\n    zeroVector         = 0\n    (^*)               = (*)\n\ninstance Fractional a =&gt; VectorSpace (a,a) where\n    (a, b) ^+^ (c, d)      = (a + c, b + d)\n    zeroVector             = (0,0)\n    (a, b) ^* c            = (a * c, b * c)\n</code></pre>\n"}], "owner": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1457746715, "creation_date": 1455016296, "question_id": 35290516, "link": "https://stackoverflow.com/questions/35290516/how-to-define-these-overlapping-instances-with-type-families", "title": "How to define these overlapping instances with type families?", "body": "<p>Imagine I want to define a vector space typeclass. I do the following (inspired by Yampa):</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies           #-}\n{-# LANGUAGE FlexibleContexts       #-}\n{-# LANGUAGE FlexibleInstances      #-}\n{-# LANGUAGE UndecidableInstances   #-}\n\nclass Fractional (Groundfield v) =&gt; VectorSpace v where\n    type Groundfield v\n    (^+^)      :: v -&gt; v -&gt; v\n    zeroVector :: v\n    (^*)       :: v -&gt; Groundfield v -&gt; v\n</code></pre>\n\n<p>That works perfectly. Now for some common instances. Of course, a tuple of fractionals is a vector space:</p>\n\n<pre><code>instance Fractional a =&gt; VectorSpace (a,a) where\n    type Groundfield (a,a) = a\n    (a, b) ^+^ (c, d)      = (a + c, b + d)\n    zeroVector             = (0,0)\n    (a, b) ^* c            = (a * c, b * c)\n</code></pre>\n\n<p>Or even simpler, a fractional is a vector space over itself:</p>\n\n<pre><code>instance Fractional a =&gt; VectorSpace a where\n    type Groundfield a = a\n    (^+^)              = (+)\n    zeroVector         = 0\n    (^*)               = (*)\n</code></pre>\n\n<p>Each of the instances itself is perfectly valid. But if I put them in the same module, I get this problem:</p>\n\n<pre><code>VectorSpielwiese.hs:15:10:\n  Conflicting family instance declarations:\n    Groundfield (a, a) -- Defined at VectorSpielwiese.hs:15:10\n    Groundfield a -- Defined at VectorSpielwiese.hs:21:10\n</code></pre>\n\n<p>I realise that matching on <code>a</code> in the second instance definition catches a tuple pattern as well. But I would have expected that I've already matched that pattern if I write the instance definition for <code>(a,a)</code> before. Apparently not! How can I achieve this?</p>\n"}, {"tags": ["bash", "unix", "haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1455012928, "post_id": 35289281, "comment_id": 58288601, "body": "I think I get it - he wants to evaluate a string but with the definitions of the package/file in scope - I think it should work if you have the definitions in a library and just use <code>stack eval &quot;import MyStuff; stuff ...&quot; --package MyPackage</code>"}, {"owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1455013274, "post_id": 35289281, "comment_id": 58288838, "body": "@Carsten Yes, that is quite precisely what I&#39;m trying to do. I&#39;m trying out your suggestion of <code>stack eval &quot;import MyStuff; stuff ...&quot; --package MyPackage</code> without success yet, I get <code>&lt;interactive&gt;:1:41: Not in scope: ...</code> errors. I&#39;ll keep trying a bit more."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1455013361, "post_id": 35289281, "comment_id": 58288882, "body": "@Carsten: The <code>--package \u2026</code> option isn&#39;t necessary if one executes <code>stack eval</code> in the package directory."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1455013808, "post_id": 35289281, "comment_id": 58289171, "body": "@Zeta ok thanks - was just a wild guess (cannot test right now)"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 0, "last_activity_date": 1455012981, "last_edit_date": 1455012981, "creation_date": 1455012798, "answer_id": 35289281, "question_id": 35289060, "link": "https://stackoverflow.com/questions/35289060/how-to-execute-haskell-code-in-the-context-of-main-with-stack/35289281#35289281", "title": "How to execute Haskell code in the context of Main with `stack`?", "body": "<p>I don't quite get what you want to do - do you want to execute the main - then use </p>\n\n<pre><code>$&gt; stack runghc ./src/Main.hs &gt; test.txt\n</code></pre>\n\n<p>or</p>\n\n<pre><code>$&gt; stack build\n$&gt; stack exec -- modulename &gt; test.txt\n</code></pre>\n\n<p>to invoke the compiled binary.</p>\n\n<p>If you have a function that is exported in main it is easiest to use <code>stack ghci</code> and call the function from inside - if it produces a <code>String</code> you can then use</p>\n\n<pre><code>writeFile \"test.txt\" (myfunction parameter1 parameter2)\n</code></pre>\n\n<p>to get the desired result.</p>\n\n<hr>\n\n<p>I have not used <code>stack eval</code> before but I guess you have to export your function in a library for that, I guess your cabal file says that you have only an export of an executable - to give you more info I would need your <code>cabal</code> file.</p>\n"}, {"comments": [{"owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "edited": false, "score": 0, "creation_date": 1455013813, "post_id": 35289405, "comment_id": 58289173, "body": "I&#39;ve tried your first suggestion (<code>import Main</code>), and I got: <code>&lt;no location info&gt;:     Could not find module \u2018Main\u2019     It is not a module in the current program, or in any known package. </code> Now I am trying the fully qualified version, and I am getting <code>&lt;interactive&gt;:1:52: Not in scope: \u2018Main.functionDefinedInMain\u2019</code>"}, {"owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "edited": false, "score": 0, "creation_date": 1455013991, "post_id": 35289405, "comment_id": 58289278, "body": "I&#39;ve tried it on a new project initialised with <code>stack new exp-eval simple</code>, without success: <a href=\"https://gist.github.com/Wizek/b79a47a02328fabae8da\" rel=\"nofollow noreferrer\">gist.github.com/Wizek/b79a47a02328fabae8da</a>"}, {"owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "edited": false, "score": 0, "creation_date": 1455015755, "post_id": 35289405, "comment_id": 58290394, "body": "Could you also post a shell session of yours demonstrating how you do it starting from <code>stack new ... simple</code>?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "edited": false, "score": 0, "creation_date": 1455019696, "post_id": 35289405, "comment_id": 58293056, "body": "@Wizek: Sure. Sorry, the previous version of my answer was misleading. It only works for <i>libraries</i> (which I tested locally), but I forgot to check whether the behaviour also holds for executables. It doesn&#39;t. <code>stack eval</code> only loads your library, not your executable. After all, your executable does not export any modules."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 3, "last_activity_date": 1455019628, "last_edit_date": 1455019628, "creation_date": 1455013129, "answer_id": 35289405, "question_id": 35289060, "link": "https://stackoverflow.com/questions/35289060/how-to-execute-haskell-code-in-the-context-of-main-with-stack/35289405#35289405", "title": "How to execute Haskell code in the context of Main with `stack`?", "body": "<p>The <code>-e</code> flag in <code>ghc -e</code> expects a Haskell expression and has&mdash;by default&mdash;only access on <code>Prelude</code>. You need to use additional functions fully qualified:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>stack eval 'Library.someFunc $ 1+1'\n            ^^^^^^^^\n</code></pre>\n\n<p>However, this does only work in the following circumstances:</p>\n\n<ol>\n<li>The module must be part of your <strong>library</strong>, not your <strong>executable</strong>.</li>\n<li>The expression must be exported from the module.</li>\n</ol>\n\n<p>If you're just trying to use <code>Main.xxx</code>, make sure that <code>Main</code> is a visible module in your library. This also concludes that you cannot use <code>eval</code> for executable only projects. However, this can lead to strange problems. For example, GHCi will try to import <code>Main</code> twice, once via the executable and once via the library.</p>\n\n<h2>Example</h2>\n\n<pre><code>$ stack new exp-eval simple\n$ cd exp-eval\n$ cat addition &gt;&gt; exp-eval.cabal\n$ stack eval 'Main.main'\n</code></pre>\n\n<p>Where <code>addition</code> has the following content:</p>\n\n<pre><code>library\n  hs-source-dirs:      src \n  exposed-modules:     Main\n  default-language:    Haskell2010\n  build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5 \n</code></pre>\n"}], "owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1455019628, "creation_date": 1455012213, "last_edit_date": 1455012915, "question_id": 35289060, "link": "https://stackoverflow.com/questions/35289060/how-to-execute-haskell-code-in-the-context-of-main-with-stack", "title": "How to execute Haskell code in the context of Main with `stack`?", "body": "<p>I'm looking to do something like this</p>\n\n<pre><code>$ stack eval 'functionDefinedInMain $ 1 + 1' &gt; test1.txt\n</code></pre>\n\n<p>However, when I execute that, <code>stderr</code> tells me</p>\n\n<pre><code>&lt;interactive&gt;:1:1: Not in scope: \u2018functionDefinedInMain\u2019\n</code></pre>\n\n<hr>\n\n<p>I've also tried to pipe code into <code>stack ghci</code>, which gets me closer:</p>\n\n<pre><code>$ echo 'functionDefinedInMain $ 1+1' | stack ghci &gt; test2.txt\nUsing main module: 1. Package `exp-proj' component exe:exp-proj with main-is file: /home/wizek/sandbox/exp-proj/exp-proj/src/Main.hs\nConfiguring GHCi with the following packages: exp-proj\n\n$ cat test2.txt\nGHCi, version 7.10.3: http://www.haskell.org/ghc/  :? for help\n[1 of 5] Compiling Utils            ( /home/wizek/sandbox/exp-proj/exp-proj/src/Utils.hs, interpreted )\n[2 of 5] Compiling Vertex           ( /home/wizek/sandbox/exp-proj/exp-proj/src/Vertex.hs, interpreted )\n[3 of 5] Compiling Edge             ( /home/wizek/sandbox/exp-proj/exp-proj/src/Edge.hs, interpreted )\n[4 of 5] Compiling Lib              ( /home/wizek/sandbox/exp-proj/exp-proj/src/Lib.hs, interpreted )\n[5 of 5] Compiling Main             ( /home/wizek/sandbox/exp-proj/exp-proj/src/Main.hs, interpreted )\nOk, modules loaded: Utils, Vertex, Edge, Lib, Main.\n*Main Edge Lib Utils Vertex&gt; 3\n*Main Edge Lib Utils Vertex&gt; Leaving GHCi.\n</code></pre>\n\n<p>As you can see, the output (which is just the number <code>3</code> in this example) file is polluted by <code>GHCi</code>.</p>\n\n<p>I'd like the content of the file to be instead:</p>\n\n<pre><code>$ cat test2.txt\n3\n</code></pre>\n\n<hr>\n\n<p>How can I either</p>\n\n<ol>\n<li>load all my project modules with <code>stack eval</code> as specified in my <code>.cabal</code> file to execute code in context, or</li>\n<li>suppress GHCi output to <code>stdout</code>? (I don't mind if GHCi puts messages on <code>stderr</code>)</li>\n</ol>\n\n<hr>\n\n<pre><code>$ stack --version\nVersion 1.0.2, Git revision fa09a980d8bb3df88b2a9193cd9bf84cc6c419b3 (3084 commits) x86_64\n</code></pre>\n\n<hr>\n\n<p><strong>edit</strong>: Added unix and bash tags since it might be possible to achieve this by piping together different <code>stack</code>/<code>GHCi</code> commands even without explicit support from <code>stack</code>.</p>\n"}, {"tags": ["haskell", "types", "polymorphism"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 4, "creation_date": 1455011726, "post_id": 35288772, "comment_id": 58287735, "body": "Do you have a definition of &quot;weakly polymorphic&quot;? As far as I know, this term is only used in OCaml, whereas you usually have the monomorphism restriction in Haskell (which can be turned off)."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1455011925, "post_id": 35288772, "comment_id": 58287876, "body": "This question seems theoretical to me... I mean just remove the word Haskell and replace it with &quot;A programming language&quot; and the answers wont change except maybe for the code samples. If you want to ask theoretical questions about languages or other computer science related topics use <a href=\"http://cs.stackexchange.com/\">cs.SE</a> not SO."}, {"owner": {"reputation": 1794, "user_id": 1135950, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b1cf007709e46bbd037f204a43c51fa4?s=128&d=identicon&r=PG", "display_name": "yonutix", "link": "https://stackoverflow.com/users/1135950/yonutix"}, "edited": false, "score": 0, "creation_date": 1455012100, "post_id": 35288772, "comment_id": 58287994, "body": "Haskell is based on a theoretical model, I&#39;m interested what weakly polymorphism mean relative to Haskell not relative to other programming language. I met this term in the solution given by my Haskell profesor. He said that for normal polymorphism RankNTypes language extension for Haskell is needed."}, {"owner": {"reputation": 1794, "user_id": 1135950, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b1cf007709e46bbd037f204a43c51fa4?s=128&d=identicon&r=PG", "display_name": "yonutix", "link": "https://stackoverflow.com/users/1135950/yonutix"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1455012181, "post_id": 35288772, "comment_id": 58288064, "body": "@Zeta No, I don&#39; t have a definition, I&#39;m searching for it."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1455012539, "post_id": 35288772, "comment_id": 58288305, "body": "Given some examples from Ocaml, this definitely looks like the <a href=\"https://stackoverflow.com/questions/32496864/what-is-the-monomorphism-restriction\">monomorphism restriction</a>, e.g. <code>f = map (+1); somelist = f [1..10] :: [Int]</code> will restrict <code>f</code> to <code>[Int] -&gt; [Int]</code>, although it could be <code>Num a =&gt; [a] -&gt; [a]</code>. The linked Q&amp;A provides much information with many external resources."}, {"owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "edited": false, "score": 0, "creation_date": 1525936758, "post_id": 35288772, "comment_id": 87552903, "body": "With the correct language extensions, GHC can do some type level programming which is a way of having a function return a type. It is used in many libraries. However, the syntax is not very nice. Idris is another language that handles type level programming and the syntax is closer to normal functions."}], "answers": [{"tags": [], "owner": {"reputation": 3683, "user_id": 330242, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c9f3ffc3e30d25eb64e2e464f0a86bd7?s=128&d=identicon&r=PG", "display_name": "przemo_li", "link": "https://stackoverflow.com/users/330242/przemo-li"}, "is_accepted": false, "score": 1, "last_activity_date": 1583919013, "creation_date": 1583919013, "answer_id": 60632859, "question_id": 35288772, "link": "https://stackoverflow.com/questions/35288772/is-haskell-weakly-polymorphic/60632859#60632859", "title": "Is Haskell weakly polymorphic?", "body": "<p>TL;DR: Haskell is not weakly polymorphic, but some tooling can behave like that under some circumstances if developer what it.</p>\n\n<p>It seams OCaml have notion of </p>\n\n<blockquote>\n  <p>weakly polymorphic type variables</p>\n</blockquote>\n\n<p><a href=\"https://caml.inria.fr/pub/docs/manual-ocaml/polymorphism.html\" rel=\"nofollow noreferrer\">https://caml.inria.fr/pub/docs/manual-ocaml/polymorphism.html</a></p>\n\n<p>Such a type variable is characterized by being able to only represent a single type and as soon as that type is inferred its every occurrence will be replaced by that type.</p>\n\n<p>By that definition Haskell is NOT weakly polymorphic. Haskell will always infer broadest possible definition of a given type variable.</p>\n\n<p>However, Haskell GHC compiler have what's called:</p>\n\n<blockquote>\n  <p>monomorphism restriction</p>\n</blockquote>\n\n<p>Which forces behavior as described in OCaml weakly polymorphic variable.\nHowever, while OCaml behavior is toggle per variable. Haskell GHC behavior is controlled by runtime flag that is only active when doing interactive REPL, and even that can be turned off!</p>\n"}], "owner": {"reputation": 1794, "user_id": 1135950, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b1cf007709e46bbd037f204a43c51fa4?s=128&d=identicon&r=PG", "display_name": "yonutix", "link": "https://stackoverflow.com/users/1135950/yonutix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1583924649, "creation_date": 1455011478, "last_edit_date": 1583924649, "question_id": 35288772, "link": "https://stackoverflow.com/questions/35288772/is-haskell-weakly-polymorphic", "title": "Is Haskell weakly polymorphic?", "body": "<p>What does it mean that Haskell is weakly polymorphic? Does it have something to do with the fact that a Haskell function can not return a type?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "monads"], "answers": [{"tags": [], "owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "is_accepted": false, "score": 2, "last_activity_date": 1455009635, "creation_date": 1455009635, "answer_id": 35288108, "question_id": 35287751, "link": "https://stackoverflow.com/questions/35287751/monad-result-type-does-not-produce-either-string-on-fail/35288108#35288108", "title": "Monad result type does not produce `Either String` on `fail`", "body": "<p>Back in the Day, there was no a <code>Monad</code> instance for <code>Either</code> in the \"standard\" libraries at the time.  Instead, this instance was <a href=\"https://hackage.haskell.org/package/mtl-1.0/src/Control/Monad/Error.hs\" rel=\"nofollow\">defined in the mtl library</a>.  However, to make <code>fail</code> work as you desire we need a way to convert a string into whatever the type <code>e</code> is in <code>Either e</code>.  This led to the <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Error.html#t:Error\" rel=\"nofollow\"><code>Error</code></a> class.  Back in the day, the <code>Monad</code> instance in mtl had <code>Error</code> as a constraint on the <code>Either</code> instance of <code>Monad</code>.  This was solely to make <code>fail</code> Do The Right Thing, and most people thought of <code>fail</code> as a bit of a wart on the <code>Monad</code> class.  Unfortunately, it meant that you couldn't use any <code>Monad</code> operations on <code>Either</code> except when your \"error\" type was an instance of <code>Error</code> which wasn't typical or usually desirable.  The orphan instance for <code>Either</code> also caused much trouble when a rival monad library, <a href=\"https://hackage.haskell.org/package/transformers\" rel=\"nofollow\">transformers</a>, came along.  Eventually, though, the usefulness of using monad operations on <code>Either</code> regardless of the \"error\" type and the movement the <code>Monad</code> instance into base prevailed to cause the constraint to be removed.  Now, though, there is no sensible thing that can be defined for <code>fail</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 10332, "user_id": 302343, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/RrFm0.png?s=128&g=1", "display_name": "Timur", "link": "https://stackoverflow.com/users/302343/timur"}, "edited": false, "score": 0, "creation_date": 1455029072, "post_id": 35288113, "comment_id": 58299484, "body": "Thank you. Then, why the more general instance of <code>Either e</code> is still being used? I thought that when I specify <code>Either String a</code> as the target - it would have bind the <code>e</code> from <code>Either e</code> to a <code>String</code>. Am I asking too much of the type inference or am I missing something yet?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 10332, "user_id": 302343, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/RrFm0.png?s=128&g=1", "display_name": "Timur", "link": "https://stackoverflow.com/users/302343/timur"}, "edited": false, "score": 0, "creation_date": 1455029911, "post_id": 35288113, "comment_id": 58300098, "body": "@Timur: <code>fail</code>&#39;s type in the context of <code>Either</code> can be thought as <code>fail :: String -&gt; Either e a</code>. There&#39;s no constraint for <code>e</code>. Given that a special instance for <code>Either String</code> would overlap the already existing one, this isn&#39;t very feasible."}, {"owner": {"reputation": 10332, "user_id": 302343, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/RrFm0.png?s=128&g=1", "display_name": "Timur", "link": "https://stackoverflow.com/users/302343/timur"}, "edited": false, "score": 0, "creation_date": 1455036170, "post_id": 35288113, "comment_id": 58305049, "body": "Ah, I get it now. Looked at the source code (<a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/src/Data.Either.html#Either\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.8.2.0/docs/src/&hellip;</a>)... Certainly, how would you implement <code>fail</code> for a generic type <code>e</code> otherwise than its default implementation with an <code>error</code>. Thank you, that&#39;s clear now!"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 5, "last_activity_date": 1455029870, "last_edit_date": 1455029870, "creation_date": 1455009657, "answer_id": 35288113, "question_id": 35287751, "link": "https://stackoverflow.com/questions/35287751/monad-result-type-does-not-produce-either-string-on-fail/35288113#35288113", "title": "Monad result type does not produce `Either String` on `fail`", "body": "<blockquote>\n  <p>Why is it?</p>\n</blockquote>\n\n<p>Remember <code>fail</code>'s type: <code>Monad m =&gt; String -&gt; m a</code>. Now, if the monad instance of <code>Either</code> was only defined for <code>Either String</code>, this would be easy:</p>\n\n<pre><code>instance Monad (Either String) where\n    fail = Left\n    ...\n</code></pre>\n\n<p>However, the actual instance is more general:</p>\n\n<pre><code>instance Monad (Either e) where\n    ...\n</code></pre>\n\n<p>Therefore <code>fail</code>'s type is also more general, even if we constrain it to this specific instance:</p>\n\n<pre><code>-- No          v  restriction on e   v\nfail :: forall e a. String -&gt; Either e a\n--      ^^^^^^^^^^\n-- This is implicitly there every time you use a polymorphic function\n-- (unless you start toying around with some extensions and move it further\n--  to the right or into parentheses, see RankNTypes or similar extensions.)\n</code></pre>\n\n<p>And since <code>e</code> isn't restricted to <code>String</code>, there's no general way to store the error message in <code>Left e</code>. For example, how what should the following example return?</p>\n\n<pre><code>example :: Either () () \nexample = fail \"Example\"\n</code></pre>\n\n<p>Even if you use an <code>Either String a</code>, the more general instance is still being used. An alternative is a newtype or your own ADT with a fitting instance:</p>\n\n<pre><code>data EitherString a  = ELeft String | ERight a\n\ninstance Monad EitherString where\n    fail = ELeft\n    ...\n\n\nnewtype EitherWrap a = Wrapped { unWrap :: Either String a }\n\ninstance Monad EitherWrap where\n    fail = Wrapped . Left\n</code></pre>\n\n<p>Note that there's <a href=\"https://prime.haskell.org/wiki/Libraries/Proposals/MonadFail\" rel=\"nofollow\">a proposal</a> to split <code>fail</code> from the <code>Monad</code> typeclass into a <code>MonadFail</code> one.</p>\n"}, {"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1455009916, "post_id": 35288119, "comment_id": 58286509, "body": "Equal in their rights to represent the value, but <code>(&gt;&gt;=)</code> is still <code>Left</code> biased."}, {"owner": {"reputation": 7207, "user_id": 338846, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f1871f7b7f5b4b39d59b72dfbe42b8f5?s=128&d=identicon&r=PG", "display_name": "Alexey Raga", "link": "https://stackoverflow.com/users/338846/alexey-raga"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1455010125, "post_id": 35288119, "comment_id": 58286640, "body": "&gt;&gt;= is <code>Right</code> based because in <code>Either a b</code> it is not <code>Either</code> that is a monad, but <code>Either a</code>."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1455010334, "post_id": 35288119, "comment_id": 58286778, "body": "I said &quot;b__i__ased&quot;, not based. <code>Left k &gt;&gt;= _ = Left k</code>. And I&#39;m well aware of the reason."}], "tags": [], "owner": {"reputation": 7207, "user_id": 338846, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f1871f7b7f5b4b39d59b72dfbe42b8f5?s=128&d=identicon&r=PG", "display_name": "Alexey Raga", "link": "https://stackoverflow.com/users/338846/alexey-raga"}, "is_accepted": false, "score": 1, "last_activity_date": 1455009679, "creation_date": 1455009679, "answer_id": 35288119, "question_id": 35287751, "link": "https://stackoverflow.com/questions/35287751/monad-result-type-does-not-produce-either-string-on-fail/35288119#35288119", "title": "Monad result type does not produce `Either String` on `fail`", "body": "<p>Because <code>Either</code> is a disjunction, not just success/error. It is often used for representing success/error (because it is convenient), but in general it is not the case.</p>\n\n<p>That's why data constructors are named <code>Left</code> and <code>Right</code>. They are equal in their rights to represent the value. </p>\n\n<p>For example, it is perfectly OK for me to have <code>Either Computation Result</code> or something like that. <code>Either Gold Money</code>, etc.</p>\n\n<p>It would probably not be correct if <code>fail</code> ended up returning one of the branches of a disjunction.</p>\n"}], "owner": {"reputation": 10332, "user_id": 302343, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/RrFm0.png?s=128&g=1", "display_name": "Timur", "link": "https://stackoverflow.com/users/302343/timur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 35288113, "answer_count": 3, "score": 2, "last_activity_date": 1455029870, "creation_date": 1455008475, "last_edit_date": 1455009144, "question_id": 35287751, "link": "https://stackoverflow.com/questions/35287751/monad-result-type-does-not-produce-either-string-on-fail", "title": "Monad result type does not produce `Either String` on `fail`", "body": "<p>Given the following function which produces a result wrapped into a Monad:</p>\n\n<pre><code>ab :: (Monad m) =&gt; Char -&gt; m Bool\nab 'a' = return True\nab 'b' = return False\nab _   = fail \"say what?\"\n</code></pre>\n\n<p>Following uses work as I would expect:</p>\n\n<pre><code>ab 'a' :: [Bool]      -- results in [True]\nab 'c' :: [Bool]      -- results in []\nab 'b' :: Maybe Bool  -- results in Just b\nab 'c' :: Maybe Bool  -- results in Nothing\nab 'a' :: Either String Bool  -- results in Right True\n</code></pre>\n\n<p>But, with <code>Either String</code>, <code>fail</code> actually produces an exception, although I would expect it to be a <code>Left</code> with an error message:</p>\n\n<pre><code>&gt; ab 'c' :: Either String Bool\n*** Exception: say what?\n</code></pre>\n\n<p>Why is it? Is there a way to change the code above (function implementation, or the way it is applied) so as to produce <code>Left</code> in case of failures (yet keeping it generic certainly). </p>\n"}, {"tags": ["haskell", "type-inference"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1455009891, "creation_date": 1455009891, "answer_id": 35288181, "question_id": 35287673, "link": "https://stackoverflow.com/questions/35287673/what-if-function-application-was-a-typeclass/35288181#35288181", "title": "What if function application was a typeclass?", "body": "<p>If you can envision this as a syntactic sugar on top of Haskell (replacing the \"space operator\" with yours), I can't see why this should make type inference any worse than it already is. </p>\n\n<p>I can however see that code might be more ambiguous with this change, e.g.</p>\n\n<pre><code>class C a where get :: a\ninstance C (Int -&gt; Int) where get = id\ninstance C Linearmap where get = ...\n\ntest = get (5 :: Int) -- actually being (get $ (5 :: Int))\n</code></pre>\n\n<p>Above <code>get</code> could be picked from both instances, while such ambiguity does not arise in plain Haskell.</p>\n"}], "owner": {"reputation": 10492, "user_id": 603688, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1058344e1b119c4d9dd3aedc5456277b?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/603688/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 35288181, "answer_count": 1, "score": 5, "last_activity_date": 1455009891, "creation_date": 1455008235, "question_id": 35287673, "link": "https://stackoverflow.com/questions/35287673/what-if-function-application-was-a-typeclass", "title": "What if function application was a typeclass?", "body": "<p>Suppose Haskell's function application (the \"space\" operator) were in a typeclass instead of baked into the language. I imagine it would look something like</p>\n\n<pre><code>class Apply f where\n    ($) :: f a r -&gt; a -&gt; r\n\ninstance Apply (-&gt;) where\n   ($) = builtinFnApply#\n</code></pre>\n\n<p>And <code>f a</code> would desugar to <code>f $ a</code>. The idea is that this would let you define other types that act like functions, ie</p>\n\n<pre><code>instance Apply LinearMap where\n    ($) = matrixVectorMult\n</code></pre>\n\n<p>and so on.</p>\n\n<p><strong>Does this make type inference undecidable?</strong> My instinct says that it does, but my understanding of type inference stops at plain Hindley-Milner. As a follow up, if it <em>is</em> undecidable, can it be made decidable by outlawing certain pathological instances?</p>\n"}, {"tags": ["haskell", "exception", "profiling", "ghc"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1455005913, "post_id": 35284927, "comment_id": 58284246, "body": "As far as I can tell <code>-xc</code> will report exceptions regardless of whether they are caught or not. The same behaviour occurs with just <code>main = readProcess &quot;cat&quot; [] &quot;foo&quot;</code>. And with <code>main = throw (ErrorCall &quot;..&quot;) `catch` (\\(ErrorCall e) -&gt; ..)</code>. I would assume this &quot;Exception&quot; is coming from deep inside <code>readProcess</code>. Note that your exception handler <i>never</i> catches an exception (well, if it finds the program &quot;cat&quot; at least). The reported exception isn&#39;t otherwise visible to you, the user, through regular means."}, {"owner": {"reputation": 1352, "user_id": 2063640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47c1f1400a0e795f77bf98361ba82e4?s=128&d=identicon&r=PG", "display_name": "eatcrayons", "link": "https://stackoverflow.com/users/2063640/eatcrayons"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1455053171, "post_id": 35284927, "comment_id": 58315303, "body": "@user2407038 - you make an interesting point about -xc halting execution even when a user thrown exception is immediately caught. Perhaps the profiler can&#39;t differentiate between caught and uncaught exceptions?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1455058530, "post_id": 35284927, "comment_id": 58318017, "body": "I don&#39;t think it halts execution - only if the error is actually uncaught. Either it cannot or chooses not to differentiate. I have not been able to find anywhere in the docs if this intended behaviour or not. To be honest I&#39;d never used this feature before, but I&#39;ve known about it and I always assumed it meant &quot;print the stack trace only if the exception is uncaught&quot;. This just seems like the obvious thing for it to do. Perhaps you should consider opening a ticket, if just to clarify in the documentation the behaviour of this feature."}, {"owner": {"reputation": 1352, "user_id": 2063640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47c1f1400a0e795f77bf98361ba82e4?s=128&d=identicon&r=PG", "display_name": "eatcrayons", "link": "https://stackoverflow.com/users/2063640/eatcrayons"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1455073456, "post_id": 35284927, "comment_id": 58322368, "body": "@user2407038 - it does seem that the program continues to run, but I know it prevents the .prof file from being generated (which is why I was running it to begin with). Perhaps I will open a ticket if no one comes along with a good explanation. Thanks!"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1455092014, "post_id": 35284927, "comment_id": 58329193, "body": "&quot;it prevents the .prof file from being generated&quot; Very strange. It is seeming more and more like a bug. Best of luck, and if you even figure it out feel free to come back and answer your own question for future generations."}], "owner": {"reputation": 1352, "user_id": 2063640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47c1f1400a0e795f77bf98361ba82e4?s=128&d=identicon&r=PG", "display_name": "eatcrayons", "link": "https://stackoverflow.com/users/2063640/eatcrayons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1454997514, "creation_date": 1454997514, "question_id": 35284927, "link": "https://stackoverflow.com/questions/35284927/haskell-profiling-throws-exception-when-using-readprocess", "title": "Haskell - profiling throws exception when using readProcess", "body": "<p>I've started profiling an algorithm I developed, and I've come across a confusing exception.</p>\n\n<p>My program makes a call to an external process. I am using readProcess from System.Process for this call. When I build (ghc 7.8.4) without the -prof flag, the program runs great without any exceptions. When I use the -prof flag, and then execute with +RTS -xc -RTS, I get exceptions at every readProcess occurrence.</p>\n\n<p>I've whittled the code down to a simple Linux-based example.</p>\n\n<p>ProfTest.hs:</p>\n\n<pre><code>module Main where\n\nimport System.Process\nimport Control.Exception\n\nmain = catch (readProcess \"cat\" [] \"foo\" &gt;&gt;= putStrLn)\n             (\\e -&gt; putStrLn $ show (e :: SomeException))\n</code></pre>\n\n<p>Then build/run as follows:</p>\n\n<pre><code>$ ghc -prof ProfTest.hs\n$ ./ProfTest +RTS -xc\n*** Exception (reporting due to +RTS -xc): (THUNK_1_0), stack trace: \n  Main.CAF\nHello\n</code></pre>\n\n<p>What causes this exception?</p>\n\n<p>The simple solution is to replace the -xc flag with -p or another option which doesn't dump the exception stack. But I'm confused why monitoring for exceptions causes an exception in this instance.</p>\n\n<p>Any ideas?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 283, "user_id": 2723238, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7d3387dfb0d1396362f6ae94289b7749?s=128&d=identicon&r=PG&f=1", "display_name": "Frank  D.", "link": "https://stackoverflow.com/users/2723238/frank-d"}, "edited": false, "score": 0, "creation_date": 1454970319, "post_id": 35280126, "comment_id": 58272566, "body": "Thank  you so much Daniel   for your time and article....it works finally after  configuring my  editor   *Main&gt; :!hellome.exe  frank Erick Hello,frank Hello,Erick"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1454968584, "creation_date": 1454968584, "answer_id": 35280126, "question_id": 35280013, "link": "https://stackoverflow.com/questions/35280013/printing-two-arguments/35280126#35280126", "title": "Printing two arguments", "body": "<p>Put the <code>putStrLn</code> command on a separate line. The second <code>do</code> is not necessary (in fact, it is necessary not to have it). Additionally, you should know that the compiler views hard tabs as padding out to the next eight-space boundary; so although things look correctly indented here on SO, your code's mixture of tabs and spaces is incorrect. I recommend either using a single tab at the beginning of each line in the <code>do</code> block or converting all tabs to spaces. See also <a href=\"http://dmwit.com/tabs\" rel=\"nofollow\">my diatribe on tab styles</a>. So:</p>\n\n<pre><code>main = do \n        args &lt;- getArgs  --Getting first arg\n        putStrLn(\"Hello,\" ++args!!0)\n        args1 &lt;- getArgs\n        putStrLn(\"Hello,\" ++args1!!1)  --Getting second arg\n</code></pre>\n\n<p>This is the smallest change needed to make things work. Additionally, since I see no reason to believe the arguments will change between the two calls to <code>getArgs</code>, you may as well omit the second call and simply reuse <code>args</code>:</p>\n\n<pre><code>main = do \n        args &lt;- getArgs\n        putStrLn(\"Hello,\" ++args!!0)\n        putStrLn(\"Hello,\" ++args!!1)\n</code></pre>\n"}], "owner": {"reputation": 283, "user_id": 2723238, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7d3387dfb0d1396362f6ae94289b7749?s=128&d=identicon&r=PG&f=1", "display_name": "Frank  D.", "link": "https://stackoverflow.com/users/2723238/frank-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1455592434, "creation_date": 1454968197, "last_edit_date": 1455592434, "question_id": 35280013, "link": "https://stackoverflow.com/questions/35280013/printing-two-arguments", "title": "Printing two arguments", "body": "<p>I am trying to <code>:load</code> file \"hello.hs\" and keep getting the errors below.</p>\n\n<p>I am using  WinGHCi 1.0.6.</p>\n\n<p>I have printed just one argument and it worked but when I try to print two arguments I get a <code>Not in scope</code> error as shown below.</p>\n\n<p>My hello.hs code contains the code below.</p>\n\n<p>-----------------hello.hs--------------------</p>\n\n<pre><code>module Main where\nimport System.Environment\nmain :: IO ( )\nmain = do \n        args &lt;- getArgs  --Getting first arg\n        putStrLn(\"Hello,\" ++args!!0)\n    do  args1 &lt;- getArgs putStrLn(\"Hello,\" ++args1!!1)  --Getting second arg\n</code></pre>\n\n<p>----------Errors while trying to  do  :load command --------</p>\n\n<pre><code>hello.hs:6:37: Not in scope: \u2018args\u2019\n\nhello.hs:7:13:\n    The last statement in a 'do' block must be an expression\n      args1 &lt;- getArgs putStrLn (\"Hello,\" ++ args1 !! 1)\n\nhello.hs:7:50:\n    Not in scope: \u2018args1\u2019\n    Perhaps you meant \u2018args\u2019 (line 5)\n</code></pre>\n"}, {"tags": ["haskell", "recursion", "fibonacci"], "comments": [{"owner": {"reputation": 7260, "user_id": 86432, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ac0f5806a57ad801fec9f5619763f667?s=128&d=identicon&r=PG", "display_name": "masonk", "link": "https://stackoverflow.com/users/86432/masonk"}, "edited": false, "score": 2, "creation_date": 1454968748, "post_id": 35279969, "comment_id": 58271886, "body": "&quot;Am I intelligent enough for X&quot; is not a programming question. Sorry. (Voting to close). However I can tell you that creative currying is a mental skill you get better at, just like enumerating for loops is something you learn how to do automatically when you work with C, but really isn&#39;t that easy for beginners."}, {"owner": {"reputation": 3744, "user_id": 4298200, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh5.googleusercontent.com/-HcKtiretO2g/AAAAAAAAAAI/AAAAAAAAAH0/IXGAL7MX8sQ/photo.jpg?sz=128", "display_name": "Neuron", "link": "https://stackoverflow.com/users/4298200/neuron"}, "edited": false, "score": 0, "creation_date": 1454969893, "post_id": 35279969, "comment_id": 58272393, "body": "from the <code>What topics can I ask about here?</code> section on stackoverflow I couldn&#39;t find a reason why this is not a relevant question. It obviously relates to programming, even though the question is opinion based. How is &quot;Am I intelligent enough for X&quot; not a programming question, if X is replaced by a programming language? You can&#39;t just strip the relevant part from a question and then claim it is off topic!"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1454970818, "post_id": 35279969, "comment_id": 58272761, "body": "If this were phrased like &quot;why does this produce the fibonacci sequence&quot; or &quot;how am I supposed to understand what this does&quot;, that would be a reasonable question. &quot;Am I a smart person?&quot; is just not a question anyone here can possibly answer, and it&#39;s not on topic."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1454970864, "post_id": 35279969, "comment_id": 58272781, "body": "I&#39;m voting to close this question as off-topic because it&#39;s about the asker&#39;s mental capacity, instead of about haskell."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 3, "creation_date": 1454972613, "post_id": 35279969, "comment_id": 58273509, "body": "Most of intelligence is just familiarity.  You worked it out yourself, which is more than a lot of people do.  Keep doing that and you&#39;ll be a pro.  (I would like to share, at the time I started learning Haskell I had just picked up Ruby in 2 days, so the 6 months it took to get comfortable in Haskell was, let&#39;s say, disheartening.  I think that&#39;s just the nature of the beast though.  It&#39;s more akin to relearning programming than learning a new language.)"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 2, "creation_date": 1454974069, "post_id": 35279969, "comment_id": 58274027, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/2404156/understanding-haskells-fibonacci\">Understanding Haskell&#39;s fibonacci</a>"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 3, "creation_date": 1454982371, "post_id": 35279969, "comment_id": 58276460, "body": "I had to look up <code>scanl</code> and see that <code>scanl f x (y : ys) = x : scanl (f x y) ys</code>. That definition is the key, and I certainly didn&#39;t remember it. But then I could see that <code>fibs = 1 : scanl (+) 1 fibs</code> gives me <code>fibs = 1 : gibs</code> where <code>gibs = scanl (+) 1 (1 : gibs) = 1 : scanl (+) 2 gibs</code>. Which means <code>gibs = 1 : hibs</code> where <code>hibs = scanl (+) 2 (1 : hibs) = 2 : scanl (+) 3 hibs</code>. Before each step, we have two consecutive Fibonacci numbers: one before scanl, one waiting in the scanl. Each step slides the window: the &quot;waiting&quot; element emerges and is replaced in the scanl by the sum of the pair."}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 0, "creation_date": 1455041719, "post_id": 35279969, "comment_id": 58308602, "body": "Joining the chorus here, but if you wrote it out by hand and figured it out, the answer is clearly yes, you are."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1455534869, "post_id": 35279969, "comment_id": 58516750, "body": "most important is to <i>name</i> all your interim entities as they come into play, like in the comment by pigworker (the <code>gibs</code> and the <code>hibs</code> i.e. <code>fibs2</code>, <code>fibs3</code>, ... ; etc.)"}], "answers": [{"tags": [], "owner": {"reputation": 3744, "user_id": 4298200, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh5.googleusercontent.com/-HcKtiretO2g/AAAAAAAAAAI/AAAAAAAAAH0/IXGAL7MX8sQ/photo.jpg?sz=128", "display_name": "Neuron", "link": "https://stackoverflow.com/users/4298200/neuron"}, "is_accepted": false, "score": 4, "last_activity_date": 1454969489, "creation_date": 1454969489, "answer_id": 35280346, "question_id": 35279969, "link": "https://stackoverflow.com/questions/35279969/i-dont-clearly-see-why-this-is-the-fibonacci-sequence-am-i-intelligent-enough/35280346#35280346", "title": "I don&#39;t clearly see why this is the Fibonacci sequence. Am I intelligent enough to be a Haskell programmer?", "body": "<ol>\n<li>Like any other language, the semantics of code should - to some extend - document itself, so the answer is yes. But at the same time it takes time getting used to the syntax - just like with any other language. Don't worry, you'll get it. Just try not to back away from such problems and embrace them. Working them through step by step is a good approach, keep doing that!</li>\n<li>I am neither a professional Haskell programmer, nor did I learn it 10 years ago, but to some extend yes. Just like you don't <em>understand</em> the Fibonacci in any other language within half a second when you see it, I'd have to think about it, but I'd get it a <strong>lot</strong> fast compared to the time I started writing in Haskell.</li>\n<li>Like any other programming language, Haskell takes a certain mindset to be read and understood easily and quickly. Just remember the first time you saw code in any other language. Chances are, you felt the exact same thing, but don't remember it as vividly. As Haskell is a very maths inspired language, many non-mathematicians often struggle with the notation and the style of coding.\nMy advise is not give up. You probably didn't have 3 years worth of maths at university, so it will just take a little while.\nBut there is a huge pot of gold at the end of this rainbow. From my experience people who wrote Haskell code understand functional programming on a level no one else ever could! It will certainly help writing elegant code in any other language!</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 11, "last_activity_date": 1454969662, "creation_date": 1454969662, "answer_id": 35280385, "question_id": 35279969, "link": "https://stackoverflow.com/questions/35279969/i-dont-clearly-see-why-this-is-the-fibonacci-sequence-am-i-intelligent-enough/35280385#35280385", "title": "I don&#39;t clearly see why this is the Fibonacci sequence. Am I intelligent enough to be a Haskell programmer?", "body": "<blockquote>\n  <p>Was I supposed to immediately just spot the Fibonacci sequence from the original line?</p>\n</blockquote>\n\n<p>Heck no! You were supposed to read the example, scratch your head, write it out manually... and <em>thereby</em> get an intuition for how <code>scanl</code> works and why this can be used for Fibonacci numbers.</p>\n\n<blockquote>\n  <p>Would some of you ... have seen that the original line is the Fibonacci sequence?</p>\n</blockquote>\n\n<p>Well, it <em>is</em> called <code>fibs</code>... apart from that, yeah, <code>scanl</code> is standard enough that an experienced programmer would quickly see what's going on.</p>\n\n<blockquote>\n  <p>pretty sure Haskell requires a higher IQ</p>\n</blockquote>\n\n<p>I think Haskell requires most of all a good deal of <em>stubbornness</em>, and a particular sense of \u00e6sthetics. Haskell has some quirky ways of doing stuff different. Some of these are a bit hard to grasp, but most of all they're just <em>unfamiliar</em> to most programmers. It's all about getting used to the stuff.</p>\n\n<p>And because, if we're honest, Haskell skills are still not a terribly utilitarian thing right now (as in, any real-world task can be solved as well by some other language too), you really need some enthusiasm for the language's beauty and future potential to keep up with it.</p>\n\n<p>Note that Haskell's quirks and features have a tendency to slowly seep into mainstream languages. So, even if &ldquo;Haskell is not for you&rdquo; you may in the long term benefit from the nice things that are prototyped here, perhaps without even noticing where they come from.</p>\n"}], "owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 35280385, "answer_count": 2, "score": 3, "last_activity_date": 1455447977, "creation_date": 1454967997, "last_edit_date": 1455447977, "question_id": 35279969, "link": "https://stackoverflow.com/questions/35279969/i-dont-clearly-see-why-this-is-the-fibonacci-sequence-am-i-intelligent-enough", "title": "I don&#39;t clearly see why this is the Fibonacci sequence. Am I intelligent enough to be a Haskell programmer?", "body": "<p>This is a way to get the Fibonacci sequence in Haskell. It's from the book haskellbook.com (supposedly for beginners):</p>\n\n<pre><code>fibs = 1 : scanl (+) 1 fibs\n</code></pre>\n\n<p>I can only \"see\" that this is Fibonacci after writing out a few of the first elements manually:</p>\n\n<pre><code>1 : scanl (+) 1 (1 : scanl (+) 1 (1 : scanl (+) 1 (1 : 1 ...\n1 : scanl (+) 1 (1 : scanl (+) 1 (1 : 1 : 2 : 3 ...\n1 : scanl (+) 1 (1 : 1 : 2 : 3 : 5 : 8 ...\n1 : 1 : 2 : 3 : 5 : 8 : 13 : 21 ...\n</code></pre>\n\n<p>Only now do I have some intuition into why this is the Fibonacci sequence. But I had to write it out like this first. And even then it's still just an intuition, not solid proof.</p>\n\n<p>I have three questions:</p>\n\n<ol>\n<li>Was I supposed to immediately just spot the Fibonacci sequence from the original line?</li>\n<li>Would some of you professional Haskell programmer in here of 5-10 years, if you had for the sake of argument never before seen this particular example, immediately have seen that the original line is the Fibonacci sequence?</li>\n<li>I sometimes find myself wondering whether I'm intelligent enough to be a Haskell programmer. Maybe it's just not for me. Haskell makes me feel inadequate sometimes :( Never had this feeling with other programming languages. So the third question: Have any tests/methods been developed to determine whether a particular programmer is intelligent enough to be a Haskell programmer? (I'm pretty sure Haskell requires a higher IQ than most other languages!)</li>\n</ol>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1454968010, "post_id": 35279867, "comment_id": 58271550, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/21188154/how-to-handle-this-simple-io-exception-in-haskell\">How to handle this simple IO exception in Haskell</a>"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1454969056, "creation_date": 1454969056, "answer_id": 35280239, "question_id": 35279867, "link": "https://stackoverflow.com/questions/35279867/how-to-ignore-exception-or-error-and-continue-io-actions-in-haskell/35280239#35280239", "title": "How to ignore exception or Error and continue IO actions in Haskell?", "body": "<p>Instead of <code>try</code>ing your best to do a whole block of commands, have a block of commands that each <code>try</code> their best. Change <code>try (mapM_ foo bar)</code> into <code>mapM_ (try . foo) bar</code>.</p>\n"}], "owner": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 650, "favorite_count": 1, "accepted_answer_id": 35280239, "answer_count": 1, "score": 3, "last_activity_date": 1454969056, "creation_date": 1454967595, "question_id": 35279867, "link": "https://stackoverflow.com/questions/35279867/how-to-ignore-exception-or-error-and-continue-io-actions-in-haskell", "title": "How to ignore exception or Error and continue IO actions in Haskell?", "body": "<pre><code>main :: IO ()\nmain = do\n    res &lt;- try (mapM_ (callProcess \"pandoc\") [[\"--help\"],[\"-eoc\"],[\"-exois\"],[\"--help\"]]) :: IO (Either SomeException ())\n    case res of\n        Right a -&gt; print \"done\"\n        Left e -&gt; print \"error\"\n</code></pre>\n\n<p>in the above code, some of the argument for the command <code>pandoc</code> are wrong and pandoc will throw errors. but I want my code to continue without stopping there and finish the mapM_</p>\n\n<p>What Exception handling should I use?</p>\n\n<p>The error I have is:</p>\n\n<pre><code>    pandoc: unrecognized option `-e'\nTry pandoc --help for more information.\n\"error\"\n</code></pre>\n"}, {"tags": ["python", "function", "haskell", "currying"], "answers": [{"tags": [], "owner": {"reputation": 2549, "user_id": 5765298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d109e4a14d083bccf645ffd660672e61?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett R", "link": "https://stackoverflow.com/users/5765298/garrett-r"}, "is_accepted": false, "score": 2, "last_activity_date": 1454967610, "creation_date": 1454967610, "answer_id": 35279872, "question_id": 35279806, "link": "https://stackoverflow.com/questions/35279806/from-haskell-to-python-how-to-do-currying/35279872#35279872", "title": "From Haskell to Python: how to do currying?", "body": "<p>Yup.  Python supports lambda expressions:</p>\n\n<pre><code>sumFive = lambda x: x + 5\n\nfor i in range(5):\n   print sumFive(i),\n\n#OUTPUT 5,6,7,8,9\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 1, "creation_date": 1454968924, "post_id": 35280045, "comment_id": 58271973, "body": "<code>partial</code> does partial application, not currying. Currying is turning a function <code>(a, b) -&gt; t</code> into a function <code>a -&gt; b -&gt; t</code>. Partial application is turning a function <code>(a, b) -&gt; t</code> into a function <code>b -&gt; t</code> given an <code>a</code>."}], "tags": [], "owner": {"reputation": 367, "user_id": 2113950, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8242dc7c5f8190006b4d4dc125040ad1?s=128&d=identicon&r=PG", "display_name": "rakesh a", "link": "https://stackoverflow.com/users/2113950/rakesh-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1454968293, "creation_date": 1454968293, "answer_id": 35280045, "question_id": 35279806, "link": "https://stackoverflow.com/questions/35279806/from-haskell-to-python-how-to-do-currying/35280045#35280045", "title": "From Haskell to Python: how to do currying?", "body": "<p>For the most generic Haskell style <em>currying</em>, look at <code>partial</code> from the <code>functools</code> module.</p>\n"}, {"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 1, "last_activity_date": 1454968377, "creation_date": 1454968377, "answer_id": 35280075, "question_id": 35279806, "link": "https://stackoverflow.com/questions/35279806/from-haskell-to-python-how-to-do-currying/35280075#35280075", "title": "From Haskell to Python: how to do currying?", "body": "<p>Python functions can return functions, allowing you to create higher-order functions. For example, here is a higher-order function which can specialize a function of two variables:</p>\n\n<pre><code>def specialize(f,a,i):\n    def g(x):\n        if i == 0:\n            return f(a,x)\n        else:\n            return f(x,a)\n    return g\n</code></pre>\n\n<p>Used like this:</p>\n\n<pre><code>&gt;&gt;&gt; def subtract(x,y): return x - y\n\n&gt;&gt;&gt; f = specialize(subtract,5,0)\n&gt;&gt;&gt; g = specialize(subtract,5,1)\n&gt;&gt;&gt; f(7)\n-2\n&gt;&gt;&gt; g(7)\n2\n</code></pre>\n\n<p>But -- there is really no need to reinvent the wheel, the module <a href=\"https://docs.python.org/3.5/library/functools.html\" rel=\"nofollow\">functools</a> has a number of useful higher-order functions that any Haskell programmer would find useful, including <code>partial</code> for partial function application, which is what you are asking about.</p>\n"}, {"tags": [], "owner": {"reputation": 1327, "user_id": 1771644, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXOfw.png?s=128&g=1", "display_name": "Michal Frystacky", "link": "https://stackoverflow.com/users/1771644/michal-frystacky"}, "is_accepted": false, "score": 1, "last_activity_date": 1454968449, "creation_date": 1454968449, "answer_id": 35280097, "question_id": 35279806, "link": "https://stackoverflow.com/questions/35279806/from-haskell-to-python-how-to-do-currying/35280097#35280097", "title": "From Haskell to Python: how to do currying?", "body": "<p>As it was pointed out, python does have <a href=\"https://docs.python.org/3.5/tutorial/controlflow.html#lambda-expressions\" rel=\"nofollow\">lambda functions</a>, so the following does solve the problem: </p>\n\n<pre><code># Haskell: sumFive = (+5)\nsumFive = lambda x : x + 5\n</code></pre>\n\n<p>I think this is more useful with the fact that python has first class functions (<a href=\"http://composingprograms.com/pages/16-higher-order-functions.html\" rel=\"nofollow\">1</a>,<a href=\"http://effbot.org/pyfaq/how-do-you-make-a-higher-order-function-in-python.htm\" rel=\"nofollow\">2</a>)</p>\n\n<pre><code>def summation(n, term):\n    total, k = 0, 1\n    while k &lt;= n:\n        total, k = total + term(k), k + 1\n    return total\n\ndef identity(x):\n    return x\n\ndef sum_naturals(n):\n    return summation(n, identity)\n\nsum_naturals(10) # Returns 55\n# Now for something a bit more complex\ndef pi_term(x):\n    return 8 / ((4*x-3) * (4*x-1))\n\ndef pi_sum(n):\n    return summation(n, pi_term)\n\npi_sum(1e6) # returns: 3.141592153589902\n</code></pre>\n\n<p>You can find more on functional programming and python <a href=\"https://newcircle.com/bookshelf/python_fundamentals_tutorial/functional_programming\" rel=\"nofollow\">here</a></p>\n"}, {"comments": [{"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 2, "creation_date": 1454968987, "post_id": 35280178, "comment_id": 58272010, "body": "That <code>plus</code> function is already in the standard library: <a href=\"https://docs.python.org/3.5/library/operator.html#operator.add\" rel=\"nofollow noreferrer\">docs.python.org/3.5/library/operator.html#operator.add</a>"}, {"owner": {"reputation": 130643, "user_id": 3923281, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CNpoa.jpg?s=128&g=1", "display_name": "Alex Riley", "link": "https://stackoverflow.com/users/3923281/alex-riley"}, "edited": false, "score": 0, "creation_date": 1455371434, "post_id": 35280178, "comment_id": 58466171, "body": "Partial application is similar to, but distinct from, currying which is what the OP&#39;s example shows (I added an answer below showing currying)."}], "tags": [], "owner": {"reputation": 869, "user_id": 2029548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f44dcf3e58fcd22cd857cd563402178?s=128&d=identicon&r=PG", "display_name": "obadz", "link": "https://stackoverflow.com/users/2029548/obadz"}, "is_accepted": false, "score": 5, "last_activity_date": 1454968802, "creation_date": 1454968802, "answer_id": 35280178, "question_id": 35279806, "link": "https://stackoverflow.com/questions/35279806/from-haskell-to-python-how-to-do-currying/35280178#35280178", "title": "From Haskell to Python: how to do currying?", "body": "<p>I think the other answers are misunderstanding the question. I believe the OP is asking about partial application of a function, in his example the function is <code>(+)</code>.</p>\n\n<p>If the goal isn't partial application, the solution is as simple as:</p>\n\n<pre><code>def sumFive(x): return x + 5\n</code></pre>\n\n<p>For partial application in Python, we can use this function: <a href=\"https://docs.python.org/2/library/functools.html#functools.partial\">https://docs.python.org/2/library/functools.html#functools.partial</a></p>\n\n<pre><code>def partial(func, *args, **keywords):\n    def newfunc(*fargs, **fkeywords):\n        newkeywords = keywords.copy()\n        newkeywords.update(fkeywords)\n        return func(*(args + fargs), **newkeywords)\n    newfunc.func = func\n    newfunc.args = args\n    newfunc.keywords = keywords\n    return newfunc\n</code></pre>\n\n<p>Then, we must turn the <code>+</code> operator into a function (I don't believe there's a lightweight syntax to do so like in Haskell):</p>\n\n<pre><code>def plus(x, y): return x + y\n</code></pre>\n\n<p>Finally:</p>\n\n<pre><code>sumFive = partial(plus, 5)\n</code></pre>\n\n<p>Not nearly as nice as in Haskell, but it works:</p>\n\n<pre><code>&gt;&gt;&gt; sumFive(7)\n12\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1327, "user_id": 1771644, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXOfw.png?s=128&g=1", "display_name": "Michal Frystacky", "link": "https://stackoverflow.com/users/1771644/michal-frystacky"}, "edited": false, "score": 0, "creation_date": 1455651899, "post_id": 35378581, "comment_id": 58581180, "body": "Good stuff here @ajcr !"}], "tags": [], "owner": {"reputation": 130643, "user_id": 3923281, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CNpoa.jpg?s=128&g=1", "display_name": "Alex Riley", "link": "https://stackoverflow.com/users/3923281/alex-riley"}, "is_accepted": false, "score": 4, "last_activity_date": 1455371277, "last_edit_date": 1455371277, "creation_date": 1455358386, "answer_id": 35378581, "question_id": 35279806, "link": "https://stackoverflow.com/questions/35279806/from-haskell-to-python-how-to-do-currying/35378581#35378581", "title": "From Haskell to Python: how to do currying?", "body": "<p>Python's design does not naturally support the evaluation of a multi-variable function into a sequence of single-variable functions (<em>currying</em>). As other answers point out, the related (but distinct) concept of <a href=\"https://en.wikipedia.org/wiki/Currying#Contrast_with_partial_function_application\" rel=\"nofollow\"><em>partial application</em></a> is more straightforward to do using <a href=\"https://docs.python.org/3/library/functools.html#functools.partial\" rel=\"nofollow\"><code>partial</code></a> from the functools module.</p>\n\n<p>However, the <a href=\"https://pypi.python.org/pypi/PyMonad/\" rel=\"nofollow\">PyMonad</a> library supplies you with the tools to make currying possible in Python, providing a \"collection of classes for programming with functors, applicative functors and monads.\"</p>\n\n<p>Use the <code>curry</code> decorator to decorate a function that accepts any number of arguments:</p>\n\n<pre><code>from pymonad import curry\n\n@curry\ndef add(x, y):\n    return x + y\n</code></pre>\n\n<p>It is then very easy to curry <code>add</code>. The syntax is not too dissimilar to Haskell's:</p>\n\n<pre><code>&gt;&gt;&gt; add5 = add(5)\n&gt;&gt;&gt; add5(12)\n17    \n</code></pre>\n\n<p>Note that here the <code>add</code> and <code>add5</code> functions are instances of PyMonad's <code>Reader</code> monad class, not a normal Python function object:</p>\n\n<pre><code>&gt;&gt;&gt; add\n&lt;pymonad.Reader.Reader at 0x7f7024ccf908&gt;\n</code></pre>\n\n<p>This allows, for example, the possibility of using simpler syntax to  compose functions (easy to do in Haskell, normally much less so in Python).</p>\n\n<p>Finally, it's worth noting that the infix operator <code>+</code> is not a Python function: <code>+</code> calls into the left-hand operand's <code>__add__</code> method, or the right-hand operand's <code>__radd__</code> method and returns the result. You'll need to decorate these class methods for the objects you're working with if you want to curry using <code>+</code> (disclaimer: I've not tried to do this yet).</p>\n"}], "owner": {"reputation": 65, "user_id": 4362051, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/afa294434bb7b7a753ad865f0ba7feaf?s=128&d=identicon&r=PG&f=1", "display_name": "bury_5", "link": "https://stackoverflow.com/users/4362051/bury-5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 948, "favorite_count": 1, "answer_count": 6, "score": 3, "last_activity_date": 1488536036, "creation_date": 1454967380, "last_edit_date": 1488536036, "question_id": 35279806, "link": "https://stackoverflow.com/questions/35279806/from-haskell-to-python-how-to-do-currying", "title": "From Haskell to Python: how to do currying?", "body": "<p>I recently started coding in Python and I was wondering if it's possible to return a function that <em>specializes</em> another function.</p>\n\n<p>For example, in Haskell you can create a function that adds 5 to any given number like this:</p>\n\n<pre><code>sumFive = (+5)\n</code></pre>\n\n<p>Is it somehow possible in Python?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 126, "user_id": 5766031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-APTQZlmDZaQ/AAAAAAAAAAI/AAAAAAAAAG4/u-iOSDRTsOo/photo.jpg?sz=128", "display_name": "Zacharie 007", "link": "https://stackoverflow.com/users/5766031/zacharie-007"}, "edited": false, "score": 0, "creation_date": 1454967295, "post_id": 35279574, "comment_id": 58271179, "body": "When you test the function numocc on a list it generates an error too. You filter with equal but equal to what ?"}, {"owner": {"reputation": 113, "user_id": 4793410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I3zVN.jpg?s=128&g=1", "display_name": "Vladyslav Babych", "link": "https://stackoverflow.com/users/4793410/vladyslav-babych"}, "reply_to_user": {"reputation": 126, "user_id": 5766031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-APTQZlmDZaQ/AAAAAAAAAAI/AAAAAAAAAG4/u-iOSDRTsOo/photo.jpg?sz=128", "display_name": "Zacharie 007", "link": "https://stackoverflow.com/users/5766031/zacharie-007"}, "edited": false, "score": 1, "creation_date": 1454967441, "post_id": 35279574, "comment_id": 58271250, "body": "@Zacharie007  Sorry, I should have clarified, this function counts the number of occurences of the element in the two-dimensional list. So you call it as follows:   numocc 1 [[1, 2], [2, 3, 2, 1, 1], [3]]"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 4793410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I3zVN.jpg?s=128&g=1", "display_name": "Vladyslav Babych", "link": "https://stackoverflow.com/users/4793410/vladyslav-babych"}, "edited": false, "score": 0, "creation_date": 1454967620, "post_id": 35279824, "comment_id": 58271350, "body": "Thank you! But is there any other way to do this, without introducing new operator? It makes the function look more confusing."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 113, "user_id": 4793410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I3zVN.jpg?s=128&g=1", "display_name": "Vladyslav Babych", "link": "https://stackoverflow.com/users/4793410/vladyslav-babych"}, "edited": false, "score": 1, "creation_date": 1454967841, "post_id": 35279824, "comment_id": 58271460, "body": "@VladyslavBabych Check my edit.  I also made sure to clarify the parsing in the first code block.  Basically, don&#39;t try to use lots of fancy operators, requiring the invention of even more operators to effectively use them.  Parentheses are often the simplest and most readable solution, and using explicit arguments is better than pointfree notation in 99% of cases."}, {"owner": {"reputation": 113, "user_id": 4793410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I3zVN.jpg?s=128&g=1", "display_name": "Vladyslav Babych", "link": "https://stackoverflow.com/users/4793410/vladyslav-babych"}, "edited": false, "score": 0, "creation_date": 1454968026, "post_id": 35279824, "comment_id": 58271559, "body": "@bheklir  I am going to accept this answer, however this function is for learning purposes (university), and the task states that I should define it in a point-free style.  However your comments are still very helpful, thank you! As I can see, it is impossible to make it point-free without introducing a new operator."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 113, "user_id": 4793410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I3zVN.jpg?s=128&g=1", "display_name": "Vladyslav Babych", "link": "https://stackoverflow.com/users/4793410/vladyslav-babych"}, "edited": false, "score": 1, "creation_date": 1454968388, "post_id": 35279824, "comment_id": 58271726, "body": "@VladyslavBabych well, it&#39;s not impossible, it&#39;s just convenient.  <a href=\"https://blunt.herokuapp.com/?_sm_au_=iVVV63vFDZNMvZLH#input=f%20e%20%3D%20map%20length%20.%20((map%20.%20filter%20.%20(%3D%3D))%20e)\" rel=\"nofollow noreferrer\">There are several ways to accomplish it</a>, but I wouldn&#39;t recommend using any of these in real code"}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 6, "last_activity_date": 1454967809, "last_edit_date": 1454967809, "creation_date": 1454967443, "answer_id": 35279824, "question_id": 35279574, "link": "https://stackoverflow.com/questions/35279574/cannot-remove-an-argument-point-free-style-haskell/35279824#35279824", "title": "Cannot remove an argument (Point-free style Haskell)", "body": "<p>Your original function is being parsed as</p>\n\n<pre><code>numocc e = (map length) . ((map . filter . (==)) e)\n</code></pre>\n\n<p>So you can't just remove the <code>e</code> since it doesn't technically appear at the end of the definition.  However, if you define the operator</p>\n\n<pre><code>(.:) :: (c -&gt; d) -&gt; (a -&gt; b -&gt; c) -&gt; (a -&gt; b -&gt; d)\n(.:) = (.) . (.)\n</code></pre>\n\n<p>Then you can write it as</p>\n\n<pre><code>numocc = map length .: (map . filter . (==))\n</code></pre>\n\n<p>The parentheses on <code>map . filter . (==)</code> are required since you can't mix <code>.</code> and <code>.:</code> due to fixity rules.</p>\n\n<p>However, at this point you're just making this function harder to read and maintain.  It would be better to break it down into smaller sections and introduce some intermediate names, along with adding the right type signature and giving the function a better name to start with:</p>\n\n<pre><code>numOccurrences :: Eq a =&gt; a -&gt; [a] -&gt; Int\nnumOccurrences valueToCount values = length (filter (== valueToCount) values)\n\nnumOccurrencesInSublists :: Eq a =&gt; a -&gt; [[a]] -&gt; [Int]\nnumOccurrencesInSublists valueToCount = map (numOccurrences valueToCount)\n</code></pre>\n\n<p>This is far more readable, doesn't rely on fancy operators, and expresses your intent more clearly.  Since the case for counting in a single list is a separate function, you can now use it elsewhere too.</p>\n\n<p>Remember, elegant code isn't about making it as short as possible, it's about making it as clear as possible.  Descriptive names (not necessarily long ones), explicit arguments, and small, composable units are best.</p>\n"}], "owner": {"reputation": 113, "user_id": 4793410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I3zVN.jpg?s=128&g=1", "display_name": "Vladyslav Babych", "link": "https://stackoverflow.com/users/4793410/vladyslav-babych"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 35279824, "answer_count": 1, "score": 1, "last_activity_date": 1454967809, "creation_date": 1454966532, "last_edit_date": 1592644375, "question_id": 35279574, "link": "https://stackoverflow.com/questions/35279574/cannot-remove-an-argument-point-free-style-haskell", "title": "Cannot remove an argument (Point-free style Haskell)", "body": "<p>I am having a problem with removing an argument 'e' in this function:</p>\n<pre><code>numocc e = map length . (map . filter . (==)) e\n</code></pre>\n<p>The function checks the number of occurences of an element inside a two-dimensional list (lists within list). So you call it as follows:</p>\n<blockquote>\n<p>numocc 1 [[1, 2], [2, 3, 2, 1, 1], [3]]</p>\n<p><em>Result : [1,2,0]</em></p>\n</blockquote>\n<p>Argument <em>e</em> is on the far right on both sides of the equal sign, and is not encased in any parameters. Therefore, I should be able to remove it to get a point-free function:</p>\n<pre><code>numocc = map length . (map . filter . (==))\n</code></pre>\n<p>However I get this error:</p>\n<blockquote>\n<p>Type error in application\nExpression     : map length . map . filter . (==)\nTerm           : map length\nType           : [[b]] -&gt; [Int]\nDoes not match : ([[a]] -&gt; [[a]]) -&gt; [Int]</p>\n</blockquote>\n<p>What is the problem here? Thanks.</p>\n"}, {"tags": ["haskell", "lambda", "system-f"], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1454968149, "post_id": 35279469, "comment_id": 58271603, "body": "I guess there&#39;s something odd about the typeclass constraint that exists in Haskell but not in this signature. You could imagine writing this signature for some concrete choice of <code>M</code>, or give a typeclass dictionary as a first argument (so that <code>(&gt;&gt;=)</code> is merely projecting out the appropriate field of a record) or something... Probably not worth changing the answer, but something to be aware of for people consuming the answer."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1454969193, "post_id": 35279469, "comment_id": 58272105, "body": "@DanielWagner That is indeed a very important point. I should at least mention it..."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1454970336, "last_edit_date": 1454970336, "creation_date": 1454966166, "answer_id": 35279469, "question_id": 35279295, "link": "https://stackoverflow.com/questions/35279295/haskell-bind-operator-in-system-f-including-kinds/35279469#35279469", "title": "Haskell bind operator in System F including kinds", "body": "<p>You're almost there. Add explicit quantifiers for type variables, and remove the type annotations on each variable use.</p>\n\n<pre><code>\u2200M:*-&gt;*. \u2200A:*. \u2200B:*. M A -&gt; (A -&gt; M B) -&gt; M B\n</code></pre>\n\n<p>I used the more conventional <code>:</code> instead of Haskell's <code>::</code>.</p>\n\n<p>Note however that System F has no higher kinds (e.g. <code>*-&gt;*</code>), so the type above can only be found in more powerful type systems (e.g. <a href=\"https://en.wikipedia.org/wiki/System_F#System_F.CF.89\" rel=\"nofollow\">System F\u03c9</a>).</p>\n\n<p>Further, above I \"conveniently\" omitted the typeclass restriction on <code>M</code>, which makes the type close to, but not-quite, the Haskell type of <code>&gt;&gt;=</code>. (Also see the comment below by @DanielWagner).</p>\n\n<p>This swept-under-the-rug detail is important. Otherwise, the type above is so general that it is not inhabited -- no lambda term has that type. Indeed, assume by contradiction there is <code>f</code> having the general type above. Then,</p>\n\n<pre><code>f (\u03bbt:*. t-&gt;\u22a5) : \u2200A,B:* . (A -&gt; \u22a5) -&gt; (A -&gt; B -&gt; \u22a5) -&gt; B -&gt; \u22a5\n</code></pre>\n\n<p>where \u22a5 is any empty type (e.g. <code>Void</code>, in Haskell). But then, taking <code>\u22a4</code> to be any nonempty type (e.g. <code>()</code>, in Haskell) with inhabitant <code>u</code>, we obtain</p>\n\n<pre><code>f (\u03bbt:*. t-&gt;\u22a5) \u22a5 : \u2200B:* . (\u22a5 -&gt; \u22a5) -&gt; (\u22a5 -&gt; B -&gt; \u22a5) -&gt; B -&gt; \u22a5\nf (\u03bbt:*. t-&gt;\u22a5) \u22a5 \u22a4 : (\u22a5 -&gt; \u22a5) -&gt; (\u22a5 -&gt; \u22a4 -&gt; \u22a5) -&gt; \u22a4 -&gt; \u22a5\nf (\u03bbt:*. t-&gt;\u22a5) \u22a5 \u22a4 (\u03bbx:\u22a5. x) : (\u22a5 -&gt; \u22a4 -&gt; \u22a5) -&gt; \u22a4 -&gt; \u22a5\nf (\u03bbt:*. t-&gt;\u22a5) \u22a5 \u22a4 (\u03bbx:\u22a5. x) (\u03bbx:\u22a5. \u03bby:\u22a4. x) : \u22a4 -&gt; \u22a5\nf (\u03bbt:*. t-&gt;\u22a5) \u22a5 \u22a4 (\u03bbx:\u22a5. x) (\u03bbx:\u22a5. \u03bby:\u22a4. x) u : \u22a5\n</code></pre>\n\n<p>so <code>\u22a5</code> is inhabited -- contradiction.</p>\n\n<p>More informally, the above merely proves that <code>data T a = T (a -&gt; Void)</code> can not be a monad.</p>\n"}], "owner": {"reputation": 1794, "user_id": 1135950, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b1cf007709e46bbd037f204a43c51fa4?s=128&d=identicon&r=PG", "display_name": "yonutix", "link": "https://stackoverflow.com/users/1135950/yonutix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 35279469, "answer_count": 1, "score": 1, "last_activity_date": 1454970336, "creation_date": 1454965469, "question_id": 35279295, "link": "https://stackoverflow.com/questions/35279295/haskell-bind-operator-in-system-f-including-kinds", "title": "Haskell bind operator in System F including kinds", "body": "<p>I need to know what is the System F type of the Haskell bind type (>>=) operator.</p>\n\n<p>Until now I writed it like this:</p>\n\n<pre><code>(M::*-&gt;* A::*) -&gt; (A::* -&gt; (M::*-&gt;* B::*)) -&gt; (M::*-&gt;*  B:*)\n</code></pre>\n\n<p>Is it right? If it is right how do I find the final result?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["haskell", "types", "type-systems"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454965352, "post_id": 35279100, "comment_id": 58270091, "body": "it depends a bit on what you want to do - for example for what I&#39;ve seen from your question I would indeed choose simple (separate) <code>newtype</code> wrappers like <code>newtype VideoPath = VideoPath FilePath</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1454965464, "post_id": 35279100, "comment_id": 58270172, "body": "or take the <i>phantom type</i> approach: <code>data TempFile a = TempFile FilePath</code> with <code>data Videoformat</code> (needs GHC extension <code>EmptyDataDecls</code>) and then <code>let videoFile = TempFile myPath :: TempFile Videoformat</code> ..."}], "answers": [{"comments": [{"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 3, "creation_date": 1454969212, "post_id": 35279411, "comment_id": 58272113, "body": "&quot;Phantom type&quot; usually refers to a type constructor that is parameterized by a type variable that it doesn&#39;t use."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 0, "creation_date": 1454970072, "post_id": 35279411, "comment_id": 58272457, "body": "@DerekElkins: I think it refers to the <i>parameters</i> which aren&#39;t actually used in some type."}, {"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 1, "creation_date": 1454970629, "post_id": 35279411, "comment_id": 58272686, "body": "I agree, I would say &quot;phantom type variables&quot; not just &quot;phantom types&quot;, but that isn&#39;t how people seem to use it. <a href=\"https://wiki.haskell.org/Phantom_type\" rel=\"nofollow noreferrer\">Phantom type</a>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1455003607, "post_id": 35279411, "comment_id": 58283187, "body": "I guess I can remove my answer as it&#39;s basically yours minus the data-kind approach"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 7, "last_activity_date": 1454966314, "last_edit_date": 1454966314, "creation_date": 1454965929, "answer_id": 35279411, "question_id": 35279100, "link": "https://stackoverflow.com/questions/35279100/in-haskell-how-do-you-restrict-functions-to-only-one-constructor-of-a-data-type/35279411#35279411", "title": "In Haskell, how do you restrict functions to only one constructor of a data type?", "body": "<p>You're right: with <code>-XDataKinds</code>, the <code>TmpFile Video -&gt; FilePath</code> approach would work. And indeed I think this may be a good application for that extension.</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\n\ndata TmpFile (a :: FileFormat) = TmpFile FilePath\n  deriving Show\n\nvideoPath :: TmpFile Video -&gt; FilePath\n</code></pre>\n\n<p>The reason you need this extension to write <code>TmpFile Video</code> is that the constructors of <code>FileFormat</code> are ab initio <em>value-level</em> (thus only exist at runtime), while <code>TmpFile</code> is type-level / compile-time.</p>\n\n<p>Of course there's another way to generate type-level entities: <em>define types</em>! </p>\n\n<pre><code>data Spreadsheet = Spreadsheet\ndata Picture = Picture\ndata Video = Video\n\ndata TmpFile a = TmpFile a FilePath\n  deriving Show\n\nvideoPath :: TmpFile Video -&gt; FilePath\n</code></pre>\n\n<p>Such types are called phantom types. But really, they're a bit of a hack to work around the former lack of proper type-level values, which DataKinds has now given us. So, unless you need compatibility with old compilers, do use DataKinds!</p>\n\n<p>An alternative would be to <em>not</em> enforce the file type at compile time, but simply make it explicit that the functions are partial.</p>\n\n<pre><code>data TmpFile = TmpFile FileFormat FilePath\n  deriving Show\n\nvideoPath :: TmpFile -&gt; Maybe FilePath\nvideoPath (TmpFile Video p) = p\nvideoPath _ = Nothing\n</code></pre>\n\n<p>In fact, that approach might well be the more rational one, depending on what you're planning to do.</p>\n"}, {"comments": [{"owner": {"reputation": 1817, "user_id": 429898, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/IbMYQ.jpg?s=128&g=1", "display_name": "jefdaj", "link": "https://stackoverflow.com/users/429898/jefdaj"}, "edited": false, "score": 0, "creation_date": 1455037103, "post_id": 35286916, "comment_id": 58305719, "body": "Good point, I think I&#39;ll avoid using DataKinds because it&#39;s one more language concept to remember, and I do find it confusing (added tickmarks, and the kinds are omitted when pattern matching even though they show up in the function type signatures). I haven&#39;t been able to get the pattern matching working with refinement types either though, because you can&#39;t get the actual value without specifying the format first. For example I would try to match on <code>listFiles (ListOf (fmt (TmpFile p)))</code>, which doesn&#39;t work without knowing <code>fmt</code>."}], "tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": false, "score": 4, "last_activity_date": 1455005601, "creation_date": 1455005601, "answer_id": 35286916, "question_id": 35279100, "link": "https://stackoverflow.com/questions/35279100/in-haskell-how-do-you-restrict-functions-to-only-one-constructor-of-a-data-type/35286916#35286916", "title": "In Haskell, how do you restrict functions to only one constructor of a data type?", "body": "<p>First of all, I would advice against using such exotic extensions as \"DataKinds\" unless you absolutely need them. The reason is quite practical and general: the more language concepts you use to solve your problem, the harder it is to reason about your code.</p>\n\n<p>Besides, \"DataKinds\" isn't an easy concept to wrap a head around. It is a transitional concept crossing two universes simultaneously: the values and the types. Personally I find it quite controversial and would only apply it when I have no other option.</p>\n\n<p>In your case you've already found two ways of approaching your problem simpler, without \"DataKinds\":</p>\n\n<blockquote>\n  <ul>\n  <li><p>Wrap TmpFile in the format instead of the other way around, so the values are Video (TmpFile \"test.avi\") etc.</p></li>\n  <li><p>Make lots of separate data types VideoTmpFile, PictureTmpFile etc.</p></li>\n  </ul>\n</blockquote>\n\n<p>I particularly like the idea of the wrapping types, because it is flexible and composable. Here's how I'd build up on it:</p>\n\n<pre><code>newtype Video a =\n  Video a\n  deriving (Functor, Foldable, Traversable)\n\nnewtype Picture a =\n  Picture a\n  deriving (Functor, Foldable, Traversable)\n\nvideoPath :: Video FilePath -&gt; FilePath\n</code></pre>\n\n<p>You can notice two things:</p>\n\n<ol>\n<li><p><code>Video</code> and <code>Picture</code> are general concepts, which are not bound to just your temporary files, and they already implement some standard interfaces. This means that they can be reused for other purposes.</p></li>\n<li><p>There is an obvious pattern in the definitions of <code>Video</code> and <code>Picture</code>.</p></li>\n</ol>\n\n<hr>\n\n<p>The pattern that you see in <code>Video</code> and <code>Picture</code> can be called \"refinement types\" and is abstracted from in <a href=\"http://nikita-volkov.github.io/refined/\" rel=\"nofollow\">the \"refined\" package</a> among others. So you might be interested in that.</p>\n\n<hr>\n\n<p>As for your other options:</p>\n\n<blockquote>\n  <ul>\n  <li><p>Make a TmpFile typeclass</p></li>\n  <li><p>Use partial functions everywhere, but add guard functions to abstract the pattern matching</p></li>\n  </ul>\n</blockquote>\n\n<p>That's a definite \"No\" to both. Don't breed typeclasses, leave them be for the truely general concepts, which have laws and likely a (Category) theory behind them. The language provides you plentiful other ways to abstract. Also don't let partial functions crawl out to your APIs - there's a consensus in the community that it's an antipattern.</p>\n"}], "owner": {"reputation": 1817, "user_id": 429898, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/IbMYQ.jpg?s=128&g=1", "display_name": "jefdaj", "link": "https://stackoverflow.com/users/429898/jefdaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 999, "favorite_count": 1, "accepted_answer_id": 35279411, "answer_count": 2, "score": 12, "last_activity_date": 1455005601, "creation_date": 1454964812, "last_edit_date": 1455003661, "question_id": 35279100, "link": "https://stackoverflow.com/questions/35279100/in-haskell-how-do-you-restrict-functions-to-only-one-constructor-of-a-data-type", "title": "In Haskell, how do you restrict functions to only one constructor of a data type?", "body": "<p>I'm not sure how to word this question. Say I'm trying to pass the paths of tmpfiles around, and I want to capture the idea that there are different formats of tmpfile, and each function only works on one of them. This works:</p>\n\n<pre><code>data FileFormat\n  = Spreadsheet\n  | Picture\n  | Video\n  deriving Show\n\ndata TmpFile = TmpFile FileFormat FilePath\n  deriving Show\n\nvideoPath :: TmpFile -&gt; FilePath\nvideoPath (TmpFile Video p) = p\nvideoPath _ = error \"only works on videos!\"\n</code></pre>\n\n<p>But there must be a better way to write it without runtime errors right? I thought of two alternatives, this:</p>\n\n<pre><code>type TmpSpreadsheet = TmpFile Spreadsheet\ntype TmpPicture     = TmpFile Picture\ntype TmpVideo       = TmpFile Video\n\nvideoPath :: TmpVideo -&gt; FilePath\n</code></pre>\n\n<p>Or this:</p>\n\n<pre><code>data TmpFile a = TmpFile a FilePath\n  deriving Show\n\nvideoPath :: TmpFile Video -&gt; FilePath\n</code></pre>\n\n<p>But obviously they don't compile. What's the proper way to do it? Some other ideas, none particularly appealing:</p>\n\n<ul>\n<li>Wrap <code>TmpFile</code> in the format instead of the other way around, so the values are <code>Video (TmpFile \"test.avi\")</code> etc.</li>\n<li>Make lots of separate data types <code>VideoTmpFile</code>, <code>PictureTmpFile</code> etc.</li>\n<li>Make a <code>TmpFile</code> typeclass</li>\n<li>Use partial functions everywhere, but add guard functions to abstract the pattern matching</li>\n</ul>\n\n<p>I also considered learning the <code>-XDataKinds</code> extension, but suspect I'm missing something much simpler that can be done without it.</p>\n\n<p>EDIT: I'm learning a lot today! I tried both the approaches outlined below (<code>DataKinds</code> and phantom types, which have dummy value constructors that can be removed with another extension), and they both work! Then I tried to go a little further. They both let you make a nested type <code>TmpFile (ListOf a)</code> in addition to regular <code>TmpFile a</code>, which is cool. But I've tentatively decided to go with plain phantom types (intact value constructors), because you can pattern match on them. For example, I was surprised that this actually works:</p>\n\n<pre><code>data Spreadsheet = Spreadsheet deriving Show\ndata Picture     = Picture     deriving Show\ndata Video       = Video       deriving Show\ndata ListOf a    = ListOf a    deriving Show\n\ndata TmpFile a = TmpFile a FilePath\n  deriving Show\n\nvideoPath :: TmpFile Video -&gt; FilePath\nvideoPath (TmpFile Video p) = p\n\n-- read a file that contains a list of filenames of type a,\n-- and return them as individual typed tmpfiles\nlistFiles :: TmpFile (ListOf a) -&gt; IO [TmpFile a]\nlistFiles (TmpFile (ListOf fmt) path) = do\n  txt &lt;- readFile path\n  let paths = map (TmpFile fmt) (lines txt)\n  return paths\n\nvidPath :: TmpFile Video\nvidPath = TmpFile Video \"video1.txt\"\n\n-- $ cat videos.txt\n-- video1.avi\n-- video2.avi\nvidsList :: TmpFile (ListOf Video)\nvidsList = TmpFile (ListOf Video) \"videos.txt\"\n\nmain :: IO [FilePath]\nmain = do\n  paths &lt;- listFiles vidsList  -- [TmpFile Video \"video1.avi\",TmpFile Video \"video2.avi\"]\n  return $ map videoPath paths -- [\"video1.avi\",\"video2.avi\"]\n</code></pre>\n\n<p>As far as I can tell, the equivalent with <code>DataKinds</code> is very similar, but can't access <code>fmt</code> as a value:</p>\n\n<pre><code>{-# LANGUAGE DataKinds, KindSignatures #-}\n\ndata FileFormat\n  = Spreadsheet\n  | Picture\n  | Video\n  | ListOf FileFormat\n  deriving Show\n\ndata TmpFile (a :: FileFormat) = TmpFile FilePath\n  deriving Show\n\nvidPath :: TmpFile Video\nvidPath = TmpFile \"video.avi\"\n\nvidsList :: TmpFile (ListOf Video)\nvidsList = TmpFile \"videos.txt\"\n\nvideoPath :: TmpFile Video -&gt; FilePath\nvideoPath (TmpFile p) = p\n\nlistFiles :: TmpFile (ListOf a) -&gt; IO [TmpFile a]\nlistFiles (TmpFile path) = do\n  txt &lt;- readFile path\n  let paths = map TmpFile (lines txt)\n  return paths\n\nmain :: IO [FilePath]\nmain = do\n  paths &lt;- listFiles vidsList\n  return $ map videoPath paths\n</code></pre>\n\n<p>(It may seem like a weird thing to want, but my actual program is going to be an interpreter for a small language that compiles to Shake rules with a tmpfile corresponding to each variable, so typed lists of tmpfiles will be useful)</p>\n\n<p>Does that seem right? I like the idea of <code>DataKinds</code> better, so I would go with it instead if I could inspect them as values, or if it turns out that's never needed.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454963427, "post_id": 35278498, "comment_id": 58268997, "body": "AFAIK you can just use the <code>Show</code> instance of <code>ThreadId</code> (get with <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Concurrent.html#v:myThreadId\" rel=\"nofollow noreferrer\">Control.Concurrent.myThreadId</a> or from <code>forkIO</code>) to print it - of course that will give you something like <code>ThreadId 42</code> - don&#39;t know if you can assign this a name - but should be possible to keep a associative map with the names yourself if you want to"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1454963514, "post_id": 35278498, "comment_id": 58269035, "body": "wait ... Hayoo found something: <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/GHC-Conc-Sync.html#v:labelThread\" rel=\"nofollow noreferrer\">labelThread</a> - should be what you are looking for?"}, {"owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1455061906, "post_id": 35278498, "comment_id": 58319362, "body": "@Carsten that&#39;s it. A string that makes the identification of threads easier. Write a 2-5 line example where you set the thread name and then print off the thread name and unless someone comes up with something better I will give it best answer."}], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1455088723, "post_id": 35307639, "comment_id": 58327590, "body": "@dfeuer ... thanks (seems I need a spell-checker ... sorry for that)"}, {"owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "edited": false, "score": 0, "creation_date": 1455116641, "post_id": 35307639, "comment_id": 58346008, "body": "&quot;getLabel&quot; and &quot;labelThread&quot; seem useful for printing thread names. I don&#39;t understand why it is obviously a bad idea to label lots of threads (unless there is labeling overhead) and I don&#39;t understand why it is necessary to remove the label. Having lots of threads with labels isn&#39;t really a problem because I only label long running threads like main, GUI, etc. I am trying to re-create a feature from Java that I used for poor man&#39;s multi-threaded debugging: <a href=\"https://groups.google.com/forum/#!topic/haskell-cafe/5b_myuBoU8o\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/haskell-cafe/5b_myuBoU8o</a>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "edited": false, "score": 0, "creation_date": 1455119556, "post_id": 35307639, "comment_id": 58348364, "body": "it can be a bad name because the way I demonstrated it will keep those names in the list - so if you have really lots the list gets longer which means more memory and - what is probably worse - <code>lookup</code> might take to long - to counter this you could use <code>Map</code> and the other problem is lessened if you &quot;dispose&quot; it at the end of the thread as I tried to show in <code>forkLabeledIO</code>"}, {"owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "edited": false, "score": 0, "creation_date": 1455120252, "post_id": 35307639, "comment_id": 58348896, "body": "Oh, I see what you&#39;re doing. You&#39;re adding the &quot;(ThreadId, String)&quot; tuples to the IO state monad and it gets bigger every time you call &quot;labelThread&quot;. In practice I don&#39;t think that it&#39;s a problem because in Java I always named a thread once and only once - at its start of execution - and I only named the long running threads. Like I said, this is like my second or third day of learning Haskell, but I appreciate it."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "edited": false, "score": 0, "creation_date": 1455120410, "post_id": 35307639, "comment_id": 58349026, "body": "yes exactly! - for learning and testing it is surely no problem - to be honest I am really surprised that you cannot get the in-build <i>label</i>  back out - maybe I am just to stupid to find it though - but I guess someone would have noticed by now"}, {"owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "edited": false, "score": 0, "creation_date": 1455121191, "post_id": 35307639, "comment_id": 58349661, "body": "you&#39;re not stupid. One more thing. The way I normally do multi-threaded debugging... groups.google.com/forum/#!topic/haskell-cafe/5b_myuBoU8o  ... It&#39;s basically just giving each thread a name and make my print line statements provide a thread name and a one or two line stack trace (formatted like a Java exception so that the IDE jumps to the right file when you click on it). I&#39;m kind of 22 years old and don&#39;t have that much experience in Industry. Is that a good way of doing multi-threaded debugging? Because in college it was like my go-to method."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "edited": false, "score": 0, "creation_date": 1455121626, "post_id": 35307639, "comment_id": 58349968, "body": "to be honest I know no good way of debugging multi-threaded programs - it&#39;s always a mess - but yes it&#39;s fine - although you should not really run into the same problems you might know from Java ... have a look at the link to online book I provided - it provides a lot of information, best practices and tool recommendations"}, {"owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "edited": false, "score": 0, "creation_date": 1455131305, "post_id": 35307639, "comment_id": 58356365, "body": "Oh wow, I ordered that book on Amazon yesterday. Anyway, the first thing I&#39;m going to implement in Haskell is my Java style multi-threaded print debugger. Would you like a copy - it&#39;s very useful to use with EclipseFP."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "edited": false, "score": 0, "creation_date": 1455131442, "post_id": 35307639, "comment_id": 58356451, "body": "sure just put it on github or something and post on reddit.com/r/haskell when you are done :D"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 5, "last_activity_date": 1455087937, "last_edit_date": 1455087937, "creation_date": 1455082670, "answer_id": 35307639, "question_id": 35278498, "link": "https://stackoverflow.com/questions/35278498/haskell-get-set-thread-name/35307639#35307639", "title": "Haskell get set thread name", "body": "<p>As I said in a comment you can use <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/GHC-Conc-Sync.html#v:labelThread\" rel=\"noreferrer\"><code>labelThread</code></a> to give the thread a label. Sadly I could not find a way to pull this label back out (all I found was this <a href=\"https://mail.haskell.org/pipermail/ghc-tickets/2014-November/018647.html\" rel=\"noreferrer\">invalid ticket</a> where someone wanted to do just this).</p>\n\n<p>But as descriped in <a href=\"http://chimera.labs.oreilly.com/books/1230000000929/ch15.html#sec_conc_eventlogging\" rel=\"noreferrer\">Parallel and Concurrent Programming in Haskell</a> you can get an event-log view on this:</p>\n\n<p>(straight from there &ndash; I hope nobody minds):</p>\n\n<pre><code>main = do\n  t &lt;- myThreadId\n  labelThread t \"main\"\n  m &lt;- newEmptyMVar\n  t &lt;- forkIO $ putMVar m 'a'\n  labelThread t \"a\"\n  t &lt;- forkIO $ putMVar m 'b'\n  labelThread t \"b\"\n  traceEventIO \"before takeMVar\"\n  takeMVar m\n  takeMVar m\n</code></pre>\n\n<p>You then should compile it with the <code>threaded</code> and <code>eventlog</code> switches set:</p>\n\n<pre><code>ghc mvar4.hs -threaded -eventlog\n</code></pre>\n\n<p>and can call it with <code>+RTS</code> and <code>-l</code>:</p>\n\n<pre><code>./mvar4 +RTS -l\n</code></pre>\n\n<p>Finally you can look at the output with <code>ghc-evetns</code>:</p>\n\n<pre><code>ghc-events show mvar4.eventlog\n</code></pre>\n\n<hr>\n\n<h2>Naive self-implementation</h2>\n\n<p>That seems not to be exactly what you want, so here is a (very basic) example of how you could do it yourself (using just lists and an <code>MVar</code> to keep the association between the <code>ThreadId</code> and its name):</p>\n\n<pre><code>import Control.Concurrent\n\ntype Labels = MVar [(ThreadId, String)]\n\ninitLabels :: IO Labels\ninitLabels = newMVar []\n\nlabelThread :: Labels -&gt; ThreadId -&gt; String -&gt; IO ()\nlabelThread labels threadId label =\n  modifyMVar_ labels (\\assocs -&gt; return $ (threadId, label):assocs)\n\ngetLabel :: Labels -&gt; ThreadId -&gt; IO String\ngetLabel labels threadId = withMVar labels (\\assocs -&gt;\n  case lookup threadId assocs of\n    Just label -&gt; return label\n    Nothing    -&gt; return $ show threadId)\n</code></pre>\n\n<p>and you can use it like this:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  ls &lt;- initLabels\n  myId &lt;- myThreadId\n  getLabel ls myId &gt;&gt;= print\n  labelThread ls myId \"my Thread\"\n  getLabel ls myId &gt;&gt;= print\n</code></pre>\n\n<p>which would get you:</p>\n\n<pre><code>\u03bb&gt; :main\n\"ThreadId 50\"\n\"my Thread\"\n</code></pre>\n\n<p>Obviously this might not be a good idea if you create lots of threads. At the very least you should add something to remove the label again at the end of your thread:</p>\n\n<pre><code>removeLabel :: Labels -&gt; ThreadId -&gt; IO ()\nremoveLabel labels threadId =\n  modifyMVar_ labels (return . filter ((/= threadId) . fst))\n\nforkLabeledIO :: Labels -&gt; String -&gt; IO () -&gt; IO ThreadId\nforkLabeledIO labels label computation = forkIO $ do\n  myId &lt;- myThreadId\n  labelThread labels myId label\n  computation\n  removeLabel labels myId\n</code></pre>\n\n<p>... yeah I know: nasty &ndash; and of course a <code>Map</code> might be a better idea too &ndash; but I hope you get the basic idea</p>\n"}], "owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "accepted_answer_id": 35307639, "answer_count": 1, "score": 3, "last_activity_date": 1455087937, "creation_date": 1454962633, "question_id": 35278498, "link": "https://stackoverflow.com/questions/35278498/haskell-get-set-thread-name", "title": "Haskell get set thread name", "body": "<p>When I print something in Java, I usually append the name of the thread to the print statement so I know what thread is running what print statement. How do I get and set the thread name in Haskell? If I can't set the thread name, how do I make a thread that has a given name?</p>\n\n<p>Note: I usually give my threads descriptive names like \"GUI_thread\", \"main_thread\", \"database_thread\", etc </p>\n"}, {"tags": ["haskell", "cons"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 3, "creation_date": 1454962536, "post_id": 35278382, "comment_id": 58268507, "body": "<i>&quot;<code>:</code> operator appends x to a list xs&quot;</i> - it doesn&#39;t; it appends <code>xs</code> to <code>x</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1403, "user_id": 1748746, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/ZMrp9.png?s=128&g=1", "display_name": "Anthony Raimondo", "link": "https://stackoverflow.com/users/1748746/anthony-raimondo"}, "edited": false, "score": 0, "creation_date": 1537974427, "post_id": 35278473, "comment_id": 91981382, "body": "also worth noting [x] is syntactic sugar for x:[]"}], "tags": [], "owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "is_accepted": true, "score": 5, "last_activity_date": 1454962527, "creation_date": 1454962527, "answer_id": 35278473, "question_id": 35278382, "link": "https://stackoverflow.com/questions/35278382/xxs-pattern-haskell-logic/35278473#35278473", "title": "(x:xs) pattern Haskell logic", "body": "<p>This is just an instance of the general pattern that the constructor for a type is both used to construct elements of that type and to deconstruct.  If you wrote</p>\n\n<pre><code>data MyList a = Empty | Cons a (MyList a)\n</code></pre>\n\n<p>you'd write</p>\n\n<pre><code>maximum' :: (Ord a) =&gt; MyList a -&gt; a  \nmaximum' Empty = error \"maximum of empty list\"  \nmaximum' (Cons x Empty) = x  \nmaximum' (Cons x xs) = max x (maximum' xs)\n</code></pre>\n\n<p>Except that lists are actually defined equivalently to</p>\n\n<pre><code>data [a] = [] | a:as\n</code></pre>\n\n<p>so, just as with other data types, <code>:</code> is used both to construct and to deconstruct nonempty lists.</p>\n"}, {"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 3, "last_activity_date": 1454962556, "creation_date": 1454962556, "answer_id": 35278479, "question_id": 35278382, "link": "https://stackoverflow.com/questions/35278382/xxs-pattern-haskell-logic/35278479#35278479", "title": "(x:xs) pattern Haskell logic", "body": "<p>The cons operator doesn't append, it prepends. That is <code>x : xs</code> produces a list that contains <code>x</code> as its first element and <code>xs</code> as the rest. Therefore the pattern <code>x : xs</code> likewise matches a list with <code>x</code> as the first element and <code>xs</code> as the rest.</p>\n"}], "owner": {"reputation": 323, "user_id": 4611344, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/X6oU3.jpg?s=128&g=1", "display_name": "A_P", "link": "https://stackoverflow.com/users/4611344/a-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1311, "favorite_count": 0, "accepted_answer_id": 35278473, "answer_count": 2, "score": 1, "last_activity_date": 1454962556, "creation_date": 1454962207, "last_edit_date": 1495541805, "question_id": 35278382, "link": "https://stackoverflow.com/questions/35278382/xxs-pattern-haskell-logic", "title": "(x:xs) pattern Haskell logic", "body": "<p>Let's say there is a simple function:</p>\n\n<pre><code>maximum' :: (Ord a) =&gt; [a] -&gt; a  \nmaximum' [] = error \"maximum of empty list\"  \nmaximum' [x] = x  \nmaximum' (x:xs) = max x (maximum' xs)\n</code></pre>\n\n<p>I understand the idea and what (x:xs) does. As it was explained in details here \n<a href=\"https://stackoverflow.com/questions/2191294/what-do-the-parentheses-signify-in-xxs-when-pattern-matching\">What do the parentheses signify in (x:xs) when pattern matching?</a> \nbut there is one little thing that I cannot get out of my head. Since <em>cons</em>: operator appends x to a list xs, <strong>why is it that x is the first element of function argument list and xs is the tail when we use (x:xs)???</strong> as if (x:xs) calls head and tail on argument list.    </p>\n"}, {"tags": ["list", "haskell", "recursion", "negation"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4108433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53214e243ee4e0aba3b7fda7711f2a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Fraxax", "link": "https://stackoverflow.com/users/4108433/fraxax"}, "edited": false, "score": 0, "creation_date": 1454956272, "post_id": 35276676, "comment_id": 58264907, "body": "Ah I see now. Thanks very much for the response!"}], "tags": [], "owner": {"reputation": 1209, "user_id": 2738025, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LSnV8.png?s=128&g=1", "display_name": "castle-bravo", "link": "https://stackoverflow.com/users/2738025/castle-bravo"}, "is_accepted": true, "score": 3, "last_activity_date": 1454956115, "creation_date": 1454956115, "answer_id": 35276676, "question_id": 35276592, "link": "https://stackoverflow.com/questions/35276592/trying-to-understand-recursion-through-a-list-of-integers/35276676#35276676", "title": "Trying to understand recursion through a list of integers", "body": "<p>Try using the <code>cons</code> operator <code>:</code> to put the negated number at the front of the list.</p>\n\n<pre><code>negation (x:xs) = -x : negation xs\n</code></pre>\n\n<p>If you do that, you can get rid of the third line.</p>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 2, "last_activity_date": 1454958448, "last_edit_date": 1454958448, "creation_date": 1454957264, "answer_id": 35277010, "question_id": 35276592, "link": "https://stackoverflow.com/questions/35276592/trying-to-understand-recursion-through-a-list-of-integers/35277010#35277010", "title": "Trying to understand recursion through a list of integers", "body": "<p>Well, the best way to write your function is this:</p>\n\n<pre><code>negation :: [Int] -&gt; [Int]\nnegation xs = map negate xs\n\n{- Example:\n\n&gt;&gt;&gt; map negate [1..5]\n[-1,-2,-3,-4,-5]\n-}\n</code></pre>\n\n<p><strong>Exercise:</strong> write your own version of <code>map</code>:</p>\n\n<pre><code>myMap :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmyMap _ [] = _fillMeIn\nmyMap f (x:xs) = _fillMeIn\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126, "user_id": 5766031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-APTQZlmDZaQ/AAAAAAAAAAI/AAAAAAAAAG4/u-iOSDRTsOo/photo.jpg?sz=128", "display_name": "Zacharie 007", "link": "https://stackoverflow.com/users/5766031/zacharie-007"}, "is_accepted": false, "score": 0, "last_activity_date": 1454960969, "last_edit_date": 1454960969, "creation_date": 1454960647, "answer_id": 35277964, "question_id": 35276592, "link": "https://stackoverflow.com/questions/35276592/trying-to-understand-recursion-through-a-list-of-integers/35277964#35277964", "title": "Trying to understand recursion through a list of integers", "body": "<p>Simple with map:</p>\n\n<pre><code>  Prelude&gt; let negatList= map (*(-1))\n</code></pre>\n\n<p>Examples:</p>\n\n<pre><code>  Prelude&gt; negatList []\n  []\n  Prelude&gt; negatList [1]\n  [-1]\n</code></pre>\n\n<p>With recursion:</p>\n\n<pre><code> negation :: [Int] -&gt; [Int]\n negation [] = []\n negation(x:xs) = -x:negation xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1690, "user_id": 5691928, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/pm6iL.jpg?s=128&g=1", "display_name": "Ratan Senapathy", "link": "https://stackoverflow.com/users/5691928/ratan-senapathy"}, "is_accepted": false, "score": 0, "last_activity_date": 1454997426, "creation_date": 1454997426, "answer_id": 35284898, "question_id": 35276592, "link": "https://stackoverflow.com/questions/35276592/trying-to-understand-recursion-through-a-list-of-integers/35284898#35284898", "title": "Trying to understand recursion through a list of integers", "body": "<p>As mentioned in an answer before, the best way is to use higher order functions as follows</p>\n\n<pre><code>negation xs = map negate xs\n</code></pre>\n\n<p>Always use higher order functions whenever possible. It is one of the general Haskell programming guidelines present on wiki.haskell.org and it simplifies your code.</p>\n"}], "owner": {"reputation": 15, "user_id": 4108433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53214e243ee4e0aba3b7fda7711f2a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Fraxax", "link": "https://stackoverflow.com/users/4108433/fraxax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 35276676, "answer_count": 4, "score": 0, "last_activity_date": 1454997426, "creation_date": 1454955814, "question_id": 35276592, "link": "https://stackoverflow.com/questions/35276592/trying-to-understand-recursion-through-a-list-of-integers", "title": "Trying to understand recursion through a list of integers", "body": "<p>I am currently learning how to use recursion in Haskell and I am trying to understand how to go through every element in a list of integers and negate them. So far I can do this but only on the final element of the list so I know that the error lies in the last line. What is the best way to go through every element in a list rather than just the final one? </p>\n\n<pre><code>negation :: [Int] -&gt; [Int]\nnegation [] = []\nnegation [n] = [-n]\nnegation(x:xs) = negation xs\n</code></pre>\n"}, {"tags": ["haskell", "memory", "sieve"], "comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 0, "creation_date": 1454956294, "post_id": 35276507, "comment_id": 58264914, "body": "Ur numbers do not match <a href=\"https://oeis.org/A000010\" rel=\"nofollow noreferrer\">oeis.org/A000010</a>"}, {"owner": {"reputation": 1209, "user_id": 2738025, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LSnV8.png?s=128&g=1", "display_name": "castle-bravo", "link": "https://stackoverflow.com/users/2738025/castle-bravo"}, "reply_to_user": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 0, "creation_date": 1454959104, "post_id": 35276507, "comment_id": 58266493, "body": "Ah, good catch. <code>applyEvery</code> should take <code>(j - 1)</code> instead of <code>j</code>. I&#39;ve updated the question."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1454961627, "post_id": 35276507, "comment_id": 58267959, "body": "Be sure to read the performance section of the haskell tag info page: <a href=\"http://stackoverflow.com/tags/haskell/info\">stackoverflow.com/tags/haskell/info</a>"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1454965316, "post_id": 35276507, "comment_id": 58270070, "body": "&quot;When computing totientSum n for n above 40000, ghci takes ages to evaluate and starts consuming tremendous amounts of memory.&quot; There is your problem, you are running code in GHCI and expecting it to be performant. This will almost never ever happen. If you want good performance, you must compile with optimizations."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1454965432, "post_id": 35276507, "comment_id": 58270153, "body": "Otherwise, the <code>applyEvery</code> function will be a source of inefficiency. Instead you can store a map of which things must be &quot;applied&quot; next. This approach along with many others is covered <a href=\"https://wiki.haskell.org/Prime_numbers\" rel=\"nofollow noreferrer\">here</a>."}], "answers": [{"tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": true, "score": 2, "last_activity_date": 1454978383, "last_edit_date": 1454978383, "creation_date": 1454971619, "answer_id": 35280831, "question_id": 35276507, "link": "https://stackoverflow.com/questions/35276507/totient-function-generating-sieve-consuming-too-much-memory/35280831#35280831", "title": "Totient-function generating sieve consuming too much memory", "body": "<p>In implementing <a href=\"https://en.wikipedia.org/wiki/Euler%27s_totient_function#Euler.27s_product_formula\" rel=\"nofollow noreferrer\">Euler product formula</a>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/oHhFv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oHhFv.png\" alt=\"Euler product formula\"></a></p>\n\n<p>you can take advantage of the fact that you are calculating Euler Phi numbers for all the numbers in the range <code>[1..n]</code></p>\n\n<p>Doing so, you may first find all the primes in the range <code>[1..n]</code> and then <em>instead of finding prime divisors of each number, find all the multiples of each prime number</em>. Obviously, the latter can be done much more efficiently.</p>\n\n<p>A possible implementation would be:</p>\n\n<pre><code>import Data.Int (Int64)\nimport Control.Applicative ((&lt;$&gt;))\nimport Data.Array.Unboxed (UArray, elems, accum, listArray)\n\nprimes :: Integral a =&gt; [a]\nprimes = 2: 3: filter pred (chain [5,11..] [7,13..])\n    where\n    chain (x:xs) (y:ys) = x: y: chain xs ys\n    pred a = all (\\i -&gt; a `mod` i /= 0) $ takeWhile (\\i -&gt; i * i &lt;= a) primes\n\neuler_phi :: Int64 -&gt; [Int64]\neuler_phi n = elems $ accum (\\a p -&gt; a - a `div` p) arr inc\n    where\n    val = takeWhile (&lt;= n) primes\n    idx = map (\\i -&gt; takeWhile (&lt;= n) [i,2 * i..]) val\n\n    inc = concat $ zipWith (\\i j -&gt; ($j) &lt;$&gt; (,) &lt;$&gt; i) idx val\n    arr = listArray (1, n) [1..n] :: UArray Int64 Int64\n\nmain = getLine &gt;&gt;= print . sum . euler_phi . read\n</code></pre>\n\n<p>then:</p>\n\n<pre><code>\\&gt; euler_phi 20\n[1,1,2,2,4,2,6,4,6,4,10,4,12,6,8,8,16,6,18,8]\n</code></pre>\n\n<p>would be <a href=\"https://en.wikipedia.org/wiki/Euler&#39;s_totient_function#Some_values_of_the_function\" rel=\"nofollow noreferrer\">Euler totient function for the first 20 numbers</a>; and if you <em>compile with <code>-O2</code> flag</em> you may calculate the cumulative sums with a pretty decent performance:</p>\n\n<pre class=\"lang-bsh prettyprint-override\"><code>$ ghc --make -O2 euler_phi.hs\n[1 of 1] Compiling Main             ( euler_phi.hs, euler_phi.o )\nLinking euler_phi ...\n\n$ time echo 40000 | ./euler_phi\n486345716\n\nreal    0m0.091s\nuser    0m0.040s\nsys     0m0.006s\n</code></pre>\n"}], "owner": {"reputation": 1209, "user_id": 2738025, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LSnV8.png?s=128&g=1", "display_name": "castle-bravo", "link": "https://stackoverflow.com/users/2738025/castle-bravo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 1, "accepted_answer_id": 35280831, "answer_count": 1, "score": 1, "last_activity_date": 1454978383, "creation_date": 1454955536, "last_edit_date": 1454967634, "question_id": 35276507, "link": "https://stackoverflow.com/questions/35276507/totient-function-generating-sieve-consuming-too-much-memory", "title": "Totient-function generating sieve consuming too much memory", "body": "<p>I have written a sieve-based generator for the list of totients, and want to take the sum up to 1000000. </p>\n\n<pre><code>applyEvery :: (a -&gt; a) -&gt; Int -&gt; [a] -&gt; [a]\napplyEvery f n xs = xf ++ (\\(y:ys) -&gt; f y : applyEvery f n ys) xb\n  where\n    (xf, xb) = splitAt (n - 1) xs\n\ntotients :: [Int]\ntotients = 1 : sieve [2..] [2..]\n  where \n    sieve (x:xs) (y:ys) \n        | x == y    = (y - 1) : sieve xs (propagatePrime x ys)  \n        | otherwise = y : sieve xs ys\n    propagatePrime j = applyEvery (\\x -&gt; (quot x j)*(j - 1)) j\n\ntotientSum :: Int -&gt; Int\ntotientSum n = sum $ take n totients\n</code></pre>\n\n<p>When computing <code>totientSum n</code> for <code>n</code> above 40000, ghci takes ages to evaluate and starts consuming tremendous amounts of memory. Compiling to an executable doesn't help. I assume that this has something to do with the way Haskell handles lazy evaluation.</p>\n\n<p>I would like to know if it's possible to selectively apply strictness to improve memory consumption of the above functions so that I can compute the totient sum up to 1000000. I would also like to know if there's a better way to do this using lists, or if I should use a random-access data structure. If you know of a faster algorithm for computing the totient sum, please share a reference.</p>\n\n<p>I thought that the definition of <code>applyEvery</code> might make a difference, so I tried the following other implementations, but they both seemed to consume more memory than the definition used above.</p>\n\n<pre><code>-- &lt;https://www.reddit.com/2tpqip/&gt;\napplyEvery' :: (a -&gt; a) -&gt; Int -&gt; [a] -&gt; [a]\napplyEvery' f n = zipWith ($) (cycle (replicate (n - 1) id ++ [f]))\n\napplyEvery'' :: (a -&gt; a) -&gt; Int -&gt; [a] -&gt; [a]\napplyEvery'' f n xs = xf ++ (\\(y:ys) -&gt; f y : applyEvery'' f n ys) xb\n  where\n    xf = take (n - 1) xs\n    xb = drop (n - 1) xs\n</code></pre>\n"}, {"tags": ["haskell", "cabal", "cabal-install", "haskell-platform", "haskell-stack"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1454953705, "post_id": 35275975, "comment_id": 58263553, "body": "The error in <code>src&#47;Data&#47;Binary&#47;Get&#47;Internal.hs</code> shows that the upper bound in <code>binary</code> on <code>base</code> is probably wrong. Any reason why you don&#39;t want to use a more recent version of GHC/cabal? Also note that your version of Cabal does not support sandboxes, you probably want to use <code>cabal-dev</code> in order to not shoot yourself in the foot."}, {"owner": {"reputation": 11, "user_id": 3554574, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h4mTq.jpg?s=128&g=1", "display_name": "siuling_88", "link": "https://stackoverflow.com/users/3554574/siuling-88"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1454954126, "post_id": 35275975, "comment_id": 58263797, "body": "Precisely I want update my library, and use cabal 1.22.7.0 (the current version), I have that version because haskell platform contains by default 1.16.0.2 in my case..."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1454958441, "post_id": 35275975, "comment_id": 58266089, "body": "Remark: <code>update</code> is usually annotated with only getting new information (e.g. &quot;update your package list&quot;, e.g. <code>cabal update</code> or <code>apt-get update</code>), since you&#39;re getting your lists and info <i>up</i> to <i>date</i>. Actually changing to a newer version is usually called upgrade nowadays (e.g. <code>apt-get upgrade</code>). That being said, you could change to <a href=\"https://www.haskell.org/platform/mac.html\" rel=\"nofollow noreferrer\">7.10.3</a> with a newer platform release."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 3554574, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h4mTq.jpg?s=128&g=1", "display_name": "siuling_88", "link": "https://stackoverflow.com/users/3554574/siuling-88"}, "edited": false, "score": 0, "creation_date": 1454958988, "post_id": 35276288, "comment_id": 58266423, "body": "I can&#39;t prove the issue you found... because...   cabal configure --enable-tests --enable-benchmarks  \t\tResolving dependencies... \t\tConfiguring binary-0.8.2.0... \t\tcabal: At least the following dependencies are missing: \t\tCabal ==1.22.*, \t\tcriterion ==1.*, \t\ttar -any, \t\ttest-framework -any, \t\ttest-framework-quickcheck2 &gt;=0.3  and I dont have, Cabal 1.22... and I cant use the tool for install cabal or update the library, I guess I must download the recent Haskell Platform and then &quot;switch&quot; the version of ghc... what do you think?  PD: I&#39;m a newbie with haskell/cabal &gt;.&lt;"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 11, "user_id": 3554574, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h4mTq.jpg?s=128&g=1", "display_name": "siuling_88", "link": "https://stackoverflow.com/users/3554574/siuling-88"}, "edited": false, "score": 0, "creation_date": 1454960823, "post_id": 35276288, "comment_id": 58267472, "body": "You already demonstrated it in your original question. I just copied and pasted the actual error from what you posted. I guess that binary has additional dependencies when you configure it with <code>--enable-tests --enable-benchmarks</code>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1454965604, "post_id": 35276288, "comment_id": 58270260, "body": "This bug has been around for <i>ages</i>. I first remember encountering it about three years ago. I think apple had just released a new operating system on which, for the first time, the default <code>gcc&#39; executable was really a symlink to </code>clang&#39;. Sometimes it is unfortunate how little library maintainers care about multi platform compatibility."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 2, "last_activity_date": 1454954733, "creation_date": 1454954733, "answer_id": 35276288, "question_id": 35275975, "link": "https://stackoverflow.com/questions/35275975/a-lot-of-errors-during-cabal-update-and-finally-doesnt-work/35276288#35276288", "title": "A lot of errors during cabal update and finally doesn&#39;t work", "body": "<p>It's just a bug in binary-0.8.2.0.</p>\n\n<pre><code>src/Data/Binary/Get/Internal.hs:403:3:\n     error: invalid preprocessing directive\n     #-}\n      ^\n</code></pre>\n\n<p><code>src/Data/Binary/Get/Internal.hs</code> has a line that starts with <code>#</code>, which clang's C preprocessor doesn't like. gcc is fine with it, but on a Mac Apple's gcc is really clang.</p>\n\n<p>That line is <a href=\"http://hdiff.luite.com/cgit/binary/diff/src/Data/Binary/Get/Internal.hs?id=8a0d0f8ea63278be100bcd7a58c8383542cbabf3\" rel=\"nofollow\">new in binary-0.8.0.0</a>, which was released Dec 20. Still odd that apparently no one else encountered this yet.</p>\n\n<p>I filed an <a href=\"https://github.com/kolmodin/binary/issues/105\" rel=\"nofollow\">issue</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1454981834, "post_id": 35279559, "comment_id": 58276347, "body": "Why would newer versions of GHC not have the same issue? Isn&#39;t feeding the input to CPP pretty much the first thing that every version of GHC does?"}, {"owner": {"reputation": 456, "user_id": 21074, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/df27a60f48d1aa274c4784cc394d3110?s=128&d=identicon&r=PG", "display_name": "L. Kolmodin", "link": "https://stackoverflow.com/users/21074/l-kolmodin"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1455110412, "post_id": 35279559, "comment_id": 58341424, "body": "IIRC GHC stopped relying on clang/gcc for CPP a couple of releases ago. I might not remember correctly though."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1455117531, "post_id": 35279559, "comment_id": 58346697, "body": "There was a big discussion about that a while ago, but it hasn&#39;t happened yet."}], "tags": [], "owner": {"reputation": 456, "user_id": 21074, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/df27a60f48d1aa274c4784cc394d3110?s=128&d=identicon&r=PG", "display_name": "L. Kolmodin", "link": "https://stackoverflow.com/users/21074/l-kolmodin"}, "is_accepted": false, "score": 0, "last_activity_date": 1454966476, "creation_date": 1454966476, "answer_id": 35279559, "question_id": 35275975, "link": "https://stackoverflow.com/questions/35275975/a-lot-of-errors-during-cabal-update-and-finally-doesnt-work/35279559#35279559", "title": "A lot of errors during cabal update and finally doesn&#39;t work", "body": "<p>It's the result of using an old GHC version with modern clang (which comes with your modern Mac OS X).\nGHC uses clang for CPP, and clang is not very understanding about its input.</p>\n\n<p>Newer GHCs don't have this issue, which explains why it hasn't been found and fixed until now.</p>\n\n<p>The <a href=\"https://github.com/kolmodin/binary/issues/105\" rel=\"nofollow\">issue was reported</a> on github. I've fixed it and pushed <code>binary-0.8.2.1</code>. Run <code>cabal update</code> and try again.</p>\n\n<p><a href=\"https://github.com/kolmodin/binary/issues/new\" rel=\"nofollow\">Let me know</a> if you run into any other issues with <code>binary</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 456, "user_id": 21074, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/df27a60f48d1aa274c4784cc394d3110?s=128&d=identicon&r=PG", "display_name": "L. Kolmodin", "link": "https://stackoverflow.com/users/21074/l-kolmodin"}, "edited": false, "score": 0, "creation_date": 1455297414, "post_id": 35329228, "comment_id": 58442906, "body": "As noted in my comment, try the new binary-0.8.2.1."}], "tags": [], "owner": {"reputation": 11, "user_id": 3554574, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h4mTq.jpg?s=128&g=1", "display_name": "siuling_88", "link": "https://stackoverflow.com/users/3554574/siuling-88"}, "is_accepted": false, "score": 0, "last_activity_date": 1455154131, "last_edit_date": 1495539914, "creation_date": 1455154131, "answer_id": 35329228, "question_id": 35275975, "link": "https://stackoverflow.com/questions/35275975/a-lot-of-errors-during-cabal-update-and-finally-doesnt-work/35329228#35329228", "title": "A lot of errors during cabal update and finally doesn&#39;t work", "body": "<p>In conclusion, it can not use the latest version of cabal 1.22.07 with an older version of GHC 7.6.3,because</p>\n\n<blockquote>\n  <p>It's just a bug in binary-0.8.2.0.</p>\n</blockquote>\n\n<pre><code>src/Data/Binary/Get/Internal.hs:403:3:\n error: invalid preprocessing directive\n #-}\n  ^\n</code></pre>\n\n<blockquote>\n  <p>src/Data/Binary/Get/Internal.hs has a line that starts with #, which clang's C preprocessor doesn't like. gcc is fine with it, but on a Mac Apple's gcc is really clang.</p>\n  \n  <p>by <a href=\"https://stackoverflow.com/users/190376/reid-barton\">Reid Barton</a></p>\n</blockquote>\n\n<p>and important to know...</p>\n\n<blockquote>\n  <p>GHC uses clang for CPP, and clang is not very understanding about its input.\n  Newer GHCs don't have this issue, which explains why it hasn't been found and fixed until now.</p>\n  \n  <p>The <a href=\"https://github.com/kolmodin/binary/issues/105\" rel=\"nofollow noreferrer\">issue was reported</a> on github. </p>\n  \n  <p>by <a href=\"https://stackoverflow.com/users/21074/l-kolmodin\">L. Kolmodin</a></p>\n</blockquote>\n\n<p>Thanks for every answer.</p>\n\n<p>PD: I could install GHC 7.6.3 and Cabal 1.22.07 using Debian... >.&lt;</p>\n"}], "owner": {"reputation": 11, "user_id": 3554574, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h4mTq.jpg?s=128&g=1", "display_name": "siuling_88", "link": "https://stackoverflow.com/users/3554574/siuling-88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 35276288, "answer_count": 3, "score": 1, "last_activity_date": 1455154131, "creation_date": 1454953493, "question_id": 35275975, "link": "https://stackoverflow.com/questions/35275975/a-lot-of-errors-during-cabal-update-and-finally-doesnt-work", "title": "A lot of errors during cabal update and finally doesn&#39;t work", "body": "<p>first of all thanks for the help you can bring me to solve my disaster with cabal xD...</p>\n\n<p>I'm working with OS X El Capitan 10.11.3, 64 bits.</p>\n\n<p>I installed Haskell platform from <a href=\"https://www.haskell.org/platform/prior.html\" rel=\"nofollow\">https://www.haskell.org/platform/prior.html</a> of 2013.2.0.0, May 2013, specially because i need to work with ghc 7.6.3 </p>\n\n<p>Then when I execute cabal update... my headache starts...</p>\n\n<pre><code>Resolving dependencies...\nConfiguring binary-0.8.2.0...\n\n/var/folders/3l/wflf71t55t92rrvt8lhx_8700000gn/T/10157.c:1:12:\n     warning: control reaches end of non-void function [-Wreturn-type]\nint foo() {}\n           ^\n1 warning generated.\nBuilding binary-0.8.2.0...\nPreprocessing library binary-0.8.2.0...\n\nsrc/Data/Binary.hs:198:43:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- This is just a convenience function, it's defined simply as:\n                                          ^\n\nsrc/Data/Binary.hs:253:35:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- This mechanism makes use of GHC's efficient built-in generics\n                                  ^\n2 warnings generated.\n\nsrc/Data/Binary/Put.hs:110:26:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n                    PairS x w' = unPut k\n                             ^\n\nsrc/Data/Binary/Put.hs:111:42:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n                in PairS (f x) (w `mappend` w')\n                                             ^\n\nsrc/Data/Binary/Put.hs:115:26:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n                    PairS b w' = unPut k\n                             ^\n\nsrc/Data/Binary/Put.hs:116:38:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n                in PairS b (w `mappend` w')\n                                         ^\n\nsrc/Data/Binary/Put.hs:123:22:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n                PairS b w' = unPut (k a)\n                         ^\n\nsrc/Data/Binary/Put.hs:124:34:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n            in PairS b (w `mappend` w')\n                                     ^\n\nsrc/Data/Binary/Put.hs:257:64:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- written in host order, host endian form, for the machine you're on.\n                                                               ^\n\nsrc/Data/Binary/Put.hs:286:64:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- written in host order, host endian form, for the machine you're on.\n                                                               ^\n8 warnings generated.\n\nsrc/Data/Binary/Get.hs:26:7:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- Let's decode binary data representing illustrated here.\n      ^\n\nsrc/Data/Binary/Get.hs:43:71:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- The fields in @Trade@ are marked as strict (using @!@) since we don't need\n                                                                      ^\n\nsrc/Data/Binary/Get.hs:48:12:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- Now, let's have a look at a decoder for this format.\n           ^\n\nsrc/Data/Binary/Get.hs:62:20:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n--getTrade' :: 'Get' Trade\n                   ^\n\nsrc/Data/Binary/Get.hs:63:79:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n--getTrade' = Trade '&lt;$&gt;' 'getWord32le' '&lt;*&gt;' 'getWord32le' '&lt;*&gt;' 'getWord16le'\n                                                                              ^\n\nsrc/Data/Binary/Get.hs:70:7:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- Let's first define a function that decodes many @Trade@s.\n      ^\n\nsrc/Data/Binary/Get.hs:88:27:\n     warning: missing terminating '\"' character [-Winvalid-pp-token]\n--  input &lt;- BL.readFile \\\"trades.bin\\\"\n                          ^\n\nsrc/Data/Binary/Get.hs:235:64:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- The lazy interface consumes a single lazy 'L.ByteString'. It's the easiest\n                                                               ^\n\nsrc/Data/Binary/Get.hs:236:47:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- interface to get started with, but it doesn't support interleaving I\\/O and\n                                              ^\n\nsrc/Data/Binary/Get.hs:298:23:\n     warning: missing terminating ' character [-Winvalid-pp-token]\nrunGetState g lbs0 pos' = go (runGetIncremental g) lbs0\n                      ^\n\nsrc/Data/Binary/Get.hs:300:53:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n      go (Done s pos a) lbs = (a, L.chunk s lbs, pos+pos')\n                                                        ^\n\nsrc/Data/Binary/Get.hs:570:53:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- host order, host endian form, for the machine you're on. On a 64 bit\n                                                    ^\n12 warnings generated.\n\nsrc/Data/Binary/Get/Internal.hs:157:22:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- | Make sure we don't have to pass Nothing to a Partial twice.\n                     ^\n\nsrc/Data/Binary/Get/Internal.hs:158:19:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- This way we don't need to pass around an EOF value in the Get monad, it\n                  ^\n\nsrc/Data/Binary/Get/Internal.hs:180:63:\n     warning: missing terminating ' character [-Winvalid-pp-token]\nprompt inp kf ks = prompt' kf (\\inp' -&gt; ks (inp `B.append` inp'))\n                                                              ^\n\nsrc/Data/Binary/Get/Internal.hs:182:7:\n     warning: missing terminating ' character [-Winvalid-pp-token]\nprompt' :: Decoder a -&gt; (B.ByteString -&gt; Decoder a) -&gt; Decoder a\n      ^\n\nsrc/Data/Binary/Get/Internal.hs:183:7:\n     warning: missing terminating ' character [-Winvalid-pp-token]\nprompt' kf ks =\n      ^\n\nsrc/Data/Binary/Get/Internal.hs:221:21:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n                let (inp', out) = B.splitAt n str\n                        ^\n\nsrc/Data/Binary/Get/Internal.hs:222:31:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n                in k out (Just inp')\n                                  ^\n\nsrc/Data/Binary/Get/Internal.hs:240:17:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n          Left state' -&gt; do\n                    ^\n\nsrc/Data/Binary/Get/Internal.hs:241:16:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n            let acc' = inp : acc\n                   ^\n\nsrc/Data/Binary/Get/Internal.hs:242:15:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n            prompt'\n                  ^\n\nsrc/Data/Binary/Get/Internal.hs:243:40:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n              (runCont (onFail (reverse acc')) B.empty ks)\n                                           ^\n\nsrc/Data/Binary/Get/Internal.hs:284:72:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- Once it's finished, return the final decoder (always 'Done' or 'Fail'),\n                                                                       ^\n\nsrc/Data/Binary/Get/Internal.hs:327:8:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n      let g' = maybe (Left ()) Right &lt;$&gt; g\n           ^\n\nsrc/Data/Binary/Get/Internal.hs:328:47:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n      either (const Nothing) Just &lt;$&gt; lookAheadE g'\n                                                  ^\n\nsrc/Data/Binary/Get/Internal.hs:403:3:\n     error: invalid preprocessing directive\n     #-}\n      ^\n\nsrc/Data/Binary/Get/Internal.hs:412:64:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n      where -- might look a bit funny, but plays very well with GHC's inliner.\n                                                                   ^\n\nsrc/Data/Binary/Get/Internal.hs:413:19:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n            -- GHC won't inline recursive functions, so we make ensureN non-recursive\n                      ^\n16 warnings and 1 error generated.\nFailed to install binary-0.8.2.0\ncabal: Error: some packages failed to install:\nCabal-1.22.7.0 depends on binary-0.8.2.0 which failed to install.\nbinary-0.8.2.0 failed during the building phase. The exception was:\nExitFailure 1\ncabal-install-1.22.8.0 depends on binary-0.8.2.0 which failed to install.\n</code></pre>\n\n<p>and then... I try install binary and...</p>\n\n<pre><code>Resolving dependencies...\nConfiguring binary-0.8.2.0...\n\n/var/folders/3l/wflf71t55t92rrvt8lhx_8700000gn/T/10204.c:1:12:\n     warning: control reaches end of non-void function [-Wreturn-type]\nint foo() {}\n           ^\n1 warning generated.\nBuilding binary-0.8.2.0...\nPreprocessing library binary-0.8.2.0...\n\nsrc/Data/Binary.hs:198:43:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- This is just a convenience function, it's defined simply as:\n                                          ^\n\nsrc/Data/Binary.hs:253:35:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- This mechanism makes use of GHC's efficient built-in generics\n                                  ^\n2 warnings generated.\n\nsrc/Data/Binary/Put.hs:110:26:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n                    PairS x w' = unPut k\n                             ^\n\nsrc/Data/Binary/Put.hs:111:42:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n                in PairS (f x) (w `mappend` w')\n                                             ^\n\nsrc/Data/Binary/Put.hs:115:26:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n                    PairS b w' = unPut k\n                             ^\n\nsrc/Data/Binary/Put.hs:116:38:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n                in PairS b (w `mappend` w')\n                                         ^\n\nsrc/Data/Binary/Put.hs:123:22:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n                PairS b w' = unPut (k a)\n                         ^\n\nsrc/Data/Binary/Put.hs:124:34:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n            in PairS b (w `mappend` w')\n                                     ^\n\nsrc/Data/Binary/Put.hs:257:64:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- written in host order, host endian form, for the machine you're on.\n                                                               ^\n\nsrc/Data/Binary/Put.hs:286:64:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- written in host order, host endian form, for the machine you're on.\n                                                               ^\n8 warnings generated.\n\nsrc/Data/Binary/Get.hs:26:7:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- Let's decode binary data representing illustrated here.\n      ^\n\nsrc/Data/Binary/Get.hs:43:71:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- The fields in @Trade@ are marked as strict (using @!@) since we don't need\n                                                                      ^\n\nsrc/Data/Binary/Get.hs:48:12:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- Now, let's have a look at a decoder for this format.\n           ^\n\nsrc/Data/Binary/Get.hs:62:20:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n--getTrade' :: 'Get' Trade\n                   ^\n\nsrc/Data/Binary/Get.hs:63:79:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n--getTrade' = Trade '&lt;$&gt;' 'getWord32le' '&lt;*&gt;' 'getWord32le' '&lt;*&gt;' 'getWord16le'\n                                                                              ^\n\nsrc/Data/Binary/Get.hs:70:7:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- Let's first define a function that decodes many @Trade@s.\n      ^\n\nsrc/Data/Binary/Get.hs:88:27:\n     warning: missing terminating '\"' character [-Winvalid-pp-token]\n--  input &lt;- BL.readFile \\\"trades.bin\\\"\n                          ^\n\nsrc/Data/Binary/Get.hs:235:64:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- The lazy interface consumes a single lazy 'L.ByteString'. It's the easiest\n                                                               ^\n\nsrc/Data/Binary/Get.hs:236:47:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- interface to get started with, but it doesn't support interleaving I\\/O and\n                                              ^\n\nsrc/Data/Binary/Get.hs:298:23:\n     warning: missing terminating ' character [-Winvalid-pp-token]\nrunGetState g lbs0 pos' = go (runGetIncremental g) lbs0\n                      ^\n\nsrc/Data/Binary/Get.hs:300:53:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n      go (Done s pos a) lbs = (a, L.chunk s lbs, pos+pos')\n                                                        ^\n\nsrc/Data/Binary/Get.hs:570:53:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- host order, host endian form, for the machine you're on. On a 64 bit\n                                                    ^\n12 warnings generated.\n\nsrc/Data/Binary/Get/Internal.hs:157:22:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- | Make sure we don't have to pass Nothing to a Partial twice.\n                     ^\n\nsrc/Data/Binary/Get/Internal.hs:158:19:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- This way we don't need to pass around an EOF value in the Get monad, it\n                  ^\n\nsrc/Data/Binary/Get/Internal.hs:180:63:\n     warning: missing terminating ' character [-Winvalid-pp-token]\nprompt inp kf ks = prompt' kf (\\inp' -&gt; ks (inp `B.append` inp'))\n                                                              ^\n\nsrc/Data/Binary/Get/Internal.hs:182:7:\n     warning: missing terminating ' character [-Winvalid-pp-token]\nprompt' :: Decoder a -&gt; (B.ByteString -&gt; Decoder a) -&gt; Decoder a\n      ^\n\nsrc/Data/Binary/Get/Internal.hs:183:7:\n     warning: missing terminating ' character [-Winvalid-pp-token]\nprompt' kf ks =\n      ^\n\nsrc/Data/Binary/Get/Internal.hs:221:21:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n                let (inp', out) = B.splitAt n str\n                        ^\n\nsrc/Data/Binary/Get/Internal.hs:222:31:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n                in k out (Just inp')\n                                  ^\n\nsrc/Data/Binary/Get/Internal.hs:240:17:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n          Left state' -&gt; do\n                    ^\n\nsrc/Data/Binary/Get/Internal.hs:241:16:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n            let acc' = inp : acc\n                   ^\n\nsrc/Data/Binary/Get/Internal.hs:242:15:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n            prompt'\n                  ^\n\nsrc/Data/Binary/Get/Internal.hs:243:40:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n              (runCont (onFail (reverse acc')) B.empty ks)\n                                           ^\n\nsrc/Data/Binary/Get/Internal.hs:284:72:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n-- Once it's finished, return the final decoder (always 'Done' or 'Fail'),\n                                                                       ^\n\nsrc/Data/Binary/Get/Internal.hs:327:8:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n      let g' = maybe (Left ()) Right &lt;$&gt; g\n           ^\n\nsrc/Data/Binary/Get/Internal.hs:328:47:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n      either (const Nothing) Just &lt;$&gt; lookAheadE g'\n                                                  ^\n\nsrc/Data/Binary/Get/Internal.hs:403:3:\n     error: invalid preprocessing directive\n     #-}\n      ^\n\nsrc/Data/Binary/Get/Internal.hs:412:64:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n      where -- might look a bit funny, but plays very well with GHC's inliner.\n                                                                   ^\n\nsrc/Data/Binary/Get/Internal.hs:413:19:\n     warning: missing terminating ' character [-Winvalid-pp-token]\n            -- GHC won't inline recursive functions, so we make ensureN non-recursive\n                      ^\n16 warnings and 1 error generated.\nFailed to install binary-0.8.2.0\ncabal: Error: some packages failed to install:\nbinary-0.8.2.0 failed during the building phase. The exception was:\nExitFailure 1\n</code></pre>\n\n<ul>\n<li><p>my ghc --version is \n<em>The Glorious Glasgow Haskell Compilation System, version 7.6.3</em></p></li>\n<li><p>my cabal --version is \n<em>cabal-install version 1.16.0.2\nusing version 1.16.0 of the Cabal library</em></p></li>\n</ul>\n\n<p>Thanks for the attention.</p>\n"}, {"tags": ["haskell", "frp", "reactive-banana"], "answers": [{"comments": [{"owner": {"reputation": 243, "user_id": 1206302, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0ac9ec73f8186f7f18f203e3620278d8?s=128&d=identicon&r=PG", "display_name": "cies", "link": "https://stackoverflow.com/users/1206302/cies"}, "edited": false, "score": 0, "creation_date": 1454953759, "post_id": 35275497, "comment_id": 58263593, "body": "This worked like a charm. I was already quite a bit in this direction, but I got stuck on thinking I needed to use <code>&lt;@ tickE</code> for <code>mouseMovementE</code>. Thank you very much!"}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 2, "last_activity_date": 1454951942, "creation_date": 1454951942, "answer_id": 35275497, "question_id": 35272631, "link": "https://stackoverflow.com/questions/35272631/how-to-create-an-event-that-contains-the-difference-between-the-value-at-current/35275497#35275497", "title": "How to create an Event that contains the difference between the value at current tick and the value at the value at previous tick?", "body": "<p>You are looking for <a href=\"http://hackage.haskell.org/package/reactive-banana/docs/Reactive-Banana-Combinators.html#v:accumE\" rel=\"nofollow\"><code>accumE</code></a> which builds events from streams of events. I highly recommend reading the recursion section of the documentation which describes how it's implemented in terms of <code>stepper</code> and <code>apply</code>.</p>\n\n<pre><code>accumE :: MonadMoment m =&gt; a -&gt; Event (a -&gt; a) -&gt; m (Event a)\n--        starting value --^           |             |\n--  stream of events that modify it  --^             |\n--  resulting events                               --^\n</code></pre>\n\n<p>To compute the difference between two points with <code>accumE</code> we'll need to keep track of the previous point. We'll also keep track of the current point. This will keep a little two-item history of the most recent events.</p>\n\n<pre><code>  (Point V2 CInt , Point V2 CInt)\n-- previous value, current value\n\nedges :: MonadMoment m =&gt; a -&gt; Event a -&gt; m (Event (a, a))\nedges initial later = accumE (initial, initial) (shift &lt;$&gt; later)\n    where\n        shift x2 (x0, x1) = (x1, x2)\n</code></pre>\n\n<p>To get the difference we'll subtract the previous one from the current one. This will give a complete network like</p>\n\n<pre><code>makeNetwork :: GraphicsData -&gt; SDLEventSource -&gt; MomentIO ()\nmakeNetwork gd sdlEventSource = mdo\n  tickE          &lt;- tickEvent sdlEventSource\n  mousePositionB &lt;- fromPoll SDL.getAbsoluteMouseLocation\n\n  let mousePositionE = mousePositionB &lt;@ tickE\n\n  mouseHistoryE &lt;- edges zero mousePositionE\n\n  let mouseMovementE = (\\(x0, x1) -&gt; x1 ^-^ x0) &lt;$&gt; mouseHistoryE\n\n  -- ...\n</code></pre>\n\n<p><code>zero</code> and <code>^-^</code> come from <a href=\"https://hackage.haskell.org/package/linear/docs/Linear-Vector.html#t:Additive\" rel=\"nofollow\"><code>Linear.Vector</code></a></p>\n"}], "owner": {"reputation": 243, "user_id": 1206302, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0ac9ec73f8186f7f18f203e3620278d8?s=128&d=identicon&r=PG", "display_name": "cies", "link": "https://stackoverflow.com/users/1206302/cies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 2, "accepted_answer_id": 35275497, "answer_count": 1, "score": 3, "last_activity_date": 1454951942, "creation_date": 1454943524, "last_edit_date": 1454946756, "question_id": 35272631, "link": "https://stackoverflow.com/questions/35272631/how-to-create-an-event-that-contains-the-difference-between-the-value-at-current", "title": "How to create an Event that contains the difference between the value at current tick and the value at the value at previous tick?", "body": "<p>I'm using <code>reactive-banana</code> and <code>sdl2</code> (using <a href=\"https://github.com/cies/reactive-banana-sdl2\" rel=\"nofollow\">this glue library</a>) for a game-like project. A <code>Behavior</code> is created for the \"absolute mouse location\", as well as a <code>Behavior</code> for the \"relative mouse location\" (a.k.a. the mouse movement). When not using FRP this works well, but with FRP the \"relative mouse location\" becomes a problem: it seems only a small amount of the data comes through. I suspect this happens because the underlying \"SDL events\" (that we represent with a <code>Behavior</code>) do not line up nicely with the tick <code>Event</code>s.</p>\n\n<p>So I want to calculate my own mouse movement, by simply comparing the mouse location at the current tick with the location at the previous tick. I'm not sure if this will solve my problems, but I have good hope :)</p>\n\n<p>First of all I'm lost on how to approach it: the <code>State</code> monad, or an <code>IORef</code>, or does <code>reactive-banana</code> provide another means?</p>\n\n<p>I'll give a small excerpt of the code I currently have:</p>\n\n<pre><code>makeNetwork :: GraphicsData -&gt; SDLEventSource -&gt; MomentIO ()\nmakeNetwork gd sdlEventSource = mdo\n  tickE          &lt;- tickEvent sdlEventSource\n  mouseMovementB &lt;- fromPoll SDL.getRelativeMouseLocation\n  mousePositionB &lt;- fromPoll SDL.getAbsoluteMouseLocation\n\n  let mousePositionE = mousePositionB &lt;@ tickE\n      mouseMovementE = mouseMovementB &lt;@ tickE  -- this yields flaky data\n\n  -- ... the rest of the network description left out ...\n</code></pre>\n\n<p>As explained above I'd like to express <code>mouseMovementE</code> in terms of the <code>mousePositionB</code> at current <code>tickE</code> (known as <code>mousePositionE</code>) and the <code>mousePositionE</code> value at the previous <code>tickE</code>.</p>\n\n<p>Any help is greatly appreciated!</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 113, "user_id": 4793410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I3zVN.jpg?s=128&g=1", "display_name": "Vladyslav Babych", "link": "https://stackoverflow.com/users/4793410/vladyslav-babych"}, "edited": false, "score": 0, "creation_date": 1454932642, "post_id": 35268965, "comment_id": 58249345, "body": "@zakyggaps So I have to change it to transform [x] = [x]? I did, and I get another error: &quot;Type error in application&quot;"}, {"owner": {"reputation": 113, "user_id": 4793410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I3zVN.jpg?s=128&g=1", "display_name": "Vladyslav Babych", "link": "https://stackoverflow.com/users/4793410/vladyslav-babych"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1454933491, "post_id": 35268965, "comment_id": 58249888, "body": "@zakyggaps Sorry, I figured that this is an easy problem and the error can be easily spotted by someone who knows Haskell well."}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1454934212, "post_id": 35268965, "comment_id": 58250319, "body": "So sarcastic:) I sincerely recommend some more feature-rich haskell implementation and editor like those mentioned in <a href=\"http://achernyak.me/universal-haskell-dev-enviornment\" rel=\"nofollow noreferrer\">this page</a> than the one you currently have. It will be great help when no one who knows Haskell well is in reach. I&#39;m sorry if I&#39;ve been offensive or off-topic."}], "answers": [{"tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 3, "last_activity_date": 1454932976, "creation_date": 1454932976, "answer_id": 35269221, "question_id": 35268965, "link": "https://stackoverflow.com/questions/35268965/type-error-in-explicitly-typed-binding-haskell/35269221#35269221", "title": "Type error in explicitly typed binding (Haskell)", "body": "<p>In the final <code>transform</code> pattern, you are using string literals for \"a\" and \"b\" when they should be characters.</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>transform :: String -&gt; String\ntransform [] = []\ntransform [x] = [x]\ntransform (x:y:xs)\n        | x == 'a' &amp;&amp; y == 'b' = \"a\" ++ (transform xs)\n        | x == 'b' &amp;&amp; y == 'a' = \"b\" ++ (transform xs)\n        | x == 'b' &amp;&amp; y == 'b' = \"a\" ++ (transform xs)\n        | x == 'a' &amp;&amp; y == 'a' = \"aaa\" ++ (transform xs)\n</code></pre>\n\n<p>Also, there was a bug in the second transform definition, where you needed to wrap <code>x</code> in brackets because it was returning a list of characters.</p>\n\n<p>(You may also want to have a final pattern match to handle any other input, since you'll get a non-exhaustive error if you run this against a string like \"zzz\")</p>\n"}], "owner": {"reputation": 113, "user_id": 4793410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I3zVN.jpg?s=128&g=1", "display_name": "Vladyslav Babych", "link": "https://stackoverflow.com/users/4793410/vladyslav-babych"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 35269221, "answer_count": 1, "score": 1, "last_activity_date": 1454932976, "creation_date": 1454932219, "question_id": 35268965, "link": "https://stackoverflow.com/questions/35268965/type-error-in-explicitly-typed-binding-haskell", "title": "Type error in explicitly typed binding (Haskell)", "body": "<p>I am writing a very simple function which transforms a string by replacing a certain combinations of characters into another. (e.g. \"ab\" to \"a\")\nI am a noob in Haskell, and I get error: \"Type error in explicitly typed binding\"</p>\n\n<p>Could you please tell me what is the problem?\nCode:</p>\n\n<pre><code>transform :: String -&gt; String\ntransform [] = []\ntransform [x] = x\ntransform (x:y:xs)\n        | x == \"a\" &amp;&amp; y == \"b\" = \"a\" ++ (transform xs)\n        | x == \"b\" &amp;&amp; y == \"a\" = \"b\" ++ (transform xs)\n        | x == \"b\" &amp;&amp; y == \"b\" = \"a\" ++ (transform xs)\n        | x == \"a\" &amp;&amp; y == \"a\" = \"aaa\" ++ (transform xs)\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["haskell", "syntax", "where-clause", "parse-error", "let"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 14, "creation_date": 1454929111, "post_id": 35267871, "comment_id": 58247198, "body": "Your posted code mixes tabs and spaces, GHC treats tabs as 8 spaces, and this breaks indentation. I recommend turning on warnings <code>-Wall</code> so that this is reported by the compiler, so you know there&#39;s something wrong. A simple solution is to avoid tabs. For more solutions see <a href=\"http://dmwit.com/tabs/\" rel=\"nofollow noreferrer\">dmwit.com/tabs</a>"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1454934527, "post_id": 35267871, "comment_id": 58250521, "body": "<b>Never</b> mix tabs and spaces. It breaks code in all languages where indentation is significant. Check your editor settings and either always use only tabs or only spaces (the latter is usually preferred)."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1454943550, "post_id": 35267871, "comment_id": 58256806, "body": "And for the record, these examples as displayed on StackOverflow appear to have exactly correct layout and syntax."}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "edited": false, "score": 0, "creation_date": 1455005956, "post_id": 35267871, "comment_id": 58284269, "body": "And correct term is bindings, not variables."}, {"owner": {"reputation": 7618, "user_id": 1509744, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1f661ea35aa6e2858e56717c813c8280?s=128&d=identicon&r=PG&f=1", "display_name": "gen", "link": "https://stackoverflow.com/users/1509744/gen"}, "reply_to_user": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "edited": false, "score": 0, "creation_date": 1455006945, "post_id": 35267871, "comment_id": 58284761, "body": "thanks @AlexeyKuleshevich"}, {"owner": {"reputation": 7618, "user_id": 1509744, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1f661ea35aa6e2858e56717c813c8280?s=128&d=identicon&r=PG&f=1", "display_name": "gen", "link": "https://stackoverflow.com/users/1509744/gen"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1455209777, "post_id": 35267871, "comment_id": 58397951, "body": "@chi can you post your comment as an answer? It resolved my issue..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1455220405, "post_id": 35267871, "comment_id": 58404736, "body": "&quot;Variables&quot; is okay too."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1455218669, "creation_date": 1455218669, "answer_id": 35348268, "question_id": 35267871, "link": "https://stackoverflow.com/questions/35267871/correct-syntax-of-let-in-and-where-clauses-in-haskell/35348268#35348268", "title": "Correct syntax of let ... in and where clauses in Haskell", "body": "<p>The posted code mixes tabs and spaces. This is a frequent cause of indentation problems.</p>\n\n<p>The Haskell report, which defined the language, states that tabs are equivalent to 8 spaces. If your editor is configured to display tabs as another number of spaces, chances are that what you are reading as indented at the correct level is not actually so for the compiler.</p>\n\n<p>The easiest fix is to replace tab with spaces in the source files. For that, I recommend turning on warnings passing the <code>-Wall</code> flag, or by adding</p>\n\n<pre><code>{-# OPTIONS -Wall #-}\n</code></pre>\n\n<p>at the beginning of you source files. Doing that will cause GHC to warn when tabs are detected.</p>\n\n<p>There also are <a href=\"http://dmwit.com/tabs\" rel=\"nofollow\">alternative solutions</a> to the drastic remove-all-tabs one. There are smart ways to mix tabs and spaces in a \"tab-agnostic\" way, which will make the code compilable and readable in spite of how many spaces a tab is equivalent to. While is is not very popular, such proposals have their technical merits.</p>\n"}], "owner": {"reputation": 7618, "user_id": 1509744, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1f661ea35aa6e2858e56717c813c8280?s=128&d=identicon&r=PG&f=1", "display_name": "gen", "link": "https://stackoverflow.com/users/1509744/gen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 35348268, "answer_count": 1, "score": 0, "last_activity_date": 1455218669, "creation_date": 1454928808, "last_edit_date": 1454929455, "question_id": 35267871, "link": "https://stackoverflow.com/questions/35267871/correct-syntax-of-let-in-and-where-clauses-in-haskell", "title": "Correct syntax of let ... in and where clauses in Haskell", "body": "<p>I am trying to declare local variables (is this the right term in the case of haskell?) in haskell using where and let-in clauses. However whenever my clauses are longer than a single line I always get some parse errors:</p>\n\n<pre><code>&gt; letExample :: Int -&gt; Int\n&gt; letExample 0 = 0\n&gt; letExample n =\n&gt;               let one     = 1\n&gt;                   four    = 4\n&gt;                   eight   = 8\n&gt;               in one*four*eight\n</code></pre>\n\n<p>When trying to load the above code into ghci I get the following error:</p>\n\n<pre><code>letexample.lhs:4:33:\nparse error in let binding: missing required 'in' Failed, modules loaded: none.\n</code></pre>\n\n<hr>\n\n<p>I get the following error when trying to load the code below:</p>\n\n<pre><code>whereexample:5:57: parse error on input \u2018=\u2019\nFailed, modules loaded: none.\n</code></pre>\n\n<p>code:</p>\n\n<pre><code>&gt; whereExample :: Int -&gt; Int\n&gt; whereExample 0 = 0\n&gt; whereExample n = one * four * eight\n&gt;               where   one     = 1\n&gt;                       four    = 4\n&gt;                       eight   = 8\n</code></pre>\n\n<p>What is the right way of using let and where in the above cases?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 682, "user_id": 3421913, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b267474c6f0ce7338d7bcd3ca14d9648?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastien", "link": "https://stackoverflow.com/users/3421913/sebastien"}, "edited": false, "score": 0, "creation_date": 1454924050, "post_id": 35266143, "comment_id": 58244006, "body": "I&#39;ve the impression that you want check user input. If you are waiting data from the user, you&#39;ll never be able to do a compile check on his entry. You only can &quot;compile check&quot; code you write. Can you clarify what you want check ?"}], "answers": [{"tags": [], "owner": {"reputation": 682, "user_id": 3421913, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b267474c6f0ce7338d7bcd3ca14d9648?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastien", "link": "https://stackoverflow.com/users/3421913/sebastien"}, "is_accepted": false, "score": 2, "last_activity_date": 1454924874, "last_edit_date": 1454924874, "creation_date": 1454924494, "answer_id": 35266386, "question_id": 35266143, "link": "https://stackoverflow.com/questions/35266143/ghc-compiler-not-complaining-about-incorrect-code-paths/35266386#35266386", "title": "GHC compiler not complaining about incorrect code paths", "body": "<p>You can use the \"case\" only on authorizeUser and then filter the DATA Command</p>\n\n\n\n<pre><code>data Command = UnauthorizedCommand | Command {command :: String, userId :: String}\n\nauthorizedUsers = [\"1\", \"2\", \"3\"]\n\nauthorizeUser :: String -&gt; String -&gt; Command\nauthorizeUser cmd userId = if (userId `elem` authorizedUsers) then Command {command=cmd, userId=userId} else UnauthorizedCommand\n\nmain :: IO ()\nmain = do\n  cmd &lt;- getLine\n  userId &lt;- getLine\n  case  authorizeUser cmd userId of\n    Command \"ls\" _ -&gt; putStrLn \"works\"\n    _ -&gt; putStrLn \"not authorized\" -- either the user id is not good or the command is not good.\n</code></pre>\n\n<p>If you have several command, you can also do:</p>\n\n<pre><code>main = do\n  cmd &lt;- getLine\n  userId &lt;- getLine\n  case  authorizeUser cmd userId of\n\n    Command _ _ -&gt; case cmd of\n        \"ls\" -&gt; putStrLn \"works\"\n        \"cd\" -&gt; putStrLn \"moved!\"\n        _ -&gt; putStrLn \"Bad command!\"\n    _ -&gt; putStrLn \"not authorized\" -- or: Unauthorized -&gt; putStrLn \"Not authorized\"\n</code></pre>\n\n<p>PS : Note you can factor the <code>putStrLn</code>s</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1454928937, "post_id": 35267185, "comment_id": 58247083, "body": "This could have been added to your other answer as an edit. It is possible to post multiple answers on SO, but they are not commonly found. I do not perfectly know the guidelines, but I believe multiple answers should be reserved to completely different approaches to the problem."}], "tags": [], "owner": {"reputation": 682, "user_id": 3421913, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b267474c6f0ce7338d7bcd3ca14d9648?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastien", "link": "https://stackoverflow.com/users/3421913/sebastien"}, "is_accepted": false, "score": 1, "last_activity_date": 1454926734, "last_edit_date": 1495542204, "creation_date": 1454926734, "answer_id": 35267185, "question_id": 35266143, "link": "https://stackoverflow.com/questions/35266143/ghc-compiler-not-complaining-about-incorrect-code-paths/35267185#35267185", "title": "GHC compiler not complaining about incorrect code paths", "body": "<p>I think I've finally understand your question: you want Haskell generate error/warning when calling <code>command</code> on an arbitrary <code>Command</code>. It is related to this answer : <a href=\"https://stackoverflow.com/a/3804900/3421913\">https://stackoverflow.com/a/3804900/3421913</a> . In short:</p>\n\n<ol>\n<li><p>It is not possible to check (or very very hard) at compile time if a command is <code>Command Str Str</code> or <code>Unauthorized</code>: in your case it is quite simple, but it might be more complex.</p></li>\n<li><p>You sometimes know that your value has the good property but it's difficult to express that in haskell (see the linked answer above with the <code>duplicates/remove_duplicates</code> functions). In your case, <code>authorizeUser cmd userId</code> is unsafe (since <code>cmd</code> and <code>userId</code> are user input), so we won't use the <code>command</code> function which will fail if the user is a monkey. Instead, we'll use the pattern matching I've proposed in my other answer.\nIf you have some invariant ensuring that <code>c::Command</code> is not <code>Unauthorized</code>, you might use directly <code>command</code>.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1454947847, "post_id": 35268192, "comment_id": 58259797, "body": "This seems promising. Although it would&#39;ve been better if it would&#39;ve been possible without the type-related boilerplate. Your second approach, GADTs, went over my head. Is there a gentle introduction to GADTs that you can recommend?"}, {"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1455023547, "post_id": 35268192, "comment_id": 58295652, "body": "how do I write a function which returns <code>Command p</code>? I tried the following but it didn&#39;t work: <a href=\"http://lpaste.net/151949\" rel=\"nofollow noreferrer\">lpaste.net/151949</a> How does one practically use this approach to do what I&#39;m trying to do?"}], "tags": [], "owner": {"reputation": 23816, "user_id": 572606, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c20a126ad0dce40e8fc4a43456107919?s=128&d=identicon&r=PG", "display_name": "shang", "link": "https://stackoverflow.com/users/572606/shang"}, "is_accepted": false, "score": 5, "last_activity_date": 1454929808, "creation_date": 1454929808, "answer_id": 35268192, "question_id": 35266143, "link": "https://stackoverflow.com/questions/35266143/ghc-compiler-not-complaining-about-incorrect-code-paths/35268192#35268192", "title": "GHC compiler not complaining about incorrect code paths", "body": "<p>The main problem in this example is that using the record syntax in a data type with multiple constructors can end up with record selector functions that are partial. It's therefore not recommended to ever mix records and multiple constructors unless all constructors have identical record fields.</p>\n\n<p>The simplest solution is to not use record syntax here and to define your own <code>command</code> accessor which makes the error case explicit with a <code>Maybe</code> return type:</p>\n\n<pre><code>data Command = UnauthorizedCommand | Command String String\n\ncommand :: Command -&gt; Maybe String\ncommand UnauthorizedCommand = Nothing\ncommand (Command cmd _)     = Just cmd\n</code></pre>\n\n<p>A slightly more complex way to check this during compile time is to use GADTs to encode the permission level in the types.</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n{-# LANGUAGE DataKinds #-}\n\ndata Permission\n  = Authorized | Unauthorized\n\ndata Command p where\n  UnauthorizedCommand :: Command Unauthorized\n  Command :: {command :: String, userId :: String} -&gt; Command Authorized\n</code></pre>\n\n<p>Now the type of the <code>command</code> selector is <code>Command Authorized -&gt; String</code> so you get a compile time error if you try to use it with an unauthorized command.</p>\n"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1454929808, "creation_date": 1454923674, "question_id": 35266143, "link": "https://stackoverflow.com/questions/35266143/ghc-compiler-not-complaining-about-incorrect-code-paths", "title": "GHC compiler not complaining about incorrect code paths", "body": "<p>I'm approaching Haskell with a view of converting runtime errors to compile-time errors. I expect the compiler to figure out that all the code paths in the following code are not error free. If <code>authorizeUser</code> returns <code>UnauthorizedCommand</code> then the call to <code>(command $ authorizeUser cmd userId)</code> will fail during runtime.</p>\n\n<pre><code>data Command = UnauthorizedCommand | Command {command :: String, userId :: String}\n\nauthorizedUsers = [\"1\", \"2\", \"3\"]\n\nauthorizeUser :: String -&gt; String -&gt; Command\nauthorizeUser cmd userId = if (userId `elem` authorizedUsers) then Command {command=cmd, userId=userId} else UnauthorizedCommand\n\nmain :: IO ()\nmain = do\n  cmd &lt;- getLine\n  userId &lt;- getLine\n  case (command $ authorizeUser cmd userId) of\n    \"ls\" -&gt; putStrLn \"works\"\n    _ -&gt; putStrLn \"not authorized\"\n</code></pre>\n\n<p>Is there a compiler switch to enable such checking?</p>\n"}, {"tags": ["haskell", "lambda", "system-f"], "answers": [{"tags": [], "owner": {"reputation": 8625, "user_id": 2642162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f497a9526578cba7c81514047b3120fb?s=128&d=identicon&r=PG", "display_name": "gsg", "link": "https://stackoverflow.com/users/2642162/gsg"}, "is_accepted": true, "score": 4, "last_activity_date": 1454911553, "creation_date": 1454911553, "answer_id": 35263310, "question_id": 35262928, "link": "https://stackoverflow.com/questions/35262928/polymorphic-self-application/35263310#35263310", "title": "Polymorphic self application", "body": "<p>The erased term does make sense: in Haskell it would be <code>\\f a -&gt; f (f a)</code>, a fairly ordinary function that applies its first argument to its second, and then again to the result.</p>\n\n<p>The difference between <code>\\f a -&gt; &lt;body&gt;</code> and <code>\\f.\\a. &lt;body&gt;</code> is only one of notation. If you prefer, write the Haskell term <code>\\f -&gt; \\a -&gt; f (f a)</code>, which is equivalent but syntactically a bit closer to the erased System F.</p>\n\n<p>(Note that <code>double</code> is not self application, which would be <code>\\f -&gt; f f</code>.)</p>\n"}], "owner": {"reputation": 1794, "user_id": 1135950, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b1cf007709e46bbd037f204a43c51fa4?s=128&d=identicon&r=PG", "display_name": "yonutix", "link": "https://stackoverflow.com/users/1135950/yonutix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 1, "accepted_answer_id": 35263310, "answer_count": 1, "score": 1, "last_activity_date": 1454911553, "creation_date": 1454909592, "question_id": 35262928, "link": "https://stackoverflow.com/questions/35262928/polymorphic-self-application", "title": "Polymorphic self application", "body": "<p>I have an example of System F plymorphism that I don't really understand:\n<a href=\"https://i.stack.imgur.com/1Pwlp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1Pwlp.png\" alt=\"enter image description here\"></a></p>\n\n<p>If I would remove the types it would remain:\n\\f.\\a.f (f a) which makes no sense.</p>\n\n<p>Can you help me with this?\nThank you!</p>\n"}, {"tags": ["haskell", "servant"], "answers": [{"comments": [{"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 0, "creation_date": 1454936656, "post_id": 35265103, "comment_id": 58251887, "body": "@majdar, very helpful pointer. This is likely the route I will take. I didn&#39;t know about that useful library until you pointed it out"}, {"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1594968078, "post_id": 35265103, "comment_id": 111317120, "body": "Discovered <code>wai-cors</code> thanks to your answer and <code>simpleCors</code> is EXACTLY what I need right now!"}], "tags": [], "owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "is_accepted": false, "score": 14, "last_activity_date": 1454919871, "creation_date": 1454919871, "answer_id": 35265103, "question_id": 35262410, "link": "https://stackoverflow.com/questions/35262410/adding-response-header-in-servant/35265103#35265103", "title": "Adding response header in Servant", "body": "<p>I think the easiest way to add CORS headers to response is to use a middleware on top of servant. <a href=\"https://hackage.haskell.org/package/wai-cors\" rel=\"noreferrer\"><code>wai-cors</code></a> makes it pretty easy:</p>\n\n<pre><code>import Network.Wai.Middleware.Cors\n\n[...]\n\napp ::  Application\napp  = simpleCors (serve userAPI server)\n</code></pre>\n\n<hr>\n\n<p>For your actual response, I guess you need to use <a href=\"https://hackage.haskell.org/package/servant-0.4.4.6/docs/Servant-API-ResponseHeaders.html\" rel=\"noreferrer\"><code>addHeader</code></a> to turn a value of type <code>Text</code> into a value of type <code>Headers '[Header \"Access-Control-Allow-Origin\" T.Text</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 0, "creation_date": 1454936607, "post_id": 35268603, "comment_id": 58251856, "body": "aha, very instructive. Thank you! I was confused why the types wouldn&#39;t change when adding the header. They do change as you pointed out."}, {"owner": {"reputation": 6006, "user_id": 239558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2362bc1c423993bbdb8548a3a059702c?s=128&d=identicon&r=PG", "display_name": "user239558", "link": "https://stackoverflow.com/users/239558/user239558"}, "edited": false, "score": 0, "creation_date": 1522015677, "post_id": 35268603, "comment_id": 85965755, "body": "can this be used to retrieve the &quot;Location&quot; header from a GET request when using servant-client?"}, {"owner": {"reputation": 2647, "user_id": 2141650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/68388df031850463b7bbb5a9e6034abe?s=128&d=identicon&r=PG", "display_name": "user2141650", "link": "https://stackoverflow.com/users/2141650/user2141650"}, "reply_to_user": {"reputation": 6006, "user_id": 239558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2362bc1c423993bbdb8548a3a059702c?s=128&d=identicon&r=PG", "display_name": "user239558", "link": "https://stackoverflow.com/users/239558/user239558"}, "edited": false, "score": 0, "creation_date": 1522131445, "post_id": 35268603, "comment_id": 86015146, "body": "@user239558 yup - just use <code>getHeaders</code> or <code>getHeadersHList</code> on the response (from <a href=\"https://hackage.haskell.org/package/servant-0.8/docs/Servant-API-ResponseHeaders.html#t:GetHeaders\" rel=\"nofollow noreferrer\">here</a>)"}, {"owner": {"reputation": 1010, "user_id": 267916, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d630bf06a192014619dd8c9a75c7ade2?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/267916/jeremy"}, "edited": false, "score": 1, "creation_date": 1555902587, "post_id": 35268603, "comment_id": 98247474, "body": "Just a note that it should be <code>y = addHeader &quot;headerVal&quot; x</code> above, but since edits have to be six characters long, this change could not be submitted."}], "tags": [], "owner": {"reputation": 2647, "user_id": 2141650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/68388df031850463b7bbb5a9e6034abe?s=128&d=identicon&r=PG", "display_name": "user2141650", "link": "https://stackoverflow.com/users/2141650/user2141650"}, "is_accepted": true, "score": 5, "last_activity_date": 1454931021, "creation_date": 1454931021, "answer_id": 35268603, "question_id": 35262410, "link": "https://stackoverflow.com/questions/35262410/adding-response-header-in-servant/35268603#35268603", "title": "Adding response header in Servant", "body": "<p>madjar already suggested this, but to expand upon it: <code>addHeader</code> changes the return type:</p>\n\n<pre><code>x :: Int\nx = 5\n\ny :: Headers '[Header \"SomeHeader\" String] Int\ny = addHeader \"headerVal\" y\n</code></pre>\n\n<p>In your case, this means you have to update the type of the <code>users</code> where binding to return <code>Either ServantErr IO (Headers '[Header \"Access-Control-Allow-Origin\" T.Text] Token</code></p>\n\n<p>More generally, you can use <code>:kind! Server UserAPI</code> in ghci to see what the type synonym expands to - that's often helpful with servant!</p>\n"}], "owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1783, "favorite_count": 3, "accepted_answer_id": 35268603, "answer_count": 2, "score": 8, "last_activity_date": 1454931021, "creation_date": 1454906122, "question_id": 35262410, "link": "https://stackoverflow.com/questions/35262410/adding-response-header-in-servant", "title": "Adding response header in Servant", "body": "<p>I am trying to figure out how to add <code>CORS</code> response header in Servant (basically, set a response header \"Access-Control-Allow-Origin: *\"). I wrote a small test case below with <code>addHeader</code> function but it errors out. I will appreciate help with figuring out the error below.</p>\n\n<p>Code:</p>\n\n<pre><code>{-# LANGUAGE CPP           #-}\n{-# LANGUAGE DataKinds     #-}\n{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE TypeFamilies  #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE OverloadedStrings #-}\nmodule Main where\n\nimport Data.Aeson\nimport GHC.Generics\nimport Network.Wai\nimport Servant\nimport Network.Wai.Handler.Warp (run)\nimport Control.Monad.Trans.Either\nimport Control.Monad.IO.Class (liftIO)\nimport Control.Monad (when, (&lt;$!&gt;))\nimport Data.Text as T\nimport Data.Configurator as C\nimport Data.Maybe\nimport System.Exit (exitFailure)\n\ndata User = User\n  { name              :: T.Text\n  , password          :: T.Text\n  } deriving (Eq, Show, Generic)\n\ninstance ToJSON User\ninstance FromJSON User\n\ntype Token = T.Text\n\ntype UserAPI = \"grant\" :&gt; ReqBody '[JSON] User :&gt; Post '[JSON] (Headers '[Header \"Access-Control-Allow-Origin\" T.Text] Token)\n\nuserAPI :: Proxy UserAPI\nuserAPI = Proxy\n\nauthUser :: User -&gt; Bool\nauthUser u = case (password u) of\n    \"somepass\" -&gt; True\n    _     -&gt; False\n\nserver :: Server UserAPI\nserver = users  \n  where users :: User -&gt; EitherT ServantErr IO Token\n        users u = case (authUser u) of\n          True -&gt; return $ addHeader \"*\" $ (\"ok\" :: Token)\n          False -&gt; return $ addHeader \"*\" $ (\"notok\" :: Token)\n\napp ::  Application\napp  = serve userAPI server\n\nmain :: IO ()\nmain = run 8081 app\n</code></pre>\n\n<p>This is the error I get:</p>\n\n<pre><code>src/Test.hs:43:10:\n    Couldn't match type \u2018Headers\n                           '[Header \"Access-Control-Allow-Origin\" Text] Text\u2019\n                   with \u2018Text\u2019\n    Expected type: Server UserAPI\n      Actual type: User -&gt; EitherT ServantErr IO Token\n    In the expression: users\n    In an equation for \u2018server\u2019:\n        server\n          = users\n          where\n              users :: User -&gt; EitherT ServantErr IO Token\n              users u\n                = case (authUser u) of {\n                    True -&gt; return $ addHeader \"*\" $ (\"something\" :: Token)\n                    False -&gt; return $ addHeader \"*\" $ (\"something\" :: Token) }\n\nsrc/Test.hs:46:28:\n    Couldn't match type \u2018Text\u2019 with \u2018Headers '[Header h v0] Text\u2019\n    In the expression: addHeader \"*\"\n    In the second argument of \u2018($)\u2019, namely\n      \u2018addHeader \"*\" $ (\"something\" :: Token)\u2019\n    In the expression: return $ addHeader \"*\" $ (\"something\" :: Token)\n\nsrc/Test.hs:47:29:\n    Couldn't match type \u2018Text\u2019 with \u2018Headers '[Header h1 v1] Text\u2019\n    In the expression: addHeader \"*\"\n    In the second argument of \u2018($)\u2019, namely\n      \u2018addHeader \"*\" $ (\"something\" :: Token)\u2019\n    In the expression: return $ addHeader \"*\" $ (\"something\" :: Token)\n</code></pre>\n\n<p>I have a working version with a simpler API (simple <code>GET</code>) where it works. But, for <code>UserAPI</code> of above type, it errors out. <code>addHeader</code> function type seems to agree with the type signature the way I think about it. I am definitely missing something here or it won't error out like this.</p>\n"}, {"tags": ["json", "validation", "haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454906752, "post_id": 35262276, "comment_id": 58236847, "body": "Why not open a bug report if you&#39;re confident it&#39;s wrong? You should probably double check with an another validation tool, but bugs happen."}, {"owner": {"reputation": 2442, "user_id": 3666302, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e9aed854fcd666aba1316ef908ad5913?s=128&d=identicon&r=PG&f=1", "display_name": "TomTom", "link": "https://stackoverflow.com/users/3666302/tomtom"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454907002, "post_id": 35262276, "comment_id": 58236903, "body": "I am not confident at all, because I read about json schemas the first time today. I mainly followed the <a href=\"https://github.com/seagreen/hjsonschema/blob/master/Example.hs\" rel=\"nofollow noreferrer\">example</a> from the hjsonschema author."}], "answers": [{"tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": false, "score": 5, "last_activity_date": 1454926444, "last_edit_date": 1454926444, "creation_date": 1454924640, "answer_id": 35266430, "question_id": 35262276, "link": "https://stackoverflow.com/questions/35262276/how-to-validate-json-with-schema-in-haskell/35266430#35266430", "title": "How to validate JSON with schema in Haskell?", "body": "<p>It's nothing about Haskell. </p>\n\n<p>Your schema doesn't have a <code>required</code> property at top level so an empty json object is acceptable. </p>\n\n<p>Also it contains no <code>\"additionalProperties\": false</code> property so anything that does not fit into one of the defined patterns are ignored. </p>\n\n<p>BTW I doubt whether it's a valid Draft4 json schema. It passed the validation of the Draft4 meta-schema but the syntax is a little bit different, maybe something Python-specific. You'd better run the test suites which came along with the <code>hjsonscheme</code> package to see if everything works fine.</p>\n"}], "owner": {"reputation": 2442, "user_id": 3666302, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e9aed854fcd666aba1316ef908ad5913?s=128&d=identicon&r=PG&f=1", "display_name": "TomTom", "link": "https://stackoverflow.com/users/3666302/tomtom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1454926444, "creation_date": 1454905114, "question_id": 35262276, "link": "https://stackoverflow.com/questions/35262276/how-to-validate-json-with-schema-in-haskell", "title": "How to validate JSON with schema in Haskell?", "body": "<p>I want to validate JSON with a schema. <a href=\"https://hackage.haskell.org/package/hjsonschema\" rel=\"nofollow\">hjsonschema</a> seemed like a good choice as it is fairly new and supports the latest draft.\nBut the <a href=\"https://github.com/plotly/plotly.py/blob/master/plotly/graph_reference/default-schema.json\" rel=\"nofollow\">plotly json schema</a> always gives me valid responses.</p>\n\n<p>I may be misunderstanding something here but this should not be valid JSON</p>\n\n<p><strong>bad.json</strong></p>\n\n<pre><code>{\n    \"fjsdklj\" : 5\n}\n</code></pre>\n\n<p>even though it is considered valid by the following code</p>\n\n<pre><code>module Main where\n\nimport           Control.Applicative\nimport           Data.Aeson\nimport           Data.HashMap.Strict (HashMap)\nimport qualified Data.HashMap.Strict as H\nimport           Data.Monoid\nimport qualified Data.ByteString.Lazy as B\nimport qualified Data.JsonSchema as JS\nimport Data.Maybe\n\nmain :: IO ()\nmain = do\n    schemaJSON &lt;- (fromJust . decode) &lt;$&gt; B.readFile \"simple-schema.json\"\n    bad &lt;- (fromJust . decode) &lt;$&gt; B.readFile \"bad.json\"\n    let schemaData = JS.RawSchema {\n                        JS._rsURI = Nothing,\n                        JS._rsData = schemaJSON\n                        }\n    schema &lt;- compileSchema (JS.SchemaGraph schemaData H.empty) schemaData\n    checkResults (JS.validate schema bad)\n\ncompileSchema :: JS.SchemaGraph -&gt; JS.RawSchema -&gt; IO (JS.Schema JS.Draft4Failure)\ncompileSchema graph rs =\n  case JS.compileDraft4 graph rs of\n    Left failure -&gt; error $ \"Not a valid schema: \" &lt;&gt; show failure\n    Right schema -&gt; return schema\n\ncheckResults :: [JS.ValidationFailure JS.Draft4Failure] -&gt; IO ()\ncheckResults [] = putStrLn \"Just fine\"\ncheckResults x = putStrLn $ \"ERROR: \" ++ show x\n</code></pre>\n\n<p><code>simple-schema.json</code> is the plotly schema and <code>bad.json</code> the snippet I posted above.</p>\n"}, {"tags": ["debugging", "haskell", "intellij-idea"], "owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1454896325, "creation_date": 1454896325, "question_id": 35261406, "link": "https://stackoverflow.com/questions/35261406/intellij-haskell-correct-path-to-remote-debugger-was-not-set", "title": "IntelliJ Haskell &quot;Correct path to remote debugger was not set.&quot;", "body": "<p>In Haskell, I can run my IntelliJ project but I cannot debug it, and apparently assertions only work in debug mode. </p>\n\n<p>Error message:</p>\n\n<pre><code>Correct path to remote debugger was not set. See Settings | Haskell Debugger\n</code></pre>\n\n<p>Source: <a href=\"https://github.com/atsky/haskell-idea-plugin/blob/master/plugin/src/org/jetbrains/haskell/debugger/HaskellProgramRunner.kt\" rel=\"nofollow noreferrer\">https://github.com/atsky/haskell-idea-plugin/blob/master/plugin/src/org/jetbrains/haskell/debugger/HaskellProgramRunner.kt</a></p>\n\n<p>See pic:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2v8yM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2v8yM.png\" alt=\"Haskell Debugger Settings in IntelliJ\"></a></p>\n\n<p>Please help and/or tell me how to implement a fatal assertion function that does not depend on compiler debug mode being turned on (I like to disable/enable assertions pragmatically)</p>\n"}, {"tags": ["debugging", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "edited": false, "score": 0, "creation_date": 1454899415, "post_id": 35261618, "comment_id": 58235447, "body": "The way I like to do debugging is I sprinkle these in crucial areas of the code (i.e. controllers that correspond to actions) and I make them print out in such a way that the stack traces are click-able. These clickable stack traces leave a trail that I can go forward or backward through, allowing me to map regions of code to functionality without me having to worry about accidentally skipping a break-point."}, {"owner": {"reputation": 51525, "user_id": 154152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tbD5u.jpg?s=128&g=1", "display_name": "Noon Silk", "link": "https://stackoverflow.com/users/154152/noon-silk"}, "reply_to_user": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "edited": false, "score": 0, "creation_date": 1454899816, "post_id": 35261618, "comment_id": 58235508, "body": "I see.  I guess in some sense that&#39;s a reasonably interesting way to go about debugging. Maybe it would be nice to have a pluggable thing that can be used on certain applications (I&#39;m guessing websites?)  In any case, in that situation I think probably this isn&#39;t the best way to go about it. You&#39;ll probably want to consider some template haskell to get the line number. See this answer: <a href=\"http://stackoverflow.com/a/13407182/154152\">stackoverflow.com/a/13407182/154152</a>  It&#39;d be interesting to see if you can make this a nice tool to aid debugging. I&#39;m not sure how robust all this is under inlining of functions, etc."}, {"owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "edited": false, "score": 0, "creation_date": 1454901545, "post_id": 35261618, "comment_id": 58235752, "body": "I&#39;ve actually made it into a really cute tool, with logging levels and the ability to disable printing of markers when a debug flag is set ( <a href=\"https://github.com/JohnReedLOL/JohnsUtils\" rel=\"nofollow noreferrer\">github.com/JohnReedLOL/JohnsUtils</a> - <a href=\"https://github.com/JohnReedLOL/JohnsUtils/blob/master/src/info/collaboration_station/utilities/Printer.java\" rel=\"nofollow noreferrer\">github.com/JohnReedLOL/JohnsUtils/blob/master/src/info/&hellip;</a> ) . I like it a lot better than going through a large code base line by line in a single direction. The IDE requires more than just a line number - it wants a full line from a stack trace (like the same as a java stack trace) so that when you click on it you go to that line."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 4, "creation_date": 1454930225, "post_id": 35261618, "comment_id": 58247915, "body": "This template-haskell based approach has essentially been obsoleted by <a href=\"http://haddock.stackage.org/lts-5.2/base-4.8.2.0/GHC-Stack.html#t:CallStack\" rel=\"nofollow noreferrer\">modern ghc features</a>."}, {"owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1454957468, "post_id": 35261618, "comment_id": 58265588, "body": "@user2407038 - I think I found this function called &quot;traceStack&quot; that &quot;prints a call stack if one is available&quot;. It would be nice if the &quot;traceStack&quot; function only printed a single one line stack trace and it formatted it same way Java formats its exception stack traces so that it makes a clickable hyperlink in the IntelliJ terminal. It would be nice if these functions also had an &quot;off&quot; switch - like a value that I could set to &quot;false&quot; to turn off all printing to the terminal."}, {"owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "edited": false, "score": 0, "creation_date": 1454962298, "post_id": 35261618, "comment_id": 58268358, "body": "@NoonSilk - I forgot the second most important thing. Every print statement also contains the name of the thread from whence the statement originated. So if you have one thread called &quot;main&quot;, another called &quot;database&quot;, and a third called &quot;gui&quot;, you can see what they&#39;re doing and what function is being called by what thread without needing to make use of fancy multi-threaded debuggers."}, {"owner": {"reputation": 3411, "user_id": 69663, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aiMZN.png?s=128&g=1", "display_name": "unhammer", "link": "https://stackoverflow.com/users/69663/unhammer"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1499414002, "post_id": 35261618, "comment_id": 76905622, "body": "@user2407038 does that work in ghc 7.10? (7.8.4 at least complains about the <code>?</code>). Btw, you might want to add it as an answer, since it doesn&#39;t require <code>-prof</code>, which it seems traceStack does."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 3411, "user_id": 69663, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aiMZN.png?s=128&g=1", "display_name": "unhammer", "link": "https://stackoverflow.com/users/69663/unhammer"}, "edited": false, "score": 1, "creation_date": 1499453617, "post_id": 35261618, "comment_id": 76930836, "body": "@unhammer It works on every version of GHC still available on the GHC website, going back 9 (!) years. <a href=\"https://downloads.haskell.org/~ghc/6.10.1/docs/html/users_guide/other-type-extensions.html#implicit-parameters\" rel=\"nofollow noreferrer\">Here</a> is the oldest version of the docs I could find which describe it (of course, read the modern version - that link is just for the curious). You need to enable an extension, <code>-XImplicitParams</code>, but you can use <code>CallStack</code> directly without it. If you feel it warrants an answer, feel free to write the answer of your choosing :)"}], "tags": [], "owner": {"reputation": 51525, "user_id": 154152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tbD5u.jpg?s=128&g=1", "display_name": "Noon Silk", "link": "https://stackoverflow.com/users/154152/noon-silk"}, "is_accepted": false, "score": 3, "last_activity_date": 1454898809, "creation_date": 1454898809, "answer_id": 35261618, "question_id": 35261366, "link": "https://stackoverflow.com/questions/35261366/how-to-print-with-line-number-and-stack-trace-in-haskell/35261618#35261618", "title": "How to print with line number and stack trace in Haskell?", "body": "<p>One option appears to be the use of a library like <a href=\"https://hackage.haskell.org/package/loch-th/docs/Debug-Trace-LocationTH.html\" rel=\"nofollow\">loc-th</a> where you can, for example, write an error message with the line information:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n-- app/Main.hs\nmodule Main where\n\nimport Debug.Trace.LocationTH\n\nmain :: IO ()\nmain = do\n    $failure \"Error\"\n    putStrLn \"Hello\"\n</code></pre>\n\n<p>gives me</p>\n\n<p><code>my-exe: app/Main.hs:10:5-12: Error</code></p>\n\n<p>It also provides a string which one <em>could</em> look at, in order to determine the line number. However, I'd imagine that's a bit frowned upon, depending on your use-case. For example, I wouldn't want to see this method used to just log line numbers.</p>\n\n<p>There's more on Haskell debugging techniques <a href=\"https://wiki.haskell.org/Debugging\" rel=\"nofollow\">here</a>.</p>\n\n<p>Honestly, though, maybe this isn't the greatest idea. What are you planning on doing with the line number?</p>\n"}, {"tags": [], "owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "is_accepted": false, "score": 3, "last_activity_date": 1454956957, "creation_date": 1454956957, "answer_id": 35276934, "question_id": 35261366, "link": "https://stackoverflow.com/questions/35261366/how-to-print-with-line-number-and-stack-trace-in-haskell/35276934#35276934", "title": "How to print with line number and stack trace in Haskell?", "body": "<p>I think I found a solution:</p>\n\n<blockquote>\n  <p>Debug.Trace: Functions for tracing and monitoring execution.</p>\n  \n  <p><strong>traceStack :: String -> a -> a Source</strong></p>\n  \n  <p>like trace, but additionally prints a call stack if one is available.</p>\n  \n  <p>In the current GHC implementation, the call stack is only availble if\n  the program was compiled with -prof; otherwise traceStack behaves\n  exactly like trace. Entries in the call stack correspond to SCC\n  annotations, so it is a good idea to use -fprof-auto or\n  -fprof-auto-calls to add SCC annotations automatically.</p>\n  \n  <p>Since: 4.5.0.0</p>\n</blockquote>\n\n<p>^ <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Debug-Trace.html\" rel=\"nofollow\">https://hackage.haskell.org/package/base-4.8.2.0/docs/Debug-Trace.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 3411, "user_id": 69663, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aiMZN.png?s=128&g=1", "display_name": "unhammer", "link": "https://stackoverflow.com/users/69663/unhammer"}, "is_accepted": false, "score": 2, "last_activity_date": 1499531437, "creation_date": 1499531437, "answer_id": 44988380, "question_id": 35261366, "link": "https://stackoverflow.com/questions/35261366/how-to-print-with-line-number-and-stack-trace-in-haskell/44988380#44988380", "title": "How to print with line number and stack trace in Haskell?", "body": "<p>As noted in @user2407038's <a href=\"https://stackoverflow.com/questions/35261366/how-to-print-with-line-number-and-stack-trace-in-haskell/35261618?noredirect=1#comment58247915_35261618\">comment</a>, modern GHC makes a CallStack available via implicit-parameters, see docs at <a href=\"http://haddock.stackage.org/lts-5.2/base-4.8.2.0/GHC-Stack.html#t:CallStack\" rel=\"nofollow noreferrer\">http://haddock.stackage.org/lts-5.2/base-4.8.2.0/GHC-Stack.html#t:CallStack</a>.</p>\n\n<p>You need the extension <a href=\"https://downloads.haskell.org/~ghc/7.10.1/docs/html/users_guide/other-type-extensions.html#implicit-parameters\" rel=\"nofollow noreferrer\">-XImplicitParams</a>.</p>\n\n<p>Then it's as simple as:</p>\n\n<pre><code>{-# LANGUAGE ImplicitParams #-}\nimport           GHC.Stack\n\nmsgStacktraced :: (?loc :: CallStack) =&gt; String -&gt; IO ()\nmsgStacktraced msg = putStrLn (msg ++ \"\\n\" ++ showCallStack ?loc)\n</code></pre>\n"}], "owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2174, "favorite_count": 3, "answer_count": 3, "score": 4, "last_activity_date": 1499531437, "creation_date": 1454895831, "last_edit_date": 1495540894, "question_id": 35261366, "link": "https://stackoverflow.com/questions/35261366/how-to-print-with-line-number-and-stack-trace-in-haskell", "title": "How to print with line number and stack trace in Haskell?", "body": "<p>I Java I appended this to my print statements and they had a stack trace...</p>\n\n<p><a href=\"https://stackoverflow.com/questions/115008/how-can-we-print-line-numbers-to-the-log-in-java\">How can we print line numbers to the log in java</a></p>\n\n<pre><code>public static int getLineNumber() {\n    // The second row of the stack trace had the caller file name, etc.\n    return Thread.currentThread().getStackTrace()[2];\n}\n</code></pre>\n\n<p>How do I do this is Haskell?</p>\n"}, {"tags": ["haskell", "bytestring"], "comments": [{"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 3, "creation_date": 1454896768, "post_id": 35261349, "comment_id": 58235062, "body": "It&#39;s the length of the ByteString as a 64-bit (8 byte) number.  If you want a specific format for your output, you should not be using the Binary class."}, {"owner": {"reputation": 46, "user_id": 688864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3716bc8e723aead2f1390be9f5a20be?s=128&d=identicon&r=PG", "display_name": "uebayasi", "link": "https://stackoverflow.com/users/688864/uebayasi"}, "reply_to_user": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 0, "creation_date": 1454903051, "post_id": 35261349, "comment_id": 58236020, "body": "After rereading the documentation, makes sense.  I started looking at Data.Binary.Get and Data.Binary.Put but somehow ended up with using Data.Binary."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "reply_to_user": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 0, "creation_date": 1457151604, "post_id": 35261349, "comment_id": 59288893, "body": "@DerekElkins since your comment answered the question, you should provide it as an answer..."}], "answers": [{"tags": [], "owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "is_accepted": false, "score": 1, "last_activity_date": 1457153785, "creation_date": 1457153785, "answer_id": 35810198, "question_id": 35261349, "link": "https://stackoverflow.com/questions/35261349/how-to-output-minimal-binary-using-data-binary-and-data-bytestring-lazy/35810198#35810198", "title": "How to output minimal binary using Data.Binary and Data.ByteString.Lazy?", "body": "<p>From my comment, the explanation of the output is that the format <code>Binary</code> currently uses for serializing <code>ByteString</code>s is to output the length as a 64-bit integer followed by the contents of the <code>ByteString</code>.</p>\n\n<p>Generally, though, the <code>Binary</code> class is of limited use.  There's no guarantee of forward or backward compatibility, no mechanism to even allow for schema evolution, no standard or specification for the instances to allow cross-language interoperability.  It's really only useful if you want an opaque binary blob that you will only store temporarily and/or communicate with nodes that you have a high level of control over.  As a consumer, this is all you can expect of a <code>Binary</code> instance.  While there is no reason not to make a <code>Binary</code> instance for a type for which you create serialization code, if you offer any guarantees beyond the above you should probably (also) present it separately from the <code>Binary</code> class.  Ideally, as an instance of some class which communicates those extra guarantees, e.g. a class for serializing to a specific format such as <a href=\"https://avro.apache.org/\" rel=\"nofollow\">Avro</a>.</p>\n\n<p>All this is only directed at the <code>Binary</code> class.  The rest of the <code>binary</code> package is quite useful for its intended purpose.</p>\n"}], "owner": {"reputation": 46, "user_id": 688864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3716bc8e723aead2f1390be9f5a20be?s=128&d=identicon&r=PG", "display_name": "uebayasi", "link": "https://stackoverflow.com/users/688864/uebayasi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1457153785, "creation_date": 1454895658, "question_id": 35261349, "link": "https://stackoverflow.com/questions/35261349/how-to-output-minimal-binary-using-data-binary-and-data-bytestring-lazy", "title": "How to output minimal binary using Data.Binary and Data.ByteString.Lazy?", "body": "<p>Minimal test code (bs.hs):</p>\n\n<pre><code>import qualified Data.Binary as B\nimport qualified Data.ByteString.Lazy.Char8 as BSLC\n\nmain = do\n    BSLC.putStr $ B.encode $ Pad $ BSLC.pack \"xxx\"\n\ndata Pad = Pad BSLC.ByteString\ninstance B.Binary Pad where\n    put (Pad p) = do\n        B.put p\n    get = do\n        p &lt;- B.get\n        return $ Pad p\n</code></pre>\n\n<p>And I get:</p>\n\n<pre><code>% runghc bs.hs | od -c\n0000000   \\0  \\0  \\0  \\0  \\0  \\0  \\0 003   x   x   x                    \n0000013\n% ghc --version\nThe Glorious Glasgow Haskell Compilation System, version 7.10.2\n</code></pre>\n\n<p>I expect to get \"xxx\".  I have no idea how the first 8 bytes (7 x \\0 + 1 x 003) come from.</p>\n"}, {"tags": ["haskell", "intellij-idea"], "comments": [{"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1454903395, "post_id": 35259912, "comment_id": 58236078, "body": "I only have very limited knowledge of Java, but by the <a href=\"https://github.com/atsky/haskell-idea-plugin/blob/master/plugin/src/org/jetbrains/haskell/doc/HaskellQuickDocumentationProvider.kt\" rel=\"nofollow noreferrer\">source</a> I guess it&#39;s not implemented."}, {"owner": {"reputation": 7054, "user_id": 1313611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9ee895c4ad3fa29cf3aaa4abddda289f?s=128&d=identicon&r=PG", "display_name": "pyrospade", "link": "https://stackoverflow.com/users/1313611/pyrospade"}, "edited": false, "score": 0, "creation_date": 1454934574, "post_id": 35259912, "comment_id": 58250547, "body": "Hi, I&#39;m the primary author of HaskForce.  It sounds like we have two questions here, how to get documentation, and then how to do a basic &quot;hello world&quot;.  The documentation lookup is very simple in HaskForce, and there are some outstanding issues to enhance it.  As for &quot;hello world&quot;, if you are facing an issue please submit a ticket on the GitHub issue tracker with details about the problems you are experiencing - <a href=\"https://github.com/carymrobbins/intellij-haskforce/issues\" rel=\"nofollow noreferrer\">github.com/carymrobbins/intellij-haskforce/issues</a>"}, {"owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "reply_to_user": {"reputation": 7054, "user_id": 1313611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9ee895c4ad3fa29cf3aaa4abddda289f?s=128&d=identicon&r=PG", "display_name": "pyrospade", "link": "https://stackoverflow.com/users/1313611/pyrospade"}, "edited": false, "score": 0, "creation_date": 1454956254, "post_id": 35259912, "comment_id": 58264902, "body": "@pyrospade - I added the full description with screenshots to &quot;Update on Haskforce&quot;."}, {"owner": {"reputation": 7054, "user_id": 1313611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9ee895c4ad3fa29cf3aaa4abddda289f?s=128&d=identicon&r=PG", "display_name": "pyrospade", "link": "https://stackoverflow.com/users/1313611/pyrospade"}, "edited": false, "score": 0, "creation_date": 1454963163, "post_id": 35259912, "comment_id": 58268855, "body": "@MichaelLafayette - It looks like you have <code>base &gt;=4.7 &amp;&amp; &lt;5</code> as a dependency in your <code>.cabal</code> file, but your compiler only has up to <code>4.6</code> according to the error message.  You should probably update the <code>.cabal</code> file to use <code>base &gt;=4.6 &amp;&amp; &lt;5</code> as the dependency.  It seems like you may have started this out as a stack project, then switched to cabal without updating your dependencies."}, {"owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "reply_to_user": {"reputation": 7054, "user_id": 1313611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9ee895c4ad3fa29cf3aaa4abddda289f?s=128&d=identicon&r=PG", "display_name": "pyrospade", "link": "https://stackoverflow.com/users/1313611/pyrospade"}, "edited": false, "score": 0, "creation_date": 1454967640, "post_id": 35259912, "comment_id": 58271363, "body": "@pyrospade - All I did was &quot;File &gt; New &gt; Project &gt; Haskell &gt; Build with Cabal &gt; Next&quot; and it automatically creates a Project.cabal file with &quot;build-depends: base &gt;= 4.7 &amp;&amp; &lt; 5&quot;. Also, even though it runs with &quot;base &gt;= 4.6 &amp;&amp; &lt; 5&quot;, the auto-complete does not work at all, not even for &quot;putStrLn&quot;. I type -- &quot;putStr&quot; <i>Ctr-Space</i> -- and I get &quot;HaskForce: no completion found.&quot; Also, debug mode (Shift + F9) doesn&#39;t even print &quot;Hello World&quot;."}, {"owner": {"reputation": 7054, "user_id": 1313611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9ee895c4ad3fa29cf3aaa4abddda289f?s=128&d=identicon&r=PG", "display_name": "pyrospade", "link": "https://stackoverflow.com/users/1313611/pyrospade"}, "edited": false, "score": 0, "creation_date": 1454971078, "post_id": 35259912, "comment_id": 58272877, "body": "@MichaelLafayette - This would probably be easier to work through if you open an issue on the github issue tracker (I don&#39;t get reasonable notifications from stack exchange).  You could also ping me on #haskforce on freenode IRC (I&#39;m crobbins) so we could have the conversation real-time."}], "answers": [{"tags": [], "owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "is_accepted": false, "score": 4, "last_activity_date": 1455062216, "creation_date": 1455062216, "answer_id": 35304522, "question_id": 35259912, "link": "https://stackoverflow.com/questions/35259912/how-to-get-haskell-documentation-to-appear-in-intellij/35304522#35304522", "title": "How to get Haskell Documentation to appear in IntelliJ?", "body": "<p>The solution is to use the Hoogle plugin. IntelliJ has a HoogleIt plugin (Ctr-Shift-H) that searches for Haskell functions in Hoogle. Atom text editor has a similar plugin. </p>\n\n<p>Javadoc style documentation is not available for Haskell in the IDE.</p>\n"}, {"tags": [], "owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "is_accepted": false, "score": 0, "last_activity_date": 1455086483, "creation_date": 1455086483, "answer_id": 35308477, "question_id": 35259912, "link": "https://stackoverflow.com/questions/35259912/how-to-get-haskell-documentation-to-appear-in-intellij/35308477#35308477", "title": "How to get Haskell Documentation to appear in IntelliJ?", "body": "<p>Alright. I'm answering my own question again. I think if you install the newest EclipseFP and configure it correctly, you can get auto-complete with documentation.</p>\n\n<p>See picture:</p>\n\n<p><a href=\"https://i.stack.imgur.com/D1D44.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D1D44.png\" alt=\"Documentation\"></a></p>\n\n<p>^ Note that EclipseFP is not download-and-run like Java Hello World. It apparently needs some configuring.</p>\n\n<p>First install:</p>\n\n<p><a href=\"http://eclipsefp.github.io/install.html\" rel=\"nofollow noreferrer\">http://eclipsefp.github.io/install.html</a></p>\n\n<p>Then do \"Extra configuration steps\"</p>\n"}], "owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 960, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1455086483, "creation_date": 1454883957, "last_edit_date": 1455062294, "question_id": 35259912, "link": "https://stackoverflow.com/questions/35259912/how-to-get-haskell-documentation-to-appear-in-intellij", "title": "How to get Haskell Documentation to appear in IntelliJ?", "body": "<p>Haskell has documentation for \"putStrLn\" here...</p>\n\n<p><a href=\"https://www.haskell.org/hoogle/?q=putStrLn\" rel=\"nofollow noreferrer\">https://www.haskell.org/hoogle/?q=putStrLn</a></p>\n\n<p>But when I use the IntelliJ IDE (default Haskell plugin), I don't get documentation. Auto-complete works for \"putStrLn\", and it says \"String -> IO()\" in the auto-complete menu, but when I press Ctr-Q or Ctr-Space, it says \"No documentation found.\"</p>\n\n<p>How do I get pop-up documentation for Haskell in IntelliJ?</p>\n\n<p>Trying alternative \"HaskForce\" plugin. Cannot figure out how to do basic \"hello world\".</p>\n\n<p><strong>* Update on Haskforce *</strong></p>\n\n<p>-- Start with getting the basic Haskell stuff:</p>\n\n<p><a href=\"https://eschulte.github.io/emacs24-starter-kit/starter-kit-haskell.html\" rel=\"nofollow noreferrer\">https://eschulte.github.io/emacs24-starter-kit/starter-kit-haskell.html</a></p>\n\n<p>-- Then get Haskforce (and uninstall Haskell Plugin for IntelliJ)</p>\n\n<p><a href=\"https://i.stack.imgur.com/fWMcA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fWMcA.png\" alt=\"Haskforce Plugin\"></a></p>\n\n<p>-- Then set up the tools in \"Settings\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/s7m4N.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s7m4N.png\" alt=\"Haskforce Tools\"></a></p>\n\n<p>-- Set compiler settings</p>\n\n<p><a href=\"https://i.stack.imgur.com/QJlJP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QJlJP.png\" alt=\"Haskforce compiler settings\"></a></p>\n\n<p>^ I turned on \"Install Cabal Dependencies\" because when it was off I got this nasty message on Run:</p>\n\n<pre><code>Information:cabal: Install dependencies\nInformation:cabal: cabal: Could not resolve dependencies:\nInformation:cabal: next goal: base (dependency of HaskforceProject-0.1.0.0)\nInformation:cabal: base&gt;=4.7 &amp;&amp; &lt;5)\nInformation:cabal: 4.6.0.0, 4.5.1.0, 4.5.0.0, 4.4.1.0, 4.4.0.0, 4.3.1.0, 4.3.0.0, 4.2.0.2,\nInformation:cabal: requires installed instance)\nInformation:cabal: null\nInformation:2/8/16 1:23 PM - Compilation completed with 1 error and 0 warnings in 1s 650ms\nError:cabal: install dependencies failed.\n</code></pre>\n\n<p>Set run configuration (\"Run > Edit Configuration\" must be done before clicking Run arrow):</p>\n\n<p><a href=\"https://i.stack.imgur.com/2pCVd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2pCVd.png\" alt=\"Run Configuration\"></a></p>\n\n<p>When I click the arrow to run, I get this message:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Yqx0i.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Yqx0i.png\" alt=\"Not Working\"></a></p>\n\n<pre><code>ghc-modi error\nUnable to parse problems from ghc-modi: cabal: At least the following dependencies are missing: base &gt;=4.7 &amp;&amp; 5 ghc-mod: readProcess: cabal \"configure\" \"--with-ghc=ghc\" \"--flags\" \"\" (exit 1): failed\n</code></pre>\n\n<p>Note that these screenshots are from a fresh install of Ubuntu 14.04 with an install of Haskell essentials and Leskah from the Ubuntu apt-get package manager. </p>\n\n<p>Got Haskforce working by changing \"base >=4.7 &amp;&amp; 5\" to \"base >=4.6 &amp;&amp; 5\" in .cabal file, but still no pop-up documentation.</p>\n\n<p><strong>* Update *</strong></p>\n\n<p>Still no pop up documentation, but I got HoogleIt plugin for IntelliJ and a Hoogle plugin for Atom that searches for functions in Hoogle (Haskell Google).</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming", "induction", "bibliography"], "answers": [{"tags": [], "owner": {"reputation": 1286, "user_id": 3668368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51cee76bdb17420321a7f4c9be16ccd9?s=128&d=identicon&r=PG&f=1", "display_name": "Rob11311", "link": "https://stackoverflow.com/users/3668368/rob11311"}, "is_accepted": false, "score": 1, "last_activity_date": 1454881065, "creation_date": 1454881065, "answer_id": 35259425, "question_id": 35259360, "link": "https://stackoverflow.com/questions/35259360/resource-for-learning-recursion-and-induction-over-lists-and-trees/35259425#35259425", "title": "Resource for learning recursion and induction over lists and trees?", "body": "<p>May be <a href=\"https://www.cs.kent.ac.uk/people/staff/sjt/Haskell_craft/toc.html\" rel=\"nofollow\">The Craft of Functional Programming </a></p>\n"}], "owner": {"reputation": 921, "user_id": 5393744, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10153636753988088/picture?type=large", "display_name": "Martin Copes", "link": "https://stackoverflow.com/users/5393744/martin-copes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "closed_date": 1454885456, "answer_count": 1, "score": 0, "last_activity_date": 1454881418, "creation_date": 1454880646, "question_id": 35259360, "link": "https://stackoverflow.com/questions/35259360/resource-for-learning-recursion-and-induction-over-lists-and-trees", "closed_reason": "Not suitable for this site", "title": "Resource for learning recursion and induction over lists and trees?", "body": "<p>I am writing a course on Functional Programming and one of the modules in the course covers lists, and another one cover trees. Both modules center on recursion and induction over these datatypes. I am seeking some material that covers these topics in order to include it as part of the course's bibliography. </p>\n\n<p>Can anyone please link to a good resource (preferably a book) where I can find these topics explained?</p>\n"}, {"tags": ["haskell", "command-line-arguments"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1454878927, "post_id": 35259054, "comment_id": 58230571, "body": "Do you always want to terminate your program? Or do you just want to show usage/help information if the user uses a wrong argument or <code>-h</code>?"}, {"owner": {"reputation": 1804, "user_id": 1260229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a918b56d3f83f46ced68b33737396b87?s=128&d=identicon&r=PG", "display_name": "sn&#248;reven", "link": "https://stackoverflow.com/users/1260229/sn%c3%b8reven"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1454879030, "post_id": 35259054, "comment_id": 58230610, "body": "<b>After</b> parsing I&#39;m checking if given strings are in correct format and want to terminate with a normal error message and usage information based on <code>options</code> if they are not. Argument handling/parsing is working fine."}, {"owner": {"reputation": 106969, "user_id": 189179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bab16b3716e0e72b8b1a7741d68f5ee2?s=128&d=identicon&r=PG", "display_name": "Ben James", "link": "https://stackoverflow.com/users/189179/ben-james"}, "edited": false, "score": 1, "creation_date": 1454880476, "post_id": 35259054, "comment_id": 58231060, "body": "If you are checking the format of the strings individually, you could achieve this by defining your own <a href=\"https://hackage.haskell.org/package/optparse-applicative-0.12.1.0/docs/Options-Applicative-Builder.html#t:ReadM\" rel=\"nofollow noreferrer\">ReadM</a> and using it with <code>option</code> (instead of using <code>strOption</code>)."}, {"owner": {"reputation": 1804, "user_id": 1260229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a918b56d3f83f46ced68b33737396b87?s=128&d=identicon&r=PG", "display_name": "sn&#248;reven", "link": "https://stackoverflow.com/users/1260229/sn%c3%b8reven"}, "reply_to_user": {"reputation": 106969, "user_id": 189179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bab16b3716e0e72b8b1a7741d68f5ee2?s=128&d=identicon&r=PG", "display_name": "Ben James", "link": "https://stackoverflow.com/users/189179/ben-james"}, "edited": false, "score": 0, "creation_date": 1454880781, "post_id": 35259054, "comment_id": 58231135, "body": "@ben-james: OK, but what if I have more complex checks that depend on other values not yet parsed? Isn&#39;t there a way to render a &quot;standard error + usage info&quot; generated from <code>options</code> from outside the applicative <code>options</code> definition?"}], "answers": [{"tags": [], "owner": {"reputation": 1804, "user_id": 1260229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a918b56d3f83f46ced68b33737396b87?s=128&d=identicon&r=PG", "display_name": "sn&#248;reven", "link": "https://stackoverflow.com/users/1260229/sn%c3%b8reven"}, "is_accepted": true, "score": 1, "last_activity_date": 1455552204, "creation_date": 1455552204, "answer_id": 35413820, "question_id": 35259054, "link": "https://stackoverflow.com/questions/35259054/optparse-applicative-generate-usage-information-with-custom-error-message-from/35413820#35413820", "title": "optparse-applicative: Generate usage information with custom error message from options definition", "body": "<p>It can be done using the <code>parserFailure</code> function from <code>Options.Applicative.Extra</code>:</p>\n\n<pre><code>renderError :: Context -&gt; String -&gt; IO ()                                       \nrenderError c msg = handleParseResult . Failure $                               \n                        parserFailure argPrefs argInfo (ErrorMsg msg) [c]\n</code></pre>\n\n<p>In the current version 0.12.0.1 <code>Context</code> has to be imported from <code>Options.Applicative.Internal</code>, this will change. <code>Context</code> constructor takes name of subparser and <code>ParserInfo</code> (the <code>info (handleServe &lt;$&gt; ...</code> part) that is used to render usage information.</p>\n"}], "owner": {"reputation": 1804, "user_id": 1260229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a918b56d3f83f46ced68b33737396b87?s=128&d=identicon&r=PG", "display_name": "sn&#248;reven", "link": "https://stackoverflow.com/users/1260229/sn%c3%b8reven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 1, "accepted_answer_id": 35413820, "answer_count": 1, "score": 2, "last_activity_date": 1455552204, "creation_date": 1454878788, "last_edit_date": 1454946115, "question_id": 35259054, "link": "https://stackoverflow.com/questions/35259054/optparse-applicative-generate-usage-information-with-custom-error-message-from", "title": "optparse-applicative: Generate usage information with custom error message from options definition", "body": "<p>I am populating an <code>Opts</code> type with constructor <code>SrvOpts</code> that stores the command-line arguments:</p>\n\n<pre><code>main :: IO ()\nmain = join $ customExecParser cf $ info options\n           (fullDesc &lt;&gt; header \"header\" &lt;&gt; footer \"footer\")\n    where cf = defaultPrefs { prefShowHelpOnError=True }\n\noptions :: Parser (IO ())\noptions = subparser $\n    command \"serve\" (info (handleServe &lt;$&gt; (SrvOpts\n            &lt;$&gt; strOption [...]\n</code></pre>\n\n<p>The function <code>handleServe</code> takes the data and then does some further validation.</p>\n\n<p>How can I terminate the program with a custom error message and normal <em>optparse-applicative</em>-style usage information generated from <code>options</code> from inside <code>handleServe</code>?</p>\n"}, {"tags": ["haskell", "ghci", "haskell-prelude"], "comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 1, "creation_date": 1454874088, "post_id": 35258147, "comment_id": 58228699, "body": "in the function definition, put the entire pattern inside parenthesis like <code>(Goofed ...)</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454874160, "post_id": 35258147, "comment_id": 58228731, "body": "also it&#39;s a bit strange to mix the valid with some invalid states - why don&#39;t you just represent the valid ones and use some score/game counter to account for penalties (I guess you will anyway)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 0, "creation_date": 1454874198, "post_id": 35258147, "comment_id": 58228746, "body": "btw @behzad.nouri you should make this into an answer ;)"}], "owner": {"reputation": 51, "user_id": 5188622, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3bd98c7e0c526724730137041a25d58e?s=128&d=identicon&r=PG&f=1", "display_name": "AVC", "link": "https://stackoverflow.com/users/5188622/avc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "closed_date": 1454874683, "answer_count": 0, "score": 0, "last_activity_date": 1512975603, "creation_date": 1454873935, "last_edit_date": 1512975603, "question_id": 35258147, "link": "https://stackoverflow.com/questions/35258147/passing-constructors-and-data-as-arguments-in-haskell", "closed_reason": "Duplicate", "title": "Passing constructors and Data as arguments in Haskell", "body": "<p>I am trying to build a small error checker for a game I am working on and I am unsure of how to pass Data types as arguments. here is what I am trying to do\nthis is the file where my data arguments are</p>\n\n<pre><code>-- | Represents the type of move played in a 'GameState'.\ndata Played = Played ((Int, Int), (Int, Int)) -- ^ A \"normal\" move.\n            | Passed                          -- ^ A (legal) pass.\n            | Goofed ((Int, Int), (Int, Int)) -- ^ An illegal move, penalty applied.\n            | Init                            -- ^ No one has moved yet.\n            | UpgradedPawn2Knight (Int,Int)   -- ^ A pawn reached the other side when &lt;2 knights.\n            | PlacedPawn ((Int, Int), (Int, Int)) -- ^ A pawn that's been placed in any empty space after having reached the far end of the board.\n            | BadPlacedPawn ((Int, Int), (Int, Int)) -- ^ A strategy has attempted to do a pawn placement, but chose an invalid location.\n</code></pre>\n\n<p>And here is my code trying to implement a function based on these game states</p>\n\n<pre><code>prevPenalty :: Played -&gt; Int\nprevPenalty Init = 0\nprevPenalty Goofed ((a, b),(c, d)) = 1\nprevPenalty Passed ((a, b),(c, d)) = 0\n\n\ncurrentPenalty :: Played -&gt; Int\ncurrentPenalty Goofed ((a, b),(c, d)) = 1 + prevPenalty\ncurrentPenalty Passed ((a, b),(c, d)) = 0 + prevPenalty\n</code></pre>\n\n<p>However, at compile time this error appears </p>\n\n<pre><code>Penalty.hs:22:1:\n    Equations for \u2018prevPenalty\u2019 have different numbers of arguments\n      Penalty.hs:22:1-20\n      Penalty.hs:23:1-38\n\nPenalty.hs:28:1:\n    Couldn't match expected type \u2018t0 -&gt; t1\u2019 with actual type \u2018Int\u2019\n    The equation(s) for \u2018currentPenalty\u2019 have two arguments,\n    but its type \u2018Played -&gt; Int\u2019 has only one\n</code></pre>\n\n<p>I cant figure out how else to fix this... Anyone have any suggestions?</p>\n"}, {"tags": ["haskell", "leksah"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454874861, "post_id": 35257487, "comment_id": 58229007, "body": "IMO the way you went is definitely recommended ... as long as you are happy with the result you should not put that much stuff into unprotected (aka non-sandboxes/non-stack) land"}, {"owner": {"reputation": 630, "user_id": 6707737, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bc7b6d3815e8d4e653eea177739b3558?s=128&d=identicon&r=PG&f=1", "display_name": "Yan.F", "link": "https://stackoverflow.com/users/6707737/yan-f"}, "edited": false, "score": 0, "creation_date": 1533223876, "post_id": 35257487, "comment_id": 90278391, "body": "All the dependencies are messy and out of control, leksah is a lazy, buggy mess, this is why going open source is sometimes bad."}], "answers": [{"tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": false, "score": 1, "last_activity_date": 1454873391, "creation_date": 1454873391, "answer_id": 35258046, "question_id": 35257487, "link": "https://stackoverflow.com/questions/35257487/haskell-ide-leskah-cannot-install/35258046#35258046", "title": "Haskell IDE Leskah cannot install", "body": "<p>Here we are in the first ring of dependency hell: hlint wants haskell-src-exts in the range [1.17, 1.18) and leksah wants it in the range [1.13.5, 1.17). If we wanted to build the project rather than use apt-get, we can </p>\n\n<ul>\n<li>wait for the leksah package maintainer to update the upper bound,</li>\n<li>do it ourselves,</li>\n<li>or clone leksah/leksah and use <code>stack build</code>.</li>\n</ul>\n\n<p>Leksah has a <a href=\"https://github.com/leksah/leksah/blob/master/stack.yaml\" rel=\"nofollow\">stack.yaml</a> set up, which means it should Just Work\u2122 with <a href=\"https://github.com/commercialhaskell/stack\" rel=\"nofollow\">stack</a>. Note that bullet one seems unlikely. The leksah project sadly is in a state of stasis.</p>\n"}], "owner": {"reputation": 2650, "user_id": 4993125, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/FaHVT.jpg?s=128&g=1", "display_name": "Michael Lafayette", "link": "https://stackoverflow.com/users/4993125/michael-lafayette"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1454873391, "creation_date": 1454870423, "question_id": 35257487, "link": "https://stackoverflow.com/questions/35257487/haskell-ide-leskah-cannot-install", "title": "Haskell IDE Leskah cannot install", "body": "<p>First did </p>\n\n<pre><code>sudo apt-get install haskell-platform\n</code></pre>\n\n<p>, then followed these instructions...</p>\n\n<p><a href=\"https://github.com/leksah/leksah#building-on-linux\" rel=\"nofollow\">https://github.com/leksah/leksah#building-on-linux</a></p>\n\n<p>Set PATH in ~/.profile to \"PATH=\"$HOME/.cabal/bin:$PATH\"\"</p>\n\n<pre><code>sudo apt-get install libgtksourceview-3.0-dev libwebkitgtk-3.0-dev\ncabal update\ncabal install Cabal cabal-install\ncabal install regex-tdfa-text --ghc-options=-XFlexibleContexts\ncabal install alex happy\ncabal install gtk2hs-buildtools\ncabal install leksah\nleksah\n</code></pre>\n\n<p>Got this horrendous error message on \"cabal install leksah\"...</p>\n\n<pre><code>Installing executable(s) in /home/johnreedlol/.cabal/bin\nInstalled gtk2hs-buildtools-0.13.0.5\njohnreedlol@johnreedcomputer:~/leksahFolder$ cabal install leksah\nResolving dependencies...\ncabal: Could not resolve dependencies:\ntrying: leksah-0.15.1.4\ntrying: hlint-1.9.28\nrejecting: haskell-src-exts-1.17.1, 1.17.0 (conflict: leksah =&gt;\nhaskell-src-exts&gt;=1.13.5 &amp;&amp; &lt;1.17)\nrejecting: haskell-src-exts-1.16.0.1, 1.16.0, 1.15.0.1, 1.15.0, 1.14.0.1,\n1.14.0, 1.13.5 (conflict: hlint =&gt; haskell-src-exts&gt;=1.17 &amp;&amp; &lt;1.18)\nrejecting: haskell-src-exts-1.13.4, 1.13.3, 1.13.2, 1.13.1, 1.13.0, 1.12.0,\n1.11.1, 1.10.2, 1.10.1, 1.10.0, 1.9.6, 1.9.5, 1.9.4, 1.9.3, 1.9.0, 1.8.2,\n1.8.1, 1.8.0, 1.7.2, 1.7.1, 1.7.0, 1.6.1, 1.6.0, 1.5.3, 1.5.2, 1.5.1, 1.5.0,\n1.4.0, 1.3.5, 1.3.4, 1.3.3, 1.3.2, 1.3.1, 1.3.0, 1.2.0, 1.1.4, 1.1.3.1, 1.1.3,\n1.1.1, 1.1.0, 1.0.1, 1.0.0, 0.5.7, 0.5.6, 0.5.5, 0.5.4, 0.5.3, 0.5.2, 0.4.8,\n0.4.6, 0.4.5, 0.4.4.1, 0.4.4, 0.4.3.1, 0.4.3, 0.4.2, 0.4.1, 0.3.12, 0.3.11,\n0.3.10, 0.3.9, 0.3.7, 0.3.5, 0.3.4, 0.3.3, 0.3.2, 0.2.1 (conflict: leksah =&gt;\nhaskell-src-exts&gt;=1.13.5 &amp;&amp; &lt;1.17)\njohnreedlol@johnreedcomputer:~/leksahFolder$\n</code></pre>\n\n<p>Ultimately went with \"sudo apt-get install leksah\"</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 62908, "user_id": 567620, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/g8HIM.jpg?s=128&g=1", "display_name": "ely", "link": "https://stackoverflow.com/users/567620/ely"}, "edited": false, "score": 0, "creation_date": 1454866573, "post_id": 35256622, "comment_id": 58225763, "body": "I may be misunderstanding, but it seems like you could also just use the helper function you provided. Then it could be <code>detectWord needle lm = isInfixOf needle (stringOfLogMessage lm)</code>. The view pattern is nice, I&#39;m just thinking out loud that it looks like it&#39;s not necessary. It looks like my confusion was that I did not consider the idea of writing the helper function as a means for abstracting away the pattern matched conversion to string -- I only thought of the helper function in terms of the &quot;right hand side&quot; logic being used."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454879021, "post_id": 35256622, "comment_id": 58230606, "body": "I for one tend to find view patterns very confusing. Maybe I&#39;m just not sufficiently accustomed to their syntax, but I can never seem to remember which part goes where."}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1454879127, "post_id": 35256622, "comment_id": 58230636, "body": "the way i think of it: foo x y is really foo (id -&gt; x) (id -&gt; y)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454879811, "post_id": 35256622, "comment_id": 58230856, "body": "I think what <i>I&#39;d</i> do when designing an abstract datatype is almost certainly to write the appropriate pattern synonyms (once!) with the user&#39;s guide open, so users don&#39;t have to think about special syntax."}], "tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": false, "score": 4, "last_activity_date": 1454866978, "last_edit_date": 1454866978, "creation_date": 1454865958, "answer_id": 35256622, "question_id": 35256473, "link": "https://stackoverflow.com/questions/35256473/avoid-repeating-code-when-reusing-for-multiple-value-constructor-pattern-matches/35256622#35256622", "title": "Avoid repeating code when reusing for multiple value constructor pattern matches", "body": "<h2>Simple, won't make people hate you</h2>\n\n<p>Try using <a href=\"https://ghc.haskell.org/trac/ghc/wiki/ViewPatterns\" rel=\"nofollow\">view patterns</a>.</p>\n\n\n\n<pre><code>{-# LANGUAGE ViewPatterns #-}\n\ndata LogMessage = Unknown String\n                | LogMessage MessageType TimeStamp String\n\nstringOfLogMessage :: LogMessage -&gt; String\nstringOfLogMessage (Unknown s) = s\nstringOfLogMessage (LogMessage _ _ s) = s\n\ndetectWord :: String -&gt; LogMessage -&gt; Bool\ndetectWord needle (stringOfLogMessage -&gt; hay) =\n  needle `isInfixOf` map toLower hay\n</code></pre>\n\n<h2>Complicated, might make people hate you</h2>\n\n<p>Use <a href=\"https://wiki.haskell.org/GHC.Generics\" rel=\"nofollow\">Generics</a> and <a href=\"https://hackage.haskell.org/package/lens-4.13.1/docs/Generics-Deriving-Lens.html\" rel=\"nofollow\">Generics.Deriving.Lens</a>.</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE NoImplicitPrelude #-}\n\nmodule Lib where\n\nimport BasePrelude\nimport Control.Lens\nimport Generics.Deriving.Lens\n\ndata LogMessage = Unknown String\n                | LogMessage () () String\n                  deriving (Generic)\n\ndetectWord :: String -&gt; LogMessage -&gt; Bool\ndetectWord needle =\n  allOf tinplate (isInfixOf needle . map toLower)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "is_accepted": true, "score": 6, "last_activity_date": 1454892180, "last_edit_date": 1454892180, "creation_date": 1454868182, "answer_id": 35257032, "question_id": 35256473, "link": "https://stackoverflow.com/questions/35256473/avoid-repeating-code-when-reusing-for-multiple-value-constructor-pattern-matches/35257032#35257032", "title": "Avoid repeating code when reusing for multiple value constructor pattern matches", "body": "<p>Write a function that gets the message in either case.  Then, you won't need to write separate cases for uses that don't care:</p>\n\n<pre><code>getMsg (Unknown m) = m\ngetMsg (LogMessage _ _ m) = m\n\ndetectWord s log = infixOf s (map toLower (getMsg log))\n</code></pre>\n\n<p>Note that <em>something</em> is going to have to check the cases of your type, and <code>getMsg</code> is about as minimal as it gets along those lines.</p>\n"}], "owner": {"reputation": 62908, "user_id": 567620, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/g8HIM.jpg?s=128&g=1", "display_name": "ely", "link": "https://stackoverflow.com/users/567620/ely"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 35257032, "answer_count": 2, "score": 5, "last_activity_date": 1454892180, "creation_date": 1454865169, "question_id": 35256473, "link": "https://stackoverflow.com/questions/35256473/avoid-repeating-code-when-reusing-for-multiple-value-constructor-pattern-matches", "title": "Avoid repeating code when reusing for multiple value constructor pattern matches", "body": "<p>Suppose you have a data structure with multiple value constructors, for example a <code>LogMessage</code> data structure like so:</p>\n\n<pre><code>data LogMessage = Unknown String \n                | LogMessage MessageType TimeStamp String\n</code></pre>\n\n<p>If the message can be parsed properly, it has some extra data and then a <code>String</code>. If it can't be parsed, then it's just a catch-all <code>Unknown String</code>.</p>\n\n<p>Or suppose you are working with something like an <code>Either String String</code>, so that you might be dealing with a <code>Left String</code> or a <code>Right String</code>.</p>\n\n<p>Now let's say that you want to apply the same processing steps to the underlying data, regardless of which value constructor it resides in.</p>\n\n<p>For example, I might want to detect a certain word within the <code>LogMessage</code> strings, so I could have a function like this:</p>\n\n<pre><code>detectWord :: String -&gt; LogMessage -&gt; Bool\ndetectWord s (Unknown m)         = isInfixOf s (map toLower m)\ndetectWord s (LogMessage _  _ m) = isInfixOf s (map toLower m)\n</code></pre>\n\n<p>or it could just as easily be written to handle <code>Either String String</code> as input instead of <code>LogMessage</code>.</p>\n\n<p>In both cases, I have to repeat the exact same code (the <code>isInfixOf ...</code> part), because I have to extract the underlying data it will operate on differently due to pattern matching on different value constructors.</p>\n\n<p>It is bad that one must repeat / \"copy-paste\" the code for each different value constructor match.</p>\n\n<p>How does one write these kinds of Haskell functions without copy/paste code? How can I write the underlying logic just once, but then explain how it should be used across many different value constructor patterns? </p>\n\n<p>Simply moving it to a secondary helper function would reduce the character count, but doesn't really solve the issue. For example, the idea below is not substantively any better about \"don't repeat yourself\" than the first case:</p>\n\n<pre><code>helper :: String -&gt; String -&gt; Bool\nhelper s m = isInfixOf s (map toLower m)\n\ndetectWord :: String -&gt; LogMessage -&gt; Bool\ndetectWord s (Unknown m)        = helper s m\ndetectWord s (LogMessage _ _ m) = helper s m\n</code></pre>\n\n<p>There again we have to say the same thing for every different pattern.</p>\n"}, {"tags": ["haskell", "math", "factors"], "answers": [{"comments": [{"owner": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "edited": false, "score": 1, "creation_date": 1454870518, "post_id": 35255008, "comment_id": 58227341, "body": "If duplicated prime factors exist, you can count them rather than keep them as duplicates.  Then, you can avoid duplicate divisors by iterating over the count of each prime, rather than taking the powerset of the full list."}, {"owner": {"reputation": 127, "user_id": 5109064, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-73Y6HtveIxM/AAAAAAAAAAI/AAAAAAAAADQ/e9eKWVZTzrI/photo.jpg?sz=128", "display_name": "Hironobu Nagaya", "link": "https://stackoverflow.com/users/5109064/hironobu-nagaya"}, "reply_to_user": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "edited": false, "score": 0, "creation_date": 1454942880, "post_id": 35255008, "comment_id": 58256297, "body": "@comingstorm I recognized problem on my code. I fixed it and appended updated code. Thank you for your advice."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1455114809, "post_id": 35255008, "comment_id": 58344679, "body": "and how fast are <code>length $ divisors 260620460100</code> and <code>length $ divisors 1000000007</code> on your computer now? :)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1455115604, "post_id": 35255008, "comment_id": 58345235, "body": "<code>behzad.nouri</code>&#39;s code uses all numbers as candidates; yours just primes. Should be faster, right? Except it takes time to generate them first. Your code is still slow -- it uses trial division, not the sieve of Eratosthenes which can be much faster (check out the package <i>arithmoi</i>). But at least for the 2nd run, the same list of primes can be used, that was already calculated before, right? Not unless you give it a <i>monomorphic</i> type signature, like <code>[Int]</code>, or <code>[Integer]</code>. But you gave it <i>polymorphic</i> type, <code>Integral a =&gt; [a]</code>. So it <i>is recalculated</i> each time! :)"}, {"owner": {"reputation": 127, "user_id": 5109064, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-73Y6HtveIxM/AAAAAAAAAAI/AAAAAAAAADQ/e9eKWVZTzrI/photo.jpg?sz=128", "display_name": "Hironobu Nagaya", "link": "https://stackoverflow.com/users/5109064/hironobu-nagaya"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1455172007, "post_id": 35255008, "comment_id": 58372234, "body": "@WillNess My update code takes 0.01 and 56.19 secs to calclate <code>length $ divisors 260620460100</code> and <code>length $ divisors 1000000007</code>. <a href=\"http://stackoverflow.com/questions/35255007/making-a-list-of-divisors-without-dividing-sequentially-in-haskell/35255008?noredirect=1#comment58345235_35255008\">Your comment</a> is the just reason why my code is slow. Fixing type signature and using <code>Math.NumberTheory.Primes.Sieve</code> module, it became faster than <code>behzad.nouri&#39;s</code> code."}, {"owner": {"reputation": 127, "user_id": 5109064, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-73Y6HtveIxM/AAAAAAAAAAI/AAAAAAAAADQ/e9eKWVZTzrI/photo.jpg?sz=128", "display_name": "Hironobu Nagaya", "link": "https://stackoverflow.com/users/5109064/hironobu-nagaya"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1455173160, "post_id": 35255008, "comment_id": 58372766, "body": "@WillNess Is it better not to use type signature? I think defining type signature is a good manner because type signature is a important concept on Haskell, but most of Haskell answers does not use type signature."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1455177700, "post_id": 35255008, "comment_id": 58375073, "body": "@HironobuNagaya Haskell takes guidance from the explicitly specified type signature. So you need to know what you&#39;re doing. If you write it wrong, you can cause type errors. Without it, it guesses, and then you have something to start from, if everything fits. OTOH there&#39;s type-directed development, where you <i>start</i> from types, they <i>aid</i> your thinking... -- In this case, you already gave the signature to <code>factors</code>, so the type for <code>divisors</code> in my answer gets deduced correspondingly, so I didn&#39;t  bother. Type signatures are good, esp. in the <i>finished</i> product."}, {"owner": {"reputation": 127, "user_id": 5109064, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-73Y6HtveIxM/AAAAAAAAAAI/AAAAAAAAADQ/e9eKWVZTzrI/photo.jpg?sz=128", "display_name": "Hironobu Nagaya", "link": "https://stackoverflow.com/users/5109064/hironobu-nagaya"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1455281136, "post_id": 35255008, "comment_id": 58431702, "body": "@WillNess My Haskell textbook recommends top-down design development, defining type signatures at first and writing function codes later. I know it is type-directed development now. I thought it is absolutely good to define type signatures. But I understand I can avoid writing it if obviously unneeded. Thank you!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1455285410, "post_id": 35255008, "comment_id": 58434560, "body": "I think it&#39;s better to always have explicit type signature for every module-level definition, especially in the finished code. Here in the answers we&#39;re sometimes a bit careless and hasty. :) (not the best of us) :)"}], "tags": [], "owner": {"reputation": 127, "user_id": 5109064, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-73Y6HtveIxM/AAAAAAAAAAI/AAAAAAAAADQ/e9eKWVZTzrI/photo.jpg?sz=128", "display_name": "Hironobu Nagaya", "link": "https://stackoverflow.com/users/5109064/hironobu-nagaya"}, "is_accepted": false, "score": 3, "last_activity_date": 1454943916, "last_edit_date": 1495542668, "creation_date": 1454857024, "answer_id": 35255008, "question_id": 35255007, "link": "https://stackoverflow.com/questions/35255007/making-a-list-of-divisors-without-dividing-sequentially-in-haskell/35255008#35255008", "title": "Making a list of divisors without dividing sequentially in Haskell", "body": "<p>My own implementation uses power set of prime factors now.</p>\n\n<p>For example, to get list of divisors of <code>30</code>, which prime factor is <code>[2,3,5]</code>,</p>\n\n<ol>\n<li>make the power set of prime factors, <code>[[],[2],[3],[5],[2,3],[2,5],[3,5],[2,3,5]]</code></li>\n<li>product each elements and get result <code>[1,2,3,5,6,10,15,30]</code>, which is list of divisors of <code>30</code></li>\n</ol>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>divisors :: Integral a =&gt; a -&gt; [a]\ndivisors n\n  | n &lt; 1 = []\n  | otherwise = distinct $ map product $ (powerset . factors) n\n\n-- | remove duplicated element in a list\ndistinct :: Eq a =&gt; [a] -&gt; [a]\ndistinct [] = []\ndistinct (x : xs)\n  | x `elem` xs = distinct xs\n  | otherwise = x : distinct xs\n\n-- | generate power set of a list\npowerset :: [a] -&gt; [[a]]\npowerset [] = [[]]\npowerset (x : xs) = xss ++ map (x :) xss where xss = powerset xs\n\n-- | generate prime factors of a integer\nfactors :: Integral a =&gt; a -&gt; [a]\nfactors m = f m (head primes) (tail primes) where\n  f m n ns\n    | m &lt; 2 = []\n    | m &lt; n ^ 2 = [m]\n    | m `mod` n == 0 = n : f (m `div` n) n ns\n    | otherwise = f m (head ns) (tail ns)\n\n-- | prime sequence\nprimes :: Integral a =&gt; [a]\nprimes = 2 : filter (\\n-&gt; head (factors n) == n) [3,5..]\n</code></pre>\n\n<p>In this code, duplicated divisors appear if duplicated prime factors exist.<br>\nI remove duplicated divisors at last step, but it does not fix basic cause of duplication.<br>\nI feel sure that there are more smart ways.</p>\n\n<p><strong>Note:</strong></p>\n\n<ul>\n<li><code>primes</code> and <code>factors</code> are referred from <a href=\"https://stackoverflow.com/questions/21276844/prime-factors-in-haskell/34977654#34977654\">Prime factors in Haskell</a>.</li>\n<li><code>powerset</code> is referred from <a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2003-June/004484.html\" rel=\"nofollow noreferrer\">powerset</a>.</li>\n</ul>\n\n<hr>\n\n<p><strong>Update:</strong></p>\n\n<p>Thanks to <a href=\"https://stackoverflow.com/questions/35255007/making-a-list-of-divisors-without-dividing-sequentially-in-haskell/35255008?noredirect=1#comment58227341_35255008\">comingstorm's advice</a>, I studied more about <em>Data.List</em> module and update my code:</p>\n\n<pre><code>import Data.List (group, subsequences)\n\ndivisors :: Integral a =&gt; a -&gt; [a]\ndivisors = map product . concatMap sequence . subsequences . map (scanr1 (*)) . group . factors\n\nprimes = ...    -- same as before\n\nfactors m = ... -- same as before\n</code></pre>\n\n<p>I noticed that <code>distinct</code> and <code>powerset</code> in original code are same with <code>nub</code> and <code>subsequences</code> in <em>Data.List</em> module.<br>\nIt becomes simple but <a href=\"https://stackoverflow.com/questions/35255007/making-a-list-of-divisors-without-dividing-sequentially-in-haskell/35255729#35255729\">behzad.nouri's code</a> is much faster.</p>\n"}, {"comments": [{"owner": {"reputation": 127, "user_id": 5109064, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-73Y6HtveIxM/AAAAAAAAAAI/AAAAAAAAADQ/e9eKWVZTzrI/photo.jpg?sz=128", "display_name": "Hironobu Nagaya", "link": "https://stackoverflow.com/users/5109064/hironobu-nagaya"}, "edited": false, "score": 1, "creation_date": 1454936266, "post_id": 35255729, "comment_id": 58251630, "body": "On my PC, your implements takes 0.01 and 0.26 secs to complete <code>length $ divisors 260620460100</code> and <code>length $ divisors 1000000007</code> while my implements takes 1.30 and 57.12 secs. How fast your code is! There are some functions I have never seen and I can not understand half of it now. I am studing with your code. Thank you very much!"}, {"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "reply_to_user": {"reputation": 127, "user_id": 5109064, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-73Y6HtveIxM/AAAAAAAAAAI/AAAAAAAAADQ/e9eKWVZTzrI/photo.jpg?sz=128", "display_name": "Hironobu Nagaya", "link": "https://stackoverflow.com/users/5109064/hironobu-nagaya"}, "edited": false, "score": 1, "creation_date": 1454980151, "post_id": 35255729, "comment_id": 58275924, "body": "@HironobuNagaya if you want to understand what <code>&amp;&amp;&amp;</code> does <a href=\"http://stackoverflow.com/a/32550390/625914\">see this answer</a>"}, {"owner": {"reputation": 127, "user_id": 5109064, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-73Y6HtveIxM/AAAAAAAAAAI/AAAAAAAAADQ/e9eKWVZTzrI/photo.jpg?sz=128", "display_name": "Hironobu Nagaya", "link": "https://stackoverflow.com/users/5109064/hironobu-nagaya"}, "edited": false, "score": 1, "creation_date": 1455033088, "post_id": 35255729, "comment_id": 58302646, "body": "I thought it was too early for me to understand <code>&amp;&amp;&amp;</code> because I could not understood what official document meant. But your answer is very instructive with essential code examples and I can understand. Thank you again!"}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": false, "score": 4, "last_activity_date": 1454861128, "creation_date": 1454861128, "answer_id": 35255729, "question_id": 35255007, "link": "https://stackoverflow.com/questions/35255007/making-a-list-of-divisors-without-dividing-sequentially-in-haskell/35255729#35255729", "title": "Making a list of divisors without dividing sequentially in Haskell", "body": "<p>With this code:</p>\n\n<pre><code>import Data.List (group)\nimport Control.Arrow ((&amp;&amp;&amp;))\n\ndivisors n = foldr go [1] . map (head &amp;&amp;&amp; length) . group $ fac n 2\n    where\n    go (_, 0) xs = xs\n    go (p, k) xs = let ys = map (* p) xs in go (p, pred k) ys ++ xs\n    fac n i\n        | n &lt; i * i      = if n == 1 then [] else [n]\n        | n `mod` i == 0 = i: fac (n `div` i) i\n        | otherwise      = fac n $ succ i\n</code></pre>\n\n<p>you will get:</p>\n\n<pre><code>\\&gt; -- print timing/memory stats after each evaluation\n\\&gt; :set +s\n\\&gt; length $ divisors 260620460100\n2187\n(0.01 secs, 0 bytes)\n\\&gt; length $ divisors 1000000007  -- prime number\n2\n(0.08 secs, 13,678,856 bytes)\n</code></pre>\n\n<p>you may compare with your implementation.</p>\n"}, {"comments": [{"owner": {"reputation": 127, "user_id": 5109064, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-73Y6HtveIxM/AAAAAAAAAAI/AAAAAAAAADQ/e9eKWVZTzrI/photo.jpg?sz=128", "display_name": "Hironobu Nagaya", "link": "https://stackoverflow.com/users/5109064/hironobu-nagaya"}, "edited": false, "score": 0, "creation_date": 1455172141, "post_id": 35316830, "comment_id": 58372311, "body": "I executed the same calculation as commented in <a href=\"http://stackoverflow.com/questions/35255007/making-a-list-of-divisors-without-dividing-sequentially-in-haskell/35255729#comment58251630_35255729\">my comment</a> with your code. It takes 0.01 and 0.05 secs!"}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 2, "last_activity_date": 1455184402, "last_edit_date": 1455184402, "creation_date": 1455111578, "answer_id": 35316830, "question_id": 35255007, "link": "https://stackoverflow.com/questions/35255007/making-a-list-of-divisors-without-dividing-sequentially-in-haskell/35316830#35316830", "title": "Making a list of divisors without dividing sequentially in Haskell", "body": "<p>The obligatory monadic code:</p>\n\n<pre><code>import Control.Monad\n\ndivisors = map product . mapM (scanl (*) 1) . group . factors\n</code></pre>\n\n<p>The <code>factors</code> as in your other linked question.</p>\n\n<p>You are already using <code>sequence</code> from List monad, no need to invoke <code>concatMap</code> explicitly (<code>mapM f</code> is equivalent to <code>sequence . map f</code>).</p>\n\n<p>The list won't be ordered though, like the one produced by your original sequentially-dividing <em>O(n)</em> code is &mdash; you could make it <em>O(sqrt(n))</em> with a simple enough trick by the way, though it would still be much slower than this code, on average. </p>\n"}], "owner": {"reputation": 127, "user_id": 5109064, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-73Y6HtveIxM/AAAAAAAAAAI/AAAAAAAAADQ/e9eKWVZTzrI/photo.jpg?sz=128", "display_name": "Hironobu Nagaya", "link": "https://stackoverflow.com/users/5109064/hironobu-nagaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 592, "favorite_count": 1, "accepted_answer_id": 35316830, "answer_count": 3, "score": 3, "last_activity_date": 1455185623, "creation_date": 1454857024, "last_edit_date": 1495535304, "question_id": 35255007, "link": "https://stackoverflow.com/questions/35255007/making-a-list-of-divisors-without-dividing-sequentially-in-haskell", "title": "Making a list of divisors without dividing sequentially in Haskell", "body": "<p>I am studying in Haskell.</p>\n\n<p>I have been implementing a function making a list of divisors.<br>\nMy first code is here:</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>divisors :: Integral a =&gt; a -&gt; [a]\ndivisors n\n  | n &lt; 1 = []\n  | otherwise = filter ((== 0) . (mod n)) [1..n]\n</code></pre>\n\n<p>This code is almost same as <a href=\"https://stackoverflow.com/questions/1480563/making-a-list-of-divisors-in-haskell\">Making a list of divisors in Haskell</a>.<br>\nIt works but slow.</p>\n\n<p>I feel it is not efficient to divide by each of <code>[1..n]</code>.<br>\nIs there another smart way to making a list of divisors?</p>\n\n<p><strong>Update:</strong></p>\n\n<p>In the case of <code>n &lt; 1</code>, <code>[1..n]</code> is the same as <code>[]</code>.<br>\nSo, guard is not required at all:</p>\n\n<pre><code>divisors :: Integral a =&gt; a -&gt; [a]\ndivisors n = filter ((== 0) . (mod n)) [1..n]\n</code></pre>\n"}, {"tags": ["string", "haskell", "char"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1454856949, "last_edit_date": 1454856949, "creation_date": 1454852263, "answer_id": 35254172, "question_id": 35253664, "link": "https://stackoverflow.com/questions/35253664/convert-unique-chars-from-string-to-table-char-int/35254172#35254172", "title": "convert unique chars from string to Table Char Int", "body": "<p>Write an auxiliary function</p>\n\n<pre><code>increment :: (Eq k, Num v) =&gt; Table k v -&gt; k -&gt; Table k v\n</code></pre>\n\n<p>to add one to a value in the table. You can implement it using the table functions you have.</p>\n\n<p>Then scan the string, and increment the table once for every character.</p>\n"}], "owner": {"reputation": 15, "user_id": 5873612, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3c0d1128fedfe256f92955308d24f808?s=128&d=identicon&r=PG&f=1", "display_name": "darrrr", "link": "https://stackoverflow.com/users/5873612/darrrr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454856949, "creation_date": 1454849283, "question_id": 35253664, "link": "https://stackoverflow.com/questions/35253664/convert-unique-chars-from-string-to-table-char-int", "title": "convert unique chars from string to Table Char Int", "body": "<p>Im trying to convert a string to it's unique chars along with an integer counter to the following interface:</p>\n\n<pre><code>empty :: Table k v\ninsert :: Eq k =&gt; Table k v -&gt; k -&gt; v -&gt; Table k v\nexists :: Eq k =&gt; Table k v -&gt; k -&gt; Bool\nlookup :: Eq k =&gt; Table k v -&gt; k -&gt; Maybe v\ndelete :: Eq k =&gt; Table k v -&gt; k -&gt; Table k v\niterate :: Table k v -&gt; (b -&gt; (k, v) -&gt; b) -&gt; b -&gt; b\nkeys :: Table k v -&gt; (b -&gt; k -&gt; b) -&gt; b -&gt; b\nvalues :: Table k v -&gt; (b -&gt; v -&gt; b) -&gt; b -&gt; b\n</code></pre>\n\n<p>My function so far is as follows:</p>\n\n<pre><code>auxCharacterCounts :: String -&gt; Table Char Int\nauxCharacterCounts (x:xs)\n| length (x:xs) &gt; 1 = (Table.insert Table.empty x (length $ filter (\\y -&gt; y == x) (x:xs)))\n</code></pre>\n\n<p>For example passing the string \"sassa\" to <code>auxCharacterCounts</code> and then running a <code>lookup tablename 's'</code> would yield <code>Just 3</code></p>\n\n<p>Giving us the indication that we have 3 occurences of the char 's' in the string \"sassa\". What im stuck at is wrapping my head on how to get the other characters, so to speak running <code>lookup tablename 'a'</code> would yield the result <code>Just 2</code> (against the string \"sassa\")</p>\n\n<p>Im not sure how to run this recursivly, can I pass the tail somehow? But if I did it will find the char 's' several times more and might result in unnessecary resource usage?</p>\n\n<p>Cheers.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1454845209, "post_id": 35252933, "comment_id": 58218557, "body": "Why do you want such functions? IMO that&#39;s unidiomatic. <i>Boolean blindness</i>. Directly matching on the constructors where you need them, that&#39;s the Haskell way."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1454845367, "post_id": 35252933, "comment_id": 58218603, "body": "the first thing that comes to mind is TemplateHaskell (well...) - but I agree with @leftaroundabout"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 1, "creation_date": 1454847478, "post_id": 35252933, "comment_id": 58219259, "body": "This is your statutory warning that, as ADT stands both for &quot;Algebraic Data Type&quot; and &quot;Abstract Data Type&quot;, it is an acronym well worth avoiding. Meanwhile, checkers and selectors are symptomatic of treating the former as if they are the latter."}, {"owner": {"reputation": 2204, "user_id": 1063961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/s9gRK.png?s=128&g=1", "display_name": "Centril", "link": "https://stackoverflow.com/users/1063961/centril"}, "edited": false, "score": 0, "creation_date": 1454851742, "post_id": 35252933, "comment_id": 58220570, "body": "Thanks for the comments! I&#39;ve expanded upon my question a bit..."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1454854597, "post_id": 35252933, "comment_id": 58221521, "body": "I disagree with the comments above: these functions are totally OK, especially the selectors ones. Avoiding &quot;boolean blindness&quot; when you don&#39;t need to is an anti-anti-pattern (see <a href=\"https://existentialtype.wordpress.com/2011/03/15/boolean-blindness/#comment-59\" rel=\"nofollow noreferrer\">this</a>)."}], "answers": [{"comments": [{"owner": {"reputation": 2204, "user_id": 1063961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/s9gRK.png?s=128&g=1", "display_name": "Centril", "link": "https://stackoverflow.com/users/1063961/centril"}, "edited": false, "score": 0, "creation_date": 1454851795, "post_id": 35253041, "comment_id": 58220586, "body": "Thanks, this is useful! I&#39;ve expanded upon my question a bit... I&#39;d much appreciate it if you could address that as well."}, {"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "reply_to_user": {"reputation": 2204, "user_id": 1063961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/s9gRK.png?s=128&g=1", "display_name": "Centril", "link": "https://stackoverflow.com/users/1063961/centril"}, "edited": false, "score": 0, "creation_date": 1454854711, "post_id": 35253041, "comment_id": 58221566, "body": "See <a href=\"http://stackoverflow.com/questions/34732588/combo-lenses-and-prisms-for-sums-of-products\">this unanswered question</a> for a bit of discussion about this. You can get most of the way immediately using <a href=\"https://hackage.haskell.org/package/lens/docs/Control-Lens-TH.html#g:7\" rel=\"nofollow noreferrer\">declarePrisms</a> which you can compose with some tuple lenses to get traversals from which you can get the functions you want via <a href=\"https://hackage.haskell.org/package/lens/docs/Control-Lens-Fold.html#v:-94--63-\" rel=\"nofollow noreferrer\"><code>^?</code></a>."}, {"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "reply_to_user": {"reputation": 2204, "user_id": 1063961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/s9gRK.png?s=128&g=1", "display_name": "Centril", "link": "https://stackoverflow.com/users/1063961/centril"}, "edited": false, "score": 0, "creation_date": 1454856065, "post_id": 35253041, "comment_id": 58222053, "body": "I&#39;m not aware of a library that will give you exactly what you want, but you can always write the Template Haskell yourself.  In the context of the above, you&#39;d want to produce <a href=\"https://hackage.haskell.org/package/lens/docs/Control-Lens-Traversal.html\" rel=\"nofollow noreferrer\">Traversals</a>.  That would amount to making functions like <code>a1 f (A x y) = A &lt;$&gt; f x &lt;*&gt; pure y; a1 f (B x y) = pure (B x y)</code> or, only getting the read-only case of a <a href=\"https://hackage.haskell.org/package/lens/docs/Control-Lens-Fold.html#g:3\" rel=\"nofollow noreferrer\">Fold</a>, <code>a1 = folding (\\t -&gt; case t of A x _ -&gt; Just x; _ -&gt; Nothing)</code> and so forth."}], "tags": [], "owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "is_accepted": true, "score": 4, "last_activity_date": 1454845560, "creation_date": 1454845560, "answer_id": 35253041, "question_id": 35252933, "link": "https://stackoverflow.com/questions/35252933/haskell-automatic-creation-of-constuctor-checker-selector-functions/35253041#35253041", "title": "Haskell: automatic creation of constuctor-checker / selector functions", "body": "<p>This pattern is a bad idea.  It leads to error-prone code.  However, there is a better way that also includes this mechanism and positively answers your question.  Use <a href=\"https://hackage.haskell.org/package/lens/docs/Control-Lens-Prism.html\" rel=\"nofollow\">Prisms</a>.  You can <a href=\"https://hackage.haskell.org/package/lens/docs/Control-Lens-TH.html#g:3\" rel=\"nofollow\">automatically derive</a> them with Template Haskell.  Then you can use <a href=\"https://hackage.haskell.org/package/lens/docs/Control-Lens-Extras.html#v:is\" rel=\"nofollow\"><code>is</code></a> to get what you want, but, you still shouldn't in the normal case.  Nevertheless, by providing prisms, your users can use better approaches while still having access to <code>is</code> when it is more convenient.</p>\n\n<p>The end result is code like</p>\n\n<pre><code>data MyData a = X a | Y a | Z a\nmakePrisms ''MyData\n\nfilterX = filter (is _X)\n</code></pre>\n"}], "owner": {"reputation": 2204, "user_id": 1063961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/s9gRK.png?s=128&g=1", "display_name": "Centril", "link": "https://stackoverflow.com/users/1063961/centril"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 35253041, "answer_count": 1, "score": 0, "last_activity_date": 1454851713, "creation_date": 1454844882, "last_edit_date": 1454851713, "question_id": 35252933, "link": "https://stackoverflow.com/questions/35252933/haskell-automatic-creation-of-constuctor-checker-selector-functions", "title": "Haskell: automatic creation of constuctor-checker / selector functions", "body": "<p>In haskell, there's a common idiom for ADTs such as:</p>\n\n<pre><code>data MyData a = X a | Y a | Z a\n</code></pre>\n\n<p>...to define functions:</p>\n\n<pre><code>isX (X _) = True\nisX _     = False\n\nisY (Y _) = True\nisY _     = False\n\nisZ (Z _) = True\nisZ _     = False\n</code></pre>\n\n<p>Is there any way to automatically generate these functions?</p>\n\n<p>Motivation: This is arguably idiomatic, or not idiomatic haskell depending on who you ask... The standard library itself has <code>isJust</code>, <code>isNothing</code>.</p>\n\n<p>Expanding the scope of the question, the record syntax allows you to create functions for a data type:</p>\n\n<pre><code>data MyData = A { a1 :: Type1, a2 :: Type2 } | B { b1 :: Type3, b2 :: Type4 }\n</code></pre>\n\n<p>And these functions have the types:</p>\n\n<pre><code>a1 :: MyData -&gt; Type1\na2 :: MyData -&gt; Type2\nb1 :: MyData -&gt; Type3\nb2 :: MyData -&gt; Type4\n</code></pre>\n\n<p>While this is undoubtedly great for data types with only 1 constructors, it is less so for data types with more than 1 constructor as the auto-generated functions result in errors when the wrong constructor has been used.</p>\n\n<p>Is there any way to autogenerate functions with these types instead?</p>\n\n<pre><code>a1 :: MyData -&gt; Maybe Type1\na2 :: MyData -&gt; Maybe Type2\nb1 :: MyData -&gt; Maybe Type3\nb2 :: MyData -&gt; Maybe Type4\n</code></pre>\n"}, {"tags": ["haskell", "hlist"], "comments": [{"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 2, "creation_date": 1454845880, "post_id": 35252562, "comment_id": 58218756, "body": "What you want are <code>hOccurs</code> and <code>hOccursMany</code> in <code>Data.HList.Occurs</code>. They don&#39;t support things like <code>Num a =&gt; HList &#39;[Char, a, Char]</code> well though."}, {"owner": {"reputation": 1774, "user_id": 1181553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fdb435376f06014566318fd7e920d25c?s=128&d=identicon&r=PG", "display_name": "miniBill", "link": "https://stackoverflow.com/users/1181553/minibill"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1454848175, "post_id": 35252562, "comment_id": 58219473, "body": "I can&#39;t seem to make <code>hOccurs</code> work, I&#39;m tring with <code>hOccursFst (HCons &#39;a&#39;  HNil) :: Char</code>. Am I missing something?"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1454850173, "post_id": 35252562, "comment_id": 58220072, "body": "Sorry I hadn&#39;t checked that carefully enough. It&#39;s <code>hOccursFst</code> but not <code>hOccurs</code> that fulfills your requirement. Sorry again."}, {"owner": {"reputation": 1774, "user_id": 1181553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fdb435376f06014566318fd7e920d25c?s=128&d=identicon&r=PG", "display_name": "miniBill", "link": "https://stackoverflow.com/users/1181553/minibill"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1454850244, "post_id": 35252562, "comment_id": 58220089, "body": "I meant that <code>hOccursFst</code> is not working for me, sorry"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1454850630, "post_id": 35252562, "comment_id": 58220210, "body": "Can you please append your exact use case to your question? <code>hOccursFst (HCons &#39;a&#39; HNil) :: Char</code> works for me in ghci. No language extensions and the only thing I imported is <code>Data.HList</code>."}, {"owner": {"reputation": 1774, "user_id": 1181553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fdb435376f06014566318fd7e920d25c?s=128&d=identicon&r=PG", "display_name": "miniBill", "link": "https://stackoverflow.com/users/1181553/minibill"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1454853508, "post_id": 35252562, "comment_id": 58221123, "body": "I was probably mistyping something, works now"}], "answers": [{"comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 3, "creation_date": 1454847169, "post_id": 35253054, "comment_id": 58219151, "body": "Overlapping instances are avoidable. We can compute a <code>[Bool]</code> lifted list from <code>[*]</code> with a closed type family that indicates the positions of the target type, then implement <code>extract</code> with a non-overlapping class based on that."}, {"owner": {"reputation": 1774, "user_id": 1181553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fdb435376f06014566318fd7e920d25c?s=128&d=identicon&r=PG", "display_name": "miniBill", "link": "https://stackoverflow.com/users/1181553/minibill"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1454848233, "post_id": 35253054, "comment_id": 58219491, "body": "@Andr&#225;sKov&#225;cs can you elaborate on that?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1454850584, "post_id": 35253054, "comment_id": 58220189, "body": "@Andr&#225;sKov&#225;cs That would indeed be cleaner. I somehow think of type families defined through overlapping equations to live in the same realm of overlapping instances -- I don&#39;t know if they can raise similar issues."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1454857151, "post_id": 35253054, "comment_id": 58222469, "body": "AFAIK closed type families remove all the evil of overlapping instances. GHC won&#39;t reduce a type family by an equation unless it can prove none of the earlier equations can be matched. The dubious advantage of overlapping instances is that you can define an overlapping instance in a different module than the instance it overlaps, which is also where the coherence problems come in. That&#39;s not possible with closed type families since they are defined in a single declaration."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454881133, "post_id": 35253054, "comment_id": 58231226, "body": "@chi, I don&#39;t think they raise the same <i>coherence</i> issues, but I think they may raise some similar flexibility issues. You may have to deal with explicit evidence of equality, or, worse, the right sort of inequality, to deal with dynamic matters. I&#39;m not really sure how bad it gets, but I&#39;m pretty suspicious of them myself."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1455140894, "post_id": 35253054, "comment_id": 58361978, "body": "@Andr&#225;sKov&#225;cs, I think my answer has finally evolved into something reasonable. Is that what you were thinking? Are there any improvements you would suggest?"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1454845640, "creation_date": 1454845640, "answer_id": 35253054, "question_id": 35252562, "link": "https://stackoverflow.com/questions/35252562/find-an-element-in-an-hlist/35253054#35253054", "title": "Find an element in an HList", "body": "<p>Since you want to check for type equality at compile time, I believe overlapping instances are unavoidable (and I'm not a fan of those...).</p>\n\n<p>Also, I'm not 100% sure I got the overlapping pragmas right. </p>\n\n<pre><code>{-# LANGUAGE DataKinds, TypeOperators, ScopedTypeVariables,\n    MultiParamTypeClasses, FlexibleInstances, FlexibleContexts #-}\n{-# OPTIONS -Wall #-}\nmodule HListFilter where\n\nimport Data.HList.HList\n\nclass OfType a b where\n    oftype :: a -&gt; [b]\n\ninstance OfType (HList '[]) b where\n    oftype = const []\n\ninstance {-# OVERLAPS #-} (OfType (HList ts) t) =&gt; OfType (HList (t ': ts)) t where\n    oftype (HCons x xs) = x : oftype xs\n\ninstance {-# OVERLAPPABLE #-} (OfType (HList ts) b) =&gt; OfType (HList (t ': ts)) b where\n    oftype (HCons _ xs) = oftype xs\n\ntest :: HList '[Int, Char, [Char], Char, Bool]\ntest = HCons (1::Int) (HCons 'a' (HCons \"foo\" (HCons 'b' (HCons True HNil))))\n\ntest_result :: [Char]\ntest_result = oftype test  -- \"ab\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1455188724, "post_id": 35260970, "comment_id": 58382416, "body": "Not much to add here. There&#39;s a minor stylistic difference to how other have done this, for example <a href=\"https://hackage.haskell.org/package/compdata-0.10/docs/src/Data-Comp-Ops.html#%3A%3C%3A\" rel=\"nofollow noreferrer\">here</a> or <a href=\"https://hackage.haskell.org/package/monad-classes-0.3.1.1/docs/src/Control-Monad-Classes-Core.html#liftN\" rel=\"nofollow noreferrer\">here</a>, that is, they use a class with a <code>Proxy</code>-ed method and (possibly) an additional <code>Proxy</code>-less top-level function. Looks like <a href=\"http://lpaste.net/152217\" rel=\"nofollow noreferrer\">this</a> in the current case."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1455209440, "post_id": 35260970, "comment_id": 58397699, "body": "@Andr&#225;sKov&#225;cs, does that technique of holding off on the big equality constraint till escaping the class make type checking faster?"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1455133415, "last_edit_date": 1455133415, "creation_date": 1454891964, "answer_id": 35260970, "question_id": 35252562, "link": "https://stackoverflow.com/questions/35252562/find-an-element-in-an-hlist/35260970#35260970", "title": "Find an element in an HList", "body": "<p>Andr\u00e1s Kov\u00e1cs referred to a type family approach. This is one way to do it:</p>\n\n<pre><code>type family Equal (x :: *) (y :: *) where\n  Equal x x = 'True\n  Equal x y = 'False\n\ntype family Check (b :: *) (as :: [*]) :: [Bool] where\n  Check b '[] = '[]\n  Check b (a ': as) = (b `Equal` a) ': Check b as\n\nclass ps ~ Check b as =&gt;\n    OfType (ps :: [Bool]) (as :: [*]) b where\n  extract :: HList as -&gt; [b]\n</code></pre>\n\n<p>The <code>ps ~ Check b as</code> superclass context is critical here, as a matter of timing. GHC always commits to an instance <em>before</em> checking the instance constraints, but it doesn't even try to find an instance until <em>after</em> solving the superclass constraints. So we need to use the superclass constraint to fix which instances to select.</p>\n\n<pre><code>instance OfType '[] '[] b where\n  extract HNil = []\n\ninstance (OfType ps as b, a ~ b) =&gt;\n           OfType ('True ': ps) (a ': as) b where\n  extract (HCons x xs) = x : extract xs\n\ninstance (OfType ps as b, Equal b a ~ 'False) =&gt;\n    OfType ('False ': ps) (a ': as) b where\n  extract (HCons _ xs) = extract xs\n</code></pre>\n\n<p>Once you've done this, you can actually write an interface that avoids the \"extra\" class parameter:</p>\n\n<pre><code>class OfType' (as :: [*]) (b :: *) where\n  extract' :: HList as -&gt; [b]\n\ninstance OfType ps as b =&gt; OfType' as b where\n  extract' = extract\n</code></pre>\n\n<hr>\n\n<p>It's quite easy to write <code>Contains</code> and <code>extract'</code>. However, writing good <em>instances</em> of <code>Contains</code> necessitates exactly the same sort of hoop jumping as <code>OfType</code>. The class you'd like to have is this:</p>\n\n<pre><code>class Contains xs y where\n  contains :: y `Elem` xs\n\n-- Elem is part of the dependently typed folklore.\ndata Elem y xs where\n  Here :: Elem y (y ': xs)\n  There :: Elem y xs -&gt; Elem y (x ': xs)\n</code></pre>\n\n<p>But writing instances will again force you into overlapping or closed type families. I know I've written this code somewhere around SO, but you should probably be able to work out the overlapping version pretty easily; the type family version will follow the same pattern as <code>OfType</code>, generally.</p>\n"}], "owner": {"reputation": 1774, "user_id": 1181553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fdb435376f06014566318fd7e920d25c?s=128&d=identicon&r=PG", "display_name": "miniBill", "link": "https://stackoverflow.com/users/1181553/minibill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 35253054, "answer_count": 2, "score": 3, "last_activity_date": 1455133415, "creation_date": 1454842454, "question_id": 35252562, "link": "https://stackoverflow.com/questions/35252562/find-an-element-in-an-hlist", "title": "Find an element in an HList", "body": "<p>I'm trying to write two functions to extract a value from an <code>HList</code>, but I can't seem to make GHC happy.</p>\n\n<p>The first function would have signature <code>extract :: HList a -&gt; [b]</code> which extracts all the elements of type <code>b</code> from the list. I only succeeded in writing it by asking the types in <code>a</code> to have <code>Typeable</code> instances.</p>\n\n<pre><code>class OfType a b where\n    oftype :: a -&gt; [Maybe b]\n\ninstance OfType (HList '[]) b where\n    oftype = const []\n\ninstance (Typeable t, Typeable b, OfType (HList ts) b) =&gt; OfType (HList (t ': ts)) b where\n    oftype (x :- xs) = (cast x :: Maybe b) : oftype xs\n\nextract :: OfType a b =&gt; a -&gt; [b]\nextract = catMaybes . oftype\n</code></pre>\n\n<p>Which is suboptimal, as one doesn't really need the <code>Typeable</code> constraint to write any instance of extract.</p>\n\n<p>I tried to use type equalities and inequalities in constraints, but this only gave me overlapping instances.</p>\n\n<p>The second function I'm trying to write would have signature <code>extract' :: Contains h n =&gt; HList h -&gt; n</code> which extracts the first element of type <code>n</code> in the list, and the context says that the list actually contains one element of that type.</p>\n\n<p>Is it possible to write <code>extract</code> without <code>Typeable</code> constraints?</p>\n\n<p>Is it possible to write <code>extract'</code> without <code>Typeable</code> constraints?\nHow can one write <code>Contains</code>?</p>\n"}, {"tags": ["haskell", "ffi", "c2hs"], "answers": [{"tags": [], "owner": {"reputation": 78, "user_id": 5894531, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-555jWWABgqI/AAAAAAAAAAI/AAAAAAAACUc/GKiAWstJGFM/photo.jpg?sz=128", "display_name": "Adrian", "link": "https://stackoverflow.com/users/5894531/adrian"}, "is_accepted": false, "score": 1, "last_activity_date": 1455334546, "creation_date": 1455334546, "answer_id": 35375782, "question_id": 35252352, "link": "https://stackoverflow.com/questions/35252352/error-when-trying-to-use-a-foreignptr-argument-to-a-dynamic-wrapper/35375782#35375782", "title": "Error when trying to use a ForeignPtr argument to a dynamic wrapper", "body": "<p>I think I sorted it out.</p>\n\n<p>I ended up finding some code in gtk2hs that did something similar to what I wanted (<a href=\"https://github.com/gtk2hs/gtk2hs/blob/master/gio/System/GIO/Async/AsyncResult.chs\" rel=\"nofollow\">https://github.com/gtk2hs/gtk2hs/blob/master/gio/System/GIO/Async/AsyncResult.chs</a>)</p>\n\n<p>I defined my callback as normal:</p>\n\n<pre><code>type HookFunc = Foo -&gt; Int -&gt; IO ()\n</code></pre>\n\n<p>Then I also defined another type that used types from <code>Foreign.C</code>, i.e.</p>\n\n<pre><code>type CHookFunc = Foo -&gt; CInt -&gt; IO ()\n</code></pre>\n\n<p>The wrapper then looked like:</p>\n\n<pre><code>foreign import \"wrapper\"\n    mkHookFunc :: CHookFunc -&gt; IO {# type hook_func_t #} -- hook_func_t is the typedef in the C header file\n</code></pre>\n\n<p>Finally, I added a marshalling function as follows:</p>\n\n<pre><code>marshalHookFunc :: HookFunc -&gt; IO {# type hook_func_t #}\nmarshalHookFunc hookFunc =\n    mkHookFunc $ \\fooPtr i -&gt; do\n        foo &lt;- mkFoo fooPtr -- mkFoo constructs a ForeignPtr Foo out of a Ptr Foo\n        hookFunc foo i\n</code></pre>\n"}], "owner": {"reputation": 78, "user_id": 5894531, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-555jWWABgqI/AAAAAAAAAAI/AAAAAAAACUc/GKiAWstJGFM/photo.jpg?sz=128", "display_name": "Adrian", "link": "https://stackoverflow.com/users/5894531/adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1455334546, "creation_date": 1454841301, "question_id": 35252352, "link": "https://stackoverflow.com/questions/35252352/error-when-trying-to-use-a-foreignptr-argument-to-a-dynamic-wrapper", "title": "Error when trying to use a ForeignPtr argument to a dynamic wrapper", "body": "<p>I'm trying to wrap a C library using c2hs. I've got an opaque C struct that I've mapped in Haskell as follows:</p>\n\n<pre><code>{#pointer *foo as Foo foreign newtype #}\n</code></pre>\n\n<p>I've used a foreign pointer so I can automatically clean up with a finalizer. All of that seems to work fine. However, I now want to wrap a function pointer that looks like the following:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>typedef void (*hook_func)(foo *f, int a);\n</code></pre>\n\n<p>My Haskell code then looks like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type HookFunc = Foo -&gt; Int -&gt; IO ()\nforeign import ccall \"wrapper\"\n    mkHookFunc :: HookFunc -&gt; IO (FunPtr HookFunc)\n</code></pre>\n\n<p>However, when I compile I get the following error:</p>\n\n<pre><code>Unacceptable argument type in foreign declaration:\n    ForeignPtr Foo\n</code></pre>\n\n<p>Any ideas on the best solution to this error? My initial thinking is that I need to use <code>unsafeForeignPtrToPtr</code> to convert to just a foo pointer, but I'm not sure how to do this/where to put it in the \"wrapper\".</p>\n\n<p>Any clues?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 6, "last_activity_date": 1454837139, "last_edit_date": 1454837139, "creation_date": 1454831790, "answer_id": 35251112, "question_id": 35251072, "link": "https://stackoverflow.com/questions/35251072/type-signature-of-functions-in-haskell/35251112#35251112", "title": "Type signature of functions in Haskell", "body": "<p>First of: all the signatures basically come from <code>(*) :: Num a =&gt; a -&gt; a -&gt; a</code> and your usage of it. And yes <code>k</code> and <code>foo</code> should be the same but <code>bar</code> is indeed a bit different as you wrote it here.</p>\n\n<ul>\n<li><code>foo</code> should be obvious (I hope) (it's just that <code>*</code> is polymorphic and the type says just that)</li>\n<li>for <code>bar</code> it's because the <code>x</code> on the left side is not used on the <code>right</code> side so you get the extra parameter <code>t</code> - it's the same as <code>bar y = \\x -&gt; x * x</code></li>\n<li>for <code>k</code> see the <a href=\"https://wiki.haskell.org/Monomorphism_restriction\">Monomorphism restriction</a> - basically Haskell will pull a default-type here to work around some slight problems that could arise. It's a bit strange that you get it here because by default newer GHCi version should not show this behavior (see the link)</li>\n</ul>\n\n<hr>\n\n<p>btw: don't wonder to much about the names of the types ;) </p>\n\n<p>The lesson learned should probably be to just write down your signatures (at least on top-level functions) ^^ - it would have solved all your problems</p>\n"}], "owner": {"reputation": 627, "user_id": 634615, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/5d0319056378070fa0eea3a731fb173c?s=128&d=identicon&r=PG", "display_name": "user634615", "link": "https://stackoverflow.com/users/634615/user634615"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1454837139, "creation_date": 1454831453, "last_edit_date": 1454837090, "question_id": 35251072, "link": "https://stackoverflow.com/questions/35251072/type-signature-of-functions-in-haskell", "title": "Type signature of functions in Haskell", "body": "<p>I have defined three functions in haskell which multiply two numbers</p>\n\n<pre><code>k = \\x y -&gt; x * y\n\nfoo y = \\x -&gt; x * y\n\nbar x = \\x -&gt; x * x\n</code></pre>\n\n<p>But I am getting different signatures for all the three functions.</p>\n\n<pre><code>\u03bb&gt; :t k\nk :: Integer -&gt; Integer -&gt; Integer\n\u03bb&gt; :t foo\nfoo :: Num a =&gt; a -&gt; a -&gt; a\n\u03bb&gt; :t bar\nbar :: Num a =&gt; t -&gt; a -&gt; a\n</code></pre>\n\n<p>Can somebody explain why it is so? I can see t in type signature of bar. is it different from normal usage of a, b, or a1, a2 etc</p>\n"}, {"tags": ["parsing", "haskell", "ghc"], "comments": [{"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1454836430, "post_id": 35250876, "comment_id": 58216090, "body": "If you mean to get the type information of any expression (top-level or not) in a haskell source file, you may want to check <a href=\"http://hackage.haskell.org/package/ghc-mod\" rel=\"nofollow noreferrer\"><code>ghc-mod</code></a> package."}, {"owner": {"reputation": 588, "user_id": 3804671, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/48b73e1e5ecec13d1edb985bfd90cf71?s=128&d=identicon&r=PG&f=1", "display_name": "ankitrokdeonsns", "link": "https://stackoverflow.com/users/3804671/ankitrokdeonsns"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1454839741, "post_id": 35250876, "comment_id": 58216953, "body": "I want to generate a tree from program source code to analyze the potential paths the program can take. Simple text based parsing is not sufficient for my usecase and need type information as well at nodes of the tree i am going to generate"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1455021954, "post_id": 35250876, "comment_id": 58294589, "body": "Do you need to do it on the source level? It&#39;d be much easier to implement this on Core, where nested pattern matching is already flattened out."}, {"owner": {"reputation": 588, "user_id": 3804671, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/48b73e1e5ecec13d1edb985bfd90cf71?s=128&d=identicon&r=PG&f=1", "display_name": "ankitrokdeonsns", "link": "https://stackoverflow.com/users/3804671/ankitrokdeonsns"}, "edited": false, "score": 0, "creation_date": 1455211075, "post_id": 35250876, "comment_id": 58398849, "body": "I would prefer it at a higher level than core for my use case. I can work with the simplified version obtained from ghc -ddump-simple as well."}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 1, "last_activity_date": 1457404773, "last_edit_date": 1495542667, "creation_date": 1457061699, "answer_id": 35787363, "question_id": 35250876, "link": "https://stackoverflow.com/questions/35250876/getting-parsed-and-type-annotated-haskell-code/35787363#35787363", "title": "Getting Parsed and Type-annotated Haskell Code", "body": "<p>There's no tool except GHC that is particularly adept at typechecking Haskell source at the moment. A <code>haskell-type-exts</code> was in development to match <code>src-exts</code>, but it was never completed.</p>\n\n<p>So you can use a reasonable wrapper to the GHC API, such as <a href=\"https://hackage.haskell.org/package/hint-0.4.2.3\" rel=\"nofollow noreferrer\">hint</a>, and invoke it on the subexpressions you want to check using its <a href=\"https://hackage.haskell.org/package/hint-0.4.2.3/docs/Language-Haskell-Interpreter.html#g:7\" rel=\"nofollow noreferrer\">type inference api</a>.</p>\n\n<p>This is a rather painful approach, but I can't think of much better. If you're only interested in working on haskell-<em>like</em> code as an exercise, you could instead import the <code>PureScript</code> compiler as a library, and then you'll be able to get a fully type annotated syntax tree in a more reasonable way.</p>\n\n<p>Alternately, you can try to navigate the thicket of the GHC api itself to get fully typechecked source...</p>\n\n<p>If you choose to go that route, <a href=\"https://stackoverflow.com/a/35021284/371753\">this answer</a> may get you started.</p>\n"}], "owner": {"reputation": 588, "user_id": 3804671, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/48b73e1e5ecec13d1edb985bfd90cf71?s=128&d=identicon&r=PG&f=1", "display_name": "ankitrokdeonsns", "link": "https://stackoverflow.com/users/3804671/ankitrokdeonsns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1457404773, "creation_date": 1454829724, "last_edit_date": 1457061724, "question_id": 35250876, "link": "https://stackoverflow.com/questions/35250876/getting-parsed-and-type-annotated-haskell-code", "title": "Getting Parsed and Type-annotated Haskell Code", "body": "<p>I am trying to parse Haskell source code and generate a decision tree to analyze different paths Haskell programs can take.\n<code>haskell-src-exts</code> gives a reasonable representation, but does not have any type information associated with it.<br>\nDoes GHC or some other tool provide that functionality?</p>\n"}, {"tags": ["haskell", "monad-transformers", "conduit", "st-monad"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1454816123, "post_id": 35249381, "comment_id": 58212329, "body": "The type <code>ConduitM i o (forall s. STT s m) r -&gt; ConduitM i o m r</code> is what is called an impredictive type, because there is a <code>forall</code> inside of a type constructor (<code>ConduitM</code> in this case). Type inference fails utterly and horrifically (for theoretical and practical reasons) in the presence of impredictive types. You can get around this by annotating <i>everything</i> with a type signature, or defining a newtype for your quantified type: <code>newtype X m = X (forall s . STT s m)</code> and then <code>foo :: ConduitM i o (X m) r -&gt; ...</code>."}, {"owner": {"reputation": 34015, "user_id": 1026598, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e4cf2da845e7862bd0b0e4edd405f77d?s=128&d=identicon&r=PG", "display_name": "Gabriel Gonzalez", "link": "https://stackoverflow.com/users/1026598/gabriel-gonzalez"}, "edited": false, "score": 1, "creation_date": 1454816514, "post_id": 35249381, "comment_id": 58212399, "body": "Why not just implement <code>foo :: ConduitM i o (STT s m) r -&gt; ConduitM i o m r</code> instead?"}], "answers": [{"tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 2, "last_activity_date": 1454840849, "last_edit_date": 1454840849, "creation_date": 1454834518, "answer_id": 35251412, "question_id": 35249381, "link": "https://stackoverflow.com/questions/35249381/how-to-hoist-conduit-of-stt/35251412#35251412", "title": "How to hoist Conduit of STT", "body": "<p>It seems that you have reinvented the <code>MFunctor</code> instance of <code>ConduitM</code>. You may check the <a href=\"http://hackage.haskell.org/package/conduit-1.2.6.1/docs/src/Data-Conduit-Internal-Conduit.html#line-140\" rel=\"nofollow\">source code</a>.</p>\n\n<p>By the author of conduit package, <a href=\"https://github.com/snoyberg/conduit/wiki/Dealing-with-monad-transformers\" rel=\"nofollow\">monad hoist in this style gives surprising results when you try to unwrap a monad with side effect</a>. In you case <code>runST</code> will be called multiple times so the state is thrown every time the conduit produces an item. </p>\n\n<p>You'd better lift every other conduit on the line from <code>Conduit i o m r</code> to <code>Conduit i o (STT s m) r</code> and call <code>runST</code> on the result. It's as easy as <code>transPipe lift</code>.</p>\n"}], "owner": {"reputation": 23, "user_id": 2830792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b151165aca8aacddac5dff94a2d74af5?s=128&d=identicon&r=PG&f=1", "display_name": "John Ky", "link": "https://stackoverflow.com/users/2830792/john-ky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 35251412, "answer_count": 1, "score": 2, "last_activity_date": 1454840849, "creation_date": 1454815784, "question_id": 35249381, "link": "https://stackoverflow.com/questions/35249381/how-to-hoist-conduit-of-stt", "title": "How to hoist Conduit of STT", "body": "<p>I've been trying to write an implementation of the function:</p>\n\n<pre><code>foo :: Monad m =&gt; ConduitM i o (forall s. STT s m) r -&gt; ConduitM i o m r\n</code></pre>\n\n<p>But I've been failing at every turn with the error:</p>\n\n<pre><code>Couldn't match type because variable `s` would escape its scope.\n</code></pre>\n\n<p>I'm now suspicious that implementing this function is impossible.</p>\n\n<pre><code>threadSTT :: Monad m\n       =&gt; (forall a. (forall s. STT s m a) -&gt; m a)\n       -&gt; ConduitM i o (forall s. STT s m) r\n       -&gt; ConduitM i o m r\nthreadSTT runM (ConduitM c0) =\n    ConduitM $ \\rest -&gt;\n        let go (Done r) = rest r\n            go (PipeM mp) = PipeM $ do\n                r &lt;- runM mp -- ERROR\n                return $ go r\n            go (Leftover p i) = Leftover (go p) i\n            go (NeedInput x y) = NeedInput (go . x) (go . y)\n            go (HaveOutput p f o) = HaveOutput (go p) (runM f) o -- ERROR\n         in go (c0 Done)\n\nfoo :: Monad m =&gt; ConduitM i o (forall s. STT s m) r -&gt; ConduitM i o m r\nfoo = threadSTT STT.runST\n</code></pre>\n\n<p>Can anyone speak to this?  I'd really love it to work, but if I can't then I need abandon use of <code>Data.Array.ST</code> for writing my conduits.</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1454804009, "post_id": 35248127, "comment_id": 58210059, "body": "&quot;because <code>z</code> is a list still&quot; \u2013 er, no, it&#39;s not; <code>y</code> and <code>out</code> are lists. \u2014 The code you provided isn&#39;t syntactically right (missing comma, indentation); please correct that so we can help you best."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454810550, "post_id": 35248127, "comment_id": 58211414, "body": "If the elements are <code>Ord</code>, you can do this much more efficiently. Can you see how?"}], "answers": [{"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1454806638, "post_id": 35248163, "comment_id": 58210686, "body": "you can also use infix syntax: <code>subset xs ys = all (`elem` ys) xs</code>"}], "tags": [], "owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "is_accepted": false, "score": 3, "last_activity_date": 1454803941, "creation_date": 1454803941, "answer_id": 35248163, "question_id": 35248127, "link": "https://stackoverflow.com/questions/35248127/apply-a-function-to-every-element-in-a-list-to-every-element-in-another-list-h/35248163#35248163", "title": "Apply a function to every element in a list to every element in another list - Haskell", "body": "<p>Checking whether all elements of <code>xs</code> are elements of <code>ys</code> is very straightforward. Loop through <code>xs</code>, and for each element, check if it is in <code>ys</code>:</p>\n\n<pre><code>subset xs ys = all (\\x -&gt; elem x ys) xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 5893491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GKPqL.jpg?s=128&g=1", "display_name": "frivat", "link": "https://stackoverflow.com/users/5893491/frivat"}, "is_accepted": false, "score": 0, "last_activity_date": 1454815905, "last_edit_date": 1454815905, "creation_date": 1454815021, "answer_id": 35249287, "question_id": 35248127, "link": "https://stackoverflow.com/questions/35248127/apply-a-function-to-every-element-in-a-list-to-every-element-in-another-list-h/35249287#35249287", "title": "Apply a function to every element in a list to every element in another list - Haskell", "body": "<p>Easy way to reason about subsets is to use sets as the data type.</p>\n\n<pre><code>import qualified Data.Set as S\n\nsubset :: Ord a =&gt; [a] -&gt; [a] -&gt; Bool\nsubset xs ys = S.isSubsetOf (S.fromList xs) (S.fromList ys)\n</code></pre>\n\n<p>Then it's as simple as:</p>\n\n<pre><code>*Main&gt; subset [1..5] [1..10]\nTrue\n*Main&gt; subset [0..5] [1..10]\nFalse\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 513, "user_id": 5689927, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a8a6405649ca4ab08b73c2735c21def8?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Rodriguez", "link": "https://stackoverflow.com/users/5689927/carlos-rodriguez"}, "is_accepted": false, "score": 1, "last_activity_date": 1454849728, "last_edit_date": 1454849728, "creation_date": 1454833862, "answer_id": 35251362, "question_id": 35248127, "link": "https://stackoverflow.com/questions/35248127/apply-a-function-to-every-element-in-a-list-to-every-element-in-another-list-h/35251362#35251362", "title": "Apply a function to every element in a list to every element in another list - Haskell", "body": "<p>You could also use the list difference function (<code>\\\\</code>). If you have list y and list x, and you want to check that all elements of x are in y, then <code>x \\\\ y</code> will return a new list with the elements of x that are not in y. If all the elements of x are in y, the returned list will be empty.</p>\n\n<p>For example, if your list y is [1,2,3,4,5] and your list x is [2,4], you can do:</p>\n\n<pre><code>Prelude&gt; [2,4] \\\\ [1,2,3,4,5]\n[]\n</code></pre>\n\n<p>If list y is [1,2,3,4,5] and list x is [2,4,6], then:</p>\n\n<pre><code>Prelude&gt; [2,4,6] \\\\ [1,2,3,4,5]\n[6]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 0, "last_activity_date": 1454958769, "last_edit_date": 1454958769, "creation_date": 1454958425, "answer_id": 35277335, "question_id": 35248127, "link": "https://stackoverflow.com/questions/35248127/apply-a-function-to-every-element-in-a-list-to-every-element-in-another-list-h/35277335#35277335", "title": "Apply a function to every element in a list to every element in another list - Haskell", "body": "<p>Let's break this down into two subproblems:</p>\n\n<ol>\n<li>Find if a <em>value</em> is a member of a list;</li>\n<li>Use the solution to #1 to test whether <em>every</em> value in a list is in the second one.</li>\n</ol>\n\n<p>For the first subproblem there is a library function already:</p>\n\n<pre><code>elem :: (Eq a, Foldable t) =&gt; a -&gt; t a -&gt; Bool\n</code></pre>\n\n<p>Lists are a <code>Foldable</code> type, so you can use this function with lists for <code>t</code> and it would have the following type:</p>\n\n<pre><code>elem :: (Eq a) =&gt; a -&gt; [a] -&gt; Bool\n</code></pre>\n\n<p><strong>EXERCISE:</strong> Write your own version of <code>elem</code>, specialized to work with lists (don't worry about the <code>Foldable</code> stuff now).</p>\n\n<p>So now, to tackle #2, one first step would be this:</p>\n\n<pre><code>-- For each element of `xs`, test whether it's an element of `ys`.\n-- Return a list of the results.\nnotYetSubset :: Eq a =&gt; [a] -&gt; [a] -&gt; [Bool]\nnotYetSubset xs ys = map (\\x -&gt; elem x ys) xs\n</code></pre>\n\n<p>After that, we need to go from the list of individual boolean results to just one boolean.  There's a standard library function that does that as well:</p>\n\n<pre><code>-- Return true if and only if every element of the argument collection is \n-- is true.\nand :: Foldable t =&gt; t Bool -&gt; Bool\n</code></pre>\n\n<p><strong>EXERCISE:</strong> write your own version of <code>and</code>, specialized to lists:</p>\n\n<pre><code>myAnd :: [Bool] -&gt; Bool\nmyAnd [] = _fillMeIn\nmyAnd (x:xs) = _fillMeIn\n</code></pre>\n\n<p>With these tools, now we can write <code>subset</code>:</p>\n\n<pre><code>subset :: Eq a =&gt; [a] -&gt; [a] -&gt; [Bool]\nsubset xs ys = and (map (\\x -&gt; elem x ys) xs)\n</code></pre>\n\n<p>Although a more experienced Haskeller would probably write it like this:</p>\n\n<pre><code>subset :: Eq a =&gt; [a] -&gt; [a] -&gt; [Bool]\nsubset xs ys = every (`elem` ys) xs\n\n{- This:\n\n       (`elem` ys)\n\n   ...is a syntactic shortcut for this:\n\n       \\x -&gt; x elem ys\n-}\n</code></pre>\n\n<p>...where <code>every</code> is another standard library function that is just a shortcut for the combination of <code>map</code> and <code>and</code>:</p>\n\n<pre><code>-- Apply a boolean test to every element of the list, and\n-- return `True` if and only if the test succeeds for all elements.\nevery :: (a -&gt; Bool) -&gt; [a] -&gt; Bool\nevery p = and . map p\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5893622, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204608093677301/picture?type=large", "display_name": "Hayden Brooks", "link": "https://stackoverflow.com/users/5893622/hayden-brooks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2061, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1454958769, "creation_date": 1454803723, "last_edit_date": 1454804306, "question_id": 35248127, "link": "https://stackoverflow.com/questions/35248127/apply-a-function-to-every-element-in-a-list-to-every-element-in-another-list-h", "title": "Apply a function to every element in a list to every element in another list - Haskell", "body": "<p>My ultimate goal is to find if a list y contains all the elements of list x (I'm checking if x is a subset of y sort of thing)</p>\n\n<pre><code>subset x y =\nand [out | z &lt;- x\n         , out &lt;- filter (==z) y ]\n</code></pre>\n\n<p>This doesn't work, and I know it's because z is a list still. I'm trying to make sense of this.</p>\n\n<p>I think I may have to use the <code>elem</code> function, but I'm not sure how to split x into chars that I can compare separately through y.</p>\n\n<p>I'm ashamed to say that I've been working on this simple problem for an hour and a half.</p>\n"}, {"tags": ["haskell", "lambda", "lambda-calculus"], "comments": [{"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 1, "creation_date": 1454801504, "post_id": 35247626, "comment_id": 58209341, "body": "If you just want to see whether the algorithm is correct (regardless of its type), you could sprinkle some <a href=\"https://hackage.haskell.org/package/base-4.7.0.0/docs/Unsafe-Coerce.html\" rel=\"nofollow noreferrer\"><code>unsafeCoerce</code></a> over the code. Don&#39;t do this in production, though."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1454802704, "post_id": 35247626, "comment_id": 58209664, "body": "You need recursion, so you&#39;ll need to have a fix-point operator at some point. You can reuse the standard one (<code>Data.Function.fix</code>), define it yourself, or make your definition produce both <code>thuleMorse</code> and <code>f</code> simultaneously rather than just <code>thuleMorse</code>."}, {"owner": {"reputation": 1209, "user_id": 2738025, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LSnV8.png?s=128&g=1", "display_name": "castle-bravo", "link": "https://stackoverflow.com/users/2738025/castle-bravo"}, "reply_to_user": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 0, "creation_date": 1454806915, "post_id": 35247626, "comment_id": 58210735, "body": "@MadameElyse, thank you for the suggestion! Inserting <code>unsafeCoerce</code> makes the interpreter evaluate the expression, and the result is indeed the Thule-Morse sequence! Here it is with <code>unsafeCoerce</code> inserted: <code>thuleMorseUnsafe = 0:1:(\\f xs -&gt; unsafeCoerce f f xs) (\\f (x:xs) -&gt; x:(1 - x):unsafeCoerce f f xs) ((\\(_:xs) -&gt; xs) thuleMorseUnsafe)</code>. Is there a cleaner looking way to do this?"}, {"owner": {"reputation": 1209, "user_id": 2738025, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LSnV8.png?s=128&g=1", "display_name": "castle-bravo", "link": "https://stackoverflow.com/users/2738025/castle-bravo"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1454808651, "post_id": 35247626, "comment_id": 58211063, "body": "@DanielWagner, yes <code>thuleMorse = 0:1:fix (\\f (x:xs) -&gt; x:(1 - x):f xs) (tail thuleMorse)</code> works perfectly, and I don&#39;t have to do anything spooky to get it to work. Thank you very much."}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1454809884, "post_id": 35247626, "comment_id": 58211302, "body": "It&#39;s Thue, not Thule"}, {"owner": {"reputation": 1209, "user_id": 2738025, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LSnV8.png?s=128&g=1", "display_name": "castle-bravo", "link": "https://stackoverflow.com/users/2738025/castle-bravo"}, "reply_to_user": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1454810961, "post_id": 35247626, "comment_id": 58211482, "body": "@pat, YIKES. I misread it ages ago, and my brain never bothered to correct itself."}], "answers": [{"comments": [{"owner": {"reputation": 1209, "user_id": 2738025, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LSnV8.png?s=128&g=1", "display_name": "castle-bravo", "link": "https://stackoverflow.com/users/2738025/castle-bravo"}, "edited": false, "score": 0, "creation_date": 1454811288, "post_id": 35248780, "comment_id": 58211529, "body": "This is the most succinct variation so far."}, {"owner": {"reputation": 1209, "user_id": 2738025, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LSnV8.png?s=128&g=1", "display_name": "castle-bravo", "link": "https://stackoverflow.com/users/2738025/castle-bravo"}, "edited": false, "score": 0, "creation_date": 1454812465, "post_id": 35248780, "comment_id": 58211716, "body": "It&#39;s also slightly faster than my fix-based version, to get the 100-millionth element of the sequence took 12.281s using the fix-based version and 11.079s using yours (<code>ghc -e &quot;...&quot;</code>). My original version also took more than 12 seconds."}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": true, "score": 3, "last_activity_date": 1454811961, "last_edit_date": 1454811961, "creation_date": 1454809396, "answer_id": 35248780, "question_id": 35247626, "link": "https://stackoverflow.com/questions/35247626/thue-morse-sequence-in-one-line-of-haskell/35248780#35248780", "title": "Thue-Morse Sequence in one Line of Haskell", "body": "<p>Here is the same algorithm, but without explicit <code>fix</code>:</p>\n\n<pre><code>thueMorse = 0 : 1 : (tail thueMorse &gt;&gt;= \\x -&gt; [x, 1 - x])\n</code></pre>\n"}], "owner": {"reputation": 1209, "user_id": 2738025, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LSnV8.png?s=128&g=1", "display_name": "castle-bravo", "link": "https://stackoverflow.com/users/2738025/castle-bravo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 0, "accepted_answer_id": 35248780, "answer_count": 1, "score": 2, "last_activity_date": 1454811961, "creation_date": 1454800195, "last_edit_date": 1454811135, "question_id": 35247626, "link": "https://stackoverflow.com/questions/35247626/thue-morse-sequence-in-one-line-of-haskell", "title": "Thue-Morse Sequence in one Line of Haskell", "body": "<p>I wrote a definition for the <a href=\"https://en.wikipedia.org/wiki/Thue%E2%80%93Morse_sequence\" rel=\"nofollow\">Thue-Morse squence</a> as an infinite list of integers in one line of Haskell:</p>\n\n<pre><code>thueMorse = 0:1:f (tail thueMorse) where f = (\\(x:xs) -&gt; x:(1 - x):f xs)\n</code></pre>\n\n<p>This is the result of a failed attempt to define the sequence in one line, only in terms of lambda expressions and itself, without let or where expressions (which really ought to be presented on two lines, making the above solution a two liner in spirit). I have been reading a little about lambda calculus, so I thought I would try it as an exercise. I would like to know if something like this is possible in Haskell, and how to do it if it is possible.</p>\n\n<pre><code>thueMorse = 0:1:(\\f xs -&gt; f f xs) (\\f (x:xs) -&gt; x:(1 - x):f f xs) ((\\(_:xs) -&gt; xs) thueMorse)\n</code></pre>\n\n<p>The above expression is a little hard to read, so I'll break it down:</p>\n\n<pre><code>(\\f xs -&gt; f f xs)\n</code></pre>\n\n<p>Takes a function and an argument and applies that function to itself and the argument. Haskell won't evaluate this expression because f has the type <code>t = t -&gt; a -&gt; a</code>, which is the crux of my problem.</p>\n\n<pre><code>(\\f (x:xs) -&gt; x:(1 - x):f f xs)\n</code></pre>\n\n<p>Is the function passed to the previous expression, which will take itself and a list as arguments. This is the part that recursively computes the Thue-Morse sequence. This also has an infinite type <code>t = t -&gt; [a] -&gt; [a]</code>.</p>\n\n<pre><code>((\\(_:xs) -&gt; xs) thueMorse)\n</code></pre>\n\n<p>This is just the equivalent of <code>(tail thueMorse)</code>, but written in terms of lambda expressions to meet the conditions of the exercise.</p>\n\n<p>Haskell complains that these expressions have infinite type and refuses to evaluate them, bit I think that if they were evaluated, they would correctly generate the Thue-Morse sequence. Is there any way to twist the interpreter or compiler's arm into evaluating these expressions? Is there a way to adjust the statement so that it can be evaluated but still only use operators from lambda calculus, and in one line?</p>\n"}, {"tags": ["csv", "haskell", "haskell-pipes"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1454802584, "post_id": 35247588, "comment_id": 58209633, "body": "You could consider throwing a pipe on the front that converts Latin-1 encoded <code>ByteString</code>s into UTF-8 encoded <code>ByteString</code>s."}, {"owner": {"reputation": 31, "user_id": 5893491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GKPqL.jpg?s=128&g=1", "display_name": "frivat", "link": "https://stackoverflow.com/users/5893491/frivat"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1454803364, "post_id": 35247588, "comment_id": 58209866, "body": "@DanielWagner So you mean decode to Text, re-encode to ByteString, and then let pipes-csv decode again into Text?"}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1454806884, "post_id": 35247588, "comment_id": 58210730, "body": "@frivat this seems exactly right. <code>delatin p = void $ for (Text.decodeIso8859_1 p) Text.encodeUtf8</code>, or as you write it. The problem is with <code>cassava</code>, not <code>pipes-csv</code>, which works with bytestring, but assumes they are utf8 encoded. This is an optimization which turns out not to be ideal in this case (I think that&#39;s the whole story). The encoding and decoding functions from <code>streaming-commons</code> are pretty efficient so hopefully the unpleasant detour won&#39;t be too costly."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1454813520, "post_id": 35247588, "comment_id": 58211889, "body": "@frivat Right. Unless you want to hack on cassava/pipes-csv directly..."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1454815540, "post_id": 35247588, "comment_id": 58212214, "body": "This seems to be a very typical problem. ByteString is not intended for representing text formats, so working with any concept of &quot;encoding&quot; beyond &quot;raw bits/bytes&quot; with a ByteString is usually a headache. You can do it if you want, but of course, you can also hammer a nail with a screwdriver. If you are working with UTF8 encoded strings, you should consider converting them to <code>Text</code> immediately and writing all of your functions to work with <code>Text</code>. If one of your dependencies only works with ByteString.. you may be SOL, i.e. stuck with the ugly solution you have now."}, {"owner": {"reputation": 31, "user_id": 5893491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GKPqL.jpg?s=128&g=1", "display_name": "frivat", "link": "https://stackoverflow.com/users/5893491/frivat"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1454891791, "post_id": 35247588, "comment_id": 58234131, "body": "@user2407038 Yes, in the ideal world, everything is uniform."}], "owner": {"reputation": 31, "user_id": 5893491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GKPqL.jpg?s=128&g=1", "display_name": "frivat", "link": "https://stackoverflow.com/users/5893491/frivat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1454805145, "creation_date": 1454799919, "last_edit_date": 1454805145, "question_id": 35247588, "link": "https://stackoverflow.com/questions/35247588/using-pipes-csv-to-parse-latin-1-encoded-content", "title": "Using pipes-csv to parse Latin-1 encoded content?", "body": "<p>I'd like to use <code>pipes-csv</code> to parse some large CSV files, but it turns out these CSV files are Latin-1 encoded and it also turns out that <code>pipes-csv</code>, and the <code>cassava</code> library it depends on, assume UTF-8. This ends up producing parsing errors that I need to handle.</p>\n\n<p>The way I've approached it is to duplicate the records that will hold CSV data so that all the <code>Text</code> fields are <code>ByteString</code> fields in the dup. I decode into the dup, then manually translate the Latin-1 strings into UTF-8 and create the final record. Inelegant to say the least.</p>\n\n<p>Is there a better way?</p>\n\n<hr>\n\n<p>Per Daniel's suggestion, here is what I have so far:</p>\n\n<pre><code>import qualified Pipes.Text.Encoding as PTE\nimport qualified Pipes.ByteString as PB\n\nwithFile \"file.csv\" ReadMode $ \\h -&gt; do\n  let transcode = PTE.decodeIso8859_1 . PB.fromHandle ~&gt; PTE.encodeUtf8\n  runEffect $ decodeByName (void . transcode $ h) &gt;-&gt; process\n</code></pre>\n\n<p>It trades off unnecessary records for unnecessary re-encoding of the text, but it's an improvement. I don't suppose there is a way to do this without doing either of these unnecessary things?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 1, "creation_date": 1454799163, "post_id": 35247447, "comment_id": 58208679, "body": "<code>Int</code> is the primitive integer type in haskell. <code>int</code> is treated as a type variable."}, {"owner": {"reputation": 11, "user_id": 3755524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f33080ba5258208f64633e401bd3ace7?s=128&d=identicon&r=PG&f=1", "display_name": "abdelkarim", "link": "https://stackoverflow.com/users/3755524/abdelkarim"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1454799591, "post_id": 35247447, "comment_id": 58208786, "body": "thanks @zakyggaps. that worked"}], "owner": {"reputation": 11, "user_id": 3755524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f33080ba5258208f64633e401bd3ace7?s=128&d=identicon&r=PG&f=1", "display_name": "abdelkarim", "link": "https://stackoverflow.com/users/3755524/abdelkarim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "closed_date": 1454799364, "answer_count": 0, "score": 1, "last_activity_date": 1454798783, "creation_date": 1454798783, "question_id": 35247447, "link": "https://stackoverflow.com/questions/35247447/wrong-use-of-logical-operators-in-haskell", "closed_reason": "Duplicate", "title": "wrong use of logical operators in haskell?", "body": "<p>I'm new to haskell. I tried compiling some examples, but I don't know what the compiler is trying to tell me.\nthis is my code:</p>\n\n<pre><code>import Data.List\nimport System.IO\n\nmax' :: int-&gt;int-&gt;int\nmax' n m \n        | (n &lt;= m) = m\n        | otherwise = n\n\nmaximum' :: [int]-&gt;int\nmaximum' [a]=a\nmaximum' (x:xs) = max' x (maximum' xs)\n\nsort' :: [int]-&gt;[int]\nsort' [] =[]\nsort' (x:xs) = sort'[y|y&lt;-(x:xs),y &lt; maximum'(x:xs)]++[y'|y'&lt;-(x:xs),y' == maximum'(x:xs)]\n</code></pre>\n\n<p>and this is the output of the compiler:</p>\n\n<pre><code>Prelude&gt; :r\n[1 of 1] Compiling Main             ( test.hs, interpreted )\nFailed, modules loaded: none.\n\ntest.hs:6:22:\n    No instance for (Ord int) arising from a use of \u2018&lt;=\u2019\n    Possible fix:\n      add (Ord int) to the context of\n        the type signature for max' :: int -&gt; int -&gt; int\n    In the expression: (n &lt;= m)\n    In a stmt of a pattern guard for\n                   an equation for \u2018max'\u2019:\n      (n &lt;= m)\n    In an equation for \u2018max'\u2019:\n        max' n m\n          | (n &lt;= m) = m\n          | otherwise = n\n\ntest.hs:15:36:\n    No instance for (Ord int) arising from a use of \u2018&lt;\u2019\n    Possible fix:\n      add (Ord int) to the context of\n        the type signature for sort' :: [int] -&gt; [int]\n    In the expression: y &lt; maximum' (x : xs)\n    In a stmt of a list comprehension: y &lt; maximum' (x : xs)\n    In the first argument of \u2018sort'\u2019, namely\n      \u2018[y | y &lt;- (x : xs), y &lt; maximum' (x : xs)]\u2019\n\ntest.hs:15:73:\n    No instance for (Eq int) arising from a use of \u2018==\u2019\n    Possible fix:\n      add (Eq int) to the context of\n        the type signature for sort' :: [int] -&gt; [int]\n    In the expression: y' == maximum' (x : xs)\n    In a stmt of a list comprehension: y' == maximum' (x : xs)\n    In the second argument of \u2018(++)\u2019, namely\n      \u2018[y' | y' &lt;- (x : xs), y' == maximum' (x : xs)]\u2019\n</code></pre>\n\n<p>the compiler is pointing to all the logical operators in my code</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1454793674, "post_id": 35246397, "comment_id": 58207046, "body": "This seems similar to the problem of a mutex. You want to specify at the type level whether the function requires the lock or not. You can see one possible way to deal with this <a href=\"http://dev.stephendiehl.com/hask/#indexed-monads\" rel=\"nofollow noreferrer\">here</a> look at the <code>IState</code> type. Replace <code>Locked</code> and <code>Unlocked</code> with <code>Authenticated</code> and <code>UnAuthenticated</code> and provide the user a <code>login</code> function that checks for the <code>oauth</code> token and which is the only way to obtain an <code>Authenticated</code> value."}], "answers": [{"comments": [{"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1454823116, "post_id": 35246931, "comment_id": 58213575, "body": "While this seems like a workable solution, is this the only approach? It just <b>seems</b> like a lot of boiler-plate for something that can easily be solved by inheritance in other languages."}, {"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1454823193, "post_id": 35246931, "comment_id": 58213587, "body": "If this boilerplate is necessary, is there a macro which can convert this into a one-liner?"}, {"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "reply_to_user": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1454850091, "post_id": 35246931, "comment_id": 58220043, "body": "@SaurabhNanda i do not agree! it is actually the other way around: no code to do run time checks and no duplicated code to implement same logic across user types"}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": false, "score": 8, "last_activity_date": 1454798643, "last_edit_date": 1454798643, "creation_date": 1454795709, "answer_id": 35246931, "question_id": 35246397, "link": "https://stackoverflow.com/questions/35246397/codifying-presence-absence-of-authentication-at-type-level/35246931#35246931", "title": "Codifying presence/absence of authentication at type level", "body": "<p><a href=\"http://www.scs.stanford.edu/11au-cs240h/notes/laziness.html#phantom-types-to-the-rescue\"><strong>Phantom types to the rescue!</strong></a> is Bryan O'Sullivan example of implementing read-only vs read/write access <strong>at the type level</strong> using <a href=\"https://wiki.haskell.org/Phantom_type\"><strong>phantom types</strong></a>.</p>\n\n<p>Similarly, for your use-case:</p>\n\n<pre><code>data Unknown       -- unknown users\ndata Authenticated -- verified users\n\nnewtype User a i = Id i deriving Show\n</code></pre>\n\n<p>It is <em>important</em> that the data constructor <code>Id</code> is <em>not</em> exposed to user, but the module provides functions to initialize and authenticate users:</p>\n\n<pre><code>-- initializes an un-authenticated user\nnewUser :: i -&gt; User Unknown i\nnewUser = Id\n\n-- authenticates a user\nauthUser :: (User a i) -&gt; User Authenticated i\nauthUser (Id i) = Id i  -- dummy implementation\n</code></pre>\n\n<p>then, you may control access at the type level <em>without code duplication</em>, <em>without run-time checks</em> and <em>without run-time cost</em>: </p>\n\n<pre><code>-- open to all users\ngetId :: User a i -&gt; i\ngetId (Id i) = i\n\n-- only authenticated users can pass through\ngetId' :: User Authenticated i -&gt; i\ngetId' (Id i) = i\n</code></pre>\n\n<p>For example, if </p>\n\n<pre><code>\\&gt; let jim = newUser \"jim\"\n\\&gt; let joe = authUser $ newUser \"joe\"\n</code></pre>\n\n<p><code>joe</code> is an authenticated user and can be passed to either function:</p>\n\n<pre><code>\\&gt; getId joe\n\"joe\"\n\\&gt; getId' joe\n\"joe\"\n</code></pre>\n\n<p>whereas, you will get <em>compile-time error</em> if you call <code>getId'</code> with <code>jim</code>:</p>\n\n<pre><code>\\&gt; getId jim\n\"jim\"\n\\&gt; getId' jim   -- compile-time error! not run-time error!\n\n&lt;interactive&gt;:28:8:\n    Couldn't match type \u2018Unknown\u2019 with \u2018Authenticated\u2019\n    Expected type: User Authenticated [Char]\n      Actual type: User Unknown [Char]\n    In the first argument of \u2018getId'\u2019, namely \u2018jim\u2019\n    In the expression: getId' jim\n</code></pre>\n"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 1, "answer_count": 1, "score": 9, "last_activity_date": 1454798643, "creation_date": 1454792394, "question_id": 35246397, "link": "https://stackoverflow.com/questions/35246397/codifying-presence-absence-of-authentication-at-type-level", "title": "Codifying presence/absence of authentication at type level", "body": "<p><strong>Context:</strong> I'm approaching Haskell from a standpoint of converting runtime errors to compile-time errors. My hypothesis is that this is possible if one can codify business logic within the program's types itself. </p>\n\n<p>I'm writing a Telegram bot, which should be accessible by users within my company. To achieve this \"restriction\", whenever someone starts chatting with the bot it will look up the <code>chat_id</code> in a table and check if a valid <code>oauth_token</code> exists. If not, the user will first be sent a link to complete a Google OAuth (our company's email is hosted on Google Apps for Business).</p>\n\n<pre><code>share [mkPersist sqlSettings, mkMigrate \"migrateAll\"] [persistLowerCase|\nVLUser\n  email String\n  chatId Integer\n  tgramUserId Integer\n  tgramFirstName String\n  tgramLastName String Maybe\n  tgramUsername String Maybe\n  oauthToken String Maybe\n  deriving Show\n|]\n</code></pre>\n\n<p>Users with a valid <code>oauth_token</code> will be able to give the Telegram bot some commands, which unauthenticated users should not be able to give.</p>\n\n<p>Now, I'm trying to codify this logic at the type level itself. There will be some functions in my Haskell code that will have the ability to accept, as arguments, both, authenticated &amp; unauthenticated users; while some functions should accept only authenticated users.</p>\n\n<p>If I keep passing user objects of the same type, i.e. <code>VLUser</code> everywhere, then I will have to be careful to check for the presence of <code>oauthToken</code> in every function. Is there a way to create two user types - <code>VLUser</code> and <code>VLUserAuthenticated</code> where:</p>\n\n<ol>\n<li>Both map to the same underlying table</li>\n<li>A <code>VLUserAuthenticated</code> can be instantiated ONLY IF it has an <code>oauthToken</code></li>\n</ol>\n"}, {"tags": ["parsing", "haskell", "parsec"], "comments": [{"owner": {"reputation": 286979, "user_id": 541136, "user_type": "moderator", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/wftMn.jpg?s=128&g=1", "display_name": "Aaron Hall", "link": "https://stackoverflow.com/users/541136/aaron-hall"}, "edited": false, "score": 1, "creation_date": 1454788364, "post_id": 35245140, "comment_id": 58205304, "body": "Could you state your question, perhaps with a &quot;How can I...&quot; and ending with a &quot;?&quot;?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1454815735, "post_id": 35245140, "comment_id": 58212258, "body": "Is this really a minimal example? Which attempts have you made to track down the code which causes the problem? At the very least, try replacing each function definition by <code>undefined</code> one by one. When your program returns <code>undefined</code> instead of looping, you know the offending function is the one you just changed. One answerer has already given you a hint as to where it may be."}], "answers": [{"tags": [], "owner": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "is_accepted": false, "score": 2, "last_activity_date": 1454791091, "last_edit_date": 1454791091, "creation_date": 1454789419, "answer_id": 35245910, "question_id": 35245140, "link": "https://stackoverflow.com/questions/35245140/haskell-parsec-gives-loop-error/35245910#35245910", "title": "Haskell parsec gives &lt;&lt;loop&gt;&gt; error", "body": "<p>It might help if you were more specific about your error message.  But I suspect the problem is that you have a left-recursive grammar:  for example, an <code>arrTy</code> can start with an <code>anyType</code>, which can be an <code>arrTy</code>.</p>\n\n<p>When implemented directly in a top-down parser (which includes combinator parsers such as Parsec), this kind of feature would cause an infinite loop.  Parsec provides various facilities to work around this problem; however, the most convenient way to solve your particular problem may also require some re-work of your grammar.</p>\n"}], "owner": {"reputation": 63, "user_id": 5892966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26dcd4cfa2f969daa76951738ad8d51?s=128&d=identicon&r=PG&f=1", "display_name": "cauliflower", "link": "https://stackoverflow.com/users/5892966/cauliflower"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1454791091, "creation_date": 1454785183, "question_id": 35245140, "link": "https://stackoverflow.com/questions/35245140/haskell-parsec-gives-loop-error", "title": "Haskell parsec gives &lt;&lt;loop&gt;&gt; error", "body": "<p>I've been trying to write a parser for the typed lambda calculus using parsec but it keeps getting stuck in a loop resulting in a &lt;> error. Everything seems fine to me; I have probably misunderstood something about parsec.</p>\n\n<pre><code>{-# LANGUAGE UnicodeSyntax #-}\n\nmodule Parser where\n\nimport Semantics ( NmTerm(..)\n                 , Ty(..))\n\nimport Text.ParserCombinators.Parsec (Parser(..)\n                                     , ParseError\n                                     , try\n                                     , oneOf\n                                     , char\n                                     , digit\n                                     , satisfy\n                                     , many1\n                                     , choice\n                                     , chainl1\n                                     , alphaNum\n                                     , eof\n                                     , letter\n                                     , parse)\n\nimport qualified Text.Parsec.Token as T\nimport qualified Text.Parsec.Language as L\nimport qualified Text.Parsec.Expr as E\nimport Control.Applicative ((&lt;|&gt;))\n\n------------\n-- LEXING --\n------------\n\nlexer \u2237 T.TokenParser ()\nlexer = T.makeTokenParser\n        $ L.emptyDef { T.identStart      = letter\n                     , T.identLetter     = alphaNum\n                     , T.reservedOpNames = [\"lambda\", \".\", \":\", \"-&gt;\"]\n                     , T.reservedNames   = [\"true\", \"false\", \"Bool\"]\n                     , T.opLetter        = oneOf \".:\"\n                     }\n\nparens \u2237 Parser a \u2192 Parser a\nparens = T.parens lexer\n\nnatural \u2237 Parser Integer\nnatural = T.natural lexer\n\nreserved \u2237 String \u2192 Parser ()\nreserved = T.reserved lexer\n\nreservedOp \u2237 String \u2192 Parser ()\nreservedOp = T.reservedOp lexer\n\nidentifier \u2237 Parser String\nidentifier = T.identifier lexer\n\nwhiteSpace \u2237 Parser ()\nwhiteSpace = T.whiteSpace lexer\n\n-------------------------------------------------------------------------------\n-------------------------------------- PARSING --------------------------------\n-------------------------------------------------------------------------------\nvariable \u2237 Parser NmTerm\nvariable = identifier &gt;&gt;= \\x \u2192 return $ NmVar x\n\ntrue \u2237 Parser NmTerm\ntrue = reserved \"true\" &gt;&gt; return NmTrue\n\nfalse \u2237 Parser NmTerm\nfalse = reserved \"false\" &gt;&gt; return NmFalse\n\nbool \u2237 Parser NmTerm\nbool = true &lt;|&gt; false\n\nboolTy \u2237 Parser Ty\nboolTy = reserved \"Bool\" &gt;&gt; return TyBool\n\narrTy \u2237 Parser Ty\narrTy = do\n  \u03c4\u2081 \u2190 anyType\n  whiteSpace\n  reservedOp \"-&gt;\"\n  whiteSpace\n  \u03c4\u2082 \u2190 anyType\n  return $ TyArr \u03c4\u2081 \u03c4\u2082\n\nanyType \u2237 Parser Ty\nanyType = arrTy &lt;|&gt; boolTy\n\nabstraction \u2237 Parser NmTerm\nabstraction = do\n  reservedOp \"lambda\"\n  whiteSpace\n  x \u2190 identifier\n  reservedOp \":\"\n  \u03c4 \u2190 anyType\n  reservedOp \".\"\n  whiteSpace\n  body \u2190 expr\n  return $ NmAbs x \u03c4 body\n\nexpr \u2237 Parser NmTerm\nexpr =  abstraction\n    &lt;|&gt; variable\n    &lt;|&gt; bool\n\nparseExpr \u2237 String \u2192 NmTerm\nparseExpr t = case parse expr \"\" t of\n                Left err  \u2192 error $ show err\n                Right ast \u2192 ast\n</code></pre>\n"}, {"tags": ["haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 1579, "user_id": 3979919, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/H11F1.jpg?s=128&g=1", "display_name": "Nima Mousavi", "link": "https://stackoverflow.com/users/3979919/nima-mousavi"}, "edited": false, "score": 0, "creation_date": 1454854813, "post_id": 35244926, "comment_id": 58221592, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/9027384/haskell-ghc-what-is-the-time-complexity-of-a-pattern-match-with-n-constructors\">Haskell GHC: what is the time complexity of a pattern match with N constructors?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1579, "user_id": 3979919, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/H11F1.jpg?s=128&g=1", "display_name": "Nima Mousavi", "link": "https://stackoverflow.com/users/3979919/nima-mousavi"}, "edited": false, "score": 3, "creation_date": 1454785370, "post_id": 35245073, "comment_id": 58204252, "body": "That is true. But <code>zip&#39; undefined [1, 2, 3]</code> will produce an exception in both cases. So I can&#39;t see how this helps or rather why it would be desirable."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 1579, "user_id": 3979919, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/H11F1.jpg?s=128&g=1", "display_name": "Nima Mousavi", "link": "https://stackoverflow.com/users/3979919/nima-mousavi"}, "edited": false, "score": 1, "creation_date": 1454811581, "post_id": 35245073, "comment_id": 58211575, "body": "@Nimi, in this case it only determines <i>which</i> argument is unconditionally strict."}, {"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "reply_to_user": {"reputation": 1579, "user_id": 3979919, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/H11F1.jpg?s=128&g=1", "display_name": "Nima Mousavi", "link": "https://stackoverflow.com/users/3979919/nima-mousavi"}, "edited": false, "score": 1, "creation_date": 1454850504, "post_id": 35245073, "comment_id": 58220158, "body": "@Nimi the point was that you can make the two functions behave very differently and not do the same thing. note the other example, <code>zip&#39; (filter (&lt; 4) [1..]) [1, 2, 3]</code> to see how this can also impact performance."}, {"owner": {"reputation": 1579, "user_id": 3979919, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/H11F1.jpg?s=128&g=1", "display_name": "Nima Mousavi", "link": "https://stackoverflow.com/users/3979919/nima-mousavi"}, "edited": false, "score": 0, "creation_date": 1454858662, "post_id": 35245073, "comment_id": 58223006, "body": "@behzad.nouri Ahh.. I can see it now. Thx"}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": false, "score": 7, "last_activity_date": 1454787563, "last_edit_date": 1454787563, "creation_date": 1454784839, "answer_id": 35245073, "question_id": 35244926, "link": "https://stackoverflow.com/questions/35244926/haskell-pattern-matching-readability-and-performance/35245073#35245073", "title": "Haskell Pattern Matching: Readability and Performance", "body": "<blockquote>\n  <p>As far as I understand both methods do the same thing.</p>\n</blockquote>\n\n<p>almost; with an exception:</p>\n\n<pre><code>\\&gt; zip' undefined []   -- 1st definition of zip'\n[]\n\\&gt; zip' (filter (&lt; 4) [1..]) [1, 2, 3]\n[(1,1),(2,2),(3,3)]\n</code></pre>\n\n<p>whereas:</p>\n\n<pre><code>\\&gt; zip' undefined []   -- 2nd definition of zip'\n*** Exception: Prelude.undefined\n\\&gt; zip' (filter (&lt; 4) [1..]) [1, 2, 3]\n[(1,1),(2,2),(3,3)   -- gets stuck here; never returns\n</code></pre>\n\n<p>in other words, the 2nd definition always forces <a href=\"https://wiki.haskell.org/Weak_head_normal_form\" rel=\"nofollow\">weak head normal form</a> for <em>both</em> arguments. </p>\n\n<p>Performance-wise, this means that one can construct a <em>pathological</em> example  such that WHNF involves heavy computations, therefore one definition performs very differently than the other.</p>\n"}], "owner": {"reputation": 1579, "user_id": 3979919, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/H11F1.jpg?s=128&g=1", "display_name": "Nima Mousavi", "link": "https://stackoverflow.com/users/3979919/nima-mousavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 550, "favorite_count": 0, "answer_count": 1, "score": 7, "last_activity_date": 1454858532, "creation_date": 1454784153, "last_edit_date": 1495535305, "question_id": 35244926, "link": "https://stackoverflow.com/questions/35244926/haskell-pattern-matching-readability-and-performance", "title": "Haskell Pattern Matching: Readability and Performance", "body": "<p>I'm going through the <a href=\"http://learnyouahaskell.com/recursion#hello-recursion\" rel=\"nofollow noreferrer\">learn you a haskell</a> tutorial and\nI've been tripping over some of the examples the author \nhas given.</p>\n\n<p>For example he reimplemented zip as follows:</p>\n\n<pre><code>zip' :: [a] -&gt; [b] -&gt; [(a,b)]  \nzip' _ [] = []  \nzip' [] _ = []  \nzip' (x:xs) (y:ys) = (x,y):zip' xs ys\n</code></pre>\n\n<p>He uses a similar approach for all his other examples,\nwhere he puts the most specific patterns first. Here is a slightly different\nversion of the zip function:</p>\n\n<pre><code>zip' :: [a] -&gt; [b] -&gt; [(a,b)]\nzip' (x:xs) (y:ys)  = (x, y):zip' xs ys\nzip' _ _            = []\n</code></pre>\n\n<p>As far as I understand both methods do the same thing. If\nan empty list is provided either way (x:xs) or (y:ys)\nwon't match which will finish the recursion by appending\nthe empty list [].</p>\n\n<ol>\n<li>I personally prefer the second version for readability, but maybe I'm wrong in doing so.</li>\n<li>Does it have any effect on the performance of a method? As far as I understand if the top most pattern does not match, Haskell will check against the next pattern. Does the order of the patterns affect performance?</li>\n</ol>\n\n<p>Kind regards,</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Possibly duplicate of:\n<a href=\"https://stackoverflow.com/questions/9027384/haskell-ghc-what-is-the-time-complexity-of-a-pattern-match-with-n-constructors\">Haskell GHC: what is the time complexity of a pattern match with N constructors?</a></p>\n\n<p>Summary: The order of the patterns is very important for the semantics (in terms of strict evaluation of the arguments) and the readability of a function. The pattern match itself will always be in <strong>O(1)</strong> time complexity.</p>\n"}, {"tags": ["image", "haskell", "image-processing", "friday"], "comments": [{"owner": {"reputation": 17633, "user_id": 2858170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4263428b9b0e0aed365e264c7a2b044?s=128&d=identicon&r=PG&f=1", "display_name": "Piglet", "link": "https://stackoverflow.com/users/2858170/piglet"}, "edited": false, "score": 0, "creation_date": 1454785280, "post_id": 35244866, "comment_id": 58204213, "body": "will you always have this background or should this work with arbitrary images? Unfortunately I have no idea of Haskell"}, {"owner": {"reputation": 1514, "user_id": 2396264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/423ea1e7faf341fbc2a08cc48c1d5886?s=128&d=identicon&r=PG", "display_name": "MarengoHue", "link": "https://stackoverflow.com/users/2396264/marengohue"}, "reply_to_user": {"reputation": 17633, "user_id": 2858170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4263428b9b0e0aed365e264c7a2b044?s=128&d=identicon&r=PG&f=1", "display_name": "Piglet", "link": "https://stackoverflow.com/users/2858170/piglet"}, "edited": false, "score": 0, "creation_date": 1454786713, "post_id": 35244866, "comment_id": 58204700, "body": "Thats unfortunate since the question is more about Haskell than anything else."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1454787380, "post_id": 35244866, "comment_id": 58204937, "body": "Could you present your current code that reads, grays scales, and edge detects?  As with your last question, I&#39;d like to answer but am far too lazy to re-produce the initial steps."}, {"owner": {"reputation": 1514, "user_id": 2396264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/423ea1e7faf341fbc2a08cc48c1d5886?s=128&d=identicon&r=PG", "display_name": "MarengoHue", "link": "https://stackoverflow.com/users/2396264/marengohue"}, "edited": false, "score": 0, "creation_date": 1454792369, "post_id": 35244866, "comment_id": 58206580, "body": "I&#39;ve added the initial steps as you were asking."}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 1, "last_activity_date": 1454821588, "last_edit_date": 1454821588, "creation_date": 1454798230, "answer_id": 35247357, "question_id": 35244866, "link": "https://stackoverflow.com/questions/35244866/filling-the-enclosed-areas-with-random-colors-haskell-friday/35247357#35247357", "title": "Filling the enclosed areas with random colors - Haskell - Friday", "body": "<p>I didn't see a question in your posting, the closest seems to be:</p>\n\n<blockquote>\n  <p>I was unable to find the way of iterating over all of the pixels though.</p>\n</blockquote>\n\n<p>You can itereate over all the pixels using <code>map</code> but then... that's just a map and you'll get no state (it's not a fold after all).  So you might want to make your own primitive recursive function and just index each pixel using <a href=\"https://hackage.haskell.org/package/friday-0.2.2.0/docs/Vision-Image-Class.html#v:index\" rel=\"nofollow\"><code>index</code></a> which is the same as <a href=\"https://hackage.haskell.org/package/friday-0.2.2.0/docs/Vision-Image-Class.html#v:-33-\" rel=\"nofollow\"><code>!</code></a>.</p>\n\n<p>You also said:</p>\n\n<blockquote>\n  <p>My idea was to use the Friday's edge detection and then fill all of the enclosed areas with it's fill function.</p>\n</blockquote>\n\n<p>Well if you fill \"all of the enlosed areas\" then your whole picture will be <strike>white</strike> filled with whatever the outer outline is depending on fill strategy - notice the larger rectangle encompassing your whole image.  I suggest you do a contour trace and filter on some simple things like perimeter size, height, width, or ratios.  My contour modules isn't pushed up to hackage yet but you can get it from github. Notice the <code>drawContour</code> function should work for you once its properly functioning (part of why I won't push it up to Hackage just yet).</p>\n"}, {"comments": [{"owner": {"reputation": 1514, "user_id": 2396264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/423ea1e7faf341fbc2a08cc48c1d5886?s=128&d=identicon&r=PG", "display_name": "MarengoHue", "link": "https://stackoverflow.com/users/2396264/marengohue"}, "edited": false, "score": 0, "creation_date": 1454910298, "post_id": 35255587, "comment_id": 58237871, "body": "Wow thank you for going through all of that hastle to implement the solution. I was working on it myself, but didn&#39;t quite finish it yet, so I didn&#39;t close the question before I was done in case I got more questions."}, {"owner": {"reputation": 1514, "user_id": 2396264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/423ea1e7faf341fbc2a08cc48c1d5886?s=128&d=identicon&r=PG", "display_name": "MarengoHue", "link": "https://stackoverflow.com/users/2396264/marengohue"}, "edited": false, "score": 0, "creation_date": 1454910824, "post_id": 35255587, "comment_id": 58238032, "body": "Where can I find any docs on this &#39;contour&#39; function? I&#39;ve scanned through your friday&#39;s fork on github but didn&#39;t find anything."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 1514, "user_id": 2396264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/423ea1e7faf341fbc2a08cc48c1d5886?s=128&d=identicon&r=PG", "display_name": "MarengoHue", "link": "https://stackoverflow.com/users/2396264/marengohue"}, "edited": false, "score": 1, "creation_date": 1454944959, "post_id": 35255587, "comment_id": 58257739, "body": "I now have access to the main repo: <a href=\"https://github.com/RaphaelJ/friday/blob/master/src/Vision/Image/Contour.hs\" rel=\"nofollow noreferrer\">github.com/RaphaelJ/friday/blob/master/src/Vision/Image/&hellip;</a>"}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 2, "last_activity_date": 1454860340, "creation_date": 1454860340, "answer_id": 35255587, "question_id": 35244866, "link": "https://stackoverflow.com/questions/35244866/filling-the-enclosed-areas-with-random-colors-haskell-friday/35255587#35255587", "title": "Filling the enclosed areas with random colors - Haskell - Friday", "body": "<blockquote>\n  <p>How do I find area and perimeter of connected components?</p>\n</blockquote>\n\n<p>You can use the contour tracing from <code>Vision.Image.Contour</code> to get all contour perimeters.  First lets start with getting the edges like you have:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\nimport Prelude as P\nimport System.Environment (getArgs)\n\nimport Vision.Detector.Edge (canny)\nimport Vision.Image\nimport Vision.Primitive.Shape\nimport Vision.Image.Storage.DevIL (Autodetect (..), load, save)\nimport Vision.Image.Transform(floodFill)\nimport Control.Monad.ST (runST, ST)\nimport Vision.Image.Contour\n\n-- Detects the edge of the image with the Canny's edge detector.\n--\n-- usage: ./canny input.png output.png\nmain :: IO ()\nmain = do\n    [input, output] &lt;- getArgs\n\n    -- Loads the image. Automatically infers the format.\n    io &lt;- load Autodetect input\n\n    case io of\n        Left err             -&gt; do\n            putStrLn \"Unable to load the image:\"\n            print err\n        Right (grey :: Grey) -&gt; do\n            let blurred, edges :: Grey\n                edges = canny 2 256 1024 blurred :: Grey\n</code></pre>\n\n<p>Here's where we acquire contours.  Due to a bug in the draw function, which I use later, I'll blur first to get contours with distinct inner and outer points. This will get patched eventually...</p>\n\n<pre><code>                cs           = contours (blur 2 edges :: Grey)\n                goodContours = P.filter goodSize (allContourIds cs)\n</code></pre>\n\n<p>Now we have a value of this <code>Contours</code> type which includes a valid <code>ContourId</code> for each connected component.  For each <code>ContourId</code> you can get its area with <code>contourSize</code> and perimeter with <code>contourPerimeter</code>.  The size of the perimeter is just the length of the list of perimeter points.</p>\n\n<p>I just did a really overly-tailored filter, called <code>goodSize</code> to get the spoons, but you can play with area and perimeter all you'd like:</p>\n\n<pre><code>                goodSize x   = let ((xmin,xmax),(ymin,ymax)) = contourBox cs x\n                               in xmax-xmin &gt; 60 &amp;&amp; xmax-xmin &lt; 500 &amp;&amp;\n                                  ymax-ymin &gt; 100 &amp;&amp; ymax-ymin &lt; 500\n\n                final, filledContours :: RGBA\n                filledContours =\n                   convert $ drawContours cs (shape edges) Fill goodContours\n</code></pre>\n\n<p>Optionally, for each contour use floodFill to get a color.  Here I just use three colors and fill whichever contours are first in the list.  The contours list is ordered top-to-bottom left-to-right so this will look odd-ish.  You could <code>sortBy xmin goodContours</code> to get a left-right ordering.</p>\n\n<pre><code>                floodStart = concatMap (take 1 . contourPerimeter cs) goodContours\n                colors = cycle [RGBAPixel 255 0 0 255, RGBAPixel 0 255 0 255, RGBAPixel 0 0 255 255]\n                final = runST doFill\n</code></pre>\n\n<p>The fill operation is using the <code>ST</code> monad, which you can find many questions about here on StackOverflow.</p>\n\n<pre><code>                doFill :: forall s. ST s RGBA\n                doFill = do\n                          m &lt;- thaw filledContours :: ST s (MutableManifest RGBAPixel s)\n                          mapM_ (\\(p,c) -&gt; floodFill p c m) (zip floodStart colors)\n                          return =&lt;&lt; unsafeFreeze m\n\n            -- Saves the edges image. Automatically infers the output format.\n            mErr &lt;- save Autodetect output final\n            case mErr of\n                Nothing  -&gt;\n                    putStrLn \"Success.\"\n                Just err -&gt; do\n                    putStrLn \"Unable to save the image:\"\n                    print err\n\ncontourBox cs x =\n  let ps = contourPerimeter cs x\n      (xs,ys) = unzip $ P.map (\\(Z :. x :. y) -&gt; (x,y)) ps\n  in ((minimum xs, maximum xs), (minimum ys, maximum ys))\n</code></pre>\n\n<p>The end result is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/QOmp6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QOmp6.jpg\" alt=\"RGB Spoons\"></a></p>\n"}], "owner": {"reputation": 1514, "user_id": 2396264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/423ea1e7faf341fbc2a08cc48c1d5886?s=128&d=identicon&r=PG", "display_name": "MarengoHue", "link": "https://stackoverflow.com/users/2396264/marengohue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 2, "accepted_answer_id": 35255587, "answer_count": 2, "score": 3, "last_activity_date": 1454860340, "creation_date": 1454783828, "last_edit_date": 1454792064, "question_id": 35244866, "link": "https://stackoverflow.com/questions/35244866/filling-the-enclosed-areas-with-random-colors-haskell-friday", "title": "Filling the enclosed areas with random colors - Haskell - Friday", "body": "<p>I am trying to perform not very complex image analysis to try and find distinct shapes and calculate some of their parameters like area and perimeter (in pixels) and I am trying to do this in Haskell (I wanted to do that to try and work with functional programming language).</p>\n\n<p>The first task in line is to count the amount of spoons on the image:\n<a href=\"https://i.stack.imgur.com/h1Ws4.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h1Ws4.jpg\" alt=\"Image of 6 spoons\"></a>\nI am using <a href=\"http://hackage.haskell.org/package/friday-0.2.2.0\" rel=\"nofollow noreferrer\">Friday</a> Haskell package to work with images.</p>\n\n<p>My idea was to use the Friday's edge detection and then fill all of the enclosed areas with it's fill function. The first one would require me to iterate over image's pixels until i've stumbled upon a black pixel. Than I would fill the area and continue the search in the image (which now has one of it's objects filled). I could color different objects with random colors and associate these colors with their objects to find their areas and perimeters.</p>\n\n<p>Here is how this image looks after I've applied edge detection to it:\n<a href=\"https://i.stack.imgur.com/3GqLX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3GqLX.png\" alt=\"enter image description here\"></a></p>\n\n<p>I was unable to find the way of iterating over all of the pixels though.\nI've found those <strong>read</strong> and <strong>readLinear</strong> functions in the following package: <a href=\"https://hackage.haskell.org/package/friday-0.2.2.0/docs/Vision-Image-Mutable.html#v:linearRead\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/friday-0.2.2.0/docs/Vision-Image-Mutable.html#v:linearRead</a>, but I am not sure how to use them and I was unable to deduce that from their type signature since I am very very new to Haskell.</p>\n\n<p>Here is the code that does all of the image reading, grayscaling and edge detecting:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\nimport Prelude hiding (filter)\nimport System.Environment (getArgs)\n\nimport Vision.Detector.Edge (canny)\nimport Vision.Image\nimport Vision.Image.Storage.DevIL (Autodetect (..), load, save)\n\ndetectEdges :: RGBA -&gt; Grey\ndetectEdges img =\n  let grey = convert img :: Grey\n      -- Img blurring --\n      blurRadius = 2\n      blurred = gaussianBlur blurRadius (Nothing :: Maybe Double) grey :: Grey\n\n      -- Sobel applying --\n      sobelRadius = 2\n      lowThreshold = 256\n      highThreshold = 1024\n  in (canny sobelRadius lowThreshold highThreshold blurred) :: Grey\n\nprocessImg :: RGBA -&gt; RGBA\nprocessImg img =\n  let edges = detectEdges img\n  -- Here goes all of the important stuff\n  in convert edges :: RGBA\n\nmain :: IO ()\nmain = do\n  [input, output] &lt;- getArgs\n\n  io &lt;- load Autodetect input\n  case io of\n    Left err             -&gt; do\n      putStrLn \"Unable to load the image:\"\n      print err\n\n    Right (img :: RGBA)  -&gt; do\n      mErr &lt;- save Autodetect output (processImg img)\n      case mErr of\n        Nothing  -&gt;\n          putStrLn \"Success.\"\n        Just err -&gt; do\n          putStrLn \"Unable to save the image:\"\n          print err\n</code></pre>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1454783517, "post_id": 35244406, "comment_id": 58203520, "body": "In the case you are trying to learn Haskell (or any other language) by mapping features from previously known languages, I&#39;d strongly recommend against it. Never try to program in X while thinking in terms of Y -- doing that will only ensure you will find X lacking many things Y has, while missing all the features X has and Y has not, leading to very non-idiomatic code in X."}, {"owner": {"reputation": 353, "user_id": 5800193, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c4e566babcca96e4c1c9509d94c34125?s=128&d=identicon&r=PG&f=1", "display_name": "Bread", "link": "https://stackoverflow.com/users/5800193/bread"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1454786130, "post_id": 35244406, "comment_id": 58204526, "body": "@chi i asked because haskell has generics, if it has generics then there must be something similar to interfaces."}, {"owner": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1454790246, "post_id": 35244406, "comment_id": 58205895, "body": "@chi is correct to warn you, though.  If you expect Haskell typeclasses to behave like Java interfaces, just because they both provide polymorphic abstraction, you will be very confused.  Haskell is not object-oriented in any way."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1454796303, "post_id": 35244406, "comment_id": 58207773, "body": "What Haskell calls generics are pretty much completely unrelated to what Java calls generics."}, {"owner": {"reputation": 8576, "user_id": 327074, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/785321440230453d4a2a721f753bd538?s=128&d=identicon&r=PG", "display_name": "icc97", "link": "https://stackoverflow.com/users/327074/icc97"}, "edited": false, "score": 0, "creation_date": 1526630878, "post_id": 35244406, "comment_id": 87828553, "body": "There&#39;s good answers here: <a href=\"https://softwareengineering.stackexchange.com/questions/189047/what-is-the-functional-programming-alternative-to-an-interface\" title=\"what is the functional programming alternative to an interface\">softwareengineering.stackexchange.com/questions/189047/&hellip;</a>"}, {"owner": {"reputation": 3483, "user_id": 2668666, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3QEDd.jpg?s=128&g=1", "display_name": "jmrah", "link": "https://stackoverflow.com/users/2668666/jmrah"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1581086456, "post_id": 35244406, "comment_id": 106323229, "body": "@chi while there is wisdom in your statement, it&#39;s not always the best way to learn.  For me, (and I imagine many people too), assimilating new concepts is vastly easier when I have a context, or reference point to base the new concepts upon.  Learning functional programming concepts by comparing and contrasting them to more mainstream language features can aid in the learning process."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3483, "user_id": 2668666, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3QEDd.jpg?s=128&g=1", "display_name": "jmrah", "link": "https://stackoverflow.com/users/2668666/jmrah"}, "edited": false, "score": 0, "creation_date": 1581103448, "post_id": 35244406, "comment_id": 106331465, "body": "@jrahhali Sure, comparing and contrasting is indeed a good thing. The issue is found when a programmer&#39;s mind is so accustomed to language Y that it can&#39;t think of anything else apart what&#39;s possible in Y. By contrast, IMO, realizing that Y has features 1,2,3,4 while another language X has 1,4,5,6 is very helpful to achieve a better understanding of both languages."}], "answers": [{"tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": false, "score": 6, "last_activity_date": 1454781663, "creation_date": 1454781663, "answer_id": 35244445, "question_id": 35244406, "link": "https://stackoverflow.com/questions/35244406/interfaces-in-functional-programming/35244445#35244445", "title": "Interfaces in functional programming", "body": "<p>Haskell <a href=\"https://www.haskell.org/tutorial/classes.html\">typeclasses</a> fulfill some of the same roles as interfaces in object oriented languages.</p>\n"}, {"tags": [], "owner": {"reputation": 23981, "user_id": 2813589, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9axBj.jpg?s=128&g=1", "display_name": "\u30a2\u30ec\u30c3\u30af\u30b9", "link": "https://stackoverflow.com/users/2813589/%e3%82%a2%e3%83%ac%e3%83%83%e3%82%af%e3%82%b9"}, "is_accepted": false, "score": 0, "last_activity_date": 1454781908, "creation_date": 1454781908, "answer_id": 35244497, "question_id": 35244406, "link": "https://stackoverflow.com/questions/35244406/interfaces-in-functional-programming/35244497#35244497", "title": "Interfaces in functional programming", "body": "<p><strong>data</strong> and <strong>newtype</strong> in Haskell are approximately equal to <strong>class</strong> in Java.</p>\n\n<p><strong>class</strong> in Haskell is approximately equal to <strong>interface</strong> in Java.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1454783657, "post_id": 35244601, "comment_id": 58203595, "body": "Some mention of the &quot;expression problem&quot; may be in order."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1454797497, "post_id": 35244601, "comment_id": 58208165, "body": "This answer needs more emphasis.  Things you would solve with an interface in java are usually best solved with functions in haskell.  Type classes are something very different, and attempting to use them like interfaces will lead you to pain."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 7, "last_activity_date": 1454782421, "creation_date": 1454782421, "answer_id": 35244601, "question_id": 35244406, "link": "https://stackoverflow.com/questions/35244406/interfaces-in-functional-programming/35244601#35244601", "title": "Interfaces in functional programming", "body": "<p>There are things like typeclasses, as the other answers say, but even more than that, there's one pervasive interface: <em>a function</em>. Many, many places where an object-oriented program would need some custom interface, a similar functional program can just use a function. eg, <code>map f xs</code> in haskell uses <code>f</code>, where an object-oriented program might use a Visitor or whatever to accomplish the same task.</p>\n"}], "owner": {"reputation": 353, "user_id": 5800193, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c4e566babcca96e4c1c9509d94c34125?s=128&d=identicon&r=PG&f=1", "display_name": "Bread", "link": "https://stackoverflow.com/users/5800193/bread"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1538, "favorite_count": 0, "accepted_answer_id": 35244601, "answer_count": 3, "score": 2, "last_activity_date": 1454782421, "creation_date": 1454781429, "question_id": 35244406, "link": "https://stackoverflow.com/questions/35244406/interfaces-in-functional-programming", "title": "Interfaces in functional programming", "body": "<p>In java and c# we have interfaces, what is the equivalent to that in a language like haskell or what is the concept called in functional programming?</p>\n"}, {"tags": ["haskell", "list-comprehension"], "answers": [{"comments": [{"owner": {"reputation": 5804, "user_id": 777510, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/MUpFE.png?s=128&g=1", "display_name": "\u1d18\u1d00\u0274\u1d00\u028f\u026a\u1d0f\u1d1b\u026as", "link": "https://stackoverflow.com/users/777510/%e1%b4%98%e1%b4%80%c9%b4%e1%b4%80%ca%8f%c9%aa%e1%b4%8f%e1%b4%9b%c9%aas"}, "edited": false, "score": 0, "creation_date": 1454773630, "post_id": 35242812, "comment_id": 58199773, "body": "Yes I know what drop does I still can&#39;t find where my logic is wrong though"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1454772840, "creation_date": 1454772840, "answer_id": 35242812, "question_id": 35242490, "link": "https://stackoverflow.com/questions/35242490/why-doesnt-this-list-comprehension-in-haskell-include-lists-of-size-n/35242812#35242812", "title": "Why doesn&#39;t this list comprehension in haskell include lists of size &lt; n", "body": "<p><code>drop (i+1) xs</code> does not remove the <code>i+1</code>th element, but all the elements with index <code>&lt; i+1</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1454827068, "post_id": 35243067, "comment_id": 58214245, "body": "In case anyone&#39;s wondering, that could be the <code>second</code> from <code>Data.Bifunctor</code> or the one from <code>Control.Arrow</code>. Since the <code>Bifunctor</code> abstraction is considerably easier to grasp, I&#39;d go with that one."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1454774644, "last_edit_date": 1454774644, "creation_date": 1454774319, "answer_id": 35243067, "question_id": 35242490, "link": "https://stackoverflow.com/questions/35242490/why-doesnt-this-list-comprehension-in-haskell-include-lists-of-size-n/35243067#35243067", "title": "Why doesn&#39;t this list comprehension in haskell include lists of size &lt; n", "body": "<p>What you're trying to do is this: &ldquo;isolate&rdquo; each element in the list from the rest, then recurse over the rest. You attempt to achieve this seperation by, on one side, <em>selecting</em> each element with <code>!!</code>, and on the other <em>removing</em> it. But that's not quite what <code>drop</code> does, it's rather a task for <code>deleteBy</code>. That is awkward to use with indices, though:</p>\n\n<pre><code>combinations n xs = [ xs !! i : x | i &lt;- [0..(length xs)-1] \n                                  , x &lt;- combinations (n-1) (xs' i) ]\n where xs' i = snd &lt;$&gt; deleteBy ((==i).fst) (zip [0..] xs)\n</code></pre>\n\n<p><em>In general</em> it's rather unidiomatic to index into Haskell lists. A much better approach is to implement this isolation-thing by direct recursion:</p>\n\n<pre><code>foci :: [a] -&gt; [(a,[a])]\nfoci [] = []\nfoci (x:xs) = (x,xs) : map (second (x:)) (foci xs)\n</code></pre>\n\n<p>And then you can do</p>\n\n<pre><code>combinations n xs = [ x\u2080 : xs'' | (x\u2080,xs') &lt;- foci xs\n                                , xs'' &lt;- combinations (n-1) xs' ]\n</code></pre>\n"}], "owner": {"reputation": 5804, "user_id": 777510, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/MUpFE.png?s=128&g=1", "display_name": "\u1d18\u1d00\u0274\u1d00\u028f\u026a\u1d0f\u1d1b\u026as", "link": "https://stackoverflow.com/users/777510/%e1%b4%98%e1%b4%80%c9%b4%e1%b4%80%ca%8f%c9%aa%e1%b4%8f%e1%b4%9b%c9%aas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "accepted_answer_id": 35243067, "answer_count": 2, "score": 1, "last_activity_date": 1454774644, "creation_date": 1454771014, "question_id": 35242490, "link": "https://stackoverflow.com/questions/35242490/why-doesnt-this-list-comprehension-in-haskell-include-lists-of-size-n", "title": "Why doesn&#39;t this list comprehension in haskell include lists of size &lt; n", "body": "<p>I am looking at this code for generating combinations in Haskell</p>\n\n<pre><code>combinations :: Int -&gt; [a] -&gt; [[a]]\ncombinations 0 _ = [[]]\ncombinations n xs = [ xs !! i : x | i &lt;- [0..(length xs)-1] \n                                  , x &lt;- combinations (n-1) (drop (i+1) xs) ]\n</code></pre>\n\n<p>I tried to visualize how the tree gets expanded, but I do not understand why the list doesn't include the paths in red.</p>\n\n<p><a href=\"https://i.stack.imgur.com/QnOkj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QnOkj.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>combinations 3 \"abcd\"\n[\"abc\",\"abd\",\"acd\",\"bcd\"]\n</code></pre>\n\n<p>All I can see is <code>xs !! i : x</code> ie append the i'th element to the n  -1 combinations of it's tail, but why doesn't <code>[d] : [[]] = [d]</code> get included.</p>\n"}, {"tags": ["sockets", "haskell", "websocket", "server"], "comments": [{"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 0, "creation_date": 1454775646, "post_id": 35238952, "comment_id": 58200488, "body": "What is wrong with explicitly passing <code>client</code> around? You have a reference to it in <code>Main</code>, so any module called from <code>Main</code> could be passed a reference to this."}, {"owner": {"reputation": 2442, "user_id": 3666302, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e9aed854fcd666aba1316ef908ad5913?s=128&d=identicon&r=PG&f=1", "display_name": "TomTom", "link": "https://stackoverflow.com/users/3666302/tomtom"}, "reply_to_user": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 0, "creation_date": 1454783370, "post_id": 35238952, "comment_id": 58203469, "body": "This is code is supposed to be used in combination with ghci. So everytime I reload the environment I&#39;d have to create the server again which is a bit annoying. Is there a way to just call <code>sendMessage</code> and have it create the server if it isn&#39;t already?"}], "answers": [{"tags": [], "owner": {"reputation": 2442, "user_id": 3666302, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e9aed854fcd666aba1316ef908ad5913?s=128&d=identicon&r=PG&f=1", "display_name": "TomTom", "link": "https://stackoverflow.com/users/3666302/tomtom"}, "is_accepted": true, "score": 1, "last_activity_date": 1454906348, "creation_date": 1454906348, "answer_id": 35262429, "question_id": 35238952, "link": "https://stackoverflow.com/questions/35238952/communicate-with-socket-from-other-module/35262429#35262429", "title": "Communicate with socket from other module", "body": "<p>I ended up using an <code>MVar</code> with <code>unsafePerformIO</code>. While not exactly recommended the the code is neat and simple.</p>\n\n<pre><code>createServer :: IO ()\ncreateServer = do\n    _ &lt;- forkIO $ runServer \"127.0.0.1\" 8080 serverApp\n    return ()\n\nserverApp :: PendingConnection -&gt; IO ()\nserverApp pending =\n    do\n        connection &lt;- acceptRequest pending\n        forever $ do\n            msg &lt;- takeMVar channel\n            sendTextData connection msg\n\nchannel :: MVar ByteString\n{-# NOINLINE channel #-}\nchannel = unsafePerformIO newEmptyMVar\n\nsendMessage :: ByteString -&gt; IO ()\nsendMessage = putMVar channel\n</code></pre>\n\n<p>The code is still missing exception handling and it only works for 1 connected client.</p>\n"}], "owner": {"reputation": 2442, "user_id": 3666302, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e9aed854fcd666aba1316ef908ad5913?s=128&d=identicon&r=PG&f=1", "display_name": "TomTom", "link": "https://stackoverflow.com/users/3666302/tomtom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 35262429, "answer_count": 1, "score": 0, "last_activity_date": 1454906348, "creation_date": 1454747126, "question_id": 35238952, "link": "https://stackoverflow.com/questions/35238952/communicate-with-socket-from-other-module", "title": "Communicate with socket from other module", "body": "<p>I'd like to run a websocket server and send messages from another module to it.</p>\n\n<p>So far I have only managed to pass a channel to the module which starts the server. But I'd like to have as globally as <code>writeFile</code> which can be called from any module at any time.</p>\n\n<p>Also I'd like to have multiple clients with <code>sendMessage</code>. Once a connection closes I assume the thread still stays in the <code>forever</code> loop.</p>\n\n<p><em>Server.hs</em></p>\n\n<pre><code>import Network.WebSockets\nimport Control.Concurrent\nimport Control.Monad\nimport Data.ByteString\n\ncreateServer :: IO (Chan ByteString)\ncreateServer = do\n    chan &lt;- newChan\n    forkIO $ runServer \"127.0.0.1\" 8080 (serverApp chan)\n    ready &lt;- readChan chan -- wait for client\n    return chan\n\nserverApp :: Chan ByteString -&gt; PendingConnection -&gt; IO ()\nserverApp chan pending =\n    do\n        print \"Client connected\"\n        connection &lt;- acceptRequest pending\n        writeChan chan \"ready\"\n        forever $ do\n            msg &lt;- readChan chan\n            sendTextData connection msg\n\nsendMessage :: Chan ByteString -&gt; ByteString -&gt; IO ()\nsendMessage = writeChan\n</code></pre>\n\n<p><em>Main.hs</em></p>\n\n<pre><code>main :: IO ()\nmain = do\n    client &lt;- createServer\n    sendMessage client (\"hello\" :: ByteString)\n</code></pre>\n"}, {"tags": ["algorithm", "list", "haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1454740617, "post_id": 35238035, "comment_id": 58190612, "body": "What exactly is this function supposed to mean? I find it deeply suspicious that <code>[0]</code> and <code>[1]</code> yield the same results, and that <code>[]</code> is rejected."}, {"owner": {"reputation": 43, "user_id": 5891130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caf6c7ac3ec764b72137c4ad2454f72c?s=128&d=identicon&r=PG", "display_name": "Adri&#225;n Rodr&#237;guez", "link": "https://stackoverflow.com/users/5891130/adri%c3%a1n-rodr%c3%adguez"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454740760, "post_id": 35238035, "comment_id": 58190640, "body": "That&#39;s just because I&#39;m not considering 0 as a binary."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 3, "creation_date": 1454740893, "post_id": 35238035, "comment_id": 58190666, "body": "@Adri&#225;nRodr&#237;guez That makes no sense."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1454741176, "post_id": 35238035, "comment_id": 58190719, "body": "Proposal for a complete rewrite: <code>binListaBin = map (0&#47;=)</code>. Only half joking."}, {"owner": {"reputation": 43, "user_id": 5891130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caf6c7ac3ec764b72137c4ad2454f72c?s=128&d=identicon&r=PG", "display_name": "Adri&#225;n Rodr&#237;guez", "link": "https://stackoverflow.com/users/5891130/adri%c3%a1n-rodr%c3%adguez"}, "edited": false, "score": 0, "creation_date": 1454742399, "post_id": 35238035, "comment_id": 58190983, "body": "Edited it so [0] is no longer an expected input."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 2, "creation_date": 1454746553, "post_id": 35238035, "comment_id": 58191931, "body": "What about even numbers?"}], "answers": [{"tags": [], "owner": {"reputation": 16822, "user_id": 560073, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh6.googleusercontent.com/-A_vJq0ilPI8/AAAAAAAAAAI/AAAAAAAAAJI/dKesA-ExUzA/photo.jpg?sz=128", "display_name": "Linus Oleander", "link": "https://stackoverflow.com/users/560073/linus-oleander"}, "is_accepted": false, "score": 2, "last_activity_date": 1454740150, "last_edit_date": 1454740150, "creation_date": 1454739845, "answer_id": 35238078, "question_id": 35238035, "link": "https://stackoverflow.com/questions/35238035/reversing-a-list-before-passing-it-as-an-argument/35238078#35238078", "title": "Reversing a List before passing it as an argument", "body": "<p>Reverse the list before you pass it to your <code>binListaBin</code> function by creating an alias function.</p>\n\n<pre><code>binListaBin xs = binListaBinInner $ reverse xs\n\nbinListaBinInner :: [Int] -&gt; Binary\nbinListaBinInner []              = error \"Empty List.\"\nbinListaBinInner [0]             = BaseOne\nbinListaBinInner [1]             = BaseOne\nbinListaBinInner x:xs\n            | x == 0    = Zero (binListaBinInner xs)\n            | x == 1    = One  (binListaBinInner xs)\n            | otherwise = error \"Not a binary.\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": true, "score": 1, "last_activity_date": 1454743195, "creation_date": 1454743195, "answer_id": 35238467, "question_id": 35238035, "link": "https://stackoverflow.com/questions/35238035/reversing-a-list-before-passing-it-as-an-argument/35238467#35238467", "title": "Reversing a List before passing it as an argument", "body": "<p>This is what I would do:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.List (foldl') -- strict foldl\n\ndata Binary = BaseOne     -- The leading one in front of all binary numbers\n            | Zero Binary -- Zero followed by a string of binary digits\n            | One Binary  -- One followed by a string of binary digits\n            deriving Show\n\ntoBinary :: Int -&gt; Binary -&gt; Binary\ntoBinary 0 = Zero\ntoBinary 1 = One\n\nflipToBinary :: Binary -&gt; Int -&gt; Binary\nflipToBinary = flip toBinary\n\nfoldBinary :: [Int] -&gt; Binary\nfoldBinary (1:xs) = foldl' flipToBinary BaseOne xs\n</code></pre>\n\n<p>Let's look at an example. We'll use my favorite number 11 in binary represented as a <code>[Int]</code>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>  8 + 0 + 2 + 1 = 11\n\n[ 1 , 0 , 1 , 1 ]\n</code></pre>\n\n<p>The <code>foldBinary</code> function converts it to the <code>Binary</code> representation:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>foldBinary [1,0,1,1] = One (One (Zero BaseOne))\n</code></pre>\n\n<p>In <code>Binary</code> it is represented as <code>One (One (Zero BaseOne))</code>. Backwards is forwards.</p>\n"}], "owner": {"reputation": 43, "user_id": 5891130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caf6c7ac3ec764b72137c4ad2454f72c?s=128&d=identicon&r=PG", "display_name": "Adri&#225;n Rodr&#237;guez", "link": "https://stackoverflow.com/users/5891130/adri%c3%a1n-rodr%c3%adguez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 35238467, "answer_count": 2, "score": 4, "last_activity_date": 1454743217, "creation_date": 1454739486, "last_edit_date": 1454742348, "question_id": 35238035, "link": "https://stackoverflow.com/questions/35238035/reversing-a-list-before-passing-it-as-an-argument", "title": "Reversing a List before passing it as an argument", "body": "<p>I'm fairly new at Haskell and I've been trying to workaround a solution for a while now, but I can't seem to be getting anywhere. </p>\n\n<p>I have defined a data type called Binary recursively</p>\n\n<pre><code>data Binary = BaseOne | Zero Binary | One Binary\n</code></pre>\n\n<p>And I'm trying to make a function that takes a binary number in list form (i.e. [1, 1, 0, 1] and converts it to my data type Binary.</p>\n\n<pre><code>binListaBin :: [Int] -&gt; Binary\nbinListaBin []              = error \"Empty List.\"\nbinListaBin [1]             = BaseOne\nbinListaBin x:xs\n            | x == 0    = Zero (binListaBin xs)\n            | x == 1    = One  (binListaBin xs)\n            | otherwise = error \"Not a binary.\"\n</code></pre>\n\n<p>The problem is that my function gives the result reversed, so my guess is that if I can reverse the input list before the function works with it, it should work properly, but I don't know how to do that inside the function. I have tried toying around with <em>where</em> and <em>let</em> sentences, but can't seem to be getting it right.</p>\n"}, {"tags": ["class", "haskell", "types"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1454753703, "post_id": 35237956, "comment_id": 58193777, "body": "Well the <code>.0</code> indicates a <i>fractional</i> part of the number (even if in this case is <code>0</code>). What would expect the type of <code>[1.5]</code> to be? It cannot be <code>Num</code> because if it were <code>Num</code> it would have to be convertible to, say, <code>Int</code> but there is no unique sensible way to do so (round to lower? round to higher? round to even? round to odd?). Also you don&#39;t want <code>1.0</code> to have type <code>Num</code> while <code>1.1</code> to have type <code>Fractional</code>... a slight typo could change way too many things in a program. Hence the simple rule in the report."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1454741798, "last_edit_date": 1454741798, "creation_date": 1454741052, "answer_id": 35238216, "question_id": 35237956, "link": "https://stackoverflow.com/questions/35237956/whats-the-difference-between-float-and-fractional-in-haskell/35238216#35238216", "title": "What&#39;s the difference between &quot;float&quot; and &quot;fractional&quot; in Haskell?", "body": "<p>There is no implicit type conversion in Haskell. Numeric literals have polymorphic types.</p>\n\n<pre><code>&gt; :t 3\n3 :: Num a =&gt; a\n\n&gt; :t 3.5\n3.5 :: Fractional a =&gt; a\n</code></pre>\n\n<p>Standard Haskell treats any number with a decimal point as fractional, even if the fractional digits are all 0. It also treats anything written in scientific notation as fractional. There's a GHC extension you can use to be more polymorphic with such representations if you like.</p>\n\n<p>As for the question in your title, <code>Float</code> is a concrete type (<code>Float :: *</code>), while <code>Fractional</code> is a type class (<code>Fractional :: * -&gt; Constraint</code>). You can write lots of functions that will work with all sorts of <code>Fractional</code> or <code>RealFrac</code> or <code>RealFloat</code> types without having to worry about the exact representation.</p>\n\n<p>Side note: <code>Float</code> is a special-purpose type, for specialized algorithms, formats, etc., and certain cases where compact representation of arrays is more important than precision or numerical stability. When you want floating point, the one you usually want is <code>Double</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1454756343, "post_id": 35238253, "comment_id": 58194485, "body": "@Bakuriu: really? My GHC-7.10 does recognise it; <code>-XNumDecimals</code> is available since 7.8 actually."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1454756464, "post_id": 35238253, "comment_id": 58194506, "body": "@leftaroundabout Uh Now it does. Guess I made a typo when trying it the first time."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 4, "last_activity_date": 1454741718, "last_edit_date": 1454741718, "creation_date": 1454741401, "answer_id": 35238253, "question_id": 35237956, "link": "https://stackoverflow.com/questions/35237956/whats-the-difference-between-float-and-fractional-in-haskell/35238253#35238253", "title": "What&#39;s the difference between &quot;float&quot; and &quot;fractional&quot; in Haskell?", "body": "<p>You can make it happen:</p>\n\n<pre><code>&gt; :set -XNumDecimals\n&gt; let c=[1.0,2.0]\n&gt; :t c\nc :: Num t =&gt; [t]\n</code></pre>\n\n<p>The answer to \"why <code>Fractional</code>\" is basically \"because the Report says so\":</p>\n\n<blockquote>\n<pre><code>float \u2192   decimal . decimal [exponent]\n      |   decimal exponent\n</code></pre>\n  \n  <p>A floating literal stands for an application of <code>fromRational</code> to a value of type <code>Rational</code> (that is, <code>Ratio Integer</code>). Given the typings:</p>\n\n<pre><code>fromInteger  :: (Num a) =&gt; Integer -&gt; a  \nfromRational :: (Fractional a) =&gt; Rational -&gt; a\n</code></pre>\n  \n  <p>integer and floating literals have the typings <code>(Num a) =&gt; a</code> and <code>(Fractional a) =&gt; a</code>, respectively.</p>\n</blockquote>\n\n<p>I would guess the Report says so because it is a nice simple rule to explain: no dot/exponent, it's <code>Num</code>-polymorphic, yes dot/exponent, it's <code>Fractional</code>-polymorphic.</p>\n\n<p>Two relevant bits are:<br>\n<a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch2.html#x7-190002.5\" rel=\"nofollow\">https://www.haskell.org/onlinereport/haskell2010/haskellch2.html#x7-190002.5</a><br>\n<a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch6.html#x13-1360006.4.1\" rel=\"nofollow\">https://www.haskell.org/onlinereport/haskell2010/haskellch6.html#x13-1360006.4.1</a></p>\n"}], "owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1038, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1454741798, "creation_date": 1454738764, "question_id": 35237956, "link": "https://stackoverflow.com/questions/35237956/whats-the-difference-between-float-and-fractional-in-haskell", "title": "What&#39;s the difference between &quot;float&quot; and &quot;fractional&quot; in Haskell?", "body": "<pre><code>Prelude&gt; let c=[1.0,2.0]\nPrelude&gt; :t c\nc :: Fractional t =&gt; [t]\n</code></pre>\n\n<p>I'd expect \"c\" to be a list of either Num or Float. Why Fractional? Is there any implicit type conversion going on here in Haskell?</p>\n"}, {"tags": ["string", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 5, "last_activity_date": 1454730132, "last_edit_date": 1454730132, "creation_date": 1454724701, "answer_id": 35236543, "question_id": 35236513, "link": "https://stackoverflow.com/questions/35236513/haskell-read-function-doesnt-handle-for-different-types/35236543#35236543", "title": "Haskell: &quot;read&quot; function doesn&#39;t handle &quot;+&quot; for different types?", "body": "<p>your assumption that read works on the rest of the line is wrong!</p>\n\n<pre><code>read :: Read a =&gt; String -&gt; a\n</code></pre>\n\n<p>it takes only the string it is applied to and not everything succeeding it, try</p>\n\n<pre><code>(read \"3.5\") + (read \"3.5\") :: Float\n</code></pre>\n\n<p>Note the parenthesis, also I'd recommend taking a look at <a href=\"http://learnyouahaskell.com/\" rel=\"noreferrer\">Learn you a haskell for great good</a> - a solid introduction to haskell.</p>\n\n<ul>\n<li><p><code>read \"8.2\"+\"3.4\"</code> does not work because, you try to add a string (<code>\"3.4\"</code>) and the compiler tells you <code>+</code> expects left and right hand side to be equal so it looks for a plus-instance for <code>String</code> (a.k.a. <code>[Char]</code>) because that is what the right hand side of <code>+</code> is.</p></li>\n<li><p><code>read \"8.2\" + 34</code> does not work because Haskell defaults to <code>Integer</code> for unspecified <code>Num</code> types (<code>34 :: Num a =&gt; a</code>), and so it tries to parse <code>\"8.2\"</code> as an integer and fails because integers don't have dots in them.</p></li>\n<li><p>the last one is almost right, you just have to add parens to make it work (see above)</p></li>\n</ul>\n\n<p>Your headline includes also a wrong assumption:</p>\n\n<p>the arguments of <code>+</code> have to have same type</p>\n\n<pre><code>(+) :: Num a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>the type signature says: something \"Numeric\" (thats something like an interface if you know java) can use the <code>+</code> function and first, second argument as well as the result are of the same type.</p>\n\n<p>if you want to have conversion you have to make it manually/explicitly</p>\n"}], "owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454730132, "creation_date": 1454724439, "question_id": 35236513, "link": "https://stackoverflow.com/questions/35236513/haskell-read-function-doesnt-handle-for-different-types", "title": "Haskell: &quot;read&quot; function doesn&#39;t handle &quot;+&quot; for different types?", "body": "<p>This one is ok, no problem</p>\n\n<pre><code>Prelude&gt; read \"8.2\" + 3.4\n11.6\n</code></pre>\n\n<p>But this one is not OK</p>\n\n<pre><code>Prelude&gt; read \"8.2\"+\"3.4\"\n&lt;interactive&gt;:69:11:\nNo instance for (Num [Char]) arising from a use of \u2018+\u2019\nIn the expression: read \"8.2\" + \"3.4\"\nIn an equation for \u2018it\u2019: it = read \"8.2\" + \"3.4\"\n</code></pre>\n\n<p>And neither this one:</p>\n\n<pre><code>Prelude&gt; read \"8.2\" + 34 \n*** Exception: Prelude.read: no parse\n</code></pre>\n\n<p>Why? I tried:</p>\n\n<pre><code>read \"8.2\"::Float + 3.4 ::Float \n</code></pre>\n\n<p>Doesn't work either.</p>\n\n<p>What is the input requirement of \"read\"? The first one string, the other one none-string, in order to do math?</p>\n"}, {"tags": ["haskell", "scotty", "haskell-warp"], "answers": [{"tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 2, "last_activity_date": 1454735574, "creation_date": 1454735574, "answer_id": 35237603, "question_id": 35235672, "link": "https://stackoverflow.com/questions/35235672/which-factors-determine-the-appropriate-value-for-settingsfork-in-a-warp-applica/35237603#35237603", "title": "Which factors determine the appropriate value for settingsFork in a Warp application?", "body": "<p>You may want to use <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Concurrent.html#v:forkOS\" rel=\"nofollow\"><code>forkOS</code></a> to create a bound thread if you're going to be manipulating thread-local state (as unbound Haskell \"threads\" might run on different OS threads, and therefore ruin the whole idea of using thread-local storage in the first place). The documentation mentions OpenGL as a possible example. Overall though, I find it difficult to come up with a situation where you wouldn't want the default implementation, which takes advantage of the builtin green-thread system. It's received wisdom that GHC's scheduler is <a href=\"http://www.aosabook.org/en/posa/warp.html\" rel=\"nofollow\">hard to beat</a>.</p>\n"}], "owner": {"reputation": 323, "user_id": 450583, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/018ad0db1f28ed72e4a1277d58959810?s=128&d=identicon&r=PG", "display_name": "flightlessbird", "link": "https://stackoverflow.com/users/450583/flightlessbird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 35237603, "answer_count": 1, "score": 1, "last_activity_date": 1454735574, "creation_date": 1454717746, "question_id": 35235672, "link": "https://stackoverflow.com/questions/35235672/which-factors-determine-the-appropriate-value-for-settingsfork-in-a-warp-applica", "title": "Which factors determine the appropriate value for settingsFork in a Warp application?", "body": "<p>In <a href=\"http://hackage.haskell.org/package/warp-3.0.13.1\" rel=\"nofollow\">Warp</a> applications, the <code>settingsFork</code> option is available on the <a href=\"http://hackage.haskell.org/package/warp-3.0.13.1/docs/Network-Wai-Handler-Warp-Internal.html#t:Settings\" rel=\"nofollow\">Settings</a> data type. This allows one to choose a different fork model. When should this be set to something other than the default (<code>void . forkIOWithUnmask</code>)? Which factors should be taken into account when making this decision? (IO vs CPU bound/use of FFI, for example).</p>\n"}, {"tags": ["performance", "haskell", "graphics", "friday"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1454716660, "post_id": 35235513, "comment_id": 58185814, "body": "Can you use the <code>-auto-all</code> profiling option to dig a little deeper into <code>compose</code> and see what is taking the time?"}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1454717316, "post_id": 35235513, "comment_id": 58186007, "body": "Does this tell you anything? <a href=\"https://bpaste.net/raw/cb2454d6fbc6\" rel=\"nofollow noreferrer\">bpaste.net/raw/cb2454d6fbc6</a>"}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1454717628, "post_id": 35235513, "comment_id": 58186086, "body": "<a href=\"https://gist.github.com/lynn/504e0712b5dd8c13f953\" rel=\"nofollow noreferrer\">Here</a> is the code, for comparison"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454730516, "post_id": 35235513, "comment_id": 58188657, "body": "This is not why your code is slow, but I&#39;m quite sure you should be able to drop the <code>toEnum</code> and <code>fromEnum</code> from <code>w2f</code> and <code>f2w</code>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1454730925, "post_id": 35235513, "comment_id": 58188719, "body": "<code>~*~</code> operates on two words and should probably be fast and do no allocation. The profile indicates this isn&#39;t the case, which is suspicious at the very least. It may be that thunks of <code>~*~</code> and other functions are being built by <code>Im.fromFunction</code>, whatever that is. Also, the way you test this may have an impact on performance, this library probably relies heavily on fusion and amortized cost analysis to get good performance but this can be broken."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1454731325, "post_id": 35235513, "comment_id": 58188791, "body": "Switching from <code>RGBA</code> to <code>RGBADelayed</code> could make a big difference. Can you explain in words what <code>compose</code> is supposed to calculate? It&#39;s not the most obvious thing in the world."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1454743621, "post_id": 35235513, "comment_id": 58191243, "body": "Also, use floor instead of round."}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 1, "creation_date": 1454767436, "post_id": 35235513, "comment_id": 58197680, "body": "I went ahead and explained in \u201ca thousand words\u201d :) I\u2019ll try <code>RGBADelayed</code> when I get the chance, thanks."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1454778979, "post_id": 35235513, "comment_id": 58201760, "body": "<code>wrap</code> is also pretty slow. You can use <code>fromFunctionCached</code> to perform only one integer division per row and one per column, instead of two per pixel."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1454798452, "post_id": 35235513, "comment_id": 58208444, "body": "If you post a complete compileable example I&#39;ll be more likely to take a look, FYI."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454798764, "post_id": 35235513, "comment_id": 58208549, "body": "@ThomasMDuBuisson, I think the gist may be that. Personally, I&#39;d be more interested in a careful verbal explanation of <i>exactly</i> what <code>compose</code> should do."}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 0, "creation_date": 1454802886, "post_id": 35235513, "comment_id": 58209718, "body": "I don\u2019t know how else to explain. It just overlays two alpha images... I used <a href=\"https://en.wikipedia.org/wiki/Alpha_compositing#Description\" rel=\"nofollow noreferrer\">these formulas</a> (the ones below \u201cAs an example\u201d). Is the wrapping the confusing part?"}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 0, "creation_date": 1454803586, "post_id": 35235513, "comment_id": 58209932, "body": "What my <i>implementation</i> does \u2013 and I think this costs me a lot of time, but I\u2019m not sure if it\u2019s the root cause \u2013 is translate <i>each</i> channel of <i>each</i> pixel from <code>Word8</code> to <code>Double</code> and back again, applying the formula from that article on the <code>Double</code> values."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454807800, "post_id": 35235513, "comment_id": 58210892, "body": "Based on the article you linked to, you might consider pre-multiplied RGBA. This is not quite supported by <code>friday</code> so I opened an <a href=\"https://github.com/RaphaelJ/friday/issues/22\" rel=\"nofollow noreferrer\">issue</a>. You may or may not be able to speed up the divisions by turning them into multiplications with a lookup table."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1455049849, "post_id": 35235513, "comment_id": 58313330, "body": "Ok, I&#39;ve taken the time to build a MCE - which would have been nice - and it runs seemingly instantaneously.  Also, it doesn&#39;t produce anything interesting but that&#39;s probably due to the lack of alpha in my input images."}], "answers": [{"comments": [{"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 0, "creation_date": 1455881397, "post_id": 35394545, "comment_id": 58699536, "body": "Well, I&#39;m sure composing two images doesn&#39;t take long. The problem is that composing thousands of them shouldn&#39;t take <i>this</i> long."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 0, "creation_date": 1455894336, "post_id": 35394545, "comment_id": 58707837, "body": "So I ask again - care to provide a minimum compilable example?"}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 1, "last_activity_date": 1455469545, "creation_date": 1455469545, "answer_id": 35394545, "question_id": 35235513, "link": "https://stackoverflow.com/questions/35235513/friday-package-is-very-slow/35394545#35394545", "title": "`friday` package is very slow", "body": "<p>As I stated in my comment, the MCE I made performs fine and does not yield any interesting output:</p>\n\n<pre><code>module Main where\nimport qualified Vision.Primitive as Im\nimport Vision.Primitive.Shape\nimport qualified Vision.Image.Type as Im\nimport qualified Vision.Image.Class as Im\nimport Vision.Image.RGBA.Type (RGBA, RGBAPixel(..))\nimport Vision.Image.Storage.DevIL (load, save, Autodetect(..), StorageError, StorageImage(..))\nimport Vision.Image (convert)\nimport Data.Word\nimport System.Environment (getArgs)\n\nmain :: IO ()\nmain = do\n  [input1,input2,output] &lt;- getArgs\n  io1 &lt;- load Autodetect input1 :: IO (Either StorageError StorageImage)\n  io2 &lt;- load Autodetect input2 :: IO (Either StorageError StorageImage)\n  case (io1,io2) of\n    (Left err,_) -&gt; error $ show err\n    (_,Left err) -&gt; error $ show err\n    (Right i1, Right i2) -&gt; go (convert i1) (convert i2) output\n where\n  go i1 i2 output =\n      do res &lt;- save Autodetect output (compose i1 i2)\n         case res of\n          Nothing -&gt; putStrLn \"Done with compose\"\n          Just e  -&gt; error (show (e :: StorageError))\n\n-- Wrap an image to a given size.\nwrap :: Im.Size -&gt; RGBA -&gt; RGBA\nwrap s im =\n    let Z :. h :. w = Im.manifestSize im\n    in Im.fromFunction s $ \\(Z :. y :. x) -&gt; im Im.! Im.ix2 (y `mod` h) (x `mod` w)\n\n-- Map a Word8 in [0, 255] to a Double in [0, 1].\nw2f :: Word8 -&gt; Double\nw2f = (/255) . fromIntegral . fromEnum\n\n-- Map a Double in [0, 1] to a Word8 in [0, 255].\nf2w :: Double -&gt; Word8\nf2w = toEnum . round . (*255)\n\n-- Compose two images into one. `bottom` is wrapped to `top`'s size.\ncompose :: RGBA -&gt; RGBA -&gt; RGBA\ncompose bottom top =\n    let newSize = Im.manifestSize top\n        bottom' = wrap newSize bottom\n    in Im.fromFunction newSize $ \\p -&gt;\n        let RGBAPixel rB gB bB aB = bottom' Im.! p\n            RGBAPixel rT gT bT aT = top Im.! p\n            aB' = w2f aB; aT' = w2f aT\n            ovl :: Double -&gt; Double -&gt; Double\n            ovl cB cT = (cT * aT' + cB * aB' * (1.0 - aT')) / (aT' + aB' * (1.0 - aT'))\n            (~*~) :: Word8 -&gt; Word8 -&gt; Word8\n            cB ~*~ cT = f2w $ w2f cB `ovl` w2f cT\n            aO = f2w (aT' + aB' * (1.0 - aT'))\n        in RGBAPixel (rB ~*~ rT) (gB ~*~ gT) (bB ~*~ bT) aO\n</code></pre>\n\n<p>This code loads two images, applies your compose operation, and saves the resulting image.  This happens almost instantly:</p>\n\n<pre><code>% ghc -O2 so.hs &amp;&amp; time ./so /tmp/lambda.jpg /tmp/lambda2.jpg /tmp/output.jpg &amp;&amp; o /tmp/output.jpg\nDone with compose\n./so /tmp/lambda.jpg /tmp/lambda2.jpg /tmp/output.jpg  0.05s user 0.00s system 98% cpu 0.050 total\n</code></pre>\n\n<p>If you have an alternate MCE then please post it.  Your complete code was too non-minimal for my eyes.</p>\n"}], "owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1455469545, "creation_date": 1454716475, "last_edit_date": 1454802938, "question_id": 35235513, "link": "https://stackoverflow.com/questions/35235513/friday-package-is-very-slow", "title": "`friday` package is very slow", "body": "<p>I\u2019m writing a Haskell program that draws <a href=\"http://puu.sh/mXkbi/ab0d55b7cc.png\" rel=\"nofollow noreferrer\">big maps</a> from <a href=\"http://nifflas.ni2.se/?page=Knytt+Stories\" rel=\"nofollow noreferrer\">Knytt Stories</a> world files. I use the <a href=\"https://hackage.haskell.org/package/friday\" rel=\"nofollow noreferrer\"><code>friday</code></a> package to make image files, and I need to compose the many graphics layers that I put together from spritesheets. Right now, I use my own ugly function for this:</p>\n\n<pre><code>import qualified Vision.Primitive as Im\nimport qualified Vision.Image.Type as Im\nimport qualified Vision.Image.Class as Im\nimport Vision.Image.RGBA.Type (RGBA, RGBAPixel(..))\n\n-- Map a Word8 in [0, 255] to a Double in [0, 1].\nw2f :: Word8 -&gt; Double\nw2f = (/255) . fromIntegral . fromEnum\n\n-- Map a Double in [0, 1] to a Word8 in [0, 255].\nf2w :: Double -&gt; Word8\nf2w = toEnum . round . (*255)\n\n-- Compose two images into one. `bottom` is wrapped to `top`'s size.\ncompose :: RGBA -&gt; RGBA -&gt; RGBA\ncompose bottom top =\n    let newSize = Im.manifestSize top\n        bottom' = wrap newSize bottom\n    in Im.fromFunction newSize $ \\p -&gt;\n        let RGBAPixel rB gB bB aB = bottom' Im.! p\n            RGBAPixel rT gT bT aT = top Im.! p\n            aB' = w2f aB; aT' = w2f aT\n            ovl :: Double -&gt; Double -&gt; Double\n            ovl cB cT = (cT * aT' + cB * aB' * (1.0 - aT')) / (aT' + aB' * (1.0 - aT'))\n            (~*~) :: Word8 -&gt; Word8 -&gt; Word8\n            cB ~*~ cT = f2w $ w2f cB `ovl` w2f cT\n            aO = f2w (aT' + aB' * (1.0 - aT'))\n        in RGBAPixel (rB ~*~ rT) (gB ~*~ gT) (bB ~*~ bT) aO\n</code></pre>\n\n<p>It simply alpha-composites a bottom layer and a top layer, like so:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7Rz5s.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7Rz5s.png\" alt=\"enter image description here\"></a></p>\n\n<p>If the \u201cbottom\u201d layer is a texture, it will be looped horizontally and vertically (by <code>wrap</code>) to fit the top layer\u2019s size.</p>\n\n<hr>\n\n<p>Rendering a map takes far, far longer than it should. Rendering the map for the default world that comes with the game takes <strong>27 minutes</strong> at <code>-O3</code>, even though the game itself can clearly render each separate screen in less than a couple of milliseconds. (The smaller example output I linked above see above takes 67 seconds; also far too long.)</p>\n\n<p>The profiler (output is <a href=\"https://bpaste.net/raw/eab52dc7d835\" rel=\"nofollow noreferrer\">here</a>) says the program spends about 77% of its time in <code>compose</code>.</p>\n\n<p>Cutting this down seems like a good first step. It seems like a very simple operation, but I can\u2019t find a native function in <code>friday</code> that lets me do this. Supposedly GHC should be good at collapsing all of the <code>fromFunction</code> stuff, but I don\u2019t know what\u2019s going on. Or is the package just super slow?</p>\n\n<p><a href=\"https://gist.github.com/lynn/504e0712b5dd8c13f953\" rel=\"nofollow noreferrer\"><strong>Here\u2019s the full, compileable code.</strong></a></p>\n"}, {"tags": ["haskell", "powerset"], "comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 1, "creation_date": 1454715333, "post_id": 35235256, "comment_id": 58185486, "body": "Cannot you compose <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Data-List.html#v:sortBy\" rel=\"nofollow noreferrer\">sortBy</a>? Not the most efficient way probably, but should do the trick."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454729701, "post_id": 35235418, "comment_id": 58188516, "body": "How well does this handle large results? If you ask for <code>head . last . powerset $ [1..25]</code>, how long does that take?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454737836, "post_id": 35235418, "comment_id": 58189999, "body": "@dfeuer That question seems eminently answerable by you without any further work by the answer writer."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1454740321, "post_id": 35235418, "comment_id": 58190551, "body": "@DanielWagner, that would normally be true, but I&#39;m away from my laptop till Monday evening at the earliest, and I&#39;m terribly impatient."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1454741021, "post_id": 35235418, "comment_id": 58190693, "body": "@dfeuer It is faster than the <code>filterM</code> version."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1454741135, "post_id": 35235418, "comment_id": 58190712, "body": "Thanks, @DanielWagner!"}, {"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1454850867, "post_id": 35235418, "comment_id": 58220270, "body": "@dfeuer this is pretty fast actually. considering that <code>[1..25]</code> has <code>2^25</code> subsets, this performs very well compared to say <code>maximum [1..2^25]</code>."}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": false, "score": 3, "last_activity_date": 1454727096, "last_edit_date": 1454727096, "creation_date": 1454715788, "answer_id": 35235418, "question_id": 35235256, "link": "https://stackoverflow.com/questions/35235256/haskell-powerset-in-lexicographic-order/35235418#35235418", "title": "Haskell Powerset in Lexicographic Order", "body": "<p>You may do a right fold:</p>\n\n<pre><code>powerset :: Foldable t =&gt; t a -&gt; [[a]]\npowerset xs = []: foldr go [] xs\n    where go x acc = [x]: fmap (x:) acc ++ acc\n</code></pre>\n\n<p>then:</p>\n\n<pre><code>\\&gt; powerset [1, 2]\n[[],[1],[1,2],[2]]\n\\&gt; powerset [1, 2, 3]\n[[],[1],[1,2],[1,2,3],[1,3],[2],[2,3],[3]]\n</code></pre>\n\n<p><sub>(edited answer to remove the call to <code>tail</code> function)</sub></p>\n"}], "owner": {"reputation": 93, "user_id": 5458700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a3c16494eb3ebe0c4bc56455019e643?s=128&d=identicon&r=PG&f=1", "display_name": "R. Monks", "link": "https://stackoverflow.com/users/5458700/r-monks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 740, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1454727096, "creation_date": 1454714734, "last_edit_date": 1454715815, "question_id": 35235256, "link": "https://stackoverflow.com/questions/35235256/haskell-powerset-in-lexicographic-order", "title": "Haskell Powerset in Lexicographic Order", "body": "<p>I want to write a powerset function in Haskell with the function declaration of:</p>\n\n<pre><code>powerset :: Ord a =&gt; [a] -&gt; [[a]]\n</code></pre>\n\n<p>However, I'm trying to make with a lexicographical ordering so that:</p>\n\n<pre><code>powerset [1,2,3] = [[], [1], [1,2], [1,2,3], [1,3], [2], [2,3], [3]]\n</code></pre>\n\n<p>I've found other ways of doing the powerset, such as:</p>\n\n<pre><code>powerSet = filterM (const [True, False])\n</code></pre>\n\n<p>but nothing that provides the powerset in lexographic order.  Is there any way to write the powerset function to provide that or to sort the unsorted powerset into this ordering?</p>\n"}, {"tags": ["function", "haskell", "pattern-matching", "signature"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454700743, "post_id": 35232011, "comment_id": 58178706, "body": "well compare them - what is easier to read? Isn&#39;t it so much nicer and closer to the actual definition? You don&#39;t have to parse/understand <code>fst</code> and <code>snd</code> either to understand the function..."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454700787, "post_id": 35232011, "comment_id": 58178737, "body": "and <b>no offense meant</b> but this is just a question asking for opinions - there will never be <b>the</b> answer (or any right one for that matter) - this is why I vote to close it"}, {"owner": {"reputation": 4251, "user_id": 1829329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f345b0578d338c5b52e9af599f7a9f19?s=128&d=identicon&r=PG", "display_name": "Zelphir Kaltstahl", "link": "https://stackoverflow.com/users/1829329/zelphir-kaltstahl"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454701211, "post_id": 35232011, "comment_id": 58178991, "body": "@Carsten Hm you might have a point about readability. I read it and was thinking: <i>but that&#39;s the same in more code</i>. Now that you mention one doesn&#39;t have to know <code>fst</code> and <code>snd</code> I can see that there might be a readability advantage."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1454702239, "post_id": 35232011, "comment_id": 58179517, "body": "The pattern-matching version looks yet better if you make some subtle layout modifications, like <code>addVectors (x\u2081,y\u2081) (x\u2082,y\u2082) = (x\u2081+x\u2082, y\u2081+y\u2082)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1454701653, "post_id": 35232225, "comment_id": 58179240, "body": "<a href=\"http://hackage.haskell.org/package/lens-4.13.1/docs/Control-Lens-Tuple.html\" rel=\"nofollow noreferrer\"><code>addVectors a b = (a^._1 + b^._1, a^._2 + b^._2, a^._3 + b^._3, a^._4 + b^._4)</code></a>. And, I don&#39;t think it would be that clever to use four-tuples as an example, since basically nobody uses tuples larger than three. What brings the message across properly is pattern like those on list cons cells."}], "tags": [], "owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "is_accepted": false, "score": 2, "last_activity_date": 1454701345, "creation_date": 1454701345, "answer_id": 35232225, "question_id": 35232011, "link": "https://stackoverflow.com/questions/35232011/why-is-pattern-matching-preferred-in-function-definitions/35232225#35232225", "title": "Why is pattern matching preferred in function definitions?", "body": "<p>As <strong>Carsten</strong> mentioned in comments, this is an opinion-based question, but let me elaborate anyway. </p>\n\n<p>Using pattern matching against 2-tuples isn't that much of an advantage, but let's consider some bigger data structure, for example 4-tuples.</p>\n\n<pre><code>addVectors :: (Num a) =&gt; (a, a, a, a) -&gt; (a, a, a, a) -&gt; (a, a, a, a)  \naddVectors a b = -- some code that adds vectors\n\naddVectors :: (Num a) =&gt; (a, a, a, a) -&gt; (a, a, a, a) -&gt; (a, a, a, a)  \naddVectors (w1, x1, y1, z1) (w2, x2, y2, z2) = (w1 + w2, x1 + x2, y1 + y2, z1 + z2)\n</code></pre>\n\n<p>Without pattern matching you'd have to write functions that extract the first, second, third and fourth element from a 4-tuple an use it inside <code>addVectors</code>. With pattern matching, writing the implementation of <code>addVectors</code> is very easy.</p>\n\n<p>I believe using such an example in the book could get the message across more effectively.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1454701657, "creation_date": 1454701657, "answer_id": 35232326, "question_id": 35232011, "link": "https://stackoverflow.com/questions/35232011/why-is-pattern-matching-preferred-in-function-definitions/35232326#35232326", "title": "Why is pattern matching preferred in function definitions?", "body": "<p>In a nutshell, one needs to construct and destruct values. </p>\n\n<p>Values are constructed by taking a data constructor which is a (possibly null-ary) function, and applying the required arguments. So far, so good.</p>\n\n<p>Random example (abusing <code>GADTSyntax</code>)</p>\n\n<pre><code>data T where\n  A :: Int -&gt; T\n  B :: T\n  C :: String -&gt; Bool -&gt; T\n</code></pre>\n\n<p>Destruction is more complex, since one needs to take a value of type <code>T</code> and obtain information about 1) which constructor was used to craft such value, and 2) what are the arguments to said constructor.</p>\n\n<p>Part 1) could be done through a function:</p>\n\n<pre><code>whichConsT :: T -&gt; Int -- returns 0,1,2 for A,B,C\n</code></pre>\n\n<p>Part 2) is more tricky. A possible option is to use projections</p>\n\n<pre><code>projA :: T -&gt; Int\n-- projB not needed\nprojC1 :: T -&gt; String\nprojC2 :: T -&gt; Bool\n</code></pre>\n\n<p>so that e.g. they satisfy</p>\n\n<pre><code>projA (A n) = n\nprojC1 (C x y) = x\nprojC2 (C x y) = y\n</code></pre>\n\n<p>But wait! The types of the projections are of the form <code>T -&gt; ...</code>, which promises that such functions work on all values of type <code>T</code>. So we can have</p>\n\n<pre><code>projA B = ??\nprojA (C x y) = ??\nprojC1 (A n) = ??\n</code></pre>\n\n<p>How to implement the above? There's no way to produce sensible results, so the best option is to trigger a runtime error.</p>\n\n<pre><code>projA B = error \"not an A!\"\nprojA (C x y) = error \"not an A!\"\nprojC1 (A n) = error \"not a C!\"\n</code></pre>\n\n<p>However, <em>this puts a burden on the programmer</em>! Now it is the programmer's responsibility to check that values which are passed to the projections have the right constructor. This can be done using <code>whichConsT</code>. Many imperative programmers are used to this kind of interface (test &amp; access, e.g. Java's <code>hasNext(), next()</code> in iterators), but this is because most imperative languages have no really better option.</p>\n\n<p>FP languages (and, nowadays, some imperative languages as well) also allow pattern matching. Using it has the following advantages over projections:</p>\n\n<ul>\n<li>no need to split the information: we get 1) and 2) at the same time</li>\n<li>no way to crash the program: we never use partial projection functions which can crash</li>\n<li>no burden on the programmer: corollary of the above</li>\n<li>if the exhaustiveness-checker is on, we are sure to handle all the possible cases</li>\n</ul>\n\n<p>Now, on types having exactly <em>one</em> constructor (tuples, <code>()</code>, <code>newtype</code>s), one can define total projections, which are perfectly fine (e.g. <code>fst,snd</code>). Still, many prefer to stick with pattern matching, which can also handle the general case as well. </p>\n"}, {"tags": [], "owner": {"reputation": 4578, "user_id": 72787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2601268a5194646e6c7532947764db?s=128&d=identicon&r=PG", "display_name": "wires", "link": "https://stackoverflow.com/users/72787/wires"}, "is_accepted": true, "score": 5, "last_activity_date": 1454702769, "last_edit_date": 1454702769, "creation_date": 1454702425, "answer_id": 35232509, "question_id": 35232011, "link": "https://stackoverflow.com/questions/35232011/why-is-pattern-matching-preferred-in-function-definitions/35232509#35232509", "title": "Why is pattern matching preferred in function definitions?", "body": "<p>I think in this case the pattern matching expresses more directly what you mean.</p>\n\n<p>In the function application case, one needs to know what <code>fst</code> and <code>snd</code> do, and from it deduce that <code>a</code> and <code>b</code> are tuples whose elements get added.</p>\n\n<pre><code>addVectors a b = (fst a + fst b, snd a + snd b)\n</code></pre>\n\n<p>The fact that we have <code>snd</code> and <code>fst</code> functions to decompose tuples is distracting here.</p>\n\n<p>In the pattern matching case it is immediately clear what the input is (a tuple whose elements we call <code>x1</code> and <code>y1</code> and a tuple... etc) and how it is deconstructed. And it is also immediately clear what is happening, how their elements are added.</p>\n\n<pre><code>addVectors (x1, y1) (x2, y2) = (x1 + x2, y1 + y2)\n</code></pre>\n\n<p>This is almost like the mathematical definition:</p>\n\n<blockquote>\n  <p>(<em>x<sub>1</sub></em>, <em>y<sub>1</sub></em>) + (<em>x<sub>2</sub></em>, <em>y<sub>2</sub></em>) := (<em>x<sub>1</sub></em> + <em>x<sub>2</sub></em>, <em>y<sub>1</sub></em> + <em>y<sub>2</sub></em>)</p>\n</blockquote>\n\n<p>Straight to the point, no distractions :-)</p>\n\n<p>You could literally write this in Haskell:</p>\n\n<pre><code>(x\u2081, y\u2081) `addVector` (x\u2082, y\u2082) = (x\u2081 + x\u2082, y\u2081 + y\u2082)\n</code></pre>\n"}], "owner": {"reputation": 4251, "user_id": 1829329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f345b0578d338c5b52e9af599f7a9f19?s=128&d=identicon&r=PG", "display_name": "Zelphir Kaltstahl", "link": "https://stackoverflow.com/users/1829329/zelphir-kaltstahl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 0, "accepted_answer_id": 35232509, "answer_count": 3, "score": 6, "last_activity_date": 1454702769, "creation_date": 1454700578, "last_edit_date": 1454701715, "question_id": 35232011, "link": "https://stackoverflow.com/questions/35232011/why-is-pattern-matching-preferred-in-function-definitions", "title": "Why is pattern matching preferred in function definitions?", "body": "<p>I am reading the \"learnyouahaskell\" tutorial from <a href=\"http://learnyouahaskell.com/syntax-in-functions\">learnyouahaskell</a>. There it reads:</p>\n\n<blockquote>\n  <p>Pattern matching can also be used on tuples. What if we wanted to make\n  a function that takes two vectors in a 2D space (that are in the form\n  of pairs) and adds them together? To add together two vectors, we add\n  their <code>x</code> components separately and then their <code>y</code> components\n  separately. Here's how we would have done it if we didn't know about\n  pattern matching:</p>\n\n<pre><code>addVectors :: (Num a) =&gt; (a, a) -&gt; (a, a) -&gt; (a, a)  \naddVectors a b = (fst a + fst b, snd a + snd b)  \n</code></pre>\n  \n  <p>Well, that works, but there's a better way to do it. Let's modify the\n  function so that it uses pattern matching.</p>\n\n<pre><code>addVectors :: (Num a) =&gt; (a, a) -&gt; (a, a) -&gt; (a, a)  \naddVectors (x1, y1) (x2, y2) = (x1 + x2, y1 + y2)  \n</code></pre>\n  \n  <p>There we go! Much better. Note that this is already a catch-all\n  pattern. The type of <code>addVectors</code> (in both cases) is <code>addVectors :: (Num a) =&gt; (a, a) -&gt; (a, a) - &gt; (a, a)</code>, so we are guaranteed to get\n  two pairs as parameters.</p>\n</blockquote>\n\n<p>My question is: Why is the pattern matching preferred the preferred way, if both definitions result in the same signature?</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1454709316, "post_id": 35231697, "comment_id": 58183153, "body": "I guess you were hoping that <code>default=CURRENT_TIME</code> would be used during insertion to fill in <code>Nothing</code>s, maybe? But I would bet that <code>default=CURRENT_TIME</code> is actually used only during migration. Then again I have never used the library these come from (which appears to be <code>persistent-template</code> -- might be worth mentioning in your question)."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1454716530, "post_id": 35231697, "comment_id": 58185773, "body": "One big issue with a huge reliance on Template Haskell is that when your generated code doesn&#39;t do what you expect, you either have to manually analyze it (and it is just <i>hideous</i>) or you must simply <i>know</i> whats happening, probably be being the person who wrote the code to generate the code that broke. Even if you do find the problem, extracting a tiny bit of code and changing it is impossible if it is all generated in one go. Your best bet may be to not use this <code>default=..</code> thing and to write this feature yourself."}, {"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 0, "creation_date": 1454799381, "post_id": 35231697, "comment_id": 58208737, "body": "Which SQL backend are you using? I recommend accessing your SQL database from the command line and checking what the table definition is (you want something like <code>SHOW CREATE TABLE foo</code> for MySQL and <code>\\d+ email</code> for Postgres."}, {"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 0, "creation_date": 1455296088, "post_id": 35231697, "comment_id": 58442016, "body": "@SaurabhNanda see my solution below using SQLite triggers."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1471064849, "post_id": 35231697, "comment_id": 65215293, "body": "To my eyes, the behavior of persistent looks right. Maybe I&#39;m too used to the ecosystem... If you want the time of <code>creation</code> and <code>update</code>, why don&#39;t you pass the proper time instead of <code>Nothing</code> ? Also why is it modeled as <code>Maybe</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 0, "creation_date": 1454865407, "post_id": 35254583, "comment_id": 58225367, "body": "But @SaurabhNanda is retrieving the record fresh from the database before printing it."}, {"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 4, "creation_date": 1454868500, "post_id": 35254583, "comment_id": 58226526, "body": "Isn&#39;t it a good idea to have a single source of &quot;truth&quot; in system design? In this case, isn&#39;t the DB the right place for this &quot;truth&quot; -- i.e. the default values of createdAt and updatedAt?"}], "tags": [], "owner": {"reputation": 1802, "user_id": 1897767, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b60e45c2f2adbfef9aa2d7c200b27f67?s=128&d=identicon&r=PG", "display_name": "Daishi Nakajima", "link": "https://stackoverflow.com/users/1897767/daishi-nakajima"}, "is_accepted": false, "score": 1, "last_activity_date": 1454854668, "creation_date": 1454854668, "answer_id": 35254583, "question_id": 35231697, "link": "https://stackoverflow.com/questions/35231697/how-to-let-default-values-come-from-the-database/35254583#35254583", "title": "How to let default values come from the database?", "body": "<p>According to <a href=\"http://www.yesodweb.com/book/persistent\" rel=\"nofollow\">http://www.yesodweb.com/book/persistent</a></p>\n\n<blockquote>\n  <p>The default attribute has absolutely no impact on the Haskell code\n  itself; you still need to fill in all values. This will only affect\n  the database schema and automatic migrations.</p>\n</blockquote>\n\n<pre><code>do\n  time &lt;- liftIO getCurrentTime\n  insert $ User \"saurabhnanda@gmail.com\" time time\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1455297303, "post_id": 35356680, "comment_id": 58442836, "body": "Good sleuthing! You win a small bounty."}, {"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1455988055, "post_id": 35356680, "comment_id": 58742000, "body": "Thanks @dfeuer, this really made my day :)"}, {"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1456055365, "post_id": 35356680, "comment_id": 58760031, "body": "@MaxGabriel I believe with the way Yesod is written, your solution is the most pragmatic. However, the issue still remains that Yesod does not have a way to represent &quot;Unspecified&quot; values. In this context, you have a value present, a NULL value, and an <b>unspecified</b> value. From a row-insertion point of view, an <b>unspecified</b> value should NOT be treated as NULL, because that prevents the DB from filling-in the defaults."}, {"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "reply_to_user": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1456061582, "post_id": 35356680, "comment_id": 58762065, "body": "@SaurabhNanda file an issue?"}], "tags": [], "owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "is_accepted": false, "score": 5, "last_activity_date": 1511371200, "last_edit_date": 1511371200, "creation_date": 1455260708, "answer_id": 35356680, "question_id": 35231697, "link": "https://stackoverflow.com/questions/35231697/how-to-let-default-values-come-from-the-database/35356680#35356680", "title": "How to let default values come from the database?", "body": "<p>(Edit: see solution below using triggers)</p>\n\n<h3>The problem: Default values don't override explicitly setting a column to NULL</h3>\n\n<p>Per the <a href=\"https://www.sqlite.org/lang_createtable.html\" rel=\"nofollow noreferrer\">SQLite docs</a>:</p>\n\n<blockquote>\n  <p>The DEFAULT clause specifies a default value to use for the column if no value is explicitly provided by the user when doing an INSERT.</p>\n</blockquote>\n\n<p>The issue is that when Persistent is doing the insert, it's specifying the <code>createdAt</code> and <code>updatedAt</code> columns as <code>NULL</code>:</p>\n\n<pre><code>[Debug#SQL] INSERT INTO \"user\"(\"email\",\"created_at\",\"updated_at\") VALUES(?,?,?); [PersistText \"saurabhnanda@gmail.com\",PersistNull,PersistNull]\n</code></pre>\n\n<p>To reach this conclusion, I modified your snippet to add SQL logging (I just copied the source of <code>runSqlite</code> and changed it to log to STDOUT). I used a file instead of in-memory database just so I could open the database in a SQLite editor and verify that the default values were being set.</p>\n\n<pre><code>-- Pragmas and imports are taken from a snippet in the Yesod book. Some of them may be superfluous.\n{-# LANGUAGE EmptyDataDecls             #-}\n{-# LANGUAGE FlexibleContexts           #-}\n{-# LANGUAGE GADTs                      #-}\n{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n{-# LANGUAGE MultiParamTypeClasses      #-}\n{-# LANGUAGE OverloadedStrings          #-}\n{-# LANGUAGE QuasiQuotes                #-}\n{-# LANGUAGE TemplateHaskell            #-}\n{-# LANGUAGE TypeFamilies               #-}\nimport Database.Persist\nimport Database.Persist.Sqlite\nimport Database.Persist.TH\nimport Control.Monad.IO.Class (liftIO)\nimport Data.Time\nimport Control.Monad.Trans.Resource\nimport Control.Monad.Logger\nimport Control.Monad.IO.Class\nimport Data.Text\n\nshare [mkPersist sqlSettings, mkMigrate \"migrateAll\"] [persistLowerCase|\nUser\n  email String\n  createdAt UTCTime Maybe default=CURRENT_TIME\n  updatedAt UTCTime Maybe default=CURRENT_TIME\n  deriving Show\n|]\n\nrunSqlite2 :: (MonadBaseControl IO m, MonadIO m)\n          =&gt; Text -- ^ connection string\n          -&gt; SqlPersistT (LoggingT (ResourceT m)) a -- ^ database action\n          -&gt; m a\nrunSqlite2 connstr = runResourceT\n                  . runStdoutLoggingT\n                  . withSqliteConn connstr\n                  . runSqlConn\n\nmain = runSqlite2 \"bar.db\" $ do\n  runMigration migrateAll\n  userId &lt;- insert $ User \"saurabhnanda@gmail.com\" Nothing Nothing\n  liftIO $ print userId\n  user &lt;- get userId\n  case user of\n    Nothing -&gt; liftIO $ putStrLn (\"coulnt find userId=\" ++ (show userId))\n    Just u -&gt; liftIO $ putStrLn (\"user=\" ++ (show user))\n</code></pre>\n\n<p>Here's the output I get:</p>\n\n<pre><code>Max@maximilians-mbp /tmp&gt; stack runghc sqlite.hs\nRun from outside a project, using implicit global project config\nUsing resolver: lts-3.10 from implicit global project's config file: /Users/Max/.stack/global/stack.yaml\nMigrating: CREATE TABLE \"user\"(\"id\" INTEGER PRIMARY KEY,\"email\" VARCHAR NOT NULL,\"created_at\" TIMESTAMP NULL DEFAULT CURRENT_TIME,\"updated_at\" TIMESTAMP NULL DEFAULT CURRENT_TIME)\n[Debug#SQL] CREATE TABLE \"user\"(\"id\" INTEGER PRIMARY KEY,\"email\" VARCHAR NOT NULL,\"created_at\" TIMESTAMP NULL DEFAULT CURRENT_TIME,\"updated_at\" TIMESTAMP NULL DEFAULT CURRENT_TIME); []\n[Debug#SQL] INSERT INTO \"user\"(\"email\",\"created_at\",\"updated_at\") VALUES(?,?,?); [PersistText \"saurabhnanda@gmail.com\",PersistNull,PersistNull]\n[Debug#SQL] SELECT \"id\" FROM \"user\" WHERE _ROWID_=last_insert_rowid(); []\nUserKey {unUserKey = SqlBackendKey {unSqlBackendKey = 1}}\n[Debug#SQL] SELECT \"email\",\"created_at\",\"updated_at\" FROM \"user\" WHERE \"id\"=? ; [PersistInt64 1]\nuser=Just (User {userEmail = \"saurabhnanda@gmail.com\", userCreatedAt = Nothing, userUpdatedAt = Nothing})\n</code></pre>\n\n<h3>Edit: Solution using triggers:</h3>\n\n<p>You can implement <code>created_at</code> and <code>updated_at</code> columns with triggers. This approach has some nice advantages. Basically there's no way for <code>updated_at</code> to be enforced by a DEFAULT value anyway, so you need a trigger for that if you want the database (and not the application) to manage it. Triggers also solve for <code>updated_at</code> being set when executing raw SQL queries or batch updates. Here's what this solution looks like:</p>\n\n<pre><code>CREATE TRIGGER set_created_and_updated_at AFTER INSERT ON user\nBEGIN\nUPDATE user SET created_at=CURRENT_TIMESTAMP, updated_at=CURRENT_TIMESTAMP WHERE user.id = NEW.id;\nEND\n\nCREATE TRIGGER set_updated_at AFTER UPDATE ON user\nBEGIN\nUPDATE user SET updated_at=CURRENT_TIMESTAMP WHERE user.id = NEW.id;\nEND\n</code></pre>\n\n<p>Now the output is as expected:</p>\n\n<pre><code>[Debug#SQL] INSERT INTO \"user\"(\"email\",\"created_at\",\"updated_at\") VALUES(?,?,?); [PersistText \"saurabhnanda@gmail.com\",PersistNull,PersistNull]\n[Debug#SQL] SELECT \"id\" FROM \"user\" WHERE _ROWID_=last_insert_rowid(); []\nUserKey {unUserKey = SqlBackendKey {unSqlBackendKey = 1}}\n[Debug#SQL] SELECT \"email\",\"created_at\",\"updated_at\" FROM \"user\" WHERE \"id\"=? ; [PersistInt64 1]\nuser=Just (User {userEmail = \"saurabhnanda@gmail.com\", userCreatedAt = Just 2016-02-12 16:41:43 UTC, userUpdatedAt = Just 2016-02-12 16:41:43 UTC})\n</code></pre>\n\n<p>The main downside to the trigger solution is that it's a slight hassle to set up the triggers.</p>\n\n<h3>Edit 2: Avoiding <code>Maybe</code> and Postgres support</h3>\n\n<p>If you'd like to avoid having <code>Maybe</code> values for <code>createdAt</code> and <code>updatedAt</code>, you can set them on the server to some dummy value like so:</p>\n\n<pre><code>-- | Use 'zeroTime' to get a 'UTCTime' without doing any IO.\n-- The main use case of this is providing a dummy-value for createdAt and updatedAt fields on our models. Those values are set by database triggers anyway.\nzeroTime :: UTCTime\nzeroTime = UTCTime (fromGregorian 1 0 0) (secondsToDiffTime 0)\n</code></pre>\n\n<p>And then let the server set the values through triggers. Slightly hacky, but in practice works great.</p>\n\n<h3>Postgresql triggers</h3>\n\n<p>The OP asked for SQLite but I'm sure people are reading this for other databases as well. Here's the Postgresql version:</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION create_timestamps()   \n        RETURNS TRIGGER AS $$\n        BEGIN\n            NEW.created_at = now();\n            NEW.updated_at = now();\n            RETURN NEW;   \n        END;\n        $$ language 'plpgsql';\n\nCREATE OR REPLACE FUNCTION update_timestamps()   \n        RETURNS TRIGGER AS $$\n        BEGIN\n            NEW.updated_at = now();\n            RETURN NEW;   \n        END;\n        $$ language 'plpgsql';\n\nCREATE TRIGGER users_insert BEFORE INSERT ON users FOR EACH ROW EXECUTE PROCEDURE create_timestamps();\nCREATE TRIGGER users_update BEFORE UPDATE ON users FOR EACH ROW EXECUTE PROCEDURE update_timestamps();\n</code></pre>\n"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 986, "favorite_count": 1, "answer_count": 2, "score": 10, "last_activity_date": 1511371200, "creation_date": 1454699382, "last_edit_date": 1454714668, "question_id": 35231697, "link": "https://stackoverflow.com/questions/35231697/how-to-let-default-values-come-from-the-database", "title": "How to let default values come from the database?", "body": "<p>Why does the <code>user</code> object still have <code>Nothing</code> for <code>createdAt</code> and <code>updatedAt</code>? Why are those fields not getting assigned by the database?</p>\n\n<pre><code>share [mkPersist sqlSettings, mkMigrate \"migrateAll\"] [persistLowerCase|\nUser\n  email String\n  createdAt UTCTime Maybe default=CURRENT_TIME\n  updatedAt UTCTime Maybe default=CURRENT_TIME\n  deriving Show\n|]\n\nmain = runSqlite \":memory:\" $ do\n  runMigration migrateAll\n  userId &lt;- insert $ User \"saurabhnanda@gmail.com\" Nothing Nothing\n  liftIO $ print userId\n  user &lt;- get userId\n  case user of\n    Nothing -&gt; liftIO $ putStrLn (\"coulnt find userId=\" ++ (show userId))\n    Just u -&gt; liftIO $ putStrLn (\"user=\" ++ (show user))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>UserKey {unUserKey = SqlBackendKey {unSqlBackendKey = 1}}\nuser=Just (User {userEmail = \"saurabhnanda@gmail.com\", userCreatedAt = Nothing, userUpdatedAt = Nothing})\n</code></pre>\n"}, {"tags": ["sqlite", "haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454697836, "post_id": 35230639, "comment_id": 58177065, "body": "<a href=\"https://hackage.haskell.org/package/sqlite-simple-0.4.9.0/docs/Database-SQLite-Simple.html#g:15\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/sqlite-simple-0.4.9.0/docs/&hellip;</a> has <code>execute</code> and variants."}, {"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454702695, "post_id": 35230639, "comment_id": 58179746, "body": "@dfeuer I&#39;m asking about how to execute <i>prepared statements</i>, not regular SQL."}, {"owner": {"reputation": 299, "user_id": 45461, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b840aa3cef2f5331e97d8ab353e4f839?s=128&d=identicon&r=PG", "display_name": "Nurpax", "link": "https://stackoverflow.com/users/45461/nurpax"}, "edited": false, "score": 0, "creation_date": 1482875075, "post_id": 35230639, "comment_id": 69907013, "body": "Author of sqlite-simple here, only now spotted this question.  There is a work-around to use nextRow with a type annotation for &quot;IO Maybe [Int]&quot;.  A &quot;void returning&quot; variant of nextRow has been requested in <a href=\"https://github.com/nurpax/sqlite-simple/issues/50\" rel=\"nofollow noreferrer\">github.com/nurpax/sqlite-simple/issues/50</a>.  This looks like something that should be added in one way or another."}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1454696057, "creation_date": 1454695346, "last_edit_date": 1454696057, "question_id": 35230639, "link": "https://stackoverflow.com/questions/35230639/how-to-execute-insert-prepared-statement-using-sqlite-simple", "title": "How to execute INSERT prepared statement using sqlite-simple?", "body": "<p><a href=\"https://hackage.haskell.org/package/sqlite-simple\" rel=\"nofollow\">sqlite-simple</a> is able to create prepared statements, but I cannot figure out how to use them with instructions that do not return results. That is:</p>\n\n<pre><code>main = do\n  db &lt;- open \"test.db\"\n  let a = 1\n  let b = 2\n  withStatement db \"INSERT INTO test VALUES (?, ?)\" $ \\stmt -&gt; do\n    bind stmt (a, b)\n    ???\n    reset stmt\n</code></pre>\n\n<p>The one API that \"fits\" in <code>???</code> is <code>nextRow</code> which requires data to be returned. So, how are prepared statements that return no results supposed to be used? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 2, "creation_date": 1454688681, "post_id": 35228548, "comment_id": 58171896, "body": "<code>x0</code> and <code>x1</code> have type <code>a</code> for a <code>[a]</code> while <code>xs</code> has type <code>[a]</code> as it is the tail. What are you expecting to pass into <code>Area</code>?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454698060, "post_id": 35228548, "comment_id": 58177205, "body": "<code>area</code> should be lower case. And you haven&#39;t shown the definition of <code>determinant</code> you&#39;re using, or what type you expect your function to have."}], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 5766031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-APTQZlmDZaQ/AAAAAAAAAAI/AAAAAAAAAG4/u-iOSDRTsOo/photo.jpg?sz=128", "display_name": "Zacharie 007", "link": "https://stackoverflow.com/users/5766031/zacharie-007"}, "is_accepted": false, "score": 1, "last_activity_date": 1454706012, "last_edit_date": 1454706012, "creation_date": 1454691984, "answer_id": 35229683, "question_id": 35228548, "link": "https://stackoverflow.com/questions/35228548/couldnt-match-expected-type/35229683#35229683", "title": "Couldn&#39;t match expected type", "body": "<pre><code> determinant :: a-&gt; a -&gt; ...\n determinant x0 x1 \n\n determinant :: a-&gt; [a] -&gt; ...\n determinant x0 **xs** \n</code></pre>\n\n<p>What type is determinant supposed to have? In the first call it takes x0 x1 that have both type a. In the second call you pass to determinant x0 xs where xs is a list of a ([a]).</p>\n"}], "owner": {"reputation": 1, "user_id": 5886716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d51f450ae7375b99adb590f7aa9122fc?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5886716/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1454706012, "creation_date": 1454688471, "last_edit_date": 1454689910, "question_id": 35228548, "link": "https://stackoverflow.com/questions/35228548/couldnt-match-expected-type", "title": "Couldn&#39;t match expected type", "body": "<pre><code>Area (x0:x1:xs) = determinant x0 x1 + Area(x1:xs) + determinant x0 xs\n</code></pre>\n\n<p>I keep getting an error for can't match expected type for the last part which is <code>determinant x0 xs</code> namely the <code>xs</code> part</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"tags": [], "owner": {"reputation": 193, "user_id": 2976249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/637930bba1a0591613b72bfee4c8fc2a?s=128&d=identicon&r=PG&f=1", "display_name": "dganti", "link": "https://stackoverflow.com/users/2976249/dganti"}, "is_accepted": true, "score": 6, "last_activity_date": 1492434210, "last_edit_date": 1492434210, "creation_date": 1454697307, "answer_id": 35231158, "question_id": 35228263, "link": "https://stackoverflow.com/questions/35228263/how-to-use-record-syntax-with-yesod-persistent/35231158#35231158", "title": "How to use record-syntax with Yesod-Persistent", "body": "<p>The function names would be like: <code>userEmail</code>, <code>userCreatedAt</code>, <code>userUpdatedAt</code>.</p>\n\n<p>Running cabal REPL and browsing the project help identify Yesod generated functions for persistent types. </p>\n"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 35231158, "answer_count": 1, "score": 5, "last_activity_date": 1492434210, "creation_date": 1454687597, "last_edit_date": 1454714703, "question_id": 35228263, "link": "https://stackoverflow.com/questions/35228263/how-to-use-record-syntax-with-yesod-persistent", "title": "How to use record-syntax with Yesod-Persistent", "body": "<p>Why doesn't the following work? I kinda know that there's a lot going under the hood and the <code>User</code> type probably doesn't really have the <code>email</code>, <code>createdAt</code>, and <code>updatedAt</code> field. What's the best way to NOT instantiate objects using positional parameters, which can easily go out of hand?</p>\n\n<pre><code>share [mkPersist sqlSettings, mkMigrate \"migrateAll\"] [persistLowerCase|\nUser\n  email String\n  createdAt UTCTime Maybe default=CURRENT_TIME\n  updatedAt UTCTime Maybe default=CURRENT_TIME\n  deriving Show\n]]\n\nmain :: IO ()\nmain = runSqlite \":memory:\" $ do\n  runMigration migrateAll\n  u &lt;- insert $ User {email=\"saurabhnanda@gmail.com\" createdAt=Nothing updatedAt=Nothing}\n</code></pre>\n\n<p>Compilation errors:</p>\n\n<pre><code>trysql.hs:38:23:\n    \u2018email\u2019 is not a (visible) field of constructor \u2018User\u2019\n\ntrysql.hs:38:55:\n    \u2018createdAt\u2019 is not a (visible) field of constructor \u2018User\u2019\n\ntrysql.hs:38:74:\n    \u2018updatedAt\u2019 is not a (visible) field of constructor \u2018User\u2019\n</code></pre>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 1, "creation_date": 1454687843, "post_id": 35228162, "comment_id": 58171311, "body": "Not that I know of. But you can always define a helper function that takes an email address and returns an <code>IO User</code> with the time fields populated (you&#39;ll need <code>IO</code> to grab the current time). An alternate solution: write a trigger."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1454710941, "creation_date": 1454710941, "answer_id": 35234558, "question_id": 35228162, "link": "https://stackoverflow.com/questions/35228162/how-to-omit-fields-that-will-be-filled-in-by-the-database/35234558#35234558", "title": "How to omit fields that will be filled in by the database", "body": "<p>I don't know much about Persistent, but the usual technique for this kind of thing is to define some parameterized types. For example, you might write</p>\n\n<pre><code>data Dated a = Dated\n    { created :: UTCTime\n    , updated :: UTCTime\n    , value :: a\n    }\n</code></pre>\n\n<p>Then your bare values need not worry about their metadata, and metadata can be handled uniformly across all different types. e.g. you might expose an API like this:</p>\n\n<pre><code>new :: a -&gt; IO (Dated a)\nnew a = do\n    now &lt;- getUTCTime\n    return (Dated now now a)\n\nupdate :: Dated a -&gt; a -&gt; IO (Dated a)\nupdate old new = do\n    now &lt;- getUTCTime\n    return (old { updated = now, value = new })\n</code></pre>\n\n<p>Then I would suggest exporting the <code>Dated</code> type constructor and all its fields, together with <code>new</code> and <code>update</code>, but not exporting the <code>Dated</code> data constructor. This will ensure that the <code>created</code> and <code>updated</code> fields are maintained correctly.</p>\n"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1454714734, "creation_date": 1454687304, "last_edit_date": 1454714734, "question_id": 35228162, "link": "https://stackoverflow.com/questions/35228162/how-to-omit-fields-that-will-be-filled-in-by-the-database", "title": "How to omit fields that will be filled in by the database", "body": "<p>I've just started off with <a href=\"http://www.yesodweb.com/book/persistent\" rel=\"nofollow\">Persistent from Yesod</a> and have already hit my first roadblock.</p>\n\n<pre><code>share [mkPersist sqlSettings, mkMigrate \"migrateAll\"] [persistLowerCase|\nUser\n  email String\n  createdAt UTCTime Maybe default=CURRENT_TIME\n  updatedAt UTCTime Maybe default=CURRENT_TIME\n  deriving Show\n|]\n\nu &lt;- insert $ User \"saurabhnanda@gmail.com\" Nothing Nothing\n</code></pre>\n\n<p>I'm coming from a Rails background and like the schema design conventions advocated by them. In this particular case, having every table have a <code>created_at</code> and <code>updated_at</code> timestamp. However, is there any way to NOT specify the <code>createdAt</code> and <code>updatedAt</code> fields for every object that will be created?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1454683960, "post_id": 35226776, "comment_id": 58168629, "body": "well can you write down the <b>type-signature</b> of your <code>f</code>? Aside form the typo (it&#39;s <code>[(String,Bool)]</code> I guess) - your cases seem to have different types which is a problem"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454684079, "post_id": 35226776, "comment_id": 58168714, "body": "I really have trouble with understanding your request - is <code>f&#39;</code> a function from any type to <code>Int</code>? ... as in <code>f&#39; :: a -&gt; Int</code>? or is it <code>f&#39; :: Foo -&gt; Int</code> (you basically wrote down this function already)"}, {"owner": {"reputation": 141, "user_id": 4960278, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh5.googleusercontent.com/-rhXMnM2laZQ/AAAAAAAAAAI/AAAAAAAAAZM/zTJL6P6VbSE/photo.jpg?sz=128", "display_name": "Timothy Chu", "link": "https://stackoverflow.com/users/4960278/timothy-chu"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1454684167, "post_id": 35226776, "comment_id": 58168777, "body": "I imagined      f :: (Data a) =&gt; a -&gt; [TypeRep] (or something like that)  and f&#39; :: (Data a) =&gt; a -&gt; Bool. (I changed my request)."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1454684265, "post_id": 35226776, "comment_id": 58168855, "body": "ok something similar might be possible - have a look at <a href=\"https://wiki.haskell.org/GHC.Generics\" rel=\"nofollow noreferrer\">Generics</a> - but that&#39;s real deep stuff ^^"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1454690097, "post_id": 35226776, "comment_id": 58172803, "body": "I doubt very much that you&#39;ll be able to get anything as powerful as a <code>TypeRep</code> out of any generic programming package, but something simpler you probably can. Counting shouldn&#39;t be too terrible with <code>GHC.Generics</code>."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1454773761, "post_id": 35226776, "comment_id": 58199812, "body": "This seems like a strange request, possibly indicative of a design error. Some more context would help us suggest an alternative approach: what are you really trying to do?"}, {"owner": {"reputation": 141, "user_id": 4960278, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh5.googleusercontent.com/-rhXMnM2laZQ/AAAAAAAAAAI/AAAAAAAAAZM/zTJL6P6VbSE/photo.jpg?sz=128", "display_name": "Timothy Chu", "link": "https://stackoverflow.com/users/4960278/timothy-chu"}, "edited": false, "score": 0, "creation_date": 1455330752, "post_id": 35226776, "comment_id": 58456546, "body": "Turns out this was a design error. I was basically trying to take an instance of any ADT, modify every Foo used in its constructor (recursively) by some  function Foo-&gt;Foo that I passed in, while leaving all other fields the same. This could be accomplished by recursively applying gmapT.  I&#39;m kind of curious why the recursive gmapT isn&#39;t in the Data.Data library, since it seems to be straightforward and also quite useful."}], "owner": {"reputation": 141, "user_id": 4960278, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh5.googleusercontent.com/-rhXMnM2laZQ/AAAAAAAAAAI/AAAAAAAAAZM/zTJL6P6VbSE/photo.jpg?sz=128", "display_name": "Timothy Chu", "link": "https://stackoverflow.com/users/4960278/timothy-chu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1454684104, "creation_date": 1454683179, "last_edit_date": 1454684104, "question_id": 35226776, "link": "https://stackoverflow.com/questions/35226776/count-number-of-values-passed-into-a-haskell-constructor", "title": "Count Number of Values Passed Into a Haskell Constructor", "body": "<p>Suppose I have a data type</p>\n\n<pre><code>data Foo = Foo String Bool | Bar (String-&gt;Bool)\n</code></pre>\n\n<p>I want a function  f that does:</p>\n\n<pre><code>f (Foo _ _) = [String, Bool]\nf (Bar _) = [String-&gt;Bool]\n</code></pre>\n\n<p>In particular, I'd like this function to magically know that Foo and Boo are constructors, and not give me either of</p>\n\n<pre><code>f (Foo _ _)  = [String -&gt; Bool] -- #Don't want this!!!!\nf (Boo _)  = [String, Bool] -- #Don't want this!!!!\n</code></pre>\n\n<p>How can  I do this? I know that I can print a list of records of an ADT using Data.Data, but I can't figure out how to print a list of typenames.</p>\n\n<hr>\n\n<p>(If this is not possible, I would settle for a  function f' that takes in ADTs and outputs whether or not it has 0 parameters.</p>\n\n<pre><code>f'(Foo _ _) = False\nf'(Bar _) = False\n</code></pre>\n\n<p>I want this to work even if I don't assign records to the ADT f' operates on.)</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 2, "creation_date": 1454683054, "post_id": 35225527, "comment_id": 58167947, "body": "In general <code>cabal configure</code> should be done before <code>cabal install</code>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1454701354, "post_id": 35225527, "comment_id": 58179078, "body": "&quot;I experience the same problems even without a sandbox.&quot; I would expect this sequence of steps to be correct.. where exactly is <code>cabal install</code> placing those executables? Is this related to <code>--enable-tests</code> at all? Try <code>cabal sandbox init; cabal install --dependencies; cabal install -v3</code>"}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 2, "last_activity_date": 1458286169, "creation_date": 1458286169, "answer_id": 36078542, "question_id": 35225527, "link": "https://stackoverflow.com/questions/35225527/installing-haskell-dependencies-like-pip-r-requirements-pip/36078542#36078542", "title": "Installing Haskell dependencies like `pip -r requirements.pip`", "body": "<p>So your problem is</p>\n\n<pre><code>cabal: At least the following dependencies are missing:\nalex &gt;=2.3, cabal &gt;=1.22, haddock &gt;=2.15, happy &gt;=1.18\n</code></pre>\n\n<p>The missing deps here are <em>not</em> libraries but programs. You have run <code>cabal install</code> on them, but that installs them into a special cabal bin folder, typically under unix in <code>~/.cabal/bin</code> for user installs. (And in different locations for mac and windows). </p>\n\n<p>So you need to ensure that that <code>bin</code> directory is in your path, <em>or</em> you need to move those executables to <code>/usr/bin</code> or the like that is already in your path.</p>\n"}], "owner": {"reputation": 2379, "user_id": 5045375, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17ed0af705e0449fe49b74d8814a8ce2?s=128&d=identicon&r=PG", "display_name": "Filip Allberg", "link": "https://stackoverflow.com/users/5045375/filip-allberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 36078542, "answer_count": 1, "score": 1, "last_activity_date": 1458286169, "creation_date": 1454679207, "question_id": 35225527, "link": "https://stackoverflow.com/questions/35225527/installing-haskell-dependencies-like-pip-r-requirements-pip", "title": "Installing Haskell dependencies like `pip -r requirements.pip`", "body": "<p>I am new to Haskell and am having problems with <code>cabal</code>.</p>\n\n<p>Performing the following operations,</p>\n\n<pre><code>$ cabal sandbox init\n$ cabal install parsec alex happy haddock mtl\n</code></pre>\n\n<p>Followed by</p>\n\n<pre><code>$ cabal configure --enable-tests\nResolving dependencies...\nConfiguring Scheme-0.1.0.0...\ncabal: At least the following dependencies are missing:\nalex &gt;=2.3, cabal &gt;=1.22, haddock &gt;=2.15, happy &gt;=1.18\n</code></pre>\n\n<p>I am using</p>\n\n<pre><code>$ cabal --version                        \ncabal-install version 1.22.8.0\nusing version 1.22.7.0 of the Cabal library \n</code></pre>\n\n<p>I deleted the sandbox and created a new one</p>\n\n<pre><code>$ cabal sandbox remove\n$ cabal sandbox init\n</code></pre>\n\n<p>so that I could use:</p>\n\n<pre><code>$ cabal install --dependencies-only\n$ cabal configure --enable-tests\n</code></pre>\n\n<p>But I suffer the same issue there, which is that both yield the same error, namely</p>\n\n<pre><code>Resolving dependencies...\nConfiguring Scheme-0.1.0.0...\ncabal: At least the following dependencies are missing:\nalex &gt;=2.3,\ncabal &gt;=1.22,\ndoctest &gt;=0.8,\nhaddock &gt;=2.15,\nhappy &gt;=1.18\n</code></pre>\n\n<p>This is my <code>.cabal</code> file,</p>\n\n<pre><code>name:                       Scheme\nversion:                    0.1.0.0\nlicense:                    MIT\nlicense-file:               LICENSE\ncategory:                   Language\nbuild-type:                 Simple\ncabal-version:              &gt;=1.10\n\nexecutable Scheme\n  main-is:             Main.hs\n  ghc-options:         -Wall\n  hs-source-dirs:      src/\n  default-language:    Haskell2010\n  build-depends:       base &gt;=4.6 &amp;&amp; &lt;4.9\n                       , cabal &gt;=1.22\n                       , parsec &gt;=3.1 &amp;&amp; &lt;3.2\n                       , alex &gt;=2.3\n                       , happy &gt;=1.18\n                       , haddock &gt;=2.15\n                       , mtl &gt;=2.2.1\n\ntest-suite doctests\n  default-language:   Haskell2010\n  type:               exitcode-stdio-1.0\n  ghc-options:        -threaded\n  main-is:            doctests.hs\n  build-depends:      base &gt;=4.6 &amp;&amp; &lt;4.9\n                       , alex &gt;=2.3\n                       , happy &gt;=1.18\n                       , haddock &gt;=2.13\n                       , doctest &gt;= 0.8\n</code></pre>\n\n<p>I experience the same problems even without a sandbox.</p>\n\n<p>In Python with <code>pip</code> this is just a matter of using a <code>virtualenv</code> and executing <code>pip install -r requirements.pip</code> if one has such a file specifying the dependencies. I'd like to go through a similar process, but with <code>cabal</code>.</p>\n\n<p>What is wrong with my approach?</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 1, "creation_date": 1454671439, "post_id": 35222536, "comment_id": 58159797, "body": "There&#39;s conflict between the dependency of  your target <code>http-conduit-2.1.8</code> and the already installed <code>attoparsec-0.13.0.1</code>, the two are requesting different versions of a package. Read briefly <a href=\"https://wiki.haskell.org/Cabal/Survival\" rel=\"nofollow noreferrer\">this page</a> and try haskell-stack build tool please."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1454672040, "post_id": 35222536, "comment_id": 58160181, "body": "This doesn&#39;t answer your question, but you can use haskellstack.org : <code>stack install http-conduit</code>."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1454677605, "post_id": 35222536, "comment_id": 58164117, "body": "Is the version of <code>transformers</code> -- 0.5.1.0 -- the one that came with your ghc? If not, something has gone wrong with this sandbox and you should start over. transformers-0.5.x is too new for things to have caught up with. There is also adding <code>--allow-newer</code> to force compatibility. But <code>stack</code> will be the best plan, I agree."}, {"owner": {"reputation": 21726, "user_id": 1708058, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4a0b611077fcb9f7ede011fdc46e4d4c?s=128&d=identicon&r=PG", "display_name": "Alan Coromano", "link": "https://stackoverflow.com/users/1708058/alan-coromano"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1454726664, "post_id": 35222536, "comment_id": 58187926, "body": "@Sibi, is stack an alrenative to cabal?"}, {"owner": {"reputation": 21726, "user_id": 1708058, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4a0b611077fcb9f7ede011fdc46e4d4c?s=128&d=identicon&r=PG", "display_name": "Alan Coromano", "link": "https://stackoverflow.com/users/1708058/alan-coromano"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1454726712, "post_id": 35222536, "comment_id": 58187937, "body": "@Michael, I&#39;ve removed sandbox and started again and that didn&#39;t help. How would stack help me?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1454737451, "post_id": 35222536, "comment_id": 58189924, "body": "@AlanCoromano Not exactly, but sort of. Stack uses curated packages by default which are known to build and they avoid this type of problem. I would recommend you going with stack. You can find the the installation details <a href=\"http://haskellstack.org/\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1454806124, "post_id": 35222536, "comment_id": 58210576, "body": "@AlanCoromano I see that like your version of <code>transformers</code>, your version of the <code>cabal</code> tool and the <code>Cabal</code> library is from the cutting edge. What version of ghc are you using?"}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1456433256, "creation_date": 1456433256, "answer_id": 35637993, "question_id": 35222536, "link": "https://stackoverflow.com/questions/35222536/unable-to-install-a-package-via-cabal-unmet-dependencies/35637993#35637993", "title": "Unable to install a package via cabal - unmet dependencies", "body": "<p>The issue was that conduit required an older version of transformers than the one at the base of your dependency tree.</p>\n\n<p>Since then, a newer conduit has been uploaded that lifts the upper bound: <a href=\"http://hackage.haskell.org/package/conduit-1.2.6.2\" rel=\"nofollow\">http://hackage.haskell.org/package/conduit-1.2.6.2</a></p>\n\n<p>Now, if you try the same procedure, things <em>should</em> work...</p>\n"}], "owner": {"reputation": 21726, "user_id": 1708058, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4a0b611077fcb9f7ede011fdc46e4d4c?s=128&d=identicon&r=PG", "display_name": "Alan Coromano", "link": "https://stackoverflow.com/users/1708058/alan-coromano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 304, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1456433256, "creation_date": 1454670225, "question_id": 35222536, "link": "https://stackoverflow.com/questions/35222536/unable-to-install-a-package-via-cabal-unmet-dependencies", "title": "Unable to install a package via cabal - unmet dependencies", "body": "<p>How can I possible fix this?</p>\n\n<pre><code>$ cabal install http-conduit\nResolving dependencies...\ncabal: Could not resolve dependencies:\ntrying: attoparsec-0.13.0.1/installed-5b6... (user goal)\ntrying: http-conduit-2.1.8 (user goal)\ntrying: monad-control-1.0.0.5 (dependency of http-conduit-2.1.8)\nnext goal: conduit (dependency of http-conduit-2.1.8)\nrejecting: conduit-1.2.6.1, 1.2.6, 1.2.5.1, 1.2.5, 1.2.4.3, 1.2.4.2, 1.2.4.1,\n1.2.4, 1.2.3.1 (conflict: attoparsec =&gt;\ntransformers==0.5.1.0/installed-426..., conduit =&gt; transformers&gt;=0.2.2 &amp;&amp;\n&lt;0.5)\nrejecting: conduit-1.2.3, 1.2.2.2, 1.2.2.1, 1.2.2, 1.2.1, 1.2.0.2, 1.2.0.1,\n1.2.0, 1.1.7, 1.1.6, 1.1.5, 1.1.4, 1.1.3, 1.1.2.1, 1.1.2, 1.1.1.1, 1.1.1,\n1.1.0.2, 1.1.0.1, 1.1.0, 1.0.17.1, 1.0.17, 1.0.16, 1.0.15.1, 1.0.15, 1.0.14,\n1.0.13.1, 1.0.13, 1.0.12, 1.0.11.1, 1.0.11, 1.0.10.1, 1.0.10, 1.0.9.3,\n1.0.9.2, 1.0.9.1, 1.0.9, 1.0.8, 1.0.7.4, 1.0.7.3, 1.0.7.2, 1.0.7.1, 1.0.7,\n1.0.6, 1.0.5.1, 1.0.5, 1.0.4.2, 1.0.4.1, 1.0.4, 1.0.3, 1.0.2, 1.0.1, 1.0.0.2,\n1.0.0.1, 1.0.0, 0.5.6, 0.5.5 (conflict: monad-control==1.0.0.5, conduit =&gt;\nmonad-control&gt;=0.3.1 &amp;&amp; &lt;0.4)\nrejecting: conduit-0.5.4.2, 0.5.4.1, 0.5.4, 0.5.3, 0.5.2.7, 0.5.2.6, 0.5.2.5,\n0.5.2.4, 0.5.2.3, 0.5.2.2, 0.5.2.1, 0.5.2, 0.5.1, 0.5.0, 0.4.2, 0.4.1.1,\n0.4.1, 0.4.0.1, 0.4.0, 0.3.0, 0.2.2, 0.2.1, 0.2.0, 0.1.1.1, 0.1.1, 0.1.0,\n0.0.4, 0.0.3, 0.0.2, 0.0.1.1, 0.0.1, 0.0.0.2, 0.0.0.1, 0.0.0 (conflict:\nhttp-conduit =&gt; conduit&gt;=0.5.5 &amp;&amp; &lt;1.3)\nBackjump limit reached (change with --max-backjumps).\n\nNote: when using a sandbox, all packages are required to have consistent\ndependencies. Try reinstalling/unregistering the offending packages or\nrecreating the sandbox.\n</code></pre>\n\n<p>And</p>\n\n<pre><code>$ cabal --version\ncabal-install version 1.22.8.0\nusing version 1.22.7.0 of the Cabal library \n</code></pre>\n"}, {"tags": ["haskell", "parametric-polymorphism"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1454648021, "post_id": 35216075, "comment_id": 58148203, "body": "I don&#39;t know how you feel about it, but I <i>always</i> turn on <code>ScopedTypeVariables</code> when I use an extension that enables <code>forall</code>; otherwise I&#39;m likely to get confused down the road."}, {"owner": {"reputation": 95, "user_id": 5886230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00a8344c28e7aabfcd0893c7a5ea8c7b?s=128&d=identicon&r=PG&f=1", "display_name": "igorbark", "link": "https://stackoverflow.com/users/5886230/igorbark"}, "edited": false, "score": 0, "creation_date": 1454706465, "post_id": 35216075, "comment_id": 58181747, "body": "Perfect, thanks a lot! Do you know of any good resources that go through all these modern language extensions? All of the Haskell books I can find deal mostly with Haskell 98, and Haskell documentation can be pretty exhausting..."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 95, "user_id": 5886230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00a8344c28e7aabfcd0893c7a5ea8c7b?s=128&d=identicon&r=PG&f=1", "display_name": "igorbark", "link": "https://stackoverflow.com/users/5886230/igorbark"}, "edited": false, "score": 0, "creation_date": 1454708897, "post_id": 35216075, "comment_id": 58182969, "body": "@igorbark If you want all the extensions, there is no better source than <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghc-language-features.html\" rel=\"nofollow noreferrer\">the horse&#39;s mouth</a>."}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "reply_to_user": {"reputation": 95, "user_id": 5886230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00a8344c28e7aabfcd0893c7a5ea8c7b?s=128&d=identicon&r=PG&f=1", "display_name": "igorbark", "link": "https://stackoverflow.com/users/5886230/igorbark"}, "edited": false, "score": 0, "creation_date": 1454712003, "post_id": 35216075, "comment_id": 58184234, "body": "@igorbark: A few people seem to have gotten use of <a href=\"http://stackoverflow.com/questions/12031878/what-is-the-purpose-of-rank2types/12033549#12033549\">my explanation of <code>RankNTypes</code> over here</a>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 10, "last_activity_date": 1454645383, "last_edit_date": 1454645383, "creation_date": 1454644851, "answer_id": 35216075, "question_id": 35215763, "link": "https://stackoverflow.com/questions/35215763/applying-function-passed-as-argument-to-different-types-in-haskell/35216075#35216075", "title": "Applying Function Passed as Argument to Different Types in Haskell", "body": "<p>This can be achieved using rank-2 polymorphism as follows:</p>\n\n<pre><code>{-# LANGUAGE Rank2Types #-}\ngeneric :: (forall a. a -&gt; Maybe a) -&gt; (Maybe Int, Maybe Bool)\ngeneric f = (f 3, f True)\n</code></pre>\n\n<p>Often you will need some typeclass restriction (not because the implementation of <code>generic</code> demands it, but because the caller cannot pass an argument that works for all types), e.g.</p>\n\n<pre><code>genericNum :: (forall a. Num a =&gt; a -&gt; a) -&gt; (Int, Integer)\ngenericNum f = (f 3, f 9)\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 5886230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00a8344c28e7aabfcd0893c7a5ea8c7b?s=128&d=identicon&r=PG&f=1", "display_name": "igorbark", "link": "https://stackoverflow.com/users/5886230/igorbark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 1, "accepted_answer_id": 35216075, "answer_count": 1, "score": 5, "last_activity_date": 1454646726, "creation_date": 1454642623, "last_edit_date": 1454646726, "question_id": 35215763, "link": "https://stackoverflow.com/questions/35215763/applying-function-passed-as-argument-to-different-types-in-haskell", "title": "Applying Function Passed as Argument to Different Types in Haskell", "body": "<p>Is there any way to apply a function passed as an argument to two different types? As a contrived example, I can create a <code>(Maybe Int, Maybe Bool)</code> with the expression <code>(Just 3, Just True)</code>, but if I try to make this behaviour more generic with the function</p>\n\n<pre><code>generic :: (a -&gt; Maybe a) -&gt; (Maybe Int, Maybe Bool)\ngeneric f = (f 3, f True)\n</code></pre>\n\n<p>so that I might be able to do something like <code>generic Just</code>, the compiler complains because the type variable <code>a</code> is constant.</p>\n\n<p>The use case of this is applying a generic function to a tree structure where each node is parametrized by a type.</p>\n"}, {"tags": ["haskell", "recursion", "definition"], "comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1454642336, "post_id": 35215660, "comment_id": 58146643, "body": "<code>let sum [] = 0 ; sum (x:xs) = x + sum xs</code> (GHCi definition dialect)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1454663092, "post_id": 35215660, "comment_id": 58154489, "body": "For this kind of issues, I recommend <a href=\"http://science.raphael.poss.name/haskell-for-ocaml-programmers.html#straightforward-equivalences\" rel=\"nofollow noreferrer\">Haskell for OCaml programmers</a> (even if I don&#39;t completely agree on all its suggestions)."}], "answers": [{"comments": [{"owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "edited": false, "score": 0, "creation_date": 1454664209, "post_id": 35216084, "comment_id": 58155127, "body": "I tried first one on ghc, got syntax error:let sum = \\case  []-&gt;0  x:xs-&gt;x+sum xs  sum [1..10]. It says parse error on input `case&#39;"}, {"owner": {"reputation": 86, "user_id": 4456770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9939c63a637b6b1d01f386aa28785a42?s=128&d=identicon&r=PG&f=1", "display_name": "isanco", "link": "https://stackoverflow.com/users/4456770/isanco"}, "reply_to_user": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "edited": false, "score": 0, "creation_date": 1454686073, "post_id": 35216084, "comment_id": 58170080, "body": "@vik: You need to allow for the extension <code>LambdaCase</code> in ghci. Before typing <code>let sum  = ...</code>, you should type in ghci <code>:set -XLambdaCase</code>. See  <a href=\"http://stackoverflow.com/questions/12584884/how-do-i-enable-language-extensions-from-within-ghci\">here</a>."}, {"owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "edited": false, "score": 0, "creation_date": 1454722242, "post_id": 35216084, "comment_id": 58187115, "body": "Thanks, it works in ghci. But if I wish to use GHC to compile my code, how do I import? I tried &quot;import LambdaCase&quot;, still says &quot;parse error on input `case&#39;. Am I using wrong import?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "edited": false, "score": 0, "creation_date": 1454726379, "post_id": 35216084, "comment_id": 58187868, "body": "@viksantata The first code block in my answer is a complete file you can compile."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 7, "last_activity_date": 1454729813, "last_edit_date": 1454729813, "creation_date": 1454644915, "answer_id": 35216084, "question_id": 35215660, "link": "https://stackoverflow.com/questions/35215660/how-to-write-a-recursive-function-with-initial-condition-in-haskell/35216084#35216084", "title": "How to write a recursive function with initial condition in Haskell?", "body": "<p>Assuming the feature you like is \"I don't have to repeat the name <code>sum</code>\", the <code>LambdaCase</code> extension enables this:</p>\n\n<pre><code>{-# LANGUAGE LambdaCase #-}\n\nmodule CaseExample where\nimport Prelude hiding (sum)\n\nsum = \\case\n    [] -&gt; 0\n    x:xs -&gt; x + sum xs\n</code></pre>\n\n<p>Otherwise, the syntax that works without extensions is</p>\n\n<pre><code>sum [] = 0\nsum (x:xs) = x + sum xs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "edited": false, "score": 1, "creation_date": 1454738579, "post_id": 35216096, "comment_id": 58190154, "body": "Prelude seems to forbid having multiple lines of code. Each time I type &quot;enter&quot;, the expression is evaluated. How did your example work? Thanks."}, {"owner": {"reputation": 2079, "user_id": 338519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df4784f6e62ac5f0f9005b565810aae0?s=128&d=identicon&r=PG", "display_name": "user338519", "link": "https://stackoverflow.com/users/338519/user338519"}, "edited": false, "score": 0, "creation_date": 1473108748, "post_id": 35216096, "comment_id": 66006174, "body": ":set +m for multiline mode"}], "tags": [], "owner": {"reputation": 126, "user_id": 5766031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-APTQZlmDZaQ/AAAAAAAAAAI/AAAAAAAAAG4/u-iOSDRTsOo/photo.jpg?sz=128", "display_name": "Zacharie 007", "link": "https://stackoverflow.com/users/5766031/zacharie-007"}, "is_accepted": true, "score": 3, "last_activity_date": 1467914920, "last_edit_date": 1467914920, "creation_date": 1454645045, "answer_id": 35216096, "question_id": 35215660, "link": "https://stackoverflow.com/questions/35215660/how-to-write-a-recursive-function-with-initial-condition-in-haskell/35216096#35216096", "title": "How to write a recursive function with initial condition in Haskell?", "body": "<pre><code>sum :: [Int] -&gt; Int\n\nsum [] = 0\nsum (x:xs) = x + sum xs\n</code></pre>\n\n<p>Another way </p>\n\n<pre><code> Prelude&gt;:{\n Prelude|let sumE  xs' = case xs' of\n Prelude|                     [] -&gt; 0\n Prelude|                     x:xs' -&gt; x + sumE xs'\n Prelude| \n Prelude|:}\n Prelude&gt; sumE [1,2,3]\n 6\n Prelude&gt; sumE []\n 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126, "user_id": 5766031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-APTQZlmDZaQ/AAAAAAAAAAI/AAAAAAAAAG4/u-iOSDRTsOo/photo.jpg?sz=128", "display_name": "Zacharie 007", "link": "https://stackoverflow.com/users/5766031/zacharie-007"}, "is_accepted": false, "score": 1, "last_activity_date": 1454758968, "last_edit_date": 1454758968, "creation_date": 1454758292, "answer_id": 35240501, "question_id": 35215660, "link": "https://stackoverflow.com/questions/35215660/how-to-write-a-recursive-function-with-initial-condition-in-haskell/35240501#35240501", "title": "How to write a recursive function with initial condition in Haskell?", "body": "<p>This will alow you to write multiple lines of code:</p>\n\n<pre><code>  Prelude&gt; :set +m\n</code></pre>\n\n<p>Then try this code. The prompt changes from prelude> to prelude|  :</p>\n\n<pre><code>Prelude&gt; let sumE  xs' = case xs' of\nPrelude|                     [] -&gt; 0\nPrelude|                     x:xs' -&gt; x + sumE xs'\n</code></pre>\n"}], "owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "accepted_answer_id": 35216096, "answer_count": 3, "score": 1, "last_activity_date": 1467914920, "creation_date": 1454641830, "question_id": 35215660, "link": "https://stackoverflow.com/questions/35215660/how-to-write-a-recursive-function-with-initial-condition-in-haskell", "title": "How to write a recursive function with initial condition in Haskell?", "body": "<p>In F# I can define like this:</p>\n\n<pre><code>let rec sum = function\n| [] -&gt; 0\n| x::xs -&gt; x + sum xs\n</code></pre>\n\n<p>Looks quite convenient. Is there its correspondence in Haskell? </p>\n"}, {"tags": ["haskell", "optimization"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1454639533, "post_id": 35215317, "comment_id": 58145875, "body": "If the code is working and you just want suggestions for improvement, you should post at codereview.stackexchange.com. Otherwise, you need to specify exactly what the problem is that you want solved."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1454654098, "post_id": 35215317, "comment_id": 58150177, "body": "This is a weird variation on the maximum subarray problem. I&#39;m guessing the modulo <code>n</code> bit is designed to break the standard (efficient) solution. I&#39;m not sure if there&#39;s any similarly efficient solution to this variant, but I doubt it. Modular arithmetic and maximization don&#39;t really mesh very well in general."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1454662922, "post_id": 35215317, "comment_id": 58154362, "body": "In this kind of questions, you should always include a specification, by stating in plain words what the program is supposed to do. This will provide more visibility -- I guess most readers just see a block of code and stop reading. There is a very brief one inside the code in the comment above <code>d</code>, but it&#39;s lost in the noise."}, {"owner": {"reputation": 25, "user_id": 3681046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1a51d5c3ce0b5dfca5709f5a2886742?s=128&d=identicon&r=PG&f=1", "display_name": "jaggedGoofy", "link": "https://stackoverflow.com/users/3681046/jaggedgoofy"}, "edited": false, "score": 0, "creation_date": 1454704192, "post_id": 35215317, "comment_id": 58180547, "body": "Fair enough; here is the link to the hackerrank challenge I&#39;m attempting to solve - <a href=\"https://www.hackerrank.com/challenges/maximise-sum\" rel=\"nofollow noreferrer\">hackerrank.com/challenges/maximise-sum</a>"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1454647326, "post_id": 35215634, "comment_id": 58148002, "body": "I suggest using <code>&lt;=&lt;</code> instead of <code>&gt;=&gt;</code> to keep all the compositions flowing the same way."}, {"owner": {"reputation": 25, "user_id": 3681046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1a51d5c3ce0b5dfca5709f5a2886742?s=128&d=identicon&r=PG&f=1", "display_name": "jaggedGoofy", "link": "https://stackoverflow.com/users/3681046/jaggedgoofy"}, "edited": false, "score": 0, "creation_date": 1454648300, "post_id": 35215634, "comment_id": 58148270, "body": "This is the awesomeness of Haskell that drew me to it. Thanks for the explanation"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 6, "last_activity_date": 1454651139, "last_edit_date": 1454651139, "creation_date": 1454641563, "answer_id": 35215634, "question_id": 35215317, "link": "https://stackoverflow.com/questions/35215317/what-optimizations-can-be-made-to-this-haskell-code/35215634#35215634", "title": "What optimizations can be made to this Haskell code?", "body": "<p>You can improve the runtime a lot by observing that <code>map sum (produceContiguous d n)</code> (which has runtime \u03a9(m^2), m the length of <code>drop n d</code> -- possibly O(m^3) time because you're appending to the end of <code>acc</code> on each iteration) can be collapsed to <code>scanl (+) 0 (drop n d)</code> (which has runtime O(m)). There are plenty of other stylistic changes I would make as well, but that's the main algorithmic one I can think of.</p>\n\n<p>Cleaning up all the stylistic stuff, I would probably write:</p>\n\n<pre><code>import Control.Monad\nimport Data.List\naddMod n x y = (x+y) `mod` n\nmaxResult n = maximum . (scanl (addMod n) 0 &lt;=&lt; tails)\n</code></pre>\n\n<p>In ghci:</p>\n\n<pre><code>*Main&gt; jaggedGoofyMax 100 [1..1000]\n99\n(12.85 secs, 24,038,973,096 bytes)\n*Main&gt; dmwitMax 100 [1..1000]\n99\n(0.42 secs, 291,977,440 bytes)\n</code></pre>\n\n<p>Not shown here is the version of <code>jaggedGoofyMax</code> that has <em>only</em> the optimization I mentioned in my first paragraph applied, which has slightly better runtime/memory usage stats to <code>dmwitMax</code> when run in ghci (but basically identical to <code>dmwitMax</code> when both are compiled with <code>-O2</code>). So you can see that for even modest input sizes this optimization can make a big difference.</p>\n"}], "owner": {"reputation": 25, "user_id": 3681046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1a51d5c3ce0b5dfca5709f5a2886742?s=128&d=identicon&r=PG&f=1", "display_name": "jaggedGoofy", "link": "https://stackoverflow.com/users/3681046/jaggedgoofy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 35215634, "answer_count": 1, "score": 1, "last_activity_date": 1454651139, "creation_date": 1454639251, "question_id": 35215317, "link": "https://stackoverflow.com/questions/35215317/what-optimizations-can-be-made-to-this-haskell-code", "title": "What optimizations can be made to this Haskell code?", "body": "<pre><code>--Returns last N elements in list\nlastN :: Int -&gt; [a] -&gt; [a]\nlastN n xs = let m = length xs in drop (m-n) xs\n\n--create contiguous array starting from index b within list a\nproduceContiguous :: [a] -&gt; Int -&gt; [[a]]\nproduceContiguous [] _ = [[]]  \nproduceContiguous arr ix = scanl (\\acc x -&gt; acc ++ [x]) [arr !! ix] inset\n    where inset = lastN (length arr - (ix + 1)) arr\n\n--Find maximum sum of all possible contiguous sub arrays, modulo [n]\n--d is dummy data\nlet d = [1,2,3,10,6,3,1,47,10]\nlet maxResult = maximum $ map (\\s -&gt; maximum s) $ map (\\c -&gt; map (\\ac -&gt; (sum ac )`mod` (last n)) c ) $ map (\\n -&gt; produceContiguous d n ) [0..(length d) -1]\n</code></pre>\n\n<p>I'm a Haskell newb - just a few days into it .. If I'm doing something obviously wrong, whoopsies</p>\n"}, {"tags": ["haskell", "semantics"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1454647527, "post_id": 35215203, "comment_id": 58148075, "body": "I&#39;m voting to close this question as off-topic because you can&#39;t learn the barest basics of a new language by asking about them on SO. That is what tutorials are for."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 2, "creation_date": 1454665465, "post_id": 35215203, "comment_id": 58155961, "body": "LET a BE 3. We give a value a name, this is all about it."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454705815, "post_id": 35215203, "comment_id": 58181351, "body": "@dfeuer I find it a good question, and it shows that the OP wants to understand something. Your and my ideas of how to learn something may be different from how the OP approaches things. That doesn&#39;t change the fact that the question touches an important concept - referential transaprency - and we shouldn&#39;t get tired too early to explain it again and again. Just my 0,02\u20ac"}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 1, "creation_date": 1454722568, "post_id": 35215203, "comment_id": 58187187, "body": "I also do wonder why &quot;everything is a function in haskell&quot; is stated here with such confidence, when it is clearly false... but, I see a lot of people thinking this. Why is this so common? is there some resource somewhere that claims that everything in haskell is a function? Why would people even believe or think this in the first place? :|  there must be somewhere everyone is getting this from."}], "answers": [{"comments": [{"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1454663526, "post_id": 35215332, "comment_id": 58154716, "body": "Haskell doesn&#39;t generally have anything I would call &quot;bytecode&quot;."}, {"owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "reply_to_user": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1454811621, "post_id": 35215332, "comment_id": 58211585, "body": "@SebastianRedl, yes, I couldn&#39;t think of a better word at the time. I fixed the issue."}], "tags": [], "owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "is_accepted": false, "score": 3, "last_activity_date": 1454811695, "last_edit_date": 1454811695, "creation_date": 1454639406, "answer_id": 35215332, "question_id": 35215203, "link": "https://stackoverflow.com/questions/35215203/how-to-name-the-of-a-haskell-expression/35215332#35215332", "title": "How to name the &quot;=&quot; of a Haskell expression?", "body": "<p>First, just to get this out of the way, <strong>not everything in Haskell is a function</strong>. Functions are actually their very own type denoted by the <code>(-&gt;)</code> operator. This is way the type declarations for functions tend to look like <code>func :: a -&gt; b</code>. Most things in Haskell are, however, lazy, meaning that values are not evaluated until they are actually needed. This is similar to how argumentless functions act in other languages, so values can, for some purposes at least, be <em>conceptualized</em> as functions. That does not mean, though, that the <code>a</code> in your example is callable. </p>\n\n<p>As for the phrasing, either of the latter two are accurate. I prefer the second, but both work. In Haskell, <code>let a = 3</code> doesn't really <em>construct</em> an argument, so the first doesn't make a lot of sense. (not at the level that most Haskell programmers work anyway; I don't know how the generated machine code works under the covers).</p>\n\n<p>All in all, I advise you go take some introductory courses on Haskell. Most of them cover this sort of stuff.</p>\n\n<p>EDIT: As some other answers have pointed out, the word \"assign\" tends to imply some level of mutability, which Haskell does not have. For that reason, I would advise against the last phrasing.</p>\n"}, {"comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1454677431, "post_id": 35219821, "comment_id": 58164002, "body": "I think &quot;bind to name&quot; is definitely more approrpriate in Haskell than &quot;bind to variable&quot;..."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1454678120, "post_id": 35219821, "comment_id": 58164458, "body": "@ErikAllik Possibly so. I sometimes think of a &quot;variable&quot; as  a &quot;name with a scope&quot;, where a &quot;name&quot; is just a string/syntactic identifier. Anyway, I edited."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1454678025, "last_edit_date": 1454678025, "creation_date": 1454662249, "answer_id": 35219821, "question_id": 35215203, "link": "https://stackoverflow.com/questions/35215203/how-to-name-the-of-a-haskell-expression/35219821#35219821", "title": "How to name the &quot;=&quot; of a Haskell expression?", "body": "<pre><code>let a=3\n</code></pre>\n\n<blockquote>\n  <p>\"Construct an object named a\"</p>\n</blockquote>\n\n<p>No, this is not common terminology in Haskell.</p>\n\n<blockquote>\n  <p>\"bind value 3 to object a\"</p>\n</blockquote>\n\n<p>This is closer. One could simply say \"bind value 3 to name (or variable, or identifier) <code>a</code>\". There are no \"objects\" in Haskell.</p>\n\n<blockquote>\n  <p>\"assign a value to variable a\"</p>\n</blockquote>\n\n<p>No, \"assignment\" usually implies that one can mutate the value of a variable, when this is not the case in pure functional programming.</p>\n\n<p>Personally, I'd just read <code>let a = 3</code> as \"define <code>a</code> as <code>3</code>\". In Haskell, most of the time, we reason about the values of variables, disregarding when exactly such values are constructed / allocated / garbage collected and how exactly the values are represented in memory. So, we usually avoid to think about \"how\" operationally a program is executed, focusing more on \"what\" is the result, and whether it is the intended one (\"denotationally\").</p>\n\n<p>Of course, after we get the intended result, we do start caring about the performance of our programs. For that, we need to have at least a rough idea about the \"how\" the program is executed, its memory allocations, etc.</p>\n"}, {"tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 0, "last_activity_date": 1454700835, "creation_date": 1454700835, "answer_id": 35232079, "question_id": 35215203, "link": "https://stackoverflow.com/questions/35215203/how-to-name-the-of-a-haskell-expression/35232079#35232079", "title": "How to name the &quot;=&quot; of a Haskell expression?", "body": "<p>As far as I know, variable does not mean that things are mutable but that there value are not fixed and depend on the context. For example, when you define the mathematical funcion <code>f(x) : x -&gt; x+1</code>, <code>x</code> is variable in the way it depends on what you pass to <code>f</code> when you call it, where as <code>f</code> will be always the same function. There is no notion of mutability but only of scope. In Haskell I suppose things are the same, a variable is any 'binding' which is not global but lives in a limited scope. I would use <code>defines</code> but I don't see why 'assign' wouldn't be appropriate.</p>\n"}, {"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 1, "last_activity_date": 1454705615, "creation_date": 1454705615, "answer_id": 35233301, "question_id": 35215203, "link": "https://stackoverflow.com/questions/35215203/how-to-name-the-of-a-haskell-expression/35233301#35233301", "title": "How to name the &quot;=&quot; of a Haskell expression?", "body": "<blockquote>\n  <p>Does it mean:</p>\n  \n  <p>\"Construct an object named a\" or \"bind value 3 to object a\" or \"assign\n  a value to variable a\"?</p>\n</blockquote>\n\n<p>No, no, and again, no.</p>\n\n<p>First, in Haskell we speak of <strong>values</strong>, not objects. Numbers, for example, are values, and you know that every number has infinitely many names. For example:</p>\n\n<pre><code>0\nthe predecessor of 1\nthe predecessor of the precdecessor of 2\nthe predecessor of ...(32493 times)... the predecessor of 32495\nthe product of 1 and 0\nthe product of the successor of 1 and 0\n...\n... and so on, you get the idea\n...\n</code></pre>\n\n<p>Now, as in normal language, when we need to mention something with a complicated name very often, we tend to invent a short name. For example, when we write an article about activities of the \"bureau for the promotion of alcohol, tobacco and firearms\" we introduce an abbreviation like in</p>\n\n<blockquote>\n  <p>The bureau for the promotion of alcohol, tobacco and firearms (ATF) is\n  agian in the news. The chief of the ATF, Drink A'Glass, said in an\n  interview that beer alone is no good when you can't have a good smoke\n  at the same time. ...</p>\n</blockquote>\n\n<p>Likewise, in Haskell, we may need to mention \"the square of the first element of the tuple that is the result of applying function f to some list whose name is <em>xs</em>\" and we can give it a name like so</p>\n\n<pre><code>let a = sqr . fst . f $ xs\n</code></pre>\n\n<p>and henceforth we can just use <code>a</code>.\nBecause of <em>referential transparency</em> it doesn't matter for the meaning of the program if you do this and use the name <code>a</code> or write the complicated expression all the time. Thus, this principle guarantees that the meaning of the name and of its definition is the same in the same way that \"the predecessor of 2\" and \"the successor of 0\" are the same as 1.</p>\n"}], "owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 1, "accepted_answer_id": 35219821, "answer_count": 4, "score": 1, "last_activity_date": 1454811695, "creation_date": 1454638441, "last_edit_date": 1454677382, "question_id": 35215203, "link": "https://stackoverflow.com/questions/35215203/how-to-name-the-of-a-haskell-expression", "title": "How to name the &quot;=&quot; of a Haskell expression?", "body": "<pre><code>let a = 3\n</code></pre>\n\n<p>Does it mean:</p>\n\n<ul>\n<li>\"Construct an object named a\" or</li>\n<li>\"bind value 3 to object a\" or</li>\n<li>\"assign a value to variable a\"?</li>\n</ul>\n\n<p>If everything in Haskell is a function, so can I say here a is also a function? But functions can be called, how can I call \"a\"?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 30577, "user_id": 476496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85197b0087c5bee323d2690c977878f8?s=128&d=identicon&r=PG", "display_name": "Vincent Savard", "link": "https://stackoverflow.com/users/476496/vincent-savard"}, "edited": false, "score": 1, "creation_date": 1454618294, "post_id": 35211120, "comment_id": 58137430, "body": "Asking for code is off-topic. What have you tried? Why didn&#39;t it work?"}, {"owner": {"reputation": 62027, "user_id": 603977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myasv.jpg?s=128&g=1", "display_name": "jscs", "link": "https://stackoverflow.com/users/603977/jscs"}, "edited": false, "score": 0, "creation_date": 1454618618, "post_id": 35211120, "comment_id": 58137617, "body": "What are the rules for the insertions?"}, {"owner": {"reputation": 126, "user_id": 5766031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-APTQZlmDZaQ/AAAAAAAAAAI/AAAAAAAAAG4/u-iOSDRTsOo/photo.jpg?sz=128", "display_name": "Zacharie 007", "link": "https://stackoverflow.com/users/5766031/zacharie-007"}, "reply_to_user": {"reputation": 62027, "user_id": 603977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myasv.jpg?s=128&g=1", "display_name": "jscs", "link": "https://stackoverflow.com/users/603977/jscs"}, "edited": false, "score": 0, "creation_date": 1454620566, "post_id": 35211120, "comment_id": 58138721, "body": "@Josh I guess starting with &#39;a&#39; then alternate between &#39;b&#39; and &#39;a&#39;. And finish with a or b."}, {"owner": {"reputation": 62027, "user_id": 603977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myasv.jpg?s=128&g=1", "display_name": "jscs", "link": "https://stackoverflow.com/users/603977/jscs"}, "reply_to_user": {"reputation": 126, "user_id": 5766031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-APTQZlmDZaQ/AAAAAAAAAAI/AAAAAAAAAG4/u-iOSDRTsOo/photo.jpg?sz=128", "display_name": "Zacharie 007", "link": "https://stackoverflow.com/users/5766031/zacharie-007"}, "edited": false, "score": 1, "creation_date": 1454620626, "post_id": 35211120, "comment_id": 58138766, "body": "I see what you see, @Zacharie007, but the asker needs to be explicit; guesses don&#39;t really help."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1454624123, "post_id": 35211120, "comment_id": 58140583, "body": "I&#39;m voting to close this question as off-topic."}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 6, "last_activity_date": 1454620954, "last_edit_date": 1454620954, "creation_date": 1454619118, "answer_id": 35211393, "question_id": 35211120, "link": "https://stackoverflow.com/questions/35211120/haskell-need-help-designing-this-function/35211393#35211393", "title": "Haskell: Need Help Designing this Function", "body": "<p>go figure</p>\n\n<pre><code>Prelude&gt; 'a' : (concat $ zipWith (\\x y -&gt; x:[y]) \"Hello\" $ cycle \"ba\")\n\"aHbealblaob\"\n</code></pre>\n\n<p>or without any details this would do too.</p>\n\n<pre><code>f :: String -&gt; String\nf \"Hello\" = \"aHbealblaob\"\nf _       = \"not specified\"\n</code></pre>\n\n<p>Actually, there is a nice mutual recursive solution similar to odd/even.</p>\n\n<pre><code>wrap [] = []\nwrap (x:xs) = 'a':x:'b':skip xs\nskip [] = []\nskip (x:xs) = x: wrap xs\n\nwrap \"Hello\"\n\"aHbealblaob\"\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5863326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f727f854b2159dcf0be4f61845434f?s=128&d=identicon&r=PG&f=1", "display_name": "blues5938", "link": "https://stackoverflow.com/users/5863326/blues5938"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 1, "closed_date": 1454630232, "answer_count": 1, "score": -5, "last_activity_date": 1454620954, "creation_date": 1454618197, "last_edit_date": 1454618269, "question_id": 35211120, "link": "https://stackoverflow.com/questions/35211120/haskell-need-help-designing-this-function", "closed_reason": "Needs details or clarity", "title": "Haskell: Need Help Designing this Function", "body": "<p>I am trying to design a function that when given a string the function inserts a's and b's into the string. </p>\n\n<p>For example:</p>\n\n<p>Given the string <code>\"Hello\"</code></p>\n\n<p>The function would return <code>\"aHbealblaob\"</code>.</p>\n"}, {"tags": ["haskell", "quickcheck"], "answers": [{"comments": [{"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1454628307, "post_id": 35212174, "comment_id": 58142507, "body": "I didn&#39;t know about <a href=\"https://wiki.haskell.org/GHC/Type_families\" rel=\"nofollow noreferrer\">type families</a>!  You are right in that I only want specific instances of Sized, so the first approach does the trick.  Thank you."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1454622571, "last_edit_date": 1454622571, "creation_date": 1454622066, "answer_id": 35212174, "question_id": 35211058, "link": "https://stackoverflow.com/questions/35211058/generating-arbitrary-jointlist-with-concrete-types/35212174#35212174", "title": "Generating arbitrary `JointList` with concrete types", "body": "<p>I suspect that rather than supporting producing random lists annotated by user-chosen instances of <code>Sized</code>, you really intended just to support producing random lists annotated by the specific type <code>Size</code>. You can modify your <code>Arbitrary</code> instance declaration this way to do that:</p>\n\n<pre><code>instance (m ~ Size, Arbitrary a) =&gt; Arbitrary (JoinList m a) where\n    -- as before\n</code></pre>\n\n<p>You will want to declare the obvious <code>Monoid</code> instance for <code>Size</code>:</p>\n\n<pre><code>instance Monoid Size where\n    mempty  = 0\n    mappend = (+)\n</code></pre>\n\n<p>You can skip declaring the <code>Sized</code> class entirely.</p>\n\n<p>Alternately, if you really did intend to produce random lists annotated by user-chosen instances, then you need the <code>Sized</code> class to provide a way to <em>produce</em> annotations, rather than consuming them as the class currently provides. Thus, for example:</p>\n\n<pre><code>class Sized a where size :: Int -&gt; a\ninstance Sized Size where size = Size\n</code></pre>\n\n<p>Then the <code>Arbitrary</code> instance declaration would remain the same, but would replace <code>Size</code> with <code>size</code> in the production for <code>Single</code>.</p>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 35212174, "answer_count": 1, "score": 1, "last_activity_date": 1454622571, "creation_date": 1454617979, "question_id": 35211058, "link": "https://stackoverflow.com/questions/35211058/generating-arbitrary-jointlist-with-concrete-types", "title": "Generating arbitrary `JointList` with concrete types", "body": "<p>I am writing tests for one of the exercises of <a href=\"http://www.seas.upenn.edu/~cis194/spring13/lectures/07-folds-monoids.html\" rel=\"nofollow\">this course homework</a>.</p>\n\n<p>In this homework the following data type is defined:</p>\n\n<pre><code>data JoinList m a = Empty\n              | Single m a\n              | Append m (JoinList m a) (JoinList m a)\n              deriving (Eq, Show)\n</code></pre>\n\n<p>To carry out the tests, I would like to generate random <code>JointList</code> elements using <code>QuickCheck</code>, in such a way that <code>m</code> is a <code>Monoid</code> that carries information about the number of elements in the list. This is, I would like to define <code>arbitrary</code> as follows:</p>\n\n<pre><code>instance (Sized m0, Monoid m0, Arbitrary a0) =&gt; \n    (Arbitrary (JoinList m0 a0)) where\n  arbitrary = oneof [ return Empty\n                    , liftM (Single (Size 1)) arbitrary\n                    , liftM2 (doAppend) arbitrary arbitrary\n                    ]\n              where doAppend jxs jys = Append (tag jxs &lt;&gt; tag jys) jxs jys\n</code></pre>\n\n<p>where <code>&lt;&gt;</code> is defined as the sum of the sizes of the two operands, and the <code>Sized</code> class is defined as follows:</p>\n\n<pre><code>newtype Size = Size Int\n    deriving (Eq, Ord, Show, Num)\n\nclass Sized a where\n  size :: a -&gt; Size\n</code></pre>\n\n<p>However, this results in the following compiler error:</p>\n\n<pre><code>Couldn't match expected type \u2018m0\u2019 with actual type \u2018Size\u2019\n  \u2018m0\u2019 is a rigid type variable bound by\n       the instance declaration at test/Spec.hs:35:10\nRelevant bindings include\n  arbitrary :: Gen (JoinList m0 a0) (bound at test/Spec.hs:36:3)\nIn the first argument of \u2018Single\u2019, namely \u2018(Size 1)\u2019\nIn the first argument of \u2018liftM\u2019, namely \u2018(Single (Size 1))\u2019\n</code></pre>\n\n<p>Is there a way to achieve this?</p>\n"}, {"tags": ["haskell", "types", "dsl", "existential-type", "gadt"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454619907, "post_id": 35211027, "comment_id": 58138356, "body": "Not like that, but you can use Template Haskell to make some custom syntax. Warning: not for the faint of heart. Alternatively, there are some tricks you can play with classes to make heterogeneous lists easier to write (the <code>HList</code> package has such a thing). This will look pretty, but your error messages will be scary."}], "answers": [{"comments": [{"owner": {"reputation": 705, "user_id": 1121705, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c723ca9f7ba138b9df58d93e100d7146?s=128&d=identicon&r=PG", "display_name": "Brandon Ogle", "link": "https://stackoverflow.com/users/1121705/brandon-ogle"}, "edited": false, "score": 0, "creation_date": 1454619489, "post_id": 35211414, "comment_id": 58138138, "body": "I want to at some point include type guarantees that the query isn&#39;t going to generate something strange. For instance I dont want to allow operations like <code>select [&quot;this&quot;, sum &quot;that&quot;] $ from &quot;tbl&quot;</code> as this is selecting a single value and a vector, while I would allow <code>select [&quot;this&quot; `add` (sum &quot;that&quot;)] $ from &quot;tbl&quot;</code>"}], "tags": [], "owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "is_accepted": false, "score": 0, "last_activity_date": 1454619192, "creation_date": 1454619192, "answer_id": 35211414, "question_id": 35211027, "link": "https://stackoverflow.com/questions/35211027/heterogeneous-list-for-a-dsl/35211414#35211414", "title": "Heterogeneous List for a DSL", "body": "<p>No, proper heterogeneous lists are impossible in Haskell. You will always need some sort of constructor. However, there might be another solution to your problem. You could redefine your combinators to return <code>String</code>s instead of <code>Column</code>s. Something like this, perhaps.</p>\n\n<pre><code>infixl 5 `add`\nadd :: String -&gt; String -&gt; String\nadd a b = a ++ \" + \" ++ b\n\ninfix 2 &lt;~ \n(&lt;~) :: String -&gt; String -&gt; String\nnew &lt;~ old = old ++ \" as \" ++ new\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 705, "user_id": 1121705, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c723ca9f7ba138b9df58d93e100d7146?s=128&d=identicon&r=PG", "display_name": "Brandon Ogle", "link": "https://stackoverflow.com/users/1121705/brandon-ogle"}, "edited": false, "score": 0, "creation_date": 1454622847, "post_id": 35211689, "comment_id": 58139972, "body": "This seems to be exactly what I needed"}], "tags": [], "owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "is_accepted": true, "score": 2, "last_activity_date": 1454629223, "last_edit_date": 1454629223, "creation_date": 1454620245, "answer_id": 35211689, "question_id": 35211027, "link": "https://stackoverflow.com/questions/35211027/heterogeneous-list-for-a-dsl/35211689#35211689", "title": "Heterogeneous List for a DSL", "body": "<p>GHC has an extension for cases just like this one: <code>OverloadedStrings</code>. The basic idea behind OverloadedStrings is that string literals can be any type which implement the <code>Data.String.IsString</code> typeclass. So for your code, you could do something like this.</p>\n\n<pre><code>import Data.String\n\nnewtype Column = Column String\n\ninstance IsString Column where\n  fromString = Column\n</code></pre>\n\n<p>And then define your combinators as you were. Now, the bare string literals you want will be interpreted as <code>Columns</code>.</p>\n\n<pre><code>Main*&gt; :t [\"those\" &lt;~ \"this\" `and` \"that\", \"thing\"]\n[\"those\" &lt;~ \"this\" `and` \"that\", \"thing\"] :: [Column]\n</code></pre>\n"}], "owner": {"reputation": 705, "user_id": 1121705, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c723ca9f7ba138b9df58d93e100d7146?s=128&d=identicon&r=PG", "display_name": "Brandon Ogle", "link": "https://stackoverflow.com/users/1121705/brandon-ogle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 35211689, "answer_count": 2, "score": 0, "last_activity_date": 1454629223, "creation_date": 1454617854, "question_id": 35211027, "link": "https://stackoverflow.com/questions/35211027/heterogeneous-list-for-a-dsl", "title": "Heterogeneous List for a DSL", "body": "<p><strong>TL;DR</strong> </p>\n\n<p>is their a way I can construct a heterogenous list constrained to some typeclass, without calling a constructor on each element?</p>\n\n<hr>\n\n<p>I finally have the opportunity to take a deeper dive into Haskell, and I am trying to build a DSL that generates a query string for a SQL like language. The following is pseudo code for what I am trying to attempt, these types will be more refined once I have a better idea of how to approach this. Please excuse the vagueness.</p>\n\n<p>The desired syntax for my dsl is something like</p>\n\n<pre><code>from :: String -&gt; Query\nselect :: [String] -&gt; Query -&gt; Query\nselect [\"this\", \"that\"] $ from \"tbl\"\n</code></pre>\n\n<p>The trouble is that I would also like to allow for things like Column arithmetic and logical operators in the argument to select. For example</p>\n\n<pre><code>(&lt;~) :: String -&gt; Column -&gt; Column -- used for assigning a new name\nadd  :: String -&gt; String -&gt; Column\n\nselect [\"stuff\" &lt;~ \"this\" `add` \"that\", \"this\"] $ from \"tbl\"\n</code></pre>\n\n<p>the output of which could be something like</p>\n\n<pre><code>SELECT \n    this + that as stuff, \n    this\nFROM tbl;\n</code></pre>\n\n<p>The obvious problem is that this requires a heterogeneous list. I could create a new data type to wrap up these values and go on with my life, but I think the result is much more cumbersome</p>\n\n<pre><code>select [\"stuff\" &lt;~ (Column \"this\") `add` (Column \"that\"), Column \"this\", Column \"that\"] $ from \"tbl\"\n</code></pre>\n\n<p>I have seen some tricks using GADT's and Existentials but they all require wraping each value in a constructor while I stubbornly want my strings as is. Is it possible??</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1454609547, "post_id": 35208487, "comment_id": 58132193, "body": "So, for example, <code>(+3)</code> is the same as <code>(\\x -&gt; x + 3)</code>."}, {"owner": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1454610596, "post_id": 35208487, "comment_id": 58132879, "body": "Added a lambda version to my examples"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 3, "creation_date": 1454611781, "post_id": 35208487, "comment_id": 58133632, "body": "One could ad for a newbie that there is one and only one exception to the rule: <code>(-n)</code> is not a section, but the sme as <code>negate n</code>"}, {"owner": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "edited": false, "score": 0, "creation_date": 1454615240, "post_id": 35208487, "comment_id": 58135662, "body": "added a section on <code>(-n)</code> and <code>subtract</code>"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1454615950, "post_id": 35208487, "comment_id": 58136083, "body": "<code>subtract</code> is quite a long word that I am too lazy to type. I generally just write <code>(+(-x))</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454624744, "post_id": 35208487, "comment_id": 58140881, "body": "I sometimes wish I could make arbitrary expressions infix, which would allow <code>(`(-)` n)</code>."}], "tags": [], "owner": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "is_accepted": true, "score": 7, "last_activity_date": 1454615133, "last_edit_date": 1454615133, "creation_date": 1454609503, "answer_id": 35208487, "question_id": 35208137, "link": "https://stackoverflow.com/questions/35208137/starting-with-haskell/35208487#35208487", "title": "Starting with Haskell", "body": "<p>Haskell has \"operator slicing\":  if you omit one or both of the arguments to an operator, Haskell automatically turns it into a function for you.</p>\n\n<p>Specifically, <code>(+3)</code> is missing the first argument (Haskell has no unary <code>+</code>).  So, Haskell makes that expression into a function that takes the missing argument, and returns the input value plus 3:</p>\n\n<pre><code>-- all the following functions are the same\nf1 x = x + 3\nf2 = (+3)\nf3 = \\ x -&gt; x + 3\n</code></pre>\n\n<p>Similarly, if you omit both arguments, Haskell turns it into a function with two (curried) arguments:</p>\n\n<pre><code>-- all the following functions are the same\ng1 x y = x + y\ng2 = (+)\ng3 = \\ x y -&gt; x + y\n</code></pre>\n\n<p>From comments:  note that Haskell <em>does</em> have unary <code>-</code>.  So, <code>(-n)</code> is not an operator slice, it just evaluates the negative (same as <code>negate n</code>).</p>\n\n<p>If you want to slice binary <code>-</code> the way you do <code>+</code>, you can use <code>(subtract n)</code> instead:</p>\n\n<pre><code>-- all the following functions are the same\nh1 x = x - 3\nh2 = subtract 3\nh3 = \\ x -&gt; x - 3\n</code></pre>\n"}], "owner": {"reputation": 285, "user_id": 5009585, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1027230390635433/picture?type=large", "display_name": "Jose Maria Landa", "link": "https://stackoverflow.com/users/5009585/jose-maria-landa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 35208487, "answer_count": 1, "score": 2, "last_activity_date": 1454615133, "creation_date": 1454608401, "last_edit_date": 1454609499, "question_id": 35208137, "link": "https://stackoverflow.com/questions/35208137/starting-with-haskell", "title": "Starting with Haskell", "body": "<p>Can someone explain to me whats going on in this function?</p>\n\n<pre><code>applyTwice :: (a -&gt; a) -&gt; a -&gt; a\napplyTwice f x = f (f x)\n</code></pre>\n\n<p>I do understand what curried functions are, this could be re-written like this:</p>\n\n<pre><code>applyTwice :: ((a -&gt; a) -&gt; (a -&gt; (a)))\napplyTwice f x = f (f x)\n</code></pre>\n\n<p>However I dont fully understand the <code>(+3)</code> operator and how it works. Maybe it's something really stupid but I can't figure it out. \nCan someone explain step by step how the function works? Thanks =)</p>\n\n<pre><code>applyTwice :: ((a -&gt; a) -&gt; (a -&gt; (a)))\napplyTwice f x = f (f x)\n</code></pre>\n"}, {"tags": ["haskell", "aeson"], "comments": [{"owner": {"reputation": 2332, "user_id": 615030, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Yd1uW.png?s=128&g=1", "display_name": "Artyom", "link": "https://stackoverflow.com/users/615030/artyom"}, "edited": false, "score": 1, "creation_date": 1454599809, "post_id": 35204046, "comment_id": 58125670, "body": "What&#39;s your version of vector? (You can determine it by doing <code>cabal info vector | grep installed</code>.) If it&#39;s lower than 0.10.12.0, I guess that&#39;s the problem (in which case you&#39;ll have to replace <code>fromList</code> with <code>Vector.fromList</code> and <code>HashMap.fromList</code> respectively)."}, {"owner": {"reputation": 111, "user_id": 2197402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nN3u0.jpg?s=128&g=1", "display_name": "Jonny Appleseed", "link": "https://stackoverflow.com/users/2197402/jonny-appleseed"}, "reply_to_user": {"reputation": 2332, "user_id": 615030, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Yd1uW.png?s=128&g=1", "display_name": "Artyom", "link": "https://stackoverflow.com/users/615030/artyom"}, "edited": false, "score": 0, "creation_date": 1454675119, "post_id": 35204046, "comment_id": 58162286, "body": "That works! I&#39;ve edited the post with the updates."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1457038758, "post_id": 35204046, "comment_id": 59237141, "body": "@JonnyAppleseed if you found a solution, you should post it as an answer and accept it, rather than just update the post. That way this doesn&#39;t linger as an unanswered question..."}], "owner": {"reputation": 111, "user_id": 2197402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nN3u0.jpg?s=128&g=1", "display_name": "Jonny Appleseed", "link": "https://stackoverflow.com/users/2197402/jonny-appleseed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1454675027, "creation_date": 1454597108, "last_edit_date": 1454675027, "question_id": 35204046, "link": "https://stackoverflow.com/questions/35204046/having-trouble-generating-arbitrary-json-with-haskells-aeson-package", "title": "Having trouble generating arbitrary json with Haskell&#39;s Aeson package", "body": "<p>I'm a Haskell newb, having only just finished reading <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow\">LYAH</a>. I am reading <a href=\"https://artyom.me/aeson\" rel=\"nofollow\">this Aeson tutorial</a>, but I'm having trouble executing most of the code examples. For instance, I have the following in Scratch01.hs ...</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nmodule Scratch01 where\n\nimport Data.Aeson\nimport GHC.Exts\n\nval :: Value\nval = Object $ fromList [\n  (\"numbers\", Array $ fromList [Number 1, Number 2, Number 3]),\n  (\"boolean\", Bool True) ]\n</code></pre>\n\n<p>... and I'm trying to execute it like this</p>\n\n<pre><code>$ ghci --version\nThe Glorious Glasgow Haskell Compilation System, version 7.8.3\n$ ghci -XOverloadedStrings\nGHCi, version 7.8.3: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; :load Scratch01.hs\n[1 of 1] Compiling Scratch01        ( Scratch01.hs, interpreted )\n\nScratch01.hs:10:3:\n    Couldn't match expected type \u2018Item Object\u2019\n                with actual type \u2018(t0, Value)\u2019\n    The type variable \u2018t0\u2019 is ambiguous\n    In the expression:\n      (\"numbers\", Array $ fromList [Number 1, Number 2, Number 3])\n    In the first argument of \u2018fromList\u2019, namely\n      \u2018[(\"numbers\", Array $ fromList [Number 1, Number 2, ....]),\n        (\"boolean\", Bool True)]\u2019\n    In the second argument of \u2018($)\u2019, namely\n      \u2018fromList\n         [(\"numbers\", Array $ fromList [Number 1, Number 2, ....]),\n          (\"boolean\", Bool True)]\u2019\n\nScratch01.hs:10:33:\n    Couldn't match expected type \u2018Item Array\u2019 with actual type \u2018Value\u2019\n    In the expression: Number 1\n    In the first argument of \u2018fromList\u2019, namely\n      \u2018[Number 1, Number 2, Number 3]\u2019\nFailed, modules loaded: none.\nPrelude&gt;\n</code></pre>\n\n<p>I've been tinkering with the types for a bit, but I'm stumped. Am I using the wrong version of GHC or something?</p>\n\n<h3>Edit</h3>\n\n<p>I did what artyom suggested. This works:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nmodule Scratch01 where\n\nimport Data.Aeson\nimport qualified Data.HashMap.Lazy as HM\nimport qualified Data.Vector as V\n\nval :: Value\nval = Object $ HM.fromList [\n  (\"numbers\", Array $ V.fromList [Number 1, Number 2, Number 3]),\n  (\"boolean\", Bool True) ]\n</code></pre>\n"}, {"tags": ["haskell", "aeson"], "comments": [{"owner": {"reputation": 764, "user_id": 3529754, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a8311cc9fdf0e052da7367ae79775c1c?s=128&d=identicon&r=PG&f=1", "display_name": "bash0r", "link": "https://stackoverflow.com/users/3529754/bash0r"}, "edited": false, "score": 0, "creation_date": 1454590395, "post_id": 35201374, "comment_id": 58118862, "body": "Could you please post a self contained code snippets or at least some signatures? It is impossible to read haskell without signatures at hand. And as far as I can see you&#39;re trying to do IO during conversion to JSON?"}], "answers": [{"tags": [], "owner": {"reputation": 180, "user_id": 870558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61e041c1f9172c385e6e460380124732?s=128&d=identicon&r=PG", "display_name": "Narvius", "link": "https://stackoverflow.com/users/870558/narvius"}, "is_accepted": true, "score": 2, "last_activity_date": 1454591684, "last_edit_date": 1454591684, "creation_date": 1454591358, "answer_id": 35201870, "question_id": 35201374, "link": "https://stackoverflow.com/questions/35201374/unsure-how-to-assign-monadic-value-to-aeson-pair/35201870#35201870", "title": "Unsure how to assign monadic value to Aeson pair", "body": "<p>I'm assuming you're working with a monad stack with <code>IO</code> at the bottom.</p>\n\n<p><code>object</code> takes <code>[Pair]</code> as argument, however you're trying to pass it an <code>IO</code>. <code>(&gt;&gt;=)</code> keeps things <em>inside</em> the monad (by definition!), so <code>(&gt;&gt;= id)</code> does not do what you want it to (in fact, the signature of <code>(&gt;&gt;= id)</code> is <code>Monad m =&gt; m (m a) -&gt; m a</code>, ergo <code>join</code>). You want to move things around a bit:</p>\n\n<pre><code>Just b -&gt; do\n      expenditures &lt;- forM categories (\\x -&gt; do\n          spent &lt;- liftIO $ calculateCategoryBalanceForMonth (entityKey x) 1\n          return $ object [ \"spent\" .= spent ])\n      json $ object [ \"categoryExpenditures\" .= expenditures ]\n</code></pre>\n\n<p>For mapping with a monadic result, use <code>mapM</code>, or <code>forM</code> (<code>forM = flip mapM</code>). </p>\n"}], "owner": {"reputation": 170, "user_id": 383249, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AQGFX.jpg?s=128&g=1", "display_name": "acrognale", "link": "https://stackoverflow.com/users/383249/acrognale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 1, "accepted_answer_id": 35201870, "answer_count": 1, "score": 0, "last_activity_date": 1454591684, "creation_date": 1454589883, "question_id": 35201374, "link": "https://stackoverflow.com/questions/35201374/unsure-how-to-assign-monadic-value-to-aeson-pair", "title": "Unsure how to assign monadic value to Aeson pair", "body": "<p>Consider the following code:</p>\n\n<pre><code>    S.get \"/budget/:bid/month/:mnth\" $ do\n      mbid &lt;- param \"bid\"\n      (budget :: Maybe Budget) &lt;- liftIO $ getBudget $ toSqlKey mbid\n      (categories :: [Entity Category]) &lt;- liftIO $ getCategories $ toSqlKey mbid\n      case budget of \n        Nothing -&gt; json $ object [ \"message\" .= (\"No budget was found!\" :: String) ]\n        Just b -&gt; do\n          json $ object [\n              \"categoryExpenditures\" .= map (\\x -&gt; object [\"spent\" .= liftIO $ \n                calculateCategoryBalanceForMonth (entityKey x) 1 &gt;&gt;= (\\y -&gt; y) ]) categories\n            ]\n</code></pre>\n\n<p>Up until this point, <code>calculateCategoryBalanceForMonth</code> has type <code>calculateCategoryBalanceForMonth :: CategoryId -&gt; Int -&gt; IO Double</code>. </p>\n\n<p>I am attempting to map over <code>categories</code> and return a list of <code>categoryExpenditures</code> as a JSON object in Aeson. However, I cannot figure out how to return the value from <code>liftIO</code> to the <code>.=</code> operator.</p>\n\n<p>My attempt involved desugaring the assignment operator to <code>&gt;&gt;= (\\y -&gt; y)</code> or <code>&gt;&gt;= id</code> where I was hoping <code>id</code> would return a Double, or at least something that had an instance of <code>ToJSON</code>. This does not appear to be the case though.</p>\n\n<p>I also know that using the assignment operator for the <code>liftIO</code> expression, and then passing the assigned variable into the <code>.=</code> operator works, however I was unsure how to use the assignment operator within an anonymous function for map.</p>\n\n<p>What might I be doing wrong? Is any more clarity needed?</p>\n"}, {"tags": ["variables", "haskell", "immutability", "assign"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454583369, "post_id": 35198897, "comment_id": 58114367, "body": "I like to think <i>pull a value out</i> if I see it ^^"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1454588298, "post_id": 35198897, "comment_id": 58117547, "body": "&quot;But I can still use &quot;let&quot; to assign something else to this name.&quot; - precisely, you can assign to the <i>name</i>, not the value. This does not correspond to mutation in any way. Calling <code>c</code> a variable is fine - its value does indeed vary."}], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454583502, "post_id": 35199009, "comment_id": 58114458, "body": "IMO it&#39;s better to write <code>[c  | c &lt;- x ] = do c &lt;- x \\n return c</code> (where in the comment I cannot write the newline/indentation - but I hope you get it)"}, {"owner": {"reputation": 764, "user_id": 3529754, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a8311cc9fdf0e052da7367ae79775c1c?s=128&d=identicon&r=PG&f=1", "display_name": "bash0r", "link": "https://stackoverflow.com/users/3529754/bash0r"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454583589, "post_id": 35199009, "comment_id": 58114520, "body": "@Carsten Yes I know what you mean. I&#39;ll change it. But I&#39;ll have to admit that I don&#39;t use list comprehensions."}], "tags": [], "owner": {"reputation": 764, "user_id": 3529754, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a8311cc9fdf0e052da7367ae79775c1c?s=128&d=identicon&r=PG&f=1", "display_name": "bash0r", "link": "https://stackoverflow.com/users/3529754/bash0r"}, "is_accepted": false, "score": 4, "last_activity_date": 1454583634, "last_edit_date": 1454583634, "creation_date": 1454582897, "answer_id": 35199009, "question_id": 35198897, "link": "https://stackoverflow.com/questions/35198897/does-mean-assigning-a-variable-in-haskell/35199009#35199009", "title": "Does &quot;&lt;-&quot; mean assigning a variable in Haskell?", "body": "<p>It's referring to the monadic bind operator <code>&gt;&gt;=</code>. You just don't need to explicitly write a lambda as right hand side parameter. The list comprension will be compiled down to the monadic actions defined. And by that it means exactly the same as in a monadic environment.</p>\n\n<p>In fact you can replace the list comprension with a simple call to <code>filter</code>:</p>\n\n<pre><code>filter (`elem` ['A' .. 'Z']) x\n</code></pre>\n\n<p>To answer your question regarding the <code>&lt;-</code> syntactic structure a bit clearer:</p>\n\n<pre><code>[c| c &lt;- x]\n</code></pre>\n\n<p>is the same as</p>\n\n<pre><code>do c &lt;- x\n   return c\n</code></pre>\n\n<p>is the same as</p>\n\n<pre><code>x &gt;&gt;= \\c -&gt; return c\n</code></pre>\n\n<p>is the same as</p>\n\n<pre><code>x &gt;&gt;= return\n</code></pre>\n\n<p>Consider the official documentation of Haskell for further reading: <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Monad.html#v:-62--62--61-\" rel=\"nofollow\">https://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Monad.html#v:-62--62--61-</a></p>\n"}, {"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 2, "last_activity_date": 1454583458, "creation_date": 1454583458, "answer_id": 35199223, "question_id": 35198897, "link": "https://stackoverflow.com/questions/35198897/does-mean-assigning-a-variable-in-haskell/35199223#35199223", "title": "Does &quot;&lt;-&quot; mean assigning a variable in Haskell?", "body": "<pre><code>[c|c&lt;-x, c `elem` ['A'..'Z']]\n</code></pre>\n\n<p>is a <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-420003.11\" rel=\"nofollow\">list comprehension</a>, and <code>c &lt;- x</code> is a generator where <code>c</code> is a pattern to be matched from the elements of the list <code>x</code>. <code>c</code> is a pattern which is successively bound to the elements of the input list <code>x</code> which are <code>a</code>, <code>s</code>, <code>e</code>, <code>u</code>, ... when you evaluate <code>removeLower \"aseruiiUIUIdkf\"</code>.</p>\n\n<pre><code>c `elem` ['A'..'Z']\n</code></pre>\n\n<p>is a predicate which is applied to each successive binding of <code>c</code> inside the comprehension and an element of the input only appears in the output list if it passes this predicate.</p>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 7, "last_activity_date": 1454623351, "last_edit_date": 1454623351, "creation_date": 1454622153, "answer_id": 35212198, "question_id": 35198897, "link": "https://stackoverflow.com/questions/35198897/does-mean-assigning-a-variable-in-haskell/35212198#35212198", "title": "Does &quot;&lt;-&quot; mean assigning a variable in Haskell?", "body": "<p>If you're familiar with C, think of the distinction between <em>declaring</em> a variable and <em>assigning</em> a value to it.  For example, you can declare a variable on its own and later assign to it:</p>\n\n<pre><code>int i;\ni = 7;\n</code></pre>\n\n<p>Or you can declare a variable and assign initial value at the same time:</p>\n\n<pre><code>int i = 7;\n</code></pre>\n\n<p>And in either case, you can <strong>mutate</strong> the value of a variable by assigning to it once more after the first initialization or assignment:</p>\n\n<pre><code>int i = 7;  // Declaration and initial assignment\ni = 5;      // Mutation\n</code></pre>\n\n<p>Assignment in Haskell works exclusively like the second example\u2014declaration with initialization:</p>\n\n<ol>\n<li>You declare a variable;</li>\n<li>Haskell doesn't allow uninitialized variables, so you are required to supply a value in the declaration;</li>\n<li>There's no mutation, so the value given in the declaration will be the only value for that variable throughout its <a href=\"https://en.wikipedia.org/wiki/Scope_(computer_science)\" rel=\"noreferrer\"><strong>scope</strong></a>.</li>\n</ol>\n\n<p>I bolded and hyperlinked \"scope\" because it's the second critical component here.  This goes one of your questions:</p>\n\n<blockquote>\n  <p>\u201cremoveLower\" is an immutable? Even it's a function object?  But I can still use \"let\" to assign something else to this name.</p>\n</blockquote>\n\n<p>After you bind <code>removeLower</code> to the function you define in your example, the name <code>removeLower</code> will always refer to that function <strong>within the scope of that definition</strong>.  This is easy to demonstrate in the interpreter.  First, let's define a function <code>foo</code>:</p>\n\n<pre><code>Prelude&gt; let foo x = x + 2\nPrelude&gt; foo 4\n6\n</code></pre>\n\n<p>Now we define an <code>bar</code> that uses <code>foo</code>:</p>\n\n<pre><code>Prelude&gt; let bar x = foo (foo x)\nPrelude&gt; bar 4\n8\n</code></pre>\n\n<p>And now we \"redefine\" <code>foo</code> to something different:</p>\n\n<pre><code>Prelude&gt; let foo x = x + 3\nPrelude&gt; foo 4\n7\n</code></pre>\n\n<p>Now what do you think happens to <code>bar</code>?</p>\n\n<pre><code>Prelude&gt; bar 4\n8\n</code></pre>\n\n<p>It remains the same!  Because the \"redefinition\" of <code>foo</code> doesn't <strong>mutate</strong> anything\u2014it just says that, <strong>in the new scope created by the \"redefinition\"</strong>, the name <code>foo</code> stands for the function that adds three.  The definition of <code>bar</code> was made in the earlier scope where <code>foo x = x + 2</code>, so that's the meaning that the name <code>foo</code> has in that definition of <code>bar</code>.  The original value of <code>foo</code> was not destroyed or mutated by the \"redefinition.\"</p>\n\n<p>In a Haskell program as much as in a C program, the same name can still refer to different values in different scopes of the program.  This is what makes \"variables\" variable.  The difference is that in Haskell you can never mutate the value of a variable within one scope.  You can <strong>shadow</strong> a definition, however\u2014uses of a variable will refer to the \"nearest\" definition of that name in some sense.  (In the case of the interpreter, the most recent <code>let</code> declaration for that variable.)</p>\n\n<hr>\n\n<p>Now, with that out of the way, here are the syntaxes that exist in Haskell for <em>variable binding</em> (\"assignment\").  First, there's top-level declarations in a module:</p>\n\n<pre><code>module MyLibrary (addTwo) where\n\naddTwo :: Int -&gt; Int\naddTwo x = x + 2\n</code></pre>\n\n<p>Here the name <code>addTwo</code> is declared with the given function as its value.  A top level declaration can have private, auxiliary declarations in a <code>where</code> block:</p>\n\n<pre><code>addSquares :: Integer -&gt; Integer\naddSquares x y = squareOfX + squareOfY\n  where square z = z * z\n        squareOfX = square x\n        squareOfY = square y\n</code></pre>\n\n<p>Then there's the <code>let ... in ...</code> expression, that allows you to declare a local variable for any expression:</p>\n\n<pre><code>addSquares :: Integer -&gt; Integer\naddSquares x y = \n  let square z = z * z\n      squareOfX = square x\n      squareOfY = square y\n  in squareOfX + squareOfY\n</code></pre>\n\n<p>Then there's the <code>do</code>-notation that has its own syntax for declaring variables:</p>\n\n<pre><code>example :: IO ()\nexample = do\n  putStrLn \"Enter your first name:\"\n  firstName &lt;- getLine\n\n  putStrLn \"Enter your lasst name:\"\n  lastName &lt;- getLine\n\n  let fullName = firstName ++ \" \" ++ lastName\n  putStrLn (\"Hello, \" ++ fullName ++ \"!\")\n</code></pre>\n\n<p>The <code>var &lt;- action</code> assigns a value that is produced by an <em>action</em> (e.g., reading a line from standard input), while <code>let var = expr</code> assigns a value that is produced by a <em>function</em> (e.g., concatenating some strings).  Note that the <code>let</code> in a <code>do</code> block is not the same thing as the <code>let ... in ...</code> from above!</p>\n\n<p>And finally, in list comprehension you get the same assignment syntax as in <code>do</code>-notation.</p>\n"}], "owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8025, "favorite_count": 1, "answer_count": 3, "score": 6, "last_activity_date": 1454623351, "creation_date": 1454582625, "question_id": 35198897, "link": "https://stackoverflow.com/questions/35198897/does-mean-assigning-a-variable-in-haskell", "title": "Does &quot;&lt;-&quot; mean assigning a variable in Haskell?", "body": "<p>Just started Haskell, it's said that everything in Haskell is \"immutable\" except IO package. So when I bind a name to something, it's always something immutable? Question, like below:</p>\n\n<pre><code>Prelude&gt; let removeLower x=[c|c&lt;-x, c `elem` ['A'..'Z']]\nPrelude&gt; removeLower \"aseruiiUIUIdkf\"\n\"UIUI\"\n</code></pre>\n\n<p>So here:</p>\n\n<pre><code>1. \u201cremoveLower\" is an immutable? Even it's a function object?\nBut I can still use \"let\" to assign something else to this name.\n\n2. inside the function \"c&lt;-x\" seems that \"c\" is a variable.\nIt is assigned by list x's values.\n</code></pre>\n\n<p>I'm using the word \"variable\" from C language, not sure how Haskell name all its names?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell", "null"], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 12, "creation_date": 1454585392, "post_id": 35198713, "comment_id": 58115672, "body": "Please <a href=\"http://blog.jle.im/entry/io-monad-considered-harmful\" rel=\"nofollow noreferrer\">avoid introducing every type which happens to have a <code>Monad</code> instance as \u201cthe X monad\u201d</a>, especially to beginners. (And, <code>Maybe a</code> is not a monad, <code>Maybe</code> is.)"}, {"owner": {"reputation": 764, "user_id": 3529754, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a8311cc9fdf0e052da7367ae79775c1c?s=128&d=identicon&r=PG&f=1", "display_name": "bash0r", "link": "https://stackoverflow.com/users/3529754/bash0r"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1454594331, "post_id": 35198713, "comment_id": 58121576, "body": "@leftaroundabout Oh wow cool. I&#39;ve actually learned something today. :D"}], "tags": [], "owner": {"reputation": 764, "user_id": 3529754, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a8311cc9fdf0e052da7367ae79775c1c?s=128&d=identicon&r=PG&f=1", "display_name": "bash0r", "link": "https://stackoverflow.com/users/3529754/bash0r"}, "is_accepted": false, "score": 9, "last_activity_date": 1454593943, "last_edit_date": 1454593943, "creation_date": 1454582198, "answer_id": 35198713, "question_id": 35198674, "link": "https://stackoverflow.com/questions/35198674/can-i-declare-a-null-value-in-haskell/35198713#35198713", "title": "Can I declare a NULL value in Haskell?", "body": "<p>There is no null in Haskell. What you want is the <code>Maybe</code> monad.</p>\n\n<pre><code>data Maybe a\n    = Just a\n    | Nothing\n</code></pre>\n\n<p><code>Nothing</code> refers to classic null and <code>Just</code> contains a value.</p>\n\n<p>You can then pattern match against it:</p>\n\n<pre><code>foo Nothing  = Nothing\nfoo (Just a) = Just (a * 10)\n</code></pre>\n\n<p>Or with <code>case</code> syntax:</p>\n\n<pre><code>let m = Just 10\n in case m of\n      Just v  -&gt; print v\n      Nothing -&gt; putStrLn \"Sorry, there's no value. :(\"\n</code></pre>\n\n<p>Or use the supperior functionality provided by the typeclass instances for <code>Functor</code>, <code>Applicative</code>, <code>Alternative</code>, <code>Monad</code>, <code>MonadPlus</code> and <code>Foldable</code>.</p>\n\n<p>This could then look like this:</p>\n\n<pre><code>foo :: Maybe Int -&gt; Maybe Int -&gt; Maybe Int\nfoo x y = do\n  a &lt;- x\n  b &lt;- y\n  return $ a + b\n</code></pre>\n\n<p>You can even use the more general signature:</p>\n\n<pre><code>foo :: (Monad m, Num a) =&gt; m a -&gt; m a -&gt; m a\n</code></pre>\n\n<p>Which makes this function work for ANY data type that is capable of the functionality provided by <code>Monad</code>. So you can use <code>foo</code> with <code>(Num a) =&gt; Maybe a</code>, <code>(Num a) =&gt; [a]</code>, <code>(Num a) =&gt; Either e a</code> and so on.</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1454647077, "post_id": 35199654, "comment_id": 58147919, "body": "Beautiful. For some reason, until this moment I had not meditated on how the inability to check for bottoms means that nobody tries to check for bottoms, and what that means for its parallels to Java&#39;s <code>null</code>. Thank you for this insight."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 13, "last_activity_date": 1454585648, "last_edit_date": 1454585648, "creation_date": 1454584820, "answer_id": 35199654, "question_id": 35198674, "link": "https://stackoverflow.com/questions/35198674/can-i-declare-a-null-value-in-haskell/35199654#35199654", "title": "Can I declare a NULL value in Haskell?", "body": "<p>There <em>is</em> a &ldquo;null&rdquo; value that you can use for variables of any type. It's called \u27c2 (pronounced <em>bottom</em>). We don't need a keyword to produce bottom values; actually \u27c2 is the value of any computation which doesn't terminate. For instance,</p>\n\n<pre><code>bottom = let x = x in x   -- or simply `bottom = bottom`\n</code></pre>\n\n<p>will infinitely loop. It's obviously not a good idea to do this deliberately, however you can use <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:undefined\"><code>undefined</code></a> as a &ldquo;standard bottom value&rdquo;. It's perhaps the closest thing Haskell has to Java's <code>null</code> keyword.</p>\n\n<p>But you definitely shouldn't/can't use this for most of the applications where Java programmers would grab for <code>null</code>.</p>\n\n<ul>\n<li>Since everything in Haskell is immutable, a value that's undefined will always stay undefined. It's not possible to use this as a &ldquo;hold on a second, I'll define it later&rdquo; indication<sup>&dagger;</sup>.</li>\n<li>It's not possible to check <em>whether</em> a value is bottom or not. For <a href=\"https://en.wikipedia.org/wiki/Halting_problem\">rather deep theoretical reasons</a>, in fact. So you can't use this for values that may or may not be defined.</li>\n</ul>\n\n<p>And you know what? It's really good that Haskell does't allow this! In Java, you constantly need to be wary that values might be null. In Haskell, if a value is bottom than something is plain broken, but this will never be part of intended behaviour / something you might need to check for. If for some value it's <em>intended</em> that it might not be defined, then you must always make this explicit by wrapping the type in a <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#t:Maybe\"><code>Maybe</code></a>. By doing this, you make sure that anybody trying to use the value <em>must</em> first check whether it's there. Not possible to forget this and run into a null-reference exception at runtime!</p>\n\n<p>And because Haskell is so good at handling variant types, checking the contents of a <code>Maybe</code>-wrapped value is really not too cumbersome. You can just do it explicitly with pattern matching,</p>\n\n<pre><code>quun :: Int -&gt; String\nquun i = case computationWhichMayFail i of\n   Just j  -&gt; show j\n   Nothing -&gt; \"blearg, failed\"\n\ncomputationWhichMayFail :: Int -&gt; Maybe Int\n</code></pre>\n\n<p>or you can use the fact that <code>Maybe</code> is a functor. Indeed it is an instance of almost every specific functor class: <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#t:Functor\"><code>Functor</code></a>, <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Applicative.html#t:Applicative\"><code>Applicative</code></a>, <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Applicative.html#t:Alternative\"><code>Alternative</code></a>, <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Foldable.html#t:Foldable\"><code>Foldable</code></a>, <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Traversable.html#t:Traversable\"><code>Traversable</code></a>, <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#t:Monad\"><code>Monad</code></a>, <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Monad.html#t:MonadPlus\"><code>MonadPlus</code></a>. It also lifts <a href=\"http://hackage.haskell.org/package/Semigroup-0.0.7/docs/Data-Semigroup.html#t:Semigroup\">semigroups</a> to <a href=\"https://www.haskell.org/hoogle/?hoogle=Monoid\">monoids</a>.</p>\n\n<h2><a href=\"https://en.wikipedia.org/wiki/The_Hitchhiker&#39;s_Guide_to_the_Galaxy\">D\u1d0f\u0274'\u1d1b P\u1d00\u0274\u026a\u1d04</a> now,</h2>\n\n<p>you don't need to know what the heck these things are. But when you've learned what they do, you will be able to write very concise code that automagically handles missing values always in the right way, with zero risk of missing a check.</p>\n\n<hr>\n\n<p><sup>&dagger;</sup><sub>Because Haskell is lazy, you generally don't need to defer any calculations to be done later. The compiler will automatically see to it that the computation is done <em>when it's necessary</em>, and no sooner.</sub></p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1454585857, "creation_date": 1454585857, "answer_id": 35200003, "question_id": 35198674, "link": "https://stackoverflow.com/questions/35198674/can-i-declare-a-null-value-in-haskell/35200003#35200003", "title": "Can I declare a NULL value in Haskell?", "body": "<p>Not in Haskell (or in many other FP languages). If you have some expression of some type <code>T</code>, its evaluation will give a value of type <code>T</code>, with the following exceptions:</p>\n\n<ul>\n<li><p>infinite recursion may make the program \"loop forever\" and failing to return anything</p>\n\n<pre><code>let f n = f (n+1) in f 0\n</code></pre></li>\n<li><p>runtime errors can abort the program early, e.g.:</p>\n\n<ul>\n<li>division by zero, square root of negative, and other numerical errors</li>\n<li><code>head []</code>, <code>fromJust Nothing</code>, and other partial functions used on invalid inputs</li>\n<li>explicit calls to <code>undefined</code>, <code>error \"message\"</code>, or other exception-throwing primitives</li>\n</ul></li>\n</ul>\n\n<p>Note that even if the above cases might be regarded as \"special\" values called \"bottoms\" (the name comes from domain theory), you can not test against these values at runtime, in general. So, these are not at all the same thing as Java's <code>null</code>. More precisely, you can't write things like</p>\n\n<pre><code> -- assume f :: Int -&gt; Int\nif (f 5) is a division-by-zero or infinite recursion\nthen 12\nelse 4\n</code></pre>\n\n<p>Some exceptional values can be caught in the <code>IO</code> monad, but forget about that -- exceptions in Haskell are not idiomatic, and roughly only used for IO errors.</p>\n\n<p>If you want an exceptional value which can be tested at run-time, use the <code>Maybe a</code> type, as @bash0r already suggested. This type is similar to Scala's <code>Option[A]</code> or Java's not-so-much-used <code>Optional&lt;A&gt;</code>.</p>\n\n<p>The value is having both a type <code>T</code> and type <code>Maybe T</code> is to be able to precisely identify which functions always succeed, and which ones can fail. In Haskell the following is frowned upon, for instance:</p>\n\n<pre><code> -- Finds a value in a list. Returns -1 if not present.\n findIndex :: Eq a =&gt; [a] -&gt; a -&gt; Int\n</code></pre>\n\n<p>Instead this is preferred:</p>\n\n<pre><code> -- Finds a value in a list. Returns Nothing if not present.\n findIndex :: Eq a =&gt; [a] -&gt; a -&gt; Maybe Int\n</code></pre>\n\n<p>The result of the latter is less convenient than the one of the former, since the <code>Int</code> must be unwrapped at every call. This is <em>good</em>, since in this way each user of the function is prevented to simply \"ignore\" the not-present case, and write buggy code.</p>\n"}, {"comments": [{"owner": {"reputation": 42863, "user_id": 577603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/70c19b44cc2eb6f1a87a08fc892c502b?s=128&d=identicon&r=PG", "display_name": "ComicSansMS", "link": "https://stackoverflow.com/users/577603/comicsansms"}, "edited": false, "score": 0, "creation_date": 1454587222, "post_id": 35200188, "comment_id": 58116842, "body": "Also note that this is pretty much the motivation for the introduction of <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/Optional.html\" rel=\"nofollow noreferrer\"><code>java.util.Optional&lt;T&gt;</code></a> in Java 8. It&#39;s not the same as <code>null</code>, but it solves what is probably the only valid use case for <code>null</code> in a much nicer way. If you want to understand Haskell&#39;s <code>Maybe</code> as a Java developer, <code>Optional&lt;T&gt;</code> is a good start."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 42863, "user_id": 577603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/70c19b44cc2eb6f1a87a08fc892c502b?s=128&d=identicon&r=PG", "display_name": "ComicSansMS", "link": "https://stackoverflow.com/users/577603/comicsansms"}, "edited": false, "score": 1, "creation_date": 1454587544, "post_id": 35200188, "comment_id": 58117030, "body": "@ComicSansMS Indeed. There&#39;s also <code>Nullable&lt;T&gt;</code> in C#. It exists because <code>int</code> variables can&#39;t be null, and sometimes you want them to be. In Haskell, <i>everything</i> is non-nullable, unless you use <code>Maybe</code>."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 42863, "user_id": 577603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/70c19b44cc2eb6f1a87a08fc892c502b?s=128&d=identicon&r=PG", "display_name": "ComicSansMS", "link": "https://stackoverflow.com/users/577603/comicsansms"}, "edited": false, "score": 0, "creation_date": 1454589251, "post_id": 35200188, "comment_id": 58118119, "body": "I meant to say... Eiffel is an OOP language that allows you to declare variables as &quot;not nullable&quot;. (They wanted to make it the default, but that would break backwards compatibility.)"}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 5, "last_activity_date": 1510838530, "last_edit_date": 1510838530, "creation_date": 1454586395, "answer_id": 35200188, "question_id": 35198674, "link": "https://stackoverflow.com/questions/35198674/can-i-declare-a-null-value-in-haskell/35200188#35200188", "title": "Can I declare a NULL value in Haskell?", "body": "<p>Haskell does not have \"null\". This is a design feature. It completely prevents any possibility of your code crashing due to a null-pointer exception.</p>\n\n<p>If you look at code written in an imperative language, 99% of the code <em>expects</em> stuff to never be null, and will malfunction catastrophically if you give it null. But then 1% of the code <em>does</em> expect nulls, and <em>uses</em> this feature to specify optional arguments or whatever. But you can't easily tell, by looking at the code, which parts are expecting nulls as legal arguments, and which parts aren't. Hopefully it's documented &mdash; but don't hold your breath!</p>\n\n<p>In Haskell, there is no null. If that argument is declared as <code>Customer</code>, then there <em>must</em> be an actual, real <code>Customer</code> there. You can't just pass in a null (intentionally or by mistake). So the 99% of the code that is expecting a real <code>Customer</code> will always work.</p>\n\n<p>But what about the other 1%? Well, for that we have <code>Maybe</code>. But it's an explicit thing; you have to <em>explicitly</em> say \"this value is optional\". And you have to <em>explicitly</em> check when you use it. You cannot \"forget\" to check; it won't compile.</p>\n\n<p>So yes, there is no \"null\", but there is <code>Maybe</code> which is kinda similar, but safer.</p>\n"}], "owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7561, "favorite_count": 3, "answer_count": 4, "score": 2, "last_activity_date": 1510838530, "creation_date": 1454582098, "question_id": 35198674, "link": "https://stackoverflow.com/questions/35198674/can-i-declare-a-null-value-in-haskell", "title": "Can I declare a NULL value in Haskell?", "body": "<p>Just curious, seems when declaring a name, we always specify some valid values, like let a = 3. Question is, in imperative languages include c/java there's always a keyword of \"null\". Does Haskell has similar thing? When could a function object be null?</p>\n"}, {"tags": ["debugging", "haskell", "lazy-evaluation", "ghci"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454581402, "post_id": 35198306, "comment_id": 58112911, "body": "try <code>seq c ()</code> after: <code>:sprint c</code> will give you <code>c = &#39;a&#39; : _</code> ... also read the link I posted in your last question"}], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 11, "creation_date": 1454581802, "post_id": 35198434, "comment_id": 58113208, "body": "for <code>let a = 3</code> it&#39;s more complicated (you should try this) - by default <code>a</code> will be <code>a :: Num a =&gt; a</code> and in your case will always <code>:sprint</code> to <code>_</code> - IMO the <code>String</code> example is better suited to get a feeling for this"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 7, "creation_date": 1454592211, "post_id": 35198434, "comment_id": 58120038, "body": "if you use <code>let a = 3</code>, you better specify a type <code>let a = 3 :: Int</code> so you won&#39;t get confused, also note this behaviour has changed in GHC 7.8 in older versions you did not have to write the type in this statement to make <code>:sprint</code> work as &#39;expected&#39;."}], "tags": [], "owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "is_accepted": false, "score": 7, "last_activity_date": 1454581475, "creation_date": 1454581475, "answer_id": 35198434, "question_id": 35198306, "link": "https://stackoverflow.com/questions/35198306/why-sprint-always-prints-a/35198434#35198434", "title": "Why :sprint always prints a &quot;_&quot;?", "body": "<p>Haskell is lazy. It doesn't evaluate things until they are needed.</p>\n\n<p>The GHCi <code>sprint</code> command (not part of Haskell, just a debugging command of the interpreter) prints the value of an expression without forcing evaluation.</p>\n\n<p>When you write</p>\n\n<pre><code>let a = 3\n</code></pre>\n\n<p>you bind a new name <code>a</code> to the right-hand side expression, but Haskell won't evaluate that thing yet. Therefore, when you <code>sprint</code> it, it prints <code>_</code> as the value to indicate that the expression has not yet been evaluated.</p>\n\n<p>Try this:</p>\n\n<pre><code>let a = 3\n:sprint a -- a has not been evaluated yet\nprint a -- forces evaluation of a\n:sprint a -- now a has been evaluated\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 23, "creation_date": 1468859495, "post_id": 35200329, "comment_id": 64289157, "body": "Remark: Since <code>[1..]</code> has a polymorphic type, it&#39;s likely that <code>:sp xs</code> yields <code>_</code>, even after <code>head xs</code>. <code>let xs = [1..] :: [Integer]</code> will fix this."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 16, "last_activity_date": 1454586805, "creation_date": 1454586805, "answer_id": 35200329, "question_id": 35198306, "link": "https://stackoverflow.com/questions/35198306/why-sprint-always-prints-a/35200329#35200329", "title": "Why :sprint always prints a &quot;_&quot;?", "body": "<p>Haskell is a lazy language. It doesn't evaluate results until they are \"needed\".</p>\n\n<p>Now, just <em>printing</em> a value causes all of it to be \"needed\". In other words, if you type an expression in GHCi, it will try to print out the result, which causes it all to be evaluated. Usually that's what you want.</p>\n\n<p>The <code>sprint</code> command (which is a GHCi feature, not part of the Haskell language) allows you to see how much of a value has been evaluated at this point.</p>\n\n<p>For example:</p>\n\n<pre><code>Prelude&gt; let xs = [1..]\nPrelude&gt; :sprint xs\nxs = _\n</code></pre>\n\n<p>So, we just declared <code>xs</code>, and it's currently unevaluated. Now let's print out the first element:</p>\n\n<pre><code>Prelude&gt; head xs\n1\nPrelude&gt; :sprint xs\nxs = 1 : _\n</code></pre>\n\n<p>Now GHCi has evaluated the head of the list, but nothing more.</p>\n\n<pre><code>Prelude&gt; take 10 xs\n[1,2,3,4,5,6,7,8,9,10]\nPrelude&gt; :sprint xs\nxs = 1 : 2 : 3 : 4 : 5 : 6 : 7 : 8 : 9 : 10 : _\n</code></pre>\n\n<p>Now the first 10 elements are evaluated, but more remain. (Since <code>xs</code> is an <em>infinite list</em>, that's not surprising.)</p>\n\n<p>You can construct other expressions and evaluate them a bit at a time to see what's going on. This is really part of the GHCi debugger, which lets you step through your code one bit at a time. Especially if your code is getting caught in an infinite loop, you don't want to <code>print</code> anything, because that might lock up GHCi. But you still want to see what's going on... hence <code>sprint</code>, which lets you see what's evaluated so far.</p>\n"}, {"comments": [{"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 3, "creation_date": 1488673098, "post_id": 42602657, "comment_id": 72336330, "body": "Note that this only applies to &quot;overloaded&quot; values like <code>xs</code>; things that are have a type with variables and have type class constraints on those variables. It&#39;s mostly only examples involving literal numbers that behave this way; unfortunately numbers are the obvious things to play around with while learning. If you instead play around with booleans (<code>True</code>, <code>False</code>, <code>&amp;&amp;</code>, <code>and</code>, etc) then everything mostly behaves the same regardless of <code>NoMonomorphismRestriction</code> or whether you give an explicit type signature."}], "tags": [], "owner": {"reputation": 1057, "user_id": 2716377, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0JbwB.png?s=128&g=1", "display_name": "Nicolas Mattia", "link": "https://stackoverflow.com/users/2716377/nicolas-mattia"}, "is_accepted": false, "score": 8, "last_activity_date": 1488804531, "last_edit_date": 1488804531, "creation_date": 1488670724, "answer_id": 42602657, "question_id": 35198306, "link": "https://stackoverflow.com/questions/35198306/why-sprint-always-prints-a/42602657#42602657", "title": "Why :sprint always prints a &quot;_&quot;?", "body": "<p>I'm a bit late, but I had a similar issue:</p>\n\n<pre><code>\u03bb: let xs = [1,2,3]\nxs :: Num t =&gt; [t]\n\u03bb: :sprint xs\nxs = _\n\u03bb: print xs\n\u03bb: :sprint xs\nxs = _\n</code></pre>\n\n<p><em>This issue is specific to polymorphic values.</em> If you have <code>-XNoMonomorphismRestriction</code> enabled ghci will never really evaluate/force <code>xs</code>, it'll only evaluate/force specializations:</p>\n\n<pre><code>\u03bb: :set -XMonomorphismRestriction\n\u03bb: let xs = [1,2,3]\nxs :: [Integer]\n\u03bb: print xs\n\u03bb: :sprint xs\nxs = [1,2,3]\n</code></pre>\n"}], "owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1603, "favorite_count": 2, "accepted_answer_id": 35200329, "answer_count": 3, "score": 16, "last_activity_date": 1488804531, "creation_date": 1454581179, "last_edit_date": 1454582571, "question_id": 35198306, "link": "https://stackoverflow.com/questions/35198306/why-sprint-always-prints-a", "title": "Why :sprint always prints a &quot;_&quot;?", "body": "<pre><code>Prelude&gt; let a = 3\nPrelude&gt; :sprint a\na = _\nPrelude&gt; let c = \"ab\"\nPrelude&gt; :sprint c\nc = _\n</code></pre>\n\n<p>Why does it always print a <code>_</code>? I don't quite get the semantics of the <code>:sprint</code> command.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 764, "user_id": 3529754, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a8311cc9fdf0e052da7367ae79775c1c?s=128&d=identicon&r=PG&f=1", "display_name": "bash0r", "link": "https://stackoverflow.com/users/3529754/bash0r"}, "edited": false, "score": 0, "creation_date": 1454579984, "post_id": 35197627, "comment_id": 58111890, "body": "In your type signature for <code>distance</code> you&#39;re saying <code>v -&gt; v -&gt; Double</code>. In your instance declaration for <code>OneD1 m</code> you have <code>x1</code> and <code>x2</code> of type <code>m</code>. That is the m you mentioned in <code>OneD1 m</code>. Due to the type <code>v -&gt; v -&gt; Double</code> Haskell expects to construct a value of type <code>Double</code>. That means <code>m</code> = <code>Double</code>. But <code>m</code> is not <code>Double</code>. You could use Type Families or generalize the type of <code>distance</code> any further to solve the problem. For example <code>distance :: v -&gt; v -&gt; v</code> and <code>instance Num m =&gt; Vector (OneD1 m) where</code>."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1454580472, "last_edit_date": 1454580472, "creation_date": 1454580036, "answer_id": 35197852, "question_id": 35197627, "link": "https://stackoverflow.com/questions/35197627/haskell-meaning-of-the-error-in-ghci/35197852#35197852", "title": "Haskell: meaning of the error in GHCI", "body": "<pre><code>instance Vector (OneD1 m) where\n</code></pre>\n\n<p>This promises that <code>(OdeD1 m)</code> is a vector, for any <code>m</code>. Including <code>OneD1 String</code>, etc.</p>\n\n<pre><code>   distance (OD1 x1) (OD1 x2) = x2-x1\n</code></pre>\n\n<p>Here we try to apply <code>-</code> on two values of type <code>m</code>, which could be absolutely anything. There are two issues here:</p>\n\n<ul>\n<li><code>m</code> might not be a numeric type -- GHC is not reporting this error, at the moment.</li>\n<li>the result of the difference is again of type <code>m</code>, but distance should produce a <code>Double</code>. This is the error GHC is reporting.</li>\n</ul>\n\n<p>You need to restrict <code>m</code> to some numeric type, so that you can use <code>-</code>, and that type must admit a conversion to <code>Double</code>, otherwise you can't satisfy the <code>distance</code> signature.</p>\n\n<p>One trivial way is:</p>\n\n<pre><code>instance Vector (OneD1 Double) where\n   distance (OD1 x1) (OD1 x2) = x2-x1\n</code></pre>\n\n<p>Another could be:</p>\n\n<pre><code>instance Real m =&gt; Vector (OneD1 m) where\n   distance (OD1 x1) (OD1 x2) = realToFrac (x2-x1)\n</code></pre>\n"}], "owner": {"reputation": 269, "user_id": 1084637, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/745239e23061d746727436ec06e5dd2e?s=128&d=identicon&r=PG", "display_name": "asp5", "link": "https://stackoverflow.com/users/1084637/asp5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1454580472, "creation_date": 1454579415, "question_id": 35197627, "link": "https://stackoverflow.com/questions/35197627/haskell-meaning-of-the-error-in-ghci", "title": "Haskell: meaning of the error in GHCI", "body": "<p>I'm not able to figure out what this error msg means. I want to define the function distance for the data type below... I do NOT want to use any GHC extensions.. even if the code is ugly, want to understand the error better, before I move on to using the extensions. Can someone please let me know what this error means and how I can get rid of this.</p>\n\n<pre><code>class Vector v where\n\n         distance :: v -&gt; v -&gt; Double\n\n-- doesn't make sense, but WTH...    \nnewtype OneD1 a = OD1 a\n         deriving (Show)\n\ninstance Vector (Maybe m) where\n    distance _ _ = 5.6\n\ninstance Vector (OneD1 m) where\n   distance (OD1 x1) (OD1 x2) = x2-x1\n\n    Prelude&gt; :reload\n[1 of 1] Compiling Main             ( VectorTypeClass.hs, interpreted )\n\nVectorTypeClass.hs:33:33:\n    Couldn't match expected type `Double' with actual type `m'\n      `m' is a rigid type variable bound by\n          the instance declaration\n          at C:\\Users\\byamm\\Documents\\Programming\\Haskell\\Lab\\Expts\\VectorTypeClass\\VectorTypeClass.hs:32:10\n    Relevant bindings include\n      x2 :: m\n        (bound at C:\\Users\\byamm\\Documents\\Programming\\Haskell\\Lab\\Expts\\VectorTypeClass\\VectorTypeClass.hs:33:27)\n      x1 :: m\n        (bound at C:\\Users\\byamm\\Documents\\Programming\\Haskell\\Lab\\Expts\\VectorTypeClass\\VectorTypeClass.hs:33:18)\n      distance :: OneD1 m -&gt; OneD1 m -&gt; Double\n        (bound at C:\\Users\\byamm\\Documents\\Programming\\Haskell\\Lab\\Expts\\VectorTypeClass\\VectorTypeClass.hs:33:4)\n    In the first argument of `(-)', namely `x2'\n    In the expression: x2 - x1\nFailed, modules loaded: none.\nPrelude&gt;\n</code></pre>\n"}]