[{"tags": ["haskell", "cabal-install", "nix"], "comments": [{"owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "edited": false, "score": 0, "creation_date": 1539846862, "post_id": 52864666, "comment_id": 92651049, "body": "<a href=\"https://stackoverflow.com/a/47264375/2789312\">stackoverflow.com/a/47264375/2789312</a> does that help?"}], "answers": [{"tags": [], "owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "is_accepted": true, "score": 3, "last_activity_date": 1539851219, "last_edit_date": 1539851219, "creation_date": 1539847178, "answer_id": 52868885, "question_id": 52864666, "link": "https://stackoverflow.com/questions/52864666/is-it-possible-to-keep-the-test-suite-logs-generated-by-cabal-when-run-through-n/52868885#52868885", "title": "Is it possible to keep the test suite logs generated by Cabal when run through nix-build?", "body": "<h1>Keeping the log files in case the test suite was successful</h1>\n\n<p>You can specify a shell script which gets executed after the test suite is run by <code>postCheck</code>. This is only executed, if the test suite is successful.</p>\n\n<p>Calling <code>cabal2nix</code> with or without <code>--shell</code> will contain a derivation like that in the output:</p>\n\n<pre><code> { mkDerivation, base, stdenv }:\n      mkDerivation {\n        pname = \"sample\";\n        version = \"0.0.0.1\";\n        src = ./.;\n        isLibrary = false;\n        isExecutable = true;\n        executableHaskellDepends = [ base ];\n        testHaskellDepends = [ base ];\n        license = stdenv.lib.licenses.unfree;\n        hydraPlatforms = stdenv.lib.platforms.none;\n      };\n</code></pre>\n\n<p>All you have to add is</p>\n\n<pre><code> postCheck = ''\n              mkdir -p $out/logs\n              find dist/test -name \\*log -exec cp '{}' $out/logs \\;\n            '';\n</code></pre>\n\n<p>and you will find your log files in <code>result/logs</code>.</p>\n\n<p>The whole derivation will now look like:</p>\n\n<pre><code> { mkDerivation, base, stdenv }:\n      mkDerivation {\n        pname = \"sample\";\n        version = \"0.0.0.1\";\n        src = ./.;\n        isLibrary = false;\n        isExecutable = true;\n        executableHaskellDepends = [ base ];\n        testHaskellDepends = [ base ];\n        license = stdenv.lib.licenses.unfree;\n        hydraPlatforms = stdenv.lib.platforms.none;\n        postCheck = ''\n              mkdir -p $out/logs\n              find dist/test -name \\*log -exec cp '{}' $out/logs \\;\n            '';\n      };\n</code></pre>\n\n<h1>Keeping the log files in case the test suite failed</h1>\n\n<p>If you want to look at these log files in case the test suite fails, you can call <code>nix-build</code> with the option <code>--keep-failed</code> or <code>-K</code>. This way it will keep the temporary build directory and print a message like</p>\n\n<pre><code>note: keeping build directory '/tmp/nix-build-sample-0.0.0.1.drv-0'\n</code></pre>\n\n<p>near the end of its output (third to last line for me). You will find the log files in that directory. In my\nexample, they have been placed in</p>\n\n<pre><code>/tmp/nix-build-sample-0.0.0.1.drv-0/sample/dist/test\n</code></pre>\n"}], "owner": {"reputation": 170, "user_id": 1077030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d3a5d927d0f97fc7fc35f7d9ee16fad?s=128&d=identicon&r=PG", "display_name": "noteed", "link": "https://stackoverflow.com/users/1077030/noteed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 52868885, "answer_count": 1, "score": 3, "last_activity_date": 1539851219, "creation_date": 1539816684, "question_id": 52864666, "link": "https://stackoverflow.com/questions/52864666/is-it-possible-to-keep-the-test-suite-logs-generated-by-cabal-when-run-through-n", "title": "Is it possible to keep the test suite logs generated by Cabal when run through nix-build?", "body": "<p>I have a .cabal file specifying a test suite, and a default.nix file generated with <code>cabal2nix</code>.</p>\n\n<p>Then I have a release.nix file (containing something like <code>pkgs.haskell.packages.ghc802.callPackage ./default.nix {})</code> that I can <code>nix-build</code>.</p>\n\n<p>It works: I have a result symlink with my program.</p>\n\n<p>While compiling my program with <code>nix-build</code>, I see in the output this line: <code>Test suite logged to: dist/test/myprogram-0.0.0-test-suite.log</code> (I guess produced indirectly by <code>cabal test</code>), but the file seems to be discarded.</p>\n\n<p>Is it possible to keep around that log file (possibly within the directory pointed to by the result symlink) ?</p>\n"}, {"tags": ["parsing", "haskell", "aeson"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1539803692, "post_id": 52861673, "comment_id": 92638549, "body": "You haven&#39;t included the code that actually produces the error - could you please do so? It&#39;s possible, for example, that you have made a simple typo, that we cannot see here."}, {"owner": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1539804844, "post_id": 52861673, "comment_id": 92639076, "body": "@AJFarmar added in the code that produced the error."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1539806975, "post_id": 52861673, "comment_id": 92640019, "body": "Great, thank you. I&#39;m not sure if I&#39;ve found the issue, but can I ask why you write <code>let l = L.toList (data1 an)</code> instead of <code>let l = data1 an</code>? That seems like it could be the issue here."}, {"owner": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1539807418, "post_id": 52861673, "comment_id": 92640228, "body": "That&#39;s because <code>data1 an</code> outputs an <code>Object</code> type. <code>an</code> contains a lot of <code>Object (fromList [(&quot;ABC&quot;, &quot;123&quot;)])</code>. Applying <code>toList</code> on it lets me convert it to a list and extract out each one at a time."}, {"owner": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1539807644, "post_id": 52861673, "comment_id": 92640330, "body": "From what I understand <code>Object (fromList [(&quot;ABC&quot;, &quot;123&quot;)])</code> has the type <code>Value</code> and just <code>fromList [(&quot;ABC&quot;, &quot;123&quot;)]</code> has the type Object. So I think there should be a way to extract <code>Object</code> out of the <code>Value</code> type"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1539808070, "post_id": 52861673, "comment_id": 92640534, "body": "That may be so, but still <code>l</code> is a list, and you&#39;re writing <code>l .: &quot;ABC</code> which is not well-typed, so why are you writing that?"}, {"owner": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1539809497, "post_id": 52861673, "comment_id": 92641187, "body": "@AJFarmar Sorry that was my bad. I forgot to add <code>Data.List.head</code> in front of l. Fixed"}], "answers": [{"comments": [{"owner": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "edited": false, "score": 0, "creation_date": 1539810570, "post_id": 52863401, "comment_id": 92641646, "body": "I&#39;m still a beginner in haskell so this might be an odd question but wouldn&#39;t looking up key need the type to be <code>Object</code> instead of <code>Value</code> which is the result of the last <code>print</code> statement. Applying <code>data1</code> on <code>an</code> gives me a bunch of objects. Applying <code>toList</code> on it lets me choose which element I want. And from inside that element I need to extract the <code>&quot;123&quot;</code>. <code>toList data1 an</code> is equivalent to <code>[Value, Value, Value,....]</code>. Applying <code>head</code> means I ultimately get just <code>Value</code>."}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "reply_to_user": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "edited": false, "score": 0, "creation_date": 1539824411, "post_id": 52863401, "comment_id": 92645152, "body": "It would help if you posted your entire program.  <code>.:</code> requires an Object.  According to the definition you gave of <code>data1 :: DataSet -&gt; Object</code>, <code>data1 an :: Object</code>.  What are you seeing that suggests <code>data1 an</code> is &quot;a bunch of objects&quot;?  Whence are you importing <code>toList</code>?  There are several functions of that name."}], "tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": false, "score": 2, "last_activity_date": 1539809408, "creation_date": 1539809408, "answer_id": 52863401, "question_id": 52861673, "link": "https://stackoverflow.com/questions/52861673/how-to-get-hashmap-object-out-of-value-in-haskell-aeson/52863401#52863401", "title": "How to get HashMap (Object) out of Value in Haskell, Aeson?", "body": "<p><code>Object</code> is one of several constructors of the <a href=\"https://hackage.haskell.org/package/aeson-1.4.1.0/docs/Data-Aeson.html#t:Value\" rel=\"nofollow noreferrer\"><code>Value</code> type</a> </p>\n\n<pre><code>Haskell Constructor | JSON Syntax\nObject              | {\"key\": \"value\"}\nString              | \"hello\"\nNumber              | 123\nArray               | [1, 2, 3]\n</code></pre>\n\n<p>Note that in this case, the constructor <code>Object</code> is not a constructor of the type <code>Object</code>. [Note at end.]</p>\n\n<p>The error comes from passing a <code>Value</code> to some function expecting an <code>Object</code>.  You will need to define what the program should do if it encounters any of the other cases.  </p>\n\n<p>Or since you have <code>data1 an :: Object</code>, you can lookup the key you want in that.  I'm not sure what the type of <code>S.toList</code> is, but you seem to be converting your <code>Object</code> to a <code>Value</code> and then passing it to <code>.:</code> which requires an Object.</p>\n\n<p>Final note: <code>Object (fromList [(\"ABC\", String \"123\")])</code> is a single Value with a single Object with one key-value pair. <code>fromList</code> is a way to create Objects from their parts (instead of by parsing JSON strings).</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "is_accepted": true, "score": 0, "last_activity_date": 1539858297, "last_edit_date": 1539858297, "creation_date": 1539857743, "answer_id": 52871797, "question_id": 52861673, "link": "https://stackoverflow.com/questions/52861673/how-to-get-hashmap-object-out-of-value-in-haskell-aeson/52871797#52871797", "title": "How to get HashMap (Object) out of Value in Haskell, Aeson?", "body": "<p>One quick and dirty way of getting things out of <code>Value</code> type is to</p>\n\n<p>encode <code>Value</code> as <code>ByteString</code></p>\n\n<p>encode has type <code>encode :: ToJSON a =&gt; a -&gt; ByteString</code></p>\n\n<p>so here in your code </p>\n\n<pre><code>...\n  case x of\n    Left er   -&gt; print er\n    Right an -&gt; do\n      let l = S.toList (data1 an)\n          x = (encode . snd) l  -- you can replace snd with fst if you want \"ABC\" instead of \"123\"\n          y = decode x :: Maybe (HashMap String String)\n          case y of\n              Nothing -&gt; print \"got nothing\"\n              Just a -&gt; print $ Data.HashMap.Strict.toList a\n</code></pre>\n\n<p>Which will output a list like this:</p>\n\n<pre><code>[(\"123\")]\n</code></pre>\n\n<p>Now you can extract values with simple functions.</p>\n\n<p>Hope that helps.</p>\n\n<p>To know more about how you'd go about parsing JSON file better I would recommend giving <a href=\"https://artyom.me/aeson\" rel=\"nofollow noreferrer\">https://artyom.me/aeson</a> a good read.</p>\n"}, {"tags": [], "owner": {"reputation": 588, "user_id": 350221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8d7a8bfcca7e634c4faacea5e4f00ce?s=128&d=identicon&r=PG", "display_name": "Dave Parrish", "link": "https://stackoverflow.com/users/350221/dave-parrish"}, "is_accepted": false, "score": 0, "last_activity_date": 1551812541, "last_edit_date": 1551812541, "creation_date": 1551812007, "answer_id": 55009656, "question_id": 52861673, "link": "https://stackoverflow.com/questions/52861673/how-to-get-hashmap-object-out-of-value-in-haskell-aeson/55009656#55009656", "title": "How to get HashMap (Object) out of Value in Haskell, Aeson?", "body": "<p>Here are some ways you can unwrap the <code>Object</code> constructor from the <code>Value</code> data type.</p>\n\n<p>You could create a function to unwrap:</p>\n\n<pre><code>unwrapValue :: Value -&gt; Object\nunwrapValue (Object x) = x\nunwrapValue _ = error \"No Object available\"\n</code></pre>\n\n<p>Notice this function will return an error because there are possibilities where <code>Value</code> will not be an <code>Object</code>.</p>\n\n<p>Also, don't get confused by <code>Object</code> being both a constructor of <code>Value</code> and a type in aeson!</p>\n\n<p>You could unwrap inline as well but it is also not safe, meaning it can cause runtime errors. For example:</p>\n\n<pre><code>getNum :: Array -&gt; Either String Scientific\ngetNum someArray = flip parseEither someArray $ \\arr -&gt; do\n  let Just (Object obj) = arr !? 1 -- Unsafe unwrap Object constructor from Value (also unwraps Just constructor from Maybe)\n  (Number num) &lt;- obj .: \"myNumber\" -- Unsafe unwrap Number constructor from Value\n\n  return num\n</code></pre>\n"}], "owner": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1036, "favorite_count": 0, "accepted_answer_id": 52871797, "answer_count": 3, "score": 1, "last_activity_date": 1551812541, "creation_date": 1539801984, "last_edit_date": 1539809455, "question_id": 52861673, "link": "https://stackoverflow.com/questions/52861673/how-to-get-hashmap-object-out-of-value-in-haskell-aeson", "title": "How to get HashMap (Object) out of Value in Haskell, Aeson?", "body": "<p>I'm trying to get used to some haskell libraries by solving some online practice problems. </p>\n\n<p>I have some code which outputs this</p>\n\n<pre><code>Object (fromList [(\"ABC\", String \"123\")])\n</code></pre>\n\n<p>It may also be</p>\n\n<pre><code>Object (fromList [(\"123\", String \"ABC\")])\nObject (fromList [(String \"123\", String \"ABC\")])\nObject (fromList [(\"123\", \"ABC\")])\n</code></pre>\n\n<p>what I need to extract is <code>\"123\"</code></p>\n\n<p>using <code>.:</code> which has type <code>(.:) :: FromJSON a =&gt; Object -&gt; Text -&gt; Parser a</code>  to extract value given key raises this error</p>\n\n<pre><code>\u2022 Couldn't match type \u2018Value\u2019 with \u2018HashMap Text Value\u2019                                                         \n  Expected type: Object\n    Actual type: Value\n</code></pre>\n\n<p>My best guess is that I'm going to have to write a parser, but I have no idea how to go about doing that or what to look for.</p>\n\n<p>Code that produced the error :</p>\n\n<pre><code>x &lt;- (eitherDecode &lt;$&gt; simpleHttp url) :: IO (Either String DataSet)\n  case x of\n    Left er   -&gt; print er\n    Right an -&gt; do\n      let l = S.toList (data1 an)\n      print $ l .: \"ABC\"\n</code></pre>\n\n<p>where DataSet is defined like this</p>\n\n<pre><code>newtype DataSet = DataSet {\n                   data1  :: Object\n                   } deriving (Show, Generic)\n</code></pre>\n\n<p>If I were to replace </p>\n\n<pre><code>print $ (Data.List.head l) .: \"ABC\"\n</code></pre>\n\n<p>with just </p>\n\n<pre><code>print $ (Data.List.head l)\n</code></pre>\n\n<p>I get </p>\n\n<pre><code>Object (fromList [(\"ABC\", String \"123\")])\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1539789351, "post_id": 52858104, "comment_id": 92631423, "body": "Is there a particular reason you use <code>&lt;!-- language: lang-haskell --&gt;</code>? I find the default highlighting (i.e. <code>&lt;!-- language: haskell --&gt;</code>) more readable."}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 1, "creation_date": 1539789471, "post_id": 52858104, "comment_id": 92631505, "body": "Just to emphasize, yes it <i>can</i> be done, but there are more idiomatic ways of accomplishing the same thing, and I would recommend just constraining the functions that actually <i>need</i> that constraint, not the whole datatype."}, {"owner": {"reputation": 9, "user_id": 10519327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEyTZ.jpg?s=128&g=1", "display_name": "SkullKiddo", "link": "https://stackoverflow.com/users/10519327/skullkiddo"}, "edited": false, "score": 0, "creation_date": 1539790705, "post_id": 52858104, "comment_id": 92632243, "body": "Sorry leftaroundabout, was my first port and I just mimic another post I saw online. Thanks mayolo I will try this approach"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1539792443, "post_id": 52858104, "comment_id": 92633112, "body": "@SkullKiddo Don&#39;t worry about the highlighting. For future posts, note that you can omit the <code>&lt;!-- language ...</code> line, and the highlighting will be done correctly: the language is determined by the question tag <code>haskell</code>. Indeed the <code>&lt;!-- language</code> line is only needed when you need two tags for two programming languages."}], "owner": {"reputation": 9, "user_id": 10519327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEyTZ.jpg?s=128&g=1", "display_name": "SkullKiddo", "link": "https://stackoverflow.com/users/10519327/skullkiddo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "closed_date": 1539789405, "answer_count": 0, "score": 0, "last_activity_date": 1539790474, "creation_date": 1539788926, "last_edit_date": 1539790474, "question_id": 52858104, "link": "https://stackoverflow.com/questions/52858104/haskell-restricting-variable-type-in-a-new-data-type", "closed_reason": "Duplicate", "title": "Haskell - Restricting variable type in a new data type", "body": "<p>I'm learning haskell and I have a simple class in Haskell like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class Point p where \n   ....\n   -- some functions\n   ....\n</code></pre>\n\n<p>and i want to make a Tree that only containts any data that is instance of Point. I want something like this:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>data Kd2nTree a = Empty | Node a (Kd2nTree a) (Kd2nTree a)\n</code></pre>\n\n<p>So 'a' can only be instance of my class Point.</p>\n\n<p>How can I do this?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1539788128, "post_id": 52857786, "comment_id": 92630718, "body": "Have you tried it? Yes, it&#39;s possible, and the definition of <code>b</code> doesn&#39;t even need to come after the definition of <code>a</code>; <code>... where { b = a + 2; a = 1 + 3 }</code> works just as well."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1539788187, "post_id": 52857786, "comment_id": 92630761, "body": "Yes, and you can even use the <i>same</i> variable, like <code>a = 1 + a</code>, here this is a bit dangerous, but for example <code>where lst = 1 : lst</code> is sometimes used to declare an infinite list that will for some operations require constant memory."}, {"owner": {"reputation": 1227, "user_id": 5053374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe57f0998df065470ff42c938f781cf?s=128&d=identicon&r=PG", "display_name": "Libby", "link": "https://stackoverflow.com/users/5053374/libby"}, "edited": false, "score": 4, "creation_date": 1539788476, "post_id": 52857786, "comment_id": 92630941, "body": "Why are you people answering in the comments?!?!"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 1227, "user_id": 5053374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe57f0998df065470ff42c938f781cf?s=128&d=identicon&r=PG", "display_name": "Libby", "link": "https://stackoverflow.com/users/5053374/libby"}, "edited": false, "score": 3, "creation_date": 1539788796, "post_id": 52857786, "comment_id": 92631107, "body": "@Libby: because it looks like the <code>where</code> clause of a question syntactically :)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 1227, "user_id": 5053374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe57f0998df065470ff42c938f781cf?s=128&d=identicon&r=PG", "display_name": "Libby", "link": "https://stackoverflow.com/users/5053374/libby"}, "edited": false, "score": 1, "creation_date": 1539803733, "post_id": 52857786, "comment_id": 92638562, "body": "@Libby I answered in the comments because it&#39;s not a well-asked question. The OP ask whether perfectly good code works without apparently even trying it."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1227, "user_id": 5053374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe57f0998df065470ff42c938f781cf?s=128&d=identicon&r=PG", "display_name": "Libby", "link": "https://stackoverflow.com/users/5053374/libby"}, "edited": false, "score": 0, "creation_date": 1539806896, "post_id": 52857786, "comment_id": 92639986, "body": "@Libby Indeed we should not answer in comments. Still, sometimes the question seems unclear, so the comment is implicitly asking &quot;is this the kind of answer you seek?&quot;. Further, I guess that other times the answer looks so trivial that the comment-writer feels uneasy with posting it as an answer, perhaps believing that would be a shameful rep-grabbing move. SO policy is of course that answers should be answers, not comments (and we have CW for who does not want rep, in theory). I&#39;m not a psychologist, but this is my guess :)"}], "answers": [{"tags": [], "owner": {"reputation": 2638, "user_id": 7208029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QxbAJ.png?s=128&g=1", "display_name": "Chai T. Rex", "link": "https://stackoverflow.com/users/7208029/chai-t-rex"}, "is_accepted": false, "score": 6, "last_activity_date": 1539788586, "creation_date": 1539788586, "answer_id": 52857993, "question_id": 52857786, "link": "https://stackoverflow.com/questions/52857786/where-clause-in-haskell/52857993#52857993", "title": "Where clause in Haskell", "body": "<p>Yes. The variables in the <code>where</code> clause can see other variables in the same <code>where</code> clause.</p>\n\n<p>For doubts, you can test it out with a simpler structure to see if it gives the correct value:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>testing = b\n  where\n    a = 1000\n    b = a + 234\n\nmain = print testing\n</code></pre>\n\n<p>Does it print out 1234 as expected?</p>\n"}, {"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1539790878, "post_id": 52858023, "comment_id": 92632344, "body": "Nice art.  I was hoping someone would show an example like <code>lst</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 6, "last_activity_date": 1539808323, "last_edit_date": 1539808323, "creation_date": 1539788668, "answer_id": 52858023, "question_id": 52857786, "link": "https://stackoverflow.com/questions/52857786/where-clause-in-haskell/52858023#52858023", "title": "Where clause in Haskell", "body": "<p><strong>Yes</strong>, it is even possible to use the <em>same</em> variable in the expression as the one you define.</p>\n\n<p>would work as well. In essence, the variables are just references to \"expressions\". So for your case you construct something that looks like:</p>\n\n\n\n<pre class=\"lang-none prettyprint-override\"><code>    \u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\nb\u2500\u2500&gt;\u2503  (+)  \u2503\n    \u2523\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u252b   \u250f\u2501\u2501\u2501\u2513\n    \u2503 o \u2503 o\u2500\u2542\u2500\u2500&gt;\u2503 2 \u2503\n    \u2517\u2501\u253f\u2501\u253b\u2501\u2501\u2501\u251b   \u2517\u2501\u2501\u2501\u251b\n      \u2502\n      v\n    \u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\na\u2500\u2500&gt;\u2503  (+)  \u2503\n    \u2523\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u252b   \u250f\u2501\u2501\u2501\u2513\n    \u2503 o \u2503 o\u2500\u2542\u2500\u2500&gt;\u2503 3 \u2503\n    \u2517\u2501\u253f\u2501\u253b\u2501\u2501\u2501\u251b   \u2517\u2501\u2501\u2501\u251b\n      \u2502\n      \u2502         \u250f\u2501\u2501\u2501\u2513\n      \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt;\u2503 1 \u2503\n                \u2517\u2501\u2501\u2501\u251b\n</code></pre>\n\n<p>This expression tree thus contains functions which point to other expression trees. Haskell will by default <em>not</em> evaluate these expressions: the expressions are evaluated lazily: only when you have to calculate these, you will calculate the corresponding value. Furthermore, if you are for example interested in the value of <code>b</code>, you thus will calculate the value of <code>a</code>, and thus the <code>1+3</code> expression will only be evaluated <em>once</em>. The same holds in the opposite direction: in case you first evaluate <code>a</code>, then evaluating <code>b</code> will benefit from the fact that <code>a</code> was already calculated. You can for example define two variables in terms of each other, like:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>foo :: Int\nfoo = a\n    where a = 1 + b\n          b = 1 + a\n</code></pre>\n\n<p>but this will get stuck in an infinite loop since you will create an expression that looks like <code>1 + (1 + (1 + (...)))</code>.</p>\n\n<p>We can even define a variable in terms of itself. For example the function below generates an infinite list of ones:</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>ones :: [Int]\nones = lst\n    where lst = 1 : lst\n</code></pre>\n\n<p>This will be represented as:</p>\n\n\n\n<pre class=\"lang-none prettyprint-override\"><code>      \u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\nlst\u2500\u2500&gt;\u2503  (:)  \u2503&lt;\u2500\u256e\n      \u2523\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u252b  \u2502\n      \u2503 o \u2503 o\u2500\u2542\u2500\u2500\u256f\n      \u2517\u2501\u253f\u2501\u253b\u2501\u2501\u2501\u251b\n        \u2502\n        v\n      \u250f\u2501\u2501\u2501\u2513\n      \u2503 1 \u2503\n      \u2517\u2501\u2501\u2501\u251b\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3964, "user_id": 10262805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zQvN3.jpg?s=128&g=1", "display_name": "Yilmaz", "link": "https://stackoverflow.com/users/10262805/yilmaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1618298032, "creation_date": 1618298032, "answer_id": 67070285, "question_id": 52857786, "link": "https://stackoverflow.com/questions/52857786/where-clause-in-haskell/67070285#67070285", "title": "Where clause in Haskell", "body": "<pre><code>calcProfit revenue cost= if revenue - cost &gt;0\n                         then revenue - cost\n                         else 0\n</code></pre>\n<p>In this example we are repeating (revenuw-cost) your computation. This is a cheap operation but if it was an expensive operation you would be wasting resources. To prevent this, we use <code>where</code> clause:</p>\n<pre><code>calcProfit revenue cost = if profit &gt;0 \n                          then profit\n                          else 0\n           where profit= revenue-cost\n</code></pre>\n<p>With &quot;where&quot; clause we reverse the normal order used to write variables. In most of the  programming languages, variables are declared before they\u2019re used. In Haskell, because of referential transparency, variable order isn\u2019t an issue.</p>\n<p>As you see, we declare the variable &quot;profit&quot; in where clause and then we used it</p>\n"}], "owner": {"reputation": 121, "user_id": 10513295, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hNAO7bYMxyc/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsIIg2tLxpED_OmNmokxr3aKUTQQ/mo/photo.jpg?sz=128", "display_name": "jazzer97", "link": "https://stackoverflow.com/users/10513295/jazzer97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1757, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1618298032, "creation_date": 1539787963, "question_id": 52857786, "link": "https://stackoverflow.com/questions/52857786/where-clause-in-haskell", "title": "Where clause in Haskell", "body": "<p>I'm confused about how the <strong>where clause</strong> in Haskell works in a certain situation.</p>\n\n<p>My biggest question is, is it possible <strong>to declare a variable</strong> that does something in the <strong>where clause</strong> and <strong>use back</strong> that declared variable through <strong>another variable</strong> declared in the where clause?</p>\n\n<p>For example:</p>\n\n<pre><code>someFunc :: somefunc\n.\n| (guard expression)\n| (guard expression)\nwhere a = 1+3\n      b = a + 2 --using back 'a' variable which was also declared in the where clause.\n</code></pre>\n\n<p>Is this possible? When i do this haskell does not report any error but I was having doubts if it's a correct.</p>\n"}, {"tags": ["json", "haskell", "aeson"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1539787505, "post_id": 52857608, "comment_id": 92630331, "body": "JSON objects are inherently unordered, so the same file can result in all possible key-value pair orders."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1539787527, "post_id": 52857608, "comment_id": 92630347, "body": "As for your second question, calculating the <i>maximum</i> can be done in <i>linear time</i>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1539788761, "post_id": 52857608, "comment_id": 92631099, "body": "You have to distinguish between two things: the abstract <i>object</i> that the JSON represents, and the concrete <i>serialization</i> that is actually stored in the file. The serialization has to choose <i>some</i> ordering of the keys (since files themselves are ordered sequences of bytes), but whatever order is chosen is unrelated to the the object itself. The only way to represent order in JSON is to use an array."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "is_accepted": false, "score": 0, "last_activity_date": 1539792189, "creation_date": 1539792189, "answer_id": 52859143, "question_id": 52857608, "link": "https://stackoverflow.com/questions/52857608/why-is-my-code-parsing-a-sorted-json-file-into-unsorted-list-haskell-and-aeso/52859143#52859143", "title": "Why is my code parsing a sorted JSON file into unsorted list? | Haskell and Aeson", "body": "<p>I was able to solve the problem with Willem's directions (in the comments).</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric     #-}\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE RecordWildCards   #-}\n\nmodule Tesst where\n\nimport           Data.Aeson\nimport qualified Data.ByteString.Lazy as B\nimport           Data.HashMap.Strict  as S\nimport           Data.List\nimport           Data.Text\nimport           Data.Time\nimport           GHC.Exts\nimport           GHC.Generics\nimport           Network.HTTP.Conduit (simpleHttp)\n\n\nnewtype TechnicalAnalysis = TechnicalAnalysis {\n                   rsiQuote  :: Object\n                   } deriving (Show, Generic)\n\n\ninstance FromJSON TechnicalAnalysis where\n  parseJSON = withObject \"RSI Quote\" $\n    \\o -&gt; do\n      rsiQuote &lt;- o        .: \"Technical Analysis: RSI\"\n      return TechnicalAnalysis {..}\n\nmain :: IO ()\nmain = do\n  putStrLn \"Which ticker? \"\n  symbolToQuote &lt;- getLine\n  d &lt;- (eitherDecode &lt;$&gt; simpleHttp (\"https://www.alphavantage.co/query?function=RSI&amp;interval=weekly&amp;time_period=10&amp;series_type=open&amp;apikey=FI2KMC2DSAE&amp;symbol=\" ++ symbolToQuote)) :: IO (Either String TechnicalAnalysis)\n  case d of\n    Left e   -&gt; print e\n    Right qt -&gt; do\n      let l = S.toList (rsiQuote qt)\n      print $ maximumBy (\\(a, _) (b, _) -&gt; compare a b) l\n</code></pre>\n\n<hr>\n\n<p>This was the key</p>\n\n<pre><code>maximumBy (\\(a, _) (b, _) -&gt; compare a b)\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "edited": false, "score": 0, "creation_date": 1539872471, "post_id": 52859300, "comment_id": 92665801, "body": "That&#39;s far better than my implementation! Thanks a lot!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "edited": false, "score": 0, "creation_date": 1539872600, "post_id": 52859300, "comment_id": 92665886, "body": "Also if you wouldn&#39;t mind, could you add a bit more documentation to your code? I&#39;m still very new to haskell so it&#39;ll be a massive help following your thought processes."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 0, "last_activity_date": 1539793357, "last_edit_date": 1539793357, "creation_date": 1539792727, "answer_id": 52859300, "question_id": 52857608, "link": "https://stackoverflow.com/questions/52857608/why-is-my-code-parsing-a-sorted-json-file-into-unsorted-list-haskell-and-aeso/52859300#52859300", "title": "Why is my code parsing a sorted JSON file into unsorted list? | Haskell and Aeson", "body": "<p>You have chosen the essentially dynamically-typed <code>Object</code> as your semantic object. Choose something better; <code>Map Day Double</code>, e.g., or <code>ArgMax Day Double</code> if you <em>really</em> only want the latest RSI value and will never look at anything else.</p>\n\n<p>For example:</p>\n\n<pre><code>import Control.Monad\nimport Data.Aeson\nimport Data.Aeson.Types\nimport Data.HashMap.Strict as S\nimport Data.List.NonEmpty\nimport Data.Semigroup\nimport Data.Text\nimport Data.Time\n\n-- can't use readMaybe, 2018-10-17 10:31:05 has extra non-Day gunk at the end\njsonReadText :: Read a =&gt; String -&gt; Text -&gt; Parser a\njsonReadText err t = case reads (unpack t) of\n    (v,_):_ -&gt; return v\n    _ -&gt; fail $ \"could not parse \" ++ unpack t ++ \" as \" ++ err\n\nnewtype RSI = RSI Double deriving Show\n\ninstance FromJSON RSI where\n    parseJSON = withObject \"object with RSI key\" $ \\o -&gt; do\n        t &lt;- o .: pack \"RSI\"\n        RSI &lt;$&gt; jsonReadText \"Double\" t\n\nnewtype LatestRSI = LatestRSI (ArgMax Day RSI) deriving Show\n\ninstance FromJSON LatestRSI where\n    parseJSON = withObject \"RSI Quote\" $ \\o -&gt; do\n        quoteMap &lt;- o .: pack \"Technical Analysis: RSI\"\n        quotes &lt;- forM (S.toList quoteMap) $ \\(dayText, rsiValue) -&gt; do\n            day &lt;- jsonReadText \"Day\" dayText\n            rsi &lt;- parseJSON rsiValue\n            return (Max (Arg day rsi))\n        case quotes of\n            [] -&gt; fail \"expected non-empty collection of RSI quotes\"\n            q:qs -&gt; return . LatestRSI . sconcat $ q :| qs\n</code></pre>\n\n<p>Example usage in ghci:</p>\n\n<pre><code>&gt; bs &lt;- Data.ByteString.Lazy.readFile \"test.json\"\n&gt; eitherDecode bs :: Either String LatestRSI\nRight (LatestRSI (Max {getMax = Arg 2018-10-17 (RSI 54.5653)}))\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 52859300, "answer_count": 2, "score": 0, "last_activity_date": 1539793357, "creation_date": 1539787412, "question_id": 52857608, "link": "https://stackoverflow.com/questions/52857608/why-is-my-code-parsing-a-sorted-json-file-into-unsorted-list-haskell-and-aeso", "title": "Why is my code parsing a sorted JSON file into unsorted list? | Haskell and Aeson", "body": "<p>I'm trying to parse a nested JSON file which looks like this</p>\n\n<pre><code>{\n    \"Meta Data\": {\n        \"1: Symbol\": \"MSFT\",\n        \"2: Indicator\": \"Relative Strength Index (RSI)\",\n        \"3: Last Refreshed\": \"2018-10-17 10:31:05\",\n        \"4: Interval\": \"weekly\",\n        \"5: Time Period\": 10,\n        \"6: Series Type\": \"open\",\n        \"7: Time Zone\": \"US/Eastern Time\"\n    },\n    \"Technical Analysis: RSI\": {\n        \"2018-10-17 10:31:05\": {\n            \"RSI\": \"54.5653\"\n        },\n        \"2018-10-12\": {\n            \"RSI\": \"63.0279\"\n        },\n        \"2018-10-05\": {\n            \"RSI\": \"74.7519\"\n        },\n        \"2018-09-28\": {\n            \"RSI\": \"72.1573\"\n        },\n        \"2018-09-21\": {\n            \"RSI\": \"74.8123\"\n        },\n        \"2018-09-14\": {\n            \"RSI\": \"66.7116\"\n        },\n        \"2018-09-07\": {\n            \"RSI\": \"75.8051\"\n          ...\n          ...\n          ... and so on\n</code></pre>\n\n<hr>\n\n<p>My goal is to get the latest/uppermost \"RSI\" value. Since the key (the dates) are variable, I'm trying to get it without matching the keys.</p>\n\n<hr>\n\n<p>This is what I've got so far</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric     #-}\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE RecordWildCards   #-}\n\nmodule Tesst where\n\nimport           Data.Aeson\nimport qualified Data.ByteString.Lazy as B\nimport           Data.HashMap.Strict  as S\nimport           Data.Text\nimport           Data.Time\nimport           GHC.Exts\nimport           GHC.Generics\nimport           Network.HTTP.Conduit (simpleHttp)\n\nnewtype TechnicalAnalysis = TechnicalAnalysis {\n                   rsiQuote  :: Object\n                   } deriving (Show, Generic)\n\n\ninstance FromJSON TechnicalAnalysis where\n  parseJSON = withObject \"RSI Quote\" $\n    \\o -&gt; do\n      rsiQuote &lt;- o        .: \"Technical Analysis: RSI\"\n      return TechnicalAnalysis {..}\n\nmain :: IO ()\nmain = do\n  putStrLn \"Which ticker? \"\n  symbolToQuote &lt;- getLine\n  d &lt;- (eitherDecode &lt;$&gt; simpleHttp (\"https://www.alphavantage.co/query?function=RSI&amp;interval=weekly&amp;time_period=10&amp;series_type=open&amp;apikey=FI2KMDSAE&amp;symbol=\" ++ symbolToQuote)) :: IO (Either String TechnicalAnalysis)\n  case d of\n    Left e   -&gt; print e\n    Right qt -&gt; print $ Prelude.map (\\(a, b) -&gt; (read (unpack a) :: Day, b)) (S.toList (rsiQuote qt))\n</code></pre>\n\n<hr>\n\n<p>What I get running the code is this:</p>\n\n<pre><code>[(2005-09-02,Object (fromList [(\"RSI\",String \"60.8860\")])),(2017-12-29,Object (fromList [(\"RSI\",String \"71.1921\")])),(2011-09-16,Object (fromList [(\"RSI\",String \"50.3489\")])),(2000-05-12,Object (fromList [(\"RSI\",String \"33.6402\")]))...\n</code></pre>\n\n<p>as you can see, all the values are out of order.</p>\n\n<hr>\n\n<p>My questions are: </p>\n\n<ol>\n<li>Why isn't it just printing out that JSON file as it is?</li>\n<li>Is it possible to get the latest RSI value without sorting the\nresult?</li>\n</ol>\n"}, {"tags": ["haskell", "haskell-diagrams"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1539784645, "post_id": 52856034, "comment_id": 92628380, "body": "Ok, you&#39;re looking for a way to do this. What research have you done? What attempts have you made? We&#39;re not just going to write this (quite nontrivial) code for you."}, {"owner": {"reputation": 661, "user_id": 1021134, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8724cd9cfab6d6818d3cf8c7f10400e5?s=128&d=identicon&r=PG", "display_name": "fredefox", "link": "https://stackoverflow.com/users/1021134/fredefox"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1539784798, "post_id": 52856034, "comment_id": 92628497, "body": "I don&#39;t know how to remove the question again. If you feel this is off-topic go right ahead, sir."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1539787329, "post_id": 52856885, "comment_id": 92630219, "body": "Although this is true, it&#39;s not really an answer, is it? In fact one might interpret that the question is actually about <i>what assumptions are reasonable</i> to make about a function that should be drawn as a path. Yeah, in a cardinality sense most \u211d\u2192\u211d functions are utterly discontinous, but most functions <i>you&#39;d actually want to plot</i> are probably infinitely differentiable almost everywhere..."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1539787606, "post_id": 52856885, "comment_id": 92630391, "body": "@leftaroundabout Sure, and I&#39;d upvote an answer about what assumptions are reasonable, if you have some in mind. Especially if the conclusion of those assumptions is something different than &quot;generate a fixed set of <code>Double</code>s to sample along&quot;, the existing proposed solution. I would find that outcome surprising and probably enlightening."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1539787928, "post_id": 52856885, "comment_id": 92630588, "body": "I will write an answer later today."}, {"owner": {"reputation": 1943, "user_id": 305559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc113924265dbeb535c8b2fefe4e33ee?s=128&d=identicon&r=PG", "display_name": "Brent Yorgey", "link": "https://stackoverflow.com/users/305559/brent-yorgey"}, "edited": false, "score": 0, "creation_date": 1540227051, "post_id": 52856885, "comment_id": 92777525, "body": "If you assume that you also can compute the curvature of the function at any given point, I could imagine some kind of adaptive sampling process where you start with some fixed set of points and then &quot;zoom in&quot; on places where the function seems to be changing more quickly.  @leftroundabout , I&#39;d be interested to read your promised answer!"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1539785263, "creation_date": 1539785263, "answer_id": 52856885, "question_id": 52856034, "link": "https://stackoverflow.com/questions/52856034/sampling-points-along-a-path/52856885#52856885", "title": "Sampling points along a path", "body": "<p>Can't be done. If you want a \"good\" sample of a function, you must assume <em>something</em> about smoothness of the function; without any assumptions functions can be wildly weird. For example, the Weierstrass function is continuous everywhere and differentiable nowhere; the rationality indicator is bounded but discontinuous everywhere; and indeed by any sane metric the vast majority of functions are not even computable let alone easily interrogatable for a set of \"representative\" inputs.</p>\n\n<p>So make some assumptions, or demand that the user tell you how to sample.</p>\n"}], "owner": {"reputation": 661, "user_id": 1021134, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8724cd9cfab6d6818d3cf8c7f10400e5?s=128&d=identicon&r=PG", "display_name": "fredefox", "link": "https://stackoverflow.com/users/1021134/fredefox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 52856885, "answer_count": 1, "score": 0, "last_activity_date": 1539785263, "creation_date": 1539782699, "question_id": 52856034, "link": "https://stackoverflow.com/questions/52856034/sampling-points-along-a-path", "title": "Sampling points along a path", "body": "<p>Say I have a <code>type Path a = Double -&gt; a</code>. That describes some notion of a \"path\" in a given type <code>a</code>. In my case I want to use this to draw a curve in a 2-dimensional space. I use <a href=\"http://hackage.haskell.org/package/diagrams-lib\" rel=\"nofollow noreferrer\"><code>diagrams</code></a> so let <code>a = P2 Double</code> (<a href=\"http://hackage.haskell.org/package/diagrams-lib-1.4.2.3/docs/Diagrams-TwoD.html#t:P2\" rel=\"nofollow noreferrer\"><code>P2</code></a>).</p>\n\n<p>What I'm looking for is a (generic) way of sampling any path <code>p :: Path (P2 Double)</code> so that I can generate a smooth curve. Currently I just generate a fixed set of <code>Double</code>s that I sample <code>p</code> along. However, this only works nicely if <code>p</code> is relatively smooth w.r.t. the sample rate.</p>\n"}, {"tags": ["haskell", "frp", "conduit", "haskell-pipes", "streamly"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1539768896, "post_id": 52849593, "comment_id": 92618760, "body": "I don&#39;t understand -- do you expect the thread IDs to be <code>1,2,3</code>? Or do you expect the values to show up in the order <code>1,2,3</code>? Recall that parallel execution provides no ordering guarantees, in general (otherwise it would be sequential execution)."}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1539770150, "post_id": 52849593, "comment_id": 92619482, "body": "I have updated the question, no special order just x always processed on the same thread x1, tell me if it&#39;s clearer"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1539772619, "creation_date": 1539772619, "answer_id": 52852894, "question_id": 52849593, "link": "https://stackoverflow.com/questions/52849593/groupby-of-stream-by-agreggateid-haskell-concurrency-streaming/52852894#52852894", "title": "GroupBy of stream by agreggateId (Haskell / concurrency streaming)", "body": "<p>In the code above, <code>parallely</code> decided to create one Haskell thread for each element in the list <code>getAggregateIds</code>, which is <code>[1,2,3,1,2,3]</code>.\n<code>parallely</code> does not care about there being some duplicate elements in the list: it simply starts a thread for each one.</p>\n\n<p>In principle, <code>parallely</code> could allocate only a small number of Haskell threads and reuse them later on (possibly for the same duplicate ID, or another one), but there would be no performance gain in doing so. Indeed, the crucial part here is that an Haskell thread is being allocated, not an OS thread,</p>\n\n<p>Haskell threads are very lightweight, they use very little memory and so they are very cheap to create and dispose. Trying to reuse them would possibly lead to worse performance.</p>\n\n<p>Further, the Haskell runtime can execute many Haskell threads in a single OS threads. Usually, a small pool of OS threads is kept around by the runtime, and Haskell threads are mapped to those. Since OS threads are not as lightweight OS threads are indeed reused between Haskell threads.</p>\n\n<p>Finally, note that the <code>ThreadId</code> is the name of the Haskell thread, not the OS one, so it's normal to see no reuse of those IDs.</p>\n"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 52852894, "answer_count": 1, "score": 0, "last_activity_date": 1539772619, "creation_date": 1539761923, "last_edit_date": 1539770062, "question_id": 52849593, "link": "https://stackoverflow.com/questions/52849593/groupby-of-stream-by-agreggateid-haskell-concurrency-streaming", "title": "GroupBy of stream by agreggateId (Haskell / concurrency streaming)", "body": "<p><strong><em>Context</em></strong> : I'm implementing an App in CQRS and I'm trying to optimize the processing of commands (1 stream by aggregate Id basically)... </p>\n\n<p><strong><em>Problem</em></strong> : I would like to have a first stream that receives all the commands and dispatches these ones by their aggregate Id on different threads :</p>\n\n<p>1) Commands within an aggregate are processed in a serialized way<br>\n2) Aggregates process their commands independently (in parallel). </p>\n\n<p><strong><em>Solution</em></strong> : I'm trying to perform a groupBy on streams by aggregate Id basically...To help a bit,I simplified the example as follow :</p>\n\n<pre><code>module Sandbox where\n\nimport Streamly\nimport qualified Streamly.Prelude as S\nimport Control.Concurrent\nimport Control.Monad.IO.Class (MonadIO(..))\n\nmain :: IO ()\nmain = do\n         runStream $ parallely $ S.fromList getAggregateIds |&amp; S.mapM (\\x -&gt; do\n            threadId &lt;- myThreadId\n            liftIO $ putStrLn $ (show threadId) ++ \"  value \" ++ (show x))\n\n\ngetAggregateIds :: [Integer]\ngetAggregateIds = [1..3] &lt;&gt; [1..3]\n</code></pre>\n\n<p>so this script is displaying the following result :</p>\n\n<pre><code>ThreadId 17  value 1\nThreadId 15  value 2\nThreadId 19  value 3\nThreadId 13  value 1\nThreadId 16  value 3\nThreadId 18  value 2\n</code></pre>\n\n<p>What I'm expecting is something like that (no special order just x always processed on the same thread x1 ) :</p>\n\n<pre><code>ThreadId X1  value X\nThreadId Y1  value Y\nThreadId Z1  value Z\nThreadId X1  value X\nThreadId Y1  value Y\nThreadId Z1  value Z\n</code></pre>\n\n<p>Thanks !!</p>\n"}, {"tags": ["haskell", "gloss"], "comments": [{"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1539816804, "post_id": 52849289, "comment_id": 92643597, "body": "How do you determine that <code>x</code> and <code>y</code> don&#39;t change? Can you show your code for that?"}], "owner": {"reputation": 51, "user_id": 10517039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c3e414c9c6436c0dc43614f302f742e?s=128&d=identicon&r=PG&f=1", "display_name": "Ed Williams", "link": "https://stackoverflow.com/users/10517039/ed-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 213, "favorite_count": 0, "answer_count": 0, "score": 5, "last_activity_date": 1539959937, "creation_date": 1539760752, "last_edit_date": 1539959937, "question_id": 52849289, "link": "https://stackoverflow.com/questions/52849289/mouse-handler-in-haskell-gloss-on-mac", "title": "Mouse handler in Haskell Gloss on Mac", "body": "<p>I was wrong about what the problem was.  The event handlers worked fine, and everything works now.  I found the answer on <a href=\"http://gloss.ouroborus.net/\" rel=\"nofollow noreferrer\">http://gloss.ouroborus.net/</a>, and the relevant paragraph is cited below.  I apologize for asking a misleading question.  I would delete the question but I don't see a way to do that.  </p>\n\n<p>from gloss.ouroborus.net:</p>\n\n<p>Q: On my MacBook Pro under OSX, gloss programs freeze after displaying the first few frames.\nA: This can happen on dual GPU systems when the OS switches from the integrated GPU (baked into the processor) to the discrete one (separate from the main processor). The gloss program can sometimes draw a few frames before getting stuck, otherwise it just shows a black window. This is probably a bug in OSX not switching the graphics context properly. The work-around is to disable automatic GPU switching under System Preferences / Energy Saver. </p>\n\n<p>Original question:</p>\n\n<p>I wrote a game in Haskell Gloss which uses mouse click and keyboard handlers.  It compiles and runs fine on a PC, but, while it compiles and loads on an Apple and presents the game screen, the mouse and keyboard handlers malfunction.  The mouse handler recognizes that the mouse button has been been clicked, but reports the same pair of numbers for the mouse position no matter where the mouse is.  The keyboard handler does not work for 's' and 'f', but the escape key DOES work.  </p>\n\n<p>Here are the handlers:</p>\n\n<pre><code>mousehandle::Event-&gt;(Board,Board)-&gt;IO(Board,Board)\nmousehandle (EventKey (MouseButton LeftButton) Down _ pt@(x,y)) \n                        (board,solved) = \n                            return (board',solved)\n                            where \n                                    board' = if candidates == [] then board \n                                                        else rotateCell board (fst (head candidates))\n                                    candidates = getCandidates (x,y) board\nmousehandle (EventKey (Char 's') Down _ _ ) (board1, board2) = return (board2, board1)\nmousehandle (EventKey (Char 'f') Down _ _ ) (board1, board2) = do\n                                    print \"filename?\"\n                                    ans &lt;- getLine \n                                    games2File [board1, board2]   ans\n                                    return (board1, board2)\nmousehandle (EventKey (SpecialKey KeyEsc) Down _ _) _ = exitSuccess                                        \nmousehandle _ x = return x\n</code></pre>\n\n<p>I know what the returned mouse position coordinates are for each click because a trace in the function getCandidates prints them out to the console.  </p>\n\n<p>The computer is a Mac Book Pro.  The Haskell used is GHC 7.6.3, installed as part of the full Haskell Platform.   Gloss was installed with \"cabal install gloss\".    </p>\n\n<p>Any suggestions would be welcome.</p>\n"}, {"tags": ["haskell", "typeclass", "type-constraints"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1539760232, "post_id": 52848998, "comment_id": 92613982, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2170341/why-does-haskell-stop-short-of-inferring-the-datatypes-typeclasses-in-the-funct\">Why does Haskell stop short of inferring the datatype&#39;s typeclasses in the function signatures?</a>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1539760245, "post_id": 52848998, "comment_id": 92613991, "body": "... or <a href=\"https://stackoverflow.com/questions/12770278/typeclass-constraints-on-data-declarations\" title=\"typeclass constraints on data declarations\">stackoverflow.com/questions/12770278/&hellip;</a>"}, {"owner": {"reputation": 2424, "user_id": 3206471, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fdc1f4bd9f3118fff33a160e9efdb61e?s=128&d=identicon&r=PG", "display_name": "gigabytes", "link": "https://stackoverflow.com/users/3206471/gigabytes"}, "edited": false, "score": 2, "creation_date": 1539760692, "post_id": 52848998, "comment_id": 92614229, "body": "Ideed the compiler can infer it: try to remove the function type signature and see. But here you are disabling any inference because you are explicitly giving a type to your function, so the compiler does not even start inferring. It just complains the signature is wrong (or rather that the function is wrong for that signature)"}, {"owner": {"reputation": 960, "user_id": 200886, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b77d4a4cef2d3500ad583b4e93934fae?s=128&d=identicon&r=PG", "display_name": "divesh premdeep", "link": "https://stackoverflow.com/users/200886/divesh-premdeep"}, "reply_to_user": {"reputation": 2424, "user_id": 3206471, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fdc1f4bd9f3118fff33a160e9efdb61e?s=128&d=identicon&r=PG", "display_name": "gigabytes", "link": "https://stackoverflow.com/users/3206471/gigabytes"}, "edited": false, "score": 0, "creation_date": 1539762587, "post_id": 52848998, "comment_id": 92615210, "body": "@gigabytes This is the first occurrence I&#39;ve encountered where adding a function signature actually change the behaviour of the compiler. I thought function signatures served more of a readability / documentation purpose because they are not really needed."}, {"owner": {"reputation": 960, "user_id": 200886, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b77d4a4cef2d3500ad583b4e93934fae?s=128&d=identicon&r=PG", "display_name": "divesh premdeep", "link": "https://stackoverflow.com/users/200886/divesh-premdeep"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1539763091, "post_id": 52848998, "comment_id": 92615482, "body": "@melpomene Cheers, however, those answers don&#39;t explain the &quot;why&quot; aspect of it."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1539763284, "post_id": 52848998, "comment_id": 92615587, "body": "@diveshpremdeep It shouldn&#39;t be surprising that adding a function signature can change the behaviour of the compiler. If you add a signature that&#39;s just wrong, like <code>sort :: IO Double -&gt; Char</code>, then this surely must cause a compile-time error. The point is that you can ask the compiler what the (most general) correct signature is, rather than writing it yourself \u2013 though more often it actually works better to start with the signature and let the compiler help you with the <i>implementation</i> instead. And, sometimes signatures are actually needed, in particular when Rank-2 types are involved."}, {"owner": {"reputation": 2424, "user_id": 3206471, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fdc1f4bd9f3118fff33a160e9efdb61e?s=128&d=identicon&r=PG", "display_name": "gigabytes", "link": "https://stackoverflow.com/users/3206471/gigabytes"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1539767902, "post_id": 52848998, "comment_id": 92618169, "body": "As @leftaroundabout said, this is just a case of a wrong type signature. If you write the same type signature that the compiler would have inferred alone, of course he behaviour does not change. But if you write a wrong one, or one correct but less general than the most general one (which is the one inferred), then of course the compiler acts accordingly."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1539768533, "post_id": 52848998, "comment_id": 92618560, "body": "Signature are for documentation purposes, but not only for that. Regular documentation is  human-only. Signatures, instead, are read by both humans and the compiler, which will check the code against the signature. Indeed, we add them in the code so that the compiler can point out errors as early as possible. If we want a function to return a string, but we make a mistake and make it return  boolean, the compiler would happily infer the unintended type, and report errors (perhaps) only when the function is used, surprising the programmer. With a type signature the error is found early."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 2, "creation_date": 1539810437, "post_id": 52848998, "comment_id": 92641593, "body": "@diveshpremdeep Type-inference is undecidable in any relatively complex type system. The Haskell compiler <i>needs</i> type signatures in many situations. Regarding your code: I hope you have read the book: you should not add such constraints on a <code>data</code> declaration. They really add nothing to your type and only cause headaches. There are better alternatives."}, {"owner": {"reputation": 960, "user_id": 200886, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b77d4a4cef2d3500ad583b4e93934fae?s=128&d=identicon&r=PG", "display_name": "divesh premdeep", "link": "https://stackoverflow.com/users/200886/divesh-premdeep"}, "reply_to_user": {"reputation": 2424, "user_id": 3206471, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fdc1f4bd9f3118fff33a160e9efdb61e?s=128&d=identicon&r=PG", "display_name": "gigabytes", "link": "https://stackoverflow.com/users/3206471/gigabytes"}, "edited": false, "score": 0, "creation_date": 1539833503, "post_id": 52848998, "comment_id": 92646881, "body": "@gigabytes Indeed, if I omit the type declaration, the compiler happily compiles my code. As I understand it, my original code fails because I&#39;m overriding the compiler&#39;s inferred type declaration with my own, which user leftaroundabout has mentioned. Please add your comment as an answer so that I can accept it. Thanks!"}, {"owner": {"reputation": 960, "user_id": 200886, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b77d4a4cef2d3500ad583b4e93934fae?s=128&d=identicon&r=PG", "display_name": "divesh premdeep", "link": "https://stackoverflow.com/users/200886/divesh-premdeep"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1539834162, "post_id": 52848998, "comment_id": 92647029, "body": "@Bakuriu I am going through the book right now. I was simply curious about why the compiler behaves this way."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1540134816, "post_id": 52848998, "comment_id": 92743368, "body": "see <a href=\"https://stackoverflow.com/a/2172085/849891\">this answer</a> at the first proposed duplicate."}], "answers": [{"tags": [], "owner": {"reputation": 2424, "user_id": 3206471, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fdc1f4bd9f3118fff33a160e9efdb61e?s=128&d=identicon&r=PG", "display_name": "gigabytes", "link": "https://stackoverflow.com/users/3206471/gigabytes"}, "is_accepted": true, "score": 2, "last_activity_date": 1540106752, "creation_date": 1540106752, "answer_id": 52913009, "question_id": 52848998, "link": "https://stackoverflow.com/questions/52848998/adding-type-constraints-to-data-declarations/52913009#52913009", "title": "Adding type constraints to data declarations", "body": "<p>Ideed the compiler can infer it: try to remove the function type signature and see. \nFor example, with <code>ghci</code>:</p>\n\n<pre><code>Prelude&gt; :set -XDatatypeContexts\nPrelude&gt; data Ord a =&gt; OrderedValue a = OrderedValue a\nPrelude&gt; let getOrderedValue (OrderedValue a) = a\nPrelude&gt; :t getOrderedValue\ngetOrderedValue :: Ord t =&gt; OrderedValue t -&gt; t\n</code></pre>\n\n<p>However, by explicitly stating a type for your function, you are disabling any inference. Type inference kicks in when there is no explicit type annotation for a term. If you explicitly give it, that is the type the term will have no matter what, so it has to be correct.</p>\n\n<p>So, the compiler here is <em>type-checking</em> your code, and finds that a type such as <code>OrderedValue a -&gt; a</code> is wrong, because it ignores the <code>Ord a</code> constraint. </p>\n\n<p>However, note that <code>DatatypeContexts</code>, which allows you to put the constraint on the data type, is deprecated. The consensus about it is that it is better to put constraints only on the functions that really need them. If you remove the <code>Ord a</code> constraint from the data type, then the <code>getOrderedValue</code> function compiles well, because there would be no <code>Ord a</code> constraint to obey, and indeed you can notice that this matches more closely the intuition behind the original type you wrote, which now is correct.</p>\n\n<p>As an aside, note that the type that the compiler infers automatically is the <em>most general</em> one for the particular body of the function to correctly type-check, but you can explicitly give a less general type.</p>\n\n<p>For example, the following function:</p>\n\n<pre><code>mysum = foldr (+) 0\n</code></pre>\n\n<p>has type <code>(Num b, Foldable t) =&gt; t b -&gt; b</code>, but you can write:</p>\n\n<pre><code>mysum :: [Integer] -&gt; Integer\nmysum = foldr (+) 0\n</code></pre>\n\n<p>because that's a correct type for the function, albeit a more <em>specific</em> one. Of course, then once the specific type is assigned to <code>mysum</code>, you cannot call it with another instance of <code>Foldable</code> or another <code>Num</code> type: you loose the generality when you specialize the type.</p>\n"}], "owner": {"reputation": 960, "user_id": 200886, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b77d4a4cef2d3500ad583b4e93934fae?s=128&d=identicon&r=PG", "display_name": "divesh premdeep", "link": "https://stackoverflow.com/users/200886/divesh-premdeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "accepted_answer_id": 52913009, "answer_count": 1, "score": 1, "last_activity_date": 1540106752, "creation_date": 1539759607, "last_edit_date": 1539763050, "question_id": 52848998, "link": "https://stackoverflow.com/questions/52848998/adding-type-constraints-to-data-declarations", "title": "Adding type constraints to data declarations", "body": "<p>I've been reading about making our own types and type classes from <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow noreferrer\">Learn You a Haskell for Great Good</a>. I don't quite understand the behaviour of the Haskell compiler when I add a type constraint to my <code>data</code> declarations.</p>\n\n<p>For example, I have</p>\n\n<pre><code>{-# LANGUAGE DatatypeContexts #-}\n\ndata (Ord a) =&gt; OrderedValue a = OrderedValue a\n\ngetOrderedValue :: OrderedValue a -&gt; a\ngetOrderedValue (OrderedValue a) = a\n</code></pre>\n\n<p>As can be seen above, I have a type constraint on my data declaration, stating that any value that is contained inside an <code>OrderedValue</code> must have an <code>Ord</code> instance.</p>\n\n<p>I tried compiling this code and the compiler spit out </p>\n\n<pre><code>\u2022 No instance for (Ord a) arising from a use of \u2018OrderedValue\u2019\n  Possible fix:\n    add (Ord a) to the context of\n      the type signature for:\n        getOrderedValue :: forall a. OrderedValue a -&gt; a\n\u2022 In the pattern: OrderedValue a\n  In an equation for \u2018getOrderedValue\u2019:\n      getOrderedValue (OrderedValue a) = a\n</code></pre>\n\n<p>Changing the definition of <code>getOrderedValue</code> to</p>\n\n<pre><code>getOrderedValue :: (Ord a) =&gt; OrderedValue a -&gt; a\ngetOrderedValue (OrderedValue a) = a\n</code></pre>\n\n<p>expectedly fixed the problem.</p>\n\n<p>My question is - why is the compiler complaining here? I assumed the compiler should be able to infer that the <code>a</code> being pattern matched in</p>\n\n<pre><code>getOrderedValue (OrderedValue a) = a\n</code></pre>\n\n<p>has an <code>Ord</code> instance, because the <code>OrderedValue</code> value constructor is for constructing instances of type <code>OrderedValue</code> that has a type parameter <code>a</code> that has an <code>Ord</code> instance.</p>\n\n<p>Phew, that was a mouthful.</p>\n\n<p>Thanks.</p>\n\n<p><strong>EDIT</strong> - I had a look at the alternate answers that @melpomene suggested, thanks for that. However, I'm looking for an answer that describes <strong>why</strong> the Haskell language designers chose to implement it this way.</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 1, "creation_date": 1539749772, "post_id": 52846646, "comment_id": 92610277, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/25191659/why-is-haskell-missing-obvious-typeclasses\">Why is Haskell missing &quot;obvious&quot; Typeclasses</a>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1539751387, "post_id": 52846646, "comment_id": 92610641, "body": "This might be a better use for backpack than typeclasses."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1539764945, "post_id": 52846646, "comment_id": 92616499, "body": "Use <a href=\"http://hackage.haskell.org/package/lens-4.3.3/docs/Control-Lens-At.html\" rel=\"nofollow noreferrer\"><code>At</code></a>."}], "answers": [{"comments": [{"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1539781635, "post_id": 52851458, "comment_id": 92626366, "body": "I had no idea that module Signatures existed, I can see this being very useful (especially for people wanting to avoid more &quot;advanced&quot; FP or Category Theory"}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1539785152, "post_id": 52851458, "comment_id": 92628733, "body": "One of the motivation behind Backpack is to keep simple Haskell. Having typeclass for <code>Map</code> most likely will involve advance features like <code>TypeFamilies</code>, so Backpack really shines here!"}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1539794961, "post_id": 52851458, "comment_id": 92634424, "body": "Sorry if I missed something obvious as I&#39;m rather new to Haskell development, but I can&#39;t seem to find it on hackage. Is there a suggested way to use the project code externally? I saw <a href=\"https://github.com/haskell/cabal/issues/4206\" rel=\"nofollow noreferrer\">github.com/haskell/cabal/issues/4206</a> so assume you may be waiting on that to publish to hackage."}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1539795730, "post_id": 52851458, "comment_id": 92634768, "body": "Hmmm, I now see that backpacks are more than a conceptual idea and require using next.hackage (currently), but I don&#39;t see the packages there either."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1539835236, "post_id": 52851458, "comment_id": 92647273, "body": "@bbarker It&#39;s not on Hackage because maintaining it on Hackage requires to upload 20 packages. I would like to wait for <i>multiple public libraries</i> support to be implemented first (it&#39;s almost done and will be merged to <code>cabal</code> in nearest days). Meanwhile you can depend on GitHub repository, <code>cabal</code> allows to specify dependency on GitHub directly."}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 2, "last_activity_date": 1539768299, "creation_date": 1539768299, "answer_id": 52851458, "question_id": 52846646, "link": "https://stackoverflow.com/questions/52846646/is-there-a-standard-immutable-map-e-g-data-map-data-hashmap-typeclass-in-h/52851458#52851458", "title": "Is there a standard immutable &quot;Map&quot; (e.g. Data.Map, Data.HashMap) typeclass in Haskell?", "body": "<p>There're some unsolvable problems with having typeclass for the <code>Map</code>-like data structures. Fortunately, Backpack helps. You can see the interface for <code>Map</code> via Backpack here:</p>\n\n<ul>\n<li><a href=\"https://github.com/kowainik/containers-backpack\" rel=\"nofollow noreferrer\">https://github.com/kowainik/containers-backpack</a></li>\n</ul>\n\n<p>I've implemented this solution and a blog post about such interface:</p>\n\n<ul>\n<li><a href=\"https://kowainik.github.io/posts/2018-08-19-picnic-put-containers-into-a-backpack\" rel=\"nofollow noreferrer\">https://kowainik.github.io/posts/2018-08-19-picnic-put-containers-into-a-backpack</a></li>\n</ul>\n"}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1539796318, "creation_date": 1539744832, "last_edit_date": 1539796318, "question_id": 52846646, "link": "https://stackoverflow.com/questions/52846646/is-there-a-standard-immutable-map-e-g-data-map-data-hashmap-typeclass-in-h", "title": "Is there a standard immutable &quot;Map&quot; (e.g. Data.Map, Data.HashMap) typeclass in Haskell?", "body": "<p>It seems that the idea of a dictionary is one that gives rise to many different implementations, understandably. Since this is Haskell, I'll focus on immutable maps/hashes/dicts. I'd like to be able to use a typeclass for a little library I'm working on and allow users to choose their Hash/Map/Dict implementation.</p>\n\n<p>If there isn't a standard typeclass, it seems that providing a typeclass via hackage might be useful, and failing that, one could (as a library/API provider) still find benefit from using the hackage package or one's own typeclass to allow users to choose a given implementation for a Map.</p>\n\n<p>Assuming I haven't missed a typeclass for Dicts, is there anything in particular about immutable dictionaries that would not go well with typeclasses in Haskell?</p>\n\n<p><strong>Update</strong></p>\n\n<p>The more general question <a href=\"https://stackoverflow.com/questions/25191659\">Why is Haskell missing &quot;obvious&quot; Typeclasses</a> provides a lot of useful insight that goes a long way towards answering this question, but doesn't offer practical solutions to this particular case.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1539779899, "post_id": 52846280, "comment_id": 92625239, "body": "Sorting a list just to find the biggest element is inefficient. Sorting takes O(n lg n) time, while finding the biggest element only requires an O(n) scan of the list."}], "answers": [{"tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 1, "last_activity_date": 1539742055, "creation_date": 1539742055, "answer_id": 52846335, "question_id": 52846280, "link": "https://stackoverflow.com/questions/52846280/sorting-a-list-before-executing-the-guard-clause-in-haskell/52846335#52846335", "title": "Sorting a list before executing the guard clause in Haskell", "body": "<p>This is commonly done by defining a helper function that does the heavy processing work. Idiomatically this is named <code>go</code>.</p>\n\n<pre><code>place :: [Int] -&gt; Int\nplace = go . quicksort\n  where\n  go numlist\n    | length numlist /= 0 = biggestVal\n    where biggestVal = head numList\n</code></pre>\n\n<p>Note that this function doesn't need guards:</p>\n\n<pre><code>place :: [Int] -&gt; Int\nplace = go . quicksort\n  where go (x:_) = x\n        go _ = undefined  -- you didn't define this, what should you do??\n</code></pre>\n\n<p>Note also that to find the largest value in a list, you don't need to sort it first.</p>\n\n<pre><code>place [x] = x\nplace []  = undefined -- again: what should this be?\nplace xs  = foldr1 max xs\n</code></pre>\n\n<p>In fact, there's even a name for this:</p>\n\n<pre><code>place = maximum\n</code></pre>\n\n<p>It's even more polymorphic than you need:</p>\n\n<pre><code>maximum :: (Ord a, Foldable t) =&gt; t a -&gt; a\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1141, "user_id": 1367497, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c1ab83696683e53a9940cd2a8c480894?s=128&d=identicon&r=PG", "display_name": "peeyush singh", "link": "https://stackoverflow.com/users/1367497/peeyush-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1539743852, "creation_date": 1539743852, "answer_id": 52846515, "question_id": 52846280, "link": "https://stackoverflow.com/questions/52846280/sorting-a-list-before-executing-the-guard-clause-in-haskell/52846515#52846515", "title": "Sorting a list before executing the guard clause in Haskell", "body": "<p>In addition to the answer given by Adam, please think of the following:</p>\n\n<ol>\n<li><p>Am assuming you were looking for the guard so that your call to <code>head</code> after <code>quicksort</code> does not fail. Try to look at it this way: would you even want to try to sort an empty list? Max of empty list would be an empty list, so if you put a guard upfront and only sort->head in case it is not an empty list. </p></li>\n<li><p>In Haskell to check for empty list it is better to use <code>null</code> since <code>list</code> can be of infinite length. </p></li>\n<li><p>If you want to implement your own max function then sorting just for taking max is overkill as the number of comparison would be more than required. </p></li>\n</ol>\n"}], "owner": {"reputation": 121, "user_id": 10513295, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hNAO7bYMxyc/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsIIg2tLxpED_OmNmokxr3aKUTQQ/mo/photo.jpg?sz=128", "display_name": "jazzer97", "link": "https://stackoverflow.com/users/10513295/jazzer97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 52846335, "answer_count": 2, "score": -1, "last_activity_date": 1539743852, "creation_date": 1539741519, "question_id": 52846280, "link": "https://stackoverflow.com/questions/52846280/sorting-a-list-before-executing-the-guard-clause-in-haskell", "title": "Sorting a list before executing the guard clause in Haskell", "body": "<p>I've created an example where I have a list of integers:</p>\n\n<pre><code>mylist = [4,3,1,6,9]\n</code></pre>\n\n<p>and I have a function that prints out the maximum value in the list depending on whether or not the list has a length greater than 0. But instead of writing a function to print the maximum value, i want to sort the list in descending before hand and just return the head like so:</p>\n\n<pre><code>place :: [Int] -&gt; Int\nplace numlist\n    quicksort numlist --is it possible to sort a list beforehand before running the guard clause??\n    | length numlist /= 0 = biggestVal\n    where biggestVal = head numlist \n</code></pre>\n\n<p>where the quick sort function is:</p>\n\n<pre><code>quicksort :: [Int] -&gt; [Int]  \nquicksort [] = []  \nquicksort (x:xs) =   \n    let smallerSorted = quicksort [a | a &lt;- xs, a &gt;= x]  \n        biggerSorted = quicksort [a | a &lt;- xs, a &lt; x]  \n    in  smallerSorted ++ [x] ++ biggerSorted\n</code></pre>\n\n<p>In other words, I'm trying to quicksort the list before executing the where clause instead of having to write</p>\n\n<pre><code>where biggestVal = head $ quicksort numlist\n</code></pre>\n"}, {"tags": ["haskell", "polymorphism"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 8, "last_activity_date": 1539722913, "last_edit_date": 1539722913, "creation_date": 1539722387, "answer_id": 52843727, "question_id": 52843680, "link": "https://stackoverflow.com/questions/52843680/haskell-bags-how-can-i-use-polymorphism-in-haskell/52843727#52843727", "title": "Haskell - Bags - How can I use polymorphism in Haskell?", "body": "<h1>Defining a <code>data</code> type</h1>\n\n<p>This is not about functional programming itself. If you define a <code>data</code>type (or <code>newtype</code>), in Haskell it needs a <em>data constructor</em> (for <code>newtype</code> there can only be <em>one</em> data constructor, and with one parameter). <code>[(a, Amount)]</code> is however <em>not</em> a good \"name\" for a data constructor (well you did not intend to use that as a data constructor anyway).</p>\n\n<p>We can here write a data constructor like:</p>\n\n<pre><code>data Bag a = <b>Bag</b> [(a, Amount)]</code></pre>\n\n<p>and since here <code>Bag</code> contains (likely) one data constructor with <em>one</em> parameter, we can make it a <code>newtype</code>:</p>\n\n<pre><code><b>newtype</b> Bag a = Bag [(a, Amount)]</code></pre>\n\n<p>The above however might not be necessary: you might want to declare a type <em>alias</em> with <code>type</code>:</p>\n\n<pre><code><b>type</b> Bag a = [(a, Amount)]</code></pre>\n\n<p>in that case, you did <em>not</em> construct a new type, but you can write <code>Bag a</code>, and \"behind the curtains\", Haskell will replace this with <code>[(a, Amount)]</code>.</p>\n\n<h1>Define functions with <code>Bag</code></h1>\n\n<p>In case you now want to define a function that processes a <code>Bag</code>, you will need to specify the parameter <code>a</code> in the signature as well, for example:</p>\n\n<pre><code>count :: Eq a =&gt; [a] -&gt; Bag <b>a</b>\ncount =  -- ...</code></pre>\n\n<p>Now it is clear that we transform a list of <code>a</code>s, in a <code>Bag</code> of <code>a</code>s.</p>\n"}], "owner": {"reputation": 37, "user_id": 8751986, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209866723017300/picture?type=large", "display_name": "Hugo Casa&#241;as Salgado", "link": "https://stackoverflow.com/users/8751986/hugo-casa%c3%b1as-salgado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1539722913, "creation_date": 1539722117, "last_edit_date": 1539722189, "question_id": 52843680, "link": "https://stackoverflow.com/questions/52843680/haskell-bags-how-can-i-use-polymorphism-in-haskell", "title": "Haskell - Bags - How can I use polymorphism in Haskell?", "body": "<p>I have just started learning Haskell and still haven't grasped Functional Programming. I need to create a polymorphic datatype whose type I don't know until one of the functions I've written is run. The program seems to want me to build a list of tuples out of a list, e.g.:</p>\n\n<p><code>['Car', 'Car', 'Motorcycle', 'Motorcycle', 'Motorcycle', 'Truck']</code> would be converted to <code>[('Car', 2), ('Motorcycle', 3), ('Truck', 1)]</code>.</p>\n\n<p>Within a same list of tuples (a bag), all elements will be of the same type, but different bags may contain other types. Right now, my datatype declaration (I'm not sure if it's called 'declaration' in FP) goes:</p>\n\n<pre><code>type Amount = Int\ndata Bag a = [(a, Amount)]\n</code></pre>\n\n<p>However, when I try to load the module, I get this error:</p>\n\n<pre><code>Cannot parse data constructor in a data/newtype declaration: [(a, Amount)]\n</code></pre>\n\n<p>If I change <code>data</code> to <code>type</code> in the declaration, I get this error message for all functions:</p>\n\n<pre><code>Expecting one more argument to \u2018Bag\u2019\nExpected a type, but \u2018Bag\u2019 has kind \u2018* -&gt; *\u2019\n</code></pre>\n\n<p>Is there something I'm not grasping about FP or is it a code error?, and more importantly,  how can I declare this in a way that actually allows me to load the module into GHCi?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1539717873, "post_id": 52840280, "comment_id": 92601247, "body": "Why <code>[[&quot;222&quot;], [&quot;2&quot;], [&quot;333&quot;]]</code> instead of <code>[&quot;222&quot;, &quot;2&quot;, &quot;333&quot;]</code>?"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1539738344, "post_id": 52840280, "comment_id": 92607841, "body": "You may do like <code>myFunc = (group =&lt;&lt;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "is_accepted": false, "score": 4, "last_activity_date": 1539708421, "creation_date": 1539708421, "answer_id": 52840344, "question_id": 52840280, "link": "https://stackoverflow.com/questions/52840280/haskell-split-list/52840344#52840344", "title": "Haskell split list", "body": "<p>You can do this for a single string with <code>group</code> from <code>Data.List</code>:</p>\n\n<pre><code>group \"2333\" == [\"2\",\"333\"]\n</code></pre>\n\n<p>You can do an action for each element in a list with <code>map</code>:</p>\n\n<pre><code>map group [\"222\",\"2333\"] === [[\"222\"],[\"2\",\"333\"]]\n</code></pre>\n\n<p>You can flatten a list of lists with <code>concat</code>:</p>\n\n<pre><code>(concat $ map group [\"222\",\"2333\"]) == [\"222\",\"2\",\"333\"]\n</code></pre>\n\n<p>And there's a <code>concatMap</code> to do both at once:</p>\n\n<pre><code>concatMap group [\"222\",\"2333\"] == [\"222\",\"2\",\"333\"]\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 8077394, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e547ed41ce104877f55cfae87619f5af?s=128&d=identicon&r=PG&f=1", "display_name": "JohnTeiMir", "link": "https://stackoverflow.com/users/8077394/johnteimir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1539727230, "creation_date": 1539708167, "last_edit_date": 1539727230, "question_id": 52840280, "link": "https://stackoverflow.com/questions/52840280/haskell-split-list", "title": "Haskell split list", "body": "<p>I would like to separate this list, in a list of lists in which to separate whenever you see a different character, example:</p>\n\n<ul>\n<li><code>[\"222\", \"2333\"]</code> \u2192 <code>[[\"222\"], [\"2\"], [\"333\"]]</code></li>\n</ul>\n\n<p>Thank you for your help</p>\n"}, {"tags": ["haskell", "pretty-print"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1539711303, "post_id": 52840204, "comment_id": 92597954, "body": "Can you avoid needing it? (If you say a bit about why you think you need it, we may be able to help you avoid it.)"}, {"owner": {"reputation": 798, "user_id": 9223023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RTmMa.png?s=128&g=1", "display_name": "Petras Purlys", "link": "https://stackoverflow.com/users/9223023/petras-purlys"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1539713827, "post_id": 52840204, "comment_id": 92599221, "body": "I&#39;m composing a report / document out of several optional parts. It can be avoided using Maybes but that&#39;s just more code in comparison with what could be just empty documents."}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1539714169, "post_id": 52840204, "comment_id": 92599410, "body": "A useful function could be <code>catMaybes :: [Maybe a] -&gt; [a]</code> in Data.Maybe"}, {"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1582388999, "post_id": 52840204, "comment_id": 106764155, "body": "You&#39;re not the only one to have a problem  with <code>prettyprinter</code>&#39;s handling of empty documents: <a href=\"https://github.com/quchen/prettyprinter/issues/159\" rel=\"nofollow noreferrer\">github.com/quchen/prettyprinter/issues/159</a> Feel free to chime in! :)"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1539722576, "creation_date": 1539722576, "answer_id": 52843774, "question_id": 52840204, "link": "https://stackoverflow.com/questions/52840204/empty-zero-height-documents-in-haskell-prettyprinter/52843774#52843774", "title": "Empty (zero height) documents in Haskell prettyprinter", "body": "<p>No, <a href=\"http://hackage.haskell.org/package/prettyprinter-1.2.1/docs/src/Data.Text.Prettyprint.Doc.Internal.html#Doc\" rel=\"nofollow noreferrer\">there isn't</a>:</p>\n\n<pre><code>data Doc ann =\n    Fail\n    | Empty\n    | Char !Char\n    | Text !Int !Text\n    | Line\n    | FlatAlt (Doc ann) (Doc ann)\n    | Cat (Doc ann) (Doc ann)\n    | Nest !Int (Doc ann)\n    | Union (Doc ann) (Doc ann)\n    | Column (Int -&gt; Doc ann)\n    | WithPageWidth (PageWidth -&gt; Doc ann)\n    | Nesting (Int -&gt; Doc ann)\n    | Annotated ann (Doc ann)\n</code></pre>\n\n<p>None of these correspond to anything with a height under 1 -- the closest is <code>Empty</code>, but this is interpreted as a height-1 empty document (and your <code>emptyDoc</code> is <code>emptyDoc = Empty</code>).</p>\n\n<p>It does seem a bit infelicitous. Perhaps a patch to the library to add a truly empty document would be considered; it would certainly be the cleanest approach.</p>\n\n<p>Another possibility would be to use the annotation mechanism to make a \"this chunk has height 0\" annotation, and write your own renderer that handles this annotation.</p>\n\n<p>But using <code>Maybe (Doc foo)</code> or <code>[Doc foo]</code> as appropriate in positions where you may need a 0-height document is likely to be the most straightforward way to make progress.</p>\n"}], "owner": {"reputation": 798, "user_id": 9223023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RTmMa.png?s=128&g=1", "display_name": "Petras Purlys", "link": "https://stackoverflow.com/users/9223023/petras-purlys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 52843774, "answer_count": 1, "score": 3, "last_activity_date": 1539722576, "creation_date": 1539707869, "question_id": 52840204, "link": "https://stackoverflow.com/questions/52840204/empty-zero-height-documents-in-haskell-prettyprinter", "title": "Empty (zero height) documents in Haskell prettyprinter", "body": "<p>Is there a way to create a zero height empty document in <a href=\"http://hackage.haskell.org/package/prettyprinter\" rel=\"nofollow noreferrer\">prettyprinter</a>? emptyDoc has a height of 1 which then results in empty lines. I would also like to avoid using Maybes to solve this.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1539699105, "post_id": 52837350, "comment_id": 92591037, "body": "See <code>lookup :: Eq a =&gt; a -&gt; [(a,b)] -&gt; Maybe b</code>. Currently, you aren&#39;t dealing with the possibility that <code>studid</code> isn&#39;t found in the list."}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1539700096, "post_id": 52837350, "comment_id": 92591703, "body": "Why don&#39;t use Data.Map? It is efficient than recursive function. To find a element in Map, just O(log n) instead of O(n)"}], "answers": [{"tags": [], "owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "is_accepted": false, "score": 2, "last_activity_date": 1539698930, "creation_date": 1539698930, "answer_id": 52837462, "question_id": 52837350, "link": "https://stackoverflow.com/questions/52837350/getting-data-elements-through-match/52837462#52837462", "title": "Getting data elements through match", "body": "<p>Have you had a look at <a href=\"https://wiki.haskell.org/List_comprehension\" rel=\"nofollow noreferrer\">list comprehension</a>?</p>\n\n<pre><code>getStudMarks studentId marks = [ id | (student, id) &lt;- marks, student == studentId ]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 121, "user_id": 10513295, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hNAO7bYMxyc/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsIIg2tLxpED_OmNmokxr3aKUTQQ/mo/photo.jpg?sz=128", "display_name": "jazzer97", "link": "https://stackoverflow.com/users/10513295/jazzer97"}, "edited": false, "score": 0, "creation_date": 1539700381, "post_id": 52837520, "comment_id": 92591881, "body": "there seems to be an error going on in studId((id,mark):xs) = getStudMarks studId xs. Shouldnt it be id instead? I&#39;m confused"}, {"owner": {"reputation": 121, "user_id": 10513295, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hNAO7bYMxyc/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsIIg2tLxpED_OmNmokxr3aKUTQQ/mo/photo.jpg?sz=128", "display_name": "jazzer97", "link": "https://stackoverflow.com/users/10513295/jazzer97"}, "edited": false, "score": 0, "creation_date": 1539700521, "post_id": 52837520, "comment_id": 92591972, "body": "I&#39;m more familiar with the guards syntax in your first example. Would it be possible to cater for empty list [] in the guards statement?"}, {"owner": {"reputation": 1616, "user_id": 3478417, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Emaro.jpg?s=128&g=1", "display_name": "SBylemans", "link": "https://stackoverflow.com/users/3478417/sbylemans"}, "reply_to_user": {"reputation": 121, "user_id": 10513295, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hNAO7bYMxyc/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsIIg2tLxpED_OmNmokxr3aKUTQQ/mo/photo.jpg?sz=128", "display_name": "jazzer97", "link": "https://stackoverflow.com/users/10513295/jazzer97"}, "edited": false, "score": 0, "creation_date": 1539701874, "post_id": 52837520, "comment_id": 92592847, "body": "You can also use the multiple notation in combination with the guards, so first line of second option combined with first option. On the other hand the second option is how usually Haskell is written."}, {"owner": {"reputation": 1616, "user_id": 3478417, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Emaro.jpg?s=128&g=1", "display_name": "SBylemans", "link": "https://stackoverflow.com/users/3478417/sbylemans"}, "reply_to_user": {"reputation": 121, "user_id": 10513295, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hNAO7bYMxyc/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsIIg2tLxpED_OmNmokxr3aKUTQQ/mo/photo.jpg?sz=128", "display_name": "jazzer97", "link": "https://stackoverflow.com/users/10513295/jazzer97"}, "edited": false, "score": 1, "creation_date": 1539702048, "post_id": 52837520, "comment_id": 92592972, "body": "It should not be <code>getStudMarks id ((id,mark):xs)</code> instead of <code>getStudMarks studId ((id,mark):xs)</code> in the last line, because this case is covered in the second line of the second option."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1539702533, "post_id": 52837520, "comment_id": 92593260, "body": "<code>getStudMarks id ((id,mark):xs) = mark</code> is not valid Haskell."}, {"owner": {"reputation": 1616, "user_id": 3478417, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Emaro.jpg?s=128&g=1", "display_name": "SBylemans", "link": "https://stackoverflow.com/users/3478417/sbylemans"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1539758896, "post_id": 52837520, "comment_id": 92613289, "body": "@DanielWagner Was not sure if Haskell also supports pattern matching, like Prolog"}], "tags": [], "owner": {"reputation": 1616, "user_id": 3478417, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Emaro.jpg?s=128&g=1", "display_name": "SBylemans", "link": "https://stackoverflow.com/users/3478417/sbylemans"}, "is_accepted": false, "score": 1, "last_activity_date": 1539763668, "last_edit_date": 1539763668, "creation_date": 1539699181, "answer_id": 52837520, "question_id": 52837350, "link": "https://stackoverflow.com/questions/52837350/getting-data-elements-through-match/52837520#52837520", "title": "Getting data elements through match", "body": "<p>The recursion should be</p>\n\n<pre><code>getStudMarks studid [] = error \"No value for id\"\ngetStudMarks studid ((id,mark):xs) \n    | studid == id = mark\n    | otherwise = getStudMarks studid xs\n</code></pre>\n\n<p>Other possibility</p>\n\n<pre><code>getStudMarks id [] = error \"No value for id\"\ngetStudMarks studid ((id,mark):xs) = if studid == id then mark else getStudMarks studId xs\n</code></pre>\n\n<p>Inspired by <a href=\"http://learnyouahaskell.com/recursion\" rel=\"nofollow noreferrer\">LearnYouAHaskell</a></p>\n"}, {"comments": [{"owner": {"reputation": 121, "user_id": 10513295, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hNAO7bYMxyc/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsIIg2tLxpED_OmNmokxr3aKUTQQ/mo/photo.jpg?sz=128", "display_name": "jazzer97", "link": "https://stackoverflow.com/users/10513295/jazzer97"}, "edited": false, "score": 0, "creation_date": 1539700292, "post_id": 52837562, "comment_id": 92591830, "body": "I&#39;m only wrapping it to one layer of [] bracket [(StudID,Int)] instead of [[(StudID,Int)]]. And what do you mean by getStudMarks = lookup. I didn&#39;t understood that part"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 121, "user_id": 10513295, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hNAO7bYMxyc/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsIIg2tLxpED_OmNmokxr3aKUTQQ/mo/photo.jpg?sz=128", "display_name": "jazzer97", "link": "https://stackoverflow.com/users/10513295/jazzer97"}, "edited": false, "score": 0, "creation_date": 1539701461, "post_id": 52837562, "comment_id": 92592584, "body": "<code>(id, mark):xs</code> is <i>already</i> a list, defined by the <code>(:)</code> constructor. Wrapping it in <code>[...]</code> creates a list whose sole element is the matched list; it&#39;s identical to <code>((id,mark):xs):[]</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 121, "user_id": 10513295, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hNAO7bYMxyc/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsIIg2tLxpED_OmNmokxr3aKUTQQ/mo/photo.jpg?sz=128", "display_name": "jazzer97", "link": "https://stackoverflow.com/users/10513295/jazzer97"}, "edited": false, "score": 0, "creation_date": 1539701567, "post_id": 52837562, "comment_id": 92592648, "body": "<code>lookup</code> (which is already defined in the Prelude) is basically the function you are trying to define."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 4, "last_activity_date": 1539699690, "last_edit_date": 1539699690, "creation_date": 1539699316, "answer_id": 52837562, "question_id": 52837350, "link": "https://stackoverflow.com/questions/52837350/getting-data-elements-through-match/52837562#52837562", "title": "Getting data elements through match", "body": "<p><code>(id, mark):xs</code> is the list you want to pattern-match on; you are wrapping that in <em>another</em> layer of brackets that implies a value of type <code>[[(StudID, Int)]]</code>.</p>\n\n<pre><code>getStudMarks studid ((id,mark):xs) = if studid == id then mark else getStudMarks studid marks.\n</code></pre>\n\n<p>However, you also need to consider what happens if <code>getStudMarks</code> ever receives an <em>empty</em> list as its second argument, which will happen if <code>studid</code> is never found.</p>\n\n<pre><code>getStudMarks _ [] = ???\n</code></pre>\n\n<p>Compare your function to <code>lookup :: Eq =&gt; a -&gt; [(a,b)] -&gt; Maybe b</code> (which, incidentally is all you really need here; change the type of <code>getStudMarks</code>, write <code>getStudMarks = lookup</code>, and you're done). </p>\n"}], "owner": {"reputation": 121, "user_id": 10513295, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hNAO7bYMxyc/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsIIg2tLxpED_OmNmokxr3aKUTQQ/mo/photo.jpg?sz=128", "display_name": "jazzer97", "link": "https://stackoverflow.com/users/10513295/jazzer97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1539763668, "creation_date": 1539698621, "last_edit_date": 1539699201, "question_id": 52837350, "link": "https://stackoverflow.com/questions/52837350/getting-data-elements-through-match", "title": "Getting data elements through match", "body": "<p>I have an a list of data with the format <code>[(StudID,Int)]</code> where <code>type StudID = String</code>. Hence, I have a set of data:</p>\n\n<pre><code>marks = [(\"8\",90),(\"10\",100),(\"5\",86),(\"3\",45)]\n</code></pre>\n\n<p>I now want to obtain the second value based on a matching ID which is the first element in each tuple. For example, if the <code>ID</code> I'm looking for is <code>\"5\"</code> then I want the value of <code>86</code> and so on. I tried something as below:</p>\n\n<pre><code>getStudMarks :: StudID -&gt; [(StudID,Int)] -&gt; Int\ngetStudMarks studid [(id,mark):xs] = if studid == id then mark else getStudMarks studid xs\n</code></pre>\n\n<p>But I'm getting thrown </p>\n\n<blockquote>\n  <p>Couldn't match expected type \u2018(StudID, Int)\u2019 with actual type \u2018[(StudID, Int)]\u2019</p>\n</blockquote>\n\n<p>highlighting the <code>[(id,mark):xs]</code> section in my code</p>\n\n<p>Am I doing the recursion correctly?</p>\n"}, {"tags": ["arrays", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": false, "score": 1, "last_activity_date": 1539698617, "creation_date": 1539698617, "answer_id": 52837348, "question_id": 52833015, "link": "https://stackoverflow.com/questions/52833015/create-carray-of-carray/52837348#52837348", "title": "Create CArray of CArray", "body": "<p>You have to supply the return type for divArray function as:</p>\n\n<pre><code>divArray 3 testArr::CArray Int (CArray Int Double)\n</code></pre>\n\n<p>Otherwise, there is no default CArray instance of Foreign.Storable.Storable classtype. If no such instance, the below error will be arised  </p>\n\n<blockquote>\n  <p>No instance for (Foreign.Storable.Storable (CArray Int Double))</p>\n</blockquote>\n\n<p>Only the instances of Storable can be element of CArray.</p>\n"}], "owner": {"reputation": 827, "user_id": 1276388, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4ae985df9e533570f5ac2ea9bfc25dfd?s=128&d=identicon&r=PG", "display_name": "\u0397\u03bb\u03b5\u03ba\u03c4\u03c1\u03bf\u03bb\u03cc\u03b3\u03bf\u03c2 \u039c\u03b7\u03c7\u03b1\u03bd\u03b9\u03ba\u03cc\u03c2", "link": "https://stackoverflow.com/users/1276388/%ce%97%ce%bb%ce%b5%ce%ba%cf%84%cf%81%ce%bf%ce%bb%cf%8c%ce%b3%ce%bf%cf%82-%ce%9c%ce%b7%cf%87%ce%b1%ce%bd%ce%b9%ce%ba%cf%8c%cf%82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1539698617, "creation_date": 1539684481, "last_edit_date": 1539686326, "question_id": 52833015, "link": "https://stackoverflow.com/questions/52833015/create-carray-of-carray", "title": "Create CArray of CArray", "body": "<p>I want to create a CArray of CArray:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE FlexibleContexts #-}\n\nmodule Main where\n\nimport Data.Array.CArray\nimport Data.Array.Base\n\ntestArr :: CArray Int Double\ntestArr =  listArray (0,5) [0..5]\n\n-- divvyArray :: Int -&gt; CArray Int Double -&gt; CArray Int (CArray Int Double)\ndivArray w arr = arr'\n  where (m1,m2) = bounds arr\n        len = m2 - w + 2\n        divInd = zip [0..(m2-w+1)] [w..m2]\n        f ix = slice (0,w) ix arr \n        arr' = listArray (0,len) [ f k | k &lt;- divInd] \n</code></pre>\n\n<p>The code compiles and has type <code>divArray :: (Enum p, Shapable p, IArray a1 e, IArray a2 (a1 p e), Ix p, Num p) =&gt; p -&gt; a1 p e -&gt; a2 p (a1 p e)'</code></p>\n\n<p>But when I run it</p>\n\n<blockquote>\n  <p>divArray 3 testArray</p>\n</blockquote>\n\n<p>It gives this error:</p>\n\n<pre><code>&lt;interactive&gt;:168:1: error:\n    \u2022 Non type-variable argument\n        in the constraint: IArray a2 (CArray Int Double)\n      (Use FlexibleContexts to permit this)\n    \u2022 When checking the inferred type\n        it :: forall (a2 :: * -&gt; * -&gt; *).\n              IArray a2 (CArray Int Double) =&gt;\n              a2 Int (CArray Int Double)\n</code></pre>\n\n<p>Just to give an idea, in <code>[]</code>, the result should be:</p>\n\n<blockquote>\n  <p>divList 3 [0..5]</p>\n</blockquote>\n\n<pre><code>[[0..2],[1..3],[2..4],[3..5]]\n</code></pre>\n"}, {"tags": ["haskell", "haskell-lens"], "answers": [{"comments": [{"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1539694967, "post_id": 52834521, "comment_id": 92588248, "body": "Ahh, unfortunately my actual data type has 5 variants, not just 2. They all have the necessary lens though (see my edited version). However it might be possible to daisy-chain Eithers and <code>choosing</code>."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1539696024, "post_id": 52834521, "comment_id": 92588958, "body": "It turns out that writing the Iso is exactly as much code as writing the lens getter and setter functions; both need a forwards and backwards case for each constructor. So it looks like there isn&#39;t a clever way of doing this. If nobody comes up with anything else then I&#39;ll accept this as the best available answer."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1539713888, "post_id": 52834521, "comment_id": 92599263, "body": "What&#39;s TBRA? Google comes up empty."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1539729221, "post_id": 52834521, "comment_id": 92605840, "body": "@WillNess TBRA is to be read as <i>to be read as</i>. Hm, IMO that should be established ASAP. YMMV. <i>Anyway,..</i>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1539757151, "post_id": 52834521, "comment_id": 92612494, "body": "____chuckle____. :)"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 7, "last_activity_date": 1539729064, "last_edit_date": 1539729064, "creation_date": 1539689528, "answer_id": 52834521, "question_id": 52832649, "link": "https://stackoverflow.com/questions/52832649/how-can-i-write-a-lens-for-a-sum-type/52834521#52834521", "title": "How can I write a lens for a sum type", "body": "<p><a href=\"http://hackage.haskell.org/package/lens-4.17/docs/Control-Lens-Lens.html#v:choosing\" rel=\"nofollow noreferrer\">The function you probably want</a> is</p>\n\n<pre><code>choosing :: Functor f =&gt; LensLike f s t a b -&gt; LensLike f s' t' a b -&gt; LensLike f (Either s s') (Either t t') a b\n</code></pre>\n\n<p>to be read as</p>\n\n<pre><code>choosing :: Lens' s   a      -&gt; Lens' s'  a      -&gt; Lens' (Either s s')    a\n</code></pre>\n\n<p>or in your case</p>\n\n<pre><code>choosing :: Lens' Foo String -&gt; Lens' Bar String -&gt; Lens' (Either Foo Bar) String\n</code></pre>\n\n<p>To use that with <code>Problem</code>, you'll need the fact that <code>Problem</code> is actually isomorphic to <code>Either Foo Bar</code>. Existance of both a <code>Prism' Problem Foo</code> and <code>Prism' Problem Bar</code> isn't sufficient for that, because you could also have</p>\n\n<pre><code>data Problem' = Problem'Foo Foo\n              | Spoilsport\n              | Problem'Bar Bar\n</code></pre>\n\n<p>I don't think there's any standard TH utility for giving such an isomorphism using more than one constructor, but you can write it yourself, which is somewhat easier than writing the lens onto the string yourself:</p>\n\n<pre><code>delegateProblem :: Iso' Problem (Either Foo Bar)\ndelegateProblem = iso p2e e2p\n where p2e (ProblemFoo foo) = Left foo\n       p2e (ProblemBar bar) = Right bar\n       e2p (Left foo) = ProblemFoo foo\n       e2p (Right bar) = ProblemBar bar\n</code></pre>\n\n<p>and with that</p>\n\n<pre><code>problemName :: Lens' Problem String\nproblemName = delegateProblem . choosing fooName barName\n</code></pre>\n\n<p>Short version:</p>\n\n<pre><code>{-# LANGUAGE LambdaCase #-}\nproblemName = iso (\\case ProblemFoo foo -&gt; Left foo\n                         ProblemBar bar -&gt; Right bar)\n                  (\\case Left foo -&gt; ProblemFoo foo\n                         Right bar -&gt; ProblemBar bar)\n            . choosing fooName barName\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1539699883, "post_id": 52836898, "comment_id": 92591571, "body": "Ahh, right. I&#39;ve done it using the <code>lens</code> combinator with separate <code>goForwards</code> and <code>goBackwards</code> functions, making two cases for each constructor. But this does it with only one. Definitely neater, and probably the simplest possible solution."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 6, "last_activity_date": 1539697339, "creation_date": 1539697339, "answer_id": 52836898, "question_id": 52832649, "link": "https://stackoverflow.com/questions/52832649/how-can-i-write-a-lens-for-a-sum-type/52836898#52836898", "title": "How can I write a lens for a sum type", "body": "<p>Sure, it's very mechanical:</p>\n\n<pre><code>problemName :: Lens' Problem String\nproblemName f = \\case\n    ProblemFoo foo -&gt; ProblemFoo &lt;$&gt; fooName f foo\n    ProblemBar bar -&gt; ProblemBar &lt;$&gt; barName f bar\n    ProblemBaz baz -&gt; ProblemBaz &lt;$&gt; bazName f baz\n</code></pre>\n\n<p>It should be obvious how to extend this to further constructors, or even how to write a bit of TH for it provided you can think of a way to describe the right sub-lens to pick for each branch -- perhaps using a typeclass for dispatch or similar.</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 8, "last_activity_date": 1539706387, "last_edit_date": 1539706387, "creation_date": 1539704767, "answer_id": 52839350, "question_id": 52832649, "link": "https://stackoverflow.com/questions/52832649/how-can-i-write-a-lens-for-a-sum-type/52839350#52839350", "title": "How can I write a lens for a sum type", "body": "<p>You are right in that you can write it with <code>outside</code>. To begin with, some definitions:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n\nimport Control.Lens\n\nnewtype Foo = Foo { _fooName :: String }\n    deriving (Eq, Ord, Show)\nmakeLenses ''Foo\n\nnewtype Bar = Bar { _barName :: String }\n    deriving (Eq, Ord, Show)\nmakeLenses ''Bar\n\nnewtype Baz = Baz { _bazName :: String }\n    deriving (Eq, Ord, Show)\nmakeLenses ''Baz\n\ndata Problem =\n    ProblemFoo Foo |\n    ProblemBar Bar |\n    ProblemBaz Baz\n    deriving (Eq, Ord, Show)\nmakePrisms ''Problem\n</code></pre>\n\n<p>The above is just what you described in your question, except that I'm also making prisms for <code>Problem</code>.</p>\n\n<p>The type of <code>outside</code> (specialised to functions, simple lenses, and simple prisms, for the sake of clarity) is:</p>\n\n<pre><code>outside :: Prism' s a -&gt; Lens' (s -&gt; r) (a -&gt; r)\n</code></pre>\n\n<p>Given a prism for e.g. a case of a sum type, <code>outside</code> gives you a lens on functions from the sum type which targets the branch of the function that handles the case. Specifying all branches of the function amounts to handling all cases:</p>\n\n<pre><code>problemName :: Problem -&gt; String\nproblemName = error \"Unhandled case in problemName\"\n    &amp; outside _ProblemFoo .~ view fooName\n    &amp; outside _ProblemBar .~ view barName\n    &amp; outside _ProblemBaz .~ view bazName\n</code></pre>\n\n<p>That is rather pretty, except for the need to throw in the <code>error</code> case due to the lack of a sensible default. <a href=\"http://hackage.haskell.org/package/total-1.0.5/docs/Lens-Family-Total.html\" rel=\"noreferrer\">The <em>total</em> library</a> offers an alternative that improves on that and provides exhaustiveness checking along the way, as long as you are willing to contort your types a bit further:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n{-# LANGUAGE DeriveGeneric #-}\n\nimport Control.Lens\nimport GHC.Generics (Generic)\nimport Lens.Family.Total    \n\n-- etc.\n\n-- This is needed for total's exhaustiveness check.\ndata Problem_ a b c =\n    ProblemFoo a |\n    ProblemBar b |\n    ProblemBaz c\n    deriving (Generic, Eq, Ord, Show)\nmakePrisms ''Problem_\n\ninstance (Empty a, Empty b, Empty c) =&gt; Empty (Problem_ a b c)\n\ntype Problem = Problem_ Foo Bar Baz\n\nproblemName :: Problem -&gt; String\nproblemName = _case\n    &amp; on _ProblemFoo (view fooName)\n    &amp; on _ProblemBar (view barName)\n    &amp; on _ProblemBaz (view bazName)\n</code></pre>\n"}], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 480, "favorite_count": 1, "accepted_answer_id": 52839350, "answer_count": 3, "score": 9, "last_activity_date": 1603222762, "creation_date": 1539683359, "last_edit_date": 1603222762, "question_id": 52832649, "link": "https://stackoverflow.com/questions/52832649/how-can-i-write-a-lens-for-a-sum-type", "title": "How can I write a lens for a sum type", "body": "<p>I have a type like this:</p>\n<pre><code>data Problem =\n   ProblemFoo Foo |\n   ProblemBar Bar |\n   ProblemBaz Baz\n</code></pre>\n<p><code>Foo</code>, <code>Bar</code> and <code>Baz</code> all have a lens for their names:</p>\n<pre><code>fooName :: Lens' Foo String\nbarName :: Lens' Bar String\nbazName :: Lens' Baz String\n</code></pre>\n<p>Now I'd like to create a lens</p>\n<pre><code>problemName :: Lens' Problem String\n</code></pre>\n<p>Clearly I can write this using the <a href=\"http://hackage.haskell.org/package/lens-4.17/docs/Control-Lens-Lens.html#v:lens\" rel=\"nofollow noreferrer\"><code>lens</code></a> construction function and a pair of case statements, but is there a better way?</p>\n<p>The documentation for <a href=\"http://hackage.haskell.org/package/lens-4.17/docs/Control-Lens-Prism.html#v:outside\" rel=\"nofollow noreferrer\"><code>outside</code></a> talks about using a Prism as a kind of first-class pattern, which sounds suggestive, but I can't see how to actually make it happen.</p>\n<p>(Edit: added <code>Baz</code> case because my real problem isn't isomorphic with <code>Either</code>.)</p>\n"}, {"tags": ["json", "haskell", "aeson"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1539685429, "post_id": 52832266, "comment_id": 92582655, "body": "Have you tried <code>return (TechinicalAnalysis {..})</code> or <code>return $ TechinicalAnalysis {..}</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1539686672, "post_id": 52832266, "comment_id": 92583283, "body": "@MarkSeemann Just did, no luck :(   Got the same error"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "is_accepted": true, "score": 2, "last_activity_date": 1539696112, "creation_date": 1539696112, "answer_id": 52836463, "question_id": 52832266, "link": "https://stackoverflow.com/questions/52832266/parsing-a-nested-json-in-haskell-with-aeson/52836463#52836463", "title": "Parsing a nested JSON in Haskell with Aeson", "body": "<p>I solved the problem.</p>\n\n<p>What <code>.:</code> returns has the type <code>Object</code> and not <code>String</code></p>\n\n<p>So instead of this</p>\n\n<pre><code>data TechinicalAnalysis = TechinicalAnalysis {\n                   name :: String,\n                   date :: String,\n                   rsi  :: String\n                   } deriving (Show, Generic)\n</code></pre>\n\n<p>I wroth this</p>\n\n<pre><code>newtype TechinicalAnalysis = TechinicalAnalysis {\n                   rsi  :: String\n                   } deriving (Show, Generic)\n</code></pre>\n\n<p>and it worked seamlessly. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 52836463, "answer_count": 1, "score": 2, "last_activity_date": 1539696112, "creation_date": 1539682199, "last_edit_date": 1539687794, "question_id": 52832266, "link": "https://stackoverflow.com/questions/52832266/parsing-a-nested-json-in-haskell-with-aeson", "title": "Parsing a nested JSON in Haskell with Aeson", "body": "<p>I'm trying to learn the Aeson library in Haskell.\nRight now I'm trying to parse a simple JSON file which look like this </p>\n\n<pre><code>{\n    \"Meta Data\": {\n        \"1: Symbol\": \"MSFT\",\n        \"2: Indicator\": \"Relative Strength Index (RSI)\",\n        \"3: Last Refreshed\": \"2018-10-15\",\n        \"4: Interval\": \"weekly\",\n        \"5: Time Period\": 10,\n        \"6: Series Type\": \"open\",\n        \"7: Time Zone\": \"US/Eastern Time\"\n    },\n    \"Technical Analysis: RSI\": {\n        \"2018-10-15\": {\n            \"RSI\": \"54.5653\"\n        },\n        \"2018-10-12\": {\n            \"RSI\": \"63.0279\"\n        },\n        \"2018-10-05\": {\n            \"RSI\": \"74.7519\"\n        },\n        \"2018-09-28\": {\n            \"RSI\": \"72.1573\"\n        },\n        \"2018-09-21\": {\n            \"RSI\": \"74.8123\"\n        },\n        \"2018-09-14\": {\n            \"RSI\": \"66.7116\"\n        },\n        \"2018-09-07\": {\n            \"RSI\": \"75.8051\"\n        },\n..and so on\n</code></pre>\n\n<p>with the help of this tutorial on Aeson <a href=\"https://artyom.me/aeson\" rel=\"nofollow noreferrer\">Aeson: the tutorial</a>\nSpecifically the \"Nested records\" section </p>\n\n<hr>\n\n<p>This is what I've got so far.</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric     #-}\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE RecordWildCards   #-}\n\nmodule Tesst where\n\nimport           Data.Aeson\nimport qualified Data.ByteString.Lazy as B\nimport           Data.Time\nimport           GHC.Exts\nimport           GHC.Generics\nimport           Network.HTTP.Conduit (simpleHttp)\n\ndata TechinicalAnalysis = TechinicalAnalysis {\n                   name :: String,\n                   date :: String,\n                   rsi  :: String\n                   } deriving (Show, Generic)\n\n\ninstance FromJSON TechinicalAnalysis where\n  parseJSON = withObject \"RSI Quote\" $\n    \\o -&gt; do\n      rsiQuote &lt;- o        .: \"Technical Analysis: RSI\"\n      date     &lt;- rsiQuote .: \"2018-10-16\"\n      rsi      &lt;- date     .: \"RSI\"\n      return TechinicalAnalysis {..}\n\n\nmain :: IO ()\nmain = do\n  putStrLn \"Which ticker? \"\n  symbolToQuote &lt;- getLine\n  d &lt;- (eitherDecode &lt;$&gt; simpleHttp (\"https://www.alphavantage.co/query?function=RSI&amp;interval=weekly&amp;time_period=10&amp;series_type=open&amp;apikey==FI2KMCSDSAE&amp;symbol=\" ++ symbolToQuote)) :: IO (Either String TechinicalAnalysis)\n  case d of\n    Left e   -&gt; print e\n    Right qt -&gt; print (rsi qt)\n</code></pre>\n\n<hr>\n\n<p>My goal here is to get the latest \"RSI\" quote from the JSON file from the link.\nI'm not sure how to go about doing that right now, so for testing purposes I manually wroth the key <code>\"2018-10-16\"</code> in the <code>parseJSON</code> section.</p>\n\n<hr>\n\n<p>The error msg I get running the code is </p>\n\n<pre><code>    \u2022 Couldn't match type \u2018unordered-containers-0.2.9.0:Data.HashMap.Base.HashMap\n                             Data.Text.Internal.Text Value\u2019\n                     with \u2018[Char]\u2019\n      Expected type: String\n        Actual type: Object\n    \u2022 In the \u2018date\u2019 field of a record\n      In the first argument of \u2018return\u2019, namely \u2018TechinicalAnalysis {..}\u2019\n      In a stmt of a 'do' block: return TechinicalAnalysis {..}\n   |\n27 |       return TechinicalAnalysis {..}\n   |              ^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>Which I think is telling me that the response <code>date</code> got from <code>date &lt;- rsiQuote .: \"2018-10-15\"</code> isn't what I expected.</p>\n\n<hr>\n\n<p><a href=\"https://stackoverflow.com/questions/52763829/haskell-aeson-getting-nothing-when-trying-to-decode-json-url-req/52766730#52766730\">Here</a> you can find my previous questing and what I later figured out as an answer (different JSON file, parsed successfully)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1539676846, "post_id": 52828746, "comment_id": 92577651, "body": "As Yuji Yamamoto&#39;s answer points out, I made several errors when documenting that function. I&#39;m sorry for the confusion."}], "answers": [{"comments": [{"owner": {"reputation": 1069, "user_id": 4299824, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LKWkrlvV9UE/AAAAAAAAAAI/AAAAAAAABYQ/OWKjHFpdGGs/photo.jpg?sz=128", "display_name": "YAMAMOTO Yuji", "link": "https://stackoverflow.com/users/4299824/yamamoto-yuji"}, "edited": false, "score": 1, "creation_date": 1539673739, "post_id": 52829097, "comment_id": 92575941, "body": "NOTE: I&#39;ve sent a pull request to fix the errors <a href=\"https://github.com/haskell/containers/pull/573\" rel=\"nofollow noreferrer\">github.com/haskell/containers/pull/573</a>"}, {"owner": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "edited": false, "score": 0, "creation_date": 1539674690, "post_id": 52829097, "comment_id": 92576443, "body": "Hi, can you tell me what the type of <code>f</code> should be? Or what is the parameter of <code>f</code>? I think I did not understand what it does."}, {"owner": {"reputation": 1069, "user_id": 4299824, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LKWkrlvV9UE/AAAAAAAAAAI/AAAAAAAABYQ/OWKjHFpdGGs/photo.jpg?sz=128", "display_name": "YAMAMOTO Yuji", "link": "https://stackoverflow.com/users/4299824/yamamoto-yuji"}, "reply_to_user": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "edited": false, "score": 0, "creation_date": 1539674892, "post_id": 52829097, "comment_id": 92576526, "body": "It&#39;s <code>Maybe String -&gt; IO (Maybe String)</code>."}], "tags": [], "owner": {"reputation": 1069, "user_id": 4299824, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LKWkrlvV9UE/AAAAAAAAAAI/AAAAAAAABYQ/OWKjHFpdGGs/photo.jpg?sz=128", "display_name": "YAMAMOTO Yuji", "link": "https://stackoverflow.com/users/4299824/yamamoto-yuji"}, "is_accepted": true, "score": 3, "last_activity_date": 1539671043, "creation_date": 1539671043, "answer_id": 52829097, "question_id": 52828746, "link": "https://stackoverflow.com/questions/52828746/haskell-data-map-strict-alterf-parse-error-on-input/52829097#52829097", "title": "Haskell Data.Map.Strict alterF: parse error on input \u2018-&gt;\u2019", "body": "<p>It's just because the sample has a syntax error.</p>\n\n<p>To fix that, assign <code>f</code> with <code>=</code>.\nIn addition, the sample has several other errors.\nFixing all of them, it'd be:</p>\n\n<pre><code>interactiveAlter :: Int -&gt; Map Int String -&gt; IO (Map Int String)\ninteractiveAlter k m = alterF f k m where\n  f Nothing = do\n     putStrLn $ show k\n       ++ \" was not found in the map. Would you like to add it?\"\n     getUserResponse1 :: IO (Maybe String)\n\n  f (Just old) = do\n     putStrLn $ \"The key is currently bound to \"\n       ++ show old ++ \". Would you like to change or delete it?\"\n     getUserResponse2 :: IO (Maybe String)\n</code></pre>\n\n<p>But remember you must define <code>getUserResponse1</code> and <code>getUserResponse2</code> by yourself to actually run the code above.</p>\n"}], "owner": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 52829097, "answer_count": 1, "score": 1, "last_activity_date": 1539671043, "creation_date": 1539669385, "question_id": 52828746, "link": "https://stackoverflow.com/questions/52828746/haskell-data-map-strict-alterf-parse-error-on-input", "title": "Haskell Data.Map.Strict alterF: parse error on input \u2018-&gt;\u2019", "body": "<p>I tried the example on <a href=\"http://hackage.haskell.org/package/containers-0.6.0.1/docs/Data-Map-Strict.html#v:alterF\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/containers-0.6.0.1/docs/Data-Map-Strict.html#v:alterF</a> , and had an error in repl:</p>\n\n<pre><code>interactiveAlter :: Int -&gt; Map Int String -&gt; IO (Map Int String)\ninteractiveAlter k m = alterF f k m where\n  f Nothing -&gt; do\n     putStrLn $ show k ++\n         \" was not found in the map. Would you like to add it?\"\n     getUserResponse1 :: IO (Maybe String)\n  f (Just old) -&gt; do\n     putStrLn \"The key is currently bound to \" ++ show old ++\n         \". Would you like to change or delete it?\"\n     getUserresponse2 :: IO (Maybe String)\n\n\nerror:\n    parse error on input \u2018-&gt;\u2019\n    f Nothing -&gt; blah...\n              ^^\n</code></pre>\n\n<p>I noticed the <code>alterF</code> is not existed in other version of Data.Map.Strict. \nDoes this relate to the version of GHC? If so, how can I get the version of my compiler?</p>\n\n<p>What should I change to use this <code>alertF</code> in my project? I just want to use this <code>alterF</code> pattern to do something.</p>\n"}, {"tags": ["linux", "docker", "haskell", "haskell-stack", "libc"], "comments": [{"owner": {"reputation": 6953, "user_id": 4541045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfffa01cff641ad93fa459b26d3cdb4?s=128&d=identicon&r=PG&f=1", "display_name": "ti7", "link": "https://stackoverflow.com/users/4541045/ti7"}, "edited": false, "score": 1, "creation_date": 1539631026, "post_id": 52823328, "comment_id": 92563913, "body": "Adding another layer of complexity is unlikely to simplify your problem. Can you rebuild your program in the new environment or run it remotely?"}, {"owner": {"reputation": 115, "user_id": 6549493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2535754e54dc7fae66a4bfa9ff2372e?s=128&d=identicon&r=PG&f=1", "display_name": "ocstat", "link": "https://stackoverflow.com/users/6549493/ocstat"}, "reply_to_user": {"reputation": 6953, "user_id": 4541045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfffa01cff641ad93fa459b26d3cdb4?s=128&d=identicon&r=PG&f=1", "display_name": "ti7", "link": "https://stackoverflow.com/users/4541045/ti7"}, "edited": false, "score": 0, "creation_date": 1539631172, "post_id": 52823328, "comment_id": 92563983, "body": "I would rather do the compilation on my machine because the host is slow (not helped by stack taking a long time to compile all the dependencies), and I have limited bandwidth. But yes ideally I would have a machine which did have such an up to date version of glibc... I just wondered if anybody else had had this issue and solved it"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1539645564, "post_id": 52823328, "comment_id": 92568623, "body": "It can solve this problem yes. Are you sure your docker image has glibc 2.28? But can you not just update glibc on the host?"}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1539653683, "post_id": 52823328, "comment_id": 92570248, "body": "Just clearing up confusion: glibc 2 = libc6. glibc being backwards compatible means that newer glibc supports programs built for older glibc. You need glibc to be forwards compatible to get a program built on later glibc to work with older glibc; it is not."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 6549493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2535754e54dc7fae66a4bfa9ff2372e?s=128&d=identicon&r=PG&f=1", "display_name": "ocstat", "link": "https://stackoverflow.com/users/6549493/ocstat"}, "edited": false, "score": 0, "creation_date": 1539668506, "post_id": 52827558, "comment_id": 92573711, "body": "thanks! i feel a bit dumb about the backwards compatibility now... I have realised that I can try doing <code>FROM ubuntu:18.04 $do build$, FROM ubuntu:18.04 $copy executables$</code>"}, {"owner": {"reputation": 115, "user_id": 6549493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2535754e54dc7fae66a4bfa9ff2372e?s=128&d=identicon&r=PG&f=1", "display_name": "ocstat", "link": "https://stackoverflow.com/users/6549493/ocstat"}, "edited": false, "score": 0, "creation_date": 1539670865, "post_id": 52827558, "comment_id": 92574568, "body": "hmm just looked and the image <code>fpco&#47;stack-build:lts-12.9</code> uses ubuntu 16.04 (which has glibc &lt; 2.28) which implies that the docker container must be using the shared C libraries from my laptop rather than the ubuntu image (otherwise it would have &#39;just worked&#39;)? nonetheless i will try it with ubuntu 18.04 later"}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": true, "score": 1, "last_activity_date": 1539660367, "creation_date": 1539660367, "answer_id": 52827558, "question_id": 52823328, "link": "https://stackoverflow.com/questions/52823328/can-docker-solve-a-problem-of-mismatched-c-shared-libraries/52827558#52827558", "title": "Can docker solve a problem of mismatched C shared libraries?", "body": "<blockquote>\n  <p>Why am I getting this problem in the first place? I thought I read somewhere that glibc is backwards compatible? </p>\n</blockquote>\n\n<p>GLIBC <em>is</em> backwards compatible (programs built against old GLIBC continue to work on newer GLIBC), but the <em>inverse</em> is not true.</p>\n\n<p>In your case, you built on a newer (GLIBC-2.28) system, and are trying to run on an older one (GLIBC-2.27). That is not guaranteed to work (although it might for sufficiently simple programs).</p>\n\n<blockquote>\n  <p>Is there a way to use docker to get around this problem?</p>\n</blockquote>\n\n<p>You need to <em>build</em> against the oldest version of GLIBC that you are planning to use.</p>\n\n<p>You can achieve this in multiple ways:</p>\n\n<ul>\n<li>use a Linux to older Linux crosscompiler</li>\n<li>use a chroot build environment</li>\n<li>use a docker container with older GLIBC <em>at build time</em>.</li>\n</ul>\n\n<p>Or you could <em>run</em> in a docker container that has the GLIBC-2.28 that your program needs.</p>\n"}], "owner": {"reputation": 115, "user_id": 6549493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2535754e54dc7fae66a4bfa9ff2372e?s=128&d=identicon&r=PG&f=1", "display_name": "ocstat", "link": "https://stackoverflow.com/users/6549493/ocstat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3462, "favorite_count": 0, "accepted_answer_id": 52827558, "answer_count": 1, "score": 2, "last_activity_date": 1539660367, "creation_date": 1539630778, "question_id": 52823328, "link": "https://stackoverflow.com/questions/52823328/can-docker-solve-a-problem-of-mismatched-c-shared-libraries", "title": "Can docker solve a problem of mismatched C shared libraries?", "body": "<p>I am trying to run some haskell code on an ubuntu (18.04) host, which was compiled on my laptop.</p>\n\n<pre><code>host: 4.15.0-36-generic #39-Ubuntu SMP Mon Sep 24 16:19:09 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux\n\nlaptop: 4.14.74-1-MANJARO #1 SMP PREEMPT Fri Oct 5 14:16:52 UTC 2018 x86_64 GNU/Linux\n</code></pre>\n\n<p>The error I get is</p>\n\n<pre><code>/lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.28' not found\n</code></pre>\n\n<p>After doing some research I learned that this is because my laptop has version 2.28 of glibc installed, but the host only has libc6 2.27.</p>\n\n<p>I did some googling and figured that maybe docker could solve this problem. However, I just created a docker image with the following Dockerfile and it didn't work (same GLIBC_2.28 error)</p>\n\n<pre><code>FROM fpco/stack-build:lts-12.9 as builder\n\nRUN mkdir /opt/build\nCOPY . /opt/build\nRUN cd /opt/build &amp;&amp; stack build \n\nFROM ubuntu:18.04\nRUN mkdir -p /opt/myapp\nWORKDIR /opt/myapp\nRUN apt-get update &amp;&amp; apt-get install -y \\\n  ca-certificates\nCOPY --from=builder /opt/build/.stack-work/install/x86_64-linux-tinfo6/lts-12.9/8.4.3/bin .\nCMD [\"/opt/myapp/myapp-exe\"]\n</code></pre>\n\n<p>I'm not sure what to do now. I have a few questions:</p>\n\n<ul>\n<li><p>Why am I getting this problem in the first place? I thought I read somewhere that glibc is backwards compatible? (Is glibc the same thing as libc6..?)</p></li>\n<li><p>Is there a way to use docker to get around this problem? Could i run my build process inside an ubuntu image? e.g. <code>FROM fcpo/stack-build:lts-12.9 and ubutu:18.04</code>, then later on creating another ubuntu image into which i copy my binary?</p></li>\n<li><p>Has anybody else run into this before ? If so did you find a solution (other than just changing operating system?)?</p></li>\n</ul>\n"}, {"tags": ["list", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1539630849, "post_id": 52823253, "comment_id": 92563817, "body": "<code>mergeArrays = zipWith (%)</code> (or to go with @coredump&#39;s comment, <code>zipWith (,)</code>); in any case, always use <code>x : foo</code> instead of <code>[x] ++ foo</code>."}, {"owner": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "edited": false, "score": 5, "creation_date": 1539630868, "post_id": 52823253, "comment_id": 92563821, "body": "Don&#39;t store them as ratios, but as tuples"}, {"owner": {"reputation": 97, "user_id": 10422222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a66ede9ebac7c16933020177bc488f?s=128&d=identicon&r=PG&f=1", "display_name": "SeePlusPlus", "link": "https://stackoverflow.com/users/10422222/seeplusplus"}, "edited": false, "score": 0, "creation_date": 1539640215, "post_id": 52823253, "comment_id": 92567374, "body": "Yes, I ended up using this strategy."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 10422222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a66ede9ebac7c16933020177bc488f?s=128&d=identicon&r=PG&f=1", "display_name": "SeePlusPlus", "link": "https://stackoverflow.com/users/10422222/seeplusplus"}, "edited": false, "score": 0, "creation_date": 1539640181, "post_id": 52824429, "comment_id": 92567366, "body": "That&#39;s a good solution, thank you. I ended up converting them all to tuples, extracting the first and second parts, taking the gcd and checking to see if it was equal to 1. My solution is definitely not as clear and concise as yours."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1539635834, "creation_date": 1539635834, "answer_id": 52824429, "question_id": 52823253, "link": "https://stackoverflow.com/questions/52823253/how-to-keep-non-reduced-form-of-ratio-in-haskell/52824429#52824429", "title": "How to Keep Non-Reduced Form of Ratio in Haskell", "body": "<p>Since the ratios are reduced, checking that the gcd is 1 is the same as checking that the numerator hasn't changed.</p>\n\n<pre><code>import Data.Ratio\n\nrationalSumLowest :: Integer -&gt; [Rational]\nrationalSumLowest n =\n    [ v\n    | i &lt;- [1 .. n-1]\n    , let v = i % (n-i)\n    , numerator v == i\n    ]\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 10422222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a66ede9ebac7c16933020177bc488f?s=128&d=identicon&r=PG&f=1", "display_name": "SeePlusPlus", "link": "https://stackoverflow.com/users/10422222/seeplusplus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 1, "accepted_answer_id": 52824429, "answer_count": 1, "score": 3, "last_activity_date": 1547911409, "creation_date": 1539630380, "last_edit_date": 1547911409, "question_id": 52823253, "link": "https://stackoverflow.com/questions/52823253/how-to-keep-non-reduced-form-of-ratio-in-haskell", "title": "How to Keep Non-Reduced Form of Ratio in Haskell", "body": "<p>I am trying to create a function <code>rationalSumLowest</code> that takes an <code>Int n</code> and returns a list of ratio numbers that sum to <code>n</code>, but only showing the ratio numbers that are already in reduced form. I have attempted to do this by creating the following functions: </p>\n\n<pre><code>mergeArrays :: [Int] -&gt; [Int] -&gt; [Ratio Int]\nmergeArrays [] [] = []\nmergeArrays (x:xs) (y:ys) = [x%y] ++ mergeArrays xs ys\n\nrationalSum :: Int -&gt; [Ratio Int]\nrationalSum 0 = []\nrationalSum 1 = []\nrationalSum n = mergeArrays [1..(n-1)] [(n-1), (n-2)..1]\n\nsumLowestBool :: Ratio Int -&gt; Bool\nsumLowestBool x\n  |(gcd (extractNumerator (x)) (extractDenominator (x)) == 1) = True\n  |otherwise = False\n\nrationalSumLowest :: Int -&gt; [Ratio Int]\nrationalSumLowest 0 = []\nrationalSumLowest 1 = []\nrationalSumLowest n = [i | i &lt;- rationalSum (n), sumLowestBool i == True]\n</code></pre>\n\n<p>It should run like this: </p>\n\n<pre><code>*Main&gt; rationalSumLowest 5\n[1 % 4,2 % 3,3 % 2,4 % 1]\n*Main&gt; rationalSumLowest 8\n[1 % 7,3 % 5,5 % 3,7 % 1]\n*Main&gt; rationalSumLowest 12\n[1 % 11,5 % 7,7 % 5,11 % 1]\n</code></pre>\n\n<p>With <code>rationalSum</code> running like this: </p>\n\n<pre><code>*Main&gt; rationalSum 5\n[1 % 4,2 % 3,3 % 2,4 % 1]\n*Main&gt; rationalSum 8\n[1 % 7,1 % 3,3 % 5,1 % 1,5 % 3,3 % 1,7 % 1]\n*Main&gt; rationalSum 1\n[]\n</code></pre>\n\n<p>My <code>rationalSum</code> function works properly, but my <code>rationalSumLowest</code> function does not. It returns the same list as the <code>rationalSum</code> function. I know this is because in Haskell, all ratios are automatically reduced and thus my <code>sumLowestBool</code> would return <code>True</code> for all entries in the list.</p>\n\n<p>My question is: is there a way to keep the non-reduced form of the ratio in the original list so that my <code>sumLowestBool</code> function can work properly?</p>\n"}, {"tags": ["haskell", "sdl-2"], "comments": [{"owner": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "edited": false, "score": 2, "creation_date": 1539618738, "post_id": 52820250, "comment_id": 92558077, "body": "Load/import the re-exporting module in ghci and run &quot;:i P&quot; ?"}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "reply_to_user": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "edited": false, "score": 0, "creation_date": 1539630050, "post_id": 52820250, "comment_id": 92563424, "body": "I now realize I had actually found it, and that my error was that I had forgotten how <code>newtype</code> worked - still, all of these answers and comments have been useful."}], "answers": [{"comments": [{"owner": {"reputation": 7502, "user_id": 6368697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yq4cG.jpg?s=128&g=1", "display_name": "Patrick Mevzek", "link": "https://stackoverflow.com/users/6368697/patrick-mevzek"}, "edited": false, "score": 1, "creation_date": 1539621099, "post_id": 52820538, "comment_id": 92559130, "body": "While this link may answer the question, it is better to include the essential parts of the answer here and provide the link for reference.  Link-only answers can become invalid if the linked page changes. - <a href=\"/review/low-quality-posts/21138674\">From Review</a>"}, {"owner": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "reply_to_user": {"reputation": 7502, "user_id": 6368697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yq4cG.jpg?s=128&g=1", "display_name": "Patrick Mevzek", "link": "https://stackoverflow.com/users/6368697/patrick-mevzek"}, "edited": false, "score": 0, "creation_date": 1539622724, "post_id": 52820538, "comment_id": 92559896, "body": "Thank you!  Good advice.  Would you comment also apply to the answer from @Daniel Wagner?"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 2, "creation_date": 1539623352, "post_id": 52820538, "comment_id": 92560167, "body": "This answer would be a bit more useful if you explained how to search within a specific package. Otherwise, this does seem to answer the question since it was indeed just asking for a link."}], "tags": [], "owner": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "is_accepted": false, "score": 3, "last_activity_date": 1539623869, "last_edit_date": 1539623869, "creation_date": 1539618992, "answer_id": 52820538, "question_id": 52820250, "link": "https://stackoverflow.com/questions/52820250/where-is-sdl-p-point-constructor-defined/52820538#52820538", "title": "Where is SDL.P (Point constructor) defined?", "body": "<p>Is this it? It\u2019s all I could find using stackage search within the \u201csdl2\u201d package.<br>\n<a href=\"https://www.stackage.org/haddock/lts-12.13/sdl2-2.4.1.0/SDL-Internal-Vect.html#v:P\" rel=\"nofollow noreferrer\">https://www.stackage.org/haddock/lts-12.13/sdl2-2.4.1.0/SDL-Internal-Vect.html#v:P</a></p>\n\n<p>Edit, how I did it:</p>\n\n<p>You can limit the search offered by Stackage to a single package, using the URL: <a href=\"https://www.stackage.org/package/PACKAGE_NAME\" rel=\"nofollow noreferrer\">https://www.stackage.org/package/PACKAGE_NAME</a>, so in this case <a href=\"https://www.stackage.org/package/sdl2\" rel=\"nofollow noreferrer\">https://www.stackage.org/package/sdl2</a>.</p>\n\n<p>Searching for operators, put them in parentheses, such as \"(.)\".  For your question, search for \"P\" like so: <a href=\"https://www.stackage.org/lts-12.13/hoogle?q=P&amp;package=sdl2\" rel=\"nofollow noreferrer\">https://www.stackage.org/lts-12.13/hoogle?q=P&amp;package=sdl2</a></p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 4, "last_activity_date": 1539619536, "creation_date": 1539619536, "answer_id": 52820688, "question_id": 52820250, "link": "https://stackoverflow.com/questions/52820250/where-is-sdl-p-point-constructor-defined/52820688#52820688", "title": "Where is SDL.P (Point constructor) defined?", "body": "<p>Hackage has haddocks for the sdl2 package. If you click the \"Index\" link, then click \"P\", you can find a list of all identifiers that start with that letter -- including the P data type.</p>\n\n<p><a href=\"http://hackage.haskell.org/package/sdl2-2.4.1.0/docs/doc-index-P.html\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/sdl2-2.4.1.0/docs/doc-index-P.html</a></p>\n"}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1539623869, "creation_date": 1539617973, "question_id": 52820250, "link": "https://stackoverflow.com/questions/52820250/where-is-sdl-p-point-constructor-defined", "title": "Where is SDL.P (Point constructor) defined?", "body": "<p>I've attempted to comb <a href=\"https://github.com/haskell-game/sdl2\" rel=\"nofollow noreferrer\">the repository</a> (oh the joys of globally used single character names) without luck, but maybe I'm looking for the wrong things. </p>\n\n<p>Seeing documentation for SDL.P would probably also work. </p>\n\n<p>For future reference, is there a good way to go about finding data constructors in Haskell (as they seem to be difficult to grep for in the single-character case)?</p>\n"}, {"tags": ["haskell", "pattern-matching", "wildcard"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1539675078, "post_id": 52817665, "comment_id": 92576631, "body": "While you should use pattern <code>c</code> instead of <code>c@(_)</code>, there&#39;s nothing wrong with the latter. The real issue in the above code is that <code>c@(_)</code> is not indented as the <code>&#39;,&#39;</code> of the previous line, so it is parsed as the continuation of the previous line, as if you wrote a single line <code>&#39;,&#39; -&gt; go [] (....) xs c@(_) -&gt; go [] ...</code>"}], "answers": [{"comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 1, "creation_date": 1539610969, "post_id": 52817796, "comment_id": 92553578, "body": "@BercoviciAdrian: how is <code>66.3</code> an <code>Int</code>?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 1, "creation_date": 1539611037, "post_id": 52817796, "comment_id": 92553621, "body": "This looks like a classic problem: you aim to do <i>too</i> much in a single function. You can make a parser that omits the curly brackets, and splits the input by a comma, next it is only a <code>map</code>ping with <code>readMaybe</code>."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1539611067, "post_id": 52817796, "comment_id": 92553638, "body": "I am sorry it was a typo , it really does not matter if it is a <code>Int</code> or a <code>Double</code>.Initially i wanted to make something that could work on more types..but i let it <code>Int</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 1, "creation_date": 1539611164, "post_id": 52817796, "comment_id": 92553704, "body": "@BercoviciAdrian: well as said, I think it might be better to use a tool like <code>Parsec</code> (<a href=\"https://hackage.haskell.org/package/parsec\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/parsec</a>) to specify the &quot;grammar&quot; of your language and thus omitting the curly brackets, and split by a comma. You can then perform a simple <code>map readMaybe</code> to any type."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1539611318, "post_id": 52817796, "comment_id": 92553795, "body": "I wanted to still do some <code>primitive</code> operations to get the hang of it before i start <code>parsec</code>.Anywho you answered my question regarding <code>wild pattern</code>.I was curious  since there are times when i want to further  <code>branch</code> that <code>wild card</code>.(Something like <code>case x of t@(t1:t2) - &gt;</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 1, "creation_date": 1539611396, "post_id": 52817796, "comment_id": 92553846, "body": "@BercoviciAdrian: yes but that is when you specify a data constructor, so a <code>variablename@(constructor para meters)</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1539609878, "creation_date": 1539609878, "answer_id": 52817796, "question_id": 52817665, "link": "https://stackoverflow.com/questions/52817665/pattern-matching-on-wild-card/52817796#52817796", "title": "Pattern matching on wild card", "body": "<p>You can just use a <strong>variable identifier</strong>, a variable does not specify any pattern, so you can write it like:</p>\n\n<pre><code>readDataRaw::String -&gt; [Maybe Int]\nreadDataRaw (x:xs) = go [] [](x:xs) where\n    go _ ls [] = ls\n    go small big (x:xs) = case x of\n        '}' -&gt; big\n        ',' -&gt; go [] ((readMaybe small::Maybe Int):big)  xs \n        <b>c</b> -&gt; go [] c:small big xs</code></pre>\n\n<p>The above however has some errors, and incomplete patterns. For example in <code>readDataRaw</code> you only specify the <code>(x:xs)</code> pattern in the head, whereas it is - strictly speaking - possible that you call the function with an empty list <code>[]</code>. It also \"clashes\" with the <code>(x:xs)</code> in the <code>go</code> pattern: this is not a problem since Haskell takes the \"closest\" variable, so the one defined in th3e <code>go</code> clause, but it introduces some confusion. In the last case (with the <code>c</code>, you als return <code>go [] c : small big xs</code>, which will be interpreted as <code>(go [] c) : small big xs</code> which does not make much sense. A \"refactored\" implementation could look like:</p>\n\n<pre><code>readDataRaw::String -&gt; [Maybe Int]\nreadDataRaw = go [] [] where\n    go _ ls [] = ls\n    go small big (x:xs) = case x of\n        '}' -&gt; big\n        ',' -&gt; go [] ((readMaybe small::Maybe Int):big)  xs \n        <b>c</b> -&gt; go (c:small) big xs</code></pre>\n\n<p>But still, it is a bit \"ugly\". This is partly because it is unclear <em>what</em> you want to do.</p>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "accepted_answer_id": 52817796, "answer_count": 1, "score": 2, "last_activity_date": 1539610908, "creation_date": 1539609386, "last_edit_date": 1539610908, "question_id": 52817665, "link": "https://stackoverflow.com/questions/52817665/pattern-matching-on-wild-card", "title": "Pattern matching on wild card", "body": "<p>Hello i am trying to pattern match for a <em>wild card</em> pattern but I need to \"grab\" the <code>wild card</code>.I am trying to parse a <code>String</code> to a <code>list</code> of <code>Maybe Int</code>.<br><br>\n<strong>INPUT</strong><br><code>{123,aa,55,66}</code><br>\n<strong>OUTPUT</strong> <br><code>[Just 123,Nothing,Just 55.4,Just 66.3]</code><br><br>So I put together the following method:</p>\n\n<p><strong>Method</strong></p>\n\n<pre><code>readDataRaw::String-&gt;[Maybe Int]\n    readDataRaw (x:xs)=go [] [](x:xs) where\n            go _ ls []         = ls\n            go small big (x:xs)= case x of\n                                  '}'    -&gt; big\n                                  ','    -&gt; go [] ((readMaybe small::Maybe Int):big)  xs \n                                   c@(_) -&gt; go [] c:small big xs\n</code></pre>\n\n<p><strong>Error</strong></p>\n\n<pre><code>parse error on input `-&gt;'\n   |\n66 |                                    c@(_) -&gt; go [] c:small big xs\n   |                                          ^^\n</code></pre>\n\n<p>How can i use the wild card on the right side of the <code>-&gt;</code> in my last case ?</p>\n"}, {"tags": ["haskell", "floating-point"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1539587285, "post_id": 52811334, "comment_id": 92540641, "body": "How would you tell the compiler which type you were referring to like this?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1539587706, "post_id": 52811334, "comment_id": 92540837, "body": "If you use <code>floatRadix</code>, it would not be very clear if that is for a <code>Float</code>, or <code>Double</code>, etc."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 4, "creation_date": 1539588405, "post_id": 52811334, "comment_id": 92541178, "body": "In modern Haskell you could use explicit type applications (<a href=\"https://kseo.github.io/posts/2017-01-08-visible-type-application-ghc8.html\" rel=\"nofollow noreferrer\">kseo.github.io/posts/&hellip;</a>) with your design: <code>floatRadix @Float</code>. But they were only added recently."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1539606596, "post_id": 52811334, "comment_id": 92550853, "body": "See also: <a href=\"https://stackoverflow.com/a/48798638/5684257\">stackoverflow.com/a/48798638/5684257</a>"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 5, "last_activity_date": 1539589076, "last_edit_date": 1539589076, "creation_date": 1539588007, "answer_id": 52811560, "question_id": 52811334, "link": "https://stackoverflow.com/questions/52811334/why-are-floatrange-floatradix-and-floatdigits-functions/52811560#52811560", "title": "Why are floatRange, floatRadix and floatDigits functions?", "body": "<p>The problem with this is that you would construct the functions for multiple instances, like:</p>\n\n<pre><code>instance RealFloat Float where\n    -- ...\n    floatRadix = 2\n    floatDigits = 24\n    floatRange = (-125, 128)\n\ninstance RealFloat Double where\n    -- ...\n    floatRadix = 2\n    floatDigits = 53\n    floatRange = (-1021, 1024)\n</code></pre>\n\n<p>But now it creates a problem when you query for example <code>floatDigits</code>: for what instance should we take? The one for <code>Float</code>, or the one for <code>Double</code> (or another type)? All of these are valid candidates.</p>\n\n<p>By using an <code>a</code> parameter, we can make a disambiguation, for example:</p>\n\n<pre><code>Prelude&gt; floatDigits (0 :: Float)\n24\nPrelude&gt; floatDigits (0 :: Double)\n53\n</code></pre>\n\n<p>but it holds that the value of the parameter does not matter, for example:</p>\n\n<pre><code>Prelude&gt; floatDigits (undefined :: Float)\n24\nPrelude&gt; floatDigits (undefined :: Double)\n53\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 11, "last_activity_date": 1539590617, "creation_date": 1539590617, "answer_id": 52812209, "question_id": 52811334, "link": "https://stackoverflow.com/questions/52811334/why-are-floatrange-floatradix-and-floatdigits-functions/52812209#52812209", "title": "Why are floatRange, floatRadix and floatDigits functions?", "body": "<p>Your proposed non-function methods would have type</p>\n\n<pre><code>floatRadix' :: RealFloat a =&gt; Integer\nfloatDigits' :: RealFloat a =&gt; Int\n...\n</code></pre>\n\n<p>Those are <em>ambiguous types</em>: there is an <code>a</code> type variable, but it doesn't actually appear to the right of the <code>=&gt;</code> and thus can't be inferred from the context. Which is, in standard Haskell, really the <em>only</em> way you can infer such a type variable: local type signatures also can only to the signature head, not the constraint. so whether you write <code>(floatDigits' :: Int)</code> or <code>(floatDigits' :: RealFloat Double =&gt; Int)</code>, it won't actually work \u2013 the compiler can't infer that you mean the <code>instance RealFloat Double</code> version of the method.</p>\n\n<pre><code>class RealFloat' a where\n  floatDigits' :: Int\ninstance RealFloat' Double where\n  floatDigits' = floatDigits (0 :: Double)\n</code></pre>\n\n<pre>\n*Main> floatDigits' :: Int\n\n&lt;interactive>:3:1: error:\n    \u2022 No instance for (RealFloat' a0)\n        arising from a use of \u2018floatDigits'\u2019\n    \u2022 In the expression: floatDigits' :: Int\n      In an equation for \u2018it\u2019: it = floatDigits' :: Int\n*Main> floatDigits' :: RealFloat Double => Int\n\n&lt;interactive>:4:1: error:\n    \u2022 Could not deduce (RealFloat' a0)\n        arising from a use of \u2018floatDigits'\u2019\n      from the context: RealFloat Double\n        bound by an expression type signature:\n                   RealFloat Double => Int\n        at :4:17-39\n      The type variable \u2018a0\u2019 is ambiguous\n    \u2022 In the expression: floatDigits' :: RealFloat Double => Int\n      In an equation for \u2018it\u2019:\n          it = floatDigits' :: RealFloat Double => Int\n</pre>\n\n<p>For this reason, Haskell does not allow you to write methods with ambiguous type in the first place. Actually trying to compile the class as I wrote it above gives this error message:</p>\n\n<pre>    \u2022 Could not deduce (RealFloat' a0)\n      from the context: RealFloat' a\n        bound by the type signature for:\n                   floatDigits' :: forall a. RealFloat' a => Int\n        at /tmp/wtmpf-file3738.hs:2:3-21\n      The type variable \u2018a0\u2019 is ambiguous\n    \u2022 In the ambiguity check for \u2018floatDigits'\u2019\n      <b>To defer the ambiguity check to use sites, enable AllowAmbiguousTypes</b>\n      When checking the class method:\n        floatDigits' :: forall a. RealFloat' a => Int\n      In the class declaration for \u2018RealFloat'\u2019\n</pre>\n\n<p>The highlighted line cites however a GHC extension that says \u201cit's ok, I know what I'm doing\u201d. So if you add <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html?highlight=ambiguous#extension-AllowAmbiguousTypes\" rel=\"noreferrer\"><code>{-# LANGUAGE AllowAmbiguousTypes #-}</code></a> to the top of the file with the <code>class RealFloat'</code> in it, the compiler will accept that.</p>\n\n<p>What's the point though, when the instance can't be resolved at the use site? Well, it <em>can</em> actually be resolved, but only using <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html?highlight=ambiguous#extension-TypeApplications\" rel=\"noreferrer\">another pretty new GHC extension</a>:</p>\n\n<pre><code>*Main&gt; :set -XTypeApplications \n*Main&gt; floatDigits' @Double\n53\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 3, "last_activity_date": 1539719691, "last_edit_date": 1539719691, "creation_date": 1539618990, "answer_id": 52820537, "question_id": 52811334, "link": "https://stackoverflow.com/questions/52811334/why-are-floatrange-floatradix-and-floatdigits-functions/52820537#52820537", "title": "Why are floatRange, floatRadix and floatDigits functions?", "body": "<p>The <code>RealFloat</code> class is very old. Back when it was designed, nobody had worked out really good ways to pass extra type information to a function. At that time it was common to take an argument of the relevant type and expect the user to pass <code>undefined</code> at that type. As leftaroundabout explained, GHC now has extensions that do this pretty nicely most of the time. But before <code>TypeApplications</code>, two other techniques were invented to do this job more cleanly.</p>\n\n<p>To disambiguate without GHC extensions, you can use either proxy passing or newtype-based tagging. I believe both techniques were given their final forms by Edward Kmett with a last polymorphic spin by Shachaf Ben-Kiki (see <a href=\"https://stackoverflow.com/questions/37261593/who-invented-proxy-passing-and-when\">Who invented proxy passing and when?</a>). Proxy passing tends to give an easy-to-use API, while the newtype approach can be more efficient under certain circumstances. Here's the proxy-passing approach. This requires you to pass an argument of some type. Traditionally, the caller will use <code>Data.Proxy.Proxy</code>, which is defined</p>\n\n<pre><code>data Proxy a = Proxy\n</code></pre>\n\n<p>Here's how the class would look with proxy passing:</p>\n\n<pre><code>class (RealFrac a, Floating a) =&gt; RealFloat a where\n    floatRadix :: proxy a -&gt; Integer\n    floatDigits :: proxy a -&gt; Int\n    ...\n</code></pre>\n\n<p>And here's how it would be used. Note that there's no need to pass in a value of the type you're talking about; you just pass the proxy constructor.</p>\n\n<pre><code>foo :: Int\nfoo = floatDigits (Proxy :: Proxy Double)\n</code></pre>\n\n<p>To avoid passing a runtime argument at all, you can use tagging. This is often done with the <code>tagged</code> package, but it's quite easy to roll your own too. You could even reuse <code>Control.Applicative.Const</code>, but that doesn't communicate the intention so well.</p>\n\n<pre><code>newtype Tagged t a = Tagged\n  { unTagged :: a }\n</code></pre>\n\n<p>Here's how the class would look:</p>\n\n<pre><code>class (RealFrac a, Floating a) =&gt; RealFloat a where\n    floatRadix :: Tagged a Integer\n    floatDigits :: Tagged a Int\n    ...\n</code></pre>\n\n<p>And here's how you'd use it:</p>\n\n<pre><code>foo :: Int\nfoo = unTagged (floatDigits :: Tagged Double Int)\n</code></pre>\n"}], "owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 52820537, "answer_count": 3, "score": 7, "last_activity_date": 1539719691, "creation_date": 1539586999, "question_id": 52811334, "link": "https://stackoverflow.com/questions/52811334/why-are-floatrange-floatradix-and-floatdigits-functions", "title": "Why are floatRange, floatRadix and floatDigits functions?", "body": "<p>According to <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:floatRadix\" rel=\"noreferrer\">Hackage</a>, these functions of the <code>RealFloat</code> class are</p>\n\n<blockquote>\n  <p>... constant function[s] ...</p>\n</blockquote>\n\n<p>If they always remain at the same value, no matter the argument, as suggested by this description, why not simply use:</p>\n\n<pre><code>class (RealFrac a, Floating a) =&gt; RealFloat a where\n    floatRadix :: Integer\n    floatDigits :: Int\n    floatRange :: (Int, Int)\n    ...\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1539587113, "post_id": 52810991, "comment_id": 92540534, "body": "Haskell comments are written with <code>-- comment</code>, not <code>#comment</code>."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1539593786, "post_id": 52810991, "comment_id": 92543877, "body": "That&#39;s not array, it&#39;s a list."}], "answers": [{"tags": [], "owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "is_accepted": false, "score": 3, "last_activity_date": 1539585894, "creation_date": 1539585894, "answer_id": 52811076, "question_id": 52810991, "link": "https://stackoverflow.com/questions/52810991/sorting-a-list-of-cards/52811076#52811076", "title": "Sorting a list of cards", "body": "<p><code>x</code> is a single Card, and you're trying to index it with <code>x !! 1</code>. The first argument of <code>!!</code> must be a list (<code>[Card]</code>), but you supplied a <code>Card</code> instead, hence the error.</p>\n\n<p>I think you should compare with just <code>x</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": false, "score": 1, "last_activity_date": 1539589719, "creation_date": 1539589719, "answer_id": 52812021, "question_id": 52810991, "link": "https://stackoverflow.com/questions/52810991/sorting-a-list-of-cards/52812021#52812021", "title": "Sorting a list of cards", "body": "<p>The error is pointing out that you're trying to perform list-indexing (<code>!!</code>) on a <code>Card</code>, and a <code>Card</code> isn't a list.</p>\n\n<p>It looks like you're trying to use <code>!!</code> to extract the rank from a <code>Card</code>, possibly under the assumption that <code>Card</code> is index 0, and the <code>Rank</code> index 1.<br>\nThat's not something you can do, and not at all how anything works.  </p>\n\n<p>Since you've derived <code>Ord</code>, you can simply compare two <code>Card</code>s:</p>\n\n<pre><code>[a | a &lt;- xs, a &lt;= x]\n</code></pre>\n\n<p>If you hadn't derived <code>Ord</code>, you could have defined your own \"extractor\":</p>\n\n<pre><code>rank (Card r) = r\n\n...\n\n[a | a &lt;- xs, rank a &lt;= rank x]\n</code></pre>\n"}], "owner": {"reputation": 3258, "user_id": 7661005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0c49d2077073823b91fa1ccc82fa0d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Maxxx", "link": "https://stackoverflow.com/users/7661005/maxxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1539589719, "creation_date": 1539585550, "question_id": 52810991, "link": "https://stackoverflow.com/questions/52810991/sorting-a-list-of-cards", "title": "Sorting a list of cards", "body": "<p>I have a card datatype:</p>\n\n<pre><code>data Card = Card Rank\n   deriving (Ord)\n</code></pre>\n\n<p>where i can create numbered cards in an array denoted by:</p>\n\n<pre><code>mycard = [Card 1,Card 7, Card 3]\n</code></pre>\n\n<p>I'm now trying to sort the cards based on their rank in descending order particularly using quick sort. Hence i would get </p>\n\n<pre><code>[Card 7, Card 3, Card 1]\n</code></pre>\n\n<p>I wrote:</p>\n\n<pre><code>quicksort :: [Card] -&gt; [Card]  \nquicksort [] = []  \nquicksort (x:xs) =   \n    let smallerSorted = quicksort [a | a &lt;- xs, a &lt;= x !! 1]  #compare at index 1 which is the rank\n        biggerSorted = quicksort [a | a &lt;- xs, a &gt; x !! 1] #compare at index 1 which is the rank \n    in  smallerSorted ++ [x] ++ biggerSorted \n</code></pre>\n\n<p>But I'm getting an error saying</p>\n\n<pre><code>Couldn't match expected type \u2018[Card]\u2019 with actual type \u2018Card\u2019\n\u2022 In the first argument of \u2018(!!)\u2019, namely \u2018x\u2019\n  In the second argument of \u2018(&gt;)\u2019, namely \u2018x !! 1\u2019\n  In the expression: a &gt; x !! 1\n</code></pre>\n"}, {"tags": ["haskell", "recursion", "types", "return-type"], "comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 2, "creation_date": 1539586322, "post_id": 52810646, "comment_id": 92540146, "body": "It would be easier to answer your question if you added some examples of inputs and the corresponding outputs that you expect, like <code>findInt [...] == ...</code> for various cases."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1539586687, "post_id": 52810646, "comment_id": 92540338, "body": "As it is, your function says \u201cgiven a list of at least one element, if the first element is the integer 1, then return that integer, otherwise return a list beginning with the boolean <code>False</code> followed by the result of callling <code>findInt</code> on the remainder of the list; when given an empy list, raise an error\u201d, which doesn\u2019t make much sense, so it\u2019s difficult to determine what you\u2019re trying to do in order to help you."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 10502229, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Saki", "link": "https://stackoverflow.com/users/10502229/saki"}, "edited": false, "score": 0, "creation_date": 1539584473, "post_id": 52810730, "comment_id": 92539397, "body": "Ahhh thank you for pointing that out! But then now I have another error which also doesnt match the expected type  Couldn&#39;t match expected type \u2018Either Int Bool\u2019                   with actual type \u2018[Either a0 Bool]\u2019"}, {"owner": {"reputation": 303, "user_id": 8163791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fsyj2.jpg?s=128&g=1", "display_name": "Jacob Soderlund", "link": "https://stackoverflow.com/users/8163791/jacob-soderlund"}, "reply_to_user": {"reputation": 93, "user_id": 10502229, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Saki", "link": "https://stackoverflow.com/users/10502229/saki"}, "edited": false, "score": 1, "creation_date": 1539585079, "post_id": 52810730, "comment_id": 92539664, "body": "The problem is probably related to the fact that findInt&#39;s signature says it returns a single value, but in practice it can return a list (on the else line)."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1539596299, "post_id": 52810730, "comment_id": 92545147, "body": "I rolled back since I&#39;ve posted my own answer."}], "tags": [], "owner": {"reputation": 303, "user_id": 8163791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fsyj2.jpg?s=128&g=1", "display_name": "Jacob Soderlund", "link": "https://stackoverflow.com/users/8163791/jacob-soderlund"}, "is_accepted": false, "score": 4, "last_activity_date": 1539596275, "last_edit_date": 1539596275, "creation_date": 1539584309, "answer_id": 52810730, "question_id": 52810646, "link": "https://stackoverflow.com/questions/52810646/how-to-return-different-type-in-recursion-function-haskell/52810730#52810730", "title": "How to return different type in recursion function? (Haskell)", "body": "<p>If you have a look at the <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Either.html\" rel=\"nofollow noreferrer\">Either</a> type, you'll see that it has two constructors, <code>Left</code> and <code>Right</code>. In order to construct a value of the <code>Either</code> type, you need to use one of the constructors. e.g.</p>\n\n<pre><code>if x == 1 then Left x\n</code></pre>\n\n<p>Specifically, <code>Left</code> is used to construct the first type of the Either type (<code>Int</code> in this case), and <code>Right</code> is used for the second type (<code>Bool</code> in this case).</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1539593614, "post_id": 52811350, "comment_id": 92543792, "body": "Further, since <code>Right x</code> is only used with <code>x=False</code>, the type <code>Either Int Bool</code> is more complex than needed, and should probably be replaced with <code>Maybe Int</code>, adapting the code accordingly."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1539598361, "post_id": 52811350, "comment_id": 92546238, "body": "@chi you meant &quot;Maybe 1&quot;, i.e. <code>Bool</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1539600465, "post_id": 52811350, "comment_id": 92547308, "body": "No, I really meant <code>Maybe Int</code>. The point is that <code>Either Int Bool</code> is isomorphic to <code>Int</code> plus two &quot;special&quot; values (<code>Right True, Right False</code>). Still, the code above only uses one special value (<code>Right False</code>), so we could remove the other (<code>Right True</code>) which is unused from the type. Hence, we get <code>Maybe Int</code>, and we can let <code>findInt (x:xs) = if x==1 then Just x else findInt xs ; findInt [] = Nothing</code>"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1539608862, "post_id": 52811350, "comment_id": 92552269, "body": "@chi Since the only <code>Int</code> value ever returned is <code>1</code>, it could be further simplified from <code>Maybe Int</code> to <code>Bool</code>, where <code>Just 1</code> corresponds to <code>True</code>, and <code>Nothing</code> corresponds to <code>False</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1539620676, "post_id": 52811350, "comment_id": 92558969, "body": "@4castle Ah, I now see Will&#39;s point. Thanks. I agree: it should be <code>Bool</code> then. (Somehow, I wonder if this is what the OP really wanted.)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1539628793, "post_id": 52811350, "comment_id": 92562775, "body": "@chi and then it is just <code>elem 1</code>. but I read the question narrowly, as part of the OP&#39;s general process of learning the <i>language</i>. mastering the library can come later."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 3, "last_activity_date": 1539885235, "last_edit_date": 1539885235, "creation_date": 1539587063, "answer_id": 52811350, "question_id": 52810646, "link": "https://stackoverflow.com/questions/52810646/how-to-return-different-type-in-recursion-function-haskell/52811350#52811350", "title": "How to return different type in recursion function? (Haskell)", "body": "<p>Your function as given has no type: <code>x :: Int</code> and <code>(False : _) :: [Bool]</code>, and these two types can't be unified (read <code>::</code> as \"has a type\").</p>\n\n<p>Tweaked,</p>\n\n<pre><code>findInt (x:xs) =\n     if x == 1 then Left x\n     else Right False : findInt xs\n</code></pre>\n\n<p>it still has no type: <code>Left x :: Either Int b</code> and <code>(Right False : _) :: [Either a Bool]</code>, and these two types can't be unified either.</p>\n\n<p>But </p>\n\n<pre><code>findInt :: [Int] -&gt; Either Int Bool\nfindInt (x:xs) =\n     if x == 1 then Left x\n     else findInt xs\nfindInt [] = Right False\n</code></pre>\n\n<p>has a type, because <code>Left x :: Either Int b</code> and <code>Right False :: Either a Bool</code>, and these two types <em>can</em> be unified:</p>\n\n<pre><code>        Either Int b\n        Either a   Bool\n       -----------------      a ~ Int , b ~ Bool\n        Either Int Bool\n</code></pre>\n\n<p>The unified type is indeed <code>Either Int Bool</code>, as the type signature specifies.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1539609818, "creation_date": 1539609818, "answer_id": 52817778, "question_id": 52810646, "link": "https://stackoverflow.com/questions/52810646/how-to-return-different-type-in-recursion-function-haskell/52817778#52817778", "title": "How to return different type in recursion function? (Haskell)", "body": "<p>Since you never use <code>True</code> in your output, your use of <code>Either Int Bool</code> is isomorphic to <code>Maybe Int</code>:</p>\n\n<pre><code>a2b :: Either Int Bool -&gt; Maybe Int\na2b (Right x) = Just x\na2b (Left x) = Nothing\n\nb2a :: Maybe Int -&gt; Either Int Bool\nb2a (Just x) -&gt; Right x\nb2a Nothing -&gt; Left False\n</code></pre>\n\n<p>As such, I would just use <code>Maybe Int</code> to simplify your function.</p>\n\n<pre><code>findInt :: [Int] -&gt; Maybe Int\nfindInt [] = Nothing\nfindInt (x:xs) = if x == 1 then Just x else findInt xs\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 10502229, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Saki", "link": "https://stackoverflow.com/users/10502229/saki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 720, "favorite_count": 0, "accepted_answer_id": 52811350, "answer_count": 3, "score": 0, "last_activity_date": 1539885235, "creation_date": 1539583844, "last_edit_date": 1539586635, "question_id": 52810646, "link": "https://stackoverflow.com/questions/52810646/how-to-return-different-type-in-recursion-function-haskell", "title": "How to return different type in recursion function? (Haskell)", "body": "<p>I need to return for example either an integer or a Boolean in a recursive function.</p>\n\n<p>An example code of my problem:</p>\n\n<pre><code>findInt :: [Int] -&gt; Either Int Bool\nfindInt (x:xs) =\n     if x == 1 then x\n     else False : findInt xs\n</code></pre>\n\n<p>Then the error says <em>couldn't match expected type \"Either Int Bool\" with actual type \"Int\"</em>. But I want to check whether the element is in this list and if it does it will return the element and tell me if it's not by returning a Boolean.</p>\n"}, {"tags": ["haskell", "clojure", "haskell-wai"], "answers": [{"tags": [], "owner": {"reputation": 1227, "user_id": 5053374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe57f0998df065470ff42c938f781cf?s=128&d=identicon&r=PG", "display_name": "Libby", "link": "https://stackoverflow.com/users/5053374/libby"}, "is_accepted": true, "score": 5, "last_activity_date": 1539625367, "last_edit_date": 1539625367, "creation_date": 1539612121, "answer_id": 52818508, "question_id": 52809752, "link": "https://stackoverflow.com/questions/52809752/middleware-for-per-request-data/52818508#52818508", "title": "Middleware for per-request data", "body": "<p>This confused me for a long time too! But figuring it out gave me a helpful technique for understanding Haskell library types.</p>\n\n<p>First I'll start with my middleware being undefined:</p>\n\n<pre><code>myMiddleware :: Middleware\nmyMiddleware = undefined\n</code></pre>\n\n<p>So what is <code>Middleware</code>? The key is to look at the <a href=\"http://hackage.haskell.org/package/wai-3.2.1.2/docs/Network-Wai.html#t:Middleware\" rel=\"nofollow noreferrer\">definition of the type</a>: </p>\n\n<pre><code>type Middleware = Application -&gt; Application\n</code></pre>\n\n<p>Let's start at the first layer (or level of abstraction) by having the middleware take an Application and return an Application. We don't know how to modify an application, so we'll return exactly what's passed in for now.</p>\n\n<pre><code>myMiddleware :: Application -&gt; Application\nmyMiddleware theOriginalApp = theOriginalApp\n</code></pre>\n\n<p>But what is an Application? Again, let's <a href=\"http://hackage.haskell.org/package/wai-3.2.1.2/docs/Network-Wai.html#t:Application\" rel=\"nofollow noreferrer\">turn to Hackage</a>:</p>\n\n<pre><code>type Application = Request -&gt; (Response -&gt; IO ResponseReceived) -&gt; IO ResponseReceived\n</code></pre>\n\n<p>An Application is a function! We may not know exactly what each part is supposed to do or be, but we can find out. Let's replace <code>Application</code> in our type signature with the function type:</p>\n\n<pre><code>myMiddleware :: (Request -&gt; (Response -&gt; IO ResponseReceived) -&gt; IO ResponseReceived) \n             -&gt; (Request -&gt; (Response -&gt; IO ResponseReceived) -&gt; IO ResponseReceived)\nmyMiddleware theOriginalApp = theOriginalApp\n</code></pre>\n\n<p>Now we can see this type should allow us to access a <code>Request</code>! But how do we use it? </p>\n\n<p>We can expand <code>theOriginalApp</code> in the function definition into a lambda expression that matches the return type:</p>\n\n<pre><code>myMiddleware :: (Request -&gt; (Response -&gt; IO ResponseReceived) -&gt; IO ResponseReceived) \n             -&gt; (Request -&gt; (Response -&gt; IO ResponseReceived) -&gt; IO ResponseReceived)\nmyMiddleware theOriginalApp = (\\req sendResponse -&gt; undefined)\n</code></pre>\n\n<p>We can do whatever we want with the request now:</p>\n\n<pre><code>myMiddleware :: (Request -&gt; (Response -&gt; IO ResponseReceived) -&gt; IO ResponseReceived) \n             -&gt; (Request -&gt; (Response -&gt; IO ResponseReceived) -&gt; IO ResponseReceived)\nmyMiddleware theOriginalApp = (\\req sendResponse -&gt;\n  let myModifiedRequest = addSomeHeadersIfMissing req in\n    undefined)\n</code></pre>\n\n<p>Now what about that <code>undefined</code>? Well, we're trying to match our lambda to the type of that return function, which takes a Request and a function (that we don't care about) and returns an <code>IO ResponseReceived</code>. </p>\n\n<p>So, we need something that can use <code>myModifiedRequest</code> and return an <code>IO ResponseReceived</code>. Luckily our type signature indicates that <code>theOriginalApp</code> has the right type! To make it fit, we only need to give it the <code>sendResponse</code> function too.</p>\n\n<pre><code>myMiddleware :: (Request -&gt; (Response -&gt; IO ResponseReceived) -&gt; IO ResponseReceived) \n             -&gt; (Request -&gt; (Response -&gt; IO ResponseReceived) -&gt; IO ResponseReceived)\nmyMiddleware theOriginalApp = (\\req sendResponse -&gt;\n  let myModifiedRequest = addSomeHeadersIfMissing req in\n    theOriginalApp myModifiedRequest sendResponse)\n</code></pre>\n\n<p>And that's it, that will work! We can improve the readability by simplifying the type annotation back to <code>Middleware</code>, and getting rid of the lambda. (We can also <a href=\"https://wiki.haskell.org/Eta_conversion\" rel=\"nofollow noreferrer\">eta-reduce</a> and remove the <code>sendResponse</code> term from both the arguments and the definition, but I think it's clearer if it stays.)</p>\n\n<p>The result:</p>\n\n<pre><code>myMiddleware :: Middleware\nmyMiddleware theOriginalApp req sendResponse =\n  let myModifiedRequest = addSomeHeadersIfMissing req in\n    theOriginalApp myModifiedRequest sendResponse\n</code></pre>\n"}], "owner": {"reputation": 405, "user_id": 9348482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67dc5143c1ba85c2f417bf83ede6177f?s=128&d=identicon&r=PG&f=1", "display_name": "autumn322", "link": "https://stackoverflow.com/users/9348482/autumn322"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 3, "accepted_answer_id": 52818508, "answer_count": 1, "score": 6, "last_activity_date": 1539625367, "creation_date": 1539577497, "question_id": 52809752, "link": "https://stackoverflow.com/questions/52809752/middleware-for-per-request-data", "title": "Middleware for per-request data", "body": "<p>In <code>clojure</code>, I can write something like this:</p>\n\n<pre><code>(defn wrap-my-header\n  [handler]\n  (fn [request]\n    (let [request (if (get-in request [:headers \"my-header\"])\n                    (assoc request :has-my-header? true)\n                    request)]\n      (handler request))))\n</code></pre>\n\n<p>In this middleware, I'm checking if I have a non-nil value in <code>my-header</code> in <code>:headers</code>, if yes, I'll attach some data in the <code>request</code> map. This demonstrates that I can treat <code>request</code> and <code>response</code> as a somewhat \"stateful\" data.</p>\n\n<p>I'm still new in haskell and wanted to do similar things with <code>scotty</code>. After looking at the type of <a href=\"http://hackage.haskell.org/package/wai-3.2.1.2/docs/Network-Wai.html#t:Middleware\" rel=\"noreferrer\">middleware</a>, I can create a middleware like this:</p>\n\n<pre><code>myMiddleware :: Middleware \nmyMiddleware app req respond = app req respond\n</code></pre>\n\n<p>After staring at the type for a long time, I still don't know  how to do it. Some reading and thinking makes me assume that this is not possible, <code>Middleware</code> can only only short-circuit the handler and/or alter the generated response. Is this true?</p>\n\n<hr>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1539568828, "post_id": 52808724, "comment_id": 92535675, "body": "First, try creating a function of type <code>[P] -&gt; [String]</code>, then you can pass the result to the <code>F</code> constructor."}, {"owner": {"reputation": 13, "user_id": 9375305, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "user9375305", "link": "https://stackoverflow.com/users/9375305/user9375305"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1539569695, "post_id": 52808724, "comment_id": 92535836, "body": "what if I create [P] -&gt; [String] function, the input data type turn into be [String] so, [String] -&gt; F ??"}], "answers": [{"comments": [{"owner": {"reputation": 17989, "user_id": 365102, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e3139989e6548e7deac2cd45253d60df?s=128&d=identicon&r=PG", "display_name": "Mateen Ulhaq", "link": "https://stackoverflow.com/users/365102/mateen-ulhaq"}, "reply_to_user": {"reputation": 13, "user_id": 9375305, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "user9375305", "link": "https://stackoverflow.com/users/9375305/user9375305"}, "edited": false, "score": 0, "creation_date": 1539569660, "post_id": 52808854, "comment_id": 92535827, "body": "@user9375305 You could certainly have that as well (using tagged unions) but... I don&#39;t think you want that from your example."}], "tags": [], "owner": {"reputation": 17989, "user_id": 365102, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e3139989e6548e7deac2cd45253d60df?s=128&d=identicon&r=PG", "display_name": "Mateen Ulhaq", "link": "https://stackoverflow.com/users/365102/mateen-ulhaq"}, "is_accepted": false, "score": 0, "last_activity_date": 1539569541, "last_edit_date": 1539569541, "creation_date": 1539569271, "answer_id": 52808854, "question_id": 52808724, "link": "https://stackoverflow.com/questions/52808724/the-recursion-of-custom-data-type/52808854#52808854", "title": "the recursion of custom data type", "body": "<p>A simple way is to simply upgrade your <code>getname</code> function to take in lists using <code>map</code>:</p>\n\n<pre><code>checkout :: [P] -&gt; [F]\ncheckout xs = map getname xs where\n  getname (P name) = F [name]\n</code></pre>\n\n<p>But if you really want to explicitly recurse, we can just do the same thing the implementation of <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.Base.html#map\" rel=\"nofollow noreferrer\"><code>map</code></a> does:</p>\n\n<pre><code>checkout :: [P] -&gt; [F]\ncheckout [] = []\ncheckout (x:xs) = (getname x : checkout xs) where\n  getname (P name) = F [name]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 9375305, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "user9375305", "link": "https://stackoverflow.com/users/9375305/user9375305"}, "edited": false, "score": 0, "creation_date": 1539602203, "post_id": 52813174, "comment_id": 92548289, "body": "Thanks a lot , I tried to modify something , but I have got redundant warning, would you please see answer it - I just edited my question"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 13, "user_id": 9375305, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "user9375305", "link": "https://stackoverflow.com/users/9375305/user9375305"}, "edited": false, "score": 0, "creation_date": 1539602843, "post_id": 52813174, "comment_id": 92548645, "body": "@user9375305 If you want to use a list comprehension, you only need the line <code>checkout xs = F [ str | (P str) &lt;- xs ]</code> after the type signature, nothing else."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1539594254, "creation_date": 1539594254, "answer_id": 52813174, "question_id": 52808724, "link": "https://stackoverflow.com/questions/52808724/the-recursion-of-custom-data-type/52813174#52813174", "title": "the recursion of custom data type", "body": "<p>First, you can build a function <code>P -&gt; String</code>, which simply \"removes\" the <code>P</code> constructor</p>\n\n<pre><code>removeP :: P -&gt; String\nremoveP (P str) = str\n</code></pre>\n\n<p>Then, you can apply that on a list</p>\n\n<pre><code>removePs :: [P] -&gt; [String]\nremovePs xs = map removeP xs\n</code></pre>\n\n<p>Finally, we can exploit the constructor <code>F :: [String] -&gt; F</code> as follows</p>\n\n<pre><code>checkout :: [P] -&gt; F\ncheckout xs = F (removePs xs)\n</code></pre>\n\n<p>Alternatively, we could have used a list comprehension:</p>\n\n<pre><code>checkout xs = F [ str | (P str) &lt;- xs ]\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9375305, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "user9375305", "link": "https://stackoverflow.com/users/9375305/user9375305"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 52813174, "answer_count": 2, "score": -1, "last_activity_date": 1539602120, "creation_date": 1539567892, "last_edit_date": 1539602120, "question_id": 52808724, "link": "https://stackoverflow.com/questions/52808724/the-recursion-of-custom-data-type", "title": "the recursion of custom data type", "body": "<p>I am a quite newbie of haskell.<br>\nI am quite not sure of recursion of string.</p>\n\n<p>I made something simple example.  </p>\n\n<pre><code> data P = P String deriving (Show,Eq,Read)\n data F = F [String] deriving (Show,Eq,Read)\n\n checkout :: [P] -&gt; F\n checkout [] = F [\"\"]\n checkout (x:xs) = getname x where\n     getname (P ame) = F [ame ]\n     -- getname (P ame) = F [ame :(getname xs)] I tried like this but it is an error... \n</code></pre>\n\n<p>Main> checkout[(P \"S\"), (P \"WW\")] --> F[\"S\"] </p>\n\n<p>How can I get  F[\"S\", \"WW\"] ??</p>\n\n<p>One more question > </p>\n\n<pre><code>data P = P String Int deriving (Show,Eq,Read)\ndata F = F [String] [Int] deriving (Show,Eq,Read)\n\ncheckout :: [P] -&gt; F\ncheckout xs = F (removePs xs)\ncheckout xs = F [ str | (P str _ ) &lt;- xs ]\ncheckout xs = U [ o | (P _ o ) &lt;- xs ]\n</code></pre>\n\n<p>I have got redundant , is there any way to solve? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1539609517, "post_id": 52808323, "comment_id": 92552683, "body": "Note that <code>getMissing</code> doesn&#39;t really need to have <code>Maybe Int</code> as its return type; you are always getting <i>some</i> list as input, so you can always return at least 0. You&#39;ll do some additional filtering in the body, but the end result is that you can them simply define <code>getLengthOfMissingArray = fmap getMissing</code>."}], "answers": [{"tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": true, "score": 4, "last_activity_date": 1539568908, "creation_date": 1539568908, "answer_id": 52808822, "question_id": 52808323, "link": "https://stackoverflow.com/questions/52808323/haskell-maybe-parametric-polymorphism/52808822#52808822", "title": "Haskell Maybe/Parametric Polymorphism", "body": "<p><code>sequence :: [Maybe a] -&gt; Maybe [a]</code> will help you adapt your <code>[Maybe [Int]]</code> to <code>[[Int]]</code>.  </p>\n\n<p><code>join :: Maybe (Maybe a) -&gt; Maybe a</code> might also be useful.  </p>\n\n<p>Both <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Traversable.html#v:sequence\" rel=\"nofollow noreferrer\">sequence</a> and <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Monad.html#v:join\" rel=\"nofollow noreferrer\">join</a> have more general types - I wrote them as I expect you will use them here.</p>\n\n<p>You will see \"Ambiguous type variable\" errors when you pass a polymorphic value to a function that is polymorphic in its argument.  To actually run the function GHC needs to use a specific type, and it won't choose - you need to.  Since you want <code>getLengthOfMissingArray</code> to remain polymorphic, you can add a type signature to the test case to specify how the tests should run.</p>\n"}, {"tags": [], "owner": {"reputation": 479, "user_id": 4496701, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-SST61v329Q0/AAAAAAAAAAI/AAAAAAAAAFM/ihwdZ1nZE7Q/photo.jpg?sz=128", "display_name": "Cliff Stamp", "link": "https://stackoverflow.com/users/4496701/cliff-stamp"}, "is_accepted": false, "score": 0, "last_activity_date": 1539609327, "creation_date": 1539609327, "answer_id": 52817645, "question_id": 52808323, "link": "https://stackoverflow.com/questions/52808323/haskell-maybe-parametric-polymorphism/52817645#52817645", "title": "Haskell Maybe/Parametric Polymorphism", "body": "<p>Thanks to bergey (and dramforever on cw) :</p>\n\n<pre><code>getLengthOfMissingArray :: Eq a =&gt; Maybe [Maybe [a]] -&gt; Maybe Int \ngetLengthOfMissingArray maybelist = do\n  list  &lt;- maybelist \n  ns    &lt;- sequence list \n  getMissing ns\n\ngetMissing :: Eq a =&gt; [[a]] -&gt; Maybe Int \ngetMissing list\n  | any (==0) l0  = Nothing\n  | otherwise     = Just $ sumn mx - sumn (mn - 1) - sum l0\n  where\n    l0 = map length list\n    (mn,mx) = (minimum l0, maximum l0)\n    sumn n = n * (n + 1) `quot` 2\n</code></pre>\n\n<p>And adjusting the tests :</p>\n\n<pre><code>getLengthOfMissingArray (Nothing :: Maybe [Maybe [Int]]) `shouldBe` Nothing\n</code></pre>\n"}], "owner": {"reputation": 479, "user_id": 4496701, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-SST61v329Q0/AAAAAAAAAAI/AAAAAAAAAFM/ihwdZ1nZE7Q/photo.jpg?sz=128", "display_name": "Cliff Stamp", "link": "https://stackoverflow.com/users/4496701/cliff-stamp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 52808822, "answer_count": 2, "score": 0, "last_activity_date": 1539609327, "creation_date": 1539563628, "last_edit_date": 1539590875, "question_id": 52808323, "link": "https://stackoverflow.com/questions/52808323/haskell-maybe-parametric-polymorphism", "title": "Haskell Maybe/Parametric Polymorphism", "body": "<p>I have this code :</p>\n\n<pre><code>getLengthOfMissingArray :: Maybe [Maybe [Int]] -&gt; Maybe Int \ngetLengthOfMissingArray maybelist = do\n  ns &lt;- maybelist \n  getMissing ns\n\ngetMissing :: [Maybe [Int]] -&gt; Maybe Int \ngetMissing maybelist\n  | any (==Nothing) maybelist = Nothing\n  | any (==Just []) maybelist = Nothing\n  | otherwise                 = Just (sumn mx - sumn (mn - 1) - sum l0)\n  where\n    l0 = map length (catMaybes maybelist)\n    (mn,mx) = (minimum l0, maximum l0)\n    sumn n = n * (n + 1) `quot` 2\n</code></pre>\n\n<p>Which is a Haskell translation of this :</p>\n\n<p><a href=\"https://www.codewars.com/kata/length-of-missing-array\" rel=\"nofollow noreferrer\">https://www.codewars.com/kata/length-of-missing-array</a></p>\n\n<p>Now it works, however I have two issues :</p>\n\n<ul>\n<li>it is kind of fugly</li>\n<li>it should work on any list, not just int's</li>\n</ul>\n\n<p>I would like to have getMissing just be :</p>\n\n<pre><code>getMissing :: [[Int]] -&gt; Int \n</code></pre>\n\n<p>And then just use that function inside of the other one, but I don't know how to utilize that function on the <code>Maybe</code> of a <code>Maybe</code>.</p>\n\n<p>Second, I tried simply doing :</p>\n\n<pre><code>getMissing :: Eq a =&gt; [Maybe [a]] -&gt; Maybe Int \ngetLengthOfMissingArray :: Eq a =&gt; Maybe [Maybe [a]] -&gt; Maybe Int \n</code></pre>\n\n<p>But then Haskell generates errors when I try to use QuickCheck on test cases like :</p>\n\n<pre><code>getLengthOfMissingArray (Just [ Nothing, Just [ 4, 5, 1, 1 ], Just [ 1 ],\n                                Just [ 5, 6, 7, 8, 9 ] ])     `shouldBe` Nothing\n</code></pre>\n\n<p>That works, but this generates type errors :</p>\n\n<pre><code>getLengthOfMissingArray (Just [Just []])                      `shouldBe` Nothing\n</code></pre>\n\n<p>I guess without an actual <code>a</code> there there's an issue because if I just try to run it on a <code>Nothing</code> it also generates the same type error:</p>\n\n<blockquote>\n  <p>\"Ambiguous type variable \u2018a0\u2019 arising from a use of \u2018getLengthOfMissingArray\u2019\n        prevents the constraint \u2018(Eq a0)\u2019 from being solved.\"</p>\n</blockquote>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1539549740, "post_id": 52806912, "comment_id": 92531985, "body": "Why is this wrapped in an extra list? Why <code>[[(Bool, Bool, Bool)]]</code> and not just <code>[(Bool, Bool, Bool)]</code>?"}, {"owner": {"reputation": 23, "user_id": 4390793, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-p2zxOeZtNJw/AAAAAAAAAAI/AAAAAAAAAFU/HvZFH14w35c/photo.jpg?sz=128", "display_name": "bldzrr", "link": "https://stackoverflow.com/users/4390793/bldzrr"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1539549819, "post_id": 52806912, "comment_id": 92531998, "body": "@WillemVanOnsem because I&#39;m returning multiple lists inside of a list"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1539549888, "post_id": 52806912, "comment_id": 92532016, "body": "But your  tuple can only contain <i>one</i> list, so there is no reason here to wrap it in another list: the <i>inner</i> list will always be a singleton list (containing one element), so as a result you have a type that gives <i>less</i> constraints."}, {"owner": {"reputation": 371, "user_id": 10475958, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156768574859732/picture?type=large", "display_name": "Santiago Bruno", "link": "https://stackoverflow.com/users/10475958/santiago-bruno"}, "edited": false, "score": 2, "creation_date": 1539550234, "post_id": 52806912, "comment_id": 92532088, "body": "What&#39;s the purpose of the function? The example you gave just returns the same that was passed as parameter so I don&#39;t see where is the recursion and how the two integer parameters affect the function."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 0, "last_activity_date": 1539550211, "creation_date": 1539550211, "answer_id": 52806981, "question_id": 52806912, "link": "https://stackoverflow.com/questions/52806912/return-list-of-lists-of-3-tuples-using-recursion-in-haskell/52806981#52806981", "title": "Return List of Lists of 3 tuples using recursion in Haskell", "body": "<p>You do not need to use recursion. The list of 3-tuples is stored in the first parameter, so we can obtain it with:</p>\n\n<pre><code>recursFunction :: ([(Bool, Bool, Bool)], Int, Int) -&gt; [[(Bool, Bool, Bool)]]\nrecursFunction (l, _,_) = ...</code></pre>\n\n<p>here <code>l</code> will be the list of booleans, so <code>l</code> has type <code>l :: [(Bool, Bool, Bool)]</code>. If the output type is just <code>[(Bool, Bool, Bool)]</code>, we can thus return:</p>\n\n<pre><code>recursFunction :: ([(Bool, Bool, Bool)], Int, Int) -&gt; [(Bool, Bool, Bool)]\nrecursFunction (l, _,_) = l</code></pre>\n\n<p>otherwise we can wrap each 3-tuple in another list, for example with <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Applicative.html#v:pure\" rel=\"nofollow noreferrer\"><strong><code>pure :: Applicative f =&gt; a -&gt; f a</code></strong></a>. Here we <code>map</code> every element of the list (such element has type <code>(Bool, Bool, Bool)</code> in a <em>singleton</em> list, so:</p>\n\n<pre><code>recursFunction :: ([(Bool, Bool, Bool)], Int, Int) -&gt; [[(Bool, Bool, Bool)]]\nrecursFunction (l, _,_) = map pure l</code></pre>\n\n<p>But personally I do not see any benefit from this: since now it looks as if every element of the result is a list, and that list can - given the definition - contain zero, one or more elements. But since we know for sure it contains <em>exactly</em> one element, it is thus better <em>not</em> to wrap it in a list.</p>\n"}], "owner": {"reputation": 23, "user_id": 4390793, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-p2zxOeZtNJw/AAAAAAAAAAI/AAAAAAAAAFU/HvZFH14w35c/photo.jpg?sz=128", "display_name": "bldzrr", "link": "https://stackoverflow.com/users/4390793/bldzrr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1539550211, "creation_date": 1539549688, "question_id": 52806912, "link": "https://stackoverflow.com/questions/52806912/return-list-of-lists-of-3-tuples-using-recursion-in-haskell", "title": "Return List of Lists of 3 tuples using recursion in Haskell", "body": "<p>I'm a Haskell newb. I'm trying to write a recursive function that takes the argument:</p>\n\n<pre><code>([(Bool, Bool, Bool)], Int, Int)\n</code></pre>\n\n<p>and return a List of Lists of 3-tuples:</p>\n\n<pre><code>[[(Bool, Bool, Bool)]]\n</code></pre>\n\n<p>so for example a call of </p>\n\n<pre><code>recursFunction ([(True, False, False), (False, True, False)], 25, 25)\n</code></pre>\n\n<p>should return</p>\n\n<pre><code>[[(True, False, False)],[(False,True,False)]]\n</code></pre>\n\n<p>so far I have</p>\n\n<pre><code>recursFunction :: ([(Bool, Bool, Bool)], Int, Int) -&gt; [[(Bool, Bool, Bool)]]\nrecursFunction ([], y, z) = [[]]\n</code></pre>\n\n<p>I'm stuck and I'm not sure how to proceed or use recursion for this function.</p>\n"}, {"tags": ["haskell", "stackage", "lts"], "comments": [{"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 0, "creation_date": 1539544173, "post_id": 52805904, "comment_id": 92530644, "body": "Yes. but I guess the point of the LTS is to have packages that &quot;just work&quot;. which is why those that are problematic aren&#39;t listed. However I am aware of some packages in LTS that don&#39;t compile with stack out-of-the-box in some cases, specifically because stack doesn&#39;t set up msys properly on windows. So I&#39;m not sure anymore"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 0, "creation_date": 1539544467, "post_id": 52805904, "comment_id": 92530725, "body": "@M.Aroosi That&#39;s what confuses me: A works with LTS-X.Y + B, and A would work if B were in LTS-X.Y, and B would work as part of LTS. In other words, B and A would both &quot;just work&quot; together and as part of LTS."}], "answers": [{"comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1539568270, "post_id": 52808741, "comment_id": 92535558, "body": "So in a situation like the one described, A has to find a way to abandon its dependency on B. Correct?"}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 1, "creation_date": 1539569414, "post_id": 52808741, "comment_id": 92535775, "body": "Your options are to adopt MissingH, stop depending on it, or not put your package in Stackage."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1539570492, "post_id": 52808741, "comment_id": 92535975, "body": "Let\u2019s assume the whole point of the question is find a way for a to be in LTS."}], "tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": false, "score": 1, "last_activity_date": 1539568092, "creation_date": 1539568092, "answer_id": 52808741, "question_id": 52805904, "link": "https://stackoverflow.com/questions/52805904/is-a-package-excluded-from-stackage-lts-because-of-an-omitted-dependency/52808741#52808741", "title": "Is a package excluded from Stackage LTS because of an omitted dependency?", "body": "<p>Yes, for every package in a given Stackage snapshot, all of its transitive dependencies are also in the snapshot.  Also, packages are only included if the package's maintainer agrees to keep it up to date with respect to its dependencies.  There are more details about this in <a href=\"https://github.com/commercialhaskell/stackage\" rel=\"nofollow noreferrer\">the README on github</a>.  An <a href=\"https://github.com/commercialhaskell/stackage/blob/master/MAINTAINERS.md\" rel=\"nofollow noreferrer\">excerpt</a>:</p>\n\n<ul>\n<li>All packages are buildable and testable from Hackage. We recommend the Stack Travis script, which ensures a package is not accidentally incomplete.</li>\n<li>All packages are compatible with the newest versions of all dependencies (You can find restrictive upper bounds by visiting <a href=\"http://packdeps.haskellers.com/feed?needle=PACKAGENAME\" rel=\"nofollow noreferrer\">http://packdeps.haskellers.com/feed?needle=PACKAGENAME</a>).</li>\n<li>All packages in a snapshot are compatible with the versions of libraries that ship with the GHC used in the snapshot (more information on lenient lower bounds).</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "is_accepted": true, "score": 1, "last_activity_date": 1539624265, "creation_date": 1539624265, "answer_id": 52821859, "question_id": 52805904, "link": "https://stackoverflow.com/questions/52805904/is-a-package-excluded-from-stackage-lts-because-of-an-omitted-dependency/52821859#52821859", "title": "Is a package excluded from Stackage LTS because of an omitted dependency?", "body": "<p>I'll copy/paste <a href=\"https://github.com/commercialhaskell/stackage/commit/4ea291a1dab866866fb1e4080e3d94b34e4d1264#commitcomment-30898021\" rel=\"nofollow noreferrer\">my answer on github</a></p>\n\n<hr>\n\n<blockquote>\n  <p>does package A have to be excluded?</p>\n</blockquote>\n\n<p>No, it doesn't have to be excluded. Here's why:</p>\n\n<blockquote>\n  <p>even if the only reason B is excluded is because of a test suite dependency</p>\n</blockquote>\n\n<p>In this case, we can add B to the build plan and mark it under the <code>skipped-tests</code> section in order to avoid pulling in its test suite dependencies. This is true of both LTS and nightly snapshots.</p>\n\n<p>(However, a preferable course of action would be to remedy B's dependency issue so that the test suite can be run.)</p>\n\n<hr>\n\n<p>To further clarify, in response to @bergey's answer:</p>\n\n<blockquote>\n  <p>packages are only included if the package's maintainer agrees to keep it up to date with respect to its dependencies</p>\n</blockquote>\n\n<p>This is only true of packages <em>explicitly</em> included. Some packages are transitive dependencies, which are included <em>implicitly</em>, and are not necessarily held to such strict standards. (However, in the future we <em>may</em> eliminate the concept of implicit inclusion and instead include all packages explicitly.)</p>\n\n<p>Exceptions can also be made so that a package may be included, even though its <em>test suite</em> or its <em>benchmarks</em> have incompatible dependency constraints with the snapsnot.</p>\n\n<p>Of course the preferred way to go is to not need to make such exceptions, and we encourage all maintainers to keep all of their build targets up to date.</p>\n\n<p>Finally, allow me to note that this question would probably be more well suited for <a href=\"https://groups.google.com/forum/#!forum/stackage\" rel=\"nofollow noreferrer\">the stackage mailing list</a>, which is admittedly not well publicied or utilized.</p>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 2, "accepted_answer_id": 52821859, "answer_count": 2, "score": 2, "last_activity_date": 1539624265, "creation_date": 1539542338, "last_edit_date": 1539543941, "question_id": 52805904, "link": "https://stackoverflow.com/questions/52805904/is-a-package-excluded-from-stackage-lts-because-of-an-omitted-dependency", "title": "Is a package excluded from Stackage LTS because of an omitted dependency?", "body": "<p>I'm a bit confused about how a dependency on a package affects including it in Stackage LTS; specifically, if</p>\n\n<ul>\n<li><a href=\"http://hackage.haskell.org/package/crypto-enigma\" rel=\"nofollow noreferrer\">package A</a> requires <a href=\"http://hackage.haskell.org/package/MissingH\" rel=\"nofollow noreferrer\">package B</a>, and </li>\n<li>package A works when package B is <a href=\"https://github.com/orome/crypto-enigma-hs/blob/c04314957eaac47803e07a05b93cc9423eb9318e/travis-stacks/patch-lts-nightly.yaml\" rel=\"nofollow noreferrer\">installed as an extra-dep</a> on top of <a href=\"https://www.stackage.org/nightly-2018-10-14\" rel=\"nofollow noreferrer\">LTS-X.Y</a>, but </li>\n<li>package B itself is <a href=\"https://github.com/commercialhaskell/stackage/blob/a02196de09166134c916818c2f489b63b3c01a77/build-constraints.yaml#L3696\" rel=\"nofollow noreferrer\">not in LTS-X.Y</a>,</li>\n</ul>\n\n<p>does package A <a href=\"https://github.com/commercialhaskell/stackage/blob/a02196de09166134c916818c2f489b63b3c01a77/build-constraints.yaml#L3892\" rel=\"nofollow noreferrer\">have to be excluded</a> from LTS-X.Y, particularly if </p>\n\n<ul>\n<li>the only reason B is excluded is <a href=\"https://github.com/jgoerzen/missingh/issues/45#issuecomment-429644724\" rel=\"nofollow noreferrer\">because of a test suite dependency</a>, not a dependency in the library itself?</li>\n</ul>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1539542248, "post_id": 52805223, "comment_id": 92530146, "body": "@jberryman Uh, isn&#39;t that function <code>\\ _ _ -&gt; True</code>? I can&#39;t understand your hint. At the moment, I&#39;m unsure if this can be easily achieved with <code>foldr</code>. I&#39;d switch to explicit recursion and use some accumulator argument instead. (Perhaps there&#39;s a simpler way?)"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1539548644, "post_id": 52805223, "comment_id": 92531746, "body": "@chi oh you&#39;re right, without thinking I interpreted &quot;strictly increasing&quot; to mean a sequence that either ascends or descends by at most one. Obviously this is not what strictly increasing usually means, but I&#39;m not convinced it&#39;s not what op wants. Otherwise the problem statement is ambiguous e.g. <code>map return</code> is a valid solution. Similarly both examples op gives are valid solutions"}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 0, "creation_date": 1539549215, "post_id": 52805223, "comment_id": 92531873, "body": "I don\u2019t understand what you want the function to do.  You say one thing, and the example shows something else."}, {"owner": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "edited": false, "score": 0, "creation_date": 1539549536, "post_id": 52805223, "comment_id": 92531942, "body": "What should <code>[1,1,2]</code> give? Or <code>[2,1,1,2]</code>? Is your priority to favor earlier sequences or something more elaborate?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1539550524, "post_id": 52805223, "comment_id": 92532151, "body": "An observation: the output <code>[[5,6,7],[2],[1,1,1]]</code> meets the spec &quot;all sublists non-empty, all sublists either strictly increasing, strictly decreasing, or all-equal&quot;."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1539553201, "post_id": 52805223, "comment_id": 92532804, "body": "@DanielWagner ... and that spec is easily satisfied by <code>map pure</code> :) I guess the intent is to make the first list as long as possible, then the second one as long as possible, and so on."}, {"owner": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "edited": false, "score": 0, "creation_date": 1539553449, "post_id": 52805223, "comment_id": 92532851, "body": "Presumably a fourth requirement is that it should be &quot;eager&quot;, in the sense that the breaks should occur as late as possible."}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1539723868, "post_id": 52807064, "comment_id": 92603965, "body": "I&#39;ve posted an answer with a bit simpler code which does what your last code is doing, I think. It&#39;s an unfold."}, {"owner": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1539728454, "post_id": 52807064, "comment_id": 92605606, "body": "Clever! Simpler is debatable :). Not quite equivalent since this one is more lazy (e.g. <code>take 10 $ head $ splitSort [1..]</code> terminates)."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1539756834, "post_id": 52807064, "comment_id": 92612365, "body": "I wrote &quot;simpler-looking&quot; there, at first, but I guess I edited it to <i>simplify</i> it. ;) hmm. Good point about laziness. <code>length</code> is usually a no-no, and I played with fusing it into <code>splitAt</code> to make it count over the first group&#39;s spine instead of the numbers, essentially in unary, but it made the code much less &quot;simpler&quot;-looking so I decided against the edit."}], "tags": [], "owner": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "is_accepted": false, "score": 2, "last_activity_date": 1539587649, "last_edit_date": 1539587649, "creation_date": 1539550905, "answer_id": 52807064, "question_id": 52805223, "link": "https://stackoverflow.com/questions/52805223/split-a-list-into-non-empty-sub-lists-in-haskell/52807064#52807064", "title": "Split a list into non-empty sub-lists in Haskell", "body": "<p>Here is a kinda ugly solution, with three <code>reverse</code> in one line of code :).</p>\n\n<pre><code>addElement :: Ord a =&gt; a -&gt; [[a]] -&gt; [[a]]\naddElement a []  = [[a]]\naddElement a (x:xss) = case x of\n  (x1:x2:xs) \n    | any (check a x1 x2) [(==),(&lt;),(&gt;)] -&gt; (a:x1:x2:xs):xss\n    | otherwise -&gt; [a]:(x:xss)\n  _  -&gt; (a:x):xss\n  where \n    check x1 x2 x3 op = (x1 `op` x2) &amp;&amp; (x2 `op` x3) \n\nsplitSort xs = reverse $ map reverse $ foldr addElement [] (reverse xs)\n</code></pre>\n\n<p>You can possibly get rid of all the reversing if you modify <code>addElement</code> a bit.</p>\n\n<p>EDIT:\nHere is a less reversing version (even works for infinite lists):</p>\n\n<pre><code>splitSort2 []         = []\nsplitSort2 [x]        = [[x]]\nsplitSort2 (x:y:xys)  = (x:y:map snd here):splitSort2 (map snd later)\n  where \n    (here,later) = span ((==c) . uncurry compare) (zip (y:xys) xys)\n    c            = compare x y  \n</code></pre>\n\n<p>EDIT 2:\nFinally, here is a solution based on a single decorating/undecorating, that avoids comparing any two values more than once and is probably a lot more efficient.</p>\n\n<pre><code>splitSort xs = go (decorate xs) where\n  decorate :: Ord a =&gt; [a] -&gt; [(Ordering,a)]\n  decorate xs = zipWith (\\x y -&gt; (compare x y,y)) (undefined:xs) xs\n\n  go :: [(Ordering,a)] -&gt; [[a]]\n  go ((_,x):(c,y):xys)  = let (here, later) = span ((==c) . fst) xys in \n                              (x : y : map snd here) : go later\n  go xs = map (return . snd) xs -- Deal with both base cases\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "edited": false, "score": 0, "creation_date": 1539580624, "post_id": 52808042, "comment_id": 92538144, "body": "This doesn&#39;t quite work. It&#39;s missing cases (crashes for &#180;[]&#180; and &#180;[0]&#180;). Also for inputs like <code>[0,1,0,1]</code> it gives <code>[[0,1],[0],[1]]</code> which is hardly intended."}, {"owner": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "edited": false, "score": 0, "creation_date": 1539587382, "post_id": 52808042, "comment_id": 92540679, "body": "decorate-group-undecorate is unlikely to work very well with this problem. Consider the failing case of <code>[0,1,0,1]</code>, whether the last value should be grouped in with the previous or not depends not only on how it compares to the previous value, but also on how that value compares to the one before that - all the way back to the start of the list."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "edited": false, "score": 0, "creation_date": 1539587829, "post_id": 52808042, "comment_id": 92540882, "body": "@Jonas Dureg&#229;rd Thanks for the points. The edge cases like empty or single element lists are easy fix. As for consequent alterations of <code>Ordering</code> type it might need further thinking in this case."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1539588213, "post_id": 52808042, "comment_id": 92541077, "body": "This is written in a rather odd style. The point-free <code>f &lt;$&gt; g &lt;*&gt; h</code> meaning <code>\\ x -&gt; f (g x) (h x)</code> is okay, although not something I\u2019d present to a beginner. Other things to note: <code>zipWith (,)</code> can be simplified to <code>zip</code>; <code>groupBy (\\ p c -&gt; snd p == snd c)</code> can be written point-free as <code>groupBy ((==) `on` snd)</code> (where <code>on</code> is from <code>Data.Function</code>); and <code>groups &gt;&gt;= return . map fst</code> is more conventionally written <code>map fst &lt;$&gt; groups</code>, since <code>x &gt;&gt;= return . f</code> = <code>f &lt;$&gt; x</code>."}, {"owner": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "edited": false, "score": 0, "creation_date": 1539616432, "post_id": 52808042, "comment_id": 92556898, "body": "@Redu After edit <code>[0,0,1,0,-1]</code> still gives <code>[[0,0],[1],[0,-1]]</code>, no idea why it does that (gotta love QuickCheck). Also still missing the singleton case, <code>[0]</code> gives error (<code>tail []</code>)."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "edited": false, "score": 0, "creation_date": 1539617625, "post_id": 52808042, "comment_id": 92557519, "body": "@Jonas Dureg&#229;rd Has to make <code>squeeze</code> more clever but it&#39;s already my time off from office (beer time) so gotto do it later to night."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1540112195, "post_id": 52808042, "comment_id": 92737408, "body": "@Will Ness Your code is brilliant yet i think we both have got lost by overthinking. Sometimes it&#39;s much simpler than we have initially thought. Have a look at my last bit above, at the very end. :)"}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 2, "last_activity_date": 1540136494, "last_edit_date": 1540136494, "creation_date": 1539560365, "answer_id": 52808042, "question_id": 52805223, "link": "https://stackoverflow.com/questions/52805223/split-a-list-into-non-empty-sub-lists-in-haskell/52808042#52808042", "title": "Split a list into non-empty sub-lists in Haskell", "body": "<p>The initial try turned out to be lengthy probably inefficient but i will keep it striked for the sake of integrity with the comments. You best just skip to the end for the answer.</p>\n\n<p><s>Nice question... but turns out to be a little hard candy. My approach is in segments, those of each i will explain;</p>\n\n<pre><code>import Data.List (groupBy)\n\nsplitSort :: Ord a =&gt; [a] -&gt; [[a]]\nsplitSort (x:xs) = (:) &lt;$&gt; (x :) . head &lt;*&gt; tail $ interim\n                   where\n                   pattern = zipWith compare &lt;$&gt; init &lt;*&gt; tail\n                   tuples  = zipWith (,) &lt;$&gt; tail &lt;*&gt; pattern\n                   groups  = groupBy (\\p c -&gt; snd p == snd c) . tuples $ (x:xs)\n                   interim = groups &gt;&gt;= return . map fst\n\n*Main&gt; splitSort [5,6,7,2,1,1,1]\n[[5,6,7],[2,1],[1,1]]\n</code></pre>\n\n<ul>\n<li>The <code>pattern</code> function (<code>zipWith compare &lt;$&gt; init &lt;*&gt; tail</code>) is of type <code>Ord a =&gt; [a] -&gt; [Ordering]</code> when fed with <code>[5,6,7,2,1,1,1]</code> compares the <code>init</code> of it by the <code>tail</code> of it by <code>zipWith</code>. So the result would be <code>[LT,LT,GT,GT,EQ,EQ]</code>. This is the pattern we need.</li>\n<li>The <code>tuples</code> function will take the <code>tail</code> of our list and will tuple up it's elements with the corresponding elements from the result of <code>pattern</code>. So we will end up with something like <code>[(6,LT),(7,LT),(2,GT),(1,GT),(1,EQ),(1,EQ)]</code>.</li>\n<li>The <code>groups</code> function utilizes <a href=\"http://hackage.haskell.org/package/groupBy-0.1.0.0/docs/Data-List-GroupBy.html\" rel=\"nofollow noreferrer\"><code>Data.List.groupBy</code></a> over the second items of the tuples and generates the required sublists such as <code>[[(6,LT),(7,LT)],[(2,GT),(1,GT)],[(1,EQ),(1,EQ)]]</code></li>\n<li>Interim is where we monadically get rid of the <code>Ordering</code> type values and tuples. The result of interim is <code>[[6,7],[2,1],[1,1]]</code>.</li>\n<li>Finally at the main function body <code>(:) &lt;$&gt; (x :) . head &lt;*&gt; tail $ interim</code> appends the first item of our list (<code>x</code>) to the sublist at <code>head</code> (it has to be there whatever the case) and gloriously present the solution.</li>\n</ul>\n\n<p><strong>Edit:</strong> So investigating the <code>[0,1,0,1]</code> resulting <code>[[0,1],[0],[1]]</code> problem that @Jonas Dureg\u00e5rd discovered, we can conclude that in the result there shall be no sub lists with a length of 1 except for the last one when singled out. I mean for an input like <code>[0,1,0,1,0,1,0]</code> the above code produces <code>[[0,1],[0],[1],[0],[1],[0]]</code> while it should <code>[[0,1],[0,1],[0,1],[0]]</code>. So I believe adding a <code>squeeze</code> function at the very last stage should correct the logic.</p>\n\n<pre><code>import Data.List (groupBy)\n\nsplitSort :: Ord a =&gt; [a] -&gt; [[a]]\nsplitSort []     = []\nsplitSort [x]    = [[x]]\nsplitSort (x:xs) = squeeze $ (:) &lt;$&gt; (x :) . head &lt;*&gt; tail $ interim\n                   where\n                   pattern = zipWith compare &lt;$&gt; init &lt;*&gt; tail\n                   tuples  = zipWith (,) &lt;$&gt; tail &lt;*&gt; pattern\n                   groups  = groupBy (\\p c -&gt; snd p == snd c) $ tuples (x:xs)\n                   interim = groups &gt;&gt;= return . map fst\n\n                   squeeze []           = []\n                   squeeze [y]          = [y]\n                   squeeze ([n]:[m]:ys) = [n,m] : squeeze ys\n                   squeeze ([n]:(m1:m2:ms):ys) | compare n m1 == compare m1 m2 = (n:m1:m2:ms) : squeeze ys\n                                               | otherwise                     = [n] : (m1:m2:ms) : squeeze ys\n                   squeeze (y:ys)       = y : squeeze s\n\n*Main&gt; splitSort [0,1, 0, 1, 0, 1, 0]\n[[0,1],[0,1],[0,1],[0]]\n*Main&gt; splitSort [5,6,7,2,1,1,1]\n[[5,6,7],[2,1],[1,1]]\n*Main&gt; splitSort [0,0,1,0,-1]\n[[0,0],[1,0,-1]]\n</code></pre>\n\n<p>Yes; as you will also agree the code has turned out to be a little too lengthy and possibly not so efficient.</s></p>\n\n<p><strong>The Answer:</strong> I have to trust the back of my head when it keeps telling me i am not on the right track. Sometimes, like in this case, the problem reduces down to a single <code>if then else</code> instruction, much simpler than i had initially anticipated.</p>\n\n<pre><code>runner :: Ord a =&gt; Maybe Ordering -&gt; [a] -&gt; [[a]]\nrunner _       []  = []\nrunner _       [p] = [[p]]\nrunner mo (p:q:rs) = let mo'    = Just (compare p q)\n                         (s:ss) = runner mo' (q:rs)\n                     in if mo == mo' || mo == Nothing then (p:s):ss\n                                                      else [p] : runner Nothing (q:rs)\nsplitSort :: Ord a =&gt; [a] -&gt; [[a]]\nsplitSort = runner Nothing\n</code></pre>\n\n<p>My test cases</p>\n\n<pre><code>*Main&gt; splitSort [0,1, 0, 1, 0, 1, 0]\n[[0,1],[0,1],[0,1],[0]]\n*Main&gt; splitSort [5,6,7,2,1,1,1]\n[[5,6,7],[2,1],[1,1]]\n*Main&gt; splitSort [0,0,1,0,-1]\n[[0,0],[1,0,-1]]\n*Main&gt; splitSort [1,2,3,5,2,0,0,0,-1,-1,0]\n[[1,2,3,5],[2,0],[0,0],[-1,-1],[0]]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "edited": false, "score": 1, "creation_date": 1539605158, "post_id": 52814716, "comment_id": 92549973, "body": "If you clean this up a lot, you get the solution with all the reverses in my answer, but this one is less efficient (uses multiple ++ instead of a single reverse). You have a guard that checks <code>n1 == n2 || n1 &lt; n2 || n1 &gt; n2</code>, that whole expression can be replaced by True... Also you have large chunks of code that are identical except for the comparison operator - factor it out!"}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "reply_to_user": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "edited": false, "score": 0, "creation_date": 1539615358, "post_id": 52814716, "comment_id": 92556338, "body": "@Jonas Dureg&#229;rd Yes, the points you mentions above are right. It seems it can be to reverse whole list and all elements in sorted sub-list once after foldl construct the list."}], "tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": false, "score": 1, "last_activity_date": 1539624039, "last_edit_date": 1539624039, "creation_date": 1539599478, "answer_id": 52814716, "question_id": 52805223, "link": "https://stackoverflow.com/questions/52805223/split-a-list-into-non-empty-sub-lists-in-haskell/52814716#52814716", "title": "Split a list into non-empty sub-lists in Haskell", "body": "<p>I wonder whether this question can be solve using foldr if splits and groups a list from</p>\n\n<pre><code> [5,6,7,2,1,1,1]\n</code></pre>\n\n<p>to </p>\n\n<pre><code> [[5,6,7],[2,1],[1,1]]\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code> [[5,6,7],[2],[1,1,1]]\n</code></pre>\n\n<p>The problem is in each step of foldr, we only know the sorted sub-list on right-hand side and a number to be processed. e.g. after read [1,1] of [5,6,7,2,1,1,1] and next step, we have</p>\n\n<pre><code>1, [[1, 1]] \n</code></pre>\n\n<p>There are no enough information to determine whether make a new group of 1 or group 1 to [[1,1]]</p>\n\n<p>And therefore, we may construct required sorted sub-lists by reading elements of list from left to right, and why foldl to be used. Here is a solution without optimization of speed.</p>\n\n<p>EDIT:\nAs the problems that @Jonas Dureg\u00e5rd pointed out on comment, some redundant code has been removed, and beware that it is not a efficient solution.</p>\n\n<pre><code>splitSort::Ord a=&gt;[a]-&gt;[[a]]\nsplitSort numList = foldl step [] numList\n    where step [] n       = [[n]]\n          step sublists n = groupSublist (init sublists) (last sublists) n\n\n          groupSublist sublists [n1] n2 = sublists ++ [[n1, n2]]\n          groupSublist sublists sortedList@(n1:n2:ns) n3\n            | isEqual n1 n2 = groupIf (isEqual n2 n3) sortedList n3 \n            | isAscen n1 n2 = groupIfNull isAscen sortedList n3\n            | isDesce n1 n2 = groupIfNull isDesce sortedList n3\n            | otherwise     = mkNewGroup sortedList n3\n            where groupIfNull check sublist@(n1:n2:ns) n3\n                    | null ns   = groupIf (check n2 n3) [n1, n2] n3\n                    | otherwise = groupIf (check (last ns) n3) sublist n3\n                  groupIf isGroup | isGroup   = addToGroup\n                                  | otherwise = mkNewGroup\n                  addToGroup gp n = sublists ++ [(gp ++ [n])]\n                  mkNewGroup gp n = sublists ++ [gp] ++ [[n]]\n\n          isEqual x y = x == y\n          isAscen x y = x &lt; y\n          isDesce x y = x &gt; y\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "edited": false, "score": 1, "creation_date": 1539614944, "post_id": 52818616, "comment_id": 92556100, "body": "This solution is equivalent to <code>splitSort2</code> in my previous answer. Note that it  probably runs in O(N^2) worst case time (unless the compiler uses some really clever trick to cancel out the zipping/unzipping), which seems a bit unfortunate for this clearly O(N) problem."}], "tags": [], "owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "is_accepted": false, "score": 1, "last_activity_date": 1539612500, "creation_date": 1539612500, "answer_id": 52818616, "question_id": 52805223, "link": "https://stackoverflow.com/questions/52805223/split-a-list-into-non-empty-sub-lists-in-haskell/52818616#52818616", "title": "Split a list into non-empty sub-lists in Haskell", "body": "<p>For this solution I am making the assumption that you want the \"longest rally\". By that I mean: </p>\n\n<pre><code>splitSort [0, 1, 0, 1] = [[0,1], [0,1]]    -- This is OK\nsplitSort [0, 1, 0, 1] = [[0,1], [0], [1]] -- This is not OK despite of fitting your requirements \n</code></pre>\n\n<p>Essentially, There are two pieces:</p>\n\n<ul>\n<li>Firstly, split the list in two parts: <code>(a, b)</code>. Part <code>a</code> is the longest rally considering the order of the two first elements. Part <code>b</code> is the rest of the list.</li>\n<li>Secondly, apply <code>splitSort</code> on <code>b</code> and put all list into one list of list</li>\n</ul>\n\n<p>Taking the longest rally is surprisingly messy but straight. Given the list <code>x:y:xs</code>: by construction <code>x</code> and <code>y</code> will belong to the rally. The elements in <code>xs</code> belonging to the rally depends on whether or not they follow the <code>Ordering</code> of <code>x</code> and <code>y</code>. To check this point, you zip every element with the <code>Ordering</code> is has compared against its previous element and split the list when the <code>Ordering</code> changes. (edge cases are pattern matched) In code:</p>\n\n<pre><code>import Data.List\nimport Data.Function\n\n-- This function split the list in two (Longest Rally, Rest of the list)\nsplitSort' :: Ord a =&gt; [a] -&gt; ([a], [a])\nsplitSort'        []  = ([], [])\nsplitSort'     (x:[]) = ([x],[])\nsplitSort' l@(x:y:xs) = case span ( (o ==) . snd) $ zip (y:xs) relativeOrder of\n                            (f, s) -&gt; (x:map fst f, map fst s)\n  where relativeOrder = zipWith compare (y:xs) l\n        o = compare y x\n\n-- This applies the previous recursively\nsplitSort :: Ord a =&gt; [a] -&gt; [[a]]\nsplitSort        []  = []\nsplitSort     (x:[]) = [[x]]\nsplitSort   (x:y:[]) = [[x,y]]\nsplitSort l@(x:y:xs) = fst sl:splitSort (snd sl)\n  where sl = splitSort' l\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13772, "user_id": 379311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c993f4f111e6ff3211ccda1b98828253?s=128&d=identicon&r=PG", "display_name": "Yann Vernier", "link": "https://stackoverflow.com/users/379311/yann-vernier"}, "is_accepted": false, "score": 0, "last_activity_date": 1539774048, "last_edit_date": 1539774048, "creation_date": 1539687858, "answer_id": 52833999, "question_id": 52805223, "link": "https://stackoverflow.com/questions/52805223/split-a-list-into-non-empty-sub-lists-in-haskell/52833999#52833999", "title": "Split a list into non-empty sub-lists in Haskell", "body": "<p>My initial thought looks like:</p>\n\n<pre><code>ordruns :: Ord a =&gt; [a] -&gt; [[a]]\nordruns = foldr extend []\n  where\n    extend a [                    ] = [      [a]      ]\n    extend a (    [b]       : runs) =       [a,b]   : runs\n    extend a (run@(b:c:etc) : runs)\n      | compare a b == compare b c  =       (a:run) : runs\n      | otherwise                   = [a] : run     : runs\n</code></pre>\n\n<p>This eagerly fills from the right, while maintaining the <code>Ordering</code> in all neighbouring pairs for each sublist. Thus only the first result can end up with a single item in it. </p>\n\n<p>The thought process is this: an <code>Ordering</code> describes the three types of subsequence we're looking for: ascending <code>LT</code>, equal <code>EQ</code> or descending <code>GT</code>. Keeping it the same every time we add on another item means it will match throughout the subsequence. So we know we need to start a new run whenever the <code>Ordering</code> does not match. Furthermore, it's impossible to compare 0 or 1 items, so every run we create contains at least 1 and if there's only 1 we do add the new item. </p>\n\n<p>We could add more rules, such as a preference for filling left or right. A reasonable optimization is to store the ordering for a sequence instead of comparing the leading two items twice per item. And we could also use more expressive types. I also think this version is inefficient (and inapplicable to infinite lists) due to the way it collects from the right; that was mostly so I could use cons (<code>:</code>) to build the lists. </p>\n\n<p>Second thought: I could collect the lists from the left using plain recursion. </p>\n\n<pre><code>ordruns :: Ord a =&gt; [a] -&gt; [[a]]\nordruns [] = []\nordruns [a] = [[a]]\nordruns (a1:a2:as) = run:runs\n  where\n    runs = ordruns rest\n    order = compare a1 a2\n    run = a1:a2:runcontinuation\n    (runcontinuation, rest) = collectrun a2 order as\n    collectrun _ _ [] = ([], [])\n    collectrun last order (a:as)\n      | order == compare last a =\n          let (more,rest) = collectrun a order as\n          in (a:more, rest)\n      | otherwise = ([], a:as)\n</code></pre>\n\n<p>More exercises. What if we build the list of comparisons just once, for use in grouping?</p>\n\n<pre><code>import Data.List\n\nordruns3 [] = []\nordruns3 [a] = [[a]]\nordruns3 xs = unfoldr collectrun marked\n  where\n    pairOrder = zipWith compare xs (tail xs)\n    marked = zip (head pairOrder : pairOrder) xs\n    collectrun [] = Nothing\n    collectrun ((o,x):xs) = Just (x:map snd markedgroup, rest)\n      where (markedgroup, rest) = span ((o==).fst) xs\n</code></pre>\n\n<p>And then there's the part where there's a <code>groupBy :: (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]</code> but no <code>groupOn :: Eq b =&gt; (a -&gt; b) -&gt; [a] -&gt; [[a]]</code>. We can use a wrapper type to handle that. </p>\n\n<pre><code>import Data.List\n\ndata Grouped t = Grouped Ordering t\ninstance Eq (Grouped t) where\n  (Grouped o1 _) == (Grouped o2 _) = o1 == o2\nordruns4 [] = []\nordruns4 [a] = [[a]]\nordruns4 xs = unmarked\n  where\n    pairOrder = zipWith compare xs (tail xs)\n    marked = group $ zipWith Grouped (head pairOrder : pairOrder) xs\n    unmarked = map (map (\\(Grouped _ t) -&gt; t)) marked\n</code></pre>\n\n<p>Of course, the wrapper type's test can be converted into a function to use <code>groupBy</code> instead:</p>\n\n<pre><code>import Data.List\n\nordruns5 [] = []\nordruns5 [a] = [[a]]\nordruns5 xs = map (map snd) marked\n  where\n    pairOrder = zipWith compare xs (tail xs)\n    marked = groupBy (\\a b -&gt; fst a == fst b) $\n               zip (head pairOrder : pairOrder) xs\n</code></pre>\n\n<p>These marking versions arrive at the same decoration concept Jonas Dureg\u00e5rd applied. </p>\n"}, {"comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1539727545, "post_id": 52843783, "comment_id": 92605316, "body": "Hell yeah..! Rockstar..! Took me like 20 minutes to get wtf you had in your mind. But then you are over and over running <code>g</code> on the remainder part of the list... Hmmm..! You already know that right..? I have another idea, which will eventually make me delete my answer."}, {"owner": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1539755163, "post_id": 52843783, "comment_id": 92611804, "body": "@Redu Laziness should prevent any repeated comparisons, if that is what worries you (<code>head . group</code> is very lazy and doesn&#39;t touch most of the input list)."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1539756539, "post_id": 52843783, "comment_id": 92612260, "body": "@Redu why delete? the more the merrier! :) It took some playing with the data, and observation at the REPL, to come up with this. the end result seems obvious in retrospect."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1539761327, "post_id": 52843783, "comment_id": 92614580, "body": "@Redu ... you meant,  running <code>splitAt (length g + 1)</code> over and over, where <code>g</code> is the first group. So <code>group</code> is used to find the longest prefix, and <code>splitAt</code> actually takes it out (or, splits it off)."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1539762781, "last_edit_date": 1539762781, "creation_date": 1539722633, "answer_id": 52843783, "question_id": 52805223, "link": "https://stackoverflow.com/questions/52805223/split-a-list-into-non-empty-sub-lists-in-haskell/52843783#52843783", "title": "Split a list into non-empty sub-lists in Haskell", "body": "<p>Every ordered prefix is already in some order, and you don't care in which, as long as it is the longest: </p>\n\n<pre><code>import Data.List (group, unfoldr)\n\nfoo :: Ord t =&gt; [t] -&gt; [[t]]\nfoo = unfoldr f\n  where\n  f []  = Nothing\n  f [x] = Just ([x], [])\n  f xs  = Just $ splitAt (length g + 1) xs\n            where \n            (g : _) = group $ zipWith compare xs (tail xs)\n</code></pre>\n\n<hr>\n\n<p><code>length</code> can be fused in to make the <code>splitAt</code> count in unary essentially, and thus not be as strict (unnecessarily, as Jonas Dureg\u00e5rd rightly commented):</p>\n\n<pre><code>  ....\n  f xs  = Just $ foldr c z g xs\n            where \n            (g : _) = group $ zipWith compare xs (tail xs)\n            c _ r (x:xs) = let { (a,b) = r xs } in (x:a, b)\n            z     (x:xs) = ([x], xs)\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 10503579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3032201fe6d616038f5b1871d301608e?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymous Panther", "link": "https://stackoverflow.com/users/10503579/anonymous-panther"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1605, "favorite_count": 1, "answer_count": 6, "score": 5, "last_activity_date": 1540136494, "creation_date": 1539537943, "last_edit_date": 1539600866, "question_id": 52805223, "link": "https://stackoverflow.com/questions/52805223/split-a-list-into-non-empty-sub-lists-in-haskell", "title": "Split a list into non-empty sub-lists in Haskell", "body": "<p>I have to split the given list into non-empty sub-lists each of which\nis either in strictly ascending order, in strictly descending order, or contains all equal elements.  For example, [5,6,7,2,1,1,1] should become [[5,6,7],[2,1],[1,1]]. </p>\n\n<p>Here is what I have done so far: </p>\n\n<pre><code>splitSort :: Ord a =&gt; [a] -&gt; [[a]] \nsplitSort ns = foldr k [] ns\n  where\n    k a []  = [[a]]\n    k a ns'@(y:ys) | a &lt;= head y = (a:y):ys\n                   | otherwise = [a]:ns'\n</code></pre>\n\n<p>I think I am quite close but when I use it it outputs [[5,6,7],[2],[1,1,1]] instead of [[5,6,7],[2,1],[1,1]].</p>\n"}, {"tags": ["haskell", "hakyll"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1539539472, "post_id": 52805193, "comment_id": 92529321, "body": "See <a href=\"https://hackage.haskell.org/package/hakyll-4.12.4.0/docs/Hakyll-Web-Tags.html#t:Tags\" rel=\"nofollow noreferrer\">the documentation on what <code>Tags</code> are</a>. You will need to use one of the functions that take a <code>Tags</code> argument and produce a <code>Compiler</code> or better <code>Context</code>, that you can use instead of (or together with) the <code>defaultContext</code>."}, {"owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1539540582, "post_id": 52805193, "comment_id": 92529618, "body": "That documentation doesn&#39;t really make sense to me, as a beginner. What function should I use to take the <code>tags</code> that I generated, and make a context from it that contains a list of all tags, and all their associated posts?"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1539542803, "post_id": 52805193, "comment_id": 92530288, "body": "It&#39;s a normal <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses\" rel=\"nofollow noreferrer\">algebraic <code>data</code> type</a>. You can use <code>tagsMap tags</code> to get a list of tuples, each with a tag name and a list of page identifiers having that tag. Then read the <code>Template</code> and <a href=\"https://github.com/bergus/hakyll/blob/master/lib/Hakyll/Web/Template/Context.hs\" rel=\"nofollow noreferrer\"><code>Context</code> documentation</a> for how to build a <code>listField</code> from that, which you should be able to use to render a list of tag names."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1539542863, "post_id": 52805193, "comment_id": 92530302, "body": "(Rendering the (titles etc of) associated posts themselves will be more advanced, since the tag list will only contain post identifiers. You won&#39;t easily get the metadata of that page to render it, that&#39;ll require additional effort)."}, {"owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1539549455, "post_id": 52805193, "comment_id": 92531925, "body": "What will that involve, exactly? Is there a function for getting the title of a page, given its identifier?"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1539554142, "post_id": 52805193, "comment_id": 92533016, "body": "Yes, <a href=\"https://hackage.haskell.org/package/hakyll-4.12.4.0/docs/Hakyll-Core-Metadata.html#v:getMetadata\" rel=\"nofollow noreferrer\"><code>getMetadata</code></a> will do that (when called in a <code>Compiler</code> monad or the top-level <code>Rule</code> monad). But first try to get the list of tag names working, and post an update to your question if you did."}, {"owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1540676657, "post_id": 52805193, "comment_id": 92954793, "body": "I just posted an update. I&#39;m getting closer, but I don&#39;t think I know how to make a <code>listField</code> from <code>tagsMap tags</code>."}], "answers": [{"comments": [{"owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "edited": false, "score": 0, "creation_date": 1541125970, "post_id": 53098134, "comment_id": 93118912, "body": "If I&#39;m not mistaken, it looks like your website has one page for each tag. I can achieve that just fine, but what I&#39;m having trouble with is making one page that lists all tags, and for each tag lists all its associated posts."}, {"owner": {"reputation": 674, "user_id": 7478655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UL7XU.jpg?s=128&g=1", "display_name": "vrom911", "link": "https://stackoverflow.com/users/7478655/vrom911"}, "reply_to_user": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "edited": false, "score": 0, "creation_date": 1541129066, "post_id": 53098134, "comment_id": 93119479, "body": "@Jono We actually have a page that lists all tags (this is all posts page), but without showing associated posts with that. But probably the trick with grabbing all tags from all posts could be useful for you if I understand your problem correctly."}, {"owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "edited": false, "score": 0, "creation_date": 1541173959, "post_id": 53098134, "comment_id": 93138207, "body": "I can manage to print out a list of all tags, and I can make tag pages which each list all the associated posts for that tag, but I can&#39;t make a page that lists tags along with their associated posts. I have a feeling it involves creating a <code>tagsListContext</code>, a <code>listField</code> of tags, and <code>listField</code>s inside each of those. But I don&#39;t understand how a <code>field</code> is necessarily associated with an <code>Item</code>, and how they interact. I just wish I could find a working example of a tags page that lists all tags, and for each one, lists all the associated posts."}, {"owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "edited": false, "score": 0, "creation_date": 1541268389, "post_id": 53098134, "comment_id": 93161550, "body": "Could you edit your answer to include a working code block that lists tags, then within each, lists their associated posts? It would be something that begins <code>create [&quot;tags.html&quot;] $ do</code>, I&#39;m guessing. If so, I&#39;d happily give you the bounty."}], "tags": [], "owner": {"reputation": 674, "user_id": 7478655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UL7XU.jpg?s=128&g=1", "display_name": "vrom911", "link": "https://stackoverflow.com/users/7478655/vrom911"}, "is_accepted": false, "score": 1, "last_activity_date": 1541063405, "creation_date": 1541063405, "answer_id": 53098134, "question_id": 52805193, "link": "https://stackoverflow.com/questions/52805193/in-hakyll-how-can-i-generate-a-tags-page/53098134#53098134", "title": "In Hakyll, how can I generate a tags page?", "body": "<p>Here is what we've done to achieve this behaviour on our webpage:</p>\n\n<p><a href=\"https://github.com/kowainik/kowainik.github.io/blob/e3976e9eb686f6511258b3cea487af59f7c64bd6/site.hs#L61-L66\" rel=\"nofollow noreferrer\">Kowainik webpage tags building</a></p>\n\n<p>And the example of the tag page:</p>\n\n<p><a href=\"https://kowainik.github.io/tags/haskell\" rel=\"nofollow noreferrer\">https://kowainik.github.io/tags/haskell</a></p>\n\n<p>You can ask any questions about the code :)</p>\n"}, {"comments": [{"owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "edited": false, "score": 1, "creation_date": 1542866273, "post_id": 53422440, "comment_id": 93723586, "body": "Thanks so much for this very thorough answer! Besides being helpful for me, I think it&#39;ll go a long way toward helping others that are also looking to do this in Hakyll, too."}], "tags": [], "owner": {"reputation": 1435, "user_id": 6676199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21f60cb3880bf43a7c74ffeecbf996e1?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Amidon", "link": "https://stackoverflow.com/users/6676199/peter-amidon"}, "is_accepted": false, "score": 9, "last_activity_date": 1542847669, "creation_date": 1542847669, "answer_id": 53422440, "question_id": 52805193, "link": "https://stackoverflow.com/questions/52805193/in-hakyll-how-can-i-generate-a-tags-page/53422440#53422440", "title": "In Hakyll, how can I generate a tags page?", "body": "<p>I have modified your <code>site.hs</code> to create a rudimentary tags list page which I believe has the structure required: a list of tags, each of which contains a list of posts with that tag.</p>\n\n<p>Here's a summary of each of the things that I had to do to get it to work:</p>\n\n<pre><code>{-# LANGUAGE ViewPatterns #-}\n</code></pre>\n\n<p>Not strictly necessary, but a nice language extension which I use once. I thought I'd use/mention it since you mentioned that you're a beginner to Haskell, and it's nice to know about.</p>\n\n<pre><code>tags &lt;- buildTags \"posts/*\" (fromCapture \"tags/*.html\")\n</code></pre>\n\n<p>There are two changes needed to this line, compared to the <code>buildTags</code> in your initial <code>site.hs</code>. One is that it should probably moved out of the individual <code>match</code> clauses into the top level <code>Rules</code> monad, so that we can create individual tag pages if required. The other is that the capture was similarly changed from <code>\"tags.html#\"</code> to <code>\"tags/*.html\"</code>. This is important because Hakyll wants every <code>Item</code> to have a unique <code>Identifier</code>, and not every tags page is the same.</p>\n\n<p>Having the individual tag pages with unique identifiers may not be strictly necessary, but simplifies the rest of the setup since a lot of the Hakyll machinery assumes they exist.  In particular, the <code>Tags:</code> line in the individual post descriptions was not previously being rendered correctly either.</p>\n\n<p>For the same reason, it's a good idea to actually make these individual tag pages routable: without this stanza in the top-level <code>Rules</code> monad, the tags on each post won't render correctly with the default <code>tagsField</code> that you use, since they can't figure out how to link to an individual tag page:</p>\n\n<pre><code>tagsRules tags $ \\tag pat -&gt; do\n    route idRoute\n    compile $ do\n        posts &lt;- recentFirst =&lt;&lt; loadAll pat\n        let postCtx = postCtxWithTags tags\n            postsField = listField \"posts\" postCtx (pure posts)\n            titleField = constField \"title\" (\"Posts tagged \\\"\"++tag++\"\\\"\")\n            indexCtx = postsField &lt;&gt; titleField &lt;&gt; defaultContext\n        makeItem \"\" &gt;&gt;= applyTemplate postListTemplate indexCtx\n                    &gt;&gt;= applyTemplate defaultTemplate defaultContext\n                    &gt;&gt;= relativizeUrls\n                    &gt;&gt;= cleanIndexUrls\n</code></pre>\n\n<p>Alright, that's the preliminaries. Now onto the main attraction:</p>\n\n<pre><code>defaultCtxWithTags tags = listField \"tags\" tagsCtx getAllTags         `mappend`\n                          defaultContext\n</code></pre>\n\n<p>Alright, the important thing added here is some <code>tags</code> field. It will contain one item for each thing returned by <code>getAllTags</code>, and the fields on each item will be given by <code>tagsCtx</code>.</p>\n\n<pre><code>  where getAllTags :: Compiler [Item (String, [Identifier])]\n        getAllTags = pure . map mkItem $ tagsMap tags\n          where mkItem :: (String, [Identifier]) -&gt; Item (String, [Identifier])\n                mkItem x@(t, _) = Item (tagsMakeId tags t) x\n</code></pre>\n\n<p>What's <code>getAllTags</code> doing? Well, it starts with <code>tagsMap tags</code>, just like your example. But Hakyll wants the result to be an <code>Item</code>, so we have to wrap it up using <code>mkItem</code>. What's in an <code>Item</code> other than the body? Just an <code>Identifier</code>, and the <code>Tags</code> object happens to contain a field that tells us how to get this! So <code>mkItem</code> just uses <code>tagsMakeId</code> to get an identifier and wraps up the given body with that identifier.</p>\n\n<p>What about <code>tagsCtx?</code></p>\n\n<pre><code>        tagsCtx :: Context (String, [Identifier])\n        tagsCtx = listFieldWith \"posts\" postsCtx getPosts             `mappend`\n                  metadataField                                       `mappend`\n                  urlField \"url\"                                      `mappend`\n                  pathField \"path\"                                    `mappend`\n                  titleField \"title\"                                  `mappend`\n                  missingField\n</code></pre>\n\n<p>Everything starting with <code>metadataField</code> is just the usual stuff we expect to get from <code>defaultContext</code>; we can't use <code>defaultContext</code> here since it wants to add a <code>bodyField</code>, but the body of this <code>Item</code> isn't a string (but instead a much more useful for us Haskell structure representing a tag).  The interesting bit of this is line which adds the <code>posts</code> field, which should look a bit familiar. The big difference is that it uses <code>listFieldWith</code> instead of <code>listField</code>, which basically means that <code>getPosts</code> gets an extra argument, which is the body of the <code>Item</code> that this field is on. In this case, that's the tag record from <code>tagsMap</code>.</p>\n\n<pre><code>          where getPosts :: Item (String, [Identifier])\n                         -&gt; Compiler [Item String]\n                getPosts (itemBody -&gt; (_, is)) = mapM load is\n</code></pre>\n\n<p><code>getPosts</code> mostly just uses the <code>load</code> function to get ahold of the <code>Item</code> for each post given its <code>Identifier</code>---it's a lot like the <code>loadAll</code> you do to get all the posts on the index page, but it just gives you one post. The weird-looking pattern-match on the left is <code>ViewPatterns</code> in action: it's basically saying that for this pattern to match, the pattern on the right of the <code>-&gt;</code> (i.e. <code>(_, is)</code>) should match the result of applying the function on the left (i.e. <code>itemBody</code>) to the argument.</p>\n\n<pre><code>                postsCtx :: Context String\n                postsCtx = postCtxWithTags tags\n</code></pre>\n\n<p><code>postsCtx</code> is very simple: just the same <code>postCtxWithTags</code> used everywhere else we render a post.</p>\n\n<p>That's everything necessary to get a <code>Context</code> with everything that you want; all that's left is to actually make a template to render it!</p>\n\n<pre><code>tagListTemplateRaw :: Html\ntagListTemplateRaw =\n  ul $ do\n    \"$for(tags)$\"\n    li ! A.class_ \"\" $ do\n      a ! href \"$url$\" $ \"$title$\"\n      ul $ do\n        \"$for(posts)$\"\n        li ! A.class_ \"\" $ do\n          a ! href \"$url$\" $ \"$title$\"\n        \"$endfor$\"\n    \"$endfor$\"\n</code></pre>\n\n<p>This is just a very simple template that renders nested lists; you could of course do various things to make it fancier/nicer-looking.</p>\n\n<p>I have made a PR to your repo so that you can see these changes in context <a href=\"https://github.com/JonathanReeve/jonreeve.com-hakyll/pull/1\" rel=\"noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 639, "favorite_count": 2, "answer_count": 2, "score": 14, "last_activity_date": 1542847669, "creation_date": 1539537762, "last_edit_date": 1541347436, "question_id": 52805193, "link": "https://stackoverflow.com/questions/52805193/in-hakyll-how-can-i-generate-a-tags-page", "title": "In Hakyll, how can I generate a tags page?", "body": "<p>I'm trying to do something like <a href=\"https://javran.github.io/posts/2014-03-01-add-tags-to-your-hakyll-blog.html\" rel=\"noreferrer\">what's described in this tutorial</a>, i.e., add tags to my Hakyll blog, but instead of generating a page for every tag, just have one page that lists all tags and their posts. So given a <code>Post1</code> tagged <code>Tag1</code>, and a <code>Post2</code> tagged <code>Tag1, Tag2</code>, and a <code>Post3</code> tagged <code>Tag2</code>, my <code>tags.html</code> would look like this:  </p>\n\n<pre><code> Tag1: \n  - Post1\n  - Post2\n Tag2: \n  - Post2\n  - Post3\n</code></pre>\n\n<p>But I'm a Haskell beginner, and I don't fully understand all of Hakyll's monadic contexts. Here's what I have so far: </p>\n\n<pre><code>create [\"tags.html\"] $ do\n    route idRoute\n    tags &lt;- buildTags \"posts/*\" (fromCapture \"tags.html\")\n    compile $\n        makeItem \"\"\n            &gt;&gt;= applyTemplate tagListTemplate defaultContext\n            &gt;&gt;= applyTemplate defaultTemplate defaultContext\n            &gt;&gt;= relativizeUrls\n            &gt;&gt;= cleanIndexUrls\n</code></pre>\n\n<p>The problem is, I don't really know what <code>Tags</code> are, in the context of my blog. I can't seem to print them out for debugging. (I tried adding <code>print tags</code>, but it doesn't work.) So I'm having a really hard time thinking about how to proceed with this. </p>\n\n<p><a href=\"https://github.com/JonathanReeve/jonreeve.com-hakyll/blob/eb6f3e44127dc5dc63f14febec935ea7e06af8c9/site.hs#L76\" rel=\"noreferrer\">The complete file is here on GitHub.</a></p>\n\n<p>Any help is much appreciated. </p>\n\n<p><strong>Update</strong>: I'm still not much closer to figuring this out. Here's what I'm trying now: </p>\n\n<pre><code>create [\"tags.html\"] $ do\n        route idRoute\n        tags &lt;- buildTags \"posts/*\" (fromCapture \"tags.html#\")\n        let tagList = tagsMap tags\n        compile $ do\n            makeItem \"\"\n              &gt;&gt;= applyTemplate tagListTemplate (defaultCtxWithTags tags)\n</code></pre>\n\n<p>along with:</p>\n\n<pre><code>-- Add tags to default context, for tag listing\ndefaultCtxWithTags :: Tags -&gt; Context String\ndefaultCtxWithTags tags = listField \"tags\" defaultContext (return (tagsMap tags)) `mappend` defaultContext\n</code></pre>\n\n<p><a href=\"https://github.com/JonathanReeve/jonreeve.com-hakyll/blob/master/site.hs#L127\" rel=\"noreferrer\">The full code, as it currently stands, is up here.</a></p>\n\n<p>Any help with this would be much appreciated. I'm aware of all the documentation, but I can't seem to translate that into working code. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1539531508, "post_id": 52804214, "comment_id": 92526959, "body": "<code>showsPrec</code> is used to implement <code>show</code>. It prevents things like <code>Just (a :- b)</code> being printed as <code>Just a :- b</code>, or <code>Just [1,2,3]</code> being printed as <code>Just ([1,2,3])</code>."}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 7, "creation_date": 1539531681, "post_id": 52804214, "comment_id": 92527009, "body": "Normally, <code>Show</code> should always define <code>showsPrec</code> rather than <code>show</code>."}, {"owner": {"reputation": 11051, "user_id": 347165, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4881e74d5b966aca3f5945a974e8d91b?s=128&d=identicon&r=PG", "display_name": "Xodarap", "link": "https://stackoverflow.com/users/347165/xodarap"}, "reply_to_user": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 0, "creation_date": 1539531874, "post_id": 52804214, "comment_id": 92527072, "body": "@augustss cool, why?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1539531962, "post_id": 52804214, "comment_id": 92527108, "body": "@Xodarap in <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.Show.html#shows\" rel=\"nofollow noreferrer\">the source</a>, you can see that <code>show</code> is ultimately defined in terms of <code>showsPrec</code>."}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 2, "creation_date": 1539536472, "post_id": 52804214, "comment_id": 92528434, "body": "@Xodarap, so you get parenthesis in the right places."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1539769579, "post_id": 52804214, "comment_id": 92619165, "body": "Like augustss said, this is not &quot;unusual&quot;, this is &quot;the correct way to do it&quot;. :-)"}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 9, "creation_date": 1539531982, "post_id": 52804383, "comment_id": 92527112, "body": "Don&#39;t forget the efficiency advantage of using <code>ShowS</code> over <code>String</code> for appending."}], "tags": [], "owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "is_accepted": true, "score": 6, "last_activity_date": 1539531947, "creation_date": 1539531947, "answer_id": 52804383, "question_id": 52804214, "link": "https://stackoverflow.com/questions/52804214/what-are-the-advantages-of-showsprec-over-show/52804383#52804383", "title": "What are the advantages of showsPrec over show?", "body": "<p>The <code>showsPrec</code> function receives an additional argument: \"the operator precedence of the enclosing context\".</p>\n\n<p>The main use case of defining <code>showsPrec</code> instead of <code>show</code> is so that you can decide whether to show your value with parens around it or not. When defining <code>showsPrec</code>, it is common to use <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:showParen\" rel=\"noreferrer\"><code>showParen</code></a>.</p>\n\n<p>See, for example, <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.Show.html#line-568\" rel=\"noreferrer\">the source for <code>instance Show KindRep</code></a></p>\n"}], "owner": {"reputation": 11051, "user_id": 347165, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4881e74d5b966aca3f5945a974e8d91b?s=128&d=identicon&r=PG", "display_name": "Xodarap", "link": "https://stackoverflow.com/users/347165/xodarap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "accepted_answer_id": 52804383, "answer_count": 1, "score": 6, "last_activity_date": 1539531947, "creation_date": 1539530670, "last_edit_date": 1539531033, "question_id": 52804214, "link": "https://stackoverflow.com/questions/52804214/what-are-the-advantages-of-showsprec-over-show", "title": "What are the advantages of showsPrec over show?", "body": "<p>A job candidate submitted a code sample to me which implements <code>Show</code> by using <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:showsPrec\" rel=\"noreferrer\"><code>showsPrec</code></a> instead of <code>show</code>. This seems like an unusual enough choice that he must've had a reason to do this, but I can't find anything online about the advantages of this.</p>\n\n<p>Is there any reason to use <code>showsPrec</code>?</p>\n"}, {"tags": ["haskell", "assertion"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1539528276, "post_id": 52803806, "comment_id": 92526041, "body": "<a href=\"https://www.haskell.org/hoogle/?hoogle=assert\" rel=\"nofollow noreferrer\">Hoogle is your friend</a>."}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 3, "last_activity_date": 1539528449, "creation_date": 1539528449, "answer_id": 52803849, "question_id": 52803806, "link": "https://stackoverflow.com/questions/52803806/performing-assertions-in-haskell/52803849#52803849", "title": "Performing assertions in Haskell", "body": "<p>Yes, Hoogle tells us that <code>Control.Exception</code> provides <a href=\"https://www.haskell.org/hoogle/?hoogle=assert\" rel=\"nofollow noreferrer\"><code>assert :: Bool -&gt; a -&gt; a</code></a>.</p>\n\n<p>But you could just write this yourself:</p>\n\n<pre><code>assert :: Bool -&gt; a -&gt; a\nassert False _ = error \"Assertion failed!\"\nassert _     a = a\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 7, "last_activity_date": 1539528458, "creation_date": 1539528458, "answer_id": 52803850, "question_id": 52803806, "link": "https://stackoverflow.com/questions/52803806/performing-assertions-in-haskell/52803850#52803850", "title": "Performing assertions in Haskell", "body": "<p>Typically ones uses a <code>Maybe</code> to specify computations that \"might fail\", like:</p>\n\n<pre><code>computeSum :: Int -&gt; Int -&gt; <b>Maybe Int</b>\ncomputeSum x y | result &gt; 0 && result &lt;= 10 = <b>Just</b> result\n               | otherwise = <b>Nothing</b>\n    where result = x + y</code></pre>\n\n<p>So it will return a <code>Just result</code> in case the assertions are matched, or <code>Nothing</code> in case the assertions are not satisfied.</p>\n\n<p>Sometimes <code>Either String a</code> is used to provide an error message, like:</p>\n\n<pre><code>computeSum :: Int -&gt; Int -&gt; <b>Either String Int</b>\ncomputeSum x y | result &gt; 0 && result &lt;= 10 = <b>Right</b> result\n               | otherwise = <b>Left</b> \"Result is note between 0 and 10\"\n    where result = x + y</code></pre>\n\n<p>You can also raise an error, but personally I think this is not advisable, since the signature does not \"hint\" that the computation might fail:</p>\n\n<pre><code>computeSum :: Int -&gt; Int -&gt; <b>Int</b>\ncomputeSum x y | result &gt; 0 && result &lt;= 10 = result\n               | otherwise = <b>error</b> \"result is not between 0 and 10\"\n    where result = x + y</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 3, "last_activity_date": 1539528629, "creation_date": 1539528629, "answer_id": 52803870, "question_id": 52803806, "link": "https://stackoverflow.com/questions/52803806/performing-assertions-in-haskell/52803870#52803870", "title": "Performing assertions in Haskell", "body": "<p>Yes, Haskell has if statements:</p>\n\n<pre><code>function x y =\n  let r = x + y\n  in if r &gt; 0 &amp;&amp; r &lt;= 10\n     then r\n     else error \"I don't know what I'm doing.\"\n</code></pre>\n"}], "owner": {"reputation": 3258, "user_id": 7661005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0c49d2077073823b91fa1ccc82fa0d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Maxxx", "link": "https://stackoverflow.com/users/7661005/maxxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 561, "favorite_count": 0, "accepted_answer_id": 52803850, "answer_count": 3, "score": 0, "last_activity_date": 1539582318, "creation_date": 1539528139, "last_edit_date": 1539582318, "question_id": 52803806, "link": "https://stackoverflow.com/questions/52803806/performing-assertions-in-haskell", "title": "Performing assertions in Haskell", "body": "<p>Say i have a function that computes the sum between two numbers:</p>\n\n<pre><code>computeSum :: Int -&gt; Int -&gt; Int\ncomputeSum x y = x + y\n</code></pre>\n\n<p>Is there any <strong>form of control</strong> over the <strong>returned value</strong> from the above function where I only want <strong>to sum up two numbers</strong> where their <strong>sum</strong> will <strong>be non negative and must be less than 10</strong>?</p>\n\n<p>I just started functional programming from imperative where we can have a simple check in imperative programming of a function's return value such as:</p>\n\n<pre><code>if value &lt;= 10 and value &gt; 0:\n   return value\n</code></pre>\n\n<p>Just wondering if there is something similar to that in haskell?</p>\n"}, {"tags": ["haskell", "quickcheck", "hspec"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1539524441, "post_id": 52803136, "comment_id": 92524903, "body": "<code>xs</code> is not defined in the <code>let ...</code> part of the <code>let</code>-<code>in</code> statement."}], "answers": [{"comments": [{"owner": {"reputation": 1317, "user_id": 1014679, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/337f44cf793b4ee4ce848da801e34dd2?s=128&d=identicon&r=PG", "display_name": "Raiden616", "link": "https://stackoverflow.com/users/1014679/raiden616"}, "edited": false, "score": 0, "creation_date": 1539533009, "post_id": 52803484, "comment_id": 92527408, "body": "Right, okay I thought it might be something exactly like that. The issue is I want this function to apply to an xs of any type. Since the map just wraps it up it really doesn&#39;t matter what type it is. Is this not something quickcheck deals with? In which case do I need to provide multiple properties for different types, or can I write some kind of custom generator?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1317, "user_id": 1014679, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/337f44cf793b4ee4ce848da801e34dd2?s=128&d=identicon&r=PG", "display_name": "Raiden616", "link": "https://stackoverflow.com/users/1014679/raiden616"}, "edited": false, "score": 0, "creation_date": 1539533695, "post_id": 52803484, "comment_id": 92527617, "body": "@Raiden616 QuickCheck does not know the type does not matter. In this case, you can see that <code>uniform</code> only adds uniform weights, and <code>totalProbability</code> sums those weights neglecting the data they are paired with. So, indeed the type does not matter. (Even without looking at the <code>uniform</code> code, one might actually prove that using parametricity, and a bit of theoretical computer science). In this case, you can test for <code>[Int]</code> only, since if your code works for that type, it will work for any other type as well. There&#39;s no need to use QuickCheck to &quot;generate a random type&quot;, so to speak."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1539526052, "creation_date": 1539526052, "answer_id": 52803484, "question_id": 52803136, "link": "https://stackoverflow.com/questions/52803136/hspec-quickcheck-ambiguous-type-variable-a0/52803484#52803484", "title": "Hspec &amp; QuickCheck - Ambiguous type variable a0?", "body": "<p>You need to specify a type for <code>xs</code>: is that a list of strings? ints? booleans? This is so that QuickCheck can generate a random sample in that type.</p>\n\n<p>You can write, for instance:</p>\n\n<pre><code>...\nin (\\xs -&gt; (totalProbability $ uniform (xs :: [Int])) `shouldBe` 1)\n</code></pre>\n"}], "owner": {"reputation": 1317, "user_id": 1014679, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/337f44cf793b4ee4ce848da801e34dd2?s=128&d=identicon&r=PG", "display_name": "Raiden616", "link": "https://stackoverflow.com/users/1014679/raiden616"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "accepted_answer_id": 52803484, "answer_count": 1, "score": 0, "last_activity_date": 1539526052, "creation_date": 1539523604, "question_id": 52803136, "link": "https://stackoverflow.com/questions/52803136/hspec-quickcheck-ambiguous-type-variable-a0", "title": "Hspec &amp; QuickCheck - Ambiguous type variable a0?", "body": "<p>I have written a function in Haskell that takes a list of arbitrary elements and returns (mapped) a list of tuples. Each tuple contains the original element and a fraction, with all the fractions in the list adding to 1 (therefore I simply calculate the fraction once using <code>1 ``div`` length xs</code> and apply it all elements). This is the code:</p>\n\n<pre><code>uniform :: [a] -&gt; [(a, Int)]\nuniform xs = map (\\x -&gt; (x, prob)) xs\n  where prob = 1 `div` (length xs)\n</code></pre>\n\n<p>(Disclaimer: This is actually a slightly simplified version, but I am producing the exact same behaviour, so hopefully this suffices).</p>\n\n<p>I am trying to cover this with a property based test using Hspec and Quickcheck:</p>\n\n<pre><code>spec = do\n    describe \"uniform\" $ do\n\n        it \"produces a uniform distribution summing to 1\" $ property $\n            let totalProbability ((_, p):xs) = p + (totalProbability xs)\n            in (\\xs -&gt; (totalProbability $ uniform xs) `shouldBe` 1)\n</code></pre>\n\n<p>However when I run this I get this error:</p>\n\n<pre><code>\u2022 Ambiguous type variable \u2018a0\u2019 arising from a use of \u2018property\u2019\n  prevents the constraint \u2018(Arbitrary a0)\u2019 from being solved.\n  Probable fix: use a type annotation to specify what \u2018a0\u2019 should be.\n  These potential instances exist:\n    instance (Arbitrary a, Arbitrary b) =&gt; Arbitrary (Either a b)\n      -- Defined in \u2018Test.QuickCheck.Arbitrary\u2019\n    instance Arbitrary Ordering\n      -- Defined in \u2018Test.QuickCheck.Arbitrary\u2019\n    instance Arbitrary Integer\n      -- Defined in \u2018Test.QuickCheck.Arbitrary\u2019\n    ...plus 19 others\n    ...plus 62 instances involving out-of-scope types\n    (use -fprint-potential-instances to see them all)\n\u2022 In the second argument of \u2018($)\u2019, namely\n    \u2018property\n       $ let totalProbability ((_, p) : xs) = p + (totalProbability xs)\n         in (\\ xs -&gt; (totalProbability $ uniform xs) `shouldBe` 1)\u2019\n  In a stmt of a 'do' block:\n    it \"produces a uniform distribution summing to 1\"\n      $ property\n          $ let totalProbability ((_, p) : xs) = p + (totalProbability xs)\n            in (\\ xs -&gt; (totalProbability $ uniform xs) `shouldBe` 1)\n  In the second argument of \u2018($)\u2019, namely\n    \u2018do it \"produces a uniform distribution summing to 1\"\n          $ property\n              $ let totalProbability ((_, p) : xs) = ...\n                in (\\ xs -&gt; (totalProbability $ uniform xs) `shouldBe` 1)\u2019\n</code></pre>\n\n<p>|\n12 |         it \"produces a uniform distribution summing to 1\" $ property $\n   |                                                             ^^^^^^^^^^...</p>\n\n<p>I am guessing that somewhere I have not given QuickCheck enough information about how to generate the test value, but I am not sure where to go from here.</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1539579635, "post_id": 52801691, "comment_id": 92537871, "body": "You don&#39;t need guards here"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1539513033, "creation_date": 1539513033, "answer_id": 52801741, "question_id": 52801691, "link": "https://stackoverflow.com/questions/52801691/can-i-use-let-in-guards-on-haskell/52801741#52801741", "title": "Can I use let in guards on Haskell?", "body": "<p>Unfortunately, we can not do that with <code>let</code>.</p>\n\n<p>More precisely, we can write</p>\n\n<pre><code>func x y | let z = .. in condition = result\n         | otherCondition          = otherResult\n</code></pre>\n\n<p>but <code>z</code> will only be visible in <code>condition</code>, and not in <code>result</code>, <code>otherCondition</code> or <code>otherResult</code>.</p>\n\n<p>(This can be improved using pattern guards, but not completely: <code>z</code> will still be unavailable in <code>otherCondition</code> and <code>otherResult</code>)</p>\n\n<p>The solution is using <code>where</code> instead:</p>\n\n<pre><code>  func x y | condition      = result\n           | otherCondition = otherResult\n           where z = ...\n</code></pre>\n\n<p>Here, <code>z</code> is visible everywhere.</p>\n\n<p>(Personally, I dislike this form of <code>where</code> because it is too far from the uses of <code>z</code>, but I can't see any simple alternative in this case.)</p>\n\n<p>Finally, let me add that your code does not look functional to me: there's no <code>if then</code> without <code>else</code> in functional programming, and <code>mult -= 1</code> can not modify variable <code>mult</code> (the same holds for <code>sum += 1</code>). </p>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 3, "last_activity_date": 1539513585, "creation_date": 1539513585, "answer_id": 52801800, "question_id": 52801691, "link": "https://stackoverflow.com/questions/52801691/can-i-use-let-in-guards-on-haskell/52801800#52801800", "title": "Can I use let in guards on Haskell?", "body": "<p>You can use <code>let</code> in the top however it has to be followed by an <code>in</code> to designate the block where the defined values are to be used. Also you are missing the condition about what to do if <code>sum /= 3</code> and <code>mul /= 5</code>. So may be returning a <code>Maybe</code> type could be better such as</p>\n\n<pre><code>func :: Integral a =&gt; a -&gt; a -&gt; Maybe a\nfunc x y = let sum = x + y\n               mul = x * y\n            in case (sum, mul) of\n               (3, _) -&gt; Just (sum + 1)\n               (_, 5) -&gt; Just (mul - 1)\n               _      -&gt; Nothing\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1539521413, "post_id": 52802157, "comment_id": 92524116, "body": "Oh, nice, I forgot about that. Too bad the <code>let</code> scope does not include later branches, i.e. we can&#39;t use <code>sum</code> after the second guard starts."}], "tags": [], "owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "is_accepted": false, "score": 6, "last_activity_date": 1539516400, "creation_date": 1539516400, "answer_id": 52802157, "question_id": 52801691, "link": "https://stackoverflow.com/questions/52801691/can-i-use-let-in-guards-on-haskell/52802157#52802157", "title": "Can I use let in guards on Haskell?", "body": "<p>In fact, Haskell2010 allows the <code>let</code> expression to appear in the guard. See the report <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-460003.13\" rel=\"noreferrer\">here</a>. <code>|let decls</code> introduces the names defined in <code>decls</code> to the environment. </p>\n\n<p>For your case, we can write</p>\n\n<pre><code>fun x y \n  | let sum = x + y, sum == 3 = Just (sum + 1)\n  | let mult = x * y, mult == 5 = Just (mult - 1)\n  | otherwise = Nothing\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 10502229, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Saki", "link": "https://stackoverflow.com/users/10502229/saki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2134, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1539516400, "creation_date": 1539512603, "question_id": 52801691, "link": "https://stackoverflow.com/questions/52801691/can-i-use-let-in-guards-on-haskell", "title": "Can I use let in guards on Haskell?", "body": "<p>right now I have an error that says  parse error on input \u2018|\u2019 that refers to the '|' before the if statement. \nI am also not sure if I can use let in guards like the code below.\nThe code below is an example to my problem, please help to correct my mistakes, thank you in advance!</p>\n\n<pre><code>func x y\n   | let \n       sum = x + y\n       mult = x * y\n   | if sum == 3\n       then do\n            sum+=1\n       else if mult == 5\n           then do\n                mult -=1\n</code></pre>\n"}, {"tags": ["haskell", "code-coverage", "haskell-lens"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 4, "creation_date": 1539542745, "post_id": 52800053, "comment_id": 92530272, "body": "Just ignore the coverage warnings. It&#39;s a waste of your time to write tests for field accessors - it&#39;s not like they can ever go wrong."}], "answers": [{"comments": [{"owner": {"reputation": 3618, "user_id": 2621216, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/51uHg.jpg?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/2621216/gavin"}, "edited": false, "score": 0, "creation_date": 1539623588, "post_id": 52819677, "comment_id": 92560271, "body": "Hi Paul, thanks but the accessors are marked as \u2018never executed\u2019 even though the lenses were called in the tests."}], "tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 0, "last_activity_date": 1539615939, "creation_date": 1539615939, "answer_id": 52819677, "question_id": 52800053, "link": "https://stackoverflow.com/questions/52800053/how-to-increase-coverage-for-record-types-with-lenses/52819677#52819677", "title": "How to increase coverage for record types with lenses?", "body": "<p><code>makeLenses</code> does not execute the <code>_average</code> etc field accessor functions, it merely uses them to construct the lenses.</p>\n\n<p>If you write code that uses <code>aValue ^. average</code> then the <code>_average</code> function will be called by the lens.</p>\n"}], "owner": {"reputation": 3618, "user_id": 2621216, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/51uHg.jpg?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/2621216/gavin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539615939, "creation_date": 1539498325, "question_id": 52800053, "link": "https://stackoverflow.com/questions/52800053/how-to-increase-coverage-for-record-types-with-lenses", "title": "How to increase coverage for record types with lenses?", "body": "<h1>Background</h1>\n\n<p>I am using record types with the <a href=\"https://hackage.haskell.org/package/lens\" rel=\"nofollow noreferrer\">lens</a>. I have written some unit tests with HUnit and HSpec.</p>\n\n<p>However, the hpc coverage report shows that the field accessors were never executed.</p>\n\n<p>Thus, contributing to the lower coverage for the record types.</p>\n\n<h1>Example</h1>\n\n<pre><code>data MetricValue =\n  MetricValue { _average   :: Maybe Scientific\n              , _count     :: Maybe Scientific\n              , _maximum   :: Maybe Scientific\n              , _minimum   :: Maybe Scientific\n              , _timeStamp :: Text\n              , _total     :: Maybe Scientific\n              } deriving (Generic, Show)\n\nmakeLenses ''MetricValue\n</code></pre>\n\n<p>The <code>_average</code>, <code>_count</code>, <code>_maximum</code>, etc. fields were highlighted in yellow indicating that they were never executed.</p>\n\n<h1>Questions</h1>\n\n<p>How can I improve the coverage?</p>\n\n<p>How should I probably test the record types with lenses?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1539509984, "post_id": 52799753, "comment_id": 92521539, "body": "Probably, the book is using the term <i>composition</i> rather liberally here, without referring to <code>(.)</code>. It&#39;s only saying &quot;use A and B to achieve C&quot;."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1539524049, "post_id": 52799753, "comment_id": 92524794, "body": "If the usage of &quot;composition&quot; there was literal why giving it as an exercise? I mean it would literally be saying &quot;Insert the ASCII character <code>.</code> between the name of these two functions&quot; which does not sound like an interesting exercise. It&#39;s probably a shorthand for &quot;write a function <code>f</code>, whose implementation uses a call to one of the two functions you just defined to obtain a value that is, maybe after some other operation, fed to other function such that...&quot;. It&#39;s simply saying &quot;do this exercise but use the two functions you just defined, don&#39;t do it from scratch&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1539509799, "post_id": 52801268, "comment_id": 92521494, "body": "Upvoted for the exegesis, even if this is likely not what the book intended."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1539510675, "post_id": 52801268, "comment_id": 92521683, "body": "for <i>any</i> <code>f</code> and <code>gh</code>, <code>((. f) . gh) x y = (. f) (gh x) y = (gh x . f) y = gh x (f y)</code>. it&#39;s a common combinatory pattern. they are all equivalent. so if one of them is well typed, all are. i.e. there&#39;s no need to bother with the specific interim expressions&#39; types."}, {"owner": {"reputation": 3608, "user_id": 1040915, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5d4fad479f4b604d4acc731fdae68d9d?s=128&d=identicon&r=PG", "display_name": "scubbo", "link": "https://stackoverflow.com/users/1040915/scubbo"}, "edited": false, "score": 0, "creation_date": 1539542425, "post_id": 52801268, "comment_id": 92530192, "body": "Wow - that&#39;s a lot of information and explanation, thank you! It&#39;s probably going to take me a few reads to fully grok this, but I really appreciate the walkthrough."}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 4, "last_activity_date": 1539509136, "creation_date": 1539509136, "answer_id": 52801268, "question_id": 52799753, "link": "https://stackoverflow.com/questions/52799753/typo-composition-in-seven-languages-in-seven-weeks-haskell-section/52801268#52801268", "title": "Typo(?) (&quot;composition&quot;) in Seven Languages In Seven Weeks - Haskell Section", "body": "<p>I don't feel convinced that the following is what the author of that question had in mind, but you can write <code>lazy8th</code> like this:</p>\n\n<pre><code>lazy8th = (. lazy5th) . zipWith (+) . lazy3rd\n</code></pre>\n\n<p>How does this work? Let's break it down, but let's start by reiterating the type of the composition operator:</p>\n\n<pre><code>Prelude&gt; :t (.)\n(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n</code></pre>\n\n<p>To describe it in words, the <code>.</code> operator is a function that takes a function from <code>b</code> to <code>c</code>, and another function from <code>a</code> to <code>b</code>, and composes them by 'gluing' them together on <code>b</code>, to produce a composed function from <code>a</code> to <code>c</code>.</p>\n\n<h1>First step</h1>\n\n<p>Which type does <code>(. lazy5th)</code> have, then?</p>\n\n<pre><code>Prelude&gt; :t (. lazy5th)\n(. lazy5th) :: ([Int] -&gt; c) -&gt; Int -&gt; c\n</code></pre>\n\n<p>The <code>lazy5th</code> function has the declared type <code>Int -&gt; [Int]</code>, and it 'sits' in the position of <code>a -&gt; b</code> in the type of <code>.</code>. In other words, <code>a</code> must be <code>Int</code>, and <code>b</code> must be <code>[Int]</code>.</p>\n\n<p>Since the function is only partially applied, it's still waiting for the left function, which should have the type <code>b -&gt; c</code>. We've just learned that <code>b</code> is <code>[Int]</code>, so the function this partially applied expression is still 'waiting for' must have the type <code>[Int] -&gt; c</code>. Once we supply such a function, we get a function <code>a -&gt; c</code>, or rather, replacing <code>a</code> with <code>Int</code>, <code>Int -&gt; c</code>.</p>\n\n<h1>Second step</h1>\n\n<p>What type does <code>zipWith (+)</code> have?</p>\n\n<pre><code>Prelude&gt; :t zipWith (+)\nzipWith (+) :: Num c =&gt; [c] -&gt; [c] -&gt; [c]\n</code></pre>\n\n<p>Given the definition of <code>zipWith</code>, this is hardly surprising, I hope.</p>\n\n<p>What, then, is the type of <code>(. lazy5th) . zipWith (+)</code>?</p>\n\n<pre><code>Prelude&gt; :t (. lazy5th) . zipWith (+)\n(. lazy5th) . zipWith (+) :: [Int] -&gt; Int -&gt; [Int]\n</code></pre>\n\n<p>How do we get there? Let's recapitulate what we knew:</p>\n\n<pre><code>Prelude&gt; :t (. lazy5th)\n(. lazy5th) :: ([Int] -&gt; c) -&gt; Int -&gt; c\nPrelude&gt; :t zipWith (+)\nzipWith (+) :: Num c =&gt; [c] -&gt; [c] -&gt; [c]\n</code></pre>\n\n<p>How does <code>[c] -&gt; [c] -&gt; [c]</code> fit into the mold of <code>a -&gt; b</code>? It does once we realise that, due to currying, <code>[c] -&gt; [c] -&gt; [c]</code> can also be written as <code>[c] -&gt; ([c] -&gt; [c])</code>. In other words, we can think of this function as a function that takes a single list <code>[c]</code> as input, and returns a function <code>[c] -&gt; [c]</code> as output. Thus, replacing <code>a</code> with <code>[c]</code>, and <code>b</code> with <code>[c] -&gt; [c]</code>, this fits with the type of <code>(. lazy5th)</code>.</p>\n\n<p>The input type of <code>(. lazy5th)</code> is <code>[Int] -&gt; c</code>. Careful, now, because this <code>c</code> isn't the same <code>c</code> as in the previous paragraph, so let's call it <code>c'</code>: <code>[Int] -&gt; c'</code>.</p>\n\n<p>The only way <code>[c] -&gt; [c]</code> can fit with <code>[Int] -&gt; c'</code> is if <code>c</code> is <code>Int</code>, and <code>c'</code> is <code>[Int]</code>. Thus, the types so far, with helpful brackets:</p>\n\n<pre><code>(. lazy5th) :: ([Int] -&gt; [Int]) -&gt; Int -&gt; [Int]\nzipWith (+) :: [Int] -&gt; ([Int] -&gt; [Int])\n</code></pre>\n\n<p>Thus, the composition of these two functions is a function that takes the input of <code>zipWith (+)</code> (<code>[Int]</code>) and passes the output as input to <code>(. lazy5th)</code>, which produces a function of the type <code>Int -&gt; [Int]</code>.</p>\n\n<h1>Third step</h1>\n\n<p>What's the type of <code>lazy3rd</code>?</p>\n\n<pre><code>Prelude&gt; :t lazy3rd\nlazy3rd :: Int -&gt; [Int]\n</code></pre>\n\n<p>That's the declared type of the function, so no surprises there. How does that compose with the previous step?</p>\n\n<p>Again, due to currying, we can rewrite <code>[Int] -&gt; Int -&gt; [Int]</code> as <code>[Int] -&gt; (Int -&gt; [Int])</code>. Now we have:</p>\n\n<pre><code>(. lazy5th) . zipWith (+) :: [Int] -&gt; (Int -&gt; [Int])\nlazy3rd :: Int -&gt; [Int]\n</code></pre>\n\n<p>Thus, the composition of these two expressions take the input to <code>lazy3rd</code>, which is <code>Int</code>, and returns a function of the type <code>(Int -&gt; [Int])</code>:</p>\n\n<pre><code>Prelude&gt; :t (. lazy5th) . zipWith (+) . lazy3rd\n(. lazy5th) . zipWith (+) . lazy3rd :: Int -&gt; Int -&gt; [Int]\n</code></pre>\n\n<p>Alternatively, if brackets help, you could write it as:</p>\n\n<pre><code>(. lazy5th) . zipWith (+) . lazy3rd :: Int -&gt; (Int -&gt; [Int])\n</code></pre>\n\n<p>This means the same, though.</p>\n\n<h1>Demo</h1>\n\n<p>Does it work, then?</p>\n\n<pre><code>Prelude&gt; lazy8th = (. lazy5th) . zipWith (+) . lazy3rd\nPrelude&gt; take 9 $ lazy8th 4 6\n[10,18,26,34,42,50,58,66,74]\n</code></pre>\n\n<p>Yes, it does.</p>\n\n<h1>But how?</h1>\n\n<p>How did I come up with this solution?</p>\n\n<p>Honestly, I cheated. I just typed <code>\\x y -&gt; zipWith (+) (lazy3rd x) (lazy5th y)</code> into <a href=\"http://pointfree.io/\" rel=\"nofollow noreferrer\">pointfree.io</a>, and it gave me the result.</p>\n\n<p>The exegesis and explanations, however, are my own.</p>\n"}, {"comments": [{"owner": {"reputation": 3608, "user_id": 1040915, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5d4fad479f4b604d4acc731fdae68d9d?s=128&d=identicon&r=PG", "display_name": "scubbo", "link": "https://stackoverflow.com/users/1040915/scubbo"}, "edited": false, "score": 0, "creation_date": 1539542717, "post_id": 52801945, "comment_id": 92530268, "body": "Thanks for the guide on how to derive this! It&#39;s fascinating how you and Mark came to this same conclusion by different means - his appears to be guided by Type signatures and yours by application of identities. For what it&#39;s worth, I really doubt that this was the route that the book intended, since it hasn&#39;t yet mentioned pointfree style or the <code>$</code> operator (though I&#39;ve seen the latter while researching online). But your series of steps was very instructive, thank you!"}, {"owner": {"reputation": 3608, "user_id": 1040915, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5d4fad479f4b604d4acc731fdae68d9d?s=128&d=identicon&r=PG", "display_name": "scubbo", "link": "https://stackoverflow.com/users/1040915/scubbo"}, "edited": false, "score": 0, "creation_date": 1539553103, "post_id": 52801945, "comment_id": 92532787, "body": "I&#39;m accepting this answer because it gives a walkthrough of <i>how</i> to get from the naive implementation to the composed one - but I highly recommend reading Mark&#39;s answer that goes into more detail on the type signatures involved."}], "tags": [], "owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "is_accepted": true, "score": 3, "last_activity_date": 1539522355, "last_edit_date": 1539522355, "creation_date": 1539514775, "answer_id": 52801945, "question_id": 52799753, "link": "https://stackoverflow.com/questions/52799753/typo-composition-in-seven-languages-in-seven-weeks-haskell-section/52801945#52801945", "title": "Typo(?) (&quot;composition&quot;) in Seven Languages In Seven Weeks - Haskell Section", "body": "<p>I think the book just gives a practice for writing the pointfree style. So even if you don't know the common combinatory pattern suggested by @Will Ness, you can transform any expression into a pointfree style.\nRemember the fact that if a parameter <code>x</code> is located at the end of both the function definition and the function body, you can eliminate it, such as:</p>\n\n<p><code>fun x = &lt;some function body&gt; $ x</code> </p>\n\n<p>can be rewritten as</p>\n\n<p><code>fun = &lt;some function body&gt;</code></p>\n\n<p>So, the key for transformation is moving the parameter <code>x</code> at the end of the function definition to the end of the definition body, and can be written in the form of <code>&lt;some function body&gt; $ x</code>, which is important. </p>\n\n<p>In your case, <code>lazy8th x y = zipWith (+) (lazy3rd x) (lazy5th y)</code> is easy to get. So now the first step is moving <code>y</code> to the end of the definition body, since <code>y</code> is at the end of the left side. This step is easy:</p>\n\n<p><code>lazy8th x y = zipWith (+) (lazy3rd x) (lazy5th y)</code></p>\n\n<p>=> <code>lazy8th x y = zipWith (+) (lazy3rd x) . lazy5th $ y</code></p>\n\n<p>with which we can eliminate the parameter <code>y</code> at the end, and get:</p>\n\n<p><code>lazy8th x = zipWith (+) (lazy3rd x) . lazy5th</code></p>\n\n<p>Next we need to remove the <code>x</code>, but how? It is not as obvious as <code>y</code>. </p>\n\n<p>To solve it, we need to remember one common skill in Haskell \u2014\u2014 <strong>Section</strong> for the partial application, such as <code>x + y</code> => <code>(+ y) x</code>. With this concept in mind, we can change the previous result as follows:</p>\n\n<p><code>lazy8th x = zipWith (+) (lazy3rd x) . lazy5th</code></p>\n\n<p>=> <code>lazy8th x = (. lazy5th) (zipWith (+) (lazy3rd x))</code></p>\n\n<p><code>(.)</code> is just a binary operator like <code>(+)</code>, remember? </p>\n\n<p>Now since the parameter <code>x</code> is at the end of the definition body, we can rewrite it into:</p>\n\n<p><code>lazy8th x = (. lazy5th) (zipWith (+) . lazy3rd $ x)</code></p>\n\n<p>However, <code>x</code> is not at the end of the whole body. It is easy to achieve this. Remember that <code>(. lazy5th) (zipWith (+) . lazy3rd $ x)</code> is just <code>f1 (f2 $ x)</code>, which can be transformed into <code>f1 . f2 $ x</code> easily. So the final result is obvious:</p>\n\n<p><code>lazy8th x = (. lazy5th) (zipWith (+) . lazy3rd $ x)</code></p>\n\n<p>=> <code>lazy8th x = (. lazy5th) . (zipWith (+) . lazy3rd) $ x</code></p>\n\n<p>=> <code>lazy8th = (. lazy5th) . (zipWith (+) . lazy3rd)</code></p>\n\n<p>=> <code>lazy8th = (. lazy5th) . zipWith (+) . lazy3rd</code></p>\n\n<p>since <code>(.)</code> associates to the right (and is associative, in general). This is the final pointfree style definition.</p>\n"}], "owner": {"reputation": 3608, "user_id": 1040915, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5d4fad479f4b604d4acc731fdae68d9d?s=128&d=identicon&r=PG", "display_name": "scubbo", "link": "https://stackoverflow.com/users/1040915/scubbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 52801945, "answer_count": 2, "score": 3, "last_activity_date": 1539522355, "creation_date": 1539495012, "last_edit_date": 1539509213, "question_id": 52799753, "link": "https://stackoverflow.com/questions/52799753/typo-composition-in-seven-languages-in-seven-weeks-haskell-section", "title": "Typo(?) (&quot;composition&quot;) in Seven Languages In Seven Weeks - Haskell Section", "body": "<p>I'm <a href=\"https://stackoverflow.com/questions/52798038/not-in-scope-type-constructor-or-class-and-other-errors-while-reversing-a/52798068?noredirect=1#comment92515991_52798068\">still</a> working through \"Seven Languages In Seven Weeks\", and I've either found a typo or something that I don't understand.</p>\n\n<p>One of the challenges reads:</p>\n\n<blockquote>\n  <p>Write a function that takes an argument <code>x</code> and returns a lazy sequence that has every third number, starting with <code>x</code>. Then, write a function that includes every fifth number, beginning with <code>y</code>. Combine these functions <em>through composition</em> to return every eighth number, beginning with <code>x+y</code></p>\n</blockquote>\n\n<p>(Emphasis mine)</p>\n\n<p>It's the \"composition\" that I'm not sure about. Judging by previous parts of the book, composition is carried out via the <code>.</code> operator and, from earlier in the book, is defined as</p>\n\n<blockquote>\n  <p>a process that used the return from one function as the input of another</p>\n</blockquote>\n\n<p>Given that definition, I don't see how composition would achieve what's described here, since the output of each of the described functions is an <code>[Int]</code>, but their inputs are <code>Int</code>. My implementation (<em>not</em> using composition) is below:</p>\n\n<pre><code>lazy3rd :: Int -&gt; [Int]\nlazy3rd x = x:(lazy3rd (x+3))\nlazy5th :: Int -&gt; [Int]\nlazy5th x = x:(lazy5th (x+5))\nlazy8th :: Int -&gt; Int -&gt; [Int]\nlazy8th x y = zipWith (+) (lazy3rd x) (lazy5th y)\n----\n[in Prelude]\nPrelude&gt; take 9 (Day2.lazy8th 4 6)\n[10,18,26,34,42,50,58,66,74]\n</code></pre>\n\n<p>Looking <a href=\"https://pragprog.com/titles/btlang/errata\" rel=\"nofollow noreferrer\">here</a> (search for <code>#82151</code>), it seems I'm not alone in being confused.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 3258, "user_id": 7661005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0c49d2077073823b91fa1ccc82fa0d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Maxxx", "link": "https://stackoverflow.com/users/7661005/maxxx"}, "edited": false, "score": 0, "creation_date": 1539503276, "post_id": 52800139, "comment_id": 92520059, "body": "so the &#39;x&#39; is necessary in the lambda expression."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3258, "user_id": 7661005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0c49d2077073823b91fa1ccc82fa0d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Maxxx", "link": "https://stackoverflow.com/users/7661005/maxxx"}, "edited": false, "score": 0, "creation_date": 1539509570, "post_id": 52800139, "comment_id": 92521444, "body": "@Maxxx Well, you could write it in pointfree style as <code>filter ((&amp;&amp;) &lt;$&gt; (&gt;0) &lt;*&gt; (&lt;10)) lst</code> or <code>filter (liftA2 (&amp;&amp;) (&gt;0) (&lt;10)) lst</code> using applicatives, but the lambda is simpler"}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 4, "last_activity_date": 1539499171, "creation_date": 1539499171, "answer_id": 52800139, "question_id": 52799717, "link": "https://stackoverflow.com/questions/52799717/filtering-list-elements-based-on-range-of-value/52800139#52800139", "title": "Filtering list elements based on range of value", "body": "<blockquote>\n  <p>filterList lst = filter (>0 &amp;&amp; &lt;10) lst</p>\n</blockquote>\n\n<p>The problem is that it's not a valid expression in Haskell. But even if we add parentheses to get rid of parse errors:</p>\n\n<pre><code>filterList lst = filter ((&gt;0) &amp;&amp; (&lt;10)) lst -- no parse errors, but types are not matched\n</code></pre>\n\n<p>we'll get the error message, that types are not matched, which is correct, since <code>&amp;&amp;</code> expects both arguments to be <code>Bool</code>, but <code>(&gt; 0)</code> and <code>(&lt; 10)</code> are functions <code>Integer -&gt; Bool</code>.</p>\n\n<p>Seems the functions lack arguments, but we can provide some:</p>\n\n<pre><code>filterList lst = filter (\\x -&gt; (x &gt; 0) &amp;&amp; (x &lt; 10)) lst\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 9899983, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u9Plr.png?s=128&g=1", "display_name": "Mateus Reis", "link": "https://stackoverflow.com/users/9899983/mateus-reis"}, "is_accepted": false, "score": 2, "last_activity_date": 1539501211, "creation_date": 1539501211, "answer_id": 52800357, "question_id": 52799717, "link": "https://stackoverflow.com/questions/52799717/filtering-list-elements-based-on-range-of-value/52800357#52800357", "title": "Filtering list elements based on range of value", "body": "<p>You can use a list comprehension.</p>\n\n<pre><code>[x | x &lt;- lst, x&lt;10, x&gt;0]\n</code></pre>\n\n<p>Or perhaps the built in filter function twice.</p>\n\n<pre><code>filter (&lt; 10) (filter (&gt; 0) lst)\n</code></pre>\n"}], "owner": {"reputation": 3258, "user_id": 7661005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0c49d2077073823b91fa1ccc82fa0d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Maxxx", "link": "https://stackoverflow.com/users/7661005/maxxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 788, "favorite_count": 0, "accepted_answer_id": 52800139, "answer_count": 2, "score": 3, "last_activity_date": 1539501211, "creation_date": 1539494408, "question_id": 52799717, "link": "https://stackoverflow.com/questions/52799717/filtering-list-elements-based-on-range-of-value", "title": "Filtering list elements based on range of value", "body": "<p>I have a list declared:</p>\n\n<pre><code>lst = [-1,6,4,13]\n</code></pre>\n\n<p>and i want to filter the list elements with values > 0 and less than 10. I wrote:</p>\n\n<pre><code>filterList :: [Int] -&gt; [Int]\nfilterList lst = filter (&gt;0 &amp;&amp; &lt;10) lst\n</code></pre>\n\n<p>When i run :t filter i can see that:</p>\n\n<pre><code>filter (a -&gt; Bool) -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>But when i run the compiler, the error shown is due to \"&lt;10\" in the filter clause. Is this not the right way to filter as I specified that i want to filter values more than zero and less than 10?</p>\n"}, {"tags": ["haskell", "large-data"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1539509380, "post_id": 52799711, "comment_id": 92521397, "body": "Have you tried with the strict version, <code>foldr&#39;</code>, from <code>Data.Foldable</code>?"}, {"owner": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "edited": false, "score": 2, "creation_date": 1539513614, "post_id": 52799711, "comment_id": 92522333, "body": "The list comprehension does not do what you intend, it runs for every combination (multiplying N^2 factors instead of N). Changing the generator to <code>|(x,y) &lt;- zip lst1 lst2]</code> yields almost instantaneous results for lists with 100k elements when i try it in ghci. How do you create the lists you are using?"}, {"owner": {"reputation": 83, "user_id": 6723576, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205831053970450/picture?type=large", "display_name": "A B", "link": "https://stackoverflow.com/users/6723576/a-b"}, "reply_to_user": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "edited": false, "score": 0, "creation_date": 1539515426, "post_id": 52799711, "comment_id": 92522711, "body": "@JonasDureg&#229;rd The lists represent counts of word occurrences in a collection of texts. The texts are read in a do block, and processed through several functions until we get their vectorized representation. Counts are then computed from the collection of vectorized texts. I did try to use strict foldr and marking lists as strict with !, but to no avail."}, {"owner": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "edited": false, "score": 1, "creation_date": 1539546071, "post_id": 52799711, "comment_id": 92531139, "body": "If you run <code>getP [100000..] [1..100000]</code> or such, do you get a result? Perhaps it&#39;s the production of the input lists that fail? Try printing them or writing them to a file to make sure that is not the problem."}, {"owner": {"reputation": 83, "user_id": 6723576, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205831053970450/picture?type=large", "display_name": "A B", "link": "https://stackoverflow.com/users/6723576/a-b"}, "reply_to_user": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "edited": false, "score": 0, "creation_date": 1539547814, "post_id": 52799711, "comment_id": 92531559, "body": "@JonasDureg&#229;rd I do get almost instantaneous output for getP if I use in-memory data. Will need to figure out how to tame lazy evaluation."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1539550652, "post_id": 52799711, "comment_id": 92532185, "body": "@AndyPants Not exactly a beginner technique, but in my opinion the &quot;proper&quot; memory-efficient way of solving the problem starting from two files in disk would be to use a streaming library (I like &quot;streaming&quot;) to create two effectful producers of values, zip them <a href=\"http://hackage.haskell.org/package/streaming-0.2.2.0/docs/Streaming-Prelude.html#v:zip\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/streaming-0.2.2.0/docs/&hellip;</a> into a single producer of tuples, and consume the combined stream with an Applicative fold library like &quot;foldl&quot; <a href=\"https://stackoverflow.com/a/50050772/1364288\">stackoverflow.com/a/50050772/1364288</a> The &quot;foldl&quot; library provides a generalization of the concept of strict left fold."}], "answers": [{"tags": [], "owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "is_accepted": false, "score": 0, "last_activity_date": 1539503889, "last_edit_date": 1539503889, "creation_date": 1539502728, "answer_id": 52800510, "question_id": 52799711, "link": "https://stackoverflow.com/questions/52799711/process-large-lists-in-haskell-into-a-single-value/52800510#52800510", "title": "Process large lists in Haskell into a single value", "body": "<p>You could try <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:zipWith\" rel=\"nofollow noreferrer\"><code>zipWith</code></a> followed by <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:product\" rel=\"nofollow noreferrer\"><code>product</code></a>:</p>\n\n<pre><code>getP :: [Int] -&gt; [Int] -&gt; Double\ngetP xs ys = product $ zipWith func xs ys\n  where \n    func x y = let dx = fromIntegral x\n                   dy = fromIntegral y\n               in dx / (dx + dy)\n</code></pre>\n\n<p>I would avoid using explicit recursion and stick to library functions for speed. You could also use certain ghc <a href=\"https://wiki.haskell.org/Performance/GHC#Use_optimisation\" rel=\"nofollow noreferrer\">flags</a> to speed up the compiled code.  </p>\n"}, {"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 2, "last_activity_date": 1539527762, "last_edit_date": 1539527762, "creation_date": 1539527141, "answer_id": 52803650, "question_id": 52799711, "link": "https://stackoverflow.com/questions/52799711/process-large-lists-in-haskell-into-a-single-value/52803650#52803650", "title": "Process large lists in Haskell into a single value", "body": "<p>All three solutions have space leaks, maybe that's what causes the unresponsiveness.</p>\n\n<p>In Haskell, when reducing a big list to a single summary value, it is very easy to inadvertently cause space leaks if we never \"look into\" the intermediate values of the computation. We can end up with a gigantic tree of unevaluated thunks hiding behind a seemingly inoffensive single <code>Double</code> value.</p>\n\n<hr>\n\n<p>The <code>foldr</code> example leaks because <code>foldr</code> never forces its accumulator to <a href=\"https://wiki.haskell.org/Weak_head_normal_form\" rel=\"nofollow noreferrer\">weak head normal form</a>. Use the strict left <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Foldable.html#v:foldl-39-\" rel=\"nofollow noreferrer\"><code>foldl'</code></a> instead (you will need to reorder some function arguments). <code>foldl'</code> should ensure that the intermediate <code>Double</code> values remain \"small\" and thunks don't accumulate.</p>\n\n<hr>\n\n<p>The explicit recursion example is dangerous because it is not tail-recursive and for large lists can cause a stack overflow (we repeatedly put values in the stack, waiting for the next recursive call to complete). A solution would involve making the function tail-recursive by <a href=\"https://wiki.haskell.org/Performance/Accumulating_parameter\" rel=\"nofollow noreferrer\">passing the intermediate result as an extra parameter</a>, and putting a <a href=\"https://ocharles.org.uk/posts/2014-12-05-bang-patterns.html\" rel=\"nofollow noreferrer\">bang pattern</a> on that parameter to ensure thunks don't accumulate.</p>\n\n<hr>\n\n<p>The <code>product</code> example leaks because, unfortunately, neither the <code>sum</code> nor the <code>product</code> functions are strict. For large lists, it's better to use <code>foldl'</code> instead. (There's also a bug, as it has been mentioned in the comments.)</p>\n"}], "owner": {"reputation": 83, "user_id": 6723576, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205831053970450/picture?type=large", "display_name": "A B", "link": "https://stackoverflow.com/users/6723576/a-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "accepted_answer_id": 52803650, "answer_count": 2, "score": 1, "last_activity_date": 1539527762, "creation_date": 1539494361, "last_edit_date": 1539498685, "question_id": 52799711, "link": "https://stackoverflow.com/questions/52799711/process-large-lists-in-haskell-into-a-single-value", "title": "Process large lists in Haskell into a single value", "body": "<p>I have 2 lists of Int of equal size (roughly 10,000 elements): say x and y. I need to compute a product of the following expression for each corresponding pair of elements from the lists: x_i/(x_i+y_i), i.e. x_i and y_i are the first elements of the lists, then second, etc.</p>\n\n<p>My approaches work fine on small test cases, but ghci hangs for the larger lists. Any insight as to the cause and solution would be appreciated.</p>\n\n<p>I tried to do this with fold, zipping the lists first:</p>\n\n<pre><code>getP:: [Int] -&gt; [Int] -&gt; Double\ngetP zippedCounts = foldr (\\(x,y) acc -&gt; let intX = fromIntegral x\n                                             intY = fromIntegral y\n                                             intSum = intX + intY in\n                                             (acc*(intX/intSum))) \n                          1.0\n                          zippedCounts\n</code></pre>\n\n<p>I also tried recusion:</p>\n\n<pre><code>getP lst [] = 1.0\ngetP [] lst = 1.0\ngetP (h1:t1) (h2:t2) = ((fromIntegral h1) / ((fromIntegral h1) + (fromIntegral h2))) * (getP t1 t2)\n</code></pre>\n\n<p>As well as list comprehension:</p>\n\n<pre><code>getP lst1 lst2 = (product [((fromIntegral x) / ((fromIntegral x) + (fromIntegral y)))|x &lt;- lst1, y &lt;- lst2])\n</code></pre>\n"}, {"tags": ["haskell", "ghci"], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 6, "last_activity_date": 1539499267, "creation_date": 1539499267, "answer_id": 52800153, "question_id": 52799484, "link": "https://stackoverflow.com/questions/52799484/haskell-ghci-cannot-load-file/52800153#52800153", "title": "Haskell ghci cannot load file", "body": "<p>Haskell source files should end with an extension of <code>hs</code>. Renaming your file should make it work:</p>\n\n<pre><code>$ mv tryout.hl tryout.hs\n</code></pre>\n\n<p>Demo in <code>ghci</code>:</p>\n\n<pre><code>\u03bb&gt; :l tryout.hl\ntarget \u2018tryout.hl\u2019 is not a module name or a source file\n\u03bb&gt; :l tryout.hs\n[1 of 1] Compiling Main             ( tryout.hs, interpreted )\nOk, one module loaded.\n</code></pre>\n"}], "owner": {"reputation": 1496, "user_id": 573877, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a7c7b523aa1eb7a0959ecaf368fe06a0?s=128&d=identicon&r=PG", "display_name": "Salo", "link": "https://stackoverflow.com/users/573877/salo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 396, "favorite_count": 0, "accepted_answer_id": 52800153, "answer_count": 1, "score": 1, "last_activity_date": 1539574717, "creation_date": 1539491530, "last_edit_date": 1539574717, "question_id": 52799484, "link": "https://stackoverflow.com/questions/52799484/haskell-ghci-cannot-load-file", "title": "Haskell ghci cannot load file", "body": "<p>I am new to Haskell and trying to play around with it. Therefore I want to define some functions in a file and then load them in <code>ghci</code>. </p>\n\n<p>I have a file called <code>tryout.hl</code> which I want to load in <code>ghci</code> using either\n<code>:l tryout</code> or <code>:load tryout.hl</code>. With both commands I get <code>target \u2018tryout\u2019 is not a module name or a source file</code>.</p>\n\n<p>What am I doing wrong?</p>\n\n<p>Here  is my shell history:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>[user@pc](~/proggin/haskell)$ ls -lah\ntotal 12K\ndrwxr-xr-x  2 user users 4.0K Oct 14 05:07 .\ndrwxr-xr-x 14 user users 4.0K Oct 13 07:51 ..\n-rw-r--r--  1 user users  138 Oct 14 05:07 tryout.hl\n\n[user@pc](~/proggin/haskell)$ cat tryout.hl \ntake' :: (Num i, Ord i) =&gt; i -&gt; [a] -&gt; [a]  \ntake' n _  \n    | n &lt;= 0   = []  \ntake' _ []     = []  \ntake' n (x:xs) = x : take' (n-1) xs \n\n[user@pc](~/proggin/haskell)$ ghci\nGHCi, version 8.4.3: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; :!pwd\n/home/user/proggin/haskell\nPrelude&gt; :!ls\ntryout.hl\nPrelude&gt; :l tryout\ntarget \u2018tryout\u2019 is not a module name or a source file\nPrelude&gt; :load tryout.hl\ntarget \u2018tryout.hl\u2019 is not a module name or a source file\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 6344028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a549eacec12a0c5d1c804293e8c21a?s=128&d=identicon&r=PG&f=1", "display_name": "macintosh", "link": "https://stackoverflow.com/users/6344028/macintosh"}, "edited": false, "score": 0, "creation_date": 1539513249, "post_id": 52801173, "comment_id": 92522260, "body": "Hey @chi thank you for message. I forgot to type so indentation is Float ... -&gt; Float. Might my question is not clear. I already can see the quadratic equation roots result with above code but as you can see I should add some additional part like ` &quot;Has two real roots&quot; ` ... I tried if-else and getLine I could not do"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 157, "user_id": 6344028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a549eacec12a0c5d1c804293e8c21a?s=128&d=identicon&r=PG&f=1", "display_name": "macintosh", "link": "https://stackoverflow.com/users/6344028/macintosh"}, "edited": false, "score": 0, "creation_date": 1539513331, "post_id": 52801173, "comment_id": 92522282, "body": "@macintosh That would mean that the result is exactly single float. If that&#39;s your type, your function then has only to return a single root."}, {"owner": {"reputation": 157, "user_id": 6344028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a549eacec12a0c5d1c804293e8c21a?s=128&d=identicon&r=PG&f=1", "display_name": "macintosh", "link": "https://stackoverflow.com/users/6344028/macintosh"}, "edited": false, "score": 0, "creation_date": 1539513794, "post_id": 52801173, "comment_id": 92522373, "body": "hmm, after your point I realised my result is an example like &quot;single root&quot; -&gt; [1.0], &quot;two roots&quot; -&gt; [0.5, 2.0]. I should show this result separate as well like <code>0.5 and 2.0</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 157, "user_id": 6344028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a549eacec12a0c5d1c804293e8c21a?s=128&d=identicon&r=PG&f=1", "display_name": "macintosh", "link": "https://stackoverflow.com/users/6344028/macintosh"}, "edited": false, "score": 0, "creation_date": 1539515725, "post_id": 52801173, "comment_id": 92522787, "body": "@macintosh If you want to return those lists, then the result type must be <code>[Float]</code> or something similar. Otherwise you could use a custom return type like <code>data Solutions = None | One Float | Two Float Float</code> and then <code>quadraticprob :: Float -&gt; Float -&gt; Float -&gt; Solutions</code>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1539508403, "creation_date": 1539508403, "answer_id": 52801173, "question_id": 52799296, "link": "https://stackoverflow.com/questions/52799296/haskell-how-can-i-show-function-result/52801173#52801173", "title": "Haskell how can I show function result", "body": "<p>A few hints:</p>\n\n<p>Use a <code>getLine</code> for each argument</p>\n\n<pre><code>... = do\n   astr &lt;- getLine\n   bstr &lt;- getLine\n   cstr &lt;- getLine\n   putStrLn (show (quadraticprob (read astr) (read bstr) (read cstr)))\n</code></pre>\n\n<p>For <code>quadraticprob</code>, it's not clear what your goal actually is. Before writing any code, you should start by writing the intended type.</p>\n\n<pre><code>quadraticprob :: ?? -&gt; ?? -&gt; ?? -&gt; ??\n</code></pre>\n\n<p>What should that be?</p>\n"}, {"tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": false, "score": 2, "last_activity_date": 1539512745, "creation_date": 1539512745, "answer_id": 52801708, "question_id": 52799296, "link": "https://stackoverflow.com/questions/52799296/haskell-how-can-i-show-function-result/52801708#52801708", "title": "Haskell how can I show function result", "body": "<p>Assume you want get 3 integers from standard input call \"getLine\" function once.</p>\n\n<p>The expression</p>\n\n<pre><code>line &lt;- getLine\n</code></pre>\n\n<p>will return a string like (for example)</p>\n\n<pre><code>\"2 2 2\"\n</code></pre>\n\n<p>with spaces between each integer. The first thing need to do is to remove the space and convert it from string to Int type. the <strong><em>words</em></strong> and <strong><em>read</em></strong> functions can solve this easily as below:</p>\n\n<pre><code>map read (words line)::[Int]\n</code></pre>\n\n<p>However, a integers list cannot pass to your quadratic function directly, it need use <strong><em>case</em></strong> get elements from list as below</p>\n\n<pre><code>case map read (words line)::[Int] of \n     [a, b, c] -&gt; putStrLn $ show $ quadraticprob a b c\n</code></pre>\n\n<p>If you want read real number instead of integers, just change map..::[Int] to ::[Double].</p>\n"}], "owner": {"reputation": 157, "user_id": 6344028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a549eacec12a0c5d1c804293e8c21a?s=128&d=identicon&r=PG&f=1", "display_name": "macintosh", "link": "https://stackoverflow.com/users/6344028/macintosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 471, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1539513176, "creation_date": 1539488671, "last_edit_date": 1539513176, "question_id": 52799296, "link": "https://stackoverflow.com/questions/52799296/haskell-how-can-i-show-function-result", "title": "Haskell how can I show function result", "body": "<p>I have a question that asks me find 'quadratic equation' and <code>show</code> result and add number of the roots </p>\n\n<p>example:</p>\n\n<pre><code>Main&gt; quadratric 2 2 2\n2x^2 + 2x + 2 = 0\nHas no real roots.\n\nMain&gt; quadratic 2 5 2\n2x^2 + 5x + 2 = 0\nHas two real roots:\n-2.0 and -0.5\n</code></pre>\n\n<p>So this is quadratic equation:</p>\n\n<pre><code>quadraticprob a b c\n       | root &lt; 0  = error \"Has no real roots\"\n       | root == 0 = [-b/(2*a)]\n       | root &gt; 0  = [-b/(2*a) + sqroot/(2*a),\n                             -b/(2*a) - sqroot/(2*a)]\n       where\n           root = b*b - 4*a*c\n           sqroot = sqrt root\n</code></pre>\n\n<p>I can get the result but I should add how many roots they have so I should use one more function that <code>getLine</code> and show the result.</p>\n\n<p>I made this but it's totally wrong:</p>\n\n<pre><code>readresult :: IO ()\nreadresult = do\n      line &lt;- getLine \n      putStrLn (show (quadraticprob (read line))\n</code></pre>\n\n<p>Can you help me with my mistake please?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1539505616, "post_id": 52798448, "comment_id": 92520550, "body": "You should not vandalize your question. Instead of editing and removing the content (which will be restored by the moderators, anyway), you can <i>close</i> it yourself. Or alternatively, you can answer your own question, if you know how to solve your issue. Note that when a question has an upvoted answer, it can no longer be deleted by SO rules (this does not apply here, so you can still close it yourself)."}], "answers": [{"tags": [], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "is_accepted": false, "score": 2, "last_activity_date": 1539528523, "creation_date": 1539528523, "answer_id": 52803859, "question_id": 52798448, "link": "https://stackoverflow.com/questions/52798448/recursive-convert-a-3-tuple-to-a-char-haskell/52803859#52803859", "title": "Recursive convert a 3-tuple to a char - Haskell", "body": "<p>The best answer I can come up with is that you should probably change your program so that your types represent what you want. Specifically, when I look at your code it seems that you have (or at least you think/you don\u2019t have but wrote the wrong program):</p>\n\n<ol>\n<li>Every <code>[[(Int,Int,Int)]]</code> is a list of the form <code>[xs]</code></li>\n<li>Every <code>(Int,Int,Int)</code> is either <code>(0,0,0)</code> or <code>(1,1,1)</code></li>\n</ol>\n\n<p>Firstly I will write down a solution to your problem as stated. Secondly I will show you how to construct types that represent the state of the wold (and don\u2019t allow you to represent illegal states).</p>\n\n<pre><code>renderThing (0,0,0) = ' '\nrenderThing (1,1,1) = '\u2588'\nrenderState = map (map renderThing)\n</code></pre>\n\n<p>Let\u2019s describe this briefly. The first two lines define a partial function to do what your int-triple-to-char function, as described in the parent.</p>\n\n<p>The third line defines the function you want. Let\u2019s read it from left to right:</p>\n\n<ol>\n<li>To <code>renderState</code> (which will have type <code>[[(Int,Int,Int)]] -&gt; [[Char]]</code>):</li>\n<li>Apply the <code>map renderThing :: [(Int,Int,Int)] -&gt; [Char]</code> to each element of the list passed as input\n\n<ol>\n<li>To do that function, apply <code>renderThing</code> to each element of the inner list (I assume this is a row)</li>\n</ol></li>\n</ol>\n\n<p>Unfortunately your program will crash if you ever violate your implicit invariant that any <code>(Int,Int,Int)</code>  is either <code>(0,0,0)</code>, or <code>(1,1,1)</code>. One better type could be <code>(Bool,Bool,Bool)</code> as each element can then only have one of two values. Another way you could do this is:</p>\n\n<pre><code>data Thing = White | Black\n</code></pre>\n\n<p>There are two ways to put this into your program. Either use good types throughout so the compiler can make sure you never end up in an unexpected state, or you can have conversion functions which can have errors:</p>\n\n<pre><code>renderableBoard :: [[(Int,Int,Int)]] -&gt; Either String [[Thing]]\nrenderableBoard = mapM (mapM convertOne) where\n  convertOne (0,0,0) = White\n  convertOne (1,1,1) = Black\n  convertOne x = \"cannot concert to thing: \" ++ show x\n</code></pre>\n"}], "owner": {"reputation": 1004, "user_id": 1692517, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/893889b69fb20b6f02e3cb7a182e1c47?s=128&d=identicon&r=PG", "display_name": "user1692517", "link": "https://stackoverflow.com/users/1692517/user1692517"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1539528523, "creation_date": 1539476313, "last_edit_date": 1539517450, "question_id": 52798448, "link": "https://stackoverflow.com/questions/52798448/recursive-convert-a-3-tuple-to-a-char-haskell", "title": "Recursive convert a 3-tuple to a char - Haskell", "body": "<p>Given this function, I was wondering how one would approach this problem</p>\n\n<pre><code>convertChar' :: [[(Int, Int, Int)]] -&gt; [[Char]] \n</code></pre>\n\n<p>I have the following helper functions, not sure if they're needed</p>\n\n<pre><code>toList :: [[(Int, Int, Int)]] -&gt; [(Int, Int, Int)]\ntoList [(x)] = (x)\n\nconvertList :: [(Int, Int, Int)] -&gt; [[(Int, Int, Int)]]\nconvertList x = [x] \n</code></pre>\n\n<p>The <code>(Int, Int, Int)</code> will either be <code>(1, 1, 1) or (0, 0, 0)</code></p>\n\n<ul>\n<li>If the tuple is (1, 1, 1) it will return the \u2588 char. </li>\n<li>If the tuple is   (0, 0, 0) it will return \" \"</li>\n</ul>\n\n<p>I was wondering what the smart way to approach this is.\nWould I have to convert the original input from [[()]] to [()]\nApply the functions and then convert back to [[()]] before calling the converChar function recursively again?</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1539473478, "post_id": 52798188, "comment_id": 92516210, "body": "Tip: <a href=\"https://www.haskell.org/hoogle/?hoogle=%28a-%3Eb%29+-%3E+%5Ba%5D+-%3E+%5Bb%5D\" rel=\"nofollow noreferrer\"><code>map :: (a -&gt;b) -&gt; [a] -&gt; [b]</code></a>."}], "answers": [{"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": true, "score": 1, "last_activity_date": 1539473808, "creation_date": 1539473808, "answer_id": 52798262, "question_id": 52798188, "link": "https://stackoverflow.com/questions/52798188/how-to-recursively-iterate-through-a-list-of-3-tuples-in-haskell/52798262#52798262", "title": "How to recursively iterate through a list of 3-tuples in Haskell", "body": "<p>If you want to use recursion then you may do as follows;</p>\n\n<pre><code>modif :: [(Int, Int, Int)] -&gt; [(Int, Int, Int)]\nmodif []                 = []\nmodif (t@(x, _, _) : ts) = case x &gt; 20 of\n                           True -&gt; (50, 50, 50) : modif ts\n                           _    -&gt; t : modif ts\n\n*Main&gt; modif [(0, 0, 0),(30,15,0)]\n[(0,0,0),(50,50,50)]\n</code></pre>\n\n<p>The <code>t@(x, _, _)</code> portion stands for pattern maching <code>x</code> on the first element of the tuple and also naming the whole thing as <code>t</code>.</p>\n"}], "owner": {"reputation": 1004, "user_id": 1692517, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/893889b69fb20b6f02e3cb7a182e1c47?s=128&d=identicon&r=PG", "display_name": "user1692517", "link": "https://stackoverflow.com/users/1692517/user1692517"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 52798262, "answer_count": 1, "score": -2, "last_activity_date": 1539473808, "creation_date": 1539472968, "last_edit_date": 1539473504, "question_id": 52798188, "link": "https://stackoverflow.com/questions/52798188/how-to-recursively-iterate-through-a-list-of-3-tuples-in-haskell", "title": "How to recursively iterate through a list of 3-tuples in Haskell", "body": "<p>I have a list of 3-tuples <code>[(Int, Int, Int)]</code></p>\n\n<p>I have written the following helper functions.</p>\n\n<pre><code>--This function is used to check if the first element is over 20    \ncheckValue :: (Int, Int, Int) -&gt; Bool  \ncheckValue (x, _, _) = x  &gt; 20\n\n\n--This function is used to set the 3-tuple to return (50, 50, 50)\nsetValue :: (Int, Int, Int) -&gt; (Int, Int, Int)\nsetValue a = (50, 50, 50)\n</code></pre>\n\n<p>My goal is to iterate through the list of 3-tuples and apply my helper functions.</p>\n\n<p>For each item in list</p>\n\n<ul>\n<li><p>Run checkValue.</p></li>\n<li><p>If checkValue = true, apply setValue to the current tuple.</p></li>\n<li>Continue</li>\n</ul>\n\n<p>So basically if I have this <code>[(0, 0, 0)(30,15,0)]</code>\nIt would return <code>[(0, 0, 0)(50, 50, 50)]</code></p>\n\n<p>Could someone point me in the right direction, been stuck on this for a while.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1409, "user_id": 7518695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dT38T.jpg?s=128&g=1", "display_name": "GrayCat", "link": "https://stackoverflow.com/users/7518695/graycat"}, "edited": false, "score": 1, "creation_date": 1539471769, "post_id": 52798056, "comment_id": 92515918, "body": "I guess your problem might be in lack of terminating term for recursion. You subtract one from i on each call but recursion ends only in error."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1539473043, "post_id": 52798056, "comment_id": 92516147, "body": "If you make it to the <code>otherwise</code> case, then you know <code>i&lt; 0</code> is <code>False</code> and <code>i&gt;0</code> is <code>False</code>. Now think about what this implies about the value of <code>(i -1 )</code>. Is that what you intended?"}, {"owner": {"reputation": 157, "user_id": 6344028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a549eacec12a0c5d1c804293e8c21a?s=128&d=identicon&r=PG&f=1", "display_name": "macintosh", "link": "https://stackoverflow.com/users/6344028/macintosh"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1539473963, "post_id": 52798056, "comment_id": 92516278, "body": "Hey @DanielWagner I guess same that @GrayCat mentioned. This is the recursion part I guess so when not i &gt; 0 I should get exception but I could not get it. Also did you say if you use &quot;otherwise&quot; case when i &lt; 0 <code>False</code> then i &gt; 0 <code>False</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1539476330, "post_id": 52798056, "comment_id": 92516550, "body": "@macintosh You check <i>both</i> that <code>i&lt; 0</code> and <code>i&gt;0</code> before hitting the <code>otherwise</code> case. So if you hit the <code>otherwise</code> case, both of those must be <code>False</code>."}, {"owner": {"reputation": 157, "user_id": 6344028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a549eacec12a0c5d1c804293e8c21a?s=128&d=identicon&r=PG&f=1", "display_name": "macintosh", "link": "https://stackoverflow.com/users/6344028/macintosh"}, "edited": false, "score": 0, "creation_date": 1539479053, "post_id": 52798056, "comment_id": 92516871, "body": "I got it, so only when <code>i &gt; 0</code> should <code>i - 0</code> otherwise should on <code>i</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1409, "user_id": 7518695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dT38T.jpg?s=128&g=1", "display_name": "GrayCat", "link": "https://stackoverflow.com/users/7518695/graycat"}, "is_accepted": false, "score": 1, "last_activity_date": 1539472555, "creation_date": 1539472555, "answer_id": 52798153, "question_id": 52798056, "link": "https://stackoverflow.com/questions/52798056/how-can-i-use-haskell-exception-for-index-negative/52798153#52798153", "title": "How can I use Haskell exception for index negative", "body": "<p>Add terminating condition for your recursion. On each call you subtract one from i and when it reaches below 0 you just throw error. </p>\n"}, {"comments": [{"owner": {"reputation": 157, "user_id": 6344028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a549eacec12a0c5d1c804293e8c21a?s=128&d=identicon&r=PG&f=1", "display_name": "macintosh", "link": "https://stackoverflow.com/users/6344028/macintosh"}, "edited": false, "score": 0, "creation_date": 1539473280, "post_id": 52798170, "comment_id": 92516174, "body": "Thank you for your answer I forgot to add but I cannot use any built-in function. I guess take and drop functions are already built in."}], "tags": [], "owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "is_accepted": false, "score": 0, "last_activity_date": 1539472779, "creation_date": 1539472779, "answer_id": 52798170, "question_id": 52798056, "link": "https://stackoverflow.com/questions/52798056/how-can-i-use-haskell-exception-for-index-negative/52798170#52798170", "title": "How can I use Haskell exception for index negative", "body": "<p>Probably the easiest approach to this uses the Prelude <a href=\"https://www.stackage.org/haddock/lts-9.13/base-4.9.1.0/Prelude.html#v:take\" rel=\"nofollow noreferrer\">take</a> and <a href=\"https://www.stackage.org/haddock/lts-9.13/base-4.9.1.0/Prelude.html#v:drop\" rel=\"nofollow noreferrer\">drop</a> functions to process the list.  Then you just need to do the bounds checking:</p>\n\n<pre><code>slice :: Int -&gt; Int -&gt; [a] -&gt; Either String [a]\nslice from to lst\n  | from &lt; 0 = Left \"First index cannot be negative (i &lt; 0)!\"\n  | to &lt; from = Left \"First index cannot be greater than second index (i &gt; k)\"\n  | otherwise = Right $ take (to - from) $ drop from $ lst\n</code></pre>\n\n<p>Here I'm using <code>Either</code> to report either success or failure.  On the one hand that disagrees with the problem as stated; on the other, it gives callers a chance to handle the error without immediately terminating the program, which is more polite.</p>\n"}], "owner": {"reputation": 157, "user_id": 6344028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a549eacec12a0c5d1c804293e8c21a?s=128&d=identicon&r=PG&f=1", "display_name": "macintosh", "link": "https://stackoverflow.com/users/6344028/macintosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 531, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1539473314, "creation_date": 1539471449, "last_edit_date": 1539473314, "question_id": 52798056, "link": "https://stackoverflow.com/questions/52798056/how-can-i-use-haskell-exception-for-index-negative", "title": "How can I use Haskell exception for index negative", "body": "<p>I am trying to solve one of my Haskell question. The question asks me to that extracts a slice of a list of integers. Function should take a list and two indexes new list number contains between two indexes.</p>\n\n<p>For this function;</p>\n\n<ul>\n<li>First index should smaller than second index</li>\n<li>First index cannot be negative number\n\n<ul>\n<li>we cannot use any built-in functions</li>\n</ul></li>\n</ul>\n\n<p>example:</p>\n\n<pre><code>makeSlice [1,2,3,4,5] 2 3\n[3,4]\nmakeSlice [1,2,3,4,5] (-1) 3\n*** Exception: First index cannot be negative\n</code></pre>\n\n<p>I tried a few option but below function if I give positive number I am getting <strong>\"First index cannot be negative\"</strong> exception</p>\n\n<pre><code>makeSlice :: [a] -&gt; Int -&gt; Int -&gt; [a]\nmakeSlice [] _ _ =[]\n\nmakeSlice (h:t) i k\n\n    |k &lt; 0 = []\n    | i&gt;k  = error \"First index cannot be greater than second index (i &gt; k)\"\n    | i&lt; 0 = error \"First index cannot be negative (i &lt; 0)!\"\n    | i&gt;0 = makeSlice t (i - 1) (k - 1)\n    | otherwise = h:makeSlice t (i -1 ) (k - 1)\n</code></pre>\n\n<p>Can you help me to find where I am making wrong?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1539471389, "post_id": 52798038, "comment_id": 92515851, "body": "The list constructor is <code>:</code>, not <code>::</code>. You&#39;ve also written <code>in</code> twice in your second attempt."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1539471408, "post_id": 52798038, "comment_id": 92515854, "body": "Sidenote: Haskell functions are called like <code>func arg1 arg2 arg3 ...</code>. Calling them like <code>func(arg1)</code> is bad style and will likely cause problems later."}, {"owner": {"reputation": 3608, "user_id": 1040915, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5d4fad479f4b604d4acc731fdae68d9d?s=128&d=identicon&r=PG", "display_name": "scubbo", "link": "https://stackoverflow.com/users/1040915/scubbo"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1539471558, "post_id": 52798038, "comment_id": 92515889, "body": "Writing <code>in</code> twice was intentional (though, I will admit, unintuitive!) since there are two &quot;ins&quot; in the example at the bottom of <a href=\"https://www.cmi.ac.in/~madhavan/courses/pl2011/lecturenotes/lecture-notes/node70.html\" rel=\"nofollow noreferrer\">here</a>. I&#39;ll try with just one - thanks! And yes - that was certainly a simple typo (<code>:</code>/<code>::</code>) that I missed, thank you!  I&#39;ve certainly noticed that style, and I&#39;ve usually tried to match it, but I put in the parentheses to make sure I was clear about what was calling what. Thanks for the tip!"}], "answers": [{"comments": [{"owner": {"reputation": 3608, "user_id": 1040915, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5d4fad479f4b604d4acc731fdae68d9d?s=128&d=identicon&r=PG", "display_name": "scubbo", "link": "https://stackoverflow.com/users/1040915/scubbo"}, "edited": false, "score": 0, "creation_date": 1539472135, "post_id": 52798068, "comment_id": 92515978, "body": "Thank you very much! Amazing how much difference an extra colon can make to how the compiler interprets commands :)"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 3608, "user_id": 1040915, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5d4fad479f4b604d4acc731fdae68d9d?s=128&d=identicon&r=PG", "display_name": "scubbo", "link": "https://stackoverflow.com/users/1040915/scubbo"}, "edited": false, "score": 2, "creation_date": 1539472185, "post_id": 52798068, "comment_id": 92515991, "body": "@scubbo Much like a stray semicolon, one might say ;)"}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 3, "last_activity_date": 1539471603, "creation_date": 1539471603, "answer_id": 52798068, "question_id": 52798038, "link": "https://stackoverflow.com/questions/52798038/not-in-scope-type-constructor-or-class-and-other-errors-while-reversing-a/52798068#52798068", "title": "Not in scope: type constructor or class \u2018-\u2019 (and other errors while reversing a list)", "body": "<p>Lists are constructed with <code>:</code>. <code>::</code> denotes a type, and so Haskell tries to read it as a type, hence the error.</p>\n\n<p>The corrected code is:</p>\n\n<pre><code>reverseList1 :: [a] -&gt; [a]\nreverseList1 [] = []\nreverseList1 [x] = [x]\nreverseList1 l = last l : reverseList1 (take (length l - 1) l)\n</code></pre>\n\n<p>Note the bracketing that makes the code more readable!</p>\n\n<p>In your second attempt, you write <code>in</code> twice and the parser gets confused.</p>\n\n<p>The corrected code is:</p>\n\n<pre><code>reverseList1 l =\n  let takeLength = length l - 1\n  in last l : reverseList1 (take takeLength) l\n</code></pre>\n\n<hr>\n\n<p>Now, the error is actually quite interesting. The <code>TypeOperators</code> extension is one that allows (unsurprisingly) infix operators in type declarations.</p>\n\n<p>Here, the compiler noticed that <code>-</code> looked like an infix operator, and given that it was in a type signaures inferred that you probably meant to use the <code>TypeOperators</code> extension. Of course, that wasn't the case here!</p>\n\n<p>As for <code>DataKinds</code>, that is a fairly advanced extension that allows you to put data (like <code>1</code>, <code>\"Hello\"</code> etc.) in types. I won't go into exactly what it's used for here, but the reason that the compiler mentioned it is that you used <code>1</code> in a type signature, which can only be used with the <code>DataKinds</code> extension.</p>\n"}], "owner": {"reputation": 3608, "user_id": 1040915, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5d4fad479f4b604d4acc731fdae68d9d?s=128&d=identicon&r=PG", "display_name": "scubbo", "link": "https://stackoverflow.com/users/1040915/scubbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 652, "favorite_count": 0, "accepted_answer_id": 52798068, "answer_count": 1, "score": 1, "last_activity_date": 1539471603, "creation_date": 1539471135, "question_id": 52798038, "link": "https://stackoverflow.com/questions/52798038/not-in-scope-type-constructor-or-class-and-other-errors-while-reversing-a", "title": "Not in scope: type constructor or class \u2018-\u2019 (and other errors while reversing a list)", "body": "<p>I'm working through the \"Seven Languages In Seven Weeks\" book, and one of the questions in the first day of Haskell is to \"<em>Write a function that takes a list and returns the same list in reverse</em>\".</p>\n\n<p>My first implementation worked fine:</p>\n\n<pre><code>reverseList :: [a] -&gt; [a]\nreverseList [] = []\nreverseList [x] = [x]\nreverseList (h:t) = reverseList(t) ++ [h]\n</code></pre>\n\n<p>I then thought of another approach, which I tried to implement as:</p>\n\n<pre><code>reverseList1 :: [a] -&gt; [a]\nreverseList1 [] = []\nreverseList1 [x] = [x]\nreverseList1 l = last(l) :: reverseList1(take(length(l)-1)(l))\n</code></pre>\n\n<p>(That is - take the last element, then append to it the reversed first-all-but-one elements). However, this gave me an error (actually, three) when I tried to load the file:</p>\n\n<pre><code>[1 of 1] Compiling Day1             ( day1.hs, interpreted )\n\nday1.hs:35:49: error: Not in scope: type constructor or class \u2018-\u2019\n   |\n35 |   reverseList1 l = last(l) :: reverseList1(take(length(l)-1)(l))\n   |                                                 ^^^^^^^^^^^\n\nday1.hs:35:49: error:\n    Illegal operator \u2018-\u2019 in type \u2018length (l) - 1\u2019\n      Use TypeOperators to allow operators in types\n   |\n35 |   reverseList1 l = last(l) :: reverseList1(take(length(l)-1)(l))\n   |                                                 ^^^^^^^^^^^\n\nday1.hs:35:59: error:\n    Illegal type: \u20181\u2019 Perhaps you intended to use DataKinds\n   |\n35 |   reverseList1 l = last(l) :: reverseList1(take(length(l)-1)(l))\n   |                                                           ^\nFailed, no modules loaded.\n</code></pre>\n\n<hr>\n\n<p>Googling for the \"not in scope\" error suggested that I'm trying to use something which hasn't been imported - I don't <em>think</em> that I need to explicitly import \"subtract\", based on other experiments.</p>\n\n<p>I don't understand the second error (<code>Use TypeOperators to allow operators in types</code>) - I see from <a href=\"https://stackoverflow.com/questions/33566889/how-to-resolve-use-of-operators-in-type-declaration-repa\">here</a> that <code>TypeOperators</code> is a flag I can set on <code>ghci</code>, but I'm not <em>trying</em> to use an operator in a type - <code>length(l)-1</code> is (to the best of my knowledge) an argument to <code>take</code>, not a type.</p>\n\n<p>Googling \"perhaps you intended to use DataTypes\" led me to <a href=\"https://stackoverflow.com/questions/33714435/haskell-again-illegal-types\">here</a> - I <em>hope</em> that my code won't be as ripped-apart as that example, but it's possible that I'm equally clueless!</p>\n\n<hr>\n\n<p>Based on the last example <a href=\"https://www.cmi.ac.in/~madhavan/courses/pl2011/lecturenotes/lecture-notes/node70.html\" rel=\"nofollow noreferrer\">here</a>, I also tried:</p>\n\n<pre><code>reverseList1 l = last(l) :: reverseList1(take(takeLength)(l))\n  where takeLength = length(l)-1\n</code></pre>\n\n<p>(which gave a (very lengthy!) error starting with \"Couldn't match type 'a'\") and</p>\n\n<pre><code>reverseList1 l =\n  let takeLength = length(l)-1 in\n  in last(l) :: reverseList1(take(takeLength)(l))\n</code></pre>\n\n<p>Which gave</p>\n\n<pre><code>day1.hs:40:5: error: parse error on input \u2018in\u2019\n   |\n40 |     in last(l) :: reverseList1(take(takeLength)(l))\n   |     ^^\nFailed, no modules loaded.\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1539465533, "post_id": 52797411, "comment_id": 92514561, "body": "You are looking for <code>minimum</code>: <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:minimum\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.12.0.0/docs/&hellip;</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1539465546, "post_id": 52797411, "comment_id": 92514564, "body": "<code>min a b</code> takes two arguments, only. For a list of values, use <code>minimum list</code> instead. (And don&#39;t use square brackets like <code>[factors n]</code> unless you want a list with exactly one element inside)"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1539465565, "post_id": 52797411, "comment_id": 92514569, "body": "<code>min</code> works for <i>two</i> items, <code>minimum</code> for a <code>Foldable</code> of items."}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 4, "last_activity_date": 1539467110, "creation_date": 1539467110, "answer_id": 52797631, "question_id": 52797411, "link": "https://stackoverflow.com/questions/52797411/how-to-i-properly-use-the-min-function-in-haskell-code/52797631#52797631", "title": "How to I properly use the min function in Haskell code?", "body": "<p>You mean <a href=\"https://www.haskell.org/hoogle/?hoogle=minimum\" rel=\"nofollow noreferrer\"><code>minimum :: Ord a =&gt; [a] -&gt; a</code></a>. Plus, you're erroneously using square brackets when you should be using parentheses. Don't use square brackets when you're not explicity defining a list!</p>\n\n<p>Here's the corrected part:</p>\n\n<pre><code>smallestFactor n = minimum (factors n)\n</code></pre>\n\n<p>The rest of your code is fine.</p>\n"}], "owner": {"reputation": 31, "user_id": 10470086, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ABpfO8koRkA/AAAAAAAAAAI/AAAAAAAAAMQ/0Glud0tdsKM/photo.jpg?sz=128", "display_name": "Li Wang", "link": "https://stackoverflow.com/users/10470086/li-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "closed_date": 1539495140, "answer_count": 1, "score": -2, "last_activity_date": 1539467110, "creation_date": 1539465432, "question_id": 52797411, "link": "https://stackoverflow.com/questions/52797411/how-to-i-properly-use-the-min-function-in-haskell-code", "closed_reason": "Not suitable for this site", "title": "How to I properly use the min function in Haskell code?", "body": "<pre><code>main = print $ smallestFactor 15\n\nfactors n = [x | x &lt;- [2..n], n `mod` x == 0]\nsmallestFactor n = min[factors n]\n</code></pre>\n\n<p>I understand that it's a pretty trivial question but someone told me that I could use min get grab out the smallest value of a element list. Though, I'm not exactly sure how one is suppose to use it. </p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 1915, "user_id": 2682729, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PZlkg.gif?s=128&g=1", "display_name": "typesanitizer", "link": "https://stackoverflow.com/users/2682729/typesanitizer"}, "edited": false, "score": 0, "creation_date": 1539453760, "post_id": 52795764, "comment_id": 92511719, "body": "If you&#39;re always specifying the resolver using the <code>--resolver</code> flag, why not write the same resolver in <code>stack.yaml</code>? Are you switching resolvers frequently?"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 1915, "user_id": 2682729, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PZlkg.gif?s=128&g=1", "display_name": "typesanitizer", "link": "https://stackoverflow.com/users/2682729/typesanitizer"}, "edited": false, "score": 0, "creation_date": 1539453945, "post_id": 52795764, "comment_id": 92511760, "body": "@theindigamer: It&#39;s not one-to-one and I&#39;m trying to avoid (a) proliferation of files and (b) writing the same thing in several places. E.g., <a href=\"https://github.com/orome/crypto-enigma-hs/tree/develop/travis-stacks\" rel=\"nofollow noreferrer\">I&#39;ve got</a> one <code>just_use_resolver.yaml</code>  and another <code>add_extra_dep_xyz.yaml</code>, and each of those applies to several different resolvers."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1539456942, "post_id": 52796180, "comment_id": 92512515, "body": "I&#39;d be a little temped to document this using something like <code>resolver: chooseTheResolverOnTheCLI</code>. In such way, hopefully <code>stack</code> will produce a error hinting at the issue, if the user reads it carefully."}], "tags": [], "owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "is_accepted": true, "score": 3, "last_activity_date": 1539456457, "creation_date": 1539456457, "answer_id": 52796180, "question_id": 52795764, "link": "https://stackoverflow.com/questions/52795764/can-i-omit-or-specify-a-dummy-value-for-resolver-in-my-stack-yaml/52796180#52796180", "title": "Can I omit or specify a &quot;dummy&quot; value for &#39;resolver&#39; in my stack.yaml", "body": "<p>It is not idiomatic to do things this way with stack, but you can put anything in the <code>resolver</code> field, and it will be ignored by stack if you supply the <code>--resolver</code> flag. For example:</p>\n\n<pre><code>$ cat stack.yaml\n# stack.yaml\nresolver: none\npackages: []\nextra-deps:\n- tardis-0.2.0.0\n\n$ stack repl\nUnable to load custom resolver none from local file:\n  /Users/dan/scratch/stack-no-resolver-test/none\nException: InvalidYaml (Just (YamlException \"Yaml file not found: /Users/dan/scratch/stack-no-resolver-test/none\"))\n\n $ stack --resolver lts-12.0 repl\n...\nConfiguring GHCi with the following packages:\nGHCi, version 8.4.3: http://www.haskell.org/ghc/  :? for help \n</code></pre>\n\n<p>You just have to be able to understand that the \"unable to load custom resolver none\" error message, for your use case, means that you forgot to supply <code>--resolver</code> on the command line.</p>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 1, "accepted_answer_id": 52796180, "answer_count": 1, "score": 2, "last_activity_date": 1539456457, "creation_date": 1539453404, "question_id": 52795764, "link": "https://stackoverflow.com/questions/52795764/can-i-omit-or-specify-a-dummy-value-for-resolver-in-my-stack-yaml", "title": "Can I omit or specify a &quot;dummy&quot; value for &#39;resolver&#39; in my stack.yaml", "body": "<p>I am using <code>stack.yaml</code> files in conjunction with a specified <code>--resolver</code> so that the <code>resolver</code> key in <code>stack.yaml</code> is (or should be) always ignored. </p>\n\n<p>Is there a way to specify this fact in the <code>stack.yaml</code> itself? Or is there an idiom for expressing this there. I'd like to simply omit <code>resolver</code> from the file, but that's not allowed.</p>\n"}, {"tags": ["haskell", "monads", "maybe"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1539450913, "post_id": 52795360, "comment_id": 92510912, "body": "The point is that these calculations should result in a <code>Maybe</code> as well, or if not, you can use a <code>return</code>."}, {"owner": {"reputation": 23, "user_id": 10499964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e79c5e2de3a7bc460ab31af47774c2?s=128&d=identicon&r=PG&f=1", "display_name": "lookarpthestars", "link": "https://stackoverflow.com/users/10499964/lookarpthestars"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1539451353, "post_id": 52795360, "comment_id": 92511053, "body": "Not sure what you&#39;re referring to, <code>compute</code> or <code>main</code>? Either way, <code>compute</code> already returns a <code>Maybe</code> value, while <code>main</code> is intended to definitely return an <code>Int</code>, hence no <code>Maybe</code>. In other words, one of the calculations in <code>main</code> might fail, but at least one should pass which guarantees that <code>main</code> has an <code>Int</code> return value."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1539451527, "post_id": 52795360, "comment_id": 92511104, "body": "but the idea of a <code>Monad Maybe</code> is to see <code>Maybe</code>s as &quot;potentially failing&quot; computations. So here you make a &quot;chain&quot; of potentially failing computations, and return <code>Just result</code> in case it succeeds, and <code>Nothing</code> otherwise. If you are sure <code>compute</code> will always return an <code>Just _</code>, then why does it have the signature <code>Int -&gt; Int -&gt; Maybe Int</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10499964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e79c5e2de3a7bc460ab31af47774c2?s=128&d=identicon&r=PG&f=1", "display_name": "lookarpthestars", "link": "https://stackoverflow.com/users/10499964/lookarpthestars"}, "edited": false, "score": 0, "creation_date": 1539452120, "post_id": 52795475, "comment_id": 92511267, "body": "Thanks, your comment that refers to it as a chain of successful actions made it clearer to me, and I realize I actually am going in the wrong direction. What I intend is not for it to be a chain of actions, but a series of computations (which any might fail, but one is guaranteed to pass), and returning the first out of the series that passed. In essence, what <code>main</code> is doing is abstracting away the possible failures and choosing the first that succeeds, so that a definite <code>Int</code> value can be used elsewhere when it calls <code>main</code>. Is there a way to do this?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 23, "user_id": 10499964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e79c5e2de3a7bc460ab31af47774c2?s=128&d=identicon&r=PG&f=1", "display_name": "lookarpthestars", "link": "https://stackoverflow.com/users/10499964/lookarpthestars"}, "edited": false, "score": 0, "creation_date": 1539452345, "post_id": 52795475, "comment_id": 92511334, "body": "@lookarpthestars: you could use <code>asum</code> for that, like <code>asum [compute x y, compute (x+2) (y+2)]</code>, which will return the first <code>Just</code> in the list, but this is still a <code>Maybe</code>, since it is possible that <i>all</i> computations fail."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 23, "user_id": 10499964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e79c5e2de3a7bc460ab31af47774c2?s=128&d=identicon&r=PG&f=1", "display_name": "lookarpthestars", "link": "https://stackoverflow.com/users/10499964/lookarpthestars"}, "edited": false, "score": 0, "creation_date": 1539452350, "post_id": 52795475, "comment_id": 92511337, "body": "See: <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Foldable.html#v:asum\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.12.0.0/docs/&hellip;</a>"}, {"owner": {"reputation": 23, "user_id": 10499964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e79c5e2de3a7bc460ab31af47774c2?s=128&d=identicon&r=PG&f=1", "display_name": "lookarpthestars", "link": "https://stackoverflow.com/users/10499964/lookarpthestars"}, "edited": false, "score": 0, "creation_date": 1539452937, "post_id": 52795475, "comment_id": 92511516, "body": "Sweet, this comment along with the part you added after the edit gives me something to work from. Appreciate the concise answer."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 23, "user_id": 10499964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e79c5e2de3a7bc460ab31af47774c2?s=128&d=identicon&r=PG&f=1", "display_name": "lookarpthestars", "link": "https://stackoverflow.com/users/10499964/lookarpthestars"}, "edited": false, "score": 0, "creation_date": 1539531856, "post_id": 52795475, "comment_id": 92527064, "body": "@lookarpthestars to your first comment, <i>no</i>,  main is <i>not</i> &quot;choosing the first that succeeds&quot;. only if all three computations succeed it returns a Just (with the sum of three results). otherwise it returns Nothing. so it tries to run all of them (one after another, but <i>all</i> of them) and then combine all the results."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 8, "last_activity_date": 1539469513, "last_edit_date": 1539469513, "creation_date": 1539451418, "answer_id": 52795475, "question_id": 52795360, "link": "https://stackoverflow.com/questions/52795360/do-notation-for-monad-in-function-returning-a-different-type/52795475#52795475", "title": "Do notation for monad in function returning a different type", "body": "<p>Well the signature is in essence wrong. The result should be a <code>Maybe Int</code>:</p>\n\n<pre><code>main :: Int -&gt; Int -&gt; <b>Maybe Int</b>\nmain x y = do\n  first &lt;- compute x y\n  second &lt;- compute (x+2) (y+2)\n  third &lt;- compute (x+4) (y+4)\n  <b>return</b> (first + second + third)</code></pre>\n\n<p>For example here we <code>return (first + second + third)</code>, and the <code>return</code> will wrap these in a <code>Just</code> data constructor.</p>\n\n<p>This is because your <code>do</code> block, implicitly uses the <code>&gt;&gt;=</code> of the <code>Monad Maybe</code>, which is defined as:</p>\n\n<pre><code>instance Monad Maybe where\n    Nothing &gt;&gt;=_ = Nothing\n    (Just x) &gt;&gt;= f = f x\n    return = Just\n</code></pre>\n\n<p>So that means that it will indeed \"unpack\" values out of a <code>Just</code> data constructor, but in case a <code>Nothing</code> comes out of it, then this means that the result of the entire <code>do</code> block will be <code>Nothing</code>.</p>\n\n<p>This is more or less the convenience the <code>Monad Maybe</code> offers: you can make computations as a chain of <em>succesful</em> actions, and in case one of these fails, the result will be <code>Nothing</code>, otherwise it will be <code>Just result</code>.</p>\n\n<p>You can thus not at the end return an <code>Int</code> instead of a <code>Maybe Int</code>, since it is definitely possible - from the perspective of the types - that one or more computations <em>can</em> return a <code>Nothing</code>.</p>\n\n<p>You can however \"post\" process the result of the <code>do</code> block, if you for example add a \"default\" value that will be used in case one of the computations is <code>Nothing</code>, like:</p>\n\n<pre><code>import Data.Maybe(fromMaybe)\n\nmain :: Int -&gt; Int -&gt; <b>Int</b>\nmain x y = <b>fromMaybe 0</b> $ do\n  first &lt;- compute x y\n  second &lt;- compute (x+2) (y+2)\n  third &lt;- compute (x+4) (y+4)\n  return (first + second + third)</code></pre>\n\n<p>Here in case the <code>do</code>-block thus returns a <code>Nothing</code>, we replace it with <code>0</code> (you can of course add another value in the <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Maybe.html#v:fromMaybe\" rel=\"nofollow noreferrer\"><strong><code>fromMaybe :: a -&gt; Maybe a -&gt; a</code></strong></a> as a value in case the computation \"fails\").</p>\n\n<p>If you want to return the first element in a list of <code>Maybe</code>s that is <code>Just</code>, then you can use <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Foldable.html#v:asum\" rel=\"nofollow noreferrer\"><strong><code>asum :: (Foldable t, Alternative f) =&gt; t (f a) -&gt; f a</code></strong></a>, so then you can write your <code>main</code> like:</p>\n\n<pre><code>-- first <i>non</i>-failing computation\n\nimport Data.Foldable(asum)\nimport Data.Maybe(fromMaybe)\n\nmain :: Int -&gt; Int -&gt; Int\nmain x y = fromMaybe 0 $ <b>asum</b> [\n    compute x y\n    compute (x+2) (y+2)\n    compute (x+4) (y+4)\n]</code></pre>\n\n<p>Note that the <code>asum</code> can still contain only <code>Nothing</code>s, so you still need to do some post-processing.</p>\n"}, {"tags": [], "owner": {"reputation": 767, "user_id": 814796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZQemO.jpg?s=128&g=1", "display_name": "madgen", "link": "https://stackoverflow.com/users/814796/madgen"}, "is_accepted": false, "score": 3, "last_activity_date": 1539452216, "last_edit_date": 1539452216, "creation_date": 1539452185, "answer_id": 52795586, "question_id": 52795360, "link": "https://stackoverflow.com/questions/52795360/do-notation-for-monad-in-function-returning-a-different-type/52795586#52795586", "title": "Do notation for monad in function returning a different type", "body": "<p>Willem's answer is basically perfect, but just to really drive the point home, let's think about what would happen if you could write something that allows you to return an int.</p>\n\n<p>So you have the <code>main</code> function with type <code>Int -&gt; Int -&gt; Int</code>, let's assume an implementation of your <code>compute</code> function as follows:</p>\n\n<pre><code>compute :: Int -&gt; Int -&gt; Maybe Int\ncompute a 0 = Nothing\ncompute a b = Just (a `div` b)\n</code></pre>\n\n<p>Now this is basically a safe version of the integer division function <code>div :: Int -&gt; Int -&gt; Int</code> that returns a <code>Nothing</code> if the divisor is <code>0</code>.</p>\n\n<p>If you could write a main function as you like that returns an <code>Int</code>, you'd be able to write the following:</p>\n\n<pre><code>unsafe :: Int\nunsafe = main 10 (-2)\n</code></pre>\n\n<p>This would make the <code>second &lt;- compute ...</code> fail and return a <code>Nothing</code> but now you have to interpret your <code>Nothing</code> as a number which is not good. It defeats the whole purpose of using <code>Maybe</code> monad which captures failure safely. You can, of course, give a default value to <code>Nothing</code> as Willem described, but that's not always appropriate.</p>\n\n<p>More generally, when you're inside a <code>do</code> block you should just think inside \"the box\" that is the monad and don't try to escape. In some cases like <code>Maybe</code> you might be able to do <code>unMaybe</code> with something like <code>fromMaybe</code> or <code>maybe</code> functions, but not in general.</p>\n"}, {"tags": [], "owner": {"reputation": 2638, "user_id": 7208029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QxbAJ.png?s=128&g=1", "display_name": "Chai T. Rex", "link": "https://stackoverflow.com/users/7208029/chai-t-rex"}, "is_accepted": false, "score": 1, "last_activity_date": 1539452909, "last_edit_date": 1539452909, "creation_date": 1539452509, "answer_id": 52795636, "question_id": 52795360, "link": "https://stackoverflow.com/questions/52795360/do-notation-for-monad-in-function-returning-a-different-type/52795636#52795636", "title": "Do notation for monad in function returning a different type", "body": "<p>I have two interpretations of your question, so to answer both of them:</p>\n\n<h2>Sum the <code>Maybe Int</code> values that are <code>Just n</code> to get an <code>Int</code></h2>\n\n<p>To sum <code>Maybe Int</code>s while throwing out <code>Nothing</code> values, you can use <code>sum</code> with <a href=\"https://hackage.haskell.org/package/base/docs/Data-Maybe.html#v:catMaybes\" rel=\"nofollow noreferrer\"><code>Data.Maybe.catMaybes :: [Maybe a] -&gt; [a]</code></a> to throw out <code>Nothing</code> values from a list:</p>\n\n<pre><code>sum . catMaybes $ [compute x y, compute (x+2) (y+2), compute (x+4) (y+4)]\n</code></pre>\n\n<h2>Get the first <code>Maybe Int</code> value that's <code>Just n</code> as an <code>Int</code></h2>\n\n<p>To get the first non-<code>Nothing</code> value, you can use <code>catMaybes</code> combined with <a href=\"https://hackage.haskell.org/package/base/docs/Data-Maybe.html#v:listToMaybe\" rel=\"nofollow noreferrer\"><code>listToMaybe :: [a] -&gt; Maybe a</code></a> to get <code>Just</code> the first value if there is one or <code>Nothing</code> if there isn't and <a href=\"https://hackage.haskell.org/package/base/docs/Data-Maybe.html#v:fromMaybe\" rel=\"nofollow noreferrer\"><code>fromMaybe :: a -&gt; Maybe a -&gt; a</code></a> to convert <code>Nothing</code> to a default value:</p>\n\n<pre><code>fromMaybe 0 . listToMaybe . catMaybes $ [compute x y, compute (x+2) (y+2), compute (x+4) (y+4)]\n</code></pre>\n\n<p>If you're <strong>guaranteed</strong> to have at least one succeed, use <code>head</code> instead:</p>\n\n<pre><code>head . catMaybes $ [compute x y, compute (x+2) (y+2), compute (x+4) (y+4)]\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10499964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e79c5e2de3a7bc460ab31af47774c2?s=128&d=identicon&r=PG&f=1", "display_name": "lookarpthestars", "link": "https://stackoverflow.com/users/10499964/lookarpthestars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 52795475, "answer_count": 3, "score": 2, "last_activity_date": 1539469513, "creation_date": 1539450647, "last_edit_date": 1539451664, "question_id": 52795360, "link": "https://stackoverflow.com/questions/52795360/do-notation-for-monad-in-function-returning-a-different-type", "title": "Do notation for monad in function returning a different type", "body": "<p>Is there a way to write <code>do</code> notation for a monad in a function which the return type isn't of said monad? </p>\n\n<p>I have a main function doing most of the logic of the code, supplemented by another function which does some calculations for it in the middle. The supplementary function might fail, which is why it is returning a <code>Maybe</code> value. I'm looking to use the <code>do</code> notation for the returned values in the main function. Giving a generic example:</p>\n\n<pre><code>-- does some computation to two Ints which might fail\ncompute :: Int -&gt; Int -&gt; Maybe Int\n\n-- actual logic \nmain :: Int -&gt; Int -&gt; Int\nmain x y = do\n  first &lt;- compute x y\n  second &lt;- compute (x+2) (y+2)\n  third &lt;- compute (x+4) (y+4)\n  -- does some Int calculation to first, second and third\n</code></pre>\n\n<p>What I intend is for <code>first</code>, <code>second</code>, and <code>third</code> to have the actual <code>Int</code> values, taken out of the <code>Maybe</code> context, but doing the way above makes Haskell complain about not being able to match types of <code>Maybe Int</code> with <code>Int</code>.</p>\n\n<p>Is there a way to do this? Or am I heading towards the wrong direction?</p>\n\n<p>Pardon me if some terminology is wrongly used, I'm new to Haskell and still trying to wrap my head around everything.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p><code>main</code> has to return an <code>Int</code>, without being wrapped in <code>Maybe</code>, as there is another part of the code using the result of <code>main</code>as <code>Int</code>. The results of a single <code>compute</code> might fail, but they should collectively pass (i.e. at least one would pass) in <code>main</code>, and what I'm looking for is a way to use <code>do</code> notation to take them out of <code>Maybe</code>, do some simple <code>Int</code> calculations to them (e.g. possibly treating any <code>Nothing</code> returned as <code>0</code>), and return the final value as just <code>Int</code>.</p>\n"}, {"tags": ["haskell", "floating-point", "decimal", "rounding"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 10, "creation_date": 1539445860, "post_id": 52794697, "comment_id": 92509489, "body": "Do you understand floating point?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 4, "creation_date": 1539446662, "post_id": 52794697, "comment_id": 92509698, "body": "I don&#39;t think this is a Haskell-specific problem. Floating point errors are <a href=\"http://www.smbc-comics.com/comics/20130605.png\" rel=\"nofollow noreferrer\">a well-known problem</a>, and the full mechanics of floating-point numbers can be <i>extremely</i> complex. If you really want to know about it, there are <a href=\"https://www.ias.ac.in/article/fulltext/reso/021/01/0011-0030\" rel=\"nofollow noreferrer\">plenty</a> <a href=\"http://flint.cs.yale.edu/cs422/doc/art-of-asm/pdf/CH14.PDF\" rel=\"nofollow noreferrer\">of</a> <a href=\"https://people.eecs.berkeley.edu/~wkahan/ieee754status/IEEE754.PDF\" rel=\"nofollow noreferrer\">specifications</a> available online."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1539446670, "post_id": 52794697, "comment_id": 92509701, "body": "These floating point numbers are represented in base 2 in a computer, and all operations happen in base 2. They are converted in base 10 only just before they are printed on screen, for human readability."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1539447038, "post_id": 52794697, "comment_id": 92509798, "body": "@AJFarmar Indeed it&#39;s not Haskell-specific: I just tried running the above divisions on Python, and got the same rounding errors. (Hardly a surprise, of course.)"}, {"owner": {"reputation": 6159, "user_id": 754705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/942fe51aac5dc523f0305439fa9a6e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/754705/michael"}, "edited": false, "score": 2, "creation_date": 1539448160, "post_id": 52794697, "comment_id": 92510167, "body": "it works exactly as it should. this is really not a haskell problem. it&#39;s just the way how floating point numbers work."}, {"owner": {"reputation": 243, "user_id": 3101837, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/be519e779b6eb7672b6bd1a02a966b71?s=128&d=identicon&r=PG", "display_name": "Jeffrey Lebowski", "link": "https://stackoverflow.com/users/3101837/jeffrey-lebowski"}, "edited": false, "score": 0, "creation_date": 1539453134, "post_id": 52794697, "comment_id": 92511565, "body": "Got it, thanks! That makes me want to try and learn Assembly before."}, {"owner": {"reputation": 1091, "user_id": 2160562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CcQEn.png?s=128&g=1", "display_name": "gammatester", "link": "https://stackoverflow.com/users/2160562/gammatester"}, "edited": false, "score": 0, "creation_date": 1539454871, "post_id": 52794697, "comment_id": 92512008, "body": "Actually the decimal printout should be <code>14&#47;3 = 4.6666666666666670</code>, it seems that trailing zeros are suppressed."}], "answers": [{"tags": [], "owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 10, "last_activity_date": 1539455690, "last_edit_date": 1539455690, "creation_date": 1539454959, "answer_id": 52795975, "question_id": 52794697, "link": "https://stackoverflow.com/questions/52794697/doubts-over-ghci-simple-arithmetics/52795975#52795975", "title": "Doubts over ghci simple arithmetics", "body": "<p>The <a href=\"https://wiki.haskell.org/Language_and_library_specification\" rel=\"noreferrer\">Haskell specification</a> leaves some slack in its specification of floating-point formats and behaviors. It says Haskell\u2019s <code>Double</code> type should cover IEEE \u201cdouble-precision\u201d in range and precision, the default operations defined by the Haskell Prelude do not conform to certain standards, but some aspects of IEEE floating-point have been accounted for in the Prelude class <code>RealFloat</code>. For this answer, I will demonstrate how the results in the question arise from the IEEE-754 basic 64-bit binary floating-point format and arithmetic.</p>\n\n<p>The question states:</p>\n\n<blockquote>\n  <p>These told me Haskell uses a total of 17 digits (or 18 characters including the dot?), whether or not they're significant. </p>\n</blockquote>\n\n<p>This is incorrect. As assumed in this answer, and is likely the case in OP\u2019s Haskell implementation, the number has 53 binary digits, not 17 decimal digits. 17 digits may be displayed, but this is the result of conversion of the number for display, not an exact representation of the actual value used for computing.</p>\n\n<p>The first three cases shown are unremarkable, but, for illustration, we show the internal values:</p>\n\n<pre><code>\u03bb&gt; 1/3\n0.3333333333333333 -- 0.333333333333333314829616256247390992939472198486328125\n\u03bb&gt; 4/3\n1.3333333333333333 -- 1.3333333333333332593184650249895639717578887939453125\n\u03bb&gt; 3424/3\n1141.3333333333333 -- 1141.333333333333257542108185589313507080078125\n</code></pre>\n\n<p>Now we will look at the surprising cases, starting with:</p>\n\n<pre><code>\u03bb&gt; 14/3\n4.666666666666667\n</code></pre>\n\n<p>What is surprising here is that it is shown with 16 decimal digits, whereas the previous results were shown with 17. Why?</p>\n\n<p>I do not see rules in the Haskell specification about how floating-point numbers should be formatted when displayed or otherwise converted to decimal. One rule that would explain this is one adopted by Java and some other software: Produce just enough decimal digits that convert the decimal numeral back to the floating-point format produces the original number. That is, just enough digits are produced to uniquely identify the internal value. (Other not uncommon rules are to convert to a fixed number of digits, or to convert to a fixed number of digits and then remove trailing zeroes. Both the just-enough rule and the remoe-trailing-zeroes rule would produce the results shown in the question. I will demonstrate the just-enough rule in this answer.)</p>\n\n<p>The value produced by <code>14/3</code> is exactly \n4.66666666666666696272613990004174411296844482421875. Together with the next lower and next greater representable values, we have (with a space inserted after the 16<sup>th</sup> digit, to assist visualization):</p>\n\n<pre><code>4.666666666666666 0745477201999165117740631103515625\n4.666666666666666 96272613990004174411296844482421875\n4.666666666666667 850904559600166976451873779296875\n</code></pre>\n\n<p>If we were converting 4.666666666666667 to floating-point, which of the above values should be the result? The middle one is closer; it is only about .04 away (in units of the lowest digit), whereas the others are .93 and .15 away. Thus the 16 digits \u201c4.666666666666667\u201d are sufficient to uniquely identify 4.66666666666666696272613990004174411296844482421875.</p>\n\n<p>In contrast, consider 4/3, which is 1.3333333333333332593184650249895639717578887939453125. It and its two neighbors are:</p>\n\n<pre><code>1.333333333333333 03727386009995825588703155517578125\n1.333333333333333 2593184650249895639717578887939453125\n1.333333333333333 481363069950020872056484222412109375\n</code></pre>\n\n<p>Again, the space is after the 16<sup>th</sup> digit. If we were converting the 16-digit 1.333333333333333 to floating-point, which of these should be the result? Now the first one is closer; it is only .04 units away. So \u201c1.333333333333333\u201d fails to represent the correct internal value. We need the 17-digit \u201c1.3333333333333333\u201d in order to uniquely identify the desired value.</p>\n\n<p>The next case is:</p>\n\n<pre><code>\u03bb&gt; 34/3\n11.333333333333334\n</code></pre>\n\n<p>The question asks why this is \u201cerroneously rounded.\u201d It is not. The internal value is 11.3333333333333339254522798000834882259368896484375. This number and its two neighboring representable values are:</p>\n\n<pre><code>11.333333333333332149095440399833023548126220703125\n11.3333333333333339254522798000834882259368896484375\n11.33333333333333570180911920033395290374755859375\n</code></pre>\n\n<p>The middle one is the closest to 11\u2153, so it is the correct result of <code>34/3</code>. And \u201c11.333333333333334\u201d is a correct conversion of 11.3333333333333339254522798000834882259368896484375 to a 17-digit decimal numeral.</p>\n\n<p>Similarly, in:</p>\n\n<pre><code>\u03bb&gt; 44/3\n14.666666666666666\n</code></pre>\n\n<p>the candidate results are:</p>\n\n<pre><code>14.666666666666664 29819088079966604709625244140625\n14.666666666666666 0745477201999165117740631103515625\n14.666666666666667 850904559600166976451873779296875\n</code></pre>\n\n<p>The middle of these is closer to 14\u2154, as it is about .59 units away (using units at the position I marked with a space), whereas the last one is 1.18 units away. So the correct internal result is 14.6666666666666660745477201999165117740631103515625, and the result of converting that to 17 decimal digits is 14.666666666666666.</p>\n"}], "owner": {"reputation": 243, "user_id": 3101837, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/be519e779b6eb7672b6bd1a02a966b71?s=128&d=identicon&r=PG", "display_name": "Jeffrey Lebowski", "link": "https://stackoverflow.com/users/3101837/jeffrey-lebowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 52795975, "answer_count": 1, "score": 0, "last_activity_date": 1539503210, "creation_date": 1539445744, "last_edit_date": 1539448326, "question_id": 52794697, "link": "https://stackoverflow.com/questions/52794697/doubts-over-ghci-simple-arithmetics", "title": "Doubts over ghci simple arithmetics", "body": "<p>I'm starting to learn Haskell using <a href=\"http://learnyouahaskell.com/starting-out\" rel=\"nofollow noreferrer\">Miran Lipovaca's famous book</a>, but my curiosity stopped me at the first interactions with the Glasgow Haskell Compiler's interactive shell (ghci).</p>\n\n<p>In particular, I started playing by dividing two integers to get floating point decimal numbers, basically to see how Haskell manages them automatically and to know more about its automatic casting.</p>\n\n<pre><code>\u03bb&gt; 1/3\n0.3333333333333333\n\u03bb&gt; 4/3\n1.3333333333333333\n\u03bb&gt; 3424/3\n1141.3333333333333\n</code></pre>\n\n<p>These told me Haskell uses a total of 17 digits (or 18 characters including the dot?), whether or not they're significant. However, these ones occured as well</p>\n\n<pre><code>\u03bb&gt; 14/3\n4.666666666666667\n\u03bb&gt; 34/3\n11.333333333333334\n\u03bb&gt; 44/3\n14.666666666666666\n</code></pre>\n\n<p>Why is the first shorter by one digit? Why are the others erroneously rounded?</p>\n\n<p>Probably it's a stupid question, but I feel like knowing the answer to such basic things I can start with a deeper understanding on how the language (or the interpreter?) works by knowing a little more of what's under the hood.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 3258, "user_id": 7661005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0c49d2077073823b91fa1ccc82fa0d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Maxxx", "link": "https://stackoverflow.com/users/7661005/maxxx"}, "edited": false, "score": 0, "creation_date": 1539444929, "post_id": 52794457, "comment_id": 92509194, "body": "hmmm didn&#39;t know i was overcomplicating it. But instead of returning a boolean of whether True or False, if i were to return the card in hand that has the same suit as the trump does it still hold? I&#39;ll update the post for this."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 3258, "user_id": 7661005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0c49d2077073823b91fa1ccc82fa0d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Maxxx", "link": "https://stackoverflow.com/users/7661005/maxxx"}, "edited": false, "score": 0, "creation_date": 1539445111, "post_id": 52794457, "comment_id": 92509258, "body": "well no, the above returns a Boolean - which is what your question implied you were after. You&#39;d have to modify it to return the actual card(s). (Using <code>filter</code> seems the most obvious way, assuming you want to return all trump cards in the hand.)"}, {"owner": {"reputation": 3258, "user_id": 7661005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0c49d2077073823b91fa1ccc82fa0d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Maxxx", "link": "https://stackoverflow.com/users/7661005/maxxx"}, "edited": false, "score": 0, "creation_date": 1539445492, "post_id": 52794457, "comment_id": 92509372, "body": "perfect! I&#39;d prefer using filter to retrieve the card with same suit as trump instead of the simpler method of returning True or False. My idea of using filter is updated in the post. Would appreciate if you could look at it and give me some feedback on how i can achieve it since I just started functional programming"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 3258, "user_id": 7661005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0c49d2077073823b91fa1ccc82fa0d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Maxxx", "link": "https://stackoverflow.com/users/7661005/maxxx"}, "edited": false, "score": 0, "creation_date": 1539445952, "post_id": 52794457, "comment_id": 92509526, "body": "I have edited my answer above to deal with your second question. (PS I am also relatively new to functional programming and Haskell.)"}], "tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": true, "score": 2, "last_activity_date": 1539460469, "last_edit_date": 1539460469, "creation_date": 1539444157, "answer_id": 52794457, "question_id": 52794409, "link": "https://stackoverflow.com/questions/52794409/utilizing-map-in-haskell-on-function-arguments/52794457#52794457", "title": "Utilizing map in haskell on function arguments", "body": "<p>I think you're overcomplicating this:</p>\n\n<pre><code>checkTrump trump myhand = (retrieveSuit trump) `elem` (map retrieveSuit myhand)\n</code></pre>\n\n<p>(PS it would make more sense to me for the function to take just the suit, instead of the full card, for the <code>trump</code> argument. But the above should work for the function you are trying to make.)</p>\n\n<p>For the second scenario, your function signature doesn't really make much sense because you have no guarantee that only one trump exists in the hand. There could be more than one - and there could also be none! So it makes most sense to me to change it to return a list, and just use the <code>filter</code> function (I also changed the name to avoid confusion, and to make it fit better with what the function does):</p>\n\n<pre><code>getTrumpsInHand :: Card -&gt; [Card] -&gt; [Card]\ngetTrumpsInHand trump hand = filter checkSuit hand\n                                where checkSuit card = retrieveSuit card == retrieveSuit trump\n</code></pre>\n"}], "owner": {"reputation": 3258, "user_id": 7661005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0c49d2077073823b91fa1ccc82fa0d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Maxxx", "link": "https://stackoverflow.com/users/7661005/maxxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 52794457, "answer_count": 1, "score": 1, "last_activity_date": 1539460469, "creation_date": 1539443895, "last_edit_date": 1539445096, "question_id": 52794409, "link": "https://stackoverflow.com/questions/52794409/utilizing-map-in-haskell-on-function-arguments", "title": "Utilizing map in haskell on function arguments", "body": "<p>I have created two objects in Haskell, mainly a trump card and the cards in hand.</p>\n\n<pre><code>trump = Card Spade Two\nmyhand = [Card Diamond Three, Card Spade Two]\n</code></pre>\n\n<p>where card is denoted by:</p>\n\n<pre><code>data Card = Card Suit Rank\n</code></pre>\n\n<p>I have written a function called retrieveSuit which retrieves the suit of the cards which are spades, diamonds,hearts etc..</p>\n\n<pre><code>retrieveSuit :: Card -&gt; Suit\nretrieveSuit (Card suit _) = suit\n</code></pre>\n\n<p>The problem I'm having is that I'm trying to write a function that <strong>compares both the suits of the trump and hand cards</strong> and see <strong>if the hand cards contain the suit of the trump card</strong> but I'm having issue mapping across both arguments of trump and myhand as I only know how to map one argument but not both.</p>\n\n<pre><code>checkTrump :: Card -&gt; [Card] -&gt; Bool\ncheckTrump trump myhand = (map retrieveSuit myhand) (retrieveSuit trump) if trump == myhand then True else False\n</code></pre>\n\n<p>when i run, i get the error </p>\n\n<pre><code>error: parse error on input `if'\n</code></pre>\n\n<p>Am i applying the function retrieveSuit correctly to both arguments of checkTrump? In this case, the program would <strong>output True</strong> since the cards in hand does contain a Spade which is the suit of the trump card as well.</p>\n\n<p>Edit:\nUpdate for second scenario. Instead of returning true or false, if i were to return the card in hand that has the same suit as trump: </p>\n\n<pre><code>checkTrump :: Card -&gt; [Card] -&gt; Card\ncheckTrump trump myhand = filter ((cardSuit trump) `elem` (map cardSuit myhand))\n</code></pre>\n"}, {"tags": ["function", "haskell", "input"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1539442138, "post_id": 52794110, "comment_id": 92508393, "body": "The above produces an error, <code>tryout</code> here takes <i>one</i> parameter. A function of type <code>a -&gt; b</code>."}, {"owner": {"reputation": 1, "user_id": 10499611, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ouSirHjRHrc/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVLDE7zUOkBv8e4UgIl17KpYJVKEg/mo/photo.jpg?sz=128", "display_name": "Elzine Burger", "link": "https://stackoverflow.com/users/10499611/elzine-burger"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1539442323, "post_id": 52794110, "comment_id": 92508456, "body": "You are right, it doesn&#39;t. But I still don&#39;t get what a -&gt; b means. What is a function of a type a -&gt; b? could you explain it to me real simple, because I feel like I am not grasping any concept of this."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1539442643, "post_id": 52794110, "comment_id": 92508542, "body": "By type signature, <code>tryout</code> takes only one function parameter with type (<code>a -&gt; b</code>) and returns an <code>Int</code> type value. Such as <code>tryout f = const 4 f</code> or (<code>tryout = const 4</code> as a shorthand). It might as well use <code>f</code> to eventually produce an integer value instead of discarding it."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1539450570, "post_id": 52794110, "comment_id": 92510816, "body": "<code>a -&gt; b</code> is the type of <i>any</i> function, because neither the input type nor the return type is restricted, and the two don&#39;t have to be the same."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1539450908, "creation_date": 1539450908, "answer_id": 52795389, "question_id": 52794110, "link": "https://stackoverflow.com/questions/52794110/haskell-higher-order-functions-and-what-input-belongs-here/52795389#52795389", "title": "Haskell, higher order functions and what input belongs here?", "body": "<p><code>tryout</code> takes <em>any</em> function as its argument, and returns an integer. Because you don't have any value to call the function on, <code>tryout</code> can't do anything but ignore it, and return some integer. (There is one total implementation of <code>tryout</code> for each value of type <code>Int</code>.)</p>\n\n<pre><code>tryout :: (a -&gt; b) -&gt; Int\ntryout _ = 4\n-- tryout (+) == 4; (+) :: Num x =&gt; x -&gt; x -&gt; x, where a ~ x and b ~ x -&gt; x\n-- tryout return == 4; return :: Monad m =&gt; x -&gt; m x, where a ~ x and b ~ m a\n-- tryout length == 4; length :: Foldable t =&gt; t x -&gt; Int, where a ~ t x and b ~ Int\n-- etc\n</code></pre>\n\n<p>If <code>tryout</code> <em>also</em> took an additional argument to type <code>a</code>, you could at least apply the function to get a value of type <code>b</code>, but you still couldn't do anything with it, since <code>tryout</code> has to return an <code>Int</code>. </p>\n\n<pre><code>tryout :: (a -&gt; b) -&gt; a -&gt; Int\ntryout _ _ = 4\n\n-- tryout length \"foo\" == 4; a ~ String, b ~ Int\n</code></pre>\n\n<p>Now, imagine that in addition to the function of type <code>a -&gt; b</code>, the value of type <code>a</code>, you <em>also</em> had an argument of type <code>b -&gt; Int</code>. <em>Now</em> we can finally do something non-trivial (though still simple).</p>\n\n<pre><code>tryout :: (a -&gt; b) -&gt; a -&gt; (b -&gt; Int) -&gt; Int\ntryout f x g = g (f x)\n</code></pre>\n\n<p>We apply <code>f</code> to <code>x</code> to get a value of type <code>b</code>, then pass that to <code>g</code> in order to get an <code>Int</code> we can return. It's not the <em>only</em> definition that type-checks; we can\nstill ignore <code>f</code>, <code>x</code>, and <code>g</code> and return a fixed <code>Int</code> as with the previous examples.</p>\n"}], "owner": {"reputation": 1, "user_id": 10499611, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ouSirHjRHrc/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVLDE7zUOkBv8e4UgIl17KpYJVKEg/mo/photo.jpg?sz=128", "display_name": "Elzine Burger", "link": "https://stackoverflow.com/users/10499611/elzine-burger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1539450908, "creation_date": 1539441941, "question_id": 52794110, "link": "https://stackoverflow.com/questions/52794110/haskell-higher-order-functions-and-what-input-belongs-here", "title": "Haskell, higher order functions and what input belongs here?", "body": "<p>because I don't understand higher order functions in haskell, I tried this</p>\n\n<pre><code>tryout :: (a -&gt;b) -&gt; Int\ntryout p q = 4\n</code></pre>\n\n<p>and I could also do\n     tryout p = 4\nwhy is it possible to do p as well as p q ? </p>\n\n<pre><code>tryout :: (a -&gt;b) -&gt; Int\ntryout p q = 4\n</code></pre>\n\n<p>and when I was playing around trying to get it, I called tryout with 3 4, 3->4 and with 3 and it all didn't work. \nCould someone explain to me what I'm doing here, why p as well as p q can be written (that is probably because p = a->b and p en q is a and b) and could I get an example of what I could do to call tryout? </p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 19532, "user_id": 570689, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4eed5285039322bafbeee9102367b0a4?s=128&d=identicon&r=PG", "display_name": "\u0414\u041c\u0418\u0422\u0420\u0418\u0419 \u041c\u0410\u041b\u0418\u041a\u041e\u0412", "link": "https://stackoverflow.com/users/570689/%d0%94%d0%9c%d0%98%d0%a2%d0%a0%d0%98%d0%99-%d0%9c%d0%90%d0%9b%d0%98%d0%9a%d0%9e%d0%92"}, "is_accepted": true, "score": 1, "last_activity_date": 1539440104, "last_edit_date": 1539440104, "creation_date": 1539439650, "answer_id": 52793772, "question_id": 52793723, "link": "https://stackoverflow.com/questions/52793723/problem-with-creating-a-list-of-string-after-a-transform-in-haskell/52793772#52793772", "title": "Problem with creating a list of string after a transform in Haskell", "body": "<blockquote>\n  <p>If I get a list of string like [\"Dog\", \"red\", \"caR\", \"HELLO\"] and I want to convert the lower case into upper case and vice versa using fold instruction, how can I return a list of string?</p>\n</blockquote>\n\n<p>If for given list of strings you want to have a list of strings as well, the type of such a function will be <code>convertWords :: [String] -&gt; [String]</code>.</p>\n\n<p>For every <code>String</code> inside a list you need to apply another function that will swap the case <code>convertWord :: String -&gt; String</code>. Thus, <code>convertWords = map convertWord</code>.</p>\n\n<p>Given that switching the case is applicable only for <code>Char</code>, and <code>String = [Char]</code>, we also need to have <code>convertChar :: Char -&gt; Char</code> function, so <code>convertWord = map convertChar</code>.</p>\n\n<p>Definition for <code>convertChar</code> might look like that:</p>\n\n<pre><code>convertChar :: Char -&gt; Char\nconvertChar c | isUpper c = toLower c\n              | otherwise = toUpper c\n</code></pre>\n\n<p>And finally,</p>\n\n<pre><code>convertWord :: String -&gt; String\nconvertWord = map convertChar\n\nconvertWords :: [String] -&gt; [String]\nconvertWords = map convertWord\n</code></pre>\n\n<p>We have the correct result:</p>\n\n<pre><code>&gt;&gt; convertWords [\"Dog\", \"red\", \"caR\", \"HELLO\"]\n[\"dOG\",\"RED\",\"CAr\",\"hello\"]\nit :: [String]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 619, "user_id": 8514005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/318a3ae487b2140f9d08079450b6903d?s=128&d=identicon&r=PG&f=1", "display_name": "JohEker", "link": "https://stackoverflow.com/users/8514005/joheker"}, "is_accepted": false, "score": 1, "last_activity_date": 1539447253, "creation_date": 1539447253, "answer_id": 52794881, "question_id": 52793723, "link": "https://stackoverflow.com/questions/52793723/problem-with-creating-a-list-of-string-after-a-transform-in-haskell/52794881#52794881", "title": "Problem with creating a list of string after a transform in Haskell", "body": "<p>Using <code>if then else</code> for the binary condition of <code>being upper or not being upper</code> together with a <code>map</code> could look like this: </p>\n\n<pre><code>converter i = map (map(\\x -&gt; if isUpper x then toLower x else toUpper x)) i\n</code></pre>\n\n<p>If you would like to use foldl we need to look at the signature for foldl : </p>\n\n<p><code>foldl :: Foldable t =&gt; (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b</code></p>\n\n<p>So we could create a function to take a list of String, a String and return a manipulated version of that String inside the list. </p>\n\n<p><code>folder :: [String] -&gt; String -&gt; [String]</code></p>\n\n<p>To stay with the <code>if then else</code> to easier see the difference would look something like this: </p>\n\n<pre><code>folder :: [String] -&gt; String -&gt; [String]\nfolder xs  \"\" = []\nfolder xs s   = xs ++ [sb s]\n\n where sb \"\"     = \"\"\n       sb (c:cc) = if isUpper c then toLower c : sb cc else toUpper c : sb cc\n</code></pre>\n\n<p>This could of course and preferable be changed to match on guards instead, i leave that up you to.</p>\n\n<p>With this function <code>folder</code> we could now use <code>foldl</code> because the signatures match. Giving <code>foldl</code> our <code>folder</code> and an empty list and the input list as arguments will solve the problem: </p>\n\n<p><code>converter' xs = foldl folder [] xs</code> </p>\n"}], "owner": {"reputation": 123, "user_id": 10321338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/20Pz7.jpg?s=128&g=1", "display_name": "OnlyDavies", "link": "https://stackoverflow.com/users/10321338/onlydavies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 52793772, "answer_count": 2, "score": 1, "last_activity_date": 1539447253, "creation_date": 1539439328, "question_id": 52793723, "link": "https://stackoverflow.com/questions/52793723/problem-with-creating-a-list-of-string-after-a-transform-in-haskell", "title": "Problem with creating a list of string after a transform in Haskell", "body": "<p>If I get a list of string like [\"Dog\", \"red\", \"caR\", \"HELLO\"] and I want to convert the lower case into upper case and vice versa using fold instruction, how can I return a list of string?</p>\n\n<p>The return should be like [\"dOG\", \"RED\", \"CAr\", \"hello\"]</p>\n\n<p>I have this code</p>\n\n<pre><code>convertWords :: [String] -&gt; String\nconvertWords words= foldl(\\ r it -&gt;r++foldl(\\ rr iitt -&gt;if isUpper iitt then rr++[toLower iitt] else rr++[toUpper iitt]) [] it) [] words\n</code></pre>\n\n<p>The problem is that it returns a good conversion, but in one list like:</p>\n\n<p>\"dOGREDCArhello\"</p>\n\n<p>Thank you</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 8, "creation_date": 1539433495, "post_id": 52792660, "comment_id": 92506248, "body": "I guess you did not install the <code>split</code> package with stack or cabal."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1539459780, "post_id": 52792660, "comment_id": 92513223, "body": "How are you trying to compile or interpret this code? Do you have a <code>.cabal</code> or <code>stack.yaml</code> file? What does the file look like?"}], "owner": {"reputation": 145, "user_id": 10448841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ee631428bfbd476b1ab1c60d534e084?s=128&d=identicon&r=PG&f=1", "display_name": "Maqruis1", "link": "https://stackoverflow.com/users/10448841/maqruis1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1068, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1539431741, "creation_date": 1539431741, "question_id": 52792660, "link": "https://stackoverflow.com/questions/52792660/haskell-could-not-find-module-data-list-split", "title": "Haskell: Could not find module \u2018Data.List.Split\u2019", "body": "<p>I'm trying to split a list in Haskell and I want to import Data.List.Split. \nHowever I'm presented with this error:  </p>\n\n<pre><code>a.hs:2:1: error:\n    Could not find module \u2018Data.List.Split\u2019\n    Use -v to see a list of the files searched for.\n  |\n2 | import Data.List.Split\n  | ^^^^^^^^^^^^^^^^^^^^^^\nFailed, no modules loaded.\n</code></pre>\n\n<p>This is my code:  </p>\n\n<pre><code>module PoemLines where\nimport Data.List.Split\n\nfirstSen = \"Tyger Tyger, burning bright\\n\"\nsecondSen = \"In the forests of the night\\n\"\nthirdSen = \"What immortal hand or eye\\n\"\nfourthSen = \"Could frame thy fearful symmetry?\"\nsentences = firstSen ++ secondSen ++ thirdSen ++ fourthSen\n\nmyLines :: String -&gt; [String]\nmyLines x = undefined\nshouldEqual =\n [ \"Tyger Tyger, burning bright\"\n , \"In the forests of the night\"\n , \"What immortal hand or eye\"\n , \"Could frame thy fearful symmetry?\"\n ]\n\nmain :: IO ()\nmain =\n print $ \"Are they equal? \"\n         ++ show (myLines sentences == shouldEqual)\n</code></pre>\n\n<p>How do I fix this? Thank you.</p>\n"}, {"tags": ["haskell", "set"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1539430142, "post_id": 52792411, "comment_id": 92505351, "body": "Probably it should be <code>foldl&#39; (flip insert)</code>"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1539430778, "post_id": 52792411, "comment_id": 92505526, "body": "Why don&#39;t you just use <code>fromList</code> function from <code>Data.Set</code> module?"}, {"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1539431258, "post_id": 52792411, "comment_id": 92505641, "body": "@Redu As an exercise"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1539430674, "creation_date": 1539430674, "answer_id": 52792513, "question_id": 52792411, "link": "https://stackoverflow.com/questions/52792411/folding-a-list-of-elements-into-a-set-of-elements/52792513#52792513", "title": "Folding a list of elements into a set of elements", "body": "<p>You are accidentally referring to <code>Data.Set.foldl'</code> instead of <code>Data.List.foldl'</code>. You need to import both modules and then disambiguate:</p>\n\n<pre><code>listToSet :: [Int] -&gt; Set Int\nlistToSet d = Data.List.foldl' (flip Data.Set.insert) empty d\n</code></pre>\n\n<p>Even better, use qualifed imports:</p>\n\n<pre><code>import qualified Data.Set as S\nimport Data.List\n\nlistToSet :: [Int] -&gt; S.Set Int\nlistToSet d = foldl' (flip S.insert) S.empty d\n</code></pre>\n\n<p>Or even better, directly use <code>S.fromList</code>: it's already present in the library, so there's no point in reinventing the wheel (unless as an exercise).</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 1, "last_activity_date": 1539430680, "creation_date": 1539430680, "answer_id": 52792515, "question_id": 52792411, "link": "https://stackoverflow.com/questions/52792411/folding-a-list-of-elements-into-a-set-of-elements/52792515#52792515", "title": "Folding a list of elements into a set of elements", "body": "<p><a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:foldl-39-\" rel=\"nofollow noreferrer\"><strong><code>foldl' :: Foldable t =&gt; (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b</code></strong></a> has as first parameter a function of type <code>b -&gt; a -&gt; b</code>, you thus should provide first the <code>Set</code> to update, then the element to insert, and it then generates a new <code>Set</code>.</p>\n\n<p>The <a href=\"http://hackage.haskell.org/package/containers-0.6.0.1/docs/Data-Set.html#v:insert\" rel=\"nofollow noreferrer\"><strong><code>insert :: Ord a =&gt; a -&gt; Set a -&gt; Set a</code></strong></a> however takes the parameters in the <em>opposite</em> way: it first takes the element to insert, and then <code>Set</code> to update.</p>\n\n<p>You thus can use <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:flip\" rel=\"nofollow noreferrer\"><strong><code>flip :: (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c</code></strong></a> to \"flip the parameters\", and thus construct a function that has parameters in the order the <code>foldl'</code> can process, so we can define the function like:</p>\n\n<pre><code>import Data.Set(empty, insert)\nimport Data.List(foldl')\n\nlistToSet :: (Foldable f, Ord e) =&gt; f e -&gt; Set e\nlistToSet = foldl' (flip insert) empty</code></pre>\n\n<p>Note that what you here aim to define already exists: the <code>Data.Set</code> module has a <a href=\"http://hackage.haskell.org/package/containers-0.6.0.1/docs/Data-Set.html#v:fromList\" rel=\"nofollow noreferrer\"><strong><code>fromList :: Ord a =&gt; [a] -&gt; Set a</code></strong></a> function to generate a <code>Set a</code> out of an <code>[a]</code>.</p>\n"}], "owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 0, "accepted_answer_id": 52792515, "answer_count": 2, "score": 2, "last_activity_date": 1539430680, "creation_date": 1539429986, "question_id": 52792411, "link": "https://stackoverflow.com/questions/52792411/folding-a-list-of-elements-into-a-set-of-elements", "title": "Folding a list of elements into a set of elements", "body": "<p>I want to fold a list into a set, but my implementation seems to require that the list is already a set. <code>Element</code> has an <code>Ord</code> instance. Imports are correct.</p>\n\n<pre><code>listToSet :: [Element] -&gt; Set Element\nlistToSet d = foldl' insert empty d\n</code></pre>\n\n<p><code>d</code> should already be a set here, so this of course gives a type error, can I use <code>foldl'</code> to create a set from a list? Do I first need to \"cast\" the list of <code>Element</code>s to a list of sets of length one with each one of the <code>Element</code>s?</p>\n\n<p>Error:</p>\n\n<pre><code>Assignment3.hs:201:39: error:\n    * Couldn't match type `Element' with `Set Element'\n      Expected type: [Set Element]\n        Actual type: [Element]\n    * In the third argument of foldl', namely `d'\n      In the expression: foldl' insert empty d\n      In an equation for `listToSet':\n          listToSet d = foldl' insert empty d\n    |\n201 | listToSet d = foldl' insert empty d\n    |     \n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3281, "user_id": 3574379, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/B85yX.png?s=128&g=1", "display_name": "srghma", "link": "https://stackoverflow.com/users/3574379/srghma"}, "edited": false, "score": 0, "creation_date": 1539427287, "post_id": 52791746, "comment_id": 92504681, "body": "@M.Aroosi (I see you deleted your comment) very bad that <code>type synonyms cannot be partially applied</code>, code looks ugly when I have to wrap my object in datatype constructors <code>Compose</code> and <code>Apply</code> each time (posted an answer). Is there a way to implement compositions of functors without <code>data</code> or <code>newtype</code>?"}, {"owner": {"reputation": 3281, "user_id": 3574379, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/B85yX.png?s=128&g=1", "display_name": "srghma", "link": "https://stackoverflow.com/users/3574379/srghma"}, "edited": false, "score": 0, "creation_date": 1539427871, "post_id": 52791746, "comment_id": 92504800, "body": "Is there a way to implement compositions of functors without need to wrap in data constructor <code>Composition</code> or <code>Apply</code> all the time? Is this possible to make this with type synonyms in idris for example?"}, {"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 0, "creation_date": 1539437493, "post_id": 52791746, "comment_id": 92507276, "body": "There is sort of a solution with type families and whatnot, but it involves using type signatures like <code>Eval ([] \u25cb Maybe \u25cb Lift Maybe \u21af Int)</code>, or if you prefer to introduce another operator for the last(well, first since it associates to the right) composition: <code>Eval ([] \u25cb Maybe % Maybe \u21af Int)</code> If this fits with what you want, tell me and I&#39;ll post it as an answer."}, {"owner": {"reputation": 3281, "user_id": 3574379, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/B85yX.png?s=128&g=1", "display_name": "srghma", "link": "https://stackoverflow.com/users/3574379/srghma"}, "reply_to_user": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 0, "creation_date": 1539438371, "post_id": 52791746, "comment_id": 92507521, "body": "@M. Aroosi yes, please, post an answer :)"}], "answers": [{"comments": [{"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 0, "creation_date": 1539442281, "post_id": 52793962, "comment_id": 92508443, "body": "One thing I&#39;d like to add, is that the <code>Fcf</code> package defines most of those things already, You&#39;d only need to add a few of the things in the answer: the composition operator, the application operator if you want that unicode lightning (there&#39;s already one in <code>Fcf</code>, they just use <code>($)</code> for it), the <code>%</code> operator if you want it. In <code>Fcf</code> they called what I named <code>Lift</code> as <code>Pure1</code>, you could also use the fish operator <code>&lt;=&lt;</code> instead of defining your own composition, but then you&#39;d need to stick <code>Pure1</code> on everything."}, {"owner": {"reputation": 3281, "user_id": 3574379, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/B85yX.png?s=128&g=1", "display_name": "srghma", "link": "https://stackoverflow.com/users/3574379/srghma"}, "edited": false, "score": 0, "creation_date": 1539443592, "post_id": 52793962, "comment_id": 92508799, "body": "unexpected answer for common problem, tnx"}], "tags": [], "owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "is_accepted": true, "score": 4, "last_activity_date": 1539441656, "last_edit_date": 1539441656, "creation_date": 1539440937, "answer_id": 52793962, "question_id": 52791746, "link": "https://stackoverflow.com/questions/52791746/how-to-make-dot-composition-and-dollar-application-sign-for-functors/52793962#52793962", "title": "How to make dot (composition) and dollar (application) sign for functors?", "body": "<p>So as per your request, here's the solution involving type families. It is based around the idea behind the <a href=\"https://hackage.haskell.org/package/first-class-families-0.3.0.1/docs/Fcf.html\" rel=\"nofollow noreferrer\"><code>Fcf</code></a> package with an article explaining that idea <a href=\"http://blog.poisson.chat/posts/2018-08-06-one-type-family.html\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>Before I begin there's something in favor of using a normal data type/newtype: You can define functor instances for the composition type so it acts as a single unit, that is you can define <code>instance (Functor f, Functor g) =&gt; Functor (Compose f g) where ..</code> which you can't do with the approach below.<br>\nThere might be a library that allows you to do that with a list of types instead of just 2 (so something like <code>Compose [Maybe, [], Either Int] a</code>), but I can't seem to find it right now, so if anyone knows it it's probably a better solution than the one I present below (in my opinion).</p>\n\n<p>First we need some language extensions:  </p>\n\n<pre><code>{-# LANGUAGE \n  TypeFamilies,\n  TypeInType,\n  TypeOperators\n  #-}\n</code></pre>\n\n<p>Let's also include <code>Data.Kind</code> for <code>Type</code></p>\n\n<pre><code>import Data.Kind (Type)\n</code></pre>\n\n<p>Let's define a type <code>Exp a</code> which will represent <code>a</code>.<br>\nWe'll also define a type family <code>Eval</code> which will let do the grunt work, it will take an <code>Exp a</code> and give us an <code>a</code>  </p>\n\n<pre><code>type Exp a = a -&gt; Type\ntype family Eval (e :: Exp a) :: a\n</code></pre>\n\n<p>We can now define our operators <code>(\u25cb)</code> and <code>(\u21af)</code> (I'd prefer to use easier to type operators here, say # and $ instead, but I'll stick with the ones you picked for this answer).<br>\nWe define these as empty data types. This is where <code>TypeInType</code> comes in (and <code>TypeOperators</code> but that's because we are using operators).  </p>\n\n<pre><code>infixr 9 \u25cb\ndata (\u25cb) :: (b -&gt; c) -&gt; (a -&gt; Exp b) -&gt; a -&gt; Exp c\n\ninfixr 0 \u21af\ndata (\u21af) :: (a -&gt; Exp b) -&gt; a -&gt; Exp b\n</code></pre>\n\n<p>Notice how the final kind is <code>Exp a</code> for them? that allows us to give them type instances for <code>Eval</code>  </p>\n\n<pre><code>type instance Eval ((\u25cb) f g a) = f (Eval (g a))\ntype instance Eval ((\u21af) f a) = Eval (f a)\n</code></pre>\n\n<p>Now you may be wondering \"<code>(\u25cb)</code>'s second argument is of kind <code>a -&gt; Exp b</code>, but I want to give it something like <code>Maybe</code> which has kind <code>* -&gt; *</code>!\", this is where we have 3 solutions to that problem:  </p>\n\n<ol>\n<li>add another operator, say <code>(%)</code> which is just like <code>(\u25cb)</code> but takes a second argument of kind <code>a -&gt; b</code> instead of <code>a -&gt; Exp b</code>. This only needs to replace the right-most composition operator.  </li>\n<li>\"lift\" the kind <code>a -&gt; b</code> into <code>a -&gt; Exp b</code>, I'll use a data type named <code>Lift</code> for that. This only needs to be done to the rightmost type in the composition.  </li>\n<li>provide a \"do nothing\" data type of kind <code>a -&gt; Exp b</code>, I'll call that <code>Pure</code>.  </li>\n</ol>\n\n<p>Here are the three solutions written in Haskell:  </p>\n\n<pre><code>infixr 9 %\ndata (%) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; Exp c\ntype instance Eval ((%) f g a) = f (g a)\n\ndata Lift :: (a -&gt; b) -&gt; a -&gt; Exp b\ntype instance Eval (Lift f a) = f a\n\ndata Pure :: a -&gt; Exp a\ntype instance Eval (Pure a) = a \n</code></pre>\n\n<p>One more thing we can do with this setup is make a type-level function datatype we call \"Compose\" which will take a list of types and produce their composition  </p>\n\n<pre><code>data Compose :: [a -&gt; a] -&gt; a -&gt; Exp a \ntype instance Eval (Compose '[] a) = a\ntype instance Eval (Compose (x:xs) a) = x (Eval (Compose xs a))\n</code></pre>\n\n<p>Now we can make our program, with some tests and a <code>main</code> that just prints the values of the tests:  </p>\n\n<pre><code>{-# LANGUAGE \n  TypeFamilies,\n  TypeInType,\n  TypeOperators\n  #-}\n\nmodule Main where\n\nimport Data.Kind (Type)\n\ntype Exp a = a -&gt; Type\ntype family Eval (e :: Exp a) :: a\n\ninfixr 9 \u25cb\ndata (\u25cb) :: (b -&gt; c) -&gt; (a -&gt; Exp b) -&gt; a -&gt; Exp c\n\ninfixr 0 \u21af\ndata (\u21af) :: (a -&gt; Exp b) -&gt; a -&gt; Exp b\n\ntype instance Eval ((\u25cb) f g a) = f (Eval (g a))\ntype instance Eval ((\u21af) f a) = Eval (f a)\n\ninfixr 9 %\ndata (%) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; Exp c\ntype instance Eval ((%) f g a) = f (g a)\n\ndata Lift :: (a -&gt; b) -&gt; a -&gt; Exp b\ntype instance Eval (Lift f a) = f a\n\ndata Pure :: a -&gt; Exp a\ntype instance Eval (Pure a) = a \n\ndata Compose :: [a -&gt; a] -&gt; a -&gt; Exp a \ntype instance Eval (Compose '[] a) = a\ntype instance Eval (Compose (x:xs) a) = x (Eval (Compose xs a))\n\ntest :: [] (Maybe Int)\ntest = [Just 1]\n\n-- using %\ntest2 :: Eval (([] % Maybe) Int)\ntest2 = [Just 1]\n\ntest2' :: Eval ([] % Maybe \u21af Int)\ntest2' = [Just 1]\n\n-- works for longer types too\ntest3 :: Eval (([] \u25cb Maybe % Maybe) Int)\ntest3 = [Just (Just 1)]\n\ntest3' :: Eval ([] \u25cb Maybe % Maybe \u21af Int)\ntest3' = [Just (Just 1)]\n\n-- we can instead Lift the rightmost type\ntest4 :: Eval (([] \u25cb Maybe \u25cb Lift Maybe) Int)\ntest4 = [Just (Just 1)]\n\ntest4' :: Eval ([] \u25cb Maybe \u25cb Lift Maybe \u21af Int)\ntest4' = [Just (Just 1)]\n\n-- an even longer type, with definition \"matching\" the type declaration\ntest5 :: Eval ([] \u25cb Maybe \u25cb Either Bool % Maybe \u21af Int)\ntest5 = (:[]) . Just . Right . Just $ 1\n\n-- Same as above, but instead let's use Pure so we don't need to lift the Maybe or use %\ntest6 :: Eval ([] \u25cb Maybe \u25cb Either Bool \u25cb Maybe \u25cb Pure \u21af Int)\ntest6= (:[]) . Just . Right . Just $ 1\n\n-- same as above, uses Compose\ntest7 :: Eval (Compose [[], Maybe, Either Bool, Maybe] Int)\ntest7= (:[]) . Just . Right . Just $ 1\n\nmain :: IO ()\nmain = do\n  print test\n  print test2\n  print test2'\n  print test3\n  print test3'\n  print test4\n  print test4'\n  print test5\n  print test6\n  print test7\n  return ()\n</code></pre>\n"}], "owner": {"reputation": 3281, "user_id": 3574379, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/B85yX.png?s=128&g=1", "display_name": "srghma", "link": "https://stackoverflow.com/users/3574379/srghma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 1, "accepted_answer_id": 52793962, "answer_count": 1, "score": 5, "last_activity_date": 1554896478, "creation_date": 1539424706, "last_edit_date": 1554896478, "question_id": 52791746, "link": "https://stackoverflow.com/questions/52791746/how-to-make-dot-composition-and-dollar-application-sign-for-functors", "title": "How to make dot (composition) and dollar (application) sign for functors?", "body": "<p>I have made dot sign for functors (\u25cb), but my application (\u21af) doesnt work, I have an error in <code>test3</code> function declaration</p>\n\n<pre><code>{-# LANGUAGE TypeOperators #-}\n\nmodule Main where\n\nimport Protolude\n\n-- composition of functors, analog of .\ninfixr 9 \u25cb\ntype (\u25cb) f g a = f (g a)\n\n-- functor application, analog of $\ninfixr 0 \u21af\ntype (\u21af) f a = f a\n\ntest :: [] (Maybe Int)\ntest = [Just 1]\n\ntest2 :: ([] \u25cb Maybe) Int\ntest2 = [Just 1]\n\ntest3 :: ([] \u25cb Maybe) \u21af Int -- error here\ntest3 = [Just 1]\n\nmain :: IO ()\nmain = do\n  print test\n  print test2\n  return ()\n</code></pre>\n\n<p>I have an error</p>\n\n<pre><code>[Error]\u2022 The type synonym \u2018\u25cb\u2019 should have 3 arguments, but has been given 2 \u2022 In the type signature: test3 :: ([] \u25cb Maybe) \u21af Int\n</code></pre>\n\n<p>What's wrong?</p>\n\n<hr>\n\n<p>UPDATE</p>\n\n<p>Here is the implementation using newtype, because <code>type synonyms cannot be partially applied</code> (@M.Aroosi)</p>\n\n<p>I don't like it because I have to wrap data with datatype constructor all the time</p>\n\n<p><strong>Is there a way to implement it without need to wrap data with <code>Composition</code> or <code>Apply</code> all the time?</strong></p>\n\n<pre><code>{-# LANGUAGE TypeOperators #-}\n\nmodule Main where\n\nimport Protolude\n\n-- I can't use `type` here, because type synonyms cannot be partially applied\n\n-- composition of functors, analog of .\ninfixr 9 \u25cb\nnewtype (\u25cb) f g a = Composition (f (g a)) deriving (Show)\n\n-- functor application, analog of $\ninfixr 0 \u21af\nnewtype (\u21af) f a = Apply (f a) deriving (Show)\n\ntest :: [] (Maybe Int)\ntest = [Just 1]\n\ntest2 :: ([] \u25cb Maybe) Int\ntest2 = Composition [Just 1]\n\ntest2' :: [] \u25cb Maybe \u21af Int\ntest2' = Apply (Composition [Just 1])\n\ntest3 :: ([] \u25cb Maybe \u25cb Maybe) Int\ntest3 = Composition [Composition (Just (Just 1))]\n\ntest3' :: [] \u25cb Maybe \u25cb Maybe \u21af Int\ntest3' = Apply (Composition [Composition (Just (Just 1))])\n\nmain :: IO ()\nmain = do\n  print test\n  print test2\n  print test2'\n  print test3\n  print test3'\n  return ()\n</code></pre>\n\n<hr>\n\n<p>UPDATE</p>\n\n<p>This can be done trivially in idris</p>\n\n<pre><code>module Main\n\ntest : List (Maybe Integer)\ntest = [Just 1]\n\n-- using (.) from prelude\ntest1 : (List . Maybe) Integer\ntest1 = [Just 1]\n\n-- using (.) and ($) from prelude\ntest2 : List . Maybe $ Integer\ntest2 = [Just 1]\n\nmain : IO ()\nmain = do\n  print test\n  print test1\n  print test2\n</code></pre>\n\n<hr>\n\n<p>UPDATE</p>\n\n<p>composition with <code>type</code> also works in purescript (YAY!)</p>\n\n<pre><code>module Main where\n\nimport Prelude\nimport Data.Maybe (Maybe(..))\nimport Control.Monad.Eff (Eff)\nimport Control.Monad.Eff.Console (CONSOLE, logShow)\n\ntype Composition f g a = f (g a)\ninfixr 9 type Composition as \u25cb\n\ntype Apply f a = f a\ninfixr 0 type Apply as \u21af\n\ntest1 :: (Array \u25cb Maybe) Int\ntest1 = [Just 1]\n\ntest2 :: Array \u25cb Maybe \u21af Int\ntest2 = [Just 1]\n\ntest3 :: (Array \u25cb Maybe \u25cb Maybe) Int\ntest3 = [Just (Just 1)]\n\ntest4 :: Array \u25cb Maybe \u25cb Maybe \u21af Int\ntest4 = [Just (Just 1)]\n\nmain :: forall e. Eff (console :: CONSOLE | e) Unit\nmain = do\n  logShow test1\n  logShow test2\n  logShow test3\n  logShow test4\n</code></pre>\n\n<hr>\n\n<p>UPDATE</p>\n\n<p>there is an ongoing effort to make this possible in haskell </p>\n\n<p><a href=\"https://github.com/kcsongor/typelevel-prelude\" rel=\"nofollow noreferrer\">https://github.com/kcsongor/typelevel-prelude</a></p>\n"}, {"tags": ["function", "haskell", "figure", "chess"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1539423072, "creation_date": 1539423072, "answer_id": 52791516, "question_id": 52791168, "link": "https://stackoverflow.com/questions/52791168/haskell-function-for-si/52791516#52791516", "title": "haskell function for si", "body": "<p>Here's a few hints:</p>\n\n<ul>\n<li><p>Write a function to generate a table of <code>Pos</code> with all the coordinates, i.e. a <code>[[Pos]]</code> like this</p>\n\n<pre><code>generateTable (i,j) = [[(1,1),(1,2),...,(1,j)], ..., [(i,1),...,(i,j)]]\n</code></pre>\n\n<ul>\n<li>To solve this you might want to write an auxiliary function <code>generateRow x j = [(x,1),...,(x,j)]</code> first, and then use it to generate each row</li>\n<li>You can use recursion, or you might also use a (possibly nested) list comprehension. There are many options.</li>\n</ul></li>\n<li><p>Once you have your <code>table :: [[Pos]]</code> you can <code>map (map figure) table</code> to get the wanted <code>[[a]]</code>.</p>\n\n<ul>\n<li>Alternatively, you can use the <code>figure</code> function sooner, and avoid to generate the pairs in the first place.</li>\n</ul></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 9972747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78853b4c9f117716bb564f6286690798?s=128&d=identicon&r=PG&f=1", "display_name": "Jeanine de Jong", "link": "https://stackoverflow.com/users/9972747/jeanine-de-jong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1539453438, "creation_date": 1539420187, "last_edit_date": 1539453438, "question_id": 52791168, "link": "https://stackoverflow.com/questions/52791168/haskell-function-for-si", "title": "haskell function for si", "body": "<p>I am trying to write a function <code>render</code> by using <code>toPosition</code> with </p>\n\n<pre><code>render :: Dimensie -&gt; Figure a -&gt; [[a]] \n</code></pre>\n\n<p>But I can't figure out how. Could you propose a way to do this?</p>\n\n<pre><code>type Figure a = Pos -&gt; a\n\ntype Pos = (Double, Double) -- (x, y)\n\nchessboard :: Figure Bool\nchessboard (x, y) = even (round x) == even (round y)\n\ntype Dimensie = (Int, Int)\n\nrender :: Dimensie -&gt; Figure a -&gt; [[a]] \nrender  = undefined\n\ntoPosition :: Dimensie \u2192 (Int, Int) \u2192 Pos\ntoPosition d (x, y) = (fromIntegral x \u2217 2 / b \u2212 1, 1 \u2212 fromIntegral y \u2217 2 / h)\n        where\n           b = fromIntegral (fst d \u2212 1)\n           h = fromIntegral (snd d \u2212 1)\n</code></pre>\n\n<p>And when I call it with</p>\n\n<pre><code> Figure&gt; render (3,3) chessboard\n</code></pre>\n\n<p>it should give</p>\n\n<pre><code>[[True,False,True],[False,True,False],[True,False,True]]\n</code></pre>\n\n<p>And then I want to follow this up by writing a function that gives a certain character for a certain boolean value. It should display for example <code>@</code> for <code>True</code> and <code>.</code> for <code>False</code></p>\n\n<pre><code>boolChar :: Bool -&gt; Char\nboolChar = undefined\n</code></pre>\n\n<p>But how do I write this?\nI don't get how to get a <code>[[Bool]]</code> out of <code>[[a]]</code> at the <code>render</code> function, it keeps telling me that it <code>couldn't match expected type \u2018a\u2019 with actual type \u2018Bool\u2019</code> and that <code>\u2018a\u2019 is a rigid type variable bound by the type signature for:</code> and then it tells which line it went wrong.\nSo what do I write for <code>render d (x,y) c = ....</code> to get it to display the asked outcome?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1539416660, "post_id": 52788053, "comment_id": 92502201, "body": "Compared to C, haskell semantics is essentially completely predictable. The evaluation order, instead, is not predictable. This might seem a contradiction, but when evaluating <code>a + b</code> in Haskell it does not matter which one between <code>a,b</code> is evaluated first, since there are no side effects (unlike C), so the result will be the same. The Haskell report only mandates a predictable result, and does not mandate a specific evaluation order."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 10, "last_activity_date": 1539386679, "last_edit_date": 1539386679, "creation_date": 1539386270, "answer_id": 52788121, "question_id": 52788053, "link": "https://stackoverflow.com/questions/52788053/order-of-pattern-matching-evaluation-in-haskell/52788121#52788121", "title": "Order of pattern matching evaluation in Haskell", "body": "<p>It is defined in the language itself. <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-840004.4.3.1\" rel=\"noreferrer\">Subsection 4.4.3.1 of the Haskell Report 2010</a> specifies that the clauses in a function definition are equivalent to a case expression. Case expressions, in turn, have their alternatives matched in order. Quoting <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-460003.13\" rel=\"noreferrer\">section 3.13 of the Report</a>:</p>\n\n<blockquote>\n  <p>A case expression is evaluated by pattern matching the expression <em>e</em> against the individual alternatives. The alternatives are tried sequentially, from top to bottom.</p>\n</blockquote>\n"}], "owner": {"reputation": 333, "user_id": 7441934, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gKmnB.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7441934/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 485, "favorite_count": 0, "accepted_answer_id": 52788121, "answer_count": 1, "score": 1, "last_activity_date": 1563749468, "creation_date": 1539385742, "last_edit_date": 1563749468, "question_id": 52788053, "link": "https://stackoverflow.com/questions/52788053/order-of-pattern-matching-evaluation-in-haskell", "title": "Order of pattern matching evaluation in Haskell", "body": "<p>Take the two similar looking functions:</p>\n\n<pre><code>foo :: Eq a =&gt; [a] -&gt; Bool\nfoo [x,y] | x == y = True\nfoo _ = False\n\nbar :: Eq a =&gt; [a] -&gt; Bool\nbar _ = False\nbar [x,y] | x == y = True\n\nmain = do\nprint $ foo [1,1]\nprint $ bar [1,1]\n</code></pre>\n\n<p>When compiled with ghc, the result is predictably:</p>\n\n<p><code>True</code></p>\n\n<p><code>False</code></p>\n\n<p>Because it seems the order in which it evaluates different pattern groups goes from the top down. My question is whether this behavior is defined in the language itself or just by the compiler? For example, if I use a different compiler could I get the opposite result? I want to know if it's predictable or ambiguous like in C/C++</p>\n"}, {"tags": ["haskell", "cabal", "cabal-new"], "answers": [{"comments": [{"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1539418522, "post_id": 52790950, "comment_id": 92502580, "body": "Although there is a <a href=\"https://github.com/haskell/cabal/pull/5455\" rel=\"nofollow noreferrer\">pull request</a> that wants to fix this."}], "tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": true, "score": 2, "last_activity_date": 1539418472, "creation_date": 1539418472, "answer_id": 52790950, "question_id": 52787883, "link": "https://stackoverflow.com/questions/52787883/how-can-i-pass-test-options-with-cabal-new-test/52790950#52790950", "title": "How can I pass test-options with cabal new-test?", "body": "<p>No, it is not possible, presumably because <code>new-test</code> runs all test suites, so it is unclear which test to pass it to.</p>\n\n<p>But new versions of <code>cabal</code> tell you in the help for <code>new-test</code>:</p>\n\n<blockquote>\n  <p>To pass command-line arguments to a test suite, see the new-run command.</p>\n</blockquote>\n\n<p>so that is now the way to run a single test suite with options.</p>\n"}], "owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 1, "accepted_answer_id": 52790950, "answer_count": 1, "score": 6, "last_activity_date": 1594038182, "creation_date": 1539384384, "question_id": 52787883, "link": "https://stackoverflow.com/questions/52787883/how-can-i-pass-test-options-with-cabal-new-test", "title": "How can I pass test-options with cabal new-test?", "body": "<p>In the old cabal, you could pass test options like <code>--color</code> and <code>--match=name</code> by doing <code>cabal test --test-option=--color --test-option=--match=name</code>. Can this be done with <code>cabal new-test</code>? I don't see a <code>--test-option</code> in the help output of <code>cabal new-test --help</code>.</p>\n"}, {"tags": ["haskell", "functional-programming", "tree"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1539378730, "post_id": 52787042, "comment_id": 92495498, "body": "You <code>update</code> <code>l</code> (or <code>r</code>), and then <i>wrap</i> it in a new <code>Node</code> with the old <code>r</code> and <code>l</code> together, so you &quot;reconstruct&quot; a new tree."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1539378744, "post_id": 52787042, "comment_id": 92495503, "body": "Don&#39;t throw away <code>Node _ x r</code> when modifying <code>l</code> in the second case.  Don&#39;t throw away <code>Node l x _</code> when modifying <code>r</code> in the third case."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1539379185, "post_id": 52787042, "comment_id": 92495656, "body": "Regarding your edit: no, don&#39;t recursively call <code>update</code> on a new node that looks exactly the same as your input. Call <code>update</code> on the child node, and then <i>after</i> the call use the result to create the new tree."}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 10394930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5fc94932382e087ae14e58bade83cbc?s=128&d=identicon&r=PG&f=1", "display_name": "newb346", "link": "https://stackoverflow.com/users/10394930/newb346"}, "edited": false, "score": 1, "creation_date": 1539379889, "post_id": 52787126, "comment_id": 92495926, "body": "Thanks! I was able to figure it out based on the comments but it&#39;s nice to have a write up about it. And yes, the size optimization makes complete sense, might need to incorporate that separately"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1539379961, "last_edit_date": 1539379961, "creation_date": 1539379211, "answer_id": 52787126, "question_id": 52787042, "link": "https://stackoverflow.com/questions/52787042/update-a-tree-based-on-index-haskell/52787126#52787126", "title": "Update a tree based on index Haskell", "body": "<p>Since in Haskell all data is <em>immutable</em>, you can not \"update\" a tree, you construct a <em>new</em> tree. That tree might however have references to subtrees of the old tree. You thus do not per se construct a <em>completely</em> new tree.</p>\n\n<p>You managed to create an \"updated\" node, so now the only thing that is missing, is to use the \"updated\" subtree in a <em>new</em> tree. In that tree, you can use the \"old\" value together with the <em>other</em> subtree to construct a new one, like:</p>\n\n<pre><code>update :: Tree a -&gt; Int -&gt; a -&gt; Tree a\nupdate Leaf _ _ = Leaf\nupdate (Node l x r) index c\n    | s == index      = Node l c r\n    | index &lt; s       = <b>Node</b> (update l index c) <b>x r</b>\n    | otherwise       = <b>Node l x (</b>update r (index - s - 1) c<b>)</b>\n  where s = size l</code></pre>\n\n<p>You might also need to change the <code>Leaf</code> case if you \"count\" a leaf as a node.</p>\n\n<p>Trees with indices are not very common. It might also - in order to boost performance - be better to keep track of the number of items in the left subchild (or both), since then we can just pick the left or right subchild without counting the children. By keeping track of the number, for a <em>complete</em> tree, then updating the tree is an <em>O(log n)</em> operation, not an <em>O(n)</em> operation.</p>\n"}], "owner": {"reputation": 141, "user_id": 10394930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5fc94932382e087ae14e58bade83cbc?s=128&d=identicon&r=PG&f=1", "display_name": "newb346", "link": "https://stackoverflow.com/users/10394930/newb346"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 396, "favorite_count": 1, "accepted_answer_id": 52787126, "answer_count": 1, "score": 1, "last_activity_date": 1539379961, "creation_date": 1539378626, "last_edit_date": 1539379816, "question_id": 52787042, "link": "https://stackoverflow.com/questions/52787042/update-a-tree-based-on-index-haskell", "title": "Update a tree based on index Haskell", "body": "<p>I have trees of the form:</p>\n\n<pre><code>data Tree a = Leaf | Node (Tree a) a (Tree a)\n</code></pre>\n\n<p>I created a function to look up the value of a node in a tree based on an in-order, left-to-right traversal.</p>\n\n<pre><code>getElem :: Tree a -&gt; Int -&gt; Maybe a\ngetElem Leaf _ = Nothing\ngetElem (Node l x r) n\n    | s == n     = Just x\n    | n &lt; s      = getElem l n \n    | otherwise  = getElem r (n - s - 1)\n  where\n    s = size l\n</code></pre>\n\n<p>I now want to write a method to be able to update a tree. It should be able to take in a tree, an index and a value and update the node at that index with the value. So far I have:</p>\n\n<pre><code>update :: Tree a -&gt; Int -&gt; a -&gt; Tree a\nupdate Leaf _ _ = Leaf\nupdate (Node l x r) index c\n    | s == index      = (Node l c r)\n    | index &lt; s       = update l index c\n    | otherwise       = update r (index - s - 1) c\n  where\n    s = size l\n</code></pre>\n\n<p>This function is able to add but it obviously returns just the added node itself. I want to be able to return the entire tree post the 'update' with the new node or return the tree as is if the index is out of bounds.</p>\n\n<p>Could anybody give me some idea how to proceed with this?</p>\n\n<p>Edit 1:</p>\n\n<p>Okay, I understand that I am basically discarding the remainder of my tree when recursing here. So:</p>\n\n<pre><code>update :: Tree a -&gt; Int -&gt; a -&gt; Tree a\nupdate Leaf _ _ = Leaf\nupdate (Node l x r) index c\n    | s == index      = (Node l c r)\n    | index &lt; s       = update (Node l2 x r) index c\n    | otherwise       = update (Node l x r2) (index - s - 1) c\n  where\n    s = size l\n    l2 = l\n    r2 = r\n</code></pre>\n\n<p>Edit 2(Silly me!):</p>\n\n<pre><code>update :: Tree a -&gt; Int -&gt; a -&gt; Tree a\nupdate Leaf _ _ = Leaf\nupdate (Node l x r) index c\n    | s == index      = (Node l c r)\n    | index &lt; s       = (Node (upd l index c) x r)\n    | otherwise       = (Node l x (upd r (index - s - 1) c)) \n  where\n    s = size l\n</code></pre>\n\n<p>It took me a bit to wrap my head around it. Thank you for the comments!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 6415, "user_id": 1416525, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6f23f148b7241e345a61d193ed205685?s=128&d=identicon&r=PG", "display_name": "cdk", "link": "https://stackoverflow.com/users/1416525/cdk"}, "edited": false, "score": 4, "creation_date": 1539374648, "post_id": 52786263, "comment_id": 92494025, "body": "<a href=\"https://wiki.haskell.org/Scoped_type_variables\" rel=\"nofollow noreferrer\">wiki.haskell.org/Scoped_type_variables</a> sounds like what you need"}], "answers": [{"tags": [], "owner": {"reputation": 767, "user_id": 814796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZQemO.jpg?s=128&g=1", "display_name": "madgen", "link": "https://stackoverflow.com/users/814796/madgen"}, "is_accepted": true, "score": 6, "last_activity_date": 1539375579, "creation_date": 1539375579, "answer_id": 52786486, "question_id": 52786263, "link": "https://stackoverflow.com/questions/52786263/how-do-i-assert-the-type-of-an-inner-function-depends-on-the-type-of-the-outer-f/52786486#52786486", "title": "How do I assert the type of an inner function depends on the type of the outer function in Haskell?", "body": "<p>Yes, it's done via the <code>ScopedTypeVariables</code> extension. You need to quantify the outer function with <code>forall</code>, then the functions defined in the where clause unless they have <code>forall</code> themselves will refer to the outer scope. When you don't have scoped type variables, every type signature is implicitly quantified so the variables are potentially different to the compiler.</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\nmodule SO where\n\nimport Control.Monad.State\nimport qualified Data.Set as S\n\nbreadthFirst :: forall m a. (Monad m, Ord a) =&gt; (a -&gt; m [a]) -&gt; [a] -&gt; m ()\nbreadthFirst f init = evalStateT (go init) S.empty\n  where\n    go :: [a] -&gt; StateT (S.Set a) m ()\n    go [] = return ()\n    go (x:xs) = do\n      visited &lt;- gets (S.member x)\n      if visited then (go xs) else do\n        modify (S.insert x)\n        lift (f x) &gt;&gt;= (\\n -&gt; go (xs++n))\n</code></pre>\n"}], "owner": {"reputation": 2588, "user_id": 298736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb2a346fde4e2c5dc426aa702d181443?s=128&d=identicon&r=PG", "display_name": "Peter Milley", "link": "https://stackoverflow.com/users/298736/peter-milley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 52786486, "answer_count": 1, "score": 4, "last_activity_date": 1539375579, "creation_date": 1539374372, "question_id": 52786263, "link": "https://stackoverflow.com/questions/52786263/how-do-i-assert-the-type-of-an-inner-function-depends-on-the-type-of-the-outer-f", "title": "How do I assert the type of an inner function depends on the type of the outer function in Haskell?", "body": "<p>So, I'm writing a little helper function to do breadth-first searches (just a hobby project):</p>\n\n<pre><code>import Control.Monad.State\nimport qualified Data.Set as S\n\nbreadthFirst :: (Monad m, Ord a) =&gt; (a -&gt; m [a]) -&gt; [a] -&gt; m ()                                                                                                   \nbreadthFirst f init = evalStateT (go init) S.empty                                                                                                                \n  where                                                                                                                                                            \n    go :: [a] -&gt; StateT (S.Set a) m ()                                                                                                                             \n    go [] = return ()                                                                                                                                              \n    go (x:xs) = do                                                                                                                                                 \n      visited &lt;- gets (S.member x)                                                                                                                                       \n      if visited then (go xs) else do                                                                                                                                      \n        modify (S.insert x)                                                                                                                                        \n        lift (f x) &gt;&gt;= (\\n -&gt; go (xs++n))\n</code></pre>\n\n<p>I.e. pull states off a queue, run <code>f</code> to get more states and put them back on the queue, use a <code>Set</code> to keep track of visited states, and whatever side effects <code>m</code> provides.</p>\n\n<p>Except it doesn't compile: <code>Couldn't match type \u2018m\u2019 with \u2018m1\u2019</code> etc etc okay the compiler doesn't think the inner <code>a</code> and <code>m</code> are the same as the outer <code>a</code> and <code>m</code> and hence it doesn't think the <code>f x</code> call will compile...</p>\n\n<p>But if I delete the type assertion for <code>go</code> I get <code>Non-type variable argument in the constraint</code> because it infers a too-broad type for <code>go</code>:</p>\n\n<pre><code>go :: forall (t :: (* -&gt; *) -&gt; * -&gt; *).\n          (MonadTrans t, MonadState (S.Set a) (t m)) =&gt;\n          [a] -&gt; t m ()\n</code></pre>\n\n<p>I can fix this with <code>FlexibleContexts</code> but I <em>know</em> the type of <code>go</code>, it's not some arbitrary <code>MonadState</code> instance, it's just <code>StateT</code>. If I replace <code>return ()</code> with <code>StateT $ (\\s -&gt; ((), s))</code> then that give the compiler the extra info it needs but that's a little off-putting too.</p>\n\n<p>Is there a way to just tell the compiler the type signature of <code>go</code>, including the fact that the type variables are the same type variables as in the outer function?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1539371000, "post_id": 52785563, "comment_id": 92492681, "body": "What is <code>xs b</code> doing here?"}, {"owner": {"reputation": 79, "user_id": 10488457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e8d44864fddcc26fb7fedf9a4e43f3c?s=128&d=identicon&r=PG&f=1", "display_name": "gbm0102", "link": "https://stackoverflow.com/users/10488457/gbm0102"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1539371208, "post_id": 52785563, "comment_id": 92492755, "body": "@WillemVanOnsem I was trying to send my PriceList (xs) and the first element of my list (b) into the <code>look</code> function to &quot;look up&quot; the corresponding tuple of (Name, Price)."}], "answers": [{"tags": [], "owner": {"reputation": 619, "user_id": 8514005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/318a3ae487b2140f9d08079450b6903d?s=128&d=identicon&r=PG&f=1", "display_name": "JohEker", "link": "https://stackoverflow.com/users/8514005/joheker"}, "is_accepted": false, "score": 2, "last_activity_date": 1539373070, "last_edit_date": 1539373070, "creation_date": 1539372769, "answer_id": 52785941, "question_id": 52785563, "link": "https://stackoverflow.com/questions/52785563/haskell-cycling-through-list-to-map-new-lists/52785941#52785941", "title": "Haskell - cycling through list to map new lists", "body": "<p>What i think you are looking for is to look <code>PriceList</code> with the first element in the <code>CartItems</code>, then look the <code>PriceList</code> with the second element in the <code>CartItems</code> and so forth. This can be done with recursion, building a list like this</p>\n\n<pre><code>priceCart :: PriceList -&gt; CartItems -&gt; CartPrices\npriceCart [] _ = []\npriceCart t@((bc, n, p):xs) (b:bs) = look t b : priceCart t bs\n</code></pre>\n\n<p>As you see the pattern matching on PriceList is not of use and could be replaced:</p>\n\n<pre><code>priceCart t (b:bs) = look t b : priceCart t bs\n</code></pre>\n\n<p>Why is this not working with <code>map</code> in the way you have written in this case? </p>\n\n<p>So map is looking for a function to apply on every element in the input list. Your function takes two arguments, one of the arguments can be found as an element in PriceList, namely <code>xs</code>. The other argument however, <code>b (BarCode)</code>, is NOT an element in your list <code>xs</code>, and <code>map</code> will not be able to recognize it as one of the arguments for the functions, since it is not an element in the list that you are mapping on.</p>\n"}, {"tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": true, "score": 2, "last_activity_date": 1539372950, "creation_date": 1539372950, "answer_id": 52785981, "question_id": 52785563, "link": "https://stackoverflow.com/questions/52785563/haskell-cycling-through-list-to-map-new-lists/52785981#52785981", "title": "Haskell - cycling through list to map new lists", "body": "<p>I think you want to look up each <code>BarCode</code> in the <code>PriceList</code>.  I expect that the result of <code>priceList</code> will be the same length as the input <code>CartItems</code>.  This is a good fit for <code>map</code>.</p>\n\n<p>In general, <code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]</code>.\nIn your case, you want <code>map :: (BarCode -&gt; (Name, Price)) -&gt; [BarCode] -&gt; [(Name, Price)]</code>.</p>\n\n<p>You have a list of type <code>[Barcode]</code>, so that's no problem.  You <em>almost</em> have a function of type <code>BarCode -&gt; (Name, Price)</code> in <code>look :: PriceList -&gt; BarCode -&gt; (Name, Price)</code>.  The key point is that you will compare each <code>BarCode</code> to the same <code>PriceList</code>.  So you can write <code>priceCart prices bs = map (look prices) bs</code>, where <code>look prices :: BarCode -&gt; (Name, Price)</code>.</p>\n\n<p>Partial application often trips up people learning Haskell.  <code>look prices</code> is equivalent to <code>\\barcode -&gt; look prices barcode</code> in anonymous-function syntax.  <code>prices</code> supplies the first argument to <code>look</code>, and what's left is a function that still needs a <code>BarCode</code>.</p>\n\n<p>You can use explicit recursion anywhere that you can use <code>map</code> - explicit recursion is more general.  In this case, I find the version with <code>map</code> easier to read.</p>\n"}], "owner": {"reputation": 79, "user_id": 10488457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e8d44864fddcc26fb7fedf9a4e43f3c?s=128&d=identicon&r=PG&f=1", "display_name": "gbm0102", "link": "https://stackoverflow.com/users/10488457/gbm0102"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "accepted_answer_id": 52785981, "answer_count": 2, "score": 1, "last_activity_date": 1539373070, "creation_date": 1539370634, "last_edit_date": 1539371827, "question_id": 52785563, "link": "https://stackoverflow.com/questions/52785563/haskell-cycling-through-list-to-map-new-lists", "title": "Haskell - cycling through list to map new lists", "body": "<p>I'm working on a beginner Haskell program that can take a database of product prices (i.e. a price list) and a list of barcodes of the items in a shopping cart and generate the list of item prices. But the code that I've written produces type errors that I'll go into below. First, my code:</p>\n\n<p>I begin by defining my relevant types:</p>\n\n<pre><code>type BarCode = Int\ntype Name = String\ntype Price = Int\ntype PriceList = [(BarCode,Name,Price)]\ntype CartItems = [BarCode]\ntype CartPrices = [(Name,Price)]\n</code></pre>\n\n<p>Next, I started to write my main program:</p>\n\n<pre><code>priceCart :: PriceList -&gt; CartItems -&gt; CartPrices\npriceCart ((bc, n, p):xs) (b:bs) = map look (xs b)\n\nlook :: PriceList -&gt; BarCode -&gt; (Name, Price)\nlook [] barcode = (\"None\",0)\nlook ((bc, n, p):xs) barcode\n    | bc == barcode = (n, p)\n    | otherwise = look xs barcode\n</code></pre>\n\n<p>Essentially, I want to be able to go through my list of barcodes and call my <code>look</code> function for every element of <code>CartItems</code> and build a list with the <code>map</code> function. But my knowledge doesn't quite extend to all of the prelude functions, and so I believe I'm using the <code>map</code> function incorrectly. In fact, I know this, because of the compile errors that I got (see below). But now I'm also wondering if I'm missing how to correctly iterate through my list in <code>priceCart</code> -- should I perhaps be using recursion as in my <code>look</code> function? If so, I'm a little confused as to how I can combine all of the aforementioned functions to produce the desired output.</p>\n\n<p><a href=\"https://i.stack.imgur.com/x5GQQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x5GQQ.png\" alt=\"Compile Errors\"></a></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1539361733, "post_id": 52783481, "comment_id": 92488533, "body": "Your example is missing imports, could you add those?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1539362109, "post_id": 52783481, "comment_id": 92488712, "body": "@MichaelLitchard: these are defined in <a href=\"https://stackoverflow.com/questions/52778291/haskell-need-to-define-vector2-instance-for-typeclass\" title=\"haskell need to define vector2 instance for typeclass\">stackoverflow.com/questions/52778291/&hellip;</a> but you are correct that it is better to include these to make the question more &quot;canned&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10494759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500e0a2da2e41b2befa40a946845ef88?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkman", "link": "https://stackoverflow.com/users/10494759/yorkman"}, "edited": false, "score": 0, "creation_date": 1539363359, "post_id": 52783665, "comment_id": 92489316, "body": "Thanks for your quick response and I think I have made the changes you advise.  My question is when I tested it, I got error    vecF (1,2) [(0,0),(1,1),(2,2)]...do you know what&#39;s wrong?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 3, "user_id": 10494759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500e0a2da2e41b2befa40a946845ef88?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkman", "link": "https://stackoverflow.com/users/10494759/yorkman"}, "edited": false, "score": 0, "creation_date": 1539363799, "post_id": 52783665, "comment_id": 92489510, "body": "@Yorkman: well the parameters here are a <code>Vector2</code> and a list of 2-tuples, you first parameters is a 2-tuple, so it should be <code>vecF (Vector2 (1,2)) [(0,0), (1,1), (2,2)]</code>. But I thin the last approach is probably the best: implementing a function that can calculate the difference between two <code>VectorSpace</code> type objects."}, {"owner": {"reputation": 3, "user_id": 10494759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500e0a2da2e41b2befa40a946845ef88?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkman", "link": "https://stackoverflow.com/users/10494759/yorkman"}, "edited": false, "score": 0, "creation_date": 1539394221, "post_id": 52783665, "comment_id": 92498808, "body": "hi...there is no compile error however, when I try to test with your vecDiff                              vecF (Vector2 (1,2)) [(0,0), (1,1), (2,2)]                                        I go the following error                                                                                      Couldn&#39;t match type \u2018(,) Integer\u2019 with \u2018Vector2\u2019       Expected type: Vector2 a         Actual type: (Integer, a)     In the expression: (0, 0)       In the second argument of \u2018vecF\u2019, namely \u2018[(0, 0), (1, 1), (2, 2)]\u2019       In the expression: vecF (Vector2 (1, 2)) [(0, 0), (1, 1), (2, 2)]"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 3, "user_id": 10494759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500e0a2da2e41b2befa40a946845ef88?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkman", "link": "https://stackoverflow.com/users/10494759/yorkman"}, "edited": false, "score": 0, "creation_date": 1539406964, "post_id": 52783665, "comment_id": 92500425, "body": "@Yorkman: yes, in case you make a function with <code>vecDif</code>, you add the flexibility that the vectorspace of the first parameter is the same as the elements in the list, but not two different one, so <code>vecF (Vector2 (1,2)) [Vector2 (0,0)]</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 3, "user_id": 10494759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500e0a2da2e41b2befa40a946845ef88?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkman", "link": "https://stackoverflow.com/users/10494759/yorkman"}, "edited": false, "score": 0, "creation_date": 1539415928, "post_id": 52783665, "comment_id": 92502016, "body": "@Yorkman please don&#39;t continually get back at questions you asked, when the problem has shifted. First make sure you&#39;ve really tried everything you could to solve it yourself, and that it is worthwhile going to SO, then ask a new, self-contained question about the new problem."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1539362071, "last_edit_date": 1592644375, "creation_date": 1539362071, "answer_id": 52783665, "question_id": 52783481, "link": "https://stackoverflow.com/questions/52783481/how-do-i-resolve-this-error-in-haskell-coding-with-vector/52783665#52783665", "title": "How do I resolve this error in Haskell coding with vector", "body": "<p>There are basically four problems here: two can be solved easilyk, the others will require to change the signature, or implementing extra functions:</p>\n<ol>\n<li><p>you forgot to write brackets in the head of the function:</p>\n <pre><code>vecF <b>(Vector2 (a,b))</b> ys = ...</code></pre>\n</li>\n<li><p>the brackets in the &quot;yield&quot; part of the list comprehension do not have brackets to make a tuple:</p>\n<pre><code>[ vecMagnitude (Vector2 <b>(a+(-1)*a', b+(-1)*b')</b>) | ... ]</code></pre>\n</li>\n<li><p>in your signature you allow the first parameter to be any <code>v a</code> with <code>v</code> a <code>VectorSpace</code> type, and <code>a</code> a <code>Floating</code> type, so you can not just add a constructor like:</p>\n <pre><code>vecF <b><s>(Vector2 (a, b))</s></b> = ...</code></pre>\n</li>\n<li><p>(can not be solved in a straightforward way) since <code>ys</code> is a list of <code>v a</code>s, you can not just enumerate from <code>ys</code> as:</p>\n <pre><code>[ ... | <b><s>(a', b') &lt;- ys</s></b> ]</code></pre>\n</li>\n</ol>\n<p>The last two problems can not be solved easily, we can <em>specialize</em> the signature such that it works, like:</p>\n<pre><code>vecF :: Floating a =&gt; <b>Vector2</b> a -&gt; [<b>(a, a)</b>] -&gt; [a]\nvecF (Vector2 (a,b)) ys = [ vecMagnitude ( Vector2 (a-a',b-b')) |(a',b') &lt;- ys ]</code></pre>\n<p>but then we of course loose the flexibitily to use other <code>VectorSpace</code>s, another option is for example to move <code>vecF</code> to the <code>class</code> definition and implement it in the <code>instance</code> clause. Finally another option might be to make extra functions such that you do not need pattern matching to calculate the <code>vecMaginute</code>, you can for example implement a function:</p>\n<pre><code>class VectorSpace v where\n    -- ...\n    vecDiff :: Num a =&gt; v a -&gt; v a -&gt; v a</code></pre>\n<p>and then you can implement this as:</p>\n<pre><code>vecF :: (Floating a, VectorSpace v) =&gt; v a -&gt; [v a] -&gt; [a]\nvecF v0 vs = [ vecMagnitude (vecDiff v0 v1) | v1 &lt;- vs ]</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10494759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500e0a2da2e41b2befa40a946845ef88?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkman", "link": "https://stackoverflow.com/users/10494759/yorkman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 52783665, "answer_count": 1, "score": 0, "last_activity_date": 1539362071, "creation_date": 1539361225, "question_id": 52783481, "link": "https://stackoverflow.com/questions/52783481/how-do-i-resolve-this-error-in-haskell-coding-with-vector", "title": "How do I resolve this error in Haskell coding with vector", "body": "<pre><code>newtype Vector2 a = Vector2 (a,a)\n   deriving (Show,Eq)\n\ninstance VectorSpace Vector2 where \n  vecMagnitude (Vector2 (a,b)) = (a**2 + b**2)**(1/2)\n\nvecF :: (Floating a, VectorSpace v) =&gt; v a -&gt; [v a] -&gt; [a]\nvecF Vector2 (a,b) ys = [ vecMagnitude ( Vector2 (a+(-1)*a'),(b+(-1)*b') ) |(a',b') &lt;- ys ]\n</code></pre>\n\n<p>So the above coding I have errors with is the vecF function, see the following error msg :</p>\n\n<pre><code>Couldn't match type \u2018v\u2019 with \u2018(,) a0\u2019\n  \u2018v\u2019 is a rigid type variable bound by\n    the type signature for:\n      vecF :: forall a (v :: * -&gt; *).\n              (Floating a, VectorSpace v) =&gt;\n              v a -&gt; [v a] -&gt; [a]\n    at Assign_2_EC_test.hs:74:1-58\n  Expected type: v a\n    Actual type: (a0, a)\n\nIn the pattern: (a, b)\n  In an equation for \u2018vecF\u2019:\n      vecF (a, b) ys\n        = [vecMagnitude ((a + (- 1) * a'), (b + (- 1) * b')) |\n             (a', b') &lt;- ys]\nRelevant bindings include\n    vecF :: v a -&gt; [v a] -&gt; [a]\n</code></pre>\n\n<p>Any idea what was the error </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 3258, "user_id": 7661005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0c49d2077073823b91fa1ccc82fa0d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Maxxx", "link": "https://stackoverflow.com/users/7661005/maxxx"}, "edited": false, "score": 0, "creation_date": 1539360685, "post_id": 52782883, "comment_id": 92488014, "body": "thanks for the thorough walkthrough. One question, do i need to define the return value as well which is the final -&gt; Int in the function type in makeBid c cs n bs or is it just the first four arguments?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 3258, "user_id": 7661005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0c49d2077073823b91fa1ccc82fa0d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Maxxx", "link": "https://stackoverflow.com/users/7661005/maxxx"}, "edited": false, "score": 0, "creation_date": 1539361595, "post_id": 52782883, "comment_id": 92488464, "body": "The return value is just whatever the expression the right side evaluates two. For example, a valid (though probably useless) definition might be <code>makeBid c cs n bs = 3</code>, since <code>3</code> is a valid <code>Int</code> value."}, {"owner": {"reputation": 3258, "user_id": 7661005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0c49d2077073823b91fa1ccc82fa0d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Maxxx", "link": "https://stackoverflow.com/users/7661005/maxxx"}, "edited": false, "score": 0, "creation_date": 1539363229, "post_id": 52782883, "comment_id": 92489241, "body": "thanks but I&#39;m still terribly confused on how the BidFunc returns an Int from the 4 set of arguments that is supplied. The game is based off &quot;Oh Hell&quot; card game where the player makes a bid at start. So in a relatively simple example, say i wrote something like &quot;makeBid c cs n bs = (for card in cs, if card == c) then doSomething...&quot;. I understand if it&#39;s &quot;add x y =  x + y&quot; which would give the summation of x and y but for a card game, it&#39;s just not as clear as i expected."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 3258, "user_id": 7661005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0c49d2077073823b91fa1ccc82fa0d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Maxxx", "link": "https://stackoverflow.com/users/7661005/maxxx"}, "edited": false, "score": 0, "creation_date": 1539365432, "post_id": 52782883, "comment_id": 92490197, "body": "This is getting pretty far off-topic, as you are now asking how one would actually implement <code>makeBid</code>, rather than asking about the syntax. Consider a very simple definition, though, that simply outbids the last player as long as it&#39;s theoretically possible to take that many tricks. You might write <code>makeBid _ hand _ (lastbid:_) = if lastbid == length hand then 0 else lastbid + 1</code>. This ignores the proposed trump suit and the number of players, and it assumes that at least one bid has been made (and that the most recent bid is at the front of the list)."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 7, "last_activity_date": 1539359292, "last_edit_date": 1539359292, "creation_date": 1539358908, "answer_id": 52782883, "question_id": 52782821, "link": "https://stackoverflow.com/questions/52782821/trouble-understanding-types-in-haskell/52782883#52782883", "title": "Trouble understanding types in Haskell", "body": "<p><code>makeBid :: BidFunc</code> is <em>exactly</em> the same as <code>makeBid :: Car -&gt; [Card] -&gt; Int -&gt; [Int] -&gt; Int</code>, so you would define the function in exactly the same way:</p>\n\n<pre><code>makeBid :: BidFunc\n-- makeBid :: Card -&gt; [Card] -&gt; Int -&gt; [Int] -&gt; Int\nmakeBid c cs n bs = ...\n</code></pre>\n\n<p>As for the formatting of the <code>type</code> definition, it's just that: formatting. IMO, it would be a little clearer written as</p>\n\n<pre><code>type BidFunc = Card   -- ...\n            -&gt; [Card]  -- ...\n            -&gt; Int    -- ...\n            -&gt; [Int]  -- ...\n            -&gt; Int    -- ...\n</code></pre>\n\n<p>if you want to comment on each argument and the return value. Without comments, it can of course be written on one line:</p>\n\n<pre><code>type BidFunc = Card -&gt; [Card] -&gt; Int -&gt; [Int] -&gt; Int\n</code></pre>\n\n<p>In general, <code>type &lt;lhs&gt; = &lt;rhs&gt;</code> just remeans that <code>&lt;lhs&gt;</code> is a name that can refer to whatever type <code>&lt;rhs&gt;</code> specifies.</p>\n\n<hr>\n\n<p>As to <em>why</em> one might feel the need to define a type alias for something that isn't going to be reused often, I couldn't say. Are they any other functions beside <code>makeBid</code> that would have the same type?</p>\n"}], "owner": {"reputation": 3258, "user_id": 7661005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0c49d2077073823b91fa1ccc82fa0d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Maxxx", "link": "https://stackoverflow.com/users/7661005/maxxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 52782883, "answer_count": 1, "score": 0, "last_activity_date": 1539359292, "creation_date": 1539358634, "question_id": 52782821, "link": "https://stackoverflow.com/questions/52782821/trouble-understanding-types-in-haskell", "title": "Trouble understanding types in Haskell", "body": "<p>I'm given the following where:</p>\n\n<pre><code>data Card = Card Suit Rank\n  deriving (Eq, Ord, Show)\n\ntype BidFunc\n  = Card    -- ^ trump card\n  -&gt; [Card] -- ^ list of cards in the player's hand\n  -&gt; Int    -- ^ number of players\n  -&gt; [Int]  -- ^ bids so far\n  -&gt; Int    -- ^ the number of tricks the player intends to win\n</code></pre>\n\n<p>where I'm required to write a function of</p>\n\n<pre><code>makeBid :: BidFunc\nmakeBid = (write here)\n</code></pre>\n\n<p>The problem I'm having is that i couldnt understand the syntax of the function type declared which is BidFunc. I'm new to Haskell so i would appreciate if someone could give me an explanation clear enough on the function type above. </p>\n\n<p>In particularly, why is there a '=' Card, followed by -> [Card] etc? Am i supposed to pass in arguments to the function type?</p>\n"}, {"tags": ["haskell", "types", "monoids", "foldable"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1539346205, "post_id": 52779202, "comment_id": 92479968, "body": "You need to add a <code>unSum</code> and <code>unProduct</code> as post-processing step."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1539350833, "last_edit_date": 1539350833, "creation_date": 1539346425, "answer_id": 52779326, "question_id": 52779202, "link": "https://stackoverflow.com/questions/52779202/foldable-and-monoid-types/52779326#52779326", "title": "Foldable and Monoid types", "body": "<p>If you use <code>Sum</code> (or <code>Product</code>) in the <code>foldMap</code>, you will first <em>map</em> the items in the <code>Foldable</code> to <code>Sum</code>s (or <code>Product</code>s). Therefore the result of <code>fsum</code> will - like you defined it - be a <code>Sum a</code>, not an <code>a</code>:</p>\n\n<pre><code>fsum :: (Foldable f, Num a) =&gt; f a -&gt; <b>Sum a</b>\nfsum b = foldMap Sum b</code></pre>\n\n<p>In order to retrieve the value that is wrapped in the <code>Sum</code> constructor, you can fetch it with the <code>unSum :: Sum a -&gt; a</code> getter:</p>\n\n<pre><code>fsum :: (Foldable f, Num a) =&gt; f a -&gt; <b>a</b>\nfsum b = <b>unSum (</b>foldMap Sum b<b>)</b></code></pre>\n\n<p>or after an <em>eta-reduction</em>:</p>\n\n<pre><code>fsum :: (Foldable f, Num a) =&gt; f a -&gt; a\nfsum = unSum . foldMap Sum</code></pre>\n\n<p>The same should happen for a <code>Product</code>.</p>\n"}], "owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 1, "accepted_answer_id": 52779326, "answer_count": 1, "score": 2, "last_activity_date": 1605146841, "creation_date": 1539346028, "last_edit_date": 1605146841, "question_id": 52779202, "link": "https://stackoverflow.com/questions/52779202/foldable-and-monoid-types", "title": "Foldable and Monoid types", "body": "<p>I'm trying to write functions that add and multiply all elements in a list using monoids and Foldable. I've set up some code that I think works:</p>\n\n<pre><code>data Rose a = a :&gt; [Rose a]\n    deriving (Eq, Show)\n\ninstance Functor Rose where\n    fmap f rose@(a:&gt;b) = (f a :&gt; map (fmap f) b) \n\nclass Monoid a where\n    mempty ::           a\n    (&lt;&gt;)   :: a -&gt; a -&gt; a\n\ninstance Monoid [a] where\n    mempty = []\n    (&lt;&gt;)   = (++)\n\nnewtype Sum     a = Sum     { unSum     :: a } deriving (Eq, Show)\nnewtype Product a = Product { unProduct :: a } deriving (Eq, Show)\n\ninstance Num a =&gt; Monoid (Sum a) where\n    mempty           = Sum 0\n    Sum n1 &lt;&gt; Sum n2 = Sum (n1 + n2)\n\ninstance Num a =&gt; Monoid (Product a) where\n    mempty                   = Product 1\n    Product n1 &lt;&gt; Product n2 = Product (n1 * n2)\n\nclass Functor f =&gt; Foldable f where\n    fold    :: Monoid m =&gt;             f m -&gt; m\n    foldMap :: Monoid m =&gt; (a -&gt; m) -&gt; f a -&gt; m\n    foldMap f a = fold (fmap f a)\n\ninstance Foldable [] where\n    fold = foldr (&lt;&gt;) mempty\n\ninstance Foldable Rose where\n    fold (a:&gt;[]) = a &lt;&gt; mempty\n    fold (a:&gt;b)  = a &lt;&gt; (fold (map fold b))\n</code></pre>\n\n<p>And then after having defined the different Foldable instances and the Sum and Product types I want to define two functions that add respectively multiply the elements in a datastructure, but this gives errors which I do not know how to interpret, I must admit that I it was more guess work than actual logic so a thorough explanation of your answer would be welcome.</p>\n\n<pre><code>fsum, fproduct :: (Foldable f, Num a) =&gt; f a -&gt; a\nfsum b     = foldMap Sum b\nfproduct b = foldMap Product b\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>Assignment3.hs:68:14: error:\n    * Occurs check: cannot construct the infinite type: a ~ Sum a\n    * In the expression: foldMap Sum b\n      In an equation for `fsum': fsum b = foldMap Sum b\n    * Relevant bindings include\n        b :: f a (bound at Assignment3.hs:68:6)\n        fsum :: f a -&gt; a (bound at Assignment3.hs:68:1)\n   |\n68 | fsum b     = foldMap Sum b\n   |              ^^^^^^^^^^^^^\n\nAssignment3.hs:69:14: error:\n    * Occurs check: cannot construct the infinite type: a ~ Product a\n    * In the expression: foldMap Product b\n      In an equation for `fproduct': fproduct b = foldMap Product b\n    * Relevant bindings include\n        b :: f a (bound at Assignment3.hs:69:10)\n        fproduct :: f a -&gt; a (bound at Assignment3.hs:69:1)\n   |\n69 | fproduct b = foldMap Product b\n   |              ^^^^^^^^^^^^^^^^^\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1539342717, "post_id": 52778291, "comment_id": 92478073, "body": "Great vector space! What is your question?"}, {"owner": {"reputation": 3, "user_id": 10494759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500e0a2da2e41b2befa40a946845ef88?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkman", "link": "https://stackoverflow.com/users/10494759/yorkman"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1539342976, "post_id": 52778291, "comment_id": 92478209, "body": "oh I need to create an instance statement to define for Vector2...but I am new to Haskell...and clue ?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1539343076, "post_id": 52778291, "comment_id": 92478260, "body": "I would argue that this is not <a href=\"http://hackage.haskell.org/package/vector-space-0.15/docs/Data-VectorSpace.html#t:VectorSpace\" rel=\"nofollow noreferrer\">the class of vector spaces</a>. Vector spaces aren&#39;t supposed to be parameterised over the scalar type. Your class is actually more about representable functors, which is what the <a href=\"http://hackage.haskell.org/package/linear\" rel=\"nofollow noreferrer\">linear library</a> is based on. I recommend you look into the source both of these libraries, to answer the question."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1539343093, "post_id": 52778291, "comment_id": 92478275, "body": "@Yorkman: but being new to something is not an excuse for lack of effort. What did you try? What is not working?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1539343321, "post_id": 52778291, "comment_id": 92478389, "body": "...or if you really don&#39;t have any clue at all how to start, you should probably first read an introduction to Haskell in general. IMO <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow noreferrer\">Learn You A Haskell</a> is still the best point of entry, though many people prefer <a href=\"http://haskellbook.com/\" rel=\"nofollow noreferrer\">Haskell from First Principles</a> nowadays."}, {"owner": {"reputation": 3, "user_id": 10494759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500e0a2da2e41b2befa40a946845ef88?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkman", "link": "https://stackoverflow.com/users/10494759/yorkman"}, "edited": false, "score": 0, "creation_date": 1539343348, "post_id": 52778291, "comment_id": 92478401, "body": "So here is what I tried so far :                                                                instance VectorSpace (a,a) =&gt; VectorSpace Vector2 a    vecZero = (0.0,0.0)      vecSum (x,y) (x&#39;,y&#39;) = (x+x&#39;,y+y&#39;)"}, {"owner": {"reputation": 3, "user_id": 10494759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500e0a2da2e41b2befa40a946845ef88?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkman", "link": "https://stackoverflow.com/users/10494759/yorkman"}, "edited": false, "score": 0, "creation_date": 1539343791, "post_id": 52778291, "comment_id": 92478633, "body": "oh don&#39;t know, that&#39;s what the question i was being asked...."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1539349170, "post_id": 52778291, "comment_id": 92481603, "body": "Please don&#39;t add code in the comments; put your attempt in the question itself."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10494759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500e0a2da2e41b2befa40a946845ef88?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkman", "link": "https://stackoverflow.com/users/10494759/yorkman"}, "edited": false, "score": 0, "creation_date": 1539344518, "post_id": 52778686, "comment_id": 92479046, "body": "thanks it works  for the vecSum, but I got an error for vecZero = (0.0,0.0) as it is a zero vector constant....do you know why?"}, {"owner": {"reputation": 3, "user_id": 10494759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500e0a2da2e41b2befa40a946845ef88?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkman", "link": "https://stackoverflow.com/users/10494759/yorkman"}, "edited": false, "score": 0, "creation_date": 1539344932, "post_id": 52778686, "comment_id": 92479270, "body": "I just updated my last line...do you have any idea to fix vecZero ?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 3, "user_id": 10494759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500e0a2da2e41b2befa40a946845ef88?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkman", "link": "https://stackoverflow.com/users/10494759/yorkman"}, "edited": false, "score": 0, "creation_date": 1539345069, "post_id": 52778686, "comment_id": 92479337, "body": "It&#39;s the same issue as I explained for <code>vecSum</code>."}, {"owner": {"reputation": 3, "user_id": 10494759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500e0a2da2e41b2befa40a946845ef88?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkman", "link": "https://stackoverflow.com/users/10494759/yorkman"}, "edited": false, "score": 0, "creation_date": 1539345765, "post_id": 52778686, "comment_id": 92479729, "body": "I tried with this but still got error   vecZero (Vector2 (0.0,0.0))"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1539344652, "last_edit_date": 1539344652, "creation_date": 1539344155, "answer_id": 52778686, "question_id": 52778291, "link": "https://stackoverflow.com/questions/52778291/haskell-need-to-define-vector2-instance-for-typeclass/52778686#52778686", "title": "Haskell - need to define Vector2 instance for typeclass", "body": "<blockquote>\n  <p>So here is what I tried so far: <pre>instance VectorSpace (a,a) => VectorSpace Vector2 a\n  vecZero = (0.0,0.0)\n  vecSum (x,y) (x',y') = (x+x',y+y')</pre></p>\n</blockquote>\n\n<p>The first problem here is syntax. You need a <code>where</code> at the end of the first line, and if <code>Vector2 a</code> is supposed to be the instance head then it needs to go in parentheses:</p>\n\n<pre><code>instance VectorSpace (a,a) =&gt; VectorSpace (Vector2 a) where\n</code></pre>\n\n<p>That, however, doesn't match the kinds of your declared class.</p>\n\n<pre><code>class VectorSpace (v :: <b>*</b> -> *) where\n    vZero :: (Num a) => v <b>a</b>\n    ...</code></pre>\n\n<p>i.e., the class already has the assumption built in that <code>v</code> will be applied to some <code>a</code> parameter<sup>\u2020</sup>. Thus the instance head should <em>not</em> contain that parameter, it should just look like</p>\n\n<pre><code>instance (...?) =&gt; VectorSpace Vector2 where\n</code></pre>\n\n<p>In fact it turns out you don't need any constraints at all here.</p>\n\n<pre><code>instance VectorSpace Vector2 where\n</code></pre>\n\n<p>Now as for the methods,</p>\n\n<blockquote>\n<pre>  vecSum (x,y) (x',y') = (x+x',y+y')</pre>\n</blockquote>\n\n<p>that would be a perfectly sensible implementation if your type were the tuple type. However your type is actually a <code>newtype</code> wrapped tuple, and <code>newtypes</code> always need explicit constructors. Like</p>\n\n<pre><code>  vecSum (Vector2 (x,y)) (Vector2 (x',y')) = Vector2 (x+x',y+y')\n</code></pre>\n\n<p>This is a bit silly really: you have both a named constructor and a tuple constructor, nested. It's also pretty inefficient since tuples incur extra indirection (laziness, cache). The type should better be defined as</p>\n\n<pre><code>data Vector2 a = Vector2 !a !a\n</code></pre>\n\n<p>where, because the fields are strict, GHC can unbox the numbers. In that case, the definition would be</p>\n\n<pre><code>  vecSum (Vector2 x y) (Vector2 x' y') = Vector2 (x+x') (y+y')\n</code></pre>\n\n<hr>\n\n<p><sup>\u2020</sup><sub>Mind, as I've already commented it is IMO <strong>not</strong> good for a vector space class to parameterise <code>v a</code> at all. In the <a href=\"http://hackage.haskell.org/package/vector-space-0.15/docs/Data-VectorSpace.html#t:VectorSpace\" rel=\"nofollow noreferrer\"><code>vector-space</code> library</a>, the instances aren't required to be parameterised; one of the advantages is that you can directly give an instance for ordinary tuples without needing any newtype wrapping.</sub></p>\n"}], "owner": {"reputation": 3, "user_id": 10494759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500e0a2da2e41b2befa40a946845ef88?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkman", "link": "https://stackoverflow.com/users/10494759/yorkman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1539344652, "creation_date": 1539342669, "question_id": 52778291, "link": "https://stackoverflow.com/questions/52778291/haskell-need-to-define-vector2-instance-for-typeclass", "title": "Haskell - need to define Vector2 instance for typeclass", "body": "<pre><code>newtype Vector2 a = Vector2 (a,a)\n     deriving (Show,Eq)\n\nclass VectorSpace v where\n     vZero :: (Num a) =&gt; v a\n     vSum :: (Num a) =&gt; v a -&gt; v a -&gt; v a\n     vScalarProd :: (Num a) =&gt; a -&gt; v a -&gt; v a\n     vMagnitude :: (Floating a) =&gt; v a -&gt; a\n</code></pre>\n\n<p>Need to define for Vector2 to be instances of the type class VectorSpace.</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1539327208, "post_id": 52773470, "comment_id": 92469591, "body": "<code>plusOne = map (map (+1)) </code>?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1539327793, "post_id": 52773470, "comment_id": 92469866, "body": "Divide and conquer. First write a fun tion to manipulate one list element. Then combine it with a function that manipulates lists."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1539329511, "post_id": 52773470, "comment_id": 92470775, "body": "You might want to introduce a type to make your function signature more readable. For example <code>String</code> is a type for <code>[Char]</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1539351294, "post_id": 52773470, "comment_id": 92482743, "body": "@arrowd You can&#39;t <code>(+1)</code> a 3-tuple, but you can indeed use <code>map (map f)</code> for a suitable <code>f</code>."}], "answers": [{"tags": [], "owner": {"reputation": 13772, "user_id": 379311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c993f4f111e6ff3211ccda1b98828253?s=128&d=identicon&r=PG", "display_name": "Yann Vernier", "link": "https://stackoverflow.com/users/379311/yann-vernier"}, "is_accepted": false, "score": 7, "last_activity_date": 1539327840, "creation_date": 1539327840, "answer_id": 52774058, "question_id": 52773470, "link": "https://stackoverflow.com/questions/52773470/iterating-through-a-list-of-lists-of-3-tuples-in-haskell/52774058#52774058", "title": "Iterating through a list of lists of 3-tuples in Haskell", "body": "<p>Split the functions. The lists are easy; one <code>map</code> each. But tuples don't traverse the way they do in e.g. Python, so they require unpacking to access the elements; this is possible with generic programming but far easier with pattern matching. Tuples can hold fields of varying types, so something like <code>map</code> couldn't access all of them. We can make our own map-analogue for triples specifically:</p>\n\n<pre><code>map3t :: (x -&gt; y) -&gt; (x, x, x) -&gt; (y, y, y)\nmap3t f (a, b, c) = (f a, f b, f c)\n</code></pre>\n\n<p>Now we can inspect each level of our type and handle it separately:</p>\n\n<pre><code>op :: Int -&gt; Int\nop = (+1)\nt3 :: (Int, Int, Int) -&gt; (Int, Int, Int)\nt3 = map3t op\nlt3 :: [(Int, Int, Int)] -&gt; [(Int, Int, Int)]\nlt3 = map t3\nllt3 :: [[(Int, Int, Int)]] -&gt; [[(Int, Int, Int)]]\nllt3 = map lt3\n</code></pre>\n\n<p>This is not recursion, although <code>map</code> may be implemented using recursion (<a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/src/GHC.Base.html#map\" rel=\"noreferrer\"><code>Data.List.map</code></a> is). Each function calls a different function for the inner level. </p>\n"}, {"tags": [], "owner": {"reputation": 619, "user_id": 8514005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/318a3ae487b2140f9d08079450b6903d?s=128&d=identicon&r=PG&f=1", "display_name": "JohEker", "link": "https://stackoverflow.com/users/8514005/joheker"}, "is_accepted": false, "score": 1, "last_activity_date": 1539368480, "last_edit_date": 1539368480, "creation_date": 1539359483, "answer_id": 52783025, "question_id": 52773470, "link": "https://stackoverflow.com/questions/52773470/iterating-through-a-list-of-lists-of-3-tuples-in-haskell/52783025#52783025", "title": "Iterating through a list of lists of 3-tuples in Haskell", "body": "<p>Here is an example of a not very generic way of how we can use map to access nested lists,which also can be matched on 3tuples with a lambda function: </p>\n\n<pre><code>fun :: (Num a, Num b, Num c) =&gt; [[(a, b, c)]] -&gt; [[(a, b, c)]]\nfun xs = map (map(\\(x,y,z) -&gt; (x+1,y+1,z+1))) xs\n</code></pre>\n\n<p>Pros: En easy and understandable oneliner to solve a specific problem</p>\n\n<p>Cons: Not generic for the function applied to the elements, can become fuzzy and out of hand with more complex and bigger input structures.</p>\n\n<p>Mapping with a hard coded function forcing you to make a new map for each operation. So a better way in that case would be to refactor the function itself, ie :</p>\n\n<pre><code>fun2 f xs = map (map(op f)) xs\n    where\n    op f' (x,y,z) = (f' x,f' y, f' z)\n</code></pre>\n\n<p>Making <code>op</code> a function to which you can give an operation for the specific type.</p>\n\n<p>Making the signature for the function more generic on the types of operations: (Notice here that we can no longer be sure of the type of <code>x,y,z</code>, which before were numerics (because of the <code>+1</code> operation) giving us a more generic version of the function, but also making us more responsible of matching the types correctly, no string operations on integers etc.)</p>\n\n<pre><code>fun2 :: (t -&gt; c) -&gt; [[(t, t, t)]] -&gt; [[(c, c, c)]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1539378057, "last_edit_date": 1539378057, "creation_date": 1539371338, "answer_id": 52785680, "question_id": 52773470, "link": "https://stackoverflow.com/questions/52773470/iterating-through-a-list-of-lists-of-3-tuples-in-haskell/52785680#52785680", "title": "Iterating through a list of lists of 3-tuples in Haskell", "body": "<p>Define a proper functor to wrap your tuples.</p>\n\n<pre><code>data Three a = Three {getThree :: (a, a, a)} deriving (Show, Functor)\n</code></pre>\n\n<p>If you don't want to use the <code>DeriveFunctor</code> extension, the definition is simple:</p>\n\n<pre><code>instance Functor Three where\n  fmap f (Three (x, y, z)) = Three (f x, f y, f z)\n</code></pre>\n\n<p>Then you can simply define <code>plusOne</code> as</p>\n\n<pre><code>&gt;&gt;&gt; plusOne = let f = getThree . fmap (+1) . Three in fmap (fmap f)\n</code></pre>\n\n<p>where <code>f</code> is a function that wraps a 3-tuple, maps <code>(+1)</code> over each element, and unwraps the result. This gets mapped over your list of lists:</p>\n\n<pre><code>&gt; x = [[(1, 2, 3), (4,5,6)], [(7,8,9)]]\n&gt; plusOne x\n[[(2,3,4),(5,6,7)],[(8,9,10)]]\n</code></pre>\n\n<hr>\n\n<p>You can also use <code>Data.Functor.Compose</code> to eliminate one of the levels of <code>fmap</code> (or, at least hide it behind another set of names to break up the monotony):</p>\n\n<pre><code>&gt; getCompose . fmap (getThree . fmap (+1) . Three) . Compose $ x\n[[(2,3,4),(5,6,7)],[(8,9,10)]]\n</code></pre>\n\n<p>We've applied the same pattern of wrapping/fmaping/unwrapping twice. We can abstract that away with a helper function</p>\n\n<pre><code>-- wrap, map, and unwrap\nwmu pre post f = post . fmap f . pre\n\nplusOne = wmu Compose getCompose $ wmu Three getThree $ (+1)\n</code></pre>\n\n<hr>\n\n<p>One might notice a similarity between <code>wmu</code> and <code>dimap</code> (specialized to <code>(-&gt;)</code>):</p>\n\n<pre><code>wmu pre post = dimap pre post . fmap\n</code></pre>\n\n<hr>\n\n<p>Everything is even simpler if you can replace the generic tuple with a custom product type in the first place.</p>\n\n<pre><code>data Triplet a = Triplet a a a\n\n-- Can be derived as well\ninstance Functor Triplet where\n    fmap f (Triplet x y z) = Triplet (f x) (f y) (f z)\n\nplusOne :: [[Triplet Int]] -&gt; [[Triplet Int]]\nplusOne = fmap (fmap (fmap (+1)))\n</code></pre>\n"}], "owner": {"reputation": 1004, "user_id": 1692517, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/893889b69fb20b6f02e3cb7a182e1c47?s=128&d=identicon&r=PG", "display_name": "user1692517", "link": "https://stackoverflow.com/users/1692517/user1692517"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 615, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1539378057, "creation_date": 1539325422, "last_edit_date": 1539330083, "question_id": 52773470, "link": "https://stackoverflow.com/questions/52773470/iterating-through-a-list-of-lists-of-3-tuples-in-haskell", "title": "Iterating through a list of lists of 3-tuples in Haskell", "body": "<p><code>plusOne :: [[(Int, Int, Int)]] -&gt; [[(Int, Int, Int)]]</code></p>\n\n<p>Given a list of lists of 3-tuples.\nIf I want to iterate through the list and +1 to the Int values, how should I approach this? I'm not sure if this is a scenario where Maps should be used or not.</p>\n\n<p>Can someone point me into the right direction?</p>\n"}, {"tags": ["haskell", "typeclass", "newtype"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 6, "creation_date": 1539318659, "post_id": 52772147, "comment_id": 92466528, "body": "<code>instance (Num a, TooMany a) =&gt; TooMany (a, a)</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 1, "last_activity_date": 1539352150, "creation_date": 1539352150, "answer_id": 52780957, "question_id": 52772147, "link": "https://stackoverflow.com/questions/52772147/how-to-add-typeclass-constraints-to-a-newtype-expression/52780957#52780957", "title": "How to add typeclass constraints to a newtype expression?", "body": "<p>The minimal change would be like this:</p>\n\n<pre><code>instance (Num a, Ord a, TooMany a) =&gt; TooMany (a, a) where\n    tooMany (t1, t2) = (t1 + t2) &gt; 44\n</code></pre>\n\n<p>Two notes about this instance: I had to add an <code>Ord</code> constraint because of the call to <code>(&gt;)</code>, and the <code>TooMany</code> constraint is redundant because the implementation does not call <code>tooMany</code> with an <code>a</code> as an argument. I suspect the intended exercise solution has a slightly different implementation of the <code>tooMany</code> method -- I encourage you to try to find a way to implement this using the <code>TooMany a</code> constraint and without using the <code>Ord a</code> constraint!</p>\n\n<p>For your <code>newtype</code>, the correct syntax is this:</p>\n\n<pre><code>newtype YetAnotherTooMany a = YetAnotherTooMany (a, a)\n    deriving (Eq, Show, TooMany)\n</code></pre>\n\n<p>You would need to delete the <code>(Int, Int)</code> instance of <code>TooMany</code> for this exact syntax to work, as otherwise there are overlapping instances to choose during deriving. However, I expect the intended exercise solution is to write the instance yourself for this <code>newtype</code> under the assumption that the <code>(a, a)</code> instance does not exist at all -- since presumably the goal is to learn how to use <code>newtype</code> to avoid overlapping instance problems in the first place.</p>\n"}], "owner": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "accepted_answer_id": 52780957, "answer_count": 1, "score": 2, "last_activity_date": 1539352150, "creation_date": 1539317375, "last_edit_date": 1539318410, "question_id": 52772147, "link": "https://stackoverflow.com/questions/52772147/how-to-add-typeclass-constraints-to-a-newtype-expression", "title": "How to add typeclass constraints to a newtype expression?", "body": "<p>I am reading the book <em>Haskell Programming from First Principles</em> and there is an exercise in the <code>newtype</code> chapter, asking me to make a <code>TooMany</code> instance for <code>(Num a, TooMany a) =&gt; (a, a)</code>.</p>\n\n<p>The exercises before this one have already made <code>TooMany</code> instances for <code>Int</code>, <code>Goats Int</code>, <code>(Int, String)</code> and <code>(Int, Int)</code>. I have done these ones but not for <code>(Num a, TooMany a) =&gt; (a, a)</code>.</p>\n\n<p>All codes follows:</p>\n\n<pre><code>{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n{-# LANGUAGE FlexibleInstances #-}\n\nclass TooMany a where\n  tooMany :: a -&gt; Bool\n\ninstance TooMany Int where\n  tooMany n = n &gt; 42\n\nnewtype Goats = Goats Int deriving (Eq, Show, TooMany)\n\n-- the following needs FlexibleInstances pragma\ninstance TooMany (Int, String) where\n  tooMany (n, _) = n &gt; 33\n\n-- or do this:\nnewtype AnotherTooMany = AnotherTooMany (Int, String) deriving (Eq, Show, TooMany)\n\ninstance TooMany (Int, Int) where\n  tooMany (n, m) = (n + m) &gt; 44\n\n\n-- THE FOLLOWING ONES ARE NOT CORRECT !!!\n\ninstance TooMany (Num a, TooMany a) =&gt; (a, a) where\n  tooMany (t1, t2) = (t1 + t2) &gt; 44\n\nnewtype YetAnotherTooMany =\n  YetAnotherTooMany (Num a, TooMany a) =&gt; (a, a)\n  deriving (Eq, Show, TooMany)\n</code></pre>\n\n<p>How should I change the last two expressions to make them work?</p>\n\n<p>I also referred to the following questions, but still not found an answer:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/12397751/adding-class-constraints-to-typeclass-instance\">Adding class constraints to typeclass instance</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/43444170/can-a-typeclass-constraint-be-used-in-a-newtype-definition\">Can a typeclass constraint be used in a newtype definition?</a></p>\n"}, {"tags": ["haskell", "types", "literals"], "comments": [{"owner": {"reputation": 194, "user_id": 10322433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ouTTb.png?s=128&g=1", "display_name": "blueheart", "link": "https://stackoverflow.com/users/10322433/blueheart"}, "edited": false, "score": 1, "creation_date": 1539313705, "post_id": 52771596, "comment_id": 92465464, "body": "<a href=\"https://stackoverflow.com/questions/34974872/what-does-num-a-a-mean-in-haskell-type-system\" title=\"what does num a a mean in haskell type system\">stackoverflow.com/questions/34974872/&hellip;</a> not what you asked but somewhat helpful"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1539332392, "post_id": 52771596, "comment_id": 92472232, "body": "Note that the types of literals are exactly what you got above: some of these are polymorphic values, which will fit any suitable type. If <code>1</code> was an <code>Int</code>, then we couldn&#39;t do <code>x+1</code> when <code>x::Double</code>, and we would need to resort to an explicit numeric conversion (there is no &quot;numeric promotion&quot; in Haskell). If you really want an int <code>1</code>, use <code>(1 :: Int)</code> instead; otherwise, let <code>1</code> adapt to the type required by the context."}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 5, "last_activity_date": 1539322916, "creation_date": 1539322916, "answer_id": 52772955, "question_id": 52771596, "link": "https://stackoverflow.com/questions/52771596/how-to-determine-the-type-of-literal-in-haskell/52772955#52772955", "title": "How to determine the type of literal in Haskell?", "body": "<p>You can ask ghci to default the type variables:</p>\n\n<pre><code>$ ghci\n\u03bb&gt; let x = 3\n\u03bb&gt; :type x\nx :: Num p =&gt; p\n\u03bb&gt; :type +d x\nx :: Integer\n\u03bb&gt; :type +d 1\n1 :: Integer\n\u03bb&gt; :type +d 1.0\n1.0 :: Double\n</code></pre>\n\n<p>The <code>:type +d</code> will make ghci to chose the default types for the type variables. Also, this is the general Haskell defaulting rule:</p>\n\n<pre><code>default Num Integer\ndefault Real Integer\ndefault Enum Integer\ndefault Integral Integer\ndefault Fractional Double\ndefault RealFrac Double\ndefault Floating Double\ndefault RealFloat Double\n</code></pre>\n\n<p>You can learn more <a href=\"https://kseo.github.io/posts/2017-01-04-type-defaulting-in-haskell.html\" rel=\"noreferrer\">about it here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 5, "last_activity_date": 1539333153, "creation_date": 1539333153, "answer_id": 52775423, "question_id": 52771596, "link": "https://stackoverflow.com/questions/52771596/how-to-determine-the-type-of-literal-in-haskell/52775423#52775423", "title": "How to determine the type of literal in Haskell?", "body": "<p>If you write <code>1</code>, it has <em>any possible number type</em>. That's what <code>Num p =&gt; p</code> actually means.</p>\n\n<p>If you use <code>1</code> in an expression, GHCi will attempt to figure out the correct type of number to use based on what functions you're calling on it, and then automatically give <code>1</code> the right type.</p>\n\n<p>If GHCi cannot guess what the correct type is (because there's not enough context or because several types would fit), it <em>defaults</em> to <code>Integer</code>. (And for <code>1.0</code> it will default to <code>Double</code>. And for any other type constraint, it will try to default to <code>()</code> if possible.)</p>\n\n<p>This is similar to how compiled code works. If you write a number in your source code, GHC (the compiler) will attempt to auto-detect what the correct type should be. The difference is, if <em>the compiler</em> can't figure it out, it <em>won't</em> \"guess\" or \"default\", it'll just give you a compile-time error and demand that you specify what you mean. That's desirable to make compiled code work how you expected, but it's tedious for interactively trying stuff out, which is why GHCi has defaulting.</p>\n\n<p>The type of a single character is <em>always</em> <code>Char</code>.</p>\n\n<p>The type of a string is <em>always</em> <code>String</code> or <code>[Char]</code>. (One is an alias to the other.)</p>\n\n<p>The type of <code>True</code> and <code>False</code> is <em>always</em> <code>Bool</code>. And so on.</p>\n\n<p>So it's only really numbers that have the possibility of multiple types.</p>\n\n<p>[Well, there's an option to make strings polymorphic too, but we won't worry about that now...]</p>\n\n<p>If you want messy details, you can read the Haskell Language Report (which is the official specification document that defines the Haskell language) and the GHCi user manual (which describes what GHCi does).</p>\n"}], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 564, "favorite_count": 0, "accepted_answer_id": 52772955, "answer_count": 2, "score": 2, "last_activity_date": 1539333153, "creation_date": 1539313333, "question_id": 52771596, "link": "https://stackoverflow.com/questions/52771596/how-to-determine-the-type-of-literal-in-haskell", "title": "How to determine the type of literal in Haskell?", "body": "<p>When I test the type of literal in GHCi, I find</p>\n\n<pre><code>Prelude&gt; :t 1\n1 :: Num p =&gt; p\n\nPrelude&gt; :t 'c'    \n'c' :: Char\n\nPrelude&gt; :t \"string\"    \n\"string\" :: [Char]\n\nPrelude&gt; :t 1.0\n1.0 :: Fractional p =&gt; p\n</code></pre>\n\n<p>The problem is how does Haskell to determine the type of such literal? where can I find the information about that?</p>\n\n<p>Furthermore, Are there exist any way to change the way of GHC to interpret the type of literal? </p>\n\n<p>For example:</p>\n\n<pre><code> -- do something\n\n :t 1\n 1 :: Int      -- interprets 1 as Int rather then Num p =&gt; p\n\n :t 1.0\n 1.0 :: Double -- interprets 1.0 as Double rather then Fractional p =&gt; p \n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7503333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a82d116fb2392f0115b6d9bfc75ba44?s=128&d=identicon&r=PG&f=1", "display_name": "user7503333", "link": "https://stackoverflow.com/users/7503333/user7503333"}, "edited": false, "score": 0, "creation_date": 1539564652, "post_id": 52770117, "comment_id": 92534921, "body": "Can I ask one more thing ? How can I concatenate names like &quot;Ben Joy Hellen&quot;"}], "tags": [], "owner": {"reputation": 194, "user_id": 10322433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ouTTb.png?s=128&g=1", "display_name": "blueheart", "link": "https://stackoverflow.com/users/10322433/blueheart"}, "is_accepted": true, "score": 0, "last_activity_date": 1539299919, "creation_date": 1539299919, "answer_id": 52770117, "question_id": 52769921, "link": "https://stackoverflow.com/questions/52769921/how-to-split-element-of-custom-data-type/52770117#52770117", "title": "How to split element of custom Data type", "body": "<pre><code>total :: [Person] -&gt; Int\ntotal [] = 0\ntotal (x:xs) = getAge x where\n      getAge (Name _ age _ ) = age + total xs\n</code></pre>\n\n<p>You need to use a list of the Person type. This will return the total age of all elements in the list.</p>\n"}], "owner": {"reputation": 21, "user_id": 7503333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a82d116fb2392f0115b6d9bfc75ba44?s=128&d=identicon&r=PG&f=1", "display_name": "user7503333", "link": "https://stackoverflow.com/users/7503333/user7503333"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 52770117, "answer_count": 1, "score": -3, "last_activity_date": 1539302847, "creation_date": 1539298173, "last_edit_date": 1539302847, "question_id": 52769921, "link": "https://stackoverflow.com/questions/52769921/how-to-split-element-of-custom-data-type", "title": "How to split element of custom Data type", "body": "<p>I am a newbie to haskell. </p>\n\n<p>I am quite confused of custom data type </p>\n\n<p>So what I want to make it is to show total age of person and each person's name and age </p>\n\n<p>so I expects it looks like this </p>\n\n<pre><code>Detail \"Ben\" 20 Student\n       \"Joy\" 25 Police\n       \"Hellen\" 10 Student\nTotal   55 -- 20 + 25 + 10 \n</code></pre>\n\n<p>So this is my code </p>\n\n<pre><code> data Person = Name String Int Job deriving Show -- name age Job\n data Det = Total Int | Detail String Int Job deriving Show -- age | name age Job\n data Job = Police | Student deriving Show \n\n\nSplit :: Person -&gt; Int -- Need to get eacn age to accumulate one another for total age \nSplit (Name _ age _ ) = age\n\ncheck1 :: [Person] -&gt; Det -- Need to sum all the age with Split function \n......?\n</code></pre>\n"}, {"tags": ["haskell", "ghc", "haskell-stack"], "comments": [{"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "edited": false, "score": 0, "creation_date": 1539313512, "post_id": 52767320, "comment_id": 92465431, "body": "Are you already passing the argument <code>-j1</code> (or <code>stack.yaml</code> <code>jobs: 1</code>)?"}, {"owner": {"reputation": 1227, "user_id": 5053374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe57f0998df065470ff42c938f781cf?s=128&d=identicon&r=PG", "display_name": "Libby", "link": "https://stackoverflow.com/users/5053374/libby"}, "reply_to_user": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "edited": false, "score": 0, "creation_date": 1539313971, "post_id": 52767320, "comment_id": 92465508, "body": "@bergey no, just <code>stack build</code>"}, {"owner": {"reputation": 1227, "user_id": 5053374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe57f0998df065470ff42c938f781cf?s=128&d=identicon&r=PG", "display_name": "Libby", "link": "https://stackoverflow.com/users/5053374/libby"}, "reply_to_user": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "edited": false, "score": 1, "creation_date": 1539317992, "post_id": 52767320, "comment_id": 92466333, "body": "@bergey omg <code>stack build -j1</code> worked. THANK YOU"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1539336509, "post_id": 52767320, "comment_id": 92474627, "body": "So how about you self-answer and accept the question?"}, {"owner": {"reputation": 1227, "user_id": 5053374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe57f0998df065470ff42c938f781cf?s=128&d=identicon&r=PG", "display_name": "Libby", "link": "https://stackoverflow.com/users/5053374/libby"}, "edited": false, "score": 0, "creation_date": 1539351203, "post_id": 52767320, "comment_id": 92482694, "body": "Well, it turns out it <i>was</i> a duplicate of that other question, and I just missed the <code>-j1</code> part... So I&#39;ll flag myself instead. XD"}], "owner": {"reputation": 1227, "user_id": 5053374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe57f0998df065470ff42c938f781cf?s=128&d=identicon&r=PG", "display_name": "Libby", "link": "https://stackoverflow.com/users/5053374/libby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 514, "favorite_count": 1, "closed_date": 1539357801, "answer_count": 0, "score": 5, "last_activity_date": 1539293645, "creation_date": 1539285066, "last_edit_date": 1539292996, "question_id": 52767320, "link": "https://stackoverflow.com/questions/52767320/running-out-of-memory-while-compiling-with-ghc", "closed_reason": "Duplicate", "title": "Running out of memory while compiling with GHC", "body": "<p>I recently upgraded my app to GHC 8.4 and I'm attempting to deploy the app to production. Unfortunately, when I try to compile the app on the continuous integration server, it runs out of memory every time. (This app has been compiling on this same service without problems for years.) Is there any way to configure GHC/Stack to make compilation use fewer resources? It's okay if it makes compilation slower.</p>\n\n<p>For context, here is where the compiler crashes:</p>\n\n<pre><code>Progress 171/271: aeson-1.2.4.0                               aeson-1.2.4.0: copy/register\nProgress 171/271: aeson-1.2.4.0                               Progress 172/271\n\n--  While building custom Setup.hs for package Cabal-2.2.0.1 using:\n      /root/.stack/setup-exe-cache/x86_64-linux/Cabal-simple_mPHDZzAJ_2.2.0.1_ghc-8.4.3 --builddir=.stack-work/dist/x86_64-linux/Cabal-2.2.0.1 build --ghc-options \" -ddump-hi -ddump-to-file -fdiagnostics-color=always\"\n    Process exited with code: ExitFailure (-9) (THIS MAY INDICATE OUT OF MEMORY)\n</code></pre>\n\n<p>ETA: This question has been flagged as duplicate of <a href=\"https://stackoverflow.com/questions/46147137/cabal-install-criterion-out-of-memory\">Cabal install criterion out of memory</a>, but unfortunately that solution doesn't help me. If I change <code>stack build</code> to <code>stack build --ghc-options '+RTS -M1500M -RTS'</code>, that only seems to make the crash happen slightly earlier:</p>\n\n<pre><code>Cabal-2.2.0.1: copy/register\nProgress 171/271: Cabal-2.2.0.1                               Progress 172/271\n\n--  While building custom Setup.hs for package tzdata-0.1.20180501.0 using:\n      /root/.stack/setup-exe-cache/x86_64-linux/Cabal-simple_mPHDZzAJ_2.2.0.1_ghc-8.4.3 --builddir=.stack-work/dist/x86_64-linux/Cabal-2.2.0.1 build --ghc-options \" -ddump-hi -ddump-to-file -fdiagnostics-color=always\"\n    Process exited with code: ExitFailure (-9) (THIS MAY INDICATE OUT OF MEMORY)\n</code></pre>\n"}, {"tags": ["json", "parsing", "haskell", "aeson"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1539272722, "post_id": 52763829, "comment_id": 92451147, "body": "The derived instance probably expects a single object with 11 keys, not a 1-key object whose value has 10 fields."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1539273614, "post_id": 52763829, "comment_id": 92451696, "body": "Also, the derived field names are your accessors (like <code>quote</code>, <code>symbol</code>, etc), not the actual JSON keys like &#39;&quot;Global Quote&quot;&#39; and &#39;&quot;01. symbol&quot;&#39;. You&#39;ll need to write your instances by hand."}, {"owner": {"reputation": 1915, "user_id": 2682729, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PZlkg.gif?s=128&g=1", "display_name": "typesanitizer", "link": "https://stackoverflow.com/users/2682729/typesanitizer"}, "edited": false, "score": 0, "creation_date": 1539277618, "post_id": 52763829, "comment_id": 92453644, "body": "Some fields don&#39;t have proper types. For example, the prices are double-quoted strings in your JSON example, whereas numbers (<code>Float</code>) are encoded without double-quotes in JSON. Have you tried writing a decoder by hand?"}], "answers": [{"tags": [], "owner": {"reputation": 2578, "user_id": 395863, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d694caab02e48b350c52fda041cc75cf?s=128&d=identicon&r=PG", "display_name": "Raveline", "link": "https://stackoverflow.com/users/395863/raveline"}, "is_accepted": true, "score": 4, "last_activity_date": 1539282436, "creation_date": 1539282436, "answer_id": 52766730, "question_id": 52763829, "link": "https://stackoverflow.com/questions/52763829/haskell-aeson-getting-nothing-when-trying-to-decode-json-url-req/52766730#52766730", "title": "Haskell - Aeson : Getting &quot;Nothing&quot; when trying to decode JSON URL Req", "body": "<p>First off: Aeson is <em>not the easiest library for a beginner</em>. There are more difficult ones, sure, but it supposes you already a fair number of things about the language. You didn't pick the \"simplest task\" to begin with. I know this can be surprising, and you might think that parsing JSON should be simple, but parsing JSON with strong type guarantees is actually not that simple.</p>\n\n<p>But here's what I can tell you to help you a bit:</p>\n\n<ul>\n<li><p>First, use <code>eitherDecode</code> rather than <code>decode</code>: you will get an error message rather than simply <code>Nothing</code>, which will help you a bit.</p></li>\n<li><p>Deriving through <code>Generic</code> is neat and very often, a time saver, but it's not magic either. The name of the object key and the name of your datatype fields have to match exactly. Sadly, this is not the case here and due to haskell syntax, you couldn't name your fields like the keys of the object. Your best solution is to implement FromJSON manually (see the recommended link below). A good way to see \"what is expect\" by the generic FromJSON is to also derive ToJSON, create a dummy <code>Quote</code> and see the result of <code>encode</code>.</p></li>\n<li><p>Your first field (<code>quote</code>) is not a key of the object itself, but rather the name of this object. So you have dynamic keys (\"Global Quote\" being one here). Once again, this typically a case where you want to write the FromJSON instance manually.</p></li>\n</ul>\n\n<p>I recommend you read this famous <a href=\"https://artyom.me/aeson\" rel=\"nofollow noreferrer\">tutorial written by Artyom Kazak</a> on Aeson. This will help you tremendously and is probably the best advice I can give.</p>\n\n<p>For your manual instance, supposing it was <em>exactly</em> the document you want to parse and you had only the \"Global Quote\" to deal with, it would look more or less like this:</p>\n\n<pre><code>instance ToJSON Quote where\n  parseJSON = withObject \"Document\" $\n    \\d -&gt; do\n        glob &lt;- d .: \"Global Quote\"\n        withObject \"Quote\" v (\\gq -&gt;\n          Quote &lt;$&gt; gq .: \"01. symbol\"\n                &lt;*&gt; pure \"Global Quote\"\n                &lt;*&gt; gq .: \"02. open\"\n                &lt;*&gt; gq .: \"03. high\"\n          -- ... and so on\n         ) v\n</code></pre>\n\n<p>(It's not the most pretty way, nor the best way, to write it, but it should be one possible way).</p>\n\n<p>Also note that, as an astute commenter wrote, the types of your fields are not always aligned with the type of your example JSON document. \"volume\" is an <code>Int</code> (byte-limited int), potentially an <code>Integer</code> (\"mathematical\" integer, no bound), but not a <code>Float</code>. Your \"ltd\" can be parsed a string - but it probably should be a date (<code>Day</code> from <code>Data.Time</code> would be the first choice - it already has a <code>FromJSON</code> instance so chances are it should be parseable as is). Change percent is most likely not parseable as Float like that, you'll need to write a dedicated parser for this type (and decide how you want to store it - <code>Ratio</code> is a potential solution).</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "is_accepted": false, "score": 1, "last_activity_date": 1539611348, "creation_date": 1539611348, "answer_id": 52818245, "question_id": 52763829, "link": "https://stackoverflow.com/questions/52763829/haskell-aeson-getting-nothing-when-trying-to-decode-json-url-req/52818245#52818245", "title": "Haskell - Aeson : Getting &quot;Nothing&quot; when trying to decode JSON URL Req", "body": "<p>@Raveline with their answer above pointed me to the right direction. I was able to solve all those issues, here's the final product!</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric     #-}\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE RecordWildCards   #-}\n\nmodule Test where\n\nimport           Data.Aeson\nimport qualified Data.ByteString.Lazy as B\nimport           GHC.Exts\nimport           GHC.Generics\nimport           Network.HTTP.Conduit (simpleHttp)\n\njsonURL :: String\njsonURL = \"https://www.alphavantage.co/query?function=GLOBAL_QUOTE&amp;symbol=MSFT&amp;apikey=demo\"\n\ngetJSON :: IO B.ByteString\ngetJSON = simpleHttp jsonURL\n\ndata Quote = Quote {\n                   symbol        :: String,\n                   open          :: String,\n                   high          :: String,\n                   low           :: String,\n                   price         :: String,\n                   volume        :: String,\n                   ltd           :: String,\n                   previousClose :: String,\n                   change        :: String,\n                   changePercent :: String\n                   } deriving (Show, Generic)\n\n\ninstance FromJSON Quote where\n  parseJSON = withObject \"Global Quote\" $\n    \\o -&gt; do\n      globalQuote   &lt;- o           .: \"Global Quote\"\n      symbol        &lt;- globalQuote .: \"01. symbol\"\n      open          &lt;- globalQuote .: \"02. open\"\n      high          &lt;- globalQuote .: \"03. high\"\n      low           &lt;- globalQuote .: \"04. low\"\n      price         &lt;- globalQuote .: \"05. price\"\n      volume        &lt;- globalQuote .: \"06. volume\"\n      ltd           &lt;- globalQuote .: \"07. latest trading day\"\n      previousClose &lt;- globalQuote .: \"08. previous close\"\n      change        &lt;- globalQuote .: \"09. change\"\n      changePercent &lt;- globalQuote .: \"10. change percent\"\n      return Quote {..}\n\n\nmain :: IO ()\nmain = do\n  d &lt;- (eitherDecode &lt;$&gt; getJSON) :: IO (Either String Quote)\n  case d of\n    Left e   -&gt; print e\n    Right qt -&gt; print (read (price qt) :: Float)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "accepted_answer_id": 52766730, "answer_count": 2, "score": 2, "last_activity_date": 1539611400, "creation_date": 1539271798, "last_edit_date": 1539611400, "question_id": 52763829, "link": "https://stackoverflow.com/questions/52763829/haskell-aeson-getting-nothing-when-trying-to-decode-json-url-req", "title": "Haskell - Aeson : Getting &quot;Nothing&quot; when trying to decode JSON URL Req", "body": "<p>I'm relatively new to haskell and right now I'm trying to get a deeper understanding and trying to get used to different popular libraries.</p>\n\n<p>Right now I'm trying \"aeson\".</p>\n\n<p>What I want to do is parse MSFT quote request from <a href=\"https://www.alphavantage.co/query?function=GLOBAL_QUOTE&amp;symbol=MSFT&amp;apikey=demo\" rel=\"nofollow noreferrer\">https://www.alphavantage.co/query?function=GLOBAL_QUOTE&amp;symbol=MSFT&amp;apikey=demo</a></p>\n\n<p>This is what it looks like </p>\n\n<pre><code>{\n    \"Global Quote\": {\n        \"01. symbol\": \"MSFT\",\n        \"02. open\": \"105.3500\",\n        \"03. high\": \"108.2400\",\n        \"04. low\": \"105.2700\",\n        \"05. price\": \"107.6000\",\n        \"06. volume\": \"23308066\",\n        \"07. latest trading day\": \"2018-10-11\",\n        \"08. previous close\": \"106.1600\",\n        \"09. change\": \"1.4400\",\n        \"10. change percent\": \"1.3564%\"\n    }\n}\n</code></pre>\n\n<p>This is what I've got so far</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric     #-}\n{-# LANGUAGE OverloadedStrings #-}\n\nimport           Data.Aeson\nimport qualified Data.ByteString.Lazy as B\nimport           GHC.Exts\nimport           GHC.Generics\nimport           Network.HTTP\nimport           Network.URI\n\njsonURL :: String\njsonURL = \"http://www.alphavantage.co/query?function=GLOBAL_QUOTE&amp;symbol=MSFT&amp;apikey=demo\"\n\ngetRequest_ :: HStream ty =&gt; String -&gt; Request ty\ngetRequest_ s = let Just u = parseURI s in defaultGETRequest_ u\n\njsonReq = getRequest_ jsonURL\n\ndata Quote = Quote {quote         :: String,\n                    symbol        :: String,\n                    open          :: Float,\n                    high          :: Float,\n                    low           :: Float,\n                    price         :: Float,\n                    volume        :: Float,\n                    ltd           :: String,\n                    previousClose :: Float,\n                    change        :: Float,\n                    changePerct   :: Float\n                   } deriving (Show, Generic)\n\ninstance FromJSON Quote\ninstance ToJSON Quote\n\n\nmain :: IO ()\nmain = do\n  d &lt;- simpleHTTP jsonReq\n  body &lt;- getResponseBody d\n  print (decode body :: Maybe Quote)\n</code></pre>\n\n<p>What am I doing wrong?</p>\n\n<p>Edit: Fixed version in the answers.</p>\n"}, {"tags": ["haskell", "conduit"], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 0, "last_activity_date": 1539274674, "creation_date": 1539274674, "answer_id": 52764704, "question_id": 52760961, "link": "https://stackoverflow.com/questions/52760961/lifting-the-monad-io-in-conduitt-on-resourcet/52764704#52764704", "title": "Lifting the monad IO in ConduitT on ResourceT", "body": "<p>How about <code>transPipe</code>: <a href=\"https://hackage.haskell.org/package/conduit-1.3.1/docs/Data-Conduit.html#v:transPipe\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/conduit-1.3.1/docs/Data-Conduit.html#v:transPipe</a></p>\n\n<pre><code>transPipe :: Monad m =&gt; (forall a. m a -&gt; n a) -&gt; ConduitT i o m r -&gt; ConduitT i o n r\n\ntransPipe liftIO :: ConduitT i o IO r -&gt; ConduitT i o (ResourceT IO) r\n</code></pre>\n"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1539280696, "creation_date": 1539263550, "last_edit_date": 1539280696, "question_id": 52760961, "link": "https://stackoverflow.com/questions/52760961/lifting-the-monad-io-in-conduitt-on-resourcet", "title": "Lifting the monad IO in ConduitT on ResourceT", "body": "<p>I'm trying to use the function MergeSources in <a href=\"https://github.com/cgaebel/stm-conduit/blob/4795394071752085c33b9e17458d041b787dee49/Data/Conduit/TMChan.hs\" rel=\"nofollow noreferrer\">stm-conduit</a> which has the following signature : </p>\n\n<pre><code>mergeSources :: (MonadResource mi, MonadIO mo, MonadUnliftIO mi)\n             =&gt; [ConduitT () a mi ()] -- ^ The sources to merge.\n             -&gt; Int -- ^ The bound of the intermediate channel.\n             -&gt; mo (ConduitT () a mi ())    \n</code></pre>\n\n<p>I have sources based on IO directly, and I don't know how to move on this mi Monad which I believe ResourceT is the candidate : </p>\n\n<p>so I have sources with the following signature :</p>\n\n<pre><code>ConduitT () (Connection,WorkspaceId) IO ()\n</code></pre>\n\n<p>and I would like this signature instead : </p>\n\n<pre><code>ConduitT () (Connection,WorkspaceId) (ResourceT IO) ()\n</code></pre>\n\n<p>despite the fact I have no resource to handle in these actions (I have a connection but it's global, that's what they recommend...), I give you an example of the function I want to use </p>\n\n<pre><code>streamAllWorkspaceAlreadyCreated :: Connection -&gt; ConduitT () (Connection,WorkspaceId) IO ()\nstreamAllWorkspaceAlreadyCreated  eventStoreConnection = do\n    yield eventStoreConnection\n    .| WorkspaceStream.streamAll\n    .| WorkspaceStream.discardCorruptedStreams\n    .| mapC (\\workSpaceId -&gt; (eventStoreConnection,workSpaceId))\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1539257083, "post_id": 52758799, "comment_id": 92440790, "body": "<code>addExFunction input</code> does not return an <code>IO ...</code>, so you can not add this as last line (since other actions are <code>IO</code> in this do-block). You can for example use <code>print (addExFunction input)</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1539263317, "post_id": 52758799, "comment_id": 92444715, "body": "Strictly speaking, <code>return (addExFunction input)</code> would type check, although an <code>IO</code> action that doesn&#39;t actually have a side effect wouldn&#39;t be very useful."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 9, "last_activity_date": 1539257044, "creation_date": 1539257044, "answer_id": 52758847, "question_id": 52758799, "link": "https://stackoverflow.com/questions/52758799/haskell-error-couldnt-match-type-with-io/52758847#52758847", "title": "Haskell: Error: Couldn&#39;t match type \u2018[]\u2019 with \u2018IO\u2019", "body": "<p><code>addExFunction input</code> is a <code>String</code>. In the main <code>do</code> block, you need to use IO actions instead. What do you want to do with the string? If you want to print it, say so:</p>\n\n<pre><code>main = do\n   ...\n   putStrLn (addExFunction input)\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 10448841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ee631428bfbd476b1ab1c60d534e084?s=128&d=identicon&r=PG&f=1", "display_name": "Maqruis1", "link": "https://stackoverflow.com/users/10448841/maqruis1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "accepted_answer_id": 52758847, "answer_count": 1, "score": 0, "last_activity_date": 1539257044, "creation_date": 1539256867, "question_id": 52758799, "link": "https://stackoverflow.com/questions/52758799/haskell-error-couldnt-match-type-with-io", "title": "Haskell: Error: Couldn&#39;t match type \u2018[]\u2019 with \u2018IO\u2019", "body": "<p>I'm writing a simple Haskell program that adds an exclamation mark ! to the end of an inputted string by the user. However my program won't run. This is my code:</p>\n\n<pre><code>addExFunction :: String -&gt; String\naddExFunction x = x ++ \"!\"\n\nmain = do\n putStrLn \"enter string: \"\n input &lt;- getLine\n addExFunction input\n</code></pre>\n\n<p>This is what my error looks like:  </p>\n\n<pre><code>a.hs:7:2: error:\n    \u2022 Couldn't match type \u2018[]\u2019 with \u2018IO\u2019\n      Expected type: IO Char\n        Actual type: String\n    \u2022 In a stmt of a 'do' block: addExFunction input\n      In the expression:\n        do putStrLn \"enter string: \"\n           input &lt;- getLine\n           addExFunction input\n      In an equation for \u2018main\u2019:\n          main\n            = do putStrLn \"enter string: \"\n                 input &lt;- getLine\n                 addExFunction input\n  |\n7 |  addExFunction input\n  |  ^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>I am new to Haskell. How do I fix this error? Thank you.</p>\n"}, {"tags": ["haskell", "types", "match"], "answers": [{"tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": true, "score": 4, "last_activity_date": 1539256431, "creation_date": 1539256431, "answer_id": 52758664, "question_id": 52758527, "link": "https://stackoverflow.com/questions/52758527/cant-match-expected-type-with-actual-type-haskell/52758664#52758664", "title": "Can&#39;t match expected type with actual type, Haskell", "body": "<p>Just get rid of the parentheses and comma:</p>\n\n<pre><code>terna x y = (x, y, (sqrt ((x*x)+ (y*y))))\n</code></pre>\n\n<p>Function application in Haskell is done with spaces, not parentheses and commas as in most other languages. In particular, the compiler is interpreting <code>(x, y)</code> as a pair (tuple with 2 values), hence the type error you see.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 4, "last_activity_date": 1539262584, "last_edit_date": 1539262584, "creation_date": 1539256936, "answer_id": 52758815, "question_id": 52758527, "link": "https://stackoverflow.com/questions/52758527/cant-match-expected-type-with-actual-type-haskell/52758815#52758815", "title": "Can&#39;t match expected type with actual type, Haskell", "body": "<p>Take a look at the head of the function:</p>\n\n<pre><code>terna <b>(x, y)</b> = ...</code></pre>\n\n<p>This is the pattern of a 2-tuple, not of a function with two parameters (note that strictly speaking, functions have <em>one</em> parameter, here we thus construct a function with one parameter, that generates a function that then takes the other parameter, but Haskell provides a more convenient syntax for this).</p>\n\n<p>As a result the signature of your function is:</p>\n\n<pre><code>terna :: <b>(Double, Double)</b> -&gt; (Double, Double, Double)\nterna (x, y) = (x, y, sqrt (x*x + y*y))</code></pre>\n\n<p>But typically in Haskell, functions are \"<em>curried</em>\", so it makes more sense to write it like:</p>\n\n<pre><code>terna :: <b>Double -&gt; Double</b> -&gt; (Double, Double, Double)\nterna <b>x y</b> = (x, y, sqrt (x*x + y*y))</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10489304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40fd5cc6c931748a405c2d86ad79fb09?s=128&d=identicon&r=PG&f=1", "display_name": "Grard", "link": "https://stackoverflow.com/users/10489304/grard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 52758664, "answer_count": 2, "score": 0, "last_activity_date": 1539262584, "creation_date": 1539256003, "question_id": 52758527, "link": "https://stackoverflow.com/questions/52758527/cant-match-expected-type-with-actual-type-haskell", "title": "Can&#39;t match expected type with actual type, Haskell", "body": "<p>I've got this error <em>Couldn't match expected type <code>Double -&gt; (Double, Double, Double)' with actual type</code>(Double, Double, Double)</em>\nwhich I don't know how to fix, I've been struggling with this for some days with different errors and now I think I have it, just need that to get fixed, this is my code:</p>\n\n<p><code>terna :: Double -&gt; Double -&gt; (Double, Double, Double)\n terna (x, y) = (x, y, (sqrt ((x*x)+ (y*y))))</code></p>\n\n<p>It's simple yet I'm just starting with Haskell and find many rocks on my path due to being new to functional programming. Thank you.</p>\n"}, {"tags": ["haskell", "type-conversion"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1539245382, "post_id": 52755214, "comment_id": 92433659, "body": "<code>div</code> is integer division, so from that point, the value is <i>gone</i>."}, {"owner": {"reputation": 13772, "user_id": 379311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c993f4f111e6ff3211ccda1b98828253?s=128&d=identicon&r=PG", "display_name": "Yann Vernier", "link": "https://stackoverflow.com/users/379311/yann-vernier"}, "edited": false, "score": 2, "creation_date": 1539256747, "post_id": 52755214, "comment_id": 92440582, "body": "It&#39;s not so obvious it should ever be a <code>Double</code>; in fact, you should probably use a <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Fixed.html#t:Centi\" rel=\"nofollow noreferrer\">Data.Fixed.Centi</a>."}], "answers": [{"comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1539252757, "post_id": 52755481, "comment_id": 92438173, "body": "I believe there&#39;s some number formatting stuff in <code>Numeric</code> (?) as well..."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1539253432, "post_id": 52755481, "comment_id": 92438613, "body": "@MathematicalOrchid: yes like <code>showHFloat</code>, but I do not really like the <code>RealFoat</code> constraint here, since then again we are in the &quot;floating point&quot; world. Especially for prices, calculating with floating points can result in summing up values to values that not completely correct."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 6, "last_activity_date": 1539251759, "last_edit_date": 1539251759, "creation_date": 1539246217, "answer_id": 52755481, "question_id": 52755214, "link": "https://stackoverflow.com/questions/52755214/haskell-convert-integer-to-double-then-string/52755481#52755481", "title": "Haskell - Convert integer to double, then String", "body": "<p><code>div</code> is <em>integer</em> division. So that means that <code>div 188 100</code>, you get:</p>\n\n<pre><code>Prelude&gt; div 188 100\n1\n</code></pre>\n\n<p>So that means that after the <code>div</code>, the <code>88</code> is \"gone\". Furthermore <code>div</code> truncates to negative infinity. As a result if the number is negative we get:</p>\n\n<pre><code>Prelude&gt; div (-210) 100\n-3\n</code></pre>\n\n<p>But you probably better do not convert the number to a <code>Float</code> anyway: <code>Float</code>s are not capable to precisely represent decimal numbers: approximations are used. For example if you write <code>0.82</code>, a value will be stored that looks like <code>0.8200000000000001</code> (although this is again not the exact representation). In case the number is rather large, the mantissa is not always capable to represent the entire number, so there can be an error in the conversion. Finally if you print small or large numbers, by default <code>show</code> will use scientific notation (this is of course not \"inherently\" a problem, but I think it is rather odd if you print a price, I've never seen a supermarket with labels like <code>$ 9e-2</code>):</p>\n\n<pre><code>Prelude&gt; 0.01 :: Float\n1.0e-2\n</code></pre>\n\n<p>Which is probably not what you want.</p>\n\n<p>You can simply split the number in three parts: the value before the decimal dot, and the two digits after the decimal dot. Like:</p>\n\n<pre><code>import Data.Char(intToDigit)\n\nformatDollars :: Price -&gt; String\nformatDollars pr = show pr0 ++ ['.', pr1, pr2]\n    where pr0 = quot pr 100\n          digit n = intToDigit (abs (rem n 10))\n          pr1 = digit (quot pr 10)\n          pr2 = digit pr\n</code></pre>\n\n<p>The <a href=\"https://hackage.haskell.org/package/Decimal\" rel=\"nofollow noreferrer\"><strong><code>Decimal</code></strong> [hackage]</a> package might also be an option. A <code>DecimalRaw</code> is represented in such a way that for the <em>decimal</em> system, it can represent numbers precisely. For example:</p>\n\n<pre><code>Prelude&gt; import Data.Decimal\nPrelude Data.Decimal&gt; Decimal 2 188\n1.88 \n</code></pre>\n\n<p>So we can avoid all the trouble, and write it like:</p>\n\n<pre><code>import Data.Decimal(DecimalRaw(Decimal))\n\nformatDollars :: Price -&gt; String\nformatDollars = show . Decimal 2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 7, "last_activity_date": 1539246222, "creation_date": 1539246222, "answer_id": 52755486, "question_id": 52755214, "link": "https://stackoverflow.com/questions/52755214/haskell-convert-integer-to-double-then-string/52755486#52755486", "title": "Haskell - Convert integer to double, then String", "body": "<pre><code>188 `div` 100 == 1\n</code></pre>\n\n<p>You want to convert to <code>Double</code> <em>before</em> doing the division. (And then do real division, not integer division.)</p>\n\n<pre><code>formatDollars x = show ((fromIntegral x) / 100)\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 10488457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e8d44864fddcc26fb7fedf9a4e43f3c?s=128&d=identicon&r=PG&f=1", "display_name": "gbm0102", "link": "https://stackoverflow.com/users/10488457/gbm0102"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1208, "favorite_count": 0, "accepted_answer_id": 52755486, "answer_count": 2, "score": 3, "last_activity_date": 1539251759, "creation_date": 1539245325, "question_id": 52755214, "link": "https://stackoverflow.com/questions/52755214/haskell-convert-integer-to-double-then-string", "title": "Haskell - Convert integer to double, then String", "body": "<p>I'm practicing Haskell by writing a program that will convert a price in cents into dollars. Obviously, this means that my Int will need to become a Double, but I want my final output to be that of a String. My code:</p>\n\n<p>First, I defined my <code>Price</code> type:</p>\n\n<p><code>type Price = Int</code></p>\n\n<p>Then, I wrote my module:</p>\n\n<pre><code>formatDollars :: Price -&gt; String\nformatDollars x = show (fromIntegral (x `div` 100))\n</code></pre>\n\n<p>My test input for <code>x</code> was 188, which should give me 1.88.</p>\n\n<p>But my output is always <code>\"1\"</code>. This makes me think that my fromIntegral function might not be utilized correctly in my code, as if it's truncating after the decimal. Since I'm so new to Haskell, I'm sure it's a  simple mistake; could someone help me out?</p>\n"}, {"tags": ["parsing", "haskell"], "comments": [{"owner": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "edited": false, "score": 0, "creation_date": 1539245947, "post_id": 52754593, "comment_id": 92433936, "body": "Your full code is missing imports it seems. Also your do-block seems to end with a <code>let</code> which is not allowed AFAIK.  Why are you using <code>Text</code> at all? There is a splitOn that works for strings in <code>Data.List.Split</code> in the split package. I don&#39;t think using read the way you do will work though."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "reply_to_user": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "edited": false, "score": 1, "creation_date": 1539251004, "post_id": 52754593, "comment_id": 92437066, "body": "@JonasDureg&#229;rd Text is definitely the right type for reading source files."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1539265699, "post_id": 52754593, "comment_id": 92446341, "body": "There are generally two approaches to parsing in Haskell: parser combinators and parser generators. Google should take you through the next few steps from there once you know these keywords. A tutorial on either tech is much too large to be a good topic for SO, I think."}, {"owner": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1539271323, "post_id": 52754593, "comment_id": 92450321, "body": "@Cubic 1) That seems a bit oversimplified. 2) This code doesn&#39;t appear to read the source file as <code>Text</code>."}, {"owner": {"reputation": 13, "user_id": 10487833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bW1dl.png?s=128&g=1", "display_name": "xnorlord", "link": "https://stackoverflow.com/users/10487833/xnorlord"}, "edited": false, "score": 0, "creation_date": 1539274520, "post_id": 52754593, "comment_id": 92452091, "body": "I am using the appropriate imports. I didn&#39;t include them, so full code is a bit misleading. I apologize. I was really looking for a way to resolve the issues between String and Text, or how to resolve the error code. From what I understood, Text is the best way to handle source files."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10487833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bW1dl.png?s=128&g=1", "display_name": "xnorlord", "link": "https://stackoverflow.com/users/10487833/xnorlord"}, "edited": false, "score": 0, "creation_date": 1539286264, "post_id": 52767146, "comment_id": 92457897, "body": "Thank you. This is exactly the sort of answer I was looking for. I am familiar with parsing, just not in Haskell. Coming from Python and C++, the handling of Data Types is my biggest impasse. A lot of my issues are with implementation, syntax, etc. Using String explicitly left me with issues where read q would fail when q is a parsed [Char], where [[Char]] looked like [\\&quot;states q\\&quot;,\\&quot;alphabet e\\&quot;, ... ]. And using Lazy.Text, which seems like the proper way to deal with consuming strings, lead to IO issues and the above error. And Hoogle is amazing. Thanks again."}], "tags": [], "owner": {"reputation": 1915, "user_id": 2682729, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PZlkg.gif?s=128&g=1", "display_name": "typesanitizer", "link": "https://stackoverflow.com/users/2682729/typesanitizer"}, "is_accepted": true, "score": 0, "last_activity_date": 1539290499, "last_edit_date": 1539290499, "creation_date": 1539284321, "answer_id": 52767146, "question_id": 52754593, "link": "https://stackoverflow.com/questions/52754593/how-do-i-parse-s-expressions-into-a-data-structure-in-haskell/52767146#52767146", "title": "How do I parse S-expressions into a data structure in Haskell?", "body": "<p><code>read</code> is a partial function with type <code>Read a =&gt; String -&gt; a</code>, which throws an exception on parsing failure. Normally you want to avoid it (use <code>readMaybe</code> instead if you have a string). <code>String</code> and <code>L.Text</code> are different types, which is why you're getting an error.</p>\n\n<p>Your sample code is missing an extra <code>)</code> after the <code>trans-func</code>.</p>\n\n<p>I'm using the Megaparsec package which provides an easy way to work with parser combinators. The author of the library has written a longer tutorial <a href=\"https://markkarpov.com/megaparsec/parsing-simple-imperative-language.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>The basic idea is that <code>Parser a</code> is the type of a value that can parse something of type <code>a</code>. In <code>Text.Megaparsec</code> there are several functions which you can use (<code>parse</code>, <code>parseMaybe</code> etc.), to \"run\" the parser on a \"stringy\" data type (e.g. <code>String</code> or strict/lazy <code>Text</code>).</p>\n\n<p>When you use <code>do</code> notation for <code>IO</code>, it means \"do one action after another\". Similarly, you can use <code>do</code> notation with <code>Parser</code>, it means \"parse this one thing, then parse the next thing\".</p>\n\n<p><code>p1 *&gt; p2</code> means run the parser <code>p1</code>, run <code>p2</code> and return the result of running <code>p2</code>. <code>p1 &lt;* p2</code> means run the parser <code>p1</code>, run <code>p2</code> and return the result of running <code>p1</code>. You can also look up documentation on <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow noreferrer\">Hoogle</a> in case you're having trouble understanding something.</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE NamedFieldPuns    #-}\n\n-- In practice, many of these imports would be unqualified, but I've\n-- opted for explicitness for clarity.\nimport Control.Applicative (empty, many, some, (&lt;*), (*&gt;))\nimport Control.Exception (try, IOException)\nimport Data.Maybe (fromMaybe)\nimport Data.Set (Set)\nimport Data.Text (Text)\n\nimport qualified Data.Set as Set\nimport qualified Data.Text as T\nimport qualified Data.Text.IO as TIO\nimport qualified Text.Megaparsec as MP\nimport qualified Text.Megaparsec.Char as MPC\nimport qualified Text.Megaparsec.Char.Lexer as MPCL\n\ntype Q = Text\ntype E = Char\n\ndata EntryDFA = EntryDFA\n  { state :: Set Q\n  , alpha :: Set E\n  , delta :: Set (Q,E,Q)\n  , start :: Q\n  , final :: Set Q\n  } deriving Show\n\ninputFile = \"foo.sexp\"\n\nmain :: IO ()\nmain = do\n  -- read file and check for exception instead of checking if\n  -- it exists and then trying to read it\n  result &lt;- try (TIO.readFile inputFile)\n  case result of\n    Left e -&gt; print (e :: IOException)\n    Right txt -&gt; do\n      case MP.parse dfaParser inputFile txt of\n        Left e -&gt; print e\n        Right dfa -&gt; print dfa\n\ntype Parser = MP.Parsec () Text\n\n-- There are no comments in the S-exprs, so leave those empty\nspaceConsumer :: Parser ()\nspaceConsumer = MPCL.space MPC.space1 empty empty\n\nsymbol :: Text -&gt; Parser Text\nsymbol txt = MPCL.symbol spaceConsumer txt\n\nparens :: Parser a -&gt; Parser a\nparens p = MP.between (symbol \"(\") (symbol \")\") p\n\nsetP :: Ord a =&gt; Parser a -&gt; Parser (Set a)\nsetP p = do\n  items &lt;- parens (p `MP.sepBy1` (symbol \",\"))\n  return (Set.fromList items)\n\npair :: Parser a -&gt; Parser b -&gt; Parser (a, b)\npair p1 p2 = parens $ do\n  x1 &lt;- p1\n  x2 &lt;- symbol \",\" *&gt; p2\n  return (x1, x2)\n\nstateP :: Parser Text\nstateP = do\n  c &lt;- MPC.letterChar\n  cs &lt;- many MPC.alphaNumChar\n  return (T.pack (c:cs))\n\ndfaParser :: Parser EntryDFA\ndfaParser = do\n  () &lt;- spaceConsumer\n  (_, state) &lt;- pair (symbol \"states\") (setP stateP)\n  (_, alpha) &lt;- pair (symbol \"alpha\") (setP alphaP)\n  (_, delta) &lt;- pair (symbol \"trans-func\") (setP transFuncP)\n  (_, start) &lt;- pair (symbol \"start\") valP\n  (_, final) &lt;- pair (symbol \"final\") (setP valP)\n  return (EntryDFA {state, alpha, delta, start, final})\n  where\n    alphaP :: Parser Char\n    alphaP = MPC.letterChar &lt;* spaceConsumer\n    transFuncP :: Parser (Text, Char, Text)\n    transFuncP = parens $ do\n      s1 &lt;- stateP\n      a &lt;- symbol \",\" *&gt; alphaP\n      s2 &lt;- symbol \",\" *&gt; stateP\n      return (s1, a, s2)\n    valP :: Parser Text\n    valP = fmap T.pack (some MPC.digitChar)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10487833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bW1dl.png?s=128&g=1", "display_name": "xnorlord", "link": "https://stackoverflow.com/users/10487833/xnorlord"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 52767146, "answer_count": 1, "score": 0, "last_activity_date": 1539403331, "creation_date": 1539242977, "last_edit_date": 1539403331, "question_id": 52754593, "link": "https://stackoverflow.com/questions/52754593/how-do-i-parse-s-expressions-into-a-data-structure-in-haskell", "title": "How do I parse S-expressions into a data structure in Haskell?", "body": "<p>I'm new to Haskell and could use some guidance.</p>\n\n<p>The challenge: take an S-expression and parse it into a record.</p>\n\n<p>Where I have succeeded: I can take a file and read it into a parsed String. \nYet, using parsing Text to DFA s.t </p>\n\n<pre><code> let \n        toDFA :: [L.Text] -&gt; EntryDFA\n        toDFA t =\n           let [q,a,d,s,f] = t\n           in EntryDFA { \n               state = read q\n              ,alpha = read a\n              ,delta = read d\n              ,start = read s\n              ,final = read f }\n</code></pre>\n\n<p>returns this error:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018L.Text\u2019 with \u2018[Char]\u2019\n  Expected type: String\n    Actual type: L.Text\n</code></pre>\n\n<p>There must be a more idiomatic approach.</p>\n"}, {"tags": ["haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "edited": false, "score": 1, "creation_date": 1539256953, "post_id": 52753350, "comment_id": 92440717, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/29246108/how-to-combine-case-statement-patterns\">How to combine case statement patterns</a>"}, {"owner": {"reputation": 189, "user_id": 8179137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b43fe26a1b6191280614f56683525d?s=128&d=identicon&r=PG&f=1", "display_name": "Potato44", "link": "https://stackoverflow.com/users/8179137/potato44"}, "edited": false, "score": 1, "creation_date": 1539270088, "post_id": 52753350, "comment_id": 92449560, "body": "Hopefully we get <a href=\"https://github.com/ghc-proposals/ghc-proposals/pull/43\" rel=\"nofollow noreferrer\">or-patterns sometime not too far in the future</a>"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 2, "creation_date": 1539242015, "post_id": 52753679, "comment_id": 92431915, "body": "@BercoviciAdrian The above technique still applies, you can use <code>case x of y | y `elem` &quot;{}&quot; -&gt; ...</code>"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1539243019, "post_id": 52753679, "comment_id": 92432468, "body": "Oh you can place guards before the <code>-&gt;</code> ?"}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 7, "last_activity_date": 1539239602, "creation_date": 1539239602, "answer_id": 52753679, "question_id": 52753350, "link": "https://stackoverflow.com/questions/52753350/multiple-pattern-match/52753679#52753679", "title": "Multiple pattern match", "body": "<p>In this particular example, you could use a <strong>guard</strong>:</p>\n\n<pre><code>f :: Char -&gt; Bool\nf x | x `elem` \"abc\" = someMethod\nf _ = someOtherMethod\n</code></pre>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 652, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1539243758, "creation_date": 1539238250, "last_edit_date": 1539243758, "question_id": 52753350, "link": "https://stackoverflow.com/questions/52753350/multiple-pattern-match", "title": "Multiple pattern match", "body": "<p>Hello can someone please explain me how can i do the following in haskell:</p>\n\n<pre><code>f :: Char -&gt; Bool\nf 'a' = someMethod\nf 'b' = someMethod\nf 'c' = someMethod\nf _ = someOtherMethod\n</code></pre>\n\n<p>Can i do somehow something similar to the <code>@</code> pattern :</p>\n\n<pre><code>f :: Char -&gt; Bool\nf x@(pattern1 || pattern2 ...pattern n) = sameMethod x\n</code></pre>\n\n<p>Basically I want to apply the same method for multiple patterns .Is this possible? I do not want to write N pattern match lines that basically do the same thing.</p>\n\n<p><strong>P.S</strong> My method that i want to implement is the following :</p>\n\n<pre><code>readContent::String-&gt;Maybe [Double]\nreadContent (x:xs)=go [] [](x:xs) where\n    go _ ls [] =if length length ls &gt; 0  then Just ls else Nothing\n    go small big (x:xs)= case x of\n                           '}' -&gt; Just (small:big) -- i want some other pattern here too\n                           ',' -&gt; go [] small:big  xs \n                            t@(_) -&gt; go  t:small big xs\n</code></pre>\n\n<p>I am parsing a <code>String</code> that can be delimited by <code>}</code>,<code>{</code> and <code>,</code>. For <code>}</code> and <code>{</code> i want to apply the same method.</p>\n"}, {"tags": ["haskell", "equality", "proof", "map-function", "function-composition"], "answers": [{"tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 6, "last_activity_date": 1539231650, "last_edit_date": 1539231650, "creation_date": 1539230820, "answer_id": 52752042, "question_id": 52751564, "link": "https://stackoverflow.com/questions/52751564/haskell-function-composition-with-map-function/52752042#52752042", "title": "Haskell Function Composition with Map Function", "body": "<p>You tested</p>\n\n<pre><code>test (p . f) = map f . test (p . f)\n</code></pre>\n\n<p>Which is indeed false. The property is actually</p>\n\n<pre><code>test p . f = map f . test (p . f)\n</code></pre>\n\n<p>Where the LHS associates as</p>\n\n<pre><code>test p . f = (test p) . f\n</code></pre>\n\n<p>Remember, function application is more tightly binding than any user-definable operator, acting like it's <code>infixl 10</code>. Two identifiers next to each other are always part of a prefix function application. (Except in the case of as-patterns: <code>f xs@ys zs</code> means <code>f (xs@ys) zs</code>.)</p>\n\n<p>To prove the property:</p>\n\n<pre><code>    test p . f\n={definition of (.)}\n    \\x -&gt; test p (f x)\n={definition of test}\n    \\x -&gt; if p (f x) then [f x] else []\n={definition of map, multiple times}\n    \\x -&gt; if p (f x) then map f [x] else map f []\n={float map f out of cases}\n    \\x -&gt; map f (if p (f x) then [x] else [])\n={definition of (.)}\n    \\x -&gt; map f (if (p . f) x then [x] else [])\n={definition of test}\n    \\x -&gt; map f (test (p . f) x)\n={definition of (.)}\n    map f . test (p . f)\n</code></pre>\n\n<p>Adapting your example, <code>test (&lt;15) . (*3)</code> means \"multiply by <code>3</code>, ensuring that the result is less than <code>15</code>.\" <code>map (*3) . test ((&lt;15) . (*3))</code> means \"ensure that thrice the input is less than <code>15</code>, and, if so, return thrice the input.\"</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1540191168, "post_id": 52761687, "comment_id": 92756612, "body": "someone should do a book/blog, &quot;The Annotated SO Haskell&quot;, with curated entries like this one. SO by itself has too high a noise level. Do you know where / if we can see the past entries on <a href=\"https://www.haskell.org/news\" rel=\"nofollow noreferrer\">haskell.org/news</a> <i>StackOverflow</i> section (and <i>Reddit</i>)? Who/what/where maintains this list? This would be very valuable."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1540205092, "post_id": 52761687, "comment_id": 92764260, "body": "@WillNess I believe the haskell.org/news list is just the raw questions feed of this tag (plus the counterparts on the Code Review and Software Engineering sites). If we were to seed a curated list of some sort, a possible place to start might be the favorite questions of users here. Here is <a href=\"https://data.stackexchange.com/stackoverflow/revision/914598/1137940/favourites-per-view-for-answered-questions-draft\" rel=\"nofollow noreferrer\">a sketch of a SEDE plaything for aggregating that</a> (though combing through the favorites of tag regulars might be helpful too)."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 4, "last_activity_date": 1542977381, "last_edit_date": 1542977381, "creation_date": 1539265546, "answer_id": 52761687, "question_id": 52751564, "link": "https://stackoverflow.com/questions/52751564/haskell-function-composition-with-map-function/52761687#52761687", "title": "Haskell Function Composition with Map Function", "body": "<p><a href=\"https://stackoverflow.com/a/52752042/2751851\">HTNW's answer</a> covers your test case and how to prove the equation using the definition of <code>test</code>. I'd say there still is an underlying question, though: from which hat were we supposed to pull that equation of -- why should we even consider the possibility of it being true? To answer that, let's begin by having a second look at the equation:</p>\n\n<pre><code>test p . f = map f . test (p . f)\n</code></pre>\n\n<p>In words, it says that modifying a value using some <code>f</code> function and then, given some suitable predicate <code>p</code>, applying <code>test p</code> on it is the same than modifying the value after using <code>test</code> (with the predicate suitably modified by composing it with <code>f</code>, so that it fits the type of the unmodified value).</p>\n\n<p>Next, let's consider the type of <code>test</code>:</p>\n\n<pre><code>-- I'm adding the implicit forall for the sake of emphasis.\nforall a. (a -&gt; Bool) -&gt; a -&gt; [a]\n</code></pre>\n\n<p>The crucial thing here is that a function with this type must work for any choice of <code>a</code> whatsoever. If it can be anything, we don't know anything about it in advance when implementing a function with this type, like <code>test</code>. That severely limits what such a function can do: in particular, the elements of the result list, if any, must all be the same as the supplied value of type <code>a</code> (how could we change it into something else without knowing its type in advance?), and the predicate must be either ignored or applied to that same value (what else would we apply it to?). Taking that into account, what the equation says now feels natural: it doesn't matter whether we change the values with <code>f</code> before or after <code>test</code>, because <code>test</code> won't change the values on its own.</p>\n\n<p>One way to make this sort of reasoning rigorous is through free theorems. A free theorem for a type is, thanks to parametric polymorphism, guaranteed to always hold for any possible value of that type, and you don't need anything other than the type to figure it out. It happens that the free theorem for <code>forall a. (a -&gt; Bool) -&gt; a -&gt; [a]</code> is precisely <code>test p . f = map f . test (p . f)</code>. Since I can't do justice to the subject in these short lines, here are a few references about free theorems:</p>\n\n<ul>\n<li><p><a href=\"https://bartoszmilewski.com/2014/09/22/parametricity-money-for-nothing-and-theorems-for-free/\" rel=\"nofollow noreferrer\"><em>Parametricity: Money for Nothing and Theorems for Free</em></a>, by Bartosz Milewski, is a good exposition with pointers to the key primary sources if you want to dig deeper.</p></li>\n<li><p><a href=\"https://duplode.github.io/posts/what-does-fmap-preserve.html\" rel=\"nofollow noreferrer\"><em>What Does fmap Preserve?</em></a>, by yours truly, is not exactly about free theorems, but it presents some of the related themes in (hopefully) an accessible way.</p></li>\n<li><p>Relevant Stack Overflow posts: <a href=\"https://stackoverflow.com/a/45493120/2751851\">amalloy's answer to <em>Polymorphic reasoning</em></a>; <a href=\"https://stackoverflow.com/q/26995382/2751851\"><em>Type signatures that never make sense</em></a>.</p></li>\n<li><p><a href=\"http://hackage.haskell.org/package/lambdabot\" rel=\"nofollow noreferrer\"><em>lambdabot</em></a> can generate free theorems for you. You can use it either as a command line tool or through the bot that runs on the #haskell Freenode IRC channel.</p></li>\n</ul>\n"}], "owner": {"reputation": 65, "user_id": 3810700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bea332a5f49c1c2aaa12ab874ae2bb1?s=128&d=identicon&r=PG&f=1", "display_name": "flopoe", "link": "https://stackoverflow.com/users/3810700/flopoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "accepted_answer_id": 52752042, "answer_count": 2, "score": 4, "last_activity_date": 1542977381, "creation_date": 1539227244, "last_edit_date": 1540190694, "question_id": 52751564, "link": "https://stackoverflow.com/questions/52751564/haskell-function-composition-with-map-function", "title": "Haskell Function Composition with Map Function", "body": "<p>I'm going through the Richard Bird's \"Thinking Functionally with Haskell\" book and there is a section that I can't understand where he's proving a property of the filter method. What he's proving is:</p>\n\n<pre><code>filter p . map f = map f . filter (p . f)\n</code></pre>\n\n<p>Previously in the book, he defines the filter as:</p>\n\n<pre><code>filter p = concat . map (test p)\ntest p x = if p x then [x] else []\n</code></pre>\n\n<p>This is how he proves the first equation:</p>\n\n<pre><code>    filter p . map f\n= {second definition of filter} -- He's referring to the definition I gave above\n    concat . map (test p) . map f\n= {functor property of map}\n    concat . map (test p . f)\n= {since test p . f = map f . test (p . f)}\n    concat . map (map f . test (p . f))\n= {functor property of map}\n    concat . map (map f) . map (test (p . f))\n= {naturality of concat}\n    map f . concat . map (test (p . f))\n= {second definition of filter}\n    map f . filter (p . f)\n</code></pre>\n\n<p>What I can't understand is how <code>test p . f</code> is equal to <code>map f . test (p . f)</code>.</p>\n\n<p>This is how I tried to test it:</p>\n\n<pre><code>test :: (a -&gt; Bool) -&gt; a -&gt; [a]\ntest p x = if p x then [x] else []\n\ntest ((&lt;15) . (3*)) 4 -- test p .f, returns [4]\n(map (3*) . test((&lt;15) . (3*))) 4 -- map f . test (p . f), returns [12]\n</code></pre>\n\n<p>Can anyone please explain what I'm missing here?</p>\n"}, {"tags": ["haskell", "fold"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 3, "creation_date": 1539226778, "post_id": 52751410, "comment_id": 92427141, "body": "I\u2019m a little surprised the book asks you to write such a function, given that it\u2019s partial\u2014it clearly can\u2019t produce a value given an empty list. You could handle the empty list case explicitly, or you could use <code>foldr1</code>, but I can\u2019t guess what the \u201cintended\u201d solution would be."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1539226807, "post_id": 52751410, "comment_id": 92427145, "body": "Well, no.  That type signature is fundamentally incorrect.  You cannot find a base case because it&#39;s impossible."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1539227380, "post_id": 52751410, "comment_id": 92427261, "body": "@Carl it&#39;s as incorrect as that of <code>tail</code>."}], "answers": [{"tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 0, "last_activity_date": 1539240895, "creation_date": 1539240895, "answer_id": 52754013, "question_id": 52751410, "link": "https://stackoverflow.com/questions/52751410/how-to-specify-an-initial-value-for-foldr-when-using-ordering-to-compare-val/52754013#52754013", "title": "How to specify an initial value for `foldr` when using `Ordering` to compare values in Haskell?", "body": "<p>Take the first item of the list as your start case, and then process the rest of the list:</p>\n\n<pre><code>myMaximumBy _ [] = error \"Empty list\"\nmyMaximumBy f (v:vs) = foldr (\\x y -&gt; if f x y == LT then y else x) v vs\n</code></pre>\n"}], "owner": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 251, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539240895, "creation_date": 1539225954, "question_id": 52751410, "link": "https://stackoverflow.com/questions/52751410/how-to-specify-an-initial-value-for-foldr-when-using-ordering-to-compare-val", "title": "How to specify an initial value for `foldr` when using `Ordering` to compare values in Haskell?", "body": "<p>I am doing the exercise 10.10 in <em>Haskell Programming From First Principles</em> , the question is to write a <code>myMaximumBy</code> function using <code>foldr</code>:</p>\n\n<pre><code>myMaximumBy :: (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; a\nmyMaximumBy = undefined\n</code></pre>\n\n<p>I am trying to do this:</p>\n\n<pre><code>myMaximumBy :: (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; a\nmyMaximumBy f = foldr (\\x y -&gt; if f x y == LT then y else x) INIT_VAL\n</code></pre>\n\n<p>But I do not know how to specify an initial value <code>INIT_VAL</code> for this expression. Can you help me with this?</p>\n"}, {"tags": ["haskell", "idris", "dependent-type", "singleton-type"], "answers": [{"comments": [{"owner": {"reputation": 1349, "user_id": 7655081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b23af7029d2ec53c15d8d9d2cccb0bb?s=128&d=identicon&r=PG&f=1", "display_name": "0xd34df00d", "link": "https://stackoverflow.com/users/7655081/0xd34df00d"}, "edited": false, "score": 0, "creation_date": 1579971270, "post_id": 59903241, "comment_id": 105947817, "body": "Ah, singletons of singletons from 2.6! No wonder it didn&#39;t work with 2.5!"}], "tags": [], "owner": {"reputation": 589, "user_id": 1486400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b6c720fd6b86fdf2293eefb5188d46b?s=128&d=identicon&r=PG", "display_name": "int_index", "link": "https://stackoverflow.com/users/1486400/int-index"}, "is_accepted": true, "score": 3, "last_activity_date": 1579897571, "creation_date": 1579897571, "answer_id": 59903241, "question_id": 52750918, "link": "https://stackoverflow.com/questions/52750918/lifting-existentials-to-type-level/59903241#59903241", "title": "Lifting existentials to type level", "body": "<p>The solution to this problem requires singletons of singletons, which were introduced in <code>singletons-2.6</code>. First, the required language extensions and imports:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE TemplateHaskell, GADTs, ScopedTypeVariables, PolyKinds, DataKinds,\n             TypeFamilies, TypeOperators, UndecidableInstances, InstanceSigs,\n             TypeApplications, FlexibleInstances, StandaloneDeriving #-}\n\nmodule AddrSing where\n\nimport GHC.TypeLits\nimport Data.Kind\nimport Data.Singletons.TH\nimport Data.Singletons.Sigma\n</code></pre>\n\n<p>Now we can define <code>AddrType</code> and generate singletons for it:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>singletons\n  [d| data AddrType = Post | Email | Office\n        deriving Show\n  |]\n</code></pre>\n\n<p>Nothing fancy so far, but then we have <code>AddrFields</code>, which is a bit more tricky:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data AddrFields :: AddrType -&gt; Type where\n  PostFields :: { city :: Symbol, street :: Symbol } -&gt; AddrFields Post\n  EmailFields :: { email :: Symbol } -&gt; AddrFields Email\n  OfficeFields :: { floor :: Nat, desk :: Nat } -&gt; AddrFields Office\n\nderiving instance Show (AddrFields addrType)\n</code></pre>\n\n<p>Instead of <code>String</code> and <code>Integer</code> I had to use <code>Symbol</code> and <code>Nat</code>, as the latter can be promoted. And then, since <code>AddrFields</code> is itself a GADT, we have to singletonize it by hand:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data SAddrFields :: forall addrType. AddrFields addrType -&gt; Type where\n  SPostFields :: Sing city -&gt; Sing street -&gt; SAddrFields (PostFields city street)\n  SEmailFields :: Sing email -&gt; SAddrFields (EmailFields email)\n  SOfficeFields :: Sing floor -&gt; Sing desk -&gt; SAddrFields (OfficeFields floor desk)\n\nderiving instance Show (SAddrFields addrFields)\n\ntype instance Sing = SAddrFields\n\ninstance (SingI city, SingI street) =&gt; SingI (PostFields city street) where\n  sing = SPostFields sing sing\n\ninstance (SingI email) =&gt; SingI (EmailFields email) where\n  sing = SEmailFields sing\n\ninstance (SingI floor, SingI desk) =&gt; SingI (OfficeFields floor desk) where\n  sing = SOfficeFields sing sing\n</code></pre>\n\n<p>Automating this bit is an open issue: <a href=\"https://github.com/goldfirere/singletons/issues/150\" rel=\"nofollow noreferrer\">https://github.com/goldfirere/singletons/issues/150</a></p>\n\n<p>Next, let's define <code>Addr</code>, which is simply a dependent pair:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type Addr = Sigma AddrType (TyCon AddrFields)\n</code></pre>\n\n<p>Here's an example of an <code>Addr</code> value:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>x :: Addr\nx = SPost :&amp;: PostFields undefined undefined\n</code></pre>\n\n<p>The <code>Symbol</code> fields of <code>PostFields</code> cannot have any inhabitants, so I had to fill them in with <code>undefined</code>, but this is unimportant at the moment. Just note that we already have a singleton as our first component, <code>SPost</code>.</p>\n\n<p>This is where singletons of singletons come into play. We can singletonize <code>x</code> as follows:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>xSing :: Sing @Addr (SPost :&amp;: PostFields \"Foo\" \"Bar\")\nxSing = sing\n</code></pre>\n\n<p>For the final bit, let's define <code>someCoolPredicate</code> and <code>AddrList</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>singletons\n  [d|\n    someCoolPredicate :: [Addr] -&gt; Bool\n    someCoolPredicate (_ : _) = True\n    someCoolPredicate [] = False\n  |]\n\ndata AddrList :: [Addr] -&gt; Type where\n  MkAddrList :: (SomeCoolPredicate addrs ~ True) =&gt; Sing addrs -&gt; AddrList addrs\n\nderiving instance Show (AddrList addrs)\n</code></pre>\n\n<hr>\n\n<p>With this machinery in place, your Idris example <code>MkAddrList [(Post ** PostFields \"Foo\" \"Bar\")]</code> is written as follows:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>ghci&gt; MkAddrList @'[SPost :&amp;: PostFields \"Foo\" \"Bar\"] sing\nMkAddrList (SCons (SWrapSing {sUnwrapSing = SPost} :&amp;: SPostFields (SSym @\"Foo\") (SSym @\"Bar\")) SNil)\n</code></pre>\n\n<p>Full code here: <a href=\"https://gist.github.com/int-index/743ad7b9fcc54c9602b4eecdbdca34b5\" rel=\"nofollow noreferrer\">https://gist.github.com/int-index/743ad7b9fcc54c9602b4eecdbdca34b5</a></p>\n"}], "owner": {"reputation": 1349, "user_id": 7655081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b23af7029d2ec53c15d8d9d2cccb0bb?s=128&d=identicon&r=PG&f=1", "display_name": "0xd34df00d", "link": "https://stackoverflow.com/users/7655081/0xd34df00d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 1, "accepted_answer_id": 59903241, "answer_count": 1, "score": 5, "last_activity_date": 1579897571, "creation_date": 1539221756, "question_id": 52750918, "link": "https://stackoverflow.com/questions/52750918/lifting-existentials-to-type-level", "title": "Lifting existentials to type level", "body": "<p>tl;dr: I'm trying to rewrite some dependently-typed code that has a list of sigma-types in Haskell, and I can't seem to generate singletons for an existential, in other words this code fails:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Foo :: Type where\n  Foo :: forall foo. Sing foo -&gt; Foo\n\n$(genSingletons [''Foo])\n</code></pre>\n\n<hr>\n\n<p>Longer version follows.</p>\n\n<p>Assume this Idris code as a model:</p>\n\n<pre><code>data AddrType = Post | Email | Office\n\ndata AddrFields : AddrType -&gt; Type where\n  PostFields : (city : String) -&gt; (street : String) -&gt; AddrFields Post\n  EmailFields : (email : String) -&gt; AddrFields Email\n  OfficeFields : (floor : Int) -&gt; (desk : Nat) -&gt; AddrFields Office\n\nAddr : Type\nAddr = (t : AddrType ** AddrFields t)\n\nsomeCoolPredicate : List AddrType -&gt; Bool\n\ndata AddrList : List Addr -&gt; Type where\n  MkAddrList : (lst : List Addr) -&gt; {auto prf : So (someCoolPredicate lst)} -&gt; AddrList lst\n</code></pre>\n\n<p>Basically, when we're given a value of type <code>AddrList lst</code>, we know that <code>lst : List Addr</code>, and that <code>someCoolPredicate</code> holds for that list.</p>\n\n<p>The closest I managed to achieve in modern Haskell is, assuming singletons-2.5:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Singletons.TH\nimport Data.Singletons.Prelude\nimport Data.Singletons.Prelude.List\n\ndata AddrType = Post | Email | Office\n              deriving (Eq, Ord, Show)\n\n$(genSingletons [''AddrType])\n$(singEqInstances [''AddrType])\n\ndata family AddrFields (a :: AddrType)\n\ndata instance AddrFields 'Post    = PostFields { city :: String, street :: String } deriving (Eq, Ord, Show)\ndata instance AddrFields 'Email   = EmailFields { email :: String } deriving (Eq, Ord, Show)\ndata instance AddrFields 'Office  = OfficeFields { flr :: Int, desk :: Int} deriving (Eq, Ord, Show)\n\ndata Addr :: Type where\n  Addr :: { addrType :: Sing addrType\n          , addrTypeVal :: AddrType\n          , fields :: AddrFields addrType\n          } -&gt; Addr\n\n$(promote [d|\n  someCoolPredicate :: [Addr] -&gt; Bool\n  someCoolPredicate = ...\n  |])\n\ndata AddrList :: [Addr] -&gt; Type where\n  AddrList :: { addrs :: Sing addrs, prf :: SomeCoolPredicate addrs :~: 'True } -&gt; AddrList addrs\n</code></pre>\n\n<p>But how do I actually construct a value of this type given an <code>[Addr]</code>? In other words, how do I express something like the following in Idris?</p>\n\n<pre><code>*Addrs&gt; MkAddrList [(Post ** PostFields \"Foo\" \"Bar\")]\nMkAddrList [(Post ** PostFields \"Foo\" \"Bar\")] : AddrList [(Post ** PostFields \"Foo\" \"Bar\")]\n</code></pre>\n\n<p>The problem is that looks like I have to be able to do <code>toSing</code> or equivalent on the list of <code>Addr</code>, but <code>$(genSingletons [''Addr])</code> fails. Indeed, even the code in the tl;dr section fails. So what should I do, except for abandoning this idea?</p>\n"}]