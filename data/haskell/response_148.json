[{"tags": ["json", "parsing", "haskell", "avro"], "owner": {"reputation": 1247, "user_id": 3169543, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7416c0dca5630ff1c31b955e185e955b?s=128&d=identicon&r=PG&f=1", "display_name": "user3169543", "link": "https://stackoverflow.com/users/3169543/user3169543"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1510309860, "creation_date": 1510180879, "last_edit_date": 1510309860, "question_id": 47190948, "link": "https://stackoverflow.com/questions/47190948/haskell-parsing-with-a-fixed-syntax-along-with-user-defined-options", "title": "Haskell : Parsing with a fixed syntax along with user defined options", "body": "<p>I'm currently using <a href=\"https://avro.apache.org/docs/1.8.2/spec.html\" rel=\"nofollow noreferrer\">AVRO</a> implementation in Haskell <a href=\"https://github.com/GaloisInc/avro\" rel=\"nofollow noreferrer\">here</a> as a reference and (re)implementing my own version to do a relatively big project in Haskell. </p>\n\n<p>The <code>Type</code> that is defined for representing Schema is <a href=\"https://github.com/GaloisInc/avro/blob/master/src/Data/Avro/Schema.hs#L66\" rel=\"nofollow noreferrer\">this.</a></p>\n\n<p>I would like to also have an option for the user of this library to have \"custom\" defined fields to be added as part of the JSON schema. These \"custom\" fields are NOT relevant for producing Haskell data structures and serialization based on the AVRO specification. As an example, lets say we have an infra, when  that generates \"logging\" functions (used when doing the RPC defined in AVRO spec), based on \"log\" key with value true being present as part of the schema. If we don't want to log a field, we can leave out the \"log\" key.</p>\n\n<pre><code>      {\n          \"type\": \"record\",\n          \"name\": \"test\",\n          \"fields\" : [\n                       {\n                        \"name\": \"a\", \n                        \"type\": \"long\"\n                       },\n                       {\n                        \"name\": \"b\", \n                        \"type\": \"string\",\n                        \"log\" : true\n                      }\n                     ]\n      }\n</code></pre>\n\n<p>Now the parser that generates \"AVRO\" related stuff, does NOT care about the keywords it does not understand. But the User infra, to which these makes sense will need to parse these.</p>\n\n<p>what is the best way to do represent the AST and construct this by applying multiple parsers, 1. the regular \"avro\" parser and then the user defined parser to look for \"custom\" syntax. Some thing like below (for a way smaller set)</p>\n\n<pre><code>    import           Data.Aeson\n    data AvroObj a = Record Name [AvroObj a]\n                  | Enum Name Symbols a\n                  | Boolean Name a\n                  | Integer Name a\n                  | Float Name a\n                  deriving(Show)\n\n    data UserState = UserState {\n       log :: Maybe Bool\n    } deriving(Show)\n\n-- this is defined in the library\n    instance FromJSON a =&gt; FromJSON (AvroObj a) where\n        parseJSON = undefined\n\n-- user defines this \n    instance FromJSON UserState where\n        parseJSON = undefined\n</code></pre>\n\n<p>Somehow the user can use <code>AvroObj UserState</code> type to refer to the complete AST. I'm stuck at defining the type and what the function signatures should be.\nAny pointers to some patterns dealing with this would be great. </p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell", "hugs"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 6, "creation_date": 1510177044, "post_id": 47189354, "comment_id": 81329572, "body": "&quot;<i>Unfortunately most of the documentation seems to apply only to ghc.</i>&quot; - That&#39;s because hugs is dead. There hasn&#39;t been a new release since 2006."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1510177329, "post_id": 47189354, "comment_id": 81329713, "body": "I run <code>inaList [0..1000000]</code> with no issues in GHCi. It looks as if Hugs has some bugs, or it severely limits the computation (even if the code seems mostly harmless)"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1510191202, "post_id": 47189354, "comment_id": 81334258, "body": "Inlist2 has a lot of bad choices when it comes to performance, <code>elem</code> is O(n) and you do this for each <code>x</code> in the input list, <code>maximum</code> is also O(n) but I believe the value is calculated only once, <code>takeWhile</code> has also linear run time; my recommendation would be 1) use ghc(i), 2) use <code>Set</code> to make use that your elements can be ordered, this would be helpful for the membership test and the maximum calculation, 3) if you have control over your input use <code>Word64</code> or <code>Int64</code> instead of <code>Integer</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1510224691, "post_id": 47189354, "comment_id": 81348292, "body": "<code>findPos</code> isn&#39;t tail recursive, which could be the problem for your third version. I don&#39;t know what causes trouble for the second. This is all speculation; I&#39;m not going to install Hugs on my computer, let alone try to learn its quirks."}], "owner": {"reputation": 11, "user_id": 8909010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b5110b8759290748e3696a3dbd75f4e?s=128&d=identicon&r=PG&f=1", "display_name": "user8909010", "link": "https://stackoverflow.com/users/8909010/user8909010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1510177925, "creation_date": 1510173923, "last_edit_date": 1510177925, "question_id": 47189354, "link": "https://stackoverflow.com/questions/47189354/hugs-list-comprehension-with-part-of-infinite-list-results-in-control-stack-ov", "title": "Hugs - List comprehension with part of infinite list results in Control stack overflow", "body": "<p>I try to write a function that gets a list of Integers and should filter it so that the returned list contains only the numbers which match a certain pattern. Unfortunately the order must remain the same. \nI have implemented a infinite list, that returns all valid numbers in ordered sequence and use it in an list comprehension. This works fine and fast in ghci, but my problem is, that with bigger lists in hugs, which we are required to use in my university course, it results in a Control stack overflow, which i don't comprehend.</p>\n\n<p>I have written minimal examples which should demonstrate my problem:</p>\n\n<pre><code>import Data.List\naList = map (1000*) [0..] -- a example list...\n\n-- works only with lists with a max length of 4093 e.g. [0..4092]  but is fast.\n-- (with [0..4093] it results in a Control stack overflow)\ninaList :: [Integer] -&gt; [Integer] \ninaList list = [x| x&lt;-list,elem x cap_aList]\n    where list_max = maximum list\n          cap_aList = takeWhile (&lt;=list_max) aList -- should be computed only once?\n\n-- seems to works even with [0..100000] but is really really slow\n-- does not exactly what i want.\ninaList_working :: [Integer] -&gt; [Integer] \ninaList_working list = [x| x&lt;-list,elem x $take 1000 aList ]\n\n-- works  with max [0..4092] and is slow.\ninaList_2 :: [Integer] -&gt; [Integer] \ninaList_2 list = [x| x&lt;-list,elem x $takeWhile (&lt;=(fromIntegral $maximum list)) aList ]\n\n-- works fast but with max [0..4091].\ninaList_3 :: [Integer] -&gt; [Integer] \ninaList_3 list = [x| x&lt;-list,elem x cap_aList ]\n    where   list_max = maximum list\n            toTake = findPos list_max aList\n            cap_aList = take toTake aList\n\nfindPos :: Integer -&gt; [Integer] -&gt; Int\nfindPos i (n:nx)\n    | i&gt;=n = 1 + findPos i nx\n    | otherwise = 0 \n</code></pre>\n\n<p>There is no difference if i use <code>aList = map (8*) [0..]</code> instead of <code>aList = map (1000*) [0..]</code>.\nIt only takes a bit longer to finish because it has to do more comparisons, but does not result in a crash.\nTherefore it seems the length of the list for <code>elem</code> does not impact the length of the Control stack?</p>\n\n<p>I have no idea why the Control stack overflow occurs.\nEven <code>[x| x&lt;-liste,foldl' (||) False $map (==x) cap_aList]</code> results in the same error.</p>\n\n<p>If it is used with normal lists the list comprehension works flawless, but if used with <code>takeWhile</code> (see <code>inaList</code> and <code>inaList_2</code>) it runs into a Control stack overflow or segmentation fault.\nIf <code>take</code> is used with a computed value (see <code>inaList_3</code>) it also crashes. With a \"static\" <code>take</code> (see <code>inaList_working</code>) it suddenly works.\nI thought, that the where clause should usually be computed only once or never. Then why does it make a difference how the list was build?\nAnd shouldn't hugs try to reduce/compute the Control stack if it is full?\nUnfortunately most of the documentation seems to apply only to ghc.</p>\n\n<p>So why does this Control stack overflow occur in this case, how can it be avoided and how can i determine how the control stack looks like/is populated?\nAre there multiple control stacks?</p>\n\n<p>I hope someone can explain whats going on.</p>\n"}, {"tags": ["haskell", "io"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 4, "creation_date": 1510174152, "post_id": 47189327, "comment_id": 81328117, "body": "Use <code>let res = ...</code> instead of <code>res &lt;- ...</code>"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 2, "creation_date": 1510175057, "post_id": 47189327, "comment_id": 81328641, "body": "<code>estCommande (instruction) == True</code> ~ <code>estCommande (instruction)</code>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1510177149, "post_id": 47189327, "comment_id": 81329624, "body": "Slightly tongue-in-cheek solution: since <code>res</code> isn&#39;t used anywhere, you can just delete the offending line. But only slightly tongue-in-cheek, as there&#39;s a lesson here, namely: I suspect you believe that merely calling <code>evalParser</code> will &quot;do something&quot;, but it won&#39;t. This smells like you have made a bit of a mistake; e.g. perhaps <code>evalParser</code> should be returning an updated store to use in the later recursive call to <code>programme</code>, or perhaps you intended to print the result, or both. Or perhaps you did those in the original but cut them out to make a minimal example, in which case kudos!"}], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1510201137, "post_id": 47189390, "comment_id": 81336697, "body": "Since &quot;arrows&quot; are a notion with their own syntax perhaps we should stick to calling it &quot;do notation&quot; or &quot;monadic bind&quot; to avoid causing confusion later on."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1510201278, "post_id": 47189390, "comment_id": 81336739, "body": "@ThomasM.DuBuisson I originally had &quot;do notation&quot;, but it didn&#39;t sound right to me. I haven&#39;t written Haskell in a couple years, so I&#39;ve forgotten some terminology. I&#39;ll change it back. Thanks."}], "tags": [], "owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "is_accepted": false, "score": 2, "last_activity_date": 1510201309, "last_edit_date": 1510201309, "creation_date": 1510174039, "answer_id": 47189390, "question_id": 47189327, "link": "https://stackoverflow.com/questions/47189327/haskell-float-to-io-float/47189390#47189390", "title": "Haskell : Float to IO Float", "body": "<p><code>evalParser</code> is pure, you don't need to use do notation to call it. To shimmy fix it, you could just wrap it in a <code>return</code> to stick it in the IO Monad:</p>\n\n<pre><code>res &lt;- return $ evalParser instruction store\n</code></pre>\n\n<p>To avoid the wrapping/unwrapping altogether though, just don't treat it as an impure value from the start:</p>\n\n<pre><code>let res = evalParser instruction store\n</code></pre>\n"}], "owner": {"reputation": 353, "user_id": 8906596, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10207778167811470/picture?type=large", "display_name": "Adrien Varet", "link": "https://stackoverflow.com/users/8906596/adrien-varet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510201309, "creation_date": 1510173825, "question_id": 47189327, "link": "https://stackoverflow.com/questions/47189327/haskell-float-to-io-float", "title": "Haskell : Float to IO Float", "body": "<p>I have a type problem with this function</p>\n\n<pre><code>type Store = [(String, Float)]\nevalParser :: String -&gt; Store -&gt; Float -- Boring function who returns a Float\n\nprogramme :: Store -&gt; IO()\nprogramme store = do\n    putStr \"@EvmInteractif:$&gt; \"\n    instruction &lt;- getLine\n    putStrLn (show instruction)\n\n    if (estCommande (instruction) == True) then\n        do\n            res &lt;- evalParser instruction store\n            putStrLn \"TODO: execution de la commande\"\n            programme store\n</code></pre>\n\n<p>And at the line of res's affectation I have this error : </p>\n\n<p>Couldn't match expected type <code>IO Float' with actual type</code>Float'\n    In the return type of a call of `evalParser'\n    In a stmt of a 'do' block: v &lt;- evalParser expr store</p>\n\n<p>Can someone tell me the rigth syntax please ? \nThanks</p>\n"}, {"tags": ["haskell", "ghc", "ghci"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1510177409, "post_id": 47188857, "comment_id": 81329747, "body": "Cool! Smells buggy to me."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1552690167, "post_id": 47188857, "comment_id": 97121617, "body": "Cannot reproduce the behaviour on GHC version 8.0."}], "owner": {"reputation": 537, "user_id": 888445, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4381063157454f1bf8bd5effd0dd07b0?s=128&d=identicon&r=PG", "display_name": "Corey Staten", "link": "https://stackoverflow.com/users/888445/corey-staten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 0, "score": 8, "last_activity_date": 1510247850, "creation_date": 1510172151, "last_edit_date": 1510247850, "question_id": 47188857, "link": "https://stackoverflow.com/questions/47188857/ghci-hangs-when-ctrlcing-from-infinite-loop-with-fbreak-on-exception-set", "title": "GHCi hangs when Ctrl+Cing from infinite loop with -fbreak-on-exception set", "body": "<p>As the title says, I create an infinite loop in GHCi:</p>\n\n<pre><code>f x = x - 2\ng x = if f x &lt; x then g (f x + 2) else x\ng 2\n</code></pre>\n\n<p>Normally pressing Ctrl+C yields \"Interrupted.\" and a return to the GHCi prompt.  If I <code>:set -fbreak-on-exception</code> beforehand though, Ctrl+C does not break the loop and my only recourse is to kill the program externally.</p>\n\n<p>Is there a way to break into infinite loops using GHCi?  Is this a bug?</p>\n"}, {"tags": ["haskell", "show"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1510166982, "creation_date": 1510166982, "answer_id": 47187443, "question_id": 47187317, "link": "https://stackoverflow.com/questions/47187317/haskell-show-with-function-application/47187443#47187443", "title": "haskell show with function application", "body": "<p>It's a precedence issue.</p>\n\n<pre><code>show n ++ \" \" ++ show $ length line\n</code></pre>\n\n<p>means</p>\n\n<pre><code>(show n ++ \" \" ++ show) (length line)\n</code></pre>\n\n<p>which makes no sense since <code>show</code> is not a string. It does not mean</p>\n\n<pre><code>show n ++ \" \" ++ (show (length line))\n</code></pre>\n\n<p>To get the wanted one, you need parentheses. Use one of these:</p>\n\n<pre><code>zipWith (\\n line -&gt; show n ++ \" \" ++ show (length line)) [1..] $ lines xs\n-- or\nzipWith (\\n line -&gt; show n ++ \" \" ++ (show $ length line)) [1..] $ lines xs\n</code></pre>\n\n<p>I'd prefer the former since it's simpler.</p>\n"}, {"tags": [], "owner": {"reputation": 27685, "user_id": 610979, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ku5ga.png?s=128&g=1", "display_name": "Frank Schmitt", "link": "https://stackoverflow.com/users/610979/frank-schmitt"}, "is_accepted": false, "score": 2, "last_activity_date": 1510167391, "creation_date": 1510167391, "answer_id": 47187555, "question_id": 47187317, "link": "https://stackoverflow.com/questions/47187317/haskell-show-with-function-application/47187555#47187555", "title": "haskell show with function application", "body": "<p>Your problem boils down to:</p>\n\n<pre><code>*Main&gt; let line = \"abc\"\n*Main&gt; \" \" ++ show (length line)\n\" 3\"\n*Main&gt; \" \" ++ show $length line\n&lt;interactive&gt;:9:1: error:\n    \u2022 Couldn't match expected type \u2018Int -&gt; t\u2019 with actual type \u2018[Char]\u2019\n</code></pre>\n\n<p>The root cause for this is that <code>$</code> has lower precedence than <code>++</code>:</p>\n\n<pre><code>*Main&gt; :info (++)\n...\ninfixr 5 ++\n*Main&gt; :info ($)\n...\ninfixr 0 $\n</code></pre>\n\n<p>as defined in the <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-820004.4.2\" rel=\"nofollow noreferrer\">Haskell Report</a></p>\n\n<p>Therefore, you need parentheses around <code>show $ length line</code>.</p>\n"}], "owner": {"reputation": 145, "user_id": 1007935, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/de45a111a477254b06722ab142f744a1?s=128&d=identicon&r=PG", "display_name": "momi", "link": "https://stackoverflow.com/users/1007935/momi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 47187443, "answer_count": 2, "score": 1, "last_activity_date": 1515722015, "creation_date": 1510166521, "last_edit_date": 1515722015, "question_id": 47187317, "link": "https://stackoverflow.com/questions/47187317/haskell-show-with-function-application", "title": "haskell show with function application", "body": "<p>this line of code in Haskell produces an error on compilation:</p>\n\n<pre><code>lineStat :: String -&gt; [String]\nlineStat xs =  zipWith (\\n line -&gt; show n ++ \" \" ++ show $ length line) [1..] $ lines xs\n</code></pre>\n\n<p>Error:\n    Couldn't match expected type <code>Int -&gt; String</code> with actual type <code>[Char]</code>\n    The first argument of ($) takes one argument,but its type <code>[Char]</code> has none</p>\n\n<p>However this line of code works:</p>\n\n<pre><code>lineStat xs =  zipWith (\\n line -&gt; show n ++ \" \" ++ show (length line)) [1..] $ lines xs\n</code></pre>\n\n<p>Why?</p>\n"}, {"tags": ["algorithm", "haskell", "math", "functional-programming", "greedy"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1510166583, "post_id": 47187307, "comment_id": 81323780, "body": "Hint: what do we know about the element that produce the highest product?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1510166785, "post_id": 47187307, "comment_id": 81323882, "body": "Your logic for <code>a&#39;,b&#39;,c&#39;</code> looks wrong. Suppose <code>a=8,b=5,c=2</code> and <code>x=7</code> comes. Do you get <code>a&#39;=8,b&#39;=7,c&#39;=5</code> for the next iteration ?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1510166924, "post_id": 47187307, "comment_id": 81323970, "body": "Hint: try to define all the variables together as in <code>where (a&#39;,b&#39;,c&#39;) = if (...) then (x,a,b) else if (...) then (a,x,b) else ...</code> (you could also use guards for that)"}, {"owner": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1510167471, "post_id": 47187307, "comment_id": 81324309, "body": "@WillemVanOnsem that they are the three maximum numbers in the list or the maximum and two minimum negative numbers?"}, {"owner": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1510167561, "post_id": 47187307, "comment_id": 81324357, "body": "@chi I was trying to define all of those variables but I was getting compilation errors which were very confusing. but the idea is to use pattern-matching  for returning the result in the if-then-else expressions, correct?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1510167763, "post_id": 47187307, "comment_id": 81324501, "body": "There&#39;s no pattern matching in my comment above, except for <code>(a&#39;,b&#39;,c&#39;) =</code>. The <code>if</code> part simply evaluates to a 3-tuple, it does not pattern match anything."}, {"owner": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1510168171, "post_id": 47187307, "comment_id": 81324741, "body": "@chi Oh that makes sense."}], "answers": [{"comments": [{"owner": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "edited": false, "score": 0, "creation_date": 1510168114, "post_id": 47187532, "comment_id": 81324706, "body": "Also if the list could include negative numbers, then would <code>sol2</code> need to have two more parameters to keep track the min numbers?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "edited": false, "score": 0, "creation_date": 1510168529, "post_id": 47187532, "comment_id": 81324954, "body": "@AriaPahlavan I think things get quite a bit more complicated if negative numbers are allowed. There&#39;s all kinds of fun edge cases -- e.g. perhaps there are <i>only</i> negative numbers, in which case you want the biggest ones again instead of the smallest ones. You should also think carefully about when including 0 might be the right answer. The simplest (though inefficient) is to compute all the products: <code>maxProd3 xs = maximum [x*y*z | x:ys &lt;- tails xs, y:zs &lt;- tails ys, z &lt;- zs]</code>. (Even if you don&#39;t use that implementation in the end, it&#39;s a good one to test against with QuickCheck or similar.)"}, {"owner": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1510169210, "post_id": 47187532, "comment_id": 81325375, "body": "@DanielWagner would become that complicated? I can&#39;t think of that many corner cases though.  Anyhow, <code>maxProd3</code> is O(N^3) for time and space complexity, isn&#39;t it?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1510169804, "post_id": 47187532, "comment_id": 81325758, "body": "@DanielWagner: it is possible by keeping track of the two lowest numbers."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "edited": false, "score": 0, "creation_date": 1510169818, "post_id": 47187532, "comment_id": 81325765, "body": "@AriaPahlavan &quot;Would become that complicated?&quot; The simplest obviously correct formulation of a solution that I can think of has four cases. &quot;<code>maxProd3</code> is O(N^3), isn&#39;t it?&quot; Yes, as I mentioned, it is inefficient; but useful as a specification to test against."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1510169948, "post_id": 47187532, "comment_id": 81325835, "body": "@DanielWagner: or we can hope that <i>Leetcode</i> has a good judging system <a href=\"https://leetcode.com/problems/maximum-product-of-three-numbers/description/\" rel=\"nofollow noreferrer\">leetcode.com/problems/maximum-product-of-three-numbers/&hellip;</a> :) Leetcode also has its own solution (I obtained after succesful submission), but I don&#39;t know if I&#39;m allowed to share this."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1510170713, "post_id": 47187532, "comment_id": 81326250, "body": "Interesting. The argument that this is correct is pretty subtle. I like it a lot! You might like <code>where a:b:c:_ = coerce (sort :: [Down a] -&gt; [Down a]) xs; d:e:_ = sort xs</code> (with <code>ScopedTypeVariables</code>) or similar as a prettier way of getting the three largest and two smallest elements (still in linear time). Full details <a href=\"http://lpaste.net/359898\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "edited": false, "score": 1, "creation_date": 1510173628, "post_id": 47187532, "comment_id": 81327815, "body": "I agree it&#39;s a very subtle argument and explanation.  Thanks!"}, {"owner": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "edited": false, "score": 1, "creation_date": 1510173775, "post_id": 47187532, "comment_id": 81327902, "body": "And I like the python soln too. My Java implementation was a bit more verbous/noisy, which kinda bothers me"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1510170434, "last_edit_date": 1510170434, "creation_date": 1510167280, "answer_id": 47187532, "question_id": 47187307, "link": "https://stackoverflow.com/questions/47187307/highest-product-of-3-implementation-in-haskell/47187532#47187532", "title": "highest product of 3 implementation in haskell", "body": "<h1><em>Positive</em> numbers</h1>\n\n<p>You are on the right track in the sense that you look for the highest numbers. The problem is however that <em>a</em>, <em>b</em> and <em>c</em> are not always ordered.</p>\n\n<p>Indeed say for instance that we have the numbers <code>[6,2,4]</code>. Then the way <code>(a,b,c)</code> will evolve through the recursion is:</p>\n\n<pre><code>(0,0,0) -&gt; (6,0,0) -&gt; (2,6,0) -&gt; (4,2,6)\n</code></pre>\n\n<p>But now <code>a=4</code>, so that means that if we now encounter <code>3</code>, we will <em>not</em> replace that value, whereas we can do this since we can remove the <code>2</code>.</p>\n\n<p>Although there are many ways to solve this, probably the best way to do this is to <em>maintain order</em>: ensure that <code>a &lt;= b &lt;= c</code>.</p>\n\n<p>So we can use:</p>\n\n<pre><code>sol1 = sol2' (0,0,0)\n\nsol2' (a,b,c) []     = a*b*c\nsol2' t@(a,b,c) (x:xs) = sol2' f xs\n  where f | x &gt;= c = (b,c,x)\n          | x &gt;= b = (b,x,c)\n          | x &gt; a = (x,b,c)\n          | otherwise = t\n</code></pre>\n\n<p>this produces the expected:</p>\n\n<pre><code>Prelude&gt; sol1 [1,2,3,4]\n24\nPrelude&gt; sol1 [3, 5, 1, 2, 4, 10, 0, 4, 8, 11]\n880\n</code></pre>\n\n<h1>Intermezzo: keep track of numbers if negative are present</h1>\n\n<p>Your program first takes <code>(0,0,0)</code> as the first three values. But in case for instance the list contains only negative numbers (i.e. <code>[-1,-2,-3]</code>) we of course want to keep track of these first. We can do this for instance by initializing our tuple with elements from the list:</p>\n\n<pre><code>import Data.List(sort)\n\nsol1 (xa:xb:xc:xs) = sol2' (a,b,c) xs\n    where [a,b,c] = sort [xa,xb,xc]\n</code></pre>\n\n<p>So now we take the first three elements, sort these, and use these as the first tuple. The remaining of the list is processed. This function will error in case <code>sol1</code> is not given a list with at least three elements, but in that case there probably is no answer. We can use a <code>Maybe</code> to handle the fact that the function is non-total. </p>\n\n<h1><em>all</em> numbers</h1>\n\n<p>Of course we also want to deal with negative numbers. Multiplying two negative numbers results in a positive number. So by keeping track of the two smallest numbers as well, we can then do the math properly. So first we will use another argument <code>(d,e)</code> to keep track of the smallest numbers with <code>d &lt;= e</code>:</p>\n\n<pre><code>sol1_all = sol2_all' (0,0,0) (0,0)\n\nsol2_all' (a,b,c) (d,e) []     = -- ...\nsol2_all' t@(a,b,c) u@(d,e) (x:xs) = sol2_all' f g xs\n  where f | x &gt;= c = (b,c,x)\n          | x &gt;= b = (b,x,c)\n          | x &gt; a = (x,b,c)\n          | otherwise = t\n        g | x &lt;= d = (x,d)\n          | x &lt;= e = (d,x)\n          | otherwise = u\n</code></pre>\n\n<p>So now we have obtained the greatest numbers <code>(a,b,c)</code> and the smallest numbers <code>(d,e)</code>. If <code>d</code> and <code>e</code> are indeed negative, then the only way to produce a large . So now we have the following possibilities to consider <code>a*b*c</code> and <code>c*d*e</code>. So we can write it as:</p>\n\n<pre><code>sol2_all' (a,b,c) (d,e) [] = max (a*b*c) (c*d*e)\nsol2_all' t@(a,b,c) u@(d,e) (x:xs) = sol2_all' f g xs\n  where f | x &gt;= c = (b,c,x)\n          | x &gt;= b = (b,x,c)\n          | x &gt; a = (x,b,c)\n          | otherwise = t\n        g | x &lt;= d = (x,d)\n          | x &lt;= e = (d,x)\n          | otherwise = u\n</code></pre>\n\n<p>Note however that this will not always produce the correct result here because we can count two numbers in both tuples. We can solve this by <em>properly</em>  initializing the tuples:</p>\n\n<pre><code>import Data.List(sort)\n\nsol1_all (xa:xb:xc:xs) = sol2_all' (a,b,c) (a,b) xs\n    where [a,b,c] = sort [xa,xb,xc]\n\nsol2_all' (a,b,c) (d,e) [] = max (a*b*c) (c*d*e)\nsol2_all' t@(a,b,c) u@(d,e) (x:xs) = sol2_all' f g xs\n  where f | x &gt;= c = (b,c,x)\n          | x &gt;= b = (b,x,c)\n          | x &gt; a = (x,b,c)\n          | otherwise = t\n        g | x &lt;= d = (x,d)\n          | x &lt;= e = (d,x)\n          | otherwise = u\n</code></pre>\n\n<h1>Rationale behind picking different (possibly equivalent) elements</h1>\n\n<p>How do we know that we will not use an element twice? Since we only use <code>a*b*c</code> or <code>c*d*e</code> this will - in the case of a list with three element - boils down to <code>max(a*b*c,a*b*c)</code> (<code>a</code>, <code>b</code>, and <code>c</code> here the result of <code>sort</code>). So uniqueness is guaranteed. Since we will only add elements in the first tuple if these are at least greater than <code>a</code>, and less than <code>b</code>, we know that in order for an <code>x</code> to be added in both tuples, it should be <code>a &lt;= x &lt;= b</code>. In that case we will obtain tuples <code>(x,b,c)</code> and <code>(a,x)</code>. But since we evaluate in that case <code>x*b*c</code> and <code>a*x*c</code>, <code>x</code> will thus not occur in any expression twice.</p>\n\n<h1><em>Leetcode</em> challenge</h1>\n\n<p>I submitted a Python version of this code to the <a href=\"https://leetcode.com/problems/maximum-product-of-three-numbers/description/\" rel=\"nofollow noreferrer\"><em>Leetcode Challenge</em></a> and it was accepted:</p>\n\n<pre><code>class Solution:\n    def maximumProduct(self, nums):\n        a,b,c = d,e,_ = sorted(nums[:3])\n        for x in nums[3:]:\n            if x &gt;= c:\n                a,b,c = b,c,x\n            elif x &gt;= b:\n                a,b = b,x\n            elif x &gt;= a:\n                a = x\n            if x &lt;= d:\n                d,e = x,d\n            elif x &lt; e:\n                e = x\n        return max(a*b*c,c*d*e)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "edited": false, "score": 0, "creation_date": 1510175307, "post_id": 47189274, "comment_id": 81328776, "body": "interesting! could you elaborate on how the list is being transformed to achieve the result a bit more please"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1510175839, "post_id": 47189274, "comment_id": 81329013, "body": "That, however, is rather ridiculously inefficient. A list of length n has 2^n subsequences. Roughly half of them have length at least n/2, so we&#39;re talking O(n*2^n). Youch! Compare that to Willem Van Onsem&#39;s solution, which is O(n). That&#39;s not just &quot;somewhat&quot; more efficient. There really is no way to use <code>subsequences</code> here without going exponential."}, {"owner": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "edited": false, "score": 0, "creation_date": 1510248548, "post_id": 47189274, "comment_id": 81365231, "body": "I agree that readability is very important, but O(n*2^n) is just very hurtful; also the more efficient solution by Willem Van Onsem is pretty readable too, though this solution uses more &quot;functional&quot;."}], "tags": [], "owner": {"reputation": 42360, "user_id": 389146, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/zGYUq.jpg?s=128&g=1", "display_name": "Karl Bielefeldt", "link": "https://stackoverflow.com/users/389146/karl-bielefeldt"}, "is_accepted": false, "score": 1, "last_activity_date": 1510181201, "last_edit_date": 1510181201, "creation_date": 1510173671, "answer_id": 47189274, "question_id": 47187307, "link": "https://stackoverflow.com/questions/47187307/highest-product-of-3-implementation-in-haskell/47189274#47189274", "title": "highest product of 3 implementation in haskell", "body": "<p>There are somewhat more efficient solutions, but I would lean toward something more straightforward like:</p>\n\n<pre><code>import Data.List (subsequences)\nf :: (Num a, Ord a) =&gt; [a] -&gt; a\nf = maximum . map product . filter ((==3) . length) . subsequences\n</code></pre>\n\n<p>Thinking about functional algorithms as sequences of transformations on collections makes them much more idiomatic than transforming imperative loops into recursive functions.</p>\n\n<p>Note if you are doing this with really long lists where efficiency is a concern, you can sort the list first, then take the lowest two and the highest three, and the algorithm will still work:</p>\n\n<pre><code>takeFirstLast xs = (take 2 sorted) ++ (drop (length sorted - 3) sorted)\n  where sorted = sort xs\n</code></pre>\n\n<p>However, my original way is plenty fast up to lists of size 100 or so, and is a <strong>lot</strong> easier to understand.  I don't believe in sacrificing readability for speed until I'm told it's an actual requirement.</p>\n"}], "owner": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 1, "accepted_answer_id": 47187532, "answer_count": 2, "score": 3, "last_activity_date": 1510269323, "creation_date": 1510166496, "last_edit_date": 1510231221, "question_id": 47187307, "link": "https://stackoverflow.com/questions/47187307/highest-product-of-3-implementation-in-haskell", "title": "highest product of 3 implementation in haskell", "body": "<p>I'd like the algorithm for <em>highest product of 3</em> problem implemented in haskell. Here's the problem statement:</p>\n\n<blockquote>\n  <p>Given an array of integers, find the highest product you can get from\n  three of the integers.</p>\n</blockquote>\n\n<p>For example given <code>[1, 2, 3, 4]</code>, the algorithm should return <code>24</code>. And given <code>[-10, -10, 5, 1, 6]</code>, the highest product of 3 would be <code>600 = -10*-10*6</code>.</p>\n\n<p>My attempt (assumed no negatives for the first try): </p>\n\n<pre><code>sol2' a b c []     = a*b*c\nsol2' a b c (x:xs) = sol2' a' b' c' xs\n  where \n    a' = if (x &gt; a) then x else a\n    b' = if (x &gt; a &amp;&amp; a &gt; b) then a else b\n    c' = if (x &gt; a &amp;&amp; a &gt; b &amp;&amp; b &gt; c) then b else c\n\nsol2 li = sol2' a b c li\n  where a = 0\n        b = 0 \n        c = 0\n</code></pre>\n\n<p>I tested the implementation with <code>[3, 5, 1, 2, 4, 10, 0, 4, 8, 11]</code> but the return value is <code>550</code>, which is supposed to be <code>880</code>.</p>\n"}, {"tags": ["haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 4, "creation_date": 1510165757, "post_id": 47186895, "comment_id": 81323314, "body": "This is a <a href=\"https://wiki.haskell.org/Pattern_guard\" rel=\"nofollow noreferrer\">pattern guard</a>. What do you mean by nested?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1510166172, "post_id": 47186895, "comment_id": 81323545, "body": "I find the use of <code>b</code> in <code>Just (b, _) &lt;- ..</code> to be horrible. GHC should warn about that, since it bears _no_relation to the outermost <code>b</code>. Just pretend the pattern is <code>Just (_,_) &lt;- ...</code>, since that <code>b</code> is not even used. (If it were used, the innermost <code>b</code> bindings would shadow the outermost one -- it&#39;s better to rename <code>b</code> to something else in that case)"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1510169393, "post_id": 47186895, "comment_id": 81325494, "body": "@chi Or better, <code>Just _</code>. Or really, why introduce this whole confusing <code>uncons</code> at all? Just write <code>case b of {((_:_):_) -&gt; True; otherwise = False}</code>: a list whose first item is a nonempty list."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1510175846, "post_id": 47186895, "comment_id": 81329016, "body": "@amalloy I agree. I guess the code was meant to be an example about how to use <code>uncons</code> with pattern guards. If so, perhaps a more insightful example would have been better, though."}], "owner": {"reputation": 1193, "user_id": 1024626, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1f3105b2e91741b91b5af4431e26a0d6?s=128&d=identicon&r=PG", "display_name": "pretobomba", "link": "https://stackoverflow.com/users/1024626/pretobomba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 297, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1510164982, "creation_date": 1510164982, "question_id": 47186895, "link": "https://stackoverflow.com/questions/47186895/pattern-matching-in-haskell-case-statements", "title": "Pattern matching in Haskell case statements", "body": "<p>I came across the following piece of code:</p>\n\n<pre><code>lala :: [[Int]] -&gt; Bool\nlala b = case b of\n   (a:_) | Just (b, _) &lt;- uncons a -&gt; True\n   other -&gt; False\n</code></pre>\n\n<p>While I understand that the function checks that the first element of the list is not empty (there are better ways of writing this, but that's not the point), I don't fully understand the pattern matching happening in the case statement. Is the left arrow in this case simply pattern matching on the <code>uncons</code> call? Can this style of pattern matching be nested? This almost seems like a list comprehension syntax, are there other places where this type of pattern matching can be used?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1510161674, "post_id": 47185856, "comment_id": 81320872, "body": "You&#39;re increasing your n number every time, not decreasing it. <code>2^(n-1)-1</code> is the new <code>n</code> value you pass in to the function at each call."}, {"owner": {"reputation": 7185, "user_id": 4949918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49ebe74084d2bf2feab20ec74c7b05ba?s=128&d=identicon&r=PG&f=1", "display_name": "Axnyff", "link": "https://stackoverflow.com/users/4949918/axnyff"}, "edited": false, "score": 2, "creation_date": 1510161688, "post_id": 47185856, "comment_id": 81320881, "body": "The numbers are not decreasing, you&#39;re calling mrs with 2^(n-1)-1. It looks like you inversed the number to put in the list and the number to compute"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1510162159, "post_id": 47185856, "comment_id": 81321148, "body": "Step back and ask yourself what does <code>n</code> represent when you call <code>mrs n</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1510162983, "post_id": 47185925, "comment_id": 81321614, "body": "Perhaps it is worth adding a guard that <code>n &gt; 1</code>, otherwise <code>mrs 0</code> will result in an infinite list."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1510165488, "post_id": 47185925, "comment_id": 81323175, "body": "@WillemVanOnsem Fair point. I thought the Mersenne numbers were defined only for positive <code>n</code>, but it does leave a dangerous function without that protection."}, {"owner": {"reputation": 43, "user_id": 8908375, "user_type": "registered", "profile_image": "https://graph.facebook.com/1460228620720869/picture?type=large", "display_name": "Dewayn Clark", "link": "https://stackoverflow.com/users/8908375/dewayn-clark"}, "edited": false, "score": 0, "creation_date": 1510166464, "post_id": 47185925, "comment_id": 81323711, "body": "Thanks a lot, I knew I was off  &quot;a bit&quot;. Now I think about it, it&#39;s really straight forward. First element in the list is my statement, the tail will be recursive -1 untill I reach 1. Still getting used to the syntax.  Anyway, thanks!"}], "tags": [], "owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "is_accepted": true, "score": 4, "last_activity_date": 1510161753, "creation_date": 1510161753, "answer_id": 47185925, "question_id": 47185856, "link": "https://stackoverflow.com/questions/47185856/calculating-mersenne-numbers-in-haskell/47185925#47185925", "title": "Calculating Mersenne numbers in Haskell", "body": "<p>You need to decrease your <code>n</code> value with each call, but you're currently increasing it. What you really want is probably: </p>\n\n<pre><code>mrs :: Integer -&gt; [Integer]\nmrs 1 = [0]\nmrs n = (2^(n-1)-1) : mrs (n-1)\n\n&gt; mrs 7\n[63,31,15,7,3,1,0]\n</code></pre>\n\n<p>If you want to keep the order increasing, just reverse the list: </p>\n\n<pre><code>&gt; reverse $ mrs 7\n[0,1,3,7,15,31,63]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1510174271, "post_id": 47186060, "comment_id": 81328185, "body": "The original question already wants them in <i>increasing</i> order"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 1, "last_activity_date": 1510174420, "last_edit_date": 1510174420, "creation_date": 1510162174, "answer_id": 47186060, "question_id": 47185856, "link": "https://stackoverflow.com/questions/47185856/calculating-mersenne-numbers-in-haskell/47186060#47186060", "title": "Calculating Mersenne numbers in Haskell", "body": "<p>A more declarative style to do this is probably defining a range <code>[1..n]</code> and then perform a mapping over it: <code>\\x -&gt; 2^(x-1)-1</code>:</p>\n\n<pre><code>mrs n = map (\\x -&gt; 2^(x-1)-1) [1..n]\n</code></pre>\n\n<p>or a pointfree approach:</p>\n\n<pre><code>mrs n = map (subtract 1 . (2 ^) . subtract 1) [1..n]\n</code></pre>\n\n<p>Now we can improve the situation by performing the <code>subtract 1</code> already in the range:</p>\n\n<pre><code>mrs n = map (subtract 1 . (2 ^)) [<b>0</b>..n<b>-1</b>]</code></pre>\n\n<p>This produces:</p>\n\n<pre><code>Prelude&gt; mrs 7\n[0,1,3,7,15,31,63]\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 8908375, "user_type": "registered", "profile_image": "https://graph.facebook.com/1460228620720869/picture?type=large", "display_name": "Dewayn Clark", "link": "https://stackoverflow.com/users/8908375/dewayn-clark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 47185925, "answer_count": 2, "score": 3, "last_activity_date": 1510174420, "creation_date": 1510161501, "last_edit_date": 1510169043, "question_id": 47185856, "link": "https://stackoverflow.com/questions/47185856/calculating-mersenne-numbers-in-haskell", "title": "Calculating Mersenne numbers in Haskell", "body": "<p>We have the task to build a simple recursive function displaying the <a href=\"https://en.wikipedia.org/wiki/Mersenne_prime\" rel=\"nofollow noreferrer\"><em>Mersenne number</em></a> in Haskell, sorted from smallest to biggest number.\nIt's basicly 2^n-1\nSo <code>mersenne 7</code> looks something like that <code>[0,1,3, 7, 15, 31, 63]</code></p>\n\n<p>We couldn't get it done sadly and are stuck on that piece of code.</p>\n\n<pre><code>mrs :: Integer -&gt; [Integer]\nmrs 1 = [0]\nmrs n = n : mrs (2^(n-1)-1)\n</code></pre>\n\n<p>But somehow the numbers are increasing in size while they should decrease because n is getting lower. I believe it's easy to solve and I'll feel dumb afterwards, but so be it.</p>\n\n<p>Currently, for input <code>7</code> it spits out <code>[7, 63, 46.........giant number, error]</code></p>\n\n<p>For input <code>3</code> it constantly spits out <code>3</code>'s: <code>[3,3,3,3...]</code> and lower than that tells me about negativ exponents.</p>\n\n<p>We are quite new to Haskell, all googling and reading through scripts didn't work.</p>\n"}, {"tags": ["haskell", "multidimensional-array"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 2, "creation_date": 1510160746, "post_id": 47185541, "comment_id": 81320255, "body": "Please reduce your code to the minimal amount necessary to illustrate what you are asking about. For example, the <code>nextGen</code> functions seems irrelevant to your question. You can create a hard-coded <code>Board</code> to print. Also, show the output you actually get and explain how it differs from what you want. For more tips to improve your question to attract the answers you want, see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1510161166, "post_id": 47185541, "comment_id": 81320544, "body": "I think my nextGen is relevant to se how everything works. But now i&#39;ve fixed my output suggestions"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1510161315, "post_id": 47185541, "comment_id": 81320659, "body": "Your question is about <b>printing</b>. The only important data is the input to your print function. Where that data comes from is irrelevant. The <b>format</b> of the data is extremely important. You need to figure out how to transform the format of the input data into the format you wish to output."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1510161505, "post_id": 47185541, "comment_id": 81320778, "body": "Breaking problems into small parts is an extremely important skill as a programmer.  This means that you need to focus on the details which are important to the current problem <b>and ignore everything else</b>."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1510161601, "post_id": 47185541, "comment_id": 81320829, "body": "Your edit is much better. Can you find anything else to remove that is not important to your current question? Can you also add a <code>main</code> function with a contrived <code>Board</code> object that is used to call <code>printArray</code>?"}, {"owner": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1510161611, "post_id": 47185541, "comment_id": 81320833, "body": "Hmm, thank you, that&#39;s true."}, {"owner": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1510161788, "post_id": 47185541, "comment_id": 81320937, "body": "Maybe the set and get functions? And no, I don&#39;t think i&#39;m good enough in haskell to do that.."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1510161855, "post_id": 47185541, "comment_id": 81320982, "body": "You can also think of it from another angle: what code do you need for <code>printArray</code> to compile? Get rid of anything that is not absolutely necessary for this."}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "edited": false, "score": 0, "creation_date": 1510162255, "post_id": 47185930, "comment_id": 81321201, "body": "I&#39;m going to try this approach to begin with, thank you. I&#39;ll come back to you!"}], "tags": [], "owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "is_accepted": false, "score": 1, "last_activity_date": 1510161766, "creation_date": 1510161766, "answer_id": 47185930, "question_id": 47185541, "link": "https://stackoverflow.com/questions/47185541/haskell-print-out-2d-array/47185930#47185930", "title": "Haskell print out 2d array", "body": "<p>To start to answer your question, I suggest breaking the problem into several pieces:</p>\n\n<ol>\n<li>Print out the numbers across the top.</li>\n<li>Number each row as you print them.</li>\n<li>Decide what symbol to print in each cell.</li>\n</ol>\n\n<p>Tackle each of these pieces one at a time. If it helps, rather than think in terms of \"printing\" just build up a <code>String</code> object. Once you have a <code>String</code>, printing is pretty trivial.</p>\n"}], "owner": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 820, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510161766, "creation_date": 1510160524, "last_edit_date": 1510161472, "question_id": 47185541, "link": "https://stackoverflow.com/questions/47185541/haskell-print-out-2d-array", "title": "Haskell print out 2d array", "body": "<p>I'm trying to print out my 2d array in game of life, but i'm not quite sure how to go on with it. So I need some help with my printArray function I'm not quite sure how to proceed. Her is the code below, everything is working.. Except printing it out in the right manner. </p>\n\n<pre><code>module GameOfLife where\nimport Data.List\nimport System.IO\nimport Text.Show\nimport Data.Array\nimport System.Random\n\nwidth :: Int\nwidth = 5\n\nheight :: Int\nheight = 5\n\ndata State = Alive | Dead deriving (Eq, Show)\ntype Pos = (Int,Int)\ntype Board = Array Pos State\n\nstartBoard :: Pos -&gt; Board\nstartBoard (width,height) =\n  let bounds = ((0,0),(width - 1,height - 1))\n  in array bounds $ zip (range bounds) (repeat Dead)\n\nset :: Board -&gt; [(Pos,State)] -&gt; Board\nset = (//)\n\nget :: Board -&gt; [Pos] -&gt; [State]\nget board pos = map (board!) pos\n\nneighbours :: Board -&gt; Pos -&gt; [Pos]\nneighbours board c@(x,y) =\n  filter (/= c) $ filter (inRange (bounds board)) [(x',y') | x' &lt;- [x -             \n 1..x + 1], y' &lt;- [y - 1..y + 1]]\n\nnextGen :: Board -&gt; Board\nnextGen board =(irrelevant code for the question..)\n\n\nprintArray :: Board -&gt; String\nprintArray arr =\n  unlines [unwords [show (arr ! (x, y)) | x &lt;- [1..5]] | y &lt;- [1..5]]\n</code></pre>\n\n<p>My output:</p>\n\n<pre><code>[((0,0),Dead),((0,1),Dead),((0,2),Dead),((0,3),Dead),((1,0),Dead),\n((1,1),Dead),((1,2),Dead),((1,3),Dead),((2,0),Dead),((2,1),Dead),\n((2,2),Dead)2,3),Dead)]\n</code></pre>\n\n<p>My preferable output:</p>\n\n<pre><code>   1  2  3  4  5\n 1 .  .  .  .  .\n 2 n  n  n  .  .\n 3 n  X  n  .  .\n 4 n  n  n  .  .\n 5 .  .  .  .  .\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1510160123, "post_id": 47185328, "comment_id": 81319810, "body": "Ask yourself this: What if I did <code>match (Tuple [B True]) (Tuple [N 10])</code>? What should happen then?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1510160185, "post_id": 47185328, "comment_id": 81319853, "body": "You do not wrap the resulting list back in a <code>Term</code> constructor. Furhermore you perform recursion, but that recursion will yield a <code>Record</code>, so you should unwrap that record and prepend it with a value and wrap it back into a <code>Term</code> constructor."}, {"owner": {"reputation": 491, "user_id": 5137138, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e37c34a79c1a83fe429961233358ef39?s=128&d=identicon&r=PG&f=1", "display_name": "Leomar de Souza", "link": "https://stackoverflow.com/users/5137138/leomar-de-souza"}, "reply_to_user": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1510160572, "post_id": 47185328, "comment_id": 81320114, "body": "@SilvioMayolo In this case, it should return an error because it is not part of the specifications of a Record. At the moment, I did not even validate the entries yet, because I could not get out of this error. But it is still necessary to validate the entries so that the first Tuple is only of type S (String) and also, the two Tuplets have to have the same amount of elements. After I can resolve this error, I will work on this validation."}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1510160669, "post_id": 47185328, "comment_id": 81320188, "body": "You can&#39;t <i>not</i> validate, though. Haskell won&#39;t let you deal with invalid data, by virtue of how powerful the type system is. So you <i>have</i> to deal with the non-<code>S</code> case, even if it&#39;s just to call <code>error</code> (which happens by default if you pattern match and don&#39;t provide an alternative)."}, {"owner": {"reputation": 491, "user_id": 5137138, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e37c34a79c1a83fe429961233358ef39?s=128&d=identicon&r=PG&f=1", "display_name": "Leomar de Souza", "link": "https://stackoverflow.com/users/5137138/leomar-de-souza"}, "reply_to_user": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1510160835, "post_id": 47185328, "comment_id": 81320312, "body": "@SilvioMayolo That&#39;s right, I expressed myself poorly in what I said. That&#39;s exactly what you said. Sorry for the mistake :)"}, {"owner": {"reputation": 491, "user_id": 5137138, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e37c34a79c1a83fe429961233358ef39?s=128&d=identicon&r=PG&f=1", "display_name": "Leomar de Souza", "link": "https://stackoverflow.com/users/5137138/leomar-de-souza"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1510160963, "post_id": 47185328, "comment_id": 81320413, "body": "@WillemVanOnsem Thanks for the information on how to solve the error, I will try to work on it. I&#39;m still learning Haskell. It&#39;s totally new to me."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1510198996, "post_id": 47185328, "comment_id": 81336163, "body": "Please never paste pictures of error messages. Copy and paste the text."}], "answers": [{"comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1510160596, "post_id": 47185529, "comment_id": 81320131, "body": "Imho, this does not really answers the question what is wrong with the code. It provides some good suggestions about improving it, but does not point to the error that the OP aims to solve."}], "tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": false, "score": 1, "last_activity_date": 1510160480, "creation_date": 1510160480, "answer_id": 47185529, "question_id": 47185328, "link": "https://stackoverflow.com/questions/47185328/couldnt-match-expected-type-term/47185529#47185529", "title": "Couldn&#39;t match expected type \u2018Term\u2019", "body": "<p><code>x</code> is a <code>Term</code> but in order to return the type you want, you need it to be a <code>Label</code>. So you need to pattern match on the label.</p>\n\n<pre><code>match (Tuple (S x : xs)) (Tuple (z : zs)) = [(x, z)] ++ match (Tuple xs) (Tuple zs)\n</code></pre>\n\n<p>But this raises the question: what if I pass <code>match (Tuple [B True]) (Tuple [N 10])</code>? We can't, according to your types, define a <code>Record</code> with a Boolean for a key. So should the program crash? Or should we get some \"default\" behavior? You might consider changing match so that it takes <code>[Label]</code> as its first argument, rather than a general <code>Term</code>. This eliminates the need to do all this pattern matching, so it's clearer, and it stops people from being able to pass nonsense data to it, so it's more correct.</p>\n\n<p>If for some reason you need people to be able to pass a general <code>Term</code> to <code>match</code>, you might consider returning a <code>Maybe</code> so you can gracefully handle the failure case.</p>\n"}, {"comments": [{"owner": {"reputation": 491, "user_id": 5137138, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e37c34a79c1a83fe429961233358ef39?s=128&d=identicon&r=PG&f=1", "display_name": "Leomar de Souza", "link": "https://stackoverflow.com/users/5137138/leomar-de-souza"}, "edited": false, "score": 0, "creation_date": 1510246538, "post_id": 47189299, "comment_id": 81363882, "body": "Thank you. I really was having a hard time resolving this issue. Your solution was perfect."}, {"owner": {"reputation": 491, "user_id": 5137138, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e37c34a79c1a83fe429961233358ef39?s=128&d=identicon&r=PG&f=1", "display_name": "Leomar de Souza", "link": "https://stackoverflow.com/users/5137138/leomar-de-souza"}, "edited": false, "score": 0, "creation_date": 1510279702, "post_id": 47189299, "comment_id": 81378747, "body": "If possible, I would like you to clarify a question about the &lt;$&gt; operator in the third line of zipSame. The use of this operator is new to me, because I did not know it before. What&#39;s the difference to just using $ and &lt;$&gt;?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 491, "user_id": 5137138, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e37c34a79c1a83fe429961233358ef39?s=128&d=identicon&r=PG&f=1", "display_name": "Leomar de Souza", "link": "https://stackoverflow.com/users/5137138/leomar-de-souza"}, "edited": false, "score": 0, "creation_date": 1510286167, "post_id": 47189299, "comment_id": 81380257, "body": "@LeomardeSouza, <code>&lt;$&gt;</code> is an infix version of <code>fmap</code>. I&#39;m mapping over the <code>Maybe</code> to apply a function to whatever (if anything) is inside. In this context, it is used with type <code>(&lt;$&gt;) :: (a -&gt; b) -&gt; Maybe a -&gt; Maybe b</code>, but it actually works for any <code>Functor</code>."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 1, "last_activity_date": 1510174668, "last_edit_date": 1510174668, "creation_date": 1510173741, "answer_id": 47189299, "question_id": 47185328, "link": "https://stackoverflow.com/questions/47185328/couldnt-match-expected-type-term/47189299#47189299", "title": "Couldn&#39;t match expected type \u2018Term\u2019", "body": "<p>The problem is the line</p>\n\n<pre><code>match (Tuple (x:xs)) (Tuple (z:zs)) = [(x,z)] ++ match (Tuple xs) (Tuple zs)\n</code></pre>\n\n<p>The result of the recursive call will be a <code>Term</code>, so you can't apply the list concatenation operator, <code>++</code>, to it. Furthermore, the result of such a concatenation would be a list, not a <code>Term</code>, so you'd end up with the wrong result type.</p>\n\n<p>The underlying operation here is really just the standard</p>\n\n<pre><code>zip :: [a] -&gt; [b] -&gt; [(a,b)]\n</code></pre>\n\n<p>so let's build on that:</p>\n\n<pre><code>match (Tuple labels) (Tuple terms) = Record (zip labels terms)\n</code></pre>\n\n<p>As others have noted, this is a bit strange, because it will fail for non-<code>Tuple</code> values. So you likely want something more like</p>\n\n<pre><code>match2 :: [Label] -&gt; [Term] -&gt; Term\nmatch2 labels values = Record (zip labels values)\n</code></pre>\n\n<p>But this still seems surprising, because it doesn't seem to make much sense to build a record from label and value lists of different lengths. Perhaps you could use</p>\n\n<pre><code>match3 :: [Label] -&gt; [Term] -&gt; Maybe Term\nmatch3 ls ts = Record &lt;$&gt; zipSame ls ts\n\nzipSame :: [a] -&gt; [b] -&gt; Maybe [(a,b)]\nzipSame [] [] = Just []\nzipSame (l:ls) (t:ts) = ((l,t):) &lt;$&gt; zipSame ls ts\nzipSame _ _ = Nothing\n</code></pre>\n"}], "owner": {"reputation": 491, "user_id": 5137138, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e37c34a79c1a83fe429961233358ef39?s=128&d=identicon&r=PG&f=1", "display_name": "Leomar de Souza", "link": "https://stackoverflow.com/users/5137138/leomar-de-souza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 47189299, "answer_count": 2, "score": 1, "last_activity_date": 1510174668, "creation_date": 1510159877, "last_edit_date": 1510160078, "question_id": 47185328, "link": "https://stackoverflow.com/questions/47185328/couldnt-match-expected-type-term", "title": "Couldn&#39;t match expected type \u2018Term\u2019", "body": "<p>I'm trying to develop a <code>match</code> function to combine two Tuplas into a Record, which has the following combination [(Label, Value)]. The first Tuple, there must be only elements of type String and the second Tuple can be any other type of element.</p>\n\n<p>The code is:</p>\n\n<pre><code>type RItem = (Label, Term)\n\ntype TItem = (Term)\n\ntype Label = String\n\ndata Term = Record [RItem]\n          | Tuple [TItem]\n          | B Bool\n          | N Int\n          | S String\n        deriving(Eq, Show)  \n\nmatch :: Term -&gt; Term -&gt; Term\nmatch (Tuple _) (Tuple []) = Record []\nmatch (Tuple []) (Tuple _) = Record []\nmatch (Tuple (x:xs)) (Tuple (z:zs)) = [(x,z)] ++ match (Tuple xs) (Tuple zs)\n</code></pre>\n\n<p>However, at the time of compiling the above code, this error is shown:</p>\n\n<p><a href=\"https://i.stack.imgur.com/QxPLa.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QxPLa.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>An example of code that should be written and working in this program is:</p>\n\n<pre><code>&gt; t1 = Tuple [(S \"a\"), (S \"b\")]\n&gt; t2 = Tuple [(N 10), (N 20)]\n&gt; match t1 t2\n</code></pre>\n\n<p>And the valid result should be a Record as follows:: <code>Record [(\"a\", 10), (\"b\", 20)]</code>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1510156729, "post_id": 47183904, "comment_id": 81317425, "body": "Ideally, GHC would conjure up such instances and tuple types on a need basis. I think some other SO answer had mentioned that there is no fundamental obstacle to that: only some engineering work in GHC. Since not many people need very large tuples, the stopgap solution is to include some fixed number of tuples and some fixed number of instances for these."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1510156823, "post_id": 47183904, "comment_id": 81317508, "body": "Think of it as a suggestion: if you have tuples that <i>aren&#39;t</i> covered by the pre-defined instances, you might want to reconsider your design."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1510157771, "post_id": 47183904, "comment_id": 81318199, "body": "The .NET library also has such <code>Tuple&lt;&gt;</code>s (up to 10 elements if I&#39;m correct). These are not very common, but easy to use as &quot;generic&quot; types in case these are simply intermediate results."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1510158092, "post_id": 47183904, "comment_id": 81318431, "body": "I&#39;ve often wondered if it weren&#39;t smart if Haskell had no tuple-types with more than two elements at all, and instead just defined <code>(a,...,x)</code> as syntactic sugar for <code>((a,...),x)</code>. Then all we&#39;d need would be <code>instance (Ord a, Ord b) =&gt; Ord (a,b)</code>. Tuples with more than two elements are seldom used anyway, more than four are highly frowned upon."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1510158743, "post_id": 47183904, "comment_id": 81318893, "body": "@leftaroundabout I&#39;d like the inductive nature of what you propose, but the extra pointer indirections under the hood sound a bit unpalatable. Unless GHC had some guarantees about being able to get rid of some of those..."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1510161445, "post_id": 47183904, "comment_id": 81320739, "body": "@Alec for performance-critical stuff, you surely wouldn&#39;t want to use boxed tuples anyway..."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1510162096, "post_id": 47183904, "comment_id": 81321115, "body": "@leftaroundabout Being performance-critical isn&#39;t something that is binary. I think 3+ tuples have (and should have!) some widespread use. Because they are used so widely, I think they should be optimized as much as their abstract interface allows."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1510162990, "post_id": 47183904, "comment_id": 81321617, "body": "@leftaroundabout IIRC, Isabelle/HOL (and maybe Agda?) uses that encoding for larger tuples. In a non-terminating language, the additional bottoms could be undesired, though. Also note that in Haskell we have <code>HList</code> which is almost the same thing -- except it is not used very much."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1510167099, "post_id": 47183904, "comment_id": 81324067, "body": "@leftaroundabout A talk about inductive tuples from ICFP 2016 <a href=\"https://www.youtube.com/watch?v=6BqEt9d-amM\" rel=\"nofollow noreferrer\">youtube.com/watch?v=6BqEt9d-amM</a>"}], "owner": {"reputation": 1, "user_id": 8107769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c82915f2fc83a633ab55e8473577f12?s=128&d=identicon&r=PG&f=1", "display_name": "Noud Savenije", "link": "https://stackoverflow.com/users/8107769/noud-savenije"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510155879, "creation_date": 1510155879, "question_id": 47183904, "link": "https://stackoverflow.com/questions/47183904/why-are-very-long-instances-of-certain-type-classes-included-in-the-prelude", "title": "Why are very long instances of certain type classes included in the prelude?", "body": "<p>In the haskell prelude there are instances for very big tuples. For example:</p>\n\n<pre><code>(Ord a, Ord b, Ord c, Ord d, Ord e, Ord f, Ord g, Ord h, Ord i, Ord j, Ord k) =&gt; Ord (a, b, c, d, e, f, g, h, i, j, k)\n(Eq a, Eq b, Eq c, Eq d, Eq e, Eq f, Eq g, Eq h, Eq i, Eq j, Eq k) =&gt; Eq (a, b, c, d, e, f, g, h, i, j, k)\n</code></pre>\n\n<p>Bounded, Read and Show also derive similar instances.\nCan anyone explain to me why these instances are included in the prelude? Are datatypes that use them commonly used and if so, what for? And couldn't you just easily derive your own instance for such a datatype?</p>\n"}, {"tags": ["sorting", "haskell", "iteration"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 2, "creation_date": 1510152467, "post_id": 47182529, "comment_id": 81314123, "body": "You have to show your <code>checksorted</code> function. I have a suspicion that it has a type of <code>[Int] -&gt; Bool</code>, not <code>[a] -&gt; Bool</code>."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1510157532, "post_id": 47182529, "comment_id": 81318038, "body": "What are the declarations for the sort functions?"}], "answers": [{"tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": false, "score": 1, "last_activity_date": 1510152488, "creation_date": 1510152488, "answer_id": 47182660, "question_id": 47182529, "link": "https://stackoverflow.com/questions/47182529/haskell-comparing-sorting-algorithms/47182660#47182660", "title": "Haskell Comparing Sorting Algorithms", "body": "<p>At least one of <code>checksorted</code>, <code>mergesort</code>, <code>insertionSort</code>, or <code>qsort</code> must take the type <code>[Int]</code> to get that error.</p>\n\n<p>The error message is telling you that you specified that <code>sortCheck</code> should work for a list of any type, as long as the type has an <code>Ord</code> instance, but the inferred type from the body requires a list of <code>Int</code>.</p>\n\n<p><code>~</code> is the type equality constraint.<code>(a ~ Int)</code> can be read as \"<code>a</code> is equal to <code>Int</code>\".</p>\n"}], "owner": {"reputation": 23, "user_id": 6765188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e6c6c057cde61e36e2c57bdfce22629?s=128&d=identicon&r=PG&f=1", "display_name": "Ed Bramworth", "link": "https://stackoverflow.com/users/6765188/ed-bramworth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1510153242, "creation_date": 1510152106, "last_edit_date": 1510153242, "question_id": 47182529, "link": "https://stackoverflow.com/questions/47182529/haskell-comparing-sorting-algorithms", "title": "Haskell Comparing Sorting Algorithms", "body": "<p>Basically I want to write a function that takes a single list as an input, applies a list of sorting algorithms to that list, and then returns a Boolean indicating whether they all yielded a sorted list or not.</p>\n\n<p>(<code>checksorted</code> is a function I wrote that takes a list and returns a Boolean indicating whether it is sorted or not) </p>\n\n<p>This is the code I started with:</p>\n\n<pre><code>sortCheck :: Ord a =&gt; [a] -&gt; Bool\n\nsortCheck xs = checkSorted(mergeSort xs) &amp;&amp; checkSorted(insertionSort xs) &amp;&amp; checkSorted(qSort xs)\n</code></pre>\n\n<p>When I try to compile this, I get some sort of type error:\n<code>could not deduce (a ~ Int)</code></p>\n\n<p>How could I do this using an infinite list?</p>\n\n<p>EDIT: This is my checksorted algorithm</p>\n\n<pre><code>checkSorted :: Ord a =&gt; [a] -&gt; Bool\ncheckSorted [] = True\ncheckSorted [x] = True\ncheckSorted (x:y:xs) = x &lt;= y &amp;&amp; checkSorted (y:xs)\n</code></pre>\n"}, {"tags": ["haskell", "arguments"], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 3, "last_activity_date": 1510151776, "last_edit_date": 1510151776, "creation_date": 1510151026, "answer_id": 47182199, "question_id": 47181582, "link": "https://stackoverflow.com/questions/47181582/haskell-equation-as-argument-in-a-function/47182199#47182199", "title": "Haskell: Equation as argument in a function", "body": "<p>Yes; you need to create a data type that <em>represents</em> a formula, rather than passing a Haskell expression that needs to be evaluated. For example,</p>\n\n<pre><code>data Formula = Term Int Int   -- coefficient and exponent\n             | Sum Formula Formula deriving Show\n\nderive :: Formula -&gt; Formula\nderive (Term coeff exp) = Term (coeff * exp) (exp - 1)\nderive (Sum x y) = Sum (derive x) (derive y)\n\nmain = print (derive $ Sum (Term 1 2) (Term (-1) 1))\n</code></pre>\n"}], "owner": {"reputation": 333, "user_id": 7441934, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gKmnB.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7441934/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 47182199, "answer_count": 1, "score": 0, "last_activity_date": 1510151776, "creation_date": 1510149419, "question_id": 47181582, "link": "https://stackoverflow.com/questions/47181582/haskell-equation-as-argument-in-a-function", "title": "Haskell: Equation as argument in a function", "body": "<p>Is there any way I can make a function that takes a mathematical equation as an argument? For example</p>\n\n<pre><code>derive :: --equation\n...\nmain = print (derive $ x**2-x)\n</code></pre>\n\n<p>Would I need to make a custom data type?</p>\n"}, {"tags": ["haskell", "monads", "functor", "complex-numbers", "applicative"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1510149281, "post_id": 47181078, "comment_id": 81311844, "body": "They are law-abiding instances, so there is no reason for them not to exist (this is the &#39;mathematical&#39; basis)"}, {"owner": {"reputation": 1889, "user_id": 4540658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/9vCJz.jpg?s=128&g=1", "display_name": "Dannyu NDos", "link": "https://stackoverflow.com/users/4540658/dannyu-ndos"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1510149407, "post_id": 47181078, "comment_id": 81311942, "body": "So there are no connections to complex analysis, and complex numbers are just size-two arrays here?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1510157215, "post_id": 47181078, "comment_id": 81317810, "body": "Complex numbers <i>are</i>, in some sense, just arrays of size 2. \u2102 is isomorphic to \u211d&#178;."}], "answers": [{"comments": [{"owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 0, "creation_date": 1527951270, "post_id": 47182104, "comment_id": 88326239, "body": "Why use <code>pure f &lt;*&gt; pure a &lt;*&gt; b</code> instead of <code>f a &lt;$&gt; b</code>?"}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 8, "last_activity_date": 1510151802, "last_edit_date": 1510151802, "creation_date": 1510150795, "answer_id": 47182104, "question_id": 47181078, "link": "https://stackoverflow.com/questions/47181078/meaning-and-usage-of-complex-number-functor-and-monad/47182104#47182104", "title": "Meaning and usage of complex number functor and monad?", "body": "<p><em>Edited</em> to add note at bottom re: \"linear\" package.</p>\n\n<p>The instances were added as per this <a href=\"https://ghc.haskell.org/trac/ghc/ticket/10609\" rel=\"noreferrer\">Trac 10609 ticket</a> initiated by <a href=\"https://mail.haskell.org/pipermail/libraries/2015-June/025886.html\" rel=\"noreferrer\">a mailing list post</a> where Fumiaki Kinoshita noted that there were some missing instances in the base libraries that seemed to be definable in only one way and proposed a patch to add them.</p>\n\n<p>As far as I can see, there was no mathematical motivation for adding them, though there's at least one mathematically meaningful operation that can be expressed applicatively, namely scalar multiplication:</p>\n\n<pre><code>&gt; pure (*) &lt;*&gt; pure 2 &lt;*&gt; (3 :+ 4)\n6 :+ 8\n&gt;\n</code></pre>\n\n<p>In a <a href=\"https://mail.haskell.org/pipermail/libraries/2015-June/025897.html\" rel=\"noreferrer\">follow-up</a> to the above mailing list post, Edward Kmett noted that he was in favor because he'd had to add orphan instances for <code>Complex</code> to his <code>linear</code> package for years to make up for the missing instances.</p>\n\n<p>It looks like he found them useful in defining an <code>Additive</code> instance for <code>Complex</code> thus essentially making a <code>Complex</code> a special case of a two dimensional vector.</p>\n"}], "owner": {"reputation": 1889, "user_id": 4540658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/9vCJz.jpg?s=128&g=1", "display_name": "Dannyu NDos", "link": "https://stackoverflow.com/users/4540658/dannyu-ndos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 47182104, "answer_count": 1, "score": 10, "last_activity_date": 1510151802, "creation_date": 1510147958, "question_id": 47181078, "link": "https://stackoverflow.com/questions/47181078/meaning-and-usage-of-complex-number-functor-and-monad", "title": "Meaning and usage of complex number functor and monad?", "body": "<p>I was kinda surprised when I read the source code of instances of <code>Applicative Complex</code> and <code>Monad Complex</code> from GHC <code>Data.Complex</code> module:</p>\n\n<pre><code>-- | @since 4.9.0.0\ninstance Applicative Complex where\n  pure a = a :+ a\n  f :+ g &lt;*&gt; a :+ b = f a :+ g b\n  liftA2 f (x :+ y) (a :+ b) = f x a :+ f y b\n\n-- | @since 4.9.0.0\ninstance Monad Complex where\n  a :+ b &gt;&gt;= f = realPart (f a) :+ imagPart (f b)\n</code></pre>\n\n<p>What the...? The <code>Applicative Complex</code> instance seems to treat complex numbers as just size-two arrays. And they both seem more like arrow operations. Is there any mathematical basis behind them? Either there is or not, what are they used for?</p>\n"}, {"tags": ["haskell", "pattern-matching", "ocaml"], "answers": [{"tags": [], "owner": {"reputation": 2970, "user_id": 7443386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e4614d70f2beccd13ed9e18a42ad5ab?s=128&d=identicon&r=PG", "display_name": "&#201;tienne Millon", "link": "https://stackoverflow.com/users/7443386/%c3%89tienne-millon"}, "is_accepted": true, "score": 18, "last_activity_date": 1510146635, "creation_date": 1510146635, "answer_id": 47180637, "question_id": 47180583, "link": "https://stackoverflow.com/questions/47180583/ocaml-equivalent-to-haskells-in-pattern-matching-a-k-a-as-pattern/47180637#47180637", "title": "OCaml equivalent to Haskell&#39;s @ in pattern matching (a.k.a. as-pattern)", "body": "<p>You can use <code>as</code>:</p>\n\n<pre><code>let f = function\n| [] -&gt; (* ... *)\n| (x::xs) as l -&gt;\n  (*\n   here:\n   - x is the head\n   - xs is the tail\n   - l is the whole list\n  *)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28350, "user_id": 2625442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a48a497d3aae41354bc1189d57db2c3?s=128&d=identicon&r=PG", "display_name": "ivg", "link": "https://stackoverflow.com/users/2625442/ivg"}, "is_accepted": false, "score": 13, "last_activity_date": 1510148221, "last_edit_date": 1510148221, "creation_date": 1510147563, "answer_id": 47180941, "question_id": 47180583, "link": "https://stackoverflow.com/questions/47180583/ocaml-equivalent-to-haskells-in-pattern-matching-a-k-a-as-pattern/47180941#47180941", "title": "OCaml equivalent to Haskell&#39;s @ in pattern matching (a.k.a. as-pattern)", "body": "<p>Let me extend Etienne's answer a little bit with some examples:</p>\n\n<pre><code>let x :: xs as list = [1;2;3];;\nval x : int = 1\nval xs : int list = [2; 3]\nval list : int list = [1; 2; 3]\n</code></pre>\n\n<p>When you write <code>&lt;pattern&gt; as &lt;name&gt;</code>, the variable <code>&lt;name&gt;</code> is bound to the whole pattern on the left, in other words, the scope of <code>as</code> extends as far to the left as possible (speaking more techically  <code>as</code> has lower priority than constructors, i.e., the constructors bind tighter). So, in case of the deep pattern matching, you might need to use parentheses to limit the scope, e.g.,</p>\n\n<pre><code>let [x;y] as fst :: ([z] as snd) :: xs as list = [[1;2];[3]; [4]];;\nval x : int = 1\nval y : int = 2\nval fst : int list = [1; 2]\nval z : int = 3\nval snd : int list = [3]\nval xs : int list list = [[4]]\nval list : int list list = [[1; 2]; [3]; [4]]\n</code></pre>\n"}], "owner": {"reputation": 7284, "user_id": 1757964, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GGs4H.jpg?s=128&g=1", "display_name": "APerson", "link": "https://stackoverflow.com/users/1757964/aperson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "accepted_answer_id": 47180637, "answer_count": 2, "score": 8, "last_activity_date": 1510148221, "creation_date": 1510146504, "last_edit_date": 1510146815, "question_id": 47180583, "link": "https://stackoverflow.com/questions/47180583/ocaml-equivalent-to-haskells-in-pattern-matching-a-k-a-as-pattern", "title": "OCaml equivalent to Haskell&#39;s @ in pattern matching (a.k.a. as-pattern)", "body": "<p>In Haskell, while pattern matching, I can use <code>@</code> to get the entire structure in a pattern. (For easier Googling, this structure is known as an as-pattern.)</p>\n\n<p>For example, <code>x:xs</code> decomposes a list into a head and a tail; I can also get the entire list with <code>xxs@(x:xs)</code>.</p>\n\n<p>Does OCaml have something like this?</p>\n"}, {"tags": ["haskell", "instance", "show"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1510143989, "post_id": 47179611, "comment_id": 81308183, "body": "But <code>Handler</code> is a function. How can you <code>Show</code> a function? You also defined type aliasses, instead of new types."}], "answers": [{"tags": [], "owner": {"reputation": 4565, "user_id": 1134885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c428466054762cf7d4b5fb5f4396fa2?s=128&d=identicon&r=PG", "display_name": "NovaDenizen", "link": "https://stackoverflow.com/users/1134885/novadenizen"}, "is_accepted": false, "score": 1, "last_activity_date": 1510352658, "creation_date": 1510352658, "answer_id": 47232056, "question_id": 47179611, "link": "https://stackoverflow.com/questions/47179611/show-instance-for-a-type/47232056#47232056", "title": "Show instance for a type", "body": "<p>You can't usefully define <code>Show Handler</code> because it's a function type.  You have no way to break a function value down and show anything useful.</p>\n\n<p>You don't need to define <code>Show Store</code> because it's already defined, based on <code>instance (Show a, Show b) =&gt; Show (a,b)</code> and <code>instance Show a =&gt; Show [a]</code> from the Prelude.</p>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 1, "last_activity_date": 1510354313, "creation_date": 1510354313, "answer_id": 47232339, "question_id": 47179611, "link": "https://stackoverflow.com/questions/47179611/show-instance-for-a-type/47232339#47232339", "title": "Show instance for a type", "body": "<p>If you want to show handlers, I suggest bundling a name with the handler:</p>\n\n<pre><code>data Handler = Handler String ([String] -&gt; Store -&gt; IO Store)\n</code></pre>\n\n<p>Then when you create a handler you give it a name:</p>\n\n<pre><code>myHandler :: Handler\nmyHandler = Handler \"my handler\" $ \\args store -&gt; do\n    ...\n</code></pre>\n\n<p>and you can use the name to show the handler:</p>\n\n<pre><code>instance Show Handler where\n    show (Handler name _) = \"&lt;handler \" ++ show name ++ \"&gt;\"\n</code></pre>\n"}], "owner": {"reputation": 353, "user_id": 8906596, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10207778167811470/picture?type=large", "display_name": "Adrien Varet", "link": "https://stackoverflow.com/users/8906596/adrien-varet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 763, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545123803, "creation_date": 1510143643, "last_edit_date": 1545123803, "question_id": 47179611, "link": "https://stackoverflow.com/questions/47179611/show-instance-for-a-type", "title": "Show instance for a type", "body": "<p>I have those types in my program : </p>\n\n<pre><code>type Store = [(String, Float)]\ntype Handler = [String] -&gt; Store -&gt; IO (Store)\n\ndata Command = Command {\n    name :: String,        -- Nom de la commande\n    description :: String, -- Description de la commande\n    exits :: Bool,         -- Drapeau pour sortir de la boucle \n                           -- Vrai pour quit, faux pour les autres\n    run :: Handler         -- Le code \u00e0 executer             \n}\n</code></pre>\n\n<p>I want to create two instance for <code>Show Handler</code> and <code>Show Store</code> but I don't know the right syntax of <code>Show Instance</code> for types.</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "edited": false, "score": 0, "creation_date": 1510144896, "post_id": 47179563, "comment_id": 81308816, "body": "What are you trying to accomplish with the getWordsInfo function? Getting the number of characters in words with a length greater than 2 which are all alphanumeric? If so then you don&#39;t really need to use a foldl, you can just use sum."}, {"owner": {"reputation": 145, "user_id": 1007935, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/de45a111a477254b06722ab142f744a1?s=128&d=identicon&r=PG", "display_name": "momi", "link": "https://stackoverflow.com/users/1007935/momi"}, "reply_to_user": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "edited": false, "score": 0, "creation_date": 1510145532, "post_id": 47179563, "comment_id": 81309259, "body": "Nevermind, in folding function I could do other stuff that return Int, just I am wondering why this won&#39;t compile...."}], "answers": [{"tags": [], "owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "is_accepted": true, "score": 5, "last_activity_date": 1510146482, "last_edit_date": 1510146482, "creation_date": 1510145738, "answer_id": 47180318, "question_id": 47179563, "link": "https://stackoverflow.com/questions/47179563/haskell-expected-type-trouble/47180318#47180318", "title": "haskell expected type trouble", "body": "<p>You appear to be using point free notation incorrectly.</p>\n\n<p>The only line of this that is wrong is:</p>\n\n<p><code>let wordList = filter (\\x -&gt; length x &gt; 2 &amp;&amp; all isAlpha x) . words</code></p>\n\n<p>The error message is saying that when you call wordList it hasn't been applied to enough arguments, it is expecting a list of lists, but instead has been given a function which takes a string and produces a list of lists. So, we simply need to give the wordList function the input string.</p>\n\n<p>You can rewrite it two ways:</p>\n\n<p>The first is by explicitly specifying the argument:</p>\n\n<pre><code>getWordsInfo xs = let wordList = filter (\\x -&gt; length x &gt; 2 &amp;&amp; all isAlpha x) (words xs)\n                  in foldl foldingFunction 0 wordList\n                    where foldingFunction acc tWord = acc + length tWord\n</code></pre>\n\n<p>The second is by keeping the point free bit not in a let binding:</p>\n\n<pre><code>getWordsInfo = foldl foldingFunction 0 . filter (\\x -&gt; length x &gt; 2 &amp;&amp; all isAlpha x) . words\n                    where foldingFunction acc tWord = acc + length tWord\n</code></pre>\n\n<p>Your folding function is taking the length of each word and summing them up, which can be simplified by mapping over the list, and taking the length, then summing the list.</p>\n\n<pre><code>getWordsInfo = sum . map length . filter (\\x -&gt; length x &gt; 2 &amp;&amp; all isAlpha x) . words\n</code></pre>\n\n<p>And that line is getting a bit long, so we should probably factor some of it out into another definition giving us finally:</p>\n\n<pre><code>import Data.Char (isAlpha)\n\ngetWordsInfo = sum . map length . filter isLongWord . words\n    where isLongWord x = length x &gt; 2 &amp;&amp; all isAlpha x\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>\u03bb&gt; getWordsInfo \"apple banana orange a a b b punctuation!!\"\n17\n\u03bb&gt; getWordsInfo \"aa bb cc\"\n0\n\u03bb&gt; getWordsInfo \"!!!\"\n0\n\u03bb&gt; getWordsInfo \"apple\"\n5\n\u03bb&gt;\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 1007935, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/de45a111a477254b06722ab142f744a1?s=128&d=identicon&r=PG", "display_name": "momi", "link": "https://stackoverflow.com/users/1007935/momi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 47180318, "answer_count": 1, "score": 0, "last_activity_date": 1510146482, "creation_date": 1510143494, "question_id": 47179563, "link": "https://stackoverflow.com/questions/47179563/haskell-expected-type-trouble", "title": "haskell expected type trouble", "body": "<p>new to Haskell and functional programing...in the learning process. What is wrong with this code:</p>\n\n<pre><code>import System.IO\nimport Data.Char\nimport System.Environment\n\nmain = do\n   args &lt;- getArgs\n   progName &lt;- getProgName\n   content &lt;- readFile $ head args\n   putStrLn $ show $ getWordsInfo content\n\ngetWordsInfo = let\n                  wordList = filter (\\x -&gt; length x &gt; 2 &amp;&amp; all isAlpha x) . words\n               in foldl foldingFunction 0 wordList\n                 where foldingFunction acc tWord = acc + length tWord\n</code></pre>\n\n<p>When I try to compile it, I get the following</p>\n\n<pre><code> Couldn't match expected type `[[a0]]'\n            with actual type `String -&gt; [[Char]]'\nIn the third argument of `foldl', namely `wordList'\nIn the expression: foldl foldingFunction 0 wordList\nIn the expression:\n  let\n    wordList = filter (\\ x -&gt; length x &gt; 2 &amp;&amp; all isAlpha x) . words\n  in foldl foldingFunction 0 wordList\n</code></pre>\n"}, {"tags": ["haskell", "types", "tuples"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1510143470, "post_id": 47179462, "comment_id": 81307812, "body": "Terminological note: <code>Shape</code> is a type. <code>Circle</code>, <code>Rectangle</code>, <code>Triangle</code>, and <code>Label</code> are constructors.  Lists  can only contain values of a single type."}], "answers": [{"tags": [], "owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "is_accepted": false, "score": 2, "last_activity_date": 1510143707, "last_edit_date": 1510143707, "creation_date": 1510143355, "answer_id": 47179517, "question_id": 47179462, "link": "https://stackoverflow.com/questions/47179462/haskell-how-to-get-a-list-of-figures-of-specified-type/47179517#47179517", "title": "HASKELL: How to get a list of figures of specified type?", "body": "<p>Declare a predicate, like</p>\n\n<pre><code>isCircle :: Shape -&gt; Bool\nisCircle (Circle _ _) = True\nisCircle _ = False\n</code></pre>\n\n<p>Then, filter by it:</p>\n\n<pre><code>databaseCircles = filter isCircle database\n</code></pre>\n\n<p>However, I'd advise you to decompose your types a bit:</p>\n\n<pre><code>data Circle = Circle Point Float\ndata Rectangle = Rectangle Point Point\ndata Triangle = Triangle Point Point Point\ndata Label = Label Point Font String\ndata Shape = CircleShape Circle | RectangleShape Rectangle\n    | TriangleShape Triangle | LabelShape Label\n</code></pre>\n\n<p>So that you can have a type-safe list of circles (or rectangles, or etc.):</p>\n\n<pre><code>getMaybeCircle:: Shape -&gt; Maybe Circle\ngetMaybeCircle (CircleShape c) = Just c\ngetMaybeCircle _ = Nothing\n\nfilterCircles :: [Shape] -&gt; [Circle]\nfilterCircles = catMaybes . map getMaybeCircle\n</code></pre>\n\n<p>Note: <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Maybe.html#v:catMaybes\" rel=\"nofollow noreferrer\"><code>catMaybes</code></a> is from <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Maybe.html\" rel=\"nofollow noreferrer\"><code>Data.Maybe</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1510160800, "creation_date": 1510160800, "answer_id": 47185633, "question_id": 47179462, "link": "https://stackoverflow.com/questions/47179462/haskell-how-to-get-a-list-of-figures-of-specified-type/47185633#47185633", "title": "HASKELL: How to get a list of figures of specified type?", "body": "<p>A list comprehension also works</p>\n\n<pre><code>[ s | s@(Circle _ _) &lt;- database ]\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8417135, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Z64hBEONvA/AAAAAAAAAAI/AAAAAAAADjs/2_c7cDcu6HU/photo.jpg?sz=128", "display_name": "Alex Hyriavets", "link": "https://stackoverflow.com/users/8417135/alex-hyriavets"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1510160800, "creation_date": 1510143219, "question_id": 47179462, "link": "https://stackoverflow.com/questions/47179462/haskell-how-to-get-a-list-of-figures-of-specified-type", "title": "HASKELL: How to get a list of figures of specified type?", "body": "<p>I have the user data types like</p>\n\n<pre><code>data Point = Point Float Float deriving (Show)\ndata Shape = Circle Point Float | \n         Rectangle Point Point | \n         Triangle Point Point Point |\n         Label Point Font String deriving (Show)  \n</code></pre>\n\n<p>And database like</p>\n\n<pre><code>database :: [Shape]\ndatabase = [(Circle (Point 2 5) 5), (Circle (Point 1 4) 3), (Circle (Point 8 3) 4),\n    (Rectangle (Point 0 5) (Point 10 0)), (Rectangle (Point 3 5) (Point 10 0)),(Rectangle (Point 0 10) (Point 20 0)),\n    (Triangle (Point 1 1) (Point 2 2) (Point 3 1)), (Triangle (Point 2 5) (Point 5 8) (Point 9 1))]\n</code></pre>\n\n<p>So how can i get figures of specified type from this?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": false, "score": 1, "last_activity_date": 1510148838, "creation_date": 1510148838, "answer_id": 47181364, "question_id": 47178815, "link": "https://stackoverflow.com/questions/47178815/how-haskell-catch-throwio-called-exception-in-exceptt/47181364#47181364", "title": "how haskell catch throwIO called exception in ExceptT", "body": "<p>You can use the <code>safe-exceptions</code> package (tutorial at: <a href=\"https://haskell-lang.org/library/safe-exceptions\" rel=\"nofollow noreferrer\">https://haskell-lang.org/library/safe-exceptions</a>), which provides a set of functions which will help here in two ways:</p>\n\n<ol>\n<li>They are lifted to work in many different monads, including <code>ExceptT</code> and <code>ReaderT</code>. Note that you will likely need to derive instances for <code>MonadThrow</code> and <code>MonadCatch</code> for your <code>HandlerT</code>.</li>\n<li>You can use the <code>catchAny</code> and <code>tryAny</code> functions to catch all synchronous exceptions, which is probably what you want here. (See the linked tutorial for more information on synchronous vs asynchronous.)</li>\n</ol>\n\n<p>That said: given that the <code>httpLBS</code> function is (most likely) living in <code>IO</code> itself, you can also do something like:</p>\n\n<pre><code>liftIO (tryAny (httpLBS req))\n</code></pre>\n\n<p>and avoid the need to bother with runtime exceptions in a monad transformer at all.</p>\n"}], "owner": {"reputation": 5756, "user_id": 1436450, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/49ade21b14846e41684616c6e7209db3?s=128&d=identicon&r=PG", "display_name": "Chinaxing", "link": "https://stackoverflow.com/users/1436450/chinaxing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510148838, "creation_date": 1510141330, "question_id": 47178815, "link": "https://stackoverflow.com/questions/47178815/how-haskell-catch-throwio-called-exception-in-exceptt", "title": "how haskell catch throwIO called exception in ExceptT", "body": "<p>when use monad transformer <code>ExceptT</code> to wrapper the <code>IO Monad</code>.</p>\n\n<p>and then <code>throwIO e</code> in the inner IO monad,</p>\n\n<p>so how this exception was catch by outer <code>Exception</code> and converted to and <code>Either e a</code> Type one</p>\n\n<p>for example:</p>\n\n<p>my program define type :</p>\n\n<p>newtype HandlerT e a = HandlerT { runHandlerT :: ExceptT e (ReaderT (IO a)) }</p>\n\n<p>then when in inner IO monad do the HTTP request to access and no-existen web site, the innert http.LBS will throw exception by call throwIO.</p>\n\n<p>then , </p>\n\n<pre><code>runExceptT $ runReaderT $ runHandlerT (http.LBS \"http://notexist.com\") \n</code></pre>\n\n<p>will return an <code>Either e a</code></p>\n\n<p>the e has the exception the inner call throw out.</p>\n"}, {"tags": ["haskell", "types", "ghc", "dependent-type", "data-kinds"], "answers": [{"comments": [{"owner": {"reputation": 7435, "user_id": 4617597, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/b1Sdw.png?s=128&g=1", "display_name": "Marcelo Lazaroni", "link": "https://stackoverflow.com/users/4617597/marcelo-lazaroni"}, "edited": false, "score": 0, "creation_date": 1510149654, "post_id": 47181367, "comment_id": 81312115, "body": "Wow, that was quite a ride! Thanks a lot for that. I will try it."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 7435, "user_id": 4617597, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/b1Sdw.png?s=128&g=1", "display_name": "Marcelo Lazaroni", "link": "https://stackoverflow.com/users/4617597/marcelo-lazaroni"}, "edited": false, "score": 0, "creation_date": 1510152815, "post_id": 47181367, "comment_id": 81314393, "body": "@MarceloLazaroni I think the preliminary code above can be autogenerated using the <a href=\"http://hackage.haskell.org/package/singletons\" rel=\"nofollow noreferrer\">singletons</a> package, relieving the effort, but it&#39;s still useful to know what&#39;s going on and being able to write it manually."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1510148847, "creation_date": 1510148847, "answer_id": 47181367, "question_id": 47178415, "link": "https://stackoverflow.com/questions/47178415/enforce-different-value-constructors-in-functions-signature/47181367#47181367", "title": "Enforce different value constructors in functions signature", "body": "<p>I can't guarantee this is the \"best\" approach for any reasonable notion of \"best\", but here's a try.</p>\n\n<pre><code>{-# LANGUAGE GADTs, DataKinds, KindSignatures, ScopedTypeVariables,\n  AllowAmbiguousTypes, TypeApplications #-}\n{-# OPTIONS -Wall #-}\n\nmodule Currency where\n\ntype Number = Rational\n</code></pre>\n\n<p>We start by defining a <code>Currency</code> type with some associated auxiliary machinery. </p>\n\n<pre><code>data Currency = USD | EUR | GBP\n</code></pre>\n\n<p>We add an an associated singleton GADT.</p>\n\n<pre><code>-- Singleton type for Currency\ndata SCurrency (cur :: Currency) where\n    S_USD :: SCurrency 'USD\n    S_EUR :: SCurrency 'EUR\n    S_GBP :: SCurrency 'GBP\n</code></pre>\n\n<p>We also define a helper class to link the two types (basic and singleton). We could do without, but it's convenient.</p>\n\n<pre><code>-- Helper class\nclass CCurrency (cur :: Currency) where\n    sing :: SCurrency cur\ninstance CCurrency 'USD where sing = S_USD\ninstance CCurrency 'EUR where sing = S_EUR\ninstance CCurrency 'GBP where sing = S_GBP\n</code></pre>\n\n<p>We'll need an heterogeneous equality operator on the singleton type.</p>\n\n<pre><code>-- Like (==), but working on potentially different types\nsameCur :: SCurrency cur1 -&gt; SCurrency cur2 -&gt; Bool\nsameCur S_USD S_USD = True\nsameCur S_EUR S_EUR = True\nsameCur S_GBP S_GBP = True\nsameCur _     _     = False\n</code></pre>\n\n<p>Ideally we should have <code>sameCur :: SCurrency cur1 -&gt; SCurrency cur2 -&gt; Either (cur1 :~: cur2) ((cur1 :~: cur2) -&gt; Void)</code> but a boolean is enough for our purposes.</p>\n\n<p>End of the preliminaries. We can now define a type for values with a currency known at compile time.</p>\n\n<pre><code>data Value (cur :: Currency) =  Value Number\n</code></pre>\n\n<p>We also have a type for values with a currency known only at runtime</p>\n\n<pre><code>data AnyValue where\n    AnyValue :: CCurrency cur =&gt; Value cur -&gt; AnyValue\n</code></pre>\n\n<p>Conversion rate are similar to the original code, except they carry singletons.</p>\n\n<pre><code>data ConversionRate where\n    CR :: SCurrency cur1 -&gt; SCurrency cur2 -&gt; Number -&gt; ConversionRate\n\nconversionRates :: [ConversionRate]\nconversionRates = [CR S_GBP S_EUR 1.2]\n</code></pre>\n\n<p>We can now define a typesafe sum.</p>\n\n<pre><code>sumValue :: Value cur -&gt; Value cur -&gt; Value cur\nsumValue (Value x) (Value y) = Value (x+y)\n</code></pre>\n\n<p>We can also write a typesafe conversion, in two flavors.</p>\n\n<pre><code>convert :: forall newCur. CCurrency newCur =&gt;\n           ConversionRate\n        -&gt; AnyValue\n        -&gt; Maybe (Value newCur)\nconvert (CR old new rate) (AnyValue (Value val :: Value cur)) =\n    if sameCur old (sing @ cur) &amp;&amp; sameCur new (sing @ newCur)\n    then Just $ Value $ val*rate\n    else Nothing\n\nconvert' :: forall oldCur newCur. (CCurrency oldCur, CCurrency newCur) =&gt;\n            ConversionRate\n         -&gt; Value oldCur\n         -&gt; Maybe (Value newCur)\nconvert' cr val = convert cr (AnyValue val)\n</code></pre>\n"}], "owner": {"reputation": 7435, "user_id": 4617597, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/b1Sdw.png?s=128&g=1", "display_name": "Marcelo Lazaroni", "link": "https://stackoverflow.com/users/4617597/marcelo-lazaroni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 47181367, "answer_count": 1, "score": 2, "last_activity_date": 1510148847, "creation_date": 1510140058, "question_id": 47178415, "link": "https://stackoverflow.com/questions/47178415/enforce-different-value-constructors-in-functions-signature", "title": "Enforce different value constructors in functions signature", "body": "<p>I am handling currencies and currency operations. I want operations to be type safe, but I also need to store different currencies together in a collection so I can search them. </p>\n\n<p>These two goals seem to clash.</p>\n\n<p>I can implement it with an option type, but I don't get type safety in operations:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type Number = Rational\n\ndata Currency = USD | EUR | GBP\n\ndata Value = Value Number Currency\n\n-- I can have this\ntype ConversionRate = (Currency, Currency, Number)\n\nconversionRates :: [ConversionRate]\nconversionRates = [(GBP, EUR, 1.2)]\n\n-- This is not typesafe and would allow summing different currencies\nsumValue :: Value -&gt; Value -&gt; Value\nsumValue = undefined\n\n-- This is also not typesafe\nconvert :: ConversionRate -&gt; Value -&gt; Currency -&gt; Maybe Value\nconvert = undefined\n</code></pre>\n\n<p>Or I can use a type for each currency, but I can't easily create and handle their exchange rates.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE GADTSyntax #-}\n{-# LANGUAGE ExistentialQuantification #-}\n\ntype Number = Rational\n\ndata USD = USD\ndata EUR = EUR\ndata GBP = GBP\n\nclass Currency a\n\ninstance Currency USD\ninstance Currency EUR\ninstance Currency GBP\n\ndata Value a where\n    Value :: Currency a =&gt; a -&gt; Value a\n\ndata ConversionRate a b where\n    ConversionRate :: (Currency a, Currency b) =&gt; Number -&gt; ConversionRate a b\n\n-- Now I can have type-safe currency operations\nsumValue :: Currency a =&gt; Value a -&gt; Value a\nsumValue = undefined\n\n-- And I can make sure my conversions make sense\nconvert :: ConversionRate a b -&gt; Value a -&gt; b\nconvert = undefined\n\n-- But I can't hold a list of conversion rates that I can easily manipulate\ntype ConversionRates = ??\n</code></pre>\n\n<h2>How I'm currently doing it</h2>\n\n<p>My current solution is an isomorphism between currencies as different types and a currency option type in the hope of having the best of both worlds in different parts of the program. But this is a mess to work with.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE ExistentialQuantification #-}\ntype Number = Rational\n\ndata Symbol = USD | EUR | GBP\n\ndata Dollar = Dollar\ndata Euro = Euro\ndata Pound = Pound\n\nclass Currency a where\n    toSymbol :: a -&gt; Symbol\n\ninstance Currency Dollar where toSymbol _ = USD\ninstance Currency Euro where toSymbol _ = EUR\ninstance Currency Pound where toSymbol _ = GBP\n\ndata Wrapper = forall a. Currency a =&gt; Wrapper a\n\ntoCurrency :: Symbol -&gt; Wrapper\n</code></pre>\n\n<p><strong><em>How can I have type safety in some functions and the convenience of same-type values in other functions?</em></strong>. Looks like a job for <code>DataKinds</code> but I don't see how it can help.</p>\n\n<p>Keep in mind that I don't have all the data at coding time. It will be fetched from an API. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1510136504, "post_id": 47177050, "comment_id": 81303192, "body": "Your statement <code>fmap . fmap (+5) (Just (Just 4))</code> does not makes sense: the first <code>fmap</code> expects a function."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1510136915, "post_id": 47177050, "comment_id": 81303503, "body": "I edited to <code>(fmap . fmap) (+5) (Just (Just 4))</code> now it is obviously."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1510137242, "creation_date": 1510137242, "answer_id": 47177389, "question_id": 47177050, "link": "https://stackoverflow.com/questions/47177050/how-does-fmap-function-composition-works/47177389#47177389", "title": "how does fmap function composition works", "body": "<pre><code>(fmap . fmap) (+5) (Just (Just 4))\n= { def. (.) }\nfmap (fmap (+5)) (Just (Just 4))\n= { fmap g (Just x) = Just (g x), where g = fmap (+5) ; x = Just 4 }\nJust (fmap (+5) (Just 4))\n= { fmap g (Just x) = Just (g x), where g = (+5) ; x = 4 }\nJust (Just ((+5) 4))\n= { def. (+) }\nJust (Just 9)\n</code></pre>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 47177389, "answer_count": 1, "score": 0, "last_activity_date": 1510137242, "creation_date": 1510136356, "last_edit_date": 1510136867, "question_id": 47177050, "link": "https://stackoverflow.com/questions/47177050/how-does-fmap-function-composition-works", "title": "how does fmap function composition works", "body": "<p>I am trying to understand how function composition works.   </p>\n\n<p>The common example is: </p>\n\n<pre><code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c  \nf . g = \\x -&gt; f (g x)  \n</code></pre>\n\n<p>It is easy to understand, what a function composition is.   </p>\n\n<p>Now consider:</p>\n\n<pre><code>(fmap . fmap) (+5) (Just (Just 4))\n</code></pre>\n\n<p>Let's consider first <code>fmap</code> implementation: </p>\n\n<pre><code>fmap . fmap = \\x -&gt; fmap ( fmap x )\n</code></pre>\n\n<p>How does the example is going to execute?   </p>\n\n<p>Does <code>fmap (+5)</code> is going to execute first?</p>\n\n<p>What is the <code>x</code> value in connection of the example?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1510135885, "post_id": 47176710, "comment_id": 81302764, "body": "It is <code>div (xn + const &#47; xn) 2</code>. <code>div</code> is not an operator so you can not use it infix (without backtics)."}, {"owner": {"reputation": 105, "user_id": 7841878, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ea84e22431b5da70d9f514ee95767b09?s=128&d=identicon&r=PG&f=1", "display_name": "James Hamish", "link": "https://stackoverflow.com/users/7841878/james-hamish"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1510136095, "post_id": 47176710, "comment_id": 81302908, "body": "I have been using div with the backticks, I removed them here as it took div out of the code listing when I did that."}, {"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "edited": false, "score": 0, "creation_date": 1510136617, "post_id": 47176710, "comment_id": 81303269, "body": "@JamesHamish You have to escape the quote by putting a backslash before it: <code>`div`</code>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1510138272, "post_id": 47176710, "comment_id": 81304405, "body": "quote backticks-containing code by putting double-backticks around it."}], "answers": [{"tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": false, "score": 2, "last_activity_date": 1510136144, "creation_date": 1510136144, "answer_id": 47176961, "question_id": 47176710, "link": "https://stackoverflow.com/questions/47176710/iterate-calculation-in-haskell/47176961#47176961", "title": "Iterate Calculation in Haskell", "body": "<p>Just use a <code>lambda</code> function:</p>\n\n<pre><code>mySeq = iterate (\\xn -&gt;(xn + 5 `div` xn) `div` 2) 1\n</code></pre>\n\n<p>Here you have a <a href=\"https://repl.it/Nw89/0\" rel=\"nofollow noreferrer\">live example</a></p>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 7841878, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ea84e22431b5da70d9f514ee95767b09?s=128&d=identicon&r=PG&f=1", "display_name": "James Hamish", "link": "https://stackoverflow.com/users/7841878/james-hamish"}, "edited": false, "score": 0, "creation_date": 1510136600, "post_id": 47176990, "comment_id": 81303259, "body": "The problem with this is I am  using div for integral divide and rounding down, when you have divided you are using /"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 105, "user_id": 7841878, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ea84e22431b5da70d9f514ee95767b09?s=128&d=identicon&r=PG&f=1", "display_name": "James Hamish", "link": "https://stackoverflow.com/users/7841878/james-hamish"}, "edited": false, "score": 1, "creation_date": 1510136672, "post_id": 47176990, "comment_id": 81303311, "body": "You can not use <code>div</code> and <code>&#47;</code> at the same time and obtain the same type, since <code>(&#47;) :: Fractional f =&gt; f -&gt; f -&gt; f</code> and <code>div :: Integral i =&gt; i -&gt; i -&gt; i</code>. Although technically we can construct such a type, it is quite weird to have a type bing both <code>Integral</code> and <code>Fractional</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 105, "user_id": 7841878, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ea84e22431b5da70d9f514ee95767b09?s=128&d=identicon&r=PG&f=1", "display_name": "James Hamish", "link": "https://stackoverflow.com/users/7841878/james-hamish"}, "edited": false, "score": 0, "creation_date": 1510138498, "post_id": 47176990, "comment_id": 81304549, "body": "@JamesHamish check whether  the parentheses are in fact what you intended, or not. And it makes much more sense with the floats than with the integers."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1510136987, "last_edit_date": 1510136987, "creation_date": 1510136229, "answer_id": 47176990, "question_id": 47176710, "link": "https://stackoverflow.com/questions/47176710/iterate-calculation-in-haskell/47176990#47176990", "title": "Iterate Calculation in Haskell", "body": "<p>You basically describe a function:</p>\n\n<pre><code>next xn = (xn + c) / (2*xn)\n</code></pre>\n\n<p>with <code>c</code> the <code>const</code> (<code>const</code> is a function from the Prelude, so do not use that name). Or as a lambda expression:</p>\n\n<pre><code>\\xn -&gt; (xn + c) / (2*xn)\n</code></pre>\n\n<p>with <code>c</code> your constant. So now we can inject that in the <code>iterate</code>:</p>\n\n<pre><code>take 10 (iterate (\\xn -&gt; (xn + 5) / (2*xn)) 1)\n</code></pre>\n\n<p>with <code>c=5</code>, we get:</p>\n\n<pre><code>Prelude&gt; take 10 (iterate (\\xn -&gt; (xn + 5) / (2*xn)) 1)\n[1.0,3.0,1.3333333333333333,2.375,1.5526315789473684,2.110169491525424,1.684738955823293,1.9839094159713946,1.7601381796335236,1.9203430326819695]\n</code></pre>\n\n<p>If you want to calculate values over integers, you can use:</p>\n\n<pre><code>\\xn -&gt; div (xn + c) (2*xn)\n</code></pre>\n\n<p>this produces:</p>\n\n<pre><code>Prelude&gt; take 10 (iterate (\\xn -&gt; div (xn + 5) (2*xn)) 1)\n[1,3,1,3,1,3,1,3,1,3]\n</code></pre>\n\n<p>If you want to round down the result after the calculation, you can use <code>floor</code>:</p>\n\n<pre><code>\\xn -&gt; floor ((fromIntegral xn + 5) / (2* fromIntegral xn))\n</code></pre>\n\n<p>this produces:</p>\n\n<pre><code>Prelude&gt; take 10 $ iterate (\\xn -&gt; floor ((fromIntegral xn + 5) / (2* fromIntegral xn))) 1\n[1,3,1,3,1,3,1,3,1,3]\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 7841878, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ea84e22431b5da70d9f514ee95767b09?s=128&d=identicon&r=PG&f=1", "display_name": "James Hamish", "link": "https://stackoverflow.com/users/7841878/james-hamish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 47176990, "answer_count": 2, "score": 0, "last_activity_date": 1510136987, "creation_date": 1510135478, "question_id": 47176710, "link": "https://stackoverflow.com/questions/47176710/iterate-calculation-in-haskell", "title": "Iterate Calculation in Haskell", "body": "<p>I am a beginner to Haskell, I am trying to create an infinite list in haskell where the next term is found by the following formula </p>\n\n<pre><code>xn+1 = (xn + const / xn) div 2.\n</code></pre>\n\n<p>I have been looking into the iterate command as I want to apply the same function again to generate the next answer.</p>\n\n<p>I will then use take to choose a certain number of elements from the list.</p>\n\n<p>However I am unsure how I can represent xn when using iterate.</p>\n\n<p>I started writing <code>take 10 (iterate (xn +5 /xn div 2) 1)</code>, I know I need to replace the xn but not sure what with.</p>\n\n<p>Could somebody advise me?</p>\n"}, {"tags": ["haskell", "ghc", "typeclass"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1510130765, "post_id": 47171805, "comment_id": 81299305, "body": "The <code>{-# OVERLAPPABLE #-}</code> and <code>{-# LANGUAGE FlexibleContexts #-}</code> don&#39;t influence anything. Another way of getting compilation: add a <code>x :: Int</code> to the <code>let</code> binding."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1510135782, "post_id": 47171805, "comment_id": 81302695, "body": "Perhaps the silliest thing is that it also typechecks when there&#39;s <i>no instance at all</i> in the module..."}], "answers": [{"comments": [{"owner": {"reputation": 1525, "user_id": 546591, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/33RTK.jpg?s=128&g=1", "display_name": "James Koppel", "link": "https://stackoverflow.com/users/546591/james-koppel"}, "edited": false, "score": 0, "creation_date": 1510164893, "post_id": 47182094, "comment_id": 81322808, "body": "1) What do you mean (Foo a =&gt; SomeClass a) is the only instance in scope? What about the (SomeClass a) constraint in the declaration?"}, {"owner": {"reputation": 1525, "user_id": 546591, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/33RTK.jpg?s=128&g=1", "display_name": "James Koppel", "link": "https://stackoverflow.com/users/546591/james-koppel"}, "edited": false, "score": 0, "creation_date": 1510164944, "post_id": 47182094, "comment_id": 81322836, "body": "2) Why does it need to simplify the SomeClass (Maybe a) constraint immediately for it to simplify at all? Why can&#39;t it defer that resolution step till the end after it&#39;s already looked at the declaring context?"}, {"owner": {"reputation": 1525, "user_id": 546591, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/33RTK.jpg?s=128&g=1", "display_name": "James Koppel", "link": "https://stackoverflow.com/users/546591/james-koppel"}, "edited": false, "score": 0, "creation_date": 1510165014, "post_id": 47182094, "comment_id": 81322888, "body": "3) This does help explain the simplified example I gave, but it falls short for the real example. I&#39;ll edit my post to also give the real example."}, {"owner": {"reputation": 1525, "user_id": 546591, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/33RTK.jpg?s=128&g=1", "display_name": "James Koppel", "link": "https://stackoverflow.com/users/546591/james-koppel"}, "edited": false, "score": 0, "creation_date": 1510165441, "post_id": 47182094, "comment_id": 81323145, "body": "4) So, can I summarize your answer as &quot;the GHC typechecker has a bug in the presence of overlapping instances?&quot; This very much does not sound like correct behavior; should it be reported?"}, {"owner": {"reputation": 1525, "user_id": 546591, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/33RTK.jpg?s=128&g=1", "display_name": "James Koppel", "link": "https://stackoverflow.com/users/546591/james-koppel"}, "edited": false, "score": 0, "creation_date": 1510167577, "post_id": 47182094, "comment_id": 81324367, "body": "I wish I could give you the karma of accepting this answer because, even though it doesn&#39;t entirely answer the question I asked, it did help me understand a different problem I&#39;ve been facing the last 2 hours. My conclusion is that I should avoid let-statements in favor of case statements and where clauses. (Using where-clauses fixed a problem that simply annotating the LHS of a let-statement didn&#39;t, even though I thought they were equivalent.)"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1510150777, "creation_date": 1510150777, "answer_id": 47182094, "question_id": 47171805, "link": "https://stackoverflow.com/questions/47171805/adding-an-unused-instance-fixes-a-type-error/47182094#47182094", "title": "Adding an unused instance fixes a type error", "body": "<p>The reason for this is that the compiler tries to make <code>x</code> as general as possible: it wants it to be <code>(SomeClass a) =&gt; Int</code> (notice this would be an ambiguous type if you wrote it out yourself). One way to prevent this kind of weird local type is to enable <code>-XMonoLocalBinds</code>, but I wouldn't really recommend it.</p>\n\n<p>Now, the compiler goes on to typechecking. At that point, there is exactly one <code>instance SomeClass</code> in scope, namely the catch-all <code>(Foo a) =&gt; SomeClass a</code>, so there's no ambiguity. (In principle, Haskell completely forbids ambiguity in instance resolution; <code>OVERLAPPABLE</code> subverts this but it only jumps into action when there's actually a need, like when you have an extra <code>instance SomeClass Int</code>.) Therefore, the compiler immediately commits to that instance and thus eliminates <code>(SomeClass a)</code> for the type-checking of <code>c</code>. That it does this is necessary for situations where you actually want a class constraint to be replaced by the constraint of an instance. This may seem useless in the given example, but it's actually crucial when you have instances of the form</p>\n\n<pre><code>instance Bar a =&gt; SomeClass (Maybe a)\n</code></pre>\n\n<p>...which is much more reasonable than your code because that <em>can't</em> be expressed as a superclass constraint, and is perfectly ok without any overlap. If the compiler didn't reduce the constraint resolving down to <code>Bar a</code> in those situations, it could never actually resolve down the <code>Maybe</code> type.</p>\n\n<p>Conlusion: avoid overlapping instances; express class relations by superclass declarations if possible, else reify the constraints into a GADT (which is awkward but gives you exact control where which constraint is going to be used).</p>\n"}], "owner": {"reputation": 1525, "user_id": 546591, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/33RTK.jpg?s=128&g=1", "display_name": "James Koppel", "link": "https://stackoverflow.com/users/546591/james-koppel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 1, "answer_count": 1, "score": 9, "last_activity_date": 1510165748, "creation_date": 1510116629, "last_edit_date": 1510165748, "question_id": 47171805, "link": "https://stackoverflow.com/questions/47171805/adding-an-unused-instance-fixes-a-type-error", "title": "Adding an unused instance fixes a type error", "body": "<p>Consider this code:</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE UndecidableInstances #-}\n\nmodule Foo where\n\nclass Foo a\n\nclass SomeClass a\ninstance {-# OVERLAPPABLE #-} (Foo a) =&gt; SomeClass a\n\nbar :: (SomeClass a) =&gt; a -&gt; Int\nbar = const 0\n\nfoo :: (SomeClass a) =&gt; a -&gt; Int\nfoo t = let x = bar t in x\n</code></pre>\n\n<p>Here, <code>foo</code> calls <code>bar</code>, and should be able to do so using the <code>SomeClass</code> constraint in its context. Instead, GHC assumes it must do so using the <code>Foo a =&gt; SomeClass a</code> instance:</p>\n\n<pre><code>Foo.hs:16:17:\n    Could not deduce (Foo a) arising from a use of \u2018bar\u2019\n    from the context (SomeClass a)\n      bound by the type signature for foo :: SomeClass a =&gt; a -&gt; Int\n      at Foo.hs:15:8-32\n    Possible fix:\n      add (Foo a) to the context of\n        the inferred type of x :: Int\n        or the type signature for foo :: SomeClass a =&gt; a -&gt; Int\n    In the expression: bar t\n    In an equation for \u2018x\u2019: x = bar t\n    In the expression: let x = bar t in x\n</code></pre>\n\n<p>There are two ways to fix this:</p>\n\n<ol>\n<li>In <code>foo</code>, changing <code>let x = bar t in x</code>  to <code>bar t</code></li>\n<li>Appending the line <code>instance SomeClass Int</code> to my program</li>\n</ol>\n\n<p>What is going on here? Why is this problem occurring, and why do these fixes work?</p>\n\n<hr>\n\n<p>This example is, of course, simplified by my actual problem. I encountered it during my work on the Cubix framework for multi-language transformation ( arxiv.org/pdf/1707.04600 ).</p>\n\n<p>My actual problem involves a function with a constraint <code>InjF f IdentL FunctionExpL</code> (\"f is a language where identifiers may be used to denote the function in a function call\"). I have an (overlappable) instance <code>(FunctionIdent :&lt;: f) =&gt; InjF f IdentL FunctionExpL</code>, which the typechecker seizes on, giving me a spurious <code>Could not deduce FunctionIdent :&lt;: f</code> error.</p>\n\n<p>This error persists even when there is an instance <code>InjF Foo IdentL FunctionExpL</code> in scope for a specific <code>Foo</code>, so leftaroundabout's answer, which predicts that that other instance should fix the problem, is not the full story.</p>\n"}, {"tags": ["list", "haskell", "tuples"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 5, "creation_date": 1510107112, "post_id": 47170429, "comment_id": 81290515, "body": "<code>sumTuples list = foldl (\\(xAcc, yAcc) (x,y) -&gt; (xAcc + x, yAcc + y)) (0,0) list</code>"}, {"owner": {"reputation": 95, "user_id": 4953630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd318bbe430df481b424624c8397b04c?s=128&d=identicon&r=PG&f=1", "display_name": "Computer Geek", "link": "https://stackoverflow.com/users/4953630/computer-geek"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1510107214, "post_id": 47170429, "comment_id": 81290549, "body": "@Alec This works. Thank you so much."}, {"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "edited": false, "score": 0, "creation_date": 1510129620, "post_id": 47170429, "comment_id": 81298711, "body": "alternatively <code>sumTuples xs = (sumOver fst, sumOver snd)     where sumOver x = sum $ map x xs </code>"}], "answers": [{"tags": [], "owner": {"reputation": 48, "user_id": 6093436, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0GvDe.jpg?s=128&g=1", "display_name": "DRTorresRuiz", "link": "https://stackoverflow.com/users/6093436/drtorresruiz"}, "is_accepted": true, "score": 1, "last_activity_date": 1510349019, "creation_date": 1510349019, "answer_id": 47231327, "question_id": 47170429, "link": "https://stackoverflow.com/questions/47170429/adding-corresponding-values-of-tuple-in-a-list-in-haskell/47231327#47231327", "title": "Adding corresponding values of Tuple in a list in Haskell", "body": "<p>You can also use <code>foldr1</code>:</p>\n\n<p><code>foldr1 :: Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a</code></p>\n\n<p>In this case,</p>\n\n<pre><code>sumSecondTuple :: Num a =&gt; [(a,a)] -&gt; (a,a)\nsumSecondTuple = foldr1 f\n    where\n        f = (\\ (a,b) (c,d) -&gt; (a+c,b+d) )\n</code></pre>\n\n<p>However, <code>sumSecondTuple []</code> returns an exception <code>Prelude.foldr1: empty list</code>. So, it's better to use <code>foldr</code> than use <code>foldr1</code> on this occasion.</p>\n"}], "owner": {"reputation": 95, "user_id": 4953630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd318bbe430df481b424624c8397b04c?s=128&d=identicon&r=PG&f=1", "display_name": "Computer Geek", "link": "https://stackoverflow.com/users/4953630/computer-geek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 47231327, "answer_count": 1, "score": 2, "last_activity_date": 1510349019, "creation_date": 1510106931, "question_id": 47170429, "link": "https://stackoverflow.com/questions/47170429/adding-corresponding-values-of-tuple-in-a-list-in-haskell", "title": "Adding corresponding values of Tuple in a list in Haskell", "body": "<p>I have a list for example: [(1,2),(3,4),(5,6)] and the function should return me the sum of the corresponding Tuples. So, this list should return (9,12). I know how to make the tuples add up individually but I have having troubles doing it them together. </p>\n\n<pre><code>sumSecondTuple list = foldl (\\acc (x,y) -&gt; (+) y acc) 0 list  \n    sumFirstTuple list = foldl (\\acc (x,y) -&gt; (+) x acc) 0 list\n</code></pre>\n\n<p>I have this much  so far. Is there a way I can incooperate them together? </p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 32687, "user_id": 85931, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a6d1f2e792d99695d610498b1170b6c6?s=128&d=identicon&r=PG", "display_name": "tpdi", "link": "https://stackoverflow.com/users/85931/tpdi"}, "edited": false, "score": 0, "creation_date": 1510080090, "post_id": 47165195, "comment_id": 81280098, "body": "Once you do find a match, you never recurse  (call aa) again. Also, a much simpler implementation is: put the array of tuples in a dictionary as fst() as key, snd() as value. Then iterate the list (this can be recursive or not) and foreach element, yield the value of that key in the dictionary or the value in the list if there is no such key (that is, dict.getOrDefault(element, element))"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1510080249, "post_id": 47165195, "comment_id": 81280198, "body": "If <code>ys == []</code> shouldn&#39;t you check if the <i>entire</i> list is empty. That being said your code looks imperative, not functional, and you perhaps should make it easier for yourself by first writing a function that can look up a <i>single</i> value in the dictionary."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1510080700, "post_id": 47165195, "comment_id": 81280475, "body": "You also use a lot of <code>return</code> and <code>do</code>s. These are <code>Monad</code> functions. Usually you do not find these very often in pure functions."}, {"owner": {"reputation": 33, "user_id": 8901982, "user_type": "registered", "profile_image": "https://graph.facebook.com/1539506849436735/picture?type=large", "display_name": "Aizaku", "link": "https://stackoverflow.com/users/8901982/aizaku"}, "edited": false, "score": 0, "creation_date": 1510082204, "post_id": 47165195, "comment_id": 81281342, "body": "Thank you for your suggestions. I will look into that stuff"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1510083067, "post_id": 47165195, "comment_id": 81281775, "body": "<code>return</code> does not do what you think it does.  How about a game? Never type <code>return</code>, forget it exists. Every time you want to type it instead type <code>pure</code> and think &quot;I am lifting this value into a richer computation environment&quot;. If you don&#39;t know what a monad is or which monad you are in then you never even need to type &quot;pure&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "is_accepted": true, "score": 3, "last_activity_date": 1510080732, "creation_date": 1510080732, "answer_id": 47165438, "question_id": 47165195, "link": "https://stackoverflow.com/questions/47165195/haskell-recursive-dictionary-function-problems/47165438#47165438", "title": "Haskell recursive dictionary function problems", "body": "<p>This is not too tricky a problem to solve if we break it down. Firstly we want a function which takes a list of tuples, and a key, and returns the value of that key if it exists in the list.</p>\n\n<p>Fortunately this is already defined for us, with <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:lookup\" rel=\"nofollow noreferrer\">lookup</a></p>\n\n<p>It returns a Maybe value. If we don't find it, then we don't need to replace it, so we can simply return the original value. <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Maybe.html#v:fromMaybe\" rel=\"nofollow noreferrer\">fromMaybe</a> does this for us, it takes a default value and a maybe value, and if the maybe value is a Just, it returns the value in the just. </p>\n\n<p>Now we just need to map over the list, and for each item, replace it with the item in the association list if it exists, or if not, replace it with itself.</p>\n\n<p>And here's the code:</p>\n\n<pre><code>import Data.Maybe (fromMaybe)\n\ntranslator xs ys = map replace xs\n    where replace x = fromMaybe x (lookup x ys)\n</code></pre>\n\n<p>Your code has a few issues in that you appear to be trying to use do notation when it's not really needed. When you're a beginner, generally you should just be using do notation in functions where you use IO. If you want to define something to prevent everything being one long statement, you can use where or let.</p>\n\n<pre><code>\u03bb&gt; translator [\"a\", \"b\", \"zz\"] [(\"a\", \"11\"),(\"b\",\"c\")]\n[\"11\",\"c\",\"zz\"]\n\u03bb&gt; \n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8901982, "user_type": "registered", "profile_image": "https://graph.facebook.com/1539506849436735/picture?type=large", "display_name": "Aizaku", "link": "https://stackoverflow.com/users/8901982/aizaku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 0, "accepted_answer_id": 47165438, "answer_count": 1, "score": 1, "last_activity_date": 1563080737, "creation_date": 1510079890, "last_edit_date": 1563080737, "question_id": 47165195, "link": "https://stackoverflow.com/questions/47165195/haskell-recursive-dictionary-function-problems", "title": "Haskell recursive dictionary function problems", "body": "<p>I have been trying to learn Haskell and currently trying to make a recursive \"dictionary\" or \"translator\" function.\nBasically it should receive an array of stings like and an array of tuples or sting, and return an array of strings that has elements replaced by tuple's 2nd part if it matched 1st one.\nSo basically from</p>\n\n<pre><code>[\"a\", \"b\", \"zz\"] [(\"a\", \"11\"),(\"b\",\"c\")]\n</code></pre>\n\n<p>to</p>\n\n<pre><code>[\"11\",\"c\",\"zz\"]\n</code></pre>\n\n<p>Having trouble making it... this is what I have so far:</p>\n\n<pre><code>aa (x:xs) (y:ys) = do\n    -- iterate through y\n    if ys == [] then return(x:xs) else aa (x:xs)(ys)\n        -- iterate through x\n    if xs == [] then return(x:xs) else aa (xs)(y:ys);\n\n    if x == fst(y) \n    then do \n        putStrLn(\"Yes\");\n        return (snd(y):xs);\n    else return (x:xs);\n</code></pre>\n\n<p>which worked for 1st element of the array.\nI can't seem to figure out how do I make it go through. Also removing putStrLn causes error \"mismatched\" brackets, why?</p>\n\n<p>While trying to figure it out also tried storing the result, and it didn't work out:</p>\n\n<pre><code>aa (x:xs) (y:ys) = do\n\n    if x == fst(y)\n    then result &lt;- snd(y):xs\n    else result &lt;- x:xs\n\n    return result;\n</code></pre>\n\n<p>resulted in an error \"parse error on input '&lt;-' Perhaps this should be in a 'do' block?\"</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 2, "creation_date": 1510075913, "post_id": 47164022, "comment_id": 81277737, "body": "It&#39;s appears as though you just need to pass it an Int, and two functions, each that take a Hand and a Board. What have you tried?"}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 3, "last_activity_date": 1510077142, "creation_date": 1510077142, "answer_id": 47164425, "question_id": 47164022, "link": "https://stackoverflow.com/questions/47164022/need-help-calling-a-haskell-function-whose-arguments-involves-types-which-themse/47164425#47164425", "title": "Need help calling a Haskell function whose arguments involves types which themselves take args", "body": "<p>The <em>Cardinal Rule of Typed Application</em> in Haskell is, very simply,</p>\n\n<pre><code>f    :: a  -&gt; b   ===\nf (x :: a) :: b\n</code></pre>\n\n<p>Thus, in your case,</p>\n\n<pre><code>playDomsRound    :: DomsPlayer     -&gt; DomsPlayer     -&gt; Int  -&gt; (Score, Score)   ===\nplayDomsRound (p :: DomsPlayer)    :: DomsPlayer     -&gt; Int  -&gt; (Score, Score)   ===\nplayDomsRound (p :: DomsPlayer) (q :: DomsPlayer)    :: Int  -&gt; (Score, Score)   ===\nplayDomsRound (p :: DomsPlayer) (q :: DomsPlayer) (i :: Int) :: (Score, Score)\n</code></pre>\n\n<p>and you can write any of the above in your code. </p>\n\n<p>Any expression which has a type, can appear in your code.</p>\n\n<p>Since you've defined</p>\n\n<pre><code>type DomsPlayer = Hand -&gt; Board -&gt; (Domino, End)\n</code></pre>\n\n<p>the type <code>DomsPlayer</code> is the same as the type <code>Hand -&gt; Board -&gt; (Domino, End)</code>. This is what your <code>playDomsRound</code> expects: a function. Not yet applied to any of the arguments that <em>it</em> expects. Just a function.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8901610"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 47164425, "answer_count": 1, "score": 3, "last_activity_date": 1510077142, "creation_date": 1510075804, "question_id": 47164022, "link": "https://stackoverflow.com/questions/47164022/need-help-calling-a-haskell-function-whose-arguments-involves-types-which-themse", "title": "Need help calling a Haskell function whose arguments involves types which themselves take args", "body": "<p>Sorry if the title is ambiguous, essentially I have the following data type declarations:</p>\n\n<pre><code>type Domino = (Integer, Integer)\ntype Hand = [Domino]\ntype Board = [Domino]\ntype DomsPlayer = Hand -&gt; Board -&gt; (Domino, End)\ntype Score = (Integer, String)\n</code></pre>\n\n<p>and a function:</p>\n\n<pre><code>playDomsRound :: DomsPlayer -&gt; DomsPlayer -&gt; Int -&gt; (Score, Score)\n</code></pre>\n\n<p>how do I go about calling the playDomsRound function?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1510067783, "post_id": 47160950, "comment_id": 81272223, "body": "Turn on <code>DuplicateRecordFields</code> and the records approach will work"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1510094659, "post_id": 47160950, "comment_id": 81287256, "body": "A very similar question here <a href=\"https://stackoverflow.com/questions/20907974/haskell-record-accessors-shared-by-different-constructors-of-the-same-data-type\">Haskell record accessors shared by different constructors of the same data type</a>. Provided your duplicate record accessors point to the same type i guess it should work."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 1, "creation_date": 1510097262, "post_id": 47160950, "comment_id": 81288095, "body": "@Redu no, here we have 2 different data types, <code>Animal</code> and <code>Owner</code>."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1510098830, "post_id": 47160950, "comment_id": 81288530, "body": "@Will Ness Yes you are right my bad."}, {"owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "reply_to_user": {"reputation": 126499, "user_id": 1531124, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/zw18i.png?s=128&g=1", "display_name": "GhostCat", "link": "https://stackoverflow.com/users/1531124/ghostcat"}, "edited": false, "score": 0, "creation_date": 1537530417, "post_id": 47160950, "comment_id": 91828826, "body": "@GhostCat : maybe you right for this case. Otherwise,  no offence,but you should wonder what is worst : making a wrong triage or polluting a post with a private message not related at all to the topic. Best Regards"}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1510088162, "post_id": 47163398, "comment_id": 81284365, "body": "<code>main = print $ name bob</code> gives compiler error on ideone (8.0.1) and <a href=\"https://tio.run/##fVFNT8JAEL33V7wsHjApBz9ICAmHKkiMBpOip4bD0C5L0@22tovEIH/dutsC1Ri97O7MvJn35u2ayoRLWe16HTx6s@mLN51gvMllHJLmPg@zIrqLuYxKdHp7B45@zzk8wTHCvdJNOKPUxnNdxEoYTESa4Kk4Jfls6yOMM4EP3JI251xRwh0g4kX8ZhrQ9TlFLubrbOti8nr@c4Lpbh6mZQdqpw6H3zhM0YWyOkza6qkTJBqYsOH@xNj9RfW0VbwwTPVdE/0/yz0IKW0qaGQs/uYQVKysiaddaivY9JBmGDgFKU0ql6RakHWN@W2B4dpJiFpAbSXYAxHDRd8us8kzFR0XARvbWDNcDhAcRbhouRbOMlu28JtsyXDVR2BYFqjMwJRiKyg3P6tx1rhiWqrqM1xJEmX1BQ\" rel=\"nofollow noreferrer\">tio</a> (8.0.2) both; works OK with OP&#39;s last code, which uses type classes."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1510088403, "post_id": 47163398, "comment_id": 81284472, "body": "Tip: <code>DuplicateRecordFields</code> works well with <code>NamedFieldPuns</code> and <code>RecordWildcards</code>, both for creating records and extracting fields. So one can write for example <code>let Animal {name} = Animal Cat &quot;Garfield&quot; 8</code> without interfering with similar code for <code>Owner</code> in another function."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1510088889, "post_id": 47163398, "comment_id": 81284685, "body": "(had to disambiguate it by writing <code>main = print $ (name :: Owner -&gt; Name) bob</code>)."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1510096383, "post_id": 47163398, "comment_id": 81287813, "body": "I haven&#39;t used <code>DuplicateRecordFields</code> - is there any downside except for disambiguating, how are they working with <code>lenses</code>?"}, {"owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "edited": false, "score": 0, "creation_date": 1510133038, "post_id": 47163398, "comment_id": 81300753, "body": "@Alec,  with the  DuplicateRecordFields  extension, the file loads correctly  in GHCi , but then no way to invoke name, even with the disambiguate trick, I still have the ambigous error. (using GHCi version 8.2.1). Any idea why ?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "edited": false, "score": 1, "creation_date": 1510134886, "post_id": 47163398, "comment_id": 81302079, "body": "@sandwood <a href=\"https://tio.run/##fVFNT8JAFLzvr5gsHiBpD36QEBJMqiAxGkyonpoeHnQtDe22LovEIL@97raUaoxe2r735s3Mm65osxZpWu7dDh692fTFm04w3hZpsiQt5mKZq@guEWm0Qcc9MDD9UQh4scAI91LX5YwyW/taJTI2mIg0wZNJRumznY8wzmN84pa0efqS1oIBkVDJu1lAdy4ocuCv8p2DyVvvJ4PZrj/Myh7Usg6H3zTM0IG0Pkzb@qkaFNew2JaHk2L3l9TTTgpllKp3JfQ/l3M0srGtoLYR/q0Rk3q1IZ5uqaLg02ObY8AUSU2ySEm2IJsan7cDjiu2JmoBVZTgD0Qc5317zLbIZdQcAj62tea4GCBoTDhotUK2yBct/CZfcFz2ERiVEKUhzCixhgrzZzXO0G1iqRfc6yqfHgxLWX4B\" rel=\"nofollow noreferrer\">here&#39;s one</a> that works. Could you show your code that doesn&#39;t?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "edited": false, "score": 0, "creation_date": 1510153635, "post_id": 47163398, "comment_id": 81315055, "body": "@sandwood You may need to explicitly add a type to the record accessor. I know, this is disappointingly verbose. The good news is that <code>DuplicateRecordFields</code> is only a stepping stone to a solution which should have fancy polymorphism (which would mean that your accessor would be well-typed and not tied to a particular field). Look up <code>OverloadedRecordFields</code> for more."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 6, "last_activity_date": 1510073706, "creation_date": 1510073706, "answer_id": 47163398, "question_id": 47160950, "link": "https://stackoverflow.com/questions/47160950/several-data-type-with-type-constructor-accepting-the-same-type-how-to-get-same/47163398#47163398", "title": "Several data type with Type constructor accepting the same Type, how to get same name accessor ?", "body": "<p>Records (and their accessors) in Haskell are... suboptimal. That said, this particular issue regarding duplicate record fields has a workaround (since GHC 8.0) in the form of the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#duplicate-record-fields\" rel=\"noreferrer\"><code>DuplicateRecordFields</code></a> extension. Note that the record accessors have to be used in an unambiguous fashion (there is no fancy polymorphism happening here).</p>\n\n<pre><code>{-# LANGUAGE DuplicateRecordFields #-}\n\ntype Age = Int\ntype Name = String\n\ndata AnimalType = Dog | Cat | Snake\n  deriving (Read, Show, Eq)\n\ndata Animal = Animal\n  { animalType :: AnimalType\n  , name :: Name\n  , age :: Age\n  } deriving(Show, Eq)\n\ndata Owner = Owner\n  { name :: Name\n  , age :: Age\n  , animals :: [Animal]\n  } deriving(Show, Eq)\n\ngarfield = Animal Cat \"Garfield\" 8\nrantanplan = Animal Dog \"Rantanplan \" 4\nkaa = Animal Snake \"Kaa\" 15\n\ndupond = Owner \"Dupont\" 28 [garfield, rantanplan]\nbob = Owner \"Bob\" 35 [kaa] \n</code></pre>\n"}], "owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1510073706, "creation_date": 1510066651, "question_id": 47160950, "link": "https://stackoverflow.com/questions/47160950/several-data-type-with-type-constructor-accepting-the-same-type-how-to-get-same", "title": "Several data type with Type constructor accepting the same Type, how to get same name accessor ?", "body": "<p>Short : I have a solution to my problem, but it seems overkill so I wonder if I miss something.</p>\n\n<p>Long :\nI have a 2 data Type, an Animal type and an Owner type. Both have same \"attributes\" age and name. For sake of simplicity, I want to be able to call age and name indifferenly on Animal and on Owner</p>\n\n<pre><code>type Age = Int\ntype Name = String\n\ndata AnimalType = Dog | Cat | Snake\n deriving (Read, Show,Eq)\n\n--with  datatype and pattern matching\ndata Animal = Animal AnimalType Name Age\n deriving(Show, Eq)\nname (Animal _ name _) = name \nage (Animal _ _ age) = age \nanimalType (Animal animalType _ _) = animalType \n\ndata Owner = Owner Name Age [Animal]\n deriving(Show,Eq)\nname    (Owner name _      _) = name \nage     (Owner _    age    _) = age\nanimals (Owner _    _      animals) = animals\n\ngarfield = Animal Cat \"Garfield\" 8\nrantanplan = Animal Dog \"Rantanplan \" 4\nkaa = Animal Snake \"Kaa\" 15\n\ndupond = Owner \"Dupont\" 28 [garfield, rantanplan]\nbob = Owner \"Bob\" 35 [kaa]\n</code></pre>\n\n<p>This does not compile, </p>\n\n<pre><code>  Multiple declarations of `age'\n</code></pre>\n\n<p>The same thing does not work neither with Record syntax.</p>\n\n<p>Doing so, one is forced to name differently age for Owner and age for Animal.</p>\n\n<p>Then I dug a bit and found out that I could use typeclass to achieve that.</p>\n\n<pre><code>type Age = Int\ntype Name = String\n\nclass Nameable a where\n name:: a -&gt; Name\n\nclass Ageable a where\n age:: a -&gt; Age\n\n\ndata AnimalType = Dog | Cat | Snake\n deriving (Read, Show,Eq)\n\n--with  datatype and pattern matching\ndata Animal = Animal AnimalType Name Age\n deriving(Show, Eq)\n\ninstance Nameable Animal where\n name (Animal _ name _) = name \n\ninstance Ageable Animal where\n age (Animal _ _ age) = age\n\nanimalType (Animal animalType _ _) = animalType \n\n\ndata Owner = Owner Name Age [Animal]\n deriving(Show,Eq)\n\ninstance Nameable Owner where \n name (Owner name _ _) = name\n\ninstance Ageable Owner where\n age (Owner _ age _) = age\n\nanimals (Owner _    _      animals) = animals\n\n\n\ngarfield = Animal Cat \"Garfield\" 8\nrantanplan = Animal Dog \"Rantanplan \" 4\nkaa = Animal Snake \"Kaa\" 15\n\ndupond = Owner \"Dupont\" 28 [garfield, rantanplan]\nbob = Owner \"Bob\" 35 [kaa]\n</code></pre>\n\n<p>This approach is almost identical to usage of Interface in Java. The first one that does not work is closer to old C struct approach. </p>\n\n<p>is there a quicker way to achieve the same result ? </p>\n"}, {"tags": ["haskell", "typeclass", "quantifiers"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1510066484, "post_id": 47160843, "comment_id": 81271272, "body": "What do you mean with &quot;<i>does not work</i>&quot;. Please provide a compile error/unexpected output, etc."}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1510066595, "post_id": 47160843, "comment_id": 81271350, "body": "I meant typecheck of course. everyone knows after type checking, everything works ;) - (you are right though)"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1510066595, "post_id": 47160843, "comment_id": 81271352, "body": "The error suggests it already goes wrong with the <code>newtype</code>, not <code>ko</code>/<code>ok</code>."}], "answers": [{"comments": [{"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1510066972, "post_id": 47160986, "comment_id": 81271622, "body": "spot on. thank you. so polymorphism should come last. I have another very counter intuitive example where switching from successive applications g applied to f applied to some value works, while composing functions first and applying to the value fails. a bit frustrating.."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 5, "last_activity_date": 1510066735, "creation_date": 1510066735, "answer_id": 47160986, "question_id": 47160843, "link": "https://stackoverflow.com/questions/47160843/existential-quantification-of-typeclass-constraints/47160986#47160986", "title": "Existential quantification of typeclass constraints", "body": "<p><code>ko</code> would only work if the type of <code>a</code> were</p>\n\n<pre><code>a :: Maybe (\u2200 expr . ExpSYM expr =&gt; expr)\na = lit &lt;$&gt; Just 5\n</code></pre>\n\n<p>...because only then would you be able to do-unwrap it to obtain the polymorphic value <code>v :: \u2200 expr . ExpSYM expr =&gt; expr</code>. That value must be polymorphic so it can actually be used in <code>Wrapped</code>.</p>\n\n<p>But <code>Maybe (\u2200 expr . ExpSYM expr =&gt; expr)</code> is an <a href=\"https://en.wikipedia.org/wiki/Parametric_polymorphism#Impredicative_polymorphism\" rel=\"noreferrer\">impredicative type</a>. GHC Haskell doesn't support impredicative types.</p>\n\n<p>OTOH, in <code>ok</code>, <code>v</code> is just a boring old integer coming from an unspectacular <code>Just 5 :: Maybe Int</code>. Only <code>e</code> introduces the polymorphism, but does so outside of the <code>Maybe</code> monad.</p>\n"}], "owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 47160986, "answer_count": 1, "score": 3, "last_activity_date": 1510095534, "creation_date": 1510066352, "last_edit_date": 1510095534, "question_id": 47160843, "link": "https://stackoverflow.com/questions/47160843/existential-quantification-of-typeclass-constraints", "title": "Existential quantification of typeclass constraints", "body": "<p>I am not sure why <code>ko</code> does not typecheck.\nIs there a particularly enlightening explanation ?</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE RankNTypes #-}\n{-# LANGUAGE NoMonomorphismRestriction, FlexibleInstances #-}\n\nmodule Wrap where\n\nclass ExpSYM repr where\n    lit :: Int -&gt; repr\n\nnewtype Wrapped = Wrapped{unWrap :: forall repr. ExpSYM repr =&gt; repr}\n\na = (lit &lt;$&gt; Just 5) :: ExpSYM expr =&gt; Maybe expr\n\nko :: Maybe Wrapped\nko = do v &lt;- a\n        return $ Wrapped $ v\n\nok :: Maybe Wrapped\nok = do v &lt;- Just 5\n        let e = lit v\n        return $ Wrapped $ e\n</code></pre>\n\n<p>The compiler mentions </p>\n\n<pre><code>SO.hs:15:14: error:\n    \u2022 No instance for (ExpSYM a0) arising from a use of \u2018a\u2019\n    \u2022 In a stmt of a 'do' block: v &lt;- a\n      In the expression:\n        do { v &lt;- a;\n             return $ Wrapped $ v }\n      In an equation for \u2018ko\u2019:\n          ko\n            = do { v &lt;- a;\n                   return $ Wrapped $ v }\n\nSO.hs:16:28: error:\n    \u2022 Couldn't match expected type \u2018repr\u2019 with actual type \u2018a0\u2019\n        because type variable \u2018repr\u2019 would escape its scope\n      This (rigid, skolem) type variable is bound by\n        a type expected by the context:\n          ExpSYM repr =&gt; repr\n        at SO.hs:16:18-28\n    \u2022 In the second argument of \u2018($)\u2019, namely \u2018v\u2019\n      In the second argument of \u2018($)\u2019, namely \u2018Wrapped $ v\u2019\n      In a stmt of a 'do' block: return $ Wrapped $ v\n    \u2022 Relevant bindings include v :: a0 (bound at SO.hs:15:9)\nFailed, modules loaded: none.\n</code></pre>\n\n<p><strong><em>Edit :</em></strong>\nFound a nice solution to circumvent this in Oleg's note, which is to specialize the type such that the polymorphism is removed by type application, adding the instance </p>\n\n<pre><code>instance ExpSYM Wrapped where\n   lit x = Wrapped $ lit x\n</code></pre>\n\n<p>we then have </p>\n\n<pre><code>notko :: Maybe Wrapped\nnotko = do v &lt;- a    \n           return $ v -- note the difference. what's the type of a ?\n\n-- and we get all the usual goodies, no silly impredicative error\nalsoOk = lit &lt;$&gt; Just 5 :: Maybe Wrapped\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1510063242, "post_id": 47159722, "comment_id": 81269086, "body": "<code>sequence :: [IO a] -&gt; IO [a]</code> or <code>mapM :: (a -&gt; IO b) -&gt; [a] -&gt; IO [b]</code>."}, {"owner": {"reputation": 51, "user_id": 8168200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-QsHbz8YjcMY/AAAAAAAAAAI/AAAAAAAAACw/jqGmmP79ahk/photo.jpg?sz=128", "display_name": "BaasBartMans", "link": "https://stackoverflow.com/users/8168200/baasbartmans"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1510072755, "post_id": 47159722, "comment_id": 81275732, "body": "thanks, works like a charm"}], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 3, "last_activity_date": 1510064725, "creation_date": 1510064725, "answer_id": 47160304, "question_id": 47159722, "link": "https://stackoverflow.com/questions/47159722/haskell-gloss-io-textures/47160304#47160304", "title": "Haskell gloss IO textures", "body": "<p>There's a helper function that gets you almost all of the way there:</p>\n\n<pre><code>sequence :: [IO a] -&gt; IO [a]\n</code></pre>\n\n<p>I.e. it combines a list of IO actions into a single action that (when run) returns a list of the results.</p>\n\n<p>You can't use this \"inside\" of the call to <code>pictures</code> (because that's pure Haskell code, which can't run IO actions, so there's no way to get that <code>[a]</code>), but you can do it the other way:</p>\n\n<pre><code>(&gt;&gt;=) :: IO a -&gt; (a -&gt; IO b) -&gt; IO b\n</code></pre>\n\n<p>Use <code>&gt;&gt;=</code> to push your function \"into\" IO:</p>\n\n<pre><code>sequence (map loadBMP myBMPFiles) &gt;&gt;= (\\textures -&gt; display window background (pictures textures))\n</code></pre>\n\n<p>(By the way, I'm assuming you have a list of filenames called <code>myBMPFiles</code> here.)</p>\n\n<p>The same code can also be written using <code>do</code> notation:</p>\n\n<pre><code>do\n    textures &lt;- sequence (map loadBMP myBMPFiles)\n    display window background (pictures textures)\n</code></pre>\n\n<p>And finally, <code>sequence</code> and <code>map</code> can be combined into <code>mapM</code> (also in the standard library):</p>\n\n<pre><code>do\n    textures &lt;- mapM loadBMP myBMPFiles\n    display window background (pictures textures)\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 8168200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-QsHbz8YjcMY/AAAAAAAAAAI/AAAAAAAAACw/jqGmmP79ahk/photo.jpg?sz=128", "display_name": "BaasBartMans", "link": "https://stackoverflow.com/users/8168200/baasbartmans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "accepted_answer_id": 47160304, "answer_count": 1, "score": 1, "last_activity_date": 1510064725, "creation_date": 1510062911, "question_id": 47159722, "link": "https://stackoverflow.com/questions/47159722/haskell-gloss-io-textures", "title": "Haskell gloss IO textures", "body": "<p>I am making a game, for which i use textures. These textures are loaded in in Gloss from BMP files and give a IO Picture. </p>\n\n<p>Now i have a list of IO Pictures, which i want to render. The render takes a picture, and you can compose multiple pictures into one, with pictures</p>\n\n<p>Now </p>\n\n<pre><code>Render :: IO()\ntexture1 &lt;- loadBMP \"D:/t1.bmp\"\n\ndisplay window background (pictures [translate 10 50 $ texture1])\n</code></pre>\n\n<p>works, however, i want to use a list of textures. As this works with small numbers, but it becomes too much with 100s of textures. </p>\n\n<p>Now for some reason, the pictures function, which takes Picture, now works with IO, which i believe has something to do with the do. </p>\n\n<p>My question is, is there a way to put this into a function? If it were all Picture, it would be easy, but because of the IO Picture, I dont know how to do it</p>\n\n<p>something like</p>\n\n<pre><code>func :: [IO Picture] -&gt; [?]\nfunc [] = []\nfunc (x:xs) =  do\n               x' &lt;- x\n               x' ++ func xs\n</code></pre>\n\n<p>and then</p>\n\n<pre><code> display window background (pictures func)\n</code></pre>\n"}, {"tags": ["haskell", "binary-search-tree"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1510061532, "post_id": 47159220, "comment_id": 81267905, "body": "What did you post all that code for?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1510061610, "post_id": 47159220, "comment_id": 81267950, "body": "If you manage to sort a tree, I don&#39;t see how it can be hard to find the maximum."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1510062354, "post_id": 47159220, "comment_id": 81268484, "body": "What did you try? This looks more as a problem dump than a question. Also, most of your code is irrelevant to the task: I guess you did not write it, but you merely copy &amp; pasted from somewhere else. You should show your attempt, and describe your issues. Also see <a href=\"https://stackoverflow.com/help/on-topic\">stackoverflow.com/help/on-topic</a>"}, {"owner": {"reputation": 51, "user_id": 7705348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb96e95a587838505ef50fe24a58f86?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/7705348/blaze"}, "edited": false, "score": 0, "creation_date": 1510062900, "post_id": 47159220, "comment_id": 81268857, "body": "i reduced the size of the code"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1510062902, "post_id": 47159220, "comment_id": 81268858, "body": "Now the question has no (longer an) attempt of the OP side."}], "answers": [{"tags": [], "owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "is_accepted": false, "score": 1, "last_activity_date": 1510075086, "last_edit_date": 1510075086, "creation_date": 1510063471, "answer_id": 47159921, "question_id": 47159220, "link": "https://stackoverflow.com/questions/47159220/max-of-a-tree-in-haskell/47159921#47159921", "title": "Max of a Tree in haskell", "body": "<p>As some of the comments have suggested, you can just sort the the tree, and take the maximum. You can use your earlier <code>inOrder</code> and <code>makeTree</code> functions to create a tree sort function:</p>\n\n<pre><code>treeSort :: (Ord a) =&gt; [a] -&gt; [a]\ntreeSort xs = inOrder (makeTree xs)\n</code></pre>\n\n<p>Which gives a list of your tree items in sorted order, then just take the <a href=\"https://www.haskell.org/hoogle/?hoogle=maximum\" rel=\"nofollow noreferrer\"><code>maximum</code></a> of this:</p>\n\n<pre><code>maxTree :: (Ord a) =&gt; [a] -&gt; a\nmaxTree xs = maximum (treeSort xs)\n</code></pre>\n\n<p>Which has this behaviour:</p>\n\n<pre><code>Prelude&gt; let sortedTree = treeSort [4,3,2,1,5,6,8,7,9]\nPrelude&gt; sortedTree\n[1,2,3,4,5,6,7,8,9]\nPrelude&gt; maxTree sortedTree\n9\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 7705348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb96e95a587838505ef50fe24a58f86?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/7705348/blaze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 827, "favorite_count": 0, "closed_date": 1510079458, "answer_count": 1, "score": -8, "last_activity_date": 1510075086, "creation_date": 1510061369, "last_edit_date": 1510062863, "question_id": 47159220, "link": "https://stackoverflow.com/questions/47159220/max-of-a-tree-in-haskell", "closed_reason": "Needs more focus", "title": "Max of a Tree in haskell", "body": "<pre><code>data Tree a = Null | Node a (Tree a) (Tree a)\n     deriving (Read,Show)\n</code></pre>\n\n<p>Having a problem here, how would I find the maximum value of a binary tree?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8638529"}, "edited": false, "score": 0, "creation_date": 1510057577, "post_id": 47157839, "comment_id": 81265078, "body": "There&#39;s a condition: at least 3 functions (compose 1 [(+1),(+1)] shouldn&#39;t work). How can I control it?"}, {"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "edited": false, "score": 0, "creation_date": 1510057926, "post_id": 47157839, "comment_id": 81265303, "body": "As @Willem Van Onsem points out, you can use flip ($) instead of (\\a b -&gt; b a) which you might find cleaner."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1510058262, "post_id": 47157839, "comment_id": 81265538, "body": "@LokiTheCreator The requirement that it should not work with a shorter list is quite weird. Usually, in task assignments, we find requirements such as &quot;it must work with lists of length &gt;=3&quot; instead of &quot;it must fail on lists of length &lt;3&quot;. I&#39;d suggest to double check that failing is actually a requirement, since it seems likely that you are misreading the task description."}], "tags": [], "owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "is_accepted": false, "score": 3, "last_activity_date": 1510058045, "last_edit_date": 1510058045, "creation_date": 1510057180, "answer_id": 47157839, "question_id": 47157748, "link": "https://stackoverflow.com/questions/47157748/list-of-functions-applying-to-argument/47157839#47157839", "title": "List of functions applying to argument", "body": "<p>This should do the trick:</p>\n\n<pre><code>compose x ys = foldl (\\a b -&gt; b a) x ys\n</code></pre>\n\n<p>This can be ETA reduced to be </p>\n\n<pre><code>compose = foldl (\\a b -&gt; b a)\n</code></pre>\n\n<p>or alternatively </p>\n\n<pre><code>compose x [] = x\ncompose x (y:ys) = compose (y x) ys\n</code></pre>\n\n<p>It applies the function to the input, then uses that input as the next input until it reaches the end of the list, and it then returns the final value.</p>\n\n<pre><code>\u03bb&gt; compose 1 [(+1), (+1), (/2)]\n1.5\n\u03bb&gt; compose 1 [(+1), (+1), (/2), (*10), (+(-1))]\n14.0\n\u03bb&gt; compose 1 []\n1\n\u03bb&gt; \n</code></pre>\n\n<p>Because of how haskell parses minuses, I think you have to make a minus function by adding a negative.</p>\n\n<p>If the user has to enter at least 3 functions, you could do this:</p>\n\n<pre><code>compose x ys\n    | length ys &lt; 3 = error \"Must enter at least 3 functions!\"\n    | otherwise = foldl (\\a b -&gt; b a) x ys\n</code></pre>\n\n<p>Alternatively, you could return a Maybe, as it's not very good style to error on something recoverable.</p>\n\n<pre><code>compose x ys\n    | length ys &lt; 3 = Nothing\n    | otherwise = Just $ foldl (\\a b -&gt; b a) x ys\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1510058584, "last_edit_date": 1510058584, "creation_date": 1510057603, "answer_id": 47157981, "question_id": 47157748, "link": "https://stackoverflow.com/questions/47157748/list-of-functions-applying-to-argument/47157981#47157981", "title": "List of functions applying to argument", "body": "<h1>General problem</h1>\n\n<p>You can use <code>foldl</code> for this: in that case you pass an accumulator left-to-right over the list, and perform some operation over it:</p>\n\n<p>So your <code>compose</code> then would look something like:</p>\n\n<pre><code>compose :: a -&gt; [(a -&gt; a)] -&gt; a\ncompose x0 fs = foldl (??) x0 fs\n</code></pre>\n\n<p>So now the question is what we do in <code>??</code>. The first argument is the accumulator, the second an element of the list, a function. So we have to implement something like:</p>\n\n<pre><code>compose :: a -&gt; [(a -&gt; a)] -&gt; a\ncompose x0 fs = foldl g x0 fs\n    where g xi f = ...\n</code></pre>\n\n<p>we thus want to apply <code>f</code> to <code>xi</code> to obtain the next <code>xi</code>. Or in other words:</p>\n\n<pre><code>compose :: a -&gt; [(a -&gt; a)] -&gt; a\ncompose x0 fs = foldl g x0 fs\n    where g xi f = f xi\n</code></pre>\n\n<p>If we aim to simplify the <code>g</code> function, we can write it as:</p>\n\n<pre><code>compose :: a -&gt; [(a -&gt; a)] -&gt; a\ncompose x0 fs = foldl g x0 fs\n    where g = flip ($)\n</code></pre>\n\n<p>and further improve it to:</p>\n\n<pre><code>compose :: a -&gt; [(a -&gt; a)] -&gt; a\ncompose = foldl (flip ($))\n</code></pre>\n\n<p>This then produces:</p>\n\n<pre><code>Prelude&gt; foldl (flip ($)) 1 [(+1)]\n2\nPrelude&gt; foldl (flip ($)) 1 [(+1),(+1)]\n3\nPrelude&gt; foldl (flip ($)) 1 [(+1),(+1),(/2)]\n1.5\n</code></pre>\n\n<h1>Three or more elements</h1>\n\n<p>If you want to restrict the number of elements to three or more, we can use pattern matching:</p>\n\n<pre><code>compose :: a -&gt; [(a -&gt; a)] -&gt; a\ncompose x0 fs@(_:_:_:_) = foldl (flip ($)) x0 fs\n</code></pre>\n\n<p>although it is a bit weird that the program is not supposed to work on lists with no, one or two elements.</p>\n"}, {"tags": [], "owner": {"reputation": 4565, "user_id": 1134885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c428466054762cf7d4b5fb5f4396fa2?s=128&d=identicon&r=PG", "display_name": "NovaDenizen", "link": "https://stackoverflow.com/users/1134885/novadenizen"}, "is_accepted": false, "score": 0, "last_activity_date": 1510071829, "creation_date": 1510071829, "answer_id": 47162774, "question_id": 47157748, "link": "https://stackoverflow.com/questions/47157748/list-of-functions-applying-to-argument/47162774#47162774", "title": "List of functions applying to argument", "body": "<p>Just two cases, zero functions or at least one.</p>\n\n<pre><code>compose x [] = x\ncompose x (f:fs) = compose (f x) fs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1510090008, "creation_date": 1510090008, "answer_id": 47167697, "question_id": 47157748, "link": "https://stackoverflow.com/questions/47157748/list-of-functions-applying-to-argument/47167697#47167697", "title": "List of functions applying to argument", "body": "<p>This can simply be done by using <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-List.html#v:foldl1\" rel=\"nofollow noreferrer\"><code>foldr1</code></a> to cascade the list functions by flipped compose operators</p>\n\n<pre><code>Prelude&gt; foldr1 (flip (.)) [(+5),(/2),(*3)] $ 1\n9.0\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8638529"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 898, "favorite_count": 1, "answer_count": 4, "score": 4, "last_activity_date": 1516064444, "creation_date": 1510056884, "last_edit_date": 1510057648, "question_id": 47157748, "link": "https://stackoverflow.com/questions/47157748/list-of-functions-applying-to-argument", "title": "List of functions applying to argument", "body": "<p>Task is to make function, taking list of unary functions (+1,*2 etc.) <strong>(3 at least)</strong> and consistently applying them to argument. For example: func 1 [(+1),(+1),(/2)] == 1.5. Here's what i made:</p>\n\n<pre><code>compose x [(y),(c),(z)] =  map ($ x) [(z) . (c) . (y)]\n</code></pre>\n\n<p>But how can I make unlimited list of functions? In case if user wants more than 3 functions.\nAnother problem is that this function returns list with one element instead of just one element ([4] instead of 4) and I'm kinda stuck with it</p>\n"}, {"tags": ["bash", "haskell", "ghc"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1510054645, "post_id": 47156947, "comment_id": 81263125, "body": "How did you install alex, do you run your program in a local environment?"}, {"owner": {"reputation": 11, "user_id": 7069324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5525f3ccb24586dc1ff13ec9dbe12fbd?s=128&d=identicon&r=PG&f=1", "display_name": "Tabasco", "link": "https://stackoverflow.com/users/7069324/tabasco"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1510055498, "post_id": 47156947, "comment_id": 81263660, "body": "Yes it is local, and I used &quot;cabal install alex&quot;"}, {"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "edited": false, "score": 0, "creation_date": 1510056118, "post_id": 47156947, "comment_id": 81264055, "body": "If you run <code>alex</code> from a terminal, does the program run?"}, {"owner": {"reputation": 11, "user_id": 7069324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5525f3ccb24586dc1ff13ec9dbe12fbd?s=128&d=identicon&r=PG&f=1", "display_name": "Tabasco", "link": "https://stackoverflow.com/users/7069324/tabasco"}, "edited": false, "score": 0, "creation_date": 1510057511, "post_id": 47156947, "comment_id": 81265025, "body": "No, actually even if I am sitting in the dir where alex is located, it just says -bash: alex: command not found"}, {"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "edited": false, "score": 0, "creation_date": 1510058368, "post_id": 47156947, "comment_id": 81265605, "body": "Has it been installed with the correct permissions? If you chmod +x it, then run ./alex, does that work?"}, {"owner": {"reputation": 11, "user_id": 7069324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5525f3ccb24586dc1ff13ec9dbe12fbd?s=128&d=identicon&r=PG&f=1", "display_name": "Tabasco", "link": "https://stackoverflow.com/users/7069324/tabasco"}, "edited": false, "score": 0, "creation_date": 1510062253, "post_id": 47156947, "comment_id": 81268408, "body": "Yeah! When i chmod +x it and then did ./alex -v it gave me the version number."}, {"owner": {"reputation": 11, "user_id": 7069324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5525f3ccb24586dc1ff13ec9dbe12fbd?s=128&d=identicon&r=PG&f=1", "display_name": "Tabasco", "link": "https://stackoverflow.com/users/7069324/tabasco"}, "edited": false, "score": 0, "creation_date": 1510066163, "post_id": 47156947, "comment_id": 81271049, "body": "But it does not solve the original problem, it still says The program &#39;alex&#39; is required but it could not be found."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1510075820, "post_id": 47156947, "comment_id": 81277667, "body": "Have you sourced the profile after editing?"}, {"owner": {"reputation": 11, "user_id": 7069324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5525f3ccb24586dc1ff13ec9dbe12fbd?s=128&d=identicon&r=PG&f=1", "display_name": "Tabasco", "link": "https://stackoverflow.com/users/7069324/tabasco"}, "edited": false, "score": 0, "creation_date": 1510082678, "post_id": 47156947, "comment_id": 81281571, "body": "It works! Holy cow... I am setting that quote as my desktop background. Thank you for all of your help!"}], "owner": {"reputation": 11, "user_id": 7069324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5525f3ccb24586dc1ff13ec9dbe12fbd?s=128&d=identicon&r=PG&f=1", "display_name": "Tabasco", "link": "https://stackoverflow.com/users/7069324/tabasco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 584, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1510075523, "creation_date": 1510054563, "last_edit_date": 1510075523, "question_id": 47156947, "link": "https://stackoverflow.com/questions/47156947/the-program-alex-is-required-but-it-could-not-be-found-setup-lhs", "title": "The program &#39;alex&#39; is required but it could not be found. Setup.lhs", "body": "<p>I am on Mac os X on a local machine, and is trying to run \n<code>runhaskell Setup.lhs configure --ghc</code>\nI have been trying to install the program in several ways but I always run into the same problem </p>\n\n<blockquote>\n  <p>The program 'alex' is required but it could not be found.</p>\n</blockquote>\n\n<p>I have been trying to link a PATH to Alex, \nWhen I installed alex it showed the path being \n\"Installing executable alex in /Users/xxx/Library/Haskell/ghc-8.2.1/lib/alex-3.2.3/bin\"\nAnd I can find the file there\nI added this to my bash profile</p>\n\n<pre><code>export PATH=/Users/sven/Library/Haskell/ghc-8.2.1/lib/alex-3.2.3/bin:$PATH\n</code></pre>\n\n<p>But the message still shows up.\nI installed \nThank you in advance!</p>\n"}, {"tags": ["parsing", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1510066467, "post_id": 47156251, "comment_id": 81271260, "body": "Is there a reason you aren&#39;t simply defining a <code>Monad</code> instance for your parser (with <code>return</code>, <code>fail</code>, and <code>&gt;&gt;=</code>) instead?"}, {"owner": {"reputation": 475, "user_id": 3235560, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/d5mR4.jpg?s=128&g=1", "display_name": "exrezzo", "link": "https://stackoverflow.com/users/3235560/exrezzo"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1510068391, "post_id": 47156251, "comment_id": 81272646, "body": "@chepner no, this is from our prof. that is teaching us Haskell at University and that&#39;s the way he&#39;s doing things"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1510076692, "post_id": 47156251, "comment_id": 81278203, "body": "OK, I might have ruined the surprise then :)"}, {"owner": {"reputation": 475, "user_id": 3235560, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/d5mR4.jpg?s=128&g=1", "display_name": "exrezzo", "link": "https://stackoverflow.com/users/3235560/exrezzo"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1510077228, "post_id": 47156251, "comment_id": 81278500, "body": "@chepner LOL :D"}], "answers": [{"tags": [], "owner": {"reputation": 225, "user_id": 8363795, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NkUCkHmpY58/AAAAAAAAAAI/AAAAAAAAAY4/Ylb34NmG0p4/photo.jpg?sz=128", "display_name": "&#193;d&#225;m R&#233;v&#233;sz", "link": "https://stackoverflow.com/users/8363795/%c3%81d%c3%a1m-r%c3%a9v%c3%a9sz"}, "is_accepted": false, "score": 1, "last_activity_date": 1510053182, "creation_date": 1510053182, "answer_id": 47156491, "question_id": 47156251, "link": "https://stackoverflow.com/questions/47156251/sequencing-operator-in-haskell-parser/47156491#47156491", "title": "Sequencing operator in Haskell Parser", "body": "<p>As far as I can see it reads three char and gives back the first and the last one as a pair wrapped in a Parser monad.</p>\n"}, {"tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": false, "score": 0, "last_activity_date": 1510148649, "creation_date": 1510148649, "answer_id": 47181293, "question_id": 47156251, "link": "https://stackoverflow.com/questions/47156251/sequencing-operator-in-haskell-parser/47181293#47181293", "title": "Sequencing operator in Haskell Parser", "body": "<p>If <code>p</code> specifically is the problem, it's working similarly to this pseudo-program, which is completely made up but hopefully illustrates the flow:</p>\n\n<pre><code>p input = let [(x, rest1)] = item input\n              [(z, rest2)] = item rest1\n              [(y, rest3)] = item rest2\n          in\n             [((x, y), rest3)]\n</code></pre>\n\n<p>That is, it parses three characters and produces a pair consisting of the first and the third characters.  </p>\n"}], "owner": {"reputation": 475, "user_id": 3235560, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/d5mR4.jpg?s=128&g=1", "display_name": "exrezzo", "link": "https://stackoverflow.com/users/3235560/exrezzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1510148649, "creation_date": 1510052451, "last_edit_date": 1510052587, "question_id": 47156251, "link": "https://stackoverflow.com/questions/47156251/sequencing-operator-in-haskell-parser", "title": "Sequencing operator in Haskell Parser", "body": "<p>We are trying to build a Parser, but I can't understand the way the function p works, even if I understood the <code>&gt;&gt;&gt;=</code> operator. How does de <code>p</code> function works?</p>\n\n<pre><code>type Parser a = String -&gt; [(a, String)]\n\nreturnb :: a -&gt; Parser a\nreturnb v = \\input -&gt; [(v, input)]\n\nfailure :: Parser a\nfailure = \\input -&gt; []\n\nitem :: Parser Char\nitem = \\input -&gt; case input of\n    [] -&gt; []\n    (x:xs) -&gt; [(x, xs)]\n\n\nparse :: Parser a -&gt; String -&gt; [(a, String)]\nparse parser input = parser input\n</code></pre>\n\n<hr>\n\n<pre><code>-- Sequencing operator\n\n(&gt;&gt;&gt;=) :: Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b\np &gt;&gt;&gt;= f = \\input -&gt; case parse p input of\n    [] -&gt; []\n    [(v, out)] -&gt; parse (f v) out\n</code></pre>\n\n<hr>\n\n<pre><code>p :: Parser (Char, Char)\np = item &gt;&gt;&gt;= \\x -&gt; \n    item &gt;&gt;&gt;= \\z -&gt; \n    item &gt;&gt;&gt;= \\y -&gt; \n    returnb (x,y)\n</code></pre>\n"}, {"tags": ["haskell", "io"], "answers": [{"tags": [], "owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "is_accepted": false, "score": 4, "last_activity_date": 1510051357, "creation_date": 1510051357, "answer_id": 47155895, "question_id": 47155641, "link": "https://stackoverflow.com/questions/47155641/pre-filled-user-input/47155895#47155895", "title": "Pre-filled user input", "body": "<p>Editing the input lines and similar functionality is typically provided in POSIX world by <a href=\"https://en.wikipedia.org/wiki/GNU_Readline\" rel=\"nofollow noreferrer\">readline library</a>, and searching for \"haskell readline\" would be a good starting point if you want to know more about this.</p>\n\n<p>In Haskell, <a href=\"https://hackage.haskell.org/package/haskeline\" rel=\"nofollow noreferrer\">haskeline</a> package provides similar functionality.</p>\n\n<p>The function for your use case is <a href=\"https://hackage.haskell.org/package/haskeline-0.7.4.0/docs/System-Console-Haskeline.html#v:getInputLineWithInitial\" rel=\"nofollow noreferrer\">getInputLineWithInitial</a>:</p>\n\n<pre><code>getInputLineWithInitial\n    :: MonadException m  \n    =&gt; String                  -- ^ The input prompt\n    -&gt; (String, String)        -- ^ The initial value left and right of the cursor\n    -&gt; InputT m (Maybe String)\n</code></pre>\n\n<p>You can convert an <code>InputT IO</code> value to <code>IO</code> by using <a href=\"https://hackage.haskell.org/package/haskeline-0.7.4.0/docs/System-Console-Haskeline.html#v:runInputT\" rel=\"nofollow noreferrer\">runInputT</a>:</p>\n\n<pre><code>runInputT defaultSettings :: InputT IO a -&gt; IO a\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "is_accepted": true, "score": 2, "last_activity_date": 1524924132, "last_edit_date": 1524924132, "creation_date": 1510056759, "answer_id": 47157702, "question_id": 47155641, "link": "https://stackoverflow.com/questions/47155641/pre-filled-user-input/47157702#47157702", "title": "Pre-filled user input", "body": "<p>Building off @Koterpillar's answer, here is an implementation of <code>editLine</code> as specified in the question, along with a slightly more general (but equally powerful) function:</p>\n\n<pre><code>import System.Console.Haskeline (InputT, runInputT, getInputLineWithInitial, defaultSettings)\n\neditLine :: String -&gt; IO String\neditLine = getLinePrefill \"\"\n\n-- getLinePrefill prompt = (putStr prompt &gt;&gt;) . editLine\ngetLinePrefill :: String -&gt; String -&gt; IO String\ngetLinePrefill prompt fill = line\n    where\n        -- no line == empty line\n        line :: IO String\n        line = concat &lt;$&gt; maybeLine\n\n        -- run the InputT monad\n        maybeLine :: IO (Maybe String)\n        maybeLine = runInputT defaultSettings $ inputLine\n\n        -- Get input line, prompt as supplied, default-string to the left of mouse\n        inputLine :: InputT IO (Maybe String)\n        inputLine = getInputLineWithInitial prompt (fill, \"\")\n</code></pre>\n"}], "owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 47157702, "answer_count": 2, "score": 2, "last_activity_date": 1524924132, "creation_date": 1510050658, "question_id": 47155641, "link": "https://stackoverflow.com/questions/47155641/pre-filled-user-input", "title": "Pre-filled user input", "body": "<p>I'm intending to write a simple program for line-wise file editing. The basic form of this program (which I know I can do) would allow the user to prepend, insert, and append lines to a file, in addition to deleting and replacing lines.</p>\n\n<p>The line replace operation would require the user to write the entire desired contents of the line in <code>stdin</code>, but this is tedious if the new line is sufficiently similar to the old line. Ideally, they would have the added option to edit the line. The user input would pre-fill with the old contents of the line, allowing them to modify this line rather than typing the whole thing out.</p>\n\n<p>I understand the regular <code>getLine</code> function cannot interpret arrow keypresses or other meta-keys except for backspace, so this may be a far more complex problem than it seemed on the surface; but if there is a preexisting function or library for this kind of operation I would be very appreciative.</p>\n\n<p>If it helps, the desired type would be the following:</p>\n\n<pre><code>editLine :: String -&gt; IO String\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 2, "creation_date": 1510051621, "post_id": 47155540, "comment_id": 81261200, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/47146630/combining-multiple-functions\">Combining multiple functions</a>"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 1, "last_activity_date": 1510050659, "creation_date": 1510050659, "answer_id": 47155643, "question_id": 47155540, "link": "https://stackoverflow.com/questions/47155540/haskell-use-map/47155643#47155643", "title": "Haskell use map", "body": "<p>You can first construct a \"translation\" function:</p>\n\n<pre><code>trns 'A' = 'U'\ntrns 'T' = 'A'\ntrns 'C' = 'G'\ntrns 'G' = 'C'\ntrns x = x\n</code></pre>\n\n<p>And ow we can use:</p>\n\n<pre><code>condi\u00e7oes = map trns\n</code></pre>\n\n<p>So we perform a mapping over the <code>trns</code> function.</p>\n\n<p>Note that there is a <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:reverse\" rel=\"nofollow noreferrer\"><strong><code>reverse :: [a] -&gt; [a]</code></strong></a> builtin, or you can ue <code>foldl</code> for this:</p>\n\n<pre><code>reverse' :: [a] -&gt; [a]\nreverse' = foldl (flip (:)) []\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 8077394, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e547ed41ce104877f55cfae87619f5af?s=128&d=identicon&r=PG&f=1", "display_name": "JohnTeiMir", "link": "https://stackoverflow.com/users/8077394/johnteimir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510050659, "creation_date": 1510050382, "last_edit_date": 1510050452, "question_id": 47155540, "link": "https://stackoverflow.com/questions/47155540/haskell-use-map", "title": "Haskell use map", "body": "<p>I would like to know if it is possible to use a map in my code instead of being as it is. My code is to receive a <code>String</code>, replace some <code>Char</code>s with others and reverse it, but I wanted to use a map in this code.</p>\n\n<pre><code>transforme' ::[Char] -&gt; [Char]\ntransforme'   = reverse'.condi\u00e7oes\n\ncondi\u00e7oes :: [Char] -&gt; [Char]\ncondi\u00e7oes   = foldr (\\x -&gt; if\n                x == 'A' then ('U':)\n                else if x == 'T' then ('A':)\n                else if x == 'C' then ('G':)\n                else if x == 'G' then ('C':)\n                else (x:)) []\n\nreverse' :: [Char] -&gt; [Char]\nreverse' xs = foldr (\\b f x -&gt; f (b : x)) id xs []\n</code></pre>\n"}, {"tags": ["haskell", "algebraic-data-types"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1510048908, "post_id": 47154663, "comment_id": 81259394, "body": "That&#39;s not an <i>order</i> relation."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1510049169, "post_id": 47154663, "comment_id": 81259556, "body": "Related: <a href=\"https://stackoverflow.com/q/28665917/67579\">stackoverflow.com/q/28665917/67579</a>"}, {"owner": {"reputation": 1204, "user_id": 2215449, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a3a5594f450529ec1dc7fdd263659b37?s=128&d=identicon&r=PG", "display_name": "tintin", "link": "https://stackoverflow.com/users/2215449/tintin"}, "edited": false, "score": 0, "creation_date": 1510049353, "post_id": 47154663, "comment_id": 81259689, "body": "is this what you are looking for ?<code>data Hand = P | S | R deriving (Show, Eq, Ord)</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 1204, "user_id": 2215449, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a3a5594f450529ec1dc7fdd263659b37?s=128&d=identicon&r=PG", "display_name": "tintin", "link": "https://stackoverflow.com/users/2215449/tintin"}, "edited": false, "score": 1, "creation_date": 1510049395, "post_id": 47154663, "comment_id": 81259727, "body": "@tintin: probably not, since the rules of <i>rock-paper-scissors</i> are not an order relation."}, {"owner": {"reputation": 1204, "user_id": 2215449, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a3a5594f450529ec1dc7fdd263659b37?s=128&d=identicon&r=PG", "display_name": "tintin", "link": "https://stackoverflow.com/users/2215449/tintin"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1510049520, "post_id": 47154663, "comment_id": 81259793, "body": "@WillemVanOnsem gotcha, and rock paper scissors can not form a valid <code>Ord</code> relation ship."}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 1079328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec7a58050502ff3c1af844029cc1c3db?s=128&d=identicon&r=PG&f=1", "display_name": "user1079328", "link": "https://stackoverflow.com/users/1079328/user1079328"}, "edited": false, "score": 1, "creation_date": 1510050020, "post_id": 47155208, "comment_id": 81260146, "body": "Thanks for explaining why this couldn&#39;t be an order relation. Adding the <code>beats</code> function achieves what I was looking for (not having to write all the compares)."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 8, "last_activity_date": 1510049532, "creation_date": 1510049532, "answer_id": 47155208, "question_id": 47154663, "link": "https://stackoverflow.com/questions/47154663/haskell-cyclic-ord-relationship/47155208#47155208", "title": "Haskell Cyclic Ord Relationship", "body": "<p>What you describe here is <strong><em>not</em> an order relation</strong>. An order relation is:</p>\n\n<ol>\n<li><em>reflexive</em>, all values <code>x</code> are less than or equal tot itself;</li>\n<li>antisymmetric: if <code>x</code> is less than or equal to <code>y</code> and <code>y</code> is less than or equal to <code>x</code>, then <code>x</code> is equal to <code>y</code>;</li>\n<li><em>transitive</em>: if <code>x</code> is less than or equal to <code>y</code>, and <code>y</code> is less than or equal to <code>z</code>, then <code>x</code> is less than or equal to <code>z</code>.</li>\n</ol>\n\n<p>Your definition is <em>not</em> transitive. Indeed: <code>S</code> is less than <code>R</code>, <code>R</code> is less than <code>P</code>, but <code>S</code> is not less than <code>P</code>. I therefore would strongly advice you <em>not</em> to use <code>Ord</code>, since for instance sorting, etc. make use of these invariants.</p>\n\n<p>What you can do is let it derive from <code>Ord</code> automatically:</p>\n\n<pre><code>data Hand = P | S | R deriving (Show, Eq<b>, Ord</b>)</code></pre>\n\n<p>and then define a function <code>beats</code>:</p>\n\n<pre><code>beats :: Hand -&gt; Hand -&gt; Ordering\nbeats R P = LT\nbeats P R = GT\nbeats x y = compare x y\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": false, "score": 3, "last_activity_date": 1510081091, "last_edit_date": 1510081091, "creation_date": 1510079598, "answer_id": 47165111, "question_id": 47154663, "link": "https://stackoverflow.com/questions/47154663/haskell-cyclic-ord-relationship/47165111#47165111", "title": "Haskell Cyclic Ord Relationship", "body": "<p>You can write generic variant of this function:</p>\n\n<pre><code>cyclicRelation :: (Bounded a, Ord a) =&gt; a -&gt; a -&gt; Ordering\ncyclicRelation x y | x == minBound &amp;&amp; y == maxBound = GT\n                   | x == maxBound &amp;&amp; y == minBound = LT\n                   | otherwise                      = x `compare` y\n</code></pre>\n\n<p>Then just derive needed instances:</p>\n\n<pre><code>data Hand = P | S | R deriving (Show, Eq<b>, Ord, Bounded</b>)</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 1, "last_activity_date": 1510503108, "creation_date": 1510503108, "answer_id": 47250972, "question_id": 47154663, "link": "https://stackoverflow.com/questions/47154663/haskell-cyclic-ord-relationship/47250972#47250972", "title": "Haskell Cyclic Ord Relationship", "body": "<p>I liked @freestyle's answer best and influencing by that just draw a Cirord type class which may be applicable to any such cyclic ordered data type like Pokemons etc :)</p>\n\n<pre><code>class (Bounded a, Ord a) =&gt; Cirord a where\n  ccompare   :: a -&gt; a -&gt; Ordering\n  cmax, cmin :: a -&gt; a -&gt; a\n\n  ccompare x y = let mima = [minBound, maxBound]\n                 in if x `elem` mima &amp;&amp; y `elem` mima then compare y x\n                                                      else compare x y\n\n  cmax x y = if ccompare x y == LT then y else x\n  cmin x y = if ccompare x y == LT then x else y\n\ndata Hand = P | S | R deriving (Show, Eq, Ord, Bounded)\ninstance Cirord Hand\n\n*Main&gt; ccompare P R\nGT\n*Main&gt; ccompare S R\nLT\n*Main&gt; ccompare R S\nGT\n*Main&gt; ccompare R P\nLT\n*Main&gt; ccompare P S\nLT\n*Main&gt; ccompare S P\nGT\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 1079328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec7a58050502ff3c1af844029cc1c3db?s=128&d=identicon&r=PG&f=1", "display_name": "user1079328", "link": "https://stackoverflow.com/users/1079328/user1079328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 47155208, "answer_count": 3, "score": 3, "last_activity_date": 1510503108, "creation_date": 1510048187, "question_id": 47154663, "link": "https://stackoverflow.com/questions/47154663/haskell-cyclic-ord-relationship", "title": "Haskell Cyclic Ord Relationship", "body": "<p>I was trying to define a data type for rock paper scissors and came up with something like this: </p>\n\n<pre><code>data Hand = P | S | R deriving (Show, Eq)\n\ninstance Ord Hand where\n  compare R P = LT\n  compare P R = GT\n  compare R S = GT\n  compare S R = LT\n  compare P S = LT\n  compare S P = GT\n  compare _ _ = EQ\n</code></pre>\n\n<p>While writing all that I was wondering if there's any way to define the data type to just have it derive Ord and then specify that\n<code>compare R P = LT</code> and <code>compare P R = GT</code> instead of having to write all the comparisons by hand, for three elements it's okay but it would get tedious with each added element.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1510048082, "post_id": 47154557, "comment_id": 81258801, "body": "No it is just syntax."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 3, "creation_date": 1510049014, "post_id": 47154557, "comment_id": 81259457, "body": "<code>:{</code> and <code>:}</code> are not even syntax. they are GHCi&#39;s commands."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 1, "creation_date": 1510058933, "post_id": 47154557, "comment_id": 81266024, "body": "I find it much more convenient to edit a text file and then (re)load it in ghci. No need for all of these brackets and no surprises such as this one!"}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1510048805, "post_id": 47154823, "comment_id": 81259322, "body": "Yes, GHCi used to require definitions to start their line with <code>let</code>. Since GHC-8, this can be omitted though. Questions like this make me wonder whether that was really a good decision..."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1510053316, "post_id": 47154823, "comment_id": 81262274, "body": "About <code>:{ :}</code>: it is not Haskell syntax, it is GHCi-only syntax allowing multiline input."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1510066691, "post_id": 47154823, "comment_id": 81271426, "body": "<code>:{</code> and <code>:}</code> are independent of whether or not your version of GHCi requires an explicit <code>let</code> keyword; they allow you to span a command across multiple physical lines."}], "tags": [], "owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "is_accepted": false, "score": 4, "last_activity_date": 1510398358, "last_edit_date": 1510398358, "creation_date": 1510048564, "answer_id": 47154823, "question_id": 47154557, "link": "https://stackoverflow.com/questions/47154557/what-is-the-multiple-line-in-haskell-an-operator-a-function-something-else/47154823#47154823", "title": "What is the multiple line in Haskell ? an operator , a function , something else?", "body": "<p>In earlier versions of <code>ghci</code>, lines defining functions would have to be prepended with <code>let</code>. As of a recent version, the <code>let</code> is implicit in any definition line.<br>\nWhat this means is, each line defining your function is treated as its own <code>let</code> expression, so each subsequent line replaces (or 'shadows') the previous definition, instead of adding to it as would occur in a regular Haskell program.</p>\n\n<p>The <code>:{</code> and <code>:}</code> in <code>ghci</code> allow you to write several lines as a single input, whereas usually each line is treated independently in <code>ghci</code>. This means that you can write a multiline <code>let</code> expression:</p>\n\n<pre><code>:{\nlet fact 0 = 1\n    fact n = n * fact (n - 1)\n:}\n</code></pre>\n\n<p>Or, in later versions, this is equivalent:</p>\n\n<pre><code>:{\nfact 0 = 1\nfact n = n * fact (n - 1)\n:}\n</code></pre>\n\n<p>And the function <code>fact</code> will be defined as one would expect in a regular Haskell program.</p>\n"}, {"tags": [], "owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "is_accepted": false, "score": 1, "last_activity_date": 1510048753, "creation_date": 1510048753, "answer_id": 47154901, "question_id": 47154557, "link": "https://stackoverflow.com/questions/47154557/what-is-the-multiple-line-in-haskell-an-operator-a-function-something-else/47154901#47154901", "title": "What is the multiple line in Haskell ? an operator , a function , something else?", "body": "<p>When you define</p>\n\n<pre><code>Prelude&gt; factorial 0 = 1\nPrelude&gt; factorial n = n*factorial(n-1)\nPrelude&gt; factorial 2\n*** Exception: stack overflow\n</code></pre>\n\n<p>The first definition of <code>factorial</code> is discarded, so the function is defined as</p>\n\n<pre><code>Prelude&gt; factorial n = n*factorial(n-1)\n</code></pre>\n\n<p>So you don't have a statement to end the recursion anymore.</p>\n"}, {"comments": [{"owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "edited": false, "score": 3, "creation_date": 1510048936, "post_id": 47154919, "comment_id": 81259416, "body": "It may be unclear to newer haskell users that this only applies to GHCi, and not compiled programs."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1510049135, "last_edit_date": 1510049135, "creation_date": 1510048798, "answer_id": 47154919, "question_id": 47154557, "link": "https://stackoverflow.com/questions/47154557/what-is-the-multiple-line-in-haskell-an-operator-a-function-something-else/47154919#47154919", "title": "What is the multiple line in Haskell ? an operator , a function , something else?", "body": "<blockquote>\n  <p>why the first one is wrong, what happen in this case</p>\n</blockquote>\n\n<p>Because you defined <strong>two functions</strong> that had the same name.</p>\n\n<p>First you define:</p>\n\n<pre><code>factorial 0 = 1\n</code></pre>\n\n<p>later you define:</p>\n\n<pre><code>factorial n = n*factorial(n-1)\n</code></pre>\n\n<p>But Haskell will see the second factorial as a variable that is scoped more local, so the second function definition, <em>hides</em> the previous one. The first line (<code>factorial 0 = 1</code>) is thus no longer part of the definition. Thus Haskell will evaluate <code>factorial 2 -&gt; 2 * factorial 1 -&gt; 2 * 1 * factorial 0 -&gt; 2 * 1 * 0 * factorial (-1) -&gt; ...</code>.</p>\n\n<blockquote>\n  <p>why the 2nd and the 3rd are working</p>\n</blockquote>\n\n<p>Because here you define a <em>single</em> function, and Haskell interpretets the two clauses as two clauses of the <em>same</em> function. The fact that with <code>:t function</code> you obtain the same, is just coincidence.</p>\n\n<p>Note that the above only is valid for GHCi. If you work with a <code>ghc</code> compiler, it will of course see all your statements as part of the same function definition. In case you mix the clauses of two functions (e.g. first <code>a 0 = 0</code>, then <code>b 0 = 0</code>, and then <code>a n = n</code>) it will error about *multiple definitions for the same function).</p>\n"}], "owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 528, "favorite_count": 0, "accepted_answer_id": 47154919, "answer_count": 3, "score": 5, "last_activity_date": 1510398358, "creation_date": 1510047923, "question_id": 47154557, "link": "https://stackoverflow.com/questions/47154557/what-is-the-multiple-line-in-haskell-an-operator-a-function-something-else", "title": "What is the multiple line in Haskell ? an operator , a function , something else?", "body": "<p>I am very new to Haskell , and I must say I am puzzled </p>\n\n<p>I am using GHCi prelude</p>\n\n<p>First attemps to create a factorial </p>\n\n<pre><code>Prelude&gt; factorial 0 = 1\nPrelude&gt; factorial n = n*factorial(n-1)\nPrelude&gt; factorial 2\n*** Exception: stack overflow\n</code></pre>\n\n<p>ends up in stack overflow. Obviously recursion has not stopped.</p>\n\n<pre><code>Prelude&gt; :t factorial\nfactorial :: Num t =&gt; t -&gt; t\n</code></pre>\n\n<p>Then reading this post <a href=\"https://stackoverflow.com/questions/2846050/how-to-define-a-function-in-ghci-across-multiple-lines\">How to define a function in ghci across multiple lines?</a></p>\n\n<p>I found out that I have to use either multiple line edition or braces  (by the way is this an operator ?) </p>\n\n<pre><code>Prelude&gt; let { fact 0 = 1 ; fact n = n * fact (n-1) }\nPrelude&gt; fact 5\n120\nPrelude&gt; ::t fact\nfact :: (Eq p, Num p) =&gt; p -&gt; p\n</code></pre>\n\n<p>or </p>\n\n<pre><code>Prelude&gt; :{\nPrelude| facto 0 = 1\nPrelude| facto n = n*facto(n-1)\nPrelude| :}\nPrelude&gt; facto 4\n24\nPrelude&gt; :t facto\nfacto :: (Eq p, Num p) =&gt; p -&gt; p\n</code></pre>\n\n<p>So, my question is , why the first one is wrong, what happen in this case, why the 2nd and the 3rd are working, and from the result of the :t function, they seem to at least result in the exact same definition.</p>\n"}, {"tags": ["haskell", "exception-handling", "happstack"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1510076484, "post_id": 47153651, "comment_id": 81278097, "body": "I don&#39;t know much about Happstack, but I&#39;m guessing it&#39;s the same as the difference between <code>return undefined</code> (which is not bottom, but a computation whose result is bottom) and <code>putStrLn undefined</code> (which is bottom)."}], "answers": [{"tags": [], "owner": {"reputation": 4625, "user_id": 1861521, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dda04c7abdfe8b05f4a258b7a01900a6?s=128&d=identicon&r=PG", "display_name": "jcarpenter2", "link": "https://stackoverflow.com/users/1861521/jcarpenter2"}, "is_accepted": true, "score": 0, "last_activity_date": 1524808084, "creation_date": 1524808084, "answer_id": 50055998, "question_id": 47153651, "link": "https://stackoverflow.com/questions/47153651/catch-program-errors-in-happstack-request-handler/50055998#50055998", "title": "Catch program errors in Happstack request handler", "body": "<p>I found the answer, by the way.  Basically it has to do with lazy evaluation - the <code>Response</code> object is only evaluated to WHNF until after Happstack has internally started streaming data into the response body, at which point it is too late to change the status code from 200 to 500.</p>\n\n<p>This is the correct behavior if the response is a video stream, since strictly evaluating the response to make sure it does not contain any <code>undefined</code> values before sending the HTTP response would be unwieldy in that case.  However, it is decidedly inconvenient for known-small responses that <em>are</em> practical to deeply, strictly evaluate to eliminate any possibility of bottom values.  Furthermore, HTTP clients (mostly browsers) implicitly assume that a 200 response code means the request was a success - and it is only in specific cases such as streaming videos that the 200 response is in any way \"not trusted\" and the code consuming the HTTP response looks deeper into it to make sure that it is well-formatted and well-formed before processing and displaying it to the end user - indeed as seen here in my question as the browser displays an empty page and the network tab shows <code>200</code> with no content even though there very much was an internal server error.</p>\n\n<p><a href=\"https://github.com/Happstack/happstack-server/pull/36\" rel=\"nofollow noreferrer\">Here</a> is a pull request of mine against Happstack that simply adds some typeclasses to the <code>Response</code> object so that it is possible to deeply, strictly evaluate it before returning it into the <code>ServerPart</code> monad.  That particular PR has had a troubled history (it used to do something a bit larger in scope) and so I might close it and open a fresh one.  If so, that one should be marked as closed and have a link to the fresh one.</p>\n"}], "owner": {"reputation": 4625, "user_id": 1861521, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dda04c7abdfe8b05f4a258b7a01900a6?s=128&d=identicon&r=PG", "display_name": "jcarpenter2", "link": "https://stackoverflow.com/users/1861521/jcarpenter2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 50055998, "answer_count": 1, "score": 3, "last_activity_date": 1524808084, "creation_date": 1510045077, "last_edit_date": 1510046825, "question_id": 47153651, "link": "https://stackoverflow.com/questions/47153651/catch-program-errors-in-happstack-request-handler", "title": "Catch program errors in Happstack request handler", "body": "<p>I'm kind of a noob at Haskell, so I'm not entirely sure if this is a Happstack question or a general Haskell question.</p>\n\n<p>Here's an example of the difficulty I'm having.  This code \"theoretically\" renders some content, but actually throws an error:</p>\n\n<pre><code>throwsError :: String\nthrowsError = fromJust Nothing\n\n-- no error page\nmain :: IO ()\nmain = do\n  simpleHTTP nullConf $ do\n    decodeBody (defaultBodyPolicy \"/tmp/\" 4096 4096 4096)\n    ok $ toResponse throwsError\n</code></pre>\n\n<p>This error does not crash the whole program.  Fortunately, Happstack catches any errors thrown while handling the request, like a web server should.  However, unfortunately it does not display any kind of error page to the user.  It responds with status code 200 and empty content.</p>\n\n<p>Now, if I simply output the error string first:</p>\n\n<pre><code>-- yes error page\nmain :: IO ()\nmain = do\n  simpleHTTP nullConf $ do\n    decodeBody (defaultBodyPolicy \"/tmp/\" 4096 4096 4096)\n    lift $ putStrLn throwsError -- added this line\n    ok $ toResponse throwsError\n</code></pre>\n\n<p>Happstack returns status 500 and displays an error page.  Why is Happstack behaving like this?</p>\n\n<p>The <code>ServerPart</code> monad implements <code>MonadThrow</code>, so I tried importing <code>Control.Monad.Catch (handle)</code> and writing this, but it didn't do what I expected; it again returned 200 with no content:</p>\n\n<pre><code>showErrorPage :: SomeException -&gt; ServerPart Response\nshowErrorPage _ = internalServerError $ toResponse \"Error\"\n\n-- also no error page\nmain :: IO ()\nmain = do\n  simpleHTTP nullConf $ handle showErrorPage $ do\n    decodeBody (defaultBodyPolicy \"/tmp/\" 4096 4096 4096)\n    ok $ toResponse throwsError\n</code></pre>\n\n<p>In case it isn't clear, I would like to handle all errors thrown, so I can log them and display a custom error page.  (Except, of course, for errors that are thrown while logging and displaying the error page).  Guidance would be appreciated.</p>\n"}, {"tags": ["haskell", "windows-10", "ghc"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1510029843, "post_id": 47149996, "comment_id": 81249894, "body": "Sounds like you should <code>report this as a GHC bug:  http:&#47;&#47;www.haskell.org&#47;ghc&#47;reportabug</code>. Could be a duplicate of <a href=\"https://ghc.haskell.org/trac/ghc/ticket/14398\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/ticket/14398</a>, but the GHC developers clearly think this is a bug and will be able to help you more if you tell them about it."}, {"owner": {"reputation": 71, "user_id": 6849194, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0aa59b2afd0efa6a1293291b4a82dfb6?s=128&d=identicon&r=PG&f=1", "display_name": "\u5929\u5bae\u93e1\u82b1", "link": "https://stackoverflow.com/users/6849194/%e5%a4%a9%e5%ae%ae%e9%8f%a1%e8%8a%b1"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1510029960, "post_id": 47149996, "comment_id": 81249922, "body": "thank you for your advice! I will try it too"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1510043912, "post_id": 47149996, "comment_id": 81256047, "body": "As a temporary workaround, try running GHCi from a path which only contains ASCII characters. I&#39;m guessing GHCi is trying to access some path containing Chinese characters, and this triggers some bug."}], "owner": {"reputation": 71, "user_id": 6849194, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0aa59b2afd0efa6a1293291b4a82dfb6?s=128&d=identicon&r=PG&f=1", "display_name": "\u5929\u5bae\u93e1\u82b1", "link": "https://stackoverflow.com/users/6849194/%e5%a4%a9%e5%ae%ae%e9%8f%a1%e8%8a%b1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 291, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1510029043, "creation_date": 1510029043, "question_id": 47149996, "link": "https://stackoverflow.com/questions/47149996/ghc-exe-internal-error-mkpath-failed-converting-char-to-wchar-t", "title": "ghc.exe: internal error: mkPath failed converting char* to wchar_t*", "body": "<p>today I followed the Haskel Platform website download the version 8.2.1 and installed it sucessfully, i add the extra path too.But when I open GHCI in start menu or in PowerShell,it cant run sucessfully, below are the error message, ps: here is Windows 10 Pro Insider Preview, does it matter or what?</p>\n\n<pre><code>GHCi, version 8.2.1: http://www.haskell.org/ghc/  :? for help\nghc.exe: internal error: mkPath failed converting char* to wchar_t*\n   (GHC version 8.2.1 for x86_64_unknown_mingw32)\nPlease report this as a GHC bug:  http://www.haskell.org/ghc/reportabug\n\nThis application has requested the Runtime to terminate it in an unusual way.\nPlease contact the application's support team for more information.\n</code></pre>\n\n<p>Meanwhile, the winghci as well, can't run correctly, once open, it shuts down and report problems.\nDid you guys meet this problem before? Thank you everyone for your suggestions and solutions!</p>\n"}, {"tags": ["haskell", "recursion", "mapping"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1510026995, "post_id": 47149615, "comment_id": 81249236, "body": "You can&#39;t apply <code>lst3 w</code>, because <code>lst3</code> is not a function. It is a list. Similarly, you cannot apply <code>(foo (n-1) lst0) w</code>, because <code>(foo (n-1) lst0)</code> is a list, not a function.  This is what the compiler is telling you in the error message."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 5, "creation_date": 1510028526, "post_id": 47149615, "comment_id": 81249589, "body": "What is your desired output? I&#39;m struggling to understand what you want your code to do."}, {"owner": {"reputation": 1055, "user_id": 593298, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51e634a7316f1a4101f65519d2110cce?s=128&d=identicon&r=PG", "display_name": "keep_learning", "link": "https://stackoverflow.com/users/593298/keep-learning"}, "edited": false, "score": 2, "creation_date": 1510043467, "post_id": 47149615, "comment_id": 81255768, "body": "The problem is that your code is returning arbitrary nested lists.  lst0 = [1,25,100]  lst1 = [1,25,100] lst2 = [[2,26,101],[26,50,125],[101,125,200]] lst3 = [[[3,27,102],[27,51,126],[102,126,201]],[[27,51,126],[51,75,&zwnj;&#8203;150],[126,150,225]],&zwnj;&#8203;[[102,126,201],[126,&zwnj;&#8203;150,225],[201,225,30&zwnj;&#8203;0]]] Try capturing this arbitrary nested lists in data structure."}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1510081883, "post_id": 47149615, "comment_id": 81281171, "body": "what&#39;s going to be the first element? it&#39;s going to be an infinitely nested list, won&#39;t it? it&#39;s not expressible in Haskell."}, {"owner": {"reputation": 61, "user_id": 7113047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20756957eeff77779fbfb97ccf63df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Flaten", "link": "https://stackoverflow.com/users/7113047/eric-flaten"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1510101883, "post_id": 47149615, "comment_id": 81289278, "body": "@FyodorSoikin I see what you&#39;re saying. If <code>lst3</code> were rewritten as <code>lst3&#39; prev =  map (\\z -&gt; map (\\y -&gt; map (\\x -&gt; y + x) lst0) z) prev</code>, then <code>lst3&#39; w</code> would work, right?"}, {"owner": {"reputation": 61, "user_id": 7113047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20756957eeff77779fbfb97ccf63df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Flaten", "link": "https://stackoverflow.com/users/7113047/eric-flaten"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1510102064, "post_id": 47149615, "comment_id": 81289324, "body": "@4castle the desired output of lists is what you see in the comment by keep_learning. All the sub-lists are made up of adding the same value to [1, 25, 100]. So if you added 1 to each one you get [2, 26, 101]. If adding 25 you get [26, 50, 125]. The integers from earlier lists become the number added to [1, 25, 100]."}, {"owner": {"reputation": 61, "user_id": 7113047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20756957eeff77779fbfb97ccf63df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Flaten", "link": "https://stackoverflow.com/users/7113047/eric-flaten"}, "reply_to_user": {"reputation": 1055, "user_id": 593298, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51e634a7316f1a4101f65519d2110cce?s=128&d=identicon&r=PG", "display_name": "keep_learning", "link": "https://stackoverflow.com/users/593298/keep-learning"}, "edited": false, "score": 0, "creation_date": 1510102249, "post_id": 47149615, "comment_id": 81289368, "body": "@keep_learning Actually the lists that are generated follow systematically from a recursive pattern. I explained this pattern in my comment to 4castle. I&#39;m not well versed in Haskell and don&#39;t know how I would generate these lists through data structures. I&#39;ll check into this, though."}, {"owner": {"reputation": 61, "user_id": 7113047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20756957eeff77779fbfb97ccf63df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Flaten", "link": "https://stackoverflow.com/users/7113047/eric-flaten"}, "reply_to_user": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1510102413, "post_id": 47149615, "comment_id": 81289396, "body": "@HuStmpHrrr The first list is <code>[1,25,100]</code>. I explained how the lists are made in my comment to 4castle&#39;s comment (see above). The list won&#39;t be an infinitely nested list since it will begin with a value for n (= the number of levels to the game tree) and subtract one at each iteration, then when n = 1 it outputs lst1 (which is made from adding zero to each element of <code>[1, 25, 100]</code>)."}], "owner": {"reputation": 61, "user_id": 7113047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20756957eeff77779fbfb97ccf63df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Flaten", "link": "https://stackoverflow.com/users/7113047/eric-flaten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 286, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1510112371, "creation_date": 1510026229, "last_edit_date": 1510112371, "question_id": 47149615, "link": "https://stackoverflow.com/questions/47149615/recursive-mapping-function-haskell", "title": "Recursive mapping function haskell", "body": "<p>My goal is to write a recursive function that uses the mapping function to generate a set of lists of integers that are ultimately generated from an initial list of integers. </p>\n\n<p>To help me understand what my coding needs to do, I set <code>lst0</code> as my initial list of integers, then used <code>lst0</code> to make <code>lst1</code>,and <code>lst1</code> to make <code>lst2</code>,and so on and so forth.  </p>\n\n<pre><code>lst0 = [1,25,100] \n\nlst1 =  map (\\x -&gt; 0 + x) lst0\n\nlst2 =  map (\\y -&gt; map (\\x -&gt; y + x) lst0) lst1 \n\nlst3 =  map (\\z -&gt; map (\\y -&gt; map (\\x -&gt; y + x) lst0) z) lst2 \n\nlst4 =  map (\\w -&gt; map (\\z -&gt; map (\\y -&gt; map (\\x -&gt; y + x) lst0) z) w) lst3 \n</code></pre>\n\n<p>Then I rewrote the above lists as functions that take as input the previous list/funcition. They all work fine (e.g., <code>list4 lst3</code> which is short for <code>list4 $ list3 $ list2 $ list1 $ list0</code>).</p>\n\n<pre><code>list0 = [1,25,100] \n\nlist1 prev =  map (\\x -&gt; 0 + x) prev\n\nlist2 prev =  map (\\y -&gt; map (\\x -&gt; y + x) list0) prev\n\nlist3 prev =  map (\\z -&gt; map (\\y -&gt; map (\\x -&gt; y + x) list0)z) prev\n\nlist4 prev =  map (\\w -&gt; map (\\z -&gt; map (\\y -&gt; map (\\x -&gt; y + x) list0)z) w) prev\n</code></pre>\n\n<p>I then rewrote each function with the previous function in it to get the below functions. These also work just fine. </p>\n\n<pre><code>list0' = [1,25,100] \n\nlist1' =  map (\\x -&gt; 0 + x) list0'\n\nlist2' prev =  map (\\y -&gt; map (\\x -&gt; y + x) list0') prev\n\nlist3' prev =  map (\\z -&gt; list2' z) prev\n\nlist4' prev =  map (\\w -&gt; list3' w) prev\n</code></pre>\n\n<p>Yet when I try to condense all of the above functions into a recursive <code>foo</code> function below, I get the following error about <code>(foo (n-1) initlst) z</code>. The <code>n</code> is the depth of the game tree I am building and <code>initlst</code> will be <code>lst0</code> (that is <code>[1,25,100]</code>).</p>\n\n<pre><code>foo n initlst\n | n == 1    = map (\\x -&gt; 0 + x) initlst\n | n == 2    = map (\\y -&gt; map (\\x -&gt; y + x) initlst) $ foo 1 initlst\n | otherwise = map (\\z -&gt; (foo (n-1) initlst) z) $ foo (n-1) initlst  \n</code></pre>\n\n<p>The error message is the following and it references this part of the <code>foo</code> function: <code>(foo (n-1) initlst) z</code>:</p>\n\n<pre><code>Couldn't match expected type \u2018a1 -&gt; a1\u2019 with actual type \u2018[a1]\u2019\nRelevant bindings include\n  z :: a1 (bound at BuildTreesQ3.lhs:61:24)\n  initlst :: [a1] (bound at BuildTreesQ3.lhs:58:9)\n  foo :: a -&gt; [a1] -&gt; [a1] (bound at BuildTreesQ3.lhs:58:3)\nThe function \u2018foo\u2019 is applied to three arguments,\nbut its type \u2018a -&gt; [a1] -&gt; [a1]\u2019 has only two\nIn the expression: (foo (n - 1) initlst) z\nIn the first argument of \u2018map\u2019, namely\n  \u2018(\\ z -&gt; (foo (n - 1) initlst) z)\u2019\n</code></pre>\n\n<p>Any insights into what I'm missing will be very much appreciated. Thanks in advance.</p>\n"}, {"tags": ["haskell", "esqueleto"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1510076222, "post_id": 47146909, "comment_id": 81277921, "body": "What have you tried and why didn&#39;t it work? Are you just looking for <a href=\"https://hackage.haskell.org/package/esqueleto-2.5.3/docs/Database-Esqueleto.html#v:sub_select\" rel=\"nofollow noreferrer\">this function</a>?"}, {"owner": {"reputation": 12964, "user_id": 704015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/rpCnn.png?s=128&g=1", "display_name": "Jezen Thomas", "link": "https://stackoverflow.com/users/704015/jezen-thomas"}, "edited": false, "score": 0, "creation_date": 1515662177, "post_id": 47146909, "comment_id": 83387678, "body": "I didn&#39;t immediately realise this, but in addition to <code>sub_select</code>, there&#39;s also <code>subList_select</code>."}, {"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1539101460, "post_id": 47146909, "comment_id": 92375721, "body": "@user2407038 That returns an <code>SqlExpr</code>, and is limited to a single row value at that. It wouldn&#39;t work."}, {"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "reply_to_user": {"reputation": 12964, "user_id": 704015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/rpCnn.png?s=128&g=1", "display_name": "Jezen Thomas", "link": "https://stackoverflow.com/users/704015/jezen-thomas"}, "edited": false, "score": 0, "creation_date": 1539101498, "post_id": 47146909, "comment_id": 92375742, "body": "@JezenThomas <code>subList_select</code> also returns an SqlExpr. Also wouldn&#39;t work."}], "answers": [{"comments": [{"owner": {"reputation": 12964, "user_id": 704015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/rpCnn.png?s=128&g=1", "display_name": "Jezen Thomas", "link": "https://stackoverflow.com/users/704015/jezen-thomas"}, "edited": false, "score": 0, "creation_date": 1539159004, "post_id": 52725322, "comment_id": 92395815, "body": "it&#39;s probably best to raise this <a href=\"https://github.com/bitemyapp/esqueleto/issues\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "reply_to_user": {"reputation": 12964, "user_id": 704015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/rpCnn.png?s=128&g=1", "display_name": "Jezen Thomas", "link": "https://stackoverflow.com/users/704015/jezen-thomas"}, "edited": false, "score": 0, "creation_date": 1539192367, "post_id": 52725322, "comment_id": 92416119, "body": "@JezenThomas I figured they&#39;d already be aware of such a big gap in functionality. On checking your link, I found <a href=\"https://github.com/bitemyapp/esqueleto/issues/32\" rel=\"nofollow noreferrer\">issue #32</a> and <a href=\"https://github.com/bitemyapp/esqueleto/issues/70\" rel=\"nofollow noreferrer\">issue #70</a>. That covers the needs raised here."}], "tags": [], "owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "is_accepted": false, "score": 1, "last_activity_date": 1539105627, "last_edit_date": 1539105627, "creation_date": 1539101826, "answer_id": 52725322, "question_id": 47146909, "link": "https://stackoverflow.com/questions/47146909/select-from-subquery-and-join-on-subquery-in-esqueleto/52725322#52725322", "title": "Select from subquery and join on subquery in Esqueleto", "body": "<p>I got here because I had the same question. I imagine the thing we want would be something like:</p>\n\n<pre><code>fromSelect\n  :: ( Database.Esqueleto.Internal.Language.From query expr backend a\n     , Database.Esqueleto.Internal.Language.From query expr backend b\n     )\n  =&gt; (a -&gt; query b)\n  -&gt; (b -&gt; query c)\n  -&gt; query c\n</code></pre>\n\n<p>Unfortunately, from looking at <a href=\"https://hackage.haskell.org/package/esqueleto-2.5.3/docs/src/Database-Esqueleto-Internal-Sql.html\" rel=\"nofollow noreferrer\">Database.Esqueleto.Internal.Sql</a>.FromClause:</p>\n\n<pre><code>-- | A part of a @FROM@ clause.\ndata FromClause =\n    FromStart Ident EntityDef\n  | FromJoin FromClause JoinKind FromClause (Maybe (SqlExpr (Value Bool)))\n  | OnClause (SqlExpr (Value Bool))\n</code></pre>\n\n<p>I don't think there's any support for this in Esqueleto. It only seems to support simple table names and joins with on-clauses that have a boolean expression. I imagine the hardest part of adding support for this is handling table and column name aliases (<code>as</code> sql clause), since <code>^.</code> expects an <code>expr (Entity val)</code> and an <code>EntityField val typ</code>. Simplest way is to change that to using <code>String</code> or <code>Text</code> for both operands, but that's not very type-safe. I'm not sure what the best option would be implementation-wise to make that type safe.</p>\n\n<p>EDIT: Probably best to forget <code>^.</code> and have <code>fromSelect</code> generate the aliases when providing the returned values of its first parameter as the arguments of its second parameter. Types would probably have to be altered to make room for these aliases. This is only contemplating <code>from</code> subqueries, not joins. That's another problem.</p>\n"}], "owner": {"reputation": 69847, "user_id": 3853934, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/GtQuz.jpg?s=128&g=1", "display_name": "Micha\u0142 Per\u0142akowski", "link": "https://stackoverflow.com/users/3853934/micha%c5%82-per%c5%82akowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1539105627, "creation_date": 1510007339, "question_id": 47146909, "link": "https://stackoverflow.com/questions/47146909/select-from-subquery-and-join-on-subquery-in-esqueleto", "title": "Select from subquery and join on subquery in Esqueleto", "body": "<p>How can I do <code>select ... from (select ...) join (select ...)</code> in Esqueleto?</p>\n\n<p>I'm aware that I can use <code>rawSql</code> from Persistent, but I'd like to avoid that.</p>\n\n<p>For the record, here is the full query:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>select q.uuid, q.upvotes, q.downvotes, count(a.parent_uuid), max(a.isAccepted) as hasAccepted\nfrom\n  (select post.uuid, post.title, sum(case when (vote.type = 2) then 1 else 0 end) as upvotes, sum(case when (vote.type = 3) then 1 else 0 end) as downvotes\n    from post left outer join vote on post.uuid = vote.post_id\n    where post.parent_uuid is null\n    group by post.uuid\n    order by post.created_on desc\n  ) q\nleft outer join\n  (select post.parent_uuid, max(case when (vote.type = 1) then 1 else 0 end) as isAccepted\n    from post left outer join vote on post.uuid = vote.post_id\n    where post.parent_uuid is not null\n    group by post.id\n  ) a\non a.parent_uuid = q.uuid\ngroup by q.uuid\nlimit 10\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1510006200, "post_id": 47146630, "comment_id": 81243632, "body": "If you replace all the C&#39;s with G&#39;s then replace all the G&#39;s with C, your DNA will now only have C&#39;s. You need to transcribe each character as you go."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1510006387, "post_id": 47146630, "comment_id": 81243714, "body": "I suggest making a function with type <code>Char -&gt; Char</code> which maps a given letter to its &quot;opposite&quot;. Then you can map this function over the entire dna strand. Essentially, you need to combine all of your lambdas into a single function."}, {"owner": {"reputation": 117, "user_id": 7212810, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pNFqk.jpg?s=128&g=1", "display_name": "Wireless", "link": "https://stackoverflow.com/users/7212810/wireless"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1510007258, "post_id": 47146630, "comment_id": 81244036, "body": "@Code-Apprentice I needed it to be [Char] and a map with a new function would&#39;ve made it give an error, I tried it before, maybe was doing something wrong but the guy down there already made it work :)"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1510007346, "post_id": 47146630, "comment_id": 81244079, "body": "The given answer is exaclty what I had in mind. Notice that <code>transc :: Char -&gt; Char</code> and is mapped once over the input list <code>[Char]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 7212810, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pNFqk.jpg?s=128&g=1", "display_name": "Wireless", "link": "https://stackoverflow.com/users/7212810/wireless"}, "edited": false, "score": 0, "creation_date": 1510007212, "post_id": 47146831, "comment_id": 81244023, "body": "Ah, thank you, that did it, I had tried doing something with map but was making a different function called transc but then it would let me map because of too few arguments...."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1510007412, "post_id": 47146831, "comment_id": 81244097, "body": "IMO, you do the community a disservice by completely solving a problem like this for the OP."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 2, "creation_date": 1510007817, "post_id": 47146831, "comment_id": 81244262, "body": "@Code-Apprentice I&#39;m very choosy about only giving answers like this to people who&#39;ve actually put in the effort and just need a small push. If you&#39;d like though, I&#39;d be happy to discuss the issue in chat."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1510008066, "post_id": 47146831, "comment_id": 81244366, "body": "@4castle You make a good point. The OP certainly has made an effort to solve the problem. I was trying to give him a slightly smaller push towards a similar solution."}], "tags": [], "owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "is_accepted": true, "score": 3, "last_activity_date": 1510007274, "last_edit_date": 1510007274, "creation_date": 1510006962, "answer_id": 47146831, "question_id": 47146630, "link": "https://stackoverflow.com/questions/47146630/combining-multiple-functions/47146831#47146831", "title": "Combining multiple functions", "body": "<p>You should make one function which handles all of the <code>Char -&gt; Char</code> conversions at once.</p>\n\n<pre><code>dnaToRna :: [Char] -&gt; [Char]\ndnaToRna = reverse . map transc\n  where\n    transc 'A' = 'U'\n    transc 'T' = 'A'\n    transc 'C' = 'G'\n    transc 'G' = 'C'\n    transc _   = error \"Invalid DNA molecule\"\n</code></pre>\n\n<p>To make this even safer, you could make it return a <code>Maybe [Char]</code> instead. The <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:lookup\" rel=\"nofollow noreferrer\"><code>lookup</code></a> function can also be used instead of using a custom mapping function.</p>\n\n<pre><code>dnaToRna :: [Char] -&gt; Maybe [Char]\ndnaToRna = mapM (`lookup` zip \"ATCG\" \"UAGC\") . reverse\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 117, "user_id": 7212810, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pNFqk.jpg?s=128&g=1", "display_name": "Wireless", "link": "https://stackoverflow.com/users/7212810/wireless"}, "edited": false, "score": 0, "creation_date": 1510086833, "post_id": 47154194, "comment_id": 81283722, "body": "Thanks for ur solution, will look into it :)"}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1510046730, "creation_date": 1510046730, "answer_id": 47154194, "question_id": 47146630, "link": "https://stackoverflow.com/questions/47146630/combining-multiple-functions/47154194#47154194", "title": "Combining multiple functions", "body": "<p>@4castle's answer shows the right direction.</p>\n\n<p>Since OP's problem has been solved i believe it would worth to show how to make it more efficient by using <a href=\"https://hackage.haskell.org/package/containers-0.5.10.2/docs/Data-Map-Lazy.html\" rel=\"nofollow noreferrer\"><code>Data.Map</code></a> for the look ups. Also by using a <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-List.html#v:foldl\" rel=\"nofollow noreferrer\"><code>foldl</code></a> we may skip the reversing job as well.</p>\n\n<pre><code>import qualified Data.Map.Lazy as M\n\ndna2rna :: String -&gt; String\ndna2rna = foldl (\\r c -&gt; (M.findWithDefault '-' c m) : r) \"\"\n          where m  = M.fromList $ zip \"ATCG\" \"UAGC\"\n\n*Main&gt; dna2rna \"AAATGTTAGTACACTAAGG\"\n\"CCUUAGUGUACUAACAUUU\"\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 7212810, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pNFqk.jpg?s=128&g=1", "display_name": "Wireless", "link": "https://stackoverflow.com/users/7212810/wireless"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 47146831, "answer_count": 2, "score": 3, "last_activity_date": 1510046730, "creation_date": 1510006003, "question_id": 47146630, "link": "https://stackoverflow.com/questions/47146630/combining-multiple-functions", "title": "Combining multiple functions", "body": "<p>I'm trying to make a DNA transcription program but I'm having trouble with the way I'm doing it, I'm sure there's an easier way to do this but this was the first thing that came to my head but it's not working the way I want it to.</p>\n\n<pre><code>dnaToRna :: [Char] -&gt; [Char]\ndnaToRna [] = []\ndnaToRna xs = reverse(transc xs)\n    where transc = (replaceA . replaceT . replaceC . replaceG)\nreplaceA = map(\\c -&gt; if c == 'A' then 'U' else c)\nreplaceT = map(\\c -&gt; if c == 'T' then 'A' else c)\nreplaceC = map(\\c -&gt; if c == 'C' then 'G' else c)\nreplaceG = map(\\c -&gt; if c == 'G' then 'C' else c)\n</code></pre>\n\n<p>Here's the output:</p>\n\n<pre><code>*Main&gt; let seq = \"AAATGTTAGTACACTAAGG\"\n*Main&gt; dnaToRna seq\n\"GGUUUGUGUUGUUUGUUUU\"\n</code></pre>\n\n<p>I figure this is because the transc replaces the A, then checks the whole String and replaces the T, etc etc\nAny tips?\nThanks in advance!</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 1290, "user_id": 5499871, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206799318615183/picture?type=large", "display_name": "Izaak Weiss", "link": "https://stackoverflow.com/users/5499871/izaak-weiss"}, "is_accepted": false, "score": 2, "last_activity_date": 1510001824, "creation_date": 1510001824, "answer_id": 47145646, "question_id": 47145564, "link": "https://stackoverflow.com/questions/47145564/haskell-positions-in-a-string/47145646#47145646", "title": "Haskell positions in a string", "body": "<p>You can get the fist 5 elements of a string <code>s</code> using <code>take 5 s</code>, and the last 5 using <code>take 5 $ reverse s</code>. </p>\n"}], "owner": {"reputation": 29, "user_id": 8077394, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e547ed41ce104877f55cfae87619f5af?s=128&d=identicon&r=PG&f=1", "display_name": "JohnTeiMir", "link": "https://stackoverflow.com/users/8077394/johnteimir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510001824, "creation_date": 1510001492, "question_id": 47145564, "link": "https://stackoverflow.com/questions/47145564/haskell-positions-in-a-string", "title": "Haskell positions in a string", "body": "<p>I am trying to make a program that receives a string and returns the percentage of Cs and Gs in the first 5 and in the last 5 positions, if the string has less than 20 chars, the function should return the percentage in the complete sequence.\nHowever, I've already been able to get you to give me only the percentage of Cs and Gs, but I do not know how to check in the first 5 positions and the finals.</p>\n\n<pre><code>function' :: [Char] -&gt; Double\nfunction' xs = fromIntegral final0 / fromIntegral final1\n                where final0 = length $ filter (\\x-&gt; x == 'C'|| x == 'G') xs\n                      final1 = length xs\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509998848, "post_id": 47144854, "comment_id": 81239872, "body": "<code>drop (&#39;A&#39; string)</code>?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1509998886, "post_id": 47144854, "comment_id": 81239899, "body": "There are a lot of reasons why this does not work. Can you explain (<i>duck debugging</i>) why you think the above fragment should do what you want it to do?"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1509999308, "post_id": 47144854, "comment_id": 81240093, "body": "Adenine, thymine, cytosine and guanine?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1509999336, "post_id": 47144854, "comment_id": 81240110, "body": "@MarkSeemann: my guess as well. But nevertheless, It is very weird why somebody expects this to work."}, {"owner": {"reputation": 25, "user_id": 5592324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e109800005f3982586a08c8d23155d7?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Concei&#231;&#227;o", "link": "https://stackoverflow.com/users/5592324/miguel-concei%c3%a7%c3%a3o"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509999674, "post_id": 47144854, "comment_id": 81240271, "body": "@WillemVanOnsem i did not expect it to work though, it was an attempt"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509999704, "post_id": 47144854, "comment_id": 81240287, "body": "@MiguelConceicao: so you make an attempt by writing an algorithm you do not expect to work? That&#39;s not much better than writing some random snippet. Perhaps it can help by first describing how you think your program is supposed to work, or by writing a recursive version."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1509999805, "post_id": 47144854, "comment_id": 81240363, "body": "@WillemVanOnsem Do you always expect your code to work the first time you try something new? That accusatory question isn&#39;t very friendly."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1509999934, "post_id": 47144854, "comment_id": 81240431, "body": "@amalloy: not at all. What I mean is that if you write some piece of code, one of course has some solving strategy in mind. The fact that some parts do not turn out to work very well is very likely and happens a lot. But one usually has some idea how to solve the problem in the first place."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1510000077, "post_id": 47144854, "comment_id": 81240503, "body": "I think your first question, &quot;how did you think this would work&quot; is a good one to develop the right thought processes, I just objected to the followup. The edited version is less confrontational: thanks for that."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1510011943, "post_id": 47144854, "comment_id": 81245737, "body": "I wonder if &quot;Is there a way to do this using a fold function?&quot; is really the question you meant to ask. Are you asking this because fold is how you first thought of to approach this, or because you genuinely want to use fold for some reason? If this is just because fold was your first guess about how to implement this, then there&#39;s a quite short non-fold-based answer: <code>test = filter (`notElem` &quot;ACGT&quot;)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1510000293, "creation_date": 1510000293, "answer_id": 47145267, "question_id": 47144854, "link": "https://stackoverflow.com/questions/47144854/using-foldl-foldr-to-drop-elements-from-a-string/47145267#47145267", "title": "Using foldl/foldr to drop elements from a String", "body": "<p>May be you can do as follows;</p>\n\n<pre><code>Prelude&gt; foldr (\\c a -&gt; if (elem c $ \"ATCG\") then a else c : a) \"\" ['A'..'Z']\n\"BDEFHIJKLMNOPQRSUVWXYZ\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1510016854, "last_edit_date": 1510016854, "creation_date": 1510000808, "answer_id": 47145387, "question_id": 47144854, "link": "https://stackoverflow.com/questions/47144854/using-foldl-foldr-to-drop-elements-from-a-string/47145387#47145387", "title": "Using foldl/foldr to drop elements from a String", "body": "<h1><code>foldr</code> as a <em>catamorphism</em></h1>\n\n<p>One of the aspects we can use here is that <code>foldr</code> is a <em>catamorphism</em> over a list <code>[]</code>. Indeed we can write:</p>\n\n<pre><code>foldr (:) []\n</code></pre>\n\n<p>and if we enter a list, we will obtain exactly the same list:</p>\n\n<pre><code>Prelude&gt; foldr (:) [] [1,4,2,5]\n[1,4,2,5]\n</code></pre>\n\n<p>Why? Conceptually <code>foldr</code> iterates over the list <em>right-to-left</em>. It uses an accumulator that first is <code>[]</code>, for every element in the list <code>x</code>, it calls the function with <code>x</code> and <code>a</code> (<code>a</code> being the accumulator) as arguments. The result obtained in the new accumulator that is the used to process the new element.</p>\n\n<p>So:</p>\n\n<pre><code>   foldr (:) [] [1,4,2,5]\n-&gt; foldr (:) ((:) 5 []) [1,4,2]\n</code></pre>\n\n<p>Now <code>(:)</code> is a constructor that takes a <em>head</em> (here <code>5</code>) and a tail (here <code>[]</code>), and constructs a list that starts with the head as first element, followed by the elements of the tail, so <code>(:) 5 []</code> is equal to <code>[5]</code>.</p>\n\n<pre><code>-&gt; foldr (:) [5] [1,4,2]\n-&gt; foldr (:) [2,5] [1,4]\n-&gt; foldr (:) [4,2,5] [1]\n-&gt; foldr (:) [1,4,2,5] []\n-&gt; [1,4,2,5]\n</code></pre>\n\n<p>So if we pass a list through <code>foldr (:) []</code> we obtain the same list.</p>\n\n<h1>Why is this useful?</h1>\n\n<p>What does this has to do with our problem? Well if we want to perform a filtering, we can use another function istead of <code>(:)</code>. We should only prepend if the character is not an <code>'A'</code>, <code>'C'</code>, <code>'G'</code>, or <code>'T'</code>. So some function that works with:</p>\n\n<pre><code>f x xs | &lt;some-condition&gt; = x : xs\n       | otherwise = xs\n</code></pre>\n\n<p>Now in order to check if a character <code>x</code> is not <code>'A'</code>, <code>'C'</code>, <code>'G'</code>, or <code>'T'</code>, we can write:</p>\n\n<pre><code>not (elem x \"ACGT\")\n</code></pre>\n\n<p>So the function is now:</p>\n\n<pre><code>f x xs | not (elem x \"ACGT\") = x : xs\n       | otherwise = x:xs\n</code></pre>\n\n<p>or shorter:</p>\n\n<pre><code>f x | not (elem x \"ACGT\") = (x:)\n    | otherwise = id\n</code></pre>\n\n<p>We can also swap the output and thus remove the <code>not</code>:</p>\n\n<pre><code>f x | elem x \"ACGT\" = id\n    | otherwise = (x:)\n</code></pre>\n\n<p>Thus now we can use that function <code>f</code> instead of <code>(:)</code> with a <code>where</code> clause:</p>\n\n<pre><code>filterAcgt :: [Char] -&gt; [Char]\nfilterAcgt = foldr f []\n    where f x | elem x \"ACGT\" = id\n              | otherwise = (x:)\n</code></pre>\n\n<p>and now we can generate a sequence of <code>'A'..'Z'</code> without <code>'A'</code>, <code>'C'</code>, <code>'G'</code> and <code>'T'</code>:</p>\n\n<pre><code>Prelude&gt; filterAcgt ['A'..'Z']\n\"BDEFHIJKLMNOPQRSUVWXYZ\"\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5592324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e109800005f3982586a08c8d23155d7?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Concei&#231;&#227;o", "link": "https://stackoverflow.com/users/5592324/miguel-concei%c3%a7%c3%a3o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1809, "favorite_count": 0, "accepted_answer_id": 47145387, "answer_count": 2, "score": 2, "last_activity_date": 1510016854, "creation_date": 1509998744, "last_edit_date": 1510003896, "question_id": 47144854, "link": "https://stackoverflow.com/questions/47144854/using-foldl-foldr-to-drop-elements-from-a-string", "title": "Using foldl/foldr to drop elements from a String", "body": "<p>If it's possible I'd want to use foldl or foldr to drop the chars 'A','T','C' and 'G' from a String ['A'..'Z']</p>\n\n<p>I tried this:</p>\n\n<pre><code>string = ['A'..'Z']\ntest string = foldl (\\string (x:xs) -&gt; \n                     if x == 'A' then drop ('A' string) \n                     else test xs) string\n</code></pre>\n\n<p>However it doesn't work because drop does not work with Char. Is there a way to do this using a fold function?</p>\n"}, {"tags": ["haskell", "http-conduit"], "answers": [{"tags": [], "owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "is_accepted": true, "score": 5, "last_activity_date": 1509996864, "creation_date": 1509996864, "answer_id": 47144420, "question_id": 47144419, "link": "https://stackoverflow.com/questions/47144419/when-i-run-a-lot-of-http-requests-in-parallel-i-get-no-such-protocol-name-tcp/47144420#47144420", "title": "When I run a lot of http requests in parallel, I get &quot;no such protocol name: tcp&quot;", "body": "<p>The requests are all run in parallel and make the process run out of file descriptors. Use</p>\n\n<pre><code>import ClassyPrelude\n\ntraverseThrottled :: (MonadMask m, MonadBaseControl IO m, Forall (Pure m), Traversable t) =&gt; Int -&gt; (a -&gt; m b) -&gt; t a -&gt; m (t b)\ntraverseThrottled concLevel action taskContainer = do\n    sem &lt;- newQSem concLevel\n    let throttledAction = bracket_ (waitQSem sem) (signalQSem sem) . action\n    mapConcurrently throttledAction taskContainer\n</code></pre>\n\n<p>(adjust imports if you don't use <code>ClassyPrelude</code>)</p>\n\n<p>Make sure your equivalent of <code>httpLBS</code> consumes the request if you use a streaming alternative. And that your <code>b</code> is strict in all fields.</p>\n"}], "owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 47144420, "answer_count": 1, "score": 2, "last_activity_date": 1509996864, "creation_date": 1509996864, "question_id": 47144419, "link": "https://stackoverflow.com/questions/47144419/when-i-run-a-lot-of-http-requests-in-parallel-i-get-no-such-protocol-name-tcp", "title": "When I run a lot of http requests in parallel, I get &quot;no such protocol name: tcp&quot;", "body": "<p>The code</p>\n\n<pre><code>mapConcurrently httpLBS requests\n</code></pre>\n\n<p>throws</p>\n\n<pre><code>ConnectionFailure Network.BSD.getProtocolByName: does not exist (no such protocol name: tcp))\n</code></pre>\n\n<p>after about 1k requests.</p>\n"}, {"tags": ["list", "haskell", "set"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509994047, "post_id": 47143640, "comment_id": 81237356, "body": "In short: transformations such that the overhead of intermediate datastructures is reduced (by rewriting the functions that these datastructures are no longer necessary for instance)."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1509994434, "post_id": 47143640, "comment_id": 81237566, "body": "It&#39;s basically the use of <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/src/GHC.Base.html#augment\" rel=\"nofollow noreferrer\">rewrite rules</a> that, as Willem said, removes intermediate datastructures/results. See <a href=\"https://downloads.haskell.org/~ghc/8.0-latest/docs/html/users_guide/glasgow_exts.html#list-fusion\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/8.0-latest/docs/html/users_guide/&zwnj;&#8203;&hellip;</a>."}, {"owner": {"reputation": 313, "user_id": 1850556, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/97f961d8dbf3bc77984150a62893a076?s=128&d=identicon&r=PG", "display_name": "fhyve", "link": "https://stackoverflow.com/users/1850556/fhyve"}, "edited": false, "score": 0, "creation_date": 1509994989, "post_id": 47143640, "comment_id": 81237826, "body": "So is this only relevant when using streams/infinite lists?"}, {"owner": {"reputation": 313, "user_id": 1850556, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/97f961d8dbf3bc77984150a62893a076?s=128&d=identicon&r=PG", "display_name": "fhyve", "link": "https://stackoverflow.com/users/1850556/fhyve"}, "edited": false, "score": 1, "creation_date": 1509995146, "post_id": 47143640, "comment_id": 81237910, "body": "I would also consider this a slightly non-duplicate question. To elaborate my question: when would I need to care about what list fusion does when using these set-to-list functions (as opposed to knowing the details about what list fusion is and how it does it)?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1510001039, "post_id": 47143640, "comment_id": 81241088, "body": "This refers to an internal implementation detail. You would not be using streams directly. The comment in the documentation just tells you that it can perform the fusion optimization, due to its implementation."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 2, "creation_date": 1510001383, "post_id": 47143640, "comment_id": 81241284, "body": "Also, what do you mean by &quot;worry about&quot;? The results won&#39;t change, so if you&#39;re not concerned about performance, you never really need to worry about it. Also, in this context, &quot;stream&quot; doesn&#39;t really refer to an infinite list."}, {"owner": {"reputation": 313, "user_id": 1850556, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/97f961d8dbf3bc77984150a62893a076?s=128&d=identicon&r=PG", "display_name": "fhyve", "link": "https://stackoverflow.com/users/1850556/fhyve"}, "edited": false, "score": 2, "creation_date": 1510038226, "post_id": 47143640, "comment_id": 81253124, "body": "&quot;The results won&#39;t change, so if you&#39;re not concerned about performance, you never really need to worry about it.&quot;  That answers my question in the negative."}], "owner": {"reputation": 313, "user_id": 1850556, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/97f961d8dbf3bc77984150a62893a076?s=128&d=identicon&r=PG", "display_name": "fhyve", "link": "https://stackoverflow.com/users/1850556/fhyve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 440, "favorite_count": 0, "closed_date": 1509994255, "answer_count": 0, "score": 5, "last_activity_date": 1509996743, "creation_date": 1509993846, "last_edit_date": 1509996743, "question_id": 47143640, "link": "https://stackoverflow.com/questions/47143640/what-is-list-fusion", "closed_reason": "Duplicate", "title": "What is list fusion?", "body": "<p>I'm looking up sets and converting sets to lists in Haskell, and I see this:</p>\n\n<blockquote>\n  <p>Convert the set to a list of elements. Subject to list fusion.</p>\n</blockquote>\n\n<p>(<a href=\"https://hackage.haskell.org/package/containers-0.5.10.2/docs/Data-Set.html\" rel=\"noreferrer\">https://hackage.haskell.org/package/containers-0.5.10.2/docs/Data-Set.html</a>)</p>\n\n<p>I see this in many of the functions handling conversion of sets and lists. When do I need to worry about what this does, and what do I need to think about in such cases? Do I only need to worry about it if I am dealing with streams, as the proposed duplicate question suggests?</p>\n"}, {"tags": ["email", "haskell", "sendmail"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1509992574, "post_id": 47142512, "comment_id": 81236605, "body": "It helps if you name the <i>package</i> you&#39;re using by name; you can&#39;t always identify what library you&#39;re using based on the module you imported. In this case it looks like you&#39;re using<code>mime-mail</code>?"}, {"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1509994289, "post_id": 47142512, "comment_id": 81237504, "body": "Yes, it is mime-mail"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509994562, "post_id": 47142512, "comment_id": 81237631, "body": "Looks like <code>renderSendMail</code> eventually calls <code>&#47;usr&#47;sbin&#47;sendmail -t</code> (or possibly uses the CPP variable <code>MIME_MAIL_SENDMAIL_PATH</code> if that&#39;s defined). Where does your <code>sendmail</code> live -- is it indeed <code>&#47;usr&#47;sbin&#47;sendmail</code>? Does it understand <code>-t</code> to mean the same thing as this package intends it to?"}, {"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 0, "creation_date": 1509994697, "post_id": 47142512, "comment_id": 81237703, "body": "which(sendmail) returns /usr/bin/sendmail"}], "answers": [{"comments": [{"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 0, "creation_date": 1510000552, "post_id": 47144596, "comment_id": 81240774, "body": "My global cabal is broken, I use stack"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 0, "creation_date": 1510004109, "post_id": 47144596, "comment_id": 81242706, "body": "@Ikciwor Then you should read the documentation for stack to learn how to pass CPP directives."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1509997584, "creation_date": 1509997584, "answer_id": 47144596, "question_id": 47142512, "link": "https://stackoverflow.com/questions/47142512/rendersendmail-not-sending-mails/47144596#47144596", "title": "renderSendMail not sending mails", "body": "<p>Since your <code>sendmail</code> is in a different location than what mime-mail is expecting, you will need to inform it of the correct location. The exact right incantation depends a little bit on how you are installing mime-mail; in the simplest case, where you are installing it with <code>cabal install</code>, try this:</p>\n\n<pre><code>cabal install --ghc-option -DMIME_MAIL_SENDMAIL_PATH='\"'`which sendmail`'\"' mime-mail\n</code></pre>\n\n<p>Other tools than cabal-install should have the ability to be informed of this CPP directive in a similar way.</p>\n"}], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1509997584, "creation_date": 1509989240, "last_edit_date": 1509994336, "question_id": 47142512, "link": "https://stackoverflow.com/questions/47142512/rendersendmail-not-sending-mails", "title": "renderSendMail not sending mails", "body": "<p>I try to send simple mail from Haskell's Network.Mail.Mime (package mime-mail) by</p>\n\n<pre><code>renderSendMail $ simpleMail' (Address Nothing \"myEMailHere\") \n    (Address (Just \"TESTER\") \"myEMailHere\") \"TEST\" \"TESTING\"\n</code></pre>\n\n<p>It executes without any warnings or exceptions, but the email is not sent. However</p>\n\n<pre><code>echo \"TEST\" | sendmail -v \"myEMailHere\"\n</code></pre>\n\n<p>works as expected. I have tried using renderMailCustom and giving arguments to sendmail as above, but despite I got same info as sendmail's output (\"Mail Delivery Status Report will be mailed to username.\"), I didn't receive any E-Mail.</p>\n\n<p>What am I doing wrong here?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509988425, "post_id": 47142209, "comment_id": 81234530, "body": "Haskell translates <code>func2</code> into <code>func1</code>."}], "answers": [{"comments": [{"owner": {"reputation": 126, "user_id": 1701505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9571176eb5229b426542e5c1218a239a?s=128&d=identicon&r=PG", "display_name": "David Boreham", "link": "https://stackoverflow.com/users/1701505/david-boreham"}, "edited": false, "score": 0, "creation_date": 1509989818, "post_id": 47142483, "comment_id": 81235298, "body": "Well, multi-parameter functions surely exist as a concept in the mind of whoever implemented said de-sugaring. Do you have a citation in the documentation where this de-sugaring is explained? I missed it in all the books and wiki pages I read, although clearly something like that had to be going on (hence my question). btw when I use the word &quot;translate&quot; that you say isn&#39;t happening, I actually mean the thing you say is happening, which you call &quot;desugaring&quot;."}, {"owner": {"reputation": 126, "user_id": 1701505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9571176eb5229b426542e5c1218a239a?s=128&d=identicon&r=PG", "display_name": "David Boreham", "link": "https://stackoverflow.com/users/1701505/david-boreham"}, "edited": false, "score": 0, "creation_date": 1509990248, "post_id": 47142483, "comment_id": 81235534, "body": "Realized it wasn&#39;t me who used the word &quot;translate&quot;, although I easily could have. Desugaring is just a form of syntactic translation, no?"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 126, "user_id": 1701505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9571176eb5229b426542e5c1218a239a?s=128&d=identicon&r=PG", "display_name": "David Boreham", "link": "https://stackoverflow.com/users/1701505/david-boreham"}, "edited": false, "score": 0, "creation_date": 1509991369, "post_id": 47142483, "comment_id": 81236081, "body": "You cited two different type signatures and two different body definitions in your question, and asked how Haskell &quot;knows&quot; them to be equivalent. I answered for both: the first part of my answer is about type signatures, the second part is about body definitions."}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 4, "last_activity_date": 1509991408, "last_edit_date": 1509991408, "creation_date": 1509989150, "answer_id": 47142483, "question_id": 47142209, "link": "https://stackoverflow.com/questions/47142209/does-haskell-understand-curried-function-definitions/47142483#47142483", "title": "Does Haskell &quot;understand&quot; curried function definitions?", "body": "<p>When talking about type signatures, there is no such thing as a \"multi-parameter function\". All functions are single-parameter, period. Haskell doesn't need to somehow \"translate\" multi-parameter functions into single-parameter ones, because the former doesn't exist at all.</p>\n\n<p>All function type signatures look like <code>a -&gt; b</code>, where <code>a</code> is argument type and <code>b</code> is return type. Sometimes <code>b</code> may just happen to contain more arrows <code>-&gt;</code>, in which case we, humans (but not the compiler), may say that the function has multiple parameters.</p>\n\n<p>When talking about the syntax for implementations, i.e. <code>f x y = z</code> - that is merely syntactic sugar, which gets desugared (i.e. mechanically transformed) into <code>f = \\x -&gt; \\y -&gt; z</code> during compilation.</p>\n"}, {"comments": [{"owner": {"reputation": 126, "user_id": 1701505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9571176eb5229b426542e5c1218a239a?s=128&d=identicon&r=PG", "display_name": "David Boreham", "link": "https://stackoverflow.com/users/1701505/david-boreham"}, "edited": false, "score": 0, "creation_date": 1510001822, "post_id": 47143141, "comment_id": 81241529, "body": "Thanks, that was helpful. fwiw I think I figured out why this doesn&#39;t appear clearly in the literature: functions are typically introduced before lambda expressions but you can&#39;t explain this syntax sugar without first understanding the latter. I eventually found it explained in &quot;Programming in Haskell&quot; section 4.5 &quot;Lambda expressions&quot;, pages after Curried Functions are discussed in section 3.6. The Tutorial page <a href=\"https://www.haskell.org/tutorial/functions.html\" rel=\"nofollow noreferrer\">haskell.org/tutorial/functions.html</a> is silent on the subject even though it introduces lambdas right there and talks about a function having two arguments.."}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 0, "creation_date": 1510024376, "post_id": 47143141, "comment_id": 81248617, "body": "The Haskell definition document is good at answering these kind of questions."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": false, "score": 6, "last_activity_date": 1594316815, "last_edit_date": 1594316815, "creation_date": 1509991756, "answer_id": 47143141, "question_id": 47142209, "link": "https://stackoverflow.com/questions/47142209/does-haskell-understand-curried-function-definitions/47143141#47143141", "title": "Does Haskell &quot;understand&quot; curried function definitions?", "body": "<p>In the <em>language</em> itself, writing a function definition of the form <code>f x y z = _</code> is equivalent to <code>f = \\x y z -&gt; _</code>, which is equivalent to <code>f = \\x -&gt; \\y -&gt; \\z -&gt; _</code>. There's no theoretical reason for this; it's just that those nested lambda abstractions are a terrible eye-/finger-sore and everyone thought that it would be fine to sacrifice a bit of pedantry to make some syntax sugar for it. That's all there is on the surface and is probably all you need to know, for now.</p>\n<p>In the <em>implementation</em> of the language, though, things get trickier. In GHC, which is the most common implementation, there actually is a difference between <code>f x y = _</code> and <code>f = \\x -&gt; \\y -&gt; _</code>. When GHC compiles Haskell, it assigns <em>arity</em> to declarations. The former definition of <code>f</code> has arity <code>2</code>, and the latter has arity <code>0</code>. Take <code>(.)</code> from <code>GHC.Base</code></p>\n<pre><code>(.) f g = \\x -&gt; f (g x)\n</code></pre>\n<p><code>(.)</code> has arity <code>2</code>, even though its type (<code>(b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c</code>) says that it can be applied up to thrice. This affects optimization: GHC will only inline a function that is <em>saturated</em>, or has at least as many arguments applied as its arity. In the call <code>(maximum .)</code>, <code>(.)</code> will not inline, because it only has one argument (it is <em>unsaturated</em>). In the call <code>(maximum . f)</code>, it <em>will</em> inline to <code>\\x -&gt; maximum (f x)</code>, and in <code>(maximum . f) 1</code>, the <code>(.)</code> will inline first to a lambda abstraction (producing <code>(\\x -&gt; maximum (f x)) 1</code>), which will beta-reduce to <code>maximum (f 1)</code>. If <code>(.)</code> were implemented</p>\n<pre><code>(.) f g x = f (g x)\n</code></pre>\n<p><code>(.)</code> would have arity <code>3</code>, which means it would inline less often (specifically the <code>f . g</code> case, which is a very common argument to higher order functions), likely reducing performance, which is exactly what the comment on it says:</p>\n<blockquote>\n<p>Make sure it has TWO args only on the left, so that it inlines\nwhen applied to two functions, even if there is no final argument</p>\n</blockquote>\n<p>Final answer: the two forms <em>should be</em> equivalent, according to the language's semantics, but in GHC the two forms have different characteristics when it comes to optimization, even if they always give the same result.</p>\n"}], "owner": {"reputation": 126, "user_id": 1701505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9571176eb5229b426542e5c1218a239a?s=128&d=identicon&r=PG", "display_name": "David Boreham", "link": "https://stackoverflow.com/users/1701505/david-boreham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1594316815, "creation_date": 1509988111, "question_id": 47142209, "link": "https://stackoverflow.com/questions/47142209/does-haskell-understand-curried-function-definitions", "title": "Does Haskell &quot;understand&quot; curried function definitions?", "body": "<p>In Haskell functions always take one parameter. Multiple parameters are implemented via <a href=\"https://www.haskell.org/tutorial/functions.html\" rel=\"nofollow noreferrer\">Currying</a>. That being the case, I can see how a function of two parameters would be defined as \"func1\" below. It's a function that returns a function (closure) that adds the outer function's single parameter to the returned function's single parameter. </p>\n\n<p>However, although this is how curried functions <em>work</em>, that's not the regular Haskell syntax for defining a two-parameter function. Instead we're taught to define such a function like \"func2\". </p>\n\n<p>I'd like to know how Haskell understands that func2 should behave the same way as func1. There's nothing about the definition of func2 that suggest to me that it is a function that returns a function. To the contrary it actually looks like a two-parameter function, something we're told doesn't exist! </p>\n\n<p>What's the trick here? Is Haskell just born knowing that we can define multi-parameter functions in this textbook way, and that they work the way we expect anyhow? That is, is this a syntax convention that doesn't seem to be clearly documented (Haskell knows what you mean and will supply the missing function return for you), or is there some other magic at work or something I'm missing?</p>\n\n<pre><code>func1 :: Int -&gt; (Int -&gt; Int)\nfunc1 x = (\\y -&gt; x + y)\n\nfunc2 :: Int -&gt; Int -&gt; Int\nfunc2 x y = x + y\n\nmain = do\n    print (func1 7 9)\n    print (func2 7 9)\n</code></pre>\n"}, {"tags": ["haskell", "recursion", "sum", "arguments"], "answers": [{"comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1509986494, "post_id": 47141647, "comment_id": 81233284, "body": "You don&#39;t need the guards; you can just write <code>sumFromTo x y = sum [x..y]</code>, since if <code>y &lt; x</code> then <code>[x..y] = []</code>."}, {"owner": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "edited": false, "score": 0, "creation_date": 1509986513, "post_id": 47141647, "comment_id": 81233295, "body": "This isn&#39;t a recursive definition. You probably need to do something like <code>otherwise = x + sumFromTo (x + 1) y</code> and add a definition for <code>x == y = x</code>."}, {"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "reply_to_user": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "edited": false, "score": 0, "creation_date": 1509986868, "post_id": 47141647, "comment_id": 81233492, "body": "@Phylogenesis True, I just thought it might be nice for him to know there&#39;s an easier way to do it."}, {"owner": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "edited": false, "score": 0, "creation_date": 1509986947, "post_id": 47141647, "comment_id": 81233546, "body": "Recursive definition is available <a href=\"https://www.ideone.com/t45jCc\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "reply_to_user": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "edited": false, "score": 0, "creation_date": 1509987525, "post_id": 47141647, "comment_id": 81233956, "body": "@Phylogenesis Do you want to post that as another answer, or shall I add it to mine?"}, {"owner": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "edited": false, "score": 0, "creation_date": 1509987708, "post_id": 47141647, "comment_id": 81234078, "body": "Add it to yours. No point polluting this question with multiple answers."}], "tags": [], "owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "is_accepted": false, "score": 2, "last_activity_date": 1509987790, "last_edit_date": 1509987790, "creation_date": 1509986146, "answer_id": 47141647, "question_id": 47141511, "link": "https://stackoverflow.com/questions/47141511/sumfromto-a-recursive-function/47141647#47141647", "title": "SumFromTo , A Recursive Function", "body": "<p>You can use a list comprehension to do this very simply:</p>\n\n<pre><code>sumFromTo :: Int -&gt; Int -&gt; Int\nsumFromTo x y = sum [x..y]\n</code></pre>\n\n<p>However, I'm not sure what you'd want to do if x == y.</p>\n\n<p>In the code you've given, your recursive definition isn't correct syntax. You've only given sumFromTo one argument, when it needs two, and you appear to have missed a + between the y and the function.</p>\n\n<pre><code>\u03bb&gt; sumFromTo 8 5\n0\n\u03bb&gt; sumFromTo 5 8\n26\n\u03bb&gt; sumFromTo 8 8\n8\n\u03bb&gt; \n</code></pre>\n\n<p>[a..b] means a list with a step of 1 between a and b, so [1..4] is [1,2,3,4]</p>\n\n<p>Thanks to Phylogenesis, here is a recursive definition:</p>\n\n<pre><code>sumFromTo :: Int -&gt; Int -&gt; Int\nsumFromTo x y\n    | x &gt; y = 0\n    | x == y = x\n    | otherwise = x + sumFromTo (x + 1) y\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 8863334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab38d2ef8fd5564b21653289447123bc?s=128&d=identicon&r=PG&f=1", "display_name": "Nasser", "link": "https://stackoverflow.com/users/8863334/nasser"}, "edited": false, "score": 0, "creation_date": 1510007600, "post_id": 47142193, "comment_id": 81244176, "body": "@commuSoft Thanks for letting me know that there is an easier way but the question basically told me to use recursion so that&#39;s why."}, {"owner": {"reputation": 19, "user_id": 8863334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab38d2ef8fd5564b21653289447123bc?s=128&d=identicon&r=PG&f=1", "display_name": "Nasser", "link": "https://stackoverflow.com/users/8863334/nasser"}, "edited": false, "score": 0, "creation_date": 1510007662, "post_id": 47142193, "comment_id": 81244189, "body": "@zpalmtree Thanks for the help!"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 19, "user_id": 8863334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab38d2ef8fd5564b21653289447123bc?s=128&d=identicon&r=PG&f=1", "display_name": "Nasser", "link": "https://stackoverflow.com/users/8863334/nasser"}, "edited": false, "score": 0, "creation_date": 1510044940, "post_id": 47142193, "comment_id": 81256692, "body": "@Nasser: but this <i>is</i> a recursive way to solve the problem."}, {"owner": {"reputation": 19, "user_id": 8863334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab38d2ef8fd5564b21653289447123bc?s=128&d=identicon&r=PG&f=1", "display_name": "Nasser", "link": "https://stackoverflow.com/users/8863334/nasser"}, "edited": false, "score": 0, "creation_date": 1510072717, "post_id": 47142193, "comment_id": 81275707, "body": "@commuSoft Oh sorry I read your answer the wrong way! thanks."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 1, "last_activity_date": 1509988056, "creation_date": 1509988056, "answer_id": 47142193, "question_id": 47141511, "link": "https://stackoverflow.com/questions/47141511/sumfromto-a-recursive-function/47142193#47142193", "title": "SumFromTo , A Recursive Function", "body": "<p>I think you make the problem too complex if you want to implement this with recursion. Basically there are two cases:</p>\n\n<ol>\n<li>one where the lower bound is greater than the upper bound, in which case the sum is zero; and</li>\n<li>one where the lower bound is less than or equal to the upper bound.</li>\n</ol>\n\n<p>The first case (1) can be expressed by writing:</p>\n\n<pre><code>sumFromTo x y | x &gt; y = 0\n</code></pre>\n\n<p>In the second case, the result is the lower bound plus the sum of the lowerbound plus one to the upper bound, so:</p>\n\n<pre><code>              | otherwise = x + sumFromTo (x+1) y\n</code></pre>\n\n<p>and putting these together:</p>\n\n<pre><code>sumFromTo :: (Num a, Ord a) =&gt; a -&gt; a -&gt; a\nsumFromTo x y | x &gt; y = 0\n              | otherwise = x + sumFromTo (x+1) y\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8863334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab38d2ef8fd5564b21653289447123bc?s=128&d=identicon&r=PG&f=1", "display_name": "Nasser", "link": "https://stackoverflow.com/users/8863334/nasser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1509988056, "creation_date": 1509985709, "last_edit_date": 1509985807, "question_id": 47141511, "link": "https://stackoverflow.com/questions/47141511/sumfromto-a-recursive-function", "title": "SumFromTo , A Recursive Function", "body": "<p>I am trying to do a recursive function that should give the sum of all integers between and including its two arguments. For example,\n<code>sumFromTo 5 8</code> is <code>5 + 6 + 7 + 8 = 26</code>. If the first argument is greater than the\nsecond, the function should return 0. </p>\n\n<p>This is what I got currently but I am a beginner and I don't think I did it right </p>\n\n<pre><code>sumFromTo :: Int -&gt; Int -&gt; Int\nsumFromTo x y \n| x == 1 = 1 \n| y == 1 = 1 \n| x &gt; 1 &amp;&amp; y &gt; 1 = x + y sumFromTo (x - 1)\n| otherwise = 0 \n</code></pre>\n\n<p>Any help please? </p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 5469, "user_id": 7083401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eA15o.png?s=128&g=1", "display_name": "ice1000", "link": "https://stackoverflow.com/users/7083401/ice1000"}, "is_accepted": false, "score": 2, "last_activity_date": 1509977945, "creation_date": 1509977945, "answer_id": 47139001, "question_id": 47138901, "link": "https://stackoverflow.com/questions/47138901/haskell-percentage-of-char-in-a-string/47139001#47139001", "title": "Haskell percentage of char in a string", "body": "<h2>Some errors in the question</h2>\n\n<p>You said</p>\n\n<blockquote>\n  <p>'C' and 'A'</p>\n</blockquote>\n\n<p>While your code says</p>\n\n<blockquote>\n  <p>\\x-> x == 'C'|| x == 'G'</p>\n</blockquote>\n\n<h2>What you're doing</h2>\n\n<p>You're measuring the number of <code>C</code>s and <code>G</code>s, and <code>*100</code>, and return the result.</p>\n\n<h2>How to solve</h2>\n\n<p>do not <code>*100</code>, do <code>/ length xs</code>.</p>\n\n<h2>Solution</h2>\n\n<pre><code>function' xs = fromIntegral final0 / fromIntegral final1\n                where final0 = length $ filter (\\x-&gt; x == 'C'|| x == 'G') xs\n                      final1 = length xs\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 8077394, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e547ed41ce104877f55cfae87619f5af?s=128&d=identicon&r=PG&f=1", "display_name": "JohnTeiMir", "link": "https://stackoverflow.com/users/8077394/johnteimir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1509977945, "creation_date": 1509977587, "question_id": 47138901, "link": "https://stackoverflow.com/questions/47138901/haskell-percentage-of-char-in-a-string", "title": "Haskell percentage of char in a string", "body": "<p>I am trying to make a program that receives a STRING and returns the percentage of 'C' and 'A' in it. However it is going to me wrong, this is my code:</p>\n\n<pre><code>function' :: [Char] -&gt; Double\nfunction' xs = 100* ( fromIntegral final0 )\n                    where final0 = length $ filter (\\x-&gt; x == 'C'|| x == 'G') xs\n</code></pre>\n\n<p>if I run: function '$ replicate 20' C ', return me 2000.0 and should give me 1.0</p>\n"}, {"tags": ["loops", "haskell", "recursion", "monads"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1509961612, "post_id": 47133634, "comment_id": 81217581, "body": "whileM is in Control.Monad.Loops."}, {"owner": {"reputation": 1818, "user_id": 1955231, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/100002848311925/picture?type=large", "display_name": "Agnishom Chattopadhyay", "link": "https://stackoverflow.com/users/1955231/agnishom-chattopadhyay"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1509961897, "post_id": 47133634, "comment_id": 81217752, "body": "@n.m. I know, but it does something else. It has a different signature as well: <code>Monad m =&gt; m Bool -&gt; m a -&gt; m [a]</code>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1509962917, "post_id": 47133634, "comment_id": 81218344, "body": "Your version seems to be close to unfoldWhileM, except you take a list of monadic actions, which yiu don&#39;t really need (you generate the list with repeat anyway)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 5, "creation_date": 1509967427, "post_id": 47133634, "comment_id": 81220828, "body": "Reading <code>Control.Monad.Loops</code> confirmed by opinion that there are too many forms of loops one can define. I was searching for something like <code>doWhile :: (a -&gt; IO Bool) -&gt; IO a -&gt; IO [a]</code>, which I think I used in the past, but didn&#39;t find something equivalent. Only <code>unfoldrM</code> and friends seem to be that general, but does not separate the guard with the body of the loop. I also wonder if using a loop library makes the code more difficult to read, since most programmers have not memorized the 100 loop variants (even if they will likely guess the intent)."}], "answers": [{"tags": [], "owner": {"reputation": 738, "user_id": 8075159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8709365a90d8a840b976b0f132f912e5?s=128&d=identicon&r=PG&f=1", "display_name": "Hogeyama", "link": "https://stackoverflow.com/users/8075159/hogeyama"}, "is_accepted": true, "score": 13, "last_activity_date": 1509961918, "creation_date": 1509961918, "answer_id": 47134056, "question_id": 47133634, "link": "https://stackoverflow.com/questions/47133634/the-haskell-way-to-do-io-loops-without-explicit-recursion/47134056#47134056", "title": "The Haskell way to do IO Loops (without explicit recursion)?", "body": "<p><a href=\"http://hackage.haskell.org/package/monad-loops-0.4.3/docs/Control-Monad-Loops.html#v:unfoldWhileM\" rel=\"noreferrer\">unfoldWhileM</a> is same as your <code>whileM</code> except that it takes an action (not a list) as second argument.</p>\n\n<pre><code>myReadList = unfoldWhileM (/= \"\") getLine\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 1, "last_activity_date": 1509976502, "creation_date": 1509976502, "answer_id": 47138570, "question_id": 47133634, "link": "https://stackoverflow.com/questions/47133634/the-haskell-way-to-do-io-loops-without-explicit-recursion/47138570#47138570", "title": "The Haskell way to do IO Loops (without explicit recursion)?", "body": "<p>Yes for abstracting out the explicit recursion as mentioned in the previous answer there is the <a href=\"http://hackage.haskell.org/package/monad-loops-0.4.3/docs/Control-Monad-Loops.html\" rel=\"nofollow noreferrer\"><code>Control.Monad.Loop</code></a> library which is useful. For those who are interested <a href=\"http://conscientiousprogrammer.com/blog/2015/12/11/24-days-of-hackage-2015-day-11-monad-loops-avoiding-writing-recursive-functions-by-refactoring/\" rel=\"nofollow noreferrer\">here is a nice tutorial on Monad Loops</a>.</p>\n\n<p>However there is another way. Previously, struggling with this job and knowing that Haskell is by default Lazy i first tried;</p>\n\n<pre><code>(sequence . repeat $ getLine) &gt;&gt;= return . takeWhile (/=\"q\")\n</code></pre>\n\n<p>I expected the above to collect entered lines into an <code>IO [String]</code> type. Nah... It runs indefinitely and IO acti\u015fons don't look lazy at all. At this point <a href=\"https://hackage.haskell.org/package/lazyio-0.1.0.4/docs/System-IO-Lazy.html\" rel=\"nofollow noreferrer\"><code>System IO Lazy</code></a> might come handy too. It's a 2 function only simple library.</p>\n\n<pre><code>run        :: T a -&gt; IO a\ninterleave :: IO a -&gt; T a\n</code></pre>\n\n<p>So <code>run</code> takes an Lazy IO action and turns it into an IO action and <code>interleave</code> does the opposite. Accordingly if we rephrase the above function as;</p>\n\n<pre><code>import qualified System.IO.Lazy as LIO\n\ngls = LIO.run (sequence . repeat $ LIO.interleave getLine) &gt;&gt;= return . takeWhile (/=\"q\")\n\nPrelude&gt; gls &gt;&gt;= return . sum . fmap (read :: String -&gt; Int)\n1\n2\n3\n4\nq\n10\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1509994692, "creation_date": 1509994692, "answer_id": 47143862, "question_id": 47133634, "link": "https://stackoverflow.com/questions/47133634/the-haskell-way-to-do-io-loops-without-explicit-recursion/47143862#47143862", "title": "The Haskell way to do IO Loops (without explicit recursion)?", "body": "<p>A solution using the effectful streams of the <a href=\"http://hackage.haskell.org/package/streaming-0.1.4.5/docs/Streaming-Prelude.html\" rel=\"nofollow noreferrer\">streaming</a> package:</p>\n\n<pre><code>import Streaming\nimport qualified Streaming.Prelude as S\n\nmain :: IO ()\nmain = do\n    result &lt;- S.toList_ . S.takeWhile (/=\"\") . S.repeatM $ getLine\n    print result\n</code></pre>\n\n<hr>\n\n<p>A solution that shows prompts, keeping them separated from the reading actions:</p>\n\n<pre><code>main :: IO ()\nmain = do\n    result &lt;- S.toList_\n            $ S.zipWith (\\_ s -&gt; s)\n                        (S.repeatM $ putStrLn \"Write something: \")\n                        (S.takeWhile (/=\"\") . S.repeatM $ getLine)\n    print result\n</code></pre>\n"}], "owner": {"reputation": 1818, "user_id": 1955231, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/100002848311925/picture?type=large", "display_name": "Agnishom Chattopadhyay", "link": "https://stackoverflow.com/users/1955231/agnishom-chattopadhyay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 47134056, "answer_count": 3, "score": 4, "last_activity_date": 1509994692, "creation_date": 1509960552, "question_id": 47133634, "link": "https://stackoverflow.com/questions/47133634/the-haskell-way-to-do-io-loops-without-explicit-recursion", "title": "The Haskell way to do IO Loops (without explicit recursion)?", "body": "<p>I want to read a list of strings seperated by newlines from STDIN, until a new line is witnessed and I want an action of the type <code>IO [String]</code>. Here is how I would do it with recursion:</p>\n\n<pre><code>myReadList :: IO String\nmyReadList = go []\nwhere \n    go :: [String] -&gt; IO [String]   \n    go l = do {\n                 inp &lt;- getLine;\n                 if (inp == \"\") then \n                     return l;\n                 else go (inp:l);\n                }\n</code></pre>\n\n<p>However, this method of using go obscures readability and is a pattern so common that one would ideally want to abstract this out.</p>\n\n<p>So, this was my attempt:</p>\n\n<pre><code>whileM :: (Monad m) =&gt; (a -&gt; Bool) -&gt; [m a] -&gt; m [a]\nwhileM p []     = return []\nwhileM p (x:xs) = do\n    s &lt;- x\n    if p s\n    then do\n        l &lt;- whileM p xs\n        return (s:l)\n    else\n        return []\n\nmyReadList :: IO [String]\nmyReadList = whileM (/= \"\") (repeat getLine)\n</code></pre>\n\n<p>I am guessing there is some default implementation of this <code>whileM</code> or something similar already. However I cannot find it.</p>\n\n<p>Could someone point out what is the most natural and elegant way to deal with this problem?</p>\n"}, {"tags": ["haskell", "random", "instance", "gloss"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1509960079, "post_id": 47133198, "comment_id": 81216531, "body": "<a href=\"http://hackage.haskell.org/package/QuickCheck-2.10.1/docs/Test-QuickCheck-Arbitrary.html#v:arbitrary\" rel=\"nofollow noreferrer\">related</a>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1509967614, "post_id": 47133198, "comment_id": 81220941, "body": "Did you try to write the instance? What issue did you find?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1509969529, "post_id": 47133198, "comment_id": 81222139, "body": "Have you had a look at <a href=\"https://hackage.haskell.org/package/random-1.1/docs/System-Random.html#g:4\" rel=\"nofollow noreferrer\">random:  System.Random</a>? Can you show your efforts in implementing the <code>Random</code> interface for your <code>Asteroid</code> data-type."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1509969811, "post_id": 47133198, "comment_id": 81222324, "body": "\u201cAt a random time\u201d can&#39;t very well be expressed as a <code>Random</code> instance. Are you writing your game in a Functional Reactive Programming style, or with a traditional \u201cimperative loop\u201d? In the former case, you could just generate an ordered list of equal-distributed entering-time values. Else you&#39;d rather have to pull a <i>time interval</i> out of an exponential distribution whenever an asteroid appears, and then wait for that time before you generate the next."}], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 1, "last_activity_date": 1510086185, "creation_date": 1510086185, "answer_id": 47166776, "question_id": 47133198, "link": "https://stackoverflow.com/questions/47133198/haskell-random-instance-of-own-datatype/47166776#47166776", "title": "haskell random instance of own datatype", "body": "<p>There's already a <code>Random</code> instance for <code>Float</code>. Assuming that you also have <code>Random</code> instances for <code>Vector</code> and <code>Point</code>, you can use them to define a <code>Random</code> instance for <code>Asteroid</code>:</p>\n\n<pre><code>instance Random Asteroid where\n  randomR (Asteroid pl vl sl, Asteroid ph vh sh) g =\n    let (p, g1) = randomR (pl, ph) g\n        (v, g2) = randomR (vl, vh) g1\n        (s, g3) = randomR (sl, sh) g2\n    in (Asteroid p v s, g3)\n  random g =\n    let (p, g1) = random g\n        (v, g2) = random g1\n        (s, g3) = random g2\n    in (Asteroid p v s, g3)\n</code></pre>\n\n<p>The <code>randomR</code> function takes a range of values, from minimum (low) to maximum (high). How you define a meaningful range of a complex value like <code>Asteroid</code>, I'll leave up to you; here, I'm simply assuming that you can pass a low and high <code>Asteroid</code> value.</p>\n\n<p>The first step uses the underlying <code>Random</code> instance for <code>Point</code> by calling <code>randomR</code>. <code>p</code> is a randomly generated <code>Point</code> value, and <code>g1</code> is the next random generator value to use.</p>\n\n<p>Likewise, <code>v</code> is a randomly generated <code>Vector</code> value, generated by the underlying instance for <code>Vector</code>.</p>\n\n<p>Finally, <code>s</code> is a <code>Float</code> generated by <code>randomR</code> for <code>Float</code>.</p>\n\n<p>The return value is a new <code>Asteroid</code> value composed from <code>p</code>, <code>v</code>, and <code>s</code>, plus the most recent generator <code>g3</code>.</p>\n\n<p>The implementation of <code>random</code> follows the same template.</p>\n\n<p>You could write this code in a prettier form, using e.g. using <code>MonadRandom</code>, but for starters, I left the code in its raw form to show how it works.</p>\n"}], "owner": {"reputation": 19, "user_id": 8893155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40522b80da488cd63dd745f511523645?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Wijnen", "link": "https://stackoverflow.com/users/8893155/steven-wijnen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510086185, "creation_date": 1509959101, "last_edit_date": 1509959316, "question_id": 47133198, "link": "https://stackoverflow.com/questions/47133198/haskell-random-instance-of-own-datatype", "title": "haskell random instance of own datatype", "body": "<p>I am working on an Asteroid game made in Haskell with Graphics.gloss. Now I have defined a datatype for the asteroids like this: </p>\n\n<pre><code>data Asteroid = Asteroid {   asteroidPos:: Point, \n                             asteroidVel   :: Vector,\n                             asteroidSize  :: Float }\n</code></pre>\n\n<p>So that it has a Position defined by a point, a velocity defined by a vector and it's size. Now I want to know how I could write an instance of Random for this datatype so that a new asteroid appears at a random time, on a random place with a random velocity. Does anyone know how I can accomplish this?</p>\n"}, {"tags": ["haskell", "f#", "functional-programming"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 5, "creation_date": 1509957544, "post_id": 47132554, "comment_id": 81215100, "body": "Have you tried doing tests to see which is faster?"}, {"owner": {"reputation": 1192, "user_id": 7023187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/321015561587503/picture?type=large", "display_name": "Rares Dima", "link": "https://stackoverflow.com/users/7023187/rares-dima"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1509957773, "post_id": 47132554, "comment_id": 81215223, "body": "@AJFarmar I thought about it but is there a way to measure execution time in haskell?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 3, "creation_date": 1509958155, "post_id": 47132554, "comment_id": 81215419, "body": "If there were no way to measure execution time in haskell, your question &quot;which of these is faster&quot; would be unanswerable."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 10, "creation_date": 1509958851, "post_id": 47132554, "comment_id": 81215825, "body": "In almost all cases, the execution time will be exactly the same, at least if you compile with optimization, because the optimized code will be exactly the same. If you don&#39;t compile with optimization, I&#39;m <i>guessing</i> the first may be faster, but why wouldn&#39;t you compile with optimization if you care about performance?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1509959855, "post_id": 47132554, "comment_id": 81216385, "body": "Consider running <a href=\"http://www.serpentine.com/criterion/\" rel=\"nofollow noreferrer\">criterion</a> and writing a small benchmark. Likely, with optimization on, you will not find any difference."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1509964173, "post_id": 47132554, "comment_id": 81219011, "body": "Even without optimisations, any performance difference would not be significant if the individual operations cost much more than any composition-related overhead. If you have maps, folds and <code>show</code> in the chain, that is likely the case."}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 9, "last_activity_date": 1509964691, "last_edit_date": 1509964691, "creation_date": 1509964470, "answer_id": 47134867, "question_id": 47132554, "link": "https://stackoverflow.com/questions/47132554/haskell-performance-composition-vs-application/47134867#47134867", "title": "Haskell performance: Composition vs Application?", "body": "<p>There shouldn't be any difference at all, as long as <code>(|&gt;)</code> and <code>(&gt;&gt;&gt;)</code> get inlined. Let's write an example that uses four different functions, two in F# style, and two in Haskell style:</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Char (isUpper)\n\n{-# INLINE (|&gt;) #-}\n(|&gt;) :: a -&gt; (a -&gt; b) -&gt; b\n(|&gt;) x f = f x\n\n{-# INLINE (&gt;&gt;&gt;) #-}\n(&gt;&gt;&gt;) :: (a -&gt; b) -&gt; (b -&gt; c) -&gt; a -&gt; c\n(&gt;&gt;&gt;) f g x = g (f x)\n\ncompositionF :: String -&gt; String\ncompositionF = filter isUpper &gt;&gt;&gt; length &gt;&gt;&gt; show \n\napplicationF :: String -&gt; String\napplicationF x = x |&gt; filter isUpper |&gt; length |&gt; show \n\ncompositionH :: String -&gt; String\ncompositionH = show . length . filter isUpper\n\napplicationH :: String -&gt; String\napplicationH x = show $ length $ filter isUpper $ x\n\nmain :: IO ()\nmain = do\n  getLine &gt;&gt;= putStrLn . compositionF  -- using the functions\n  getLine &gt;&gt;= putStrLn . applicationF  -- to make sure that\n  getLine &gt;&gt;= putStrLn . compositionH  -- we actually get the\n  getLine &gt;&gt;= putStrLn . applicationH  -- corresponding GHC core\n</code></pre>\n\n<p>If we compile our code with <code>-ddump-simpl -dsuppress-all -O0</code> we get:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>==================== Tidy Core ====================\nResult size of Tidy Core = {terms: 82, types: 104, coercions: 0}\n\n-- RHS size: {terms: 9, types: 11, coercions: 0}\n&gt;&gt;&gt;_rqe\n&gt;&gt;&gt;_rqe =\n  \\ @ a_a1cE @ b_a1cF @ c_a1cG f_aqr g_aqs x_aqt -&gt;\n    g_aqs (f_aqr x_aqt)\n\n-- RHS size: {terms: 2, types: 0, coercions: 0}\n$trModule1_r1gR\n$trModule1_r1gR = TrNameS \"main\"#\n\n-- RHS size: {terms: 2, types: 0, coercions: 0}\n$trModule2_r1h6\n$trModule2_r1h6 = TrNameS \"Main\"#\n\n-- RHS size: {terms: 3, types: 0, coercions: 0}\n$trModule\n$trModule = Module $trModule1_r1gR $trModule2_r1h6\n\n-- RHS size: {terms: 58, types: 73, coercions: 0}\nmain\nmain =\n  &gt;&gt;\n    $fMonadIO\n    (&gt;&gt;=\n       $fMonadIO\n       getLine\n       (. putStrLn\n          (&gt;&gt;&gt;_rqe\n             (&gt;&gt;&gt;_rqe (filter isUpper) (length $fFoldable[]))\n             (show $fShowInt))))\n    (&gt;&gt;\n       $fMonadIO\n       (&gt;&gt;=\n          $fMonadIO\n          getLine\n          (. putStrLn\n             (\\ x_a10M -&gt;\n                show $fShowInt (length $fFoldable[] (filter isUpper x_a10M)))))\n       (&gt;&gt;\n          $fMonadIO\n          (&gt;&gt;=\n             $fMonadIO\n             getLine\n             (. putStrLn\n                (. (show $fShowInt) (. (length $fFoldable[]) (filter isUpper)))))\n          (&gt;&gt;=\n             $fMonadIO\n             getLine\n             (. putStrLn\n                (\\ x_a10N -&gt;\n                   show $fShowInt (length $fFoldable[] (filter isUpper x_a10N)))))))\n\n-- RHS size: {terms: 2, types: 1, coercions: 0}\nmain\nmain = runMainIO main\n</code></pre>\n\n<p>So <code>&gt;&gt;&gt;</code> doesn't get inlined if we don't enable optimizations. If we enable optimizations however, you won't see <code>&gt;&gt;&gt;</code> or <code>(.)</code> at all. Our functions slightly differ, since <code>(.)</code> doesn't get inlined at that stage, but that's somewhat expected.</p>\n\n<p>If we add <code>{-# NOINLINE \u2026 #-}</code> to our functions and enable optimiziations we see that the four functions won't differ at all:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>$ ghc -ddump-simpl -dsuppress-all -O2 Example.hs\n[1 of 1] Compiling Main             ( Example.hs, Example.o )\n\n==================== Tidy Core ====================\nResult size of Tidy Core = {terms: 261, types: 255, coercions: 29}\n\n-- RHS size: {terms: 2, types: 0, coercions: 0}\n$trModule2\n$trModule2 = TrNameS \"main\"#\n\n-- RHS size: {terms: 2, types: 0, coercions: 0}\n$trModule1\n$trModule1 = TrNameS \"Main\"#\n\n-- RHS size: {terms: 3, types: 0, coercions: 0}\n$trModule\n$trModule = Module $trModule2 $trModule1\n\nRec {\n-- RHS size: {terms: 29, types: 20, coercions: 0}\n$sgo_r574\n$sgo_r574 =\n  \\ sc_s55y sc1_s55x -&gt;\n    case sc1_s55x of _ {\n      [] -&gt; I# sc_s55y;\n      : y_a2j9 ys_a2ja -&gt;\n        case y_a2j9 of _ { C# c#_a2hF -&gt;\n        case {__pkg_ccall base-4.9.1.0 u_iswupper Int#\n                                     -&gt; State# RealWorld -&gt; (# State# RealWorld, Int# #)}_a2hE\n               (ord# c#_a2hF) realWorld#\n        of _ { (# ds_a2hJ, ds1_a2hK #) -&gt;\n        case ds1_a2hK of _ {\n          __DEFAULT -&gt; $sgo_r574 (+# sc_s55y 1#) ys_a2ja;\n          0# -&gt; $sgo_r574 sc_s55y ys_a2ja\n        }\n        }\n        }\n    }\nend Rec }\n\n-- RHS size: {terms: 15, types: 14, coercions: 0}\napplicationH\napplicationH =\n  \\ x_a12X -&gt;\n    case $sgo_r574 0# x_a12X of _ { I# ww3_a2iO -&gt;\n    case $wshowSignedInt 0# ww3_a2iO []\n    of _ { (# ww5_a2iS, ww6_a2iT #) -&gt;\n    : ww5_a2iS ww6_a2iT\n    }\n    }\n\nRec {\n-- RHS size: {terms: 29, types: 20, coercions: 0}\n$sgo1_r575\n$sgo1_r575 =\n  \\ sc_s55r sc1_s55q -&gt;\n    case sc1_s55q of _ {\n      [] -&gt; I# sc_s55r;\n      : y_a2j9 ys_a2ja -&gt;\n        case y_a2j9 of _ { C# c#_a2hF -&gt;\n        case {__pkg_ccall base-4.9.1.0 u_iswupper Int#\n                                     -&gt; State# RealWorld -&gt; (# State# RealWorld, Int# #)}_a2hE\n               (ord# c#_a2hF) realWorld#\n        of _ { (# ds_a2hJ, ds1_a2hK #) -&gt;\n        case ds1_a2hK of _ {\n          __DEFAULT -&gt; $sgo1_r575 (+# sc_s55r 1#) ys_a2ja;\n          0# -&gt; $sgo1_r575 sc_s55r ys_a2ja\n        }\n        }\n        }\n    }\nend Rec }\n\n-- RHS size: {terms: 15, types: 15, coercions: 0}\ncompositionH\ncompositionH =\n  \\ x_a1jF -&gt;\n    case $sgo1_r575 0# x_a1jF of _ { I# ww3_a2iO -&gt;\n    case $wshowSignedInt 0# ww3_a2iO []\n    of _ { (# ww5_a2iS, ww6_a2iT #) -&gt;\n    : ww5_a2iS ww6_a2iT\n    }\n    }\n\nRec {\n-- RHS size: {terms: 29, types: 20, coercions: 0}\n$sgo2_r576\n$sgo2_r576 =\n  \\ sc_s55k sc1_s55j -&gt;\n    case sc1_s55j of _ {\n      [] -&gt; I# sc_s55k;\n      : y_a2j9 ys_a2ja -&gt;\n        case y_a2j9 of _ { C# c#_a2hF -&gt;\n        case {__pkg_ccall base-4.9.1.0 u_iswupper Int#\n                                     -&gt; State# RealWorld -&gt; (# State# RealWorld, Int# #)}_a2hE\n               (ord# c#_a2hF) realWorld#\n        of _ { (# ds_a2hJ, ds1_a2hK #) -&gt;\n        case ds1_a2hK of _ {\n          __DEFAULT -&gt; $sgo2_r576 (+# sc_s55k 1#) ys_a2ja;\n          0# -&gt; $sgo2_r576 sc_s55k ys_a2ja\n        }\n        }\n        }\n    }\nend Rec }\n\n-- RHS size: {terms: 15, types: 15, coercions: 0}\ncompositionF\ncompositionF =\n  \\ x_a1jF -&gt;\n    case $sgo2_r576 0# x_a1jF of _ { I# ww3_a2iO -&gt;\n    case $wshowSignedInt 0# ww3_a2iO []\n    of _ { (# ww5_a2iS, ww6_a2iT #) -&gt;\n    : ww5_a2iS ww6_a2iT\n    }\n    }\n\nRec {\n-- RHS size: {terms: 29, types: 20, coercions: 0}\n$sgo3_r577\n$sgo3_r577 =\n  \\ sc_s55d sc1_s55c -&gt;\n    case sc1_s55c of _ {\n      [] -&gt; I# sc_s55d;\n      : y_a2j9 ys_a2ja -&gt;\n        case y_a2j9 of _ { C# c#_a2hF -&gt;\n        case {__pkg_ccall base-4.9.1.0 u_iswupper Int#\n                                     -&gt; State# RealWorld -&gt; (# State# RealWorld, Int# #)}_a2hE\n               (ord# c#_a2hF) realWorld#\n        of _ { (# ds_a2hJ, ds1_a2hK #) -&gt;\n        case ds1_a2hK of _ {\n          __DEFAULT -&gt; $sgo3_r577 (+# sc_s55d 1#) ys_a2ja;\n          0# -&gt; $sgo3_r577 sc_s55d ys_a2ja\n        }\n        }\n        }\n    }\nend Rec }\n\n-- RHS size: {terms: 15, types: 14, coercions: 0}\napplicationF\napplicationF =\n  \\ x_a12W -&gt;\n    case $sgo3_r577 0# x_a12W of _ { I# ww3_a2iO -&gt;\n    case $wshowSignedInt 0# ww3_a2iO []\n    of _ { (# ww5_a2iS, ww6_a2iT #) -&gt;\n    : ww5_a2iS ww6_a2iT\n    }\n    }\n...\n</code></pre>\n\n<p>All <code>go</code> functions are exactly the same (sans variable names), and <code>application*</code> is the same as <code>composition*</code>. So go ahead and create your own F# prelude in Haskell, there shouldn't be any performance issue.</p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1509969226, "post_id": 47135186, "comment_id": 81221966, "body": "Are all those ugly <code>null</code> checks from the inlined <code>Array.map</code> function, or are they only generated by the pipeline?"}, {"owner": {"reputation": 13006, "user_id": 679898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7819f58e928d59c76fe12b30607346d6?s=128&d=identicon&r=PG", "display_name": "scrwtp", "link": "https://stackoverflow.com/users/679898/scrwtp"}, "edited": false, "score": 2, "creation_date": 1509974936, "post_id": 47135186, "comment_id": 81225316, "body": "<code>If critical performance is important to you I recommend getting a good decompiler tool to make sure that the generated code doesn&#39;t contain unexpected overhead</code>- and then put a clear comment on why the code is the way it is so someone doesn&#39;t overeagerly refactor it."}, {"owner": {"reputation": 11019, "user_id": 418488, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/625af9d6f5c5062f65a43582b57c041d?s=128&d=identicon&r=PG", "display_name": "Just another metaprogrammer", "link": "https://stackoverflow.com/users/418488/just-another-metaprogrammer"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1509990799, "post_id": 47135186, "comment_id": 81235812, "body": "@leftaroundabout they seems to be from the inlined functions from <code>module Array</code> that use <code>checkNonNull &quot;array&quot; array</code> in many functions. A smarter compiled could figure out that many of these checks are unnecessary and remove them. If we are lucky the jitter eliminates them for us."}], "tags": [], "owner": {"reputation": 11019, "user_id": 418488, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/625af9d6f5c5062f65a43582b57c041d?s=128&d=identicon&r=PG", "display_name": "Just another metaprogrammer", "link": "https://stackoverflow.com/users/418488/just-another-metaprogrammer"}, "is_accepted": false, "score": 5, "last_activity_date": 1509965410, "creation_date": 1509965410, "answer_id": 47135186, "question_id": 47132554, "link": "https://stackoverflow.com/questions/47132554/haskell-performance-composition-vs-application/47135186#47135186", "title": "Haskell performance: Composition vs Application?", "body": "<p>My answer is about F#.</p>\n\n<p>In most cases the F# compiler is able to optimize pipelines into the same code:</p>\n\n<pre><code>let f x = x |&gt; (+) 1 |&gt; (*) 2 |&gt; (+) 2\nlet g x = x |&gt; ((+) 1 &gt;&gt; (*) 2 &gt;&gt; (+) 2)\n</code></pre>\n\n<p>Decompiling <code>f</code> and <code>g</code> we see that the compiler reaches the same result:</p>\n\n<pre><code>public static int f(int x)\n{\n    return 2 + 2 * (1 + x);\n}\npublic static int g(int x)\n{\n    return 2 + 2 * (1 + x);\n}\n</code></pre>\n\n<p>But it doesn't always seem to hold as we can see with slightly more advanced pipelines:</p>\n\n<pre><code>let f x = x |&gt;  Array.map add1 |&gt; Array.map mul2 |&gt; Array.map add2 |&gt; Array.reduce (+)\nlet g x = x |&gt; (Array.map add1 &gt;&gt; Array.map mul2 &gt;&gt; Array.map add2 &gt;&gt; Array.reduce (+))\n</code></pre>\n\n<p>Decompiling shows some differences:</p>\n\n<pre><code>public static int f(int[] x)\n{\n  FSharpFunc&lt;int, FSharpFunc&lt;int, int&gt;&gt; arg_25_0 = new Program.f@9();\n  if (x == null)\n  {\n    throw new ArgumentNullException(\"array\");\n  }\n  int[] array = new int[x.Length];\n  FSharpFunc&lt;int, FSharpFunc&lt;int, int&gt;&gt; fSharpFunc = arg_25_0;\n  for (int i = 0; i &lt; array.Length; i++)\n  {\n    array[i] = x[i] + 1;\n  }\n  FSharpFunc&lt;int, FSharpFunc&lt;int, int&gt;&gt; arg_6C_0 = fSharpFunc;\n  int[] array2 = array;\n  if (array2 == null)\n  {\n    throw new ArgumentNullException(\"array\");\n  }\n  array = new int[array2.Length];\n  fSharpFunc = arg_6C_0;\n  for (int i = 0; i &lt; array.Length; i++)\n  {\n    array[i] = array2[i] * 2;\n  }\n  FSharpFunc&lt;int, FSharpFunc&lt;int, int&gt;&gt; arg_B3_0 = fSharpFunc;\n  int[] array3 = array;\n  if (array3 != null)\n  {\n    array2 = new int[array3.Length];\n    fSharpFunc = arg_B3_0;\n    for (int i = 0; i &lt; array2.Length; i++)\n    {\n      array2[i] = array3[i] + 2;\n    }\n    return ArrayModule.Reduce&lt;int&gt;(fSharpFunc, array2);\n  }\n  throw new ArgumentNullException(\"array\");\n}\n\npublic static int g(int[] x)\n{\n  FSharpFunc&lt;int[], int[]&gt; f = new Program.g@10-1();\n  FSharpFunc&lt;int[], int[]&gt; fSharpFunc = new Program.g@10-3(f);\n  FSharpFunc&lt;int, FSharpFunc&lt;int, int&gt;&gt; reduction = new Program.g@10-4();\n  int[] array = fSharpFunc.Invoke(x);\n  return ArrayModule.Reduce&lt;int&gt;(reduction, array);\n}\n</code></pre>\n\n<p>For <code>f</code> F# inlines the pipeline except for the final reduce. </p>\n\n<p>For <code>g</code> the pipeline is constructed and then invoked. This means that <code>g</code> is likely somewhat slower and somewhat more memory intensive than <code>f</code>. </p>\n\n<p>In this particular example it's likely not important as we are creating array objects and iterating over them but if the functions composed are very cheap in terms of CPU and memory the cost of establishing and invoking the pipeline could prove relevant.</p>\n\n<p>If critical performance is important to you I recommend getting a good decompiler tool to make sure that the generated code doesn't contain unexpected overhead. Otherwise you are probably fine with either approach.</p>\n"}], "owner": {"reputation": 1192, "user_id": 7023187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/321015561587503/picture?type=large", "display_name": "Rares Dima", "link": "https://stackoverflow.com/users/7023187/rares-dima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "answer_count": 2, "score": 7, "last_activity_date": 1509994355, "creation_date": 1509956679, "last_edit_date": 1509994355, "question_id": 47132554, "link": "https://stackoverflow.com/questions/47132554/haskell-performance-composition-vs-application", "title": "Haskell performance: Composition vs Application?", "body": "<p>I saw some question about similarities and differences between function composition and application and the various ways to do it, but one thing that has started to puzzle me a little(and that has not been asked as far as I searched) is about the difference in performance.</p>\n\n<p>When I learned F# I fell in love with the pipe operator <code>|&gt;</code>, which has it's equivalent in haskell's reverse application <code>&amp;</code>. But the F# variant is unarguably more beautiful in my opinion(and I don't think I'm the only one).</p>\n\n<p>Now, one can easily hack the pipe operator into haskell:</p>\n\n<pre><code>(|&gt;) x f = f x\n</code></pre>\n\n<p>And it works like a charm! Problem solved! </p>\n\n<p>The big difference between the pipe(both in F# and our haskell trick) is that it does not compose functions, it is based on function application. It takes the value on the left and passes it into the function on the right, as opposed to the composition, which takes 2 functions and returns another function, which can then be used as any regular function.</p>\n\n<p>This, at least for me, makes the code much prettier since you only use one operator to direct the flow of information trough the whole function from arguments to final values, since with basic composition(or >>>) you cannot put a value on the left side to have it passed trough the \"chain\".</p>\n\n<p>But from a performance standpoint, looking at these general options, the result should be the exact same:</p>\n\n<pre><code>f x = x |&gt; func1 |&gt; func2 |&gt; someLambda |&gt; someMap |&gt; someFold |&gt; show\n\nf x = x &amp; (func1 &gt;&gt;&gt; func2 &gt;&gt;&gt; someLambda &gt;&gt;&gt; someMap &gt;&gt;&gt; someFold &gt;&gt;&gt; show)\n\nf x = (func1 &gt;&gt;&gt; func2 &gt;&gt;&gt; someLambda &gt;&gt;&gt; someMap &gt;&gt;&gt; someFold &gt;&gt;&gt; show) x\n</code></pre>\n\n<p>Which one would be the fastest, the one based on repeated application or the one(s) base on composition and a single application?</p>\n"}, {"tags": ["haskell", "lambda", "functional-programming", "factorial"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1509926152, "post_id": 47127773, "comment_id": 81205958, "body": "&quot;<i>Variable not in scope: incr</i>&quot; is because you did not yet implement <code>incr</code>, but it&#39;s really simple: increment one of those numbers! Not the integer <code>+1</code> increment, but for that church encoding."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1509927797, "post_id": 47127773, "comment_id": 81206196, "body": "Please include enough code to reproduce the problem <i>in the question itself</i> (N.B. not at an off-site resource)."}, {"owner": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1509928574, "post_id": 47127773, "comment_id": 81206330, "body": "@Bergi That&#39;s where I am stuck; even though I also believe that <code>incr</code> should be very simple to implement, but I can&#39;t quite perceive the meaning of incrementing a &quot;church encoding&quot; (I assume that by &quot;church encoding&quot; you mean the positive integers that I have in the code snippet)."}, {"owner": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509928674, "post_id": 47127773, "comment_id": 81206351, "body": "@DanielWagner I copied the code inside the question, as requested. Thank you"}, {"owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "edited": false, "score": 0, "creation_date": 1509929418, "post_id": 47127773, "comment_id": 81206496, "body": "@AriaPahlavan, I should mention that your program relies upon Haskell&#39;s built-in recursion mechanism (when <code>fact</code> calls <code>fact</code>) \u2013 the answer I provided uses lambdas to achieve recursion"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1509934551, "post_id": 47127773, "comment_id": 81207599, "body": "@AriaPahlavan How could a function <code>incr</code> look, so that <code>incr one</code> or <code>incr (\\f x -&gt; f x)</code> becomes <code>\\f x -&gt; f (f x)</code>?"}, {"owner": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1509939270, "post_id": 47127773, "comment_id": 81208712, "body": "@Bergi <code>incr = (\\n f x -&gt; f (n f x))</code> is how I think it should be implemented, and <code>decr n</code> works fine, But <code>fact n</code> doesn&#39;t compile."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1509939627, "post_id": 47127773, "comment_id": 81208790, "body": "@AriaPahlavan Yes, that looks good (although I&#39;d have written <code>incr n = \\f x -&gt; f (n f x)</code>)."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1509939933, "post_id": 47127773, "comment_id": 81208850, "body": "Whoa, this looks like an interesting case. Not sure if its a bug in the compiler\u2026"}, {"owner": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1509940576, "post_id": 47127773, "comment_id": 81208998, "body": "@Bergi Oh yeah I originally wrote it like <code>incr n = \\f x -&gt; f (n f x))</code> but then changed it because for some reason I thought that would fix the issue where the compilation would never finish (but obviously I was wrong). Anyways so you also believe that this should work and the reason it doesn&#39;t finish compiling could be a bug in the compiler. I guess I could register a GHC bug report."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1509940849, "post_id": 47127773, "comment_id": 81209041, "body": "@AriaPahlavan At first you might want to check whether it&#39;s a GHC issue, or just something that repl.it does. It&#39;s a useful tool for fiddling around, but compiler bug reports should be done with a local instance of the compiler that you have complete control over (using latest version and trying out some command-line flags)."}, {"owner": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1509942255, "post_id": 47127773, "comment_id": 81209322, "body": "@Bergi I compiled it using the latest version of GHC (installed on my system), and I got compilation failure. I updated the question with some portion of the error message. (the error message was very long)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1509961100, "post_id": 47127773, "comment_id": 81217250, "body": "@Bergi, it&#39;s definitely not a bug in the compiler. The problem is that <code>fact</code> has a rank-2 type, so it requires a type signature: <code>fact :: (forall a. (a -&gt; a) -&gt; a -&gt; a) -&gt; (t -&gt; t) -&gt; t -&gt; t</code>. Separately, the definition of <code>decr</code> is quite wrong; it has a surprising type and calculates incorrect results."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509961927, "post_id": 47127773, "comment_id": 81217772, "body": "@dfeuer Yeah, that&#39;s what I figured as well after trying it (and assigning some types with the help of LiberalTypeSynonyms and RankNTypes). It&#39;s only the &quot;hanging instead of reporting an error&quot; behaviour encountered in repl.it that I would consider a bug."}], "answers": [{"comments": [{"owner": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "edited": false, "score": 0, "creation_date": 1509928766, "post_id": 47128140, "comment_id": 81206377, "body": "your <code>pred</code> is taking <code>n</code>, <code>f</code>, and <code>x</code> as arguments if I am not mistaking, which is different from the implementation I was aiming at (i.e. <code>decr n = ...</code>)."}, {"owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "reply_to_user": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "edited": false, "score": 0, "creation_date": 1509929004, "post_id": 47128140, "comment_id": 81206415, "body": "@AriaPahlavan, ah, that is one way to think of it; here&#39;s another \u2013 <i>&quot;Pred takes a Church numeral <code>n</code> and returns a new Church numeral&quot;</i>"}, {"owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "reply_to_user": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "edited": false, "score": 0, "creation_date": 1509929695, "post_id": 47128140, "comment_id": 81206553, "body": "It&#39;s no different than (eg) your <code>mul m n f x = m (n f) x</code> \u2013 <code>mul</code> doesn&#39;t take <i>four</i> arguments <i>m</i>, <i>n</i>, <i>f</i>, and <i>x</i>; that wouldn&#39;t make any sense \u2013 Multiplication takes <i>two</i> arguments (Church numerals <i>m</i> and <i>n</i> in this case) and it returns a Church numeral (<code>\\f x -&gt; m (n f) x</code>)"}, {"owner": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "edited": false, "score": 0, "creation_date": 1509930427, "post_id": 47128140, "comment_id": 81206709, "body": "The JavaScript version you provided is I believe the correct way of implementing this as is defined here: <a href=\"https://en.wikipedia.org/wiki/Church_encoding\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Church_encoding</a>. But does that mean the <code>decr n</code> is implemented incorrectly?"}, {"owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "reply_to_user": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "edited": false, "score": 2, "creation_date": 1509931019, "post_id": 47128140, "comment_id": 81206817, "body": "Church&#39;s encoding of <a href=\"https://en.wikipedia.org/wiki/Church_encoding#Derivation_of_predecessor_function\" rel=\"nofollow noreferrer\"><i>pred</i></a> in Haskell would be <code>pred n = \\f x -&gt; n (\\g h -&gt; g (g f)) (\\u -&gt; x) (\\u -&gt; u)</code> \u2013 not sure why Hughes deviates from this encoding"}, {"owner": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "edited": false, "score": 0, "creation_date": 1509932095, "post_id": 47128140, "comment_id": 81207028, "body": "I think the increment lambda should be <code>inc = (\\g h -&gt; h (g f))</code>."}, {"owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "reply_to_user": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "edited": false, "score": 0, "creation_date": 1509932800, "post_id": 47128140, "comment_id": 81207159, "body": "But that&#39;s is an invalid \u03b7-reduction; <code>\\g h -&gt; h (g f)</code> is not equivalent to (Church&#39;s) <code>\\g h x -&gt; h (g h x)</code>; the <code>x</code> is on the <i>inside</i> of the <code>()</code> \u2013 if you&#39;re trying to be clever tho, you can use Haskell&#39;s <code>(.)</code>: <code>\\g h -&gt; h . (g f)</code>; but of course that&#39;s cheating"}], "tags": [], "owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "is_accepted": true, "score": 3, "last_activity_date": 1509929863, "last_edit_date": 1509929863, "creation_date": 1509928409, "answer_id": 47128140, "question_id": 47127773, "link": "https://stackoverflow.com/questions/47127773/functional-programming-%c3%a0-la-1940s-minimalistic-implementation-of-factorial/47128140#47128140", "title": "Functional Programming &#224; la 1940s: Minimalistic Implementation of Factorial", "body": "<p>It looks like you're really close</p>\n\n<p>I can show you how to do this using <a href=\"https://en.wikipedia.org/wiki/Church_encoding\" rel=\"nofollow noreferrer\">Church's encodings</a> in JavaScript, but not in Haskell, because I don't know how to make some simple combinators type-check in Haskell (<code>U</code> below)</p>\n\n<p>Because JavaScript is strictly evaluated, predicate branches must be wrapped in a lambda</p>\n\n<p>Go ahead and run the snippet \u2013 we calculate <code>8!</code></p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>const True = a =&gt; b =&gt;\r\n  a ()\r\n  \r\nconst False = a =&gt; b =&gt;\r\n  b ()\r\n  \r\nconst IsZero = n =&gt;\r\n  n (x =&gt; False) (True)\r\n\r\nconst Succ = n =&gt;\r\n  f =&gt; x =&gt; f (n (f) (x))\r\n  \r\nconst Pred = n =&gt;\r\n  f =&gt; x =&gt; n (g =&gt; h =&gt; h (g (f))) (u =&gt; x) (u =&gt; u)\r\n\r\nconst Mult = m =&gt; n =&gt;\r\n  f =&gt; m (n (f))\r\n  \r\nconst Add = m =&gt; n =&gt;\r\n  m (Succ) (n)\r\n\r\nconst one = f =&gt; x =&gt;\r\n  f (x)\r\n  \r\nconst two =\r\n  Add (one) (one)\r\n  \r\nconst four =\r\n  Add (two) (two)\r\n  \r\nconst eight =\r\n  Add (four) (four)\r\n\r\nconst U = f =&gt; f (f)\r\n\r\nconst Fact = U (f =&gt; acc =&gt; n =&gt;\r\n  IsZero (n)\r\n    (z =&gt; acc) // thunks used for predicate branches\r\n    (z =&gt; U (f) (Mult (acc) (n)) (Pred (n)))) (one)\r\n    \r\nconst result = \r\n  Fact (eight)\r\n  \r\n// convert church numeral result to a JavaScript number\r\nconsole.log ('8! =', result (x =&gt; x + 1) (0))\r\n// 8! = 40320</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>If you cheat a little, you can achieve faux laziness by using JavaScript's <code>?:</code> ternary operator \u2013 I'm only showing this so you can see <code>Fact</code> in a more readable form; the above implementation uses <em>only</em> lambdas</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>const IsZero = n =&gt;\r\n  // cheat by returning JavaScript's true/false booleans\r\n  n (x =&gt; false) (true)\r\n\r\nconst Succ = n =&gt;\r\n  f =&gt; x =&gt; f (n (f) (x))\r\n  \r\nconst Pred = n =&gt;\r\n  f =&gt; x =&gt; n (g =&gt; h =&gt; h (g (f))) (u =&gt; x) (u =&gt; u)\r\n\r\nconst Mult = m =&gt; n =&gt;\r\n  f =&gt; m (n (f))\r\n  \r\nconst Add = m =&gt; n =&gt;\r\n  m (Succ) (n)\r\n\r\nconst one = f =&gt; x =&gt;\r\n  f (x)\r\n  \r\nconst two =\r\n  Add (one) (one)\r\n  \r\nconst four =\r\n  Add (two) (two)\r\n  \r\nconst eight =\r\n  Add (four) (four)\r\n\r\nconst U = f =&gt; f (f)\r\n\r\nconst Fact = U (f =&gt; acc =&gt; n =&gt;\r\n  IsZero (n)\r\n    ? acc // now we're sorta cheating using JavaScript's ternary here\r\n    : U (f) (Mult (acc) (n)) (Pred (n))) (one)\r\n\r\nconst result = \r\n  Fact (eight)\r\n  \r\nconsole.log ('8! =', result (x =&gt; x + 1) (0))\r\n// 8! = 40320</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 1, "last_activity_date": 1509980161, "creation_date": 1509980161, "answer_id": 47139717, "question_id": 47127773, "link": "https://stackoverflow.com/questions/47127773/functional-programming-%c3%a0-la-1940s-minimalistic-implementation-of-factorial/47139717#47139717", "title": "Functional Programming &#224; la 1940s: Minimalistic Implementation of Factorial", "body": "<p>First, let's try to explicitly type everything. Na\u00efvely, all this stuff is parameterised on some type that the Church functions deal with:</p>\n\n<pre><code>type Logical a = a -&gt; a -&gt; a\ntype Nat a = (a-&gt;a) -&gt; a-&gt;a\n\n-- boolean\ntrue, false :: Logical a\ntrue x y = x\nfalse x y = y\n\nifte :: Logical a -&gt; a -&gt; a -&gt; a\nifte = id\n\nincr :: Nat a -&gt; Nat a\nincr n f = f . n f\n\n-- integer \u201cliterals\u201d\nzero, one, two, three :: Nat a\nthree = incr two\ntwo   = incr one\none   = incr zero\nzero _ = id\n\n-- addition and multiplication\nadd, mul :: Nat a -&gt; Nat a -&gt; Nat a\nadd m n f = m f . n f\nmul m n f = m $ n f\n\n-- zero check\nisZero :: Nat a -&gt; Logical a\nisZero n = n (const false) true\n</code></pre>\n\n<p>...ok, here we run into the first problem:</p>\n\n<pre><code>\u2022 Couldn't match expected type \u2018Logical a\u2019 with actual type \u2018a\u2019\n  \u2018a\u2019 is a rigid type variable bound by\n    the type signature for:\n      isZero :: forall a. Nat a -&gt; Logical a\n    at /tmp/wtmpf-file7834.hs:25:1-28\n\u2022 In the expression: n (const false) true\n</code></pre>\n\n<p>The issue is that we try to use the <code>Nat</code>-church-numbers as a function not on the underlying <code>a</code> type that the result <code>Logical</code> is supposed to work with, but on those logicals themselves. I.e. it's actually</p>\n\n<pre><code>isZero :: Nat (Logical a) -&gt; Logical a\n</code></pre>\n\n<p>It gets worse for <code>decr</code> \u2013 this doesn't work:</p>\n\n<pre><code>decr :: Nat a -&gt; Nat a\ndecr n = n (\\m f x -&gt; f (m incr x))\n           zero\n           id\n           zero\n</code></pre>\n\n<p>because you're trying to use the number for both a logical purpose as in <code>isZero</code>, which requires injecting another <code>Nat</code> layer, but also for just passing on/incrementing. In traditional Hindley-Milner, you'd need to decide on one of these, so it's not possible to make it typecheck.</p>\n\n<p>In modern Haskell, you <em>can</em> make it typecheck, by <em>making the argument polymorphic</em>:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes, UnicodeSyntax #-}\ndecr :: (\u2200 \u03b1 . Nat \u03b1) -&gt; Nat a\n</code></pre>\n\n<p>To avoid carrying around the quantifier, we might make another synonym:</p>\n\n<pre><code>type ANat = \u2200 \u03b1 . Nat \u03b1\n</code></pre>\n\n<p>then it's just</p>\n\n<pre><code>decr :: ANat -&gt; Nat a\n</code></pre>\n\n<p>And that technique works for the factorial as well:</p>\n\n<pre><code>fact :: ANat -&gt; Nat a\nfact n = ifte (isZero n)\n      one\n      (mul n $ fact (decr n))\n</code></pre>\n"}], "owner": {"reputation": 1047, "user_id": 6042837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/A52kS.jpg?s=128&g=1", "display_name": "Aria Pahlavan", "link": "https://stackoverflow.com/users/6042837/aria-pahlavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 2, "accepted_answer_id": 47128140, "answer_count": 2, "score": 1, "last_activity_date": 1509993566, "creation_date": 1509924757, "last_edit_date": 1509993566, "question_id": 47127773, "link": "https://stackoverflow.com/questions/47127773/functional-programming-%c3%a0-la-1940s-minimalistic-implementation-of-factorial", "title": "Functional Programming &#224; la 1940s: Minimalistic Implementation of Factorial", "body": "<p>I have watched the amazing talk by John Hughes titled <a href=\"https://youtu.be/XrNdvWqxBvA\" rel=\"nofollow noreferrer\">Why Functional Programming Matters</a> a couple of times and only recently decided to actually try implementing the \"minimalist\" version of booleans, integers, and of course factorial, as shown in the <a href=\"https://youtu.be/XrNdvWqxBvA?t=1m28s\" rel=\"nofollow noreferrer\">video</a>. </p>\n\n<p>I implemented <code>true</code>, <code>false</code>, <code>ifte</code>, <code>zero</code>, <code>one</code>, <code>two</code>, <code>iszero</code>, <code>decr</code> and finally <code>fact</code> <a href=\"https://repl.it/Nm3P/7\" rel=\"nofollow noreferrer\">here</a> as follow:</p>\n\n<pre><code>-- boolean\ntrue x y = x\nfalse x y = y\nifte bool t e = bool t e\n\n-- positive integers\nthree f x = f $ f $ f x\ntwo f x = f $ f x\none f x = f x\nzero f x = x \n\n-- add and multiplication\nadd m n f x = m f $ n f x\nmul m n f x = m (n f) x \n\n-- is zero check\niszero n =  n (\\_ -&gt; false) true\n\n-- decrement\ndecr n = \n  n (\\m f x -&gt; f (m f zero))\n    zero\n    (\\x-&gt;x)\n    zero\n\n\n-- factorial\nfact n =\n  ifte (iszero n)\n    one\n    (mul n (fact (decr n)))\n</code></pre>\n\n<h2>Problem</h2>\n\n<p>I tested every function, and they all compile and work perfectly, except for <code>decr</code> and <code>fact</code>. </p>\n\n<p>Even though John Hughes promises at <a href=\"https://youtu.be/XrNdvWqxBvA?t=6m37s\" rel=\"nofollow noreferrer\">6:37</a> that his implementation of <code>decr</code> works, it fails to compile with the following error:</p>\n\n<blockquote>\n  <p>error: Variable not in scope: incr</p>\n</blockquote>\n\n<p>I am not certain how <code>incr</code> should be implemented in <code>(\\m f x -&gt; f (m incr zero))</code>. </p>\n\n<p>Now if I define them as <code>incr = (+1)</code> and change the definition of <code>decr</code> to the following, then <code>decr</code> compiles and works fine, but <code>fact</code> still causes compilation failure. </p>\n\n<pre><code>decr n = \n  n (\\m f x -&gt; f (m incr x))\n    zero\n    (\\x-&gt;x)\n    zero'\n</code></pre>\n\n<p>Is there a bug in the lambda <code>(\\m f x -&gt; f (m incr zero))</code> used in the definition of <code>decr</code>, or should <code>incr</code> be defined differently? </p>\n\n<h2>Update</h2>\n\n<p>When I define <code>incr</code> as <code>incr n = (\\f x -&gt; f (n f x))</code>, <code>decr n</code> works fine, but <code>fact n</code> fails to compile. Here's the readable portion of the error message:</p>\n\n<blockquote>\n  <p>factorial.hs:30:1: error:\n      \u2022 Occurs check: cannot construct the infinite type:</p>\n  \n  <p>...</p>\n  \n  <p>| fact n =<br>\n     | ^^^^^^^^...</p>\n  \n  <p>...</p>\n  \n  <p>factorial.hs:33:6: error:\n      \u2022 Occurs check: cannot construct the infinite type:</p>\n  \n  <p>...</p>\n\n<pre><code>\u2022 In the third argument of \u2018ifte\u2019, namely \u2018(mul n (fact (decr n)))\u2019\n  In the expression: ifte (iszero n) one (mul n (fact (decr n)))\n  In an equation for \u2018fact\u2019:\n      fact n = ifte (iszero n) one (mul n (fact (decr n)))\n</code></pre>\n  \n  <p>...</p>\n  \n  <p>|     (mul n (fact (decr n)))<br>\n     |      ^^^^^^^^^^^^^^^^^^^^^</p>\n</blockquote>\n\n<p>Note: the complete error message is several pages long.</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 4625, "user_id": 1861521, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dda04c7abdfe8b05f4a258b7a01900a6?s=128&d=identicon&r=PG", "display_name": "jcarpenter2", "link": "https://stackoverflow.com/users/1861521/jcarpenter2"}, "edited": false, "score": 1, "creation_date": 1509941469, "post_id": 47127758, "comment_id": 81209152, "body": "Some languages like Idris support totality checking - and it would surely be possible to write a totality checking extension for GHC, although I don&#39;t know of one.  However, due to the undecidability of the halting problem, there is no totality checker that will accept all programs that halt while rejecting all programs that do not halt."}], "answers": [{"comments": [{"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1509990339, "post_id": 47128054, "comment_id": 81235582, "body": "Agreed. Actually I was hoping that in case of <code>GHC</code> there would be some runtime hints about behavior of a program that is unproductively consuming CPU. In particular I saw no memory consuption profile before it ran out of it. Did my thread miss some &quot;safe-points&quot; for example?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1509990965, "post_id": 47128054, "comment_id": 81235885, "body": "@sevo I&#39;m not sure I understood that question. Are you saying you ran with profiling, but did not see any profiling output? If so, that seems like a completely different question, and I encourage you to open a fresh SO post with a minimal reproducing example."}, {"owner": {"reputation": 1597, "user_id": 2161072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ba143872804741abb61bf862ac4bd75?s=128&d=identicon&r=PG", "display_name": "Desty", "link": "https://stackoverflow.com/users/2161072/desty"}, "edited": false, "score": 0, "creation_date": 1528663983, "post_id": 47128054, "comment_id": 88582198, "body": "&quot;However, as far as I know nobody has done the engineering work needed to turn that theory into a tool that one can easily run on Haskell source.&quot; -- perhaps not at the compile stage, but GHC&#39;s runtime system has been doing simple &quot;blackhole&quot; infinite loop detection for quite a while. See <a href=\"http://mainisusuallyafunction.blogspot.com/2011/10/thunks-and-lazy-blackholes-introduction.html\" rel=\"nofollow noreferrer\">mainisusuallyafunction.blogspot.com/2011/10/&hellip;</a> for some info."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1597, "user_id": 2161072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ba143872804741abb61bf862ac4bd75?s=128&d=identicon&r=PG", "display_name": "Desty", "link": "https://stackoverflow.com/users/2161072/desty"}, "edited": false, "score": 0, "creation_date": 1528672198, "post_id": 47128054, "comment_id": 88583938, "body": "@Desty Which is, unfortunately, <i>so</i> simple that it won&#39;t even catch the example given in the question, where a function literally calls itself with the exact same arguments."}, {"owner": {"reputation": 1597, "user_id": 2161072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ba143872804741abb61bf862ac4bd75?s=128&d=identicon&r=PG", "display_name": "Desty", "link": "https://stackoverflow.com/users/2161072/desty"}, "edited": false, "score": 0, "creation_date": 1528845819, "post_id": 47128054, "comment_id": 88658927, "body": "@DanielWagner indeed; perhaps something about the function or how it&#39;s wrapped in a &quot;catch&quot; means it isn&#39;t noticed by the detector. Just pointing out that work has been done to make it possible in <i>some</i> cases."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 4, "last_activity_date": 1509927487, "creation_date": 1509927487, "answer_id": 47128054, "question_id": 47127758, "link": "https://stackoverflow.com/questions/47127758/detect-infinite-loops-in-a-ghc-program/47128054#47128054", "title": "Detect infinite loops in a GHC program", "body": "<p>Short answer: no.</p>\n\n<p>It certainly isn't possible to notice <em>every</em> infinite loop one could write down; this is famously known as <a href=\"https://en.wikipedia.org/wiki/Halting_problem\" rel=\"nofollow noreferrer\">the halting problem</a> and the formal proof that one cannot write a loop-detecting program is so famous that there's even <a href=\"http://www.lel.ed.ac.uk/~gpullum/loopsnoop.html\" rel=\"nofollow noreferrer\">a Dr. Seuss version of it</a>.</p>\n\n<p>Of course, there's also an <a href=\"https://en.wikipedia.org/wiki/Static_program_analysis\" rel=\"nofollow noreferrer\">entire branch of computer science</a> devoted to taking best-effort approaches to undecidable problems, and in theory we know a lot about ways to detect simple versions of such infinite loops. However, as far as I know nobody has done the engineering work needed to turn that theory into a tool that one can easily run on Haskell source.</p>\n"}, {"tags": [], "owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "is_accepted": false, "score": 0, "last_activity_date": 1510084707, "creation_date": 1510084707, "answer_id": 47166436, "question_id": 47127758, "link": "https://stackoverflow.com/questions/47127758/detect-infinite-loops-in-a-ghc-program/47166436#47166436", "title": "Detect infinite loops in a GHC program", "body": "<p>I presume this is a follow up to <a href=\"https://stackoverflow.com/questions/47127085\">What is the format of GHC hp profile?</a>.</p>\n\n<p>In general there is no way to automatically detect every infinite loop. In practice and not specific to GHC, I think it is commonly reasonable to detect them manually by looking at the CPU and memory usage. This particular case should exhaust memory because it is not tail recursive (at least, I think that's the reason). Something like <code>action x y z = action x y z</code> won't allocate and so would spin indefinitely, maxing the CPU with no increase in memory usage. It would be up to you to have an expectation of execution time and memory usage and investigate any deviations.</p>\n\n<p>I haven't tried this, but if you suspect an infinite loop perhaps you could use the <code>xc</code> RTS option and interrupt the execution to get a stack trace.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1510084707, "creation_date": 1509924638, "last_edit_date": 1509924952, "question_id": 47127758, "link": "https://stackoverflow.com/questions/47127758/detect-infinite-loops-in-a-ghc-program", "title": "Detect infinite loops in a GHC program", "body": "<p>In this example, <code>action</code> is an infinite loop created by mistake. Is there a way to detect such loops in a GHC program?</p>\n\n<pre><code>   action bucket manager url = catch\n      (action bucket manager url)\n      (\\(e :: HttpException) -&gt; Logger.warn $ \"Problems with \" ++ url)\n</code></pre>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 1, "creation_date": 1509982633, "post_id": 47127085, "comment_id": 81230700, "body": "What profiling options are you using and how quickly does the program exhaust memory - is it a slow, steady increase, or a sudden spike? I think I had hit that when the memory is pinned it might not register, and if the sample frequency is too low it may not &quot;catch&quot; the usage. I would try <code>-h</code> options to see if that shows anything different, and maybe <code>-i</code> to adjust the frequency."}, {"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "reply_to_user": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1509991353, "post_id": 47127085, "comment_id": 81236073, "body": "Actually, this was an infinite loop. I&#39;m curious as to why I did not see some obvious hint in the profile data. During investigation I found no information about profile output an hence this question."}, {"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 2, "creation_date": 1509991835, "post_id": 47127085, "comment_id": 81236287, "body": "You mean a hint of an infinite loop in the memory profiling data? If it was <i>allocating</i> I would expect some indication of the usage continuously growing, and that would go back to my first comment."}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1509919110, "creation_date": 1509919110, "question_id": 47127085, "link": "https://stackoverflow.com/questions/47127085/what-is-the-format-of-ghc-hp-profile", "title": "What is the format of GHC hp profile?", "body": "<p>I have a program that exhausts memory. If I were to trust <code>hp2pretty</code>, this program barely uses 1% of the heap at peak. So, I'd like to verify the contents of \"suspect\" <code>.hp</code> lines like:</p>\n\n<pre><code>(39987)listDirectoryCerts.getDirContents/listDirector...    179632\n</code></pre>\n\n<p>How else can I determine what is consuming all my heap?</p>\n"}, {"tags": ["haskell", "typeclass", "implicit"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1509923011, "post_id": 47126343, "comment_id": 81205311, "body": "<a href=\"http://hackage.haskell.org/package/reflection-2.1.2/docs/Data-Reflection.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/reflection-2.1.2/docs/&hellip;</a>"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1509954570, "post_id": 47126343, "comment_id": 81213576, "body": "<a href=\"http://hackage.haskell.org/package/reflection-2.1.2/docs/src/Data-Reflection.html#reify\" rel=\"nofollow noreferrer\">The implementation</a> is ... is it beautiful?  Is it awful?"}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1509961468, "post_id": 47126343, "comment_id": 81217491, "body": "@melpomene oh thank you !"}], "owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1509921069, "creation_date": 1509913996, "last_edit_date": 1509921069, "question_id": 47126343, "link": "https://stackoverflow.com/questions/47126343/new-ghc8-and-implicit-parameters", "title": "New GHC8 and implicit parameters", "body": "<p>In his <a href=\"http://okmij.org/ftp/Haskell/tr-15-04.pdf\" rel=\"nofollow noreferrer\">implicit configuration paper</a>, Oleg reflect values at the type level.</p>\n\n<p>With the new tools of GHC8, what can be improved to his presentation ?\nFor instance we can remove the use of undefined with type application, but what else ?</p>\n\n<p>Here is the original after the intro</p>\n\n<pre><code>{-# LANGUAGE PolyKinds #-}\n{-# LANGUAGE DeriveFunctor #-}\n{-# LANGUAGE StandaloneDeriving #-}\n#!/usr/bin/env stack\n-- stack --resolver lts-9.2 script --package http-conduit --package tagged --package lens\n{-# LANGUAGE GADTs #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE AllowAmbiguousTypes #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE RankNTypes #-}\n{-# LANGUAGE TypeApplications #-}\n{-# LANGUAGE NoImplicitPrelude #-}\n{-# LANGUAGE ExplicitForAll      #-}\n{-# OPTIONS_GHC -fno-warn-unused-imports -fno-warn-unused-local-binds  -fno-warn-missing-signatures #-}\n\nimport Prelude\nimport Control.Lens.Operators ((&lt;&amp;&gt;))\nimport Data.Function\nimport Data.Kind\n</code></pre>\n\n<p>code </p>\n\n<pre><code>-- Original\n--------------\ndata Zero; data Twice (s :: Type); data Succ (s :: Type); data Pred (s :: Type) -- pure type\n\nclass ReflectNum1 s where reflectNum1 :: Num a =&gt; s -&gt; a\n\ninstance ReflectNum1 Zero      where reflectNum1 _ = 0 -- on ne se sert pas de s\ninstance ReflectNum1 s =&gt; ReflectNum1 (Twice s) where reflectNum1 _ = (reflectNum1 (undefined :: s) * 2)\ninstance ReflectNum1 s =&gt; ReflectNum1 (Succ s ) where reflectNum1 _ = (reflectNum1 (undefined :: s) + 1)\ninstance ReflectNum1 s =&gt; ReflectNum1 (Pred s ) where reflectNum1 _ = (reflectNum1 (undefined :: s) - 1)\n\n--\nv1 :: Int = reflectNum1 (undefined :: Zero)\n</code></pre>\n\n<p>with type application we can have a nice cleaning of the undefined</p>\n\n<pre><code>--- Type Application\n\n-- outillage\nnewtype Tagged s a = Tagged { unTag :: a } deriving Show\nderiving instance Functor (Tagged s)\ninstance Applicative (Tagged s) where\n  pure = Tagged\n  Tagged f &lt;*&gt; Tagged x = Tagged (f x)\n  _ *&gt; n = n\n\nretag :: Tagged s b -&gt; Tagged t b\nretag = Tagged . unTag\n\nclass ReflectNum s where reflectNum :: Num a =&gt; Tagged s a\ninstance                 ReflectNum  Zero     where reflectNum = Tagged 0\ninstance ReflectNum s =&gt; ReflectNum (Pred  s) where reflectNum = (reflectNum @ s) &lt;&amp;&gt; ((-) 1) &amp; retag\ninstance ReflectNum s =&gt; ReflectNum (Succ  s) where reflectNum = (reflectNum @ s) &lt;&amp;&gt; ((+) 1) &amp; retag\ninstance ReflectNum s =&gt; ReflectNum (Twice s) where reflectNum = (reflectNum @ s) &lt;&amp;&gt; (* 2)   &amp; retag\n\ngetReflNum :: forall s a. (ReflectNum s, Num a) =&gt; a\ngetReflNum = unTag (reflectNum @ s)\nv3 :: Int = getReflNum  @ Zero\n</code></pre>\n\n<p>Can we do better ? As in expressing more properties, or in a nicer way ?</p>\n"}, {"tags": ["haskell", "haskell-stack", "hspec"], "answers": [{"comments": [{"owner": {"reputation": 1527, "user_id": 5539184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/r4U5R.jpg?s=128&g=1", "display_name": "Rob Murray", "link": "https://stackoverflow.com/users/5539184/rob-murray"}, "edited": false, "score": 0, "creation_date": 1509899371, "post_id": 47123673, "comment_id": 81197722, "body": "That&#39;s great. Is it possible to get a test to be skipped when just running <code>stack test</code> with no skip specified? Or would this be possible by having another similar specification file with just the expensive test in?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 1527, "user_id": 5539184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/r4U5R.jpg?s=128&g=1", "display_name": "Rob Murray", "link": "https://stackoverflow.com/users/5539184/rob-murray"}, "edited": false, "score": 1, "creation_date": 1509900345, "post_id": 47123673, "comment_id": 81198101, "body": "You can set the skip in a <code>.hspec</code> file, see <a href=\"http://hspec.github.io/options.html#specifying-options-in-config-files\" rel=\"nofollow noreferrer\">hspec.github.io/options.html#specifying-options-in-config-fi&zwnj;&#8203;les</a>."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 1, "last_activity_date": 1509901950, "last_edit_date": 1509901950, "creation_date": 1509897956, "answer_id": 47123673, "question_id": 47123435, "link": "https://stackoverflow.com/questions/47123435/haskell-hspec-only-run-expensive-test-on-command-line-flag/47123673#47123673", "title": "Haskell Hspec - only run expensive test on command line flag", "body": "<p>You can use <a href=\"http://hspec.github.io/options.html\" rel=\"nofollow noreferrer\"><code>--skip=PATTERN</code></a> to skip a test. Other than that, you can check the command line arguments in your own <code>main</code> if you don't use automatic test discovery and set the <code>Config</code> for <a href=\"http://hackage.haskell.org/package/hspec-core-2.4.4/docs/Test-Hspec-Core-Runner.html#v:hspecWith\" rel=\"nofollow noreferrer\"><code>hspecWith</code></a> (the <code>configSkipPredicate</code>).</p>\n\n<p>If you want to automatically skip a test without specifying it on the command line you can use a <code>.hspec</code> file, see <a href=\"http://hspec.github.io/options.html#specifying-options-in-config-fi%E2%80%8C%E2%80%8Bles\" rel=\"nofollow noreferrer\">here</a>. The you can override the skip by specifying to match the pattern instead on the command line.</p>\n"}], "owner": {"reputation": 1527, "user_id": 5539184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/r4U5R.jpg?s=128&g=1", "display_name": "Rob Murray", "link": "https://stackoverflow.com/users/5539184/rob-murray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 47123673, "answer_count": 1, "score": 0, "last_activity_date": 1509901950, "creation_date": 1509896563, "last_edit_date": 1509899440, "question_id": 47123435, "link": "https://stackoverflow.com/questions/47123435/haskell-hspec-only-run-expensive-test-on-command-line-flag", "title": "Haskell Hspec - only run expensive test on command line flag", "body": "<p>I want to run an expensive Hspec test only when some flag on the command line is set for <code>stack test</code>. I understand that I can use <code>stack test --test-arguments=...</code> but what would I use on the command line and how would I carry out the conditional testing in my <code>Spec.hs</code>? I can't seem to find a good example elsewhere online.</p>\n\n<p><strong>EDIT:</strong>  Is it possible to get a test to be skipped when just running <code>stack test</code> with no skip specified? Or would this be possible by having another similar specification file with just the expensive test in?</p>\n"}, {"tags": ["haskell", "ghci", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1509893394, "post_id": 47122772, "comment_id": 81195465, "body": "Try adding a Foo.hs module to your project and import it&#39;s functions. There is no problem in using pre-compiled libraries."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1509893445, "post_id": 47122772, "comment_id": 81195490, "body": "@sevo you mean a Foo module that is not listed anywhere?"}, {"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1509893750, "post_id": 47122772, "comment_id": 81195597, "body": "It needs to be listed as part of the stack project. Otherwise it won&#39;t get compiled by GHCI. In my case it is listed in <code>other-modules</code> section as well as located under <code>source-dirs</code> in <code>package.yaml</code>."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1509893887, "post_id": 47122772, "comment_id": 81195643, "body": "if it is in the &quot;other-modules&quot; section and not in the &quot;exposed-modules&quot; section of your <code>.cabal</code> file it won&#39;t be imported if you do <code>stack ghci</code> - I am a bit confused - is this answer not addressing your problem? are your comments just additions to my answer?"}, {"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1509894263, "post_id": 47122772, "comment_id": 81195795, "body": "I can import module without &quot;expsed-modules&quot; using &quot;import Foo&quot; interactively AFTER scripts are loaded. The <code>-ghci-script Scratch.hs</code> is just like your solution, except I can have many project specific scripts. The answer is not addressing my problem. My coments try to explain why."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1509894722, "post_id": 47122772, "comment_id": 81195980, "body": "you can have a <code>.ghci</code> file in each project - but if my answer is not addressing your problem, I am sorry. Though I have to say your question is quite short and could use some clarification. Nevertheless I think my answer is useful for someone else, so I won&#39;t delete it."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 1, "last_activity_date": 1509892648, "creation_date": 1509892648, "answer_id": 47122772, "question_id": 47122640, "link": "https://stackoverflow.com/questions/47122640/how-can-i-import-other-stack-modules-in-ghci-script/47122772#47122772", "title": "How can I import other Stack modules in ghci script?", "body": "<p>you could write a project specific <code>.ghci</code> file:</p>\n\n<h2><code>.ghci</code></h2>\n\n<pre><code>import qualified Data.Text as T\n\n:set prompt \"Custom GHCi Script &gt; \"\n:set -XOverloadedStrings\n\nputStrLn \"Hello Darkness my old Friend!\"\n</code></pre>\n\n<p>then remove all write permissions for non owner</p>\n\n<pre><code>$ &gt; chmod go-w .ghci\n</code></pre>\n\n<p>and finally </p>\n\n<pre><code>$ &gt; stack ghci\n</code></pre>\n\n<p>or</p>\n\n<pre><code>$ &gt; stack ghci --package text --load Scratch.hs\nConfiguring GHCi with the following packages:\nGHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\nHello Darkness my old Friend!\nLoaded GHCi configuration from /home/epsilonhalbe/.ghci\nLoaded GHCi configuration from /home/epsilonhalbe/.ghc/ghci.conf\nLoaded GHCi configuration from /tmp/ghci24482/ghci-script\nCustom GHCi Script &gt; a = T.pack \"Text\"\nCustom GHCi Script &gt; :t a\na :: T.Text\nCustom GHCi Script &gt;\n</code></pre>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1509922156, "creation_date": 1509891757, "last_edit_date": 1509922156, "question_id": 47122640, "link": "https://stackoverflow.com/questions/47122640/how-can-i-import-other-stack-modules-in-ghci-script", "title": "How can I import other Stack modules in ghci script?", "body": "<p>I have a sequence of IO actions to run before I can explore data in GHCI. So I use this command:</p>\n\n<pre><code>stack ghci --ghci-options \"-ghci-script Scratch.hs\"\n</code></pre>\n\n<p>The problem is that other modules are not found and cannot be imported. They are compiled later though and subsequently can be imported interactively. How can I change this order?</p>\n"}, {"tags": ["loops", "haskell"], "comments": [{"owner": {"reputation": 1055, "user_id": 593298, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51e634a7316f1a4101f65519d2110cce?s=128&d=identicon&r=PG", "display_name": "keep_learning", "link": "https://stackoverflow.com/users/593298/keep-learning"}, "edited": false, "score": 0, "creation_date": 1509933325, "post_id": 47122615, "comment_id": 81207295, "body": "You can also try until function. <a href=\"http://zvon.org/comp/r/ref-Haskell.html#Functions~Prelude.until\" rel=\"nofollow noreferrer\">zvon.org/comp/r/ref-Haskell.html#Functions~Prelude.until</a>"}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1524021553, "post_id": 47122615, "comment_id": 86796927, "body": "<code>take 100 $ f 1</code>"}], "answers": [{"tags": [], "owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "is_accepted": false, "score": 4, "last_activity_date": 1509934745, "last_edit_date": 1509934745, "creation_date": 1509892737, "answer_id": 47122788, "question_id": 47122615, "link": "https://stackoverflow.com/questions/47122615/how-to-get-out-of-iterate-loop-when-a-condition-is-met/47122788#47122788", "title": "How to get out of iterate loop when a condition is met?", "body": "<p>Just flip the condition, and <code>takeWhile</code> it holds:</p>\n\n<pre><code>f x = takeWhile (&lt;= 100) $ iterate g x\n</code></pre>\n\n<p>Which could also be made point free:</p>\n\n<pre><code>f = takeWhile (&lt;= 100) . iterate g\n</code></pre>\n\n<p>This will take from the infinite list that <code>iterate</code> returns while the accumulator is less than or equal to 100.</p>\n"}, {"comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1509895524, "post_id": 47122802, "comment_id": 81196306, "body": "What is the point of blank avatar which i see many users switching  to recently..? Couldn&#39;t find anything on meta..."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1509897389, "post_id": 47122802, "comment_id": 81197022, "body": "@Redu No one here has a blank avatar. I think you&#39;re having connection problems or something."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1509897731, "post_id": 47122802, "comment_id": 81197136, "body": "@Carcigenicate Yes i guess &quot;or something&quot; is applying here. Strange thing is i see this for &quot;some particular&quot; users in all my computers which are at different locations. Sorry for totally out of topic question though."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1509904019, "post_id": 47122802, "comment_id": 81199452, "body": "@Redu try <a href=\"https://stackoverflow.com/users/849891/will-ness?tab=profile\">stackoverflow.com/users/849891/will-ness?tab=profile</a>. btw I used to sometimes - very rarely - have the same problem. I just ignored it, and it went back to normal."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 2, "last_activity_date": 1610958371, "last_edit_date": 1610958371, "creation_date": 1509892810, "answer_id": 47122802, "question_id": 47122615, "link": "https://stackoverflow.com/questions/47122615/how-to-get-out-of-iterate-loop-when-a-condition-is-met/47122802#47122802", "title": "How to get out of iterate loop when a condition is met?", "body": "<p>Yes, you either use <code>takeWhile (not . p)</code> for that, equivalent to</p>\n<pre><code>foldr (\\x r -&gt; if (not (p x)) then (x:r) else []) []\n</code></pre>\n<p>or sometimes the following is useful,</p>\n<pre><code>takeUntil p = foldr (\\x r -&gt; if (not (p x)) then (x:r) else [x]) []\n</code></pre>\n<p>if you want to include the last element into the sequence, as well.</p>\n<p>In your case, you'd write <code>takeWhile (not . (&gt; 100)) . iterate (*2)</code>, or <code>takeUntil (&gt; 100) . iterate (*2)</code>.</p>\n<p><code>(not . (&gt; 100))</code> is of course the same as <code>(&lt;= 100)</code>.</p>\n"}], "owner": {"reputation": 432, "user_id": 7763268, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1276671ab10db450b270747c1372e320?s=128&d=identicon&r=PG&f=1", "display_name": "sininen", "link": "https://stackoverflow.com/users/7763268/sininen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1449, "favorite_count": 0, "accepted_answer_id": 47122802, "answer_count": 2, "score": 3, "last_activity_date": 1610958371, "creation_date": 1509891630, "question_id": 47122615, "link": "https://stackoverflow.com/questions/47122615/how-to-get-out-of-iterate-loop-when-a-condition-is-met", "title": "How to get out of iterate loop when a condition is met?", "body": "<p>I want to iterate over a function <code>g</code> with <code>iterate</code>. When I run my code the loop runs infinitely. Is there any possibility to get out of the loop when a condition is met?</p>\n\n<p>Something like <code>if g x &gt; 100 then stop</code>.</p>\n\n<p>My code:</p>\n\n<pre><code>f x = iterate g x\n\ng x = 2 * x\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "edited": false, "score": 2, "creation_date": 1509891398, "post_id": 47122460, "comment_id": 81194753, "body": "You don&#39;t need to use brackets in function calls or functions, unless you&#39;re pattern matching. <code>findGen(x)</code> should just be <code>findGen x</code> and <code>ys = countify(zs)</code> should just be <code>ys = countify zs</code>. The only time you need brackets is to pattern match on something like <code>(x:xs)</code>, or to do some work before passing it to a function, like you&#39;ve done in <code>getList (x-1)</code>"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1510019466, "post_id": 47122460, "comment_id": 81247482, "body": "Do you mean for this to generate the <a href=\"https://en.wikipedia.org/wiki/Look-and-say_sequence\" rel=\"nofollow noreferrer\">look-and-say sequence</a> (1, 11, 21, 1211, 111221, 312211, 13112221, 1113213211, \u2026)? The answers so far seem to be solving a different problem."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 6751737, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6152019e8b439f285e5de0ef75c72fcb?s=128&d=identicon&r=PG&f=1", "display_name": "The_C", "link": "https://stackoverflow.com/users/6751737/the-c"}, "edited": false, "score": 0, "creation_date": 1509891732, "post_id": 47122532, "comment_id": 81194866, "body": "Oh, don&#39;t mind group, we needed to recreate it as a part of the exercise."}, {"owner": {"reputation": 73, "user_id": 6751737, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6152019e8b439f285e5de0ef75c72fcb?s=128&d=identicon&r=PG&f=1", "display_name": "The_C", "link": "https://stackoverflow.com/users/6751737/the-c"}, "edited": false, "score": 0, "creation_date": 1509892196, "post_id": 47122532, "comment_id": 81195039, "body": "Okay, I&#39;ve fixed whatever you guys said, but it still gives me weird errors  main.hs:19:13: error:     Not in scope: type constructor or class \u2018List\u2019 main.hs:19:21: error:     Not in scope: type constructor or class \u2018List\u2019"}, {"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "reply_to_user": {"reputation": 73, "user_id": 6751737, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6152019e8b439f285e5de0ef75c72fcb?s=128&d=identicon&r=PG&f=1", "display_name": "The_C", "link": "https://stackoverflow.com/users/6751737/the-c"}, "edited": false, "score": 2, "creation_date": 1509892582, "post_id": 47122532, "comment_id": 81195169, "body": "@The_C It&#39;s hard to say what the issue is when we can&#39;t see the new code, but List isn&#39;t a keyword in Prelude. Keywords with capital letters are generally data constructors, but to make lists we use square brackets to create a list instead of a constructor"}], "tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 0, "last_activity_date": 1509891619, "last_edit_date": 1509891619, "creation_date": 1509891126, "answer_id": 47122532, "question_id": 47122460, "link": "https://stackoverflow.com/questions/47122460/finding-nth-generation-in-the-sequence-1-1-1-2-1-1-2-1-1/47122532#47122532", "title": "Finding n&#39;th generation in the sequence 1 / 1 1 / 2 1 / 1 2 1 1", "body": "<blockquote>\n  <p>I was trying to create it using Ord</p>\n</blockquote>\n\n<p>If you want to sort a list, use <code>sort</code> (from Data.List if I remember correctly)</p>\n\n<p>Also, note that the compiler will not accept <code>getList</code> because of the wrong type signature you supplied. Use <code>Integer</code> instead of <code>a</code> and it will be ok. Fix the signature for <code>findGen</code> the same way. Or better yet, until you get more familiar with the type system, don't give type signatures at all.</p>\n\n<p>Furthermore, what is <code>count</code>? And why would you need to re-implement <code>group</code>?</p>\n"}, {"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1509955700, "post_id": 47125455, "comment_id": 81214160, "body": "<code>makeMap</code> is a lot easier than that.  Check out <code>fromListWith</code>"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1509959646, "post_id": 47125455, "comment_id": 81216270, "body": "@luqui Hey thanks so much for pointing out <code>fromListWith</code>. I was hoping to find out something simpler for this very basic need. I will correct accordingly."}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1509959609, "last_edit_date": 1509959609, "creation_date": 1509908674, "answer_id": 47125455, "question_id": 47122460, "link": "https://stackoverflow.com/questions/47122460/finding-nth-generation-in-the-sequence-1-1-1-2-1-1-2-1-1/47125455#47125455", "title": "Finding n&#39;th generation in the sequence 1 / 1 1 / 2 1 / 1 2 1 1", "body": "<p>If i have the pattern right you may do this by using <code>Data.Map</code> and using <code>iterate</code> from <code>Data.List</code> in a lazy fashion as follows; (Thanks to @luqui's simplification on the map side)</p>\n\n<pre><code>import qualified Data.Map.Lazy as M\n</code></pre>\n\n<pre><code><s>makeMap :: String -> M.Map Char Int\nmakeMap cs = foldr incrementOr1 M.empty cs\n             where \n             incrementOr1 c m | M.member c m = M.alter (fmap (+1)) c m\n                              | otherwise    = M.insert c 1 m</s></code></pre>\n\n<pre><code>makeMap :: String -&gt; M.Map Char Int\nmakeMap = M.fromListWith (+) . map (flip (,) 1)\n\ngenerateList :: [String]\ngenerateList = iterate getChrCnt \"1\"\n               where\n               getChrCnt = M.foldrWithKey (\\k n a -&gt; a ++ show n ++ [k]) \"\" . makeMap\n\n*Main&gt; take 13 $ generateList\n[\"1\",\"11\",\"21\",\"1211\",\"1231\",\"131221\",\"132231\",\"232221\",\"134211\",\"14131231\",\"14231241\",\"24132231\",\"14233221\"]\n</code></pre>\n\n<p>Interestingly it doesn't go anywhere beyond the 13th iteration which results \"14233221\". Just converged.</p>\n"}, {"tags": [], "owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "is_accepted": false, "score": 1, "last_activity_date": 1509911741, "creation_date": 1509911741, "answer_id": 47125978, "question_id": 47122460, "link": "https://stackoverflow.com/questions/47122460/finding-nth-generation-in-the-sequence-1-1-1-2-1-1-2-1-1/47125978#47125978", "title": "Finding n&#39;th generation in the sequence 1 / 1 1 / 2 1 / 1 2 1 1", "body": "<p>I am going to provide a different thought about it. Consider your list as following,</p>\n\n<ol>\n<li>there is a seed <code>\"1\"</code>,</li>\n<li>To grow the list, you only need to rely on the previous element.</li>\n</ol>\n\n<p>Therefore, it's a fixpoint by looking back to 1 element, which can be implemented by specifying a base case, and the inductive case, then concatenate them.</p>\n\n<p>It results in a two liner.</p>\n\n<pre><code>import Data.List (group, sort)\n\ngenList :: [String]\ngenList = \"1\" : map grow genList\n  where grow s = (group $ reverse $ sort s) &gt;&gt;= (\\n@(h:_) -&gt; show (length n) ++ [h])\n\nmain :: IO ()\nmain = putStrLn $ show $ take 13 genList\n</code></pre>\n\n<p>Hopefully it's correct,</p>\n\n<pre><code>[\"1\",\"11\",\"21\",\"1211\",\"1231\",\"131221\",\"132231\",\"232221\",\"134211\",\"14131231\",\"14231241\",\"24132231\",\"14233221\"]\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 6751737, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6152019e8b439f285e5de0ef75c72fcb?s=128&d=identicon&r=PG&f=1", "display_name": "The_C", "link": "https://stackoverflow.com/users/6751737/the-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1509959609, "creation_date": 1509890730, "question_id": 47122460, "link": "https://stackoverflow.com/questions/47122460/finding-nth-generation-in-the-sequence-1-1-1-2-1-1-2-1-1", "title": "Finding n&#39;th generation in the sequence 1 / 1 1 / 2 1 / 1 2 1 1", "body": "<p>I'm trying to build a Haskell program that does as the title says. Basically every cell corresponds to the cell before it, the 2nd cell implies that there is just one '1' in the previous cell, and the 3rd cell implies that there is two '1' in the previous cell and so on.</p>\n\n<p>I'm very new to haskell and to it's syntax so I'm getting loads of errors which aren't helpful so I'm using this forum to get some help with it.</p>\n\n<p>This is my code:</p>\n\n<pre><code>findGen :: a -&gt; a\nfindGen(x) = (getList (x))!!x\n\ngetList :: a -&gt; [a]\ngetList (0) = []\ngetList (1) = [1]\ngetList (x) = getList(x-1) : ys where \n                            y = Ord getList(x-1) \n                            zs = group y\n                            ds = countify(zs)\n                            ys = concat(ds)\n\ngroup :: Eq a =&gt; [a] -&gt; [[a]]\ngroup [] = []\ngroup (x:xs) = (x:ys) : group zs where (ys,zs) = span ((==) x )xs\n\n\ncountify :: [a] -&gt; [a]\ncountify(x:xs) = (y:xs) where y = count(x)\n</code></pre>\n\n<p>What I was trying to do is like this:\nFindGen is just a function that returns the n'th element in the sequence. \ngetList is the function that builds the sequence, I was trying to create it using Ord to the previous list so I could group it and then use count to figure out how many times each number appear using countify, and then concating the list making it a string.\nTrying to figure out where am I wrong, probably in the syntax because I think the idea is good.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "ghci", "haskell-stack"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1509892045, "post_id": 47122303, "comment_id": 81194980, "body": "I would guess the program not being built with profiling is ghc. If you want to profile your program, you need to pass <code>-xc</code> to your program, not to ghci."}, {"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1509893524, "post_id": 47122303, "comment_id": 81195516, "body": "I see. Is it possible to have <code>xc</code> flag enabled for interpreted code and the libraries it runs?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1509902274, "post_id": 47122303, "comment_id": 81198839, "body": "I don&#39;t think it is possible to profile interpreted code."}], "answers": [{"tags": [], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "is_accepted": false, "score": 0, "last_activity_date": 1518170448, "creation_date": 1518170448, "answer_id": 48703219, "question_id": 47122303, "link": "https://stackoverflow.com/questions/47122303/how-to-get-stacktraces-with-stack-and-ghci/48703219#48703219", "title": "How to get stacktraces with stack and GHCI?", "body": "<pre><code>stack ghci --profile app --ghci-options \"-fexternal-interpreter -prof\"\n</code></pre>\n\n<p>The above seems to work for me (does take a few seconds to start). I had to add the following to my <code>stack.yaml</code>:</p>\n\n<pre><code>build:\n  library-profiling: true\n  executable-profiling: true\n</code></pre>\n\n<p>More informotation: \n<a href=\"https://github.com/commercialhaskell/stack/blob/master/doc/GUIDE.md#debugging\" rel=\"nofollow noreferrer\">https://github.com/commercialhaskell/stack/blob/master/doc/GUIDE.md#debugging</a>\n<a href=\"http://simonmar.github.io/posts/2016-02-12-Stack-traces-in-GHCi.html\" rel=\"nofollow noreferrer\">http://simonmar.github.io/posts/2016-02-12-Stack-traces-in-GHCi.html</a></p>\n\n<p>I may have actually run some additional commands, possibly <code>stack build --enable-library-profiling</code>.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 284, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1518170448, "creation_date": 1509889656, "last_edit_date": 1509927324, "question_id": 47122303, "link": "https://stackoverflow.com/questions/47122303/how-to-get-stacktraces-with-stack-and-ghci", "title": "How to get stacktraces with stack and GHCI?", "body": "<p>With</p>\n\n<pre><code>stack ghci --profile --ghci-options '+RTS -xc -RTS'\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>ghc: the flag -xc requires the program to be built with -prof\n</code></pre>\n\n<p>Which program is not built with <code>-prof</code> and why?</p>\n"}, {"tags": ["haskell", "lazy-evaluation", "monoids", "semigroup"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1509877331, "post_id": 47120384, "comment_id": 81190580, "body": "Do you need the semigroup/monoid abstraction, or the <code>First</code> abstraction (aka early exit from <code>IO</code> functions)?"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1509877598, "post_id": 47120384, "comment_id": 81190652, "body": "@Zeta Ideally, I&#39;d prefer to keep the semigroup/monoid abstraction, but I&#39;m open to suggestions."}, {"owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1509881624, "post_id": 47120384, "comment_id": 81191740, "body": "You could try to write your own instance for <code>Semigroup a =&gt; Semigroup (IO a)</code> that satisfies the behavior you&#39;re looking for."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1509884890, "post_id": 47120384, "comment_id": 81192682, "body": "@AsadSaeeduddin Would <code>FirstIO (launchMissiles *&gt; return Nothing) &lt;&gt; FirstIO (return (Just &#39;x&#39;))</code> be equal to <code>FirstIO (return Nothing) &lt;&gt; FirstIO (return (Just &#39;x&#39;))</code>?"}, {"owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 1, "creation_date": 1509885126, "post_id": 47120384, "comment_id": 81192752, "body": "@danidiaz Since the <code>IO</code> packed inside <code>FirstIO (launchMissiles *&gt; return Nothing)</code> is not the same as the <code>IO</code> packed inside <code>FirstIO (return Nothing)</code>, I would say no, they are not equal. The bit after the <code>&lt;&gt;</code> never factors into the evaluation."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1509886314, "post_id": 47120384, "comment_id": 81193085, "body": "@AsadSaeeduddin I think you are right, and it would be a valid <code>Monoid</code>. In fact, the <code>Alternative</code> instance for <code>MaybeT</code> in transformers is already very similar: <a href=\"http://hackage.haskell.org/package/transformers-0.5.5.0/docs/Control-Monad-Trans-Maybe.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/transformers-0.5.5.0/docs/&hellip;</a>"}, {"owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1509887446, "post_id": 47120384, "comment_id": 81193467, "body": "@MarkSeemann Thinking about this a bit more, what exactly is enforcing laziness in this monoid abstraction pushed through <code>IO</code> buying you? In other words, what use-cases would not be covered by the trivial <code>instance Semigroup (IO (First a)) where (&lt;&gt;) ia ib = ia</code> (with <code>FlexibleInstances</code> enabled)? See <a href=\"https://ideone.com/v9RRv0\" rel=\"nofollow noreferrer\">demo</a>."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 1, "creation_date": 1509892156, "post_id": 47120384, "comment_id": 81195021, "body": "Relevant: <a href=\"http://www.parsonsmatt.org/2016/11/18/clean_alternatives_with_maybet.html\" rel=\"nofollow noreferrer\">parsonsmatt.org/2016/11/18/clean_alternatives_with_maybet.ht&zwnj;&#8203;ml</a> and also <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Foldable.html#v:asum\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.10.0.0/docs/&hellip;</a>"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1509899593, "post_id": 47120384, "comment_id": 81197810, "body": "@AsadSaeeduddin A couple of quick tests with your suggestion seems to indicate that this actually solves my problem. If it&#39;s really that simple, I&#39;d be happy. You&#39;re welcome to add that as an answer. Thank you."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1509908436, "post_id": 47120384, "comment_id": 81200833, "body": "@AsadSaeeduddin I&#39;m not sure I follow... With the <code>Semigroup</code> instance for <code>IO</code> in <code>Data.Orphans</code>, <code>getFirst &lt;$&gt; (First &lt;$&gt; x) &lt;&gt; (First &lt;$&gt; y)</code> executes both <code>x</code> and <code>y</code>..."}, {"owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1509908488, "post_id": 47120384, "comment_id": 81200852, "body": "@MarkSeemann Sorry, made a mistake there. I meant to write <code>getFirst $ (First x) &lt;&gt; (First y)</code>. This is basically the same thing as what that instance from the earlier comment is doing: just picking the first <code>IO</code>. <a href=\"https://www.ideone.com/PVe1uC\" rel=\"nofollow noreferrer\">Here&#39;s</a> a demo."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1509908688, "post_id": 47120384, "comment_id": 81200911, "body": "@AsadSaeeduddin I see... In reality, my question is an attempt at simplifying my actual situation. What I really have is a series of functions that return <code>IO (Maybe MyData)</code>, and I map those to <code>IO (Option (First MyData))</code> in order to choose the leftmost, non-empty value."}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 1, "last_activity_date": 1509893286, "creation_date": 1509893286, "answer_id": 47122879, "question_id": 47120384, "link": "https://stackoverflow.com/questions/47120384/keeping-io-lazy-under-append/47122879#47122879", "title": "Keeping IO lazy under append", "body": "<blockquote>\n  <p>Is there a way that I can retain the Semigroup or Monoid abstraction, while still get lazy IO?</p>\n</blockquote>\n\n<p>Somewhat, but there are drawbacks. The udnerlying problem for our instances is that a generic instance for an <code>Applicative</code> will look like</p>\n\n<pre><code>instance Semigroup a =&gt; Semigroup (SomeApplicative a) where\n    x &lt;&gt; y = (&lt;&gt;) &lt;$&gt; x &lt;*&gt; y\n</code></pre>\n\n<p>We're here at the mercy of <code>(&lt;*&gt;)</code>, and usually the second argument <code>y</code> will be at least in WHNF. For example in <code>Maybe</code>'s implementation the first line will work fine and the second line will <code>error</code>:</p>\n\n<pre><code>liftA2 (&lt;&gt;) Just (First 10) &lt;&gt; Just (error \"never shown\")\nliftA2 (&lt;&gt;) Just (First 10) &lt;&gt; error \"fire!\"\n</code></pre>\n\n<p><code>IO</code>'s <code>(&lt;*&gt;)</code> is implemented in terms of <code>ap</code>, so the second action will <em>always</em> be executed before <code>&lt;&gt;</code> is applied.</p>\n\n<p>A <code>First</code>-like variant is possible with <a href=\"http://hackage.haskell.org/package/transformers-0.5.2.0/docs/Control-Monad-Trans-Except.html#g:2\" rel=\"nofollow noreferrer\"><code>ExceptT</code></a> or similar, essentially any data type that has a <code>Left k &gt;&gt;= _ = Left k</code> like case so that we can stop the computation at that point. Although <code>ExceptT</code> is meant for exceptions, it may work well for your use-case. Alternatively, one of the <code>Alternative</code> transformers (<code>MaybeT</code>, <code>ExceptT</code>) together with <code>&lt;|&gt;</code> instead of <code>&lt;&gt;</code> might suffice.</p>\n\n<hr>\n\n<p>A almost completely lazy IO type is also possible, but must be handled with care:</p>\n\n<pre><code>import Control.Applicative (liftA2)\nimport System.IO.Unsafe (unsafeInterleaveIO)  \n\nnewtype LazyIO a = LazyIO { runLazyIO :: IO a }\n\ninstance Functor LazyIO where\n  fmap f = LazyIO . fmap f . runLazyIO\n\ninstance Applicative LazyIO where\n  pure    = LazyIO . pure\n  f &lt;*&gt; x = LazyIO $ do\n              f' &lt;- unsafeInterleaveIO (runLazyIO f)\n              x' &lt;- unsafeInterleaveIO (runLazyIO x)\n              return $ f' x'\n\ninstance Monad LazyIO where\n  return  = pure\n  f &gt;&gt;= k = LazyIO $ runLazyIO f &gt;&gt;= runLazyIO . k\n\ninstance Semigroup a =&gt; Semigroup (LazyIO a) where\n  (&lt;&gt;) = liftA2 (&lt;&gt;)\n\ninstance Monoid a =&gt; Monoid (LazyIO a) where\n  mempty  = pure mempty\n  mappend = liftA2 mappend\n</code></pre>\n\n<p><a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/System-IO-Unsafe.html#v:unsafeInterleaveIO\" rel=\"nofollow noreferrer\"><code>unsafeInterleaveIO</code></a> will enable the behaviour you want (and is used in <code>getContents</code> and other lazy IO <code>Prelude</code> functions), but it must be used with care. The order of <code>IO</code> operations is completely off at that point. Only when we inspect the values we will trigger the original <code>IO</code>:</p>\n\n<pre><code>ghci&gt; :module +Data.Monoid Control.Monad\nghci&gt; let example = fmap (First . Just) . LazyIO . putStrLn $ \"example\"\nghci&gt; runLazyIO $ fmap mconcat $ replicateM 100 example\nFirst {getFirst = example\nJust ()}\n</code></pre>\n\n<p>Note that we only got our <code>example</code> once in the output, but at a completely random place, since the <code>putStrLn \"example\"</code> and <code>print result</code> got <em>interleaved</em>, since</p>\n\n<pre><code>print (First x) = putStrLn (show (First x))\n                = putStrLn (\"First {getFirst = \" ++ show x ++ \"}\")\n</code></pre>\n\n<p>and <code>show x</code> will finally put the <code>IO</code> necessary to get <code>x</code> in action. The action will get called only once if we use the result multiple times:</p>\n\n<pre><code>ghci&gt; :module +Data.Monoid Control.Monad\nghci&gt; let example = fmap (First . Just) . LazyIO . putStrLn $ \"example\"\nghci&gt; result &lt;- runLazyIO $ fmap mconcat $ replicateM 100 example\nghci&gt; result\nFirst {getFirst = example\nJust ()}\nghci&gt; result\nFirst {getFirst = Just ()}\n</code></pre>\n\n<p>You could write a <code>finalizeLazyIO</code> function that either <code>evaluate</code>s or <code>seq</code>'s <code>x</code> though:</p>\n\n<pre><code>finalizeLazyIO :: LazyIO a -&gt; IO a\nfinalizeLazyIO k = do\n  x &lt;- runLazyIO k\n  x `seq` return x\n</code></pre>\n\n<p>If you were to publish a module with this functions, I'd recommend to only export the type constructor <code>LazyIO</code>, <code>liftIO :: IO a -&gt; LazyIO a</code> and <code>finalizeLazyIO</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1510042305, "post_id": 47126169, "comment_id": 81255133, "body": "Perfect, the <code>newtype</code>-based instance of <code>Monoid</code> (and <code>Semigroup</code>) was just what I was looking for! Thank you!"}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 2, "last_activity_date": 1509913836, "last_edit_date": 1509913836, "creation_date": 1509912822, "answer_id": 47126169, "question_id": 47120384, "link": "https://stackoverflow.com/questions/47120384/keeping-io-lazy-under-append/47126169#47126169", "title": "Keeping IO lazy under append", "body": "<p>The <code>Alternative</code> instance for the <a href=\"http://hackage.haskell.org/package/transformers-0.5.5.0/docs/Control-Monad-Trans-Maybe.html\" rel=\"nofollow noreferrer\"><code>MaybeT</code></a> monad transformer returns the first successful result, and does not execute the rest of the operations. In combination with the <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Foldable.html#v:asum\" rel=\"nofollow noreferrer\"><code>asum</code></a> function, we can write something like:</p>\n\n<pre><code>import Data.Foldable (asum)\nimport Control.Applicative\nimport Control.Monad.Trans.Maybe\n\naction :: Char -&gt; IO Char\naction c = putChar c *&gt; return c\n\nmain :: IO ()\nmain = do\n    result &lt;- runMaybeT $ asum $ [ empty\n                                 , MaybeT $ action 'x' *&gt; return Nothing\n                                 , liftIO $ action 'v'\n                                 , liftIO $ action 'z'\n                                 ]\n    print result\n</code></pre>\n\n<p>where the final <code>action 'z'</code> won't be executed.</p>\n\n<p>We can also write a newtype wrapper with a <code>Monoid</code> instance which mimics the <code>Alternative</code>:</p>\n\n<pre><code>newtype FirstIO a = FirstIO (MaybeT IO a)\n\nfirstIO :: IO (Maybe a) -&gt; FirstIO a\nfirstIO ioma = FirstIO (MaybeT ioma)\n\ngetFirstIO :: FirstIO a -&gt; IO (Maybe a)\ngetFirstIO (FirstIO (MaybeT ioma)) = ioma\n\ninstance Monoid (FirstIO a) where\n    mempty = FirstIO empty\n    FirstIO m1 `mappend` FirstIO m2 = FirstIO $ m1 &lt;|&gt; m2\n</code></pre>\n\n<p>The relationship between <code>Alternative</code> and <code>Monoid</code> is explained in <a href=\"https://stackoverflow.com/questions/10167879/distinction-between-typeclasses-monadplus-alternative-and-monoid/10168111#10168111\">this other SO question</a>.</p>\n"}], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 47126169, "answer_count": 2, "score": 5, "last_activity_date": 1509913836, "creation_date": 1509876799, "question_id": 47120384, "link": "https://stackoverflow.com/questions/47120384/keeping-io-lazy-under-append", "title": "Keeping IO lazy under append", "body": "<p>I may have been under the false impression that Haskell is lazier than it is, but I wonder if there's a way to get the best of both worlds...</p>\n\n<p><code>Data.Monoid</code> and <code>Data.Semigroup</code> define two variations of <code>First</code>. The monoidal version models the leftmost, non-empty value, whereas the semigroup version simply models the leftmost value.</p>\n\n<p>This works fine for pure value values, but consider impure values:</p>\n\n<pre><code>x = putStrLn \"x\" &gt;&gt; return 42\ny = putStrLn \"y\" &gt;&gt; return 1337\n</code></pre>\n\n<p>Both of these values have the type <code>Num a =&gt; IO a</code>. <code>IO a</code> is a <code>Semigroup</code> instance when <code>a</code> is:</p>\n\n<pre><code>instance Semigroup a =&gt; Semigroup (IO a)\n  -- Defined in `Data.Orphans'\n</code></pre>\n\n<p>This means that it's possible to combine two <code>IO (First a)</code> values:</p>\n\n<pre><code>Prelude Data.Semigroup Data.Orphans&gt; fmap First x &lt;&gt; fmap First y\nx\ny\nFirst {getFirst = 42}\n</code></pre>\n\n<p>As we can see, though, both <code>x</code> and <code>y</code> produce their respective side-effects, even though <code>y</code> is never required.</p>\n\n<p>The same applies for <code>Data.Monoid</code>:</p>\n\n<pre><code>Prelude Data.Monoid&gt; fmap (First . Just) x &lt;&gt; fmap (First . Just) y\nx\ny\nFirst {getFirst = Just 42}\n</code></pre>\n\n<p>I think I understand why this happens, given that both the <code>Semigroup</code> and <code>Monoid</code> instances use <code>liftA2</code>, which seems to ultimately be based on <code>IO</code> <em>bind</em>, which is strict, as far as I understand it.</p>\n\n<p>If I dispense with the <code>First</code> abstraction(s), however, I can get lazier evaluation:</p>\n\n<pre><code>first x _ = x\n\nmfirst x y = do\n  x' &lt;- x\n  case x' of\n    (Just _) -&gt; return x'\n    Nothing -&gt; y\n</code></pre>\n\n<p>Using both of those ignores <code>y</code>:</p>\n\n<pre><code>Prelude&gt; first x y\nx\n42\nPrelude&gt; mfirst (fmap Just x) (fmap Just y)\nx\nJust 42\n</code></pre>\n\n<p>In both of these cases, <code>y</code> isn't printed.</p>\n\n<p>My question is, then:</p>\n\n<p><em>Can I get the best of both worlds? Is there a way that I can retain the Semigroup or Monoid abstraction, while still get lazy IO?</em></p>\n\n<p>Is there, for example, some sort of <code>LazyIO</code> container that I can wrap <code>First</code> values in, so that I get the lazy IO I'd like to have?</p>\n\n<p>The actual scenario I'm after is that I'd like to query a prioritised list of IO resources for data, and use the first one that gives me a useful response. I don't, however, want to perform redundant queries (for performance reasons).</p>\n"}, {"tags": ["haskell", "websocket"], "answers": [{"comments": [{"owner": {"reputation": 215, "user_id": 2035316, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b84b148152679b9172a63ebb10a64f69?s=128&d=identicon&r=PG", "display_name": "Deck Pope", "link": "https://stackoverflow.com/users/2035316/deck-pope"}, "edited": false, "score": 0, "creation_date": 1509878095, "post_id": 47120302, "comment_id": 81190751, "body": "Yeah, thanks, my fault, it was late night. Yet if i erase the else and leave only the ip won&#39;t work. I will try another solutions and get back. Thanks"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 1, "last_activity_date": 1509876256, "creation_date": 1509876256, "answer_id": 47120302, "question_id": 47120075, "link": "https://stackoverflow.com/questions/47120075/websockets-with-snap-wont-bind-in-production/47120302#47120302", "title": "Websockets with Snap won&#39;t bind in production", "body": "<p>That's a JavaScript issue, not a Haskell one. The <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLHyperlinkElementUtils/host\" rel=\"nofollow noreferrer\"><code>window.location.host</code></a> will <strong>never</strong> be empty. Therefore, you always end up with the websocket to jaspervdj.be.</p>\n"}], "owner": {"reputation": 215, "user_id": 2035316, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b84b148152679b9172a63ebb10a64f69?s=128&d=identicon&r=PG", "display_name": "Deck Pope", "link": "https://stackoverflow.com/users/2035316/deck-pope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509876256, "creation_date": 1509874388, "question_id": 47120075, "link": "https://stackoverflow.com/questions/47120075/websockets-with-snap-wont-bind-in-production", "title": "Websockets with Snap won&#39;t bind in production", "body": "<p>please help me with something:\nI want to implement websockets-snap in production but they seem that won't take the address. I have the following code:</p>\n\n<p><code>the js inside index.html file</code></p>\n\n<pre><code>function createChatSocket() {\n    if(window.location.host == '') {\n        /* Running on localhost */\n        return new WebSocket('ws://35.197.208.147/ws/console/');\n    } else {\n        /* Running in \"production\" */\n        return new WebSocket('wss://jaspervdj.be/websockets/example/chat/');\n    }\n}\n</code></pre>\n\n<p>the window.location.host is not empty, it is the ip</p>\n\n<p><code>the server.hs file</code></p>\n\n<pre><code>app :: Snap ()\napp = Snap.route\n    [ (\"\",               Snap.ifTop $ Snap.serveFile \"./shorts/index.html\")\n    , (\"console\", console)\n    ]\n....\n....\n....\n--------------------------------------------------------------------------------\nconsole :: Snap ()\nconsole = do\n    state &lt;- liftIO $ newMVar newServerState\n    WS.runWebSocketsSnap $ application state\n</code></pre>\n\n<p>No matter what i do, it will always return the websockets found on <code>wss://jaspervdj.be/websockets/example/chat/</code> and not my server. What can i do?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "pattern-matching", "higher-order-functions", "higher-order-types"], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 5, "last_activity_date": 1509877066, "creation_date": 1509877066, "answer_id": 47120418, "question_id": 47119719, "link": "https://stackoverflow.com/questions/47119719/is-there-a-way-to-capture-a-tuple-of-higher-order-functions-in-haskell/47120418#47120418", "title": "Is there a way to capture a tuple of higher-order functions in Haskell?", "body": "<p>You never pattern matched on a function. You always pattern matched on the pair-constructor <code>(,)</code>. Your <code>(even, odds)</code> example</p>\n\n<pre><code>(evens, odds) = (length . (filter even), length . (filter odd))\n</code></pre>\n\n<p>just works like</p>\n\n<pre><code>(first, second) = (x, y)\n</code></pre>\n\n<p>It doesn't matter what type <code>x</code> and <code>y</code> have at that point.</p>\n\n<hr>\n\n<p>Your <code>(q, r)</code> example doesn't work due to <code>quotRem</code>'s type. Let's recall it and compare it with <code>(q, r)</code>'s type:</p>\n\n<pre><code>quotRem       :: Integral n =&gt; n -&gt; n -&gt; (n     , n)\nquotRem 12345 :: Integral n =&gt;      n -&gt; (n     , n)\n(q, r)        :: Integral n =&gt;           (n -&gt; n, n -&gt; n)\n</code></pre>\n\n<p>As you can see, the pair <code>(q, r)</code>'type differs from <code>quotRem</code>'s one. Still, it's possible to write your function:</p>\n\n<pre><code>pairify :: (a -&gt; (b, c)) -&gt; (a -&gt; b, a -&gt; c)\npairify f = (fst . f, snd . f)\n\n(q,r) = pairify (quotRem 12345)\n</code></pre>\n\n<p>But as you can see we don't gain too much from <code>pairify</code>. By the way, <code>partition</code> from <code>Data.List</code> provides your <code>(even, odds)</code> functionality:</p>\n\n<pre><code>(even, odds) = pairify (partition even)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 3, "last_activity_date": 1509877424, "creation_date": 1509877424, "answer_id": 47120466, "question_id": 47119719, "link": "https://stackoverflow.com/questions/47119719/is-there-a-way-to-capture-a-tuple-of-higher-order-functions-in-haskell/47120466#47120466", "title": "Is there a way to capture a tuple of higher-order functions in Haskell?", "body": "<p>Look at the type of <code>(12345 `quotRem`)</code>:</p>\n\n<pre><code>Integral a =&gt; a -&gt; (a, a)\n</code></pre>\n\n<p>It\u2019s a single function that returns a tuple. If you want to make this into a tuple of functions, you can compose it with <code>fst</code> and <code>snd</code>:</p>\n\n<pre><code>(q, r) = (fst . f, snd . f)\n  where f = (12345 `quotRem`)\n</code></pre>\n\n<p>If you want to do this in a point-free way, one way is to use the <code>&amp;&amp;&amp;</code> combinator from <code>Control.Arrow</code>. Its fully general type is:</p>\n\n<pre><code>Arrow a =&gt; a b c -&gt; a b d -&gt; a b (c, d)\n</code></pre>\n\n<p>Specialised to the <code>-&gt;</code> arrow, that\u2019s:</p>\n\n<pre><code>(b -&gt; c) -&gt; (b -&gt; d) -&gt; b -&gt; (c, d)\n</code></pre>\n\n<p>So it takes two functions, each taking a value of type <code>b</code>, and returns both their results (of types <code>c</code> and <code>d</code>) in a tuple. So here you can do something like this:</p>\n\n<pre><code>split = (fst .) &amp;&amp;&amp; (snd .)\n(q, r) = split (12345 `quotRem`)\n</code></pre>\n\n<p>Whereas if you look at the type of <code>(length . filter even, length . filter odd)</code>, it\u2019s a tuple already,</p>\n\n<pre><code>(Integral a, Integral b) =&gt; ([a] -&gt; Int, [b] -&gt; Int)\n</code></pre>\n\n<p>Which is why of course you can destructure this tuple to bind <code>evens</code> and <code>odds</code>.</p>\n"}], "owner": {"reputation": 437, "user_id": 5299034, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10203272588494957/picture?type=large", "display_name": "BrainFRZ", "link": "https://stackoverflow.com/users/5299034/brainfrz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 47120418, "answer_count": 2, "score": 2, "last_activity_date": 1509877424, "creation_date": 1509871391, "question_id": 47119719, "link": "https://stackoverflow.com/questions/47119719/is-there-a-way-to-capture-a-tuple-of-higher-order-functions-in-haskell", "title": "Is there a way to capture a tuple of higher-order functions in Haskell?", "body": "<p>I understand that <a href=\"https://stackoverflow.com/questions/28996956/pattern-match-haskell-higher-order-function\">it's impossible to pattern match functions</a> in Haskell, and I fully understand why. However, I have two closely related questions. First, in cases where you'd like to partially apply functions for use later, is there a way of defining and capturing the return if it's a tuple? Or am I wrong, and this is still trying to pattern match functions under my nose?</p>\n\n<p>For example, suppose I'm trying to get the quotient and remainder of a value with various multiples of ten. Then, how would I write something like this?</p>\n\n<pre><code>q, r :: Integral a =&gt; a -&gt; a\n(q, r) = (12345 `quotRem`)\n</code></pre>\n\n<p>I realize here, there are separate functions that exist, so I could do this instead:</p>\n\n<pre><code>q, r :: Integral a =&gt; a -&gt; a\nq = (12345 `quot`)\nr = (12345 `rem`)\n</code></pre>\n\n<p>However, that's a very specific case, and there are unlimited other examples of functions that return tuples that would be nice to generalize. For example, a function that returns the number of evens and odds in a list.</p>\n\n<pre><code>evens, odds :: Integral a =&gt; [a] -&gt; Int\n(evens, odds) = (length . (filter even), length . (filter odd))\n</code></pre>\n\n<p>This leads me to my second question. The above works just fine in GHCi.</p>\n\n<pre><code>Prelude&gt; let (evens, odds) = (length . (filter even), length . (filter odd))\nPrelude&gt; :t evens\nevens :: Integral a =&gt; [a] -&gt; Int\nPrelude&gt; evens [1..10]\n5\n</code></pre>\n\n<p>What's even more confusing is it even works by \"pattern-matching\" in the same way that I was playing with <code>(q, r)</code> in the beginning:</p>\n\n<pre><code>Prelude&gt; let evensOdds = (length . (filter even), length . (filter odd))\nPrelude&gt; :t evensOdds\nevensOdds :: (Integral a1, Integral a) =&gt; ([a1] -&gt; Int, [a] -&gt; Int)\nPrelude&gt; let (ev,od) = evensOdds\nPrelude&gt; :t ev\nev :: Integral a1 =&gt; [a1] -&gt; Int\nPrelude&gt; ev [1..10]\n5\n</code></pre>\n\n<p>It also works just fine in an actual file loaded into GHCi, even though <code>(evens, odds)</code> doesn't. Why are these two different, and why does the second one work in GHCi at all if it doesn't work normally? Can what's different here be leveraged in some way?</p>\n"}, {"tags": ["mongodb", "haskell", "conduit"], "answers": [{"comments": [{"owner": {"reputation": 33595, "user_id": 350890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/186bebdcf5f3045b53362efe34e56e8a?s=128&d=identicon&r=PG", "display_name": "Peter Tillemans", "link": "https://stackoverflow.com/users/350890/peter-tillemans"}, "edited": false, "score": 0, "creation_date": 1512132962, "post_id": 47120155, "comment_id": 82144928, "body": "I was not yet ready at the time to appreciate your answer. I have now solved the type issues however the program hangs when it hits the conduit. I am going to hit my head a bit more against the keyboard and will post another question if I can&#39;t get out as it is something else entirely. Thanks for setting me on the right road!"}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 1, "last_activity_date": 1509875070, "creation_date": 1509875070, "answer_id": 47120155, "question_id": 47119668, "link": "https://stackoverflow.com/questions/47119668/how-to-transform-monads-in-a-conduit-pipeline/47120155#47120155", "title": "How to transform monads in a conduit pipeline?", "body": "<p>Without all of the types and functions available, it's a bit hard to tell you the best way to do it. However, one way that should work looks something like this:</p>\n\n<pre><code>withBinaryFile (unpack src) ReadMode $ \\h -&gt; runMongo $ runConduit $\n  sourceHandle h .| GFS.sinkFile bucket src\n</code></pre>\n"}], "owner": {"reputation": 33595, "user_id": 350890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/186bebdcf5f3045b53362efe34e56e8a?s=128&d=identicon&r=PG", "display_name": "Peter Tillemans", "link": "https://stackoverflow.com/users/350890/peter-tillemans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 47120155, "answer_count": 1, "score": 1, "last_activity_date": 1509882553, "creation_date": 1509870934, "last_edit_date": 1509882553, "question_id": 47119668, "link": "https://stackoverflow.com/questions/47119668/how-to-transform-monads-in-a-conduit-pipeline", "title": "How to transform monads in a conduit pipeline?", "body": "<p>I am trying to copy a file from disk to a File in MongoDB GridFS with the Database.MongoDB packages.</p>\n\n<pre><code>main :: IO ()\nmain = do\n  pipe &lt;- MDB.connect (host \"127.0.0.1\")\n  _ &lt;- access pipe master \"baseball\" run\n  close pipe\n\nrun :: MDB.Action IO GFS.File\nrun = do\n  uploadImage \"sandbox/bat.jpg\"\n\nuploadImage :: Text -&gt; MDB.Action IO GFS.File\nuploadImage src = do\n  bucket &lt;- GFS.openDefaultBucket\n  runConduitRes $ sourceFileBS (unpack src) .| (hole $ GFS.sinkFile  bucket src)\n</code></pre>\n\n<p>This does not work because the <em>sourceFileBS</em> expects as Resource in the base monad and the <em>GFS.sinkFile</em> wants a MongoDB an <em>Action</em> (a specialized Reader).</p>\n\n<p>What is an elegant way to connect these pieces of a conduit together?</p>\n"}, {"tags": ["haskell", "traversal", "haskell-lens"], "answers": [{"comments": [{"owner": {"reputation": 258, "user_id": 8888289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/244cdcaf4f9be82ce1790a3974e76bee?s=128&d=identicon&r=PG&f=1", "display_name": "Alexei Kopylov", "link": "https://stackoverflow.com/users/8888289/alexei-kopylov"}, "edited": false, "score": 0, "creation_date": 1509901797, "post_id": 47120257, "comment_id": 81198655, "body": "Thanks a lot!  By the way, is there a library function that return all indices of a list? Something like this: <code>indicesOf l = [ Traversal $ ix i | i &lt;- [0..length l - 1] ]</code>"}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": true, "score": 3, "last_activity_date": 1509875969, "creation_date": 1509875969, "answer_id": 47120257, "question_id": 47119533, "link": "https://stackoverflow.com/questions/47119533/how-to-use-a-list-of-lens/47120257#47120257", "title": "How to use a list of lens?", "body": "<p>The problem is not in specifying type explicitly. Every time you want to have a container of lenses or traversals (lens inside pair, lens inside list, lens inside <code>Maybe</code>) you need to use <a href=\"https://hackage.haskell.org/package/lens-4.15.4/docs/Control-Lens-Reified.html#t:ReifiedLens\" rel=\"nofollow noreferrer\"><code>ReifiedLens</code></a>.</p>\n\n<p>See this question for explanation: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/33088563/why-do-we-need-control-lens-reified\">Why do we need Control.Lens.Reified?</a></p>\n\n<p>So your example should be written like this:</p>\n\n<pre><code>import Control.Lens\n\nf :: [Int] -&gt; [[Int]]\nf l = [ l &amp; i .~ 1 \n      | Traversal i &lt;- [Traversal $ ix 0]\n      , l ^? i == Just 0\n      ]\n</code></pre>\n\n<blockquote>\n  <p>Note that here <code>Traversal</code> is a constructor of type <code>ReifiedTraversal</code>.</p>\n</blockquote>\n\n<p>And it works like this:</p>\n\n<pre><code>ghci&gt; f [0,0,0]\n[[1,0,0]]\n</code></pre>\n"}], "owner": {"reputation": 258, "user_id": 8888289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/244cdcaf4f9be82ce1790a3974e76bee?s=128&d=identicon&r=PG&f=1", "display_name": "Alexei Kopylov", "link": "https://stackoverflow.com/users/8888289/alexei-kopylov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 47120257, "answer_count": 1, "score": 5, "last_activity_date": 1509875969, "creation_date": 1509869732, "last_edit_date": 1509875658, "question_id": 47119533, "link": "https://stackoverflow.com/questions/47119533/how-to-use-a-list-of-lens", "title": "How to use a list of lens?", "body": "<p>Can I use a list of Traversal? The following code:</p>\n\n<pre><code>f::[Int] -&gt; [[Int]]\nf l = [l &amp; i .~ 1 |  i&lt;-[ix 0], (l^? i) == Just 0]\n</code></pre>\n\n<p>produces an error:</p>\n\n<pre><code>  \u2022 Couldn't match type \u2018Const (Data.Monoid.First Int) [Int]\u2019\n                     with \u2018Identity [Int]\u2019\n      Expected type: ASetter [Int] [Int] Int Integer\n        Actual type: Getting (Data.Monoid.First Int) [Int] Int\n    \u2022 In the first argument of \u2018(.~)\u2019, namely \u2018i\u2019\n      In the second argument of \u2018(&amp;)\u2019, namely \u2018i .~ 1\u2019\n      In the expression: l &amp; i .~ 1\n</code></pre>\n\n<p>Looking at <a href=\"https://stackoverflow.com/questions/35816019/pass-a-lens-into-a-funciton\">this question</a> I think I need somehow to explicitly give a type to i, but every my attempt fails. </p>\n"}, {"tags": ["haskell", "logging", "hslogger"], "answers": [{"comments": [{"owner": {"reputation": 4625, "user_id": 1861521, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dda04c7abdfe8b05f4a258b7a01900a6?s=128&d=identicon&r=PG", "display_name": "jcarpenter2", "link": "https://stackoverflow.com/users/1861521/jcarpenter2"}, "edited": false, "score": 1, "creation_date": 1509918891, "post_id": 47120979, "comment_id": 81204247, "body": "Luckily, calling <code>setHandlers</code> and using <code>TypeApplications</code> should not even be necessary.  The section about <code>removeLogger</code> on <a href=\"https://hackage.haskell.org/package/hslogger-1.2.10/docs/System-Log-Logger.html#g:9\" rel=\"nofollow noreferrer\">this page</a> says &quot;The root logger&#39;s default handler that writes every message to stderr can be removed by using this function before any handlers have been added to the root logger:&quot; <code>updateGlobalLogger rootLoggerName removeHandler</code>.  So apparently, the stderr logger is the only handler belonging to the root logger, and there is going to be some stability to that statement."}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": true, "score": 1, "last_activity_date": 1509880947, "creation_date": 1509880947, "answer_id": 47120979, "question_id": 47119100, "link": "https://stackoverflow.com/questions/47119100/hslogger-disable-output-to-console/47120979#47120979", "title": "hslogger disable output to console", "body": "<p>Okay, I spent about an hour and a half to figure this out. Code of <code>hslogger</code> is not very clean and doesn't make it easy to understand it. </p>\n\n<p><strong>EXPLANATION</strong></p>\n\n<p>Printing in terminal happens because there exist <code>rootLogger</code> with <code>rootLoggerName = \"\"</code> and <code>stderr</code> handler. When you print something to specific logger you also print to all parents of this exact logger. It happens so that <code>rootLoggerName</code> is one of parents for <code>Happstack.Server.AccessLog.Combined</code>. </p>\n\n<p><strong>SOLUTION</strong></p>\n\n<p>The way I found to disable terminal logging is just to set all handler of root logger name to empty list, like this:</p>\n\n<pre><code>updateGlobalLogger rootLoggerName (setHandlers [])\n</code></pre>\n\n<p>Unfortunately, this exact code won't compile because type of <code>[]</code> is too ambiguous for <code>setHandlers</code>. You can solve this type inference issue with <code>-XTypeApplications</code> extension. Here is the full code example:</p>\n\n<pre><code>{-# LANGUAGE TypeApplications #-}\n\nimport GHC.IO.Handle (Handle)\nimport System.Log.Logger\nimport System.Log.Handler.Simple\n\nmain :: IO ()\nmain = do\n  accessLogHandler &lt;- fileHandler \"access\" INFO\n  let name = \"Happstack.Server.AccessLog.Combined\"\n  updateGlobalLogger name (setHandlers [accessLogHandler])\n  updateGlobalLogger name (setLevel INFO)\n  updateGlobalLogger rootLoggerName (setHandlers @(GenericHandler Handle) [])\n  infoM name \"Hello!\"\n</code></pre>\n\n<p>This <code>infoM</code> will print only to file and won't print to terminal.</p>\n"}], "owner": {"reputation": 4625, "user_id": 1861521, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dda04c7abdfe8b05f4a258b7a01900a6?s=128&d=identicon&r=PG", "display_name": "jcarpenter2", "link": "https://stackoverflow.com/users/1861521/jcarpenter2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 47120979, "answer_count": 1, "score": 1, "last_activity_date": 1509880947, "creation_date": 1509865827, "last_edit_date": 1509872146, "question_id": 47119100, "link": "https://stackoverflow.com/questions/47119100/hslogger-disable-output-to-console", "title": "hslogger disable output to console", "body": "<p>The following is supposed to configure hslogger for a Happstack application:</p>\n\n<pre><code>main = do\n  accessLogHandler &lt;- fileHandler \"access\" INFO\n  updateGlobalLogger \"Happstack.Server.AccessLog.Combined\" (setLevel INFO)\n  updateGlobalLogger \"Happstack.Server.AccessLog.Combined\" (setHandlers [accessLogHandler])\n  simpleHTTP nullConf app\n</code></pre>\n\n<p>Access logs are going both to my \"access\" file and to stderr.  According to <a href=\"http://hackage.haskell.org/package/hslogger-1.2.10/docs/System-Log-Logger.html\" rel=\"nofollow noreferrer\">this page</a>, <code>setHandlers</code> is supposed to \"Set the Logger's list of handlers to the list supplied. All existing handlers are removed first.\"  I had assumed that console output would be an \"existing handler\", but apparently it is not.</p>\n\n<p>How do you deactivate hslogger's console output?</p>\n"}, {"tags": ["haskell", "gadt"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 3, "creation_date": 1509865825, "post_id": 47119038, "comment_id": 81187857, "body": "If I understand correctly, you could use <code>T :: Either (a -&gt; b) (Dict (a ~ b)) -&gt; a -&gt; T b</code>  (where <a href=\"https://hackage.haskell.org/package/constraints-0.9.1/docs/Data-Constraint.html#t:Dict\" rel=\"nofollow noreferrer\"><code>Dict</code></a> is from <code>constraints</code> package)"}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1509866424, "post_id": 47119038, "comment_id": 81187988, "body": "I assume <code>Either (Dict (a ~ b)) (a -&gt; b)</code> would be a better approach, replacing <code>Just</code> with <code>Right</code> and <code>Nothing</code> with <code>Left Dict</code>?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1509866657, "post_id": 47119038, "comment_id": 81188040, "body": "sure?  You get <code>Either</code>&#39;s various instances in one parameter versus the other, but it&#39;s an aesthetic issue.  I usually don&#39;t use <code>Either</code>&#39;s single-parameter instances anyway, preferring the <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Control-Arrow.html#t:ArrowChoice\" rel=\"nofollow noreferrer\"><code>ArrowChoice</code></a> combinators, which are more symmetrical."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1509870298, "post_id": 47119038, "comment_id": 81188851, "body": "Also consider <code>Either (a -&gt; b) (a :~: b)</code>, using <code>Data.Type.Equality.(:~:)</code>"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1509866219, "creation_date": 1509865202, "last_edit_date": 1509866219, "question_id": 47119038, "link": "https://stackoverflow.com/questions/47119038/is-there-a-type-restricted-maybe-style-nothing", "title": "Is there a type restricted Maybe style &quot;Nothing&quot;?", "body": "<p>Consider the following code:</p>\n\n<pre><code>data T b where\n  T :: Maybe (a -&gt; b) -&gt; a -&gt; T b\n\ng (T (Just f) x) = f x\ng (T Nothing x) = x\n</code></pre>\n\n<p>this does not compile, we get an error on the <code>Nothing</code> definition of <code>g</code>. The reason of this is because <code>Nothing</code> does not prevent the internal type <code>a</code> from being different to the externally visible type <code>b</code>.</p>\n\n<p>Now consider this alternative approach:</p>\n\n<pre><code>data Maybe' b a where\n  Just' :: a -&gt; Maybe' b a\n  Nothing' :: Maybe' b b\n\ndata T' b where\n  T' :: Maybe' (a -&gt; a) (a -&gt; b) -&gt; a -&gt; T' b\n\ng' (T' (Just' f) x) = f x\ng' (T' Nothing' x) = x\n</code></pre>\n\n<p>This compiles without issue. </p>\n\n<p>Here's another fun example of what this allows:</p>\n\n<pre><code>dotMaybe :: \n  Maybe' (dummy1 -&gt; dummy1) (b -&gt; c) -&gt; \n  Maybe' (dummy2 -&gt; dummy2) (a -&gt; b) -&gt; \n  Maybe' (dummy2 -&gt; dummy2) (a -&gt; c)\ndotMaybe (Just' f) (Just' g) = Just' (f . g)\ndotMaybe (Just' f) Nothing' = Just' f\ndotMaybe Nothing' (Just' g) = Just' g\ndotMaybe Nothing' Nothing' = Nothing'\n</code></pre>\n\n<p>Is there a package already available on Hackage that allows for the sort of functionality demonstrated in <code>Maybe'</code>, or should I package something up? I just don't want to reinvent the wheel. </p>\n"}, {"tags": ["list", "haskell", "filter"], "answers": [{"tags": [], "owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "is_accepted": false, "score": 3, "last_activity_date": 1509835185, "creation_date": 1509835185, "answer_id": 47116329, "question_id": 47116264, "link": "https://stackoverflow.com/questions/47116264/filtering-user-defined-types/47116329#47116329", "title": "Filtering User-Defined Types", "body": "<pre><code>genre :: Genre\nfilter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nfilter genre :: ???\n</code></pre>\n\n<p>Instead, what you need is a predicate like</p>\n\n<pre><code>getFilteredArtists xs genre = filter hasGenre xs where\n    hasGenre :: Artist -&gt; Bool\n</code></pre>\n\n<p>How to write <code>hasGenre</code>? Well, you already have a <code>getGenres</code> function, and the standard library has a</p>\n\n<pre><code>elem :: Eq a =&gt; a -&gt; [a] -&gt; Bool\n</code></pre>\n\n<p>function. <code>genre `elem` genres == True</code> if <code>genre</code> is contained in <code>genres</code>, <code>False</code> otherwise.</p>\n"}, {"tags": [], "owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "is_accepted": true, "score": 3, "last_activity_date": 1509835251, "creation_date": 1509835251, "answer_id": 47116338, "question_id": 47116264, "link": "https://stackoverflow.com/questions/47116264/filtering-user-defined-types/47116338#47116338", "title": "Filtering User-Defined Types", "body": "<p>The below code should work. It would help if you post the type error so people can have a better idea at what's going on. I can see a few issues with your code.</p>\n\n<p>One, you're trying to filter on genre, which is a string, not a bool. You need to use (==) to compare strings.</p>\n\n<p>Second, getGenres isn't defined but assuming it takes an artist, and returns all the genres, mapping it over the artists wouldn't do what your code appears to want it to do. It would just give you the genres without the added context of the artists. </p>\n\n<p>I think what you want to do is filter the artists where the genre is an element of the current artists.</p>\n\n<p>You can also use a data declaration to make automatically make accessor functions for you without having to manually write them.</p>\n\n<pre><code>data Artist = Artist {\n    getName :: String,\n    getGenres :: Genres\n} deriving (Show)\n\ntype Name   = String\ntype Genres = [Genre]\ntype Genre  = String\n\ngetFilteredArtists :: [Artist] -&gt; Genre -&gt; [Artist]\ngetFilteredArtists xs genre = filter (\\x -&gt; genre `elem` getGenres x) xs\n\nartists = [\n  Artist \"Grimes\" [\"Electropop\", \"Dream Pop\", \"Synthpop\"],\n  Artist \"My Bloody Valentine\" [\"Shoegaze\", \"Noise Pop\", \"Post Punk\"],\n  Artist \"David Bowie\" [\"Art Rock\", \"Pop Rock\", \"Glam Rock\", \"New Wave\"]\n  ]\n\nmain = print $ getFilteredArtists artists \"Art Rock\"\n</code></pre>\n\n<p>The above code will output:</p>\n\n<pre><code>[Artist {getName = \"David Bowie\", getGenres = [\"Art Rock\",\"Pop Rock\",\"Glam Rock\",\"New Wave\"]}]\n</code></pre>\n"}], "owner": {"reputation": 323, "user_id": 6576252, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d4bf1a52d627d15cf923fc884444a718?s=128&d=identicon&r=PG&f=1", "display_name": "Wallace Mogerty", "link": "https://stackoverflow.com/users/6576252/wallace-mogerty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 47116338, "answer_count": 2, "score": 0, "last_activity_date": 1509835251, "creation_date": 1509834719, "question_id": 47116264, "link": "https://stackoverflow.com/questions/47116264/filtering-user-defined-types", "title": "Filtering User-Defined Types", "body": "<p>I am attempting to write a function that accepts a list of <code>Artist</code>s and a <code>Genre</code> string as parameters and outputs all <code>Artist</code>s with that genre. I have defined the data type <code>Artist</code> as follows:</p>\n\n<pre><code>data Artist = Artist Name Genres\n  deriving Show\ntype Name   = String\ntype Genres = [Genre]\ntype Genre  = String\n</code></pre>\n\n<p>My code to implement the function is as follows:</p>\n\n<pre><code>getFilteredArtists :: [Artist] -&gt; Genre -&gt; [Artist]\ngetFilteredArtists xs genre = filter (genre) (map getGenres xs)\n</code></pre>\n\n<p>A sample function call is below:</p>\n\n<pre><code>artists = [\n  Artist \"Grimes\" [\"Electropop\", \"Dream Pop\", \"Synthpop\"],\n  Artist \"My Bloody Valentine\" [\"Shoegaze\", \"Noise Pop\", \"Post Punk\"],\n  Artist \"David Bowie\" [\"Art Rock\", \"Pop Rock\", \"Glam Rock\", \"New Wave\"]\n  ]\n\ngetFilteredArtists artists \"Art Rock\"\n</code></pre>\n\n<p>Which  should return <code>[Artist \"David Bowie\" [\"Art Rock\", \"Pop Rock\", \"Glam Rock\", \"New Wave\"]</code></p>\n\n<p>My function, however, is outputting a type-matching error and I am unsure why. Any help is greatly appreciated!</p>\n"}, {"tags": ["haskell", "tuples"], "comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1509834451, "post_id": 47116175, "comment_id": 81182383, "body": "Have you tried using lenses.?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 3, "creation_date": 1509835985, "post_id": 47116175, "comment_id": 81182802, "body": "Are you using the version of esqueleto on Hackage or from that Github link? In the Github one looks like <code>Value</code> is a <code>newtype</code> but the Hackage one has it as a <code>data</code>. If you&#39;re using the Github one (with it as <code>newtype</code>), your <code>someFunction</code> is just <code>coerce</code> from <code>Data.Coerce</code>. It has the added benefit of having zero runtime cost as well."}], "answers": [{"comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 1, "creation_date": 1509835324, "post_id": 47116240, "comment_id": 81182617, "body": "<code>each</code> only works for homogeneous tuples of size less than 10."}, {"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1509835413, "post_id": 47116240, "comment_id": 81182639, "body": "@danidiaz Ah, that&#39;s a pain. The linked page I think said 10, so I was hoping it would just fit this use case."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1509864573, "post_id": 47116240, "comment_id": 81187648, "body": "Also, <i>homogeneous</i> is important here, I suspect it is a dealbreaker."}], "tags": [], "owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "is_accepted": false, "score": 2, "last_activity_date": 1509844192, "last_edit_date": 1509844192, "creation_date": 1509834478, "answer_id": 47116240, "question_id": 47116175, "link": "https://stackoverflow.com/questions/47116175/extract-a-b-c-from-value-a-value-b-value-c/47116240#47116240", "title": "Extract (a, b, c) from (Value a, Value b, Value c)", "body": "<p>The library appears to have an <a href=\"http://hackage.haskell.org/package/esqueleto-2.5.3/docs/Database-Esqueleto.html#v:unValue\" rel=\"nofollow noreferrer\">unValue</a> function, so you just need to choose a way to map over arbitrary length tuples. Then someFunction can become</p>\n\n<pre><code>import Control.Lens (over, each)\n\nsomeFunction = (over each) unValue\n</code></pre>\n\n<p>If you want to try some other ways to map tuples without a lens dependency, you could check out this question: <a href=\"https://stackoverflow.com/questions/9722689/haskell-how-to-map-a-tuple\">Haskell: how to map a tuple?</a></p>\n\n<p>edit: As danidiaz points out this only works for tuples which are max 8 fields long. I'm not sure if there's a better way to generalise it.</p>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 2, "last_activity_date": 1509878480, "creation_date": 1509878480, "answer_id": 47120614, "question_id": 47116175, "link": "https://stackoverflow.com/questions/47116175/extract-a-b-c-from-value-a-value-b-value-c/47120614#47120614", "title": "Extract (a, b, c) from (Value a, Value b, Value c)", "body": "<p>If your tuple has all the same element type:</p>\n\n<pre><code>all3 :: (a -&gt; b) -&gt; (a, a, a) -&gt; (b, b, b)\nall3 f (x, y, z) = (f x, f y, f z)\n</code></pre>\n\n<p>This case can be abstracted over with lenses, using <code>over each</code> as described in @Zpalmtree\u2019s answer.</p>\n\n<p>But if your tuple has different element types, you can make the <code>f</code> argument of this function polymorphic using the <code>RankNTypes</code> extension:</p>\n\n<pre><code>all3 :: (forall a. c a -&gt; a) -&gt; (c x, c y, c z) -&gt; (x, y, z)\nall3 f (x, y, z) = (f x, f y, f z)\n</code></pre>\n\n<p>Then assuming you have <code>unValue :: Value a -&gt; a</code>, you can write:</p>\n\n<pre><code>(a, b, c) = all3 unValue queryResult\n</code></pre>\n\n<p>However, you would need to write separate functions <code>all4</code>, <code>all5</code>, \u2026, <code>all10</code> if you have large tuples. In that case you could cut down on the boilerplate by generating them with Template Haskell. This is part of the reason that large tuples are generally avoided in Haskell, since they\u2019re awkward to work with and can\u2019t be easily abstracted over.</p>\n"}, {"tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": true, "score": 2, "last_activity_date": 1509903722, "creation_date": 1509903722, "answer_id": 47124586, "question_id": 47116175, "link": "https://stackoverflow.com/questions/47116175/extract-a-b-c-from-value-a-value-b-value-c/47124586#47124586", "title": "Extract (a, b, c) from (Value a, Value b, Value c)", "body": "<p><a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Coerce.html\" rel=\"nofollow noreferrer\"><code>Data.Coerce</code></a> from <code>base</code> provides <code>coerce</code>, which acts as your <code>someFunction</code>.</p>\n\n<p><code>coerce</code> \"exchanges\" <code>newtype</code>s for the underlying type they wrap (and visa-versa). This works even if they are wrapped deeply within other types. This is also done with zero overhead, since <code>newtype</code>s have the exact same runtime representation as the type they wrap.</p>\n\n<p>There is a little bit more complexity with type variable roles that you can read about on <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Roles\" rel=\"nofollow noreferrer\">the Wiki page</a> if you're interested, but an application like this turns out to be straightforward since the package uses the \"default\" role for <code>Value</code>'s type variable argument.</p>\n"}], "owner": {"reputation": 69847, "user_id": 3853934, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/GtQuz.jpg?s=128&g=1", "display_name": "Micha\u0142 Per\u0142akowski", "link": "https://stackoverflow.com/users/3853934/micha%c5%82-per%c5%82akowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 47124586, "answer_count": 3, "score": 1, "last_activity_date": 1509903722, "creation_date": 1509833945, "question_id": 47116175, "link": "https://stackoverflow.com/questions/47116175/extract-a-b-c-from-value-a-value-b-value-c", "title": "Extract (a, b, c) from (Value a, Value b, Value c)", "body": "<p>I'm using <a href=\"https://github.com/bitemyapp/esqueleto\" rel=\"nofollow noreferrer\">esqueleto</a> for making SQL queries, and I have one query which returns data with type <code>(Value a, Value b, Value c)</code>. I want to extract <code>(a, b, c)</code> from it. I know that I can use pattern matching like that:</p>\n\n<pre><code>let (Value a, Value b, Value c) = queryResult\n</code></pre>\n\n<p>But I'd like to avoid repeating <code>Value</code> for every tuple element. This is particularly annoying when the tuple has much more elements (like 10). Is there any way to simplify this? Is there a function which I could use like that:</p>\n\n<pre><code>let (a, b, c) = someFunction queryResult\n</code></pre>\n"}, {"tags": ["haskell", "logic"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 3, "creation_date": 1509831169, "post_id": 47115813, "comment_id": 81181570, "body": "Your data type can hold much more complicated expressions than just those in CNF. If you want to work with CNF exclusively, you should trim down your data type so that it can only represent CNF expressions. That will make all of the simplification rules easier."}, {"owner": {"reputation": 73, "user_id": 8702185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8e5108dd07336da0fde1fdb3e856f3?s=128&d=identicon&r=PG&f=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/8702185/momo"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1509834727, "post_id": 47115813, "comment_id": 81182454, "body": "Yes I only need the CNF. But I thought it is already as simply as possible. How should I do that?"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1509836571, "post_id": 47115813, "comment_id": 81182947, "body": "From wikipedia: &quot;[a CNF is] a conjunction of one or more clauses, where a clause is a disjunction of literals&quot;:  so, how about: <code>newtype CNF = Conjunction [ Clause ] ; newtype Clause = Disjunction [ Literal ] ; type Literal = Bool</code>. We can do this without even understanding the problem domain. Note this isn&#39;t quite correct since I think we&#39;d like both lists to be <i>nonempty</i>. There are non-empty list libraries on hackage, or you could roll something yourself or structure things differently, but holding to this same general shape."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1509838920, "post_id": 47115813, "comment_id": 81183459, "body": "@jberryman Bool doesn&#39;t seem like a good base type for a CNF expression. You probably want a symbol of some kind, to represent a variable, eg <code>newtype Var = Var String</code>. And the lists being empty or not doesn&#39;t really matter: there are reasonable interpretations of a conjunction  or disjunction of zero clauses."}, {"owner": {"reputation": 73, "user_id": 8702185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8e5108dd07336da0fde1fdb3e856f3?s=128&d=identicon&r=PG&f=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/8702185/momo"}, "edited": false, "score": 0, "creation_date": 1509841804, "post_id": 47115813, "comment_id": 81184049, "body": "The thing is I don&#39;t have bool values I only have equations. And even if I could simplify my logic, how should I do what I asked for (add one logic to another)?"}], "owner": {"reputation": 73, "user_id": 8702185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8e5108dd07336da0fde1fdb3e856f3?s=128&d=identicon&r=PG&f=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/8702185/momo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1546083533, "creation_date": 1509830949, "last_edit_date": 1546083533, "question_id": 47115813, "link": "https://stackoverflow.com/questions/47115813/haskell-adding-two-cnfs", "title": "haskell adding two CNFs", "body": "<p>for my programming I implemented following structure:</p>\n\n<pre><code>data Logic a = Empty\n              |And     (Logic a) (Logic a)\n              | Or      (Logic a) (Logic a)\n              | Equal   (AtomVariable a) (AtomVariable a)\n              | Not (Logic a) \n              deriving (Show, Eq, Ord)\n</code></pre>\n\n<p>I will have CNF's of Equals or Not(Equal)s. My goal is to add one CNF to another and modify the result if neccesary. E.g. if I have (a=b OR a=c) AND (c!=b) and I want to add (a!=b) the result should be a=c AND c!=b AND a!=b\nI managed to do this for one equation (adding a=b or a!=b to a logic):</p>\n\n<pre><code>check :: Eq a =&gt; Logic a -&gt; Logic a -&gt; Bool\ncheck (Equal a b) (Equal c d)\n    | a == c &amp;&amp; b == d = False\n    | a == d &amp;&amp; b == c = False\n    | otherwise = True\n\ncheck (Equal a b) (Not (Equal c d)) \n    | a == c &amp;&amp; b == d = False\n    | a == d &amp;&amp; b == c = False\n    | otherwise = True\n\ncheck (Equal a b) (Or c d) = ((check (Equal a b) c) || (check (Equal a b) d))\n\ncheck (Equal a b) (And c d) = ((check (Equal a b) c) &amp;&amp; (check (Equal a b) d))\n\ncheck (Equal a b) (Implication c d e)  = check (Equal a b) (And (Equal c d) (Not (Equal c e)))\n\ncheck1 :: Eq a =&gt; Logic a -&gt; Logic a -&gt; Bool\ncheck1 (Not (Equal a b)) (Equal c d) \n    | a == c &amp;&amp; b == d = False\n    | a == d &amp;&amp; b == c = False\n    | otherwise = True\n\ncheck1 (Not (Equal a b)) (Not (Equal c d)) \n    | (check1 (Not (Equal a b)) (Equal c d)) == False = False\n    | otherwise = True\n\ncheck1 (Not (Equal a b)) (Or c d) = ((check1 (Not (Equal a b)) c) || (check1 (Not (Equal a b)) d))\n\ncheck1 (Not (Equal a b)) (And c d) = ((check1 (Not (Equal a b)) c) &amp;&amp; (check1 (Not (Equal a b)) d))\n\ncheck1 (Not (Equal a b)) (Implication c d e)  = check1 (Not (Equal a b)) (And (Equal c d) (Not (Equal c e)))\n\nadd1 :: Eq a =&gt; Logic a -&gt; Logic a -&gt; Logic a\nadd1 (Equal a b) logic\n    | check (Equal a b) logic == True = And logic (Equal a b)\n    | otherwise = logic\n\n\nadd1 (Not (Equal a b)) logic\n    | (check1 (Not (Equal a b)) logic) == True = And logic (Equal a b)\n    | otherwise = logic\n</code></pre>\n\n<p>I guess it is not the best way to do it, but I further want to add a whole logic to another.</p>\n"}, {"tags": ["haskell", "io"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1509827327, "post_id": 47115255, "comment_id": 81180358, "body": "Yes. You mix up values wrapped in an <code>IO</code> monad and simple values. If you do <code>m &gt;&gt;= f</code>, the <i>content</i> wrapped in <code>IO</code> is passed to <code>f</code>. <code>f</code> has signature <code>f :: a -&gt; IO b</code>, so it produces another (well possibly the same) value wrapped in an <code>IO</code> monad. So <code>getContents &gt;&gt;= (++ &quot; hello&quot;)</code> makes no sense, since <code>(++ &quot;hello&quot;)</code> does not return an <code>IO b</code>. You can however use <code>getContents &gt;&gt;= putStrLn . (++ &quot; hello&quot;)</code>"}, {"owner": {"reputation": 1192, "user_id": 7023187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/321015561587503/picture?type=large", "display_name": "Rares Dima", "link": "https://stackoverflow.com/users/7023187/rares-dima"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509827862, "post_id": 47115255, "comment_id": 81180529, "body": "@WillemVanOnsem I&#39;m sorry, but it is still unclear for me. If only the contents wrapped in IO is passed as an argument, then in <code>getContents &gt;&gt;= (++ &quot; hello&quot;)</code>, a <code>String</code>(or <code>[Char]</code>) should be what is passed on into <code>(++ &quot; hello&quot;)</code>, right? And <code>(++ &quot; hello&quot;)</code> has type <code>:: [Char] -&gt; [Char]</code> so if a String is passed into <code>(++ &quot; hello&quot;)</code>, what is the problem?"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 1, "creation_date": 1509828325, "post_id": 47115255, "comment_id": 81180685, "body": "I think your conclusion about do notation is wrong, it&#39;s just a syntax extension. If you don&#39;t understand how to write program without do notation then you don&#39;t understand it."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1509828871, "post_id": 47115255, "comment_id": 81180848, "body": "You seem to be looking for the <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:interact\" rel=\"nofollow noreferrer\"><code>interact</code></a> function. <code>main = interact (++ &quot; hello&quot;)</code>"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1509879885, "post_id": 47115255, "comment_id": 81191238, "body": "One thing that may help you in the future is to write your function in <code>do</code> notation and then desugar it manually, or think about what the expression you wrote manually using <code>&gt;&gt;=</code> would look like in <code>do</code> notation. For example, your erroneous expression <code>getContents &gt;&gt;= (++ &quot; hello&quot;) &gt;&gt;= putStrLn</code> corresponds to the <code>do</code> notation <code>do { x &lt;- getContents; y &lt;- x ++ &quot; hello&quot;; putStrLn y }</code>, making it clear where the error is: you have <code>y &lt;-</code>, so the right-hand side must be an <code>IO</code> action, but instead it\u2019s just a <code>String</code>. One solution is to wrap it in <code>pure</code> (or <code>return</code>) to make it an action."}], "answers": [{"comments": [{"owner": {"reputation": 1192, "user_id": 7023187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/321015561587503/picture?type=large", "display_name": "Rares Dima", "link": "https://stackoverflow.com/users/7023187/rares-dima"}, "edited": false, "score": 0, "creation_date": 1509830384, "post_id": 47115364, "comment_id": 81181340, "body": "Thank you!! This was so clear.  One more question if I may. What does the <code>pure</code> function do? The documentation just says it &quot;lifts a value&quot;, what is that supposed to mean?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 1192, "user_id": 7023187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/321015561587503/picture?type=large", "display_name": "Rares Dima", "link": "https://stackoverflow.com/users/7023187/rares-dima"}, "edited": false, "score": 1, "creation_date": 1509830748, "post_id": 47115364, "comment_id": 81181451, "body": "<code>pure</code> is almost the same as <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Control-Monad-Instances.html#v:return\" rel=\"nofollow noreferrer\"><code>return</code></a>, it&#39;s only slightly more general and arguably better named. (<code>return</code> is <i>in a few situations analogous</i> to the <code>return</code> keyword of procedural languages, but with very significant differences.) Both just \u201cwrap up\u201d a pure value so it has the type of a monadic action which does not actually have any side-effects. \u201cMasquerade\u201d is actually quite a fitting word I&#39;d say."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1509828320, "last_edit_date": 1509828320, "creation_date": 1509827685, "answer_id": 47115364, "question_id": 47115255, "link": "https://stackoverflow.com/questions/47115255/how-to-read-a-haskell-string/47115364#47115364", "title": "How to read a haskell string", "body": "<ol>\n<li><blockquote>\n  <p>Is there something I'm not getting?(99% yes)</p>\n</blockquote>\n\n<p>Yes.</p></li>\n<li><blockquote>\n  <p>If yes, then what?</p>\n</blockquote>\n\n<p>An <code>IO String</code> is something <em>conceptually utterly different</em> from a <code>String</code>. The former is like a cooking recipe, the latter like a meal.<br>\nUntil you feel like an expert Haskeller, you'd better forget that there's such a thing as <code>unsafePerformIO</code>. That is something you should never need in normal Haskell code, only for FFI bindings to impure C code or for last-resort optimisations.</p></li>\n<li><p>How should I go about reading the whole stdin and processing it all in one continuous expression?</p>\n\n<pre><code>main = getContents &gt;&gt;= putStrLn . (++ \" hello\")\n</code></pre>\n\n<p>Note that there are only two IO actions here: <code>getContents</code> and <code>putStrLn</code>. So you only need one <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Control-Monad-Instances.html#v:-62--62--61-\" rel=\"nofollow noreferrer\">bind operator</a> to get information from one action to the other.<br>\nIn between, you have the pure <code>(++ \" hello\")</code>. That does not need any monadic bind, just <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Function.html#v:.\" rel=\"nofollow noreferrer\">function composition</a>, to channel through information.<br>\nIf you find the mixed direction of information-flow ugly, you can also use the flipped bind:</p>\n\n<pre><code>main = putStrLn . (++ \" hello\") =&lt;&lt; getContents\n</code></pre>\n\n<p>Alternatively, you <em>could</em> use a monadic bind, but you'd first need to <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Control-Applicative.html#v:pure\" rel=\"nofollow noreferrer\">masquerade the pure function as an IO action</a> (an action which doesn't make use of any of the side-effect possibilities):</p>\n\n<pre><code>main = getContents &gt;&gt;= pure . (++ \" hello\") &gt;&gt;= putStrLn\n</code></pre>\n\n<p>Or you could, rather than \u201ctransforming <code>putStrLn</code> to prepend <code>\" hello\"</code> after the stuff it prints\u201d, instead \u201c<a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:-60--36--62-\" rel=\"nofollow noreferrer\">transform</a> <code>getContents</code> to prepend <code>\" hello\"</code> to the stuff it fetches\u201d:</p>\n\n<pre><code>main = (++ \" hello\")&lt;$&gt;getContents &gt;&gt;= putStrLn\n</code></pre>\n\n<p>All of these are equivalent by the monad laws.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1509829609, "post_id": 47115456, "comment_id": 81181094, "body": "kudos for using the much needed (to a newbie) parens, even if extraneous and uncool. :)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1509830865, "post_id": 47115456, "comment_id": 81181486, "body": "&quot;<code>f</code> itself has no side effects&quot; ... as it constructs an IO action description purely, which will then be run by the imperative runtime and may well have some side effects at that time, as constructed."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 11, "last_activity_date": 1509828835, "last_edit_date": 1509828835, "creation_date": 1509828307, "answer_id": 47115456, "question_id": 47115255, "link": "https://stackoverflow.com/questions/47115255/how-to-read-a-haskell-string/47115456#47115456", "title": "How to read a haskell string", "body": "<p>The main thing you're not considering seems to be the type of <code>&gt;&gt;=</code>:</p>\n\n<pre><code>(&gt;&gt;=) :: IO a -&gt; (a -&gt; IO b) -&gt; IO b\n</code></pre>\n\n<p>In other words, you don't need to \"unwrap\" <code>IO String</code> to <code>String</code>; the <code>&gt;&gt;=</code> operator already hands a plain <code>String</code> to its right operand (the function):</p>\n\n<pre><code>getContents &gt;&gt;= (\\s -&gt; ...)\n--                ^ s :: String\n</code></pre>\n\n<p>The reason <code>getContents &gt;&gt;= (++ \" hello\")</code> fails is that <code>&gt;&gt;=</code> requires the function to return an <code>IO ...</code> value, but <code>(++ \"hello\") :: String -&gt; String</code>.</p>\n\n<p>You can fix this by adding <code>return :: a -&gt; IO a</code> into the mix:</p>\n\n<pre><code>getContents &gt;&gt;= (return . (++ \"hello\"))\n</code></pre>\n\n<p>This whole expression has the type <code>IO String</code>. It will, when executed, read data from <code>stdin</code>, append <code>\"hello\"</code> to it, and return the resulting string.</p>\n\n<p>Thus,</p>\n\n<pre><code>getContents &gt;&gt;= (return . (++ \"hello\")) &gt;&gt;= putStrLn\n</code></pre>\n\n<p>should work fine. But it's more complicated than necessary. Conceptually speaking, <code>return</code> wraps a value in <code>IO</code> and <code>&gt;&gt;=</code> unwraps it again (sort of).</p>\n\n<p>We can fuse the <code>return</code> / <code>&gt;&gt;=</code> bits on the right:</p>\n\n<pre><code>getContents &gt;&gt;= (\\s -&gt; putStrLn (s ++ \"hello\"))\n</code></pre>\n\n<p>I.e. instead of taking <code>getContents :: IO String</code>, adding <code>\"hello\"</code> to it to form a new <code>IO String</code> action, then attaching <code>putStrLn :: String -&gt; IO ()</code> to it, we wrap <code>putStrLn</code> to create a new <code>String -&gt; IO ()</code> function (that appends <code>\"hello\"</code> to its argument before handing the thing off to <code>putStrLn</code>).</p>\n\n<p>Now if we want to, we can get rid of <code>s</code> by standard points-free tricks:</p>\n\n<pre><code>getContents &gt;&gt;= (putStrLn . (++ \"hello\"))\n</code></pre>\n\n<hr>\n\n<p>A note about <code>IO</code> in general: The thing to keep in mind is that <code>IO ...</code> is a normal Haskell type. There is no magic happening here. <code>&gt;&gt;=</code> doesn't execute any actions; it just combines a value of type <code>IO something</code> and a function to construct a new value of type <code>IO somethingelse</code>.</p>\n\n<p>You can think of Haskell as a pure meta-language that constructs an imperative program (i.e. a list of instructions to execute) as a data structure in memory. The only thing that's actually executed is the value bound to <code>Main.main</code>. That is, it's like an imperative runtime runs your Haskell code to produce a pure value in <code>main :: IO ()</code>. The contents of this value are then executed as imperative instructions:</p>\n\n<pre><code>main :: IO ()\nmain =\n    putChar 'H' &gt;&gt;\n    putChar 'i' &gt;&gt;\n    putChar '\\n'\n</code></pre>\n\n<p><code>main</code> is bound to a data structure representing the imperative program <code>print 'H'; print 'i'; print newline</code>. Running the Haskell program builds this data structure, then the runtime executes it.</p>\n\n<p>This model is not complete, though: The imperative runtime can call back into Haskell code. <code>&gt;&gt;=</code> can be used to \"embed\" Haskell functions in the imperative code, which can then (at runtime) inspect values, decide what to do next, etc. But all of that happens in the form of pure Haskell code; only the <code>IO</code> value returned from <code>f</code> in <code>x &gt;&gt;= f</code> matters (<code>f</code> itself has no side effects).</p>\n"}, {"comments": [{"owner": {"reputation": 1192, "user_id": 7023187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/321015561587503/picture?type=large", "display_name": "Rares Dima", "link": "https://stackoverflow.com/users/7023187/rares-dima"}, "edited": false, "score": 0, "creation_date": 1509830563, "post_id": 47115542, "comment_id": 81181386, "body": "Thank you! The box analogy actually worked. Although it is so weird that no tutorial or documentation(at least that i found) mentioned that you need to re-wrap the value before the next bind, some even hinted that one you unwrapped it, it&#39;s smooth sailing."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1509829655, "last_edit_date": 1509829655, "creation_date": 1509828811, "answer_id": 47115542, "question_id": 47115255, "link": "https://stackoverflow.com/questions/47115255/how-to-read-a-haskell-string/47115542#47115542", "title": "How to read a haskell string", "body": "<blockquote>\n  <ol>\n  <li>Is there something I'm not getting?(99% yes)</li>\n  </ol>\n</blockquote>\n\n<p>Yes. The function on the right side of the <code>&gt;&gt;=</code> is a <strong>function</strong> that has signature <code><b>a</b> -&gt; <b>m b</b></code> with <code>m</code> the monad.</p>\n\n<h1>A metaphor: birthday presents</h1>\n\n<p>Something that helped me to understand monads (and functions with bind functions <code>&gt;&gt;=</code>) is <em>not</em> to think about <code>IO</code>.</p>\n\n<p>You can also see a monad (note that <code>IO</code> is just one of the many monads) as a collection. For instance a <code>Maybe a</code>, this is also a monad.</p>\n\n<p>You can see <code>Maybe a</code> as some sort of \"box\". That box can have an object (in case of <code>Just x</code>), or can be an \"empty box\" (instead of a <code>Nothing</code>).</p>\n\n<p>Now the bind operator <code>&gt;&gt;=</code> has such a box on the left side, and a function <code>f :: a -&gt; Maybe b</code> on the other side. Imagine that <code>f</code> is a person, and currently it is their birthday. He/she receives the <em>content</em> of the box, and has to pass another present to the next person on the calendar. So the bind operator <code>&gt;&gt;=</code> will <em>open</em> the box, pass that to the person, and expects a new present it can then further be processed.</p>\n\n<p>So to make a story short: you have to return a new <em>box</em>. Now <code>(++ \" hello\")</code> takes as input the string, but it does <em>not</em> puts that content into a new box (so there is no party :( ).</p>\n\n<p>You can however wrap it into a box yourself. In order to do that, there is the <code>return</code> function (this is a function, <em>not</em> a keyword). So you can write it as:</p>\n\n<pre><code>getContents &gt;&gt;= <b>return .</b> (++ \" hello\") &gt;&gt;= putStrLn</code></pre>\n\n<p>Note that the functions do not have to give the same \"present\", but the type of \"box\" (the monad) has to be the same. For instance <code>putStrLn</code> has type <code>String -&gt; IO ()</code>. So <code>putStrLn</code> is a person that you can make happy with a string as present, and the function will return a box with a <code>()</code> instance in it (or an empty box, there is by the way only one value for <code>()</code>: <code>()</code>).</p>\n\n<p>We can thus do the string processing simply by one function, like:</p>\n\n<pre><code>getContents &gt;&gt;= putStrLn<b> . (++ \" hello\")</b></code></pre>\n\n<p>So if you write a piece of code like:</p>\n\n<pre><code>a &gt;&gt;= b &gt;&gt;= c &gt;&gt;= d &gt;&gt;= e\n</code></pre>\n\n<p>It means that <code>a</code> will construct the first box. The bind operator will open the box and handle the content to <code>b</code>. Based on the content <code>b</code> will construct a new box (with a type of object in it he/she knows <code>c</code> likes). The bind operator opens the box and passes the content to <code>c</code>, and so on.</p>\n\n<h1>What has this got to do with I/O</h1>\n\n<p>I/O functions can be seen as the people in the story of the birtday presents. They return an \"IO box\" so to speak with content in it. The bind operator will open the \"IO box\" (in fact <code>&gt;&gt;=</code> is one of the few functions that knows how to open the IO box), and pass the content to the next function. By doing it that way, it will enforce order, since the next person can not process the present if the previous person has not first inspected their present and constructed a new one.</p>\n\n<h1><code>Maybe</code> revisited</h1>\n\n<p>I/O is rather hard I/O monad to understand, since it is wired into the computer system. An easier monad to understand is the <code>Maybe</code> monad. As we already discussed, <code>Maybe</code> has the following constructor:</p>\n\n<pre><code>data Maybe a = Nothing | Just a\n</code></pre>\n\n<p>Now we imagine <code>Nothing</code> as:</p>\n\n<pre><code>  +---+\n /   /|\n+---+ +\n|   |/\n+---+\n</code></pre>\n\n<p>and <code>Just x</code> as:</p>\n\n<pre><code>  +---+\n /   /|\n+---+ +\n| x |/\n+---+\n</code></pre>\n\n<p>a box with content. Now of course you probably know how to unwrap the <code>Just x</code> constructor and obtain the <code>x</code> value. But imagine that we are not allowed to do that. Only the <code>&gt;&gt;=</code> operator is allowed to open the <code>Maybe</code> box.</p>\n\n<p>Then we can construct a monad with:</p>\n\n<pre><code>instance Monad Maybe where\n    return x = Just x\n\n    (&gt;&gt;=) Nothing _ = Nothing\n    (&gt;&gt;=) (Just x) f = f x\n</code></pre>\n\n<p>What we see is a <code>return</code> function, that wraps an object into a <code>Maybe</code> \"box\", so with <code>return</code>, we can make a \"present\".</p>\n\n<p>The bind operator will inspect the present on the left side. In case it turns out that nothing is in the box, it will not bother the person on the right side, and simply return <code>Nothing</code>.</p>\n\n<p>In case the box contains an <code>x</code>, it will give that object to <code>f</code>, but expects <code>f</code> to construct a new present. <code>&gt;&gt;=</code> thus opens the present. He/she is a \"professional birthday present opener\".</p>\n\n<p>So now we can write somthing like:</p>\n\n<pre><code>Just 2 &gt;&gt;= Just . (+5) &gt;&gt;= Just . (*6)\n</code></pre>\n\n<p>It will return <code>Just 42</code>. Why? We start with a present that contains a <code>2</code>. <code>&gt;&gt;=</code> unwraps the present, and handles the content to <code>Just . (+2)</code>, so we evaluate <code>(Just . (+2)) 2</code>. Note that the <code>Just</code> of <code>Just 2</code> has disappeared. SO now we evaluate this, and the second item in the chain thus handles a <code>Just 7</code> to the system.</p>\n\n<p>This package is again opened, and guess what, it contains a <code>7</code>, now that <code>7</code> is handled to the last function <code>Just . (*6)</code> so the last function will multiply its present by <code>6</code> and wrap it again into a box.</p>\n\n<p>If you however write:</p>\n\n<pre><code>Just 2 &gt;&gt;= (+5) &gt;&gt;= Just . (*6)</code></pre>\n\n<p>this will fail. Why? Because apparently the second function is not in a good mood, and forgot to wrap his/her gift into a box.</p>\n"}], "owner": {"reputation": 1192, "user_id": 7023187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/321015561587503/picture?type=large", "display_name": "Rares Dima", "link": "https://stackoverflow.com/users/7023187/rares-dima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1022, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1509829655, "creation_date": 1509826992, "last_edit_date": 1509828992, "question_id": 47115255, "link": "https://stackoverflow.com/questions/47115255/how-to-read-a-haskell-string", "title": "How to read a haskell string", "body": "<p>I am a complete beginner to Haskell, although familiar to the functional paradigm in languages like Python, F#, Java, C# and C++(in a limited way).</p>\n\n<p>Something that just keeps escaping me is IO in haskell. I tried several times, even learned C# and F# in between my tries of getting around it.</p>\n\n<p>To be more specific I am referring to getting IO without do notation, using do notation, IO becomes trivial. It might be bad practice, but in my spare time I like to see if I can get things done in one continuous expression. As much of a bad practice as that is, it is fun.</p>\n\n<p>Such an expression is usually of the sort(in pseudo-haskell):</p>\n\n<pre><code>main = getStdinContentsAsString \n           &gt;&gt;= ParseStringToDataStructureNeeded\n           &gt;&gt;= DoSomeComputations \n           &gt;&gt;= ConvertToString \n           &gt;&gt;= putStrLn\n</code></pre>\n\n<p>I have no problem with the last four parts. One of the reasons I learned F# was just to see if there was something i was not getting my head around aside from IO, but as soon as I had the convenient Console.ReadLine() of F# which returns a plain old String it was basically smooth sailing.  </p>\n\n<p>Which brings me back to another go at haskell, again stopped by the IO mechanism.</p>\n\n<p>I have managed(using another question here) to get reading a int from the console, and print \"Hello World!\" that many times</p>\n\n<pre><code>main = (readLn :: IO Int) &gt;&gt;= \\n -&gt; mapM_ putStrLn $ replicate n \"Hello World!\"\n</code></pre>\n\n<p>I would like to get at least some \"general use\" way to just read the whole contents of the stdin(possibly multiple lines, so getContents would need to be the function of choice) as a string, and then i can process the string using other functions like unlines and then map.</p>\n\n<p>Some of the things that I already tried:</p>\n\n<p>As I said, getContents would be what I need(unless there is some equivalent to it).</p>\n\n<p>Using logic, since</p>\n\n<pre><code>getContents :: IO String\n</code></pre>\n\n<p>Then I would need something that takes an IO String and returns a lain old String. Which is(as far as i know)</p>\n\n<pre><code>unsafePerformIO :: IO a -&gt; a\n</code></pre>\n\n<p>However for some reason ghc is not happy:</p>\n\n<pre><code>* Couldn't match type `[Char]' with `IO (IO b)'\n  Expected type: String -&gt; IO b\n    Actual type: IO (IO b) -&gt; IO b\n* In the second argument of `(&gt;&gt;=)', namely `unsafePerformIO'\n  In the expression: getContents &gt;&gt;= unsafePerformIO\n</code></pre>\n\n<p>Another thing I tried: this works without a problem;</p>\n\n<pre><code>main = getContents &gt;&gt;= putStrLn\n</code></pre>\n\n<p>Even though the type returned by getContents is an IO action and not the per se String that putStrLn wants</p>\n\n<pre><code>getContents :: IO String\nputStrLn    :: String -&gt; IO ()\n</code></pre>\n\n<p>Somehow the action is magically executed and the resulting string is passed into the put function.</p>\n\n<p>But then when I try to add something in, like simply appending \" hello\" to the input before printing it:</p>\n\n<pre><code>main = getContents &gt;&gt;= (++ \" hello\") &gt;&gt;= putStrLn\n</code></pre>\n\n<p>I suddenly get a type mismatch:</p>\n\n<pre><code>Couldn't match type `[]' with `IO'\n  Expected type: String -&gt; IO Char\n    Actual type: [Char] -&gt; [Char]\n* In the second argument of `(&gt;&gt;=)', namely `(++ \" hello\")'\n  In the first argument of `(&gt;&gt;=)', namely\n    `getContents &gt;&gt;= (++ \" hello\")'\n  In the expression: getContents &gt;&gt;= (++ \" hello\") &gt;&gt;= putStrLn\n</code></pre>\n\n<p>Somehow the IO action isn't executed anymore(or maybe I just don't understand this).</p>\n\n<p>I have also tried numerous things, with combinations of <code>getLine</code>, <code>readLn</code>, <code>getContents</code>, <code>unsafePerformIO</code>, <code>read</code>, <code>fmap</code> to no avail.</p>\n\n<p>This is just a very basic example but it illustrates perfectly the problem that made me give up haskell several times now(and probably I'm not the only one), although the stubbornness of wanting to get my head around it, and learn what is pretty much THE functional programming language keeps me coming back.</p>\n\n<p>To conclude:</p>\n\n<ol>\n<li><p>Is there something I'm not getting?(99% yes)</p></li>\n<li><p>If yes, then what?</p></li>\n<li><p>How should I go about reading the whole stdin and processing it all in one continuous expression?(If I need only 1 line, I guess whatever the solution is, it would also work with getLine sine it is basically the sister of getContents)</p></li>\n</ol>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["haskell", "replace"], "answers": [{"tags": [], "owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "is_accepted": true, "score": 7, "last_activity_date": 1509824293, "creation_date": 1509824293, "answer_id": 47114817, "question_id": 47114615, "link": "https://stackoverflow.com/questions/47114615/how-do-you-apply-multiple-cases-in-a-replace-in-haskell/47114817#47114817", "title": "How do you apply multiple cases in a replace in Haskell?", "body": "<p>One of the most powerful functions for dealing with lists is <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:concatMap\" rel=\"noreferrer\"><code>concatMap</code></a> (a.k.a. <code>&gt;&gt;=</code>). You can write your <code>clean</code> function like so:</p>\n\n<pre><code>clean :: String -&gt; String\nclean = concatMap (\\c -&gt; if c == '-' then \" \" else [c | isLetter c])\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 437, "user_id": 5299034, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10203272588494957/picture?type=large", "display_name": "BrainFRZ", "link": "https://stackoverflow.com/users/5299034/brainfrz"}, "edited": false, "score": 0, "creation_date": 1509826673, "post_id": 47114912, "comment_id": 81180141, "body": "Thanks for this! I&#39;ve not run across <code>bool</code> before. It looks like it&#39;s basically an if-else?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 437, "user_id": 5299034, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10203272588494957/picture?type=large", "display_name": "BrainFRZ", "link": "https://stackoverflow.com/users/5299034/brainfrz"}, "edited": false, "score": 2, "creation_date": 1509826876, "post_id": 47114912, "comment_id": 81180201, "body": "@BrainFRZ: it is a <i>catamorphism</i> of <code>Bool</code>, but for a boolean, this indeed acts like an <code>if-then-else</code>, with <code>bool &lt;res-if-false&gt; &lt;res-if-true&gt; &lt;condition&gt;</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 4, "last_activity_date": 1509825459, "last_edit_date": 1509825459, "creation_date": 1509824863, "answer_id": 47114912, "question_id": 47114615, "link": "https://stackoverflow.com/questions/47114615/how-do-you-apply-multiple-cases-in-a-replace-in-haskell/47114912#47114912", "title": "How do you apply multiple cases in a replace in Haskell?", "body": "<p>There are two things here:</p>\n\n<ol>\n<li>you need to remove everything that is not a letter or hyphen; and</li>\n<li>next we replace hyphens with spaces.</li>\n</ol>\n\n<p>So we can do this with a pipeline with <code>filter</code> and <code>replace</code>:</p>\n\n<pre><code>  import Data.Bool(bool)\n  import Data.Char(isLetter)\n\n   map (\\x -&gt; bool ' ' x (x /= '-')) . filter (\\x -&gt; isLetter x || x == '-')\n-- \\____________ __________________/   \\______________ ____________________/\n--              v                                     v\n--             (2)                                   (1)\n</code></pre>\n\n<p>We can use list comprehension to do the mapping and filtering like:</p>\n\n<pre><code>import Data.Bool(bool)\nimport Data.Char(isLetter)\n\nclean l = [bool ' ' x (x /= '-') | x &lt;- l, isLetter x || x == '-']\n</code></pre>\n\n<p>We can also use a single function, and perform for instance a <code>concatMap</code>:</p>\n\n<pre><code>import Data.Bool(bool)\nimport Data.Char(isLetter)\n\nconcatMap (\\x -&gt; bool (bool \"\" \" \" (x == '-')) [x] (isLetter x))\n</code></pre>\n\n<p>So here we concatenate the mapping of <code>x</code> to <code>\"\"</code> in case <code>x</code> is not a letter and the hyphen, or the empty string in case it is not a letter nor the hyphen, or <code>[x]</code> (so a 1-char string) in case <code>x</code> is a a letter.</p>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 2, "last_activity_date": 1509903709, "last_edit_date": 1509903709, "creation_date": 1509880430, "answer_id": 47120905, "question_id": 47114615, "link": "https://stackoverflow.com/questions/47114615/how-do-you-apply-multiple-cases-in-a-replace-in-haskell/47120905#47120905", "title": "How do you apply multiple cases in a replace in Haskell?", "body": "<p>This is a very good use case for <code>do</code> notation in the list monad.</p>\n\n<pre><code>clean :: String -&gt; String\nclean string = do\n  character &lt;- string         -- For each character in the string...\n  case character of\n    '-'            -&gt; \" \"     -- If it\u2019s a dash, replace with a space.\n    c | isLetter c -&gt; pure c  -- If it\u2019s a letter, return it.\n    _              -&gt; []      -- Otherwise, discard it.\n</code></pre>\n\n<p>This is ultimately simple syntactic sugar for <code>concatMap</code>. <code>pure c</code> can also be written <code>[c]</code> if you prefer; and less importantly, <code>\" \"</code> can be written <code>pure ' '</code> or <code>[' ']</code>. And as an alternative, you may find this more readable with the <code>MultiWayIf</code> extension:</p>\n\n<pre><code>if\n  | character == '-'   -&gt; \" \"\n  | isLetter character -&gt; pure character\n  | otherwise          -&gt; []\n</code></pre>\n\n<p>Finally, note that <code>isLetter</code> returns true for all Unicode letters. If you only care about ASCII, you may want to use <code>isAscii c &amp;&amp; isLetter c</code>, or <code>isAsciiUpper c || isAsciiLower c</code>.</p>\n"}], "owner": {"reputation": 437, "user_id": 5299034, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10203272588494957/picture?type=large", "display_name": "BrainFRZ", "link": "https://stackoverflow.com/users/5299034/brainfrz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 583, "favorite_count": 0, "accepted_answer_id": 47114817, "answer_count": 3, "score": 3, "last_activity_date": 1509903709, "creation_date": 1509823023, "question_id": 47114615, "link": "https://stackoverflow.com/questions/47114615/how-do-you-apply-multiple-cases-in-a-replace-in-haskell", "title": "How do you apply multiple cases in a replace in Haskell?", "body": "<p>I wrote a function to be able to clean word numbers for processing in Haskell. It needs to be able to change <code>-</code> into spaces (i.e. forty-five becomes forty five) and delete every other non-letter. I can define it recursively, but I'd really like to do something cleaner.</p>\n\n<pre><code>clean :: String -&gt; String\nclean \"\" = \"\"\nclean ('-':cs) = ' ' : clean cs\nclean (c:cs)\n    | isLetter c  = c : clean cs\n    | otherwise   = clean cs\n</code></pre>\n\n<p>This led me to defining a custom filter and defining a replace from <a href=\"https://hackage.haskell.org/package/MissingH-1.4.0.1/docs/Data-List-Utils.html\" rel=\"nofollow noreferrer\">Data.List.Split</a> based on a comment to <a href=\"https://stackoverflow.com/a/14908602/5299034\">this answer</a>, since I'm already using Data.List.Split.</p>\n\n<pre><code>clean :: String -&gt; String\nclean = filter (\\c -&gt; isLetter c || c == ' ') . replace \"-\" \" \" . filter (/= ' ')\n  where\n    replace :: String -&gt; String -&gt; String -&gt; String\n    replace old new = intercalate new . splitOn old\n</code></pre>\n\n<p>This version is even messier as a whole. Also, this version doesn't remove spaces in the original string. Is a different convention or something built-in that would allow me to do this with use a clean one-liner?</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509819824, "post_id": 47114004, "comment_id": 81177925, "body": "This is <b>not</b> ghc specific, it is a restriction that Haskell has."}, {"owner": {"reputation": 3085, "user_id": 4040600, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/B4ER6.png?s=128&g=1", "display_name": "&#201;amonn Olive", "link": "https://stackoverflow.com/users/4040600/%c3%89amonn-olive"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509819862, "post_id": 47114004, "comment_id": 81177939, "body": "@WillemVanOnsem Good to know, I wasn&#39;t able to check any other compilers, I&#39;ll update the question to reflect that."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1509822619, "post_id": 47114004, "comment_id": 81178871, "body": "Also, note that it says the <i>equations</i> have different number of arguments not the &quot;<i>functions</i>&quot;."}], "owner": {"reputation": 3085, "user_id": 4040600, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/B4ER6.png?s=128&g=1", "display_name": "&#201;amonn Olive", "link": "https://stackoverflow.com/users/4040600/%c3%89amonn-olive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "closed_date": 1509820093, "answer_count": 0, "score": 1, "last_activity_date": 1509819908, "creation_date": 1509819545, "last_edit_date": 1509819908, "question_id": 47114004, "link": "https://stackoverflow.com/questions/47114004/why-does-haskell-forbid-functions-with-different-numbers-of-arguments", "closed_reason": "Duplicate", "title": "Why does Haskell forbid functions with &quot;different numbers of arguments&quot;", "body": "<p>I was playing around in Haskell and I wrote the following code </p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>d::Integer-&gt;Integer\nd 4=7\nd=(*2)\n</code></pre>\n\n<p><a href=\"https://tio.run/##y0gszk7Nyfn/P8XKyjOvJDU9tUjXDsrgSlEwsTXnSrHV0DLS/J@bmJlnW1CUmVeikptYoJASbainZ2wQ@x8A\" rel=\"nofollow noreferrer\" title=\"Haskell \u2013 Try It Online\">Try it online!</a></p>\n\n<p>In my mind this should return 7 when the input is 4 and twice the input otherwise.  However a bit to my surprise this doesn't even compile, it gives the error in GHC:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Equations for \u2018d\u2019 have different numbers of arguments\n</code></pre>\n\n<p>Now in some ways the compiler is correct, the two definitions of <code>d</code> do have different numbers of arguments, however they do both take one argument (The first requires it be both <code>Eq</code> and <code>Num</code>, while the second only requires <code>Num</code>) and produce a member of the <code>Num</code> type class.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code> \u2699 &gt; ~/projects &gt; ghci\nGHCi, version 8.2.1: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; f 4=7\nPrelude&gt; :t f\nf :: (Eq a, Num a, Num p) =&gt; a -&gt; p\nPrelude&gt; g=(*2)\nPrelude&gt; :t g\ng :: Num a =&gt; a -&gt; a\nPrelude&gt;\n</code></pre>\n\n<p>In principle I see no reason why the compiler shouldn't allow this.</p>\n\n<p>Why does the compiler give an error here?  What is the benefit/design philosophy of doing so?</p>\n\n<hr>\n\n<p>This is not a debugging question, I know the issue and I know how to fix it, here is a working version of the code as proof.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>d::Integer-&gt;Integer\nd 4=7\nd x=x*2\n</code></pre>\n\n<p><a href=\"https://tio.run/##y0gszk7Nyfn/P8XKyjOvJDU9tUjXDsrgSlEwsTUHkhW2FVpG/3MTM/NsC4oy80pUchMLFFKiDfX0jA1i/wMA\" rel=\"nofollow noreferrer\" title=\"Haskell \u2013 Try It Online\">Try it online!</a></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1509804875, "post_id": 47111642, "comment_id": 81173181, "body": "I think this is simply some comment by the author that you should implement the <code>STM</code> etc yourself. the <code>abstract</code> parts are in comment."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 6, "creation_date": 1509806629, "post_id": 47111642, "comment_id": 81173689, "body": "@WillemVanOnsem that you <i>should</i> implement them yourself? I doubt it. If anything, I&#39;d reckon it means you <i>can&#39;t</i> implement them yourself, without access to built-in magic. Concretely, it&#39;s just saying that, just because no constructors are given in the source, the reader should not think that these types are uninhabited."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1509809713, "post_id": 47111642, "comment_id": 81174605, "body": "@leftaroundabout And I have yet a third opinion. It may be the case that <code>STM</code> and <code>TVar</code> can&#39;t be implemented without built-in magic, but that&#39;s not what &quot;abstract&quot; means. <code>Map</code> is abstract, too, but implemented in pure Haskell."}, {"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1509809951, "post_id": 47111642, "comment_id": 81174688, "body": "When you say &quot;built-in magic,&quot; what does that mean - using C library, code that&#39;s quite difficult to get right, etc?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1509816010, "post_id": 47111642, "comment_id": 81176626, "body": "@KevinMeredith I mean types like <code>IO</code> \u2013 in GHC, this is implemented as a state monad over <a href=\"http://hackage.haskell.org/package/ghc-prim-0.5.1.0/docs/GHC-Prim.html#t:RealWorld\" rel=\"nofollow noreferrer\"><code>RealWorld</code></a>, and that&#39;s what the documentation calls \u201cdeeply magical\u201d. I.e. you literally couldn&#39;t implement this type if the <code>base</code> library didn&#39;t already supply it. (Although you can implement <a href=\"https://hackage.haskell.org/package/pure-io-0.2.0/docs/PureIO.html#g:2\" rel=\"nofollow noreferrer\">something that mimicks the interface of <code>IO</code></a>.)"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 9, "last_activity_date": 1509808624, "creation_date": 1509808624, "answer_id": 47112211, "question_id": 47111642, "link": "https://stackoverflow.com/questions/47111642/understanding-abstract-types/47112211#47112211", "title": "Understanding Abstract Types", "body": "<p>An abstract data type is one which does not expose its implementation; only the type and some operations producing and consuming that type are provided, but the constructors themselves are not available for your use. </p>\n\n<p>This is usually done for one or both of these reasons:</p>\n\n<ol>\n<li>There is some invariant about which values of that type are valid which the type system is not up to guaranteeing, and which must be guaranteed instead by careful programming. If each operation offered preserves them, then only the library author need be careful and users of the library may be carefree.</li>\n<li>The representation of the data may be in flux. If the type is abstract, then future versions of the library can freely change how the type is implemented without fear of breaking existing programs, so long as the new representation can still support the existing construction and destruction operations.</li>\n</ol>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 47112211, "answer_count": 1, "score": 2, "last_activity_date": 1509808624, "creation_date": 1509804745, "question_id": 47111642, "link": "https://stackoverflow.com/questions/47111642/understanding-abstract-types", "title": "Understanding Abstract Types", "body": "<p>Looking at <a href=\"http://chimera.labs.oreilly.com/books/1230000000929/ch10.html\" rel=\"nofollow noreferrer\">Parallel and Concurrent Programming in Haskell</a>, I see:</p>\n\n<pre><code>data STM a -- abstract\ninstance Monad STM -- among other things\n\natomically :: STM a -&gt; IO a\n\ndata TVar a -- abstract\nnewTVar   :: a -&gt; STM (TVar a)\nreadTVar  :: TVar a -&gt; STM a\nwriteTVar :: TVar a -&gt; a -&gt; STM ()\n</code></pre>\n\n<p>What's the meaning of the <code>abstract</code> in <code>STM</code> and <code>TVar</code>?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": true, "score": 11, "last_activity_date": 1509800042, "creation_date": 1509800042, "answer_id": 47110956, "question_id": 47110907, "link": "https://stackoverflow.com/questions/47110907/what-should-i-do-if-two-modules-share-the-same-name/47110956#47110956", "title": "What should I do if two modules share the same name?", "body": "<p>You can use the <code>PackageImports</code> language pragma and explicitly pick the package you mean in your import statement like so:</p>\n\n<pre><code>import \"cryptonite\" Crypto.Random\n</code></pre>\n\n<p>Alternatively if you have both installed but are only using one of them, you could explicitly list the dependencies you use in a <code>cabal</code> file and build via <code>cabal</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1029, "user_id": 668074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f82d3dd033cd691ad5340b9620bdcf38?s=128&d=identicon&r=PG", "display_name": "user668074", "link": "https://stackoverflow.com/users/668074/user668074"}, "edited": false, "score": 1, "creation_date": 1509805791, "post_id": 47111418, "comment_id": 81173412, "body": "Good to know. I accepted the other answer that suggests using the <code>PackageImports</code> language extension because it fixes my issue very easily. But your suggestion also seems like a nice solution."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 12, "last_activity_date": 1509813046, "last_edit_date": 1509813046, "creation_date": 1509803112, "answer_id": 47111418, "question_id": 47110907, "link": "https://stackoverflow.com/questions/47110907/what-should-i-do-if-two-modules-share-the-same-name/47111418#47111418", "title": "What should I do if two modules share the same name?", "body": "<p>If you happen to be using <strong>ghc >= 8.2</strong> and <strong>cabal-install >= 2.0</strong>, another option is renaming the conflicting modules in the <a href=\"http://blog.ezyang.com/2017/01/try-backpack-cabal-packages/\" rel=\"noreferrer\"><code>mixins</code></a> section of the cabal file:</p>\n\n<pre><code>  build-depends:       base &gt;=4.10 &amp;&amp; &lt;4.11,\n                       cryptonite &gt;= 0.24,\n                       crypto-api &gt;= 0.13.2\n  mixins:\n                       cryptonite (Crypto.Random as CryptoniteCrypto.Random),\n                       crypto-api (Crypto.Random as CryptoAPICrypto.Random)\n</code></pre>\n\n<p>You can then import the renamed modules:</p>\n\n<pre><code>module Main where\n\nimport CryptoniteCrypto.Random\nimport CryptoAPICrypto.Random\n</code></pre>\n\n<p>One thing to take into account when renaming this way is that modules that haven't been explicitly renamed become inaccessible.</p>\n\n<p>In fact, ability to rename modules <a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html#pkg-field-library-reexported-modules\" rel=\"noreferrer\">seems to exist since <strong>GHC 7.10</strong></a>, through the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/packages.html#package-thinning-and-renaming\" rel=\"noreferrer\">-package</a> flag and the <strong>reexported-modules</strong> cabal section. <strong>reexported-modules</strong> works at declaration-time (when publishing a package) while <strong>mixins</strong> works at use-time (when depending on a package).</p>\n"}], "owner": {"reputation": 1029, "user_id": 668074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f82d3dd033cd691ad5340b9620bdcf38?s=128&d=identicon&r=PG", "display_name": "user668074", "link": "https://stackoverflow.com/users/668074/user668074"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1099, "favorite_count": 0, "accepted_answer_id": 47110956, "answer_count": 2, "score": 8, "last_activity_date": 1509813046, "creation_date": 1509799665, "question_id": 47110907, "link": "https://stackoverflow.com/questions/47110907/what-should-i-do-if-two-modules-share-the-same-name", "title": "What should I do if two modules share the same name?", "body": "<p>I have two packages that provide modules with the same name. When I try to load the module I get an error</p>\n\n<blockquote>\n  <p>Ambiguous interface for ....: It was found in multiple packages.</p>\n</blockquote>\n\n<p>What should I do to resolve this?</p>\n\n<p>To be specific, both the <code>cryptonite</code> package and <code>crypto-api</code> package provide modules with the name <code>Crypto.Random</code>. How can I specify which package I want to load the module from?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509794621, "post_id": 47110148, "comment_id": 81170444, "body": "Did you mix up tabs and/or spaces? The posted function works fine, so my guess is that the indentation is incorrect."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509794835, "post_id": 47110148, "comment_id": 81170491, "body": "Well as said, it compiles fine here. So you probably did not copy your function verbatim, or it has to do something with other code in the file."}, {"owner": {"reputation": 11, "user_id": 8885075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf17d174fa881b57a1925bbbdfe1dafa?s=128&d=identicon&r=PG&f=1", "display_name": "Javi Ortiz", "link": "https://stackoverflow.com/users/8885075/javi-ortiz"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509794917, "post_id": 47110148, "comment_id": 81170508, "body": "Yeah, was that, i mix tabs and spaces, arrrrggg, Thank you very much! :)"}], "owner": {"reputation": 11, "user_id": 8885075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf17d174fa881b57a1925bbbdfe1dafa?s=128&d=identicon&r=PG&f=1", "display_name": "Javi Ortiz", "link": "https://stackoverflow.com/users/8885075/javi-ortiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "closed_date": 1509799637, "answer_count": 0, "score": 1, "last_activity_date": 1509794760, "creation_date": 1509794411, "last_edit_date": 1509794760, "question_id": 47110148, "link": "https://stackoverflow.com/questions/47110148/parse-error-in-where-haskell", "closed_reason": "Duplicate", "title": "Parse error in where. Haskell", "body": "<p>i'm having an error in this piece of code </p>\n\n<pre><code>raices :: Double -&gt; Double -&gt; Double -&gt; [Double]\nraices a b c = [(-b+d)/t,(-b-d)/t]\n    where d = sqrt (b^2 - 4*a*c)\n          t = 2*a\n</code></pre>\n\n<p>This is the ERROR that ghci give to me</p>\n\n<pre><code>parse error on input \u2018=\u2019  \nPerhaps you need a 'let' in a 'do' block?  \ne.g. 'let x = 5' instead of 'x = 5'\n   |\n174|                   t = 2*a\n   |                     ^\n</code></pre>\n\n<p>Thanks in advance StackOverflow programmers :D!</p>\n"}, {"tags": ["haskell", "concurrency", "channel"], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 4, "last_activity_date": 1509785980, "last_edit_date": 1592644375, "creation_date": 1509785980, "answer_id": 47109118, "question_id": 47108943, "link": "https://stackoverflow.com/questions/47108943/haskell-concurrent-channel-what-is-difference-between-this-two-codes/47109118#47109118", "title": "Haskell Concurrent.Channel: What is difference between this two codes?", "body": "<p><a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Control-Concurrent.html#g:12\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/base-4.10.0.0/docs/Control-Concurrent.html#g:12</a>:</p>\n<blockquote>\n<p>In a standalone GHC program, only the main thread is required to terminate in order for the process to terminate. Thus all other forked threads will simply terminate at the same time as the main thread (the terminology for this kind of behaviour is &quot;daemonic threads&quot;).</p>\n<p>If you want the program to wait for child threads to finish before exiting, you need to program this yourself.</p>\n</blockquote>\n<p><a href=\"http://chimera.labs.oreilly.com/books/1230000000929/ch07.html#sec_reminders\" rel=\"nofollow noreferrer\">http://chimera.labs.oreilly.com/books/1230000000929/ch07.html#sec_reminders</a>:</p>\n<blockquote>\n<p>[...] This tells us something important about how threads work in Haskell: <em>the program terminates when <code>main</code> returns, even if there are other threads still running</em>. The other threads simply stop running and cease to exist after <code>main</code> returns.</p>\n</blockquote>\n"}], "owner": {"reputation": 65, "user_id": 8884562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93ba315ad9bf03983bed74641956b706?s=128&d=identicon&r=PG&f=1", "display_name": "oky", "link": "https://stackoverflow.com/users/8884562/oky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 47109118, "answer_count": 1, "score": 3, "last_activity_date": 1509785980, "creation_date": 1509784499, "question_id": 47108943, "link": "https://stackoverflow.com/questions/47108943/haskell-concurrent-channel-what-is-difference-between-this-two-codes", "title": "Haskell Concurrent.Channel: What is difference between this two codes?", "body": "<p>Why this code</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Control.Monad\nimport Control.Concurrent\nimport Control.Concurrent.STM\nimport Control.Concurrent.STM.TChan\n\nmain = do\n  ch &lt;- newTChanIO\n  forkIO $ consumer ch 0\n  forkIO $ consumer ch 1\n  ----------------------\n  forkIO $ producer ch\n  ----------------------\n  return ()\n\n\nproducer ch = loop 0\n  where\n    loop n = do\n      atomically $ writeTChan ch n\n      threadDelay (10^5 :: Int)\n      loop (n+1)\n\n\nconsumer ch n = forever $ do\n  v &lt;- atomically $ readTChan ch\n  print (n, v)\n</code></pre>\n\n<p>doesn't behave the same way as</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Control.Monad\nimport Control.Concurrent\nimport Control.Concurrent.STM\nimport Control.Concurrent.STM.TChan\n\nmain = do\n  ch &lt;- newTChanIO\n  forkIO $ consumer ch 0\n  forkIO $ consumer ch 1\n  ----------------------\n  producer ch\n  ----------------------\n  return ()\n\n\nproducer ch = loop 0\n  where\n    loop n = do\n      atomically $ writeTChan ch n\n      threadDelay (10^5 :: Int)\n      loop (n+1)\n\n\nconsumer ch n = forever $ do\n  v &lt;- atomically $ readTChan ch\n  print (n, v)\n</code></pre>\n\n<p>The latter code's output is</p>\n\n<pre><code>(0,0)\n(1,1)\n(1,2)\n(1,3)\n(1,4)\n(0,5)\n(0,6)\n(1,7)\n...\n</code></pre>\n\n<p>But, the former one's output is only</p>\n\n<pre><code>(0,0)\n</code></pre>\n\n<p>I intended that <code>producer</code> indefinitely add a value to the channel queue <code>ch</code>, and <code>consumer</code> indefinitely take a value from <code>ch</code>.</p>\n\n<p>The latter code acts as well as my intension, but the former one doesn't.</p>\n\n<p>In the eventlog (ghc-events), block happens on an MVar in <code>producer</code> thread </p>\n\n<pre><code>4775372: cap 0: stopping thread 8 (blocked on an MVar)\n</code></pre>\n\n<p>Why the former code (forkIO $ producer ch) doesn't indefinitely run.</p>\n"}, {"tags": ["haskell", "concurrency", "synchronization"], "answers": [{"comments": [{"owner": {"reputation": 91978, "user_id": 387076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/cFyP6.jpg?s=128&g=1", "display_name": "Gilles &#39;SO- stop being evil&#39;", "link": "https://stackoverflow.com/users/387076/gilles-so-stop-being-evil"}, "edited": false, "score": 3, "creation_date": 1509757797, "post_id": 47106263, "comment_id": 81163322, "body": "Thanks for finding the duplicate question! Please don&#39;t answer duplicate questions, instead <a href=\"https://stackoverflow.com/help/privileges/flag-posts\">flag</a> the question and enter the duplicate link. If others agree, the question will be marked as a duplicate."}, {"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "reply_to_user": {"reputation": 91978, "user_id": 387076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/cFyP6.jpg?s=128&g=1", "display_name": "Gilles &#39;SO- stop being evil&#39;", "link": "https://stackoverflow.com/users/387076/gilles-so-stop-being-evil"}, "edited": false, "score": 0, "creation_date": 1509760655, "post_id": 47106263, "comment_id": 81163745, "body": "Ah, OK. I wanted to comment but couldn&#39;t yet, and I wasn&#39;t sure about the flag because it doesn&#39;t seem to highlight you can add extra info, just that it calls a moderator, sounds a bit scary."}], "tags": [], "owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "is_accepted": false, "score": 0, "last_activity_date": 1509756719, "creation_date": 1509756719, "answer_id": 47106263, "question_id": 47106154, "link": "https://stackoverflow.com/questions/47106154/haskell-async-with-blocking-print/47106263#47106263", "title": "Haskell async with blocking print", "body": "<p>Looks like a dupe of <a href=\"https://stackoverflow.com/a/44916224/8737306\">this</a> question - the linked code:</p>\n\n<pre><code>do mutex &lt;- newMVar ()\n   let putStrLn' = withMVar mutex . const . putStrLn \n   mapConcurrently_ (iofunPrintingWith putStrLn') folderList\n</code></pre>\n"}], "owner": {"reputation": 9182, "user_id": 219449, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/70faf49f616436be935cb8b9512f7673?s=128&d=identicon&r=PG", "display_name": "Leonti", "link": "https://stackoverflow.com/users/219449/leonti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "closed_date": 1509760540, "answer_count": 1, "score": 1, "last_activity_date": 1509757832, "creation_date": 1509755707, "last_edit_date": 1509757832, "question_id": 47106154, "link": "https://stackoverflow.com/questions/47106154/haskell-async-with-blocking-print", "closed_reason": "Duplicate", "title": "Haskell async with blocking print", "body": "<p>I have a list of IO actions that I want to be executed concurrently, so I'm using <code>mapConcurrently</code> from <a href=\"https://hackage.haskell.org/package/async-pool\" rel=\"nofollow noreferrer\"><code>async</code></a> package.<br>\nMy IO actions include <code>print</code> expressions, for example:  </p>\n\n<pre><code>processLink :: String -&gt; IO ()\nprocessLink link = do\nresult &lt;- fetchLink\nprint $ \"Link \" ++ link ++ \"has been processed\"\n</code></pre>\n\n<p>In my <code>main</code> I have something like:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  _ &lt;- mapConcurrently (processLink) links\n  print \"Done!\"\n</code></pre>\n\n<p>Everything is executed beautifully in parallel, but it seems like <code>print</code> is also executed in parallel character-by-character so I get garbage in the output.<br>\nI think I understand why it's happening - <code>print</code> outputs one character at a time, so when it's executed from multiple threads all output is interleaved.  </p>\n\n<p>What would be a typical way to solve it?  </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 3, "creation_date": 1509754679, "post_id": 47106058, "comment_id": 81162758, "body": "&quot;My understanding is that a forall is implied for all variables at the begin of all functions even if it is not declared.&quot; That&#39;s correct, but the <code>forall</code> in your example is not at the beginning of the type, it&#39;s in the middle."}, {"owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1509754863, "post_id": 47106058, "comment_id": 81162807, "body": "What would the type for k be in withModulus\u2082? I understand it to be: <code>(forall s. Modulus s a -&gt; w)</code>"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1509755001, "post_id": 47106058, "comment_id": 81162830, "body": "It&#39;d be <code>k :: Modulus s a -&gt; w</code>, where the <code>s</code>, <code>a</code>, and <code>w</code> are <i>rigid type variables</i> (technical term) bound by the (implicit) <code>forall</code> in <code>withModulus2</code>&#39;s type. That&#39;s a different type than <code>k :: forall s a w. Modulus s a -&gt; w</code>."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1509755165, "post_id": 47106058, "comment_id": 81162866, "body": "Think of it as being a bit like a variable being mentioned in the body of a lambda which comes from the closure (eg the <code>x</code> in <code>\\f -&gt; f x</code>). The caller of the lambda gets to choose the value of the lambda&#39;s parameter, but not the values of variables in the closure. In this analogy <code>forall</code> is like lambda - when <code>withModulus2</code> calls <code>k</code>, it doesn&#39;t get to choose how to instantiate <code>s</code> because it come&#39;s from <code>k</code>&#39;s type&#39;s &quot;closure&quot;, if you will."}, {"owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1509755469, "post_id": 47106058, "comment_id": 81162918, "body": "Ok I can see your point with the closure but why would that make <code>withModulus\u2081</code> not compile?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1509755628, "post_id": 47106058, "comment_id": 81162954, "body": "Forgive me, I thought you said <code>withModulus1</code> was the version that did work?"}, {"owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1509755767, "post_id": 47106058, "comment_id": 81162977, "body": "Sorry I updated the question. It is <code>withModulus\u2081</code> that causes the compile to fail when called by <code>test\u2081</code>."}, {"owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1509755823, "post_id": 47106058, "comment_id": 81162991, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/158202/discussion-between-vanson-samuel-and-benjamin-hodgson\">continue this discussion in chat</a>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1509757812, "post_id": 47106058, "comment_id": 81163327, "body": "Consider the following much simpler function: <code>foo :: a -&gt; b -&gt; a; foo a b = head [a,b]</code>. I hope it is obvious why this function will produce a type error if you try to compile it; <code>test1</code> fails to compile for the exact same reason. In the context in which a type variable is bound, the type variable cannot unify with any other types (including with other type variables) (except by pattern matching on a GADT, which isn&#39;t relevant here); this is what the compiler means by &#39;rigid&#39;."}, {"owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "edited": false, "score": 0, "creation_date": 1509758353, "post_id": 47106058, "comment_id": 81163415, "body": "<code>forall s.</code> matches all types and can only have \u22a5 in common so it&#39;s the same type, not s and s1 like GHC is reporting."}, {"owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "edited": false, "score": 0, "creation_date": 1509760217, "post_id": 47106058, "comment_id": 81163689, "body": "Obviously my previous comment is wrong. I just don&#39;t understand why."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1509762175, "post_id": 47106058, "comment_id": 81163997, "body": "<a href=\"https://gist.github.com/roboguy13/9fabafa92c8e85501034139687faffb7\" rel=\"nofollow noreferrer\">Here&#39;s another smaller example</a>. The <code>rank2</code> function gets to pick the type of <code>a</code>, since the function that it gets (<code>f</code>) must work <i>for all</i> choices of <code>a</code>. This is the case for <code>exampleA</code>, but not <code>exampleB</code>. You can also add an explicit <code>forall</code> to <code>exampleA</code>&#39;s type to maybe make this more clear how this lines up (though this would change nothing about <code>exampleA</code> or how it type checks)."}, {"owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1509763024, "post_id": 47106058, "comment_id": 81164115, "body": "@DavidYoung your gist make perfect sense to me but I don&#39;t see how it relates to my problem."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1509783925, "creation_date": 1509783925, "answer_id": 47108879, "question_id": 47106058, "link": "https://stackoverflow.com/questions/47106058/when-is-forall-not-for-all/47108879#47108879", "title": "When is forall not for all", "body": "<p>Briefly put, a function</p>\n\n<pre><code>foo :: forall s . T s -&gt; U s\n</code></pre>\n\n<p>lets its caller to choose what the type <code>s</code> is. Indeed, it works on all types <code>s</code>. By comparison,</p>\n\n<pre><code>bar :: (forall s . T s) -&gt; U\n</code></pre>\n\n<p>requires that its caller provides an argument <code>x :: forall s. T s</code>, i.e. a polymorphic value that will work on all types <code>s</code>. This means that <code>bar</code> will choose what the type <code>s</code> will be.</p>\n\n<p>For instance,</p>\n\n<pre><code>foo :: forall a. a -&gt; [a]\nfoo x = [x,x,x]\n</code></pre>\n\n<p>is obvious. Instead,</p>\n\n<pre><code>bar :: (forall a. a-&gt;a) -&gt; Bool\nbar x = x 12 &gt; length (x \"hello\")\n</code></pre>\n\n<p>is more subtle. Here, <code>bar</code> first uses <code>x</code> choosing <code>a ~ Int</code> for <code>x 12</code>, and then uses <code>x</code> again choosing <code>a ~ String</code> for <code>x \"hello\"</code>.</p>\n\n<p>Another example:</p>\n\n<pre><code>bar2 :: Int -&gt; (forall a. a-&gt;a) -&gt; Bool\nbar2 n x | n &gt; 10    = x 12 &gt; 5\n         | otherwise = length (x \"hello\") &gt; 7\n</code></pre>\n\n<p>Here <code>a</code> is chosen to be <code>Int</code> or <code>String</code> depending on <code>n &gt; 10</code>.</p>\n\n<p>Your own type</p>\n\n<pre><code>withModulus\u2081 :: a -&gt; (forall s. Modulus s a -&gt; w) -&gt; w\n</code></pre>\n\n<p>states that <code>withModulus\u2081</code> must be allowed to choose <code>s</code> to any type it wishes. When calling this as</p>\n\n<pre><code>withModulus\u2081 arg (\\m -&gt; ...)\n</code></pre>\n\n<p><code>m</code> will have type <code>Modulus s0 a</code> where <code>a</code> was chosen by the caller, while <code>s</code> was chosen by <code>withModulus\u2081</code> itself. It is required that <code>...</code> must be compatible with any choice <code>withModulus\u2081</code> may take.</p>\n\n<p>What if we nest calls?</p>\n\n<pre><code>withModulus\u2081 arg (\\m1 -&gt; ...\n   withModulus\u2081 arg (\\m2 -&gt; ...)\n   ...\n     )\n</code></pre>\n\n<p>Now, <code>m1 :: Modulus s0 a</code> as before. Further <code>m2 :: Modulus s1 a</code> where <code>s1</code> is chosen by the innermost call to <code>withModulus\u2081</code>.</p>\n\n<p>The crucial point, here, is that there is <strong>no</strong> guarantee that <code>s0</code> is chosen to be the same as <code>s1</code>. Each call might make a different choice: see e.g. <code>bar2</code> above which indeed does so.</p>\n\n<p>Hence, the compiler can not assume that <code>s0</code> and <code>s1</code> are equal. Hence, if we call a function that requires their equality, like <code>add</code>, we get a type error, since this would constrain the freedom of choice of <code>s</code> by the two <code>withModulus\u2081</code> calls.</p>\n"}], "owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 47108879, "answer_count": 1, "score": 2, "last_activity_date": 1509783925, "creation_date": 1509754608, "last_edit_date": 1509757423, "question_id": 47106058, "link": "https://stackoverflow.com/questions/47106058/when-is-forall-not-for-all", "title": "When is forall not for all", "body": "<p>In the program below <code>test\u2081</code> will not compile but <code>test\u2082</code> will.  The reason seems to be because of the <code>forall s.</code> in <code>withModulus\u2081</code>.  It seems that the <code>s</code> is a different type for each and every call to <code>withModulus\u2081</code> because of the <code>forall s.</code>. Why is that the case?</p>\n\n<pre><code>{-# LANGUAGE \n    GADTs\n  , KindSignatures\n  , RankNTypes\n  , TupleSections\n  , ViewPatterns #-}\n\nmodule Main where\n\nimport Data.Reflection\n\nnewtype Modulus :: * -&gt; * -&gt; * where\n  Modulus :: a -&gt; Modulus s a\n  deriving (Eq, Show)\n\nnewtype M :: * -&gt; * -&gt; * where\n  M :: a -&gt; M s a\n  deriving (Eq, Show)\n\nadd :: Integral a =&gt; Modulus s a -&gt; M s a -&gt; M s a -&gt; M s a\nadd (Modulus m) (M a) (M b) = M (mod (a + b) m)\n\nmul :: Integral a =&gt; Modulus s a -&gt; M s a -&gt; M s a -&gt; M s a\nmul (Modulus m) (M a) (M b) = M (mod (a * b) m)\n\nunM :: M s a -&gt; a\nunM (M a) = a\n\nwithModulus\u2081 :: a -&gt; (forall s. Modulus s a -&gt; w) -&gt; w\nwithModulus\u2081 m k = k (Modulus m)\n\nwithModulus\u2082 :: a -&gt; (Modulus s a -&gt; w) -&gt; w\nwithModulus\u2082 m k = k (Modulus m)\n\ntest\u2081 = withModulus\u2081 89 (\\m -&gt;\n          withModulus\u2081 7 (\\m' -&gt;\n            let\n              a = M 131\n              b = M 127\n            in\n              unM $ add m' (mul m a a) (mul m b b)))\n\ntest\u2082 = withModulus\u2082 89 (\\m -&gt;\n          withModulus\u2082 7 (\\m' -&gt;\n            let\n              a = M 131\n              b = M 127\n            in\n              unM $ add m' (mul m a a) (mul m b b)))\n</code></pre>\n\n<p>Here is the error message:</p>\n\n<pre><code>Modulus.hs:41:29: error:\n    \u2022 Couldn't match type \u2018s\u2019 with \u2018s1\u2019\n      \u2018s\u2019 is a rigid type variable bound by\n        a type expected by the context:\n          forall s. Modulus s Integer -&gt; Integer\n        at app/Modulus.hs:(35,9)-(41,52)\n      \u2018s1\u2019 is a rigid type variable bound by\n        a type expected by the context:\n          forall s1. Modulus s1 Integer -&gt; Integer\n        at app/Modulus.hs:(36,11)-(41,51)\n      Expected type: M s1 Integer\n        Actual type: M s Integer\n    \u2022 In the second argument of \u2018add\u2019, namely \u2018(mul m a a)\u2019\n      In the second argument of \u2018($)\u2019, namely\n        \u2018add m' (mul m a a) (mul m b b)\u2019\n      In the expression: unM $ add m' (mul m a a) (mul m b b)\n    \u2022 Relevant bindings include\n        m' :: Modulus s1 Integer (bound at app/Modulus.hs:36:28)\n        m :: Modulus s Integer (bound at app/Modulus.hs:35:27)\n   |\n41 |               unM $ add m' (mul m a a) (mul m b b)))\n   |                             ^^^^^^^^^\n</code></pre>\n"}, {"tags": ["haskell", "serialization", "deserialization"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1509758121, "post_id": 47106015, "comment_id": 81163386, "body": "This question is a bit vague (unclear what kind of functions (and their types) you wish to have for such a map). It looks like you want a map from keys to values where the type of value can depend on the key (i.e. a <a href=\"https://hackage.haskell.org/package/dependent-map-0.2.4.0/docs/Data-Dependent-Map.html\" rel=\"nofollow noreferrer\">dependant map</a>); but unless you really need to guarantee your program doesn&#39;t error at runtime (which is somewhat futile if you&#39;re reading data over the internet anyways) this is probably overkill. What about <code>Map String Value</code> where <code>data Value = ValA A | ValB B | ValC C | .. </code>?"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 2961180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c945fcd20530878fd9b5bc6f03421e?s=128&d=identicon&r=PG", "display_name": "Samuel H.", "link": "https://stackoverflow.com/users/2961180/samuel-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1510090456, "creation_date": 1510090456, "answer_id": 47167802, "question_id": 47106015, "link": "https://stackoverflow.com/questions/47106015/strict-map-with-custom-reading-method-or-type-with-custom-read-instance/47167802#47167802", "title": "Strict map with custom reading method or type with custom read instance", "body": "<p>Both ways are very valid in their own respects, but since I was making an API to interact with such protocol too, I preferred the record syntax so I could cover all the properties more easily. Also I wasn't really going to do any checking or treatment in the getter functions, and no matter how boring making the reader instance for my type might have seemed, I bet doing all the get functions manually would be worse. Parsing stuff manually is inherently boring, I guess I was just looking for a magical funcional one liner to make all the work for me. </p>\n"}], "owner": {"reputation": 33, "user_id": 2961180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c945fcd20530878fd9b5bc6f03421e?s=128&d=identicon&r=PG", "display_name": "Samuel H.", "link": "https://stackoverflow.com/users/2961180/samuel-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510090456, "creation_date": 1509754139, "last_edit_date": 1509845540, "question_id": 47106015, "link": "https://stackoverflow.com/questions/47106015/strict-map-with-custom-reading-method-or-type-with-custom-read-instance", "title": "Strict map with custom reading method or type with custom read instance", "body": "<p>So, it is not a problem but I would want an opinion what would be a better way. So I need to read data from a outside source (TCP), that comes basically in this format:</p>\n\n<pre><code>key: value\nokey: enum\nstuff: 0.12240\namazin: 1020\n</code></pre>\n\n<p>And I need to parse it into a Haskell accessible format, so the two solutions I thought about, were either to, parse that into a strict String to String map, or record syntax type declarations.</p>\n\n<p>Initially I thought to make a type synonym for my String => String map, and make extractor functions like <code>amazin :: NiceSynonym -&gt; Int</code>, and do the necessary treatment and parsing within the method, but that felt like, <em>sketchy</em> at the time? Then I thought an actual type declaration with record syntax, with a custom Read instance. That was a nightmare, because there is a lot of enums and keys with different types and etc. And it felt... disappointing. It simply wraps the arguments and creates reader functions, not much different from the original: <code>amazin :: TypeDeclaration -&gt; Int</code>. </p>\n\n<p>Now I'm kind of regretting not going with reader functions as I initially envisioned. So, anything else I'm forgetting to consider? Any pros and cons of either sides to take note on? Is one objectively better then the other? </p>\n\n<p>P.S.: Some considerations that may make one or the other better:</p>\n\n<ul>\n<li>Once read I won't need to change it at all whatsoever, it's basically a status report</li>\n<li>No need to compare, add, etc., again just status report no point</li>\n<li>Not really a need for performance, I wont be reading hundreds a second  or anything</li>\n</ul>\n\n<p>TL;DR: Given that input example, what's the best way to make into a Haskell-readable format? map, data constructor, dependent map...</p>\n"}, {"tags": ["haskell", "io", "main"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 3, "creation_date": 1509743465, "post_id": 47104443, "comment_id": 81159453, "body": "Function calls in Haskell do not require parens around the arguments or commas between the arguments. Change <code>bmiTell( read weight ::Float, read height ::Float)</code> to <code>bmiTell (read weight :: Float) (read height :: Float)</code>."}, {"owner": {"reputation": 180, "user_id": 4062703, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e914a86d649e4f3c7f543398071d8?s=128&d=identicon&r=PG", "display_name": "tontus", "link": "https://stackoverflow.com/users/4062703/tontus"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1509743590, "post_id": 47104443, "comment_id": 81159503, "body": "Thanks, it works. Can you provide me any resource where I can learn more about Haskell  IO"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 3, "creation_date": 1509743739, "post_id": 47104443, "comment_id": 81159556, "body": "This problem doesn&#39;t have anything about it that is related to IO. I don&#39;t have any particular recommendations, but the <a href=\"https://stackoverflow.com/tags/haskell/info\">Haskell tag wiki</a> does have some information you may find useful."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 3, "last_activity_date": 1509752855, "creation_date": 1509752855, "answer_id": 47105870, "question_id": 47104443, "link": "https://stackoverflow.com/questions/47104443/main-function-input-for-realfloat-in-haskell/47105870#47105870", "title": "Main function input for RealFloat in haskell", "body": "<p>For simplicity, I will in the following discuss a <em>monomorphic version</em> of your function, i.e.</p>\n\n<pre><code>bmiTell :: Double -&gt; Double -&gt; String\n</code></pre>\n\n<p>(For a <code>RealFloat</code>, the type <code>Double</code> is <a href=\"https://wiki.haskell.org/Performance/Floating_point\" rel=\"nofollow noreferrer\">usually the only sensible choice</a>.)</p>\n\n<hr>\n\n<p>Your code would actually work if you had defined</p>\n\n<pre><code>bmiTell :: (Double, Double) -&gt; String  \nbmiTell(weight, height)\n  | ...\n</code></pre>\n\n<p>That would be the \u201cnormal way\u201d to define a multi-parameter function, as most other programming languages would do it. In this case <code>bmiTell (read weight, read height)</code> would work.</p>\n\n<p>You <em>can</em> do this in Haskell, however we prefer a different style that is in many ways equivalent but offers some nice advantages, though it is often confusing for beginners: we <a href=\"https://en.wikipedia.org/wiki/Currying\" rel=\"nofollow noreferrer\">Curry</a> most multi-parameter functions.</p>\n\n<p>It can be explained quite simply: instead of supplying both arguments <em>at once</em>, in a tuple, you supply first one argument, then the next. And so on. So, you have the function <code>bmiTell</code>. You give it the argument <code>w</code>, i.e. you write <code>bmiTell w</code>. Then you also give it the argument <code>h</code>, so you write <code>(bmiTell w) h</code>, where the parser allows us to omit the parentheses.</p>\n\n<p>The function has thus the signature <code>bmiTell :: Double -&gt; SOMETHING</code>, where <code>SOMETHING</code> must be able to accept another parameter... and only then give a string. So, in fact</p>\n\n<pre><code>bmiTell :: Double -&gt; (Double -&gt; String)\n</code></pre>\n\n<p>Here too, the parsing rules were deliberately chosen so we can actually just omit the parentheses.</p>\n\n<p>To use that function, you must, well \u2013 give both arguments one-by-one.</p>\n\n<pre><code>    bmiTell (read weight) (reight height)\n</code></pre>\n\n<p>In the whole program:</p>\n\n<pre><code>main :: IO ()\nmain = do\n    putStrLn \"What's your weight?\"  \n    weight &lt;- getLine  \n    putStrLn \"What's your height?\"  \n    height &lt;- getLine\n    print (bmiTell (read weight) (read height))\n</code></pre>\n\n<p>Actually we like to omit even more parentheses (we're not Lispers!), which can be done by using the handy no-op <code>$</code> operator:</p>\n\n<pre><code>    print $ bmiTell (read weight) (read height)\n</code></pre>\n"}], "owner": {"reputation": 180, "user_id": 4062703, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e914a86d649e4f3c7f543398071d8?s=128&d=identicon&r=PG", "display_name": "tontus", "link": "https://stackoverflow.com/users/4062703/tontus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 1, "accepted_answer_id": 47105870, "answer_count": 1, "score": 0, "last_activity_date": 1509752855, "creation_date": 1509743382, "question_id": 47104443, "link": "https://stackoverflow.com/questions/47104443/main-function-input-for-realfloat-in-haskell", "title": "Main function input for RealFloat in haskell", "body": "<p>I am trying to make a main function that takes 2 Realfloat input and pass through this function </p>\n\n<pre><code>bmiTell :: (RealFloat a) =&gt; a -&gt; a -&gt; String  \nbmiTell weight height  \n    | bmi &lt;= 18.5 = \"You're underweight\"\n    | bmi &lt;= 25.0 = \"You're normal\"\n    | bmi &lt;= 30.0 = \"You're overweight\"\n    | otherwise = \"You're obese\"\n    where bmi = weight / height ^ 2  \n</code></pre>\n\n<p>And my solution is, where I trying to get weight and height and pass it through the bmiTell funtion</p>\n\n<pre><code>main = do\n    putStrLn \"What's your weight?\"  \n    weight &lt;- getLine  \n    putStrLn \"What's your height?\"  \n    height &lt;- getLine\n    print (bmiTell( read weight ::Float, read height ::Float))\n</code></pre>\n\n<p>and this is giving this error </p>\n\n<pre><code>* No instance for (Show ((Float, Float) -&gt; String))\n        arising from a use of `print'\n        (maybe you haven't applied a function to enough arguments?)\n    * In a stmt of a 'do' block:\n        print (bmiTell (read weight :: Float, read height :: Float))\n      In the expression:\n        do putStrLn \"What's your weight?\"\n           weight &lt;- getLine\n           putStrLn \"What's your height?\"\n           height &lt;- getLine\n           ....\n      In an equation for `main':\n          main\n            = do putStrLn \"What's your weight?\"\n                 weight &lt;- getLine\n                 putStrLn \"What's your height?\"\n                 ....\n   |\n14 |     print (bmiTell( read weight ::Float, read height ::Float))\n   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\ngetbmi.hs:14:12: error:\n    * No instance for (RealFloat (Float, Float))\n        arising from a use of `bmiTell'\n    * In the first argument of `print', namely\n        `(bmiTell (read weight :: Float, read height :: Float))'\n      In a stmt of a 'do' block:\n        print (bmiTell (read weight :: Float, read height :: Float))\n      In the expression:\n        do putStrLn \"What's your weight?\"\n           weight &lt;- getLine\n           putStrLn \"What's your height?\"\n           height &lt;- getLine\n           ....\n   |\n14 |     print (bmiTell( read weight ::Float, read height ::Float))\n   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>I understand that RealFloat is Double or Float. Can anyone How to get input for RealFloat and pass it through a function. </p>\n"}, {"tags": ["haskell", "math", "functional-programming", "polynomial-math", "newtons-method"], "comments": [{"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 3, "creation_date": 1509740544, "post_id": 47103861, "comment_id": 81158171, "body": "how do you determine if it fails or not in other languages than haskell?"}, {"owner": {"reputation": 151, "user_id": 8622509, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/64ce0a9af573d9ec892fbd05278c43ec?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Buckley", "link": "https://stackoverflow.com/users/8622509/jack-buckley"}, "reply_to_user": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1509740850, "post_id": 47103861, "comment_id": 81158306, "body": "I know that if a polynomial has an odd degree, it will cross the x-axis. I am not sure how to tell if an even degreed polynomial will cross the x-axis. I can think of using the Intermediate Value Theorem but over which domain?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 5, "creation_date": 1509741245, "post_id": 47103861, "comment_id": 81158469, "body": "I&#39;m voting to close this question as off-topic because it&#39;s really about math rather than programming. You can try asking on math.stackexchange.com. If you have trouble implementing the answer, you can come back here."}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1509741258, "post_id": 47103861, "comment_id": 81158480, "body": "your answer shows you actually did not manage to handle the odd case either. Newton method requires a initial value to begin with, but how do you set the initial value? you are guaranteed to get a solution in odd case, but if there are many solutions, which one are you looking for?"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509829199, "post_id": 47104139, "comment_id": 81180953, "body": "How can you use this information to find appropriate initial values to get Newton&#39;s method to converge to each root?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509829639, "post_id": 47104139, "comment_id": 81181102, "body": "@dfeuer as I said, you start out with <i>intervals</i> (between the extrema) in which you know each root must lie. You then start Newton on the midpoint of each interval, but restricted so it can never leave the interval. What this means in practice is, whenever <i>x\u1d62</i> + <i>y\u1d62</i> / <i>x\u1d62&#39;</i> lies outside the interval, you instead do a simple bisection step to refine that interval, until the function is straight enough on the remaining interval so that Newton with its quadratic convergence kicks in."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 8, "last_activity_date": 1509742330, "last_edit_date": 1509742330, "creation_date": 1509741880, "answer_id": 47104139, "question_id": 47103861, "link": "https://stackoverflow.com/questions/47103861/how-to-know-when-newtons-method-will-fail-using-haskell/47104139#47104139", "title": "How to know when Newton&#39;s Method will fail using Haskell?", "body": "<p>To determine roughly where a polynomial of degree <em>N</em> has its roots \u2013 if any \u2013 it is sufficient to know all its extrema, because you must have exactly one root</p>\n\n<ul>\n<li>between any adjacent negative minimum and positive maximum</li>\n<li>to the left of the leftmost extremum, if it's a negative minimum or positive maximum</li>\n<li>to the right of the rightmost extremum, if it's a negative minimum or positive maximum</li>\n</ul>\n\n<p>The extrema are themselves roots of the derivative, which is conveniently a polynomial of degree <em>N</em>\u20131, so you can go down recursively until you get to the linear (or quadratic) case, where it's trivial to find the roots (exactly, in fact).</p>\n"}], "owner": {"reputation": 151, "user_id": 8622509, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/64ce0a9af573d9ec892fbd05278c43ec?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Buckley", "link": "https://stackoverflow.com/users/8622509/jack-buckley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1509742330, "creation_date": 1509740384, "last_edit_date": 1509740461, "question_id": 47103861, "link": "https://stackoverflow.com/questions/47103861/how-to-know-when-newtons-method-will-fail-using-haskell", "title": "How to know when Newton&#39;s Method will fail using Haskell?", "body": "<p>In Haskell, I am using the following function to find the root of a polynomial: </p>\n\n<pre><code>polyNewton :: (Fractional a, Ord a) =&gt; Poly a -&gt; a -&gt; a`\n\npolyNewton p s = if (abs(polyValue p s) &lt;= (0 + 1e-10)) then s else polyNewton \np (s - (polyValue p s) / (polyValue (polyDeriv p) s))\n</code></pre>\n\n<p>where polyValue is a function that finds the y-value of a polynomial p, an x-value x, and polyDeriv is a function that returns the derivative of a polynomial p.</p>\n\n<p>This code works quite well for the majority of cases, except where the polynomial does not have any actual roots (the function is above the x-axis) or if a bad initial guess is given. Is there anyway to determine if Newton's Method will fail beforehand so that my function does not run indefinitely?</p>\n"}, {"tags": ["list", "haskell", "recursion", "helper"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509741630, "post_id": 47103741, "comment_id": 81158647, "body": "That&#39;s going to be rather inefficient. Can you see why?"}, {"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509742154, "post_id": 47103741, "comment_id": 81158885, "body": "@dfeuer I suppose if you filtered first it would get rid of the extra memory being carried around and be a tad quicker, but it&#39;s tail recursive and just seems to be a standard recursive implementation of a sum function, am I missing something? I would personally implement it in a similar way to HuStmpHrrr&#39;s solution but I wanted to keep it a bit easier to understand."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509743187, "post_id": 47103741, "comment_id": 81159336, "body": "@dfeuer I can&#39;t see why. Perhaps you could say yourself?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509752627, "post_id": 47103741, "comment_id": 81162346, "body": "@DanielWagner, despite Zpalmtree&#39;s claim in the comment above, it&#39;s <i>not</i> tail recursive."}, {"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509756221, "post_id": 47103741, "comment_id": 81163060, "body": "@dfeuer Isn&#39;t tail recursion where the last statement is the function you&#39;re recursing on, so the stack frame is done with and can be reused?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509757509, "post_id": 47103741, "comment_id": 81163276, "body": "Indeed. Look at the <code>firstclass = True</code> case."}, {"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509760565, "post_id": 47103741, "comment_id": 81163736, "body": "@dfeuer Ah, my bad, I got confused on how it worked. I guess you would have to use an extra parameter to store the sum if you wanted it to be tail recursive. I just tested it out and even with -O3 it doesn&#39;t get optimized. I guess I should avoid recursion like this then, I often use it instead of foldr because I find it easier to read but I didn&#39;t realise it wasn&#39;t optimized"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509766295, "post_id": 47103741, "comment_id": 81164569, "body": "<code>foldr</code> won&#39;t (directly) help you here. You can use <code>foldl&#39;</code>, which is easy, or you can use <code>foldr</code> in a tricky higher-order way, in which the fold produces a <i>function</i> you apply to the result (<code>0</code> here) in the base case. Something like <code>foldr go id xs 0 where go x r !acc = ...</code>."}], "tags": [], "owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "is_accepted": true, "score": 1, "last_activity_date": 1509739779, "creation_date": 1509739779, "answer_id": 47103741, "question_id": 47103598, "link": "https://stackoverflow.com/questions/47103598/creating-a-program-that-accumulates-parts-of-a-list-haskell/47103741#47103741", "title": "Creating a program that accumulates parts of a list - Haskell", "body": "<p>If I'm understanding you correctly, you want the sum of the weights where the parcel is sent first class, this should do the trick:</p>\n\n<pre><code>totalWeightOfFirstClass :: [Parcel] -&gt; Weight\ntotalWeightOfFirstClass [] = 0\ntotalWeightOfFirstClass ((weight, postcode, firstclass):xs)\n    | firstclass = weight + totalWeightOfFirstClass xs\n    | otherwise = totalWeightOfFirstClass xs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1509741741, "post_id": 47103856, "comment_id": 81158705, "body": "You can break up the long chain using <code>let</code> or <code>where</code> to make this easier to read. At the very least, add some line breaks and comments!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509743114, "post_id": 47103856, "comment_id": 81159308, "body": "Just a few helper functions make a huge readability difference. After defining <code>weight (w,_,_) = w; firstclass (_,_,fc) = fc</code>, this becomes <code>sum . map weight . filter firstclass</code>."}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509744314, "post_id": 47103856, "comment_id": 81159752, "body": "@DanielWagner definitely. if it&#39;s a <code>data</code> type and is defined in a record syntax, those functions are free."}], "tags": [], "owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "is_accepted": false, "score": 2, "last_activity_date": 1509740367, "creation_date": 1509740367, "answer_id": 47103856, "question_id": 47103598, "link": "https://stackoverflow.com/questions/47103598/creating-a-program-that-accumulates-parts-of-a-list-haskell/47103856#47103856", "title": "Creating a program that accumulates parts of a list - Haskell", "body": "<p>That's too much work in your code. Try to consider using general combinator to express your code, instead of writing primitive recursion like this.</p>\n\n<pre><code>totalWeightOfFirstClass = sum . (fmap (\\(weight, _, _) -&gt; weight)) . filter (\\(_, _, firstc) -&gt; firstc)\n</code></pre>\n\n<p>It sum all the weights after applying the filter. As you can see, the code is very clean to read.</p>\n"}], "owner": {"reputation": 65, "user_id": 8486961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQbtc.jpg?s=128&g=1", "display_name": "Kieran Atkins", "link": "https://stackoverflow.com/users/8486961/kieran-atkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 47103741, "answer_count": 2, "score": 0, "last_activity_date": 1509740367, "creation_date": 1509739079, "question_id": 47103598, "link": "https://stackoverflow.com/questions/47103598/creating-a-program-that-accumulates-parts-of-a-list-haskell", "title": "Creating a program that accumulates parts of a list - Haskell", "body": "<p>I'm working on a program the will takes a list of triples and depending on one of those being true, I want to find the sum of one of the other parts of the triple.</p>\n\n<pre><code>totalWeightOfFirstClass :: [Parcel] -&gt; Weight\ntotalWeightOfFirstClass [] = go\ntotalWeightOfFirstClass ((weight, postcode, firstclass):xs) =\n  if firstclass == True then\n    go weight\n    totalWeightOfFirstClass xs\n  else\n    totalWeightOfFirstClass xs\nwhere\n  go :: Int -&gt; Int\n  go _ = 0\n  go x =\n</code></pre>\n\n<p>So the program should add up all the weight values in the list and display it at the end only if the that triple was first class. So far I have a helper statement that I want to accumulate all the values and to eventually display at the end.</p>\n\n<p>Any help or advice would be much appreciated.</p>\n\n<p>Regards, Kieran.</p>\n"}, {"tags": ["javascript", "haskell", "time-complexity", "computer-science", "complexity-theory"], "comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1509736365, "post_id": 47102809, "comment_id": 81156124, "body": "why do you think putting the four operations in a loop makes it O(n)? It doesn&#39;t, since the loop is doing four operations each of which takes O(n) time."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1509736367, "post_id": 47102809, "comment_id": 81156127, "body": "for large data structures you gain from cache affinity; think of paging a section of the data to fast memory location (CPU cache) so the consecutive look ups much faster.  The visible part:  elimination of loop counters is negligible."}, {"owner": {"reputation": 2714, "user_id": 435124, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/869caf84d3e2f1963345501b2e420df9?s=128&d=identicon&r=PG", "display_name": "bcherny", "link": "https://stackoverflow.com/users/435124/bcherny"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 2, "creation_date": 1509736500, "post_id": 47102809, "comment_id": 81156203, "body": "@AdamSmith Wouldn&#39;t traditional analysis call this O(n)?"}, {"owner": {"reputation": 2714, "user_id": 435124, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/869caf84d3e2f1963345501b2e420df9?s=128&d=identicon&r=PG", "display_name": "bcherny", "link": "https://stackoverflow.com/users/435124/bcherny"}, "reply_to_user": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1509736573, "post_id": 47102809, "comment_id": 81156229, "body": "@karakfa So the one loop instead of 4 loops is faster because the item is loaded into L1/L2 cache once and not 4 times, cutting down on memory IO?"}, {"owner": {"reputation": 6415, "user_id": 1416525, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6f23f148b7241e345a61d193ed205685?s=128&d=identicon&r=PG", "display_name": "cdk", "link": "https://stackoverflow.com/users/1416525/cdk"}, "edited": false, "score": 9, "creation_date": 1509736613, "post_id": 47102809, "comment_id": 81156243, "body": "In Big-O complexity analysis, there isn&#39;t really a meaningful distinction between <i>O(n)</i> and <i>O(c*n)</i>. Since <code>f(x) ~ O(g(n)</code> iff <code>forall x &gt; y . |f(x)| &lt; M|g(x)|</code> for some <code>M</code> and <code>y</code>"}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1509736771, "post_id": 47102809, "comment_id": 81156341, "body": "@bchemy correct, that&#39;s where most of the speed up comes from."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509737408, "post_id": 47102809, "comment_id": 81156646, "body": "In the fused version, it is often possible to avoid realizing the entire list. The list may be consumed as it is produced, dramatically reducing GC costs by keeping all the churn in the nursery. In many cases, the compiler can eliminate the list altogether, avoiding any GC cost and keeping much more of the computation in machine registers."}, {"owner": {"reputation": 2714, "user_id": 435124, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/869caf84d3e2f1963345501b2e420df9?s=128&d=identicon&r=PG", "display_name": "bcherny", "link": "https://stackoverflow.com/users/435124/bcherny"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509737938, "post_id": 47102809, "comment_id": 81156894, "body": "@dfeuer Could you explain in more detail, or link to an article? You mean memory consumed by intermediate results can be reused/GC&#39;d more effectively when using fusion than without? Does the compiler have to support fusion (eg. GHC) or can this be an application-level optimization (eg. transducers, or Lodash loop fusion)?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 3, "creation_date": 1509739520, "post_id": 47102809, "comment_id": 81157728, "body": "Something that is O(4n) is also O(n)."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1509739883, "post_id": 47102809, "comment_id": 81157899, "body": "<a href=\"https://en.wikipedia.org/wiki/Big_O_notation#Multiplication_by_a_constant\" rel=\"nofollow noreferrer\">Here&#39;s a reference for that fact</a>. The rest of the article should go into more detail about why that&#39;s the case."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1509758864, "post_id": 47102809, "comment_id": 81163495, "body": "Are you asking about this javascript code (which works with arrays, not linked lists and is strict) or about hypothetical Haskell code which does something comparable with lists and lazily? These are two entirely different situations."}], "answers": [{"comments": [{"owner": {"reputation": 2714, "user_id": 435124, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/869caf84d3e2f1963345501b2e420df9?s=128&d=identicon&r=PG", "display_name": "bcherny", "link": "https://stackoverflow.com/users/435124/bcherny"}, "edited": false, "score": 0, "creation_date": 1509987457, "post_id": 47140487, "comment_id": 81233902, "body": "Wow, this is a really intuitive way to look at it! Is there a name for this kind of analysis? It looks something like Halstead complexity."}], "tags": [], "owner": {"reputation": 25508, "user_id": 847269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/564ffe2e3f1ffe82696cd1ac01ac035e?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick87", "link": "https://stackoverflow.com/users/847269/patrick87"}, "is_accepted": true, "score": 1, "last_activity_date": 1509982553, "creation_date": 1509982553, "answer_id": 47140487, "question_id": 47102809, "link": "https://stackoverflow.com/questions/47102809/calculating-mean-min-max-sum-of-a-list-of-integers-whats-the-complexity/47140487#47140487", "title": "Calculating mean, min, max, sum of a list of integers - what&#39;s the complexity?", "body": "<p>This function:</p>\n\n<pre><code>Stats_A(array[1...n])\n    sum = 0\n    for i = 1 to n do\n        sum = sum + array[i]\n\n    avg = 0\n    for i = 1 to n do\n        avg = avg + array[i]\n    avg = avg / n\n\n    min = array[1]\n    for i = 1 to n do\n        if array[i] &lt; min then\n            min = array[i]\n\n    max = array[1]\n    for i = 1 to n do\n        if array[i] &gt; max then\n            max = array[i]\n\n    return (sum, avg, min, max)\n</code></pre>\n\n<p>And this function:</p>\n\n<pre><code>Stats_B(array[1...n])\n    sum = 0\n    min = max = array[1]\n    for i = 1 to n do\n        sum = sum + array[i]\n        if array[i] &lt; min then\n            min = array[i]\n        else if array[i] &gt; max then\n            max = array[i]\n\n    return (sum, sum / n, min, max)\n</code></pre>\n\n<p>Both have the same linear time complexity <code>O(n)</code>. We can assign costs to basic operations and work out more details expressions for the time complexities of these functions, and then we will find that <code>Stats_A</code> does more work than <code>Stats_B</code>, but not asymptotically more work. We can let:</p>\n\n<ol>\n<li>memory accesses (read/write) take time <code>a</code></li>\n<li>+, -, *, / take time <code>b</code>, <code>c</code>, <code>d</code>, <code>e</code>, respectively</li>\n<li>comparisons (&lt;, >, =) take time <code>f</code></li>\n</ol>\n\n<p>Now we can compute the more detailed runtime expressions:</p>\n\n<p>This function:</p>\n\n<pre><code>Stats_A(array[1...n])\n    sum = 0                      // a\n    for i = 1 to n do            // a + n * (f + b + a)\n        sum = sum + array[i]     // n * (2 * b + 3 * a)\n                                 // =   (2 + 4 * n) * a\n                                 //   + (    3 * n) * b\n                                 //   + (    1 * n) * f\n\n    avg = 0                      // a\n    for i = 1 to n do            // a + n * (f + b + a)\n        avg = avg + array[i]     // n * (2 * b + 3 * a)\n    avg = avg / n                // 3 * a + e\n                                 // =   (5 + 4 * n) * a\n                                 //   + (    3 * n) * b\n                                 //   + (    1 * n) * f\n                                 //   + (1        ) * e\n\n    min = array[1]               // 2 * a + b\n    for i = 1 to n do            // a + n * (f + b + a)\n        if array[i] &lt; min then   // n * (2 * a + b + f)\n            min = array[i]       // n * (2 * a + b)\n                                 // =   (3 + 5 * n) * a\n                                 //   + (1 + 3 * n) * b\n                                 //   + (    2 * n) * f\n\n    max = array[1]               // 2 * a + b\n    for i = 1 to n do            // a + n * (f + b + a)\n        if array[i] &gt; max then   // n * (2 * a + b + f)\n            max = array[i]       // n * (2 * a + b)\n                                 // =   (3 + 5 * n) * a\n                                      + (1 + 3 * n) * b\n                                      + (    2 * n) * f\n\n    return (sum, avg, min, max)  // =   (5        ) * a\n\n    // total:   (13 + 18 * n) * a\n    //        + ( 2 + 12 * n) * b\n    //        + ( 1         ) * e\n    //        + (      6 * n) * f\n    //        = n * (18a + 12b + 6f) + (13a + 2b + e)\n</code></pre>\n\n<p>And this function:</p>\n\n<pre><code>Stats_B(array[1...n])\n    sum = 0                           // a\n    min = max = array[1]              // 3a + b\n    for i = 1 to n do                 // a + n * (f + b + a)\n        sum = sum + array[i]          // n * (3 * a + 2 * b)\n        if array[i] &lt; min then        // n * (b + 2 * a + f)\n            min = array[i]            // n * (b + 2 * a)\n        else if array[i] &gt; max then   // n * (b + 2 * a + f)\n            max = array[i]            // n * (b + 2 * a)\n\n    return (sum, sum / n, min, max)   // 5a + e\n\n    // total:   ( 9 + 12 * n) * a\n              + ( 1 +  7 * n) * b\n              + ( 1         ) * e\n              + (      3 * n) * f\n              = n * (12a + 7b + 3f) + (9a + b + e)\n</code></pre>\n\n<p>The first function takes strictly longer than the second function; in the limit, the ratio of their runtimes approaches the quotient of their slopes:</p>\n\n<pre><code>(18a + 12b + 6f) / (12a + 7b + 3f)\n</code></pre>\n\n<p>We can observe that the denominator is strictly less than 2/3 of the numerator; therefore, the ratio is strictly greater than 3/2. We would expect, for any given input, <code>Stats_A</code> to take an amount approaching 50% longer than <code>Stats_B</code> as the input size increases without bound.</p>\n"}], "owner": {"reputation": 2714, "user_id": 435124, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/869caf84d3e2f1963345501b2e420df9?s=128&d=identicon&r=PG", "display_name": "bcherny", "link": "https://stackoverflow.com/users/435124/bcherny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 47140487, "answer_count": 1, "score": 1, "last_activity_date": 1509982553, "creation_date": 1509735705, "last_edit_date": 1509736606, "question_id": 47102809, "link": "https://stackoverflow.com/questions/47102809/calculating-mean-min-max-sum-of-a-list-of-integers-whats-the-complexity", "title": "Calculating mean, min, max, sum of a list of integers - what&#39;s the complexity?", "body": "<p>This is sort of a silly question that's been bugging me.</p>\n\n<p>I have a list of 100k numbers that I am calculating some statistics for. Specifically, I am computing the mean, minimum, maximum, and sum of these numbers. I'm doing it using a fold. In JavaScript:</p>\n\n<pre><code>// define folding functions:\nlet mean = (a, b, index, array) =&gt; a + b / array.length\nlet max = (a, b) =&gt; Math.max(a, b)\nlet min = (a, b) =&gt; Math.min(a, b)\nlet sum = (a, b) =&gt; a + b\n\nlet fold = initial =&gt; f =&gt; data =&gt;\n  Math.round(data.reduce(f, initial))\n\n// functions we can consume:\nlet averageDistance = fold(0)(mean)\nlet maxDistance = fold(-Infinity)(max)\nlet minDistance = fold(Infinity)(min)\nlet totalDistance = fold(0)(sum)\n\n// compute stats:\nlet data = [1, 2, 3, ...]\nlet a = averageDistance(data)\nlet b = maxDistance(data)\nlet c = minDistance(data)\nlet d = totalDistance(data)\n</code></pre>\n\n<p>The time complexity of this is clearly <em>O(n)</em> for each statistic <code>averageDistance</code>, <code>maxDistance</code>, etc. Computed over all 4 statistics, the complexity is <em>O(4n)</em>.</p>\n\n<p>Now, I can instead compute all 4 statistics in a single loop, using either a <a href=\"https://clojure.org/reference/transducers\" rel=\"nofollow noreferrer\">transducer</a> (a similar optimization to Haskell's fusion), or by inlining eveything into a <code>for</code> loop:</p>\n\n<pre><code>let a = 0\nlet b = -Infinity\nlet c = Infinity\nlet d = 0\n\nfor (let i = 0; i &lt; data.length; i++) {\n  a = mean(a, averageDistance(data[i]), i, data)\n  b = max(b, maxDistance(data[i]))\n  c = min(c, minDistance(data[i]))\n  d = sum(d, totalDistance(data[i]))\n}\n</code></pre>\n\n<p>This solution only does a single loop, so intuitively it does it in <em>O(n)</em> time (an improvement over <em>4n</em> from before).</p>\n\n<p>But it still does the same amount of work as before: (100k integers)*(4 statistics) = 400k computations.</p>\n\n<p>Is one solution really faster than another? Is the difference in space complexity (not in time)? If no to both of these, why bother with transducers or fusion at all?</p>\n"}, {"tags": ["haskell", "template-haskell", "aeson"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1509728314, "post_id": 47100569, "comment_id": 81151811, "body": "Works for me. (<code>encode (MyJSONObject &quot;foo&quot; Nothing Nothing Nothing Nothing)</code> gives <code>&quot;{\\&quot;name\\&quot;:\\&quot;foo\\&quot;}&quot;</code>.) What version of aeson are you using?"}, {"owner": {"reputation": 4113, "user_id": 4601931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4785004388498e25bc6794fe1d9d4a38?s=128&d=identicon&r=PG&f=1", "display_name": "user4601931", "link": "https://stackoverflow.com/users/4601931/user4601931"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509734195, "post_id": 47100569, "comment_id": 81154932, "body": "@DanielWagner I&#39;m using <code>aeson-1.1.2.0</code>.  My problem turned out to be not implementing <code>FromJSON&#47;ToJSON</code> for <code>data MyOtherJSONObject = MyOtherJSONObject { objects :: [MyJSONObject] } deriving (Show, Generic)</code> (which is the data I <i>really</i> wanted to <code>decode</code>/<code>encode</code>) with the <code>omitNothingFields</code> option.  Why I needed it there, too, is beyond me.  I thought my issue was with the <code>MyJSONObject</code> instances."}], "answers": [{"comments": [{"owner": {"reputation": 4113, "user_id": 4601931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4785004388498e25bc6794fe1d9d4a38?s=128&d=identicon&r=PG&f=1", "display_name": "user4601931", "link": "https://stackoverflow.com/users/4601931/user4601931"}, "edited": false, "score": 0, "creation_date": 1509734051, "post_id": 47100851, "comment_id": 81154850, "body": "Thanks for your answer.  To be more precise, I later define <code>data MyOtherJSONObject = MyOtherJSONObject { objects :: [MyJSONObject] } deriving (Show, Generic)</code> and it&#39;s this object I want to omit Nothing/null from.  Evidently I needed to put the <code>omitNothingFields</code> option in that instance, too.  Why I needed to do that, I&#39;m not so sure.  It&#39;s still the case that <code>decode</code> returns a bunch of Nothing values, but like I said, that&#39;s less important to me.  Thanks again."}], "tags": [], "owner": {"reputation": 1946, "user_id": 1432740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a84709030a711eb919bec460051eac8?s=128&d=identicon&r=PG", "display_name": "Mateusz Kowalczyk", "link": "https://stackoverflow.com/users/1432740/mateusz-kowalczyk"}, "is_accepted": true, "score": 11, "last_activity_date": 1509728099, "creation_date": 1509728099, "answer_id": 47100851, "question_id": 47100569, "link": "https://stackoverflow.com/questions/47100569/omitting-nothing-null-fields-in-haskells-aeson/47100851#47100851", "title": "Omitting Nothing/null fields in Haskell&#39;s Aeson", "body": "<p>Works for me. Try using Generics deriving instead of TH. Maybe that's doing it.</p>\n\n<pre><code>*Main Data.Aeson&gt; decode \"{\\\"name\\\":\\\"str\\\"}\" :: Maybe MyJSONObject\nJust (MyJSONObject {name = \"str\", ptype = Nothing, pid = Nothing, subject = Nothing, message = Nothing})\n*Main Data.Aeson&gt; encode (MyJSONObject \"str\" Nothing Nothing Nothing Nothing)\n\"{\\\"name\\\":\\\"str\\\"}\"\n</code></pre>\n\n<p>The full code is</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric   #-}\nimport GHC.Generics\nimport Data.Aeson\nimport Data.Aeson.Types\n\ndata MyJSONObject = MyJSONObject\n  { name    :: String\n  , ptype   :: Maybe String\n  , pid     :: Maybe String\n  , subject :: Maybe String\n  , message :: Maybe String\n  } deriving (Show, Generic)\n\ninstance ToJSON MyJSONObject where\n  toJSON = genericToJSON defaultOptions\n    { omitNothingFields = True }\n\ninstance FromJSON MyJSONObject where\n  parseJSON = genericParseJSON defaultOptions\n    { omitNothingFields = True }\n</code></pre>\n\n<p>Using GHC 8.2.1, <code>aeson-1.1.2.0</code>.</p>\n"}], "owner": {"reputation": 4113, "user_id": 4601931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4785004388498e25bc6794fe1d9d4a38?s=128&d=identicon&r=PG&f=1", "display_name": "user4601931", "link": "https://stackoverflow.com/users/4601931/user4601931"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1185, "favorite_count": 0, "accepted_answer_id": 47100851, "answer_count": 1, "score": 6, "last_activity_date": 1510264538, "creation_date": 1509727210, "last_edit_date": 1510264538, "question_id": 47100569, "link": "https://stackoverflow.com/questions/47100569/omitting-nothing-null-fields-in-haskells-aeson", "title": "Omitting Nothing/null fields in Haskell&#39;s Aeson", "body": "<p>I have a type</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric   #-}\n{-# LANGUAGE TemplateHaskell #-}\n{-# LANGUAGE MultiWayIf      #-}\n\nimport GHC.Generics\nimport Data.Aeson.TH\nimport Data.Aeson.Types\n\ndata MyJSONObject = MyJSONObject\n  { name    :: String\n  , ptype   :: Maybe String\n  , pid     :: Maybe String\n  , subject :: Maybe String\n  , message :: Maybe String\n  } deriving (Show, Generic)\n</code></pre>\n\n<p>with a great many more <code>Maybe String</code> fields.  My <code>FromJSON</code> and <code>ToJSON</code> are provided by the <code>TemplateHaskell</code> function</p>\n\n<pre><code>$(deriveJSON defaultOptions\n  {\n    omitNothingFields  = True\n  , fieldLabelModifier = \\f -&gt; if\n      | f == \"ptype\" -&gt; \"type\" -- reserved keyword\n      | f == \"pid\"   -&gt; \"id\"   -- Prelude function name\n      | otherwise    -&gt; f\n  } ''MyJSONObject)\n</code></pre>\n\n<p>Ultimately, the output of the program is a JSON document intended to be consumed by an application that does not permit some fields to have null values, even if it does allow these fields to not exist.  In other words, it's perfectly fine for <code>subject</code> to not be present in the JSON document, but if it does exist, its value cannot be null.  My expectation was that <code>omitNothingFields</code> would handle this requirement, but this does not appear to be the case: the <code>decode</code>d JSON still has <code>Nothing</code> values for fields that are not present, and the <code>encode</code>d JSON has <code>null</code> values for those fields.  The former case is fine; the latter case is not, hence the question.   </p>\n\n<p>Am I misusing, or misunderstanding the purpose of, <code>omitNothingFields</code>?  How can I ignore fields with <code>Nothing</code>/<code>null</code> values?  </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1509738962, "post_id": 47099130, "comment_id": 81157425, "body": "Note that you can use <a href=\"https://www.haskell.org/hoogle/?hoogle=Read+a+%3D%3E+String+-%3E+%28a%2C+String%29\" rel=\"nofollow noreferrer\">hoogle</a> to search for that type. The first answer is what you want, even if it hides its type under the <code>ReadS</code> alias."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 6, "last_activity_date": 1509723204, "last_edit_date": 1509723204, "creation_date": 1509722872, "answer_id": 47099281, "question_id": 47099130, "link": "https://stackoverflow.com/questions/47099130/haskell-read-something-from-a-string-and-return-type-and-rest-of-the-string/47099281#47099281", "title": "Haskell Read something from a String and return type and rest of the String", "body": "<p>You can use <code>reads</code> for that.</p>\n\n<pre><code>&gt; (reads :: ReadS Int) \"5 6 7\"\n[(5,\" 6 7\")]\n</code></pre>\n\n<p>You can also combine <code>words</code> and <code>read</code>, but it will be fragile -- e.g. if any value has a space in it, this will break in fun ways.</p>\n\n<pre><code>Text.Read&gt; mapM readMaybe (words \"5 6 7\") :: Maybe [Int] -- safer\nJust [5,6,7]\n&gt; map read (words \"5 6 7\") :: [Int] -- more convenient\n[5,6,7]\n</code></pre>\n\n<p>An example of these last ones breaking due to spaces in values, while the <code>reads</code> solution works properly:</p>\n\n<pre><code>&gt; (reads :: ReadS (Maybe Int)) \"Just 5 Just 6 Just 7\"\n[(Just 5,\" Just 6 Just 7\")]\nText.Read&gt; mapM readMaybe (words \"Just 5 Just 6 Just 7\") :: Maybe [Maybe Int]\nNothing\n</code></pre>\n"}], "owner": {"reputation": 2434, "user_id": 4591251, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/22ad6242d3ca1d772c46a5d00389d925?s=128&d=identicon&r=PG", "display_name": "Ross MacArthur", "link": "https://stackoverflow.com/users/4591251/ross-macarthur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 47099281, "answer_count": 1, "score": 0, "last_activity_date": 1509723204, "creation_date": 1509722438, "question_id": 47099130, "link": "https://stackoverflow.com/questions/47099130/haskell-read-something-from-a-string-and-return-type-and-rest-of-the-string", "title": "Haskell Read something from a String and return type and rest of the String", "body": "<p>So I know I can parse something from a string <code>s</code> like this:</p>\n\n<pre><code>read s :: Int\n</code></pre>\n\n<p>But this only works if the string is the entire type you are reading. I actually want to be able to read a stream of the same type and create a list however I couldn't find anything of the type</p>\n\n<pre><code>Read a =&gt; String -&gt; (a, String)\n</code></pre>\n\n<p>Or something of that sort. Basically I want to be able to something like <code>readSeries \"5 6 7\"</code> and get <code>[5, 6, 7]</code> and I thought the easiest would be if I can get something to return the rest of the string too.</p>\n"}, {"tags": ["parsing", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 7053154, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5610fe820050f3aff07bac7af4b451b1?s=128&d=identicon&r=PG&f=1", "display_name": "bruno cuconato", "link": "https://stackoverflow.com/users/7053154/bruno-cuconato"}, "edited": false, "score": 0, "creation_date": 1509728523, "post_id": 47099149, "comment_id": 81151936, "body": "hum, ok! thanks for showing me how to find the answer, I&#39;ll keep that in mind :)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1509722496, "creation_date": 1509722496, "answer_id": 47099149, "question_id": 47099077, "link": "https://stackoverflow.com/questions/47099077/how-to-debug-readp-parser/47099149#47099149", "title": "how to debug ReadP parser?", "body": "<p><code>ReadP</code> doesn't offer error-reporting capabilities. That's evident from the type of a <code>ReadP</code> parser:</p>\n\n<pre><code>newtype ReadP a = R (forall b . (a -&gt; P b) -&gt; P b)\ndata P a\n  = Get (Char -&gt; P a)\n  | Look (String -&gt; P a)\n  | Fail\n  | Result a (P a)\n  | Final [(a,String)] -- invariant: list is non-empty!\n  deriving Functor\n</code></pre>\n\n<p>You can see that the <code>Fail</code> constructor doesn't store any information.</p>\n\n<p>You will need to use a different parser combinator library for that (or build your own).</p>\n"}], "owner": {"reputation": 135, "user_id": 7053154, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5610fe820050f3aff07bac7af4b451b1?s=128&d=identicon&r=PG&f=1", "display_name": "bruno cuconato", "link": "https://stackoverflow.com/users/7053154/bruno-cuconato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 47099149, "answer_count": 1, "score": 1, "last_activity_date": 1509722496, "creation_date": 1509722288, "question_id": 47099077, "link": "https://stackoverflow.com/questions/47099077/how-to-debug-readp-parser", "title": "how to debug ReadP parser?", "body": "<p>I've written a simple parser using <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Text-ParserCombinators-ReadP.html\" rel=\"nofollow noreferrer\">readP</a>. it works, but I'm using it as a sort of validating parser, as input is manually written and sometimes deviates from norm. in order to correct the input, I'd like to know in which line my parser failed, so my question is:</p>\n\n<p>how can I obtain a debugging message showing in which line of input my parser failed, like the ones shown in <a href=\"http://book.realworldhaskell.org/read/using-parsec.html\" rel=\"nofollow noreferrer\">real world haskell</a> (for Parsec)?</p>\n\n<p>(I'm fairly new to haskell, btw.)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 2, "creation_date": 1509710231, "post_id": 47095011, "comment_id": 81139694, "body": "As I already mentioned in a comment to my <a href=\"https://stackoverflow.com/a/47094727/630160\">previous answer</a> - you need to include the definitions of <code>put</code>, <code>prompt</code> and <code>Board</code> to provide some context."}, {"owner": {"reputation": 4565, "user_id": 1134885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c428466054762cf7d4b5fb5f4396fa2?s=128&d=identicon&r=PG", "display_name": "NovaDenizen", "link": "https://stackoverflow.com/users/1134885/novadenizen"}, "edited": false, "score": 0, "creation_date": 1509718743, "post_id": 47095011, "comment_id": 81145482, "body": "You&#39;re looking at the wrong part of your code.  The error message does not match the code you&#39;ve included."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1509714343, "post_id": 47095265, "comment_id": 81142402, "body": "or <code>if game_choise == &quot;1&quot;</code>, I guess"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1509714684, "post_id": 47095265, "comment_id": 81142644, "body": "It would be &quot;safer&quot; on the other hand it might lead to unexpected runtime behavior - since I don&#39;t know if prompt returns the string including newline. I would do something like <code>case readMay gameChoice of Just (1 :: Int) -&gt; ..</code>."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 3, "last_activity_date": 1509710340, "creation_date": 1509710340, "answer_id": 47095265, "question_id": 47095011, "link": "https://stackoverflow.com/questions/47095011/no-instance-for-num-string-arising-from-the-literal-1-in-if/47095265#47095265", "title": "No instance for (Num String) arising from the literal `1&#39; in if", "body": "<p>my most likely fix (guess) would be </p>\n\n<pre><code>main = do\n  playGame emptyBoard\n  where\n    playGame board = do \n      game_choise &lt;- prompt \"Choose game type: (1) PvC (2) PvP\"\n      if read game_choise == (1 :: Int)\n        then putStrLn \"1\"\n        else pvp board 0\n</code></pre>\n"}], "owner": {"reputation": 1142, "user_id": 5180554, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/5OWnC.jpg?s=128&g=1", "display_name": "Alex Goft", "link": "https://stackoverflow.com/users/5180554/alex-goft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 557, "favorite_count": 0, "accepted_answer_id": 47095265, "answer_count": 1, "score": -1, "last_activity_date": 1509710340, "creation_date": 1509709509, "question_id": 47095011, "link": "https://stackoverflow.com/questions/47095011/no-instance-for-num-string-arising-from-the-literal-1-in-if", "title": "No instance for (Num String) arising from the literal `1&#39; in if", "body": "<p>Consider the next piece of code - </p>\n\n<pre><code>pvp :: Board -&gt; Int -&gt; IO ()\npvp board player = do\n  playerchoice &lt;- prompt $ (\"Player \" ++  (show (player + 1)) ++ \", it's your turn:\")\n  let newboard = if player == 0\n                   then put board X (read playerchoice)\n                   else put board O (read playerchoice)\n  case newboard of\n      Nothing -&gt; do\n        putStrLn \"Invalid move.\"\n        pvp board player\n      Just board' -&gt; putStrLn \"Valid move.\"\n</code></pre>\n\n<p>When i try to compile the script i get the following error- </p>\n\n<pre><code> No instance for (Num String) arising from the literal 1'\n In the second argument of (==)', namely 1'\n</code></pre>\n\n<p>This is how i call pvp -</p>\n\n<pre><code>main = do\n  playGame emptyBoard\n  where\n    playGame board = do \n      game_choise   &lt;- prompt \"Choose game type: (1) PvC (2) PvP\"\n      if game_choise == 1\n        then putStrLn \"1\"\n        else pvp board 0\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 8984, "user_id": 2485966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZj6A.jpg?s=128&g=1", "display_name": "Ruud Helderman", "link": "https://stackoverflow.com/users/2485966/ruud-helderman"}, "edited": false, "score": 0, "creation_date": 1509708527, "post_id": 47094491, "comment_id": 81138677, "body": "Reading this might help: <a href=\"https://stackoverflow.com/questions/35198897/does-mean-assigning-a-variable-in-haskell\" title=\"does mean assigning a variable in haskell\">stackoverflow.com/questions/35198897/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1142, "user_id": 5180554, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/5OWnC.jpg?s=128&g=1", "display_name": "Alex Goft", "link": "https://stackoverflow.com/users/5180554/alex-goft"}, "edited": false, "score": 0, "creation_date": 1509708826, "post_id": 47094727, "comment_id": 81138856, "body": "Thank you for your time answering my question, but with this fix i get ` No instance for (Num String) arising from the literal `1&#39; ` (4th line)"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 1142, "user_id": 5180554, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/5OWnC.jpg?s=128&g=1", "display_name": "Alex Goft", "link": "https://stackoverflow.com/users/5180554/alex-goft"}, "edited": false, "score": 0, "creation_date": 1509709025, "post_id": 47094727, "comment_id": 81138969, "body": "I don&#39;t know what your line 4 is you need to show your whole file - otherwise  I cannot help you. But nevertheless this is an unrelated problem to the current one - better open a new question for that one."}, {"owner": {"reputation": 1142, "user_id": 5180554, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/5OWnC.jpg?s=128&g=1", "display_name": "Alex Goft", "link": "https://stackoverflow.com/users/5180554/alex-goft"}, "edited": false, "score": 0, "creation_date": 1509709072, "post_id": 47094727, "comment_id": 81139002, "body": "I mean 4th line in the piece of code in your answer"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 1142, "user_id": 5180554, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/5OWnC.jpg?s=128&g=1", "display_name": "Alex Goft", "link": "https://stackoverflow.com/users/5180554/alex-goft"}, "edited": false, "score": 0, "creation_date": 1509709415, "post_id": 47094727, "comment_id": 81139223, "body": "As I said, I cannot help you <code>Board</code> is not known to me also the definition of <code>put</code> and <code>prompt</code>."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 4, "last_activity_date": 1509708848, "last_edit_date": 1509708848, "creation_date": 1509708549, "answer_id": 47094727, "question_id": 47094491, "link": "https://stackoverflow.com/questions/47094491/variable-not-in-scope-in-simple-a-function/47094727#47094727", "title": "`Variable not in scope` in simple a function", "body": "<p>Since I have not the whole haskell file I can only give an educated guess - but you are having newboard only in scope of your <code>if .. then .. else</code> expression</p>\n\n<p>This should be correct assuming <code>put</code> is returning a new <code>Board</code> - and has nothing to do with <code>State</code>:</p>\n\n<pre><code>pvp :: Board -&gt; Int -&gt; IO ()\npvp board player = do\n  player1choice &lt;- prompt $ (\"Player \" ++  (show (player + 1)) ++ \", it's your turn:\")\n  let newboard = if player == 0\n                   then put board X (read player1choice)\n                   else put board O (read player1choice)\n  case newboard of\n      Nothing -&gt; do\n        putStrLn \"Invalid move.\"\n        -- playGame b\n      Just board' -&gt; putStrLn \"Valid move.\"\n</code></pre>\n\n<h2>Note (unrelated to your problem)</h2>\n\n<p>You should avoid <code>read</code> it will crash your program if someone enters an invalid input - say a letter where you expect something numeric. better use <a href=\"https://hackage.haskell.org/package/extra-1.6/docs/Text-Read-Extra.html#v:readMaybe\" rel=\"nofollow noreferrer\"><code>readMaybe</code></a></p>\n"}], "owner": {"reputation": 1142, "user_id": 5180554, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/5OWnC.jpg?s=128&g=1", "display_name": "Alex Goft", "link": "https://stackoverflow.com/users/5180554/alex-goft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 643, "favorite_count": 0, "accepted_answer_id": 47094727, "answer_count": 1, "score": 0, "last_activity_date": 1509708848, "creation_date": 1509707865, "last_edit_date": 1509708553, "question_id": 47094491, "link": "https://stackoverflow.com/questions/47094491/variable-not-in-scope-in-simple-a-function", "title": "`Variable not in scope` in simple a function", "body": "<p>Consider the next piece of code -</p>\n\n<pre><code>pvp::Board-&gt;Int-&gt; IO ()\npvp board player = do\n  player1choice &lt;- prompt $ (\"Player \" ++  (show (player + 1)) ++ \", it's your turn:\")\n\n  if player == 0 \n    then let newboard = (put board X (read player1choice)) in newboard\n    else let newboard = (put board O (read player1choice)) in newboard\n\n  case newboard of\n    Nothing -&gt; putStrLn \"Invalid move.\"\n    Just board' -&gt; putStrLn \"Valid move.\"\n</code></pre>\n\n<p>For <code>case newboard of</code>, i get <code>error: Variable not in scope: newboard :: Maybe a0</code>. whats the reason for this?</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1509714403, "post_id": 47093627, "comment_id": 81142451, "body": "I hope it&#39;s clear that such an instance doesn&#39;t make a lot of sense! \u2013 Still, good question, I would also have assumed the compiler to allow this and figure out the superclass."}, {"owner": {"reputation": 4565, "user_id": 1134885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c428466054762cf7d4b5fb5f4396fa2?s=128&d=identicon&r=PG", "display_name": "NovaDenizen", "link": "https://stackoverflow.com/users/1134885/novadenizen"}, "edited": false, "score": 0, "creation_date": 1509719400, "post_id": 47093627, "comment_id": 81145956, "body": "The root problem I&#39;m seeing is that you have both &quot;Functor f =&gt; Monoidal f&quot; and &quot;Applicative f =&gt; Monoidal f&quot;.  As I understand it, the compiler needs to see only one possible derivation path for a particular typeclass on a particular type."}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1509720470, "post_id": 47093627, "comment_id": 81146656, "body": "@leftaroundabout because it&#39;s an isomorphism back and forth is that what you mean ? that&#39;s why I was laying down the iso, to get reminded of that"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1509733274, "post_id": 47101228, "comment_id": 81154446, "body": "I&#39;ve reported this as <a href=\"https://ghc.haskell.org/trac/ghc/ticket/14417\" rel=\"nofollow noreferrer\">Trac #14417</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1509734084, "post_id": 47101228, "comment_id": 81154865, "body": "And it turned out to be known and officially expected behavior as of 8.0. Weird."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1509742295, "post_id": 47101228, "comment_id": 81158937, "body": "And <a href=\"https://ghc.haskell.org/trac/ghc/ticket/11427#comment:4\" rel=\"nofollow noreferrer\">this comment</a> appears to be the money shot, explaining the problem that is solved by this behavior. It&#39;s quite technical, though."}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1509743675, "post_id": 47101228, "comment_id": 81159528, "body": "that was swift.. thank you.  it&#39;s somehow for UndecidableSuperclass. (btw UndecidableSuperclass is a thing of beauty)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1509729592, "creation_date": 1509729592, "answer_id": 47101228, "question_id": 47093627, "link": "https://stackoverflow.com/questions/47093627/can-not-deduce-superclass/47101228#47101228", "title": "Can not deduce superclass", "body": "<p>Looks like a bug to me. Here's a minimal file which shows the problem and doesn't rely on any shenanigans with renaming <code>Prelude</code> stuff or <code>undefined</code>s.</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE UndecidableInstances #-}\nclass A x\nclass A x =&gt; B x\nclass A x =&gt; C x\ninstance B x =&gt; C x\n</code></pre>\n\n<p>I recommend filing a bug on the GHC bug tracker with this file (or one very like it); the reasoning needed to discover that <code>B x</code> implies <code>A x</code> should be possible.</p>\n"}], "owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 3, "accepted_answer_id": 47101228, "answer_count": 1, "score": 7, "last_activity_date": 1509729592, "creation_date": 1509705188, "last_edit_date": 1509720644, "question_id": 47093627, "link": "https://stackoverflow.com/questions/47093627/can-not-deduce-superclass", "title": "Can not deduce superclass", "body": "<p>In the following code, GHC can not find the Functor instance in the definition of <code>Monoidal</code> instance.</p>\n\n<p>Why isn't GHC deducing that <em>given</em> the <code>Applicative</code> constraint is satisfied, then the <code>Functor</code> <em>has</em> to be somewhere already? (is there a name to this reasoning 'capability' ?)</p>\n\n<pre><code>import Prelude hiding (Applicative (..), Monad (..))\n\nclass Functor f =&gt; Applicative f where\n  pure :: a -&gt; f a\n  (&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b\n\nclass Functor f =&gt; Monoidal f where\n   unit::f ()\n   (*) ::f a -&gt; f b -&gt; f (a,b)\n\ninstance Applicative f =&gt; Monoidal f where\n  unit = pure ()\n  a * b = undefined\n</code></pre>\n\n<p>I know could of course add an explicit <code>Functor f</code> constraint to <code>Monoidal</code> to not have the error, but my question is more on why instance resolution works that way</p>\n\n<pre><code>import Prelude hiding ((*), Applicative (..), Monad (..))\n\nclass Functor f =&gt; Applicative f where\n  pure :: a -&gt; f a\n  (&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b\n\nclass Functor f =&gt; Monoidal f where\n   unit::f ()\n   (*) ::f a -&gt; f b -&gt; f (a,b)\n\ninstance (Applicative f, Functor f) =&gt; Monoidal f where\n  unit = pure ()\n  a * b = (pure (,) &lt;*&gt; a &lt;*&gt; b )\n\ninstance (Monoidal f, Functor f) =&gt; Applicative f where\n  pure x = fmap (\\_ -&gt; x) unit\n  mu &lt;*&gt; mx = fmap (\\(f, x) -&gt; f x) ((mu * mx) :: f (a -&gt; b, a))\n</code></pre>\n"}, {"tags": ["haskell", "terminal", "ghci"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1509688763, "post_id": 47089264, "comment_id": 81127947, "body": "You know you can just do <code>:r</code> after you&#39;ve loaded it once, right?"}, {"owner": {"reputation": 827, "user_id": 1276388, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4ae985df9e533570f5ac2ea9bfc25dfd?s=128&d=identicon&r=PG", "display_name": "\u0397\u03bb\u03b5\u03ba\u03c4\u03c1\u03bf\u03bb\u03cc\u03b3\u03bf\u03c2 \u039c\u03b7\u03c7\u03b1\u03bd\u03b9\u03ba\u03cc\u03c2", "link": "https://stackoverflow.com/users/1276388/%ce%97%ce%bb%ce%b5%ce%ba%cf%84%cf%81%ce%bf%ce%bb%cf%8c%ce%b3%ce%bf%cf%82-%ce%9c%ce%b7%cf%87%ce%b1%ce%bd%ce%b9%ce%ba%cf%8c%cf%82"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1509689851, "post_id": 47089264, "comment_id": 81128332, "body": "Yes, thanks for the response. <code>x &lt;- readFile &quot;Main.png&quot;</code> for example, is another case for this."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1509717018, "post_id": 47089264, "comment_id": 81144286, "body": "I really doubt this is a feature very many people would care for, so wouldn&#39;t be surprised if it was never implemented. But if you do... can&#39;t be too difficult, just write a suitable <a href=\"http://hackage.haskell.org/package/haskeline-0.7.4.0/docs/System-Console-Haskeline-Completion.html#v:completeFilename\" rel=\"nofollow noreferrer\"><code>CompletionFunc</code></a>."}], "owner": {"reputation": 827, "user_id": 1276388, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4ae985df9e533570f5ac2ea9bfc25dfd?s=128&d=identicon&r=PG", "display_name": "\u0397\u03bb\u03b5\u03ba\u03c4\u03c1\u03bf\u03bb\u03cc\u03b3\u03bf\u03c2 \u039c\u03b7\u03c7\u03b1\u03bd\u03b9\u03ba\u03cc\u03c2", "link": "https://stackoverflow.com/users/1276388/%ce%97%ce%bb%ce%b5%ce%ba%cf%84%cf%81%ce%bf%ce%bb%cf%8c%ce%b3%ce%bf%cf%82-%ce%9c%ce%b7%cf%87%ce%b1%ce%bd%ce%b9%ce%ba%cf%8c%cf%82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1509688743, "creation_date": 1509688272, "last_edit_date": 1509688743, "question_id": 47089264, "link": "https://stackoverflow.com/questions/47089264/enable-tab-auto-completion-case-insensitive-in-ghci", "title": "Enable tab auto-completion case-insensitive in GHCI", "body": "<p>It's bothersome for me to have to press <code>shift</code> key whenever to type <code>Main.hs</code> in <code>ghci</code>.</p>\n\n<pre><code>&gt; :l Main.hs\n</code></pre>\n\n<p>Is there a way to make <code>ghci</code> tab completion case-insensitive? I couldn't find a fieldname in <code>~/.haskeline</code> for this. </p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 2, "creation_date": 1509669809, "post_id": 47086704, "comment_id": 81123226, "body": "What should <code>h</code> be? If <code>a</code> determines <code>h</code> you can work with type families or functional dependencies but that is not a topic I would recommend to a beginner."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1509675484, "post_id": 47086704, "comment_id": 81124674, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4629883/rigid-type-variable-error\">rigid type variable error</a>"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1509679827, "post_id": 47086704, "comment_id": 81125674, "body": "What exactly does &quot;<i>a encapsulates a set of hypotheses of type h</i>&quot; mean?"}], "answers": [{"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 3, "last_activity_date": 1509689238, "creation_date": 1509689238, "answer_id": 47089463, "question_id": 47086704, "link": "https://stackoverflow.com/questions/47086704/couldnt-match-type-h-with-string/47089463#47089463", "title": "Couldn&#39;t match type `h&#39; with `String&#39;", "body": "<p>This</p>\n\n<pre><code>class Pmf a where\n    hypos :: a -&gt; [h]\n    prob :: a -&gt; h -&gt; Double\n</code></pre>\n\n<p>is short for</p>\n\n<pre><code>class Pmf a where\n    hypos :: forall h. a -&gt; [h]\n    prob  :: forall h. a -&gt; h -&gt; Double\n</code></pre>\n\n<p>That is, the <code>h</code>s in the two signatures are unrelated, and furthermore each of these functions needs to work for <em>any <code>h</code> that the caller might choose</em>.  I think you are looking for either type families</p>\n\n<pre><code>class Pmf a where\n    type Hypothesis a :: *\n    hypos :: a -&gt; [Hypothesis a]\n    ...\n\ninstance Pmf BoxSet where\n    type Hypothesis BoxSet = String\n    ...\n</code></pre>\n\n<p>or functional dependencies, which do the same kind of thing but with a different swagger</p>\n\n<pre><code>class Pmf a h | a -&gt; h where\n    hypos :: a -&gt; [h]\n    ...\n\ninstance Pmf BoxSet String where\n    ...\n</code></pre>\n\n<p>There are a handful of extensions needed for each, I think the error messages will lead the way.</p>\n"}], "owner": {"reputation": 139, "user_id": 2704022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gqBUP.png?s=128&g=1", "display_name": "ElBrocas", "link": "https://stackoverflow.com/users/2704022/elbrocas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1509689238, "creation_date": 1509669109, "question_id": 47086704, "link": "https://stackoverflow.com/questions/47086704/couldnt-match-type-h-with-string", "title": "Couldn&#39;t match type `h&#39; with `String&#39;", "body": "<p>I'm starting in Haskell and I would like your help and intuition on why the following code does not work. The main idea is to do a class that represents Probability mass functions</p>\n\n<pre><code>--a encapsulates a set of hypotheses of type h\nclass Pmf a where\n    hypos :: a -&gt; [h]\n    prob :: a -&gt; h -&gt; Double\n    probList :: a -&gt; [(h,Double)]\n\n    probList a = map (\\h-&gt;(h, prob a h)) $ hypos a\n</code></pre>\n\n<p>The idea is for it to be general, so for instance I could define</p>\n\n<pre><code>data BoxSet = BoxSet { ids::[String], items::[(String,Int)]} deriving(Show)\n</code></pre>\n\n<p>and make BoxSet an instance like</p>\n\n<pre><code>instance Pmf BoxSet where\n    hypos = ids\n\n    prob cj _ = let one = 1\n                    len = doubleLength $ ids cj in one/len\n</code></pre>\n\n<p>but this gives the following error</p>\n\n<pre><code>&lt;interactive&gt;:2:13: error:\n* Couldn't match type `h' with `String'\n  `h' is a rigid type variable bound by\n    the type signature for:\n      hypos :: forall h. BoxSet -&gt; [h]\n    at &lt;interactive&gt;:2:5\n  Expected type: BoxSet -&gt; [h]\n    Actual type: BoxSet -&gt; [String]\n* In the expression: ids\n  In an equation for `hypos': hypos = ids\n  In the instance declaration for `Pmf BoxSet'\n* Relevant bindings include hypos :: BoxSet -&gt; [h] (bound at &lt;interactive&gt;:2:5)\n</code></pre>\n\n<p>Its possible to put h as additional class parameter but then in the future I will expand the class with a new type d for data and i will have <a href=\"https://stackoverflow.com/questions/23983374/how-to-handle-functions-of-a-multi-parameter-typeclass-who-not-need-every-type\">this problem</a></p>\n\n<p>So then, I would appreciate if you could tell me why String can not be matched as h and how could this be solved. I understand that it expects any h with any type but in an instance it makes sense to give h a specific type.</p>\n\n<p>Also, I think I might not be on the functional mindset fully here. So if you can point a better way to model these Pmf I would gladly try it!.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1509715120, "post_id": 47085910, "comment_id": 81142936, "body": "Why don&#39;t you want subsequences of length 5?"}, {"owner": {"reputation": 4565, "user_id": 1134885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c428466054762cf7d4b5fb5f4396fa2?s=128&d=identicon&r=PG", "display_name": "NovaDenizen", "link": "https://stackoverflow.com/users/1134885/novadenizen"}, "edited": false, "score": 0, "creation_date": 1509719728, "post_id": 47085910, "comment_id": 81146198, "body": "Start with <code>oddSublists = filter oddlength . allSublists</code>, then write <code>oddlength :: [a] -&gt; Bool</code> and <code>allSublists :: [a] -&gt; [[a]]</code>."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1509665807, "creation_date": 1509665807, "answer_id": 47086277, "question_id": 47085910, "link": "https://stackoverflow.com/questions/47085910/printing-sublists-of-list-with-odd-length-haskell-programming/47086277#47086277", "title": "Printing sublists of list with odd length haskell programming", "body": "<p>I think I'd reuse <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-List.html#v:subsequences\" rel=\"nofollow noreferrer\"><code>subsequences</code></a> until I was pretty sure this was the bottleneck. Especially since you seem comfortable calling <code>length</code> a lot, it seems like efficiency isn't a big concern. So:</p>\n\n<pre><code>Data.List&gt; filter (odd . length) . subsequences $ [1..4]\n[[1],[2],[3],[1,2,3],[4],[1,2,4],[1,3,4],[2,3,4]]\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8701705, "user_type": "registered", "profile_image": "https://graph.facebook.com/1602349916483368/picture?type=large", "display_name": "Anoop Musale", "link": "https://stackoverflow.com/users/8701705/anoop-musale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1509665807, "creation_date": 1509663504, "last_edit_date": 1509663663, "question_id": 47085910, "link": "https://stackoverflow.com/questions/47085910/printing-sublists-of-list-with-odd-length-haskell-programming", "title": "Printing sublists of list with odd length haskell programming", "body": "<p>I want to print sublists of list having odd length. i coded this.</p>\n\n<pre><code>sublists :: [a] -&gt; [[a]]\nsublists [] = [[]]\nsublists (x:xs) = if odd (length (tail xs))\n                  then [x:sublist | sublist &lt;- sublists xs] ++ sublists xs \n                  else sublists xs\n</code></pre>\n\n<p>eg: <code>sublists [1,2,3,4,5,6]</code></p>\n\n<p>I am getting output as :</p>\n\n<p><code>[[1,3,5],[1,3],[1,5],[1],[3,5],[3],[5],[]]</code></p>\n\n<p>I want :</p>\n\n<p><code>[[1,3,5],[2,3,4],[2,3,5],[1],[2,3,6],[3],[5],[2],[4],[6],[1,2,3],[1,2,4],[1,2,5],[1,2,6],[1,3,4],[1,3,6],[1,4,5],[1,4,6],[1,5,6],[2,4,5],[2,4,6],[2,5,6],[3,4,5],[3,4,6],[3,5,6],[4,5,6],[]]</code></p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1509664073, "post_id": 47085908, "comment_id": 81121586, "body": "looks like <code>sequence</code> to me"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1509665618, "post_id": 47085908, "comment_id": 81122061, "body": "@n.m. You should promote that comment to an answer!"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1509665740, "post_id": 47085908, "comment_id": 81122097, "body": "This isn&#39;t really <code>sequence</code> at all, is it? We don&#39;t want <code>m [a]</code>, we want to fold it up, probably with something like <code>foldM</code>, but it&#39;s hard to tell because the types given in the question are impossible."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1509665781, "post_id": 47085908, "comment_id": 81122110, "body": "I would avoid trying to do this, because it means <code>f</code> needs to accept a variable number of parameters, and that&#39;s not usually very practical. Let <code>f</code> accept a list as a single parameter instead."}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 1, "creation_date": 1509686226, "post_id": 47085908, "comment_id": 81127189, "body": "For what it&#39;s worth, values of type <code>IO a</code> and <code>Maybe a</code>, etc. are not typically called &quot;monads&quot;, and calling them that will definitely cause a <i>lot</i> of confusion if you are ever asking for help.  The <code>IO</code> type and the <code>Maybe</code> type themselves are typically called Monads.  Values of type &#39;IO a&#39; are not monads...there isn&#39;t a common word for them, but a some people call them &quot;motes&quot;."}, {"owner": {"reputation": 4565, "user_id": 1134885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c428466054762cf7d4b5fb5f4396fa2?s=128&d=identicon&r=PG", "display_name": "NovaDenizen", "link": "https://stackoverflow.com/users/1134885/novadenizen"}, "edited": false, "score": 0, "creation_date": 1509720091, "post_id": 47085908, "comment_id": 81146423, "body": "Maybe try to describe what you want to do in higher-level wording.  What you&#39;re actually describing here at a low level doesn&#39;t make sense."}], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 4, "last_activity_date": 1509665869, "creation_date": 1509665869, "answer_id": 47086293, "question_id": 47085908, "link": "https://stackoverflow.com/questions/47085908/how-do-i-monad-an-arbitrary-number-of-monads-together-in-haskell/47086293#47086293", "title": "How do I monad an arbitrary number of Monads together in Haskell?", "body": "<p>The type</p>\n\n<pre><code>x :: Monad a =&gt; [a]\n</code></pre>\n\n<p>is impossible: you cannot have such a thing, because Monad needs a type parameter. You probably mean</p>\n\n<pre><code>x :: Monad m =&gt; [m a]\n</code></pre>\n\n<p>After that, the next problem is: what is the type of <code>y</code>? It takes a function <code>f</code>, and that <code>f</code> somehow accepts any number of arguments? That doesn't sound right, which is why GHC is complaining about the infinite type: <code>f</code>'s type must contain as a subterm the type of <code>f</code> itself.</p>\n\n<p>Perhaps you mean something more like <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Control-Monad.html#v:foldM\" rel=\"nofollow noreferrer\"><code>foldM</code></a>? Whether or not <code>foldM</code> is what you need after all, your search will be easier once you nail down the correct types of the functions you're after.</p>\n"}], "owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 47086293, "answer_count": 1, "score": 1, "last_activity_date": 1509665869, "creation_date": 1509663484, "question_id": 47085908, "link": "https://stackoverflow.com/questions/47085908/how-do-i-monad-an-arbitrary-number-of-monads-together-in-haskell", "title": "How do I monad an arbitrary number of Monads together in Haskell?", "body": "<p>Let's say I have</p>\n\n<pre><code>x :: Monad a =&gt; [a]\nx = [item1, item2, item3, ...]\n</code></pre>\n\n<p>And I want to do for these:</p>\n\n<pre><code>y f = f &lt;$&gt; item1 &lt;*&gt; item2 &lt;*&gt; item3 &lt;*&gt; item4 &lt;*&gt; ...\n</code></pre>\n\n<p>Previously I've tried this for doing it with ZipLists:</p>\n\n<pre><code>zipf' x (y:z) = getZipList $ foldl (&lt;*&gt;) (x &lt;$&gt; y) z\n</code></pre>\n\n<p>But it unfortunately returned this:</p>\n\n<pre><code>&lt;interactive&gt;:94:36: error:\n\u2022 Occurs check: cannot construct the infinite type: a1 ~ a -&gt; a1\n  Expected type: ZipList a1 -&gt; ZipList a -&gt; ZipList a1\n    Actual type: ZipList (a -&gt; a1) -&gt; ZipList a -&gt; ZipList a1\n\u2022 In the first argument of \u2018foldl\u2019, namely \u2018(&lt;*&gt;)\u2019\n  In the second argument of \u2018($)\u2019, namely \u2018foldl (&lt;*&gt;) (x &lt;$&gt; y) z\u2019\n  In the expression: getZipList $ foldl (&lt;*&gt;) (x &lt;$&gt; y) z\n\u2022 Relevant bindings include\n    z :: [ZipList a] (bound at &lt;interactive&gt;:94:12)\n    y :: ZipList a (bound at &lt;interactive&gt;:94:10)\n    x :: a -&gt; a1 (bound at &lt;interactive&gt;:94:7)\n    zipf' :: (a -&gt; a1) -&gt; [ZipList a] -&gt; [a1]\n      (bound at &lt;interactive&gt;:94:1)\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack", "ghcjs"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1509663502, "post_id": 47085877, "comment_id": 81121414, "body": "The package which the linker cannot find is <a href=\"https://packages.debian.org/search?keywords=libtinfo-dev\" rel=\"nofollow noreferrer\">this one</a>. Do you have it installed?"}, {"owner": {"reputation": 105, "user_id": 8876236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420bdedde72dc3263d569e715e9f9def?s=128&d=identicon&r=PG&f=1", "display_name": "user8876236", "link": "https://stackoverflow.com/users/8876236/user8876236"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1509668345, "post_id": 47085877, "comment_id": 81122832, "body": "@user2407038 Thanks for pointing out the Debian package <code>libtinfo-dev</code>.  When I do <code>stack setup</code> after installing that package it gets by that error.  Now I get &quot;fatal: program node is required but could not be found at node&quot;.  I will install node and try again."}, {"owner": {"reputation": 105, "user_id": 8876236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420bdedde72dc3263d569e715e9f9def?s=128&d=identicon&r=PG&f=1", "display_name": "user8876236", "link": "https://stackoverflow.com/users/8876236/user8876236"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1509670429, "post_id": 47085877, "comment_id": 81123375, "body": "I have installed nodejs using the Debian package manager but when I try <code>stack setup</code> I am still getting the same error message.  So I am not sure what it is referring to when it says node."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1509682397, "post_id": 47085877, "comment_id": 81126260, "body": "Different distros call the executable either node or nodejs, IIRC. You may need to create a symlink for the other name"}, {"owner": {"reputation": 105, "user_id": 8876236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420bdedde72dc3263d569e715e9f9def?s=128&d=identicon&r=PG&f=1", "display_name": "user8876236", "link": "https://stackoverflow.com/users/8876236/user8876236"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1509709217, "post_id": 47085877, "comment_id": 81139084, "body": "@MichaelSnoyman yes you are right.  In Debian there is another package that symlinks nodejs to node called <code>nodejs-legacy</code>.  After installing that I am able to do finish <code>stack setup</code> and also <code>stack build</code>.  And the alert saying &quot;hello from GHCJS!&quot; pops up when I open the index.html in the executables directory.  So it is working now."}], "answers": [{"tags": [], "owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "is_accepted": false, "score": 1, "last_activity_date": 1536958472, "creation_date": 1536958472, "answer_id": 52339111, "question_id": 47085877, "link": "https://stackoverflow.com/questions/47085877/compiling-haskell-to-javascript-using-ghcjs-and-haskell-stack/52339111#52339111", "title": "Compiling Haskell to JavaScript using GHCJS and Haskell Stack", "body": "<p>\"<code>Linking .stack-work/dist/x86_64-linux/Cabal-1.24.0.0/build/ghcjs-pkg/ghcjs-pkg ...\n/usr/bin/ld: cannot find -ltinfo</code>\"</p>\n\n<p>You are missing the <code>libtinfo</code> library which is part of ncurses. Depending on your environment try something like:</p>\n\n<p><code>sudo apt-get install libtinfo-dev</code></p>\n\n<hr>\n\n<p>As an aside, getting all the pieces that <code>ghcjs</code> needs to build successfully is tricky and not well documented as of September 2018.  One might hope that as the project matures it will get easier to install, and that a binary package will be produced. Know that you are not the only person who has these issues. It takes some patience and trial-and-error to get <code>ghcjs</code> working right now.</p>\n\n<p>Others have had success using <a href=\"https://nixos.org/nix/\" rel=\"nofollow noreferrer\">nix</a>, <a href=\"https://xkcd.com/927/\" rel=\"nofollow noreferrer\">I did not</a>.</p>\n"}], "owner": {"reputation": 105, "user_id": 8876236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420bdedde72dc3263d569e715e9f9def?s=128&d=identicon&r=PG&f=1", "display_name": "user8876236", "link": "https://stackoverflow.com/users/8876236/user8876236"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1536958472, "creation_date": 1509663218, "question_id": 47085877, "link": "https://stackoverflow.com/questions/47085877/compiling-haskell-to-javascript-using-ghcjs-and-haskell-stack", "title": "Compiling Haskell to JavaScript using GHCJS and Haskell Stack", "body": "<p>How can Haskell be compiled to Javascript using GHCJS and Haskell Stack?</p>\n\n<p>I have the current version of Haksell Stack <code>1.5.1</code>.</p>\n\n<p>I can initialize a GHCJS project with this command:  <code>stack new ghcjsSetup ghcjs</code></p>\n\n<p>Once in the project directory I try following the <a href=\"https://docs.haskellstack.org/en/stable/ghcjs/#ghcjs\" rel=\"nofollow noreferrer\">Stack documentation for GHCJS</a>.</p>\n\n<p>I create a <code>stack.yaml</code> file and edit it to match the example from the documentation so that is looks like this.</p>\n\n<pre><code>resolver: lts-7.19\ncompiler: ghcjs-0.2.1.9007019_ghc-8.0.1\ncompiler-check: match-exact\n\nsetup-info:\n  ghcjs:\n    source:\n      ghcjs-0.2.1.9007019_ghc-8.0.1:\n        url: http://ghcjs.tolysz.org/ghc-8.0-2017-02-05-lts-7.19-9007019.tar.gz\n        sha1: d2cfc25f9cda32a25a87d9af68891b2186ee52f9\n</code></pre>\n\n<p>Following the documentation further I try to install and boot GHCJS with this command:</p>\n\n<p><code>stack setup</code></p>\n\n<p>This command produces an output which ends with an error.</p>\n\n<pre><code>Preparing to install GHCJS to an isolated location.\nThis will not interfere with any system-level installation.\nPreparing to download ghcjs-0.2.1.9007019_ghc-8.0.1 ...\nAlready downloaded.\nUnpacking GHCJS into /home/u/.stack/programs/x86_64-linux/ghcjs-0.2.1.9007019_ghc-8.0.1/src/ ...\nSetting up GHCJS build environment\nInstalling GHCJS (this will take a long time) ...\nghcjs-0.2.1.9007019: configure (lib + exe)\nPackage ghcjs uses a custom Cabal build, but does not use a custom-setup stanza\nUsing the explicit setup deps approach based on configuration\nStrongly recommend fixing the package's cabal file\n[1 of 2] Compiling Main             ( /home/u/.stack/programs/x86_64-linux/ghcjs-0.2.1.9007019_ghc-8.0.1/src/Setup.hs, /home/u/.stack/programs/x86_64-linux/ghcjs-0.2.1.9007019_ghc-8.0.1/src/.stack-work/dist/x86_64-linux/Cabal-1.24.0.0/setup/Main.o )\n[2 of 2] Compiling StackSetupShim   ( /home/u/.stack/setup-exe-src/setup-shim-mPHDZzAJ.hs, /home/u/.stack/programs/x86_64-linux/ghcjs-0.2.1.9007019_ghc-8.0.1/src/.stack-work/dist/x86_64-linux/Cabal-1.24.0.0/setup/StackSetupShim.o )\nLinking /home/u/.stack/programs/x86_64-linux/ghcjs-0.2.1.9007019_ghc-8.0.1/src/.stack-work/dist/x86_64-linux/Cabal-1.24.0.0/setup/setup ...\nConfiguring ghcjs-0.2.1.9007019...\nghcjs-0.2.1.9007019: build (lib + exe)\nPreprocessing library ghcjs-0.2.1.9007019...\n\n/home/u/.stack/programs/x86_64-linux/ghcjs-0.2.1.9007019_ghc-8.0.1/src/src/Compiler/JMacro/Base.hs:1:55: warning:\n    -XOverlappingInstances is deprecated: instead use per-instance pragmas OVERLAPPING/OVERLAPPABLE/OVERLAPS\n\n/home/u/.stack/programs/x86_64-linux/ghcjs-0.2.1.9007019_ghc-8.0.1/src/src/Compiler/JMacro/QQ.hs:1:55: warning:\n    -XOverlappingInstances is deprecated: instead use per-instance pragmas OVERLAPPING/OVERLAPPABLE/OVERLAPS\n[ 1 of 50] Compiling GHCJS.Prim.TH.Serialized ( lib/ghcjs-prim/GHCJS/Prim/TH/Serialized.hs, .stack-work/dist/x86_64-linux/Cabal-1.24.0.0/build/GHCJS/Prim/TH/Serialized.o )\n</code></pre>\n\n<p>Because it is too long to post here I have excluded the middle of the output.  Which includes lots of warning messages.</p>\n\n<pre><code>[49 of 50] Compiling Compiler.Program ( src/Compiler/Program.hs, .stack-work/dist/x86_64-linux/Cabal-1.24.0.0/build/Compiler/Program.o )\n[50 of 50] Compiling GHCJS            ( src/GHCJS.hs, .stack-work/dist/x86_64-linux/Cabal-1.24.0.0/build/GHCJS.o )\nPreprocessing executable 'ghcjs' for ghcjs-0.2.1.9007019...\n[1 of 1] Compiling Main             ( src-bin/Main.hs, .stack-work/dist/x86_64-linux/Cabal-1.24.0.0/build/ghcjs/ghcjs-tmp/Main.o )\nLinking .stack-work/dist/x86_64-linux/Cabal-1.24.0.0/build/ghcjs/ghcjs ...\nPreprocessing executable 'ghcjs-boot' for ghcjs-0.2.1.9007019...\n[1 of 1] Compiling Main             ( src-bin/Boot.hs, .stack-work/dist/x86_64-linux/Cabal-1.24.0.0/build/ghcjs-boot/ghcjs-boot-tmp/Main.o )\n\n/home/u/.stack/programs/x86_64-linux/ghcjs-0.2.1.9007019_ghc-8.0.1/src/src-bin/Boot.hs:690:1: warning: [-Wtabs]\n    Tab character found here, and in three further locations.\n    Please use spaces instead.\nLinking .stack-work/dist/x86_64-linux/Cabal-1.24.0.0/build/ghcjs-boot/ghcjs-boot ...\nPreprocessing executable 'ghcjs-pkg' for ghcjs-0.2.1.9007019...\n[1 of 1] Compiling Main             ( src-bin/Pkg.hs, .stack-work/dist/x86_64-linux/Cabal-1.24.0.0/build/ghcjs-pkg/ghcjs-pkg-tmp/Main.o )\nLinking .stack-work/dist/x86_64-linux/Cabal-1.24.0.0/build/ghcjs-pkg/ghcjs-pkg ...\n/usr/bin/ld: cannot find -ltinfo\ncollect2: error: ld returned 1 exit status\n`gcc' failed in phase `Linker'. (Exit code: 1)\n\n--  While building package ghcjs-0.2.1.9007019 using:\n      /home/u/.stack/programs/x86_64-linux/ghcjs-0.2.1.9007019_ghc-8.0.1/src/.stack-work/dist/x86_64-linux/Cabal-1.24.0.0/setup/setup --builddir=.stack-work/dist/x86_64-linux/Cabal-1.24.0.0 build lib:ghcjs exe:ghcjs exe:ghcjs-boot exe:ghcjs-pkg exe:ghcjs-run exe:haddock-ghcjs exe:hsc2hs-ghcjs --ghc-options \" -ddump-hi -ddump-to-file\"\n    Process exited with code: ExitFailure 1\n</code></pre>\n"}, {"tags": ["haskell", "lexer", "parsec", "parser-combinators", "megaparsec"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1509691178, "post_id": 47085271, "comment_id": 81128863, "body": "Isn&#39;t this basically the same problem you&#39;re going to have with comments? There are characters in the input stream that you wish to pretend don&#39;t exist, but still need to be tracked for accurate line and column numbers. How do you handle comments? Can you handle these escape sequences in the same way?"}, {"owner": {"reputation": 507, "user_id": 4966887, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b2d9b78341809c8b9b01ac9ae3f3c72?s=128&d=identicon&r=PG&f=1", "display_name": "Chirs", "link": "https://stackoverflow.com/users/4966887/chirs"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1509701550, "post_id": 47085271, "comment_id": 81134192, "body": "@amalloy: It&#39;s not exactly the same. Handling comments happens inside our <code>lexeme</code> combinator which first executes another parser and then consumes all whitespace after the token. Note that comments can only appear between tokens, hence handling it in <code>lexeme</code> is sufficient. In contrast, <code>\\\\\\n</code> can appear anywhere, even inside a string literal or a decimal etc..."}, {"owner": {"reputation": 4565, "user_id": 1134885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c428466054762cf7d4b5fb5f4396fa2?s=128&d=identicon&r=PG", "display_name": "NovaDenizen", "link": "https://stackoverflow.com/users/1134885/novadenizen"}, "edited": false, "score": 0, "creation_date": 1509720604, "post_id": 47085271, "comment_id": 81146752, "body": "The C preprocessor is annoyingly resilient against functional refactoring.  Keep in mind you&#39;ll probably eventually want to handle <code>#line</code> directives too.  So I think maybe you&#39;ll need to pair your chars and identifiers up with some kind of <code>LocationSpan</code> type."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 2, "creation_date": 1509737940, "post_id": 47085271, "comment_id": 81156897, "body": "Perhaps you could wrap <code>ParsecT</code> in a newtype and write a modified <code>MonadParsec</code> instance for it, one in which functions like <code>token</code> and <code>tokens</code> skipped line splices. That way you wouldn&#39;t need to modify &quot;derived&quot; combinators like <code>string</code>."}, {"owner": {"reputation": 507, "user_id": 4966887, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b2d9b78341809c8b9b01ac9ae3f3c72?s=128&d=identicon&r=PG&f=1", "display_name": "Chirs", "link": "https://stackoverflow.com/users/4966887/chirs"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1511619920, "post_id": 47085271, "comment_id": 81928850, "body": "@danidiaz, We haven&#39;t implemented it as our instructor told us to skip this part of the specification, but I think this is the cleanest way to do it. Thank you for the suggestion! If you add this is an answer I will accept it."}], "owner": {"reputation": 507, "user_id": 4966887, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b2d9b78341809c8b9b01ac9ae3f3c72?s=128&d=identicon&r=PG&f=1", "display_name": "Chirs", "link": "https://stackoverflow.com/users/4966887/chirs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 333, "favorite_count": 2, "answer_count": 0, "score": 8, "last_activity_date": 1509659916, "creation_date": 1509659916, "question_id": 47085271, "link": "https://stackoverflow.com/questions/47085271/elegant-way-to-parse-line-splices-backslashes-followed-by-a-newline-in-megap", "title": "Elegant way to parse &quot;line splices&quot; (backslashes followed by a newline) in megaparsec", "body": "<p>for a small compiler project we are currently working on implementing a compiler for a subset of C for which we decided to use Haskell and megaparsec. Overall we made good progress but there are still some corner cases that we cannot correctly handle yet. One of them is the treatment of backslashes followed by a newline. To quote from the specification:</p>\n\n<blockquote>\n  <p>Each instance of a backslash character () immediately followed by a\n  new-line character is deleted, splicing physical source lines to form\n  logical source lines. Only the last backslash on any physical source\n  line shall be eligible for being part of such a splice.\n  (\u00a75.1.1., ISO/IEC9899:201x)</p>\n</blockquote>\n\n<p>So far we came up with two possible approaches to this problem:</p>\n\n<p>1.) Implement a pre-lexing phase in which the initial input is reproduced and every occurence of <code>\\\\\\n</code> is removed. The big disadvantage we see in this approach is that we loose accurate error locations which we need.</p>\n\n<p>2.) Implement a special <code>char'</code> combinator that behaves like <code>char</code> but looks an extra character ahead and will silently consume any <code>\\\\\\n</code>. This would give us correct positions. The disadvantage here is that we need to replace <em>every</em> occurence of <code>char</code> with <code>char'</code> in any parser, even in the megaparsec-provided ones like <code>string</code>, <code>integer</code>, <code>whitespace</code> etc...</p>\n\n<p>Most likely we are not the first people trying to parse a language with such a \"quirk\" with parsec/megaparsec, so I could imagine that there is some nicer way to do it. Does anyone have an idea?</p>\n"}, {"tags": ["haskell", "module"], "answers": [{"comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 2, "creation_date": 1509649768, "post_id": 47082803, "comment_id": 81115025, "body": "Some other notes: it is not an error to have two clashing names in scope, only when you try to use them. If a module exports only a handful of clashing names you can do <code>import ... hiding ...</code>. You don&#39;t actually need qualified imports to disambiguate calls, it&#39;s just more verbose, e.g. <code>Prelude.last</code> and <code>Data.ByteString.last</code>."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 4, "last_activity_date": 1509649333, "creation_date": 1509649333, "answer_id": 47082803, "question_id": 47082451, "link": "https://stackoverflow.com/questions/47082451/what-modules-in-haskell-require-a-qualified-import/47082803#47082803", "title": "What Modules in Haskell require a qualified import?", "body": "<p>There can be a potentially infinite number of such modules since there can be limitless numbers of packages each of which can supply limitless numbers of modules. The common ones you'll see around are in (I'm making this a wiki so others can edit):</p>\n\n<ul>\n<li>containers - The <code>Data.{Map,Set}</code> and other modules intentionally reuse many commonly-named operations.</li>\n<li>unordered-containers - The <code>Data.{HashMap,HashSet}</code> reuse many of the same function names such as <code>lookup</code>.</li>\n</ul>\n"}], "owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "closed_date": 1509651503, "accepted_answer_id": 47082803, "answer_count": 1, "score": -1, "last_activity_date": 1509649333, "creation_date": 1509648099, "question_id": 47082451, "link": "https://stackoverflow.com/questions/47082451/what-modules-in-haskell-require-a-qualified-import", "closed_reason": "Needs more focus", "title": "What Modules in Haskell require a qualified import?", "body": "<p>I know there are some modules where the functions overlap with Prelude or another standard Module.\nWhich ones are these?</p>\n"}, {"tags": ["haskell", "haskell-stack", "ghcjs"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 8876236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420bdedde72dc3263d569e715e9f9def?s=128&d=identicon&r=PG&f=1", "display_name": "user8876236", "link": "https://stackoverflow.com/users/8876236/user8876236"}, "edited": false, "score": 1, "creation_date": 1509654664, "post_id": 47082240, "comment_id": 81117530, "body": "You are right I did not have the most current version of Stack.  I upgraded stack using <code>stack upgrade</code> and added the new binary it showed in it&#39;s output to my PATH variable.  Then the command <code>stack new projectName ghcjs</code> worked and initialized a GHCJS project for me.  Thanks"}, {"owner": {"reputation": 131, "user_id": 218582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rthpZ.png?s=128&g=1", "display_name": "Kuznero", "link": "https://stackoverflow.com/users/218582/kuznero"}, "edited": false, "score": 0, "creation_date": 1533106137, "post_id": 47082240, "comment_id": 90218325, "body": "It doesn&#39;t look like it works any more (v1.7.1) - <a href=\"https://github.com/commercialhaskell/stack/issues/1390\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/1390</a>"}], "tags": [], "owner": {"reputation": 674, "user_id": 7478655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UL7XU.jpg?s=128&g=1", "display_name": "vrom911", "link": "https://stackoverflow.com/users/7478655/vrom911"}, "is_accepted": true, "score": 3, "last_activity_date": 1509647218, "creation_date": 1509647218, "answer_id": 47082240, "question_id": 47082079, "link": "https://stackoverflow.com/questions/47082079/initializing-a-new-ghcjs-project-using-the-haskell-tool-stack/47082240#47082240", "title": "Initializing a new GHCJS project using the Haskell Tool Stack", "body": "<p>I've got the same error recently. Apparently you've got an old version of <code>stack</code>. You need to upgrade it to version <code>&gt;= 1.5.1</code>. This error occurs because of some file format changes in <code>Cabal ver. 2.0</code> as I think.</p>\n"}], "owner": {"reputation": 105, "user_id": 8876236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420bdedde72dc3263d569e715e9f9def?s=128&d=identicon&r=PG&f=1", "display_name": "user8876236", "link": "https://stackoverflow.com/users/8876236/user8876236"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 47082240, "answer_count": 1, "score": 4, "last_activity_date": 1509647218, "creation_date": 1509646588, "question_id": 47082079, "link": "https://stackoverflow.com/questions/47082079/initializing-a-new-ghcjs-project-using-the-haskell-tool-stack", "title": "Initializing a new GHCJS project using the Haskell Tool Stack", "body": "<p>What do I need to do to initialize a GHCJS project using Haskell Stack?</p>\n\n<p>Following the <a href=\"https://docs.haskellstack.org/en/stable/GUIDE/#stack-new\" rel=\"nofollow noreferrer\">stack documentation</a> I am trying to initialize a GHCJS project so that I can compile Haskell code to JavaScript.</p>\n\n<p>After doing <code>stack templates</code> I see there is a GHCJS template</p>\n\n<pre><code>ghcjs - Haskell to JavaScript compiler, based on GHC\n</code></pre>\n\n<p>When I try using the new command with this template like this:</p>\n\n<p><code>stack new ghcjsSetup ghcjs</code></p>\n\n<p>I get this error message:</p>\n\n<pre><code>Downloading template \"ghcjs\" to create project \"ghcjsSetup\" in ghcjsSetup/ ...\n\nThe following parameters were needed by the template but not provided: author-email, author-name, category, copyright, github-username\nYou can provide them in /home/u/.stack/config.yaml, like this:\ntemplates:\n  params:\n    author-email: value\n    author-name: value\n    category: value\n    copyright: value\n    github-username: value\nOr you can pass each one as parameters like this:\nstack new ghcjsSetup ghcjs -p \"author-email:value\" -p \"author-name:value\" -p \"category:value\" -p \"copyright:value\" -p \"github-username:value\"\n\nLooking for .cabal or package.yaml files to use to init the project.\nUsing cabal packages:\n- ghcjsSetup/ghcjsSetup.cabal\n\nSelecting the best among 11 snapshots...\n\n* Partially matches lts-9.11\n    ghcjs-base not found\n        - ghcjsSetup requires -any\n\nDownloaded nightly-2017-11-01 build plan.    \nUnable to parse cabal file: FromString \"This package requires at least Cabal version 2.0\" Nothing\n</code></pre>\n"}]