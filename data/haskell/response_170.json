[{"tags": ["c", "haskell"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8174234"}, "edited": false, "score": 0, "creation_date": 1523501374, "post_id": 49785721, "comment_id": 86589621, "body": "As a starter: for loops in C are maps in functional programming, and while loops are recursion. I suspect your C does not need to be &quot;translated&quot; at all, rather you need to look for a functional solution in the first place."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1523558835, "post_id": 49785721, "comment_id": 86622297, "body": "As much as I understand you might need help in learning Haskell, StackOverflow is not a code-writing service. This question would be better if you focused on loops specifically, or gave an attempt."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1523541964, "post_id": 49786078, "comment_id": 86611926, "body": "\u201cin a functional language, like Haskell, the compiler is able to optimize the recursion away into a loop\u201d \u2013 that&#39;s a little bit misleading. Yes, often the compiler can do this, but there&#39;s no guarantee that any given loop translated somehow into recursion will get transformed back to a loop efficiently. Also, a recursive \u201cloop\u201d often is rather harder to read than a straightout imperative loop. Usually, the best replacement for loops are higher-order functions such as traversals and strict folds."}], "tags": [], "owner": {"reputation": 1101, "user_id": 7021836, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/299fc62810116e741333419b8e6cfd24?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Quilliam", "link": "https://stackoverflow.com/users/7021836/alex-quilliam"}, "is_accepted": false, "score": 0, "last_activity_date": 1523542013, "last_edit_date": 1523542013, "creation_date": 1523491602, "answer_id": 49786078, "question_id": 49785721, "link": "https://stackoverflow.com/questions/49785721/calculating-multiples-in-haskell-conversion-from-c/49786078#49786078", "title": "Calculating multiples in Haskell (conversion from C)?", "body": "<p>You'll have to use <a href=\"https://stackoverflow.com/questions/14820138/understanding-recursion-in-haskell\">recursion</a> in place of loops. </p>\n\n<p>In (most) procedural or object-orientated languages, you should hardly ever (never?) be using recursion. It is horribly inefficient, as a new stack frame must be created each time the recursive function is called.</p>\n\n<p>However, in a functional language, like Haskell, the compiler is often able to optimize the recursion away into a loop, which makes it much faster then its procedural counterparts.</p>\n\n<p>I've converted your <code>sieve</code> function into a set of recursive functions in C. I'll leave it to you to convert it into Haskell:</p>\n\n<pre><code>int main(void) {\n    //...\n    int root = sqrt(PRIME_RANGE);\n    primes[primeCnt++] = 2;\n\n    sieve(3, PRIME_RANGE, root);\n    //...\n}\n\nvoid sieve(int i, int end, int root) {\n    if(i &gt; end) {\n        return;\n    }\n\n    if(!primeFlag[i]) {\n        primes[primeCnt++] = i;\n\n        if(root &gt;= i) {\n            markMultiples(i * i, PRIME_RANGE, i);\n        }\n    }\n\n    i += 2;\n    sieve(i, end, root);\n}\n\nvoid markMultiples(int j, int end, int prime) {\n    if(j &gt; end) {\n        return;\n    }\n\n    primeFlag[j] = 1;\n    j += i &lt;&lt; 1;\n\n    markMultiples(j, end, prime);\n}\n</code></pre>\n\n<p>The point of recursion is that the same function is called repeatedly, until a condition is met. The results of one recursive call are passed onto the next call, until the condition is met.</p>\n\n<p>Also, why are you bit-fiddling instead of just multiplying or dividing by 2? Any half-decent compiler these days can convert most multiplications and divisions by 2 into a bit-shift.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9633039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LpImq.jpg?s=128&g=1", "display_name": "detroitfriedchicken", "link": "https://stackoverflow.com/users/9633039/detroitfriedchicken"}, "edited": false, "score": 1, "creation_date": 1523498372, "post_id": 49786192, "comment_id": 86588960, "body": "The amount of multiples between numbers should not duplicate. So, since 6 is a multiple of both 2 and 3, 6 should only be recorded once. I think when I tested your code, it duplicated values that should have only been recorded once."}, {"owner": {"reputation": 116, "user_id": 9125440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f51c164abdd132a04e38276a2b1d48?s=128&d=identicon&r=PG&f=1", "display_name": "chessai", "link": "https://stackoverflow.com/users/9125440/chessai"}, "reply_to_user": {"reputation": 11, "user_id": 9633039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LpImq.jpg?s=128&g=1", "display_name": "detroitfriedchicken", "link": "https://stackoverflow.com/users/9633039/detroitfriedchicken"}, "edited": false, "score": 0, "creation_date": 1523537741, "post_id": 49786192, "comment_id": 86608660, "body": "i edited the post to reflect this"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1523553872, "post_id": 49786192, "comment_id": 86619733, "body": "For <code>[y | y &lt;- [1..b], y `mod` x == 0]</code>, consider <code>[x,x+x .. b]</code> instead. You might also find <a href=\"http://hackage.haskell.org/package/data-ordlist\" rel=\"nofollow noreferrer\">data-ordlist</a> interesting, as it doesn&#39;t require converting to <code>Set</code> and could potentially give you the infinite list of multiples."}, {"owner": {"reputation": 116, "user_id": 9125440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f51c164abdd132a04e38276a2b1d48?s=128&d=identicon&r=PG&f=1", "display_name": "chessai", "link": "https://stackoverflow.com/users/9125440/chessai"}, "edited": false, "score": 0, "creation_date": 1523554183, "post_id": 49786192, "comment_id": 86619854, "body": "I switched to using [x, x+x .. b], it resulted in a relatively large speedup. Also, I think it&#39;s worth it to use IntSet here."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1523555458, "post_id": 49786192, "comment_id": 86620518, "body": "(For comparison, this technique scales to large <i>a</i> more cleanly than mine, but scales to large <i>b</i> much less cleanly.)"}, {"owner": {"reputation": 116, "user_id": 9125440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f51c164abdd132a04e38276a2b1d48?s=128&d=identicon&r=PG&f=1", "display_name": "chessai", "link": "https://stackoverflow.com/users/9125440/chessai"}, "edited": false, "score": 0, "creation_date": 1523556338, "post_id": 49786192, "comment_id": 86620974, "body": "I was just about to comment that! I think there is a way to better the complexity of this using <code>-XLinearHaskell</code>, but I&#39;m not sure if it&#39;ll work out. Let me think of something concrete before elaborating. Also, using a strict left version of <code>foldMap</code> would be a good way to increase the speed of this."}, {"owner": {"reputation": 116, "user_id": 9125440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f51c164abdd132a04e38276a2b1d48?s=128&d=identicon&r=PG&f=1", "display_name": "chessai", "link": "https://stackoverflow.com/users/9125440/chessai"}, "edited": false, "score": 0, "creation_date": 1523556855, "post_id": 49786192, "comment_id": 86621221, "body": "the technique seems to not take longer than 1second until b=3x10^6, for a = 131"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1523561458, "post_id": 49786192, "comment_id": 86623617, "body": "Another thought: it is probably cheaper to track the numbers which are <i>not</i> multiples, using set difference at each step of the fold (and starting with the set of odd numbers). This way both the size of the set being folded in decreases and the size of the accumulator decreases; by comparison here the size of the set being folded in decreases as iteration goes on, but the size of the set of all multiples is increasing as iteration continues."}], "tags": [], "owner": {"reputation": 116, "user_id": 9125440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f51c164abdd132a04e38276a2b1d48?s=128&d=identicon&r=PG&f=1", "display_name": "chessai", "link": "https://stackoverflow.com/users/9125440/chessai"}, "is_accepted": true, "score": 2, "last_activity_date": 1523557688, "last_edit_date": 1523557688, "creation_date": 1523492661, "answer_id": 49786192, "question_id": 49785721, "link": "https://stackoverflow.com/questions/49785721/calculating-multiples-in-haskell-conversion-from-c/49786192#49786192", "title": "Calculating multiples in Haskell (conversion from C)?", "body": "<p><strike>First, unless I'm grossly misunderstanding, the number of multiples you have there is wrong. The number of multiples of 2 between 1 and 30 is 15, and the number of multiples of 3 between 1 and 30 is 10, so there should be 25 numbers there.</strike></p>\n\n<p>EDIT: I did misunderstand; you want unique multiples.</p>\n\n<p>To get unique multiples, you can use Data.Set, which has the invariant that the elements of the Set are unique and ordered ascendingly.</p>\n\n<p>If you know you aren't going to exceed <code>x = maxBound :: Int</code>, you can get even better speedups using Data.IntSet. I've also included some test cases and annotated with comments what they run at on my machine.</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\n\n{-# OPTIONS_GHC -O2 #-}\n\nmodule Main (main) where\n\nimport System.CPUTime (getCPUTime)\nimport Data.IntSet (IntSet)\nimport qualified Data.IntSet as IntSet\n\nmain :: IO ()\nmain = do\n  test 3 30       -- 0.12 ms\n  test 131 132    -- 0.14 ms\n  test 500 300000 -- 117.63 ms\n\ntest :: Int -&gt; Int -&gt; IO ()\ntest !a !b = do\n  start &lt;- getCPUTime\n  print (numMultiples a b)\n  end   &lt;- getCPUTime\n  print $ \"Needed \" ++ show ((fromIntegral (end - start)) / 10^9) ++ \" ms.\\n\"\n\nnumMultiples :: Int -&gt; Int -&gt; Int\nnumMultiples !a !b = IntSet.size (foldMap go [2..a])\n  where\n    go :: Int -&gt; IntSet \n    go !x = IntSet.fromAscList [x, x+x .. b]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1523513352, "post_id": 49788622, "comment_id": 86593155, "body": "Some additional commentary: even without compiling, this appears to be quite a bit faster than the C code, less memory-hungry, and less wrong; e.g. <code>f&#39; 131 132</code> takes 0.2s and 130MB to print 131, whereas the C code compiled with optimizations takes 0.6s and 650MB to print 130. Compiling the Haskell code brings the time under measurement noise and memory usage to under 4MB."}, {"owner": {"reputation": 116, "user_id": 9125440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f51c164abdd132a04e38276a2b1d48?s=128&d=identicon&r=PG&f=1", "display_name": "chessai", "link": "https://stackoverflow.com/users/9125440/chessai"}, "edited": false, "score": 0, "creation_date": 1523545847, "post_id": 49788622, "comment_id": 86614849, "body": "I like this answer a lot. Do you happen to know what the computational complexity is?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 116, "user_id": 9125440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f51c164abdd132a04e38276a2b1d48?s=128&d=identicon&r=PG&f=1", "display_name": "chessai", "link": "https://stackoverflow.com/users/9125440/chessai"}, "edited": false, "score": 1, "creation_date": 1523553601, "post_id": 49788622, "comment_id": 86619601, "body": "@chessai The main cost is in enumerating divisors. Taking arithmetic to be constant-time for the moment, this can in general take 2^pi(a) time for sufficiently large b, where pi is the <a href=\"https://en.wikipedia.org/wiki/Prime-counting_function\" rel=\"nofollow noreferrer\">prime-counting function</a>. In more familiar terms, a/log a is a pretty decent approximation to pi(a), so we land just shy of doubly-exponential in the size of the first argument (and the second argument makes no difference asymptotically)."}, {"owner": {"reputation": 116, "user_id": 9125440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f51c164abdd132a04e38276a2b1d48?s=128&d=identicon&r=PG&f=1", "display_name": "chessai", "link": "https://stackoverflow.com/users/9125440/chessai"}, "edited": false, "score": 0, "creation_date": 1523557028, "post_id": 49788622, "comment_id": 86621286, "body": "This is super cool. I want to optimise this and save both solutions somewhere."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1523514411, "last_edit_date": 1523514411, "creation_date": 1523510737, "answer_id": 49788622, "question_id": 49785721, "link": "https://stackoverflow.com/questions/49785721/calculating-multiples-in-haskell-conversion-from-c/49788622#49788622", "title": "Calculating multiples in Haskell (conversion from C)?", "body": "<p>\nI'm not really into understanding your C, so I implemented a solution afresh using <a href=\"https://math.stackexchange.com/a/2326463/139921\">the algorithm discussed here</a>. The <em>N</em> in the linked algorithm is the product of the primes up to <em>a</em> in your problem description.</p>\n\n<p>So first we'll need a list of primes. There's a standardish trick for getting a list of primes that is at once very idiomatic and relatively efficient:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>primes :: [Integer]\nprimes = 2:filter isPrime [3..]\n\n-- Doesn't work right for n&lt;2, but we never call it there, so who cares?\nisPrime :: Integer -&gt; Bool\nisPrime n = go primes n where\n    go (p:ps) n | p*p&gt;n = True\n                | otherwise = n `rem` p /= 0 &amp;&amp; go ps n\n</code></pre>\n\n<p>Next up: we want a way to iterate over the positive square-free divisors of <em>N</em>. This can be achieved by iterating over the subsets of the primes less than <em>a</em>. There's a standard idiomatic way to get a powerset, namely:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- import Control.Monad\n-- powerSet :: [a] -&gt; [[a]]\n-- powerSet = filterM (const [False, True])\n</code></pre>\n\n<p>That would be a fine component to use, but since at the end of the day we only care about the product of each powerset element and the value of the Mobius function of that product, we would end up duplicating a lot of multiplications and counting problems. It's cheaper to compute those two things directly while producing the powerset. So:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- Given the prime factorization of a square-free number, produce a list of\n-- its divisors d together with mu(d).\ndivisorsWithMu :: Num a =&gt; [a] -&gt; [(a, a)]\ndivisorsWithMu [] = [(1, 1)]\ndivisorsWithMu (p:ps) = rec ++ [(p*d, -mu) | (d, mu) &lt;- rec] where\n    rec = divisorsWithMu ps\n</code></pre>\n\n<p>With that in hand, we can just iterate and do a little arithmetic.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>f :: Integer -&gt; Integer -&gt; Integer\nf a b = b - sum\n    [ mu * (b `div` d)\n    | (d, mu) &lt;- divisorsWithMu (takeWhile (&lt;=a) primes)\n    ]\n</code></pre>\n\n<p>And that's all the code. Crunched 137 lines of C down to 15 lines of Haskell -- not bad! Try it out in ghci:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; f 3 30\n20\n</code></pre>\n\n<p>As an additional optimization, one could consider modifying <code>divisorsWithMu</code> to short-circuit when its divisor is bigger than <em>b</em>, as we know such terms will not contribute to the final sum. This makes a noticeable difference for large <em>a</em>, as without it there are exponentially many elements in the powerset. Here's how that modification looks:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- Given an upper bound and the prime factorization of a square-free number,\n-- produce a list of its divisors d that are no larger than the upper bound\n-- together with mu(d).\ndivisorsWithMuUnder :: (Ord a, Num a) =&gt; a -&gt; [a] -&gt; [(a, a)]\ndivisorsWithMuUnder n [] = [(1, 1)]\ndivisorsWithMuUnder n (p:ps) = rec ++ [(p*d, -mu) | (d, mu) &lt;- rec, p*d&lt;=n]\n    where rec = divisorsWithMuUnder n ps\n\nf' :: Integer -&gt; Integer -&gt; Integer\nf' a b = b - sum\n    [ mu * (b `div` d)\n    | (d, mu) &lt;- divisorsWithMuUnder b (takeWhile (&lt;=a) primes)\n    ]\n</code></pre>\n\n<p>Not much more complicated; the only really interesting difference is that there's now a condition in the list comprehension. Here's an example of <code>f'</code> finishing quickly for inputs that would take infeasibly long with <code>f</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; f' 100 100000\n88169\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1523560447, "last_edit_date": 1523560447, "creation_date": 1523558670, "answer_id": 49803847, "question_id": 49785721, "link": "https://stackoverflow.com/questions/49785721/calculating-multiples-in-haskell-conversion-from-c/49803847#49803847", "title": "Calculating multiples in Haskell (conversion from C)?", "body": "<p>With data-ordlist package mentioned by Daniel Wagner in the comments, it is just</p>\n\n<pre><code>f a b = length $ unionAll [ [p,p+p..b] | p &lt;- takeWhile (&lt;= a) primes]\n</code></pre>\n\n<p>That is all. Some timings, for non-compiled code run inside GHCi:</p>\n\n<pre><code>~&gt; f 100 (10^5)\n88169\n(0.05 secs, 48855072 bytes)\n\n~&gt; f 131 (3*10^6)\n2659571\n(0.55 secs, 1493586480 bytes)\n\n~&gt; f 131 132\n131\n(0.00 secs, 0 bytes)\n\n~&gt; f 500 300000\n274055\n(0.11 secs, 192704760 bytes)\n</code></pre>\n\n<p>Compiling will surely make the memory consumption a non-issue, by converting the <code>length</code> to a counting loop.</p>\n"}], "owner": {"reputation": 11, "user_id": 9633039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LpImq.jpg?s=128&g=1", "display_name": "detroitfriedchicken", "link": "https://stackoverflow.com/users/9633039/detroitfriedchicken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 552, "favorite_count": 0, "closed_date": 1523558760, "accepted_answer_id": 49786192, "answer_count": 4, "score": 0, "last_activity_date": 1523698625, "creation_date": 1523488578, "last_edit_date": 1523698625, "question_id": 49785721, "link": "https://stackoverflow.com/questions/49785721/calculating-multiples-in-haskell-conversion-from-c", "closed_reason": "Needs more focus", "title": "Calculating multiples in Haskell (conversion from C)?", "body": "<p>I'm trying to write a Haskell program that calculates multiples. Basically, when given two integers a and b, I want to find how many integers 1 \u2264 bi \u2264 b are multiple of any integer 2 \u2264 ai \u2264 a. For example, if a = 3 and b = 30, I want to know how many integers in the range of 1-30 are a multiple of 2 or 3; there are 20 such integers: 2, 3, 4, 6, 8, 9, 10, 12, 14, 15, 16, 18, 20, 21, 22, 24, 26, 27, 28, 30.</p>\n\n<p>I have a C program that does this. I'm trying to get this translated into Haskell, but part of the difficulty is getting around the loops that I've used since Haskell doesn't use loops. I appreciate any and all help in translating this!</p>\n\n<p>My C program for reference (sorry if formatting is off):</p>\n\n<pre><code>#define PRIME_RANGE 130\n#define PRIME_CNT   32\n\n#define UPPER_LIMIT (1000000000000000ull) //10^15\n#define MAX_BASE_MULTIPLES_COUNT  25000000\n\ntypedef struct\n{\n    char primeFactorFlag;\n    long long multiple;\n}multipleInfo;\n\nunsigned char primeFlag[PRIME_RANGE + 1];\nint primes[PRIME_CNT];\nint primeCnt = 0;\n\nint maxPrimeStart[PRIME_CNT];\nmultipleInfo baseMultiples[MAX_BASE_MULTIPLES_COUNT];\nmultipleInfo mergedMultiples[MAX_BASE_MULTIPLES_COUNT];\nint baseMultiplesCount, mergedMultiplesCount;\n\nvoid findOddMultiples(int a, long long b, long long *count);\nvoid generateBaseMultiples(void);\nvoid mergeLists(multipleInfo listSource[], int countS, multipleInfo    \n\nlistDest[], int *countD);\nvoid sieve(void);\n\nint main(void)\n{\n\n    int i, j, a, n, startInd, endInd;\n    long long b, multiples;\n\n    //Generate primes\n    sieve();\n    primes[primeCnt] = PRIME_RANGE + 1;\n\n    generateBaseMultiples();\n    baseMultiples[baseMultiplesCount].multiple = UPPER_LIMIT + 1;\n\n    //Input and Output\n    scanf(\"%d\", &amp;n);\n    for(i = 1; i &lt;= n; i++)\n    {\n        scanf(\"%d%lld\", &amp;a, &amp;b);\n\n        //If b &lt;= a, all are multiple except 1\n        if(b &lt;= a)\n            printf(\"%lld\\n\",b-1);\n        else\n        {\n            //Add all even multiples\n            multiples = b / 2;\n            //Add all odd multiples\n            findOddMultiples(a, b, &amp;multiples);-\n\n            printf(\"%lld\\n\", multiples);\n        }\n    }\n    return 0;\n}\n\nvoid findOddMultiples(int a, long long b, long long *count)\n{\n    int i, k;\n    long long currentNum;\n\n    for(k = 1; k &lt; primeCnt &amp;&amp; primes[k] &lt;= a; k++)\n    {\n        for(i = maxPrimeStart[k]; i &lt; maxPrimeStart[k + 1] &amp;&amp;         \n\nbaseMultiples[i].multiple &lt;= b; i++)\n        {\n            currentNum = b/baseMultiples[i].multiple;\n            currentNum = (currentNum  + 1) &gt;&gt; 1; // remove even multiples\n            if(baseMultiples[i].primeFactorFlag) //odd number of factors\n                (*count) += currentNum;\n            else\n                (*count) -= currentNum;\n        }\n    }\n}\n\nvoid addTheMultiple(long long value, int primeFactorFlag)\n{\n    baseMultiples[baseMultiplesCount].multiple = value;\n    baseMultiples[baseMultiplesCount].primeFactorFlag = primeFactorFlag;\n    baseMultiplesCount++;\n}\n\nvoid generateBaseMultiples(void)\n{\n    int i, j, t, prevCount;\n    long long curValue;\n\n    addTheMultiple(3, 1);\n     mergedMultiples[0] = baseMultiples[0];\n    mergedMultiplesCount = 1;\n\n    maxPrimeStart[1] = 0;\n    prevCount = mergedMultiplesCount;\n    for(i = 2; i &lt; primeCnt; i++)\n    {\n        maxPrimeStart[i] = baseMultiplesCount;\n        addTheMultiple(primes[i], 1);\n        for(j = 0; j &lt; prevCount; j++)\n        {\n            curValue = mergedMultiples[j].multiple * primes[i];\n            if(curValue &gt; UPPER_LIMIT)\n                break;\n\n            addTheMultiple(curValue, 1 - mergedMultiples[j].primeFactorFlag);\n        }\n        if(i &lt; primeCnt - 1)\n            mergeLists(&amp;baseMultiples[prevCount], baseMultiplesCount - prevCount, mergedMultiples, &amp;mergedMultiplesCount);\n\n        prevCount = mergedMultiplesCount;\n    }\n    maxPrimeStart[primeCnt] = baseMultiplesCount;\n}\n\nvoid mergeLists(multipleInfo listSource[], int countS, multipleInfo listDest[], int *countD)\n{\nint limit = countS + *countD;\nint i1, i2, j, k;\n\n//Copy one list in unused safe memory\nfor(j = limit - 1, k = *countD - 1; k &gt;= 0; j--, k--)\n    listDest[j] = listDest[k];\n\n//Merge the lists\nfor(i1 = 0, i2 = countS, k = 0; i1 &lt; countS &amp;&amp; i2 &lt; limit; k++)\n{\n\n    if(listSource[i1].multiple &lt;= listDest[i2].multiple)\n        listDest[k] = listSource[i1++];\n    else\n        listDest[k] = listDest[i2++];\n}\n\nwhile(i1 &lt; countS)\n    listDest[k++] = listSource[i1++];\n\n\nwhile(i2 &lt; limit)\n    listDest[k++] = listDest[i2++];\n\n*countD = k;\n}\n\nvoid sieve(void)\n{\n   int i, j, root = sqrt(PRIME_RANGE);\n    primes[primeCnt++] = 2;\n    for(i = 3; i &lt;= PRIME_RANGE; i+= 2)\n    {\n        if(!primeFlag[i])\n        {\n            primes[primeCnt++] = i;\n            if(root &gt;= i)\n            {\n                for(j = i * i; j &lt;= PRIME_RANGE; j += i &lt;&lt; 1)\n                primeFlag[j] = 1;\n        }\n    }\n}\n}\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "edited": false, "score": 1, "creation_date": 1523485681, "post_id": 49785135, "comment_id": 86586009, "body": "Test <code>getPoints</code> separately, e.g. <code>getPoints [1,2]</code>"}, {"owner": {"reputation": 35, "user_id": 9633019, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0eBNE.png?s=128&g=1", "display_name": "jaMAN", "link": "https://stackoverflow.com/users/9633019/jaman"}, "reply_to_user": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "edited": false, "score": 0, "creation_date": 1523486789, "post_id": 49785135, "comment_id": 86586337, "body": "getPoints works, it gets the four vertices as it should be seems to pass and extra empty list."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1523487778, "post_id": 49785135, "comment_id": 86586617, "body": "<code>getPoints</code> doesn&#39;t work; indeed, it will throw an error for every possible input."}, {"owner": {"reputation": 35, "user_id": 9633019, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0eBNE.png?s=128&g=1", "display_name": "jaMAN", "link": "https://stackoverflow.com/users/9633019/jaman"}, "edited": false, "score": 0, "creation_date": 1523488380, "post_id": 49785135, "comment_id": 86586773, "body": "How would it be changed to not throw an error when it&#39;s called?"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1523488342, "creation_date": 1523488342, "answer_id": 49785683, "question_id": 49785135, "link": "https://stackoverflow.com/questions/49785135/sending-method-empty-list-when-it-should-contain-2-elements-haskell/49785683#49785683", "title": "Sending method empty list when it should contain 2 elements Haskell", "body": "<p>The empty list comes from here:</p>\n\n<pre><code>getPoints (k:v:t) = (fromIntegral k, fromIntegral v) : getPoints t\n--                                                     ^^^^^^^^^^^\n</code></pre>\n\n<p>An empty list matches the pattern <code>t</code>. (Any list at all matches the pattern <code>t</code>.)</p>\n\n<p>How you fix it is up to you, but probably the simplest fix (and also a quite reasonable one) is to replace your base case:</p>\n\n<pre><code>getPoints [] = []\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9633019, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0eBNE.png?s=128&g=1", "display_name": "jaMAN", "link": "https://stackoverflow.com/users/9633019/jaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 49785683, "answer_count": 1, "score": 0, "last_activity_date": 1523488342, "creation_date": 1523484678, "last_edit_date": 1523486325, "question_id": 49785135, "link": "https://stackoverflow.com/questions/49785135/sending-method-empty-list-when-it-should-contain-2-elements-haskell", "title": "Sending method empty list when it should contain 2 elements Haskell", "body": "<p>I'm have this code: </p>\n\n<pre><code>main :: IO ()\nmain = do\nlet list = []\nhandle &lt;- openFile \"polycake.in\" ReadMode\ncontents &lt;- hGetContents handle\nlet singlewords = words contents\n    list = fileToList singlewords\n    n = head list\n    list' = drop 1 list\n    polygons = polyList n list'\nmapM_ print polygons\nhClose handle\n\nfileToList :: [String] -&gt; [Int]\nfileToList = map read\n\npolyList :: Int -&gt; [Int] -&gt; [Polygon]\npolyList n [] = []\npolyList _ [x] = error \"Too few points remaining\"\npolyList n (v:y:list') =\nlet pointList = take (2*v) list' -- Note: list' may not *have* 2*v points\n    points = getPoints pointList\n    list'' = drop (2*v) list'\n    -- Calc Perim Here\n    --Just (under, over) = calcPerim (fromIntegral y) points :: Maybe \n(Length, Length)\n    poly = Polygon { v = v, y = y, points = points}\n    nextPoly = polyList (n-1) list''\nin (poly:nextPoly)\n\ngetPoints :: [Int] -&gt; [Point]\ngetPoints [] = error \"Can't create a point (None)\"\ngetPoints [_] = error \"Can't create a point (Only One)\"\ngetPoints (k:v:t) = (fromIntegral k, fromIntegral v) : getPoints t\n</code></pre>\n\n<p>But getPoints is getting an an Empty List. After all vertices are read in, the last pair should be the last call to getPoints but it seems like it's sending another call with the empty list.</p>\n\n<pre><code>    Polygon {v = 4, y = 2, points = [(0.0,0.0),(4.0,0.0),(4.0,4.0),(0.0,4.0)polycake.hs: Can't create point (None)\n    CallStack (from HasCallStack):\n    error, called at polycake.hs:54:16 in main:Main\n</code></pre>\n\n<p>Here's the sample input:</p>\n\n<pre><code> 2\n 4 2\n 0 0\n 4 0\n 4 4\n 0 4\n 6 10\n 3 15\n 10 1\n 12 5\n 11 19\n 9 23\n 6 20\n</code></pre>\n\n<p>Where the first line is the amount of Polygons to make, the first value of the second line is the amount of vertices in the Polygon and the second value is a value used in calculations. So 4, 2 on the second line means 4 vertices, taking the next 4 lines as vertex pairs. 6, 10 creates the next Polygon with 6 vertices etc.</p>\n\n<p>I'm just unsure where the empty list is coming from to try and create the points.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523477093, "post_id": 49783579, "comment_id": 86582572, "body": "should <code>x1 &lt;= x2</code>, or was this just an attempt to perform <i>symmetry breaking</i>."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 2, "creation_date": 1523477271, "post_id": 49783579, "comment_id": 86582670, "body": "try <code>nub</code> from Data.List."}, {"owner": {"reputation": 49, "user_id": 9394155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83fe762642d13352b0cdbd24feffcbce?s=128&d=identicon&r=PG&f=1", "display_name": "derpnallday", "link": "https://stackoverflow.com/users/9394155/derpnallday"}, "edited": false, "score": 0, "creation_date": 1523477344, "post_id": 49783579, "comment_id": 86582716, "body": "yes, I am trying to avoid the repeated symmetric solution"}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1523477505, "post_id": 49783579, "comment_id": 86582801, "body": "btw: With imperative programming there is an <i>O(n log n)</i> algorithm which does this. Yours is <i>O(n^2)</i>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 1, "creation_date": 1523478270, "post_id": 49783579, "comment_id": 86583188, "body": "@Elmex80s: in Haskell as well, given we use <code>HashSet</code>s (and hashsets <i>can</i> be implemented in <i>pure</i> functional programming)."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1523478378, "post_id": 49783579, "comment_id": 86583245, "body": "@Elmex80s why do you think that has anything to do with imperative programming? You can sort and scan from both ends in O(n log n) time without ever involving imperative programming."}], "answers": [{"comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1523493247, "post_id": 49783750, "comment_id": 86587895, "body": "Is <code>tails</code> supposed to be applied to <code>xs</code>?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1523518226, "post_id": 49783750, "comment_id": 86595793, "body": "@4castle: yes, since then we iterate over the list of tails (but it starts with the full list) so we can pattern match an element <code>x1</code>, and <code>x2s</code> is the list of remaining elements."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 6, "last_activity_date": 1523536396, "last_edit_date": 1523536396, "creation_date": 1523477571, "answer_id": 49783750, "question_id": 49783579, "link": "https://stackoverflow.com/questions/49783579/haskell-finding-tuples-of-elements-that-equal-n/49783750#49783750", "title": "Haskell: finding tuples of elements that equal n", "body": "<h1>Symmetry breaking in tuple generation</h1>\n\n<p>I have the impression that you are looking for a way to select two elements out of the list such that <code>x1</code> is always located <em>before</em> <code>x2</code>.</p>\n\n<p>A common way to always let <code>x2</code> iterate over the remainder of the list is by using <a href=\"http://hackage.haskell.org/package/base-4.11.0.0/docs/Data-List.html#v:tails\" rel=\"nofollow noreferrer\"><strong><code>tails :: [a] -&gt; [[a]]</code></strong></a>. For a list, <code>tails</code> will generate a list of all tails of the list, starting with the list itself. For example:</p>\n\n<pre><code>Prelude Data.List&gt; tails [1, 4, 2, 5]\n[[1,4,2,5],[4,2,5],[2,5],[5],[]]\n</code></pre>\n\n<p>We can use this with pattern matching to select one element, and get a reference to the remaining element. For example:</p>\n\n<pre><code>import Data.List(tails)\n\ntuplesum :: (Eq b, Num b) =&gt; [b] -&gt; b -&gt; [(b, b)]\ntuplesum xs n = [(x1,x2) | (x1:x2s) &lt;- tails xs, x2 &lt;- x2s, x1 + x2 == n]\n</code></pre>\n\n<p>Note that it is still possible to obtain duplicates here, for example if <code>5</code> would occur three times in the list, since in that case <code>x1</code> can select the first <code>5</code>, and then <code>x2</code> can select the second <code>5</code> as well as the last one. We can make use of a uniqness filter like <a href=\"http://hackage.haskell.org/package/base-4.11.0.0/docs/Data-List.html#v:nub\" rel=\"nofollow noreferrer\"><strong><code>nub :: Eq a =&gt; [a] -&gt; [a]</code></strong></a> for this:</p>\n\n<pre><code>import Data.List(nub, tails)\n\ntuplesum :: (Eq b, Num b) =&gt; [b] -&gt; b -&gt; [(b, b)]\ntuplesum xs n = nub [(x1,x2) | (x1:x2s) &lt;- tails xs, x2 &lt;- x2s, x1 + x2 == n]\n</code></pre>\n\n<p>Note that it is however still better to use <code>tails</code> here, since it will increase performance, since we will simply generate a smaller amount of duplicates in the first place.</p>\n\n<h1>Using a hashset to obtain the \"other\" element</h1>\n\n<p>The above algorithm is still <em>O(n<sup>2</sup>)</em>, and not very fast. We can however solve the problem the other way around: we can first construct a <code>HashSet</code> of the elements, and the for each element <code>x1</code>, check if <code>n - x1</code> is a member, like:</p>\n\n<pre><code>import Data.Hashable(Hashable)\nimport Data.HashSet(fromList, member)\n\ntuplesum :: (Ord b, Hashable b, Num b) =&gt; [b] -&gt; b -&gt; [(b, b)]\ntuplesum xs n = nub [(x1,x2) | x1 &lt;- xs, let x2 = n-x1, x1 &lt;= x2, member x2 hs]\n    where hs = fromList xs\n</code></pre>\n\n<p>But the runtime is still <em>O(n<sup>2</sup>)</em> because of the <code>nub</code>, we can however use a <a href=\"https://hackage.haskell.org/package/universum-0.9.0/docs/src/Nub.html#hashNub\" rel=\"nofollow noreferrer\"><strong><code>hashNub :: (Eq a, Hashable a) =&gt; [a] -&gt; [a]</code></strong></a> here:</p>\n\n<blockquote>\n<pre><code>hashNub :: (Eq a, Hashable a) =&gt; [a] -&gt; [a]\nhashNub = go HashSet.empty\n  where\n    go _ []     = []\n    go s (x:xs) =\n      if x `HashSet.member` s\n      then go s xs\n      else x : go (HashSet.insert x s) xs\n</code></pre>\n</blockquote>\n\n<p>and then let it work with:</p>\n\n<pre><code>import Data.Hashable(Hashable)\nimport Data.HashSet(fromList, member)\n\ntuplesum :: (Ord b, Hashable b, Num b) =&gt; [b] -&gt; b -&gt; [(b, b)]\ntuplesum xs n = hashNub [(x1,x2) | x1 &lt;- xs, let x2 = n-x1, x1 &lt;= x2, member x2 hs]\n    where hs = fromList xs\n</code></pre>\n\n<p>Now it works in <em>O(n log n)</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": 0, "last_activity_date": 1525742288, "last_edit_date": 1525742288, "creation_date": 1525533819, "answer_id": 50191052, "question_id": 49783579, "link": "https://stackoverflow.com/questions/49783579/haskell-finding-tuples-of-elements-that-equal-n/50191052#50191052", "title": "Haskell: finding tuples of elements that equal n", "body": "<p>I just really liked your function <code>tuplesum xs n = [(x1,x2) | x1 &lt;- xs, x2 &lt;- xs, x1 + x2 == n, x1 &lt;= x2]</code> because it is a Cartesian product and it eliminates most symmetrical pairs that would otherwise constitute about half. It gets the predicate matches so very well. The only problem remaining is the duplicate elements. I had forgotten about this until recently and Pg. 86 of  <strong>Graham Hutton</strong>'s <strong>\"Programming in Haskell\"</strong> and his <code>rmdups</code> function. What I like about his <code>rmdups</code> is that it neither depends on imports.</p>\n\n<pre><code>rmdups :: Eq a =&gt; [a] -&gt; [a]\nrmdups [] = []\nrmdups (x:xs) = x : filter (/= x) (rmdups xs)\n</code></pre>\n\n<p>Hutton's solution is wonderfully general and classically recursive. I did not want to post his solution here without adding something original so here is a list comprehension to eliminate duplicates of any data type including tuples.</p>\n\n<pre><code>rmdups ls = [d|(z,d)&lt;- zip [0..] ls, notElem d $ take z ls]\n</code></pre>\n\n<p>You can place either <code>rmdups</code> function in front of your function <code>rmdups.tuplesum</code>\nYour function eliminates most symmetrical pairs so <code>rmdups</code> does not.</p>\n\n<pre><code>rmdups [(5,5),(5,5),(1,9),(4,6),(5,5),(5,5)]\n</code></pre>\n\n<p>[(5,5),(1,9),(4,6)]</p>\n\n<p>Or</p>\n\n<pre><code>rmdups \"abcabcdefdef\" OR \"abcdefabcdef\"\n</code></pre>\n\n<p>\"abcdef\"</p>\n"}], "owner": {"reputation": 49, "user_id": 9394155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83fe762642d13352b0cdbd24feffcbce?s=128&d=identicon&r=PG&f=1", "display_name": "derpnallday", "link": "https://stackoverflow.com/users/9394155/derpnallday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1525742288, "creation_date": 1523476891, "last_edit_date": 1523477194, "question_id": 49783579, "link": "https://stackoverflow.com/questions/49783579/haskell-finding-tuples-of-elements-that-equal-n", "title": "Haskell: finding tuples of elements that equal n", "body": "<p>I am trying to write a function in Haskell that takes a list of integers and an integer n and finds all tuples that equal n. So far I have an implementation that works</p>\n\n<pre><code>tuplesum :: (Eq b, Num b) =&gt; [b] -&gt; b -&gt; [(b, b)]\ntuplesum xs n = [(x1,x2) | x1 &lt;- xs, x2 &lt;- xs, x1 + x2 == n, x1 &lt;= x2]\n</code></pre>\n\n<p>so if I gave this function the input </p>\n\n<pre><code>tuplesum [5,1,4,0,5,6,9] 10\n</code></pre>\n\n<p>the output is\n    <code>[(5,5),(5,5),(1,9),(4,6),(5,5),(5,5)]</code>\nHowever, I have 4 duplicates of the (5,5) solution. I would like the function to output <code>[(5,5),(1,9),(4,6)]</code>but I cant figure out how to constrain tuples that have the same integers without removing it as a solution entirely.</p>\n"}, {"tags": ["haskell", "monad-transformers", "state-monad"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523471549, "post_id": 49782175, "comment_id": 86579646, "body": "Is there a reason why you name this <code>Stack</code>?"}, {"owner": {"reputation": 329, "user_id": 4547023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b3ad48a35396696ce806bbb7b382fe?s=128&d=identicon&r=PG&f=1", "display_name": "Ultimate Pea", "link": "https://stackoverflow.com/users/4547023/ultimate-pea"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523472969, "post_id": 49782175, "comment_id": 86580384, "body": "I named it <code>Stack</code> to suggest a monad transformer <code>stack</code>."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1523473011, "post_id": 49782175, "comment_id": 86580404, "body": "In that case it shouldn&#39;t have a hardcoded <code>()</code> as value type."}, {"owner": {"reputation": 329, "user_id": 4547023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b3ad48a35396696ce806bbb7b382fe?s=128&d=identicon&r=PG&f=1", "display_name": "Ultimate Pea", "link": "https://stackoverflow.com/users/4547023/ultimate-pea"}, "edited": false, "score": 0, "creation_date": 1523480114, "post_id": 49782175, "comment_id": 86584035, "body": "I agree. Not hardcoding would be clearer if the transformer is used in a polymorphic way."}], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 7, "last_activity_date": 1523472402, "creation_date": 1523472402, "answer_id": 49782427, "question_id": 49782175, "link": "https://stackoverflow.com/questions/49782175/haskell-chaining-two-states-using-statet-monad-transformers/49782427#49782427", "title": "Haskell -- Chaining two states using StateT monad transformers", "body": "<p><a href=\"https://www.stackage.org/haddock/lts-11.4/mtl-2.2.2/Control-Monad-State-Class.html#t:MonadState\" rel=\"noreferrer\">The definition of <code>MonadState</code></a> has a functional dependency <code>m -&gt; s</code>, which means that one monad <code>m</code> must have at most one instance of <code>MonadState s m</code>. Or, in plainer terms, the same monad cannot have two instances of <code>MonadState</code> for two different states, which is exactly what you're trying to do.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1523477117, "last_edit_date": 1523477117, "creation_date": 1523476527, "answer_id": 49783479, "question_id": 49782175, "link": "https://stackoverflow.com/questions/49782175/haskell-chaining-two-states-using-statet-monad-transformers/49783479#49783479", "title": "Haskell -- Chaining two states using StateT monad transformers", "body": "<p>There is a simpler solution:</p>\n\n<pre><code>apply :: (MonadTuple (t m), MonadBool m, MonadTrans t) =&gt; t m ()\napply = undefined\n</code></pre>\n\n<p>You can use <code>get</code> and <code>put</code> inside <code>apply</code> to touch the <code>(Int, Int)</code> state, and <code>lift get</code> and <code>lift . put</code> to touch the <code>Bool</code> state.</p>\n\n<p>However, this requires that <code>StateT (Int, Int)</code> be the top-level transformer. If it is lower than the top, you need to encode the depth by putting the appropriate number of additional transformers in your type; e.g. if it was the third thing down then you would need</p>\n\n<pre><code>apply :: (MonadTuple (t1 (t2 (t3 m))), MonadBool m, MonadTrans t1, MonadTrans t2, MonadTrans t3) =&gt; t1 (t2 (t3 m)) ()\napply = undefined\n</code></pre>\n\n<p>and would need to use three <code>lift</code>s for every access to the <code>Bool</code> state, which quickly gets unwieldy and really loses the charm of mtl-style class-polymorphic programming.</p>\n\n<p>A common alternative style is to expose an API that touches the two states but is not class polymorphic. For example,</p>\n\n<pre><code>type Stack = StateT (Int, Int) (StateT Bool IO)\n\ngetTuple :: Stack (Int, Int)\ngetTuple = get\n\ngetBool :: Stack Bool\ngetBool = lift get\n</code></pre>\n\n<p>(Similarly you'd add a <code>putTuple</code> and <code>putBool</code>.)</p>\n\n<p>I guess with modern extensions you could also consider introducing your own class which does not have the fundep that <code>MonadState</code> has; e.g.</p>\n\n<pre><code>class MonadState2 s m where\n    get2 :: m s\n    put2 :: s -&gt; m ()\n</code></pre>\n\n<p>You could then use a newtype to give two instances, to be disambiguated by type:</p>\n\n<pre><code>newtype Stack a = Stack (StateT (Int, Int) (StateT Bool IO) a)\ninstance MonadState2 Bool Stack where\n    get2 = Stack (lift get)\n    put2 = Stack . lift . put\n\ninstance MonadState2 (Int, Int) Stack where\n    get2 = Stack get\n    put2 = Stack . put\n</code></pre>\n\n<p>Callers would then write e.g. <code>get2 @Bool</code> or <code>get2 @(Int, Int)</code> if type inference didn't have enough information to pick which instance to use. But I suspect this would get old real fast.</p>\n"}], "owner": {"reputation": 329, "user_id": 4547023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b3ad48a35396696ce806bbb7b382fe?s=128&d=identicon&r=PG&f=1", "display_name": "Ultimate Pea", "link": "https://stackoverflow.com/users/4547023/ultimate-pea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 1, "accepted_answer_id": 49782427, "answer_count": 2, "score": 4, "last_activity_date": 1523477117, "creation_date": 1523471483, "question_id": 49782175, "link": "https://stackoverflow.com/questions/49782175/haskell-chaining-two-states-using-statet-monad-transformers", "title": "Haskell -- Chaining two states using StateT monad transformers", "body": "<p>I have two or more independent states to track in one Haskell application.</p>\n\n<p>I am declaring two new type classes using </p>\n\n<pre><code>type MonadTuple m = MonadState (Int, Int) m\ntype MonadBool m = MonadState Bool m\n</code></pre>\n\n<p>The monad transformer stack is declared as </p>\n\n<pre><code>type Stack = StateT (Int, Int) (StateT Bool IO) ()\n</code></pre>\n\n<p>I intend to use the stack as such</p>\n\n<pre><code>ret :: Stack\nret = apply\n\napply :: (MonadTuple m, MonadBool m) =&gt; m ()\napply = undefined\n</code></pre>\n\n<p>The complier is unhappy because it cannot match <code>Bool</code> with <code>(Int, Int)</code> when trying to check if <code>Stack</code> conforms to <code>MonadBool</code>.</p>\n\n<p>I am aware of the solution given in the <a href=\"https://stackoverflow.com/questions/13915923/combining-multiple-states-in-statet\">Combining multiple states in StateT</a>. Are there any simpler solutions other than <strong>arrows</strong> or <strong>global state with lens</strong>?</p>\n\n<p>Appendix:\nThe full code block is </p>\n\n<pre><code>{-# LANGUAGE ConstraintKinds #-}\n{-# LANGUAGE FlexibleContexts #-}\n\nimport Control.Monad.State.Class\nimport Control.Monad.State.Lazy\n\ntype MonadTuple m = MonadState (Int, Int) m\ntype MonadBool m = MonadState Bool m\n\ntype Stack = StateT (Int, Int) (StateT Bool IO) ()\n\nret :: Stack\nret = apply\n\napply :: (MonadTuple m, MonadBool m) =&gt; m ()\napply = undefined\n</code></pre>\n"}, {"tags": ["haskell", "functor"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523469134, "post_id": 49781552, "comment_id": 86578409, "body": "It is enough, but you have to add that to the signature of <code>Functor</code> as well, since otherwise the constraints are <i>not</i> satisfied. And this will cause problems since a <code>Functor</code> is a typeclass that specifies that you are allowed to <code>fmap</code> from any <code>a</code> to any <code>b</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523469737, "post_id": 49781552, "comment_id": 86578741, "body": "The point is: say I want to use <code>fmap</code>, then I assume that it has signature <code>Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b</code>, not that there are extra constraints. So these are not &quot;<i>ad hoc</i>&quot; functions where based on <code>f</code> there are extra type constraints."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1523469789, "post_id": 49781552, "comment_id": 86578775, "body": "Put another way, <code>fmap f</code> has to work for <i>all</i> types that <code>Set</code> might create, not just the ones that support equality. It&#39;s the difference between <code>Set a</code> and <code>Eq a =&gt; Set a</code>."}, {"owner": {"reputation": 11, "user_id": 7363624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b9e61ef750831155601d09dcbca10ef?s=128&d=identicon&r=PG&f=1", "display_name": "lux_piromani", "link": "https://stackoverflow.com/users/7363624/lux-piromani"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523470678, "post_id": 49781552, "comment_id": 86579217, "body": "@WillemVanOnsem How should add the constraint to the Functor? I mean, do i have to create a more specific kind of functor?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523470756, "post_id": 49781552, "comment_id": 86579261, "body": "@user7363624: here that will be impossible, since <code>a</code> and <code>b</code> are not part of the <code>Functor</code> class. Only if you could define somthing like <code>Functor (Set a b)</code>, you could have written <code>instance (Eq a, Eq b) =&gt; Functor (Set a b)</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1523471209, "post_id": 49781552, "comment_id": 86579475, "body": "It is well-known that data structures like <code>Set a</code> which require additional constraints on <code>a</code> (e.g. <code>Eq</code> or <code>Ord</code>) can not be members of the <code>Functor</code> typeclass. Simply put, the <code>Functor</code> class requires no constraints at all. We could define a generalization of that class to consider constraints as well, but it won&#39;t be a <code>Functor</code> anyway."}, {"owner": {"reputation": 11, "user_id": 7363624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b9e61ef750831155601d09dcbca10ef?s=128&d=identicon&r=PG&f=1", "display_name": "lux_piromani", "link": "https://stackoverflow.com/users/7363624/lux-piromani"}, "edited": false, "score": 0, "creation_date": 1523471258, "post_id": 49781552, "comment_id": 86579497, "body": "So i guess i should give up on the functor part. I will just use my setMap instead of fmap, not that it really matters since i was just trying out a few things. Thank you both for your answers. Have a nice day"}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1523471927, "last_edit_date": 1523471927, "creation_date": 1523471614, "answer_id": 49782210, "question_id": 49781552, "link": "https://stackoverflow.com/questions/49781552/haskell-data-definition-and-functor-class/49782210#49782210", "title": "Haskell: data definition and Functor class", "body": "<p>A functor is a pair of functions: a type constructor <code>f</code> that maps one type to another, and a function <code>fmap</code> that maps functions of type <code>a -&gt; b</code> to functions of type <code>f a -&gt; f b</code>. There are <em>no</em> restrictions on what <code>a</code> and <code>b</code> are; both <code>f</code> and <code>fmap</code> need to work for all types.</p>\n\n<p><code>Set</code> qualifies as the type constructor; given any type <code>a</code>, it returns a new type <code>Set a</code>.</p>\n\n<p><code>setMap</code>, however, does <em>not</em> work with any two types <code>a</code> and <code>b</code>; it only works with types <code>Eq a =&gt; a</code> and <code>Eq b =&gt; b</code>.</p>\n\n<p>So, the pair <code>Set</code>/<code>setMap</code> is <em>almost</em>, but not quite, a functor from <strong>Hask</strong> to <strong>Hask</strong> (or an endofunctor on <strong>Hask</strong>), which is what the <code>Functor</code> type class represents.  (<strong>Hask</strong> is the somewhat-controversial category defined as the class of all Haskell types and the functions defined on those types.)</p>\n\n<hr>\n\n<p>However, one could define a subcategory of <strong>Hask</strong> called <strong>HaskEq</strong>, whose objects would be all the Haskell types with an <code>Eq</code> instance. Then <code>Set</code>/<code>setMap</code> would be a endofunctor on <strong>HaskEq</strong>, since <code>setMap</code> would be valid for any type in <strong>HaskEq</strong>. There's no easy way to represent <strong>HaskEq</strong> in Haskell, although <strong>Hask</strong> is trivial, as shown in <a href=\"https://hackage.haskell.org/package/base-4.11.0.0/docs/src/Control.Category.html\" rel=\"nofollow noreferrer\"><code>Control.Category</code></a>:</p>\n\n<pre><code>class Category a where\n    id :: cat a a\n    (.) :: cat b c -&gt; cat a b -&gt; cat a c\n\n-- Hask\ninstance Category (-&gt;) where\n    id = GHC.Base.id\n    (.) = (GHC.Base..)\n</code></pre>\n\n<p>But you could define your own type class to represent such endofunctors:</p>\n\n<pre><code>class EqFunctor f where\n    eqfmap :: (Eq a, Eq b) =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n\ninstance EqFunctor Set where\n    eqfmap = setMap\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7363624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b9e61ef750831155601d09dcbca10ef?s=128&d=identicon&r=PG&f=1", "display_name": "lux_piromani", "link": "https://stackoverflow.com/users/7363624/lux-piromani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1523471927, "creation_date": 1523469081, "last_edit_date": 1523469163, "question_id": 49781552, "link": "https://stackoverflow.com/questions/49781552/haskell-data-definition-and-functor-class", "title": "Haskell: data definition and Functor class", "body": "<p>i was trying to define the data type Set but i have problems when i try to instantiate the functor class.</p>\n\n<p>This is my code:</p>\n\n<pre><code>data Set a where\n    Empty :: Eq a =&gt; Set a\n    Add   :: Eq a =&gt; a -&gt; Set a -&gt; Set a\n\ninstance Functor Set where\n    fmap = setMap\n\nsetMap :: (Eq a, Eq b) =&gt; (a-&gt;b) -&gt; Set a -&gt; Set b \nsetMap f Empty = Empty\nsetMap f (Add x set) = Add (f x) $ setMap f set\n</code></pre>\n\n<p>And this is what the compiler says:</p>\n\n<pre><code>    No instance for (Eq a) arising from a use of \u2018setMap\u2019\n      Possible fix:\n        add (Eq a) to the context of\n          the type signature for:\n            fmap :: (a -&gt; b) -&gt; Set a -&gt; Set b\n</code></pre>\n\n<p>Why isn't the constraint in the setMap definition enough? Or, if it is, why is it wrong?</p>\n"}, {"tags": ["haskell", "nested-lists", "cartesian-product"], "comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1523467638, "post_id": 49779758, "comment_id": 86577646, "body": "The accepted answer on the dupe doesn&#39;t answer this question, but many of the dupe&#39;s other answers touch on cartesian products of n&gt;2 lists."}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 3, "last_activity_date": 1523463907, "creation_date": 1523463907, "answer_id": 49780156, "question_id": 49779758, "link": "https://stackoverflow.com/questions/49779758/haskell-how-to-write-a-function-that-produces-every-combinations-of-any-number/49780156#49780156", "title": "Haskell: How to write a function that produces every combinations of any number of lists passed as argument", "body": "<p>if you wrap all your inputs in a list <code>foo==sequence</code></p>\n\n<p>e.g.</p>\n\n<pre><code>&gt; sequence [[0,1], [0,1,2]]\n\n[[0,0],[0,1],[0,2],[1,0],[1,1],[1,2]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 3, "last_activity_date": 1523464478, "creation_date": 1523464478, "answer_id": 49780316, "question_id": 49779758, "link": "https://stackoverflow.com/questions/49779758/haskell-how-to-write-a-function-that-produces-every-combinations-of-any-number/49780316#49780316", "title": "Haskell: How to write a function that produces every combinations of any number of lists passed as argument", "body": "<p>This is <a href=\"http://hackage.haskell.org/package/base-4.11.0.0/docs/Data-Traversable.html#v:sequenceA\" rel=\"nofollow noreferrer\"><code>sequenceA</code></a> or <a href=\"http://hackage.haskell.org/package/base-4.11.0.0/docs/Data-Traversable.html#v:sequence\" rel=\"nofollow noreferrer\"><code>sequence</code></a>. (The former uses <code>[a]</code>'s Applicative instance while the latter uses <code>[a]</code>'s Monad instance, but in this case they're identical). Both are defined in terms of <code>traverse</code>, but let's define it ourselves:</p>\n\n<pre><code>foo = foldr f (pure [])\n  where\n  f x ys = (:) &lt;$&gt; x &lt;*&gt; ys\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9453972, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Unknown", "link": "https://stackoverflow.com/users/9453972/unknown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "closed_date": 1523466699, "answer_count": 2, "score": 0, "last_activity_date": 1582860002, "creation_date": 1523462638, "last_edit_date": 1582860002, "question_id": 49779758, "link": "https://stackoverflow.com/questions/49779758/haskell-how-to-write-a-function-that-produces-every-combinations-of-any-number", "closed_reason": "Duplicate", "title": "Haskell: How to write a function that produces every combinations of any number of lists passed as argument", "body": "<p>So lets say I want a function foo, that takes as argument, any number of lists, and return every combinations of the lists elements.</p>\n\n<p>So for instance, <code>foo [0,1] [0,1,2]</code> would return <code>[[0,0],[0,1],[0,2],[1,0],[1,1],[1,2]]</code></p>\n\n<p>and <code>foo [0,1] [0,1] [0,1]</code> would return <code>[[0,0,0],[0,0,1],[0,1,0],[1,0,0],[1,1,0],[1,0,1]]</code></p>\n\n<p>I was thinking of working recursively, and for the second example for instance, having <code>foo x y = [[a,b]|a &lt;- x, b &lt;- y]</code>, and essentially call <code>foo (foo [1,0] [1,0]) [0,1]</code></p>\n\n<p>But the problem i have right now is that foo returns a list of a list, so the more arguments i give it, the more nested lists it will have and the recursive calls won't work. Does anyone have any idea on how i can approach such a function?</p>\n\n<p>I think working with foo x y is a good idea, so that i can recursively call it on any number of lists. So if i had ls = [[0,1],[0,1],[0,1,2],[0,1,2,3],[0,1,2,3,4]]\nI would call foo on the first two and then on the next one and so on.</p>\n"}, {"tags": ["haskell", "tail-recursion"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523458184, "post_id": 49778203, "comment_id": 86571585, "body": "I think due to laziness, it is rather hard to say whether something is tail recursive. Since we do not really know in advance what will be executed."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1523459399, "post_id": 49778203, "comment_id": 86572535, "body": "...this is pretty clearly tail-recursive, right? (I don&#39;t see the <i>modulo cons</i> connection here either)"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523460158, "post_id": 49778203, "comment_id": 86573107, "body": "@WillemVanOnsem (slightly off-topic, but...) <i>should</i> we care, performance-wise? I was under the impression that what Haskell loses in tail call elimination it makes up for in lazy execution."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1523460317, "post_id": 49778203, "comment_id": 86573234, "body": "@AdamSmith: well I am not talking about tail call <i>optimization</i>. I am only saying that in Haskell it is rather unknown what parts will be evaluated first. Since that depends in what the outer functions are interested. As a result the concept of a &quot;tail call&quot; can be seen as a bit non-sensical."}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 1, "creation_date": 1523472425, "post_id": 49778203, "comment_id": 86580085, "body": "The notion of a tail call makes perfect sense in Haskell. When execution enters a function, it is because the WHNF of the result of that function is needed, and it will be computed by the time the function returns. Laziness only says that evaluation is restricted to WHNF."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523483877, "post_id": 49779161, "comment_id": 86585462, "body": "The join point optimization has certain additional restrictions, doesn&#39;t it?"}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523505073, "post_id": 49779161, "comment_id": 86590409, "body": "Yes, see \u201cNote [Invariants on join points]\u201d in <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/ghc-8.4.1/src/CoreSyn.html\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/latest/docs/html/libraries/ghc-8.&zwnj;&#8203;4.1/&hellip;</a>"}], "tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": true, "score": 9, "last_activity_date": 1523460945, "last_edit_date": 1592644375, "creation_date": 1523460945, "answer_id": 49779161, "question_id": 49778203, "link": "https://stackoverflow.com/questions/49778203/are-functions-with-guards-tail-recursive/49779161#49779161", "title": "Are functions with guards tail recursive", "body": "<p>Yes, it is tail recursive.</p>\n<p>One possible definition for what \u201cTail Recursive\u201d means in the context of Haskell is where calls to \u201cjoin points\u201d are valid, as these may only appear in tail-recursive positions.\nOn page 3 of <a href=\"https://www.microsoft.com/en-us/research/publication/compiling-without-continuations/\" rel=\"noreferrer\"><em>Compiling without Continuations</em></a> we find this figure:</p>\n<p><a href=\"https://i.stack.imgur.com/8JN2g.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/8JN2g.png\" alt=\"Tail contexts\" /></a></p>\n<p>and we see that the right-hand-side of alternatives in a case statement are tail-call positions. We could also find code corresponding to this in the GHC source.</p>\n<p>Together with the <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-460003.13\" rel=\"noreferrer\">desugaring of guards according the Haskell report</a>, which tells us that guards are essentially nested <code>case</code>-expressions, we can conclude that your function is tail-recursive.</p>\n<p>(Although one should say \u201c<code>elem'</code> is tail-recursive as a function of two arguments\u201d \u2013 without specifying the arity, the question makes less sense.)</p>\n"}], "owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 49779161, "answer_count": 1, "score": 4, "last_activity_date": 1523461539, "creation_date": 1523458128, "last_edit_date": 1523459861, "question_id": 49778203, "link": "https://stackoverflow.com/questions/49778203/are-functions-with-guards-tail-recursive", "title": "Are functions with guards tail recursive", "body": "<p>I was wondering if funtions with guards could be tail recursive. Given this implementation of <code>elem</code> for example</p>\n\n<pre><code>elem' :: (Eq a) =&gt; a -&gt; [a] -&gt; Bool\nelem' x [] = False\nelem' x (y:ys)\n    | x == y       = True\n    | otherwise    = elem' x ys\n</code></pre>\n\n<p>Is this tail recursive? I would say yes, but I am somehow not convinced. </p>\n"}, {"tags": ["haskell", "newtype", "deriving", "classy-prelude"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1523455315, "post_id": 49776924, "comment_id": 86569406, "body": "In the future, please include your code and the error in the question itself (not off-site). Making the question self-contained makes it more likely to be useful to future visitors. (I have moved your off-site resources into the question itself for you this time.)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1523456709, "post_id": 49776924, "comment_id": 86570423, "body": "This is a limitation of the role system - it has no way to express that <code>m A</code> is coercible to <code>m B</code> if <code>A</code> is coercible to <code>B</code>, for a type variable <code>m</code>. I&#39;m not sure if there is a workaround for these specific classes (alternate deriving mechanism maybe?)"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1523456801, "post_id": 49776924, "comment_id": 86570492, "body": "@user2407038 Ryan Scott has written about the proposed <code>QuantifiedConstraints</code> feature as a possible solution for this <a href=\"https://ryanglscott.github.io/2018/03/04/how-quantifiedconstraints-can-let-us-put-join-back-in-monad/\" rel=\"nofollow noreferrer\">ryanglscott.github.io/2018/03/04/&hellip;</a>"}, {"owner": {"reputation": 45, "user_id": 8199261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30937294457f71ccf70dbe2fcfc7159b?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Pilz", "link": "https://stackoverflow.com/users/8199261/samuel-pilz"}, "edited": false, "score": 0, "creation_date": 1523463664, "post_id": 49776924, "comment_id": 86575492, "body": "What is the role system? Why is it not possible to automatically? The manual implementation for IsSequence would be simply by delegating everything to the contained list: <code>fromList = X . fromList</code>, <code>filter f (X s) = X $ filter s</code> and so on. Why is this not possible to do automatically?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1523464362, "post_id": 49776924, "comment_id": 86575948, "body": "@SamuelPilz Read the article I linked above, it answers your questions in detail"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1523481274, "post_id": 49776924, "comment_id": 86584504, "body": "See the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#roles\" rel=\"nofollow noreferrer\">user guide</a> for an explanation of what roles are. It isn&#39;t possible because it&#39;s a limitation of the system; this means that in theory it is possible, but in practice it has not yet been implemented."}], "owner": {"reputation": 45, "user_id": 8199261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30937294457f71ccf70dbe2fcfc7159b?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Pilz", "link": "https://stackoverflow.com/users/8199261/samuel-pilz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 197, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1523455221, "creation_date": 1523454685, "last_edit_date": 1523455221, "question_id": 49776924, "link": "https://stackoverflow.com/questions/49776924/newtype-deriving-issequence", "title": "Newtype deriving IsSequence", "body": "<p>I have a newtype <code>X</code>, which is basically a list of Ints. I use ClassyPrelude instead of the standard Prelude and want to derive the IsSequence class. This makes it necessary to also derive lots of other classes.</p>\n\n<p>The language extension GeneralizedNewtypeDeriving should allow this (here used together with the DerivingStrategies extension). I want:</p>\n\n<pre><code>newtype X = X [Int] deriving newtype (MonoFunctor, MonoFoldable, MonoTraversable, Monoid, GrowingAppend, SemiSequence, MonoPointed, IsSequence)\n</code></pre>\n\n<p>full file: </p>\n\n<pre><code>{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n{-# LANGUAGE DerivingStrategies #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE UndecidableInstances #-}\n{-# LANGUAGE NoImplicitPrelude #-}\n{-# LANGUAGE FlexibleContexts #-}\n\nmodule Test where\n\nimport ClassyPrelude\n\nnewtype X = X [Int] deriving newtype (MonoFunctor, MonoFoldable, MonoTraversable, Monoid, GrowingAppend, SemiSequence, MonoPointed, IsSequence)\n\ntype instance Element X = Int\n</code></pre>\n\n<p>(all other language extensions seem to be important)</p>\n\n<p>However, this produces lots of error messages for <code>MonoTraversable</code> and <code>IsSequence</code>:</p>\n\n<pre><code>/path/to/file/Test.hs:13:48: error:\n    \u2022 Couldn't match representation of type \u2018m [Int]\u2019\n                               with that of \u2018m X\u2019\n        arising from the coercion of the method \u2018omapM\u2019\n          from type \u2018forall (m :: * -&gt; *).\n                     Applicative m =&gt;\n                     (Element [Int] -&gt; m (Element [Int])) -&gt; [Int] -&gt; m [Int]\u2019\n            to type \u2018forall (m :: * -&gt; *).\n                     Applicative m =&gt;\n                     (Element X -&gt; m (Element X)) -&gt; X -&gt; m X\u2019\n      NB: We cannot know what roles the parameters to \u2018m\u2019 have;\n        we must assume that the role is nominal\n    \u2022 When deriving the instance for (MonoTraversable X)\n   |\n13 |   deriving newtype (MonoFunctor, MonoFoldable, MonoTraversable, Monoid, GrowingAppend, SemiSequence, MonoPointed, IsSequence)\n   |                                                ^^^^^^^^^^^^^^^\n\n/path/to/file/Test.hs:13:48: error:\n    \u2022 Couldn't match representation of type \u2018f [Int]\u2019\n                               with that of \u2018f X\u2019\n        arising from the coercion of the method \u2018otraverse\u2019\n          from type \u2018forall (f :: * -&gt; *).\n                     Applicative f =&gt;\n                     (Element [Int] -&gt; f (Element [Int])) -&gt; [Int] -&gt; f [Int]\u2019\n            to type \u2018forall (f :: * -&gt; *).\n                     Applicative f =&gt;\n                     (Element X -&gt; f (Element X)) -&gt; X -&gt; f X\u2019\n      NB: We cannot know what roles the parameters to \u2018f\u2019 have;\n        we must assume that the role is nominal\n    \u2022 When deriving the instance for (MonoTraversable X)\n   |\n13 |   deriving newtype (MonoFunctor, MonoFoldable, MonoTraversable, Monoid, GrowingAppend, SemiSequence, MonoPointed, IsSequence)\n   |                                                ^^^^^^^^^^^^^^^\n\n/path/to/file/Test.hs:13:115: error:\n    \u2022 Couldn't match type \u2018[Int]\u2019 with \u2018X\u2019\n        arising from the coercion of the method \u2018initMay\u2019\n          from type \u2018IsSequence [Int] =&gt; [Int] -&gt; Maybe [Int]\u2019\n            to type \u2018IsSequence X =&gt; X -&gt; Maybe X\u2019\n    \u2022 When deriving the instance for (IsSequence X)\n   |\n13 |   deriving newtype (MonoFunctor, MonoFoldable, MonoTraversable, Monoid, GrowingAppend, SemiSequence, MonoPointed, IsSequence)\n   |                                                                                                                   ^^^^^^^^^^\n\n/path/to/file/Test.hs:13:115: error:\n    \u2022 Couldn't match representation of type \u2018m [Int]\u2019\n                               with that of \u2018m X\u2019\n        arising from the coercion of the method \u2018replicateM\u2019\n          from type \u2018forall (m :: * -&gt; *).\n                     Monad m =&gt;\n                     Index [Int] -&gt; m (Element [Int]) -&gt; m [Int]\u2019\n            to type \u2018forall (m :: * -&gt; *).\n                     Monad m =&gt;\n                     Index X -&gt; m (Element X) -&gt; m X\u2019\n      NB: We cannot know what roles the parameters to \u2018m\u2019 have;\n        we must assume that the role is nominal\n    \u2022 When deriving the instance for (IsSequence X)\n   |\n13 |   deriving newtype (MonoFunctor, MonoFoldable, MonoTraversable, Monoid, GrowingAppend, SemiSequence, MonoPointed, IsSequence)\n   |                                                                                                                   ^^^^^^^^^^\n\n/path/to/file/Test.hs:13:115: error:\n    \u2022 Couldn't match representation of type \u2018m [Int]\u2019\n                               with that of \u2018m X\u2019\n        arising from the coercion of the method \u2018filterM\u2019\n          from type \u2018forall (m :: * -&gt; *).\n                     Monad m =&gt;\n                     (Element [Int] -&gt; m Bool) -&gt; [Int] -&gt; m [Int]\u2019\n            to type \u2018forall (m :: * -&gt; *).\n                     Monad m =&gt;\n                     (Element X -&gt; m Bool) -&gt; X -&gt; m X\u2019\n      NB: We cannot know what roles the parameters to \u2018m\u2019 have;\n        we must assume that the role is nominal\n    \u2022 When deriving the instance for (IsSequence X)\n   |\n13 |   deriving newtype (MonoFunctor, MonoFoldable, MonoTraversable, Monoid, GrowingAppend, SemiSequence, MonoPointed, IsSequence)\n   |                                              \n</code></pre>\n\n<p>which I cannot read (maybe it has to do with default signatures?, no idea...). Leaving out the 2 classes from the deriving clause makes the code compile.</p>\n\n<p>Question: how to derive IsSequence in this case?</p>\n\n<p>For several reasons, a type-alias is not possible for my use-case but I want to use the functions provided by these classes. If the deriving is not possible, it would be necessary to implement the class-methods myself.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1523452919, "post_id": 49775913, "comment_id": 86567563, "body": "How would you do the same thing with lists?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1523453469, "post_id": 49775913, "comment_id": 86568002, "body": "Trying to force a Haskell program into the &quot;sequence of statements&quot; model of other languages doesn&#39;t usually lead to A Good Place."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1523453548, "post_id": 49775913, "comment_id": 86568062, "body": "Your last edit completely changed the question, please don&#39;t do that."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 7622546, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/114f99ab836aa7687d9967c509d9d390?s=128&d=identicon&r=PG&f=1", "display_name": "Strobe00", "link": "https://stackoverflow.com/users/7622546/strobe00"}, "edited": false, "score": 0, "creation_date": 1523453728, "post_id": 49776305, "comment_id": 86568186, "body": "Thank you! This makes sense. I&#39;m getting a not in scope error though, on the S.lookup. I was getting the same in the question code I edited (sorry about that)."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 69, "user_id": 7622546, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/114f99ab836aa7687d9967c509d9d390?s=128&d=identicon&r=PG&f=1", "display_name": "Strobe00", "link": "https://stackoverflow.com/users/7622546/strobe00"}, "edited": false, "score": 2, "creation_date": 1523453843, "post_id": 49776305, "comment_id": 86568280, "body": "Hm, what version of the package are you using? (<code>cabal info containers</code>) <code>lookup</code> has only been added quite recently to the <code>Sequence</code> module (0.5.8), before it had only <a href=\"http://hackage.haskell.org/package/containers-0.5.7.0/docs/Data-Sequence.html#v:index\" rel=\"nofollow noreferrer\"><code>index</code></a>, which you can also use (but it doesn&#39;t have a safe length-check)."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 69, "user_id": 7622546, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/114f99ab836aa7687d9967c509d9d390?s=128&d=identicon&r=PG&f=1", "display_name": "Strobe00", "link": "https://stackoverflow.com/users/7622546/strobe00"}, "edited": false, "score": 0, "creation_date": 1523466373, "post_id": 49776305, "comment_id": 86576979, "body": "This still feels like an x/y issue.  If @Strobe00 desires fast random access/update of elements in an ordered set then they&#39;ll probably be better served by a map structure."}, {"owner": {"reputation": 69, "user_id": 7622546, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/114f99ab836aa7687d9967c509d9d390?s=128&d=identicon&r=PG&f=1", "display_name": "Strobe00", "link": "https://stackoverflow.com/users/7622546/strobe00"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1523477715, "post_id": 49776305, "comment_id": 86582891, "body": "@ThomasM.DuBuisson I ended up going with IO Arrays and it&#39;s so much faster now."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1523478065, "post_id": 49776305, "comment_id": 86583081, "body": "Sounds fitting. That or an STArray."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 69, "user_id": 7622546, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/114f99ab836aa7687d9967c509d9d390?s=128&d=identicon&r=PG&f=1", "display_name": "Strobe00", "link": "https://stackoverflow.com/users/7622546/strobe00"}, "edited": false, "score": 1, "creation_date": 1523478154, "post_id": 49776305, "comment_id": 86583128, "body": "@Strobe00 though there are use cases where mutable arrays give you better performance than any alternative, I would recommend you only use them as a last-resort optimisation. Many algorithms can be implemented just as efficiently using only purely-functional tools (<i>most</i> I daresay, if you include immutable packed vectors) and only that way do you actually profit from Haskell&#39;s great safety guarantees. Using Haskell with mutable arrays is more like writing C with needlessly clunky syntax. Especially, while learning Haskell it makes sense to stick completely to lists to get a feel for it."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1523453746, "last_edit_date": 1523453746, "creation_date": 1523452992, "answer_id": 49776305, "question_id": 49775913, "link": "https://stackoverflow.com/questions/49775913/working-with-data-sequence-in-haskell/49776305#49776305", "title": "Working with Data.Sequence in Haskell", "body": "<p>Like almost everything in Haskell, <code>Seq</code> is a purely functional data structure. It's not like an imperative stack where you push stuff to, mutating the original structure. Rather, like ordinary lists, you just generate new container-values which have the extra elements, but this does not affect the old shorter seqs in any way. So, the program you've asked about should just be</p>\n\n<pre><code>testSeq :: S.Seq Int\ntestSeq = S.update 2 3 $ S.empty S.|&gt; 5 S.|&gt; 20 S.|&gt; 30\n\nmain :: IO ()\nmain = print $ S.lookup 2 testSeq\n</code></pre>\n\n<p>(It has to be <a href=\"http://hackage.haskell.org/package/containers-0.5.11.0/docs/Data-Sequence.html#v:lookup\" rel=\"noreferrer\"><code>S.lookup</code></a>, or equivalently <code>S.!?</code>. By itself, <a href=\"http://hackage.haskell.org/package/base-4.11.0.0/docs/Data-List.html#v:lookup\" rel=\"noreferrer\"><code>lookup</code></a> is a function that works on plain lists!)</p>\n\n<p>Note that this doesn't really give you any advantage over</p>\n\n<pre><code>testSeq = S.update 2 3 $ S.fromList [5,20,30]\n</code></pre>\n\n<p>In fact, lists are usually <em>faster</em> than <code>Seq</code>, they just don't allow efficient random access.</p>\n"}], "owner": {"reputation": 69, "user_id": 7622546, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/114f99ab836aa7687d9967c509d9d390?s=128&d=identicon&r=PG&f=1", "display_name": "Strobe00", "link": "https://stackoverflow.com/users/7622546/strobe00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 996, "favorite_count": 0, "accepted_answer_id": 49776305, "answer_count": 1, "score": 0, "last_activity_date": 1523453746, "creation_date": 1523451858, "last_edit_date": 1523453520, "question_id": 49775913, "link": "https://stackoverflow.com/questions/49775913/working-with-data-sequence-in-haskell", "title": "Working with Data.Sequence in Haskell", "body": "<p>I wrote a program that turned out to be far too slow using lists so I'm trying to switch over to sequences. However, I can't seem to figure out the correct syntax after looking at the documentation.</p>\n\n<p>So far I'm trying to learn with this simple code:</p>\n\n<pre><code>import Control.Monad\nimport qualified Data.Sequence as S\n\nmain :: IO ()\nmain = do \n       let testSeq = S.empty\n       testSeq S.|&gt; 5\n       testSeq S.|&gt; 20\n       testSeq S.|&gt; 3\n       let newSeq = S.update 2 3 testSeq\n       let x = lookup 2 testSeq\n       print x\n</code></pre>\n\n<p>I've played around with the syntax for a while with no luck but it still has a ton of errors:</p>\n\n<pre><code>test.hs:9:8:\n    Couldn't match expected type \u2018IO a0\u2019\n                with actual type \u2018S.Seq Integer\u2019\n    In a stmt of a 'do' block: testSeq S.|&gt; 5\n    In the expression:\n      do { let testSeq = S.empty;\n           testSeq S.|&gt; 5;\n           testSeq S.|&gt; 20;\n           testSeq S.|&gt; 3;\n           .... }\n    In an equation for \u2018main\u2019:\n        main\n          = do { let testSeq = ...;\n                 testSeq S.|&gt; 5;\n                 testSeq S.|&gt; 20;\n                 .... }\n\ntest.hs:10:8:\n    Couldn't match expected type \u2018IO a1\u2019\n                with actual type \u2018S.Seq Integer\u2019\n    In a stmt of a 'do' block: testSeq S.|&gt; 20\n    In the expression:\n      do { let testSeq = S.empty;\n           testSeq S.|&gt; 5;\n           testSeq S.|&gt; 20;\n           testSeq S.|&gt; 3;\n           .... }\n    In an equation for \u2018main\u2019:\n        main\n          = do { let testSeq = ...;\n                 testSeq S.|&gt; 5;\n                 testSeq S.|&gt; 20;\n                 .... }\n\ntest.hs:11:8:\n    Couldn't match expected type \u2018IO a2\u2019\n                with actual type \u2018S.Seq Integer\u2019\n    In a stmt of a 'do' block: testSeq S.|&gt; 3\n    In the expression:\n      do { let testSeq = S.empty;\n           testSeq S.|&gt; 5;\n           testSeq S.|&gt; 20;\n           testSeq S.|&gt; 3;\n           .... }\n    In an equation for \u2018main\u2019:\n        main\n          = do { let testSeq = ...;\n                 testSeq S.|&gt; 5;\n                 testSeq S.|&gt; 20;\n                 .... }\n\ntest.hs:13:25:\n    Couldn't match expected type \u2018[(Integer, b)]\u2019\n                with actual type \u2018S.Seq a3\u2019\n    Relevant bindings include x :: Maybe b (bound at test.hs:13:12)\n    In the second argument of \u2018lookup\u2019, namely \u2018testSeq\u2019\n    In the expression: lookup 2 testSeq\n</code></pre>\n\n<p>I'm new to Haskell so any help would be greatly appreciated!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 6, "creation_date": 1523450246, "post_id": 49775307, "comment_id": 86565491, "body": "There is no inheritance in Haskell. Type classes are something different than classes (in fact it is more like interfaces)."}, {"owner": {"reputation": 3148, "user_id": 2693928, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4c1419246c9c4d03a08f7c5db65303e?s=128&d=identicon&r=PG&f=1", "display_name": "user2693928", "link": "https://stackoverflow.com/users/2693928/user2693928"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523450355, "post_id": 49775307, "comment_id": 86565567, "body": "Thanks, can you provide same example how to create polymorphism in Haskell or Javascript(preferable). I dont understand if i have some child class to override parent method?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1523450370, "post_id": 49775307, "comment_id": 86565579, "body": "Furthermore inheritance is not a <i>required</i> feature for an object-oriented language."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1523451818, "post_id": 49775307, "comment_id": 86566710, "body": "I&#39;m torn between &quot;too broad&quot; and &quot;unclear what you&#39;re asking&quot;. This question needs a lot of work."}, {"owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "edited": false, "score": 0, "creation_date": 1523471561, "post_id": 49775307, "comment_id": 86579650, "body": "This question and a bunch of similar ones make me believe that there is the place to re-open and make a collaborative efforts on my question which was closed too : <a href=\"https://stackoverflow.com/questions/49688748/haskell-to-c-features-approximation\" title=\"haskell to c features approximation\">stackoverflow.com/questions/49688748/&hellip;</a> The fact are that :  - 80% or more of software developer know very much OOP features which use very similar concepts and terminology accross languages  (C++ / Java /C# / JS / Python)  - Maybe some super clever brain learn out of the blue but the others learn by analogy and comparing things"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "edited": false, "score": 2, "creation_date": 1523478489, "post_id": 49775307, "comment_id": 86583313, "body": "@sandwood  People usually ask &quot;How do I translate feature-X to Haskell?&quot; when they should <i>really</i> be asking &quot;How do I solve problem-Y in Haskell, for which I use feature-X in language-Z?&quot; Most of the time, if you can correctly identify problem-Y, the fact that you used feature-X in language-Z is no longer relevant."}], "answers": [{"comments": [{"owner": {"reputation": 3148, "user_id": 2693928, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4c1419246c9c4d03a08f7c5db65303e?s=128&d=identicon&r=PG&f=1", "display_name": "user2693928", "link": "https://stackoverflow.com/users/2693928/user2693928"}, "edited": false, "score": 0, "creation_date": 1523450500, "post_id": 49775427, "comment_id": 86565679, "body": "Thanks, but how can i create polymorphic methods. for example have base class Field and subclasseses TextField, SelectField and override some methods?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 3148, "user_id": 2693928, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4c1419246c9c4d03a08f7c5db65303e?s=128&d=identicon&r=PG&f=1", "display_name": "user2693928", "link": "https://stackoverflow.com/users/2693928/user2693928"}, "edited": false, "score": 2, "creation_date": 1523450757, "post_id": 49775427, "comment_id": 86565883, "body": "You can&#39;t. You can do something with  similar outcome, but that&#39;s really a different question from the one you asked here (and requires a much more detailed problem description). Don&#39;t edit questions to go in a completely different direction."}, {"owner": {"reputation": 3148, "user_id": 2693928, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4c1419246c9c4d03a08f7c5db65303e?s=128&d=identicon&r=PG&f=1", "display_name": "user2693928", "link": "https://stackoverflow.com/users/2693928/user2693928"}, "edited": false, "score": 0, "creation_date": 1523450889, "post_id": 49775427, "comment_id": 86565987, "body": "I asked but no one gave answer: <a href=\"https://stackoverflow.com/questions/49767962/functional-programming-polymorhism\" title=\"functional programming polymorhism\">stackoverflow.com/questions/49767962/&hellip;</a>"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 3148, "user_id": 2693928, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4c1419246c9c4d03a08f7c5db65303e?s=128&d=identicon&r=PG&f=1", "display_name": "user2693928", "link": "https://stackoverflow.com/users/2693928/user2693928"}, "edited": false, "score": 2, "creation_date": 1523463645, "post_id": 49775427, "comment_id": 86575477, "body": "@user2693928 That seems to be a very different question (especially since it&#39;s about classes in JavaScript which, despite having a similar name, are a totally different concept than type classes in Haskell in almost every way). If your goal is to work with classes in JavaScript, learning about type classes in Haskell will not help you achieve this goal (not to discourage you from learning Haskell, it&#39;s just that they are <i>really</i> different and type class knowledge won&#39;t really transfer to JavaScript classes)."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 10, "last_activity_date": 1523450593, "last_edit_date": 1523450593, "creation_date": 1523450377, "answer_id": 49775427, "question_id": 49775307, "link": "https://stackoverflow.com/questions/49775307/why-haskell-has-classes-and-inheritance/49775427#49775427", "title": "Why Haskell has classes and inheritance", "body": "<p>Your premise is flawed in both directions:</p>\n\n<ul>\n<li>Inheritance and OOP are two almost orthogonal concepts. Although inheritance is strongly associated with mainstream OO languages (in particularly Java and C#), these are arguably not very true to the original spirit.<br>What OO is really about is that instead of directly manipulating state that lies elsewhere, you send \u201cmessages\u201d to an object which knows how to do that safely.<br><a href=\"https://www.aomran.com/object-oriented-programming-is-not-about-objects/\" rel=\"noreferrer\">https://www.aomran.com/object-oriented-programming-is-not-about-objects/</a><br>\nThis doesn't really apply to Haskell in any way because it doesn't have mutable state to begin with.</li>\n<li>Haskell doesn't have Java-style inheritance (subtypes). It doesn't even have Java-style classes: Haskell classes are <a href=\"https://en.wikipedia.org/wiki/Type_class\" rel=\"noreferrer\">typeclasses</a>, which correspond more to Java interfaces.</li>\n</ul>\n"}], "owner": {"reputation": 3148, "user_id": 2693928, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4c1419246c9c4d03a08f7c5db65303e?s=128&d=identicon&r=PG&f=1", "display_name": "user2693928", "link": "https://stackoverflow.com/users/2693928/user2693928"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "closed_date": 1523464252, "answer_count": 1, "score": -3, "last_activity_date": 1523450593, "creation_date": 1523450064, "last_edit_date": 1523450386, "question_id": 49775307, "link": "https://stackoverflow.com/questions/49775307/why-haskell-has-classes-and-inheritance", "closed_reason": "Needs more focus", "title": "Why Haskell has classes and inheritance", "body": "<p>Haskell as definition is functional programming language.</p>\n\n<p>Then why in Haskell there are classes and inheritance.</p>\n\n<p>Isn't it OOP and FP at the same time this way???</p>\n\n<p>How to create polymorphism in Haskell or Javascript with functional programming.</p>\n"}, {"tags": ["haskell", "pattern-matching", "maybe"], "comments": [{"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1523449340, "post_id": 49774742, "comment_id": 86564794, "body": "Use <code>safeInit (x:xs) = Just (init (x:xs))</code>."}], "answers": [{"comments": [{"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1523450606, "post_id": 49774955, "comment_id": 86565767, "body": "But are you not altering the initial list that way?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 1, "creation_date": 1523450637, "post_id": 49774955, "comment_id": 86565790, "body": "@BercoviciAdrian: you can not alter anything in Haskell, all variables are immutable. In what way do you think I am altering the initial list?"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1523450916, "post_id": 49774955, "comment_id": 86566012, "body": "No you are not altering i thought you are appending the x to the xs...you were just decomposing further on with &quot;x2&quot;.My bad sorry."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1523449155, "creation_date": 1523449155, "answer_id": 49774955, "question_id": 49774742, "link": "https://stackoverflow.com/questions/49774742/using-maybe-for-pattern-matching-of-list-renders-error/49774955#49774955", "title": "Using maybe for pattern-matching of list renders error", "body": "<p>There are two problems here:</p>\n\n<ul>\n<li>you make a call with as input a <code>Maybe [a]</code>; and</li>\n<li>your first pattern contains a (strict) superset then the second, so the second one will <em>never</em> fire.</li>\n</ul>\n\n<p>For the first problem, the culprit is in the line:</p>\n\n<pre><code>safeInit (x:xs) = x: safeInit (Just xs)\n</code></pre>\n\n<p>Here <code>safeInit</code>, expects a list (type <code>[a]</code>), but you wrap the list in the <code>Just</code> constructor, hence you pass it a <code>Maybe [a]</code> value, and the <code>safeInit</code> can not handle this. So we can rewrite it to:</p>\n\n<pre><code>safeInit (x:xs) = x : safeInit xs\n</code></pre>\n\n<p>This will however <em>not</em> solve the problem, since now we call the \"cons\" (<code>:</code>) on an <code>a</code>, and <code>Maybe [a]</code>, and again, the function can not handle this. We will first have to inspect whether the recursive call produces a <code>safeInit</code>, and then prepend the <code>x</code> and rewrap it in a <code>Just</code>, we can do this with an <code>fmap</code>:</p>\n\n<pre><code>safeInit (x:xs) = fmap (x:) (safeInit xs)\n</code></pre>\n\n<p>For the second problem, we can rearrange the clauses:</p>\n\n<pre><code>safeInit :: [a] -&gt; Maybe a\nsafeInit [x, _] = Just [x]\nsafeInit (x:xs) = fmap (x:) (safeInit xs)\nsafeInit [] = Nothing\n</code></pre>\n\n<p>Nevertheless there are still problems with this approach: it is rather inefficient, since we unwrap and wrap the <code>Just</code> element for all elements (except the last one), given that is not optimized. Furthermore in case we process an infinite list, we will get stuck in an infinite loop. We can improve it, by using an inner function, that calculates the <code>init</code> given we know for sure that that <code>init</code> is valid. For example:</p>\n\n<pre><code>safeInit :: [a] -&gt; Maybe a\nsafeInit (x:xs) = Just (go x xs)\n    where go _ [] = []\n          go x (x2:xs) = x : go x2 xs\nsafeInit [] = Nothing\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1523449199, "creation_date": 1523449199, "answer_id": 49774974, "question_id": 49774742, "link": "https://stackoverflow.com/questions/49774742/using-maybe-for-pattern-matching-of-list-renders-error/49774974#49774974", "title": "Using maybe for pattern-matching of list renders error", "body": "<p>Well, it depends on what semantics you want. In case of <code>init</code>, once you've found any element at all, you know the result will actually be <code>Just</code> anyway, namely, <code>Just init_xs</code>. You then want to prepend the current <code>x</code> to the included list, not changing anything about the <code>Just</code>. The easiest way to do that is to use <code>Maybe</code>'s <code>Functor</code> instance:</p>\n\n<pre><code>safeInit (x:xs) = (x:) &lt;$&gt; safeInit xs\n</code></pre>\n\n<p>Note however that this only works if you put in an extra base case, and the clause must go <em>before</em> the generic cons one:</p>\n\n<pre><code>safeInit :: [a] -&gt; Maybe [a]\nsafeInit [_] = Just []\nsafeInit (x:xs) = (x:) &lt;$&gt; safeInit xs\nsafeInit []  = Nothing\n</code></pre>\n\n<p>An alternative that's perhaps easier to understand is to pattern-match on the recursive result:</p>\n\n<pre><code>safeInit (x:xs) = case safeInit xs of\n      Just init_xs -&gt; Just $ x : init_xs\n      Nothing -&gt; Just []\nsafeInit [] = Nothing\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 1, "creation_date": 1523450547, "post_id": 49775418, "comment_id": 86565719, "body": "I did not want to use out of the box methods.But thank you anyway."}], "tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 3, "last_activity_date": 1523450345, "creation_date": 1523450345, "answer_id": 49775418, "question_id": 49774742, "link": "https://stackoverflow.com/questions/49774742/using-maybe-for-pattern-matching-of-list-renders-error/49775418#49775418", "title": "Using maybe for pattern-matching of list renders error", "body": "<p>Expanding on Elmex80s's suggestion,</p>\n\n<pre><code>safeInit :: [a] -&gt; Maybe [a]\nsafeInit [] = Nothing\nsafeInit xs = Just (init xs)\n</code></pre>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 49774955, "answer_count": 3, "score": 0, "last_activity_date": 1523450345, "creation_date": 1523448503, "last_edit_date": 1523448607, "question_id": 49774742, "link": "https://stackoverflow.com/questions/49774742/using-maybe-for-pattern-matching-of-list-renders-error", "title": "Using maybe for pattern-matching of list renders error", "body": "<p>How should i use the <code>Just</code> constructor  when decomposing a pattern?\n <br><strong>E.G:</strong><br> If my pattern is :   <code>(x1,x2,x3,....xn)</code>  i will have to enclose  each element of the pattern with its <code>Just</code>?</p>\n\n<p><strong>My problem :</strong> i am trying to implement the Init function \"safely\".<br>Do i have to use the <code>Just</code>for the tail and for the head too in the second line?</p>\n\n<pre><code>safeInit::[a]-&gt;Maybe [a]\nsafeInit (x:xs)=x: safeInit (Just xs) #Just x : safeInit Just xs ?\nsafeInit [x,y]=Just [x]\nsafeInit _ =Nothing\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1523449472, "post_id": 49774055, "comment_id": 86564909, "body": "Do you use <code>stack</code>? Can <code>stack build</code> really succeed without a <code>stack.yaml</code>?"}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 1, "creation_date": 1523450133, "post_id": 49774055, "comment_id": 86565395, "body": "@Li-yaoXia Just checked and it can&#39;t build without a <code>stack.yaml</code>, but the only things in the file (that was generated by stack 1.6.5) are a <code>resolver</code> and a <code>packages</code> tag - everything else is in the <code>package.yaml</code>. I can even comment out the <code>packages</code> tag and the build runs fine."}, {"owner": {"reputation": 189, "user_id": 8179137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b43fe26a1b6191280614f56683525d?s=128&d=identicon&r=PG&f=1", "display_name": "Potato44", "link": "https://stackoverflow.com/users/8179137/potato44"}, "edited": false, "score": 0, "creation_date": 1523451142, "post_id": 49774055, "comment_id": 86566207, "body": "Do you understand what the difference between the <code>package-name.cabal</code> and <code>stack.yaml</code> is? <code>package.yaml</code> serves as an alternative for the cabal file."}], "answers": [{"comments": [{"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1523453460, "post_id": 49776281, "comment_id": 86567994, "body": "Thanks, this is a nice answer - just to clarify: would you only need to put a dependency in <code>stack.yaml</code> if you require its version to be pinned? Whereas putting it in <code>package.yaml</code> lets the resolver pick a version?"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 2, "creation_date": 1523453933, "post_id": 49776281, "comment_id": 86568331, "body": "The stack.yaml actually specifies versions for all packages. Most of them are usually implicit in the choice of resolver. There are resolvers with no packages (<code>ghc-*</code>), with which every single dependency, including transitive ones, need to be listed as extra-deps."}, {"owner": {"reputation": 486, "user_id": 854672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eda4f03accf45734865ea7e6c6de010?s=128&d=identicon&r=PG", "display_name": "MauganRa", "link": "https://stackoverflow.com/users/854672/mauganra"}, "reply_to_user": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1527437995, "post_id": 49776281, "comment_id": 88118968, "body": "@hnefatl An entry in <code>extra-deps</code> is only required if a dependency is not contained in a resolver, or if you want to have a specific version. Note that packages and versions contained in a resolver are expected to not change, and as far as I know <code>stack</code> will cache the resolver&#39;s data. On the other hand, dependencies in <code>*.cabal</code> and <code>package.yaml</code> should be soft, lest one loses the ability to make a version compatible to multiple resolvers."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 3, "creation_date": 1558838857, "post_id": 49776281, "comment_id": 99230450, "body": "Maybe it&#39;s a bit late to comment, but: I think it should also be noted that <code>package.yaml</code> is not mandatory in any way - it&#39;s just a thin layer over the <code>*.cabal</code> file, and many people (including me) choose to edit the <code>*.cabal</code> file directly."}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1595682756, "post_id": 49776281, "comment_id": 111562591, "body": "&quot;Another common use case is to create many stack.yaml (with different names) to easily test various configurations (e.g., GHC versions or package flags).&quot; @Li-yaoXia do you know a place where there are some examples of what you say ?"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1595694317, "post_id": 49776281, "comment_id": 111566122, "body": "One place is to look for files like <code>stack-lts*.yaml</code> on Github: <a href=\"https://github.com/search?p=1&amp;q=filename%3Astack-lts\" rel=\"nofollow noreferrer\">github.com/search?p=1&amp;q=filename%3Astack-lts</a>*.yaml&amp;type=Code I know aeson has a bunch of stack  files in its root, I&#39;m not sure whether they are still used, but that&#39;s where I first picked it up."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 17, "last_activity_date": 1588949826, "last_edit_date": 1588949826, "creation_date": 1523452917, "answer_id": 49776281, "question_id": 49774055, "link": "https://stackoverflow.com/questions/49774055/stacks-package-yaml-vs-stack-yaml/49776281#49776281", "title": "Stack&#39;s package.yaml vs stack.yaml", "body": "<blockquote>\n  <p>So from this, it seems like <code>package.yaml</code> provides a superset of the <code>*.cabal</code> file's configuration ability, like the <code>stack.yaml</code> file also does.</p>\n</blockquote>\n\n<p><code>stack.yaml</code> does not provide a superset of <code>*.cabal</code> configurations.</p>\n\n<hr>\n\n<p>The <code>*.cabal</code> file is the package-level configuration. It can be generated by <code>hpack</code> from a <code>package.yaml</code>. This configuration provides essential information about the package: dependencies, exported components (libraries, executables, test suites), and settings for the build process (preprocessors, custom <code>Setup.hs</code>). Many projects also don't use <code>hpack</code> and don't have a <code>package.yaml</code>, only a <code>*.cabal</code> file.</p>\n\n<p>The <code>stack.yaml</code> file is the project-level configuration, which specifies a particular environment to make a build reproducible, pinning versions of compiler and dependencies. This is usually specified by a resolver (such as <code>lts-11.4</code>).</p>\n\n<p><code>stack.yaml</code> is not redundant with <code>package.yaml</code>. <code>package.yaml</code> specifies what dependencies are needed. <code>stack.yaml</code> indicates one way to consistently resolve dependencies (specific package version, and/or where to get it from, for example: on Hackage, a remote repository, or a local directory).</p>\n\n<p><code>stack.yaml</code> is most useful to developers: we don't want our build to suddenly break because a dependency upgraded while working on another project, hence we pin everything with <code>stack.yaml</code>. This file is less useful to users, who may have external constraints (typically, versions are already fixed by some distribution).</p>\n\n<ul>\n<li><p>In many cases, just specifying the resolver in <code>stack.yaml</code> is enough. Hence new <code>stack</code> users usually don't need to worry about configuring <code>stack.yaml</code>.</p></li>\n<li><p>A resolver specifies a curated set of packages with specific versions (the standard ones are listed on stackage.org). If a dependency of the package is missing from the chosen resolver, then it must be listed in the <code>extra-deps</code> field of <code>stack.yaml</code>.</p></li>\n<li><p>A project can span multiple packages, that thus get added to the <code>packages</code> field of <code>stack.yaml</code>, so they can be built in a single common environment and depend on each other.</p></li>\n<li><p>Another common use case is to create many <code>stack.yaml</code> (with different names) to easily test various configurations (e.g., GHC versions or package flags).</p></li>\n</ul>\n"}], "owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3171, "favorite_count": 2, "accepted_answer_id": 49776281, "answer_count": 1, "score": 16, "last_activity_date": 1588949826, "creation_date": 1523446443, "last_edit_date": 1523446746, "question_id": 49774055, "link": "https://stackoverflow.com/questions/49774055/stacks-package-yaml-vs-stack-yaml", "title": "Stack&#39;s package.yaml vs stack.yaml", "body": "<p><a href=\"https://github.com/commercialhaskell/stack\" rel=\"noreferrer\">Stack</a> has supported <a href=\"https://github.com/sol/hpack\" rel=\"noreferrer\">hpack</a>'s <code>package.yaml</code> configuration files since at least around <a href=\"https://github.com/commercialhaskell/stack/commit/ee043bc54a316661cc207672f501cfdcef468a69\" rel=\"noreferrer\">this commit</a>, as far as I can tell, but there's not much documentation about the differences between it and the <code>stack.yaml</code> file.</p>\n\n<p>One of the few links I've found talking about it is <a href=\"https://docs.haskellstack.org/en/stable/stack_yaml_vs_cabal_package_file/\" rel=\"noreferrer\">this documentation</a>, where it says:</p>\n\n<blockquote>\n  <p><code>package.yaml</code> is a file format supported by hpack. It adds some niceties on top of cabal. For example, hpack has YAML syntax support and will automatically generate of <code>exposed-modules</code> lists. However, it's just a frontend to cabal package files.</p>\n</blockquote>\n\n<p>So from this, it seems like <code>package.yaml</code> provides a superset of the <code>*.cabal</code> file's configuration ability, like the <code>stack.yaml</code> file also does.</p>\n\n<hr>\n\n<p>The <a href=\"https://docs.haskellstack.org/en/stable/GUIDE/#inner-workings-of-stack\" rel=\"noreferrer\">documentation here</a> implies <code>stack.yaml</code> is the configuration file:</p>\n\n<blockquote>\n  <p>Next, let's look at our stack.yaml file, which gives our project-level settings.</p>\n</blockquote>\n\n<p>...<a href=\"https://docs.haskellstack.org/en/stable/GUIDE/#adding-dependencies\" rel=\"noreferrer\">and later says</a> that <code>package.yaml</code> is for storing dependencies:</p>\n\n<blockquote>\n  <p>To tell stack to use <code>text</code>, you need to add it to your <code>package.yaml</code> file \u2014 specifically in your dependencies section...</p>\n</blockquote>\n\n<p>There's <a href=\"https://stackoverflow.com/questions/40332040/what-goes-in-a-stack-package-yaml-file\">this related question</a>, but it sadly doesn't clarify the difference between the two files.</p>\n\n<p>I've been using <code>package.yaml</code> for all my project's configurations, and never using <code>stack.yaml</code>.</p>\n\n<hr>\n\n<p>So, what is the relationship between stack's <code>package.yaml</code> and <code>stack.yaml</code> files? If/when their responsibilities overlap, which is it better practice to use?</p>\n"}, {"tags": ["haskell", "haskell-stack", "intero"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1523446867, "post_id": 49774017, "comment_id": 86563096, "body": "When this happens, are you looking at a file that&#39;s part of a dependent library, or perhaps some unit tests? Does this also happen in the <code>Main</code> module?"}, {"owner": {"reputation": 65, "user_id": 9600787, "user_type": "registered", "profile_image": "https://graph.facebook.com/1940374526035557/picture?type=large", "display_name": "SAN", "link": "https://stackoverflow.com/users/9600787/san"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1523446976, "post_id": 49774017, "comment_id": 86563164, "body": "@Mark seemann It was <code>Main.hs</code> file. Also happens in other files, even non-stack files."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 1, "creation_date": 1523704920, "post_id": 49774017, "comment_id": 86676925, "body": "Have you executed <code>stack build intero</code> before opening Visual Studio Code?"}, {"owner": {"reputation": 337, "user_id": 2372806, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/758b777a16cbe44652f44fcf9fcbc30f?s=128&d=identicon&r=PG", "display_name": "Tony Martin", "link": "https://stackoverflow.com/users/2372806/tony-martin"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1563896682, "post_id": 49774017, "comment_id": 100849288, "body": "@MarkSeemann I have and I&#39;m having a similar problem"}], "owner": {"reputation": 65, "user_id": 9600787, "user_type": "registered", "profile_image": "https://graph.facebook.com/1940374526035557/picture?type=large", "display_name": "SAN", "link": "https://stackoverflow.com/users/9600787/san"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1072, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1523446354, "creation_date": 1523446354, "question_id": 49774017, "link": "https://stackoverflow.com/questions/49774017/got-problems-with-intero-or-haskero", "title": "Got problems with Intero. (or Haskero)", "body": "<p>When I put on mouse on phrases, intero says <code>\"Couldn't guess that module name. Does it exists\"</code>. It whines on function name, module name, every word of string, and even space or tab character.</p>\n\n<p>It does not cause fatal error or stop compiling, but it's irritating. How can I solve this?</p>\n\n<p>I am using Stack, Haskero on VS Code. I also tried <code>stack ghci --with-ghc-intero</code>, but it doesn't work. How can I solve this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1523453128, "post_id": 49773874, "comment_id": 86567735, "body": "Just specify the extra variable as <code>()</code>, it&#39;s phantom anyway (unless you use <code>Generic1</code>, but that&#39;s seems quite unlikely). But if <code>F</code> is a type family, you should only need <code>ToJSON</code> instances for whatever types it maps to."}, {"owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1523454700, "post_id": 49773874, "comment_id": 86568950, "body": "@Li-yaoXia You can&#39;t implement <code>to</code> <i>or</i> <code>from</code> if you just specify it as <code>()</code>. Also, the type family maps a representation to a nearly identical representation, but with the fields (in the \u02d9K1` constructors) wrapper in a <code>Maybe</code>. There are no JSON instances for generic rep types, or at least their instances are not what I want."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1523455856, "post_id": 49773874, "comment_id": 86569811, "body": "Okay, thanks, I see better what the problem is."}], "answers": [{"comments": [{"owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "edited": false, "score": 1, "creation_date": 1523458664, "post_id": 49777873, "comment_id": 86571999, "body": "Hah! <code>phantom</code> is a nice trick. Hopefully soon with quantified contexts we&#39;ll be able to require direct coercability."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "edited": false, "score": 0, "creation_date": 1523459303, "post_id": 49777873, "comment_id": 86572462, "body": "Yes, that will be much nicer!"}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 1, "last_activity_date": 1523457665, "last_edit_date": 1523457665, "creation_date": 1523457252, "answer_id": 49777873, "question_id": 49773874, "link": "https://stackoverflow.com/questions/49773874/making-a-wrapper-over-a-generic-rep/49777873#49777873", "title": "Making a wrapper over a generic Rep", "body": "<p>Given a data type <code>A</code>, <code>Generic</code> gives an isomorphism to a generic representation <code>Rep A</code>. Here we want to go the other way around. Given a generic representation <code>r</code> (here <code>r ~ F (Rep A)</code> for some <code>A</code>) we want a data type <code>B</code> such that <code>Rep B ~ r</code>. We define <code>B</code> as <code>Data r</code>:</p>\n\n<pre><code>data Data r = Data (r ())\n</code></pre>\n\n<p>The type parameter of <code>r :: * -&gt; *</code> is phantom (actually, it's used by <code>Generic1</code>, and nobody uses <code>Generic1</code>), so we can instantiate it with anything, and we pick <code>()</code> as an arbitrary default.</p>\n\n<p>We will need to express that phantom-ness as a constraint. One way is to take the conjunction of <code>Functor</code> and <a href=\"https://hackage.haskell.org/package/contravariant-1.4.1/docs/Data-Functor-Contravariant.html\" rel=\"nofollow noreferrer\"><code>Contravariant</code></a>.</p>\n\n<pre><code>type Bivariant f = (Functor f, Contravariant f)\n\nphantom :: Bivariant f =&gt; f a -&gt; f b  -- Data.Functor.Contravariant\n\ninstance Bivariant r =&gt; Generic (Data r) where\n  type Rep (Data r) = r\n  from (Data r) = phantom r\n  to = Data . phantom\n</code></pre>\n\n<hr>\n\n<p>Also I have defined <a href=\"https://hackage.haskell.org/package/generic-data-0.1.0.0/docs/Generic-Data-Types.html#t:Data\" rel=\"nofollow noreferrer\"><code>Data</code></a> in <em>generic-data</em> where I kept the extra parameter instead of instantiating it, since it is actually cheap to do so.</p>\n"}], "owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 49777873, "answer_count": 1, "score": 1, "last_activity_date": 1523457665, "creation_date": 1523445944, "question_id": 49773874, "link": "https://stackoverflow.com/questions/49773874/making-a-wrapper-over-a-generic-rep", "title": "Making a wrapper over a generic Rep", "body": "<p>I have a <code>Rep A</code> for some type that I modify using some <code>forall x. Rep A x -&gt; F (Rep A) x</code> function where <code>F</code> is a type family. Let's say this wraps all the fields in a <code>Maybe</code>. What I want to do is to serialize that <code>F (Rep A)</code> to JSON. <code>aeson</code> provides functions that serialize generic types, but it doesn't provide the functions that operate on the actual generic representation.</p>\n\n<p>To solve this problem I thought I could write something like this</p>\n\n<pre><code>newtype RepWrapper a = RepWrapper (F (Rep a))\n</code></pre>\n\n<p>with a generic instance</p>\n\n<pre><code>instance Generic a =&gt; Generic (RepWrapper a) where\n    type Rep (RepWrapper a) = F (Rep a)\n</code></pre>\n\n<p>Then I can just use the <code>aeson</code> functions on this wrapped value.</p>\n\n<p>The problem with the above is the extra type parameter that needs to be given to a <code>Rep</code>. There are three ways of doing that, as far as I can tell</p>\n\n<pre><code>newtype RepWrapper a = RepWrapper (forall x. F (Rep a) x)\ndata RepWrapper a = forall x. RepWrapper (F (Rep a) x)\nnewtype RepWrapper a x = RepWrapper (F (Rep a) x)\n</code></pre>\n\n<p>The first way lets me write the <code>from</code> function, the second way lets me write the <code>to</code> function and the third way seems useless.</p>\n\n<p>Is there a way to define the wrapper so I can implement the whole <code>Generic</code> instance?</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1523438050, "post_id": 49771075, "comment_id": 86557068, "body": "Does <code>ghc</code> actually recompiles the files? I have the impression that <code>ghc</code> first checks the timestamp of <code>.o</code>, etc. If the <code>.o</code> exists and is younger than the codefile, then no compilation is done at all. So even the compiler is rather lazy :)."}, {"owner": {"reputation": 43, "user_id": 9320545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/758099792ec86b4f9a9efa17f9ff5b6a?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Pizarro", "link": "https://stackoverflow.com/users/9320545/francisco-pizarro"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523438639, "post_id": 49771075, "comment_id": 86557477, "body": "Good point - no, <code>ghc</code> actually didn&#39;t compile the files..."}], "answers": [{"tags": [], "owner": {"reputation": 7947, "user_id": 997606, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b6117f6630078d6612afa75fb8e5bc9a?s=128&d=identicon&r=PG", "display_name": "Tom Ellis", "link": "https://stackoverflow.com/users/997606/tom-ellis"}, "is_accepted": true, "score": 2, "last_activity_date": 1523438344, "creation_date": 1523438344, "answer_id": 49771204, "question_id": 49771075, "link": "https://stackoverflow.com/questions/49771075/ghc-warnings-are-suppressed-unless-intermediate-files-are-deleted/49771204#49771204", "title": "GHC warnings are suppressed unless intermediate files are deleted", "body": "<p>If the results of compilation (<code>.hi</code> and <code>.o</code>) already exist then GHC will not recompile the <code>.hs</code>.  GHC only emits the warning when it compiles (or typechecks) the <code>.hs</code>.</p>\n\n<p>Perhaps you could use <code>ghc -fforce-recomp foo.hs</code> to force recompiling.  (If you just want to typecheck then it's quicker to use<code>ghc -fforce-recomp -fno-code foo.hs</code> but there are some warnings that <code>-fno-code</code> doesn't catch.)</p>\n"}], "owner": {"reputation": 43, "user_id": 9320545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/758099792ec86b4f9a9efa17f9ff5b6a?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Pizarro", "link": "https://stackoverflow.com/users/9320545/francisco-pizarro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 49771204, "answer_count": 1, "score": 0, "last_activity_date": 1523438344, "creation_date": 1523437968, "question_id": 49771075, "link": "https://stackoverflow.com/questions/49771075/ghc-warnings-are-suppressed-unless-intermediate-files-are-deleted", "title": "GHC warnings are suppressed unless intermediate files are deleted", "body": "<p>I'm compiling my program as: <code>ghc -Wall foo.hs</code>\nand I get some helpful warnings:</p>\n\n<pre><code>foo.hs:14:1: Warning:\n    Top-level binding with no type signature: main :: IO ()\n</code></pre>\n\n<p>Now, if I immediately re-run <code>ghc -Wall foo.hs</code>, I get no warnings. If I delete the intermediate files <code>foo.o</code> and <code>foo.hi</code>, then run <code>ghc -Wall foo.hs</code>, the warnings reappear.</p>\n\n<p>Is this intended behaviour? Can I make it so warnings are always displayed without having to delete intermediate files?</p>\n"}, {"tags": ["parsing", "haskell", "parsec"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 3, "creation_date": 1523437319, "post_id": 49770690, "comment_id": 86556509, "body": "<code>parseFoo `endBy` newLine &lt;* eof</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 616, "user_id": 8578679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CeZ5Z.png?s=128&g=1", "display_name": "Ruifeng Xie", "link": "https://stackoverflow.com/users/8578679/ruifeng-xie"}, "is_accepted": true, "score": 3, "last_activity_date": 1523462193, "creation_date": 1523462193, "answer_id": 49779588, "question_id": 49770690, "link": "https://stackoverflow.com/questions/49770690/how-to-fail-on-parse-many-with-parsec/49779588#49779588", "title": "How to fail on parse many with parsec?", "body": "<p>You should match EOF at the end of the parser. Use the provided <code>eof</code> to do it. Without <code>eof</code> the parser will not match the end of file, and will happily parse only part of the input. </p>\n\n<p>In the <code>do</code> block: </p>\n\n<pre><code>do\n    res &lt;- {- Your parser code here -}\n    eof\n    return res\n</code></pre>\n\n<p>Or just use the &lt;* operator: <code>parser &lt;* eof</code> will do. </p>\n"}], "owner": {"reputation": 716, "user_id": 2315551, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8a4c0668c9eab3ecb855d3f6fd879ad7?s=128&d=identicon&r=PG&f=1", "display_name": "lsund", "link": "https://stackoverflow.com/users/2315551/lsund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 49779588, "answer_count": 1, "score": 3, "last_activity_date": 1523462193, "creation_date": 1523436828, "question_id": 49770690, "link": "https://stackoverflow.com/questions/49770690/how-to-fail-on-parse-many-with-parsec", "title": "How to fail on parse many with parsec?", "body": "<p>Apoligies if this is a trivial thing, but I really can't find it out on my own. </p>\n\n<p><strong>PRELIMINARIES</strong></p>\n\n<p>I have a file with many entries like <code>FOO &lt;value&gt;</code>, For Example:</p>\n\n<pre><code># example.txt\nFOO 5\nFOO 9\n</code></pre>\n\n<p>Such a file read as a string would be <code>FOO 5\\nFOO 9\\n</code>. I tried to parse these with</p>\n\n<pre><code>parseFoo :: ParsecT String u Identity (String, Int)\nparseFoo = do\n    k &lt;- string \"FOO\"\n    _ &lt;- space\n    v &lt;- many1 digit\n    return (k, read v)\n\nparseFoos :: ParsecT String u Identity [(String, Int)]\nparseFoos = parseFoo `endBy` newline\n\ntestFOO :: Either ParseError [(String, Int)]\ntestFOO = parse parseFoos \"\" \"FOO 5\\nFOO 6\\n\"\n</code></pre>\n\n<p>This gives me <code>Right [(\"FOO\",5),(\"FOO\",6)]</code> as expected. </p>\n\n<p><strong>MY QUESTION</strong></p>\n\n<p>How to fail parsing on invalid inputs? </p>\n\n<p>For example: <code>parse parseFoos \"\" \"BLAH\"</code> returns <code>Right []</code>, but I want the parser to fail.</p>\n\n<p>For example: <code>parse parseFoos \"\" \"FOO 5\\nBAR 7\\n\"</code> returns <code>Right [(\"FOO\", 5)]</code>, but I want the parser to fail.</p>\n"}, {"tags": ["haskell", "ghci", "haskell-stack"], "comments": [{"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 2, "creation_date": 1523430885, "post_id": 49768305, "comment_id": 86552574, "body": "Perhaps you need to add the <a href=\"http://hackage.haskell.org/package/directory-1.3.2.2/docs/System-Directory.html\" rel=\"nofollow noreferrer\"><code>directory</code></a> package in your stack.yaml like the post you link to suggests?"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1523444110, "post_id": 49768305, "comment_id": 86561258, "body": "@hnefatl This page does not say to use <code>package.yaml</code> over <code>stack.yaml</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1523455036, "post_id": 49768305, "comment_id": 86569218, "body": "Given the directory structure you mention, I suppose you have a Stack-managed project (as opposed to, say, trying to load an isolated file in <code>stack ghci</code>). From which directory are you running <code>stack ghci</code>? I believe that, in this use case, you should run it from the root of your project (i.e. where <code>stack.yaml</code> is)."}], "answers": [{"tags": [], "owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "is_accepted": false, "score": 0, "last_activity_date": 1523500390, "creation_date": 1523500390, "answer_id": 49787073, "question_id": 49768305, "link": "https://stackoverflow.com/questions/49768305/cant-import-system-directory-when-using-stack-to-load-a-file-in-ghci/49787073#49787073", "title": "Can&#39;t import System.Directory when using stack to load a file in GHCi", "body": "<p>Consider <code>stack ghci --package directory</code>?  What's going on is that <code>stack runhaskell</code> will see all the packages in your DB - it doesn't use package hiding.  This means its behavior varies depending on what's already been installed.</p>\n\n<p><code>stack ghci</code>, on the other hand, defaults to hiding all the packages unless they are in the dependencies of the current targets.  If there are no targets, you can add additional dependencies via the <code>--package</code> option.</p>\n"}], "owner": {"reputation": 65, "user_id": 9600787, "user_type": "registered", "profile_image": "https://graph.facebook.com/1940374526035557/picture?type=large", "display_name": "SAN", "link": "https://stackoverflow.com/users/9600787/san"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1523500390, "creation_date": 1523429360, "last_edit_date": 1523454825, "question_id": 49768305, "link": "https://stackoverflow.com/questions/49768305/cant-import-system-directory-when-using-stack-to-load-a-file-in-ghci", "title": "Can&#39;t import System.Directory when using stack to load a file in GHCi", "body": "<p>I checked <a href=\"https://stackoverflow.com/questions/46260461/i-cant-import-system-directory-when-using-stack?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qa\">I cant import System.Directory when using stack</a>, but I think I'm the different case.</p>\n\n<p>Just like case above, it worked well with <code>runhaskell</code>, but when I retried it with <code>stack ghci</code> I got error saying:</p>\n\n<pre><code>C:\\haskell\\Hello\\app\\Main.hs:3:1: error:\nCould not find module \u2018System.Directory\u2019\nUse -v to see a list of the files searched for.\n</code></pre>\n\n<p>Why it works when I use <code>runhaskell</code> but not <code>stack ghci</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 2, "creation_date": 1523448288, "post_id": 49767538, "comment_id": 86564081, "body": "Looking at the source of your question, it seems you&#39;re mixing tabs &amp; spaces. Haskell doesn&#39;t really like that (something may look like it&#39;s aligned in your editor but not be considered as such by the compiler because they don&#39;t consider tabs as wide as you do). It is generally recommended to stick to spaces only."}], "answers": [{"tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": true, "score": 4, "last_activity_date": 1523428658, "creation_date": 1523428658, "answer_id": 49768124, "question_id": 49767538, "link": "https://stackoverflow.com/questions/49767538/haskell-parsing-error-on-let/49768124#49768124", "title": "Haskell Parsing Error on &#39;let&#39;", "body": "<p>Your do-block is not properly indented. Here's one way:</p>\n\n<pre><code>shorterThan :: String -&gt; Int -&gt; IO [String]\nshorterThan fileName len = do\n  fileContents &lt;- readFile fileName\n  let fileWords = lines fileContents\n  let shorterThanWords = [word | word &lt;- fileWords, length word &lt; len]\n  return shorterThanWords\n</code></pre>\n\n<p>The <code>let</code> must begin at the start of the do-block indentation.</p>\n\n<p>You also have one <code>)</code> too many at the end, it seems.</p>\n\n<p>I'd prefer to separate the \"shorter than\" logic into a non-I/O function like so:</p>\n\n<pre><code>shorterThan :: Int -&gt; [String] -&gt; [String]\nshorterThan n ws = [ w | w &lt;- ws, length w &lt; n ]\n\nwordsFromFile :: FilePath -&gt; IO [String]\nwordsFromFile filePath = words &lt;$&gt; readFile filePath\n\nmain :: IO ()\nmain = wordsFromFile \"hello.txt\" &gt;&gt;= mapM_ putStrLn . shorterThan 5\n</code></pre>\n\n<p>This makes it more reusable and more easily testable.</p>\n"}], "owner": {"reputation": 35, "user_id": 9372207, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204322705745816/picture?type=large", "display_name": "Brandon Pham", "link": "https://stackoverflow.com/users/9372207/brandon-pham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 49768124, "answer_count": 1, "score": 2, "last_activity_date": 1523429126, "creation_date": 1523426308, "last_edit_date": 1523429126, "question_id": 49767538, "link": "https://stackoverflow.com/questions/49767538/haskell-parsing-error-on-let", "title": "Haskell Parsing Error on &#39;let&#39;", "body": "<p>Hey I'm having an issue with parsing errors and I am pretty new to this. I couldn't find much on white space rules of Haskell when it comes to do's and let's. If you could point me in the right direction that would be greatly appreciated.</p>\n\n<p>CODE:</p>\n\n<pre><code>import Data.Char\n\n-- shorterThan function takes a filename and a length and returns all words in the file shorter than the given length.\n\nshorterThan :: String -&gt; Int -&gt; IO [String]\nshorterThan fileName len = do fileContents &lt;- readFile fileName\n                                let fileWords = lines fileContents\n                                let shorterThanWords = [word | word &lt;- fileWords, (length word) &lt; len]\n                                return shorterThanWords\n\nshorterThan' :: String -&gt; Int -&gt; IO [String]\nshorterThan' fileName len = readFile fileName &gt;&gt;= (\\fileContents -&gt; let fileWords = lines fileContents\n                                                                        shorterThanWords = [word | word &lt;-fileWords, (length word) &lt; len]\n                                                                    in return shorterThanWords))\n</code></pre>\n"}, {"tags": ["arrays", "haskell"], "comments": [{"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 2, "creation_date": 1523422376, "post_id": 49766679, "comment_id": 86548845, "body": "Are you sure you can&#39;t import the <code>Data.Array</code> module? It&#39;s specified in <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellpa2.html#haskellch14.html\" rel=\"nofollow noreferrer\">Haskell2010</a>, I&#39;d be really surprised if some Haskell distribution didn&#39;t have it."}, {"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1523423061, "post_id": 49766679, "comment_id": 86549053, "body": "Nice. Thank you Chris. I was doing google code jam 2018. <a href=\"https://code.google.com/codejam/resources/faq\" rel=\"nofollow noreferrer\">And it says the Haskell&#39;s complier&#39;s version is 8.0.1 and package is <code>ghc</code></a>. I&#39;ve no idea what packages are included there. How can I find document that lists all the modules included in the package <code>ghc</code>?"}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 1, "creation_date": 1523425009, "post_id": 49766679, "comment_id": 86549721, "body": "I&#39;m not sure, but if you look at <a href=\"https://hackage.haskell.org/package/ghc\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/ghc</a>, you can see that the <code>ghc</code> package has a dependency on the <code>array</code> package, so it is probably available."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1523433063, "creation_date": 1523433063, "answer_id": 49769427, "question_id": 49766679, "link": "https://stackoverflow.com/questions/49766679/is-ghc-arr-a-good-enough-array-implementation-to-use/49769427#49769427", "title": "Is GHC.Arr a good enough Array implementation to use?", "body": "<p>From the <a href=\"https://code.google.com/codejam/resources/faq#language-details\" rel=\"nofollow noreferrer\">code jam site</a>:</p>\n\n<blockquote>\n  <p>Our platform uses 64-bit Debian 9.3 (stretch). We install the packages using the command <code>apt-get install -y --no-install-recommends {.package_name}</code>.</p>\n  \n  <p>[...]</p>\n  \n  <p>Haskell:</p>\n  \n  <ul>\n  <li>The Glorious Glasgow Haskell Compilation System 8.0.1 (package: <code>ghc</code>)</li>\n  <li><code>ghc +RTS -V0 -RTS -rtsopts -o Solution Solution.hs</code></li>\n  <li><code>./Solution +RTS -V0 -RTS</code></li>\n  </ul>\n</blockquote>\n\n<p>So, the list of installed files can be found at <a href=\"https://packages.debian.org/stretch/amd64/ghc/filelist\" rel=\"nofollow noreferrer\">https://packages.debian.org/stretch/amd64/ghc/filelist</a> .</p>\n\n<p>Standard Haskell packages such as <code>base,array,containers,...</code> are included. You can use <code>Data.Array</code>.</p>\n\n<p>Full list of packages:</p>\n\n<pre><code>/var/lib/ghc/package.conf.d/Cabal-1.24.0.0.conf\n/var/lib/ghc/package.conf.d/array-0.5.1.1.conf\n/var/lib/ghc/package.conf.d/base-4.9.0.0.conf\n/var/lib/ghc/package.conf.d/binary-0.8.3.0.conf\n/var/lib/ghc/package.conf.d/bytestring-0.10.8.1.conf\n/var/lib/ghc/package.conf.d/containers-0.5.7.1.conf\n/var/lib/ghc/package.conf.d/deepseq-1.4.2.0.conf\n/var/lib/ghc/package.conf.d/directory-1.2.6.2.conf\n/var/lib/ghc/package.conf.d/filepath-1.4.1.0.conf\n/var/lib/ghc/package.conf.d/ghc-8.0.1.conf\n/var/lib/ghc/package.conf.d/ghc-boot-8.0.1.conf\n/var/lib/ghc/package.conf.d/ghc-boot-th-8.0.1.conf\n/var/lib/ghc/package.conf.d/ghc-prim-0.5.0.0.conf\n/var/lib/ghc/package.conf.d/ghci-8.0.1.conf\n/var/lib/ghc/package.conf.d/haskeline-0.7.2.3.conf\n/var/lib/ghc/package.conf.d/hoopl-3.10.2.1.conf\n/var/lib/ghc/package.conf.d/hpc-0.6.0.3.conf\n/var/lib/ghc/package.conf.d/integer-gmp-1.0.0.1.conf\n/var/lib/ghc/package.conf.d/pretty-1.1.3.3.conf\n/var/lib/ghc/package.conf.d/process-1.4.2.0.conf\n/var/lib/ghc/package.conf.d/rts.conf\n/var/lib/ghc/package.conf.d/template-haskell-2.11.0.0.conf\n/var/lib/ghc/package.conf.d/terminfo-0.4.0.2.conf\n/var/lib/ghc/package.conf.d/time-1.6.0.1.conf\n/var/lib/ghc/package.conf.d/transformers-0.5.2.0.conf\n/var/lib/ghc/package.conf.d/unix-2.7.2.0.conf\n/var/lib/ghc/package.conf.d/xhtml-3000.2.1.conf\n</code></pre>\n"}], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 49769427, "answer_count": 1, "score": 0, "last_activity_date": 1523433063, "creation_date": 1523422060, "question_id": 49766679, "link": "https://stackoverflow.com/questions/49766679/is-ghc-arr-a-good-enough-array-implementation-to-use", "title": "Is GHC.Arr a good enough Array implementation to use?", "body": "<p>I'm on a platform where only <code>base</code> is available, no other library. I'd like to use the Array data structure. I can't use Data.Array which is defined in a separate package in <code>array</code>. </p>\n\n<p>I found GHC.Arr provides array implementation. Is it a good implementation to use? </p>\n\n<p>I was also wondering why the documentation for <code>GHC.Arr</code> doesn't have a link \n<a href=\"https://hackage.haskell.org/package/base-4.11.0.0\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/base-4.11.0.0</a></p>\n"}, {"tags": ["haskell", "algebra", "polynomials"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1523414972, "post_id": 49765183, "comment_id": 86546952, "body": "<code>separateRoots</code> <i>should</i> get you most of the way there, but it doesn&#39;t seem to work correctly.  E.g. <code>separateRoots BE [1,0,-1]</code> fails to separate."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523434871, "post_id": 49765183, "comment_id": 86554880, "body": "Note that once <i>n</i> is greater than 5, there is no algebraic exact way to find the roots: <a href=\"https://en.wikipedia.org/wiki/Abel%E2%80%93Ruffini_theorem\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Abel%E2%80%93Ruffini_theorem</a>"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523439328, "post_id": 49765183, "comment_id": 86557944, "body": "@WillemVanOnsem Interesting. I was sure this theorem was originally due to Galois."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1523439702, "post_id": 49765183, "comment_id": 86558224, "body": "Well the theorem has been proved in 1824, at that moment, Galois was 13 years old. Although Galois was very young when he died (as a result of a love affair and in a duel if I recall correctly), but as far as I know, he did not wrote that theorem when he was 13."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523443558, "post_id": 49765183, "comment_id": 86560864, "body": "@WillemVanOnsem No general way, there however exceptions, x^5  = 1 has only roots which can be algebraically found for example."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1890615"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1523459804, "post_id": 49765183, "comment_id": 86572872, "body": "@luqui thats what I was thinking, but wasn&#39;t sure if that was expected behavior or not. I may file a bug report."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1532425409, "post_id": 49765183, "comment_id": 89958885, "body": "@WillemVanOnsem I read somewhere (don&#39;t remember where) that Abel proved the case degree=5 only (this contradicts Wikipedia), while Galois proved the case higher than 5."}], "answers": [{"tags": [], "owner": {"reputation": 18055, "user_id": 936310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/302ec54987694b9746abf8e2e0ad8caf?s=128&d=identicon&r=PG&f=1", "display_name": "alias", "link": "https://stackoverflow.com/users/936310/alias"}, "is_accepted": false, "score": 4, "last_activity_date": 1523426926, "last_edit_date": 1523426926, "creation_date": 1523425352, "answer_id": 49767337, "question_id": 49765183, "link": "https://stackoverflow.com/questions/49765183/finding-the-roots-of-a-polynomial/49767337#49767337", "title": "Finding the roots of a polynomial", "body": "<p>If you don't mind using an external SMT solver, you can use the SBV package:</p>\n\n<pre><code>Prelude Data.SBV&gt; allSat $ \\x -&gt; 2*x^3-19*x^2+15*x+72 .== (0::SReal)\nSolution #1:\n  s0 = 3.0 :: Real\nSolution #2:\n  s0 = 8.0 :: Real\nSolution #3:\n  s0 = -1.5 :: Real\nFound 3 different solutions.\n</code></pre>\n\n<p>You are guaranteed that the roots will be precise, i.e., no rounding error will happen. The <code>Real</code> type corresponds to infinitely precise algebraic reals. If the result cannot be printed in a finite form, it'll be written as the root of a simple equation and will be expanded to the current print precision:</p>\n\n<pre><code>Prelude Data.SBV&gt; allSat $ \\x -&gt; x^2-2 .== (0::SReal)\nSolution #1:\n  s0 = root(1, x^2 = 2) = -1.414213562373095... :: Real\nSolution #2:\n  s0 = root(2, x^2 = 2) = 1.414213562373095... :: Real\nFound 2 different solutions.\n</code></pre>\n\n<p>The number of digits can be arbitrarily long and is configurable:</p>\n\n<pre><code>Prelude Data.SBV&gt; allSatWith z3{printRealPrec=20} $ \\x -&gt; x^2-2 .== (0::SReal)\nSolution #1:\n  s0 = root(1, x^2 = 2) = -1.4142135623730950488... :: Real\nSolution #2:\n  s0 = root(2, x^2 = 2) = 1.4142135623730950488... :: Real\nFound 2 different solutions.\n</code></pre>\n\n<p>Note that SMT solvers will only get you real-roots; no complex solutions will be found:</p>\n\n<pre><code>Prelude Data.SBV&gt; allSat $ \\x -&gt; x^2+1 .== (0::SReal)\nNo solutions found.\n</code></pre>\n\n<p>If only some roots are real, those will be found:</p>\n\n<pre><code>Prelude Data.SBV&gt; allSat $ \\x -&gt; x^3+2*x-1 .== (0::SReal)\nSolution #1:\n  s0 = root(1, x^3+2x = 1) = 0.4533976515164037... :: Real\nThis is the only solution.\n</code></pre>\n\n<p>PS. To make this all work, do not forget to first install Z3 on your machine. You can get a recent copy from <a href=\"https://github.com/Z3Prover/z3/releases\" rel=\"nofollow noreferrer\">https://github.com/Z3Prover/z3/releases</a></p>\n"}, {"tags": [], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "is_accepted": true, "score": 3, "last_activity_date": 1523438802, "creation_date": 1523438802, "answer_id": 49771359, "question_id": 49765183, "link": "https://stackoverflow.com/questions/49765183/finding-the-roots-of-a-polynomial/49771359#49771359", "title": "Finding the roots of a polynomial", "body": "<p>You can use the <code>Polynomial.Roots</code> module of the <a href=\"https://hackage.haskell.org/package/dsp-0.2.4/docs/Polynomial-Roots.html\" rel=\"nofollow noreferrer\"><code>dsp</code> package</a>. It deals with complex values (complex coefficients and complex roots).</p>\n\n<p>For instance, to solve <code>1+2x+2x\u00b2=0</code>: </p>\n\n<pre><code>Prelude&gt; import Polynomial.Roots \nPrelude Polynomial.Roots&gt; roots 1e-16 1000 [1,2,2]\n[(-0.5) :+ (-0.5),(-0.5) :+ 0.5]\n</code></pre>\n\n<p>As a sanity check, R gives the same result:</p>\n\n<pre><code>&gt; polyroot(c(1,2,2))\n[1] -0.5+0.5i -0.5-0.5i\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1890615"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 1, "accepted_answer_id": 49771359, "answer_count": 2, "score": 4, "last_activity_date": 1523438802, "creation_date": 1523410932, "last_edit_date": 1523424741, "question_id": 49765183, "link": "https://stackoverflow.com/questions/49765183/finding-the-roots-of-a-polynomial", "title": "Finding the roots of a polynomial", "body": "<p>Given a polynomial of degree n, how can I reliably find all values of x where y = 0.</p>\n\n<p>I'm currently using the <a href=\"https://hackage.haskell.org/package/polynomial-0.7.3/docs/Math-Polynomial.html\" rel=\"noreferrer\"><code>Math.Polynomial</code></a> library, which doesn't seem to have this function built in. However, I could be missing something here, it seems like this would be a widely used function.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 9806, "user_id": 382982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9ZaxF.jpg?s=128&g=1", "display_name": "pdoherty926", "link": "https://stackoverflow.com/users/382982/pdoherty926"}, "edited": false, "score": 0, "creation_date": 1523416539, "post_id": 49765136, "comment_id": 86547288, "body": "@pdoherty926 I believe there isn&#39;t more to it -- a reconstructed problem statement might be &quot;implement the list-like/<code>Foldable</code>-like fold (<code>foldRT</code>) in terms of the catamorphism/general fold (<code>fold</code>)&quot;."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1523425028, "post_id": 49765136, "comment_id": 86549727, "body": "See <a href=\"https://stackoverflow.com/a/27458645/383200\">stackoverflow.com/a/27458645/383200</a> for a discussion of the general technique.  That answer goes over it for lists, but the same idea applies."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 1, "last_activity_date": 1524165706, "last_edit_date": 1524165706, "creation_date": 1524163224, "answer_id": 49928053, "question_id": 49765136, "link": "https://stackoverflow.com/questions/49765136/haskell-folding-over-trees/49928053#49928053", "title": "Haskell: Folding over trees", "body": "<p>As its name and type signature suggest, <code>foldRT</code> is a bona fide right fold for your tree (you can convince yourself of that by hand-evaluating it for something like <code>Branch 1 (Branch 0 Leaf Leaf) (Branch 2 Leaf Leaf)</code>). That means implementing <code>Foldable</code> will give you <code>foldRT</code>: <code>foldRT = foldr</code>. Why is that relevant? Because, in this case, it is much easier to implement <code>foldMap</code> than it is to figure out how to write <code>foldr</code> directly:</p>\n\n<pre><code>-- Note that l and r here aren't the subtrees, but the results of folding them.\ninstance Foldable Tree where\n    foldMap f = fold (\\v l r -&gt; l &lt;&gt; f v &lt;&gt; r) mempty\n</code></pre>\n\n<p>If you want to write <code>foldRT</code> without relying on a <code>Foldable</code> instance, all you need is expanding the <code>foldMap</code>-based definition of <code>foldr</code> (see the answers to <a href=\"https://stackoverflow.com/q/23319683/2751851\">this question</a> for the details I'll gloss over here):</p>\n\n<pre><code>foldRT f z t = appEndo (foldMap (Endo . f) t) z\n\n-- To make things less clumsy, let's use:\nfoldEndo f = appEndo . foldMap (Endo . f)\n-- foldEndo f = flip (foldRT f)\n\nfoldEndo f = appEndo . fold (\\v l r -&gt; l &lt;&gt; Endo (f v) &lt;&gt; r) mempty\n\n-- As we aren't mentioning foldMap anymore, we can drop the Endo wrappers.\n-- mempty @(Endo _) = Endo id\n-- Endo g &lt;&gt; Endo f = Endo (g . f)\nfoldEndo f = fold (\\v l r -&gt; l . f v . r) id\n\n-- Bringing it all back home:\nfoldRT :: (a -&gt; b -&gt; b) -&gt; b -&gt; Tree a -&gt; b\nfoldRT f z t = fold (\\v l r -&gt; l . f v . r) id t z\n</code></pre>\n\n<p>(Note that we ultimately reached a solution of the sort <a href=\"https://stackoverflow.com/a/27458645/2751851\">suggested by Carl</a>, only through an indirect route.)</p>\n"}], "owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1524165706, "creation_date": 1523410582, "question_id": 49765136, "link": "https://stackoverflow.com/questions/49765136/haskell-folding-over-trees", "title": "Haskell: Folding over trees", "body": "<p>I am going through some old courses online and came across this task:</p>\n\n<pre><code>data Tree a = Leaf \n            | Branch a (Tree a) (Tree a) \n            deriving (Show, Eq)\n\nfold :: (a -&gt; b -&gt; b -&gt; b) -&gt; b -&gt; Tree a -&gt; b\nfold _ acc Leaf           = acc\nfold f acc (Branch v l r) = f v (fold f acc l) (fold f acc r)\n\nfoldRT :: (a -&gt; b -&gt; b) -&gt; b -&gt; Tree a -&gt; b\nfoldRT _ acc Leaf = acc\nfoldRT f acc (Branch v l r) = foldRT f (f v (foldRT f acc r)) l\n</code></pre>\n\n<p>The task is to rewrite <code>foldRT</code> in terms of <code>fold</code>. I have been stuck on it for ages and can't wrap my head around it.</p>\n\n<p>A walk through would be greatly appreciated.</p>\n"}, {"tags": ["java", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1523409335, "post_id": 49764615, "comment_id": 86545536, "body": "What&#39;s the problem you are trying to solve? It&#39;s obfuscated by the updates to the table in your java code."}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1523414986, "post_id": 49764615, "comment_id": 86546963, "body": "You inner loop should be <code>for (int b = a; b &lt; size - 1; b++){ </code> because you do things like <code>dynamic[a][b+1]</code> which will be out-of-bound error when <code>b == size - 1</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "is_accepted": false, "score": 1, "last_activity_date": 1523414375, "last_edit_date": 1523414375, "creation_date": 1523414011, "answer_id": 49765581, "question_id": 49764615, "link": "https://stackoverflow.com/questions/49764615/converting-java-like-2d-dynamic-programing-matrix-to-haskell/49765581#49765581", "title": "Converting Java-like 2D Dynamic Programing Matrix to Haskell", "body": "<p>Dynamic programming usually relies on mutability for efficiency. But that's totally doable in Haskell. The <code>array</code> and <code>vector</code> packages both provide mutable array data structures. The APIs are slightly different than what you are probably used to in Java, but usually algorithms such as yours have a pretty direct translation. For example, here's your algorithm using the <code>array</code> package and the <code>ST</code> monad:</p>\n\n<pre><code>import Control.Monad\nimport Control.Monad.ST\nimport Data.Array.Unboxed\nimport Data.Array.MArray.Safe\nimport Data.Array.ST.Safe\n\nfoo :: Int -&gt; UArray (Int,Int) Int\nfoo size = runSTUArray $ do\n  dynamic &lt;- newArray ((0,size-1),(0,size-1)) 0\n  writeArray dynamic (0,0) 1\n  forM_ [0..size-1] $ \\a -&gt; do\n    forM_ [a..size-1] $ \\b -&gt; do\n      v &lt;- readArray dynamic (a,b)\n      if a == 0 then do\n        writeArray dynamic (a+1,b+1) (v*2)\n        writeArray dynamic (a, b+1) (v*(-1))\n      else do\n        v1 &lt;- readArray dynamic (a+1,b+1)\n        writeArray dynamic (a+1,b+1) (v1 + v * 3)\n        v2 &lt;- readArray dynamic (a,b+1)\n        writeArray dynamic (a,b+1) (v2 + v * 2)\n  return dynamic\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": false, "score": 4, "last_activity_date": 1523430307, "creation_date": 1523430307, "answer_id": 49768573, "question_id": 49764615, "link": "https://stackoverflow.com/questions/49764615/converting-java-like-2d-dynamic-programing-matrix-to-haskell/49768573#49768573", "title": "Converting Java-like 2D Dynamic Programing Matrix to Haskell", "body": "<p>Usually doing mutation manually is a mistake an Haskell.  It's awkward, and it reintroduces all the mutation bugs you normally don't get in Haskell.  Usually you let laziness take care of things for you.  Dynamic programming problems have a structure that's very straightforward to express with laziness in Haskell, but you need to start with a less obfuscated specification of the code.</p>\n\n<p>The first thing to do is deobfuscate into an inefficient recursive representation.  This was a complete pain for your example - I hope you were just typing code in more or less at random.</p>\n\n<p>Here's what I got, expressed in Haskell, though I don't guarantee it to be correct:</p>\n\n<pre><code>present :: Int -&gt; Int -&gt; Int\npresent 0 0 = 1\npresent _ 0 = 0\npresent 0 b = negate (present 0 (b - 1))\npresent a b = future a b + 2 * present a (b - 1)\n\nfuture :: Int -&gt; Int -&gt; Int\nfuture 1 b = 2 * present 0 b\nfuture a b = 3 * present (a - 1) (b - 1)\n</code></pre>\n\n<p>To get around your mutation, I had to use mutually recursive functions, with <code>present</code> conceptually tracking the state of the present row in your loop, and <code>future</code> tracking the state of the next row.  Note that the future case for rows after the first doesn't exactly mirror what you wrote. I took the liberty of trimming out the <code>dynamic[a+1][b+1] +</code> part, as <code>dynamic[a+1][b+1]</code> is always going to be zero with the way your logic is laid out.</p>\n\n<p>Normally you start dynamic programming with the recursive solution, so you don't need to go about reverse engineering like I did here.  Also, you usually have something that doesn't look like completely random operations.  I kind of like that there's mutual recursion between multiple functions, though. It makes the next part cooler.</p>\n\n<p>Let's investigate a bit in ghci, just to get a rough idea how it performs.</p>\n\n<pre><code>*Main&gt; :set +s\n*Main&gt; present 10 10\n-39366\n(0.00 secs, 801,616 bytes)\n*Main&gt; present 11 11\n-118098\n(0.00 secs, 1,530,632 bytes)\n*Main&gt; present 20 20\n-2324522934\n(1.07 secs, 746,657,288 bytes)\n*Main&gt; present 21 21\n-6973568802\n(2.22 secs, 1,493,244,064 bytes)\n*Main&gt; present 22 22\n-20920706406\n(4.14 secs, 2,986,417,752 bytes)\n</code></pre>\n\n<p>That's starting to look roughly like the expected exponential growth in runtime.</p>\n\n<p>Here's where things get cool.  Values in Haskell can be defined in terms of themselves.  The basic idea is to set up regular boxed arrays corresponding to each function, where the value of each cell is expressed via a function that replaces function calls with an array lookup. As long as there isn't any circularity in the definition, laziness just makes it all work.</p>\n\n<p>Here's what it looks like, in code:</p>\n\n<pre><code>import Data.Array\nimport Data.Ix\n\nmemoPresent :: Int -&gt; Int -&gt; Int\nmemoPresent r c = pArray ! (r, c)\n  where\n    bounds = ((0, 0), (r, c))\n\n    pArray = listArray bounds (map (uncurry present) (range bounds))\n\n    present 0 0 = 1\n    present _ 0 = 0\n    present 0 b = negate (pArray ! (0, b - 1))\n    present a b = fArray ! (a, b) + 2 * pArray ! (a, b - 1)\n\n    fArray = listArray bounds (map (uncurry future) (range bounds))\n\n    future 1 b = 2 * pArray ! (0, b)\n    future a b = 3 * pArray ! (a - 1, b - 1)\n</code></pre>\n\n<p>If you're paying close attention, you might notice that the whole first row of <code>fArray</code> isn't defined. You'd get a error if anything from that row was accessed, but that's the same situation you end up in with the recursive code, if you called <code>future 0 whatever</code>.</p>\n\n<p>Let's see how this performs:</p>\n\n<pre><code>*Main&gt; :set +s\n*Main&gt; memoPresent 10 10\n-39366\n(0.00 secs, 194,176 bytes)\n*Main&gt; memoPresent 11 11\n-118098\n(0.00 secs, 223,344 bytes)\n*Main&gt; memoPresent 20 20\n-2324522934\n(0.00 secs, 521,944 bytes)\n*Main&gt; memoPresent 21 21\n-6973568802\n(0.00 secs, 566,544 bytes)\n*Main&gt; memoPresent 22 22\n-20920706406\n(0.00 secs, 616,304 bytes)\n*Main&gt; memoPresent 100 100\n1989748563691696842\n(0.01 secs, 10,442,400 bytes)\n*Main&gt; memoPresent 200 200\n7879235843265279210\n(0.05 secs, 41,116,704 bytes)\n*Main&gt; memoPresent 1000 1000\n-4135538464527847958\n(1.26 secs, 1,064,652,488 bytes)\n</code></pre>\n\n<p>Huh.  I didn't expect it would suddenly start getting positive answers.  Oh, that's probably just <code>Int</code> underflow.  <code>Integer</code> might have been a better choice of type, though it wouldn't reflect your Java code as well.</p>\n\n<p>Anyway - the translation from recursive form to dynamic programming is really straightforward in Haskell if you use laziness to your advantage. You just need to make sure you do  your original formulation in terms of the inefficient recursion instead of obfuscated but efficient looping mutation.</p>\n"}], "owner": {"reputation": 1, "user_id": 9627702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23fedc99f51224ca44026bb64c1d5b51?s=128&d=identicon&r=PG&f=1", "display_name": "justOneMoreTime", "link": "https://stackoverflow.com/users/9627702/justonemoretime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1523430307, "creation_date": 1523406046, "question_id": 49764615, "link": "https://stackoverflow.com/questions/49764615/converting-java-like-2d-dynamic-programing-matrix-to-haskell", "title": "Converting Java-like 2D Dynamic Programing Matrix to Haskell", "body": "<p>I'm currently working with a dynamic programing algorithm in java, which uses a classic 2D matrix for back calculations. I'm trying my luck at converting it to a functional language like haskell, but it's proving beyond my match. Looking for any recommendations on what the solution might look like:</p>\n\n<pre><code>int[][] dynamic = new int[size][size];\nfor (int outer = 0; outer &lt; size; j++){\n    Arrays.fill(dynamic[outer], 0);\n}\n\ndynamic[0][0] = 1; \n\nfor (int a = 0; a &lt; size; a++){ \n   for (int b = a; b &lt; size; b++){ \n      if (a == 0){\n        dynamic[a+1][b+1] = dynamic[a][b] * 2;\n\n        dynamic[a][b+1] = dynamic[a][b] * -1;\n      } else{\n        dynamic[a+1][b+1] = dynamic[a+1][b+1] + (dynamic[a][b] * 3);\n        dynamic[a][b+1] = dynamic[a][b+1] + (dynamic[a][b] * 2);\n      }\n    }\n}\n</code></pre>\n\n<p>So far I've been looking for different options for creating 2D arrays, but to no luck. I'm guessing because Haskell does not use mutable state so it's not a super popular option. It's probably just my java brain, but I'd love some people with functional background to perhaps give me a few pointers on how to go about thinking or solving for this conversion?</p>\n"}, {"tags": ["function", "haskell", "types", "transparency", "referential"], "comments": [{"owner": {"reputation": 29068, "user_id": 149436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc4c5aa5126e36603eabdfdc57c46583?s=128&d=identicon&r=PG", "display_name": "Evan Trimboli", "link": "https://stackoverflow.com/users/149436/evan-trimboli"}, "edited": false, "score": 0, "creation_date": 1523407365, "post_id": 49764492, "comment_id": 86545030, "body": "Not 100% sure, but I think it&#39;s because the expression can only ever evaluate to <code>Maybe Bool</code> in the second example, it&#39;s either <code>Nothing</code> or <code>Just Bool</code>."}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 2, "creation_date": 1523408565, "post_id": 49764492, "comment_id": 86545322, "body": "<code>[a] -&gt; Maybe b</code> means it should work <b>for all</b> <code>a</code> and <code>b</code>. Walk through what would happen if the compiler let you call <code>isQuestion</code> with an argument of, say, <code>[4]</code>. Ultimately it would end up trying to evaluate the expression <code>4 == &#39;?&#39;</code>, which doesn&#39;t make sense since you can&#39;t compare values of different types."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1523444914, "post_id": 49764492, "comment_id": 86561793, "body": "When you write a generic function, the <i>caller</i> specifies the concrete types. So if you write a function of type <code>a -&gt; a</code>, for example, it must work for <code>Int -&gt; Int</code>, <code>Char -&gt; Char</code>, <code>String -&gt; String</code>, or any other concrete type in place of <code>a</code>. That means you can\u2019t assume anything about the operations available on <code>a</code> or what type it is, without additional constraints\u2014for example, <code>Eq a</code> to enable using <code>==</code> and <code>&#47;=</code>. Your function assumes <code>a</code> is <code>Char</code> and <code>b</code> is <code>Bool</code>\u2014it\u2019s not as generic as the type signature says. (Other answers here explain how to fix this, depending on what you want.)"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1523455789, "post_id": 49764492, "comment_id": 86569750, "body": "AFAIK, the only possible implementation of <code>f :: [a] -&gt; Maybe b</code> is <code>f _ = Nothing</code>."}], "answers": [{"comments": [{"owner": {"reputation": 4426, "user_id": 450609, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6708bd9ccabfcb1cf6863fb32f32d1de?s=128&d=identicon&r=PG", "display_name": "dave", "link": "https://stackoverflow.com/users/450609/dave"}, "edited": false, "score": 0, "creation_date": 1523491198, "post_id": 49764859, "comment_id": 86587462, "body": "I think you mean if a is <code>Char</code> not <code>[Char]</code>"}], "tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": false, "score": 4, "last_activity_date": 1523495258, "last_edit_date": 1523495258, "creation_date": 1523408275, "answer_id": 49764859, "question_id": 49764492, "link": "https://stackoverflow.com/questions/49764492/haskell-type-variables-and-generic-types/49764859#49764859", "title": "Haskell: type variables and generic types", "body": "<p>The type <code>[a] -&gt; Maybe b</code> is shorthand for <code>forall a b. [a] -&gt; Maybe b</code>. But <code>isQuestion</code> doesn't work <em>for all</em> types <code>a</code> and <code>b</code>, it only works specifically if <code>a</code> is <code>Char</code> and <code>b</code> is <code>Bool</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1523416011, "post_id": 49765552, "comment_id": 86547185, "body": "Doesn&#39;t parametric polymorphism give rise to <a href=\"https://en.wikipedia.org/wiki/Hindley%E2%80%93Milner_type_system#Polymorphic_type_order\" rel=\"nofollow noreferrer\">a subtyping relation</a> (you get an order on types and you upcast by specializing), though? There&#39;s <i>more</i> to it, but you can still use subtyping to explain why this can&#39;t work. Specifically, here we need <code>forall a b. [a] -&gt; Maybe b</code>, but we&#39;ve a value for a supertype, <code>[Char] -&gt; Maybe Bool</code>, so we can&#39;t use it. If we had an <code>exists</code> quantifier, we&#39;d even get a nice hierarchy with <code>exists a. a</code> at the top, everything else in between, and <code>forall a. a</code> at the bottom."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1523424765, "post_id": 49765552, "comment_id": 86549614, "body": "Sure.  Some polymorphic types are more general than others. But without existentials, it doesn&#39;t work at all like one would expect with OO-style subtyping. Unless you&#39;ve got an incredibly strong type theory background, it&#39;s better to just learn how parametric polymorphism works first, and then place it in the theory terms later."}], "tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": false, "score": 2, "last_activity_date": 1523413777, "creation_date": 1523413777, "answer_id": 49765552, "question_id": 49764492, "link": "https://stackoverflow.com/questions/49764492/haskell-type-variables-and-generic-types/49765552#49765552", "title": "Haskell: type variables and generic types", "body": "<p>Parametric polymorphism is <em>not</em> subtyping or supertyping. It's a statement that the implementation of a value doesn't depend on part of the type. In fact, the implementation works for any choice of type at all.</p>\n\n<p>Your implementation doesn't work for any choice of type.  It only works if <code>a</code> is <code>Char</code> and <code>b</code> is <code>Bool</code>. You can tell this because it uses <code>(== '?')</code> in there, which is a function of type <code>Char -&gt; Bool</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1033, "user_id": 2056878, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/IZFw8.jpg?s=128&g=1", "display_name": "devio", "link": "https://stackoverflow.com/users/2056878/devio"}, "edited": false, "score": 0, "creation_date": 1523436296, "post_id": 49767805, "comment_id": 86555794, "body": "Thanks Regis. But when you say &quot;thus <code>Maybe Bool</code> would be redundant&quot;, what do you exactly mean?"}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "reply_to_user": {"reputation": 1033, "user_id": 2056878, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/IZFw8.jpg?s=128&g=1", "display_name": "devio", "link": "https://stackoverflow.com/users/2056878/devio"}, "edited": false, "score": 0, "creation_date": 1523444150, "post_id": 49767805, "comment_id": 86561279, "body": "oh, sorry that was not very clear. I&#39;ll update. I meant that, if my assumption applies, then <code>Nothing</code> and <code>Just false</code> would mean virtually the same thing, and so you could get away with just a <code>Bool</code>."}, {"owner": {"reputation": 1033, "user_id": 2056878, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/IZFw8.jpg?s=128&g=1", "display_name": "devio", "link": "https://stackoverflow.com/users/2056878/devio"}, "edited": false, "score": 0, "creation_date": 1523460710, "post_id": 49767805, "comment_id": 86573524, "body": "Thanks for clearing that up. I have put the <code>Maybe</code> type in the first place to consider the case of error (an empty list).."}], "tags": [], "owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "is_accepted": true, "score": 4, "last_activity_date": 1523444322, "last_edit_date": 1523444322, "creation_date": 1523427507, "answer_id": 49767805, "question_id": 49764492, "link": "https://stackoverflow.com/questions/49764492/haskell-type-variables-and-generic-types/49767805#49767805", "title": "Haskell: type variables and generic types", "body": "<p>First observation is that</p>\n\n<pre><code>last xs == something\n</code></pre>\n\n<p>can only work if there is a definition of <code>(==)</code> in scope for the elements of <code>xs</code>. But as the compiler knows nothing about <code>a</code>, there is no such thing. You must narrow <code>a</code> to be the subset of types with equality:</p>\n\n<pre><code>isQuestion :: Eq a =&gt; [a] -&gt; Maybe b\n</code></pre>\n\n<p>The second observation is that <code>something</code> is a <code>Char</code> in your code (<code>'?'</code>), so this method can only ever work when <code>a \u2261 Char</code>. Instead, you could add that something as a parameter:</p>\n\n<pre><code>isQuestion :: Eq a =&gt; a -&gt; [a] -&gt; Maybe b\n</code></pre>\n\n<p>Finally, as has been pointed out, you have a concrete return type, i.e. <code>Maybe Bool</code>, as</p>\n\n<pre><code>(==) :: a -&gt; a -&gt; Bool\n</code></pre>\n\n<p>So your function's signature could be</p>\n\n<pre><code>isQuestion :: Eq a =&gt; a -&gt; [a] -&gt; Maybe Bool\n</code></pre>\n\n<p><strong>Edited this paragraph for clarity</strong> Note that, depending on your business logic, you might not want to make a special case of the empty string. If the only thing you care about is whether a string ends with a question mark, then <code>Nothing</code> and <code>Just false</code> would virtually mean the same thing. In that case, your function becomes a \"yes or no\" question and you can drop the <code>Maybe</code>:</p>\n\n<pre><code>isQuestion :: Eq a =&gt; a -&gt; [a] -&gt; Bool\nisQuestion x = isSuffixOf [x]\n</code></pre>\n\n<p>or simply</p>\n\n<pre><code>isQuestion :: String -&gt; Bool\nisQuestion = isSuffixOf \"?\"\n</code></pre>\n"}], "owner": {"reputation": 1033, "user_id": 2056878, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/IZFw8.jpg?s=128&g=1", "display_name": "devio", "link": "https://stackoverflow.com/users/2056878/devio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 0, "accepted_answer_id": 49767805, "answer_count": 3, "score": 1, "last_activity_date": 1523495258, "creation_date": 1523405125, "question_id": 49764492, "link": "https://stackoverflow.com/questions/49764492/haskell-type-variables-and-generic-types", "title": "Haskell: type variables and generic types", "body": "<p>When I mention in the type signature of the function <code>isQuestion</code> the types explicitly, GHCi compiles it perfectly:</p>\n\n<pre><code>isQuestion :: [Char] -&gt; Maybe Bool\nisQuestion [] = Nothing\nisQuestion xs = Just (last xs == '?')\n</code></pre>\n\n<p>However, when I turn to 'generic' code, it doesn't work:</p>\n\n<pre><code>isQuestion :: [a] -&gt; Maybe b\nisQuestion [] = Nothing\nisQuestion xs = Just (last xs == '?')\n</code></pre>\n\n<p>since I get the below error:</p>\n\n<pre><code>&lt;interactive&gt;:138:17: error:\n    * Couldn't match type `b' with `Bool'\n      `b' is a rigid type variable bound by\n        the type signature for:\n          isQuestion :: forall a b. [a] -&gt; Maybe b\n        at &lt;interactive&gt;:136:1-28\n      Expected type: Maybe b\n        Actual type: Maybe Bool\n    * In the expression: Just (last xs == '?')\n      In an equation for `isQuestion':\n          isQuestion xs = Just (last xs == '?')\n    * Relevant bindings include\n        isQuestion :: [a] -&gt; Maybe b (bound at &lt;interactive&gt;:137:1)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1523396659, "post_id": 49763284, "comment_id": 86542185, "body": "Can you post the error messages?"}], "answers": [{"comments": [{"owner": {"reputation": 1479, "user_id": 855443, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d880e98c9fffc6253f3868babc99b8c1?s=128&d=identicon&r=PG", "display_name": "user855443", "link": "https://stackoverflow.com/users/855443/user855443"}, "edited": false, "score": 0, "creation_date": 1523442474, "post_id": 49764394, "comment_id": 86560178, "body": "Thank you a lot - it works! I did not know that I have to use Generic1. Why is here no <code>Gpointed</code> (or <code>Pointed&#39;</code>) class required? I wanted to use the class for <code>newtype T = T x</code>, i.e. types of kind * but Pointed works only on types with kind <code>*-&gt;*</code> - correct? What need to be changed?"}], "tags": [], "owner": {"reputation": 8556, "user_id": 4892417, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NaBTj.jpg?s=128&g=1", "display_name": "oisdk", "link": "https://stackoverflow.com/users/4892417/oisdk"}, "is_accepted": false, "score": 2, "last_activity_date": 1523404267, "creation_date": 1523404267, "answer_id": 49764394, "question_id": 49763284, "link": "https://stackoverflow.com/questions/49763284/how-to-write-an-instance-for-generic-to-derive-a-function-like-singleton-a/49764394#49764394", "title": "How to write an instance for Generic to derive a function like singleton:: a -&gt; f a", "body": "<p>This class is usually called \"pointed\", and can be represented as such:</p>\n\n<pre><code>class Pointed f where\n  point :: a -&gt; f a\n  default point :: (Generic1 f, Pointed (Rep1 f)) =&gt; a -&gt; f a\n  point = to1 . point\n</code></pre>\n\n<p>You just need instances for each constructor:</p>\n\n<pre><code>instance Pointed c =&gt; Pointed (M1 i t c) where\n  point = M1 . point\n\ninstance Monoid c =&gt; Pointed (K1 i c) where\n  point _ = K1 mempty\n\ninstance Pointed U1 where\n  point _ = U1\n\ninstance Pointed r =&gt; Pointed (l :+: r) where\n  point = R1 . point\n\ninstance (Pointed l, Pointed r) =&gt; Pointed (l :*: r) where\n  point x = point x :*: point x\n\ninstance Pointed Par1 where\n  point = Par1\n\ninstance Pointed f =&gt; Pointed (Rec1 f) where\n  point = Rec1 . point\n\ninstance (Pointed l, Pointed r) =&gt; Pointed (l :.: r) where\n  point = Comp1 . point . point\n</code></pre>\n\n<p>Then it'll work fine:</p>\n\n<pre><code>data Three a = Three a a a deriving (Show,Generic1)\n\n&gt;&gt;&gt; point True :: Three Bool\nThree True True True\n\ninstance Pointed []\n\n&gt;&gt;&gt; point True :: [Bool]\n[True,True,True,True,True,True...\n</code></pre>\n\n<p>You might notice a similarity to <code>pure</code> in the <code>Applicative</code> class: there's actually <a href=\"https://mail.haskell.org/pipermail/libraries/2018-February/028562.html\" rel=\"nofollow noreferrer\">a proposal</a> on the GHC libraries mailing list to add this precise instance to each constructor above.</p>\n"}], "owner": {"reputation": 1479, "user_id": 855443, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d880e98c9fffc6253f3868babc99b8c1?s=128&d=identicon&r=PG", "display_name": "user855443", "link": "https://stackoverflow.com/users/855443/user855443"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523404267, "creation_date": 1523396597, "question_id": 49763284, "link": "https://stackoverflow.com/questions/49763284/how-to-write-an-instance-for-generic-to-derive-a-function-like-singleton-a", "title": "How to write an instance for Generic to derive a function like singleton:: a -&gt; f a", "body": "<p>With the advice I have received before (<a href=\"https://stackoverflow.com/questions/49276305/how-to-write-an-instance-for-generic-to-derive-a-function-like-zeroa-i-e-a-c\">How to write an instance for Generic to derive a function like zero::a (i.e. a constant)?</a>) I succeded with append and similar functions, but failed with a function to convert a single value in a value wrapped with a type (e.g. singleton :: a -> [a]). </p>\n\n<p>I have so far:</p>\n\n<pre><code>class Single l   where\n    mkOne :: x -&gt; l    \n    default mkOne :: (Generic l, Generic x, Single l, Gsingle (Rep l)) =&gt; x -&gt; l  \n    mkOne x = to ( gmkOne (from x))\n\nclass Gsingle l where \n    gmkOne :: x -&gt; l x\n\ninstance Gsingle U1 where   -- this is for zero\n  gmkOne x = U1\n\ninstance  (Gsingle a) =&gt; Gsingle (K1 i a) where\n    gmkOne (K1 x) = K1 (mkOne x)\n\ninstance Single f =&gt; Gsingle (M1 i c f) where\n  gmkOne (M1 x1) = M1 (gmkOne x1)\n\ninstance (Gsingle f, Gsingle h) =&gt; Gsingle (f :*: h) where\n  gmkOne  (x1 :*: y1) = gmkOne x1:*: gmkOne y1\n</code></pre>\n\n<p>I have the impression from looking at examples that I do not understand the <code>x</code> type parameter in <code>Gsingle</code>, or rather how to deal with the signature <code>x -&gt; lx</code> in the Gsingle. </p>\n\n<p>I tried to use type families:</p>\n\n<pre><code>class Single l   where\n    type ST l \n    mkOne :: (ST l) -&gt; l    \n    default mkOne :: (Generic l, Generic (ST l), Single l, Gsingle (Rep l)) =&gt; (ST l) -&gt; l  \n    mkOne x = to ( gmkOne (from x))\n\nclass Gsingle l where \n    type STG l \n    gmkOne :: (STG l)  -&gt; l x\ninstance Gsingle U1 where   -- this is for zero\n  gmkOne x = U1\n\ninstance  (Gsingle a) =&gt; Gsingle (K1 i a) where\n    gmkOne (K1 x) = K1 (mkOne x)\n\ninstance Single f =&gt; Gsingle (M1 i c f) where\n  gmkOne (M1 x1) = M1 (gmkOne x1)\n\ninstance (Gsingle f, Gsingle h) =&gt; Gsingle (f :*: h) where\n  gmkOne  (x1 :*: y1) = gmkOne x1:*: gmkOne y1\n</code></pre>\n\n<p>but the type erros in the instances <code>Gsingle (M1 i c f)</code> and <code>Gsingle (f :*: h)</code> remain.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523390011, "post_id": 49761859, "comment_id": 86539114, "body": "In the interactive shell <code>ghci</code>?"}, {"owner": {"reputation": 801, "user_id": 2675845, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/84d862b291ba132b59087f1b558a90cc?s=128&d=identicon&r=PG&f=1", "display_name": "RuuddR", "link": "https://stackoverflow.com/users/2675845/ruuddr"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523390127, "post_id": 49761859, "comment_id": 86539170, "body": "Yeah in that console screen ghci"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523390154, "post_id": 49761859, "comment_id": 86539189, "body": "then it is a duplicate, see the reference."}, {"owner": {"reputation": 801, "user_id": 2675845, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/84d862b291ba132b59087f1b558a90cc?s=128&d=identicon&r=PG&f=1", "display_name": "RuuddR", "link": "https://stackoverflow.com/users/2675845/ruuddr"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523420058, "post_id": 49761859, "comment_id": 86548176, "body": "Okay, I will do that"}], "owner": {"reputation": 801, "user_id": 2675845, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/84d862b291ba132b59087f1b558a90cc?s=128&d=identicon&r=PG&f=1", "display_name": "RuuddR", "link": "https://stackoverflow.com/users/2675845/ruuddr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "closed_date": 1523390031, "answer_count": 0, "score": 0, "last_activity_date": 1523408818, "creation_date": 1523389908, "question_id": 49761859, "link": "https://stackoverflow.com/questions/49761859/haskell-errors-when-declaring-types", "closed_reason": "Duplicate", "title": "Haskell - Errors when declaring types", "body": "<p>I'm trying to learn Haskell from the wikiBooks pages and there was this example code</p>\n\n<pre><code>pts :: Int -&gt; Int\npts 1 = 10\npts 2 = 6\npts x\n    | x &lt;= 6    = 7 - x\n    | otherwise = 0\n</code></pre>\n\n<p>When I put in the first line I get this error:\n:1:1: error: Variable not in scope: pts :: Int -> Int\nWhat am I doing wrong?</p>\n"}, {"tags": ["haskell", "hxt"], "comments": [{"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1523390786, "post_id": 49761513, "comment_id": 86539480, "body": "A potential hack is to wrap it in a dummy root element before serializing."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 1, "creation_date": 1523390887, "post_id": 49761513, "comment_id": 86539533, "body": "Related: <a href=\"https://stackoverflow.com/questions/7208559/hxt-surprising-behavior-when-reading-and-writing-html-to-string-in-pure-code\" title=\"hxt surprising behavior when reading and writing html to string in pure code\">stackoverflow.com/questions/7208559/&hellip;</a>"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1523391501, "post_id": 49761513, "comment_id": 86539850, "body": "@DarthFennec Thank you! While I did try to search for a solution before I wrote my question, I didn&#39;t find that one. Voting to close my own question as a duplicate."}], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "closed_date": 1523397128, "answer_count": 0, "score": 0, "last_activity_date": 1523388434, "creation_date": 1523388434, "question_id": 49761513, "link": "https://stackoverflow.com/questions/49761513/write-an-entire-xml-document-to-string-using-hxt", "closed_reason": "Duplicate", "title": "Write an entire XML document to String using HXT", "body": "<p>I'm trying to figure out how to perform some XML transformations with <a href=\"https://hackage.haskell.org/package/hxt\" rel=\"nofollow noreferrer\">HXT</a>, but I can't figure out how to output an entire document to a string. While the documentation shows how to use <code>readDocument</code> and <code>writeDocument</code>, these run in <code>IO</code>, and I'm trying to figure out how to do a pure transformation.</p>\n\n<p>(Incidentally: why is so much of HXT defined as impure functions? One of the main advantages of Haskell is, in my opinion, that the compiler can guarantee the purity of functions. If I didn't care about that, I could have accomplished my XML goal already by writing my application in another language.)</p>\n\n<p>I've figured out how to read an XML string with HXT:</p>\n\n<pre><code>Prelude Text.XML.HXT.Core&gt; x = \"&lt;foo&gt;&lt;bar&gt;baz&lt;/bar&gt;&lt;/foo&gt;\"\nPrelude Text.XML.HXT.Core&gt; runLA xread x\n[NTree (XTag \"foo\" []) [NTree (XTag \"bar\" []) [NTree (XText \"baz\") []]]]\n</code></pre>\n\n<p>That works, as one can see, as expected.</p>\n\n<p>Next, I'd like to write the <code>XmlTree</code> back to a <code>String</code>:</p>\n\n<pre><code>Prelude Text.XML.HXT.Core&gt; runLA (xread &gt;&gt;&gt; writeDocumentToString []) x\n[\"&lt;bar&gt;baz&lt;/bar&gt;\"]\n</code></pre>\n\n<p>This is the heart of <strong>my question</strong>: <em>where's the <code>foo</code> element?</em></p>\n\n<p>Why doesn't that arrow round-trip? Why isn't the output <code>\"&lt;foo&gt;&lt;bar&gt;baz&lt;/bar&gt;&lt;/foo&gt;\"</code>?</p>\n\n<hr>\n\n<p>In order to trouble-shoot, I've tried to print the Haskell representation:</p>\n\n<pre><code>Prelude Text.XML.HXT.Core&gt; runLA (xread &gt;&gt;&gt; writeDocumentToString [withShowHaskell yes]) x\n[\"NTree (XTag \\\"foo\\\" []) [NTree (XTag \\\"bar\\\" []) [NTree (XText \\\"baz\\\") []]]\"]\n</code></pre>\n\n<p>In this representation, the outermost <code>foo</code> element is still present.</p>\n\n<p>One can also demonstrate this by printing the tree:</p>\n\n<pre><code>Prelude Text.XML.HXT.Core&gt; putStrLn $ unlines $ runLA (xread &gt;&gt;&gt; writeDocumentToString [withShowTree yes]) x\n---XTag \"foo\"\n   |\n   +---XTag \"bar\"\n       |\n       +---XText \"baz\"\n</code></pre>\n\n<p>Again, it seems quite clear that the <code>foo</code> element is still there.</p>\n\n<p>How can I serialise an <code>XmlTree</code> to a <code>String</code> while preserving the entire document, including the root?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1523385975, "post_id": 49760862, "comment_id": 86537069, "body": "<code>read &quot;(1, 0.75)&quot; :: (Int , Float)</code> returns <code>(1,0.75)</code>. <code>let [x, y] = words &quot;1 0.75&quot; in (read x :: Int, read y :: Float)</code> returns <code>(1,0.75)</code>."}, {"owner": {"reputation": 69, "user_id": 7622546, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/114f99ab836aa7687d9967c509d9d390?s=128&d=identicon&r=PG&f=1", "display_name": "Strobe00", "link": "https://stackoverflow.com/users/7622546/strobe00"}, "reply_to_user": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1523386113, "post_id": 49760862, "comment_id": 86537153, "body": "@Elmex80s Yes, my thinking was put the values in a tuple and then pull them out using fst and snd. Is there a better way to go about it?"}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 1, "creation_date": 1523386136, "post_id": 49760862, "comment_id": 86537167, "body": "see updated answer"}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1523394463, "post_id": 49761120, "comment_id": 86541286, "body": "The last one doesn&#39;t actually work.  <code>::</code> isn&#39;t a cast."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1523395069, "post_id": 49761120, "comment_id": 86541549, "body": "(It will work in ghci because ghci cheats with <code>NoMonomorphismRestriction</code> -- but that causes the first line to be evaluated twice)"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1523398668, "post_id": 49761120, "comment_id": 86542927, "body": "@luqui oh good call. I&#39;ll remove the last alternative (since it&#39;s not great to begin with"}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 4, "last_activity_date": 1523398677, "last_edit_date": 1523398677, "creation_date": 1523386773, "answer_id": 49761120, "question_id": 49760862, "link": "https://stackoverflow.com/questions/49760862/pulling-values-out-of-a-list-of-ints-and-floats-in-haskell/49761120#49761120", "title": "Pulling values out of a list of ints and floats in Haskell", "body": "<p><code>countProb</code> is <code>\"2 0.75\"</code>, which is not parse-able by <code>read</code>. You could split it into two parse-able segments by using <code>words</code> which splits values on whitespace, though.</p>\n\n<pre><code>let [x, y] = words countProb\n</code></pre>\n\n<p>then you can combine to <code>:: (Integer, Float)</code> by reading each individually.</p>\n\n<pre><code>let cp = (read x, read y) :: (Integer, Float)\n</code></pre>\n\n<hr>\n\n<p>Alternatively, and considerably more complicated, you could use <code>Text.Printf.printf</code> to format your text to something <code>read</code> <strong>can</strong> parse.</p>\n\n<pre><code>let [x, y] = words countProb\n    fmtd   = printf \"(%s, %s)\" x y\n    cp     = read fmtd :: (Integer, Float)\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 7622546, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/114f99ab836aa7687d9967c509d9d390?s=128&d=identicon&r=PG&f=1", "display_name": "Strobe00", "link": "https://stackoverflow.com/users/7622546/strobe00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 49761120, "answer_count": 1, "score": 1, "last_activity_date": 1523398677, "creation_date": 1523385755, "question_id": 49760862, "link": "https://stackoverflow.com/questions/49760862/pulling-values-out-of-a-list-of-ints-and-floats-in-haskell", "title": "Pulling values out of a list of ints and floats in Haskell", "body": "<p>I have a list of values:</p>\n\n<pre><code>2 0.75\n1 0.01\n2 1.0\n3 0.8\n</code></pre>\n\n<p>I'm going over the list and want to split the pairs into two variables.</p>\n\n<p>For testing, I've just tried printing them out. However, this gives me an error \"Prelude.read: no parse\":</p>\n\n<pre><code>getCountProb :: Handle -&gt; IO ()\ngetCountProb inh = do\n    countProb &lt;- hGetLine inh\n    let cp = read countProb :: (Integer, Float)\n    let test = fst cp\n    print test\n</code></pre>\n"}, {"tags": ["parsing", "haskell", "parsec"], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1523380003, "creation_date": 1523380003, "answer_id": 49759332, "question_id": 49758970, "link": "https://stackoverflow.com/questions/49758970/parsing-a-sum-datatype-with-parsec/49759332#49759332", "title": "Parsing a sum datatype with parsec", "body": "<p>You just need an inverse of <code>toOperator</code> to map over the parser; <code>read</code> is a simple (if not robust) example.</p>\n\n<pre><code>&gt;&gt;&gt; data Operator = ADD | SUB | MUL | DIV | SQR deriving (Show, Read)\n&gt;&gt;&gt; parse (read &lt;$&gt; string \"ADD\") \"\" \"ADD\" :: Either ParseError Operator\nRight ADD\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1523380556, "post_id": 49759421, "comment_id": 86533919, "body": "You can also use <code>[minBound..maxBound]</code> as syntactic sugar for that call to <code>enumFromTo</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1523394688, "post_id": 49759421, "comment_id": 86541383, "body": "Or just <code>enumFrom minBound</code>."}], "tags": [], "owner": {"reputation": 1349, "user_id": 7655081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b23af7029d2ec53c15d8d9d2cccb0bb?s=128&d=identicon&r=PG&f=1", "display_name": "0xd34df00d", "link": "https://stackoverflow.com/users/7655081/0xd34df00d"}, "is_accepted": false, "score": 2, "last_activity_date": 1523380668, "last_edit_date": 1523380668, "creation_date": 1523380319, "answer_id": 49759421, "question_id": 49758970, "link": "https://stackoverflow.com/questions/49758970/parsing-a-sum-datatype-with-parsec/49759421#49759421", "title": "Parsing a sum datatype with parsec", "body": "<p>You have several options to avoid such duplication.</p>\n\n<p>First, if the names as they appear in the input you try to parse match exactly the constructors of <code>Operator</code> (which seems to be the case in your example), you can avoid <code>toOperator</code> at all by also deriving the <code>Read</code> instance for <code>Operator</code> and just using <code>read</code>. The code would then be along the lines of</p>\n\n<pre><code>parseOperator :: ParsecT String u Identity () Operator\nparseOperator = do\n    s &lt;- choice $ map (try . string) [\"ADD\", \"SUB\", \"MUL\", \"DIV\", \"SQR\"]\n    pure $ read s\n</code></pre>\n\n<p>You'll have to be careful to list the same names here as the <code>Operator</code> constructors and update them as necessary, though.</p>\n\n<p>Second, you can instead build the mapping yourself by defining a list (or a <code>Data.Map</code>, or <code>HashMap</code>) and then use it both to specify the admissible input and to find the corresponding operator constructor:</p>\n\n<pre><code>operators :: [(String, Operator)]\noperators = [(\"ADD\", ADD), (\"SUB\", SUB), (\"MUL\", MUL), (\"DIV\", DIV), (\"SQR\", SQR)]\n\nparseOperator :: ParsecT String u Identity () Operator\nparseOperator = do\n    s &lt;- choice $ map (try . string . fst) operators\n    case lookup s operators of\n        Just x  -&gt; return x\n        Nothing -&gt; fail \"Could not parse that operator.\"\n</code></pre>\n\n<p>Note the <code>case</code> is not really necessary for a well-defined parser: the result of the parse will by definition be in the <code>operators</code> list. And, again, the downside is that you have to keep the <code>operators</code> and the constructors list in sync.</p>\n\n<p>The third, and, perhaps, the sweetest one is to generate the list of operators automatically by some extra type classes: <code>Bounded</code> and <code>Enum</code>, which, combined, allow enumerating all the constructors of a type like yours, and which ghc will happily derive for your <code>Operator</code>. Then <code>operators</code> definition would look like</p>\n\n<pre><code>operators :: [(String, Operator)]\noperators = map (\\op -&gt; (show op, op)) $ enumFromTo minBound maxBound\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 3, "last_activity_date": 1523381234, "creation_date": 1523381234, "answer_id": 49759680, "question_id": 49758970, "link": "https://stackoverflow.com/questions/49758970/parsing-a-sum-datatype-with-parsec/49759680#49759680", "title": "Parsing a sum datatype with parsec", "body": "<p>It's simpler if you make <code>toOperator</code> participate in the Parsec parsing process directly, rather than having it be a step that happens separately, because then \"whether this thing is a valid operator\" can provide feedback into the parsing process.</p>\n\n<p>For this specific case where the thing you are parsing is a zero-field enum whose constructor names exactly match the strings you are parsing, there are already several good shortcuts posted, showing you how to concisely parse those constructors. In this answer, I will show an alternative method, which is easier to adapt to the general case of \"match one of several cases\" and to handle fancier stuff like \"one of the three constructors has an Int argument but the others don't.\"</p>\n\n<pre><code>operator :: StringParser Operator\noperator = string \"ADD\" *&gt; pure ADD\n       &lt;|&gt; string \"DIV\" *&gt; pure DIV \n       &lt;|&gt; string \"MUL\" *&gt; pure MUL\n       &lt;|&gt; try (string \"SUB\") *&gt; pure SUB \n       &lt;|&gt; string \"SQR\" *&gt; pure SQR\n</code></pre>\n\n<p>Now suppose that you had an additional constructor, <code>VAR</code>, taking a String argument. It is easy to add support for that constructor to this parser:</p>\n\n<pre><code>operator :: StringParser Operator\noperator = ...\n       &lt;|&gt; string \"VAR\" *&gt; (VAR &lt;$&gt; var)\n\nvar :: StringParser String\nvar = spaces *&gt; anyChar `manyTill` space\n</code></pre>\n"}], "owner": {"reputation": 716, "user_id": 2315551, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8a4c0668c9eab3ecb855d3f6fd879ad7?s=128&d=identicon&r=PG&f=1", "display_name": "lsund", "link": "https://stackoverflow.com/users/2315551/lsund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 49759680, "answer_count": 3, "score": 2, "last_activity_date": 1526285625, "creation_date": 1523378777, "last_edit_date": 1526285625, "question_id": 49758970, "link": "https://stackoverflow.com/questions/49758970/parsing-a-sum-datatype-with-parsec", "title": "Parsing a sum datatype with parsec", "body": "<p>I am trying to figure out how to parse a sum-datatype in Haskell in the best way possible. This is an extract of what I attempted</p>\n\n<pre><code>type Value = Int\n\ndata Operator = ADD | SUB | MUL | DIV | SQR deriving (Show)\n\ntoOperator :: String -&gt; Maybe Operator\ntoOperator \"ADD\" = Just ADD\ntoOperator \"SUB\" = Just SUB\ntoOperator \"MUL\" = Just MUL\ntoOperator \"DIV\" = Just DIV\ntoOperator \"SQR\" = Just SQR\ntoOperator _     = Nothing\n\nparseOperator :: ParsecT String u Identity () Operator\nparseOperator = do\n    s &lt;- choice $ map (try . string) [\"ADD\", \"SUB\", \"MUL\", \"DIV\", \"SQR\"]\n    case toOperator s of\n        Just x  -&gt; return x\n        Nothing -&gt; fail \"Could not parse that operator.\"\n</code></pre>\n\n<p>This code does what I want but has one obvious problem: It checks the data twice. Once in the line <code>choice $ map (try . string) [\"ADD\", \"SUB\", \"MUL\", \"DIV\", \"SQR\"]</code> and once through <code>toOperator</code>. </p>\n\n<p>What I want, is to want to parse a string into an <code>Operator</code> if it occurs in the list, and fail otherwise. But I can't figure out how to do this in a 'clean' way.</p>\n"}, {"tags": ["haskell", "cabal", "template-haskell"], "comments": [{"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 1, "creation_date": 1523373562, "post_id": 49757162, "comment_id": 86529583, "body": "<code>data-files</code> or <code>data-directory</code> in your <code>package.cabal</code>?"}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 1, "creation_date": 1523373602, "post_id": 49757162, "comment_id": 86529613, "body": "see <a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html#pkg-field-data-files\" rel=\"nofollow noreferrer\">haskell.org/cabal/users-guide/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 14585, "user_id": 568785, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/88c6371f6a47841abde4c60dd8a2f964?s=128&d=identicon&r=PG", "display_name": "Bailey Parker", "link": "https://stackoverflow.com/users/568785/bailey-parker"}, "edited": false, "score": 0, "creation_date": 1523375758, "post_id": 49757280, "comment_id": 86531092, "body": "Yep, that&#39;s exactly what I was looking for. That&#39;s so smart that they thought ahead to include that! Thank you so much!"}, {"owner": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "edited": false, "score": 0, "creation_date": 1618412069, "post_id": 49757280, "comment_id": 118594354, "body": "Doesn\u2019t seem to work for me under Cabal 3.2. People on IRC say that Cabal is not aware of <code>addDependentFile</code>."}], "tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": true, "score": 2, "last_activity_date": 1523373371, "creation_date": 1523373371, "answer_id": 49757280, "question_id": 49757162, "link": "https://stackoverflow.com/questions/49757162/making-cabal-aware-of-external-templatehaskell-dependencies/49757280#49757280", "title": "Making Cabal Aware of External TemplateHaskell Dependencies", "body": "<p><a href=\"https://hackage.haskell.org/package/template-haskell-2.13.0.0/docs/Language-Haskell-TH-Syntax.html#v:addDependentFile\" rel=\"nofollow noreferrer\">addDependentFile</a> is part of template Haskell.  It tells ghc to use that file in dependency calculations - cabal isn't even needed.</p>\n\n<p><code>embedFile</code> should be calling that.  The fact that it isn't makes me suspicious about the library.  Still, you can create a helper that looks something like this:</p>\n\n<pre><code>embed :: FilePath -&gt; Q Exp\nembed p = addDependentFile p &gt;&gt; embedFile p\n</code></pre>\n\n<p>Just mind TH's staging restrictions, and put that in a file that doesn't use it.</p>\n"}], "owner": {"reputation": 14585, "user_id": 568785, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/88c6371f6a47841abde4c60dd8a2f964?s=128&d=identicon&r=PG", "display_name": "Bailey Parker", "link": "https://stackoverflow.com/users/568785/bailey-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 49757280, "answer_count": 1, "score": 1, "last_activity_date": 1523373371, "creation_date": 1523372955, "question_id": 49757162, "link": "https://stackoverflow.com/questions/49757162/making-cabal-aware-of-external-templatehaskell-dependencies", "title": "Making Cabal Aware of External TemplateHaskell Dependencies", "body": "<p>To embed some static files in a build, I'm using: <a href=\"https://hackage.haskell.org/package/file-embed-0.0.10.1/docs/Data-FileEmbed.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/file-embed-0.0.10.1/docs/Data-FileEmbed.html</a></p>\n\n<p>It allows you to do:</p>\n\n<p><strong>MyFile.hs</strong></p>\n\n<pre><code>myFile :: Data.ByteString.ByteString\nmyFile = $(embedFile \"something/external.txt\")\n</code></pre>\n\n<p>To embed files into the produced binary.</p>\n\n<p>However, one irksome thing is that cabal doesn't know that a file using <code>embedFile</code> depends on the file it loads (and therefore changes to <code>something/external.txt</code> don't cause <code>MyFile</code> to be re-built on build).</p>\n\n<p>Is there any way to tell cabal about this dependency? The only solution I have now is to just <code>touch</code> the Haskell file to cause it to be recompiled, but this is tedious.</p>\n"}, {"tags": ["haskell", "ghc", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 14608, "user_id": 242169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784316336915cd51997764d5896961fa?s=128&d=identicon&r=PG", "display_name": "Mikhail Glushenkov", "link": "https://stackoverflow.com/users/242169/mikhail-glushenkov"}, "edited": false, "score": 0, "creation_date": 1523359632, "post_id": 49751772, "comment_id": 86519305, "body": "Thanks, I&#39;ve tried that, but my project uses <code>base-noprelude</code> and the <code>Prelude</code> from <code>base</code> clashes with the one in my project. For some reason it doesn&#39;t work with <code>PackageImports</code> either. Ideally there would be a way to import stuff just for the prompt function scope, like local imports in OCaml."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 14608, "user_id": 242169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784316336915cd51997764d5896961fa?s=128&d=identicon&r=PG", "display_name": "Mikhail Glushenkov", "link": "https://stackoverflow.com/users/242169/mikhail-glushenkov"}, "edited": false, "score": 0, "creation_date": 1523360574, "post_id": 49751772, "comment_id": 86519952, "body": "The types are also exported in other modules. I updated my answer."}, {"owner": {"reputation": 14608, "user_id": 242169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784316336915cd51997764d5896961fa?s=128&d=identicon&r=PG", "display_name": "Mikhail Glushenkov", "link": "https://stackoverflow.com/users/242169/mikhail-glushenkov"}, "edited": false, "score": 1, "creation_date": 1523375067, "post_id": 49751772, "comment_id": 86530639, "body": "OK thanks, if I put something like <code>:m - Data.String Data.Bool Data.List Data.Eq Data.Function Data.Int System.IO Text.Show Control.Monad</code> after <code>:set prompt-function</code> in my <code>~&#47;.ghci</code> I can sort of simulate local imports and get a clean prompt without noise."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 3, "last_activity_date": 1523360519, "last_edit_date": 1523360519, "creation_date": 1523357485, "answer_id": 49751772, "question_id": 49751432, "link": "https://stackoverflow.com/questions/49751432/is-it-possible-to-make-prompt-function-work-with-xnoimplicitprelude/49751772#49751772", "title": "Is it possible to make prompt-function work with -XNoImplicitPrelude?", "body": "<p>Put <code>String</code>, <code>Int</code>, <code>IO</code>, and whatever is necessary, back in scope. If <code>Prelude</code> is not available (because of using <code>base-noprelude</code>), these types can be found in their own modules:</p>\n\n<pre><code>&gt; import Data.String (String)\n&gt; import Data.Int (Int)\n&gt; import System.IO (IO)\n&gt; import Text.Show (show)\n&gt; import Control.Applicative (pure)\n&gt; :set prompt-function \\ms n -&gt; pure (show (ms, n))  -- [String] -&gt; Int -&gt; IO String\n</code></pre>\n"}], "owner": {"reputation": 14608, "user_id": 242169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784316336915cd51997764d5896961fa?s=128&d=identicon&r=PG", "display_name": "Mikhail Glushenkov", "link": "https://stackoverflow.com/users/242169/mikhail-glushenkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 49751772, "answer_count": 1, "score": 3, "last_activity_date": 1523360519, "creation_date": 1523356528, "question_id": 49751432, "link": "https://stackoverflow.com/questions/49751432/is-it-possible-to-make-prompt-function-work-with-xnoimplicitprelude", "title": "Is it possible to make prompt-function work with -XNoImplicitPrelude?", "body": "<p>I have a project that uses a custom Prelude, however it seems to conflict with the prompt function I have in <code>~/.ghci</code>. Simple example:</p>\n\n<pre><code>$ ghci -XNoImplicitPrelude\nGHCi, version 8.2.2: http://www.haskell.org/ghc/  :? for help\nLoaded GHCi configuration from /home/refold/etc/ghci\n&gt; :set prompt-function \\ms _ -&gt; ms\n\n&lt;interactive&gt;:1:19: error:\n    Not in scope: type constructor or class \u2018String\u2019\n\n&lt;interactive&gt;:1:30: error:\n    Not in scope: type constructor or class \u2018Int\u2019\n\n&lt;interactive&gt;:1:37: error:\n    Not in scope: type constructor or class \u2018IO\u2019\n\n&lt;interactive&gt;:1:40: error:\n    Not in scope: type constructor or class \u2018String\u2019\n</code></pre>\n\n<p>Is it possible to make both <code>-XNoImplicitPrelude</code> and <code>:set prompt-function</code> work together?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "edited": false, "score": 1, "creation_date": 1523358203, "post_id": 49751420, "comment_id": 86518336, "body": "Might want to edit the <code>:=</code> typo (should be <code>.=</code>) - shell habits die hard"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1523366149, "post_id": 49751420, "comment_id": 86524060, "body": "Some helper function options:  <code>text :: Text -&gt; Text ; text = id</code> and <code>&quot;kind .= text &quot;foo&quot;</code>.  Or consider <code>(..=) :: KeyValue kv =&gt; Text -&gt; Text -&gt; kv</code> and <code>&quot;kind&quot; ..= &quot;foo&quot;</code>.   I agree this is a broken corner of the language and have long wanted better defaulting that doesn&#39;t result in warnings."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "reply_to_user": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "edited": false, "score": 0, "creation_date": 1523366253, "post_id": 49751420, "comment_id": 86524154, "body": "@JordanMackie Fixed, thanks."}], "answers": [{"tags": [], "owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "is_accepted": false, "score": 3, "last_activity_date": 1523358150, "creation_date": 1523358150, "answer_id": 49751981, "question_id": 49751420, "link": "https://stackoverflow.com/questions/49751420/how-do-i-get-rid-of-defaulting-the-following-constraints-to-type-char-warn/49751981#49751981", "title": "How do I get rid of &quot;Defaulting the following constraints to type \u2018[Char]\u2019&quot; warnings?", "body": "<p>Why not lift that part of the serialisation logic out into a separate function? It's kind of hacky anyway, so better to section it off. And you'll silence the warning (provided you give the function a type). </p>\n\n<p>Something along the lines of...</p>\n\n<pre><code>toJSON thing@(Foo v) = [\"kind\" .= kind thing ...]\ntoJSON thing@(Bar v) = [\"kind\" .= kind thing ...]\n\nkind :: T -&gt; Text\nkind (Foo _) = \"foo\"\nkind (Bar_)  = \"bar\"\n</code></pre>\n\n<p>However you want to to do it. Maybe use a <code>ViewPattern</code> or maybe make <code>kind :: KeyValue kv =&gt; T -&gt; kv</code>. Just don't inline it, IMO.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 0, "last_activity_date": 1523390050, "creation_date": 1523390050, "answer_id": 49761902, "question_id": 49751420, "link": "https://stackoverflow.com/questions/49751420/how-do-i-get-rid-of-defaulting-the-following-constraints-to-type-char-warn/49761902#49761902", "title": "How do I get rid of &quot;Defaulting the following constraints to type \u2018[Char]\u2019&quot; warnings?", "body": "<p>I think I'd probably abstract the key-value pair you're making, like this:</p>\n\n<pre><code>kind :: KeyValue kv =&gt; Text -&gt; kv\nkind lbl = \"kind\" .= lbl\n\ntoJSON (Foo v) = [kind \"foo\", ...]\ntoJSON (Bar v) = [kind \"bar\", ...]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 1, "last_activity_date": 1523436068, "creation_date": 1523436068, "answer_id": 49770428, "question_id": 49751420, "link": "https://stackoverflow.com/questions/49751420/how-do-i-get-rid-of-defaulting-the-following-constraints-to-type-char-warn/49770428#49770428", "title": "How do I get rid of &quot;Defaulting the following constraints to type \u2018[Char]\u2019&quot; warnings?", "body": "<p>In the end I took Thomas DuBuisson's suggestion from the comments and added a couple of specialized functions:</p>\n\n<pre><code> -- | Type-restricted version of \"(.=)\" to silence compiler warnings about defaults.\n (..=) :: (KeyValue kv) =&gt; Text -&gt; Text -&gt; kv\n (..=) = (.=)\n\n\n -- | Type restricted version of \"(.:)\" to silence compiler warnings about defaults.\n (..:) :: Object -&gt; Text -&gt; Parser Text\n (..:) = (.:)\n</code></pre>\n"}], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1523436068, "creation_date": 1523356485, "last_edit_date": 1523366183, "question_id": 49751420, "link": "https://stackoverflow.com/questions/49751420/how-do-i-get-rid-of-defaulting-the-following-constraints-to-type-char-warn", "title": "How do I get rid of &quot;Defaulting the following constraints to type \u2018[Char]\u2019&quot; warnings?", "body": "<p>I'm using the Aeson library and the <code>OverloadedStrings</code> pragma, but this question is more general. The immediate context is that I'm writing code for a sum type so I have a \"kind\" field in the JSON to say which variant is being represented. In the ToJSON instance I write code like this:</p>\n\n<pre><code>toJSON (Foo v) = [\"kind\" .= \"foo\" ...]\ntoJSON (Bar v) = [\"kind\" .= \"bar\" ...]\n</code></pre>\n\n<p>GHC gives me the following warning for <code>\"foo\"</code> and <code>\"bar\"</code>:</p>\n\n<pre><code>Defaulting the following constraints to type \u2018[Char]\u2019\n    (ToJSON v0)\n      arising from a use of \u2018.=\u2019\n</code></pre>\n\n<p>The reason is that both <code>String</code> and <code>Text</code> are instances of ToJSON, so the compiler has to pick one, and in this case it has picked <code>String</code>.</p>\n\n<p>I know I can suppress the warning with an in-line type, like this:</p>\n\n<pre><code> toJSON (Foo v) = [\"kind\" := (\"foo\" :: Text) ...]\n</code></pre>\n\n<p>However that clutters up the code with redundant information. Also I've got quite a lot of these warnings.</p>\n\n<p>I've tried putting <code>default (Text)</code> at the top of the file, but that just changes the warning to tell me its defaulted to type <code>Text</code>.</p>\n\n<p>Is there a way of disabling the warnings for Text/String defaults but leaving any others in place?</p>\n"}, {"tags": ["parsing", "haskell", "parsec", "parser-combinators", "trifecta"], "answers": [{"tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": true, "score": 6, "last_activity_date": 1523358182, "last_edit_date": 1523358182, "creation_date": 1523357592, "answer_id": 49751802, "question_id": 49751139, "link": "https://stackoverflow.com/questions/49751139/how-to-combine-parsers-up-to-n-times-in-haskell/49751802#49751802", "title": "How to combine parsers up to n times in Haskell?", "body": "<p>You could construct a <code>many</code>-like combinator with an upper limit:</p>\n\n<pre><code>upto :: Int -&gt; Parser a -&gt; Parser [a]\nupto n p | n &gt; 0 = (:) &lt;$&gt; try p &lt;*&gt; upto (n-1) p &lt;|&gt; return []\nupto _ _ = return []\n</code></pre>\n\n<p>And for 1 up to n, a <code>many1</code>-like combinator:</p>\n\n<pre><code>upto1 :: Int -&gt; Parser a -&gt; Parser [a]\nupto1 n p | n &gt; 0 = (:) &lt;$&gt; p &lt;*&gt; upto (n-1) p\nupto1 _ _ = return []\n</code></pre>\n\n<p>A short demo:</p>\n\n<pre><code>&gt; map (parse (upto 8 digitChar) \"\") [\"\", \"123\", \"1234567890\"]\n[Right \"\",Right \"123\",Right \"12345678\"]\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 8254774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7383a98340bc989bcd5bbb7fba2920e?s=128&d=identicon&r=PG", "display_name": "Sergio de Carvalho", "link": "https://stackoverflow.com/users/8254774/sergio-de-carvalho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 590, "favorite_count": 1, "accepted_answer_id": 49751802, "answer_count": 1, "score": 4, "last_activity_date": 1523358182, "creation_date": 1523355623, "question_id": 49751139, "link": "https://stackoverflow.com/questions/49751139/how-to-combine-parsers-up-to-n-times-in-haskell", "title": "How to combine parsers up to n times in Haskell?", "body": "<p>I'm trying to combine parsers in Haskell in such a way that I could parse certain patterns up to n times. To illustrate, imagine I want to parse up to eight digits from the input. I know I can use <code>count</code> from <code>Text.Parser.Combinators</code> to parse exactly n occurrences, e.g.:</p>\n\n<pre><code>import Text.Parser.Char        (digit)\nimport Text.Parser.Combinators (count)\n\neightDigits :: Parser [Char]\neightDigits = count 8 digit\n</code></pre>\n\n<p>This, however, fails if it doesn't find exactly 8 digits. I could also use <code>some</code> to parse one or more digits:</p>\n\n<pre><code>import Text.Parser.Char        (digit)\nimport Text.Parser.Combinators (some)\n\nsomeDigits :: Parser [Char]\nsomeDigits = some digit\n</code></pre>\n\n<p>The problem with the above is that it may consume more digits than I want. Finally, I could use <code>try</code>, which combine parsers that may consume input and, on failure, go back to where it started:</p>\n\n<pre><code>import Text.Parser.Char        (digit)\nimport Text.Parser.Combinators (count, try)\nimport Control.Applicative     ((&lt;|&gt;))\n\ntwoOrThreeDigits :: Parser [Char]\ntwoOrThreeDigits = try (count 3 digit) &lt;|&gt; count 2 digit\n</code></pre>\n\n<p>While this could be extended to up to 8 repetitions, it's not scalable nor elegant, so the question is how can I combine parsers to parse a pattern anywhere between 1 and up to n times?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1523353972, "post_id": 49750519, "comment_id": 86515464, "body": "Why not <code>pretty-simple</code>? <a href=\"https://hackage.haskell.org/package/pretty-simple\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/pretty-simple</a>"}, {"owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523354536, "post_id": 49750519, "comment_id": 86515885, "body": "@WillemVanOnsem : OMG that&#39;s what I need !  Thanks !"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 2, "creation_date": 1523357441, "post_id": 49750519, "comment_id": 86517852, "body": "or <a href=\"https://hackage.haskell.org/package/pretty-show\" rel=\"nofollow noreferrer\">pretty-show</a>"}], "answers": [{"tags": [], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "is_accepted": false, "score": 2, "last_activity_date": 1523358804, "creation_date": 1523358804, "answer_id": 49752185, "question_id": 49750519, "link": "https://stackoverflow.com/questions/49750519/show-implementation-that-would-generically-display-one-line-per-record-filed/49752185#49752185", "title": "show implementation that would generically display one line per record filed", "body": "<p>I didn't know the package <code>pretty-simple</code> mentionned in a comment.</p>\n\n<p>To get a pretty print, I use the package <code>pretty-show</code> (I cannot live without this package BTW).</p>\n\n<pre><code>import Text.Show.Pretty\n\ndata Cat = Cat { catname :: String , catcolor :: String } \n            deriving (Eq, Show)\ndata Dog = Dog { dogname :: String , dogcolor :: String } \n            deriving (Eq, Show)\n\ncat1 = Cat \"Garfield\" \"orange\"\ncats = [cat1 , Cat \"Tom\" \"grey\"] \n\ndog1 = Dog \"comet\" \"white\"\ndog2 = Dog \"Odie\" \"yellow\"\ndogs = [dog1, dog2 ]\n\nmain :: IO ()\nmain = do \n    pPrint cat1\n    pPrint cats\n    pPrint dog1\n    pPrint dogs\n</code></pre>\n\n<p>This gives:</p>\n\n<pre><code>Cat { catname = \"Garfield\" , catcolor = \"orange\" }\n[ Cat { catname = \"Garfield\" , catcolor = \"orange\" }\n, Cat { catname = \"Tom\" , catcolor = \"grey\" }\n]\nDog { dogname = \"comet\" , dogcolor = \"white\" }\n[ Dog { dogname = \"comet\" , dogcolor = \"white\" }\n, Dog { dogname = \"Odie\" , dogcolor = \"yellow\" }\n]\n</code></pre>\n\n<p>Another useful function in <code>pretty-show</code> is <code>ppShow :: Show a =&gt; a -&gt; String</code>, which converts a generic value into a pretty String (if possible). Then the <code>pPrint</code> function is nothing but</p>\n\n<pre><code>pPrint = putStrLn . ppShow\n</code></pre>\n"}], "owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1523358804, "creation_date": 1523353786, "question_id": 49750519, "link": "https://stackoverflow.com/questions/49750519/show-implementation-that-would-generically-display-one-line-per-record-filed", "title": "show implementation that would generically display one line per record filed", "body": "<p>I have very long data types with a lot of records on them. The default show implementation when using deriving (Show) is not suitable anymore as it spreads on several lines (and become not human readeable) . That is why I want to instance show for my data types wih something that would output one line per record field</p>\n\n<p>Consider the following snippet where show Dog is what I want to have:  </p>\n\n<pre><code>data Cat = Cat { catname :: String , catcolor :: String } deriving (Eq, Show)\ncat1 = Cat \"Garfield\" \"orange\"\ncats = [ cat1 , Cat \"Tom\" \"grey\"] \n\ndata Dog = Dog { dogname :: String , dogcolor :: String } deriving (Eq)\ninstance Show ( Dog ) where \n show (Dog named colord)= \"Dog {\\n dogname = \"++named++\"  \\n dogcolor = \" ++ colord ++ \"\\n }\\n\"\n\ndog1 = Dog \"comet\" \"white\"\ndog2 = Dog \"Odie\" \"yellow\"\n\ndogs = [dog1, dog2 ]\n\nmain = do { print cat1;\n            print cats;\n            print dog1;\n            print dogs\n}\n</code></pre>\n\n<p>When run it gives the following : </p>\n\n<pre><code>*Main&gt; main\nCat {catname = \"Garfield\", catcolor = \"orange\"}\n[Cat {catname = \"Garfield\", catcolor = \"orange\"},Cat {catname = \"Tom\", catcolor = \"grey\"}]\nDog {\n dogname = comet\n dogcolor = white\n }\n\n[Dog {\n dogname = comet\n dogcolor = white\n }\n,Dog {\n dogname = Odie\n dogcolor = yellow\n }\n]\n*Main&gt;\n</code></pre>\n\n<p>How to achieve this result in a generic way, i.e not specific to data type Dog ? \n(for example in Java it would be with introspection) \nI have many Data types with many record fields so doing one implementation per data is not an option </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523350252, "post_id": 49749218, "comment_id": 86512984, "body": "You can use <code>\\(Human n) -&gt; n == &quot;bob&quot;</code> If I understand it correctly, but your <code>fh4</code> is syntactically invalid."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 2, "creation_date": 1523350414, "post_id": 49749218, "comment_id": 86513088, "body": "What about <code>fh3 = filter (\\h -&gt; (name (h::Human) )==&quot;bob&quot;) humans</code> ?"}, {"owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "edited": false, "score": 1, "creation_date": 1523350470, "post_id": 49749218, "comment_id": 86513130, "body": "I will edit my question; as indeed the idea is that there is off course much more fields in each data Types and I can not use the (==) directly on the type but must use the name function of them"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523350536, "post_id": 49749218, "comment_id": 86513176, "body": "@sandwood: is there a particular reason why you use the <code>DuplicateRecordFields</code> extension, and not declare records with <code>humanName</code>, <code>dogName</code>, etc.?"}, {"owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1523350790, "post_id": 49749218, "comment_id": 86513363, "body": "@WillemVanOnsem : yes, I made really a mcve stripping off the whole picture  : short : I made some kind of Database Tables to Haskell Data type  (  haskell generated code based on the actual database, mapping a table to a Haskell Data Type with one record per database column). In this database I have hundred of tables, and as you can imagine I have several of them with the same column name (says, &quot;id&quot;, &quot;name&quot;, ...).   I do not want to prefix all of them with the table name as I want to keep it simple and closest to the  real column name in the DB"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1523351051, "post_id": 49749218, "comment_id": 86513530, "body": "Do you mean <code>name (h :: Human) == &quot;bob&quot;</code>? That&#39;s valid if I remember correctly."}, {"owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1523351076, "post_id": 49749218, "comment_id": 86513548, "body": "@St&#233;phaneLaurent : thanks, that is what I was looking for. put it as an  Answer so that I can validate. Btw any way of doing this directly in a function  composition ?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523351352, "post_id": 49749218, "comment_id": 86513734, "body": "@sandwood: I think you solve the problem here at the wrong level, you can - given you use a good library - specify that the database column is different than the attribute of the Haskell record."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1523351477, "post_id": 49749218, "comment_id": 86513807, "body": "I have converted my comment to an answer. But I&#39;m not sure to understand your other question. Defining <code>humanName</code> as you did is not a bad idea IMHO."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1523352583, "post_id": 49749218, "comment_id": 86514518, "body": "Also see my edit.  Defining a class is convenient in such circumstances."}], "answers": [{"tags": [], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "is_accepted": true, "score": 5, "last_activity_date": 1523352456, "last_edit_date": 1523352456, "creation_date": 1523351392, "answer_id": 49749697, "question_id": 49749218, "link": "https://stackoverflow.com/questions/49749218/any-way-of-disambiguation-within-lambdas-or-function-composition-without-interm/49749697#49749697", "title": "Any way of disambiguation within lambdas or function composition (without intermediate function)?", "body": "<p>Since <code>name</code> is a duplicated record field you need to specify which type it is applied to:</p>\n\n<pre><code>fh3 = filter (\\h -&gt; (name (h::Human))==\"bob\") humans\n</code></pre>\n\n<p>See <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Records/OverloadedRecordFields/DuplicateRecordFields\" rel=\"nofollow noreferrer\">DuplicateRecordFields</a> for more info.</p>\n\n<h2>Edit</h2>\n\n<p>Otherwise, when dealing with duplicated record fields I like to proceed as follows.</p>\n\n<pre><code>{-# LANGUAGE DuplicateRecordFields #-}\ndata Human = Human {_name :: String } deriving (Show , Eq)\ndata Dog = Dog {_name :: String } deriving (Show , Eq)\n\nclass HasName a where \n    name :: a -&gt; String\n\ninstance HasName Human where\n    name = _name\n\ninstance HasName Dog where\n    name = _name\n</code></pre>\n\n<p>Then you can do </p>\n\n<pre><code>filter (\\h -&gt; (name h == \"bob\")) humans\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 2, "last_activity_date": 1523353279, "creation_date": 1523353279, "answer_id": 49750337, "question_id": 49749218, "link": "https://stackoverflow.com/questions/49749218/any-way-of-disambiguation-within-lambdas-or-function-composition-without-interm/49750337#49750337", "title": "Any way of disambiguation within lambdas or function composition (without intermediate function)?", "body": "<p>Adding to @St\u00e9phaneLaurent's answer, using <a href=\"https://ghc.haskell.org/trac/ghc/wiki/TypeApplication\" rel=\"nofollow noreferrer\"><code>TypeApplication</code></a> can help with point-free style:</p>\n\n<pre><code>{-# LANGUAGE DuplicateRecordFields #-}\n{-# LANGUAGE TypeApplications #-} \ndata Human = Human {_name :: String } deriving (Show , Eq)\ndata Dog = Dog {_name :: String } deriving (Show , Eq)\n\nclass HasName a where \n    name :: a -&gt; String\n\ninstance HasName Human where\n    name = _name\n\ninstance HasName Dog where\n    name = _name\n\nhumans = [Human \"bob\" , Human \"john\", Human \"paul\"]\n\n-- Now you can write it in pointfree style:\nfh2 = filter ((==\"Bob\") . name @Human) humans\n--                             ^^^^^^ This is a type argument!\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 616, "user_id": 8578679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CeZ5Z.png?s=128&g=1", "display_name": "Ruifeng Xie", "link": "https://stackoverflow.com/users/8578679/ruifeng-xie"}, "is_accepted": false, "score": 1, "last_activity_date": 1523361200, "creation_date": 1523361200, "answer_id": 49752961, "question_id": 49749218, "link": "https://stackoverflow.com/questions/49749218/any-way-of-disambiguation-within-lambdas-or-function-composition-without-interm/49752961#49752961", "title": "Any way of disambiguation within lambdas or function composition (without intermediate function)?", "body": "<p>Why not add a type signature for all these functions? like: </p>\n\n<pre><code>fh :: [Human] -&gt; [Human]\n</code></pre>\n\n<p>Adding a type signature should force the compiler to select the correct version. </p>\n"}], "owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 1, "accepted_answer_id": 49749697, "answer_count": 3, "score": 1, "last_activity_date": 1523374393, "creation_date": 1523349952, "last_edit_date": 1523374393, "question_id": 49749218, "link": "https://stackoverflow.com/questions/49749218/any-way-of-disambiguation-within-lambdas-or-function-composition-without-interm", "title": "Any way of disambiguation within lambdas or function composition (without intermediate function)?", "body": "<p>Consider the following code </p>\n\n<pre><code>{-# LANGUAGE DuplicateRecordFields #-}\ndata Human = Human {name :: String } deriving (Show , Eq)\ndata Dog = Dog {name :: String } deriving (Show , Eq)\n\nhumans = [Human \"bob\" , Human \"john\", Human \"paul\"]\n\n-- Working\nhumanName h = name (h :: Human)\nfh = filter ( (==\"bob\").humanName ) humans  \nfh' = filter (\\h -&gt; (humanName h )==\"bob\"  ) humans  \n\n-- Ambigous, not compiling\nfh2 = filter ( (==\"bob\").name ) humans\n-- Ambigous, not compiling\nfh3 = filter (\\h -&gt; (name h )==\"bob\"  ) humans\n\n-- Not compiling, I don't know if it's an error syntax or if this is impossible\nfh4 = filter (\\h -&gt; (name h)==\"bob\" (h :: Human) ) humans\n</code></pre>\n\n<p>Is there any way to have fh2, fh3 or fh4 working without having to define a named function for disambiguation ? </p>\n"}, {"tags": ["haskell", "recursion", "fold"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523347088, "post_id": 49748268, "comment_id": 86511051, "body": "Do you understand the &quot;foldr recursion pattern&quot;?"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 5, "creation_date": 1523347090, "post_id": 49748268, "comment_id": 86511052, "body": "&quot;product of nothing&quot; equals 1 is a usual mathematical convention."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1523347114, "post_id": 49748268, "comment_id": 86511067, "body": "What&#39;s a product of an empty list of values?"}, {"owner": {"reputation": 121, "user_id": 7023122, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4fc771105a47761221bba39fd522effe?s=128&d=identicon&r=PG&f=1", "display_name": "James Johnson", "link": "https://stackoverflow.com/users/7023122/james-johnson"}, "edited": false, "score": 0, "creation_date": 1523349481, "post_id": 49748268, "comment_id": 86512493, "body": "Thanks Stephane, I completely missed the logic in that!"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1523360175, "post_id": 49748268, "comment_id": 86519676, "body": "In general, <code>foldLikeThing [] = mempty</code> and <code>foldLikeThing (x:xs) = x `mappend` foldLikeThing xs</code>. (Cf. the definition of <code>foldMap</code> in terms of <code>foldr</code>.)"}], "answers": [{"tags": [], "owner": {"reputation": 286, "user_id": 9214910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22383025a510d1498c6cb790c140763?s=128&d=identicon&r=PG&f=1", "display_name": "Leif Metcalf", "link": "https://stackoverflow.com/users/9214910/leif-metcalf"}, "is_accepted": true, "score": 5, "last_activity_date": 1523347291, "creation_date": 1523347291, "answer_id": 49748393, "question_id": 49748268, "link": "https://stackoverflow.com/questions/49748268/what-does-f-v-mean-in-the-foldr-recursion-pattern/49748393#49748393", "title": "What does f [] = v mean in the Foldr Recursion Pattern?", "body": "<p><code>product []</code> is the base case. It is easy to see why it exists by working through an evaluation of the function.</p>\n\n<pre><code>product [5, 4, 8]\n5 * product [4, 8]\n5 * 4 * product [8]\n5 * 4 * 8 * product []\n5 * 4 * 8 * 1\n160\n</code></pre>\n\n<p>If the base case did not exist, product [] would not be able to evaluate to anything. 1 is the identity for multiplication, just as 0 is the identity for addition, i.e. 1 times any number is always that number, just as 0 plus any number is that number.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523558166, "post_id": 49753462, "comment_id": 86621930, "body": "Do you mean <code>Foldable</code>? Lists are <code>Traversable</code>, and <code>Traversable</code> is a subclass of <code>Foldable</code>, but it doesn&#39;t seem entirely relevant."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523559216, "post_id": 49753462, "comment_id": 86622479, "body": "@dfeuer yes, thanks. a thinko. It&#39;s relevant for the Bird&#39;s &quot;folding into a monoid iss a homomorphism&quot;. then it should link up with the &quot;monads are higher-order monoids&quot; thingy I keep having churning in my mind..."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 0, "last_activity_date": 1523559399, "last_edit_date": 1523559399, "creation_date": 1523362681, "answer_id": 49753462, "question_id": 49748268, "link": "https://stackoverflow.com/questions/49748268/what-does-f-v-mean-in-the-foldr-recursion-pattern/49753462#49753462", "title": "What does f [] = v mean in the Foldr Recursion Pattern?", "body": "<p>For <code>x = product [x]</code> to hold, <code>product [] = 1</code> must necessarily hold, because according to your definition,</p>\n\n<pre><code> product [x] = product (x:[]) = x * product []\n</code></pre>\n\n<p>But seen from a wider angle (i.e. with <code>xs == xs ++ []</code> in mind),</p>\n\n<pre><code>product (xs ++ ys) = product xs * product ys    -- and so,\n\nproduct (xs ++ []) = product xs * product []\n</code></pre>\n\n<p><a href=\"https://hackage.haskell.org/package/base-4.11.0.0/docs/Data-Foldable.html#v:foldMap\" rel=\"nofollow noreferrer\">because</a></p>\n\n<pre><code>product = foldr (*) 1 = getProduct . foldMap Product\n</code></pre>\n\n<p>and according to 1986 Richard Bird's <a href=\"https://www.cs.ox.ac.uk/files/3378/PRG56.pdf\" rel=\"nofollow noreferrer\"><em>An Introduction to the Theory of Lists</em></a>, reducing (folding) with an associative operation, like multiplication, is a <a href=\"https://en.wikipedia.org/wiki/Homomorphism\" rel=\"nofollow noreferrer\">homomorphism</a> on lists (and vice versa), i.e.</p>\n\n<pre><code>foldr (*) 1 (xs ++ ys)  =  foldr (*) 1 xs  *  foldr (*) 1 ys   -- and so,\n\nfoldr (*) 1 (xs ++ [])  =  foldr (*) 1 xs  *  foldr (*) 1 []\n</code></pre>\n\n<p>Mathematically speaking, numbers with <code>(*)</code> and <code>1</code> form a <a href=\"https://en.wikipedia.org/wiki/Monoid\" rel=\"nofollow noreferrer\"><em>monoid</em></a>. Monoids are closely involved with <em>folding</em> in Haskell:</p>\n\n<pre><code>foldMap :: Monoid m =&gt; (a -&gt; m) -&gt; f a -&gt; m    \n</code></pre>\n\n<p>In the above, <code>f</code> is a <code>Foldable</code> type, of which <em>lists</em> (<em><code>[]</code></em>) are one. So it's all connected.</p>\n"}], "owner": {"reputation": 121, "user_id": 7023122, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4fc771105a47761221bba39fd522effe?s=128&d=identicon&r=PG&f=1", "display_name": "James Johnson", "link": "https://stackoverflow.com/users/7023122/james-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 49748393, "answer_count": 2, "score": 2, "last_activity_date": 1523559399, "creation_date": 1523346901, "last_edit_date": 1523348195, "question_id": 49748268, "link": "https://stackoverflow.com/questions/49748268/what-does-f-v-mean-in-the-foldr-recursion-pattern", "title": "What does f [] = v mean in the Foldr Recursion Pattern?", "body": "<p>When using the Foldr pattern of recursion for the function product, we get:</p>\n\n<pre><code>product [] = 1\nproduct (x:xs) = x * product xs\n</code></pre>\n\n<p>My question is, what does the 'product [] = 1' mean? For the sum function for instance, we have sum[] = 0? Is this some sort of limit to the answer?</p>\n\n<p>Thank you in advance. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 521, "user_id": 7126380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207438513426512/picture?type=large", "display_name": "Johnny Liao", "link": "https://stackoverflow.com/users/7126380/johnny-liao"}, "edited": false, "score": 2, "creation_date": 1523344981, "post_id": 49747206, "comment_id": 86509730, "body": "mymap null (x:xs)=x:xs.....does this line mean &quot;if I put null function to mymap, it should return the same list.&quot;? then you will get a [a]. I guess it&#39;s the reason. Which line does the error point out?"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "reply_to_user": {"reputation": 521, "user_id": 7126380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207438513426512/picture?type=large", "display_name": "Johnny Liao", "link": "https://stackoverflow.com/users/7126380/johnny-liao"}, "edited": false, "score": 0, "creation_date": 1523345045, "post_id": 49747206, "comment_id": 86509768, "body": "Yes this is how i thought it should deal with an empty predicate."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "reply_to_user": {"reputation": 521, "user_id": 7126380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207438513426512/picture?type=large", "display_name": "Johnny Liao", "link": "https://stackoverflow.com/users/7126380/johnny-liao"}, "edited": false, "score": 0, "creation_date": 1523345150, "post_id": 49747206, "comment_id": 86509824, "body": "Apparently the third line is underlined in the error.More specifically the expression."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "reply_to_user": {"reputation": 521, "user_id": 7126380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207438513426512/picture?type=large", "display_name": "Johnny Liao", "link": "https://stackoverflow.com/users/7126380/johnny-liao"}, "edited": false, "score": 0, "creation_date": 1523345291, "post_id": 49747206, "comment_id": 86509925, "body": "The problem was indeed the 3-rd line returning the initial list.How should i deal with the return type signature if i want to return the initial list  if empty predicate...?Is there something like a conditional return type ?  [a] | [b]?"}, {"owner": {"reputation": 521, "user_id": 7126380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207438513426512/picture?type=large", "display_name": "Johnny Liao", "link": "https://stackoverflow.com/users/7126380/johnny-liao"}, "edited": false, "score": 0, "creation_date": 1523345430, "post_id": 49747206, "comment_id": 86510017, "body": "Is there any reason you don&#39;t won&#39;t use the initial list directly, instead giving null function to indicate you want a origninal one?"}, {"owner": {"reputation": 521, "user_id": 7126380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207438513426512/picture?type=large", "display_name": "Johnny Liao", "link": "https://stackoverflow.com/users/7126380/johnny-liao"}, "edited": false, "score": 0, "creation_date": 1523345534, "post_id": 49747206, "comment_id": 86510088, "body": "mymap::(a-&gt;a)-&gt;[a]-&gt;[a]    it allows you to use a id function to return the initial list. But in that way, all your funtion for map has type (a-&gt;a). Is that what you want?"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "reply_to_user": {"reputation": 521, "user_id": 7126380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207438513426512/picture?type=large", "display_name": "Johnny Liao", "link": "https://stackoverflow.com/users/7126380/johnny-liao"}, "edited": false, "score": 0, "creation_date": 1523345572, "post_id": 49747206, "comment_id": 86510108, "body": "I just wanted to exclude all null posibilities.I thought that when i write a function i have to cover all edge cases so in my case null source list and null predicate."}, {"owner": {"reputation": 521, "user_id": 7126380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207438513426512/picture?type=large", "display_name": "Johnny Liao", "link": "https://stackoverflow.com/users/7126380/johnny-liao"}, "edited": false, "score": 0, "creation_date": 1523345693, "post_id": 49747206, "comment_id": 86510188, "body": "One point I just saw: I think your null in <code>mymap null (x:xs)=x:xs</code> means &quot;every function you put into map because it&#39;s just a pattern match word."}, {"owner": {"reputation": 521, "user_id": 7126380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207438513426512/picture?type=large", "display_name": "Johnny Liao", "link": "https://stackoverflow.com/users/7126380/johnny-liao"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1523346045, "post_id": 49747206, "comment_id": 86510408, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/168620/discussion-between-johnny-liao-and-bercovici-adrian\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1523345969, "post_id": 49747962, "comment_id": 86510360, "body": "And how would i deal with an empty predicate?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1523346054, "post_id": 49747962, "comment_id": 86510416, "body": "@BercoviciAdrian no such thing exists. If you mean <code>id</code>, then that matches it in any case."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1523346842, "post_id": 49747962, "comment_id": 86510899, "body": "<code>null :: Foldable t =&gt; t a -&gt; Bool</code>. Why do you say there is no <code>null</code> in Haskell ? It tests whether a list is empty for example."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1523347182, "post_id": 49747962, "comment_id": 86511108, "body": "So there&#39;s no equivalent to a NULL function pointer argument in haskell? e.g:  void myfunction( void (*arg)() ) and i don&#39;t have to treat this case?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 1, "creation_date": 1523347917, "post_id": 49747962, "comment_id": 86511535, "body": "@St&#233;phaneLaurent That is a definition in Data.Foldable. I mean a builtin."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 2, "creation_date": 1523347976, "post_id": 49747962, "comment_id": 86511567, "body": "@BercoviciAdrian Pointers don&#39;t exist in vanilla Haskell. You don&#39;t have to treat this case."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 3, "last_activity_date": 1523347987, "last_edit_date": 1523347987, "creation_date": 1523345869, "answer_id": 49747962, "question_id": 49747206, "link": "https://stackoverflow.com/questions/49747206/dealing-with-null-method-argument-in-haskell/49747962#49747962", "title": "Dealing with null method argument in Haskell", "body": "<p><strong>There is no <code>null</code> pointer in Haskell</strong>, so this line:</p>\n\n<pre><code>mymap null (x:xs) = (x:xs)\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>mymap _ s = s\n</code></pre>\n\n<p>Since <code>null</code> simply matches everything regardless of value, being a valid identifier. You could say, for instance, <code>null = 6</code>, and it would be valid in Haskell.</p>\n\n<p>Thus giving the function type <code>mymap :: b -&gt; [a] -&gt; [a]</code>, which is different from the type you intended.</p>\n\n<p>You should remove that line. The 'correct' implementation is:</p>\n\n<pre><code>mymap :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmymap _ []     = []\nmymap f (x:xs) = f x : map f xs\n</code></pre>\n\n<p>You're right to pattern match on both <code>[]</code> and <code>(:)</code>, because in  the declaration of the list type, both occur:</p>\n\n<pre><code>-- Compiler magic occurs here! This is not usually valid syntax\ndata [a] = [] | a : [a]\n</code></pre>\n\n<p>We therefore see that in a list there are only two possibilities, both of which we must match. However, this is not the case with functions.</p>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 49747962, "answer_count": 1, "score": 0, "last_activity_date": 1523426575, "creation_date": 1523343206, "last_edit_date": 1523426575, "question_id": 49747206, "link": "https://stackoverflow.com/questions/49747206/dealing-with-null-method-argument-in-haskell", "title": "Dealing with null method argument in Haskell", "body": "<p>I have tried implementing my custom map function and i get this error which does not tell me much.</p>\n\n<pre><code>mymap::(a-&gt;b)-&gt;[a]-&gt;[b]\nmymap _ [] =[]\nmymap null (x:xs)=x:xs\nmymap f (x:xs)=f x : mymap f xs\n</code></pre>\n\n<p>Error message:</p>\n\n<pre><code>* Couldn't match type `a' with `b'\n      `a' is a rigid type variable bound by\n        the type signature for:\n          mymap :: forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>Why is it not correct since i provide a predicate from <code>a</code> to <code>b</code>, a source list of <code>a</code> and i expect a list of <code>b</code>'s</p>\n"}, {"tags": ["haskell", "tail-recursion"], "comments": [{"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 0, "creation_date": 1523342758, "post_id": 49746371, "comment_id": 86508377, "body": "I don\u2019t think so, since the result of the inner call to <code>fibsumt</code> must then be added to the accumulator."}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 1, "creation_date": 1523342788, "post_id": 49746371, "comment_id": 86508398, "body": "\u2026 things are different in Haskell though, see <a href=\"https://stackoverflow.com/questions/13042353/does-haskell-have-tail-recursive-optimization\" title=\"does haskell have tail recursive optimization\">stackoverflow.com/questions/13042353/&hellip;</a>"}, {"owner": {"reputation": 417, "user_id": 6119326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2272c3c353d86eb717ca0ceed6ad7ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Karl", "link": "https://stackoverflow.com/users/6119326/karl"}, "reply_to_user": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 0, "creation_date": 1523343069, "post_id": 49746371, "comment_id": 86508556, "body": "I probably should have used a strict language for this because laziness makes this all a bit more difficult."}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 0, "creation_date": 1523343294, "post_id": 49746371, "comment_id": 86508711, "body": "Yeah, in a strict one that would not qualify because of the outer add... but you could move it inside the inner recursive call, couldn\u2019t you? Where is that <code>b</code> coming from?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 0, "creation_date": 1523353728, "post_id": 49746371, "comment_id": 86515293, "body": "@RegisKuckaertz That answer is a good read but I don&#39;t think it quite applies here since <code>sumt</code> is strict in both of its arguments."}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1523356177, "post_id": 49746371, "comment_id": 86517010, "body": "@BenjaminHodgson I would have thought that because the recursive call does not inspect <code>acc</code>, then the compiler would box the value. Is that reasoning incorrect?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1523356557, "post_id": 49746371, "comment_id": 86517282, "body": "\u201cStrict\u201d in this context is quite a specific term: <i>how much of the input is forced when evaluating the output to WHNF?</i> It should be clear that <code>(+)</code> (on <code>Int</code>s) is strict in both of its arguments, so <code>sumt</code> (which calls <code>(+)</code>) is also strict. GHC <i>may</i> implement the recursive calls using the trampoline-esque evaluation strategy described in the linked answer but with optimisations on it won\u2019t. (Disclaimer: I haven\u2019t looked at the generated Core so I might be talking outta my ass!)"}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 0, "creation_date": 1523357541, "post_id": 49746371, "comment_id": 86517907, "body": "haha, no that&#39;s very useful, thank you."}], "owner": {"reputation": 417, "user_id": 6119326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2272c3c353d86eb717ca0ceed6ad7ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Karl", "link": "https://stackoverflow.com/users/6119326/karl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1523342070, "creation_date": 1523340078, "last_edit_date": 1523342070, "question_id": 49746371, "link": "https://stackoverflow.com/questions/49746371/is-this-tail-recursive-new-edge-cases", "title": "Is this tail-recursive? New edge cases", "body": "<pre><code>data Tree = Leaf Int | Branch Tree Tree\n\nsumt (Leaf i) acc = i + acc\nsumt (Branch l r) acc = sumt l (sumt r acc)\n</code></pre>\n\n<p><code>sumt</code> is in tail position, but it's also in the accumulator. I lean towards no because it has to evaluate the inner call to <code>sumt</code> (using a call stack), but I can see why it could be tail-recursive because the last function call is <code>sumt</code>. <code>fibsumt</code> is clearly tail-recursive even though the acc function creates a deep call-stack.</p>\n\n<pre><code>fib 0 = 0\nfib 1 = 1\nfib n = fib (n - 2) + fib (n - 1)\n\nfibsumt 0 acc = acc\nfibsumt n acc = fibsumt (n - 1) (acc + (fib n))\n</code></pre>\n\n<p>Is <code>sumt</code> classified as a tail-recursive function?</p>\n"}, {"tags": ["haskell", "if-statement", "case"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9622100, "user_type": "registered", "profile_image": "https://graph.facebook.com/1926942647318782/picture?type=large", "display_name": "Jason Nowak", "link": "https://stackoverflow.com/users/9622100/jason-nowak"}, "edited": false, "score": 0, "creation_date": 1523323249, "post_id": 49743640, "comment_id": 86502565, "body": "The point is to take a list of odd or even length and return every other number in the list as the answer. For the even length <code>mod</code> 2 == 0 this works, i.e [1,2,3,4,5,6] returns [1,3,5]. However, the case of == 1 i.e [1,2,3,4,5,6,7] returns [1,2]  where it should ideally return [1,3,5,7] this is my issue"}, {"owner": {"reputation": 11, "user_id": 9622100, "user_type": "registered", "profile_image": "https://graph.facebook.com/1926942647318782/picture?type=large", "display_name": "Jason Nowak", "link": "https://stackoverflow.com/users/9622100/jason-nowak"}, "edited": false, "score": 0, "creation_date": 1523323296, "post_id": 49743640, "comment_id": 86502576, "body": "I appreciate the added conceptual knowledge as Haskell (obviously) is still a fairly new language for me."}, {"owner": {"reputation": 11, "user_id": 9622100, "user_type": "registered", "profile_image": "https://graph.facebook.com/1926942647318782/picture?type=large", "display_name": "Jason Nowak", "link": "https://stackoverflow.com/users/9622100/jason-nowak"}, "edited": false, "score": 0, "creation_date": 1523323794, "post_id": 49743640, "comment_id": 86502675, "body": "It was the length call. Once I call length (x:xs) both conditions work. Thank you!!! @DanielWagner"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 5, "last_activity_date": 1523321986, "last_edit_date": 1523321986, "creation_date": 1523321356, "answer_id": 49743640, "question_id": 49743377, "link": "https://stackoverflow.com/questions/49743377/how-do-i-use-if-then-else-or-guards-in-a-case-statement-in-haskell/49743640#49743640", "title": "How do I use if/then/else or guards in a case statement in Haskell?", "body": "<p>There seem to be a few different errors in this code, varying through the whole range from syntactic to conceptual to algorithmic. Let's start with the syntax errors and move up the chain.</p>\n\n<p>Code in Haskell is organized into blocks. Each element of a block must start at the same indentation level; and for beginners, nested blocks should use a deeper indentation level than its surrounding block. At the top level, modules are a block whose elements are equations. <code>case</code>/<code>of</code> also begins a block, whose elements are <code>pattern -&gt; expression</code> matches.</p>\n\n<p>Together, these rules mean that the patterns <code>0</code> and <code>1</code> in your <code>case</code> statement should be aligned with each other and indented deeper than the first <code>e</code> of <code>everyOther</code>. The expression inside should be deeper still to avoid confusion. Here's one popular style for satisfying these constraints:</p>\n\n<pre><code>everyOther (x:xs) = case length (xs) 'mod' 2 of\n    0 -&gt; if (length (xs) `mod` 2 == 0)\n         then x:everyOther (take 1 xs)\n         else x:everyOther (drop 1 xs)\n    1 -&gt; if (length (xs) `mod` 2 == 1)\n         then x:everyOther (take 1 xs)\n         else x:everyOther (drop 1 xs)\n</code></pre>\n\n<p>Next: backticks (<code>`</code> &mdash; usually located to left of the row of numbers at the top of the keyboard) and forward ticks (<code>'</code>) mean different things in Haskell. It's important to use backticks for converting prefix functions to infix ones; so <code>length (xs) 'mod' 2</code> should be <code>length (xs) `mod` 2</code>. You also have a lot of redundant parentheses, notably around your argument to <code>length</code> and in the coditions of your <code>if</code> expressions. Though not an error, it is worthwhile to learn the precedence rules, as you'll need to understand code that doesn't litter them everywhere.</p>\n\n<pre><code>everyOther (x:xs) = case length xs `mod` 2 of\n    0 -&gt; if length xs `mod` 2 == 0\n         then x:everyOther (take 1 xs)\n         else x:everyOther (drop 1 xs)\n    1 -&gt; if length xs `mod` 2 == 1\n         then x:everyOther (take 1 xs)\n         else x:everyOther (drop 1 xs)\n</code></pre>\n\n<p>Next up is a conceptual error. In an expression like <code>case foo of 0 -&gt; a; 1 -&gt; b</code>, we will only ever evaluate expression <code>a</code> when <code>foo == 0</code>, and will only ever evaluate expression <code>b</code> when <code>foo == 1</code>. This makes the tests in your conditions redundant; in both branches of the <code>case</code>, we will definitely take the <code>then</code> branch. So if we were to take this code literally, it would be simpler and equivalent to write this instead:</p>\n\n<pre><code>everyOther (x:xs) = case length xs `mod` 2 of\n    0 -&gt; x:everyOther (take 1 xs)\n    1 -&gt; x:everyOther (take 1 xs)\n</code></pre>\n\n<p>Since we now have the same code in both branches of the <code>case</code>, it seems clear this wasn't your intention; but it isn't super clear to me what your intention <em>was</em>.</p>\n\n<p>There is another suspicious (though again, not technically <em>wrong</em>) detail: keep in mind that in the <code>foo</code> of <code>everyOther (x:xs) = foo</code>, the list <code>xs</code> does not include the first element of the list given to <code>everyOther</code>. So calls like <code>length xs</code> will be off by one compared to the length of the input given to <code>everyOther</code>. Take that into account as you write the expressions for the <code>0</code> and <code>1</code> patterns of your <code>case</code> statement.</p>\n\n<p>Returning to your intention: since in both patterns you write <code>everyOther (take 1 xs)</code>, I assume that you wanted that expression to be evaluated sometimes. This makes me think you have an algorithmic error; <code>take 1 xs</code> will throw away almost all of the input list, which doesn't match my understanding of what you want <code>everyOther</code> to do.</p>\n\n<p>Hopefully this discussion guides you in improving your attempt, and you can make more progress towards your goals.</p>\n"}], "owner": {"reputation": 11, "user_id": 9622100, "user_type": "registered", "profile_image": "https://graph.facebook.com/1926942647318782/picture?type=large", "display_name": "Jason Nowak", "link": "https://stackoverflow.com/users/9622100/jason-nowak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1216, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1523321986, "creation_date": 1523318887, "question_id": 49743377, "link": "https://stackoverflow.com/questions/49743377/how-do-i-use-if-then-else-or-guards-in-a-case-statement-in-haskell", "title": "How do I use if/then/else or guards in a case statement in Haskell?", "body": "<p>The \"Guards vs. If-Then-Else\" helped a little but I still want to know if this can work somehow. I need to take a list and return every other element of the list. For even length lists I got it just if length (xs) <code>mod</code> 2 == 1 to start is there an issue so I want to break up the initial length of list case like this: </p>\n\n<pre><code>everyOther:: [Int] -&gt; [Int] \neveryOther [] = [] \neveryOther (x:xs) = case length (xs) 'mod' 2 of 0 -&gt;  \nif (length (xs) `mod` 2 == 0)   \nthen  x:everyOther (take 1 xs) \nelse x:everyOther (drop 1 xs) \n1 -&gt; if (length (xs) `mod` 2 == 1) \nthen  x:everyOther (take 1 xs) \nelse x:everyOther (drop 1 xs)\n</code></pre>\n\n<p>It's telling me there is a possible \"spacing error\" at the \"if\" but is this functionally correct. Can I do this?</p>\n"}, {"tags": ["haskell", "functional-programming", "monads"], "comments": [{"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1523312738, "post_id": 49742377, "comment_id": 86499781, "body": "I&#39;m sure you already noticed this, but the answerer did reply to your comment on that post that you linked. I personally am not able to construct a counterexample fitting his description at a glance, but I wanted to make you aware of his comment."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 1, "creation_date": 1523313005, "post_id": 49742377, "comment_id": 86499856, "body": "What makes an applicative a Monad is the ability to squash it (using join) and so transform a pair of pair to a pair. You can&#39;t do it without losing some elements (going from 4 to 2) as you do in your example. That&#39;s will break the laws.  For example <code>Pair (Pair 1 2) Empty &gt;&gt;= return </code> returns Empty. That s not good ."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1523313109, "post_id": 49742377, "comment_id": 86499891, "body": "@mb14 I ran it in my head and I don&#39;t get <code>Empty</code>."}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 2, "creation_date": 1523313227, "post_id": 49742377, "comment_id": 86499929, "body": "I ran it in <a href=\"https://tio.run/##dU9dT4MwFH3vrzjJHqAGTPRxcSREcTHxY0b3TBpWoGErWIqDqL8dS4GZGL0PTc@993zcnNUF3@/7/sNf4D58XG/DdYQbrsQ7v21kokuFhf9FiDhUpdJ45bU@f25EUlznPCkI2THNsCkjMKwQHSrd4RMbJpRpMOwGISEzuJOYF715L3l5pEZR1prJhCOsqr1ImDaWVumYc8UJTFWN4miNsBVs0dquBSkyXJ0F86Sbl9wULYWboaN2OcZUw/IJTFF/MjyUku1@uY/XmAqClaHOnFOEwXUYpWaUsJpbb8/AjqJMQfB3uSPZQezZX4zOofDnUxwD/6PGw9qYghyYkFgucfcEl45ohUoJqSeH8b3AJZ0uGbIqrhslad9/Aw\" rel=\"nofollow noreferrer\">TIO</a> and I don&#39;t get <code>Empty</code>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1523313362, "post_id": 49742377, "comment_id": 86499966, "body": "@mb14 Losing elements isn&#39;t in itself a problem -- <code>(&gt;&gt;=)</code> and <code>join</code> don&#39;t have to preserve all information. <code>data Pair a = P a a</code> is indeed a monad, as the OP points out."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1523341682, "post_id": 49742377, "comment_id": 86507761, "body": "@duplode even though my example didn&#39;t work, the fact you lose elements is at the heart of the failure of the join law explained on other post. So in a way losing elements is a problem. In fact I think is the significance of the functor <code>fmap id = id</code> law (not lose, shuffle or duplicate elements)."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 1, "creation_date": 1523342459, "post_id": 49742377, "comment_id": 86508191, "body": "I meant <code>&gt;&gt;= id</code>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1523344635, "post_id": 49742377, "comment_id": 86509510, "body": "@mb14 (1) To me, it seems it is more a question of losing effects than of losing elements, though I still have to make it clearer (to myself, even) what I mean with &quot;losing effects&quot;. (2) &quot;I meant <code>&gt;&gt;= id</code>&quot; -- I assume you mean your example was actually <code>Pair (Pair 1 2) Empty &gt;&gt;= id = Empty</code>?"}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 2, "creation_date": 1523349700, "post_id": 49742377, "comment_id": 86512638, "body": "Interesting that very similar type is actually a monad: <a href=\"https://stackoverflow.com/questions/43684258/how-to-define-a-monad-instance-to-types-with-mutiple-values\" title=\"how to define a monad instance to types with mutiple values\">stackoverflow.com/questions/43684258/&hellip;</a>"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1523357888, "post_id": 49742377, "comment_id": 86518131, "body": "@Shersh  interesting indeed, however the main difference is the possibily to have only one element or two, which allows to not drop or have to duplicate things."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1523357928, "post_id": 49742377, "comment_id": 86518153, "body": "@duplode (1) <a href=\"https://wiki.haskell.org/Functor#Functor_Laws\" rel=\"nofollow noreferrer\">wiki.haskell.org/Functor#Functor_Laws</a> (2) yes :-)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1523365451, "post_id": 49742377, "comment_id": 86523522, "body": "@mb14 I don&#39;t think the functor laws are applicable here, unless we are talking about the functor laws for <code>(=&lt;&lt;)</code>, which amount to two of the monad laws -- <code>(return =&lt;&lt;) = id</code> and <code>((g &lt;=&lt; f) =&lt;&lt;) = (g =&lt;&lt;) . (f =&lt;&lt;)</code>. It is also worth noting that the identitly law implies the composition law for <code>fmap</code>, but not for <code>(=&lt;&lt;)</code>. There may well be an interesting way to look at this situation in those terms."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1523365784, "post_id": 49742377, "comment_id": 86523816, "body": "@duplode Monad being a Functor must follow the Functor laws. It is likely that Functor laws are including in Monad Laws and therefore don&#39;t need to be proven (as they can be proven from the monad laws and the definition of <code>fmap</code> for a Monad). However, making a Functor law fails should also prove that the Monad laws fails."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1523366130, "post_id": 49742377, "comment_id": 86524045, "body": "@mb14 The <code>Functor</code> laws don&#39;t fail for <code>PoE</code>: <code>fmap f = \\case { Empty -&gt; Empty; Pair x y -&gt; Pair (f x) (f y) }</code> is perfectly legal. When I talk of &quot;the functor laws for <code>(=&lt;&lt;)</code>&quot;, <a href=\"https://stackoverflow.com/a/39955475/2751851\">I mean a different functor</a>, one which is not a <code>Functor</code> (that is, not an endofunctor in <b>Hask</b>)."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1523366972, "post_id": 49742377, "comment_id": 86524750, "body": "@duplode Fair enough, anyway, it is the losse in <code>(Pair x&#39; _) -&gt; ...</code> which makes it an invalid Monad , even though I agree it&#39;s a valid Functor."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1523374982, "post_id": 49742377, "comment_id": 86530575, "body": "@mb14 I would say the problem doesn&#39;t lie there, but rather with <code>Empty</code>. Without <code>Empty</code>, that becomes a lawful <code>(&gt;&gt;=)</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1523375499, "post_id": 49742377, "comment_id": 86530922, "body": "@Shersh In the terms of my <a href=\"https://stackoverflow.com/a/49743437/2751851\">first answer</a>, that instance is lawful because it isn&#39;t actually taking the diagonal. (I suspect the only variable length list-like type in which taking the diagonal gives a lawful monad is <code>Maybe</code> -- in that case, there simply aren&#39;t enough ways to mess with the diagonals in order to get an associativity failure.)"}, {"owner": {"reputation": 2845, "user_id": 593934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nPK3i.jpg?s=128&g=1", "display_name": "winitzki", "link": "https://stackoverflow.com/users/593934/winitzki"}, "edited": false, "score": 0, "creation_date": 1523398014, "post_id": 49742377, "comment_id": 86542732, "body": "Not sure I understand this intuition about &quot;taking the diagonal&quot; or &quot;losing effects&quot;. Any functor of the form <code>Either (a, a, a) (a, a, a, a, a)</code>, or more generally, a sum of any number of products of any number of <code>a</code>&#39;s, is a lawful monad, and sometimes in more than one way.  How can this be explained heuristically using &quot;diagonals&quot; or &quot;losing information&quot;?"}, {"owner": {"reputation": 2845, "user_id": 593934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nPK3i.jpg?s=128&g=1", "display_name": "winitzki", "link": "https://stackoverflow.com/users/593934/winitzki"}, "edited": false, "score": 0, "creation_date": 1523398395, "post_id": 49742377, "comment_id": 86542848, "body": "If <code>m</code> is a monad then <code>Either a (m a)</code> is a monad and also <code>m (Either c (w, a))</code> is a monad for any constant type <code>c</code> and any monoid type <code>w</code> (we can take <code>w = ()</code> or <code>c = Void</code> here). If <code>m1</code> and <code>m2</code> are monads then <code>(m1 a, m2 a)</code> is a monad. Using these constructions and starting with the identity monad, lots of polynomial monads can be constructed. It is not clear how to detect which polynomial functors are not monads. I&#39;m having trouble coming with explicit counterexamples other than <code>Maybe (a, a)</code>, <code>Maybe (a, a, a)</code> and so on."}, {"owner": {"reputation": 2845, "user_id": 593934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nPK3i.jpg?s=128&g=1", "display_name": "winitzki", "link": "https://stackoverflow.com/users/593934/winitzki"}, "edited": false, "score": 0, "creation_date": 1523406939, "post_id": 49742377, "comment_id": 86544921, "body": "Another example of a polynomial functor that cannot be obtained using the above constructions is <code>data P a = Empty | One a | Three a a a</code>. I conjecture that it is not a monad, but I do not know how to prove in general that these constructions are the only ones yielding lawful polynomial monads."}, {"owner": {"reputation": 2845, "user_id": 593934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nPK3i.jpg?s=128&g=1", "display_name": "winitzki", "link": "https://stackoverflow.com/users/593934/winitzki"}, "edited": false, "score": 0, "creation_date": 1523421724, "post_id": 49742377, "comment_id": 86548668, "body": "@Franky the reason your question generated interest is, I believe, because nobody really knows how to recognize a monad reliably without a lot of tedious calculations. The existing literature and tutorials never talk about this, so even simple types like <code>Either c (a, a)</code> give us a pause. What we have seen is that QuickCheck will often, but not always, detect a problem. So using QuickCheck is not an ideal recipe. Proving the laws symbolically would require a proof assistant and is also not a great experience."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 2845, "user_id": 593934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nPK3i.jpg?s=128&g=1", "display_name": "winitzki", "link": "https://stackoverflow.com/users/593934/winitzki"}, "edited": false, "score": 0, "creation_date": 1523455948, "post_id": 49742377, "comment_id": 86569885, "body": "@winitzki On diagonals: taking the diagonal (first element from the first &quot;list&quot;, second element from the second &quot;list&quot;, etc.) is one of the plausible ways to attempt writing <code>join</code> for a list-like type such as the ones we are discussing here. Your instance for <code>Either (a, a, a) (a, a, a, a, a)</code> does not amount to taking the diagonal. I agree with your suggestion that it is a good idea to think about an intuitive way of describing it."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 2845, "user_id": 593934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nPK3i.jpg?s=128&g=1", "display_name": "winitzki", "link": "https://stackoverflow.com/users/593934/winitzki"}, "edited": false, "score": 0, "creation_date": 1523769378, "post_id": 49742377, "comment_id": 86692381, "body": "@winitzki I have just figured out how to explain <code>Either a (a,a...a)</code> being a monad in terms of diagonals: if you find a <code>Left x</code> while taking the diagonal of a <code>Right (m1,m2...mn)</code>, replicate it to get the <code>(a,a...a)</code> tuple you need. This generalises to <code>Monad m =&gt; Either a (m a)</code>: you just have to replace &quot;replicate&quot; with &quot;use <code>pure</code>&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 1, "creation_date": 1523314649, "post_id": 49742857, "comment_id": 86500366, "body": "Well played. You can make the <code>Empty</code> disappear by positioning them carefully. Good answer!"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 11, "last_activity_date": 1523315026, "last_edit_date": 1523315026, "creation_date": 1523314458, "answer_id": 49742857, "question_id": 49742377, "link": "https://stackoverflow.com/questions/49742377/is-data-poe-a-empty-pair-a-a-a-monad/49742857#49742857", "title": "Is `data PoE a = Empty | Pair a a` a monad?", "body": "<p>Apparently, it is not a monad. One of the monad \"<code>join</code>\" laws is</p>\n\n<pre><code>join . join = join . fmap join\n</code></pre>\n\n<p>Hence, according to the law above, these two outputs should be equal, but they are not.</p>\n\n<pre><code>main :: IO ()\nmain = do\n  let x = Pair (Pair (Pair 1 2) Empty) (Pair Empty (Pair 7 8))\n  print (join . join $ x)\n  -- output: Pair 1 8\n  print (join . fmap join $ x)\n  -- output: Empty\n</code></pre>\n\n<p>The problem is that</p>\n\n<pre><code>join x      = Pair (Pair 1 2) (Pair 7 8)\nfmap join x = Pair Empty Empty\n</code></pre>\n\n<p>Performing an additional <code>join</code> on those does not make them equal.</p>\n\n<blockquote>\n  <p>how to find that out systematically?</p>\n</blockquote>\n\n<p><code>join . join</code> has type <code>m (m (m a)) -&gt; m (m a)</code>, so I started with a triple-nested <code>Pair</code>-of-<code>Pair</code>-of-<code>Pair</code>, using numbers <code>1..8</code>. That worked fine. Then, I tried to insert some <code>Empty</code> inside, and quickly found the counterexample above.</p>\n\n<p>This approach was possible since a <code>m (m (m Int))</code> only contains a finite amount of integers inside, and we only have constructors <code>Pair</code> and <code>Empty</code> to try.</p>\n\n<p>For these checks, I find the <code>join</code> law easier to test than, say, associativity of <code>&gt;&gt;=</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1523315176, "post_id": 49742892, "comment_id": 86500565, "body": "It&#39;s funny, I used <code>Bool</code> and no counterexample was found; I thought maybe the laws held just for bool because of some anomaly. But I guess it&#39;s just the imperfection of randomness.."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 11, "last_activity_date": 1523314671, "creation_date": 1523314671, "answer_id": 49742892, "question_id": 49742377, "link": "https://stackoverflow.com/questions/49742377/is-data-poe-a-empty-pair-a-a-a-monad/49742892#49742892", "title": "Is `data PoE a = Empty | Pair a a` a monad?", "body": "<p>QuickCheck immediately finds a counterexample to associativity.</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n\nimport Test.QuickCheck\n\ndata PoE a = Empty | Pair a a deriving (Functor,Eq, Show)\n\ninstance Applicative PoE where\n    pure x = Pair x x\n    Pair f g &lt;*&gt; Pair x y = Pair (f x) (g y)\n    _        &lt;*&gt; _        = Empty\ninstance Monad PoE where\n    Empty    &gt;&gt;= _ = Empty\n    Pair x y &gt;&gt;= f = case (f x, f y) of \n                       (Pair x' _,Pair _ y') -&gt; Pair x' y'\n                       _ -&gt; Empty\n\ninstance Arbitrary a =&gt; Arbitrary (PoE a) where\n  arbitrary = oneof [pure Empty, Pair &lt;$&gt; arbitrary &lt;*&gt; arbitrary]\n\nprop_assoc :: PoE Bool -&gt; (Bool -&gt; PoE Bool) -&gt; (Bool -&gt; PoE Bool) -&gt; Property\nprop_assoc m k h =\n  ((m &gt;&gt;= k) &gt;&gt;= h) === (m &gt;&gt;= (\\a -&gt; k a &gt;&gt;= h))\n\nmain = do\n  quickCheck $ \\m (Fn k) (Fn h) -&gt; prop_assoc m k h\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>*** Failed! Falsifiable (after 35 tests and 3 shrinks):    \nPair True False\n{False-&gt;Pair False False, True-&gt;Pair False True, _-&gt;Empty}\n{False-&gt;Pair False True, _-&gt;Empty}\nPair False True /= Empty\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 6, "last_activity_date": 1523314992, "creation_date": 1523314992, "answer_id": 49742929, "question_id": 49742377, "link": "https://stackoverflow.com/questions/49742377/is-data-poe-a-empty-pair-a-a-a-monad/49742929#49742929", "title": "Is `data PoE a = Empty | Pair a a` a monad?", "body": "<p>Since you are interested in how to do it systematically, here's how I found a counterexample with quickcheck:</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n\nimport Control.Monad ((&gt;=&gt;))\nimport Test.QuickCheck\n\n-- &lt;your code&gt;\n</code></pre>\n\n<p>Defining an arbitrary instance to generate random <code>PoE</code>s.</p>\n\n<pre><code>instance (Arbitrary a) =&gt; Arbitrary (PoE a) where\n    arbitrary = do\n      emptyq &lt;- arbitrary\n      if emptyq\n        then return Empty\n        else Pair &lt;$&gt; arbitrary &lt;*&gt; arbitrary\n</code></pre>\n\n<p>And tests for the monad laws:</p>\n\n<pre><code>prop_right_id m = (m &gt;&gt;= return) == m\n    where\n    _types = (m :: PoE Int)\n\nprop_left_id fun x = (return x &gt;&gt;= f) == f x\n    where\n    _types = fun :: Fun Int (PoE Int)\n    f = applyFun fun\n\nprop_assoc fun gun hun x = (f &gt;=&gt; (g &gt;=&gt; h)) x == ((f &gt;=&gt; g) &gt;=&gt; h) x\n    where\n    _types = (fun :: Fun Int (PoE Int),\n              gun :: Fun Int (PoE Int),\n              hun :: Fun Int (PoE Int),\n              x :: Int)\n    f = applyFun fun\n    g = applyFun gun\n    h = applyFun hun\n</code></pre>\n\n<p>I don't get any failures for the identity laws, but <code>prop_assoc</code> does generate a counterexample:</p>\n\n<pre><code>ghci&gt; quickCheck prop_assoc\n*** Failed! Falsifiable (after 7 tests and 36 shrinks):\n{6-&gt;Pair 1 (-1), _-&gt;Empty}\n{-1-&gt;Pair (-3) (-4), 1-&gt;Pair (-1) (-2), _-&gt;Empty}\n{-3-&gt;Empty, _-&gt;Pair (-2) (-4)}\n6\n</code></pre>\n\n<p>Not that it's terribly helpful for understanding <em>why</em> the failure occurs, it does give you a place to start.  If we look carefully, we see that we are passing <code>(-3)</code> and <code>(-2)</code> to the third function; <code>(-3)</code> maps to <code>Empty</code> and <code>(-2)</code> maps to a <code>Pair</code>, so we can't defer to the laws of either of the two monads <code>PoE</code> is composed of.  </p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 6, "last_activity_date": 1523348048, "last_edit_date": 1523348048, "creation_date": 1523319533, "answer_id": 49743437, "question_id": 49742377, "link": "https://stackoverflow.com/questions/49742377/is-data-poe-a-empty-pair-a-a-a-monad/49743437#49743437", "title": "Is `data PoE a = Empty | Pair a a` a monad?", "body": "<p>This kind of potential <code>Monad</code> instance can be concisely described as \"taking the diagonal\". It is easier to see why if we use the <code>join</code> presentation. Here is <code>join</code> for the <code>Pair</code> type you mention:</p>\n\n<pre><code>join (P (P a00 a11) (P a10 a11)) = P a00 a11\n</code></pre>\n\n<p>Taking the diagonal, however, is only guaranteed to give a lawful <code>join</code> for fixed length (or infinite) lists. That's because of the associativity law:</p>\n\n<pre><code>join . join = join . fmap join\n</code></pre>\n\n<p>If the n-th list in a list of lists doesn't have an n-th element, it will lead to the diagonal being trimmed: it will end before its n-th element. <code>join . join</code> takes the outer diagonal (of a list of lists <em>of lists</em>) first, while <code>join . fmap join</code> takes the inner diagonals first. It may be possible for an insufficiently long innermost list which is not in the outer diagonal to trim <code>join . fmap join</code>, but it can't possibly affect <code>join . join</code>. (This would be easier to show with a picture instead of words.)</p>\n\n<p>Your <code>PoE</code> is a list-like type that doesn't have fixed length (the length is either zero or two). It turns out that taking its diagonal doesn't give us a monad, as the potential issue discussed above actually gets in the way (as illustrated in <a href=\"https://stackoverflow.com/a/49742857/2751851\">chi's answer</a>).</p>\n\n<p>Additional notes:</p>\n\n<ul>\n<li><p>This is precisely the reason <a href=\"https://hackage.haskell.org/package/base-4.11.0.0/docs/Control-Applicative.html#t:ZipList\" rel=\"nofollow noreferrer\"><code>ZipList</code></a> is not a monad: the zippy behaviour amounts to taking the diagonal.</p></li>\n<li><p>Infinite lists are isomorphic to functions from the naturals, and fixed length lists are isomorphic to functions from the naturals up to an appropriate value. This means you can get a <code>Monad</code> instance for them out of the instance for functions -- and the instance you get, again, amounts to taking the diagonal.</p></li>\n<li><p><a href=\"https://www.reddit.com/r/haskell/comments/5x4yka/deprecate_foldable_for_either/dehoey7/\" rel=\"nofollow noreferrer\">Once upon a time I got confused about this exact issue</a>.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 4, "last_activity_date": 1523507154, "last_edit_date": 1523507154, "creation_date": 1523331928, "answer_id": 49744961, "question_id": 49742377, "link": "https://stackoverflow.com/questions/49742377/is-data-poe-a-empty-pair-a-a-a-monad/49744961#49744961", "title": "Is `data PoE a = Empty | Pair a a` a monad?", "body": "<p>(Posting this as a separate answer, as it has little overlap with my other one.)</p>\n\n<blockquote>\n  <p>The actual reason why I believe this to be a monad is that it is isomorphic to <code>Maybe (Pair a)</code> with <code>Pair a = P a a</code>. They are both monads, both traversables so their composition should form a monad, too. <a href=\"https://stackoverflow.com/q/42284879/2751851\">Oh, I just found out not always</a>.</p>\n</blockquote>\n\n<p>The conditions for the composition of monads <code>m</code>-over-<code>n</code> with <code>n</code> traversable are:</p>\n\n<pre><code>-- Using TypeApplications notation to make the layers easier to track.\nsequenceA @n @m . pure @n = fmap @m (pure @n)\nsequenceA @n @m . fmap @n (join @m)\n    = join @m . fmap @m (sequenceA @n @m) . sequenceA @n @m\nsequenceA @n @m . join @n\n    = fmap @m (join @n) . sequenceA @n @m . fmap @n (sequenceA @n @m)\n</code></pre>\n\n<p>(There is also <code>sequenceA @n @m . fmap @n (pure @m) = pure @m</code>, but that always holds.)</p>\n\n<p>In our case, we have <code>m ~ Maybe</code> and <code>n ~ Pair</code>. The relevant method definitions for <code>Pair</code> would be:</p>\n\n<pre><code>fmap f (P x y) = P (f x) (f y)\npure x = P x x\nP f g &lt;*&gt; P x y = P (f x) (g y)\njoin (P (P a00 a01) (P a10 a11)) = P a00 a11 -- Let's pretend join is a method.\nsequenceA (P x y) = P &lt;$&gt; x &lt;*&gt; y\n</code></pre>\n\n<p>Let's check the third property:</p>\n\n<pre><code>sequenceA @n @m . join @n\n    = fmap @m (join @n) . sequenceA @n @m . fmap @n (sequenceA @n @m)\n\n-- LHS\nsequenceA . join $ P (P a00 a01) (P a10 a11)\nsequenceA $ P a00 a11\nP &lt;$&gt; a00 &lt;*&gt; a11 -- Maybe (Pair a)\n\n-- RHS\nfmap join . sequenceA . fmap sequenceA $ P (P a00 a01) (P a10 a11)\nfmap join . sequenceA $ P (P &lt;$&gt; a00 &lt;*&gt; a01) (P &lt;$&gt; a10 &lt;*&gt; a11)\nfmap join $ P &lt;$&gt; (P &lt;$&gt; a00 &lt;*&gt; a01) &lt;*&gt; (P &lt;$&gt; a10 &lt;*&gt; a11)\nfmap join $ (\\x y z w -&gt; P (P x y) (P z w)) &lt;$&gt; a00 &lt;*&gt; a01 &lt;*&gt; a10 &lt;*&gt; a11\n(\\x _ _ w -&gt; P x w) &lt;$&gt; a00 &lt;*&gt; a01 &lt;*&gt; a10 &lt;*&gt; a11 -- Maybe (Pair a)\n</code></pre>\n\n<p>These are clearly not the same: while any <code>a</code> values will be drawn exclusively from <code>a00</code> and <code>a11</code>, the effects of <code>a01</code> and <code>a10</code> are ignored in the left-hand side, but not in the right-hand side (in other words, if <code>a01</code> or <code>a10</code> are <code>Nothing</code>, the RHS will be <code>Nothing</code>, but the LHS won't necessarily be so). The LHS corresponds exactly to the vanishing <code>Empty</code> in <a href=\"https://stackoverflow.com/a/49742857/2751851\">chi's answer</a>, and the RHS corresponds to the inner diagonal trimming described in <a href=\"https://stackoverflow.com/a/49743437/2751851\">my other answer</a>.</p>\n\n<hr>\n\n<p>P.S.: I forgot to show that the would-be instance we are talking about here is the same one being discussed in the question:</p>\n\n<pre><code>join' ::  m (n (m (n a))) -&gt; m (n a)\njoin' = fmap @m (join @n) . join @m . fmap @m (sequenceA @n @m)\n</code></pre>\n\n<p>With <code>m ~ Maybe</code> and <code>n ~ Pair</code>, we have:</p>\n\n<pre><code>join' :: Maybe (Pair (Maybe (Pair a))) -&gt; Maybe (Pair a)\njoin' = fmap @Maybe (join @Pair) . join @Maybe . fmap @Maybe (sequenceA @Pair @Maybe)\n</code></pre>\n\n<p><code>join @Maybe . fmap @Maybe (sequenceA @Pair @Maybe)</code> means the <code>join'</code> will result in <code>Nothing</code> unless there are no <code>Nothing</code>s anywhere:</p>\n\n<pre><code>join' = \\case\n    Just (P (Just (P a00 a01)) (Just (P a10 a11))) -&gt; _\n    _ -&gt; Nothing\n</code></pre>\n\n<p>Working out the non-<code>Nothing</code> case is straightforward:</p>\n\n<pre><code>fmap join . join . fmap sequenceA $ Just (P (Just (P a00 a01)) (Just (P a10 a11)))\nfmap join . join $ Just (Just (P (P a00 a01) (P a10 a11)))\nfmap join $ Just (P (P a00 a01) (P a10 a11))\nJust (P a00 a11)\n</code></pre>\n\n<p>Therefore...</p>\n\n<pre><code>join' = \\case\n    Just (P (Just (P a00 _)) (Just (P _ a11))) -&gt; Just (P a00 a11)\n    _ -&gt; Nothing\n</code></pre>\n\n<p>... which is essentially the same as:</p>\n\n<pre><code>join = \\case\n    Pair (Pair a00 _) (Pair _ a11) -&gt; Pair (a00 a11)\n    _ -&gt; Empty\n</code></pre>\n"}], "owner": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 649, "favorite_count": 3, "accepted_answer_id": 49742857, "answer_count": 5, "score": 14, "last_activity_date": 1524823448, "creation_date": 1523311509, "last_edit_date": 1524823448, "question_id": 49742377, "link": "https://stackoverflow.com/questions/49742377/is-data-poe-a-empty-pair-a-a-a-monad", "title": "Is `data PoE a = Empty | Pair a a` a monad?", "body": "<p>This question comes from this answer in\n<a href=\"https://stackoverflow.com/a/49703783/412549\">example of a functor that is Applicative but not a Monad</a>:\nIt is claimed that the</p>\n\n<pre><code>data PoE a = Empty | Pair a a deriving (Functor,Eq)\n</code></pre>\n\n<p>cannot have a monad instance, but I fail to see that with:</p>\n\n<pre><code>instance Applicative PoE where\n    pure x = Pair x x\n    Pair f g &lt;*&gt; Pair x y = Pair (f x) (g y)\n    _        &lt;*&gt; _        = Empty\ninstance Monad PoE where\n    Empty    &gt;&gt;= _ = Empty\n    Pair x y &gt;&gt;= f = case (f x, f y) of \n                       (Pair x' _,Pair _ y') -&gt; Pair x' y'\n                       _ -&gt; Empty\n</code></pre>\n\n<p>The actual reason why I believe this to be a monad is that it is isomorphic to <code>Maybe (Pair a)</code> with <code>Pair a = P a a</code>. They are both monads, both traversables so their composition should form a monad, too. <a href=\"https://stackoverflow.com/q/42284879/2751851\">Oh, I just found out not always</a>.</p>\n\n<p>Which counter-example failes which monad law? (and how to find that out systematically?)</p>\n\n<hr>\n\n<p><em>edit:</em> I did not expect such an interest in this question. Now I have to make up my mind if I accept the best example or the best answer to the \"systematically\" part.</p>\n\n<p>Meanwhile, I want to visualize how <code>join</code> works for the simpler <code>Pair a = P a a</code>:</p>\n\n<pre><code>                   P\n          ________/ \\________\n         /                   \\\n        P                     P\n       / \\                   / \\\n      1   2                 3   4\n</code></pre>\n\n<p>it always take the outer path, yielding <code>P 1 4</code>, more commonly known as a diagonal in a matrix representation. For monad associativy I need three dimensions, a tree visualization works better. Taken from chi's answer, this is the failing example for join, and how I can comprehend it.</p>\n\n<pre><code>                  Pair\n          _________/\\_________\n         /                    \\\n       Pair                   Pair\n        /\\                     /\\\n       /  \\                   /  \\\n    Pair  Empty           Empty  Pair\n     /\\                           /\\\n    1  2                         3  4\n</code></pre>\n\n<p>Now you do the <code>join . fmap join</code> by collapsing the lower levels first, for <code>join . join</code> collapse from the root.</p>\n"}, {"tags": ["haskell", "types", "functional-programming", "servant"], "comments": [{"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 6, "creation_date": 1523306405, "post_id": 49741312, "comment_id": 86497235, "body": "It comes from the <a href=\"https://hackage.haskell.org/package/natural-transformation\" rel=\"nofollow noreferrer\">natural-transformation</a> package."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 3, "creation_date": 1523307881, "post_id": 49741312, "comment_id": 86497894, "body": "Please see <a href=\"https://stackoverflow.com/tags/haskell/info\">stackoverflow.com/tags/haskell/info</a> <i>&quot;What is function foo / operator #$*?&quot;</i>"}], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 2, "last_activity_date": 1523731140, "creation_date": 1523731140, "answer_id": 49834908, "question_id": 49741312, "link": "https://stackoverflow.com/questions/49741312/what-does-the-operator-do-in-haskell/49834908#49834908", "title": "What does the :~&gt; operator do in haskell", "body": "<p>It's a <em>type operator</em>. If you look at the top of <a href=\"https://github.com/erewok/simpleservantblog/blob/fde476d3edf4e7e1172a42626119c0d480410f9c/src/Types.hs\" rel=\"nofollow noreferrer\">the file linked in the OP</a>, you'll see the following pragma among others:</p>\n\n<pre><code>{-# LANGUAGE TypeOperators #-}\n</code></pre>\n\n<p>This means that the language is no longer 'plain' Haskell, but rather Haskell with a few GHC-specific extensions, one of which is the <a href=\"https://ocharles.org.uk/blog/posts/2014-12-08-type-operators.html\" rel=\"nofollow noreferrer\">Type Operators extension</a>.</p>\n\n<p>This extension basically just enables you to use infix operators for type definitions, instead of being limited to alphanumerical type names.</p>\n\n<p>As Chris Martin points out in his comment, this particular type operator comes from the <a href=\"https://hackage.haskell.org/package/natural-transformation/docs/Control-Natural.html\" rel=\"nofollow noreferrer\">natural-transformation</a> package. It defines the <code>:~&gt;</code> operator as a natural transformation from one functor to another.</p>\n\n<p>You could have defined it as a normal <code>newtype</code> like this:</p>\n\n<pre><code>newtype NT f g x = NT (f x -&gt; g x)\n</code></pre>\n\n<p>Using a type operator, though, makes a function signature like</p>\n\n<pre><code>SimpleApp -&gt; SimpleHandler :~&gt; Handler\n</code></pre>\n\n<p>read more like a normal function than</p>\n\n<pre><code>SimpleApp -&gt; NT (SimpleHandler Handler)\n</code></pre>\n\n<p>As an example of a natural transformation, consider <code>listToMaybe</code> from <code>Data.Maybe</code>. This functionality is also sometimes called <code>safeHead</code>, but the point is that it's a translation from the <em>list</em> (<code>[]</code>) functor to the <code>Maybe</code> functor.</p>\n\n<p>You can 'promote' that to a natural transformation like this:</p>\n\n<pre><code>*Lib Lib Data.Maybe Control.Natural&gt; safeHeadNT = wrapNT listToMaybe\n*Lib Lib Data.Maybe Control.Natural&gt; :t safeHeadNT\nsafeHeadNT :: [] :~&gt; Maybe\n</code></pre>\n\n<p>Notice that the type of <code>safeHeadNT</code> is given as <code>[] :~&gt; Maybe</code>.</p>\n\n<p>You can unwrap it again if you want to call the function:</p>\n\n<pre><code>*Lib Lib Data.Maybe Control.Natural&gt; unwrapNT safeHeadNT [1,2,3]\nJust 1\n*Lib Lib Data.Maybe Control.Natural&gt; unwrapNT safeHeadNT []\nNothing\n</code></pre>\n\n<p>Another option is to use the package's built-in <code>#</code> infix operator:</p>\n\n<pre><code>*Lib Lib Data.Maybe Control.Natural&gt; safeHeadNT # []\nNothing\n*Lib Lib Data.Maybe Control.Natural&gt; safeHeadNT # [1,2,3]\nJust 1\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 5849758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b2d19317d44d403e6bd86ca413f5ad6?s=128&d=identicon&r=PG&f=1", "display_name": "scowan", "link": "https://stackoverflow.com/users/5849758/scowan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "accepted_answer_id": 49834908, "answer_count": 1, "score": 2, "last_activity_date": 1523731140, "creation_date": 1523306123, "question_id": 49741312, "link": "https://stackoverflow.com/questions/49741312/what-does-the-operator-do-in-haskell", "title": "What does the :~&gt; operator do in haskell", "body": "<p>I was looking through a github project that seems to be a website using haskell and elm. It uses the operator <code>:~&gt;</code> <a href=\"https://github.com/erewok/simpleservantblog/blob/master/src/Types.hs\" rel=\"nofollow noreferrer\">in a type signature in this file</a>. I can't find a definition for this operator. </p>\n\n<p>What does it do? Why would I use it? What is it called?</p>\n"}, {"tags": ["haskell", "recursion"], "answers": [{"tags": [], "owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "is_accepted": true, "score": 7, "last_activity_date": 1523310465, "last_edit_date": 1523310465, "creation_date": 1523306638, "answer_id": 49741419, "question_id": 49741305, "link": "https://stackoverflow.com/questions/49741305/how-to-pick-elements-in-even-index-and-odd-index/49741419#49741419", "title": "How to pick elements in even index and odd index?", "body": "<p>Yes you are right, using the <code>partition</code> function from <code>Data.List</code>. </p>\n\n<pre><code>Prelude Data.List&gt; (s, u) = partition (even . fst) (zip [0 .. ] \"ABCD\")\nPrelude Data.List&gt; (_, s2) = unzip s\nPrelude Data.List&gt; (_, u2) = unzip u\nPrelude Data.List&gt; (s2, u2)\n(\"AC\",\"BD\")\n</code></pre>\n\n<p>How I found this? Go to <a href=\"https://www.haskell.org/hoogle/\" rel=\"noreferrer\">Hoogle</a> and fill in <code>[a] -&gt; ([a], [a])</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 6367, "user_id": 6914441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbc12c764b93fa915b8e5384f521fe12?s=128&d=identicon&r=PG&f=1", "display_name": "jferard", "link": "https://stackoverflow.com/users/6914441/jferard"}, "is_accepted": false, "score": 1, "last_activity_date": 1523461712, "last_edit_date": 1523461712, "creation_date": 1523315125, "answer_id": 49742946, "question_id": 49741305, "link": "https://stackoverflow.com/questions/49741305/how-to-pick-elements-in-even-index-and-odd-index/49742946#49742946", "title": "How to pick elements in even index and odd index?", "body": "<p><strong>EDIT</strong>: Since @DanielWagner opened the door, if it's possible to return a list instead of a tuple, an obvious solution is:</p>\n\n<pre><code>[[x | (x,i)&lt;-zip xs [0..], i `mod` 2 == j] | j&lt;-[0..1]]\n</code></pre>\n\n<p>It may be generalized to:</p>\n\n<pre><code>[[x | (x,i)&lt;-zip xs [0..], i `mod` k == j] | j&lt;-[0..k-1]]\n</code></pre>\n\n<p>For k lists of elements [[e_0, e_k, e_2k, ...], [e_1, e_k+1, e_2k+1, ...], ..., [e_k-1, e_2k-1, e_3k-1,...]].</p>\n\n<p><em>For tuples, I leave for the record the previous code, though it's clearly worse than the other answers.</em></p>\n\n<p>It's easy to pick even elements with a list comprehension:</p>\n\n<pre><code>Prelude&gt; evens xs = [x | (x,i) &lt;- zip xs [0..], even i]\nPrelude&gt; evens [\"A\", \"B\", \"C\", \"D\", \"E\"]\n[\"A\",\"C\",\"E\"]\n</code></pre>\n\n<p>You can do the same with odd elements. But you can also define a function that takes a filter (<code>even</code> or <code>odd</code>) and returns a function that will select elements:</p>\n\n<pre><code>Prelude&gt; toFilter xs = \\f -&gt; [x | (x,i) &lt;- zip xs [0..], f i]\nPrelude&gt; :t toFilter [\"A\", \"B\", \"C\", \"D\", \"E\"]\ntoFilter [\"A\", \"B\", \"C\", \"D\", \"E\"]\n  :: (Num t, Enum t) =&gt; (t -&gt; Bool) -&gt; [[Char]]\n</code></pre>\n\n<p><code>toFilter xs</code> takes a filter and returns a list:</p>\n\n<pre><code>Prelude&gt; l = toFilter [\"A\", \"B\", \"C\", \"D\", \"E\"]\nPrelude&gt; l even\n[\"A\",\"C\",\"E\"]\nPrelude&gt; l odd\n[\"B\",\"D\"]\n</code></pre>\n\n<p>It's also possible two define a function that takes a function like <code>toFilter</code> (<code>(t -&gt; Bool) -&gt; [[Char]]</code>) and create a tuple for <code>even</code> and <code>odd</code> filter:</p>\n\n<pre><code>Prelude&gt; :t \\tf -&gt; (tf even, tf odd)\n\\tf -&gt; (tf even, tf odd) :: Integral a =&gt; ((a -&gt; Bool) -&gt; t) -&gt; (t, t)\n</code></pre>\n\n<p>Now, it becomes easy to put things together:</p>\n\n<pre><code>Prelude&gt; breakByIndexes xs = (\\tf -&gt; (tf even, tf odd)) (\\f -&gt; [x | (x,i)&lt;-zip xs [0..], f i])\nPrelude&gt; breakByIndexes [\"A\", \"B\", \"C\", \"D\"]\n([\"A\",\"C\"],[\"B\",\"D\"])\nPrelude&gt; breakByIndexes [\"A\", \"B\", \"C\", \"D\", \"E\"]\n([\"A\",\"C\",\"E\"],[\"B\",\"D\"])\n</code></pre>\n\n<p>Less elegant than @elemx80s, but does the job...</p>\n"}, {"comments": [{"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "edited": false, "score": 0, "creation_date": 1523320273, "post_id": 49743358, "comment_id": 86501903, "body": "Thanks Daniel! Your solution is very elegant, just that it requires additional module other than Data.List"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "edited": false, "score": 2, "creation_date": 1523320335, "post_id": 49743358, "comment_id": 86501914, "body": "@zhangchiqing Yep. Of course <code>chunksOf</code> can be implemented with just <code>Data.List</code> functions, but I think code reuse is nice, so I recommend getting familiar with the libraries available."}, {"owner": {"reputation": 6367, "user_id": 6914441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbc12c764b93fa915b8e5384f521fe12?s=128&d=identicon&r=PG&f=1", "display_name": "jferard", "link": "https://stackoverflow.com/users/6914441/jferard"}, "edited": false, "score": 0, "creation_date": 1523385853, "post_id": 49743358, "comment_id": 86536990, "body": "&quot;it naturally generalizes to other moduli than 2&quot; because you don&#39;t produce a tuple: <code>[[x | (x,i)&lt;-zip xs [0..], i `mod` n == j] | j&lt;-[0..n-1]]</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 6367, "user_id": 6914441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbc12c764b93fa915b8e5384f521fe12?s=128&d=identicon&r=PG&f=1", "display_name": "jferard", "link": "https://stackoverflow.com/users/6914441/jferard"}, "edited": false, "score": 1, "creation_date": 1523389477, "post_id": 49743358, "comment_id": 86538840, "body": "@jferard Yup, not producing a tuple is a key trick for using this technique. But the technique brings other benefits over your proposal; e.g. it makes O(1) passes over the input list, not O(n) (where n is the modulus) like yours, and is friendlier to the GC than yours."}, {"owner": {"reputation": 6367, "user_id": 6914441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbc12c764b93fa915b8e5384f521fe12?s=128&d=identicon&r=PG&f=1", "display_name": "jferard", "link": "https://stackoverflow.com/users/6914441/jferard"}, "edited": false, "score": 0, "creation_date": 1523394614, "post_id": 49743358, "comment_id": 86541354, "body": "@DanielWagner you are right: I&#39;m not trying to save my solution, which is probably the worst proposed here (though not so bad), but I had some difficulties to ouput a tuple instead of a list..."}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1523843210, "post_id": 49743358, "comment_id": 86711921, "body": "<code>chunksOf</code> can readily be implimented in Prelude.  <code>grpby n ls = [take n (drop x ls)|x&lt;-[0,n..length ls -1]]</code>"}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1523844274, "post_id": 49743358, "comment_id": 86712106, "body": "Or as <code>map</code> <code>grpby n ls=map ((take n).flip drop ls) [0,n..length ls -1]</code>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1523844712, "post_id": 49743358, "comment_id": 86712203, "body": "@fpmora Any implementation that calls <code>length</code> will not work well on infinite lists (and will be unfriendly to the GC)."}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1523846396, "post_id": 49743358, "comment_id": 86712536, "body": "Agree. I.really.despise.length anyway. It&#39;s always ugly, too. Recursive might well be better. The `length ls -1 can be removed, but ...."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 5, "last_activity_date": 1523318705, "creation_date": 1523318705, "answer_id": 49743358, "question_id": 49741305, "link": "https://stackoverflow.com/questions/49741305/how-to-pick-elements-in-even-index-and-odd-index/49743358#49743358", "title": "How to pick elements in even index and odd index?", "body": "<p>Here is another way. Unlike the others answers at the time of posting, it naturally generalizes to other moduli than 2.</p>\n\n<pre><code>Data.List Data.List.Split&gt; transpose . chunksOf 2 $ \"ABCDE\"\n[\"ACE\",\"BD\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "edited": false, "score": 1, "creation_date": 1523335754, "post_id": 49743871, "comment_id": 86505430, "body": "wow, cool. can you explain how it works? looks very magically. what does <code>~</code> do?"}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "reply_to_user": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "edited": false, "score": 0, "creation_date": 1523352249, "post_id": 49743871, "comment_id": 86514298, "body": "@zhangchiqing You could try running it by hand on a small example to see what happens. The key thing here is that in the pattern <code>(ys, zs)</code> and the return value <code>(x:zs, ys)</code> the lists <code>ys</code> and <code>zs</code> have switched places. Which means that if <code>ys</code> gets the current value then <code>zs</code> will get the next, then <code>ys</code> again, etc., etc."}, {"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "edited": false, "score": 0, "creation_date": 1523405807, "post_id": 49743871, "comment_id": 86544690, "body": "Thinking a bit. I actually like your solution better now. Because this solution can be extended to break a list into 3-tuples, or more. like this <code>take 10 $ fst3 $ foldr (\\x xs -&gt; (x:trd3 xs, fst3 xs, snd3 xs)) ([], [], []) [1..]</code>  whereas, the <code>partition</code> solution is easier to understand, it can only work for breaking into a pair of two lists"}], "tags": [], "owner": {"reputation": 8556, "user_id": 4892417, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NaBTj.jpg?s=128&g=1", "display_name": "oisdk", "link": "https://stackoverflow.com/users/4892417/oisdk"}, "is_accepted": false, "score": 6, "last_activity_date": 1523370622, "last_edit_date": 1523370622, "creation_date": 1523323321, "answer_id": 49743871, "question_id": 49741305, "link": "https://stackoverflow.com/questions/49741305/how-to-pick-elements-in-even-index-and-odd-index/49743871#49743871", "title": "How to pick elements in even index and odd index?", "body": "<p>My favourite version of this function uses <code>foldr</code></p>\n\n<pre><code>pairs = foldr (\\x ~(ys,zs) -&gt; (x:zs,ys)) ([],[])\n</code></pre>\n\n<p>It works by swapping the tuple around on each item in the list. Inside the closure:</p>\n\n<pre><code>\\x ~(odds,evens) -&gt; (x:evens, odds)\n</code></pre>\n\n<p>You add on the <code>x</code>, which means that all of the rest of the elements in the evens list now <em>become</em> the odd-numbered elements.</p>\n\n<p>What's the <code>~</code> for? It makes the pattern-match <em>lazy</em>. Without it, you'll force the tuple. So, for instance, if I wrote:</p>\n\n<pre><code>(head . fst . pairs) [1..]\n</code></pre>\n\n<p>It would not work without the <code>~</code>. You could achieve the same effect by writing:</p>\n\n<pre><code>pairs = foldr (\\x yszs -&gt; (x:snd yszs,fst yszs)) ([],[])\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>pairs = foldr (\\x -&gt; uncurry (\\ys zs -&gt; (x:zs,ys))) ([],[])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": 0, "last_activity_date": 1523843597, "last_edit_date": 1523843597, "creation_date": 1523372497, "answer_id": 49756991, "question_id": 49741305, "link": "https://stackoverflow.com/questions/49741305/how-to-pick-elements-in-even-index-and-odd-index/49756991#49756991", "title": "How to pick elements in even index and odd index?", "body": "<p>Just remember that ASCII characters have a built in index offset by 65.</p>\n\n<p>import Data.Char (ord)</p>\n\n<p><code>ord 'A' - 65</code> = 0`</p>\n\n<p>Without the offset, the numeric values are even and odd anyway. 'A' is 65, odd.</p>\n\n<pre><code>p l = [ [x|x&lt;-l,odd (ord(head x))], [x|x&lt;-l,even (ord(head x))] ]\n</code></pre>\n\n<p>I do love pairs. Once a data set is in pairs it becomes much easier to work with. I came across a function that creates the perfect pairs for this set, it leaves unpaired elements at the end but in the list. It does not create tuples but list pairs are okay, too. The function is chunksOf.</p>\n\n<p>Here it is used as</p>\n\n<pre><code>i3 = chunksOf 2 $ words \"A B C D E F G H I\"\n</code></pre>\n\n<p>To produce the pairs we want. <code>[[\"A\",\"B\"],[\"C\",\"D\"],[\"E\",\"F\"],[\"G\",\"H\"],[\"I\"]]</code></p>\n\n<p>Pairs are even-odd pairs. The odd one at the end is really lacking an odd member. All odd elements of the list are missing the odd member. The odd member extractor has to compensate with filter of pairs with less than two members.</p>\n\n<pre><code>[ map (head) l3,   map (last) (filter ((&gt;1).length) l3) ]\n</code></pre>\n\n<p>Produces <code>[[\"A\",\"C\",\"E\",\"G\",\"I\"],[\"B\",\"D\",\"F\",\"H\"]]</code>\nPairs carry information, such as even or odd.</p>\n\n<p>And to my shock and awe @DanielWagner points out that <code>transpose</code> produces the desired results with the pair list. His is <code>transpose i3</code> for an incredibly even more concise solution. Wow!</p>\n\n<p><strong>Edit 4/15/2018</strong></p>\n\n<p>I do hope this is final or near final.</p>\n\n<pre><code>let ls = words \"A B C D E F G\"\n[[a|(a,b)&lt;-zip ls [0..],bl b]|bl&lt;-[even,odd]]\n</code></pre>\n\n<p>[[\"A\",\"C\",\"E\",\"G\"],[\"B\",\"D\",\"F\"]]</p>\n"}], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2111, "favorite_count": 1, "accepted_answer_id": 49741419, "answer_count": 5, "score": 6, "last_activity_date": 1523843597, "creation_date": 1523306098, "last_edit_date": 1523306470, "question_id": 49741305, "link": "https://stackoverflow.com/questions/49741305/how-to-pick-elements-in-even-index-and-odd-index", "title": "How to pick elements in even index and odd index?", "body": "<p>I have a list, I want to break the list into two, one with elements in the even indexes, and the other from the odd indexes.</p>\n\n<p><code>breakByIndexes :: [a] -&gt; ([a], [a])</code></p>\n\n<p>For example:</p>\n\n<pre><code>&gt; breakByIndexes [\"A\", \"B\", \"C\", \"D\"]\n([\"A\", \"C\"], [\"B\", \"D\"]\n\n&gt; breakByIndexes [\"A\", \"B\", \"C\", \"D\", \"E\"]\n([\"A\", \"C\", \"E\"], [\"B\", \"D\"]\n</code></pre>\n\n<p>I got a solution like this</p>\n\n<pre><code>breakByIndexes [] = ([], [])\nbreakByIndexes [e] = ([e], [])\nbreakByIndexes (e:o:xs) =\n  let (es, os) = breakByIndexes xs\n   in (e : es, o : os)\n</code></pre>\n\n<p>But I'm curious is it possible to implement without using recursion? \nAnd is it possible to implement by composing existing functions from <code>Data.List</code>?</p>\n"}, {"tags": ["c++", "c", "haskell", "cmake", "haskell-stack"], "owner": {"reputation": 579, "user_id": 2273107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sq2Mk.png?s=128&g=1", "display_name": "Karolis Ryselis", "link": "https://stackoverflow.com/users/2273107/karolis-ryselis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 2, "answer_count": 0, "score": 2, "last_activity_date": 1523300398, "creation_date": 1523300398, "question_id": 49739886, "link": "https://stackoverflow.com/questions/49739886/how-to-create-a-static-library-with-cmake-and-link-it-with-a-haskell-stack-proje", "title": "How to create a static library with CMake and link it with a Haskell Stack project", "body": "<p>I want to use a third party C++ library in my Haskell project. However, I get the following error while running <code>stack build</code>:</p>\n\n<pre><code>/home/ryselis/IdeaProjects/realsense-haskell/.stack-work/dist/x86_64-linux/Cabal-2.0.1.0/build/libHSrealsense-haskell-0.1.0.0-AnzRMqdjClnDgHnOUGe4TP.a(Realsense.o):ghc_16.c:function inline_c_Realsense_6: error: undefined reference to 'autoConfigurePersonTracking'\ncollect2: error: ld returned 1 exit status\n`gcc' failed in phase `Linker'. (Exit code: 1)\n--  While building custom Setup.hs for package realsense-haskell-0.1.0.0 using:\n  /home/ryselis/.stack/setup-exe-cache/x86_64-linux/Cabal-simple_mPHDZzAJ_2.0.1.0_ghc-8.2.2 --builddir=.stack-work/dist/x86_64-linux/Cabal-2.0.1.0 build lib:realsense-haskell exe:realsense-haskell-exe --ghc-options \" -ddump-hi -ddump-to-file\"\nProcess exited with code: ExitFailure 1\n</code></pre>\n\n<p>The third-party library I'm using is <code>librealsense</code>. As Haskell integration with C++ is hard, I have decided to make C wrapper for this library. As a minimal example, I have tried this: I have created a CMake project. Header file excluding compiler directives looks like this:</p>\n\n<pre><code>extern \"C\" {\n    void autoConfigurePersonTracking();\n};\n</code></pre>\n\n<p>.cpp file contains includes to <code>librealsense</code> and defines the function <code>autoConfigurePersonTracking</code>.</p>\n\n<p>In my Haskell project my stack <code>package.yaml</code> contains this section:</p>\n\n<pre><code>executables:\n  realsense-haskell-exe:\n    main:                Main.hs\n    source-dirs:         app\n    ghc-options:\n    - -threaded\n    - -rtsopts\n    - -with-rtsopts=-N\n    dependencies:\n    - realsense-haskell\n    extra-include-dirs:\n    - /home/ryselis/CLionProjects/realsense_c_wrapper/\n    extra-lib-dirs:\n    - /usr/local/lib/\n    - /home/ryselis/CLionProjects/realsense_c_wrapper/\n    extra-libraries:\n    - realsense\n    - realsense_c_wrapper\n</code></pre>\n\n<p><code>realsense_c_wrapper</code> is the name of my static C wrapper. In my Haskell code I use <code>inline-c-cpp</code> library and have this function defined:</p>\n\n<pre><code>autoConfigurePersonTracking :: IO ()\nautoConfigurePersonTracking = [C.block| void {\n  autoConfigurePersonTracking();\n}|]\n</code></pre>\n\n<p>However, linked fails with the exception given above.</p>\n\n<p>My static library's header is located at <code>/home/ryselis/CLionProjects/realsense_c_wrapper/</code> and library itself is at <code>/usr/local/lib/librealsense_c_wrapper.a</code>. <code>librealsense</code> is located in the same directory and links just fine.</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1523300342, "post_id": 49739685, "comment_id": 86494162, "body": "<code>let</code> is not assignment. You are trying to program imperatively using a purely functional programming language. I&#39;d recommend you start from a Haskell tutorial. Do not attempt to translate from another language, especially from a non functional one. (This goes both ways: do not attempt to translate Haskell into imperative programming languages)"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1523301773, "creation_date": 1523301773, "answer_id": 49740202, "question_id": 49739685, "link": "https://stackoverflow.com/questions/49739685/haskell-values-do-not-save-after-a-form-loop/49740202#49740202", "title": "Haskell - Values do not save after a ForM loop", "body": "<p><code>forM</code> returns a list of values, one each per input element in the list it's handed, with whatever you compute in the body of the function you give to <code>forM</code>. So you can extract information from the loop body with the usual <code>do</code>-notation binding syntax. Here's a simple example that asks the user whether to double each number in a list:</p>\n\n<pre><code>import Control.Monad\nvals = [1..5]\nmain = do\n    vals' &lt;- forM vals $ \\val -&gt; do\n        v &lt;- getLine\n        return (if v == \"yes\" then val*2 else val)\n    print vals'\n</code></pre>\n\n<p>An example of running it:</p>\n\n<pre><code>&gt; main\nyes\nyes\nno\nno\nyes\n[2,4,3,4,10]\n</code></pre>\n\n<p>Though this example returned numbers for simplicity, you may return arbitrary information of interest from each loop iteration in this way.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 8678219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/861f19a488a27405873e21f43821b013?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/8678219/greg"}, "edited": false, "score": 0, "creation_date": 1523311057, "post_id": 49741445, "comment_id": 86499244, "body": "Thank you so much for the reply. I think I was quite unclear with the exercise, and instead of only finding the longest increasing subsequence, Instead of finding one increasing subsequence, we will find multiple increasing subsequences with the following two constraints: - The length of each subsequence should be at least of a given size k. - If a subsequence starts at index i and ends at index j, no other subsequence can start or end in the range i to j (inclusive), i.e., no other subsequence can have any elements in between index i and j (inclusive), i.e., the subsequences cannot overlap"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1523306792, "creation_date": 1523306792, "answer_id": 49741445, "question_id": 49739685, "link": "https://stackoverflow.com/questions/49739685/haskell-values-do-not-save-after-a-form-loop/49741445#49741445", "title": "Haskell - Values do not save after a ForM loop", "body": "<p>In my other answer, I discussed the answer to the question you asked about how to store information for retrieval later when in a <code>forM</code> loop. In this answer, I will discuss the idiomatic translation of <code>for</code> loops from other languages; generally this is <em>not</em> to produce a <code>forM</code> loop in Haskell.</p>\n\n<p>Because this is an excellent programming exercise, I don't want to give away the answer -- there's a lot of joy and learning to be had from solving the problem yourself. But I do want to illustrate an alternative approach. To keep all the interesting bits of the translation I cooked up of your Python code, I will solve a slightly easier problem in a slightly stylized way: instead of <code>lis[i][j]</code> giving the length of the longest increasing subsequence between indices <code>i</code> and <code>j</code> in the original list, we will have <code>lis[i][j]</code> give the largest value between indices <code>i</code> and <code>j</code> in the original list.</p>\n\n<p>The idea will go like this: instead of iterating over indices <code>i</code> and <code>j</code>, we'll iterate over suffixes starting at <code>i</code>, then over prefixes of suffixes starting at <code>i</code> and ending at <code>j</code>. To begin with, we'll do the naive thing of just calling <code>maximum</code> on each infix expression. So:</p>\n\n<pre><code>import Data.List\n\nmaxes0 a =\n    [ [ maximum inf\n      | inf &lt;- tail (inits suff)\n      ]\n    | suff &lt;- init (tails a)\n    ]\n</code></pre>\n\n<p>For example, we can try it on your example list in ghci:</p>\n\n<pre><code>&gt; maxes0 [1,2,9,6,8]\n[[1,2,9,9,9],[2,9,9,9],[9,9,9],[6,8],[8]]\n</code></pre>\n\n<p>Note right away that there's a difference in shape here: where in Python we produced a square result, here we produce a triangular one, omitting the useless entries that do not correspond to actual infix chunks of the original list. (It's easy to reintroduce dummy values if you actually need a square result for some reason.)</p>\n\n<p>This is already pretty good, and quite idiomatic; however, there is one part of the Python code that it does not capture well yet: the Python code reuses previously computed values to do some dynamic programming. This can be done to the above code, as well, though it does require a bit of mental gymnastics the first few times you see it. We will use laziness and recursion to make available earlier results when computing later ones.</p>\n\n<p>The idea here will be to keep a rolling max as we traverse the suffix, merging as we go the list of maximums of infixes with the new values we see in the suffix. So:</p>\n\n<pre><code>maxes1 a =\n    [ let row = head suff : zipWith max row (tail suff)\n      in row\n    | suff &lt;- init (tails a)\n    ]\n</code></pre>\n\n<p>We can see in ghci that this works just the same:</p>\n\n<pre><code>&gt; maxes1 [1,2,9,6,8]\n[[1,2,9,9,9],[2,9,9,9],[9,9,9],[6,8],[8]]\n</code></pre>\n\n<p>You can combine these two ideas (making the already-computed bits available via laziness+recursion, and making the infix list available by nested list comprehensions) to produce an idiomatic translation of the Python code which is completely pure, does not mention list indices anywhere, and does not use <code>forM</code>.</p>\n"}], "owner": {"reputation": 23, "user_id": 8678219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/861f19a488a27405873e21f43821b013?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/8678219/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1523306792, "creation_date": 1523299607, "question_id": 49739685, "link": "https://stackoverflow.com/questions/49739685/haskell-values-do-not-save-after-a-form-loop", "title": "Haskell - Values do not save after a ForM loop", "body": "<p>I want to be able to create a program in haskell that can an find an increasing subsequence from a list of numbers (not yet completed, this part is to compute for each sublist what the longest increasing subsequence is within that sublist). This program essentially take take from an input such as</p>\n\n<pre><code>1\n5\n1 2 9 6 8\n</code></pre>\n\n<p>where the first line is the number of test cases and the second line being the number of numbers in the specific test case, and the third line being the test case itself. It is looking for the multiple increasing sequences within the test case. Here is what I have so far:    </p>\n\n<pre><code>main = do   \n    inputCases &lt;- getLine\n    let cases = (read inputCases :: Int)\n    forM [1..cases] $ \\num -&gt; do\n        inputNumbers &lt;- getLine\n        let numbers = (read inputNumbers :: Int)  \n        something &lt;- getLine\n        let singlewords = words something\n            list = f singlewords\n        let hello = grid numbers numbers 0\n        let second  = hello\n        print list\n        forM [0..numbers] $ \\check -&gt; do\n            forM [check..numbers] $ \\check2 -&gt; do\n                let val = 1\n                let keeper = val\n                forM [check..check2] $ \\check3 -&gt; do\n                    let val = getVal hello list keeper check check2 check3\n                    let keeper = val\n                    return()\n                print check\n                print check2\n                print val\n                let hello = updateMatrix second val (check, check2)\n                let second = hello\n\n\nf :: [String] -&gt; [Int]\nf = map read\n\ngrid :: Int -&gt; Int -&gt; a -&gt; [[a]]\ngrid x y = replicate y . replicate x\n\ngetVal :: [[Int]] -&gt; [Int] -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int\ngetVal m b second x y z = \n    if b!!z &lt; b!!y &amp;&amp; 1+m!!x!!z &gt; second then 1+m!!x!!z\n    else second\n\nupdateMatrix :: [[a]] -&gt; a -&gt; (Int, Int) -&gt; [[a]]\nupdateMatrix m x (r,c) =\n  take r m ++\n  [take c (m !! r) ++ [x] ++ drop (c + 1) (m !! r)] ++\n  drop (r + 1) m\n</code></pre>\n\n<p>However, my problem is that once the program exits the ForM loop, it does not save the variable \"hello\" or anything that was declared in the for loop. Is there a better way of doing this? Would recursion work in this case? I am not quite sure how that would be implemented\nlis[i][j] will hold the length of the longest increasing subsequence in {a[i], ..., a[j]}</p>\n\n<p>here is the python code that I am trying to translate. Given this code, is there a better way of doing this besides the way I am currently trying to do it?</p>\n\n<pre><code>T = int(input())\nfor t in range(0, T):\n\n    n = int(input())\n    a = list(map(int, input().split()))\n\n    lis = [[0 for j in range(0, n)] for i in range(0, n)]\n\n    for i in range(0, n):\n        for j in range(i, n):\n            val = 1\n            for k in range(i, j):\n                if(a[k] &lt; a[j] and 1 + lis[i][k] &gt; val):\n                    val = 1 + lis[i][k]\n            lis[i][j] = val\n</code></pre>\n"}, {"tags": ["haskell", "quickcheck"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 6, "last_activity_date": 1523293981, "creation_date": 1523293981, "answer_id": 49738224, "question_id": 49738163, "link": "https://stackoverflow.com/questions/49738163/how-to-generate-specific-random-string-in-quickcheck/49738224#49738224", "title": "How to generate specific random string in QuickCheck?", "body": "<p>Let your property take a list of booleans and convert them to cs and ss.</p>\n\n<pre><code>prop_CountersEqual :: [Bool] -&gt; Bool\nprop_CountersEqual bs = countCAndS css == countCAndS' css where\n    css = map (\\b -&gt; if b then 'C' else 'S') bs\n</code></pre>\n\n<p>If you need this frequently, you may want to define a new type with a suitable <code>Arbitrary</code> instance.</p>\n\n<pre><code>newtype CAndS = CAndS String\ninstance Arbitrary CAndS where\n    arbitrary = CAndS . map (\\b -&gt; if b then 'C' else 'S') &lt;$&gt; arbitrary\n</code></pre>\n\n<p>Then you can write your properties as e.g.</p>\n\n<pre><code>prop_CountersEqual' :: CAndS -&gt; Bool\nprop_CountersEqual' (CAndS css) = countCAndS css == countCAndS' css\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "edited": false, "score": 0, "creation_date": 1523306382, "post_id": 49738937, "comment_id": 86497226, "body": "Thanks. I like your solution better. Feels very elegant, and it has the minimum knowledge required to understand how it works."}], "tags": [], "owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "is_accepted": true, "score": 2, "last_activity_date": 1523296708, "creation_date": 1523296708, "answer_id": 49738937, "question_id": 49738163, "link": "https://stackoverflow.com/questions/49738163/how-to-generate-specific-random-string-in-quickcheck/49738937#49738937", "title": "How to generate specific random string in QuickCheck?", "body": "<p>QuickCheck provides a flurry of combinators for that, it's super easy and very elegant:</p>\n\n<pre><code>prop_CountersEqual = \n  forAll csString $ \\s -&gt; countCAndS s == countCAndS' s\n\ncsString :: Gen String\ncsString = listOf $ elements \"CS\"\n</code></pre>\n\n<p>It's also trivial to expand your dictionary, should you need it.</p>\n"}, {"tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 0, "last_activity_date": 1523298281, "last_edit_date": 1523298281, "creation_date": 1523297219, "answer_id": 49739077, "question_id": 49738163, "link": "https://stackoverflow.com/questions/49738163/how-to-generate-specific-random-string-in-quickcheck/49739077#49739077", "title": "How to generate specific random string in QuickCheck?", "body": "<p>Here's another way to define the Arbitrary instance:</p>\n\n<pre><code>newtype CAndS = CAndS String\ninstance Arbitrary CAndS where\n  arbitrary = CAndS &lt;$&gt; listOf (elements \"CS\")\n</code></pre>\n\n<p>Besides testing a function against a reference solution, you could test that the sum of <code>'C'</code>s and <code>'S'</code>es is the same as the length of the string:</p>\n\n<pre><code>prop_CountersAddUp :: CAndS -&gt; Bool\nprop_CountersAddUp (CAndS css) = length css == cs + ss\n  where (cs, ss) = countCAndS css\n</code></pre>\n\n<p>If the string is supposed to accept input that has characters other than <code>'C'</code>s and <code>'S'</code>es (but not count them), you should perhaps create a generator that generates all kinds of characters, but with a higher probability of <code>'C'</code> and <code>'S'</code>:</p>\n\n<pre><code>newtype CAndS = CAndS String\ninstance Arbitrary CAndS where\n  arbitrary = CAndS &lt;$&gt; listOf (frequency [ (1, return 'C')\n                                          , (1, return 'S')\n                                          , (2, arbitrary) ])\n</code></pre>\n\n<p>Or you might generate a string that is annotated with the right answer:</p>\n\n<pre><code>newtype CAndS = CAndS (String, Int, Int)\ninstance Arbitrary CAndS where\n    arbitrary = CAndS &lt;$&gt; sized (\\n -&gt; do\n      cs &lt;- choose (0, n)\n      let ss = n - cs\n      css &lt;- shuffle (replicate cs 'C' ++ replicate ss 'S')\n      return (css, cs, ss))\n</code></pre>\n\n<p>So you can test it:</p>\n\n<pre><code>prop_CountersEqual :: CAndS -&gt; Bool\nprop_CountersEqual (CAndS (css, cs, ss)) = cs == cs' &amp;&amp; ss == ss'\n  where (cs', ss') = countCAndS css\n</code></pre>\n"}], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 735, "favorite_count": 2, "accepted_answer_id": 49738937, "answer_count": 3, "score": 4, "last_activity_date": 1568026900, "creation_date": 1523293757, "last_edit_date": 1568026900, "question_id": 49738163, "link": "https://stackoverflow.com/questions/49738163/how-to-generate-specific-random-string-in-quickcheck", "title": "How to generate specific random string in QuickCheck?", "body": "<p>In Haskell's QuickCheck, how to generate a string such that it contains only the characters \u2018S\u2019 and \u2018C\u2019, and the position of \u2018S\u2019 and \u2018C\u2019 is random?</p>\n\n<p>For example: \"SCCS\", \"SSSS\", \"CCCC\", \"CSSCCS\", \"\"</p>\n\n<p>My use case is this:</p>\n\n<p>I have two functions <code>countCAndS :: String -&gt; (Int, Int)</code> and <code>countCAndS' :: String -&gt; (Int, Int)</code>. They have the same type signature. I'd like to write a QuickCheck property such that I can pass the same string to these two different functions and check if the outputs are the same.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523277514, "post_id": 49733162, "comment_id": 86479965, "body": "It is not really clear to me what you are looking for, what do you mean with &quot;<i>Can I directly access the value of Size, whilst carrying through the pre-existing value of Color?</i>&quot;."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1523277842, "post_id": 49733162, "comment_id": 86480198, "body": "<code>Size</code> is not an sum type consisting of the three nullary constructors <code>Small</code>, <code>Medium</code>, and <code>Large</code>; it&#39;s a type with a single constructor that expects arguments of type <code>Medium</code> and <code>Large</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1523277939, "post_id": 49733162, "comment_id": 86480275, "body": "I&#39;m not entirely sure what you intend with <code>e.Color Small</code>. Haskell doesn&#39;t have attributes, and <code>Color </code> isn&#39;t a field or component of a value of type <code>Example</code>, it&#39;s just the constructor."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523277941, "post_id": 49733162, "comment_id": 86480276, "body": "Indeed, probably the OP wanted to write <code>data Color = Red | Green | Blue</code>, etc."}, {"owner": {"reputation": 1, "user_id": 9619339, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ira Skye", "link": "https://stackoverflow.com/users/9619339/ira-skye"}, "edited": false, "score": 0, "creation_date": 1523277957, "post_id": 49733162, "comment_id": 86480288, "body": "useExample takes a Example and a String and based on the value of the string it returns Example using the original colour and the matched Size. What I know know how to do is keep the Color to be reused with the matched Size. Does that make sense?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1523277973, "post_id": 49733162, "comment_id": 86480300, "body": "See also <a href=\"https://stackoverflow.com/q/5767129/791604\">this question</a> for a more modern discussion of lens library offerings."}, {"owner": {"reputation": 1, "user_id": 9619339, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ira Skye", "link": "https://stackoverflow.com/users/9619339/ira-skye"}, "edited": false, "score": 0, "creation_date": 1523278058, "post_id": 49733162, "comment_id": 86480362, "body": "I don&#39;t mean &quot;data Color = Red | Green | Blue&quot;. I need to access directly."}, {"owner": {"reputation": 2885, "user_id": 2462437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83d2b5873df1156f07a07814e3721d02?s=128&d=identicon&r=PG", "display_name": "Daniel McLaury", "link": "https://stackoverflow.com/users/2462437/daniel-mclaury"}, "edited": false, "score": 0, "creation_date": 1523278180, "post_id": 49733162, "comment_id": 86480463, "body": "Say you have a type with lots of fields, and a value of this type. He wants to know if it&#39;s easy to create another value of this type with all but one field the same, without resorting to writing out all the fields."}], "owner": {"reputation": 1, "user_id": 9619339, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ira Skye", "link": "https://stackoverflow.com/users/9619339/ira-skye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "closed_date": 1523277904, "answer_count": 0, "score": 0, "last_activity_date": 1523278256, "creation_date": 1523277448, "last_edit_date": 1523278242, "question_id": 49733162, "link": "https://stackoverflow.com/questions/49733162/haskell-extract-value-from-data-constructor", "closed_reason": "Duplicate", "title": "haskell extract value from data constructor", "body": "<p>I'd like to do know the simplest method for adjusting a single stored value whilst hanging on to the pre existing other value. Can I directly access the value of Size, whilst carrying through the pre-existing value of Color?</p>\n\n<pre><code>data Example = Color Size\n  deriving (Show)\n\ndata Color = C Red Green Blue\n  deriving (Show)\n\ndata Size = S Small Medium Large\n  deriving (Show)\n\nuseExample :: Example -&gt; String -&gt; Example\nuseExample e s = \n  case s of\n    \"S\" -&gt; e.Color Small\n    \"M\" -&gt; e.Color Medium\n    \"L\" -&gt; e.Color Large\n</code></pre>\n\n<p>Say I have a type with lots of fields, and a value of this type. Is it possible to create another value of this type with all but one field the same, without resorting to writing out all the fields.</p>\n\n<p>This becomes critical when there are many scenarios to consider, the project I'm working on has many more than there are in this example. </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 798, "user_id": 9223023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RTmMa.png?s=128&g=1", "display_name": "Petras Purlys", "link": "https://stackoverflow.com/users/9223023/petras-purlys"}, "edited": false, "score": 0, "creation_date": 1523279730, "post_id": 49733848, "comment_id": 86481600, "body": "That would work but this is a matter of readability. NumCol and NumberColumn are/represent the same thing so I would very much like to have a single name."}, {"owner": {"reputation": 1212, "user_id": 2455145, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kazBZ.jpg?s=128&g=1", "display_name": "AlexJ136", "link": "https://stackoverflow.com/users/2455145/alexj136"}, "reply_to_user": {"reputation": 798, "user_id": 9223023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RTmMa.png?s=128&g=1", "display_name": "Petras Purlys", "link": "https://stackoverflow.com/users/9223023/petras-purlys"}, "edited": false, "score": 0, "creation_date": 1523280695, "post_id": 49733848, "comment_id": 86482252, "body": "@PetrasPurlys There is likely no free lunch there. You can, however, make <code>NumCol</code> and <code>NumberColumn</code> behave similarly, see my edit. Another option is to define <code>sumColumn</code> over pairs <code>(String, [Double])</code>, but this also has its downsides."}], "tags": [], "owner": {"reputation": 1212, "user_id": 2455145, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kazBZ.jpg?s=128&g=1", "display_name": "AlexJ136", "link": "https://stackoverflow.com/users/2455145/alexj136"}, "is_accepted": false, "score": 0, "last_activity_date": 1523280595, "last_edit_date": 1523280595, "creation_date": 1523279535, "answer_id": 49733848, "question_id": 49732645, "link": "https://stackoverflow.com/questions/49732645/constructors-as-datatypes-in-haskell/49733848#49733848", "title": "Constructors as datatypes in Haskell", "body": "<p>You could factor the <code>NumberColumn</code> constructor's data into a new datatype thusly:</p>\n\n<pre><code>data Column\n    = NumberColumn  NumCol\n    | StringColumn  String [String]\n    | UnknownColumn String [String]\n\ndata NumCol = NumCol String [Double]\n</code></pre>\n\n<p><code>sumColumn</code> is then defined over <code>NumCol</code>s only, rather than <code>Column</code>s or <code>NumberColumn</code>s:</p>\n\n<pre><code>sumColumn :: NumCol -&gt; NumCol -&gt; NumCol\nsumColumn (NumCol s1 d1) (NumCol s2 d2) = ...\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>If you want <code>NumCol</code>s to behave like <code>NumberColumn</code>s, you could use a type class:</p>\n\n<pre><code>class Columnlike a where\n    toColumn :: a -&gt; Column\n\ninstance Columnlike Column where\n    toColumn = id\n\ninstance Columnlike NumCol where\n    toColumn = NumberColumn\n</code></pre>\n\n<p>With this type class at hand, your functions over <code>Column</code> can now be over some <code>Columnlike a</code>, and you can use <code>NumCol</code>s and <code>Column</code>s interchangeably. For example:</p>\n\n<pre><code>colFunction :: Column -&gt; Column\ncolFunction = ...\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>colFunction :: Columnlike a =&gt; a -&gt; a\ncolFunction = ...\n</code></pre>\n\n<p>and you can then use <code>colFunction</code> on <code>NumCol</code>s and <code>NumberColumn</code>s alike.</p>\n"}, {"comments": [{"owner": {"reputation": 798, "user_id": 9223023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RTmMa.png?s=128&g=1", "display_name": "Petras Purlys", "link": "https://stackoverflow.com/users/9223023/petras-purlys"}, "edited": false, "score": 0, "creation_date": 1523282616, "post_id": 49734112, "comment_id": 86483571, "body": "I&#39;m sorry if I&#39;m missing something but how would this allow me to keep a list of different Columns?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 798, "user_id": 9223023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RTmMa.png?s=128&g=1", "display_name": "Petras Purlys", "link": "https://stackoverflow.com/users/9223023/petras-purlys"}, "edited": false, "score": 0, "creation_date": 1523283950, "post_id": 49734112, "comment_id": 86484431, "body": "It wasn&#39;t obvious from the question that was a requirement."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 798, "user_id": 9223023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RTmMa.png?s=128&g=1", "display_name": "Petras Purlys", "link": "https://stackoverflow.com/users/9223023/petras-purlys"}, "edited": false, "score": 2, "creation_date": 1523285092, "post_id": 49734112, "comment_id": 86485212, "body": "@PetrasPurlys Unfortunately those two features are incompatible: either the type system distinguishes the two things, so you can write a function which only accepts number columns, OR the type system does not distinguish the two things, so you can put them both in a list. If you want both features, you need two (collections of) types, one distinguishable and one not."}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "reply_to_user": {"reputation": 798, "user_id": 9223023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RTmMa.png?s=128&g=1", "display_name": "Petras Purlys", "link": "https://stackoverflow.com/users/9223023/petras-purlys"}, "edited": false, "score": 0, "creation_date": 1523285975, "post_id": 49734112, "comment_id": 86485882, "body": "@PetrasPurlys You can move the <code>a</code> to the right and get back the power you wanted. <code>data Column = forall a. ToColumn a =&gt; Column a</code> (but then you&#39;ll lose and trace of <code>a</code> in type signatures)"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1523280288, "creation_date": 1523280288, "answer_id": 49734112, "question_id": 49732645, "link": "https://stackoverflow.com/questions/49732645/constructors-as-datatypes-in-haskell/49734112#49734112", "title": "Constructors as datatypes in Haskell", "body": "<p>It seems like you want a single type constructor <code>Column</code> defined as</p>\n\n<pre><code>data Column a = Column String [a]\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>sumColumn :: Column Double -&gt; Column Double -&gt; Column Double\nsumColumn (Column name values) = ...\n</code></pre>\n\n<p>To distinguish between <code>StringColumn</code> and <code>UnknownColumn</code> from your original, use a new type for <code>Unknown</code> to distinguish it from an \"ordinary\" string.</p>\n\n<pre><code>newtype Unknown = Unknown String\n\ntype UnknownColumn = Column Unknown  -- for example\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 0, "last_activity_date": 1523281642, "last_edit_date": 1523281642, "creation_date": 1523280738, "answer_id": 49734264, "question_id": 49732645, "link": "https://stackoverflow.com/questions/49732645/constructors-as-datatypes-in-haskell/49734264#49734264", "title": "Constructors as datatypes in Haskell", "body": "<p>In addition to chepner's</p>\n\n<pre><code>data Column a = Column String [a]\n</code></pre>\n\n<p>you could define <code>sumColumn</code> as</p>\n\n<pre><code>sumColumn :: Num a =&gt; Column a -&gt; Column a -&gt; Column a\nsumColumn (Column name1 ms) (Column name2 ns) =\n  Column (name1 ++ \"+\" ++ name2) (zipWith (+) ms ns)\n</code></pre>\n\n<p>You could also use GADTs to ensure that columns that contain numbers are only used as such:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n\ndata Column a where\n  NumColumn :: Num a =&gt; String -&gt; [a] -&gt; Column a\n  StrColumn :: String -&gt; [String] -&gt; Column String\n</code></pre>\n\n<p>but you'd still have to constrain every function that operates on <code>Num a =&gt; Column a</code>s.</p>\n"}], "owner": {"reputation": 798, "user_id": 9223023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RTmMa.png?s=128&g=1", "display_name": "Petras Purlys", "link": "https://stackoverflow.com/users/9223023/petras-purlys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1523281642, "creation_date": 1523275793, "question_id": 49732645, "link": "https://stackoverflow.com/questions/49732645/constructors-as-datatypes-in-haskell", "title": "Constructors as datatypes in Haskell", "body": "<p>Currently I have these datatypes:</p>\n\n<pre><code>data NumberColumn = NumberColumn String [Double]\ndata StringColumn = StringColumn String [String]\ndata UnknownColumn = UnknownColumn String [String]\n</code></pre>\n\n<p>All of these datatypes (there are others too, these are just domain examples) model csv file columns. They can represent plain numbers, names, money, simple text and so on.</p>\n\n<p>What I would like to achieve is something like this:</p>\n\n<pre><code>data Column = NumberColumn String [Double] | StringColumn String [String] | UnknownColumn String [String]\n</code></pre>\n\n<p>That is, I would like to put them in a single datatype so that it would be possible to map, filter and create new items, like so:</p>\n\n<pre><code>sumColumn :: NumberColumn -&gt; NumberColumn -&gt; NumberColumn\nsumColumn...\n</code></pre>\n\n<p>The problem is that NumberColumn is not a datatype but a constructor, so the best that I can think of is to accept and return Column types:</p>\n\n<pre><code>sumColumn :: Column -&gt; Column -&gt; Column\nsumColumn (NumberColumn...) (NumberColumn...)...\n</code></pre>\n\n<p>This works but the explicitness that the function should only take NumberColumns is lost and I would very much like to keep it.</p>\n\n<p>Can this be achieved?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 1, "creation_date": 1523266043, "post_id": 49729524, "comment_id": 86472810, "body": "Will this help you <code>let [y1,y2,y3,y4,m1,m2,d1,d2] = &quot;20180409&quot; in (read [y1,y2,y3,y4] :: Int, read [m1,m2] :: Int, read [d1,d2] :: Int)</code>?"}, {"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1523266077, "post_id": 49729524, "comment_id": 86472832, "body": "I&#39;d say you need <a href=\"https://hackage.haskell.org/package/strptime-1.0.10/docs/Data-Time-Parse.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/strptime-1.0.10/docs/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 178, "user_id": 2803947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad6d46f2cf26b0d4e8f8736ed8c933b8?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandre Pinho", "link": "https://stackoverflow.com/users/2803947/alexandre-pinho"}, "is_accepted": false, "score": 1, "last_activity_date": 1523266801, "creation_date": 1523266801, "answer_id": 49729895, "question_id": 49729524, "link": "https://stackoverflow.com/questions/49729524/extract-yyyymmdd-from-char-and-create-datetime-value/49729895#49729895", "title": "Extract YYYYMMDD from [Char] and create DateTime value", "body": "<p>The slicing I think you have to do yourself, but to read a Integer from a string you should use the function <a href=\"http://hackage.haskell.org/package/base-4.11.0.0/docs/Prelude.html#v:read\" rel=\"nofollow noreferrer\"><code>read</code></a>, like so:</p>\n\n<pre><code>read \"1234\" :: Int\n</code></pre>\n\n<p>For this function to work on any data type, it must be an instance of the class <a href=\"http://hackage.haskell.org/package/base-4.11.0.0/docs/Prelude.html#t:Read\" rel=\"nofollow noreferrer\"><code>Read</code></a>. Unfortunately, looking at the documentation, DateTime is not.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 2, "last_activity_date": 1523267326, "creation_date": 1523267326, "answer_id": 49730051, "question_id": 49729524, "link": "https://stackoverflow.com/questions/49729524/extract-yyyymmdd-from-char-and-create-datetime-value/49730051#49730051", "title": "Extract YYYYMMDD from [Char] and create DateTime value", "body": "<p>For doing such stuff \u201cproperly\u201d, you should read up on parser combinator libraries. A (very much overkill) solution using the <a href=\"http://hackage.haskell.org/package/megaparsec\" rel=\"nofollow noreferrer\">megaparsec library</a>:</p>\n\n<pre><code>import Text.Megaparsec\nimport Text.Megaparsec.Char\nimport Control.Monad\n\ntype Parser = Parsec String String\n\ndecimalNInt :: Int -&gt; Parser Int\ndecimalNInt nDigits = read &lt;$&gt; replicateM nDigits digitChar\n\ndata DateTime = DateTime Int Int Int Int Int Int deriving (Show)\n\ndateYYYYMMDD :: Parser DateTime\ndateYYYYMMDD = DateTime &lt;$&gt;\n       decimalNInt 4 &lt;*&gt; decimalNInt 2 &lt;*&gt; decimalNInt 2\n   &lt;*&gt; pure 0 &lt;*&gt; pure 0 &lt;*&gt; pure 0\n</code></pre>\n\n<pre><code>> runParser dateYYYYMMDD \"\" \"20180409\"\n    Right (DateTime 2018 4 9 0 0 0)\n> runParser dateYYYYMMDD \"\" \"2018009\"\n    Left (TrivialError (SourcePos {sourceName = \"\", sourceLine = Pos 1, sourceColumn = Pos 8} :| []) (Just EndOfInput) (fromList [Label ('d' :| \"igit\")]))\n> runParser dateYYYYMMDD \"\" \"abcdefgh\"\n    Left (TrivialError (SourcePos {sourceName = \"\", sourceLine = Pos 1, sourceColumn = Pos 1} :| []) (Just (Tokens ('a' :| \"\"))) (fromList [Label ('d' :| \"igit\")]))\n</code></pre>\n\n<p>In perhaps better understandable monadic notation, the parser would look thus:</p>\n\n<pre><code>dateYYYYMMDD = do\n    year &lt;- decimalNInt 4\n    month &lt;- decimalNInt 2\n    day &lt;- decimalNInt 2\n    return $ DateTime year month day 0 0 0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1523275139, "post_id": 49732026, "comment_id": 86478403, "body": "You beat me to it, and amusingly, my example date would have been &quot;20180309&quot;. :-D"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1523279812, "post_id": 49732026, "comment_id": 86481663, "body": "\u201cOnly Haskell package that treats dates and times carefully\u201d \u2013 on what basis do you make that statement? I find <code>time</code> a bit, if you permit the pun, <i>dated</i>. <a href=\"http://hackage.haskell.org/package/thyme\" rel=\"nofollow noreferrer\"><code>thyme</code></a> seems the natural successor, which improves upon it both in terms of API and performance."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1523275266, "last_edit_date": 1523275266, "creation_date": 1523273841, "answer_id": 49732026, "question_id": 49729524, "link": "https://stackoverflow.com/questions/49729524/extract-yyyymmdd-from-char-and-create-datetime-value/49732026#49732026", "title": "Extract YYYYMMDD from [Char] and create DateTime value", "body": "<p>Use <a href=\"http://hackage.haskell.org/package/time-1.9.1/docs/Data-Time-Format.html#v:parseTimeM\" rel=\"nofollow noreferrer\"><code>parseTimeM</code></a>, from the only Haskell package that really treats dates and times carefully, <a href=\"http://hackage.haskell.org/package/time\" rel=\"nofollow noreferrer\">time</a>. It is a quite comprehensive library; the only thing it really lacks is natural-language processing and production.</p>\n\n<pre><code>Data.Time&gt; parseTimeM False defaultTimeLocale \"%0Y%m%d\" \"20180409\" :: Maybe Day\nJust 2018-04-09\n</code></pre>\n\n<p>The documentation linked above and the documentation for <a href=\"http://hackage.haskell.org/package/time-1.9.1/docs/Data-Time-Format.html#v:formatTime\" rel=\"nofollow noreferrer\"><code>formatTime</code></a> give a complete list of available format specifiers.</p>\n\n<p>If you really need <code>DateTime</code> and no substitute will do, you can extract the year, month, and day from a <code>Day</code> with <a href=\"http://hackage.haskell.org/package/time-1.9.1/docs/Data-Time-Calendar.html#v:toGregorian\" rel=\"nofollow noreferrer\"><code>toGregorian</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "is_accepted": true, "score": 5, "last_activity_date": 1523340676, "last_edit_date": 1523340676, "creation_date": 1523279090, "answer_id": 49733696, "question_id": 49729524, "link": "https://stackoverflow.com/questions/49729524/extract-yyyymmdd-from-char-and-create-datetime-value/49733696#49733696", "title": "Extract YYYYMMDD from [Char] and create DateTime value", "body": "<p>Using the <code>dates</code> package, I think you need <code>parseDateFormat</code>:</p>\n\n<pre><code>&gt; import Data.Dates\n&gt; import Data.Dates.Formats (parseDateFormat)\n&gt; parseDateFormat \"YYYYMMDD\" \"20180409\"\nRight 9 April 2018, 0:0:0\n</code></pre>\n\n<p>If you're sure that your string has the correct date format, you can extract the result from <code>Right</code> with <code>fromRight'</code> of the <code>extra</code> package:</p>\n\n<pre><code>&gt; import Data.Either.Extra\n&gt; fromRight' $ parseDateFormat \"YYYYMMDD\" \"20180409\"\n9 April 2018, 0:0:0\n</code></pre>\n"}], "owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 49733696, "answer_count": 4, "score": 1, "last_activity_date": 1523340676, "creation_date": 1523265578, "last_edit_date": 1523267038, "question_id": 49729524, "link": "https://stackoverflow.com/questions/49729524/extract-yyyymmdd-from-char-and-create-datetime-value", "title": "Extract YYYYMMDD from [Char] and create DateTime value", "body": "<p>I have String containing Dates with the following format \"YYYYMMDD\". This is for granted, no possibility of errors. </p>\n\n<p>I want to create DateTime from them.</p>\n\n<p>I manage to have something working , but it seems very complicated to such small things: </p>\n\n<pre><code>-- Only works in base 10 , for positive values\nstringToInt :: String -&gt; Int\nstringToInt [] = 0\nstringToInt (x:xs) = (digitToInt x * 10^length xs ) + (stringToInt xs) \n\n-- Expecting format = \"YYYYMMDD\"\nstringToDateTime :: String -&gt; DateTime\nstringToDateTime s = DateTime year month day 0 0 0\n  where year = stringToInt $ take 4 s \n        month = stringToInt $ take(6-4) . drop 4 $ s\n        day = stringToInt $ take(8-6) . drop 6 $ s\n\ndate1 = stringToDateTime \"20180409\"\n</code></pre>\n\n<p>I tried the parseDate function , but could not managed to have it working, as I could not found what it the expected String format (here is <a href=\"https://hackage.haskell.org/package/dates-0.2.2.1/docs/Data-Dates.html\" rel=\"nofollow noreferrer\">Data.Dates doc</a> : how can we know the expected format ?) </p>\n\n<p>That is why I end up doing myself function for creating a DateTime from my String, and doing so I had to create a function for converting an Int from a [Char] , because  I could not find an already existing function for this. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 2, "creation_date": 1523258446, "post_id": 49727107, "comment_id": 86468683, "body": "<a href=\"http://hackage.haskell.org/package/base-4.11.0.0/docs/Prelude.html#v:unlines\" rel=\"nofollow noreferrer\">unlines</a>?"}, {"owner": {"reputation": 6190, "user_id": 3523446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/268d77718b0875284cdfff02b4ec54b5?s=128&d=identicon&r=PG&f=1", "display_name": "qxg", "link": "https://stackoverflow.com/users/3523446/qxg"}, "edited": false, "score": 1, "creation_date": 1523258599, "post_id": 49727107, "comment_id": 86468767, "body": "simply <code>putStr $ num [0..4]</code> and you&#39;ll get expected result. Also see <a href=\"https://stackoverflow.com/questions/29089117/haskell-new-line-not-working\" title=\"haskell new line not working\">stackoverflow.com/questions/29089117/&hellip;</a>"}, {"owner": {"reputation": 21, "user_id": 9157256, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yFgG_X8HGEg/AAAAAAAAAAI/AAAAAAAAAJc/w3DzcW6btEg/photo.jpg?sz=128", "display_name": "Harpreet SINGH", "link": "https://stackoverflow.com/users/9157256/harpreet-singh"}, "reply_to_user": {"reputation": 6190, "user_id": 3523446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/268d77718b0875284cdfff02b4ec54b5?s=128&d=identicon&r=PG&f=1", "display_name": "qxg", "link": "https://stackoverflow.com/users/3523446/qxg"}, "edited": false, "score": 0, "creation_date": 1523262216, "post_id": 49727107, "comment_id": 86470638, "body": "@qxg Thanks. That really helped"}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 0, "creation_date": 1523264347, "post_id": 49727107, "comment_id": 86471808, "body": "Use <code>unlines list</code>, you don&#39;t need <code>num</code> at all. But if the objective is to build the expected output with an arbitrary height, then you don&#39;t need <code>list</code> but you will have to change your definition of <code>num</code>."}], "owner": {"reputation": 21, "user_id": 9157256, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yFgG_X8HGEg/AAAAAAAAAAI/AAAAAAAAAJc/w3DzcW6btEg/photo.jpg?sz=128", "display_name": "Harpreet SINGH", "link": "https://stackoverflow.com/users/9157256/harpreet-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "closed_date": 1523265201, "answer_count": 0, "score": 1, "last_activity_date": 1523256864, "creation_date": 1523256864, "question_id": 49727107, "link": "https://stackoverflow.com/questions/49727107/how-to-output-a-2-dimensional-list-in-haskell", "closed_reason": "Duplicate", "title": "How to output a 2 dimensional list in Haskell?", "body": "<p>I want to output this 2D list with a line break. I have tried some methods but they do not seem to work. Please assist me. Thanks</p>\n\n<p>My code:</p>\n\n<pre><code>list = [[' ',' ','*',' ',' ',' ',' ',' ',' ','*',' ',' ',' ',' ',' ',' ','*',' ',' '],\n        [' ','*',' ','*',' ',' ',' ',' ','*',' ','*',' ',' ',' ',' ','*',' ','*',' '],\n        ['*',' ','*',' ','*',' ',' ','*',' ','*',' ','*',' ',' ','*',' ','*',' ','*'],\n        ['-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-'],\n        [' ',' ','1',' ',' ',' ',' ',' ',' ','2',' ',' ',' ',' ',' ',' ','3',' ',' ']]\n\nnum :: [Int] -&gt; String\nnum x = case x of\n  []   -&gt; []\n  x:xs -&gt; list!!x ++ \"\\n\" ++ num xs\n</code></pre>\n\n<p>I output I get:</p>\n\n<pre><code>Prelude-&gt; num [0,1,2,3,4]\n\"  *      *      *  \\n * *    * *    * * \\n* * *  * * *  * * *\\n-------------------\\n  1      2      3  \\n\"\n</code></pre>\n\n<p>The output I want:</p>\n\n<pre><code>Prelude-&gt; num [0,1,2,3,4]\n  *      *      *  \n * *    * *    * * \n* * *  * * *  * * *\n-------------------\n  1      2      3  \n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1523234016, "post_id": 49724078, "comment_id": 86462195, "body": "This is not in general possible.  There is no requirement that Haskell modules be installed as source.  GHC does not install Haskell modules as source."}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 2, "creation_date": 1523237755, "post_id": 49724078, "comment_id": 86462881, "body": "If all you&#39;re looking for is the source to browse as a human reader (not as a piece of software), you can find it on <a href=\"https://hackage.haskell.org/package/base-4.11.0.0/docs/src/\" rel=\"nofollow noreferrer\">Hackage</a>."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 9616917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/044731511409cebefe29dcb927471605?s=128&d=identicon&r=PG&f=1", "display_name": "Taha Magdy", "link": "https://stackoverflow.com/users/9616917/taha-magdy"}, "edited": false, "score": 0, "creation_date": 1523268482, "post_id": 49724676, "comment_id": 86474292, "body": "Thank You, this is helpful."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1523240015, "creation_date": 1523240015, "answer_id": 49724676, "question_id": 49724078, "link": "https://stackoverflow.com/questions/49724078/what-is-the-default-path-of-the-source-of-haskell-modules-prelude-etc/49724676#49724676", "title": "What is the default path of the source of Haskell modules (Prelude, etc.)?", "body": "<p>So there's a bit of an impedance mismatch here, since packages are generally installed as binaries (though the most popular way to get the binaries is to build from source). Still, it's not too bad. The rough plan will be to map from module name to package/version pair, then ask cabal to unpack a copy of that version of the package.</p>\n\n<p>Let's say I wanted to read the source for <code>Data.Text</code>. Then:</p>\n\n<pre><code>% ghc-pkg find-module Data.Text\n/usr/local/lib/ghc-8.2.1/package.conf.d\n    (no packages)\n/home/dmwit/.ghc/x86_64-linux-8.2.1/package.conf.d\n    text-1.2.2.2\n% cabal unpack text-1.2.2.2\nUnpacking to text-1.2.2.2/\n</code></pre>\n\n<p>You will now have a <code>text-1.2.2.2</code> directory containing the source for the <code>text</code> package -- including a file in <code>text-1.2.2.2/Data/Text.hs</code> that contains the source for the <code>Data.Text</code> module.</p>\n"}], "owner": {"reputation": 103, "user_id": 9616917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/044731511409cebefe29dcb927471605?s=128&d=identicon&r=PG&f=1", "display_name": "Taha Magdy", "link": "https://stackoverflow.com/users/9616917/taha-magdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 49724676, "answer_count": 1, "score": 0, "last_activity_date": 1523242751, "creation_date": 1523233124, "last_edit_date": 1523242751, "question_id": 49724078, "link": "https://stackoverflow.com/questions/49724078/what-is-the-default-path-of-the-source-of-haskell-modules-prelude-etc", "title": "What is the default path of the source of Haskell modules (Prelude, etc.)?", "body": "<p>I want to browse the source of the installed Haskell modules on my machine.\nWhat is the default search path of Haskell's <code>import</code>?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1523223161, "post_id": 49722964, "comment_id": 86459470, "body": "In functional programming, you can not assign values do variables. All variables are immutable: once set, you can not set the variable to another value, you can however <i>return</i> a value, or use recursion. Therefore in Haskell there is no <code>if</code>, there is only an <code>if</code>-<code>else</code>, since you need to <code>return</code> something in the case the condition does <i>not</i> hold."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 3, "creation_date": 1523223189, "post_id": 49722964, "comment_id": 86459481, "body": "The code lacks too much context. It&#39;s not even clear what its purpose is in python, let alone how to approach the same problem in haskell."}, {"owner": {"reputation": 767, "user_id": 814796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZQemO.jpg?s=128&g=1", "display_name": "madgen", "link": "https://stackoverflow.com/users/814796/madgen"}, "edited": false, "score": 1, "creation_date": 1523223798, "post_id": 49722964, "comment_id": 86459680, "body": "You can write an expression that returns the desired value rather than doing an assignment, but I don&#39;t think there is much value in answering this without you providing an attempt to solve the problem. A little context would also be helpful."}, {"owner": {"reputation": 59, "user_id": 5585324, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9c8aad3bd128b9b9f8d5607a84346620?s=128&d=identicon&r=PG&f=1", "display_name": "John Gringus", "link": "https://stackoverflow.com/users/5585324/john-gringus"}, "edited": false, "score": 0, "creation_date": 1523223888, "post_id": 49722964, "comment_id": 86459718, "body": "I have updated the question!"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1523224459, "post_id": 49722964, "comment_id": 86459872, "body": "@JohnGringus Since you originally asked about the code inside the loop, did you already succeed at implementing the rest? Specifically, reading the input is something that should be separated from the actual logic. Writing a function that takes only the <code>a</code> as an argument (and then computes the final <code>lis</code> from it) would be appropriate."}, {"owner": {"reputation": 59, "user_id": 5585324, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9c8aad3bd128b9b9f8d5607a84346620?s=128&d=identicon&r=PG&f=1", "display_name": "John Gringus", "link": "https://stackoverflow.com/users/5585324/john-gringus"}, "edited": false, "score": 0, "creation_date": 1523224751, "post_id": 49722964, "comment_id": 86459964, "body": "Yes, I have already read the lines from a file and placed each line in to different variable."}, {"owner": {"reputation": 59, "user_id": 5585324, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9c8aad3bd128b9b9f8d5607a84346620?s=128&d=identicon&r=PG&f=1", "display_name": "John Gringus", "link": "https://stackoverflow.com/users/5585324/john-gringus"}, "edited": false, "score": 0, "creation_date": 1523224943, "post_id": 49722964, "comment_id": 86460018, "body": "I am also using ForM as the for loops. Is that bad practice?"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1523286636, "post_id": 49722964, "comment_id": 86486397, "body": "@JohnGringus There&#39;s nothing wrong with <code>forM</code> or <code>forM_</code> per se, but whether or not exactly what you&#39;re doing is bad practice or not is impossible to say without you actually telling us what you&#39;re doing."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 5585324, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9c8aad3bd128b9b9f8d5607a84346620?s=128&d=identicon&r=PG&f=1", "display_name": "John Gringus", "link": "https://stackoverflow.com/users/5585324/john-gringus"}, "edited": false, "score": 0, "creation_date": 1523224249, "post_id": 49723088, "comment_id": 86459811, "body": "i have updated the code!"}], "tags": [], "owner": {"reputation": 1086, "user_id": 6720909, "user_type": "registered", "profile_image": "https://graph.facebook.com/991806280936558/picture?type=large", "display_name": "Vojt\u011bch Mr&#225;z", "link": "https://stackoverflow.com/users/6720909/vojt%c4%9bch-mr%c3%a1z"}, "is_accepted": false, "score": 1, "last_activity_date": 1523224037, "creation_date": 1523224037, "answer_id": 49723088, "question_id": 49722964, "link": "https://stackoverflow.com/questions/49722964/haskell-how-to-create-a-function-that-does-an-if-check-and-then-returns-a-valu/49723088#49723088", "title": "Haskell - How to create a function that does an if check and then returns a value?", "body": "<p>I will answer your question exactly how did you ask, but when you are converting from python or other object oriented language to functional programming you cannot proceed exactly in the same way. And most of the times, you have to come up with a little bit different logic. Its hard for me to help you more, because you send a really short piece of code and little of information.</p>\n\n<p>However, probably you want some function, which is working with all the variables you are using in this piece of code, so <code>a, k, j, i, val, lis</code> also for this function is I think the best to use return type <code>Maybe</code>, which will return <code>Nothing</code> if you didnt change val or <code>Just val</code> with new value. For array/list indexing you can use operator <code>!!</code>.</p>\n\n<pre><code>fun a k j i val lis \n    | a!!k &lt; a!!j &amp;&amp; 1 + (lis!!i)!!k &gt; val = Just (1 + (lis!!i)!!k)\n    | otherwise = Nothing\n</code></pre>\n\n<p>But like I said before... I think you are probably doing some for cycles etc.. And for that its much better to use pattern matching and recursion in Haskell... </p>\n\n<p>Hope I helped you...</p>\n"}, {"tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 2, "last_activity_date": 1523264184, "last_edit_date": 1523264184, "creation_date": 1523262585, "answer_id": 49728594, "question_id": 49722964, "link": "https://stackoverflow.com/questions/49722964/haskell-how-to-create-a-function-that-does-an-if-check-and-then-returns-a-valu/49728594#49728594", "title": "Haskell - How to create a function that does an if check and then returns a value?", "body": "<h2>On asking questions</h2>\n\n<blockquote>\n  <p>How to create a function that does an if check and then returns a value?</p>\n</blockquote>\n\n<p>If this really were your question, this would answer it:</p>\n\n<pre><code>fun :: () -&gt; String\nfun () = if 5 &gt; 6 then \"You're nuts!\" else \"Obviously!\"\n</code></pre>\n\n<p>But perhaps your title should be \"Multiple increasing sequences in Haskell\".</p>\n\n<blockquote>\n  <p>I have this piece of python code that I would like to translate to Haskell: [...]</p>\n  \n  <p>I want to be able to create a function in Haskell that can do this.</p>\n</blockquote>\n\n<p>So you want to translate some code; but what is your question? Are you asking for others to translate it, or give hints as to how to translate particular bits? Or more generally how to translate from one programming paradigm into another?</p>\n\n<p>How can others enable you to create such a function in Haskell? If you're stuck at \"How do I even make a function and an if-clause?\", then perhaps should your question be <a href=\"https://stackoverflow.com/questions/1012573/getting-started-with-haskell\">How to get started with Haskell?</a> Remember you clicked the \"Ask Question\" button, not the \"Make Demands\" button. ;-)</p>\n\n<blockquote>\n  <p>This program essentially take take from an input such as</p>\n\n<pre><code>1\n5\n1 2 9 6 8\n</code></pre>\n  \n  <p>where the first line is the number of test cases and the second line being the number of numbers in the specific test case, and the third line being the test case itself. It is looking for the multiple increasing sequences within the test case</p>\n</blockquote>\n\n<p>This seems to be the actual question, except you don't really say what the \"multiple increasing sequences\" problem is. If you want help on problem solving, you have to state the problem.</p>\n\n<h2>On structuring your algorithm in Haskell</h2>\n\n<p>Without knowing exactly what your problem is, it seems that it consists of <code>n</code> sub-problems parsed from standard input; each sub-problem being contained in an array of integers. So you can at least build the following two parts:</p>\n\n<ol>\n<li><p>Extracting the problem via I/O:</p>\n\n<pre><code>import Control.Monad (replicateM)\n\n-- Read a line that contains an Int.\nreadInt :: IO Int\nreadInt = undefined\n\n-- Read a line that contains multiple Ints.\nreadInts :: IO [Int]\nreadInts = fmap (map read . words) getLine\n\n-- Read n problems.\nreadProblems :: IO [[Int]]\nreadProblems = readInt &gt;&gt;= \\n -&gt; replicateM n (readInt &gt;&gt; readInts)\n</code></pre></li>\n<li><p>Solving a problem without I/O:</p>\n\n<pre><code>solveProblem :: [Int] -&gt; Int\nsolveProblem ns = undefined\n</code></pre></li>\n<li><p>Piecing those parts together:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  problems &lt;- readProblems\n  forM problems (print . solveProblem)\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 59, "user_id": 5585324, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9c8aad3bd128b9b9f8d5607a84346620?s=128&d=identicon&r=PG&f=1", "display_name": "John Gringus", "link": "https://stackoverflow.com/users/5585324/john-gringus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 1, "closed_date": 1523279066, "answer_count": 2, "score": -9, "last_activity_date": 1523264184, "creation_date": 1523223040, "last_edit_date": 1523223868, "question_id": 49722964, "link": "https://stackoverflow.com/questions/49722964/haskell-how-to-create-a-function-that-does-an-if-check-and-then-returns-a-valu", "closed_reason": "Needs details or clarity", "title": "Haskell - How to create a function that does an if check and then returns a value?", "body": "<p>I have this piece of python code that I would like to translate to haskell:</p>\n\n<pre><code>T = int(input())\nfor t in range(0, T):\n\n  n = int(input())\n  a = list(map(int, input().split()))\n\n  lis = [[0 for j in range(0, n)] for i in range(0, n)]\n\n  for i in range(0, n):\n      for j in range(i, n):\n          val = 1\n          for k in range(i, j):\n              if(a[k] &lt; a[j] and 1 + lis[i][k] &gt; val):\n                  val = 1 + lis[i][k]\n          lis[i][j] = val\n  ans = ''\n</code></pre>\n\n<p>I want to be able to create a function in haskell that can do this. However, This program essentially take take from an input such as</p>\n\n<pre><code>1\n5\n1 2 9 6 8\n</code></pre>\n\n<p>where the first line is the number of test cases and the second line being the number of numbers in the specific test case, and the third line being the test case itself. It is looking for the multiple increasing sequences within the test case</p>\n"}, {"tags": ["sorting", "haskell", "functional-programming", "cloud-haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1523212716, "post_id": 49721333, "comment_id": 86455886, "body": "You make it rather complicated. What should happen in case the list is empty, or all elements in the list are the same? I assume you want to check if all elements are <code>&lt;=</code> the next one, or all elements are <code>&gt;=</code> than the next one."}, {"owner": {"reputation": 1, "user_id": 9572926, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AurQlZtkrvg/AAAAAAAAAAI/AAAAAAAAAQ8/nSS1uSD6wkQ/photo.jpg?sz=128", "display_name": "Shreyas Ramnath", "link": "https://stackoverflow.com/users/9572926/shreyas-ramnath"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523216077, "post_id": 49721333, "comment_id": 86457131, "body": "Oh ok, thanks. But what about the Process Bool error that I am getting? Any idea."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523216545, "post_id": 49721333, "comment_id": 86457293, "body": "In that case you should add a <code>return</code>, so <code>return $ same $ ...</code>."}], "owner": {"reputation": 1, "user_id": 9572926, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AurQlZtkrvg/AAAAAAAAAAI/AAAAAAAAAQ8/nSS1uSD6wkQ/photo.jpg?sz=128", "display_name": "Shreyas Ramnath", "link": "https://stackoverflow.com/users/9572926/shreyas-ramnath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1523212364, "creation_date": 1523212324, "last_edit_date": 1523212364, "question_id": 49721333, "link": "https://stackoverflow.com/questions/49721333/check-if-a-list-is-sorted-in-cloud-haskell", "title": "Check if a list is sorted in Cloud Haskell", "body": "<p>The main function I am using is </p>\n\n<pre><code>sorted :: [Integer] -&gt; Process Bool\nsorted a = same $ map (&gt;0) $ filter (/=0) $ zipWith (-) a (tail a)\n    where\n          same (x:xs) = and $ map (==x) xs\n</code></pre>\n\n<p>When I compile the program using ghc I get the following error.</p>\n\n<pre><code>shreyas@shreyas-Inspiron-13-7368:~/Desktop/haskell/my-project/src$ ghc Main.hs[1 of 1] Compiling Main             ( Main.hs, Main.o )\nMain.hs:9:12: error:\n    \u2022 Couldn't match expected type \u2018Process Bool\u2019\n                  with actual type \u2018Bool\u2019\n    \u2022 In the expression:\n        same $ map (&gt; 0) $ filter (/= 0) $ zipWith (-) a (tail a)\n      In an equation for \u2018sorted\u2019:\n          sorted a\n            = same $ map (&gt; 0) $ filter (/= 0) $ zipWith (-) a (tail a)\n            where\n                same (x : xs) = and $ map (== x) xs\n</code></pre>\n\n<p>Then I called remotable on 'sorted </p>\n\n<pre><code>remotable ['sorted]\n</code></pre>\n\n<p>and in the master function I take the mkClosure of it and also passed the input array as parameter to the sorted function.</p>\n\n<pre><code>master :: [NodeId] -&gt; Process ()\nmaster [] = liftIO $ putStrLn \"no slaves\"\nmaster (slave:_) = do\nsortedTrio &lt;- call $(functionTDict 'sorted) slave ($(mkClosure 'sorted)([1,2,3]::[Integer]))\nliftIO $ print sortedTrio\n</code></pre>\n\n<p>I am not able to figure out the error. Any help is much appreciated guys.</p>\n"}, {"tags": ["email", "haskell", "mime-mail"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1523211536, "post_id": 49721012, "comment_id": 86455447, "body": "I hope you have that port opened for access in your AWS settings."}, {"owner": {"reputation": 35, "user_id": 9616002, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "madmonk", "link": "https://stackoverflow.com/users/9616002/madmonk"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1523232885, "post_id": 49721012, "comment_id": 86461933, "body": "@Sibi, thanks for your response. That port isn&#39;t one of the ones listed in my AWS settings and I don&#39;t see a way of including it on there. Any idea on how to do that?"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9616002, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "madmonk", "link": "https://stackoverflow.com/users/9616002/madmonk"}, "edited": false, "score": 0, "creation_date": 1523315763, "post_id": 49728271, "comment_id": 86500745, "body": "thanks!, and for authoring the packages mime-mail[-ses] too. I tried the three options and got the following message each time: [I am sure my credentials are correct]"}, {"owner": {"reputation": 35, "user_id": 9616002, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "madmonk", "link": "https://stackoverflow.com/users/9616002/madmonk"}, "edited": false, "score": 0, "creation_date": 1523315951, "post_id": 49728271, "comment_id": 86500816, "body": "*** Exception: SESException {seStatus = Status {statusCode = 403, statusMessage = &quot;Forbidden&quot;}, seCode = &quot;SignatureDoesNotMatch&quot;, seMessage = &quot;The request signature we calculated does not match the signature you provided. Check your AWS Secret Access Key and signing method. Consult the service documentation for details.&quot;...}"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 35, "user_id": 9616002, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "madmonk", "link": "https://stackoverflow.com/users/9616002/madmonk"}, "edited": false, "score": 0, "creation_date": 1523372070, "post_id": 49728271, "comment_id": 86528590, "body": "I&#39;m not sure what the problem there is, but it&#39;s definitely unrelated to the TLS issue. There could be lots of things at play, even something like a clock skew."}, {"owner": {"reputation": 35, "user_id": 9616002, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "madmonk", "link": "https://stackoverflow.com/users/9616002/madmonk"}, "edited": false, "score": 0, "creation_date": 1523374925, "post_id": 49728271, "comment_id": 86530543, "body": "Thanks @Michael, the original TLS problem was definitely solved by your suggestion. I may raise the latest unrelated  issue as a separate question."}, {"owner": {"reputation": 410, "user_id": 836839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc8e0016381fe58fcb04b7e6039b065?s=128&d=identicon&r=PG", "display_name": "Marco Toniut", "link": "https://stackoverflow.com/users/836839/marco-toniut"}, "reply_to_user": {"reputation": 35, "user_id": 9616002, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "madmonk", "link": "https://stackoverflow.com/users/9616002/madmonk"}, "edited": false, "score": 0, "creation_date": 1550637249, "post_id": 49728271, "comment_id": 96336850, "body": "@madmonk Did you manage to solve the <code>SignatureDoesNotMatch</code> issue? Right now, I&#39;m facing that exact problem."}, {"owner": {"reputation": 35, "user_id": 9616002, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "madmonk", "link": "https://stackoverflow.com/users/9616002/madmonk"}, "reply_to_user": {"reputation": 410, "user_id": 836839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc8e0016381fe58fcb04b7e6039b065?s=128&d=identicon&r=PG", "display_name": "Marco Toniut", "link": "https://stackoverflow.com/users/836839/marco-toniut"}, "edited": false, "score": 1, "creation_date": 1550765494, "post_id": 49728271, "comment_id": 96399778, "body": "@MarcoToniut Yes, I did. Trying to retrace my steps but my memory is a bit fuzzy now. As far as I remember, I had to set up AWS access keys and use those credentials in my code. Here is a link on setting up AWS credentials in case you haven&#39;t. (<a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/IAM/latest/UserGuide/&hellip;</a>)"}, {"owner": {"reputation": 410, "user_id": 836839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc8e0016381fe58fcb04b7e6039b065?s=128&d=identicon&r=PG", "display_name": "Marco Toniut", "link": "https://stackoverflow.com/users/836839/marco-toniut"}, "reply_to_user": {"reputation": 35, "user_id": 9616002, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "madmonk", "link": "https://stackoverflow.com/users/9616002/madmonk"}, "edited": false, "score": 0, "creation_date": 1550786095, "post_id": 49728271, "comment_id": 96409877, "body": "Thanks @madmonk. I had done the appropriate setup already, yes, and tested the same access information against three different Haskell libraries and a Javascript one, with only the latter working. I&#39;m really not sure what&#39;s going on, but I bet it&#39;s related to some specific edge case being triggered by common binaries in my local configuration. This was so annoying that I ended up setting a smtp server with SendGrid instead :-P"}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 1, "last_activity_date": 1523261509, "creation_date": 1523261509, "answer_id": 49728271, "question_id": 49721012, "link": "https://stackoverflow.com/questions/49721012/haskell-tls-not-supported-error-in-mime-mail-ses/49728271#49728271", "title": "Haskell: TLS not supported error in mime-mail-ses", "body": "<p>The issue is that <code>defaultManagerSettings</code> does not provide TLS support. Instead, you need to use a TLS enabled manager, such as with:</p>\n\n<ul>\n<li>Using <a href=\"https://www.stackage.org/haddock/lts-11.4/http-client-tls-0.3.5.3/Network-HTTP-Client-TLS.html#v:tlsManagerSettings\" rel=\"nofollow noreferrer\"><code>tlsManagerSettings</code></a> with <code>newManager</code></li>\n<li>Use <a href=\"https://www.stackage.org/haddock/lts-11.4/http-client-tls-0.3.5.3/Network-HTTP-Client-TLS.html#v:newTlsManager\" rel=\"nofollow noreferrer\"><code>newTlsManager</code></a></li>\n<li>Use the global manager, which defaults to TLS enabled, via <a href=\"https://www.stackage.org/haddock/lts-11.4/http-client-tls-0.3.5.3/Network-HTTP-Client-TLS.html#v:getGlobalManager\" rel=\"nofollow noreferrer\"><code>getGlobalManager</code></a></li>\n</ul>\n"}], "owner": {"reputation": 35, "user_id": 9616002, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "madmonk", "link": "https://stackoverflow.com/users/9616002/madmonk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 49728271, "answer_count": 1, "score": 0, "last_activity_date": 1523261509, "creation_date": 1523210568, "question_id": 49721012, "link": "https://stackoverflow.com/questions/49721012/haskell-tls-not-supported-error-in-mime-mail-ses", "title": "Haskell: TLS not supported error in mime-mail-ses", "body": "<p>I am getting \"TlsNotSupported\" error message when I try to use the mime-mail-ses package to send email. I read this documentation (below) that seems to specify port numbers for STARTTLS (as opposed to TLS) but neither mime-mail-ses or mime-mail seem to have a way to specify port numbers, if that in fact were a remedy to the problem. </p>\n\n<p><a href=\"https://docs.aws.amazon.com/ses/latest/DeveloperGuide/smtp-connect.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/ses/latest/DeveloperGuide/smtp-connect.html</a></p>\n\n<pre><code>ses = SES seFrom seTo seAccessKey seSecretKey seSessionToken seRegion\n\nsMail' = simpleMail' mFrom mTo body L.empty\n\nmain = do  \n  manager &lt;- newManager defaultManagerSettings  \n  renderSendMailSES manager ses sMail'\n</code></pre>\n\n<p>I get the following message:</p>\n\n<pre><code>Exception: HttpExceptionRequest Request {  \n  ...\n  port     = 443\n  ...}  \nTlsNotSupported\n</code></pre>\n"}, {"tags": ["haskell", "types", "maybe"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1523191625, "post_id": 49717847, "comment_id": 86448789, "body": "Nit picking: you&#39;re not actually using the <code>Maybe</code> type in your code. The word <code>Maybe</code> in the phrase <code>data Sickness = Maybe Condition</code> defines a <i>value constructor</i> called <code>Maybe</code>, which happens to share the name of the <i>type constructor</i> called <code>Maybe</code> purely by coincidence. (Types and values live in different namespaces in Haskell.) I suspect you meant <code>data Sickness = Sickness (Maybe Condition)</code>, which defines a value constructor called <code>Sickness</code> with a parameter of type <code>Maybe Condition</code>."}, {"owner": {"reputation": 798, "user_id": 9223023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RTmMa.png?s=128&g=1", "display_name": "Petras Purlys", "link": "https://stackoverflow.com/users/9223023/petras-purlys"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1523192318, "post_id": 49717847, "comment_id": 86448978, "body": "@BenjaminHodgson Yes, thanks! Edits made."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1523193670, "post_id": 49717847, "comment_id": 86449356, "body": "More nitpicking: I would tweak Benjamin&#39;s suggestion by swapping the names of <code>Sickness</code> and <code>Condition</code> (i.e. <code>data Condition = Condition (Maybe Sickness)</code>)."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1523193684, "post_id": 49717847, "comment_id": 86449359, "body": "This isn&#39;t a concrete programming question, it&#39;s a discussion question. If you actually come aross a situation where this comes up in real code you can try heading over to codereview.stackexchange.com"}], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 2, "last_activity_date": 1523194885, "creation_date": 1523194885, "answer_id": 49718466, "question_id": 49717847, "link": "https://stackoverflow.com/questions/49717847/maybe-as-part-of-a-haskell-datatype/49718466#49718466", "title": "Maybe as part of a Haskell datatype", "body": "<p>Obviously, as some people point out, any answer given is subjective to some degree. Code is, however, more than a way to make a computer perform computations - it's also a medium of communication.</p>\n\n<p>The clearer you can communicate your intent to the people reading the code in the future, the better you address that concern. To take a cue from <a href=\"https://www.python.org/dev/peps/pep-0020\" rel=\"nofollow noreferrer\">the Zen of Python</a></p>\n\n<blockquote>\n  <p>Explicit is better than implicit</p>\n</blockquote>\n\n<p>That heuristic has served me well in many different programming languages and scenarios. A corollary is that in object-oriented programming, one should <a href=\"http://blog.ploeh.dk/2015/01/19/from-primitive-obsession-to-domain-modelling\" rel=\"nofollow noreferrer\">favour explicit domain objects over primitive obsession</a>.</p>\n\n<p>I'd be inclined to apply a like rule of thumb in cases like the OP, and favour explicitly named types if they better communicate intent.</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 1, "last_activity_date": 1523195394, "creation_date": 1523195394, "answer_id": 49718555, "question_id": 49717847, "link": "https://stackoverflow.com/questions/49717847/maybe-as-part-of-a-haskell-datatype/49718555#49718555", "title": "Maybe as part of a Haskell datatype", "body": "<p>I'd say a large part of the decision hinges on how <em>meaningful</em> you consider <code>Healthy</code> as a condition. If the answer is \"not very much\", you are probably better off with something like the <code>Maybe</code> encoding (cf. <a href=\"https://stackoverflow.com/q/32389885/2751851\">this question</a> for discussion of a more clear-cut case). By the way, if the illnesses weren't mutually exclusive and there were other factors contributing to a condition, we would have to adopt a somewhat different encoding:</p>\n\n<pre><code>import qualified Data.Set as Set\nimport Data.Set (Set)\n\ndata Sickness = Flu | Cold | Allergy\n    deriving (Eq, Ord)\n\ndata Alertness = Sleepy | Distracted | Caffeinated\n    deriving (Eq, Ord)\n\ndata Condition = Condition (Set Sickness) (Set Alertness)\n</code></pre>\n\n<p>I feel that in such a scenario having <code>Healthy</code> as a separate kind of condition would make significantly less sense.</p>\n\n<p>Back to your original formulation, it is worth mentioning there is an intermediate third option: rolling your own specialised, domain-specific <code>Maybe</code> (cf. <a href=\"https://stackoverflow.com/a/49718466/2751851\">Mark Seeman's answer</a>):</p>\n\n<pre><code>data Sickness = Flu | Cold | Allergy\n\ndata Condition = Healthy | Sick Sickness\n</code></pre>\n\n<p>By doing that, you will miss out on the <code>Maybe</code>-handling tools, and you might have to provide some instances and functions yourself if you want to use them (though that might be a non-issue depending on how you plan to use <code>Condition</code>).</p>\n"}], "owner": {"reputation": 798, "user_id": 9223023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RTmMa.png?s=128&g=1", "display_name": "Petras Purlys", "link": "https://stackoverflow.com/users/9223023/petras-purlys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "closed_date": 1523200076, "answer_count": 2, "score": 0, "last_activity_date": 1523195394, "creation_date": 1523190717, "last_edit_date": 1523194923, "question_id": 49717847, "link": "https://stackoverflow.com/questions/49717847/maybe-as-part-of-a-haskell-datatype", "closed_reason": "Opinion-based", "title": "Maybe as part of a Haskell datatype", "body": "<p>Say we want to model someones health. The person can be either sick and have the <code>Flu</code>, a <code>Cold</code>, an <code>Allergy</code> or be <code>Healthy</code>. There are a number of ways we could define this in Haskell, two of them being:</p>\n\n<pre><code>data Condition = Flu | Cold | Allergy | Healthy\n</code></pre>\n\n<p>or</p>\n\n<pre><code>data Condition = Flu | Cold | Allergy\ndata Sickness  = Sickness (Maybe Condition)\n</code></pre>\n\n<p>This is similar to defining a <code>Tree</code> structure, since the <code>Tree</code> element can either be a <code>Node</code> with 2 <code>Tree</code>s or <code>Empty</code>:</p>\n\n<pre><code>data Tree a = Node (Tree a) (Tree a) | Empty\n</code></pre>\n\n<p>Or the <code>Tree</code> could also be defined using a <code>Maybe</code>:</p>\n\n<pre><code>data Node a = Node (Tree a) (Tree a)\ndata Tree a = Tree (Maybe (Node a))\n</code></pre>\n\n<p>Each choice has its pros and cons. Without using a <code>Maybe</code>, we capture all of the possible values of a <code>Tree</code> or <code>Health</code> in a single data declaration, so the scope is very clear. On the other hand, if we do use a <code>Mayb</code>e, then we capture the essence that something might or might not be present in the data model and avoid creating nothingness-defining datatypes like <code>Empty</code> or <code>Healthy</code> and just use <code>Nothing</code> to model the absence. This simplifies the model a little bit, but the declaration of the datatype(s) is no longer contained in a single piece of code.</p>\n\n<p>What are other advantages and drawbacks to either approach?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1523193884, "post_id": 49717755, "comment_id": 86449425, "body": "Do you know about <code>stack script</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 590, "user_id": 3029543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100004855955180/picture?type=large", "display_name": "ptkato", "link": "https://stackoverflow.com/users/3029543/ptkato"}, "edited": false, "score": 0, "creation_date": 1593308483, "post_id": 49717854, "comment_id": 110733631, "body": "Is there a way to generate an executable using stack scripts? The stack wiki only shows how to run them."}], "tags": [], "owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "is_accepted": true, "score": 8, "last_activity_date": 1523191601, "last_edit_date": 1523191601, "creation_date": 1523190771, "answer_id": 49717854, "question_id": 49717755, "link": "https://stackoverflow.com/questions/49717755/stack-compile-stand-alone-source-file/49717854#49717854", "title": "Stack: Compile stand-alone source file", "body": "<p>You can use <code>stack ghc -- &lt;file names&gt;</code> to compile and link a set of files (it's briefly mentioned in <a href=\"https://docs.haskellstack.org/en/stable/GUIDE/#ghcrunghc\" rel=\"noreferrer\">Stack's user guide</a>):</p>\n\n<blockquote>\n  <p>You'll sometimes want to just compile (or run) a single Haskell source file, instead of creating an entire Cabal package for it. You can use <code>stack exec ghc</code> or <code>stack exec runghc</code> for that. As simple helpers, we also provide the <strong><code>stack ghc</code></strong> and <code>stack runghc</code> commands, for these common cases.</p>\n</blockquote>\n\n<p>The <code>--</code> is to ensure the arguments we pass are sent to <code>ghc</code>, rather than being parsed as arguments to <code>stack exec</code>. It's the same thing as when trying to pass arguments to an executable you've made using the normal stack toolchain: <code>stack exec myExe -foo</code> passes <code>-foo</code> to <code>exec</code>, not <code>myExe</code>, <code>stack exec myExe -- -foo</code> behaves as desired.</p>\n\n<hr>\n\n<p>For example:</p>\n\n<p>Bar.hs</p>\n\n<pre><code>module Bar where\n\nbar :: Int\nbar = 5\n</code></pre>\n\n<p>Foo.hs</p>\n\n<pre><code>import Bar\n\nmain :: IO ()\nmain = print bar\n</code></pre>\n\n<p>Compilation (don't even need to specify <code>Bar.hs</code> in the build files, it's sourced automatically):</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>&gt; stack ghc -- Foo.hs\n[1 of 2] Compiling Bar              ( Bar.hs, Bar.o )\n[2 of 2] Compiling Main             ( Foo.hs, Foo.o )\nLinking Foo ...\n&gt; ./Foo\n5\n</code></pre>\n\n<hr>\n\n<p>There's no problem with dependencies either - it looks like all the packages installed locally are available to the build (you can use <code>containers</code> or <code>QuickCheck</code> without any additional build params).</p>\n"}], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1860, "favorite_count": 3, "accepted_answer_id": 49717854, "answer_count": 1, "score": 5, "last_activity_date": 1523191601, "creation_date": 1523190091, "question_id": 49717755, "link": "https://stackoverflow.com/questions/49717755/stack-compile-stand-alone-source-file", "title": "Stack: Compile stand-alone source file", "body": "<p>Once you've installed Stack, you can use it to install GHC for you. Great!</p>\n\n<p>...now how do I compile a file with it?</p>\n\n<p>To be clear: What you're <em>supposed</em> to do is write a package specification and have Stack build that. But surely there must be a way to trivially compile a tiny helper file inside that project? It seems silly to have to construct an entire project just so I can build a tiny helper program and have it easily runnable from the shell.</p>\n\n<p>I know I can <em>run</em> any Haskell file using Stack. But I cannot for the life of me figure out how to <em>compile</em> the thing...</p>\n"}, {"tags": ["haskell", "instance", "equals", "comparable"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1523187541, "post_id": 49717406, "comment_id": 86447805, "body": "Well <code>mod x</code> is not a number, you need to provide an extra argument."}, {"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1523201458, "post_id": 49717406, "comment_id": 86451890, "body": "Doesn&#39;t it say more about location?"}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 0, "creation_date": 1523207102, "post_id": 49717406, "comment_id": 86453917, "body": "Moreover <code>myRandomList</code> is not a function, <code>myDotFunc</code> should probably be <code>myDotFunc = map (+1) . myFilterList</code> instead."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1523211225, "post_id": 49717406, "comment_id": 86455349, "body": "Why is this being downvoted? It&#39;s not a bad question."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 9515635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9788346c833344a4ccf10c184ae3eb34?s=128&d=identicon&r=PG&f=1", "display_name": "SorryIAmConfused", "link": "https://stackoverflow.com/users/9515635/sorryiamconfused"}, "edited": false, "score": 0, "creation_date": 1523188549, "post_id": 49717428, "comment_id": 86448071, "body": "oh damn :( you are right! i am also new to stackoverflow, should i just delete my question? Thanks a lot!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 29, "user_id": 9515635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9788346c833344a4ccf10c184ae3eb34?s=128&d=identicon&r=PG&f=1", "display_name": "SorryIAmConfused", "link": "https://stackoverflow.com/users/9515635/sorryiamconfused"}, "edited": false, "score": 1, "creation_date": 1523189083, "post_id": 49717428, "comment_id": 86448212, "body": "@NikBerlin No, don&#39;t delete it after it has been answered. That would prevent the answerer to gain any reputation. Indeed, SO doesn&#39;t even let you delete it when there&#39;s an upvoted answer, I believe. (When no answer is posted, deleting is fine if you realize the question is of no value to you and/or to others.)"}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 2, "last_activity_date": 1523187578, "creation_date": 1523187578, "answer_id": 49717428, "question_id": 49717406, "link": "https://stackoverflow.com/questions/49717406/haskell-no-instance-for-eq-int-int-arising-from-a-use-of/49717428#49717428", "title": "Haskell - No instance for (Eq (Int -&gt; Int)) arising from a use of \u2018==\u2019", "body": "<p>You've only given <code>mod</code> one argument, in this line:</p>\n\n<pre><code>        | mod x == 0 = x : myFilterList xs\n--        ^^^^^ HERE\n</code></pre>\n\n<p>So it looks like you're trying to compare functions. You might notice that GHC tells you this in the error:</p>\n\n<blockquote>\n  <p>No instance for (Eq (Int -> Int)) arising from a use of \u2018==\u2019 <strong>(maybe you haven't applied a function to enough arguments?)</strong></p>\n</blockquote>\n\n<p>I should be <code>mod x y</code>, where <code>y</code> is the modulo (the 'divider'). I don't know what you want <code>y</code> to be, though, So I can't correct your code.</p>\n"}], "owner": {"reputation": 29, "user_id": 9515635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9788346c833344a4ccf10c184ae3eb34?s=128&d=identicon&r=PG&f=1", "display_name": "SorryIAmConfused", "link": "https://stackoverflow.com/users/9515635/sorryiamconfused"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523187578, "creation_date": 1523187430, "question_id": 49717406, "link": "https://stackoverflow.com/questions/49717406/haskell-no-instance-for-eq-int-int-arising-from-a-use-of", "title": "Haskell - No instance for (Eq (Int -&gt; Int)) arising from a use of \u2018==\u2019", "body": "<p>im currently looking into haskell. I know that i have to make datatypes an instance of Eq in order to compare them.\nBut Int should already be comparable right ? So i dnt know how to handle the following Error:</p>\n\n<blockquote>\n  <p>\u2022 No instance for (Eq (Int -> Int)) arising from a use of \u2018==\u2019\n          (maybe you haven't applied a function to enough arguments?)</p>\n</blockquote>\n\n<p>My Code is as follows:</p>\n\n<pre><code>myRandomList = [1,2,3,4,5,6,7,8,9,10]\n\n\nmyFilterList :: [Int] -&gt; [Int]\nmyFilterList [] = []\nmyFilterList (x:xs)\n        | mod x == 0 = x : myFilterList xs\n        | otherwise = myFilterList xs\n\n\nmyDotFunc = map (+ 1) . myFilterList . myRandomList  \n</code></pre>\n\n<p>Ps: Im not even sure, if my code would work without this error, please remember that i just started haskell :)</p>\n"}, {"tags": ["haskell", "vagrant", "agda"], "answers": [{"tags": [], "owner": {"reputation": 2847, "user_id": 5775077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07307f18138876b066b764d81d644615?s=128&d=identicon&r=PG", "display_name": "P3trur0", "link": "https://stackoverflow.com/users/5775077/p3trur0"}, "is_accepted": true, "score": 6, "last_activity_date": 1523259245, "creation_date": 1523259245, "answer_id": 49727697, "question_id": 49717312, "link": "https://stackoverflow.com/questions/49717312/haskell-compiler-fails-while-compiling-a-modified-alonzo-program/49727697#49727697", "title": "Haskell compiler fails while compiling a Modified Alonzo program", "body": "<p>As suggested on <a href=\"https://github.com/agda/agda/issues/2857\" rel=\"noreferrer\">this issue</a> on Agda GitHub page, it seems a problem related to <strong>Agda version 2.5.3</strong>.</p>\n\n<p>In order to fix that I've replaced <code>cabal-install</code> with <code>stack</code> instead. I mean:</p>\n\n<pre><code>pacman --noconfirm -Sy stack\n</code></pre>\n\n<p>Then, after the provisioning execution, I followed the GitHub comment suggestion saying:</p>\n\n<blockquote>\n  <p>just tell stack to install these packages: <code>stack exec --package ieee754 --package text agda</code>. Executions after this can be made using\n  just stack exec agda.</p>\n</blockquote>\n\n<p>Doing so, I was able to install both the missing packages for a proper MAlonzo compilation.</p>\n"}], "owner": {"reputation": 2847, "user_id": 5775077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07307f18138876b066b764d81d644615?s=128&d=identicon&r=PG", "display_name": "P3trur0", "link": "https://stackoverflow.com/users/5775077/p3trur0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 2, "accepted_answer_id": 49727697, "answer_count": 1, "score": 4, "last_activity_date": 1523259245, "creation_date": 1523186663, "question_id": 49717312, "link": "https://stackoverflow.com/questions/49717312/haskell-compiler-fails-while-compiling-a-modified-alonzo-program", "title": "Haskell compiler fails while compiling a Modified Alonzo program", "body": "<p>I am trying to setup an ArchLinux Virtual Machine for Agda. So far, I've installed both the required dependencies and Agda itself, however I get an Haskell GHC error when I try to compile a simple Hello World program written in Agda. Here follows the scenario description.</p>\n\n<p>The Virtual Machine has been arranged using Vagrant. My provisioning script performs the following package installations:</p>\n\n<pre><code>pacman --noconfirm -Syyu\npacman --noconfirm -Sy ansible vim nano unzip wget git make gcc clang dnsutils\nyes | pacman -Sy virtualbox-guest-utils\npacman --noconfirm -Sy emacs\npacman --noconfirm -Sy ghc-static ghc-libs ghc\npacman --noconfirm -Sy cabal-install    \npacman --noconfirm -Sy agda\npacman --noconfirm -Sy agda-stdlib\n</code></pre>\n\n<p>Once the <code>vagrant up</code> process completes, I do a SSH login and I try to build and launch a simple Agda helloworld application, to see if everything went ok. The silly application is the following:</p>\n\n<pre><code>module helloworld where\nopen import IO\n\nmain = run (putStrLn \"Hello World\")\n</code></pre>\n\n<p>To compile it using Agda I am using the following command:</p>\n\n<pre><code>agda -i /usr/share/agda/lib/ -i . -c helloworld.agda\n</code></pre>\n\n<p>However, when the compilation runs, I come with the following error:</p>\n\n<pre><code>Calling: ghc -O -o /vagrant/helloworld -Werror -i/vagrant -main-is MAlonzo.Code.Qhelloworld /vagrant/MAlonzo/Code/Qhelloworld.hs --make -fwarn-incomplete-patterns -fno-warn-overlapping-patterns\n[ 1 of 78] Compiling MAlonzo.RTE      ( MAlonzo/RTE.hs, MAlonzo/RTE.o )\nCompilation error:\n\nMAlonzo/RTE.hs:5:1: error:\n    Could not find module \u2018Numeric.IEEE\u2019\n    There are files missing in the \u2018ieee754-0.8.0\u2019 package,\n    try running 'ghc-pkg check'.\n    Use -v to see a list of the files searched for.\n  |\n5 | import Numeric.IEEE ( IEEE(identicalIEEE) )\n  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>I tried to install the <code>ieee754</code> using cabal, but it says that the package is already installed.</p>\n\n<p>Do you know how can I get rid of it? Am I missing something?</p>\n\n<p><a href=\"https://github.com/P3trur0/vagrant-agda\" rel=\"nofollow noreferrer\">Here</a> it is the GitHub repo containing the virtual machine. In order to reproduce the problem it is enough to follow what is described in the readme file of the repository.</p>\n"}, {"tags": ["haskell", "module", "naming"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 5, "creation_date": 1523185701, "post_id": 49717000, "comment_id": 86447368, "body": "I think having modules named <code>Common</code> in functional programming is about as useful as having classes named <code>Util</code> in OOP."}, {"owner": {"reputation": 3969, "user_id": 187261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/994de0373c6a35a5f7108b274d0b1cb9?s=128&d=identicon&r=PG", "display_name": "Nazarii Bardiuk", "link": "https://stackoverflow.com/users/187261/nazarii-bardiuk"}, "edited": false, "score": 1, "creation_date": 1523186376, "post_id": 49717000, "comment_id": 86447505, "body": "I&#39;ve found this talk very useful for ideas how to organize haskell project <a href=\"https://jaspervdj.be/posts/2017-12-07-getting-things-done-in-haskell.html\" rel=\"nofollow noreferrer\">jaspervdj.be/posts/&hellip;</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1523187490, "post_id": 49717000, "comment_id": 86447794, "body": "Using FooCommon and BarCommon looks far worse to me."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1523188246, "post_id": 49717000, "comment_id": 86447994, "body": "@MarkSeemann How would you propose to organize a set of common types used by several modules? In OOP, this usually not an issue since each type has its own file/module. One module per type looks overkill in Haskell, though. Defining types in a &quot;scattered&quot; way across many modules can require mutually recursive modules (which are not very convenient in GHC). A <code>Types</code>/<code>Internal</code>/<code>Common</code> module works, but does not look very elegant. Ideally, module dependency should form a tree, avoiding the issue, but often it is a DAG instead."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1523188588, "post_id": 49717000, "comment_id": 86448087, "body": "@chi I can&#39;t answer such a question without knowing what those common types are. Often, the use of vague words like <code>Manager</code>, <code>Controller</code>, <code>Util</code>, <code>Common</code>, <code>Core</code>, etc. could indicate that there&#39;s an implicit abstraction that could benefit from being made explicit. I think that applies to OOP as well as FP. Exactly what that abstraction is, though, is context-dependent, so it&#39;s not something I can answer in general."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1523188672, "post_id": 49717000, "comment_id": 86448106, "body": "For <i>exporting</i>, note that it is possible to define both a <code>Foo.hs</code> file and a <code>Foo&#47;</code> directory, containing many modules. It is possible to write a <code>module Foo</code> that imports and re-exports the deeper modules, so to provide a simple interface to the library user. This does not help to organize common types internally to the library, though."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1523188793, "post_id": 49717000, "comment_id": 86448145, "body": "@chi Often, though, if one has a set of <code>data</code> or <code>newtype</code> definitions that are required by more than one module, those <i>could</i> be the types that model the problem space being solved by the software. In a business context, those are often collectively termed a <i>Domain Model</i>, so that could be a slightly more explicit name than <code>Common</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 1, "creation_date": 1523188797, "post_id": 49717000, "comment_id": 86448147, "body": "@MarkSeemann I agree. I think in the past I was able to find solutions to each specific case, none of which was a general solution. Probably a completely general solution does not even exist."}, {"owner": {"reputation": 798, "user_id": 9223023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RTmMa.png?s=128&g=1", "display_name": "Petras Purlys", "link": "https://stackoverflow.com/users/9223023/petras-purlys"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1523189197, "post_id": 49717000, "comment_id": 86448244, "body": "@MarkSeemann In this particular case each module in &quot;Foo&quot; represents a set of domain-specific computations. All of them return the same type (let&#39;s call it ComputationResult), so I neither can nor want to define it in every Foo. Also, I don&#39;t want to define it in Foo1 and then import it to Foo2. Foo1 and Foo2 are completely separate and can perfectly exist without each other."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1523190567, "post_id": 49717000, "comment_id": 86448555, "body": "@PetrasPurlys Doesn&#39;t that fit the scenario from my previous comment? If it&#39;s domain-specific, then would it make sense to use the name of that domain as the name of the module, instead of <code>Common</code>?"}], "owner": {"reputation": 798, "user_id": 9223023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RTmMa.png?s=128&g=1", "display_name": "Petras Purlys", "link": "https://stackoverflow.com/users/9223023/petras-purlys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1523184075, "creation_date": 1523184075, "question_id": 49717000, "link": "https://stackoverflow.com/questions/49717000/organizing-common-types-in-haskell", "title": "Organizing common types in Haskell", "body": "<p>I have several Haskell modules (Foo1.hs, Foo2.hs, Foo3.hs) that all depend on the same set of types (Common.hs):</p>\n\n<pre><code>...\nFoo/Foo1.hs\nFoo/Foo2.hs\nFoo/Foo3.hs\nFoo/Common.hs\n...\n</code></pre>\n\n<p>This structure makes the code read well when importing:</p>\n\n<pre><code>import Foo.Common\n</code></pre>\n\n<p>What I'm a little worried about is having a lot of same-named Common.hs files throughout the entire project. For example, after adding some bar modules:</p>\n\n<pre><code>...\nFoo/Foo1.hs\nFoo/Foo2.hs\nFoo/Foo3.hs\nFoo/Common.hs\nBar/Bar1.hs\nBar/Bar2.hs\nBar/Common.hs\n...\n</code></pre>\n\n<p>we end up with 2 Common.hs files. Is this fine? Would it be better to rename them somehow (say FooCommon.hs and BarCommon.hs)?</p>\n\n<p>Doing so would seem to make the importing a little bit more awkward:</p>\n\n<pre><code>import Foo.FooCommon\n</code></pre>\n\n<p>Though this might be just a matter of taste.</p>\n"}, {"tags": ["haskell", "strictness"], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 5, "last_activity_date": 1523169942, "creation_date": 1523169942, "answer_id": 49715241, "question_id": 49715102, "link": "https://stackoverflow.com/questions/49715102/ghc-error-for-missing-strict-fields/49715241#49715241", "title": "GHC error for missing strict fields", "body": "<p>A trivial example:</p>\n\n<pre><code>GHCi&gt; data Foo = Foo { bar :: !Int, baz :: String } deriving Show\n</code></pre>\n\n<p><code>bar</code> is a strict field, while <code>baz</code> is non-strict. To begin with, let's forget <code>baz</code>:</p>\n\n<pre><code>GHCi&gt; x = Foo { bar = 3 }\n\n&lt;interactive&gt;:49:5: warning: [-Wmissing-fields]\n    * Fields of `Foo' not initialised: baz\n    * In the expression: Foo {bar = 3}\n      In an equation for `x': x = Foo {bar = 3}\n</code></pre>\n\n<p>We get a warning, but <code>x</code> is constructed. (Note the warning gets printed by default in GHCi when using <code>stack ghci</code>. You might have to use <code>:set -Wall</code> to see it in plain GHCi; I'm not entirely sure.) Trying to use the <code>baz</code> in <code>x</code> naturally gets us in trouble... </p>\n\n<pre><code>GHCi&gt; x\nFoo {bar = 3, baz = \"*** Exception: &lt;interactive&gt;:49:5-19: Missing field in record construction baz\n</code></pre>\n\n<p>... though we can reach <code>bar</code> just fine:</p>\n\n<pre><code>GHCi&gt; bar x\n3\n</code></pre>\n\n<p>If we forget <code>bar</code>, though, we can't even construct the value to begin with:</p>\n\n<pre><code>GHCi&gt; y = Foo { baz = \"glub\" }\n\n&lt;interactive&gt;:51:5: error:\n    * Constructor `Foo' does not have the required strict field(s): bar\n    * In the expression: Foo {baz = \"glub\"}\n      In an equation for `y': y = Foo {baz = \"glub\"}\nGHCi&gt; y\n\n&lt;interactive&gt;:53:1: error: Variable not in scope: y\n</code></pre>\n"}], "owner": {"reputation": 383, "user_id": 5181829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LQG85.jpg?s=128&g=1", "display_name": "Marronnier", "link": "https://stackoverflow.com/users/5181829/marronnier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 49715241, "answer_count": 1, "score": 2, "last_activity_date": 1523169942, "creation_date": 1523168739, "last_edit_date": 1523169088, "question_id": 49715102, "link": "https://stackoverflow.com/questions/49715102/ghc-error-for-missing-strict-fields", "title": "GHC error for missing strict fields", "body": "<p>I'm reading <a href=\"https://www.fpcomplete.com/blog/2017/09/all-about-strictness#strict-data\" rel=\"nofollow noreferrer\">this article</a>. It reads:</p>\n\n<blockquote>\n  <p>When constructing a value with record syntax, GHC will give you an error if you forget a strict field. It will only give you a warning for non-strict fields.</p>\n</blockquote>\n\n<p>Can anyone give me a concrete example of this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1523169303, "post_id": 49713907, "comment_id": 86443334, "body": "When is a reverse perfect ?"}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1525299002, "post_id": 49713907, "comment_id": 87306756, "body": "Less work might be <code>reverse [ read [x] :: Int  | x &lt;- show 12345]</code>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9525655"}, "edited": false, "score": 0, "creation_date": 1523157577, "post_id": 49713940, "comment_id": 86441359, "body": "Can u tell me how can I send the returned list from check_1 into check_2 after all the items have been added. I tried your method and it works but it would not help me in my future checkings."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1523158054, "post_id": 49713940, "comment_id": 86441442, "body": "@Aman Since your <code>check_2</code> is just <code>reverse</code>, you can just call <code>check_2</code> where I call <code>reverse</code> and it will be the same thing."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9525655"}, "edited": false, "score": 0, "creation_date": 1523158424, "post_id": 49713940, "comment_id": 86441485, "body": "my mistake sorry. I actually now understand what u were trying to tell me in your answer and it will help me very much. Thanks"}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 4, "last_activity_date": 1523156184, "creation_date": 1523156184, "answer_id": 49713940, "question_id": 49713907, "link": "https://stackoverflow.com/questions/49713907/how-to-reverse-a-created-list-in-haskell/49713940#49713940", "title": "How to reverse a created list in Haskell?", "body": "<p>The problem is that you're reversing the list after each added item, so it ends up a jumble. You want to reverse once after you've added all the items. You can achieve that by getting rid of <code>check_2</code> and changing <code>input</code> to:</p>\n\n<pre><code>input x = reverse $ check x\n</code></pre>\n\n<p>However a better solution in this case would be to not reverse at all, but creating the list in the right order in the first place: If you change</p>\n\n<pre><code>check_1 (x`div`10) ++ [x`mod`10])\n</code></pre>\n\n<p>to</p>\n\n<pre><code>x `mod` 10 : check_1 (x `div` 10)\n</code></pre>\n\n<p>it will not only be more efficient because you got rid of the <code>++</code>, but the list will also be in reversed order from the start.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9525655"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "accepted_answer_id": 49713940, "answer_count": 1, "score": 0, "last_activity_date": 1525047730, "creation_date": 1523155728, "question_id": 49713907, "link": "https://stackoverflow.com/questions/49713907/how-to-reverse-a-created-list-in-haskell", "title": "How to reverse a created list in Haskell?", "body": "<p>I need guidance to how to make a perfect reverse in my code of Haskell.\nMy code:</p>\n\n<pre><code>input :: Int -&gt; [Int]\ninput x = check_1 x\ncheck_1 x = check_2 (case x of\n  0 -&gt; []\n  x -&gt; check_1 (x`div`10) ++ [x`mod`10])\ncheck_2 x = reverse x\n</code></pre>\n\n<p>My output: </p>\n\n<pre><code>Prelude -&gt; input 12345\nPrelude -&gt; [5,3,1,2,4]\n</code></pre>\n\n<p>How I want:</p>\n\n<pre><code>Prelude -&gt; input 12345\nPrelude -&gt; [5,4,3,2,1]\n</code></pre>\n\n<p>Please assist me in calling the check_2 function is a better way to reverse the list. Thanks</p>\n"}, {"tags": ["list", "loops", "haskell"], "comments": [{"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1523175258, "post_id": 49713905, "comment_id": 86444656, "body": "as you know how to read and print, it would make sense to omit it from question. Could you express your problem just in ghci?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9341368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ca87a4e69960a07232b06c977b9e0f?s=128&d=identicon&r=PG&f=1", "display_name": "singher", "link": "https://stackoverflow.com/users/9341368/singher"}, "edited": false, "score": 0, "creation_date": 1523201034, "post_id": 49714354, "comment_id": 86451768, "body": "Thanks for the info @Adam Smith When trying to run this, I get the error when running the main function:   &quot;multi - st - overflow.hs:(36,3)-(42,46): Non-exhaustive patterns in function go&quot; Line 36:   go lastValue xss@(x:xs) yss@(y:ys) Line 42:   else y : go y         xss ys  Any idea what would be this issue?"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 23, "user_id": 9341368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ca87a4e69960a07232b06c977b9e0f?s=128&d=identicon&r=PG&f=1", "display_name": "singher", "link": "https://stackoverflow.com/users/9341368/singher"}, "edited": false, "score": 0, "creation_date": 1523229166, "post_id": 49714354, "comment_id": 86461040, "body": "@singher Your code or your example input must differ from what was given, then. See <a href=\"https://repl.it/repls/GrowlingMushyOpengroup\" rel=\"nofollow noreferrer\">my runnable example on repl.it</a>"}, {"owner": {"reputation": 23, "user_id": 9341368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ca87a4e69960a07232b06c977b9e0f?s=128&d=identicon&r=PG&f=1", "display_name": "singher", "link": "https://stackoverflow.com/users/9341368/singher"}, "edited": false, "score": 0, "creation_date": 1523280530, "post_id": 49714354, "comment_id": 86482131, "body": "Thanks for the update. I made an error in the code indeed and I tried your example and it works now, however, there may be a small logic error inside. I find that the second test, yours reports 67  vs when I manually test it, I have 93 Unique multiples. I am trying to find the logic error inside."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 23, "user_id": 9341368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ca87a4e69960a07232b06c977b9e0f?s=128&d=identicon&r=PG&f=1", "display_name": "singher", "link": "https://stackoverflow.com/users/9341368/singher"}, "edited": false, "score": 0, "creation_date": 1523294355, "post_id": 49714354, "comment_id": 86490982, "body": "@singher What&#39;s the input that gives 67? It&#39;s not included in your test inputs."}, {"owner": {"reputation": 23, "user_id": 9341368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ca87a4e69960a07232b06c977b9e0f?s=128&d=identicon&r=PG&f=1", "display_name": "singher", "link": "https://stackoverflow.com/users/9341368/singher"}, "edited": false, "score": 0, "creation_date": 1523296053, "post_id": 49714354, "comment_id": 86491915, "body": "The input: 10 120  - the return is 67"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 23, "user_id": 9341368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ca87a4e69960a07232b06c977b9e0f?s=128&d=identicon&r=PG&f=1", "display_name": "singher", "link": "https://stackoverflow.com/users/9341368/singher"}, "edited": false, "score": 0, "creation_date": 1523301445, "post_id": 49714354, "comment_id": 86494700, "body": "@singher the return is 60 there, and it should be 60 (since <code>10 = 2*5</code>, all <code>x</code> where <code>x = 10n</code> are also factors of 2, so the result is just <code>length [2, 4..120]</code> which is trivially 60)."}, {"owner": {"reputation": 23, "user_id": 9341368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ca87a4e69960a07232b06c977b9e0f?s=128&d=identicon&r=PG&f=1", "display_name": "singher", "link": "https://stackoverflow.com/users/9341368/singher"}, "edited": false, "score": 0, "creation_date": 1523305760, "post_id": 49714354, "comment_id": 86496914, "body": "Hmm, So maybe It&#39;s slight different. The idea would be to get all multiples up to the first number. In Second test with  10 120.  Multiples of 2[2,4,6,8,10,12 ... 120] Multiples of 3[3,6,9,12,15,18,... 120] Multiples of 4[4,8,12,16,20,24,28...120] Until Multiples of 10 [10,20,30,40...120]  I then merger them all for Unique values only.  Does that make sence?"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 23, "user_id": 9341368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ca87a4e69960a07232b06c977b9e0f?s=128&d=identicon&r=PG&f=1", "display_name": "singher", "link": "https://stackoverflow.com/users/9341368/singher"}, "edited": false, "score": 0, "creation_date": 1523305838, "post_id": 49714354, "comment_id": 86496947, "body": "@singher oh! That&#39;s not the code I wrote (I only checked 2s and 10s in this case). Consider <code>let numbers = [[i, i+i..n] | i &lt;- [2..m]] in foldr uniqMergeSort [] numbers</code>"}, {"owner": {"reputation": 23, "user_id": 9341368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ca87a4e69960a07232b06c977b9e0f?s=128&d=identicon&r=PG&f=1", "display_name": "singher", "link": "https://stackoverflow.com/users/9341368/singher"}, "edited": false, "score": 0, "creation_date": 1523306935, "post_id": 49714354, "comment_id": 86497486, "body": "Is this a change within the main? &quot;results =  ..&quot; ?"}, {"owner": {"reputation": 23, "user_id": 9341368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ca87a4e69960a07232b06c977b9e0f?s=128&d=identicon&r=PG&f=1", "display_name": "singher", "link": "https://stackoverflow.com/users/9341368/singher"}, "edited": false, "score": 0, "creation_date": 1523308554, "post_id": 49714354, "comment_id": 86498203, "body": "Oh excellent, looks like this works indeed now. Thanks very much. One last question if you dont mind. What if I wanted this to work with an extremely large number, for instance, a test like: 2 1000000000000000  - how would a test like this be able to pass?"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 23, "user_id": 9341368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ca87a4e69960a07232b06c977b9e0f?s=128&d=identicon&r=PG&f=1", "display_name": "singher", "link": "https://stackoverflow.com/users/9341368/singher"}, "edited": false, "score": 0, "creation_date": 1523317959, "post_id": 49714354, "comment_id": 86501356, "body": "You&#39;d probably have to derive something arithmetically to find the total number of factors. Otherwise arbitrarily large inputs take arbitrarily long to process (as it should be)"}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 0, "last_activity_date": 1523162277, "last_edit_date": 1523162277, "creation_date": 1523160853, "answer_id": 49714354, "question_id": 49713905, "link": "https://stackoverflow.com/questions/49713905/haskell-iterate-and-populate-list/49714354#49714354", "title": "Haskell - Iterate and Populate list", "body": "<p>So there's a few parts to this, and if you break them down to each step each one is fairly straightforward. Where the input per line is <code>m</code> and <code>n</code>:</p>\n\n<ol>\n<li>Find all multiples of two between 2 and <code>n</code></li>\n<li>Find all multiples of <code>m</code> between <code>m</code> and <code>n</code></li>\n<li>Sort the two lists together, removing duplicates</li>\n<li>Get the length of the resulting list and print it</li>\n</ol>\n\n<p>Steps 1 and 2 are handled in the same function:</p>\n\n<pre><code>multiplesOfN n = [n, n+n..]\n</code></pre>\n\n<p>This will build an infinite list of values of multiples. Apply <code>takeWhile (&lt;=x)</code> to get the capped values. For the first line of your input, you would have:</p>\n\n<pre><code>twos   = takeWhile (&lt;=30) . multiplesOfN $ 2\nthrees = takeWhile (&lt;=30) . multiplesOfN $ 3\n</code></pre>\n\n<p>Then you'll need to merge the two lists together, removing duplicates. Since they are both ascending lists, this is easy to do in a one-step mergesort.</p>\n\n<pre><code>mergesort :: (Eq a, Ord a) =&gt; [a] -&gt; [a] -&gt; [a]\nmergesort [] ys = ys\nmergesort xs [] = xs\nmergesort xss@(x:xs) yss@(y:ys)\n  | x &lt; y     = x : mergesort xs yss\n  | otherwise = y : mergesort xss ys\n-- but this doesn't remove duplicates! Let's deal with that by\n-- adding a new argument @lastValue@ and discarding if any match\n\nuniqMergesort :: (Eq a, Ord a) =&gt; [a] -&gt; [a] -&gt; [a]\nuniqMergesort xs [] = xs\nuniqMergesort [] ys = ys\nuniqMergesort xss@(x:xs) yss@(y:ys)\n  | x &lt; y     = x : go x xs  yss\n  | otherwise = y : go y xss ys\n  where\n  go _ [] [] = []\n  go lastValue (x:xs) []\n    | lastValue == x =     go lastValue xs []\n    | otherwise      = x : go lastValue xs []\n  go lastValue [] (y:ys)\n    | lastValue == y =     go lastValue [] ys\n    | otherwise      = y : go lastValue [] ys\n  go lastValue xss@(x:xs) yss@(y:ys)\n    | x &lt; y     = if   x == lastValue\n                  then     go lastValue xs yss\n                  else x : go x         xs yss\n    | otherwise = if   y == lastValue\n                  then     go lastValue xss ys\n                  else y : go y         xss ys\n</code></pre>\n\n<p>Getting the length of the resulting list is just <code>length</code>, and pulling values from the file is splitting into lines, then words, then reading each word.</p>\n\n<pre><code>main :: IO ()\nmain = do\n  handle &lt;- openFile \"myFile.txt\" ReadMode\n  contents &lt;- hGetContents handle\n  let inputs  = map (map read . words) . lines $ tail contents\n      results = [let xs = takeWhile (&lt;=n) . multiplesOfN $ 2\n                     ys = takeWhile (&lt;=n) . multiplesOfN $ m\n                 in  uniqMergesort xs ys | [m, n] &lt;- inputs]\n  mapM_ (print . length) results\n  hClose handle\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9341368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ca87a4e69960a07232b06c977b9e0f?s=128&d=identicon&r=PG&f=1", "display_name": "singher", "link": "https://stackoverflow.com/users/9341368/singher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "accepted_answer_id": 49714354, "answer_count": 1, "score": 2, "last_activity_date": 1523162277, "creation_date": 1523155710, "last_edit_date": 1523159061, "question_id": 49713905, "link": "https://stackoverflow.com/questions/49713905/haskell-iterate-and-populate-list", "title": "Haskell - Iterate and Populate list", "body": "<p>I am very new to haskell, and it's by far the hardest language I found to wrap my mind around. I've found a past paper online and I decided to try to implement this in haskell for practice. </p>\n\n<p>I have a list of integers like the following in myFile.txt:</p>\n\n<pre><code>5\n3 30\n10 120\n80 96\n95 96\n98 98\n</code></pre>\n\n<p>Where the First number in the list has an integer to tell me how many tests will follow. In this case, 5 will follow. </p>\n\n<p>I am trying to return a single number(eg: 20) for each test(eg: 3 30) that signifies the total multiples that are in a particular range.</p>\n\n<p>As an example of the first test, 3 30:</p>\n\n<ol>\n<li><p>I need to find the multiples of each number from 2 to the first number (In this case, 2 and 3), up to the value 30. In this case:</p>\n\n<p>Multiples of 2: [2,4,6,8,10,12,14,16,18,20,22,24,26,28,30]</p>\n\n<p>Multiples of 3: [3,6,9,12,15,18,21,24,27,30]</p></li>\n<li><p>I then find what are similar and then count all unique values:</p>\n\n<p>[2,3,4,6,8,9,10,12,14,15,16,18,20,21,22,24,26,27,28,30]</p></li>\n</ol>\n\n<p>The Size of the final list in number 2 is 20, and that's the value I would like to return</p>\n\n<p>With that being said, I have ideas on how to do this implementation. My plans to do this implementation are:</p>\n\n<ol>\n<li>Populate a single list with values that are multiples of numbers\nthat are lesser and equal to the first number received.</li>\n<li>Take the populated list, and group it. </li>\n<li>Take the Length of group, and\nprint the value.</li>\n</ol>\n\n<p>To Start, I've done the following to read all the input, store into a list and pass it to a function to print it to confirm that I've received the right value:</p>\n\n<pre><code>main = do  \n    let myList = []\n    handle &lt;- openFile \"myFile.txt\" ReadMode\n    contents &lt;- hGetContents handle\n    let singlewords = words contents\n        myList = f singlewords\n    printMyVals myList\n    hClose handle\n\nf :: [String] -&gt; [Integer]\nf = map read\n\n\nprintMyVals :: [Integer] -&gt; IO()\nprintMyVals myList = \n    print myList\n</code></pre>\n\n<p>At this point, I am stuck.</p>\n\n<p>I am trying to figure out how I can iterate the values of my list, and use those values to populate another list with it's multiples, like stated above.</p>\n\n<p>Any help on this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1523140056, "post_id": 49712548, "comment_id": 86438597, "body": "<code>Event</code> has to have a <code>Show</code> instance for things containing it to be able to automatically derive <code>Show</code>. That probably means adding <code>deriving Show</code> to your <code>Event</code> definition."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1523140191, "post_id": 49712548, "comment_id": 86438621, "body": "His <code>Event</code> type is an alias and can not carry a deriving clause.  It is also a function so automatic deriving won&#39;t work."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1523140425, "post_id": 49712548, "comment_id": 86438670, "body": "How would you expect to print an <code>Event</code>? Functions can not be printed in general. Perhaps you could define your own custom <code>instance Show Dialogue</code> without relying on <code>Show Event</code>, e.g. by showing that as some generic string &quot;&lt;event&gt;&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 4, "last_activity_date": 1523140129, "creation_date": 1523140129, "answer_id": 49712582, "question_id": 49712548, "link": "https://stackoverflow.com/questions/49712548/cannot-print-own-data-type-in-haskell/49712582#49712582", "title": "Cannot print own data type in Haskell", "body": "<p><code>Event</code> as you have defined it is a function which has no sensible method to show.  How would you like to display this information?  One solution is to <code>import Text.Show.Functions</code>, which has an instance.</p>\n\n<p>For example:</p>\n\n<pre><code>Prelude Text.Show.Functions&gt; show (+ 1)\n\"&lt;function&gt;\"\n</code></pre>\n\n<p>Another solution is to define your own show instance:</p>\n\n<pre><code>instance Show (a -&gt; b) where\n    show _ = \"_\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1523158142, "post_id": 49712635, "comment_id": 86441457, "body": "You can also use <code>unwords</code> instead of <code>intercalate</code>."}], "tags": [], "owner": {"reputation": 3525, "user_id": 1440433, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/mKFTJ.jpg?s=128&g=1", "display_name": "Joker_vD", "link": "https://stackoverflow.com/users/1440433/joker-vd"}, "is_accepted": false, "score": 3, "last_activity_date": 1523140547, "creation_date": 1523140547, "answer_id": 49712635, "question_id": 49712548, "link": "https://stackoverflow.com/questions/49712548/cannot-print-own-data-type-in-haskell/49712635#49712635", "title": "Cannot print own data type in Haskell", "body": "<pre><code>type Event = Game -&gt; Game\ndata Dialogue= Choice String [(String, Dialogue)] \n            | Action String Event\n  -- deriving (Show)\n</code></pre>\n\n<p>When compiler tries to derive <code>Show</code> for <code>Dialogue</code>, it has to <code>Show</code> an <code>Event</code> in the <code>Action</code> variant, but it can't \u2014 <code>Event</code> is a function, and functions don't get auto-derived <code>Show</code> instances.</p>\n\n<p>You have to manually implement either <code>Show Event</code> or <code>Show Dialogue</code>. One way to implement <code>Show Dialogue</code> would be this:</p>\n\n<pre><code>instance Show Dialogue where\n    show (Choice s ds) = \" \"  `intercalate`  [\"Choice\", show s, show ds]\n    show (Action s e) = \" \"  `intercalate`  [\"Action\", show s]\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 9491737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/498b6d762c85be25f7bc8756a085924c?s=128&d=identicon&r=PG&f=1", "display_name": "Frederick", "link": "https://stackoverflow.com/users/9491737/frederick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 951, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1523140547, "creation_date": 1523139872, "last_edit_date": 1523140296, "question_id": 49712548, "link": "https://stackoverflow.com/questions/49712548/cannot-print-own-data-type-in-haskell", "title": "Cannot print own data type in Haskell", "body": "<p><strong>Please read my problem below, after the bold text, before taking your time to scrutinize this code. I don't want to waste your time if you can't answer this.</strong></p>\n\n<p>Okay. I have created my own data type within Haskell. It is</p>\n\n<pre><code>data Dialogue= Choice String [(String, Dialogue)] \n            | Action String Event\n  -- deriving (Show)\n</code></pre>\n\n<p>Note the commented out 'deriving (Show)' which is important for my problem below.</p>\n\n<p>I have a function named dialogue defined as </p>\n\n<pre><code>dialogue:: Game -&gt; Dialogue -&gt; IO Game\ndialogue (Game n p ps) (Action s e) = do \n   putStrLn s\n   return (e (Game n p ps))\ndialogue (Game n p ps) (Choice s xs) = do\n  putStrLn s\n  let ys = [ fst a | a &lt;- xs ]\n  let i = [1..length ys]\n  putStrLn (enumerate 1 ys)\n  str &lt;- getLine\n  if str `elem` exitWords\n  then do\n     return (Game n p ps)\n  else do\n     let c = read str::Int\n     if c `elem` i \n     then do \n        let ds = [ snd b | b &lt;- xs ]\n        let d = ds !! c\n        putStrLn $ show d\n        return (Game n p ps)\n     else do\n        error \"error\"\n</code></pre>\n\n<p>My data type game is defined as </p>\n\n<pre><code>data Game = Game Node Party [Party] | Won \n  deriving (Eq,Show)\n</code></pre>\n\n<p>And an Event is a type, defined by myself as</p>\n\n<pre><code>type Event = Game -&gt; Game\n</code></pre>\n\n<p><strong>Now, this is where my problem occurs.</strong> When I go to load this file within cmd and I have <strong>not</strong> included <em>deriving (Show)</em> within my data type Dialogue, I get the following error:</p>\n\n<pre><code>* No instance for (Show Dialogue) arising from a use of `show'\n* In the second argument of `($)', namely `(show d)'\n  In a stmt of a 'do' block: putStrLn $ (show d)\n  In the expression:\n    do let ds = ...\n       let d = ds !! c\n       putStrLn $ (show d)\n       return (Game n p ps)\n    |\n120 |          putStrLn $ (show d)\n</code></pre>\n\n<p>It would seem to me that I need to include the <em>deriving (Show)</em> in order to be able to print this data type to the console. However, when I do include <em>deriving (Show)</em>, I get this error:</p>\n\n<pre><code>* No instance for (Show Event)\n    arising from the second field of `Action' (type `Event')\n    (maybe you haven't applied a function to enough arguments?)\n  Possible fix:\n    use a standalone 'deriving instance' declaration,\n      so you can specify the instance context yourself\n* When deriving the instance for (Show Dialogue)\n   |\n85 |   deriving Show\n</code></pre>\n\n<p>I have spent quite a long time trying to find out why this might be happening. But I cannot find anywhere online that seems to document this particular problem. </p>\n\n<p>Any help would be perfect, or even just a link to an appropriate explanation. </p>\n\n<p>**Edit: ** My Event is a type synonym and so I cannot add <em>deriving Show</em> to this</p>\n\n<p>Thanks a lot</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 2, "creation_date": 1523169176, "post_id": 49711757, "comment_id": 86443300, "body": "can you describe in words what you want to compute ?"}, {"owner": {"reputation": 7714, "user_id": 149901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1a6db7a9fb5385fde6ba426e27d5ac6?s=128&d=identicon&r=PG", "display_name": "ondra", "link": "https://stackoverflow.com/users/149901/ondra"}, "edited": false, "score": 1, "creation_date": 1523177439, "post_id": 49711757, "comment_id": 86445211, "body": "The GO program doesn&#39;t print anything; the haskell program in your answer keeps printing &#39;358438400&#39; endlessly. Could you describe what are you trying to compute? That said; it seems to me that the proper way would be to exploit haskell laziness (<a href=\"https://github.com/quchen/articles/blob/master/loeb-moeb.md\" rel=\"nofollow noreferrer\">github.com/quchen/articles/blob/master/loeb-moeb.md</a>) and sprinkle it with <code>par</code>/<code>pseq</code> in the reducer."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 1, "creation_date": 1523188640, "post_id": 49711757, "comment_id": 86448097, "body": "Have a look at <a href=\"https://hackage.haskell.org/package/BoundedChan-1.0.3.0/docs/Control-Concurrent-BoundedChan.html\" rel=\"nofollow noreferrer\"><code>BoundedChan</code></a>."}, {"owner": {"reputation": 45, "user_id": 2336525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d7bb14bb9450f0893c14d0ede72bfa6?s=128&d=identicon&r=PG", "display_name": "user2336525", "link": "https://stackoverflow.com/users/2336525/user2336525"}, "edited": false, "score": 0, "creation_date": 1523232033, "post_id": 49711757, "comment_id": 86461750, "body": "I am trying to calculate the sum of squares: 1^2+2^2+3^2....1024^2,  (N * (N + 1) * (2 * N + 1)) / 6. In order to test the performance of Go and Haskell, I repeat calculate the sum of squares for 10 times (R)."}, {"owner": {"reputation": 45, "user_id": 2336525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d7bb14bb9450f0893c14d0ede72bfa6?s=128&d=identicon&r=PG", "display_name": "user2336525", "link": "https://stackoverflow.com/users/2336525/user2336525"}, "reply_to_user": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1523234488, "post_id": 49711757, "comment_id": 86462282, "body": "@PetrPudl&#225;k I have posted my solution in Haskell and I used MVar instead of BoundedChan. Do you mean BoundedChan is more efficient?"}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 1, "creation_date": 1523263758, "post_id": 49711757, "comment_id": 86471479, "body": "@user2336525 <code>MVar</code> allows you to store at most one value. So if a producer happens to be faster than a consumer, it&#39;ll block. With <code>BoundedChan</code> you can put more values into the channel, giving some buffer space when such a situation happens. | Note that for performance comparisons you&#39;re likely to get better numbers using <a href=\"https://downloads.haskell.org/~ghc/7.0.3/docs/html/users_guide/lang-parallel.html\" rel=\"nofollow noreferrer\">parallelization rather than concurrency</a> - while very similar, they serve quite different use-cases."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1523400503, "post_id": 49711757, "comment_id": 86543448, "body": "While <code>MVar</code> is sufficient here, in general when you would use a channel in Go, you can use <code>Chan</code> or <code>BoundedChan</code> in Haskell, depending on the blocking behaviour you want. <code>MVar</code> is more for transferring ownership between threads of a single value at a time, or implementing higher-level concurrency abstractions."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1523180467, "post_id": 49715021, "comment_id": 86446006, "body": "Minor point: <code>m &lt;- replicateM 1024 newEmptyMVar</code>. Major point: don&#39;t loop over indices <code>[0..1023]</code> unless you really have to -- using <code>!!</code> later on is very inefficient (O(N^2))! Use instead <code>mapM_ (\\ (e,x) -&gt; putMVar e (x+1)) $ zip m [0..]</code> which is O(N)"}, {"owner": {"reputation": 45, "user_id": 2336525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d7bb14bb9450f0893c14d0ede72bfa6?s=128&d=identicon&r=PG", "display_name": "user2336525", "link": "https://stackoverflow.com/users/2336525/user2336525"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1523233449, "post_id": 49715021, "comment_id": 86462058, "body": "@chi Thank you very much. I have modified my code according to your suggestions. It runs 10 times faster than the previous implementation."}], "tags": [], "owner": {"reputation": 45, "user_id": 2336525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d7bb14bb9450f0893c14d0ede72bfa6?s=128&d=identicon&r=PG", "display_name": "user2336525", "link": "https://stackoverflow.com/users/2336525/user2336525"}, "is_accepted": false, "score": 0, "last_activity_date": 1523288240, "last_edit_date": 1523288240, "creation_date": 1523168128, "answer_id": 49715021, "question_id": 49711757, "link": "https://stackoverflow.com/questions/49711757/how-to-create-lists-or-array-of-channels-in-haskell-like-go/49715021#49715021", "title": "How to create Lists (or Array) of channels in Haskell, like Go", "body": "<p>I have worked out a solution in Haskell for this MapReduce example. Please point out if there is any part of this code can be optimized. I really appreciate any help you can provide.</p>\n\n<pre><code>import Control.Concurrent\n\nmapper:: (MVar Int) -&gt; (MVar Int) -&gt; IO ()\nmapper left right = do\n    v &lt;- takeMVar left\n    --putMVar right (v*v)\n    putMVar right $! v*v\n    mapper left right\n\nreducer::  (MVar Int) -&gt; (MVar Int) -&gt; (MVar Int) -&gt; IO ()\nreducer left_1 left_2 right = do\n    v1 &lt;- takeMVar left_1\n    v2 &lt;- takeMVar left_2\n    --putMVar right  (v1+v2)\n    putMVar right $! v1+v2\n    reducer left_1 left_2 right        \n\nrepeats:: Int -&gt; [MVar Int] -&gt; [MVar Int] -&gt;IO ()\nrepeats 0 m r = do        \n    --mapM_ (\\ x -&gt; putMVar (m!!x) (x+1) ) [0..1023]\n    mapM_ (\\ (e,x) -&gt; putMVar e (x+1)) $ zip m [0..]\n    result &lt;- takeMVar (r!!1)\n    return ()\n    --putStrLn (show result)\n\nrepeats n m r = do\n    --mapM_ (\\ x -&gt; putMVar (m!!x) (x+1) ) [0..1023]\n    mapM_ (\\ (e,x) -&gt; putMVar e (x+1)) $ zip m [0..]\n    result &lt;- takeMVar (r!!1)\n    --putStrLn (show result)\n    repeats (n-1) m r\n\nmain = do\n    --m &lt;- sequence $ take 1024 $ repeat newEmptyMVar\n    m &lt;- replicateM 1024 newEmptyMVar\n    --r &lt;- sequence $ take 2048 $ repeat newEmptyMVar\n    r &lt;- replicateM 2048 newEmptyMVar\n\n    mapM_ (\\ x -&gt; forkIO (mapper (m!!x) (r!!(1024+x) ))) [0..1023]\n    mapM_ (\\ x -&gt; forkIO (reducer (r!!(x*2)) (r!!(x*2+1))  (r!!x))) [0..1023]\n    repeats 1024 m r\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7714, "user_id": 149901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1a6db7a9fb5385fde6ba426e27d5ac6?s=128&d=identicon&r=PG", "display_name": "ondra", "link": "https://stackoverflow.com/users/149901/ondra"}, "is_accepted": false, "score": 1, "last_activity_date": 1523184032, "last_edit_date": 1523184032, "creation_date": 1523179224, "answer_id": 49716358, "question_id": 49711757, "link": "https://stackoverflow.com/questions/49711757/how-to-create-lists-or-array-of-channels-in-haskell-like-go/49716358#49716358", "title": "How to create Lists (or Array) of channels in Haskell, like Go", "body": "<p>This returns the same as your Haskell code; as it is a pure computation, it uses <code>parallel</code> package.</p>\n\n<pre><code>import Data.Vector ((!), fromList, Vector)\nimport Control.Parallel (par, pseq)\n\nreducer :: Int -&gt; Int -&gt; Int\nreducer a b = a `par` b `pseq` a + b\n\nresult :: Vector Int -&gt; Int\nresult src =\n  let mr = fromList $\n               map (\\i arr -&gt; reducer (arr ! (2 * i)) (arr ! (2 * i + 1))) [0..1023]\n            ++ map (\\i _ -&gt; src ! i * src ! i) [0..1023]\n            :: Vector (Vector Int -&gt; Int)\n      -- See https://github.com/quchen/articles/blob/master/loeb-moeb.md\n      res = fmap ($ res) mr\n  in res ! 1\n\nmain :: IO ()\nmain = do\n  let src = fromList [1..1024]\n  print (result src)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 2336525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d7bb14bb9450f0893c14d0ede72bfa6?s=128&d=identicon&r=PG", "display_name": "user2336525", "link": "https://stackoverflow.com/users/2336525/user2336525"}, "edited": false, "score": 0, "creation_date": 1523287339, "post_id": 49732156, "comment_id": 86486932, "body": "Thank you! The preliminary result for this new code is 8.823s. I compile it by using &quot;ghc -threaded -o mr-opt --make -O -rtsopts mr-opt.hs&quot;.  However, the code I posted before is 1.307s. Do you get similar results?"}, {"owner": {"reputation": 45, "user_id": 2336525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d7bb14bb9450f0893c14d0ede72bfa6?s=128&d=identicon&r=PG", "display_name": "user2336525", "link": "https://stackoverflow.com/users/2336525/user2336525"}, "edited": false, "score": 0, "creation_date": 1523288615, "post_id": 49732156, "comment_id": 86487756, "body": "After forcing the value using <code>$!</code>, the result goes from 1.307s to 1.095s."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 45, "user_id": 2336525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d7bb14bb9450f0893c14d0ede72bfa6?s=128&d=identicon&r=PG", "display_name": "user2336525", "link": "https://stackoverflow.com/users/2336525/user2336525"}, "edited": false, "score": 0, "creation_date": 1523293073, "post_id": 49732156, "comment_id": 86490223, "body": "@user2336525 I only tried compiling with <code>-O</code>. Without optimizations on, it is usually pointless to perform benchmarks, since there may be a large difference, as in this case. On my computer the code above runs in ~2.5s. The original code runs in ~6s."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1523274253, "creation_date": 1523274253, "answer_id": 49732156, "question_id": 49711757, "link": "https://stackoverflow.com/questions/49711757/how-to-create-lists-or-array-of-channels-in-haskell-like-go/49732156#49732156", "title": "How to create Lists (or Array) of channels in Haskell, like Go", "body": "<p>Here's an alternative. It's not terribly elegant, but is a bit simpler than the original code, in my view.</p>\n\n<p>Main changes:</p>\n\n<ul>\n<li>We do without having two lists of <code>MVars</code> and using the slow <code>!!</code></li>\n<li>We use <code>forkAll</code> which spawns the whole binary tree of mappers/reducers (its argument is the depth: <code>2^10 = 1024</code>)</li>\n<li><code>forkAll</code> is still suboptimal since it uses <code>++</code> which is slowish, though</li>\n<li>Major change: when doing <code>putMVar</code>, we force the value using <code>$!</code>, so that we do not store unevaluated expressions inside an <code>MVar</code>. This is a major performance boost.</li>\n<li>Instead of printing all the results, we only print their sum. Otherwise, text IO slows down the benchmark. (Note that the original <code>repeats</code> does <code>n+1</code> loops, so I had to use <code>10241</code> instead of <code>10240</code> below, to match the result.)</li>\n</ul>\n\n<p>The new code is 54% faster, here.</p>\n\n<pre><code>import Control.Concurrent\nimport Control.Monad\n\nmapper :: MVar Int -&gt; MVar Int -&gt; IO ()\nmapper left right = forever $ do\n    v &lt;- takeMVar left\n    putMVar right $! v*v\n\nreducer :: MVar Int -&gt; MVar Int -&gt; MVar Int -&gt; IO ()\nreducer left_1 left_2 right = forever $ do\n    v1 &lt;- takeMVar left_1\n    v2 &lt;- takeMVar left_2\n    putMVar right $! v1+v2\n\nforkAll :: Int -&gt; MVar Int -&gt; IO [MVar Int]\nforkAll 0 res = do\n  v &lt;- newEmptyMVar\n  _ &lt;- forkIO $ mapper v res\n  return [v]\nforkAll depth res = do\n  v1 &lt;- newEmptyMVar\n  r1 &lt;- forkAll (depth - 1) v1\n  v2 &lt;- newEmptyMVar\n  r2 &lt;- forkAll (depth - 1) v2\n  _ &lt;- forkIO $ reducer v1 v2 res\n  return (r1++r2)\n\nmain :: IO ()\nmain = do\n  v &lt;- newEmptyMVar\n  res &lt;- forkAll 10 v\n\n  nums &lt;- replicateM 10241 $ do\n     mapM_ (\\ (r,i) -&gt; putMVar r (i+1)) $ zip res [0..]\n     takeMVar v\n  print $ sum nums\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 2336525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d7bb14bb9450f0893c14d0ede72bfa6?s=128&d=identicon&r=PG", "display_name": "user2336525", "link": "https://stackoverflow.com/users/2336525/user2336525"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 359, "favorite_count": 4, "accepted_answer_id": 49732156, "answer_count": 3, "score": 3, "last_activity_date": 1523288240, "creation_date": 1523133522, "last_edit_date": 1523234332, "question_id": 49711757, "link": "https://stackoverflow.com/questions/49711757/how-to-create-lists-or-array-of-channels-in-haskell-like-go", "title": "How to create Lists (or Array) of channels in Haskell, like Go", "body": "<p>I am trying to compare Haskell with Go for some concurrency examples, the following code is a simple map-reduce example in Go by using Goroutines and channels. The following Go code calculates the sum of squares:</p>\n\n<blockquote>\n  <p>1^2+2^2+3^2....1024^2</p>\n</blockquote>\n\n<p>In order to test the performance of Go and Haskell, I repeat calculate the sum of squares for R times (10).</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc mapper(in chan int, out chan int) {\n    for v := range in {out &lt;- v*v}\n}\n\nfunc reducer(in1, in2 chan int, out chan int) {\n    for i1 := range in1 {i2 := &lt;- in2; out &lt;- i1 + i2}\n}\n\nfunc main() {\n    const N = 1024  // calculate sum of squares up to N; N must be power of 2\n    const R = 10  // number of repetitions to fill the \"pipe\"\n\n    var r [N*2]chan int\n    for i := range r {r[i] = make(chan int)}\n    var m [N]chan int\n    for i := range m {m[i] = make(chan int)}\n\n    for i := 0; i &lt; N; i++ {go mapper(m[i], r[i + N])}\n    for i := 1; i &lt; N; i++ {go reducer(r[i * 2], r[i *2 + 1], r[i])}\n\n    go func () {\n        for j := 0; j &lt; R; j++ {\n            for i := 0; i &lt; N; i++ {m[i] &lt;- i + 1} \n        }\n    } ()\n\n    for j := 0; j &lt; R; j++ {\n        &lt;- r[1]\n    } \n}\n</code></pre>\n\n<p>The question is how to implement this mapreduce example in Haskell efficiently. The following Haskell code try to compute 10^2 + 7^2 in main function. My question is how to create an array (or a list) of channels, like Go, then connect mapper and reducer threads all together in the main function. </p>\n\n<pre><code>import Control.Concurrent\ndata MRchannel = MRchannel !(MVar MRcmd)\ndata MRcmd = Pass !Int | Add !Int\n  deriving (Show)\n\nmapper:: MRchannel -&gt; MRchannel -&gt; IO ()\nmapper left_C@(MRchannel left) right_C@(MRchannel right) = do\n    v &lt;- takeMVar left\n    case v of\n        Pass x -&gt; do\n            putMVar right (Add (x*x))\n            mapper left_C right_C\n        otherwise -&gt; do\n            putStrLn \"Error!\"\n            return ()\n\nreducer::  MRchannel -&gt; MRchannel -&gt; MRchannel -&gt; IO ()\nreducer left_1_C@(MRchannel left_1) left_2_C@(MRchannel left_2) \nright_C@(MRchannel right) = do\n    v1 &lt;- takeMVar left_1\n    case v1 of\n        Add x1 -&gt; do\n            v2 &lt;- takeMVar left_2\n            case v2 of\n                Add x2 -&gt; do \n                    putMVar right (Add (x1+x2))\n                    reducer left_1_C left_2_C right_C\n                otherwise -&gt; do\n                    putStrLn \"Error!\"\n                    return ()\n        otherwise -&gt; do\n            putStrLn \"Error!\"\n            return ()\n\nmain = do\nm1_l &lt;- newEmptyMVar\nm2_l &lt;- newEmptyMVar\nr1_l1 &lt;- newEmptyMVar\nr1_l2 &lt;- newEmptyMVar\nr1_r &lt;- newEmptyMVar\n    let m1_input = MRchannel m1_l\n    let m2_input = MRchannel m2_l\n    let r1_input1 = MRchannel r1_l1\n    let r1_input2 = MRchannel r1_l2\n    let r1_output = MRchannel r1_r\n    forkIO $ mapper m1_input r1_input1\n    forkIO $ mapper m2_input r1_input2\n    forkIO $ reducer r1_input1 r1_input2 r1_output\n\n    putMVar m1_l (Pass 10)\n    putMVar m2_l (Pass 7)\n\n    y &lt;- takeMVar r1_r\n    case y of \n        Add kvalue  -&gt; do\n            putStrLn $ show kvalue\n        otherwise -&gt; do\n            putStrLn \"Error\"\n            return () \n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "haskell-platform"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523133127, "post_id": 49711688, "comment_id": 86436940, "body": "Can you show the full error? My first guess is that this is an spacing issue."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523133216, "post_id": 49711688, "comment_id": 86436961, "body": "I can not reproduce the error locally, there is however another error: the fact that you forgot to put brackets around <code>Var c</code>."}, {"owner": {"reputation": 97, "user_id": 2020493, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6deecfc7faff693bcb387f3b0417a42f?s=128&d=identicon&r=PG", "display_name": "user2020493", "link": "https://stackoverflow.com/users/2020493/user2020493"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523133221, "post_id": 49711688, "comment_id": 86436964, "body": "Prelude&gt; :l unify.hs  [1 of 1] Compiling Unify            ( unify.hs, interpreted )  unify.hs:43:17: error: parse error on input \u2018Just\u2019 Failed, modules loaded: none."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1523133715, "post_id": 49711688, "comment_id": 86437102, "body": "You have a TAB character in the <code>Nothing</code> line. Don&#39;t mix TABs and spaces. GHC should warn about tabs -- turn on warnings if you did not."}], "answers": [{"tags": [], "owner": {"reputation": 685, "user_id": 5641333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xQ9JE.jpg?s=128&g=1", "display_name": "JayDepp", "link": "https://stackoverflow.com/users/5641333/jaydepp"}, "is_accepted": false, "score": 1, "last_activity_date": 1523133640, "creation_date": 1523133640, "answer_id": 49711778, "question_id": 49711688, "link": "https://stackoverflow.com/questions/49711688/getting-an-error-parse-error-on-input-just/49711778#49711778", "title": "Getting an error: parse error on input \u2018Just\u2019", "body": "<p>I got an error about the number of args to apply and about the types in lookup, but this code typechecks:</p>\n\n<pre><code>data Type = Nat | Bool | App Type Type | Var String\n    deriving (Eq, Show)\n\ntype Substitution = [(String, Type)]\n\napply :: Substitution -&gt; Type -&gt; Type\napply s Nat = Nat\napply s Bool = Bool\napply s (Var c) = case (lookup c s) of\n    Nothing -&gt; (Var c)\n    Just v -&gt; v\n</code></pre>\n\n<p>Note the parentheses around <code>Var c</code> and the order of <code>lookup c s</code></p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1523133760, "creation_date": 1523133760, "answer_id": 49711796, "question_id": 49711688, "link": "https://stackoverflow.com/questions/49711688/getting-an-error-parse-error-on-input-just/49711796#49711796", "title": "Getting an error: parse error on input \u2018Just\u2019", "body": "<p>I can not reproduce the error locally, so my guess is that you used tabs an spaces, if you however copy paste your code into the editor, it should \"work\". In that case we however receive another error:</p>\n\n<pre><code>GHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\n[1 of 1] Compiling Main             ( tmp.hs, interpreted )\n\ntmp.hs:7:1: error:\n    Equations for \u2018apply\u2019 have different numbers of arguments\n      tmp.hs:7:1-17\n      tmp.hs:(9,1)-(11,29)\nFailed, modules loaded: none.\n</code></pre>\n\n<p>This is due to the fact that you write:</p>\n\n<pre><code>apply s Var c = -- ...\n</code></pre>\n\n<p>and Haskell assumes that you here wrote three parameters: <code>s</code>, <code>Var</code>, and <code>c</code>, but the <code>c</code> of course belongs to the <code>Var</code> data constructor. We can fix this with a pair of brackets. Furthermore you call <code>lookup</code> in the wrong way: <code>lookup</code> has type <a href=\"http://hackage.haskell.org/package/base-4.11.0.0/docs/Prelude.html#v:lookup\" rel=\"nofollow noreferrer\"><strong><code>lookup :: Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b</code></strong></a>, so the first argument is the key (here <code>c</code>), and the second argument is the lookup table <code>s</code>. So we can fix this with:</p>\n\n<pre><code>apply :: Substitution -&gt; Type -&gt; Type\napply s Nat = Nat\napply s Bool = Bool\napply s (Var c) = case (lookup c s) of \n    Nothing -&gt; (Var c)\n    Just v  -&gt;  v\n</code></pre>\n\n<p>Note that you can get rid of the <code>case</code> pattern matching, and use for instance <a href=\"http://hackage.haskell.org/package/base-4.11.0.0/docs/Data-Maybe.html#v:fromMaybe\" rel=\"nofollow noreferrer\"><strong><code>fromMaybe :: a -&gt; Maybe a -&gt; a</code></strong></a> instead:</p>\n\n<pre><code>import Data.Maybe(fromMaybe)\n\napply :: Substitution -&gt; Type -&gt; Type\napply s Nat = Nat\napply s Bool = Bool\napply s d@(Var c) = fromMaybe d (lookup c s)\n</code></pre>\n\n<p>We can furthermore group the <code>Nat</code> and <code>Bool</code>  case together:</p>\n\n<pre><code>import Data.Maybe(fromMaybe)\n\napply :: Substitution -&gt; Type -&gt; Type\napply s d@(Var c) = fromMaybe d (lookup c s)\napply s t = t\n</code></pre>\n\n<p>This given of course that in case the <code>Type</code> is <em>not</em> a <code>Var c</code> pattern, we should return that <code>Type</code>.</p>\n\n<p>Perhaps you need to call <code>apply</code> recursively as well, since the substitution can result into another <code>Var</code> (and thus you have to do extra lookups). This will however <em>change the function semantically</em> (!), so I am not sure if that is a requirement.</p>\n"}], "owner": {"reputation": 97, "user_id": 2020493, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6deecfc7faff693bcb387f3b0417a42f?s=128&d=identicon&r=PG", "display_name": "user2020493", "link": "https://stackoverflow.com/users/2020493/user2020493"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 610, "favorite_count": 0, "accepted_answer_id": 49711796, "answer_count": 2, "score": 1, "last_activity_date": 1523133760, "creation_date": 1523133000, "question_id": 49711688, "link": "https://stackoverflow.com/questions/49711688/getting-an-error-parse-error-on-input-just", "title": "Getting an error: parse error on input \u2018Just\u2019", "body": "<pre><code>data Type = Nat | Bool | App Type Type | Var String \n     deriving (Eq, Show)\n\ntype Substitution = [(String, Type)]\n\napply :: Substitution -&gt; Type -&gt; Type\napply s Nat = Nat\napply s Bool = Bool\napply s Var c = case (lookup s c) of \n                Nothing -&gt; (Var c)\n                Just v  -&gt;  v\n</code></pre>\n\n<p>But the compilers give me the error \"error: parse error on input \u2018Just\u2019\n\"</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1523131224, "post_id": 49711440, "comment_id": 86436380, "body": "Just remove the constraint.  <code>Eq Int =&gt;</code> is basically meaningless - you should use constraints only with type variables.  For eample <code>union :: Eq a =&gt; [a] -&gt; [a] -&gt; [a]</code>."}, {"owner": {"reputation": 96, "user_id": 6405227, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MlagIIHaQak/AAAAAAAAAAI/AAAAAAAAAUQ/f4yypBPVz7s/photo.jpg?sz=128", "display_name": "Dipesh Desai", "link": "https://stackoverflow.com/users/6405227/dipesh-desai"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1523131357, "post_id": 49711440, "comment_id": 86436414, "body": "is there a specific reason for it?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1523179846, "post_id": 49711440, "comment_id": 86445822, "body": "@DipeshDesai Why would you need to tell the compiler that <code>Int</code> is an instance of <code>Eq</code>? It already knows that. <i>Only</i> use type constraints in polymorphic functions."}], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 5, "last_activity_date": 1523131597, "creation_date": 1523131597, "answer_id": 49711510, "question_id": 49711440, "link": "https://stackoverflow.com/questions/49711440/rigid-usage-of-int-in-haskell-functions/49711510#49711510", "title": "Rigid Usage of Int in Haskell functions", "body": "<p>Type class constraints exist to restrict the types that your function works with. For example if you have the type <code>a -&gt; a -&gt; a</code> that's a function that needs to be able to handle any type of arguments (as long as both arguments have the same type). If you change it to <code>Eq a =&gt; a -&gt; a -&gt; a</code>, it now only needs to work with arguments of a type that implements <code>Eq</code>, allowing you to use <code>==</code> on the arguments.</p>\n\n<p>In your case you have a function of type <code>[Int] -&gt; [Int] -&gt; [Int]</code>. That's already as restricted as it gets: The function works specifically with two arguments of type <code>[Int]</code> - no other types are allowed.</p>\n\n<p>So restricting it to only those types <code>Int</code> that implement <code>Eq</code> makes no sense because <code>Int</code> is already one specific type. So the type should just be <code>[Int] -&gt; [Int] -&gt; [Int]</code> and you will still be allowed to use <code>==</code> because <code>Int</code> does implement <code>Eq</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 5, "last_activity_date": 1523131743, "creation_date": 1523131743, "answer_id": 49711529, "question_id": 49711440, "link": "https://stackoverflow.com/questions/49711440/rigid-usage-of-int-in-haskell-functions/49711529#49711529", "title": "Rigid Usage of Int in Haskell functions", "body": "<p>You here write:</p>\n\n<pre><code>Eq Int =&gt; ...\n</code></pre>\n\n<p>But this is useless, we know for sure that <code>Int</code> is an instance of the <code>Eq</code> typeclass, it is redundant to state that.</p>\n\n<p>Usually you only write type constraints with a type variable in it, for example:</p>\n\n<pre><code>union :: Eq a =&gt; [a] -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>would indeed require to write such type constraint. In that case we can use a <code>union</code> for <em>every</em> <code>a</code>, given that <code>Eq a</code> holds. This holds given <code>a ~ Int</code>, but with the latter we can also use it for <code>a ~ Char</code>, <code>a ~ Maybe Int</code>, etc.</p>\n\n<p>The idea is that if you write <code>Eq a</code>, you can use the <code>(==) :: Eq a =&gt; a -&gt; a -&gt; Bool</code>, and <code>(/=) :: Eq a =&gt; a -&gt; a -&gt; Bool</code> function with expressions of type <code>a</code>. Here however you only use <code>Int</code>s, so we know for sure that we can do that.</p>\n\n<p>Although from a theoretical perspective, it would not be <em>wrong</em> to write <code>Eq Int</code>, it is rather \"non-sensical\".</p>\n"}], "owner": {"reputation": 96, "user_id": 6405227, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MlagIIHaQak/AAAAAAAAAAI/AAAAAAAAAUQ/f4yypBPVz7s/photo.jpg?sz=128", "display_name": "Dipesh Desai", "link": "https://stackoverflow.com/users/6405227/dipesh-desai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 49711510, "answer_count": 2, "score": 0, "last_activity_date": 1523131743, "creation_date": 1523131099, "last_edit_date": 1523131325, "question_id": 49711440, "link": "https://stackoverflow.com/questions/49711440/rigid-usage-of-int-in-haskell-functions", "title": "Rigid Usage of Int in Haskell functions", "body": "<p>I am new to haskell programming and I wanted to know why I get an error </p>\n\n<pre><code>Non type-variable argument in the constraint: Eq Int\n      (Use FlexibleContexts to permit this)\n</code></pre>\n\n<p>when I am trying to define a function like this</p>\n\n<pre><code>union :: (Eq (Int)) =&gt; [Int] -&gt; [Int] -&gt; [Int]\n</code></pre>\n"}, {"tags": ["haskell", "testing", "automated-tests", "property-based-testing", "haskell-hedgehog"], "comments": [{"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1523376981, "post_id": 49711248, "comment_id": 86531815, "body": "Since they both use <code>Gen</code>, isn&#39;t your result fundamentally the same? You&#39;re using three calls to <code>Gen.enumBounded</code> in each case. Why would these be different?"}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1523388528, "post_id": 49711248, "comment_id": 86538394, "body": "@jkeuhlen <code>forAll</code> works under <code>property</code> function within <code>PropertyT IO ()</code> monad. First example uses <code>Gen</code> monad. Since different monads are used the behavior can be potentially different (depending on <code>Monad</code> instances for those types). Or, simple explanation: there&#39;re multiple different ways to do smth so I wonder what is the difference between them."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1523396181, "post_id": 49711248, "comment_id": 86541997, "body": "Both examples use the <code>Property</code> monad don&#39;t they? Maybe I&#39;m missing something, but one is written in an applicative style and the other in sequential monadic style. They use the same generator in the same monad. It should have the exact same result."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1523396937, "post_id": 49711248, "comment_id": 86542311, "body": "@jkeuhlen The difference is in number of times I cal <code>forAll</code> function. Implementation of <code>forAll</code> function with multiple calls to <code>forAll</code> inside <code>PropertyT</code> is not equal to implementation of <code>Applicative</code> instance for <code>Gen</code> type."}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 0, "creation_date": 1523807260, "post_id": 49711248, "comment_id": 86702202, "body": "<code>liftA3</code> appeals to the properties of applicative functors, opening up the possibility of running computations in parallel. On the other hand, the <code>do</code> notation desugars to the bind operator, which is inherently sequential (as each computation builds on the result of the previous one)."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523908466, "post_id": 49864897, "comment_id": 86745785, "body": "This is useful, but it&#39;s a link-only answer. You should include the actual information here."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523914940, "post_id": 49864897, "comment_id": 86748799, "body": "@dfeuer Maybe, but I&#39;d prefer not to do this because (1) I don&#39;t know much about this to add something else; (2) I want to avoid duplicating text (anyone can follow the link); (3) If I copy-paste text it could become outdated because GitHub issue can be updated."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523915193, "post_id": 49864897, "comment_id": 86748909, "body": "You can always include the link, but SO policy frowns on link-only answers. Perhaps you can copy/paste with attribution and link. Make this answer Community Wiki to avoid taking credit and to encourage others to edit."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523919645, "post_id": 49864897, "comment_id": 86750380, "body": "@dfeuer I made community wiki. I have no problems with this :)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523927115, "post_id": 49864897, "comment_id": 86752127, "body": "I meant I suggested making it CW <i>and</i> copying the text into it. It&#39;s still a link-only answer!"}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": true, "score": 0, "last_activity_date": 1523907057, "creation_date": 1523907057, "answer_id": 49864897, "question_id": 49711248, "link": "https://stackoverflow.com/questions/49711248/difference-between-generating-random-input-through-gen-or-through-forall-in/49864897#49864897", "title": "Difference between generating random input through &#39;Gen&#39; or through &#39;forAll&#39; in Hedgehog", "body": "<p>Package maintainers answered this question under corresponding GitHub issue:</p>\n\n<ul>\n<li><a href=\"https://github.com/hedgehogqa/haskell-hedgehog/issues/181\" rel=\"nofollow noreferrer\">https://github.com/hedgehogqa/haskell-hedgehog/issues/181</a></li>\n</ul>\n"}], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 2, "accepted_answer_id": 49864897, "answer_count": 1, "score": 7, "last_activity_date": 1523907057, "creation_date": 1523129795, "last_edit_date": 1523698828, "question_id": 49711248, "link": "https://stackoverflow.com/questions/49711248/difference-between-generating-random-input-through-gen-or-through-forall-in", "title": "Difference between generating random input through &#39;Gen&#39; or through &#39;forAll&#39; in Hedgehog", "body": "<p>Suppose, I want to test the following associativity property for <a href=\"https://hackage.haskell.org/package/base-4.11.0.0/docs/Data-Monoid.html#t:Sum\" rel=\"nofollow noreferrer\"><code>Sum</code></a> with the help of <a href=\"https://hackage.haskell.org/package/hedgehog\" rel=\"nofollow noreferrer\">hedgehog</a> library in Haskell:</p>\n\n<pre><code>a &lt;&gt; (b &lt;&gt; c) \u2261 (a &lt;&gt; b) &lt;&gt; c\n</code></pre>\n\n<p>I have actually two ways to generate random input.</p>\n\n<h3>1. Generate all in <a href=\"https://hackage.haskell.org/package/hedgehog-0.5.3/docs/Hedgehog.html#t:Gen\" rel=\"nofollow noreferrer\"><code>Gen</code></a> (using <code>Gen</code>'s Applicative and Monad instances)</h3>\n\n<pre><code>genTriple :: Get (Int, Int, Int)\ngenTriple = liftA3 (,,) Gen.enumBounded Gen.enumBounded Gen.enumBounded\n\nprop_assoc :: Property\nprop_assoc = property $ do\n  (a, b, c) &lt;- forAll genTriple\n  (Sum a &lt;&gt; Sum b) &lt;&gt; Sum c === Sum a &lt;&gt; (Sum b &lt;&gt; Sum c)\n</code></pre>\n\n<h3>2. Generating each field under <a href=\"https://hackage.haskell.org/package/hedgehog-0.5.3/docs/Hedgehog.html#v:forAll\" rel=\"nofollow noreferrer\"><code>forAll</code></a></h3>\n\n<pre><code>prop_assoc :: Property\nprop_assoc = property $ do\n  a &lt;- forAll Gen.enumBounded\n  b &lt;- forAll Gen.enumBounded\n  c &lt;- forAll Gen.enumBounded\n  (Sum a &lt;&gt; Sum b) &lt;&gt; Sum c === Sum a &lt;&gt; (Sum b &lt;&gt; Sum c)\n</code></pre>\n\n<p>I wonder, what is the difference between two approaches? Does it somehow affect performance or parallelization or randomness?</p>\n"}, {"tags": ["list", "haskell", "dependent-type", "singleton-type"], "comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1523117870, "post_id": 49709113, "comment_id": 86432207, "body": "<code>cmpNatGT0KnownNatLaw</code> is wrong, <code>KnownNat n</code> should contain a runtime integer equal to <code>n</code>, and you merely give it a <code>Dict ()</code>. Singleton subtraction would give you the actual number, but I think using <code>-</code> in the <code>Vec</code> definition is not a good idea in the first place."}, {"owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1523118327, "post_id": 49709113, "comment_id": 86432359, "body": "I tried to add some contraints to my VCons constructor, but I end up with a weird compile error (or a runtime crash) when trying to pattern match on a VCons: <a href=\"https://gist.github.com/cdepillabout/6d4769dbd3c429d284b1eb8b9a12fb75\" rel=\"nofollow noreferrer\">gist.github.com/cdepillabout/6d4769dbd3c429d284b1eb8b9a12fb7&zwnj;&#8203;5</a>"}, {"owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1523118549, "post_id": 49709113, "comment_id": 86432427, "body": "@Andr&#225;sKov&#225;cs I&#39;m sorry, I don&#39;t know what you mean.  Isn&#39;t <code>KnownNat n</code> just a constraint?  I don&#39;t understand how it should contain a runtime integer?  Maybe you&#39;re talking about how typeclasses end up being passed as dictionaries at runtime?  I don&#39;t understand the interaction between that and <code>Dict</code>.  Would you be able to expand on your answer a little?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 2, "creation_date": 1523120094, "post_id": 49709113, "comment_id": 86432934, "body": "I&#39;m sorry, I don&#39;t have the capacity to explain now. <a href=\"http://lpaste.net/364525\" rel=\"nofollow noreferrer\">Here&#39;s a working version</a>, maybe I&#39;ll write a proper answer later."}, {"owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1523121090, "post_id": 49709113, "comment_id": 86433219, "body": "@Andr&#225;sKov&#225;cs Thanks a lot! Is using something like your NatView necessary for this?  I was hoping to do it with just the machinery from GHC.TypeLits and singletons.  Also, this is a terminology question, but would your NatView be referred to as &quot;structural equality&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "edited": false, "score": 0, "creation_date": 1523164503, "post_id": 49710029, "comment_id": 86442440, "body": "I belive the <code>sing</code> function at the very end of your post should instead be <code>singN</code>.  (I tried to make this edit myself, but StackOverflow yelled at me saying my edit wasn&#39;t substantial enough.)"}, {"owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "edited": false, "score": 1, "creation_date": 1523175644, "post_id": 49710029, "comment_id": 86444746, "body": "Thanks a lot for this answer!  I&#39;ve learned a lot from it.  I have come up with a couple different versions of my original code that works now.  <a href=\"https://gist.github.com/cdepillabout/3f187c2cce0d2216febd44dea25d41e6\" rel=\"nofollow noreferrer\">Here</a> is a version using the <code>magic</code> trick you&#39;ve described.  <a href=\"https://gist.github.com/cdepillabout/05b50263638edacdc8b0b727bbd7cc39\" rel=\"nofollow noreferrer\">Here</a> is a version with the formulation of <code>Vect</code> you suggest.  I only need the <code>axiom</code> trick for this."}, {"owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "edited": false, "score": 1, "creation_date": 1523194445, "post_id": 49710029, "comment_id": 86449617, "body": "I&#39;ve been playing around with this a little more.  I came up with <a href=\"https://gist.github.com/cdepillabout/bbe57f0f3dc50ed0d74ee5188cf72f08\" rel=\"nofollow noreferrer\">some code</a> that does basically what you suggested, but using the functionality from singletons.  It ends up being much longer than your code!"}, {"owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "edited": false, "score": 1, "creation_date": 1523201882, "post_id": 49710029, "comment_id": 86452060, "body": "And just for completion, <a href=\"https://gist.github.com/cdepillabout/0d47b2288d5681c9742de604f80b760f\" rel=\"nofollow noreferrer\">here</a> is a version that uses <code>magic</code>  (instead of Peano numbers), but doesn&#39;t use anything from singletons."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "edited": false, "score": 2, "creation_date": 1523203667, "post_id": 49710029, "comment_id": 86452729, "body": "It might be slightly safer to create <code>axiom</code> by coercing a <code>Dict (a ~ a)</code> instead of <code>Dict ()</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "edited": false, "score": 2, "creation_date": 1523214277, "post_id": 49710029, "comment_id": 86456465, "body": "@illabout, it&#39;s more common to use <code>Data.Type.Equality.:~:</code> than <code>Dict</code> for equalities. It&#39;s also likely to be more efficient, but I don&#39;t have time now to explain why."}, {"owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523230467, "post_id": 49710029, "comment_id": 86461382, "body": "Thanks @dfeuer.  I added another version <a href=\"https://gist.github.com/cdepillabout/58d1edebdae0035f8d940701b9fceb15#file-vec-proofs-using-refl-instead-of-dict-hs-L36-L37\" rel=\"nofollow noreferrer\">here</a> that uses <code>Refl</code> for equality rather than <code>Dict</code>."}, {"owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523230589, "post_id": 49710029, "comment_id": 86461416, "body": "@dfeuer I would be interested in why it is more efficient to use <code>Refl</code> rather than <code>Dict</code>.  I&#39;m guessing because <code>Dict</code> needs to carry around the constraint it is holding.  Under the hood, it is like <code>Dict</code> is a data constructor with a single parameter (unlike <code>Refl</code>, which is a data construcotr with no parameters).  Is this on the right track?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "edited": false, "score": 1, "creation_date": 1523239187, "post_id": 49710029, "comment_id": 86463137, "body": "@illabout, yes, that&#39;s it. Internally, <code>~</code> is boxed, while the equalities expressed by GADT constructors are unboxed--internally they use <code>~n#</code> constraints, which are zero-width."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 6, "last_activity_date": 1523196189, "last_edit_date": 1523196189, "creation_date": 1523121965, "answer_id": 49710029, "question_id": 49709113, "link": "https://stackoverflow.com/questions/49709113/replicate-function-for-a-length-indexed-list-using-ghc-typelits-and-singletons/49710029#49710029", "title": "replicate function for a length-indexed list using GHC.TypeLits and singletons", "body": "<p><code>axiom :: Dict a</code> is very unsafe because the runtime representation of a <code>Dict a</code> depends on the constraint <code>a</code> (which corresponds to a dictionary that is captured by the <code>Dict</code> constructor).</p>\n\n<p>A <code>KnownNat</code> constraint corresponds to an integer value at runtime, so it is not correct to construct a <code>Dict</code> of <code>KnownNat</code> using <code>unsafeCoerce</code> on a dummy dictionary (in <code>cmpNatGT0KnownNatLaw</code>). In particular, this integer is used in <code>replicateVec</code> to check whether the integer is <code>0</code>.</p>\n\n<p>Type equalities <code>(~)</code> are special in that they have no meaningful runtime representation, hence <code>axiom</code>-atizing equalities, if they are correct, technically does not lead to bad runtime behavior because the coerced dictionary is never used, but coercing from <code>Dict ()</code> to a <code>Dict (a ~ b)</code> is certainly not a supported use of <code>unsafeCoerce</code>. Coercing between equalities might be more reliable.</p>\n\n<p>To solve <code>KnownNat</code> constraints, <em>constraints</em> internally associates the type-level operations to their term-level counterparts, see <a href=\"https://hackage.haskell.org/package/constraints-0.10/docs/src/Data-Constraint-Nat.html\" rel=\"nofollow noreferrer\"><code>magic</code> in <code>Data.Constraints.Nat</code></a> and reconstructs the <code>KnownNat</code> dictionary based on implicit knowledge about how GHC represents type classes.</p>\n\n<hr>\n\n<p>Anyway, for an inductive construction like <code>replicate</code>, we can avoid <code>KnownNat</code>, and use a different singleton type that reflects the inductive nature of <code>Nat</code>.</p>\n\n<pre><code>data Sing n where\n  Z :: Sing 0\n  S :: Sing n -&gt; Sing (1 + n)\n</code></pre>\n\n<p>This singleton is actually annoying to use because <code>(+)</code> is not injective. (<code>\\x -&gt; (1 + x)</code> technically is injective, but GHC can't tell that much.) It would be easier with an actually inductively defined <code>Nat</code>, but still, with the right set of constraints, we can do some things. For example, singleton reflection (mapping from the type-level <code>n</code> to a <code>Sing n</code> value):</p>\n\n<pre><code>class SingN n where\n  singN :: Sing n\n\ninstance {-# OVERLAPPING #-} SingN 0 where\n  singN = Z\n\ninstance (n ~ (1 + n'), n' ~ (n - 1), SingN n') =&gt; SingN n where\n  singN = S (singN @n')\n</code></pre>\n\n<p>The list type should be similarly structured:</p>\n\n<pre><code>data List n a where\n  Nil :: List 0 a\n  Cons :: a -&gt; List n a -&gt; List (1 + n) a\n</code></pre>\n\n<p>The reason to set up the type index <code>n</code> this way instead of <code>Sing (n-1) -&gt; Sing n</code> and <code>a -&gt; List (n-1) a -&gt; List n a</code> is to forbid some silly values:</p>\n\n<pre><code>oops :: Sing 0\noops = S undefined\n\nouch :: List 0 ()\nouch = Cons () undefined\n</code></pre>\n\n<p>which would be a problem because functions would actually need to handle those cases which make no sense.</p>\n\n<p><code>replicate</code> turns out to be straightforward to implement because <code>List</code> and <code>Sing</code> have a lot of structure in common.</p>\n\n<pre><code>replicate :: Sing n -&gt; a -&gt; List n a\nreplicate Z _ = Nil\nreplicate (S n) a = Cons a (replicate n a)\n</code></pre>\n\n<p>We can now apply <code>replicate</code> as follows:</p>\n\n<pre><code>replicate (singN @3) \"x\"\n</code></pre>\n\n<ul>\n<li><a href=\"https://gist.github.com/Lysxia/089c0a0ce7900923716cdbf79fc4fa99\" rel=\"nofollow noreferrer\">Compilable gist</a></li>\n</ul>\n"}], "owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 1, "accepted_answer_id": 49710029, "answer_count": 1, "score": 1, "last_activity_date": 1523196189, "creation_date": 1523116172, "question_id": 49709113, "link": "https://stackoverflow.com/questions/49709113/replicate-function-for-a-length-indexed-list-using-ghc-typelits-and-singletons", "title": "replicate function for a length-indexed list using GHC.TypeLits and singletons", "body": "<p>I'm trying to write a replicate function for a length-indexed list using the machinery from <a href=\"https://hackage.haskell.org/package/base-4.11.0.0/docs/GHC-TypeLits.html\" rel=\"nofollow noreferrer\">GHC.TypeLits</a>, <a href=\"https://hackage.haskell.org/package/singletons-2.4.1\" rel=\"nofollow noreferrer\">singletons</a>, and <a href=\"https://hackage.haskell.org/package/constraints-0.10\" rel=\"nofollow noreferrer\">constraints</a>.</p>\n\n<p>The <code>Vect</code> type and signature for <code>replicateVec</code> are given below:</p>\n\n<pre><code>data Vect :: Nat -&gt; Type -&gt; Type where\n  VNil  :: Vect 0 a\n  VCons :: a -&gt; Vect (n - 1) a -&gt; Vect n a\n\nreplicateVec :: forall n a. SNat n -&gt; a -&gt; Vect n a\n</code></pre>\n\n<p>How can you write this <code>replicateVec</code> function?</p>\n\n<hr>\n\n<p>I have a version of <code>replicateVec</code> that compiles and type checks, but it appears to go into an infinite loop when run.  The code is below.  I have added comments to try to make the laws and proofs I am using a little easier to understand:</p>\n\n<pre><code>{-# LANGUAGE ConstraintKinds #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE GADTs #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE PolyKinds #-}\n{-# LANGUAGE RankNTypes #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE StandaloneDeriving #-}\n{-# LANGUAGE TypeApplications #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE TypeInType #-}\n\nmodule VectStuff where\n\nimport Data.Constraint ((:-)(Sub), Dict(Dict))\nimport Data.Kind (Type)\nimport Data.Singletons.Decide (Decision(Disproved, Proved), Refuted, (:~:)(Refl), (%~))\nimport Data.Singletons.Prelude (PNum((-)), sing)\nimport Data.Singletons.TypeLits (SNat, Sing(SNat))\nimport GHC.TypeLits (CmpNat, KnownNat, Nat)\nimport Unsafe.Coerce (unsafeCoerce)\n\ndata Vect :: Nat -&gt; Type -&gt; Type where\n  VNil  :: Vect 0 a\n  VCons :: forall n a. a -&gt; Vect (n - 1) a -&gt; Vect n a\n\nderiving instance Show a =&gt; Show (Vect n a)\n\n-- This is used to define the two laws below.\naxiom :: Dict a\naxiom = unsafeCoerce (Dict :: Dict ())\n\n-- | This law says that if we know that @n@ is not 0, then it MUST be\n-- greater than 0.\nnGT0CmpNatLaw :: (Refuted (n :~: 0)) -&gt; Dict (CmpNat n 0 ~ 'GT)\nnGT0CmpNatLaw _ = axiom\n\n-- | This law says that if we know that @n@ is greater than 0, then we know\n-- that @n - 1@ is also a 'KnownNat'.\ncmpNatGT0KnownNatLaw :: forall n. (CmpNat n 0 ~ 'GT) :- KnownNat (n - 1)\ncmpNatGT0KnownNatLaw = Sub axiom\n\n-- | This is a proof that if we have an @n@ that is greater than 0, then\n-- we can get an @'SNat' (n - 1)@\nsNatMinus1 :: forall n. (CmpNat n 0 ~ 'GT) =&gt; SNat n -&gt; SNat (n - 1)\nsNatMinus1 SNat =\n  case cmpNatGT0KnownNatLaw @n of\n    Sub Dict -&gt; SNat\n\n-- | This is basically a combination of the other proofs.  If we have a\n-- @SNat n@ and we know that it is not 0, then we can get an @SNat (n -1)@\n-- that we know is a 'KnownNat'.\nnGT0Proof ::\n     forall n.\n     Refuted (n :~: 0)\n  -&gt; SNat n\n  -&gt; (SNat (n - 1), Dict (KnownNat (n - 1)))\nnGT0Proof f snat =\n  case nGT0CmpNatLaw f of\n    Dict -&gt;\n      case cmpNatGT0KnownNatLaw @n of\n        Sub d -&gt; (sNatMinus1 snat, d)\n\nreplicateVec :: forall n a. SNat n -&gt; a -&gt; Vect n a\nreplicateVec snat a =\n  -- First we check if @snat@ is 0.\n  case snat %~ (sing @_ @0) of\n    -- If we get a proof that @snat@ is 0, then we just return 'VNil'.\n    Proved Refl -&gt; VNil\n    -- If we get a proof that @snat@ is not 0, then we use 'nGT0Proof'\n    -- to get @n - 1@, and pass that to 'replicateVec' recursively.\n    Disproved f -&gt;\n      case nGT0Proof f snat of\n        (snat', Dict) -&gt; VCons a $ replicateVec snat' a\n</code></pre>\n\n<p>However, for some reason this <code>replicateVec</code> function goes into an endless loop when I try to run it:</p>\n\n<pre><code>&gt; replicateVec (sing @_ @3) \"4\"\n[\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",^CInterrupted.\n</code></pre>\n\n<p>Why is this happening?  How can I write the <code>replicateVec</code> function correctly?</p>\n"}, {"tags": ["list", "haskell", "recursion"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1523115405, "post_id": 49708982, "comment_id": 86431467, "body": "What do you mean with <i>add those four types to a tuple</i>? Furthermore the demonstrated sample does not look syntactically sound."}, {"owner": {"reputation": 109, "user_id": 5654171, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DHQttW6OW_E/AAAAAAAAAAI/AAAAAAAAAFM/Vxf2Lo_06JA/photo.jpg?sz=128", "display_name": "Arnau Van Boschken ArnauB", "link": "https://stackoverflow.com/users/5654171/arnau-van-boschken-arnaub"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523115625, "post_id": 49708982, "comment_id": 86431537, "body": "The function returns a tuple. The first element of the tuple are all the cards won by the second pair. The second element of the tuple are all the card won by the first pair. That&#39;s why I said &quot;add&quot;"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1523115701, "post_id": 49708982, "comment_id": 86431553, "body": "But it is rather unclear when a card is won by a player. Based only on the first question, I think you want a function with signature <code>[a] -&gt; [(a,a,a,a)]</code>, but then you show a function which seems to perform way too much work. Usually it is better to split the function into multiple small functions that each perform a specific and simple task."}, {"owner": {"reputation": 109, "user_id": 5654171, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DHQttW6OW_E/AAAAAAAAAAI/AAAAAAAAAFM/Vxf2Lo_06JA/photo.jpg?sz=128", "display_name": "Arnau Van Boschken ArnauB", "link": "https://stackoverflow.com/users/5654171/arnau-van-boschken-arnaub"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523115873, "post_id": 49708982, "comment_id": 86431603, "body": "No, because I received all the cards, not only 4 cards."}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1523207308, "post_id": 49708982, "comment_id": 86453985, "body": "I see you are struggling with taking 4 at a time from a list from the beginning to the end of the list. Following is a general purpose function that converts a list into a list of lists of 4 elements each. The key is the splitAt function. I see you are using take. <code>splitAt</code> is just like <code>take</code> plus <code>drop</code> together.  <code>s4 [] = []; s4 l = (fst ss):s4 (snd ss) where ss = splitAt 4 l</code>"}], "answers": [{"comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1523273841, "post_id": 49710551, "comment_id": 86477582, "body": "In the second line, you should use round brackets, not square brackets I think."}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 3, "last_activity_date": 1523294206, "last_edit_date": 1523294206, "creation_date": 1523125348, "answer_id": 49710551, "question_id": 49708982, "link": "https://stackoverflow.com/questions/49708982/haskell-iterate-lists-by-4-elem/49710551#49710551", "title": "Haskell iterate lists by 4 elem", "body": "<p>As Willem Van Onsem mentions in the comments, your function appears to do entirely too much work. If you're trying to split a list into groups of four-tuples, do that separately from the rest of the logic.</p>\n\n<pre><code>toFourTuple :: [a] -&gt; [(a, a, a, a)]\ntoFourTuple [] = []\ntoFourTuple (a:b:c:d:rest) = (a, b, c, d) : toFourTuple rest\ntoFourTuple _  = error \"list not divisible by four\"\n                 -- how should this be handled?\n</code></pre>\n\n<p>For the rest, it might be useful to know that the Monoid instance of <code>Monoid a =&gt; (a, a)</code> implements <code>mappend</code> as <code>mappend (x, y) (x', y') = (x &lt;&gt; x', y &lt;&gt; y')</code>, so if you generate a list of <code>(leftside, rightside)</code> sublists, you can <code>mconcat</code> them together.</p>\n\n<pre><code>xs = [ ([1]   , [3])\n     , ([2, 4], [5])\n     , ([6]   , [7, 9, 11, 13])\n     ]\nmconcat xs = ([1,2,4,6],[3,5,7,9,11,13])\n</code></pre>\n\n<p>Of course this works incrementally too.</p>\n\n<pre><code>-- |Separates [Int] into ([odds], [evens])\nsplitByMod2 :: [Int] -&gt; ([Int], [Int])\nsplitByMod2 [] = ([], [])\nsplitByMod2 (x:xs)\n  | odd x  = ([x], []) `mappend` splitByMod2 xs\n  | even x = ([], [x]) `mappend` splitByMod2 xs\n  | otherwise = error \"This cannot happen\"\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 5654171, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DHQttW6OW_E/AAAAAAAAAAI/AAAAAAAAAFM/Vxf2Lo_06JA/photo.jpg?sz=128", "display_name": "Arnau Van Boschken ArnauB", "link": "https://stackoverflow.com/users/5654171/arnau-van-boschken-arnaub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523294206, "creation_date": 1523115288, "question_id": 49708982, "link": "https://stackoverflow.com/questions/49708982/haskell-iterate-lists-by-4-elem", "title": "Haskell iterate lists by 4 elem", "body": "<p>How I can iterate a list of elements four by four and then add these four card to a tuple?. </p>\n\n<p>Basically this a function that receives the Suit that it was to be killed, the cards played by order and the player who has played first. </p>\n\n<p>That game is played by pairs, so it returns a tuple with the cards won for the first couple and the cards won for the second couple. </p>\n\n<pre><code>winnedCards:: Suit-&gt; [Card] -&gt; Int -&gt; ([Card],[Card])\nwinnedCards [] _ = ([],[])\nwinnedCards (Suit type) cardsPlayed positionFirstPlayPerson\n | snd(xs) == 3 = (take 4 (cardsPlayed),[])\n | snd(xs) == 1 = (take 4 (cardsPlayed),[])\n | otherwise = ([],take 2 (cardsPlayed))\n where xs = whoHasWon (take 4 (cardsPlayed)) (Suit type)\n</code></pre>\n\n<p>whoHasWon returns the position of the player who has won. I think I have to it recursevily because I have to iterate 4 by 4, and then add the result to the tuple after each iteration.</p>\n"}, {"tags": ["haskell", "audio", "sdl-2"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1523137119, "post_id": 49708458, "comment_id": 86437970, "body": "If you&#39;re anyway just <i>saving a file to be sent to Google</i>, why do you need Haskell at all? I&#39;m a bit reminded of <a href=\"https://xkcd.com/1060/\" rel=\"nofollow noreferrer\">xkcd.com/1060</a>. Might as well just <i>use <code>arecord</code></i>. \u2014 That said, I&#39;d be interested to hear if something like <a href=\"http://hackage.haskell.org/package/conduit-audio\" rel=\"nofollow noreferrer\">conduit-audio</a> is up to recording directly in Haskell nowadays. This <i>should</i> not be difficult..."}, {"owner": {"reputation": 191, "user_id": 5414805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/329a31f8a12bd80134b9e57094052e04?s=128&d=identicon&r=PG&f=1", "display_name": "Zyphicx", "link": "https://stackoverflow.com/users/5414805/zyphicx"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1523137525, "post_id": 49708458, "comment_id": 86438083, "body": "Well, I am using Haskell because my ultimate goal is to create a kind of personal assistant (like Alexa or Cortana) so I need to be able to process the information afterwards. Also, this is a learning project and I want it to be cross platform."}], "owner": {"reputation": 191, "user_id": 5414805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/329a31f8a12bd80134b9e57094052e04?s=128&d=identicon&r=PG&f=1", "display_name": "Zyphicx", "link": "https://stackoverflow.com/users/5414805/zyphicx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 296, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1523111710, "creation_date": 1523111710, "question_id": 49708458, "link": "https://stackoverflow.com/questions/49708458/recording-microphone-audio-with-haskell", "title": "Recording microphone audio with Haskell", "body": "<p>I am working on some voice recognition software as my first Haskell project. I am looking for something something that could work cross-platform. My plan is as follows:</p>\n\n<ol>\n<li>Record audio as a .wav file</li>\n<li>Use <a href=\"https://hackage.haskell.org/package/flac\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/flac</a> to convert the .wav file to a FLAC file.</li>\n<li>Send a speech API request to Google's Speech API (as can be seen here <a href=\"https://cloud.google.com/speech/docs/quickstart\" rel=\"nofollow noreferrer\">https://cloud.google.com/speech/docs/quickstart</a>).</li>\n<li>Receive response and interpret it.</li>\n</ol>\n\n<p>However, I am currently somewhat stuck on step 1 as it seems rather difficult to record microphone input in Haskell.</p>\n\n<p>Since this is a learning experience I wanted to try to find something simple that I could understand quite easily. After some googling I found this: <a href=\"https://codereview.stackexchange.com/questions/169577/sound-recorder-based-on-sdl2\">https://codereview.stackexchange.com/questions/169577/sound-recorder-based-on-sdl2</a>, which uses Haskell SDL2 bindings and Codec.Audio.Wave. I tried copying the code to see if it would work, but alas it did not. I did not have any errors with running the program, but when I tried playing the wave file, nothing happened and it seemed completely empty. Nothing seems to have been recorded, as the file size is only 44 bytes.</p>\n\n<p>I figured the issue was the SDL open device spec not being able to find a suitable recording device, so I tried checking the frequency to see if my microphone wasn't able to handle 48000 Hz and then since that didn't help (it is 96000 Hz max) I tried messing around with the device channels, but that did not help either.</p>\n\n<p>The problem is not with my microphone since I tried recording some audio with arecord (on Arch Linux), which worked just fine. As I said, this is my first Haskell project and I am a bit of a newbie and although I do have experience in other languages it is completely possible that I have done something really silly.</p>\n\n<p>I am not opposed to any solutions not involving SDL2, but as I am looking for something (hopefully) simple and cross-platform, this seemed like a good fit.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 5282, "user_id": 3134112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8990b8e611d60bd869d1c4f06ab6351e?s=128&d=identicon&r=PG&f=1", "display_name": "ElasticCode", "link": "https://stackoverflow.com/users/3134112/elasticcode"}, "edited": false, "score": 0, "creation_date": 1523110187, "post_id": 49708185, "comment_id": 86429775, "body": "Please share more details"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1523110796, "post_id": 49708185, "comment_id": 86429985, "body": "This is basically a parse error on the run-time input, which isn&#39;t something that the compiler cannot predict or warn you about. You need to share the code and the input that causes the error."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1523113389, "post_id": 49708185, "comment_id": 86430823, "body": "Do you know what <code>readLn</code> does?"}, {"owner": {"reputation": 1, "user_id": 9611717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gai_9KgpopU/AAAAAAAAAAI/AAAAAAAAABM/wgw8sLgfZwk/photo.jpg?sz=128", "display_name": "vivek sharma", "link": "https://stackoverflow.com/users/9611717/vivek-sharma"}, "edited": false, "score": 0, "creation_date": 1523114551, "post_id": 49708185, "comment_id": 86431204, "body": "not really ! but i guess it pretty much restricts the input type to String (hear) . Well I am a learner please feel free to tell the exact functionality"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9611717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gai_9KgpopU/AAAAAAAAAAI/AAAAAAAAABM/wgw8sLgfZwk/photo.jpg?sz=128", "display_name": "vivek sharma", "link": "https://stackoverflow.com/users/9611717/vivek-sharma"}, "is_accepted": true, "score": 0, "last_activity_date": 1523122773, "creation_date": 1523122773, "answer_id": 49710154, "question_id": 49708185, "link": "https://stackoverflow.com/questions/49708185/error-user-error-prelude-readio-no-parse/49710154#49710154", "title": "Error : user error (Prelude.readIO: no parse)", "body": "<p>After working on this code I figured out that this code will take a lot of effort to work out so I changed the code a bit,rather then removing the error.</p>\n\n<pre><code>import Data.Array\nimport Data.List\nimport Data.Ord\n\nmain = do {\nls &lt;- readlist [];\nprintOften ls;\n}\nreadlist :: [String] -&gt; IO [String]\nreadlist xs = do{\nimp &lt;- getLine :: IO String;\nif (imp==\"EOF\")\nthen return xs\nelse readlist (imp:xs)\n}\nprintOften :: [String] -&gt; IO ()\nprintOften [] = return () \nprintOften (x:xs) = do {\nputStrLn x;\nputStrLn x;\nprintOften xs;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9611717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gai_9KgpopU/AAAAAAAAAAI/AAAAAAAAABM/wgw8sLgfZwk/photo.jpg?sz=128", "display_name": "vivek sharma", "link": "https://stackoverflow.com/users/9611717/vivek-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "accepted_answer_id": 49710154, "answer_count": 1, "score": -2, "last_activity_date": 1523122773, "creation_date": 1523109781, "last_edit_date": 1523113872, "question_id": 49708185, "link": "https://stackoverflow.com/questions/49708185/error-user-error-prelude-readio-no-parse", "title": "Error : user error (Prelude.readIO: no parse)", "body": "<p>This is a program which is supposed to take input unknown number of text lines and print each line twice but in reverse order \nSample input :</p>\n\n<pre><code>LINE 1\nLINE 2\nEOF\n</code></pre>\n\n<p>ACTUAL OUTPUT :</p>\n\n<pre><code>LINE 2\nLINE 2\nLINE 1\nLINE 1\n</code></pre>\n\n<p>and EOF indicates to stop accepting inputs.</p>\n\n<p>The program compiles (<code>$ ghc filename.hs</code>) just fine but at time of input the no parse error occurs (<code>$ filename: user error (Prelude.readIO: no parse)</code>)</p>\n\n<pre><code>import Data.Array\nimport Data.List\nimport Data.Ord\n\nmain = do {\nls &lt;- readlist [];\nputStrLn (show (reverse ls));\n}\nreadlist :: [String] -&gt; IO [String]\nreadlist l = do {\ninp &lt;- readLn :: IO String;\nif (inp == \"EOF\") then\nreturn l;\nelse readlist (inp:l);\n}\nprintOften :: String -&gt; IO ()\nprintOften str = do {\nputStrLn str;\nputStrLn str;\n} \n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1523099810, "post_id": 49706694, "comment_id": 86426744, "body": "Looks like it&#39;s written to take advantage of <a href=\"https://wiki.haskell.org/Correctness_of_short_cut_fusion#foldr.2Fbuild\" rel=\"nofollow noreferrer\"><code>build&#47;foldr</code> fusion</a>"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1523103754, "last_edit_date": 1523103754, "creation_date": 1523103361, "answer_id": 49707291, "question_id": 49706694, "link": "https://stackoverflow.com/questions/49706694/explanation-of-the-findindices-function/49707291#49707291", "title": "Explanation of the findIndices function", "body": "<p>The <code>CPP</code> extensions enables the C preprocessor, as for the C programming language. Here, it is used to test if the flag <code>USE_REPORT_PRELUDE</code> was set during compilation. According to that flag, the compiler uses the <code>#if</code> or the <code>#else</code> variant of code.</p>\n\n<p><code>build</code> is a function which could be defined as</p>\n\n<pre><code>build f = f (:) []\n</code></pre>\n\n<p>So, using <code>build (\\c n -&gt; ...</code> essentially lets <code>c</code> to the \"cons\" <code>(:)</code>, and <code>n</code> to the \"nil\" <code>[]</code>.</p>\n\n<p>This is <em>not</em> used for convenience: it is not convenient at all! However, the compiler optimizer works great with <code>build</code> and <code>foldr</code> combined, so the code is written here in a weird way to take advantage of that.</p>\n\n<hr>\n\n<p>Further, <code>I# ...</code> is the low-level constructor for integers. When we normally write</p>\n\n<pre><code>x :: Int\nx = 4+2\n</code></pre>\n\n<p>GHC implements <code>x</code> (very roughly) with a pointer to some memory that reads as <code>unevaluated: 4+2</code>. After <code>x</code> is forced the first time, this memory gets overwritten with <code>evaluated: I# 6#</code>. This is needed to implement laziness.\nThe \"boxing\" here refers to the indirection through a pointer.</p>\n\n<p>Instead, the type <code>Int#</code> is a plain machine integer, with no pointers, no indirection, no unevaluated expressions. It is strict (instead of lazy), but being more low-level it is more efficient. One creates a value as in</p>\n\n<pre><code>x' :: Int#\nx' = 6#\n\nx :: Int\nx = I# x'\n</code></pre>\n\n<p>Indeed, <code>Int</code> is defined as <code>newtype Int = I# Int#</code>.</p>\n\n<p>Keep in mind that this is not standard Haskell, but GHC-specific low-level details. In normal code, you should not need to use such unboxed types. In libraries, the authors do that to achieve a little more performance, but that's it.</p>\n\n<p>Sometimes, even if in our code we only use <code>Int</code>s, GHC is smart enough to automatically convert our code to using <code>Int#</code> and achieve more efficiency, avoiding the boxing. This can be observed if we ask GHC to \"dump Core\" so that we can see the result of the optimization.</p>\n\n<p>For instance, compiling</p>\n\n<pre><code>f :: Int -&gt; Int\nf 0 = 0\nf n = n + f (n-1)\n</code></pre>\n\n<p>GHC produces a lower level version (this is GHC Core, not Haskell, but it is similar enough to be understood):</p>\n\n<pre><code>Main.$wf :: GHC.Prim.Int# -&gt; GHC.Prim.Int#\nMain.$wf = \\ (ww_s4un :: GHC.Prim.Int#) -&gt;\n    case ww_s4un of ds_X210 {\n      __DEFAULT -&gt;\n        case Main.$wf (GHC.Prim.-# ds_X210 1#) of ww1_s4ur { __DEFAULT -&gt;\n        GHC.Prim.+# ds_X210 ww1_s4ur\n        };\n      0# -&gt; 0#\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1523105054, "last_edit_date": 1523105054, "creation_date": 1523103749, "answer_id": 49707350, "question_id": 49706694, "link": "https://stackoverflow.com/questions/49706694/explanation-of-the-findindices-function/49707350#49707350", "title": "Explanation of the findIndices function", "body": "<p>Notice the number of arguments to <code>go</code>. <code>go x r k = ...</code> === <code>go x r = \\k -&gt; ...</code>. This is the standard trick to arrange for left-to-right information flow while folding the list (<code>go</code> is used as the reducer function, in <code>foldr go (\\_ -&gt; n) ls 0#</code>). Here, it's the counting of <code>[0..]</code>, explicated as the initial <code>k=0</code> and the <code>(k + 1)</code> on each step (<code>k</code> is an unfortunate naming choice, <code>i</code> seems better; <code>k</code> is overloaded with the irrelevant  \"constant\" and \"continuation\", not just \"counter\" which was probably the intended meaning here). </p>\n\n<p>The <a href=\"https://wiki.haskell.org/Correctness_of_short_cut_fusion#foldr.2Fbuild\" rel=\"nofollow noreferrer\"><code>foldr/build</code> (sic) fusion</a> (linked to by luqui in the comments) turns <code>foldr c n $ findIndices p [a1,a2,...,an]</code> into a loop, exposing the inner <code>foldr</code> of the <code>findIndices</code> definition, avoiding building the actual list structure of the result of the <code>findIndices</code> call:</p>\n\n<pre><code>build g = g (:) []\n\nfoldr c n $ build g = g c n\n\nfoldr c n $ findIndices p [a1,a2,...,an] \n== \nfoldr c n $ build g where {g c n = ...} \n= \ng c n where {g c n = ...} \n= \nfoldr go (const n) [a1,a2,...,an] 0 where {go x r k = ...} \n= \ngo a1 (foldr go (const n) [a2,...,an]) 0\n=\nlet { x=a1, r=foldr go (const n) [a2,...,an], k=0 }\nin\n  if | p x -&gt; c (I# k) (r (k +# 1#))     -- no 'cons' (`:`), only 'c'\n     | otherwise -&gt;     r (k +# 1#)     \n=\n....\n</code></pre>\n\n<p>So you see, it's a standard trick to have <code>foldr</code> define a <em>function</em> which expects one more <em>input</em> argument, to arrange the left-to-right information flow while processing the input list. </p>\n\n<p>All the stuff with the hash sign are \"primitive\" or \"closer-to-machine-level\" entities. <code>I#</code> is a <em>primitive <code>Int</code></em> constructor; <code>0#</code> is a machine-level <code>0</code>; etc.. This may or may not be exactly correct, but it should be close enough.</p>\n\n<hr>\n\n<p><code>foldr/build</code> fusion seems a particular case of <em>transducers</em>-based code transformation, which is based on the fact that nested folds are fused by composing their reducers' transformers (aka transducers), as in</p>\n\n<pre><code>foldr c n $\n  foldr (tr2 c2) n2 $\n    foldr (tr3 c3) n3 xs\n=\n  foldr (tr2 c) n $         -- fold \"replaces\" the constructor nodes with its reducer\n    foldr (tr3 c3) n3 xs    --   so just use the outer reducer in the first place!\n=\n    foldr (tr3 (tr2 c)) n xs\n=\n    foldr ((tr3 . tr2) c) n xs\n</code></pre>\n\n<p>and <code>build g === foldr . tr</code> for some appropriate choice of <code>tr</code> for a given <code>g</code>, so that</p>\n\n<pre><code>build g = g c n = (foldr . tr) c n = foldr (tr c) n\n</code></pre>\n\n<hr>\n\n<p>As for <code>USE_REPORT_PRELUDE</code>, again, I can't say this with any authority, but I always assumed that it is the compilation flag which is enabled when the mock definitions from the Haskell Report are used as actual code, even though they were intended as an executable specification.</p>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1523105054, "creation_date": 1523099038, "question_id": 49706694, "link": "https://stackoverflow.com/questions/49706694/explanation-of-the-findindices-function", "title": "Explanation of the findIndices function", "body": "<p>I said in <a href=\"https://stackoverflow.com/questions/49647062/finding-elements-and-their-indices-in-a-list\">this question</a> that I didn't understand the source code of <a href=\"https://hackage.haskell.org/package/base-4.11.0.0/docs/src/Data.OldList.html#findIndices\" rel=\"nofollow noreferrer\"><code>findIndices</code></a>. </p>\n\n<p>In fact I didn't pay enough attention and I didn't see that there are <em>two</em>  definitions of this function:</p>\n\n<pre><code>findIndices      :: (a -&gt; Bool) -&gt; [a] -&gt; [Int]\n#if defined(USE_REPORT_PRELUDE)\nfindIndices p xs = [ i | (x,i) &lt;- zip xs [0..], p x]\n#else\n-- Efficient definition, adapted from Data.Sequence\n{-# INLINE findIndices #-}\nfindIndices p ls = build $ \\c n -&gt;\n  let go x r k | p x       = I# k `c` r (k +# 1#)\n               | otherwise = r (k +# 1#)\n  in foldr go (\\_ -&gt; n) ls 0#\n#endif  /* USE_REPORT_PRELUDE */\n</code></pre>\n\n<p>I understand the first definition, the one I didn't see. I don't understand the second one. I have a couple of questions:</p>\n\n<ul>\n<li><p>what is <code>if defined(USE_REPORT_PRELUDE)</code> ?</p></li>\n<li><p>can one explain the second definition ? What are <code>build</code>, <code>I#</code>, <code>+#</code>, <code>1#</code> ?</p></li>\n<li><p>why the second definition is inlined, not the first one ?</p></li>\n</ul>\n"}, {"tags": ["haskell", "applicative", "monoids"], "answers": [{"comments": [{"owner": {"reputation": 2699, "user_id": 304435, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/38fb50d1c81b7a8ea1994bc02f695fef?s=128&d=identicon&r=PG", "display_name": "tesserakt", "link": "https://stackoverflow.com/users/304435/tesserakt"}, "edited": false, "score": 0, "creation_date": 1523547649, "post_id": 49705274, "comment_id": 86616113, "body": "I ended up with some non-instance functions to zip the list and then throw that result into a <code>ZipList&#39;</code>"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1523089244, "last_edit_date": 1523089244, "creation_date": 1523088273, "answer_id": 49705274, "question_id": 49704159, "link": "https://stackoverflow.com/questions/49704159/adding-a-monoid-constraint-to-a-hidden-variable/49705274#49705274", "title": "Adding a Monoid constraint to a hidden variable", "body": "<p>There's no need to append anything here. Don't build a list <code>Cons x Nil</code> and append list <code>y</code>, just build <code>Cons x y</code>.</p>\n\n<pre><code>let ZipList bs'' = ZipList' bs &lt;*&gt; ZipList' bs'\nin ZipList' (Cons (a a') bs'')\n</code></pre>\n\n<p>About the monoid-related error. It depends on which instance you are using for your type <code>ZipList'</code>. </p>\n\n<p>If you use something like</p>\n\n<pre><code>instance Monoid (ZipList' a) where\n   mempty = ZipList' Nil\n   mappend (ZipList' Nil) zs = zs\n   mappend (ZipList' (Cons x xs)) zs = let\n      ZipList' ys = mappend (Ziplist' xs) zs\n      in ZipList' (Cons x ys)\n</code></pre>\n\n<p>then there is no need for <code>Monoid a</code>.</p>\n\n<p>I think it all depends on what kind of monoid you want. The <code>Monoid (ZipList' a)</code> you mentioned appends each component of the two lists in a pointwise fashion, and for that we do need <code>Monoid a</code>. However, in the applicative instance you do not need that kind of append, you need list concatenation. This could be achieved using the above monoid instance, instead.</p>\n\n<p>That being said: the instance you posted, working pointwise, is probably the most natural for <code>ZipList</code>. Nothing however stops you to define a non-instance function</p>\n\n<pre><code>appendZipList' :: ZipList' a -&gt; ZipList' a -&gt; ZipList' a\n</code></pre>\n\n<p>and use that in your applicative instance, without relying on monoids.</p>\n\n<p>Otherwise, you could define <code>instance Monoid (List a)</code> for the concatenating append, and use that in the applicative instance</p>\n\n<pre><code>let ZipList' bs'' = ZipList' bs &lt;*&gt; ZipList' bs'\nin ZipList' (Cons (a a') Nil `mappend` bs'')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2699, "user_id": 304435, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/38fb50d1c81b7a8ea1994bc02f695fef?s=128&d=identicon&r=PG", "display_name": "tesserakt", "link": "https://stackoverflow.com/users/304435/tesserakt"}, "is_accepted": false, "score": 0, "last_activity_date": 1523547746, "creation_date": 1523547746, "answer_id": 49800751, "question_id": 49704159, "link": "https://stackoverflow.com/questions/49704159/adding-a-monoid-constraint-to-a-hidden-variable/49800751#49800751", "title": "Adding a Monoid constraint to a hidden variable", "body": "<p>I ended up eliminating the Monoid requirement and using a function on Lists which walked them and applied the funcs from the left to the values on the right. </p>\n\n<pre><code>zipForMyList :: List (t -&gt; a) -&gt; List t -&gt; List a\nzipForMyList _ Nil                   = Nil\nzipForMyList Nil _                   = Nil\nzipForMyList (Cons f fs) (Cons a as) = (Cons (f a) (zipForMyList fs as))\n\nrepeatMyList :: p -&gt; List p\nrepeatMyList x = xs where xs = Cons x xs\n\ninstance Applicative ZipList' where\n    pure a = ZipList' (Cons a Nil)\n    ZipList' Nil &lt;*&gt; _ = ZipList' Nil\n    _ &lt;*&gt; ZipList' Nil = ZipList' Nil\n    (ZipList' fs) &lt;*&gt; (ZipList' as) = ZipList' (zipForMyList fs as)\n</code></pre>\n"}], "owner": {"reputation": 2699, "user_id": 304435, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/38fb50d1c81b7a8ea1994bc02f695fef?s=128&d=identicon&r=PG", "display_name": "tesserakt", "link": "https://stackoverflow.com/users/304435/tesserakt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 49705274, "answer_count": 2, "score": 1, "last_activity_date": 1523547746, "creation_date": 1523078573, "last_edit_date": 1523103693, "question_id": 49704159, "link": "https://stackoverflow.com/questions/49704159/adding-a-monoid-constraint-to-a-hidden-variable", "title": "Adding a Monoid constraint to a hidden variable", "body": "<p>I'm in the Haskell Book chapter on <code>Applicative</code>. I am writing the <code>Applicative</code> instance for <code>ZipList</code> and I know I overthought it and am changing my approach. My old approach was:</p>\n\n<pre><code>data List a = Nil | Cons a (List a) deriving (Eq, Show)\n\nnewtype ZipList' a =\n    ZipList' (List a)\n    deriving (Eq, Show)\n\ninstance Applicative ZipList' where\n    pure a = ZipList' (Cons a Nil)\n    ZipList' Nil &lt;*&gt; _ = ZipList' Nil\n    _ &lt;*&gt; ZipList' Nil = ZipList' Nil\n    (ZipList' (Cons a bs)) &lt;*&gt; (ZipList' (Cons a' bs')) = (ZipList' (Cons (a(a')) Nil)) `mappend` (ZipList' bs &lt;*&gt; ZipList' bs')\n</code></pre>\n\n<p>I get the error:</p>\n\n<pre><code> No instance for (Monoid b) arising from a use of \u2018mappend\u2019\n      Possible fix:\n        add (Monoid b) to the context of\n          the type signature for:\n            (&lt;*&gt;) :: forall a b. ZipList' (a -&gt; b) -&gt; ZipList' a -&gt; ZipList' b\n    \u2022 In the expression:\n        (ZipList' (Cons (a (a')) Nil))\n          `mappend` (ZipList' bs &lt;*&gt; ZipList' bs')\n      In an equation for \u2018&lt;*&gt;\u2019:\n          (ZipList' (Cons a bs)) &lt;*&gt; (ZipList' (Cons a' bs'))\n            = (ZipList' (Cons (a (a')) Nil))\n                `mappend` (ZipList' bs &lt;*&gt; ZipList' bs')\n      In the instance declaration for \u2018Applicative ZipList'\u2019\n</code></pre>\n\n<p>I think this is because the <code>mappend</code> uses the <code>Monoid</code> for <code>ZipList</code> which is:</p>\n\n<pre><code>instance Monoid a =&gt; Monoid (ZipList' a) where\n    mempty = pure mempty\n    mappend = liftA2 mappend\n</code></pre>\n\n<p>which places a <code>Monoid</code> constraint on the <code>a</code>. In the <code>Applicative</code> instance I can't add the <code>a</code> to the class instance without it ceasing to be a proper <code>Applicative</code> instance definition. I know that the solution is incorrect, but it did make me think \"How would I add a <code>Monoid</code> constraint to the argument to <code>ZipList</code> in the <code>Applicative</code> instance?</p>\n"}, {"tags": ["haskell", "gadt"], "comments": [{"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 5, "creation_date": 1523084311, "post_id": 49703092, "comment_id": 86422836, "body": "Is there such a thing as a pointer to no location in your data type? I am asking this because the <code>unpointT</code> definition leads me to believe that cannot be the case. Thus, you might be able to derive a comonad instead, provided you can write a sound version of <code>extend</code>. Another idea would be to see if you can deal with the restriction using a technique such as outlined here <a href=\"http://okmij.org/ftp/Haskell/set-monad.html\" rel=\"nofollow noreferrer\">okmij.org/ftp/Haskell/set-monad.html</a>"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1523091959, "post_id": 49703092, "comment_id": 86424705, "body": "I think you&#39;ll need to be more specific about the definition of your <code>T</code> and <code>C</code> to get a definitive answer."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1523092102, "post_id": 49703092, "comment_id": 86424729, "body": "@BenjaminHodgson C is usually something like Binary and T is <a href=\"https://hackage.haskell.org/package/static-closure-0.1.0.0/docs/Control-Static-Closure.html#t:Closure\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/static-closure-0.1.0.0/docs/&hellip;</a>"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1523092141, "post_id": 49703092, "comment_id": 86424741, "body": "Put the definitions in your question"}, {"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1523100614, "post_id": 49703092, "comment_id": 86426955, "body": "do you think you could construct <code>T (a-&gt;b)</code> for your appT?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1523116193, "post_id": 49703092, "comment_id": 86431693, "body": "Other things that might have some relevance: (1) <a href=\"https://hackage.haskell.org/package/semigroupoids\" rel=\"nofollow noreferrer\">The <code>Apply</code> and <code>Bind</code> classes from <i>semigroupoids</i></a>; (2) <a href=\"https://github.com/leftaroundabout/constrained-categories/blob/master/README.md\" rel=\"nofollow noreferrer\">Some form of constrained monads</a>."}, {"owner": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "edited": false, "score": 0, "creation_date": 1523146199, "post_id": 49703092, "comment_id": 86439777, "body": "If you have <code>unpointT</code> then you have a sensible way of constructing <code>bindT</code>. But do you really have an unrestricted <code>apT</code>? It seems to be a <code>pureT</code> hidden there"}], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1523115360, "post_id": 49703469, "comment_id": 86431455, "body": "This is fundamentally right, but I feel it would be clearer to put it in a different way. On the one hand, it is perfectly possible for the right identity law to be satisfied as long as the type of <code>m</code> fits <code>C a =&gt; T a</code>; on the other hand, the law can&#39;t be applied if the type of <code>m</code> doesn&#39;t fit -- <code>\\m -&gt; bindT m pureT</code> has type <code>C a =&gt; T a -&gt; T a</code>. (My point is that <code>T</code> may well be a monad, but it can&#39;t be a <code>Monad</code> because of the constraint.)"}], "tags": [], "owner": {"reputation": 767, "user_id": 814796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZQemO.jpg?s=128&g=1", "display_name": "madgen", "link": "https://stackoverflow.com/users/814796/madgen"}, "is_accepted": false, "score": 0, "last_activity_date": 1523070763, "creation_date": 1523070763, "answer_id": 49703469, "question_id": 49703092, "link": "https://stackoverflow.com/questions/49703092/can-i-make-this-a-monad/49703469#49703469", "title": "Can I make this a Monad", "body": "<p>It won't work as it is as a monad as the right identity law is not satisfied.</p>\n\n<p><code>bindT m pureT</code> has type <code>C a =&gt; T a</code> while <code>m</code> has type <code>T a</code>. These two should always be equal but these are not even of the same type.</p>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1523070763, "creation_date": 1523066500, "last_edit_date": 1523067448, "question_id": 49703092, "link": "https://stackoverflow.com/questions/49703092/can-i-make-this-a-monad", "title": "Can I make this a Monad", "body": "<p>I've got a type <code>T</code> (which if you're interested, is a wrapper of static-pointers I've been exploring <a href=\"https://hackage.haskell.org/package/static-closure\" rel=\"noreferrer\">here</a>) where I can happily write the following operations for:</p>\n\n<pre><code>unpointT :: T a -&gt; a\napT :: T (a -&gt; b) -&gt; T a -&gt; T b\nbindT :: T a -&gt; (a -&gt; T b) -&gt; T b\n</code></pre>\n\n<p>The problem is, I don't have an unrestricted <code>pure</code> function. <code>pure</code> must be constrained by in my case, some constraint which says the type is serialisable, such as <code>Binary</code>. </p>\n\n<pre><code>pureT :: C a =&gt; a -&gt; T a\n</code></pre>\n\n<p>Note that both <code>apT</code> and <code>bindT</code> are unrestricted. </p>\n\n<p>This all looks fairly monad like, but with the only issue being the restricted pure. Is there anyway, perhaps with some <code>GADT</code> wrapping/unwrapping, that I can get this to work with the standard <code>Monad</code> hierarchy? </p>\n\n<p>If not, is there an alternate hierarchy that exists, that restricts <code>pure</code> but keeps <code>&lt;*&gt;</code> and <code>&gt;&gt;=</code> unrestricted?</p>\n\n<p>Note also that <code>T a</code> can still be valid for some <code>a</code> even though <code>pure (x :: a)</code> is not, for example by combining <code>T (b -&gt; a)</code> and <code>T b</code> with <code>ap</code>. </p>\n"}, {"tags": ["haskell", "idris"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1523062419, "post_id": 49702472, "comment_id": 86419216, "body": "<i>&quot;...what is an example...&quot;</i> What do you mean? Are you looking for a pre-existing library? Are you looking for a general use case?"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1523126868, "post_id": 49702472, "comment_id": 86435114, "body": "@AJFarmar I&#39;m looking for either something similar to the code I posted, or a documentation/example explaining how to check the type of a term in a String containing Idris code."}], "answers": [{"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1523120127, "post_id": 49705623, "comment_id": 86432946, "body": "I meant pure in the sense of not using system calls (i.e., working with strings)."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1523129714, "post_id": 49705623, "comment_id": 86435954, "body": "The commands on the blog you linked don&#39;t work for me. <code>cabal sandbox add-source ..&#47;Idris-dev</code> do not change the cabal file in any way (despite not showing an error). Trying to build the file gives import errors. Any suggestions? It has been a while since I last used Cabal."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 1, "creation_date": 1523198512, "post_id": 49705623, "comment_id": 86450942, "body": "@MaiaVictor The instructions given are for back when the commit that made Idris a library was just merged and you couldn&#39;t actually get it off Hackage. As of now, I&#39;d imagine you&#39;d just put <code>idris</code> in <code>build-depends</code>."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1523198976, "post_id": 49705623, "comment_id": 86451086, "body": "@pdxleif Link-only answers are not good answers. You should put enough <i>here</i> so that you can figure out what to do without having to follow the link (e.g. perhaps put a paraphrased version of the code block in the link here, and maybe even point out what the most important modules in the library do)."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1523219593, "post_id": 49705623, "comment_id": 86458329, "body": "@HTNW thanks! Sadly I&#39;m still not able to figure out how to make queries (typeof, evaluate, etc.) on Strings. Sorry if it should be obvious from those files."}], "tags": [], "owner": {"reputation": 1571, "user_id": 283260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/057e618fbf211a3733e9fef66030c0b9?s=128&d=identicon&r=PG", "display_name": "pdxleif", "link": "https://stackoverflow.com/users/283260/pdxleif"}, "is_accepted": false, "score": 2, "last_activity_date": 1523091277, "creation_date": 1523091277, "answer_id": 49705623, "question_id": 49702472, "link": "https://stackoverflow.com/questions/49702472/examples-of-using-idris-as-a-pure-haskell-library/49705623#49705623", "title": "Examples of using Idris as a pure Haskell library?", "body": "<p>There's an example of compiling a program via Idris as a library on this blog post.\n<a href=\"https://brianmckenna.org/blog/idris_library\" rel=\"nofollow noreferrer\">https://brianmckenna.org/blog/idris_library</a></p>\n\n<p>The <code>Idris</code> monad you see there is <code>StateT IState (ExceptT Err IO)</code> - IO with state and failure.\n<a href=\"https://github.com/idris-lang/Idris-dev/blob/master/src/Idris/AbsSyntaxTree.hs#L426\" rel=\"nofollow noreferrer\">https://github.com/idris-lang/Idris-dev/blob/master/src/Idris/AbsSyntaxTree.hs#L426</a>\nSo it wouldn't be \"pure\", unless perhaps you  wanted to go lower level?</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1523091277, "creation_date": 1523059295, "last_edit_date": 1523061962, "question_id": 49702472, "link": "https://stackoverflow.com/questions/49702472/examples-of-using-idris-as-a-pure-haskell-library", "title": "Examples of using Idris as a pure Haskell library?", "body": "<p>I'm aware it should be possible, but, because of the lack of documentation, it'd require some considerable reverse engineering effort to figure out. As such, what is an example of using Idris as a Haskell library? Possible usage illustration:</p>\n\n<pre><code>import Idris\n\ncode :: String\ncode = unlines [\n  \"data Nat : Type where                \",\n  \"  Zero : Nat -&gt; Nat                  \",\n  \"  Suc  : Nat                         \",\n  \"                                     \",\n  \"double : Nat -&gt; Nat                  \",\n  \"double Zero    = Zero                \",\n  \"double (Suc n) = Suc (Suc (double n))\",\n  \"                                     \",\n  \"n2 : Nat                             \",\n  \"n2 = double (Suc Zero)               \"]\n\nmain :: IO ()\nmain = do\n\n  -- prints \"Nat -&gt; Nat\"\n  print $ typeOf \"double\" code\n\n  -- prints \"Suc (Suc Zero)\"\n  print $ normOf \"n2\" code\n\n  -- prints the context of a hole at given index\n  print $ contextAt &lt;index&gt; code\n</code></pre>\n\n<p>Moreover, I wonder if such library would be pure (i.e., no system calls, String-based) and, thus, capable of being compiled by GHCJS. I've posted a <a href=\"https://stackoverflow.com/questions/49330226/is-it-possible-to-use-agda-as-a-library\">similar question</a> about Agda (which didn't get the answer I needed, although I wasn't as specific).</p>\n"}, {"tags": ["haskell", "typeerror"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1523054701, "post_id": 49701838, "comment_id": 86417511, "body": "No need to apologise in your question - there&#39;s nothing wrong in asking for help."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7338433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c1A7w.jpg?s=128&g=1", "display_name": "White_Sirilo", "link": "https://stackoverflow.com/users/7338433/white-sirilo"}, "edited": false, "score": 1, "creation_date": 1523055260, "post_id": 49701905, "comment_id": 86417664, "body": "Thanks buddy, you helped me the most today, you actually had the tolerance to answer to all my noob questions. If i had more rep i would +1 you but now i am so low i can&#39;t :P."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 6, "last_activity_date": 1523054472, "creation_date": 1523054472, "answer_id": 49701905, "question_id": 49701838, "link": "https://stackoverflow.com/questions/49701838/type-error-in-explicitly-typed-binding-haskell/49701905#49701905", "title": "Type error in explicitly typed binding - Haskell", "body": "<p>You are missing the second argument in the recursive call to <code>isIn</code>; it should be</p>\n\n<pre><code> | otherwise = isIn t s + 1\n --                   ^\n</code></pre>\n\n<p>While not an error, you also have a redundant base case; <code>s</code> and <code>_</code> are both irrefutable patterns, so just <code>isIn [] _ = 0</code> is sufficient.</p>\n\n<p>Also not an error, but there is no difference between <code>hof</code> and <code>isIn</code>, as you can eta-reduce the definition to</p>\n\n<pre><code>hof s = isIn s\n</code></pre>\n\n<p>and again to</p>\n\n<pre><code>hof = isIn\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7338433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c1A7w.jpg?s=128&g=1", "display_name": "White_Sirilo", "link": "https://stackoverflow.com/users/7338433/white-sirilo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1523088317, "creation_date": 1523053913, "last_edit_date": 1523088317, "question_id": 49701838, "link": "https://stackoverflow.com/questions/49701838/type-error-in-explicitly-typed-binding-haskell", "title": "Type error in explicitly typed binding - Haskell", "body": "<p>I've been struggling for like an hour to understand some things in higher order functions and now I am at the point that I cannot move any further because of this error:</p>\n\n<pre><code>    hof :: [Integer] -&gt; (Integer -&gt; Integer)\n    isIn :: [Integer] -&gt; Integer -&gt; Integer\n    isIn [] s = 0\n    isIn [] _ = 0\n    isIn (h:t) s\n        | h == s = 0 {-&lt;-------- error points here here-}\n        | otherwise = isIn(t) + 1\n    hof s = \\n -&gt; isIn s n\n\n      ERROR file:.\\Lab2.hs:111 - Type error in explicitly typed binding\n      *** Term           : isIn\n      *** Type           : [Integer] -&gt; Integer -&gt; Integer -&gt; Integer\n      *** Does not match : [Integer] -&gt; Integer -&gt; Integer\n</code></pre>\n"}, {"tags": ["haskell", "frp", "netwire"], "comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 1, "creation_date": 1523050294, "post_id": 49701058, "comment_id": 86416037, "body": "Your original formatting problem was because SO interprets 4 spaces as continuing a list entry. 8 spaces creates a code block in the entry. Also, HTML comments (<code>&lt;!-- foo --&gt;</code>) can act as spacers if you really need one."}], "answers": [{"tags": [], "owner": {"reputation": 2567, "user_id": 994206, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/699bacad8f85a069dda312cc29e03baa?s=128&d=identicon&r=PG", "display_name": "Mokosha", "link": "https://stackoverflow.com/users/994206/mokosha"}, "is_accepted": true, "score": 1, "last_activity_date": 1537740575, "creation_date": 1537740575, "answer_id": 52470678, "question_id": 49701058, "link": "https://stackoverflow.com/questions/49701058/what-invariants-am-i-supposed-to-maintain-when-using-control-wire-unsafe-event/52470678#52470678", "title": "What invariants am I supposed to maintain when using Control.Wire.Unsafe.Event?", "body": "<p>For a lot of these answers, \"correct\" or \"legal\" depends on what you want your application to do. \"Idiomatic\" might be a more interesting question, but as the library author has passed away, it's difficult to answer these questions definitively. The following therefore only represents my experience and may not be correct: </p>\n\n<ol>\n<li><p>The \"unsafe\" part of <a href=\"http://hackage.haskell.org/package/netwire-5.0.3/docs/Control-Wire-Unsafe-Event.html\" rel=\"nofollow noreferrer\"><code>Control.Wire.Unsafe.Event</code></a> is the idea that you will be working with discrete instances in time, and you may not necessarily preserve the continuous time semantics that your program expects. In particular, there's no difference (from a type perspective) between an event happening in a simulation with a time state (the <code>s</code> in <code>Wire s e m a b</code>) that's represented as an <code>Integer</code> vs a <code>Float</code>, so you have to be careful to make sure that what you're doing makes sense for your application. The included general purpose combinators don't have that risk in the sense that they work with any sensible definition of \"time\". From the documentation of <code>data Event</code>:</p>\n\n<blockquote>\n  <p>Denotes a stream of values, each together with time of occurrence. Since Event is commonly used for functional reactive programming it does not define most of the usual instances to protect continuous time and discrete event occurrence semantics.</p>\n</blockquote>\n\n<p>From the README:</p>\n\n<blockquote>\n  <p>If you are a framework developer you can import the <code>Control.Wire.Unsafe.Event</code> module to implement your own events. A game engine may include events for key presses or certain things happening in the scene. However, as an application developer you should view this type as being opaque. This is necessary in order to protect continuous time semantics. You cannot access event values directly.</p>\n</blockquote></li>\n<li><p>There's certainly nothing \"illegal\" about doing it that way. When you inhibit is totally dependent on your application. The key difference being that if you compose wires that inhibit, the inhibition \"bubbles up\" to the first wire that handles it (such as with an <code>Alternative</code>: <code>(&lt;|&gt;)</code>). Producing <code>NoEvent</code> is fine if there's no event. :) The behavior you're looking for might be better modeled using the existing combinators <code>dropWhileE</code> and <code>fmap</code> from <code>Control.Wire.Event</code> though:</p>\n\n<pre><code>mapMaybeE :: Monad m =&gt; (a -&gt; Maybe b) -&gt; Wire s e m (Event a) (Event b)\nmapMaybeE = arr (fmap fromJust) . dropWhileE isNothing . arr (fmap f)\n</code></pre></li>\n<li><p>Yes, <code>netwire</code> makes sense for any problem where you have to simulate the state of a system that has time-dependent semantics. To expand,</p>\n\n<blockquote>\n  <p>It shouldn't have to loop continuously until the time in the session is five seconds greater than when the event came in.</p>\n</blockquote>\n\n<p>Something is going to need to keep track of this timer, so you're not going to get around having a loop in one capacity or another. (Maybe you can have the operating system do it via a call to <code>sleep</code> or something, but internally there's still some loop somewhere...) <code>netwire</code> lets you model the behavior of your system explicitly and respond to these kinds of events: both network events and timer events. Because Haskell is lazy, if you compose wires such that \"really complicated wire\" depends on a timer, the result from \"really complicated wire\" will not be evaluated until the timer expires (see <a href=\"http://hackage.haskell.org/package/netwire-5.0.3/docs/Control-Wire-Interval.html\" rel=\"nofollow noreferrer\"><code>after</code></a>.)</p></li>\n</ol>\n"}], "owner": {"reputation": 899, "user_id": 1686629, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/783eacdab4a800eab9d786d5f5911fac?s=128&d=identicon&r=PG", "display_name": "Echo Nolan", "link": "https://stackoverflow.com/users/1686629/echo-nolan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "accepted_answer_id": 52470678, "answer_count": 1, "score": 5, "last_activity_date": 1537740575, "creation_date": 1523049283, "last_edit_date": 1523050147, "question_id": 49701058, "link": "https://stackoverflow.com/questions/49701058/what-invariants-am-i-supposed-to-maintain-when-using-control-wire-unsafe-event", "title": "What invariants am I supposed to maintain when using Control.Wire.Unsafe.Event?", "body": "<p>I'm using Netwire to write a program that is driven by events from the network. I guess there are three questions here:</p>\n\n<ol>\n<li><p>What makes <code>Control.Wire.Unsafe.Event</code> unsafe? Like the title says, what invariants do I need to maintain to use it safely?</p></li>\n<li><p>I decided I need something like this: <code>mapMaybeE :: Monad m =&gt; (a -&gt; Maybe b) -&gt; Wire s e m (Event a) (Event b)</code>. The context is I have messages coming in from the network and I want to respond to only some of them. This is what I wrote:</p>\n\n<pre><code>mapMaybeE :: Monad m =&gt; (a -&gt; Maybe b) -&gt; Wire s e m (Event a) (Event b)\nmapMaybeE f = arr go . arr (fmap f)\n  where go WU.NoEvent = WU.NoEvent\n        go (WU.Event Nothing) = WU.NoEvent\n        go (WU.Event (Just a)) = WU.Event a\n</code></pre>\n\n<p>Is that \"legal\"? Or am I supposed to inhibit if there's no event?</p></li>\n<li><p>Does Netwire make sense for this sort of problem? All the examples I've seen are of games that loop continuously. Here, I only want to step the wires when there's something to be done. Mostly, that will be network events, but I might also want to do things on a timer. E.g. an event comes in, then five seconds later the program does something. It shouldn't have to loop continuously until the time in the session is five seconds greater than when the event came in.</p></li>\n</ol>\n"}, {"tags": ["function", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 9517321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc52bd738d15863c94b001d51483099?s=128&d=identicon&r=PG&f=1", "display_name": "Aelin", "link": "https://stackoverflow.com/users/9517321/aelin"}, "edited": false, "score": 0, "creation_date": 1523047723, "post_id": 49700639, "comment_id": 86415006, "body": "I still have the same problem, and I think it&#39;s because of takeWhile (&lt; max) If the power = max, then it will not be included. For example: powers 5 5. How could I fix this?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 187, "user_id": 9517321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc52bd738d15863c94b001d51483099?s=128&d=identicon&r=PG&f=1", "display_name": "Aelin", "link": "https://stackoverflow.com/users/9517321/aelin"}, "edited": false, "score": 0, "creation_date": 1523048188, "post_id": 49700639, "comment_id": 86415208, "body": "@Aelin: by changing it to <code>&lt;=</code>. This was not completely clear from the problem description."}, {"owner": {"reputation": 187, "user_id": 9517321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc52bd738d15863c94b001d51483099?s=128&d=identicon&r=PG&f=1", "display_name": "Aelin", "link": "https://stackoverflow.com/users/9517321/aelin"}, "edited": false, "score": 0, "creation_date": 1523048445, "post_id": 49700639, "comment_id": 86415327, "body": "I actually tried to change it to <code>&lt;=</code> earlier, before fixing the 1 at the start. It works now, thanks. :)"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1523048252, "last_edit_date": 1523048252, "creation_date": 1523046872, "answer_id": 49700639, "question_id": 49700581, "link": "https://stackoverflow.com/questions/49700581/haskell-function-to-return-all-powers-of-a-number-until-a-given-maximum/49700639#49700639", "title": "Haskell function to return all powers of a number until a given maximum", "body": "<p>The problem is that your <code>myPowers</code> function starts with <code>n</code>, and not with <code>1</code>. For example:</p>\n\n<pre><code>Prelude&gt; take 10 $ myPowers 2\n[2,4,8,16,32,64,128,256,512,1024]\n</code></pre>\n\n<p>We can fix this with:</p>\n\n<pre><code>myPowers n = <b>1</b> : map (* n) (myPowers n)</code></pre>\n\n<p>Note that you can make this computationally more efficient with <a href=\"http://hackage.haskell.org/package/base-4.11.0.0/docs/Prelude.html#v:iterate\" rel=\"nofollow noreferrer\"><strong><code>iterate :: (a -&gt; a) -&gt; a -&gt; [a]</code></strong></a>, so you can define it as:</p>\n\n<pre><code>myPowers n = iterate (n*) 1</code></pre>\n\n<p>You should check the bound with <code>&lt;=</code> if you want allow powers that are <em>equal</em> to the bounds:</p>\n\n<pre><code>powers n max = takeWhile (<b>&lt;=</b> max) (myPowers n)</code></pre>\n\n<p>We then obtain sample output like:</p>\n\n<pre><code>Prelude&gt; powers 2 5\n[1,2,4]\nPrelude&gt; powers 2 6\n[1,2,4]\nPrelude&gt; powers 2 10\n[1,2,4,8]\nPrelude&gt; powers 3 10\n[1,3,9]\nPrelude&gt; powers 3 30\n[1,3,9,27]\nPrelude&gt; powers 5 30\n[1,5,25]\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 9517321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc52bd738d15863c94b001d51483099?s=128&d=identicon&r=PG&f=1", "display_name": "Aelin", "link": "https://stackoverflow.com/users/9517321/aelin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "accepted_answer_id": 49700639, "answer_count": 1, "score": 3, "last_activity_date": 1523048252, "creation_date": 1523046574, "question_id": 49700581, "link": "https://stackoverflow.com/questions/49700581/haskell-function-to-return-all-powers-of-a-number-until-a-given-maximum", "title": "Haskell function to return all powers of a number until a given maximum", "body": "<p>I'm making a function that returns all the powers of n that are less than or equal to max. For example: <code>powers 2 5</code> --> [1,2,4].</p>\n\n<pre><code>myPowers n = n : map (* n) (myPowers n) \n\npowers :: Int -&gt; Int -&gt; [Int]\npowers n max = takeWhile (&lt; max) (myPowers n)\n</code></pre>\n\n<p>At the moment <code>powers</code> is returning too few numbers. For example: <code>powers 2 6</code> should return 3 numbers, but is returning 2 numbers.</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1523041702, "post_id": 49699485, "comment_id": 86412277, "body": "If <code>n &lt; 0</code> it shifts an existing value. If <code>abs(n) &gt; len</code> it inserts at the start. If <code>n &gt; 0</code> it deletes. Do I have that right? If so, then this is a bizarre function. Could you post some sample input and output?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1523041881, "post_id": 49699485, "comment_id": 86412367, "body": "<code>Int</code> is a type, not a type constructor."}, {"owner": {"reputation": 9, "user_id": 7338433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c1A7w.jpg?s=128&g=1", "display_name": "White_Sirilo", "link": "https://stackoverflow.com/users/7338433/white-sirilo"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1523042050, "post_id": 49699485, "comment_id": 86412447, "body": "@chepner excuse me chepner i meant just Int :P"}, {"owner": {"reputation": 9, "user_id": 7338433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c1A7w.jpg?s=128&g=1", "display_name": "White_Sirilo", "link": "https://stackoverflow.com/users/7338433/white-sirilo"}, "reply_to_user": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1523042194, "post_id": 49699485, "comment_id": 86412503, "body": "@SilvioMayolo the sign of the value indicates if the shifting will be left or right. i just said that if the absolute value of the n is about to shift the element further than the length of the list, then it just put it at the start or end accordingly. Excuse me, my English are rusty, i hope you understand now"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523043783, "post_id": 49699485, "comment_id": 86413175, "body": "Would it be possible to make an attempt yourself?"}, {"owner": {"reputation": 9, "user_id": 7338433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c1A7w.jpg?s=128&g=1", "display_name": "White_Sirilo", "link": "https://stackoverflow.com/users/7338433/white-sirilo"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523044202, "post_id": 49699485, "comment_id": 86413351, "body": "@WillemVanOnsem i am probably trying that for hours now.. but nothing of what i wrote or thought about is worthy writing down here..."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523044853, "post_id": 49699485, "comment_id": 86413647, "body": "@White_Sirilo: yeah, but perhaps you can first try to implement a simpler function, for instance move an element one element to the right, etc."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7338433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c1A7w.jpg?s=128&g=1", "display_name": "White_Sirilo", "link": "https://stackoverflow.com/users/7338433/white-sirilo"}, "edited": false, "score": 0, "creation_date": 1523093350, "post_id": 49701891, "comment_id": 86425025, "body": "thanks buddy you wrote awesome stuff, I will check them I depth later, I think I got it now."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 2, "last_activity_date": 1523054384, "creation_date": 1523054384, "answer_id": 49701891, "question_id": 49699485, "link": "https://stackoverflow.com/questions/49699485/simple-function-that-shifts-specific-element-of-a-list/49701891#49701891", "title": "simple function that shifts specific element of a list", "body": "<p>As @WillemVanOnsem suggests, you may want to try writing a function that shifts a target element one space to the right.  Even this simplified problem might very well be challenging!</p>\n\n<p>See if you can implement a direct recursive version.  It could be similar in structure to your <code>delete</code> function, except it will <em>swap</em> two elements instead of dropping an element at the critical point.  (Answer at the bottom -- look for the definition of <code>simpleShiftRight</code>.)</p>\n\n<p>Once you've done that, try working through this alternative approach which has the advantage that it will more easily generalize to solving your original problem.</p>\n\n<p>First, using <code>delete</code> isn't very helpful, because <code>delete</code> \"forgets\" where the element originally was.  For example, both of the following:</p>\n\n<pre><code>delete '.' \"abc.def\"\ndelete '.' \"abcde.f\"\n</code></pre>\n\n<p>yield <code>\"abcdef\"</code>, and it's not clear how to use this result to, say, shift the period one position to the right of where it was.</p>\n\n<p>Instead, what you'd really like to do is break a string up into the parts before and after the target element.  That is, you'd like to define a function <code>split</code> that works like this:</p>\n\n<pre><code>&gt; split '.' \"abc.def\"\n(\"abc\",\"def\")\n&gt; split '.' \"abcde.f\"\n(\"abcde\",\"f\")\n</code></pre>\n\n<p>With this result, shifting the period becomes much easier.</p>\n\n<p>For example, if we wanted to shift the period one position to the right, we could start by defining a function</p>\n\n<pre><code>pairRight :: ([a], [a]) -&gt; ([a], [a])\n</code></pre>\n\n<p>that works like this:</p>\n\n<pre><code>&gt; pairRight (\"abc\",\"def\")\n(\"abcd\",\"ef\")\n&gt; pairRight (\"abcde\",\"f\")\n(\"abcdef\",\"\")\n</code></pre>\n\n<p>and a function</p>\n\n<pre><code>rejoin :: a -&gt; ([a], [a]) -&gt; [a]\n</code></pre>\n\n<p>that works like this:</p>\n\n<pre><code>&gt; rejoin '.' (\"abcd\",\"ef\")\n\"abcd.ef\"\n&gt; rejoin '.' (\"abcdef\",\"\")\n\"abcdef.\"\n</code></pre>\n\n<p>and combine them:</p>\n\n<pre><code>&gt; rejoin '.' (pairRight (split '.' \"abc.def\"))\n\"abcd.ef\"\n&gt; rejoin '.' (pairRight (split '.' \"abcde.f\"))\n\"abcdef.\"\n</code></pre>\n\n<p>to get a function that shifts a character one space to the right.</p>\n\n<p>Now, <code>split</code> can be defined in terms of the library function <code>break</code>, like so:</p>\n\n<pre><code>split :: Eq a =&gt; a -&gt; [a] -&gt; ([a], [a])\nsplit x xs = let (a, _:b) = break (==x) xs in (a,b)\n</code></pre>\n\n<p>Can you implement the functions <code>pairRight</code> and <code>rejoin</code>?  They shouldn't be too hard, but if you get stuck the answer's at the bottom.</p>\n\n<p>You might also want to try defining <code>split</code> from scratch without using <code>break</code>.  It's a slightly tricky recursive function.  If you start with an \"obvious\" approach:</p>\n\n<pre><code>split :: Eq a =&gt; a -&gt; [a] -&gt; ([a], [a])\nsplit x (y:ys) | x == y    = (..., ys)\n               | otherwise = split x ys\nsplit _ [] = error \"split: target not found\"\n</code></pre>\n\n<p>you'll run into a problem.  It's not clear how to fill in the <code>...</code> because you've sort of thrown away the start of the list in the recursion.  Hopefully you've already learned that one way around this is to introduce an extra parameter to keep track of the list elements already processed and define a function:</p>\n\n<pre><code>split' :: Eq a =&gt; a -&gt; [a] -&gt; [a] -&gt; ([a], [a])\nsplit' x ls (r:rs) = ...\n</code></pre>\n\n<p>where <code>x</code> is the element we're looking for, <code>ls</code> is the set of elements on the left side of the list that we've already processed (where we didn't find a copy of <code>x</code>), and <code>(r:rs)</code> is the right side of the list that we're still processing.</p>\n\n<p>If you need a further hint, here's a template:</p>\n\n<pre><code>split' x ls (r:rs) | x == r    = (..., ...)\n                   | otherwise = split' x (...) rs\nsplit' _ _ [] = error \"split: target not found\"\n</code></pre>\n\n<p>Can you fill in the <code>...</code> here?  If you can, then you can define:</p>\n\n<pre><code>split :: Eq a =&gt; a -&gt; [a] -&gt; ([a], [a])\nsplit x xs = split' x [] xs\n</code></pre>\n\n<p>Once you have <code>split</code>, <code>pairRight</code>, and <code>rejoin</code> defined, you should be able to combine them into a function:</p>\n\n<pre><code>shiftRight :: Eq a =&gt; a -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>that can shift a target element one position to the right.</p>\n\n<p>If you get stuck, here's a complete definition of <code>shiftRight</code> and its\nhelpers:</p>\n\n<pre><code>shiftRight :: (Eq a) =&gt; a -&gt; [a] -&gt; [a]\nshiftRight x xs = rejoin x (pairRight (split x xs))\n\n-- alternative definition of split:\n-- split :: Eq a =&gt; a -&gt; [a] -&gt; ([a], [a])\n-- split x xs = let (a, _:b) = break (==x) xs in (a,b)\n\nsplit :: Eq a =&gt; a -&gt; [a] -&gt; ([a], [a])\nsplit x xs = split' x [] xs\n\nsplit' :: Eq a =&gt; a -&gt; [a] -&gt; [a] -&gt; ([a], [a])\nsplit' x ls (r:rs) | x == r    = (ls, rs)\n           | otherwise = split' x (ls ++ [r]) rs\nsplit' _ _ [] = error \"split: target not found\"\n\npairRight :: ([a], [a]) -&gt; ([a], [a])\npairRight (ls, r:rs) = (ls ++ [r], rs)\n\nrejoin :: a -&gt; ([a], [a]) -&gt; [a]\nrejoin x (ls, rs) = ls ++ [x] ++ rs\n</code></pre>\n\n<p>In this version, trying to <code>shiftRight</code> a target that isn't in the list or that is already in the rightmost position will give an error.  You might want to try fixing that.  (Note that <code>split</code> could return a <code>Maybe [a]</code>, yielding <code>Nothing</code> if the target isn't found; it also shouldn't be too tough to modify <code>pairRight</code> so that it does nothing if the pair is already shifted right as far as it can go.)</p>\n\n<p>If this seems like a lot of bother for a simple problem, I guess it is.  In real code, an experienced Haskell programmer would probably write a direct recursive version:</p>\n\n<pre><code>simpleShiftRight :: (Eq a) =&gt; a -&gt; [a] -&gt; [a]\nsimpleShiftRight x (y:z:rest) | x == y    = z:y:rest\n                              | otherwise = y : simpleShiftRight x (z:rest)\nsimpleShiftRight _ rest                   = rest\n</code></pre>\n\n<p>or this one that uses <code>break</code>:</p>\n\n<pre><code>simpleShiftRight :: (Eq a) =&gt; a -&gt; [a] -&gt; [a]\nsimpleShiftRight x xs = case break (==x) xs of\n  (ls, y:z:rs) -&gt; ls ++ z:y:rs\n  _ -&gt; xs\n</code></pre>\n\n<p>Both versions are succinct, handle all the corner cases, and are \"obviously correct\".  The downside, as previously mentioned, is that this version isn't quite as easy to generalize to your original problem.</p>\n\n<p>The version above does generalize pretty easily -- you just need to replace <code>pairRight</code> with a more sophisticated pair shifting function.  For example, defining:</p>\n\n<pre><code>pairRightN :: Int -&gt; ([a],[a]) -&gt; ([a],[a])\npairRightN n (ls, r:rs) | n &gt; 0 = pairRightN (n-1) (ls ++ [r], rs)\npairRightN _ (ls, rs)           = (ls, rs)\n</code></pre>\n\n<p>allows you to handle all positive values for <code>n</code> (i.e., all right shifts, no matter how big).  It's not too hard to further generalize it to handle left shifts, too.</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 7338433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c1A7w.jpg?s=128&g=1", "display_name": "White_Sirilo", "link": "https://stackoverflow.com/users/7338433/white-sirilo"}, "edited": false, "score": 0, "creation_date": 1523098896, "post_id": 49702963, "comment_id": 86426530, "body": "simple, helpfull and enlightening answer, thanks for your time it helped me a lot."}], "tags": [], "owner": {"reputation": 92, "user_id": 9505816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f418e4dd8af026e74ed5b49889d126e8?s=128&d=identicon&r=PG&f=1", "display_name": "tudatn", "link": "https://stackoverflow.com/users/9505816/tudatn"}, "is_accepted": false, "score": 0, "last_activity_date": 1523065112, "creation_date": 1523065112, "answer_id": 49702963, "question_id": 49699485, "link": "https://stackoverflow.com/questions/49699485/simple-function-that-shifts-specific-element-of-a-list/49702963#49702963", "title": "simple function that shifts specific element of a list", "body": "<p>For you are new to Haskell, it's better to break the problem into simpler subproblems. One trick to solve your problem is:</p>\n\n<pre><code>thinking of \"insert\" instead of \"shift\". Pseudo code:\n- remove x from the list\n- insert x back to the list at the proper position based on given n\n</code></pre>\n\n<p>You already implement delete, lets take advantage of it. Enjoy simple code:</p>\n\n<pre><code>-- assume x is in the list, otherwise your problem would not make sense\nshift :: Eq a =&gt; a-&gt;[a]-&gt;Int-&gt;[a]\nshift x lst n = if n == 0 then delete x lst \n                else insert x (n + (position x lst)) (delete x lst)\n</code></pre>\n\n<p>Sub-problems are:</p>\n\n<pre><code>1. Delete x from the list: you did that\n  delete :: Eq a =&gt; a-&gt;[a]-&gt;[a]\n  delete x []          = []\n  delete x (head:tail) = if x == head then tail else head : delete x tail\n\n2. find the position of x in the list\n  -- assume x in the list\n  position :: Eq a =&gt; a-&gt;[a]-&gt;Int\n  position x (head:tail) = if x == head then 1 else 1 + position x tail\n\n3. -- insert x into the list at nth position\n  insert :: a-&gt;Int-&gt;[a]-&gt;[a]\n  insert x n (head:tail) = if n &lt;= 1 then x : (head:tail) \n                           else head : (insert x (n-1) tail)\n  insert x n lst         = if n &gt;= length lst then lst ++ [x] \n                           else insert x n lst\n</code></pre>\n\n<p>Your precondition is that x is in the list, otherwise it does not make sense. If you want to include the case x is not in the list, twist the code.</p>\n\n<p>Have fun.</p>\n"}], "owner": {"reputation": 9, "user_id": 7338433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c1A7w.jpg?s=128&g=1", "display_name": "White_Sirilo", "link": "https://stackoverflow.com/users/7338433/white-sirilo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 541, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1523118116, "creation_date": 1523041312, "last_edit_date": 1523118116, "question_id": 49699485, "link": "https://stackoverflow.com/questions/49699485/simple-function-that-shifts-specific-element-of-a-list", "title": "simple function that shifts specific element of a list", "body": "<p>I am new to Haskell and I am trying to figure out how to make a function:</p>\n\n<pre><code>    shift:: Eq a =&gt; a -&gt; [a] -&gt; Int -&gt; [a]\n    shift x (h:t) z\n</code></pre>\n\n<blockquote>\n  <p>Input: a generic list and an element x of the same type</p>\n  \n  <p>Precondition: element x exists in the list</p>\n  \n  <p>Output: </p>\n  \n  <blockquote>\n    <p>if n &lt; 0, shift x left by n until reach the first of the list</p>\n    \n    <p>if n > 0, shift x right by n until reach the last of the list</p>\n    \n    <p>if n == 0, remove x from the list (always talking about the first appearance of x, it could be shown more than 1 time in the list).</p>\n  </blockquote>\n</blockquote>\n\n<p>Keep in mind that i have completed my delete function</p>\n\n<pre><code>    delete :: Eq b =&gt; b -&gt; [b] -&gt; [b]\n</code></pre>\n\n<p>that finds the first appearance of the desired element and deletes it. I could use delete inside shift i guess. Any kind of help is appreciated.</p>\n\n<p><strong>[some I/O samples]</strong></p>\n\n<pre><code>     Main&gt; shift 3 [] 5\n     []\n     Main&gt; shift 0 [1,2,3,4] 4\n     [1,2,3,4]\n     Main&gt; shift 3 [1,2,3,4,3,2,1] 3\n     [1,2,4,3,2,3,1]\n     Main&gt; shift 6 [1,2,3,4,5,6,7,8] 7\n     [1,2,3,4,5,7,8,6]\n     Main&gt; shift 'k' \"skin\" 0\n     \"sin\"\n     Main&gt; shift '.' \"factor.bit.\" (-2)\n     \"fact.orbit.\"\n     Main&gt; shift '.' \"0000.1111.00\" (-10)\n     \".00001111.00\"\n     Main&gt; shift \"one\" [\"one\", \"two\", \"three\"] (-2)\n     [\"one\",\"two\",\"three\"]\n     Main&gt; shift \"one\" [\"one\", \"two\", \"three\"] 1\n     [\"two\",\"one\",\"three\"]\n     Main&gt; shift \"three\" [\"one\", \"two\", \"three\"] 5\n     [\"one\",\"two\",\"three\"]\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1523033699, "post_id": 49697619, "comment_id": 86408195, "body": "What is your question?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523033750, "post_id": 49697619, "comment_id": 86408226, "body": "But here you calll <code>subs</code> in terms of <code>subs</code>, so that <i>is</i> a recursive function."}, {"owner": {"reputation": 6566, "user_id": 3565885, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/BetMM.jpg?s=128&g=1", "display_name": "acontell", "link": "https://stackoverflow.com/users/3565885/acontell"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1523034108, "post_id": 49697619, "comment_id": 86408417, "body": "@ThomasM.DuBuisson my question is the recursive solution of the problem"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523034131, "post_id": 49697619, "comment_id": 86408428, "body": "@acontell: and what is not recursive about your solution? <code>subs</code> is a recursive function, and <code>filter</code> is recursive as well."}, {"owner": {"reputation": 6566, "user_id": 3565885, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/BetMM.jpg?s=128&g=1", "display_name": "acontell", "link": "https://stackoverflow.com/users/3565885/acontell"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523034213, "post_id": 49697619, "comment_id": 86408467, "body": "@WillemVanOnsem Yes, indeed. But the length of my recursive function is 2 to the power of n. However, the exercise states that choose n xs has length nk"}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 4, "last_activity_date": 1523034222, "creation_date": 1523034222, "answer_id": 49697796, "question_id": 49697619, "link": "https://stackoverflow.com/questions/49697619/recursive-definition-of-function-choose-k-xs/49697796#49697796", "title": "Recursive definition of function choose k xs", "body": "<p>I think you are asking:</p>\n\n<blockquote>\n  <p>What is a lone, recursive function solution to this problem?</p>\n</blockquote>\n\n<p>These problems usually can be solved if you mentally walk through the base and recursive cases carefully.  For example:</p>\n\n<p>Choose is a function from ints and list of values to a list of lists of values:</p>\n\n<pre><code>choose :: Int -&gt; [a] -&gt; [[a]]\n</code></pre>\n\n<p>If the result is supposed to be 0 length then there is exactly one sublist of said length:</p>\n\n<pre><code>choose 0 _ = [ [] ]\n</code></pre>\n\n<p>If the result is non-zero but we have no more characters with which to make a sublist then there are no solutions:</p>\n\n<pre><code>choose _ [] = []\n</code></pre>\n\n<p>Otherwise we can take the first character and append that to all solutions of length one shorter:</p>\n\n<pre><code>choose n (x : xs) =\n    map (x :) (choose (n - 1) xs)\n</code></pre>\n\n<p>Or we discard this character (ex, drop 'l' and get the result \"ist\") and look for a solution with the substring:</p>\n\n<pre><code>      ++ choose n xs\n</code></pre>\n"}], "owner": {"reputation": 6566, "user_id": 3565885, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/BetMM.jpg?s=128&g=1", "display_name": "acontell", "link": "https://stackoverflow.com/users/3565885/acontell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 49697796, "answer_count": 1, "score": 2, "last_activity_date": 1523036209, "creation_date": 1523033433, "last_edit_date": 1523036209, "question_id": 49697619, "link": "https://stackoverflow.com/questions/49697619/recursive-definition-of-function-choose-k-xs", "title": "Recursive definition of function choose k xs", "body": "<p>I'm trying to solve the following problem found in \"Introduction to functional programming\" First edition Bird-Wadler.</p>\n\n<blockquote>\n  <p>5 .6.2 The function choose k xs returns a list of all subsequences of xs whose\n  length is exactly k. For example:\n  ? choose 3 \"list\"\n  [\"ist\" , \"lst\" , \"lit\" , \"lis\"]\n  Give a recursive definition of choose. Show that if xs has length n then\n  choose k xs has length nk</p>\n</blockquote>\n\n<p>I only could come up with a non-recursive solution based on a function that returns the list of subsets of an array:</p>\n\n<pre><code>subs :: [a] -&gt; [[a]]\nsubs [] = [[]]\nsubs (x:xs) = subs xs ++ map (x:) (subs xs)\n\nchoose :: Int -&gt; [a] -&gt; [[a]]\nchoose x = filter ((== x) . length) . subs\n</code></pre>\n"}, {"tags": ["haskell", "recursion", "io", "tail-recursion"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1523043627, "post_id": 49697277, "comment_id": 86413112, "body": "Formatting nitpicking: &lt;!-- language: lang-haskell --&gt; <a href=\"https://meta.stackoverflow.com/q/267272/2751851\">doesn&#39;t actually add Haskell highlighting</a>."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1523033272, "last_edit_date": 1523033272, "creation_date": 1523032993, "answer_id": 49697507, "question_id": 49697277, "link": "https://stackoverflow.com/questions/49697277/read-io-string-and-return-custom-data-type-list-in-haskell/49697507#49697507", "title": "Read IO String and return custom data type list in Haskell", "body": "<p>This code</p>\n\n<pre><code>readCards :: IO [Card]\nreadCards = return (returnCardList [])\n</code></pre>\n\n<p>is stating that <code>readCards</code> is an IO computation that does not actually do IO. Indeed <code>return something</code> implies that no IO is being performed, and that <code>something</code> is a pure value of type <code>[Card]</code>.</p>\n\n<p>This is not what you want. You need something like</p>\n\n<pre><code>readCards :: IO [Card]\nreadCards = returnCardList []\n</code></pre>\n\n<p>Consequently, the IO must be done by <code>returnCardList</code>, which must now have the type</p>\n\n<pre><code>returnCardList :: [Card] -&gt; IO [Card]\n                         -- ^^ we do perform IO here!\n</code></pre>\n\n<p>Your own implementation should work, roughly</p>\n\n<pre><code>    returnCardList acc = do \n       line &lt;- getLine\n       if line == \".\"\n       then return acc\n         -- ^^^^^^ turn the plain value into an IO computation\n       else returnCardList ((convertCard (line !! 0) (line !! 1)):acc)\n</code></pre>\n\n<p>This can be rewritten as follows: </p>\n\n<pre><code>    returnCardList acc = do \n       line &lt;- getLine\n       case line of\n          \".\" -&gt; return acc\n          (c1:c2:_) -&gt; returnCardList (convertCard c1 c2 : acc)\n          _ -&gt; ... -- you should handle here the other cases (length &lt; 2)\n</code></pre>\n\n<p>Note that you can also do without an <code>acc</code> parameter:</p>\n\n<pre><code>    returnCardList = do \n       line &lt;- getLine\n       case line of\n          \".\" -&gt; return []\n          (c1:c2:_) -&gt; (convertCard c1 c2 :) &lt;$&gt; returnCardList\n          _ -&gt; ... -- you should handle here the other cases (length &lt; 2)\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 5786712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/07KNp.jpg?s=128&g=1", "display_name": "Elif Ak", "link": "https://stackoverflow.com/users/5786712/elif-ak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 506, "favorite_count": 0, "accepted_answer_id": 49697507, "answer_count": 1, "score": 0, "last_activity_date": 1523043622, "creation_date": 1523032195, "last_edit_date": 1523043622, "question_id": 49697277, "link": "https://stackoverflow.com/questions/49697277/read-io-string-and-return-custom-data-type-list-in-haskell", "title": "Read IO String and return custom data type list in Haskell", "body": "<p>I am beginner in Haskell and I struggle with IO operations. I should get IO String from user until user send \".\" (point) character. I will use these inputs to transform Custom Data Type, naming Card, by parsing the String. And then I will add the Card to the list. When user types the \".\", I will send whole Card List. Haskell code is below:</p>\n\n<pre><code>readCards :: IO [Card]\nreadCards = return (returnCardList [])\n    where \n        returnCardList :: [Card] -&gt; [Card]\n        returnCardList acc =  do line &lt;- getLine\n                                 if line == \".\"\n                                 then acc\n                                 else returnCardList ((convertCard (line !! 0) (line !! 1)):acc)\n</code></pre>\n\n<p><code>convertCard</code> is a function which takes two <code>char</code> and return <code>Card</code>. Also <code>acc</code> stand for accumulator for tail recursion function (It is not necessary to implement with tail recursion, I just chose it).</p>\n\n<p>For example <code>returnCardList 'h' 'q'</code> gives <code>Card {suit=Hearts, rank=Queen}</code></p>\n\n<p>However above code partition gives an error: </p>\n\n<pre><code> Couldn't match type `IO' with `[]'\n Expected type: [String]\n Actual type: IO String\n</code></pre>\n\n<p>However below code (with dummy Card List) run properly:</p>\n\n<pre><code>readCards :: IO [Card]\nreadCards = return [Card {suit=Clubs, rank=King}, Card {suit=Clubs, rank=Ace}, Card {suit=Clubs, rank=Jack}]\n</code></pre>\n\n<p>I read a lot of things but I couldn't solve it. I am really wonder what I miss. </p>\n"}, {"tags": ["haskell", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 5, "creation_date": 1523023141, "post_id": 49693983, "comment_id": 86401511, "body": "(1) Nitpicking: the change in behaviour with respect to &quot;hold[ing]&quot; on is not due to an essential difference between GHCi and GHC, but rather due to <a href=\"https://stackoverflow.com/q/32496864/2751851\">the monomorphism restriction</a>, which is enabled by default for compiled programs but not in GHCi. If you turn it on in GHCi (with <code>:set -XMonomorphismRestriction</code>), you get the other behaviour. (2) For an example of something with a <code>Num (t a)</code> instance that fits <code>val3</code>, see <a href=\"https://hackage.haskell.org/package/base-4.11.0.0/docs/Data-Monoid.html#g:3\" rel=\"nofollow noreferrer\"><code>Sum</code> and <code>Product</code> from <code>Data.Monoid</code></a>."}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 1, "last_activity_date": 1523023671, "last_edit_date": 1523023671, "creation_date": 1523021437, "answer_id": 49693983, "question_id": 49693687, "link": "https://stackoverflow.com/questions/49693687/why-is-ghci-accepting-something-at-the-prompt-that-wont-compile/49693983#49693983", "title": "Why is GHCi accepting something at the prompt that won&#39;t compile?", "body": "<p>Your <code>val3</code> is generic. It's a generic value of type <code>Kung t a</code>, where <code>t</code> and <code>a</code> are not known yet. GHCi accepts it fine, because it can hold onto it and wait until you supply the concrete <code>t</code> and <code>a</code>. And indeed, as soon as you try to use the value (by printing it out) without supplying the types, GHCi bails on you.</p>\n\n<p>But GHC cannot afford to \"hold on\": it needs to know the types in order to finish compilation.</p>\n\n<p>You could remedy the situation by telling the compiler explicitly that you would like to have yourself a generic value, which could later be consumed by a consumer, who would be willing to supply suitable types. To do this, use a type annotation:</p>\n\n<pre><code>val3 :: Num (t a) =&gt; Kung t a\nval3 = Kung { field = 3 }\n</code></pre>\n\n<p>Behind the scenes, such definition would be compiled as a function that takes a dictionary <code>Num (t a)</code> and returns a value of type <code>Kung t a</code>.</p>\n\n<hr>\n\n<p>To answer the question \"<em>how did GHCi manage to \"decompose\"/\"deconstruct\" the value 3</em>\" (I'm adding this answer here, but I'm not sure if that's what you're asking).</p>\n\n<p>Number literals are polymorphic in Haskell as well. When you write <code>3</code>, the compiler understands that as <code>fromInteger (3::Integer)</code>, where <code>fromInteger</code> is a function from the <code>Num</code> class. This means that, theoretically, a literal <code>3</code> may have any type at all, as long as that type has a <code>Num</code> instance defined.</p>\n\n<p>So when you write something <code>Kung { field = 3 }</code>, the compiler sees that as <code>Kung { field = fromInteger 3 }</code>, and this could very well be of any type <code>Kung t a</code>, if only the compiler could prove that there is a <code>Num</code> instance for type <code>t a</code>, which it can use to convert <code>3</code> to <code>t a</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 6, "last_activity_date": 1523023416, "creation_date": 1523023416, "answer_id": 49694631, "question_id": 49693687, "link": "https://stackoverflow.com/questions/49693687/why-is-ghci-accepting-something-at-the-prompt-that-wont-compile/49694631#49694631", "title": "Why is GHCi accepting something at the prompt that won&#39;t compile?", "body": "<p>This is the Dreaded Monomorphism Restriction at work. The following compiles fine:</p>\n\n<pre><code>data Kung t a = Kung { field :: t a } deriving (Show, Eq)\n\nval3 :: Num (t a) =&gt; Kung t a\nval3 = Kung { field =  3 }\n</code></pre>\n\n<p>however, the <a href=\"https://wiki.haskell.org/Monomorphism_restriction\" rel=\"noreferrer\">monomorphism restriction</a> prevents GHC from inferring this signature itself. Instead, it tries to find a <em>monomorphic</em> type. For this it only has the Haskell <em>defaulting rules</em> available. Normally, these imply that a <code>Num</code>-constrained type variable is monomorphised to <code>Integer</code>... but integer is not of the form <code>t a</code>, so this fails.</p>\n\n<p>The <em>correct</em> fix is to, indeed, write the type signature yourself, but you can also turn off the monomorphism restriction:</p>\n\n<pre><code>{-# LANGUAGE NoMonomorphismRestriction #-}\n\ndata Kung t a = Kung { field :: t a } deriving (Show, Eq)\n\nval3 = Kung { field =  3 }\n</code></pre>\n\n<p>In GHCi, the monomorphism restriction is turned off by default since, GHC-7.8 I believe it was. That's why the problem doesn't arise there.</p>\n"}], "owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 49694631, "answer_count": 2, "score": 1, "last_activity_date": 1523023671, "creation_date": 1523020493, "last_edit_date": 1523022412, "question_id": 49693687, "link": "https://stackoverflow.com/questions/49693687/why-is-ghci-accepting-something-at-the-prompt-that-wont-compile", "title": "Why is GHCi accepting something at the prompt that won&#39;t compile?", "body": "<p>I'm trying to play around with Haskell types, creating a data taking a type constructor and a concrete type (inspired by <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses#the-functor-typeclass\" rel=\"nofollow noreferrer\">this</a>).</p>\n\n<p>Here is my kung.hs file: </p>\n\n<pre><code>data Kung t a = Kung { field :: t a } deriving (Show, Eq)\n\nval1 = Kung { field = [1,5] }\n\nval2 = Kung { field =  Just 3 }\n\n--val3 = Kung { field =  3 }\n</code></pre>\n\n<p>It compiles fine and loads ok: </p>\n\n<pre><code>*Main&gt; :load C:\\Test\\Haskell\\kung.hs\n[1 of 1] Compiling Main             ( C:\\Test\\Haskell\\kung.hs, interpreted )\nOk, one module loaded.\n*Main&gt; val1\nKung {field = [1,5]}\n*Main&gt; val2\nKung {field = Just 3}\n*Main&gt;\n</code></pre>\n\n<p>Now the same version, but uncommenting <code>val3</code>:</p>\n\n<pre><code>data Kung t a = Kung { field :: t a } deriving (Show, Eq)\n\nval1 = Kung { field = [1,5] }\n\nval2 = Kung { field =  Just 3 }\n\nval3 = Kung { field =  3 }\n</code></pre>\n\n<p>This does not compile : </p>\n\n<pre><code>*Main&gt; :load C:\\Test\\Haskell\\kung.hs\n[1 of 1] Compiling Main             ( C:\\Test\\Haskell\\kung.hs, interpreted )\n\nC:\\Test\\Haskell\\kung.hs:7:24: error:\n    * No instance for (Num (t0 a0)) arising from the literal `3'\n    * In the `field' field of a record\n      In the expression: Kung {field = 3}\n      In an equation for `val3': val3 = Kung {field = 3}\n  |\n7 | val3 = Kung { field =  3 }\n  |                        ^\nFailed, no modules loaded.\n</code></pre>\n\n<p>which seems fine. There is no way to \"decompose\" / \"construct\"  (maybe not the right terminology used here)  the value <code>3</code> of type <code>Num</code> from  some type constructor and some concrete type. </p>\n\n<p>Going back to the GHCi interpreter, load the first version of the file without the <code>val3</code> commented and then: </p>\n\n<pre><code>Prelude&gt; :load C:\\Test\\Haskell\\kung.hs\n[1 of 1] Compiling Main             ( C:\\Test\\Haskell\\kung.hs, interpreted )\nOk, one module loaded.\n*Main&gt; val3 = Kung { field =  3 }\n*Main&gt; :t val3\nval3 :: Num (t a) =&gt; Kung t a\n</code></pre>\n\n<p>How should I understand that? Why did GHCi artificially \"manage\" to decompose <code>3</code>? (without giving a real type) </p>\n\n<p>Then this <code>val3</code> does not really seem viable: </p>\n\n<pre><code>*Main&gt; val3\n\n&lt;interactive&gt;:50:1: error:\n    * Ambiguous type variables `t0', `a0' arising from a use of `print'\n      prevents the constraint `(Show (t0 a0))' from being solved.\n      Probable fix: use a type annotation to specify what `t0', `a0' should be.\n      These potential instances exist:\n        instance (Show b, Show a) =&gt; Show (Either a b)\n          -- Defined in `Data.Either'\n        instance [safe] Show (t a) =&gt; Show (Kung t a)\n          -- Defined at C:\\Test\\Haskell\\kung.hs:1:49\n        instance Show a =&gt; Show (Maybe a) -- Defined in `GHC.Show'\n        ...plus 15 others\n        ...plus one instance involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    * In a stmt of an interactive GHCi command: print it\n*Main&gt;\n</code></pre>\n\n<p>What is the subtlety happening here? </p>\n"}, {"tags": ["haskell", "typeerror"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1523018047, "post_id": 49692885, "comment_id": 86398015, "body": "I think it probably would help a lot if <i>before</i> writing list processing algorithms, you have a basic understanding of how lists are represented. You have a nice article here <a href=\"http://learnyouahaskell.com/starting-out\" rel=\"nofollow noreferrer\">learnyouahaskell.com/starting-out</a> Sure you do not need to have an in-depth understanding into how the Haskell ccompiler works, or how category theory is related to Haskell, etc. but it usually helps to have some insight first."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1523018112, "post_id": 49692885, "comment_id": 86398064, "body": "There are here two things wrong: you do not process the base case <code>[]</code> (the empty list, and furthermore <code>[l] : delete (r k)</code> does not makes much sense since <code>l</code> is an element, you probably want to rewrite that to <code>l : delete r k</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1523018347, "post_id": 49692885, "comment_id": 86398242, "body": "You want to compare <code>r</code> and <code>l</code>, not ignore <code>l</code> and look for <code>r</code> inside <code>k</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1523019316, "post_id": 49692885, "comment_id": 86398940, "body": "@WillemVanOnsem One more variation on the <a href=\"https://stackoverflow.com/q/48884276/2751851\"><i>Why doesn&#39;t this function work if I use \u201c&#91;xs&#93;\u201d instead of \u201cxs\u201d?</i></a> theme."}, {"owner": {"reputation": 9, "user_id": 7338433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c1A7w.jpg?s=128&g=1", "display_name": "White_Sirilo", "link": "https://stackoverflow.com/users/7338433/white-sirilo"}, "edited": false, "score": 0, "creation_date": 1523019540, "post_id": 49692885, "comment_id": 86399107, "body": "Thank you guys, i appreciate it. I will check learnyouahaskell.com later."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1523019545, "post_id": 49692885, "comment_id": 86399111, "body": "@duplode: indeed, and it is rather sad that actually every time lack of knowledge about lists is actually the reason why the person could not implement it himself/herself."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1523033461, "post_id": 49692885, "comment_id": 86408063, "body": "<code>delete(r k)</code> means: call function <code>r</code> with single argument <code>k</code>; take its result, and call <code>delete</code> with single argument (previous result). Surely you do want this. To call <code>delete</code> with two arguments use <code>delete r k</code>."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7338433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c1A7w.jpg?s=128&g=1", "display_name": "White_Sirilo", "link": "https://stackoverflow.com/users/7338433/white-sirilo"}, "edited": false, "score": 0, "creation_date": 1523019428, "post_id": 49693090, "comment_id": 86399019, "body": "i think your otherwise is faulty, did you mean: otherwise = h:delete r t ? Thanks for the help tho, i think i made it."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1523019515, "last_edit_date": 1523019515, "creation_date": 1523018605, "answer_id": 49693090, "question_id": 49692885, "link": "https://stackoverflow.com/questions/49692885/haskell-unification-would-give-infinite-type/49693090#49693090", "title": "Haskell - unification would give infinite type", "body": "<p>The pattern <code>l:k</code> does three things:</p>\n\n<ol>\n<li>It tells you the list is not empty if the pattern matches</li>\n<li>It binds <code>l</code> to the first element of the list</li>\n<li>It binds <code>k</code> to the rest of the list.</li>\n</ol>\n\n<p>In the event you have a non-empty list, you want to compare your term <code>r</code> to <code>l</code>. If <em>they</em> are equal, you just return the rest of the list. Otherwise, you put <code>l</code> back on the list that results from the recursive call.</p>\n\n<p>If the list <em>is</em> empty, you need to handle that as well, by just returning an empty list. (Deleting <code>r</code> from <code>[]</code> trivially produces <code>[]</code>.)</p>\n\n<pre><code>delete :: Eq b =&gt; b -&gt; [b] -&gt; [b]\ndelete r (h:t) | r == h = t   -- h for head, t for tail\n               | otherwise = h : delete r t\ndelete _ [] = []   -- base case\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7338433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c1A7w.jpg?s=128&g=1", "display_name": "White_Sirilo", "link": "https://stackoverflow.com/users/7338433/white-sirilo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1523019515, "creation_date": 1523017902, "last_edit_date": 1523018357, "question_id": 49692885, "link": "https://stackoverflow.com/questions/49692885/haskell-unification-would-give-infinite-type", "title": "Haskell - unification would give infinite type", "body": "<p>I am new to Haskell and I just encountered this problem/error. </p>\n\n<p>I have not a single clue what's going on, also I am not really familiar using lists and defining them as <code>(l:k)</code>... i don't really know what l and k are considered... l is an element and k is a list? </p>\n\n<p>Anyways, I would appreciate someone explained to me these l and k things or maybe <code>(l:t:k)</code> inside a function using list and maybe a way to write this simple delete function which, given that the element is inside the list, finds the first appearance of the desired element and deletes it, returning the new list.</p>\n\n<pre><code>    delete :: Eq b =&gt; b -&gt; [b] -&gt; [b]\n    delete r (l:k)\n        | inside r k = [l]:delete(r k)\n        | otherwise = k\n</code></pre>\n"}, {"tags": ["c++", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1523004078, "post_id": 49688748, "comment_id": 86388816, "body": "A <code>Functor</code> is not an iterable, for instance a function is a <code>Functor</code> as well."}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 1, "creation_date": 1523004325, "post_id": 49688748, "comment_id": 86388966, "body": "For something like iterable, look at <a href=\"https://hackage.haskell.org/package/base-4.11.0.0/docs/Data-Foldable.html\" rel=\"nofollow noreferrer\"><code>Data.Foldable</code></a>. I&#39;m not a C++ buff, but it seems that <code>fmap</code> can do more than <code>std::transform</code> since functors are not just containers."}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1523004843, "post_id": 49688748, "comment_id": 86389296, "body": "<a href=\"https://github.com/solodon4/Mach7\" rel=\"nofollow noreferrer\">C++ has pattern matching through Mach7</a>. It has Bjarne Stroustrup in the credits, but I bet it isn&#39;t commonly used at all. As <a href=\"https://stackoverflow.com/questions/20765979/c-equivalent-of-algebraic-datatype\">this SO post</a> suggests, another way of dealing with algebraic data types in C++ is <a href=\"https://www.boost.org/doc/libs/1_64_0/doc/html/variant.html\" rel=\"nofollow noreferrer\"><code>boost::variant</code></a>."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1523004886, "post_id": 49688748, "comment_id": 86389320, "body": "It seems that this approximation can vary quite a lot depending on what you are trying to achieve with it and is rather opinion based. I think most of these are completely wrong. For example C++ has no functions and no higher order functions at all from haskell perspective while haskell does not expose functions from c++ perspective."}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1523005207, "post_id": 49688748, "comment_id": 86389525, "body": "When you write &quot;Class&quot; in the Haskell column, I assume you mean type class? Neither abstract classes nor interfaces are perfect translations to OOP terminology. Another weak comparison is <a href=\"https://stackoverflow.com/questions/32124627/how-are-c-concepts-different-to-haskell-typeclasses\">C++ Concepts vs. Haskell type classes</a>. See <a href=\"https://wiki.haskell.org/OOP_vs_type_classes\" rel=\"nofollow noreferrer\">HaskellWiki&#39;s OOP vs. type classes</a> for a more thorough comparison. In fact, if you google most &quot;Haskell &lt;feature X&gt; vs. &lt;other feature Y&gt;&quot;, you get a bunch of results."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1523008630, "post_id": 49688748, "comment_id": 86391820, "body": "Please don&#39;t use the term &quot;C++ concepts&quot; in this way: &quot;concept&quot; now is a precise technical meaning in C++ (like &quot;template&quot;), even if they are not yet in the standard (AFAIK). You are using it in its English sense. Perhaps &quot;constructs&quot; or &quot;features&quot; are more appropriate, here."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1523008840, "post_id": 49688748, "comment_id": 86391963, "body": "And <code>&#39;&#39; &lt;=&gt; &#39;const&#39;</code>  ;-)"}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1523012723, "post_id": 49688748, "comment_id": 86394433, "body": "@chi: If you are speaking to me, I am referring to &quot;C++ Concepts&quot; as a proper noun just like the author/implementor that I&#39;m linking to (&quot;as defined by the Concepts TS&quot;) . I am using &quot;C++ Concepts&quot; in the &quot;English sense&quot; in the sense that I am writing English, yes, but other than that, I rely fully on how the author uses it. I&#39;ve never heard of it before today."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1523014364, "post_id": 49688748, "comment_id": 86395469, "body": "Basically, all of these are wrong or at least only &#39;correct&#39; in such an abstract sense that they&#39;re basically meaningless. Language features and metaphors don&#39;t translate well across paradigms."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1523016415, "post_id": 49688748, "comment_id": 86396846, "body": "My immediate reaction is &quot;Why are you trying to do this? What problem are you trying to solve?&quot; If you&#39;re trying to make Haskell seem just like C++... well, it isn&#39;t, and it&#39;s probably going to confuse more than illuminate. But maybe you had some other purpose in mind?"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1523016654, "post_id": 49688748, "comment_id": 86397023, "body": "C++ classes and Haskell typeclasses are not the same thing. A C++ class is both a set of types (its descendants) and a type in itself, but a Haskell typeclass is only a set of types."}], "owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 305, "favorite_count": 0, "closed_date": 1523020771, "answer_count": 0, "score": 2, "last_activity_date": 1523013530, "creation_date": 1523004000, "last_edit_date": 1523013530, "question_id": 49688748, "link": "https://stackoverflow.com/questions/49688748/haskell-to-c-features-approximation", "closed_reason": "Needs more focus", "title": "Haskell to C++ features approximation", "body": "<p>In my learning curve of Haskell, I am trying to find correspondent pairs of features in either language:</p>\n\n\n\n<pre class=\"lang-none prettyprint-override\"><code>Haskell concept        &lt;=&gt;  Approximate equivalent C++ Concept\n\nData (Record syntax)   &lt;=&gt;  Class/Struct\n\nTypeclass              &lt;=&gt;  Abstract Class (Interface in Java)\n\nType Constructor       &lt;=&gt;  Template\n\nFunctor                &lt;=&gt;  Iterable class (https://stackoverflow.com/questions/8164567/how-to-make-my-custom-type-to-work-with-range-based-for-loops) \n\nfmap                   &lt;=&gt;  std::transform \n\nlambda                 &lt;=&gt;  lambda (&gt;= C++11)  (without capture mecanism)\n\ntype                   &lt;=&gt;  alias ( &gt;= c++11), typedefs\n\ntype inference         &lt;=&gt;  type inference ( &gt;= c++11 auto)\n\nmodule                 &lt;=&gt;  library\n\nMaybe                  &lt;=&gt;  std::optional (&gt;= C++17)\n\nEither                 &lt;=&gt;  std::variant (&gt;= C++17)\n\nHigher Order Function  &lt;=&gt;  functions taking one or several function pointers or std::function as parameter \n\nTuples                 &lt;=&gt;  std::tuple (&gt;= C++11)\n</code></pre>\n\n<p>Haskell Concepts with no equivalence </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Pattern matching \nIO\nList comprehension (C++ std::initializer_list ?) \n</code></pre>\n\n<p><strong>Do you see important concepts that I should add in this list or obvious errors?</strong> </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 1, "creation_date": 1522994084, "post_id": 49685880, "comment_id": 86383590, "body": "Does your list contain NaNs or other special values?"}, {"owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 1, "creation_date": 1522994128, "post_id": 49685880, "comment_id": 86383605, "body": "Can you share your list of numbers?"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1522994188, "post_id": 49685880, "comment_id": 86383634, "body": "@max630 Yes !!!: <code>&gt; any isNaN mins</code>  <code>True</code>"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 0, "creation_date": 1522994300, "post_id": 49685880, "comment_id": 86383686, "body": "@ZhekaKozlov It takes 8 MB in a <code>txt</code> file. I could share it with a gist. But it seems that max630 has found the reason."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1522994515, "post_id": 49685880, "comment_id": 86383773, "body": "@max630 If I do <code>filter (not . isNaN) mins&#39;</code> then <code>minimum</code> gives the good result (the same as <code>foldr min</code>), but not <code>maximum</code>."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 0, "creation_date": 1522994707, "post_id": 49685880, "comment_id": 86383849, "body": "@ZhekaKozlov the list is in <a href=\"https://gist.github.com/stla/ae8289f453f1433ba4b97a67f83a4626\" rel=\"nofollow noreferrer\">this gist</a>"}, {"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1522994956, "post_id": 49685880, "comment_id": 86383952, "body": "I&#39;d expect <code>maximum</code> to return 3261145.0627630088 - it seems to be the correct value. Doesn&#39;t it do it?"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1522995157, "post_id": 49685880, "comment_id": 86384026, "body": "@max630 Yes I&#39;ve just written that in my edit."}, {"owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 0, "creation_date": 1522996698, "post_id": 49685880, "comment_id": 86384746, "body": "Also, can you tell the version of GHC?"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 0, "creation_date": 1522996810, "post_id": 49685880, "comment_id": 86384792, "body": "@ZhekaKozlov ghc 8-2.2"}], "answers": [{"comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1522995757, "post_id": 49686520, "comment_id": 86384294, "body": "Yes ok, thanks. I think a sensible <code>minimum&#47;maximum</code> function should return <code>NaN</code> in such a case (like R does for example)."}, {"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 1, "creation_date": 1522996559, "post_id": 49686520, "comment_id": 86384686, "body": "The problem that they do not know about NaN, they just use methods provided by Ord. And Ord does not have a way to say &quot;hey this value is special, abort everything and return this as a sign that it is special&quot;."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1522997212, "post_id": 49686520, "comment_id": 86384968, "body": "Yes I understand what happens. I&#39;ve found this interesting discussion about <code>NaN</code> in Julia: <a href=\"https://github.com/JuliaLang/julia/issues/7866\" rel=\"nofollow noreferrer\">github.com/JuliaLang/julia/issues/7866</a>"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1522997405, "post_id": 49686520, "comment_id": 86385077, "body": "Something &quot;funny&quot;: define <code>infty = 1&#47;0</code> and try <code>max nan infty</code> and <code>max infty nan</code>. This is respectively <code>NaN</code> and <code>Infinity</code>."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 9, "creation_date": 1522998006, "post_id": 49686520, "comment_id": 86385370, "body": "Something good to know : <a href=\"https://hackage.haskell.org/package/ieee754-0.8.0/docs/Numeric-IEEE.html#g:2\" rel=\"nofollow noreferrer\">NaN-aware min and max in Haskell</a>."}, {"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 2, "creation_date": 1523025414, "post_id": 49686520, "comment_id": 86403040, "body": "It would be great to have these issues documented on <code>Float</code>&#39;s <code>Eq</code> and <code>Ord</code> instances. They are defined in <code>GHC.Classes</code> in <code>ghc-prim</code>."}, {"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 1, "creation_date": 1523062687, "post_id": 49686520, "comment_id": 86419246, "body": "@max630: You describe violated <b>totality</b>, not antisymmetry. (And totality is defined with <code>&lt;=</code> and <code>&gt;=</code>.)"}, {"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "reply_to_user": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1523090034, "post_id": 49686520, "comment_id": 86424220, "body": "@sjakobi thanks. I had in mind <code>a &gt; b</code> = <code>not (a &lt;= b)</code>, then it would become antisymmetry.  But such replacement is not valid if there is no totality"}], "tags": [], "owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "is_accepted": true, "score": 14, "last_activity_date": 1523089847, "last_edit_date": 1523089847, "creation_date": 1522995331, "answer_id": 49686520, "question_id": 49685880, "link": "https://stackoverflow.com/questions/49685880/is-there-a-bug-in-the-minimum-function/49686520#49686520", "title": "Is there a bug in the minimum function?", "body": "<p>The reason to all issues is that the list contains <code>NaN</code>. Apparently it violated the <code>Ord</code>'s  total ordering requirement[*], so you cannot expect algorithms which use the ordering - either picking minimum or sorting - to produce correct result when it is in the input. Instead they will produce something which depends on their internal implementation, and may be different depending on seemingly unimportant reasons, for example input order. You should filter it out before doing anything else.</p>\n\n<p>[*] <code>Ord</code> does not have it laws written out explicitely (neither does <code>Eq</code> which NaN also breaks), but here example of breaking totality rule, as it is <a href=\"https://en.wikipedia.org/wiki/Total_order\" rel=\"nofollow noreferrer\">described in Wikipedia</a> (thanks @sjakobi for correcting):</p>\n\n<pre><code>Prelude&gt; let nan = 0 / 0\nPrelude&gt; nan\nNaN\nPrelude&gt; nan &lt;= 1\nFalse\nPrelude&gt; 1 &lt;= nan\nFalse\nPrelude&gt;\n</code></pre>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "accepted_answer_id": 49686520, "answer_count": 1, "score": 12, "last_activity_date": 1523089847, "creation_date": 1522992167, "last_edit_date": 1522995374, "question_id": 49685880, "link": "https://stackoverflow.com/questions/49685880/is-there-a-bug-in-the-minimum-function", "title": "Is there a bug in the minimum function?", "body": "<p>I have a list <code>mins</code> of 415920 numbers, all supposed to be closed to <code>0.1</code>:</p>\n\n<pre><code>Prelude Lib&gt; take 5 mins\n[9.83610706554002e-2,9.847021825032128e-2,9.847021825032128e-2,9.898395035483082e-2,9.898395035483082e-2]\n</code></pre>\n\n<p>However:</p>\n\n<pre><code>Prelude Lib&gt; minimum mins\n0.10087849151477328\n</code></pre>\n\n<p>The <code>minimum</code> function is not supposed to return the minimum ?</p>\n\n<p>This result sounds plausible:</p>\n\n<pre><code>Prelude Lib&gt; foldr min 100000 mins\n1.1763616593045858e-4\n</code></pre>\n\n<p>Is it a bug, or I misunderstand <code>minimum</code> ?</p>\n\n<p>Similar issue with <code>maximum</code>:</p>\n\n<pre><code>Prelude Lib&gt; maximum mins\n3261145.0627630088\nPrelude Lib&gt; foldr max 0 mins\n0.1207868227600914\n</code></pre>\n\n<p>Sorting the list yields a third result for the maximum:</p>\n\n<pre><code>Prelude Lib&gt; import Data.List as L\nPrelude Lib L&gt; mins' = sort mins\nPrelude Lib L&gt; head mins'\n1.1763616593045858e-4\nPrelude Lib L&gt; last mins'\n0.10295664278431726\n</code></pre>\n\n<p>And applying <code>minimum</code> and <code>maximum</code> on the sorted list yields a third result for the minimum:</p>\n\n<pre><code>Prelude Lib L&gt; minimum mins'\n0.10045801977483232\nPrelude Lib L&gt; maximum mins'\n3261145.0627630088\n</code></pre>\n\n<h1>Edit</h1>\n\n<p>After @max630's comment, I've searched in the list with a text editor. The <code>3261145.0627630088</code> is indeed here, and there are some <code>NaN</code>:</p>\n\n<pre><code>NaN,NaN,3261145.0627630088\n</code></pre>\n\n<p><em>Conclusion:</em> it looks like <code>minimum</code> gives a wrong result, and <code>maximum</code> gives the correct result.</p>\n\n<p><code>foldr max</code> gives a wrong result, <code>foldl max</code> gives the good one:</p>\n\n<pre><code>&gt; foldl max 0 mins\n3261145.0627630088\n</code></pre>\n"}, {"tags": ["haskell", "types", "ambiguous-call"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 6, "creation_date": 1522984176, "post_id": 49684655, "comment_id": 86380679, "body": "<code>AllowAmbiguousTypes</code> is completely \u201csafe\u201d, in the sense that it is perfectly sound, will not make the compiler diverge, and cannot lead to runtime errors, it was just mostly useless prior to the introduction of <code>TypeApplications</code>. The combination of the two is a perfectly reasonable thing."}, {"owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1522984319, "post_id": 49684655, "comment_id": 86380709, "body": "This question is inspired by an answer I received to another question that used both <code>AllowAmbiguousTypes</code> and <code>TypeApplications</code> to good effect: <a href=\"https://stackoverflow.com/a/49671162/3040129\">stackoverflow.com/a/49671162/3040129</a>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1523005343, "post_id": 49684655, "comment_id": 86389606, "body": "I woulnd&#39;t mind if they both were turned on by default -- actually, I&#39;d like that very much. Without them, we need additional <code>proxy a</code> arguments, which look hack-ish to me: why should I pass a runtime value which carries no information, only to tell the compiler that I want to use type <code>a</code>? That should be a compile-time argument, and now it can be if we use <code>foo @ a</code>. Ambiguous types are very good, once you have type applications. There is no downside to them, now."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1523028045, "last_edit_date": 1523028045, "creation_date": 1523026607, "answer_id": 49695603, "question_id": 49684655, "link": "https://stackoverflow.com/questions/49684655/how-dangerous-is-allowambiguoustypes-when-used-with-typeapplications/49695603#49695603", "title": "How dangerous is AllowAmbiguousTypes when used with TypeApplications?", "body": "<p>Alexis King nailed it in her comment; it deserves to be elevated to the level of an answer.</p>\n\n<blockquote>\n  <p><code>AllowAmbiguousTypes</code> is completely safe, in the sense that it is perfectly sound, will not make the compiler diverge, and cannot lead to runtime errors. It was just mostly useless prior to the introduction of <code>TypeApplications</code>. The combination of the two is a perfectly reasonable thing.</p>\n</blockquote>\n"}], "owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 1, "accepted_answer_id": 49695603, "answer_count": 1, "score": 3, "last_activity_date": 1523028045, "creation_date": 1522984090, "last_edit_date": 1522986504, "question_id": 49684655, "link": "https://stackoverflow.com/questions/49684655/how-dangerous-is-allowambiguoustypes-when-used-with-typeapplications", "title": "How dangerous is AllowAmbiguousTypes when used with TypeApplications?", "body": "<p>How dangerous is the <a href=\"https://downloads.haskell.org/~ghc/8.4.1/docs/html/users_guide/glasgow_exts.html#ambiguous-types-and-the-ambiguity-check\" rel=\"nofollow noreferrer\"><code>AllowAmbiguousTypes</code></a> extension when used with the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#extension-TypeApplications\" rel=\"nofollow noreferrer\"><code>TypeApplications</code></a> extension?</p>\n\n<p>The GHC manual gives the following example of an ambiguous type:</p>\n\n<pre><code>class C a\n\nf :: C a =&gt; Int\nf = 3\n</code></pre>\n\n<p>This fails to compile when not using <code>AllowAmbiguousTypes</code> with the following message:</p>\n\n<pre><code>file.hs:8:6: error:\n    \u2022 Could not deduce (C a0)\n      from the context: C a\n        bound by the type signature for:\n                   f :: forall a. C a =&gt; Int\n        at file.hs:8:6-15\n      The type variable \u2018a0\u2019 is ambiguous\n    \u2022 In the ambiguity check for \u2018f\u2019\n      To defer the ambiguity check to use sites, enable AllowAmbiguousTypes\n      In the type signature: f :: C a =&gt; Int\n  |\n8 | f :: C a =&gt; Int\n  |      ^^^^^^^^^^\n</code></pre>\n\n<p>With <code>AllowAmbiguousTypes</code>, it compiles correctly.</p>\n\n<p>However, the following example fails to compile even with <code>AllowAmbiguousTypes</code>:</p>\n\n<pre><code>class C a\n\nf :: C a =&gt; Int\nf = 3\n\ng :: C a =&gt; Int\ng = f\n</code></pre>\n\n<p>It gives the following error when trying to compile it:</p>\n\n<pre><code>file.hs:12:5: error:\n    \u2022 Could not deduce (C a0) arising from a use of \u2018f\u2019\n      from the context: C a\n        bound by the type signature for:\n                   g :: forall a. C a =&gt; Int\n        at file.hs:11:1-15\n      The type variable \u2018a0\u2019 is ambiguous\n    \u2022 In the expression: f\n      In an equation for \u2018g\u2019: g = f\n   |\n12 | g = f\n   |     ^\n</code></pre>\n\n<p>This can be written by enabling <code>TypeApplications</code> and writing it like the following:</p>\n\n<pre><code>class C a\n\nf :: C a =&gt; Int\nf = 3\n\ng :: forall a. C a =&gt; Int\ng = f @a\n</code></pre>\n\n<hr>\n\n<p><code>AllowAmbiguousTypes</code> sounds scary, but based on the description in the GHC manual, it seems pretty benign, especially when used with <code>TypeApplications</code>.</p>\n\n<p>It's not like <code>AllowAmbiguousTypes</code> is going to cause runtime errors, right?</p>\n\n<p>This combination of <code>AllowAmbiguousTypes</code> and <code>TypeApplications</code> also seems to be used in some pretty popular packages, like <a href=\"https://hackage.haskell.org/package/constraints-0.10/docs/src/Data-Constraint-Nat.html\" rel=\"nofollow noreferrer\">constraints</a>.</p>\n"}, {"tags": ["haskell", "list-comprehension"], "answers": [{"tags": [], "owner": {"reputation": 767, "user_id": 814796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZQemO.jpg?s=128&g=1", "display_name": "madgen", "link": "https://stackoverflow.com/users/814796/madgen"}, "is_accepted": false, "score": 3, "last_activity_date": 1522974608, "creation_date": 1522974608, "answer_id": 49683498, "question_id": 49683415, "link": "https://stackoverflow.com/questions/49683415/list-comprehension-troubles/49683498#49683498", "title": "List comprehension troubles", "body": "<p>Left side of the pipe does not have to be a value. You can do it like this: <code>[ if i == 4 then \"Bob\" else \"\" | i &lt;- [3..6]]</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1523052198, "post_id": 49683501, "comment_id": 86416705, "body": "I so wish I had seen this <code>map</code> expression before I composed my sorry solution. It is a gem and yet another reason to love Haskell. I eschew <code>if-then-else</code> and wish it were a function.  Haskell is so versatile with syntax <code>let { f 4 = &quot;Bob&quot;; f _ = &quot;&quot; } in map (\\s -&gt; f s) [3..6] </code> I learn new everyday here from super people like you. Thank you so much."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 1, "creation_date": 1523053722, "post_id": 49683501, "comment_id": 86417218, "body": "@fpmora N.B. that <code>\\s -&gt; f s</code> is just <code>(($) f)</code> which is just <code>f</code> :)"}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1523054199, "post_id": 49683501, "comment_id": 86417375, "body": "Wow! I am so impressed. I always forget about applying partial functions. Thank you so very much for this: <code>let { f 4 = &quot;Bob&quot;; f _ = &quot;&quot; } in map f [3..6]</code> I love, love, love one liners and people with terrific insight."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 1, "creation_date": 1523054317, "post_id": 49683501, "comment_id": 86417415, "body": "@fpmora Willem&#39;s bottom answer is the best here, imo. <code>map (bool &quot;&quot; &quot;Bob&quot; . (==4)) [3..6]</code>"}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1523054956, "post_id": 49683501, "comment_id": 86417578, "body": "I don&#39;t understand how or what <code>bool</code> does. I&#39;m still having trouble with basic prelude and a little Data.List. I&#39;ve had books on lisp for over 20 years and on Hope &amp; Haskell for almost as long but only recently am I able to use Haskell at work and so happy I am."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 1, "creation_date": 1523055973, "post_id": 49683501, "comment_id": 86417846, "body": "<code>bool</code> expects two values, a partial function to use as predicate, and a value to test. <code>bool ifFalse ifTrue p x</code> is the same as <code>if p x then ifTrue else ifFalse</code>."}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1523057945, "post_id": 49683501, "comment_id": 86418306, "body": "Do I feel dumb. I am trying everything to avoid <code>if-then-else</code> and it&#39;s been right here and there all of the time. Google has been little help. Thank you again so very much. `bool&#39; is just beautiful. I looked up book on Zevon, my go to but it looked daunting. Your explanation is superbub,  very."}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 4, "last_activity_date": 1522974626, "creation_date": 1522974626, "answer_id": 49683501, "question_id": 49683415, "link": "https://stackoverflow.com/questions/49683415/list-comprehension-troubles/49683501#49683501", "title": "List comprehension troubles", "body": "<p>Use an <code>if</code> construction.</p>\n\n<pre><code>[ if i == 4 then \"Bob\" else \"\" | i &lt;- [3..6] ]\n</code></pre>\n\n<p>Though this is probably better without a list comprehension</p>\n\n<pre><code>map f [3..6]\n  where\n  f 4 = \"Bob\"\n  f _ = \"\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 1, "creation_date": 1523133481, "post_id": 49687222, "comment_id": 86437035, "body": "I love <code>bool</code> after it was explained to me here. I so very wanted an <code>if</code> function like in other functional languages. <code>bool</code> now serves the purpose. Thank you so very much for this."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1522998328, "creation_date": 1522998328, "answer_id": 49687222, "question_id": 49683415, "link": "https://stackoverflow.com/questions/49683415/list-comprehension-troubles/49687222#49687222", "title": "List comprehension troubles", "body": "<p>The reason this does not work is because you use <code>i == 4</code> as a <em>filter</em>:</p>\n\n<pre><code>[ \"Bob\" | i &lt;- [3..6], i == 4  ]\n--                     ^ filter\n</code></pre>\n\n<p>So that means that only in case <code>i == 4</code>, you will add <code>\"Bob\"</code> to the list. In case the condition was <code>True</code> for instance two times (for example <code>i &lt; 5</code>), then we would yield <code>\"Bob\"</code> twice.</p>\n\n<p>The condition is not a filter: it determines <em>what</em> should be added to the list, not <em>on what condition</em> something should be added. In that case you can use function that checks the condition, and returns different results.</p>\n\n<p>We can use <a href=\"https://hackage.haskell.org/package/base-4.11.0.0/docs/Data-Bool.html#v:bool\" rel=\"nofollow noreferrer\"><strong><code>bool :: a -&gt; a -&gt; Bool -&gt; a</code></strong></a> for this (this is a <em>catamoprhism</em> over <code>Bool</code>):</p>\n\n<pre><code>import Data.Bool(bool)\n\n[ bool \"\" \"Bob\" (i == 4) | i &lt;- [3..6] ]\n</code></pre>\n\n<p>Note that we can use <code>map</code> as well:</p>\n\n<pre><code>import Data.Bool(bool)\n\nmap (bool \"\" \"Bob\" . (4 ==)) [3..6]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1523018704, "post_id": 49692720, "comment_id": 86398488, "body": "This will return <code>[[], [&quot;Bob&quot;], [], []]</code> instead of <code>[&quot;&quot;, &quot;Bob&quot;, &quot;&quot;, &quot;&quot;]</code>. It adds another layer of lists than it should."}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1523019173, "post_id": 49692720, "comment_id": 86398847, "body": "That&#39;s what I said because the question was: \u201dI want to use a list comprehension to have a string if a certain condition is true but if the condition is not true then put the <b>empty string in (or empty list).</b>&quot;"}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1523019315, "post_id": 49692720, "comment_id": 86398939, "body": "[] and \u201d&quot; prove to be identical. [] == &quot;&quot; -&gt; True"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 2, "creation_date": 1523021408, "post_id": 49692720, "comment_id": 86400368, "body": "@fpmora but <code>[String]</code> and <code>[[String]]</code> are not identical (<code>[&quot;Bob&quot;] &#47;= &quot;Bob&quot;</code>)"}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1523025744, "post_id": 49692720, "comment_id": 86403274, "body": "That&#39;s right and <code>[[a]] &#47;= [a]</code> but <code>[&quot;&quot;] == [[]]</code> results <code>True</code>."}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1523026642, "post_id": 49692720, "comment_id": 86403904, "body": "Just  <code>[ concat [ &quot;Bob&quot; | x == 4]   | x &lt;- [3..6] ]</code> to satisfy appearance."}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1523028056, "post_id": 49692720, "comment_id": 86404838, "body": "I don&#39;t really know what this <code>[[], [&quot;Bob&quot;], [], []]</code> is because Haskell doesn&#39;t allow lists of different types within a list. That&#39;s why concat works so well as always."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1523133604, "post_id": 49692720, "comment_id": 86437066, "body": "@4castle: the empty string is an empty list <code>[] == &quot;&quot;</code>."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523133751, "post_id": 49692720, "comment_id": 86437112, "body": "@WillemVanOnsem I know that, but in my comment the <code>[]</code> is of type <code>[String]</code>, so it would be wrong to write it as <code>&quot;&quot;</code>, which is of type <code>String</code>."}], "tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": -2, "last_activity_date": 1525122206, "last_edit_date": 1525122206, "creation_date": 1523017320, "answer_id": 49692720, "question_id": 49683415, "link": "https://stackoverflow.com/questions/49683415/list-comprehension-troubles/49692720#49692720", "title": "List comprehension troubles", "body": "<p>There is nothing wrong with what you have. It's just you have to force the result whether it meets the condition or doesn't. The way to do that is to put what you have in a list comprehension and have it \"execute\" a number of times.</p>\n\n<pre><code>[ concat [\"Bob\" | x == 4] | x &lt;- [3..6] ]\n</code></pre>\n\n<p>The condition of x not equal 4 produces and empty list '[]' so <code>concat</code> converts them to identical strings for list uniformity.</p>\n"}], "owner": {"reputation": 9, "user_id": 9393512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c463ca0a26af896c437f69305c9ed04e?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Coulter", "link": "https://stackoverflow.com/users/9393512/tim-coulter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1525122206, "creation_date": 1522973880, "question_id": 49683415, "link": "https://stackoverflow.com/questions/49683415/list-comprehension-troubles", "title": "List comprehension troubles", "body": "<p>I want to use a list comprehension to have a string if a certain condition is true but if the condition is not true then put the empty string in (or empty list). </p>\n\n<p>for example : <code>[  Bob  | i &lt;- [3..6], i == 4  ]</code> this gives the list <code>[\"Bob\"]</code> but I want to get: <code>[ \"\" , \"Bob\" , \"\" , \"\" ]</code> so any empty string whenever <code>i</code> does not equal 4. </p>\n\n<p>Is it possible to do this within a list comprehension. </p>\n"}, {"tags": ["haskell", "search", "binary-tree"], "answers": [{"comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 2, "creation_date": 1522967230, "post_id": 49681805, "comment_id": 86376646, "body": "You should use a <code>case</code> on <code>compare a b</code> to avoid having to compare them thrice (in the worst case), and the <code>Eq</code> constraint is extraneous because <code>Ord a</code> means <code>Eq a</code>."}], "tags": [], "owner": {"reputation": 20427, "user_id": 2570261, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e71068b09fc539447a0cee3e99fc419d?s=128&d=identicon&r=PG&f=1", "display_name": "Haleemur Ali", "link": "https://stackoverflow.com/users/2570261/haleemur-ali"}, "is_accepted": false, "score": 4, "last_activity_date": 1522984453, "last_edit_date": 1522984453, "creation_date": 1522963734, "answer_id": 49681805, "question_id": 49681631, "link": "https://stackoverflow.com/questions/49681631/searching-a-value-in-binary-tree-haskell/49681805#49681805", "title": "Searching a Value in Binary tree haskell", "body": "<p>A binary search could be written as follows. The type can be more generic, as we only need the items to be orderable to store / search in a binary tree.</p>\n\n<p>We visit each node and either return true, or search in 1 of the child nodes.</p>\n\n<p>example Node</p>\n\n<pre><code>   5\n /   \\\n3     7\n</code></pre>\n\n<p>lets search for 7. </p>\n\n<p>We first visit the root. since 5 != 7, we test a child node. Since 7 > 5, we search in the right node, since 7 cannot appear in the left child (all values guaranteed to be lower than 5 on the left child)</p>\n\n<p>If we reach a leaf, we just check if it contains the search term.</p>\n\n<pre><code>search :: Ord a =&gt; a -&gt; BinaryTree a -&gt; Bool\nsearch a (Leaf b) = compare a b == EQ\nsearch a (Node left b right) \n  case compare a b of \n    EQ -&gt; True\n    LT -&gt; search a left\n    GT -&gt; search a right\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "is_accepted": true, "score": 1, "last_activity_date": 1523008449, "last_edit_date": 1523008449, "creation_date": 1523006510, "answer_id": 49689467, "question_id": 49681631, "link": "https://stackoverflow.com/questions/49681631/searching-a-value-in-binary-tree-haskell/49689467#49689467", "title": "Searching a Value in Binary tree haskell", "body": "<blockquote>\n  <p>I am not sure how to proceed with the function to traverse through the tree and return the value.</p>\n</blockquote>\n\n<p>From that sentence, I understand you would have no problem writing a traversal yourself, but that there is a mental leap you need to take to understand how Haskell works.</p>\n\n<p>You see, you never <em>return</em> anything in Haskell. Returning is fundamentally <em>an imperative statement</em>. Haskell is a declarative language, which means that <strong>writing programs is done by stating facts</strong>. That nuance can be discomforting, especially if you've been introduced to programming through learning imperative languages like C, Java, JavaScript, etc. But once you truly understand it, you will see how much more expressive and easy declarative programming is.</p>\n\n<p>Because of its strong mathematical roots, in Haskell facts are stated in the form of equations, i.e. expressions where the <code>=</code> sign literally means the left- and right-hand side are equal (whereas in an imperative language, it would probably mean that you assign a value to a variable -- that does not exist in Haskell).</p>\n\n<p>The program @Haleemur Ali wrote is in 1:1 correspondence with how you would write <code>search</code> using math notation:</p>\n\n<pre><code>search(x, t) = { x == y       if t = Leaf y\n               , true         if t = Node l y r and x == y\n               , search(x, l) if t = Node l y r and x &lt; y\n               , search(x, r) if t = Node l y r and x &gt; y\n               }\n</code></pre>\n\n<p>Indeed many times, at least as a beginner, writing Haskell is just a matter of translation, from math notation to Haskell notation. Another interpretation of Haskell programs is as proofs of theorems. Your search is a theorem saying that \"<em>if you have a tree and an integer, you can always tell if the integer is somewhere inside the tree</em>\". That's what you are telling the compiler when you write a function signature:</p>\n\n<pre><code>search :: Int -&gt; Tree -&gt; Bool\n</code></pre>\n\n<p>The compiler will only be happy if you write a proof for that theorem ... you probably guessed that the algorithm above is the proof.</p>\n\n<p>An interesting observation is that the algorithm is almost dictated by the shape of the data type. Imagine you wanted to sum all the values in a tree instead:</p>\n\n<pre><code>sum(t) = { x                   if t = Leaf x\n         , x + sum(l) + sum(r) if t = Node l x r\n         }\n</code></pre>\n\n<p>Every time you want to write an algorithm over a binary tree, you will write something like the above. That is fairly mechanical and repetitive. What if later on you expand your program to deal with rose trees? Tries? You don't want to write the same algorithms and take the risk of making a mistake. One would try to come up with a function that walks down a tree and combines its values (using Haskell notation from now on):</p>\n\n<pre><code>walk :: (Int -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Tree -&gt; b\nwalk f g (Leaf x) = f x\nwalk f g (Node l x r) =\n  let a = walk f g l\n      b = walk f g r\n  in g (g (f x) a) b\n</code></pre>\n\n<p>With this function alone, you can write all manners of traversals on trees:</p>\n\n<pre><code>sum t      = walk id (+) t\nsearch x t = walk (== x) (||) t\n</code></pre>\n\n<p><code>walk</code> is such a recurring pattern that it has been abstracted. All the data structures that expose the same pattern of recursion are said to be <em>foldable</em>, and the implementation is often so obvious that you can ask the compiler to write it for you, like so:</p>\n\n<pre><code>{-# LANGUAGE DeriveFoldable #-}\n\ndata Tree a = Leaf a | Node (Tree a) a (Tree a) deriving (Foldable)\n</code></pre>\n\n<p>There's even <a href=\"https://hackage.haskell.org/package/base-4.11.0.0/docs/Data-Foldable.html#v:sum\" rel=\"nofollow noreferrer\">a definition of sum for any foldable data structure</a>.</p>\n"}], "owner": {"reputation": 96, "user_id": 6405227, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MlagIIHaQak/AAAAAAAAAAI/AAAAAAAAAUQ/f4yypBPVz7s/photo.jpg?sz=128", "display_name": "Dipesh Desai", "link": "https://stackoverflow.com/users/6405227/dipesh-desai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2619, "favorite_count": 0, "accepted_answer_id": 49689467, "answer_count": 2, "score": 2, "last_activity_date": 1523008449, "creation_date": 1522962902, "question_id": 49681631, "link": "https://stackoverflow.com/questions/49681631/searching-a-value-in-binary-tree-haskell", "title": "Searching a Value in Binary tree haskell", "body": "<p>I have just started learning Haskell and I am trying to write a code for searching for a particular value in a binary tree and if present return true else false \nThis is how my tree structure looks like</p>\n\n<pre><code>data Tree = Leaf Int | Node Tree Int Tree\n</code></pre>\n\n<p>I am not sure how to proceed with the function to traverse through the tree and return the value. I did try BFS and DFS but I am not sure on how to return once I have got my value.</p>\n\n<p>An example of how my function should look</p>\n\n<pre><code>Search 5 (Node (Node (Leaf 1) 3 (Leaf 4)) 5 (Node (Leaf 6) 7 (Leaf 9))) \n</code></pre>\n"}, {"tags": ["java", "haskell", "typeclass"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1522950282, "post_id": 49678393, "comment_id": 86368331, "body": "No, one of the nice things about Haskell is that you can also define such <code>instance</code>s inductively, like <code>instance Eq a =&gt; Eq [a]</code>. So given the elements can be checked for equality, you define the list to be valid for equality. Anther important difference is that you enforce that an <code>instance</code> must implement <i>all</i> the necessary functions. So if you make a <code>Num</code>, it does <i>not</i> suffice to only implement <code>(+)</code>, you have to impelemnt the entire &quot;pack&quot;."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1522950749, "post_id": 49678393, "comment_id": 86368583, "body": "Very similar question to <a href=\"https://stackoverflow.com/questions/45233416/difference-between-c-sharp-interface-and-haskell-type-class\">Difference between C# interface and Haskell Type Class</a>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1522950854, "post_id": 49678393, "comment_id": 86368642, "body": "Closely related: <a href=\"https://stackoverflow.com/q/47971360/2751851\"><i>Typeclasses and overloading, what is the connection?</i></a> (I&#39;m not entirely sure whether it is a dupl*cate; I&#39;ll leave it up to you and our fellow users to decide.)"}, {"owner": {"reputation": 2090, "user_id": 1499066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35bb8eaa9c809c52774aef01d19afa3?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1499066/john-smith"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1522950863, "post_id": 49678393, "comment_id": 86368643, "body": "@WillemVanOnsem correct me if I&#39;m wrong: when comparing type classes with interfaces, the same can be said about java interfaces: they do not allow inductive definition, because that is not one of java&#39;s features"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1522952558, "post_id": 49678393, "comment_id": 86369582, "body": "@JohnSmith: well the question of course always boils down to &quot;what do you consider to be an interface&quot;, etc? Typeclasses are not bound to functional programming: functional programming can exist without type classes, and imperative programming can have typeclasses. But crucial is always how those concepts are defined."}], "owner": {"reputation": 2090, "user_id": 1499066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35bb8eaa9c809c52774aef01d19afa3?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1499066/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "closed_date": 1522984735, "answer_count": 0, "score": 1, "last_activity_date": 1522950461, "creation_date": 1522950111, "last_edit_date": 1522950461, "question_id": 49678393, "link": "https://stackoverflow.com/questions/49678393/haskells-type-classes-vs-java-function-overloading", "closed_reason": "Duplicate", "title": "Haskell&#39;s type classes vs. Java function overloading", "body": "<p>I have been trying to understand Haskell's type classes and have read often that they are more general than java interfaces. Thinking about it I wondered whether the comparison between interfaces and type classes is actually not where the relationship lies. I think type classes should rather be compared to overloaded methods. Consider the following Haskell code:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class Divide a b c where\n    divi :: a -&gt; b -&gt; c\n\ninstance Divide Integer Integer Double where\n    divi x y = (fromIntegral x) `div` (fromIntegral y)\n\ninstance Divide Double Double Double where\n    divi x y = x `div` y\n\ninstance Divide Double Integer Double where\n    divi x y = x `div` (fromIntegral y)\n\ninstance Divide Integer Double Double where\n    divi x y = (fromIntegral x) `div` y\n</code></pre>\n\n<p>Writing it \"functionally\" in Java (e.g. using static methods like functions) I would translate this to the following</p>\n\n<pre><code>static class Math {\n\n    static double divi(int a, int b) {\n        return a / b;\n    }\n\n    static double divi(double a, double b) {\n        // in java the implementation is always the same because the compiler does the trick, but that is irrelevant\n        return a / b;\n    }\n\n    static double divi(double a, int b) {\n        return a / b;\n    }\n\n    static double divi(int a, double b) {\n        return a / b;\n    }\n}\n</code></pre>\n\n<p>I know this is not exactly the same since in my Java version there is no equivalent of the <code>Divide</code> Type class itself only the overloaded functions are present. But I think this comes much closer to an equivalent to the Haskell code than interface inheritance and method overriding.</p>\n\n<p>What do you guys think about that argument?</p>\n\n<p>PS: I haven't tested my code neither in Haskell nor Java, since it's only to get the point across. Please feel free to correct any bugs.</p>\n"}, {"tags": ["haskell", "types", "monads", "monad-transformers", "state-monad"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1522952103, "post_id": 49677407, "comment_id": 86369302, "body": "I am wondering if <code>(forall m. Monad m =&gt; m Int)</code> is actually isomorphic to <code>Int</code> (exploiting parametricity). I can&#39;t think of anything in that polymorphic type which is (non bottom and) distinct from <code>return someInt</code>."}, {"owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1522952986, "post_id": 49677407, "comment_id": 86369847, "body": "@chi interesting observation. I suppose we&#39;d need some other constraint(s) to motivate that technique."}], "tags": [], "owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "is_accepted": true, "score": 4, "last_activity_date": 1522946261, "creation_date": 1522946261, "answer_id": 49677407, "question_id": 49676247, "link": "https://stackoverflow.com/questions/49676247/why-does-a-working-monadic-linkage-between-functions-break-when-i-introduce-a-n/49677407#49677407", "title": "Why does a working monadic linkage between functions break, when I introduce a new argument that uses the Monad as a parameter?", "body": "<p>When you call <code>foo</code> from <code>main</code>, you are saying that <code>Monad m</code> should be <code>IO</code>. Thus, you get a <code>Dummy IO</code> from <code>Dummy (\\n -&gt; return n)</code> (this could just be <code>Dummy return</code>, by the way). Then inside <code>foo</code>, you are calling <code>bar</code> with a <code>Dummy IO</code> argument, thus setting <code>m</code> to <code>IO</code> in <code>bar</code>'s <code>Monad m</code>. However, the call to <code>bar</code> is inside <code>StateT Int IO</code> instead of <code>IO</code>, hence the error.</p>\n\n<p>As you discovered, you can call bar with <code>Dummy IO</code> and then lift the result into <code>StateT Int IO</code>. You are also correct to observe that there could be situations where this wouldn't work.</p>\n\n<p>There's another solution that you may want to consider. If you don't actually care what monad your <code>Dummy</code> type needs (as seems to be the case), you can enforce that it works in all monads:</p>\n\n<pre><code>newtype Dummy = Dummy (Int -&gt; (forall m. Monad m =&gt; m Int))\n</code></pre>\n\n<p>This requires the <code>RankNTypes</code> extension.</p>\n"}], "owner": {"reputation": 1307, "user_id": 1549736, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LBwQu.jpg?s=128&g=1", "display_name": "dbanas", "link": "https://stackoverflow.com/users/1549736/dbanas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 49677407, "answer_count": 1, "score": 1, "last_activity_date": 1522946261, "creation_date": 1522942330, "question_id": 49676247, "link": "https://stackoverflow.com/questions/49676247/why-does-a-working-monadic-linkage-between-functions-break-when-i-introduce-a-n", "title": "Why does a working monadic linkage between functions break, when I introduce a new argument that uses the Monad as a parameter?", "body": "<p>The following code:</p>\n\n<pre><code>-- tst2.hs - showing successful monadic linkage.\n\n{-# LANGUAGE NoImplicitPrelude #-}\n{-# LANGUAGE FlexibleContexts #-}\n\nimport Protolude\nimport Control.Monad.Extra  (unfoldM)\n\nfoo :: Monad m\n    =&gt; Int\n    -&gt; m [[Int]]\nfoo n = evalStateT (traverse nxt [1..n]) 0\n where nxt _ = do s &lt;- get\n                  r &lt;- bar s\n                  put $ s + 1\n                  return r\n\nbar :: Monad m\n    =&gt; Int\n    -&gt; m [Int]\nbar n = unfoldM step n\n  where step k = return $ if k &gt; 0 then Just (k, k - 1)\n                                   else Nothing\n\nmain :: IO ()\nmain = do xs &lt;- foo 3\n          print xs\n</code></pre>\n\n<p>works fine, producing this output:</p>\n\n<pre><code>Davids-Air-2:haskell-rl dbanas$ stack runghc tst2.hs \n[[],[1],[2,1]]\n</code></pre>\n\n<p>However, if I change the code slightly:</p>\n\n<pre><code>-- tst3.hs - showing breakage of monadic linkage.\n\n{-# LANGUAGE NoImplicitPrelude #-}\n{-# LANGUAGE FlexibleContexts #-}\n\nimport Protolude\nimport Control.Monad.Extra  (unfoldM)\n\ndata Dummy m = Dummy (Int -&gt; m Int)\n\nfoo :: Monad m\n    =&gt; Int\n    -&gt; Dummy m\n    -&gt; m [[Int]]\nfoo n d = evalStateT (traverse nxt [1..n]) 0\n where nxt _ = do s &lt;- get\n                  r &lt;- bar s d\n                  put $ s + 1\n                  return r\n\nbar :: Monad m\n    =&gt; Int\n    -&gt; Dummy m\n    -&gt; m [Int]\nbar n d = unfoldM step n\n  where step k = return $ if k &gt; 0 then Just (k, k - 1)\n                                   else Nothing\n\nmain :: IO ()\nmain = do xs &lt;- foo 3 $ Dummy (\\n -&gt; return n)\n          print xs\n</code></pre>\n\n<p>I get the following compiler error:</p>\n\n<pre><code>Davids-Air-2:haskell-rl dbanas$ stack runghc tst3.hs \n\ntst3.hs:15:23: error:\n    \u2022 Couldn't match type \u2018m\u2019 with \u2018StateT Integer m\u2019\n      \u2018m\u2019 is a rigid type variable bound by\n        the type signature for:\n          foo :: forall (m :: * -&gt; *). Monad m =&gt; Int -&gt; Dummy m -&gt; m [[Int]]\n        at tst3.hs:(11,1)-(14,16)\n      Expected type: StateT Integer m [[Int]]\n        Actual type: m [[Int]]\n    \u2022 In the first argument of \u2018evalStateT\u2019, namely\n        \u2018(traverse nxt [1 .. n])\u2019\n      In the expression: evalStateT (traverse nxt [1 .. n]) 0\n      In an equation for \u2018foo\u2019:\n          foo n d\n            = evalStateT (traverse nxt [1 .. n]) 0\n            where\n                nxt _\n                  = do s &lt;- get\n                       ....\n    \u2022 Relevant bindings include\n        nxt :: forall p. p -&gt; m [Int] (bound at tst3.hs:16:8)\n        d :: Dummy m (bound at tst3.hs:15:7)\n        foo :: Int -&gt; Dummy m -&gt; m [[Int]] (bound at tst3.hs:15:1)\n   |\n15 | foo n d = evalStateT (traverse nxt [1..n]) 0\n   |                       ^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>The solution turns out to be very simple, although it took me several hours to deduce:</p>\n\n<pre><code>          r &lt;- lift $ bar s d\n\nDavids-Air-2:haskell-rl dbanas$ stack runghc tst3.hs \n[[],[1],[2,1]]\n</code></pre>\n\n<p>I have a theory about this and would like confirmation:</p>\n\n<p>The Monad operating in <code>bar</code> is different from the Monad operating in <code>foo</code>.\nSpecifically, the Monad operating in <code>foo</code> is the <em>lifted</em> version of the Monad operating in <code>bar</code>. (Lifted into a <code>StateT</code> context, to be precise.)</p>\n\n<p>In the case of <code>tst2.hs</code> where there is no type linkage between the two <code>m</code>s (of <code>foo</code> and <code>bar</code>), this works perfectly.\nHowever, in <code>tst3.hs</code> I've provided a type linkage between the two forcing them to be the same Monad.\nAnd that is why the compiler complains.</p>\n\n<p>My solution works, only because the Monad operating in <code>foo</code> really is the <em>lifted</em> version of the one operating in <code>bar</code>.\nIf the two Monads were completely unrelated then my solution would <em>not</em> work.</p>\n\n<p>Is that all correct?</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 3627, "user_id": 3695939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d75f41bcfc1d3f20c084ec7e87d82012?s=128&d=identicon&r=PG&f=1", "display_name": "moondaisy", "link": "https://stackoverflow.com/users/3695939/moondaisy"}, "edited": false, "score": 0, "creation_date": 1522938437, "post_id": 49674687, "comment_id": 86360540, "body": "Try renaming the file to <code>Csvparser.hs</code>"}, {"owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "reply_to_user": {"reputation": 3627, "user_id": 3695939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d75f41bcfc1d3f20c084ec7e87d82012?s=128&d=identicon&r=PG&f=1", "display_name": "moondaisy", "link": "https://stackoverflow.com/users/3695939/moondaisy"}, "edited": false, "score": 0, "creation_date": 1522938910, "post_id": 49674687, "comment_id": 86360894, "body": "@moondaisy : post edited,  actually there are named exactly identically;  case sensitive : module is Csvparser and file is Csvparser.h"}, {"owner": {"reputation": 3627, "user_id": 3695939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d75f41bcfc1d3f20c084ec7e87d82012?s=128&d=identicon&r=PG&f=1", "display_name": "moondaisy", "link": "https://stackoverflow.com/users/3695939/moondaisy"}, "edited": false, "score": 0, "creation_date": 1522939225, "post_id": 49674687, "comment_id": 86361118, "body": "If you run <code>ghci</code> from the folder that contains both files the import should work, but maybe you have a reason not to run it from there"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1522951634, "post_id": 49674687, "comment_id": 86369048, "body": "You can also use <code>:cd C:\\Test\\Haskell</code> to change GHCi&#39;s directory to the one with your code. Note that this will also run your code in such directory (e.g. if your code creates a file, it will be created there)."}], "answers": [{"tags": [], "owner": {"reputation": 3627, "user_id": 3695939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d75f41bcfc1d3f20c084ec7e87d82012?s=128&d=identicon&r=PG&f=1", "display_name": "moondaisy", "link": "https://stackoverflow.com/users/3695939/moondaisy"}, "is_accepted": true, "score": 7, "last_activity_date": 1522939615, "creation_date": 1522939615, "answer_id": 49675245, "question_id": 49674687, "link": "https://stackoverflow.com/questions/49674687/how-to-configure-haskell-ghci-module-search-path/49675245#49675245", "title": "How to configure Haskell / ghci module search path?", "body": "<p>If you want to run <code>ghci</code> from a different folder that the one containing the file then do:</p>\n\n<pre><code>ghci -iC:\\Test\\Haskell\\\n</code></pre>\n\n<p><code>-i</code> sets the import search paths and then do:</p>\n\n<pre><code>:load C:\\Test\\Haskell\\MyApp.hs\n</code></pre>\n\n<p>Or from inside the <code>ghci</code> console do:</p>\n\n<pre><code>:set -iC:\\Test\\Haskell\\\n</code></pre>\n\n<p>If you want to see in which folder haskell is looking for the modules just call:</p>\n\n<pre><code>:show paths\n</code></pre>\n\n<p>It should print a list of paths under <code>module import search paths:</code></p>\n\n<p>All this isn't necessary if you run <code>ghci</code> from the folder that has your files, since by default Haskell will always look for the imports in the current folder.</p>\n\n<p><strong>Don't leave a space between <code>-i</code> and the path</strong></p>\n"}], "owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1510, "favorite_count": 0, "accepted_answer_id": 49675245, "answer_count": 1, "score": 7, "last_activity_date": 1522939615, "creation_date": 1522937986, "last_edit_date": 1522938823, "question_id": 49674687, "link": "https://stackoverflow.com/questions/49674687/how-to-configure-haskell-ghci-module-search-path", "title": "How to configure Haskell / ghci module search path?", "body": "<p>I have a first Application file,  Myapp.hs</p>\n\n<p>I have created a module for parsing csv file , called Csvparser which is defined in a file Csvparser.hs. </p>\n\n<p>Both files are in the same directory. </p>\n\n<p>I don't understand how to import in Myapp.hs the Csvparser module</p>\n\n<pre><code>Prelude Data.Maybe Data.List Data.Time Data.Either&gt; :load C:\\Test\\Haskell\\MyApp.hs\n[1 of 1] Compiling Main             ( C:\\Test\\Haskell\\MyApp.hs, interpreted )\n\nC:\\Test\\Haskell\\MyApp.hs:5:1: error:\n    Could not find module `Csvparser'\n    Use -v to see a list of the files searched for.\n  |\n5 | import Csvparser\n  | ^^^^^^^^^^^^^^^^\nFailed, no modules loaded.\nPrelude Data.Maybe Data.List Data.Time Data.Either&gt;\n</code></pre>\n\n<p>The module can be loaded in standalone and works</p>\n\n<pre><code>Prelude Data.Maybe Data.List Data.Time Data.Either&gt; :load C:\\Test\\Haskell\\Csvparser.hs\n[1 of 1] Compiling Csvparser        ( C:\\Test\\Haskell\\Csvparser.hs, interpreted )\nOk, one module loaded.\n*Csvparser Data.Maybe Data.List Data.Time Data.Either&gt; import Csvparser\n*Csvparser Data.Maybe Data.List Data.Time Data.Either Csvparser&gt; :t Csvparser.parseCSV\nCsvparser.parseCSV :: String -&gt; Either ParseError [[String]]\n*Csvparser Data.Maybe Data.List Data.Time Data.Either Csvparser&gt;\n</code></pre>\n\n<p>Here is the failing syntax at line 5 of MyApp.hs</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n\n\nimport Csvparser\nimport Database.HDBC\nimport Database.HDBC.ODBC\n</code></pre>\n\n<p>What can I do for making ghci/haskell understand that Csvparser module is to be found in the same directory of MyApp.hs ? </p>\n"}, {"tags": ["haskell", "docker"], "comments": [{"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1522966351, "post_id": 49672741, "comment_id": 86376394, "body": "<a href=\"https://support.docker.com/\" rel=\"nofollow noreferrer\">support.docker.com</a>"}, {"owner": {"reputation": 5087, "user_id": 2942471, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100000008666513/picture?type=large", "display_name": "manonthemat", "link": "https://stackoverflow.com/users/2942471/manonthemat"}, "edited": false, "score": 0, "creation_date": 1522968058, "post_id": 49672741, "comment_id": 86376893, "body": "I don&#39;t see any errors in the log. How is your autobuild configured?"}, {"owner": {"reputation": 51, "user_id": 1656163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ccf597bb421199ac3782cc4d7b9b9e?s=128&d=identicon&r=PG", "display_name": "masterq", "link": "https://stackoverflow.com/users/1656163/masterq"}, "edited": false, "score": 0, "creation_date": 1522985632, "post_id": 49672741, "comment_id": 86381035, "body": "My public repo also causes same error:  <a href=\"https://github.com/master-q/docker4fdb\" rel=\"nofollow noreferrer\">github.com/master-q/docker4fdb</a> <a href=\"https://hub.docker.com/r/masterq/docker4fdb/builds/bcuvzfebhz4nzu7xkdvpjie/\" rel=\"nofollow noreferrer\">hub.docker.com/r/masterq/docker4fdb/builds/&hellip;</a>"}, {"owner": {"reputation": 51, "user_id": 1656163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ccf597bb421199ac3782cc4d7b9b9e?s=128&d=identicon&r=PG", "display_name": "masterq", "link": "https://stackoverflow.com/users/1656163/masterq"}, "edited": false, "score": 0, "creation_date": 1522985792, "post_id": 49672741, "comment_id": 86381083, "body": "<a href=\"https://www.flickr.com/photos/masterq/40553104844/\" rel=\"nofollow noreferrer\">flickr.com/photos/masterq/40553104844</a> &lt; autobuild configured"}, {"owner": {"reputation": 51, "user_id": 1656163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ccf597bb421199ac3782cc4d7b9b9e?s=128&d=identicon&r=PG", "display_name": "masterq", "link": "https://stackoverflow.com/users/1656163/masterq"}, "edited": false, "score": 0, "creation_date": 1523081944, "post_id": 49672741, "comment_id": 86422252, "body": "My 3rd build got success. Is it fixed at Docker Hub side? <a href=\"https://hub.docker.com/r/masterq/fdb/builds/bocfoqxtwklwjevrfrj7ebd/\" rel=\"nofollow noreferrer\">hub.docker.com/r/masterq/fdb/builds/bocfoqxtwklwjevrfrj7ebd</a>"}], "owner": {"reputation": 51, "user_id": 1656163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ccf597bb421199ac3782cc4d7b9b9e?s=128&d=identicon&r=PG", "display_name": "masterq", "link": "https://stackoverflow.com/users/1656163/masterq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522932244, "creation_date": 1522932244, "question_id": 49672741, "link": "https://stackoverflow.com/questions/49672741/why-my-dockerfile-causes-error-at-docker-hub", "title": "Why my Dockerfile causes error at Docker Hub?", "body": "<p>I write following Dockerfile:</p>\n\n<pre><code>FROM ubuntu:xenial\nENV LANG C.UTF-8\nENV PATH /root/.local/bin:$PATH\nENV LTS lts-11.3\n\n\nRUN \\\n  apt-get update &amp;&amp; \\\n  apt-get -y upgrade &amp;&amp; \\\n  apt-get -y install curl git openmpi-doc openmpi-bin libopenmpi-dev &amp;&amp; \\\n  curl -sSL https://get.haskellstack.org/ | sh &amp;&amp; \\\n  stack update &amp;&amp; \\\n  stack upgrade &amp;&amp; \\\n  stack install --resolver $LTS c2hs QuickCheck array attoparsec containers directory hspec optparse-applicative repa split text time vector &amp;&amp; \\\n  stack install --resolver $LTS --extra-include-dirs=/usr/lib/openmpi/include --extra-lib-dirs=/usr/lib/openmpi/lib haskell-mpi-1.4.0 &amp;&amp; \\\n  rm -rf /var/lib/apt/lists/*\n\nCMD [\"bash\"]\n</code></pre>\n\n<p>And autobuild it on Docker Hub:</p>\n\n<p><a href=\"https://hub.docker.com/r/masterq/fdb/builds/b63fjdgpbcewabgbpfpugjh/\" rel=\"nofollow noreferrer\">https://hub.docker.com/r/masterq/fdb/builds/b63fjdgpbcewabgbpfpugjh/</a></p>\n\n<p>But it causes an error report \"Unexpected error\".\nHowever I can pull the image:</p>\n\n<pre><code>$ docker pull masterq/fdb:feature_dockerhub\nfeature_dockerhub: Pulling from masterq/fdb\n22dc81ace0ea: Already exists\n1a8b3c87dba3: Already exists\n91390a1c435a: Already exists\n07844b14977e: Already exists\nb78396653dae: Already exists\n2069ab170dd3: Pull complete\nDigest: sha256:47ec2ba2d2df6a33bbca0208348774fcbd431f0d544a5cfe46f170d93f08c7fd\nStatus: Downloaded newer image for masterq/fdb:feature_dockerhub\n</code></pre>\n\n<p>Why does Docker Hub maintain my Dockerfile as error?</p>\n\n<p>Best regards,</p>\n"}, {"tags": ["haskell", "cygwin"], "comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 1, "creation_date": 1522930988, "post_id": 49668859, "comment_id": 86354884, "body": "Type <code>cd emacs-25.3_1-x86_64</code> then press Enter, then type <code>cd bin</code> and press Enter. This will yield you to the desired folder."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1522931109, "post_id": 49668859, "comment_id": 86354983, "body": "Thank you :) And then what? <code>ghc --make helloworld</code> ?"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1522931220, "post_id": 49668859, "comment_id": 86355055, "body": "That works :) So in future <code>cd emacs-25.3_1-x86_64</code>, <code>cd bin</code> and then <code>ghc --make &lt;file name&gt;</code>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1522934320, "post_id": 49668859, "comment_id": 86357338, "body": "Suggestion for future questions: post errors and output from the console as text, and not as images -- it is easier for everyone. (You can copy and paste text in the console with Ctrl+Insert and Shift+Insert respectively.)"}], "answers": [{"comments": [{"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1522929058, "post_id": 49671069, "comment_id": 86353524, "body": "How do I navigate to it? It is in the Local disk (C:), emacs-25.3_1-x86_64 , bin"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1522930784, "post_id": 49671069, "comment_id": 86354731, "body": "@user65526 Usually, in e.g. Bash, <code>C:</code> is <code>&#47;c</code>, but looking at the contents of <code>&#47;cygdrive&#47;c</code>, that looks a lot like a <code>C:</code> drive. Use <code>cd</code> to change directory, just like you&#39;d do in the Windows Command Prompt."}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 2, "last_activity_date": 1522927133, "creation_date": 1522927133, "answer_id": 49671069, "question_id": 49668859, "link": "https://stackoverflow.com/questions/49668859/compiling-haskell-code-with-cygwin/49671069#49671069", "title": "Compiling Haskell code with Cygwin", "body": "<p>From the screen shot, your current working directory is <code>/cygdrive/c</code>, and as the <code>ls</code> command shows, there's no file there called <code>helloworld.hs</code>.</p>\n\n<p>I think you'll need to either navigate to where <code>helloworld.hs</code> is, or perhaps, alternatively, you may be able to enter the full path to the file.</p>\n\n<p>You can use the <code>cd</code> command to change directory.</p>\n"}], "owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522930357, "creation_date": 1522920608, "last_edit_date": 1592644375, "question_id": 49668859, "link": "https://stackoverflow.com/questions/49668859/compiling-haskell-code-with-cygwin", "title": "Compiling Haskell code with Cygwin", "body": "<p>I am reading &quot;Learn you a Haskell for great good&quot;, and have reached the chapter on I/O actions. I am using Windows, and have downloaded GHCi and WinGHCi.</p>\n<p>I'm trying to compile a simple program and have saved a file on emacs as <code>helloworld.hs</code> with <code>main = putStrLn &quot;hello, world&quot;</code> in it.</p>\n<p>The book says</p>\n<blockquote>\n<p>Open your terminal, navigate to the directory where <code>helloworld.hs</code> is located, and enter the following:</p>\n<pre><code>$ ghc --make helloworld\n</code></pre>\n</blockquote>\n<p>I am using Cygwin.</p>\n<p>If I put <code>$ ghc --make helloworld</code> I receive <code>target 'helloworld' is not a module name or a source file</code>. Do I have to write some specific commands in Cygwin prior to writing <code>$ ghc --make helloworld</code>?</p>\n<p>How can I navigate to where helloworld.hs is, or enter the full path to the file?  It is in the Local disk (C:), emacs-25.3_1-x86_64 , bin\n<img src=\"https://i.stack.imgur.com/JXzXF.jpg\" alt=\"enter image description here\" /></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1522919091, "post_id": 49668222, "comment_id": 86346513, "body": "Because Haskell interprets this <code>-</code> as a binary operator, use <code>(negate . abs) (-7)</code> instead."}, {"owner": {"reputation": 65, "user_id": 9600787, "user_type": "registered", "profile_image": "https://graph.facebook.com/1940374526035557/picture?type=large", "display_name": "SAN", "link": "https://stackoverflow.com/users/9600787/san"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1522919416, "post_id": 49668222, "comment_id": 86346742, "body": "Now it works. I really appreciate your help:D"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1522925354, "post_id": 49668222, "comment_id": 86350928, "body": "You can also used the <code>NegativeLiterals</code> extension to make <code>-7</code> interpreted as a single negative literal instead of an operator (unary or binary minus) applied to a positive literal."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 9, "last_activity_date": 1522921557, "creation_date": 1522921557, "answer_id": 49669198, "question_id": 49668222, "link": "https://stackoverflow.com/questions/49668222/another-trouble-about-haskell-function-composition-operator/49669198#49669198", "title": "Another trouble about Haskell Function composition operator", "body": "<p>If we look at the expression:</p>\n\n<pre><code>(negate.abs) -7\n</code></pre>\n\n<p>we see actually a subtraction. Indeed: we subtract <code>7</code> from <code>(negate . abs)</code>, so for Haskell it looks like you wrote:</p>\n\n<pre><code>(negate.abs) - (7)\n</code></pre>\n\n<p>Now in case you perform a subtraction, both operands need to be a <code>Num</code> (and both parameters need to have the same type, but that is not relevant here), since <code>(-)</code> has type <a href=\"http://hackage.haskell.org/package/base-4.11.0.0/docs/Prelude.html#v:-45-\" rel=\"noreferrer\"><strong><code>(-) :: Num n =&gt; n -&gt; n -&gt; n</code></strong></a>.</p>\n\n<p>The other expressions face the same problem (although of course with different details).</p>\n\n<p>The way to solve it is to let Haskell understand that the <code>-</code> is an <em>unary</em> minus that is related to <code>7</code>, we can do this for instance by using brackets:</p>\n\n<pre><code>(negate.abs) <b>(</b>-7<b>)</b></code></pre>\n\n<p>But we could have isolated it in other ways as well, for instance with a <code>let</code> statement:</p>\n\n<pre><code><b>let minusseven = -7 in</b> (negate.abs) <b>minusseven</b></code></pre>\n"}], "owner": {"reputation": 65, "user_id": 9600787, "user_type": "registered", "profile_image": "https://graph.facebook.com/1940374526035557/picture?type=large", "display_name": "SAN", "link": "https://stackoverflow.com/users/9600787/san"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1522921557, "creation_date": 1522918832, "question_id": 49668222, "link": "https://stackoverflow.com/questions/49668222/another-trouble-about-haskell-function-composition-operator", "title": "Another trouble about Haskell Function composition operator", "body": "<pre><code>*Main&gt; (negate.abs) -7\n\n&lt;interactive&gt;:26:1: error:\n? Non type-variable argument in the constraint: Num (c -&gt; c)\n  (Use FlexibleContexts to permit this)\n? When checking the inferred type\n    it :: forall c. (Num (c -&gt; c), Num c) =&gt; c -&gt; c\n</code></pre>\n\n<p>Hi, I am the questioner of  <a href=\"https://stackoverflow.com/questions/49666499/some-errors-and-difficulties-with-haskell-function-composition?noredirect=1#comment86342949_49666499\">Some errors and difficulties with Haskell function composition</a>, and now I got another trouble. Why this simple code not works?\nHere is not-working code lists:</p>\n\n<pre><code>(negate.abs) -7\nnegate (abs -7)\nnegate.abs -7\n\nnegate.abs $ 7 //only this works\n</code></pre>\n\n<p>with all same error message above.  I couldn't figure it out, so could I get a little help about why it doesn't work and how can I fix it? And also I'd like to understand the meaning of the error message, and why only the last one works. Thank you.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1522913261, "post_id": 49666499, "comment_id": 86342786, "body": "The error is not related to the code fragment I think, please post a fragment such that we can replicate the code."}, {"owner": {"reputation": 2997, "user_id": 3239842, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/43fb8ed63990c7b890667c0a6c5e4674?s=128&d=identicon&r=PG&f=1", "display_name": "Binarus", "link": "https://stackoverflow.com/users/3239842/binarus"}, "edited": false, "score": 3, "creation_date": 1522913525, "post_id": 49666499, "comment_id": 86342949, "body": "Please post your complete code. You also might be interested in learning <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask a good question</a> and <a href=\"https://stackoverflow.com/help/mcve\">how to create a minimal, complete and verifiable example</a>."}], "answers": [{"tags": [], "owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "is_accepted": false, "score": 6, "last_activity_date": 1522913459, "creation_date": 1522913459, "answer_id": 49666602, "question_id": 49666499, "link": "https://stackoverflow.com/questions/49666499/some-errors-and-difficulties-with-haskell-function-composition/49666602#49666602", "title": "Some errors and difficulties with Haskell function composition", "body": "<p>The code <code>f . g x</code> doesn't work because it gets parsed as <code>f . (g x)</code>. That is, at first <code>g</code> is applied to <code>x</code>, and then you try to get the composition of <code>f</code> with the result of <code>g x</code>.</p>\n\n<p>To make this work, you can surround the composition with parentheses <code>(f . g) x</code>, or use the <code>$</code> operator, which has the lowest priority of all operators and thus can be used to separate things: <code>f . g $ x</code>.</p>\n"}], "owner": {"reputation": 65, "user_id": 9600787, "user_type": "registered", "profile_image": "https://graph.facebook.com/1940374526035557/picture?type=large", "display_name": "SAN", "link": "https://stackoverflow.com/users/9600787/san"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522931675, "creation_date": 1522913151, "last_edit_date": 1522931675, "question_id": 49666499, "link": "https://stackoverflow.com/questions/49666499/some-errors-and-difficulties-with-haskell-function-composition", "title": "Some errors and difficulties with Haskell function composition", "body": "<pre><code>f x = x + 3\ng x = x * 3\n</code></pre>\n\n\n\n<pre><code>&lt;interactive&gt;:17:1: error:\n\n    ? Non type-variable argument in the constraint: Num (a -&gt; c)\n      (Use FlexibleContexts to permit this)\n    ? When checking the inferred type\n        it :: forall c a. (Num (a -&gt; c), Num c) =&gt; a -&gt; c\n</code></pre>\n\n<p>I'm getting an error with function composition operator. Why does it not work? <code>f x</code> works, <code>g x</code> works, and even <code>f(g x)</code> works, but <code>f.g x</code> doesn't work.</p>\n"}, {"tags": ["haskell", "constraints", "type-families", "type-level-computation", "singleton-type"], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 3, "last_activity_date": 1522927428, "creation_date": 1522927428, "answer_id": 49671162, "question_id": 49663871, "link": "https://stackoverflow.com/questions/49663871/working-with-proofs-involving-cmpnat-and-singletons-in-haskell/49671162#49671162", "title": "working with proofs involving CmpNat and singletons in Haskell", "body": "<p>The compiler is rejecting <code>plusOneLTProof</code> because its type is ambiguous. We can disable that constraint with the extension <code>AllowAmbiguousTypes</code>. I would recommend using that together with <code>ExplicitForall</code> (which is implied by <code>ScopedTypeVariables</code>, that we'll certainly need anyway, or <code>RankNTypes</code>). That's for defining it. A definition that has an ambiguous type can be used with <code>TypeApplications</code>.</p>\n\n<p>However, GHC still can't reason about naturals, so we can't define <code>plusOneLTProof = Sub Dict</code>, much less <code>incrementLength</code>, not safely.</p>\n\n<p>But we can still create the proof out of thin air with <code>unsafeCoerce</code>. This is in fact how the <a href=\"https://hackage.haskell.org/package/constraints-0.10/docs/Data-Constraint-Nat.html\" rel=\"nofollow noreferrer\"><code>Data.Constraint.Nat</code></a> module in <em>constraints</em> is implemented; unfortunately it currently doesn't contain any facts about <code>CmpNat</code>. The coercion works because there is no runtime content in type equalities. Even if the runtime values look fine, thus asserting incoherent facts can still lead to programs to go wrong.</p>\n\n<pre><code>plusOneLTProof :: forall n m. (CmpNat n m ~ 'LT) :- (CmpNat n (m+1) ~ 'LT)\nplusOneLTProof = Sub axiom\n  where\n    axiom :: (CmpNat n m ~ 'LT) =&gt; Dict (CmpNat n (m+1) ~ 'LT)\n    axiom = unsafeCoerce (Dict :: Dict (a ~ a))\n</code></pre>\n\n<p>To use the proof, we specialize it (with <code>TypeApplications</code>) and pattern match on it to introduce the RHS in the context, checking that the LHS holds.</p>\n\n<pre><code>incrementLength :: Foo -&gt; Foo\nincrementLength (Foo (n :: SNat n) (m :: SNat m)) =\n  case plusOneLTProof @n @m of\n    Sub Dict -&gt; Foo n (m %+ (sing :: SNat 1))\n</code></pre>\n"}], "owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 49671162, "answer_count": 1, "score": 2, "last_activity_date": 1522931714, "creation_date": 1522900288, "last_edit_date": 1522931714, "question_id": 49663871, "link": "https://stackoverflow.com/questions/49663871/working-with-proofs-involving-cmpnat-and-singletons-in-haskell", "title": "working with proofs involving CmpNat and singletons in Haskell", "body": "<p>I'm trying to create some functions to work with the following type.  The following code uses the <a href=\"https://hackage.haskell.org/package/singletons-2.4.1\" rel=\"nofollow noreferrer\">singletons</a> and <a href=\"https://hackage.haskell.org/package/constraints-0.10\" rel=\"nofollow noreferrer\">constraints</a> libraries on GHC-8.4.1:</p>\n\n<pre><code>{-# LANGUAGE ConstraintKinds #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE GADTs #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE PolyKinds #-}\n{-# LANGUAGE RankNTypes #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE TypeApplications #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE TypeInType #-}\n{-# LANGUAGE UndecidableInstances #-}\n\nimport Data.Constraint ((:-))\nimport Data.Singletons (sing)\nimport Data.Singletons.Prelude (Sing(SEQ, SGT, SLT), (%+), sCompare)\nimport Data.Singletons.Prelude.Num (PNum((+)))\nimport Data.Singletons.TypeLits (SNat)\nimport GHC.TypeLits (CmpNat, Nat)\n\ndata Foo where\n  Foo\n    :: forall (index :: Nat) (len :: Nat).\n       (CmpNat index len ~ 'LT)\n    =&gt; SNat index\n    -&gt; SNat len\n    -&gt; Foo\n</code></pre>\n\n<p>This is a GADT that contains a length and an index.  The index is is guaranteed to be less than the length.</p>\n\n<p>It is easy enough to write a function to create a <code>Foo</code>:</p>\n\n<pre><code>createFoo :: Foo\ncreateFoo = Foo (sing :: SNat 0) (sing :: SNat 1)\n</code></pre>\n\n<p>However, I'm having trouble writing a function that increments the <code>len</code> while keeping the <code>index</code> the same:</p>\n\n<pre><code>incrementLength :: Foo -&gt; Foo\nincrementLength (Foo index len) = Foo index (len %+ (sing :: SNat 1))\n</code></pre>\n\n<p>This is failing with the following error:</p>\n\n<pre><code>file.hs:34:34: error:\n    \u2022 Could not deduce: CmpNat index (len GHC.TypeNats.+ 1) ~ 'LT\n        arising from a use of \u2018Foo\u2019\n      from the context: CmpNat index len ~ 'LT\n        bound by a pattern with constructor:\n                   Foo :: forall (index :: Nat) (len :: Nat).\n                          (CmpNat index len ~ 'LT) =&gt;\n                          SNat index -&gt; SNat len -&gt; Foo,\n                 in an equation for \u2018incrementLength\u2019\n        at what5.hs:34:17-29\n    \u2022 In the expression: Foo index (len %+ (sing :: SNat 1))\n      In an equation for \u2018incrementLength\u2019:\n          incrementLength (Foo index len)\n            = Foo index (len %+ (sing :: SNat 1))\n    \u2022 Relevant bindings include\n        len :: SNat len (bound at what5.hs:34:27)\n        index :: SNat index (bound at what5.hs:34:21)\n   |\n34 | incrementLength (Foo index len) = Foo index (len %+ (sing :: SNat 1))\n   |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>This makes sense, since the compiler knows that <code>CmpNat index len ~ 'LT</code> (from the definition of Foo), but doesn't know that <code>CmpNat index (len + 1) ~ 'LT</code>.</p>\n\n<p>Is there any way to get something like this to work?</p>\n\n<p>It is possible to use <code>sCompare</code> to do something like this:</p>\n\n<pre><code>incrementLength :: Foo -&gt; Foo\nincrementLength (Foo index len) =\n  case sCompare index (len %+ (sing :: SNat 1)) of\n    SLT -&gt; Foo index (len %+ (sing :: SNat 1))\n    SEQ -&gt; error \"not eq\"\n    SGT -&gt; error \"not gt\"\n</code></pre>\n\n<p>However, it seems unfortunate that I have to write cases for <code>SEQ</code> and <code>SGT</code>, when I know they will never be matched.</p>\n\n<p>Also, I thought it might be possible to create a type like the following:</p>\n\n<pre><code>plusOneLTProof :: (CmpNat n m ~ 'LT) :- (CmpNat n (m + 1) ~ 'LT)\nplusOneLTProof = undefined\n</code></pre>\n\n<p>However, this gives an error like the following:</p>\n\n<pre><code>file.hs:40:8: error:\n    \u2022 Couldn't match type \u2018CmpNat n0 m0\u2019 with \u2018CmpNat n m\u2019\n      Expected type: (CmpNat n m ~ 'LT) :- (CmpNat n (m + 1) ~ 'LT)\n        Actual type: (CmpNat n0 m0 ~ 'LT) :- (CmpNat n0 (m0 + 1) ~ 'LT)\n      NB: \u2018CmpNat\u2019 is a non-injective type family\n      The type variables \u2018n0\u2019, \u2018m0\u2019 are ambiguous\n    \u2022 In the ambiguity check for \u2018bar\u2019\n      To defer the ambiguity check to use sites, enable AllowAmbiguousTypes\n      In the type signature:\n        bar :: (CmpNat n m ~  'LT) :- (CmpNat n (m + 1) ~  'LT)\n   |\n40 | bar :: (CmpNat n m ~ 'LT) :- (CmpNat n (m + 1) ~ 'LT)\n   |        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>This makes sense, I guess, since CmpNat is non-injective.  However, I know that this implication is true, so I'd like to be able to write this function.</p>\n\n<hr>\n\n<p>I'd like an answer to the following two questions:</p>\n\n<ol>\n<li><p>Is there a way to write <code>incrementLength</code> where you'd only have to match on <code>SLT</code>?  I'd be fine with changing the definition of <code>Foo</code> to make this easier.</p></li>\n<li><p>Is there a way to write <code>plusOneLTProof</code>, or at least something similar?</p></li>\n</ol>\n\n<hr>\n\n<p><em>Update</em>: I ended up using the suggestion from Li-yao Xia to write <code>plusOneLTProof</code> and <code>incrementLength</code> like the following:</p>\n\n<pre><code>incrementLength :: Foo -&gt; Foo\nincrementLength (Foo index len) =\n  case plusOneLTProof index len of\n    Sub Dict -&gt; Foo index (len %+ (sing :: SNat 1))\n\nplusOneLTProof :: forall n m. SNat n -&gt; SNat m -&gt; (CmpNat n m ~ 'LT) :- (CmpNat n (m + 1) ~ 'LT)\nplusOneLTProof SNat SNat = Sub axiom\n  where\n    axiom :: CmpNat n m ~ 'LT =&gt; Dict (CmpNat n (m + 1) ~ 'LT)\n    axiom = unsafeCoerce (Dict :: Dict (a ~ a))\n</code></pre>\n\n<p>This requires that you pass in two <code>SNat</code>s to <code>plusOneLTProof</code>, but it doesn't require <code>AllowAmbiguousTypes</code>.</p>\n"}, {"tags": ["haskell", "quickcheck"], "answers": [{"comments": [{"owner": {"reputation": 2699, "user_id": 304435, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/38fb50d1c81b7a8ea1994bc02f695fef?s=128&d=identicon&r=PG", "display_name": "tesserakt", "link": "https://stackoverflow.com/users/304435/tesserakt"}, "edited": false, "score": 0, "creation_date": 1522903948, "post_id": 49663627, "comment_id": 86338466, "body": "Right, so you sample a function and random input values and consider that good enough.  So then Eq is &quot;decidable&quot; and EqProp is &quot;close enough&quot;"}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 2, "last_activity_date": 1522898560, "creation_date": 1522898560, "answer_id": 49663627, "question_id": 49663264, "link": "https://stackoverflow.com/questions/49663264/checkers-and-eqprop/49663627#49663627", "title": "Checkers and EqProp", "body": "<p>The point is that functions and infinite values do not have <em>decidable</em> equality (<code>Eq</code>), but can be <em>tested</em> for it (<code>EqProp</code>) by observing a (random) finite fragment.</p>\n"}, {"comments": [{"owner": {"reputation": 2699, "user_id": 304435, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/38fb50d1c81b7a8ea1994bc02f695fef?s=128&d=identicon&r=PG", "display_name": "tesserakt", "link": "https://stackoverflow.com/users/304435/tesserakt"}, "edited": false, "score": 0, "creation_date": 1522907430, "post_id": 49663907, "comment_id": 86339699, "body": "So it would seem that QuickCheck does not have the ability to do random sampling. Thanks for your answer, it is quite helpful!"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 2699, "user_id": 304435, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/38fb50d1c81b7a8ea1994bc02f695fef?s=128&d=identicon&r=PG", "display_name": "tesserakt", "link": "https://stackoverflow.com/users/304435/tesserakt"}, "edited": false, "score": 3, "creation_date": 1522907817, "post_id": 49663907, "comment_id": 86339899, "body": "@tesserakt QuickCheck can do random sampling -- in fact, that is one of the key ideas behind it. When you use Checkers, you <i>are</i> using QuickCheck and its random sampling; Checkers just adds an extra layer of convenience functions."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 3, "last_activity_date": 1522900593, "creation_date": 1522900593, "answer_id": 49663907, "question_id": 49663264, "link": "https://stackoverflow.com/questions/49663264/checkers-and-eqprop/49663907#49663907", "title": "Checkers and EqProp", "body": "<blockquote>\n  <p>This library introduces the <code>EqProp</code> typeclass, and I don't understand how this differs from <code>Eq</code>.</p>\n</blockquote>\n\n<p><code>(==)</code> from <code>Eq</code> gives you a <code>Bool</code>; <code>(=-=)</code> from <code>EqProp</code> gives you a QuickCheck <code>Property</code>. If you have an instance of <code>Eq</code>, you can also make it an <code>EqProp</code> instance, <a href=\"https://hackage.haskell.org/package/checkers-0.4.9.5/docs/Test-QuickCheck-Checkers.html#v:eq\" rel=\"nofollow noreferrer\">as witnessed by <code>eq</code></a>. The interesting instances of <code>EqProp</code> are those that <em>aren't</em> instances of <code>Eq</code>, such as functions (cf. <a href=\"https://stackoverflow.com/a/49663627/2751851\">Li-yao Xia's answer</a>).</p>\n\n<blockquote>\n  <p>Why do people use checkers over Quickcheck?</p>\n</blockquote>\n\n<p>Checkers is a set of extra tools built upon QuickCheck. As its <a href=\"https://github.com/conal/checkers\" rel=\"nofollow noreferrer\">readme</a> and <a href=\"https://hackage.haskell.org/package/checkers\" rel=\"nofollow noreferrer\">Hackage description</a> suggest, one of its goals is making it easy to express class laws as Quickcheck properties. For instance, note how the definition of <a href=\"https://hackage.haskell.org/package/checkers-0.4.9.5/docs/Test-QuickCheck-Classes.html#v:applicative\" rel=\"nofollow noreferrer\">the <code>applicative</code> \"test batch\"</a>, which I will quote below, looks a lot like how we often write the <code>Applicative</code> laws, and is nicely self-documenting.</p>\n\n<p>(Feel free to skip the bookkeeping constraints in the top-level signature. Also note that the <code>m (a,b,c)</code> argument is, in a simplest-thing-that-could-possibly-work fashion, only used for type specialisation, the intent being that you pass e.g. <code>undefined :: [(Int,Int,Int)]</code> to test the list instance of <code>Applicative</code>.)</p>\n\n<pre><code>-- | Properties to check that the 'Applicative' @m@ satisfies the applicative\n-- properties\napplicative :: forall m a b c.\n               ( Applicative m\n               , Arbitrary a, CoArbitrary a, Arbitrary b, Arbitrary (m a)\n               , Arbitrary (m (b -&gt; c)), Show (m (b -&gt; c))\n               , Arbitrary (m (a -&gt; b)), Show (m (a -&gt; b))\n               , Show a, Show (m a)\n               , EqProp (m a), EqProp (m b), EqProp (m c)\n               ) =&gt;\n               m (a,b,c) -&gt; TestBatch\napplicative = const ( \"applicative\"\n                    , [ (\"identity\"    , property identityP)\n                      , (\"composition\" , property compositionP)\n                      , (\"homomorphism\", property homomorphismP)\n                      , (\"interchange\" , property interchangeP)\n                      , (\"functor\"     , property functorP)\n                      ]\n                    )\n where\n   identityP     :: m a -&gt; Property\n   compositionP  :: m (b -&gt; c) -&gt; m (a -&gt; b) -&gt; m a -&gt; Property\n   homomorphismP :: (a -&gt; b) -&gt; a -&gt; Property\n   interchangeP  :: m (a -&gt; b) -&gt; a -&gt; Property\n   functorP      :: (a -&gt; b) -&gt; m a -&gt; Property\n\n   identityP v        = (pure id &lt;*&gt; v) =-= v\n   compositionP u v w = (pure (.) &lt;*&gt; u &lt;*&gt; v &lt;*&gt; w) =-= (u &lt;*&gt; (v &lt;*&gt; w))\n   homomorphismP f x  = (pure f &lt;*&gt; pure x) =-= (pure (f x) :: m b)\n   interchangeP u y   = (u &lt;*&gt; pure y) =-= (pure ($ y) &lt;*&gt; u)\n   functorP f x       = (fmap f x) =-= (pure f &lt;*&gt; x)\n</code></pre>\n"}], "owner": {"reputation": 2699, "user_id": 304435, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/38fb50d1c81b7a8ea1994bc02f695fef?s=128&d=identicon&r=PG", "display_name": "tesserakt", "link": "https://stackoverflow.com/users/304435/tesserakt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "accepted_answer_id": 49663907, "answer_count": 2, "score": 3, "last_activity_date": 1523802256, "creation_date": 1522895823, "last_edit_date": 1523802256, "question_id": 49663264, "link": "https://stackoverflow.com/questions/49663264/checkers-and-eqprop", "title": "Checkers and EqProp", "body": "<p>I am going through the <a href=\"http://haskellbook.com/\" rel=\"nofollow noreferrer\">Haskell Book</a> and the chapter on applicatives started using the <a href=\"https://hackage.haskell.org/package/checkers\" rel=\"nofollow noreferrer\">checkers</a> library for testing.</p>\n\n<p>This library introduces the <code>EqProp</code> typeclass, and I don't understand how it differs from <code>Eq</code>. Most of the examples that call for <code>EqProp</code> use <code>Eq</code> under the hood anyway.</p>\n\n<p>Why do people use checkers over QuickCheck?</p>\n"}]