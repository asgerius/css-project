[{"tags": ["haskell", "functional-programming", "custom-data-type"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1507160917, "post_id": 46575744, "comment_id": 80104971, "body": "Sure: <code>let (Let name val body) = expr in \u2026name\u2026</code>, if you know that the <code>expr</code> is a <code>Let</code>. Or use any other form of pattern matching in functions or <code>case</code>"}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 2, "creation_date": 1507161236, "post_id": 46575744, "comment_id": 80105050, "body": "Often when you&#39;re asking a question about Haskell it will be useful to explicitly tell us the <i>type</i> of the function you&#39;re trying to write, if you can. Thinking about that is a good exercise, and will also help you write a more clear question."}, {"owner": {"reputation": 29, "user_id": 5920852, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/65a7e1b3a3d93faebfbddc84e15d7538?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymous 23234720-12473", "link": "https://stackoverflow.com/users/5920852/anonymous-23234720-12473"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1507161809, "post_id": 46575744, "comment_id": 80105205, "body": "@ChrisMartin I&#39;m working on some homework, so I didn&#39;t want anybody to straight up solve the problem for me. But what I&#39;m trying to do is create a function that takes an <code>Expr</code> datatype and returns the <code>xml</code> representation of that <code>Expr</code> as a String. Without you actually reading the homework handout that probably doesn&#39;t make much sense."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5920852, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/65a7e1b3a3d93faebfbddc84e15d7538?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymous 23234720-12473", "link": "https://stackoverflow.com/users/5920852/anonymous-23234720-12473"}, "edited": false, "score": 0, "creation_date": 1507161186, "post_id": 46575808, "comment_id": 80105034, "body": "Oh wow I knew about using, if I remember correctly <code>wildcards</code>?, but that didn&#39;t really click with me for some reason."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1507164264, "post_id": 46575808, "comment_id": 80105777, "body": "In fact, such piecewise function definitions are syntactic sugar for <code>myfunction x = case x of (Let str _ _) = ...</code>."}], "tags": [], "owner": {"reputation": 13432, "user_id": 331473, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a887c3de7f5051c9d0d88a5f7c04287d?s=128&d=identicon&r=PG", "display_name": "Adam Wagner", "link": "https://stackoverflow.com/users/331473/adam-wagner"}, "is_accepted": false, "score": 4, "last_activity_date": 1507161520, "last_edit_date": 1507161520, "creation_date": 1507160910, "answer_id": 46575808, "question_id": 46575744, "link": "https://stackoverflow.com/questions/46575744/is-it-possible-to-access-a-specific-piece-of-a-custom-data-type-in-haskell/46575808#46575808", "title": "Is it possible to access a specific piece of a custom data type in Haskell?", "body": "<p>Pattern matching is your answer.</p>\n\n<p>Something like this should do the trick:</p>\n\n<pre><code>myfunction :: Expr -&gt; SomeReturnType\nmyfunction (Let str _ _) = doSomethingWith str   -- \"str\" here is your string\n</code></pre>\n\n<p>You'll want to handle the other cases as well though, so you don't cause a runtime error:</p>\n\n<pre><code>myfunction :: Expr -&gt; SomeReturnType\nmyfunction (Let str _ _) = doSomethingElse str\nmyfunction (Binary _ _ _) = somethingEvenDifferent\nmyfunction (Unary _ _) = etc\n--- etc...\n</code></pre>\n\n<p>the <code>_</code> just says to ignore the value at that position in the constructor.</p>\n\n<hr>\n\n<p>Also, as @Bergi mentioned, there are many other places you can use pattern matching, like <code>let</code> or <code>case</code> statements, just always be sure to handle all the cases that your value could potentially be at that point in your program. </p>\n"}], "owner": {"reputation": 29, "user_id": 5920852, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/65a7e1b3a3d93faebfbddc84e15d7538?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymous 23234720-12473", "link": "https://stackoverflow.com/users/5920852/anonymous-23234720-12473"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 610, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1507187914, "creation_date": 1507160445, "last_edit_date": 1507187914, "question_id": 46575744, "link": "https://stackoverflow.com/questions/46575744/is-it-possible-to-access-a-specific-piece-of-a-custom-data-type-in-haskell", "title": "Is it possible to access a specific piece of a custom data type in Haskell?", "body": "<p>I'm very new to haskell, and functional programming in general, I'm switching back and fourth between two different books on haskell, but I can't seem to find an answer to my question. Say I have a custom datatype like the one below </p>\n\n<pre><code>data Expr\n  = Let String Expr Expr\n  | Binary BinOp Expr Expr\n  | Unary UnOp Expr\n  | Literal Literal\n  | Var String\n</code></pre>\n\n<p>and I have an instance of this data type that is in the form of the first constructor <code>Let String Expr Expr</code>, is it possible to access a specific piece of that <code>Expr</code>? For example if I wanted to access the <code>String</code> within that specific instance. </p>\n"}, {"tags": ["debugging", "haskell"], "owner": {"reputation": 11, "user_id": 8723012, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155036709455003/picture?type=large", "display_name": "Gary Colyn Hanley", "link": "https://stackoverflow.com/users/8723012/gary-colyn-hanley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1507156130, "creation_date": 1507155330, "last_edit_date": 1507156130, "question_id": 46575006, "link": "https://stackoverflow.com/questions/46575006/debugging-a-simple-haskell-function-to-place-colors-to-nodes-graphcolor", "title": "Debugging a simple haskell function to place colors to nodes &quot;graphColor&quot;", "body": "<p>So I have an assignment in haskell that I am stuck on with my logic and this is the problem I was given: </p>\n\n<p>graphColor finds all possible colorings for a graph\n  a coloring is an assignment of nodes to colors\n    such that two nodes must have different colors if they are connected by an\nedge</p>\n\n<p>graphColor takes the following arguments </p>\n\n<ol>\n<li>A list of colors</li>\n<li>A list of nodes</li>\n<li>A list of edges (i.e., pairs of nodes)</li>\n<li>A partial coloring (i.e., a list of pairs of node and color)</li>\n</ol>\n\n<p>Example list of edges</p>\n\n<pre><code>e1 :: [Edge]\ne1 = [(1,3),(2,1),(2,5),(3,1),(3,2),(3,3),(3,4),(3,5),(5,6),(2,6)]\n\ne2 :: [Edge]\ne2 = [(1,2),(2,3),(3,4),(1,3),(2,4),(1,4)]\n\ntype Code = [(Char,Char)]\n\n-- domain of our code\n\ndomain1 :: [Char]\ndomain1 = ['a'..'z']\n\n-- associated range\n\nrange1 :: [Char]\nrange1 = ['q'..'z'] ++ ['a'..'p']\n\n-- create a code out of our domain and range\ncode1 :: Code\ncode1 = zip domain1 range1\n</code></pre>\n\n<p><code>graphColor</code> returns all complete colorings of the graph, if there is more than one solution, your list does not need to contain all of them, as long as it contains at least one.</p>\n\n<h2>Ex1:</h2>\n\n<pre><code>&gt; take 1 (graphColor \"abc\" [1..6] e1 [])\n[[(6,'c'),(5,'a'),(4,'a'),(3,'c'),(2,'b'),(1,'a')]]\n</code></pre>\n\n<h2>Ex2:</h2>\n\n<pre><code>&gt; take 1 (graphColor \"abc\" [1..4] e2 [])\n[]\n</code></pre>\n\n<p>This is my code thus far which just returns the empty list no matter what.</p>\n\n<pre><code>graphColor :: [Color] -&gt; [Node] -&gt; [Edge] -&gt; Coloring -&gt; [Coloring]\n-- Fill in your code here\ngraphColor colors nodes edges solution\n  | length nodes == length solution = [solution]\n  | otherwise = concat [graphColor colors nodes edges (newSol : solution) |\n                             x &lt;- nodes, y &lt;- colors,\n                             newSol &lt;- [(x,y)],\n                             notRepeat solution edges x y,\n                             notElem newSol solution]\nnotRepeat :: Coloring -&gt; [Edge] -&gt; Node -&gt; Color -&gt; Bool\nnotRepeat solution edges x y \n  | x `elem` [z | (z,_) &lt;- solution] = False\n  |otherwise = helpHelper edges [z | (z,y) &lt;- solution] x\n\nhelpHelper edges matchedNodes x\n   = x `elem` [z | y &lt;- matchedNodes, (z,y) &lt;- edges] ++\n     [z | y &lt;- matchedNodes, (y,z) &lt;- edges]\n</code></pre>\n"}, {"tags": ["debugging", "haskell", "exception", "stack-overflow", "trace"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1507149235, "post_id": 46573457, "comment_id": 80100989, "body": "I think you can add a run-time flag <code>-xc</code> I think - to get stack traces when programs crash - see <a href=\"https://neilmitchell.blogspot.co.at/2015/09/detecting-space-leaks.html\" rel=\"nofollow noreferrer\">neilmitchell.blogspot.co.at/2015/09/detecting-space-leaks.ht&zwnj;&#8203;ml</a> for a great article about space leaks and how to find/fix them."}, {"owner": {"reputation": 6986, "user_id": 877603, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ecf2008864ba219bf52317d2ff31ffe2?s=128&d=identicon&r=PG", "display_name": "TheIronKnuckle", "link": "https://stackoverflow.com/users/877603/theironknuckle"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1507149444, "post_id": 46573457, "comment_id": 80101067, "body": "@epsilonhalbe that&#39;s cool, but I don&#39;t actually want a stack trace. I want to force evaluate the &#39;trace&#39; expression so as to print the variable values to the screen in a formatted debug string"}, {"owner": {"reputation": 6986, "user_id": 877603, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ecf2008864ba219bf52317d2ff31ffe2?s=128&d=identicon&r=PG", "display_name": "TheIronKnuckle", "link": "https://stackoverflow.com/users/877603/theironknuckle"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1507149556, "post_id": 46573457, "comment_id": 80101114, "body": "Also I don&#39;t really need to hunt down the memory leak because I already know exactly where it is. I really just want to print some values so I can see exactly what the program is working on"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1507151222, "post_id": 46573457, "comment_id": 80101923, "body": "This would benefit from a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. I&#39;m pretty sure the problem is <i>not</i> that \u201cHaskell is refusing to evaluate the <code>trace</code>\u201d, rather it probably <i>is</i> evaluating the <code>trace</code> and that&#39;s triggering the problem (which lies in <code>g</code> or <code>e</code>, themselves, so you get the same error regardless of whether <code>trace</code> triggers it or the following function)."}, {"owner": {"reputation": 6986, "user_id": 877603, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ecf2008864ba219bf52317d2ff31ffe2?s=128&d=identicon&r=PG", "display_name": "TheIronKnuckle", "link": "https://stackoverflow.com/users/877603/theironknuckle"}, "edited": false, "score": 0, "creation_date": 1507152018, "post_id": 46573457, "comment_id": 80102290, "body": "it is <i>not</i> evaluating the trace, because the side effect of &quot;printing to stdout&quot; is not happening. Instead the program just craps out with a stackoverflow exception. I want to see the intermediate values."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1507154659, "post_id": 46573457, "comment_id": 80103325, "body": "have you taken a look at the compiler output with <code>-ddump-simpl</code> maybe the optimizer (correctly IMHO) optimizes the guard with False away."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1507154967, "post_id": 46573457, "comment_id": 80103418, "body": "there is also a good idea to use ghci debugging see <a href=\"https://stackoverflow.com/questions/6724434/how-to-debug-haskell-code\">here</a> breaking on exceptions and <a href=\"https://downloads.haskell.org/~ghc/master/users-guide/ghci.html#ghci-debugger\" rel=\"nofollow noreferrer\">here</a> for general info - it is definitely no big fun to use, but not to bad once you&#39;ve used it a bit."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1507155682, "post_id": 46573457, "comment_id": 80103651, "body": "ps.: there is a lot of calling to <code>error</code> or <code>undefined</code> or partial functions (esp.   take a look at your instance declarations, they are problematic in my opinion), I&#39;d advise you to use hlint and compiling with <code>-Wall</code>. Btw. you are using <code>errz</code> in a lot of expressions - which is essentially the same as your <code>trace</code> expression - If you have a recursive data-structure in <code>g</code> or <code>e</code> you would experience the same behaviour whether you have the trace expression or not - if you run into an error - for example in the <code>case lookup</code> part."}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1507170256, "post_id": 46575132, "comment_id": 80107022, "body": "You can also reproduce this more simply, I suspect, by making <code>show g</code> demand an infinite amount of heap memory, so that you don&#39;t have to futz with runtime settings. For example, <code>let g = 1:g in trace (&quot;exp: &quot; ++ show g) $ head g</code>"}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 4, "last_activity_date": 1507156098, "creation_date": 1507156098, "answer_id": 46575132, "question_id": 46573457, "link": "https://stackoverflow.com/questions/46573457/how-to-use-trace-when-dealing-with-an-out-of-memory-exception-stackoverflow/46575132#46575132", "title": "How to use &quot;trace&quot; when dealing with an &quot;out of memory&quot; exception/stackoverflow in Haskell?", "body": "<p>I think what @leftroundabout is saying is that, if the evaluation of <code>g</code> or <code>e</code> triggers the problem, then the act of tracing will generate an exception before any output is traced.</p>\n\n<p><code>trace</code> marshals its argument out to a C string for output.  Therefore, <code>show g</code> and <code>show e</code> must be fully evaluated before <code>trace</code> prints a single character of output.</p>\n\n<p>As an example, the following program:</p>\n\n<pre><code>import Debug.Trace\n\nbadsum = sum [1..1000000]\n\nprocess g | trace (\"processing \" ++ show g) False = undefined\nprocess _ = \"whatever\"\n\nmain = print (process badsum)\n</code></pre>\n\n<p>when compiled without optimizations and run with a small heap size:</p>\n\n<pre><code>$ stack ghc -- -fforce-recomp -rtsopts Trace\n[1 of 1] Compiling Main             ( Trace.hs, Trace.o )\nLinking Trace ...\n$ ./Trace +RTS -M10M\nTrace: Heap exhausted;\nTrace: Current maximum heap size is 10485760 bytes (10 MB).\nTrace: Use `+RTS -M&lt;size&gt;' to increase it.\n</code></pre>\n\n<p>generates an exception before the <code>trace</code> call prints anything.  In the process of evaluating <code>trace</code>, the value of <code>g</code> is fully evaluated, triggering an exception before <code>trace</code> generates output.</p>\n\n<p>Replace the <code>trace</code> call with <code>trace \"processing\" False</code>, and the program prints the trace and runs to completion (since it never tries to evaluate <code>g</code>).</p>\n"}], "owner": {"reputation": 6986, "user_id": 877603, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ecf2008864ba219bf52317d2ff31ffe2?s=128&d=identicon&r=PG", "display_name": "TheIronKnuckle", "link": "https://stackoverflow.com/users/877603/theironknuckle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1507156098, "creation_date": 1507148233, "last_edit_date": 1507152195, "question_id": 46573457, "link": "https://stackoverflow.com/questions/46573457/how-to-use-trace-when-dealing-with-an-out-of-memory-exception-stackoverflow", "title": "How to use &quot;trace&quot; when dealing with an &quot;out of memory&quot; exception/stackoverflow in Haskell?", "body": "<p>Context: I'm writing an interpreter for a language which is basically a small subset of Haskell.</p>\n\n<p>Haskell's lazy evaluation is being a poo and refusing to evaluate this <code>trace</code> command due to (I suspect) an infinite recursion which results in an \"Out of memory\" exception.</p>\n\n<pre><code>evalE :: VEnv -&gt; Exp -&gt; Value\nevalE g e | trace (\"VEnv: \" ++ show g ++ \"\\nExp: \" ++ show e ++ \"\\n\\n\") False = undefined\n-- actual definition of evalE follows from here\n-- ...\n</code></pre>\n\n<p>I'm getting the following result:</p>\n\n<pre><code>weber % ./run_tests.sh\nBuilding minhs-0.1.0.0...\nPreprocessing executable 'minhs-1' for minhs-0.1.0.0...\nCheck.hs: out of memory (requested 1048576 bytes)\nweber %\n</code></pre>\n\n<p>Is there some easy way to force <code>trace</code> to evaluate, regardless of the exception? Perhaps a way to quickly force strict evaluation? I really would like to get some debugging info about what it's actually trying to evaluate.</p>\n\n<p>edit: some further googling has revealed the ($!) operator, which is supposed to force strictness. However I've added it to my code and nothing has changed:</p>\n\n<pre><code>evalE g e | trace (\"VEnv: \" ++ show g ++ \"\\nExp: \" ++ show e ++ \"\\n\\n\") $! False = undefined\n</code></pre>\n\n<p>Any other hints? I really want to force that trace to evaluate it's side effects.</p>\n\n<p>edit2: yet more googling revealed the <code>seq</code> operator, however it is not behaving as advertised.</p>\n\n<pre><code>evalE g e | trace (\"VEnv: \" ++ show g ++ \"\\nExp: \" ++ show e ++ \"\\n\\n\") False `seq` False = undefined\n</code></pre>\n\n<p>Even this refuses to print the trace.</p>\n\n<p>I also worked out how to get the BangPatterns extension working, but that didn't print the trace either:</p>\n\n<pre><code>evalE !g !e | trace (\"VEnv: \" ++ show g ++ \"\\nExp: \" ++ show e ++ \"\\n\\n\") False = undefined\n</code></pre>\n\n<p>(full file for reference. It's a multifile program though):</p>\n\n<pre><code>module MinHS.Evaluator where\nimport qualified MinHS.Env as E\nimport MinHS.Syntax\nimport MinHS.Pretty\nimport qualified Text.PrettyPrint.ANSI.Leijen as PP\n\nimport Debug.Trace\n\ntype VEnv = E.Env Value\n\ndata Value = I Integer\n           | B Bool\n           | Nil\n           | Cons Integer Value\n           | Fun VEnv [String] Exp\n           deriving (Show)\n\ninstance PP.Pretty Value where\n  pretty (I i) = numeric $ i\n  pretty (B b) = datacon $ show b\n  pretty (Nil) = datacon \"Nil\"\n  pretty (Cons x v) = PP.parens (datacon \"Cons\" PP.&lt;+&gt; numeric x PP.&lt;+&gt; PP.pretty v)\n  pretty _ = undefined -- should not ever be used\n\nevaluate :: Program -&gt; Value\nevaluate [Bind _ _ _ e] = evalE E.empty e\nevaluate bs = evalE E.empty (Let bs (Var \"main\"))\n\ninstance Num Value where\n    I x + I y = I (x + y)\n    I x * I y = I (x * y)\n    I x - I y = I (x - y)\n    abs (I x) = I (abs x)\n    fromInteger x = I x\n\ninstance Integral Value where\n    div _ (I 0) = error $ \"Cannot divide by zero\"\n    div (I x) (I y) = I (div x y)\n    mod (I x) (I y) = I (mod x y)\n\ninstance Real Value where\n\ninstance Enum Value where\n\ninstance Ord Value where\n    I x &gt; I y = x &gt; y\n    I x &gt;= I y = x &gt;= y\n    I x &lt;= I y = x &lt;= y\n    I x &lt; I y = x &lt; y\n\ninstance Eq Value where\n    I x == I y = x == y\n    I x /= I y = x /= y\n\nevalE :: VEnv -&gt; Exp -&gt; Value\nevalE g e | trace (\"VEnv: \" ++ show g ++ \"\\nExp: \" ++ show e ++ \"\\n\\n\") False = undefined\nevalE g (Num x) = I x\nevalE g (App (Prim Neg) x) = (evalE g x) * (-1)\nevalE g (Con \"False\") = B False\nevalE g (Con \"True\") = B True\nevalE g (Con \"Nil\") = Nil\nevalE g (App (App (Prim Gt) x) y) = B ((evalE g x) &gt; (evalE g y))\nevalE g (App (App (Prim Ge) x) y) = B ((evalE g x) &gt;= (evalE g y))\nevalE g (App (App (Prim Lt) x) y) = B ((evalE g x) &lt; (evalE g y))\nevalE g (App (App (Prim Le) x) y) = B ((evalE g x) &lt;= (evalE g y))\nevalE g (App (App (Prim Eq) x) y) = B ((evalE g x) == (evalE g y))\nevalE g (App (App (Prim Ne) x) y) = B ((evalE g x) /= (evalE g y))\nevalE g (App (Prim Head) (Con \"Nil\")) = error $ \"Cannot take head of empty list\"\nevalE g (App (Prim Tail) (Con \"Nil\")) = error $ \"Cannot take tail of empty list\"\nevalE g (App (Prim Head) (App (App (Con \"Cons\") x) _)) = evalE g x\nevalE g (App (Prim Tail) (App (App (Con \"Cons\") _) x)) = evalE g x\nevalE g (App (Prim Null) list) = case evalE g list of\n                                    Nil -&gt; B True\n                                    _ -&gt; B False\nevalE g (App (App (Con \"Cons\") (Num x)) y) = Cons x (evalE g y)\nevalE g (App (App (Prim Add) x) y) = (evalE g x) + (evalE g y)\nevalE g (App (App (Prim Mul) x) y) = (evalE g x) * (evalE g y)\nevalE g (App (App (Prim Sub) x) y) = (evalE g x) - (evalE g y)\nevalE g (App (App (Prim Quot) x) y) = div (evalE g x) (evalE g y)\nevalE g (App (App (Prim Rem) x) y) = mod (evalE g x) (evalE g y)\nevalE g (Let bindings exp) = evalE ((E.addAll g . (map (\\(Bind str _ _ bexp) -&gt; (str, evalE g bexp)))) bindings) exp\nevalE g e@(Var x) = case E.lookup g x of\n                    Just y -&gt; y\n                    Nothing -&gt; error $ \"Variable \" ++ x ++ \" not defined\" ++ errz g e\nevalE g (If exp t f) = case evalE g exp of\n                        B True -&gt; evalE g t\n                        B False -&gt; evalE g f\nevalE g e@(Letfun (Bind name _ args exp)) = Fun (E.add g (name, evalE g e)) args exp\nevalE g e@(App (Var x) exp) = case E.lookup g x of\n                                Just (Fun env args f) -&gt; evalE (E.addAll env [(head args, evalE g exp)]) f\n                                Nothing -&gt; error $ \"Function \" ++ x ++ \" not defined\" ++ errz g e\nevalE g (App exp1 exp2) = case evalE g exp1 of\n                            Fun env args f -&gt; evalE (E.addAll env [(head args, evalE g exp2)]) f\n\nevalE g e = error $ \"No pattern\" ++ errz g e\n--evalE g e = error \"Implement me!\"\n\nerrz g e = \"\\nVEnv: \\n\" ++ show g ++ \"\\n\\nExp: \\n\" ++ show e\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1507145616, "post_id": 46572775, "comment_id": 80099210, "body": "It&#39;s talking about printing something, but you don&#39;t show how you&#39;re trying to print something. Please show the rest of what you&#39;re doing."}, {"owner": {"reputation": 43, "user_id": 6803904, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003810682286/picture?type=large", "display_name": "Elbrus Novruzlu", "link": "https://stackoverflow.com/users/6803904/elbrus-novruzlu"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1507146024, "post_id": 46572775, "comment_id": 80099441, "body": "Actually when I do  &quot;part a = a - floor a&quot; is also give same error. Code only consist of this functiion"}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 3, "creation_date": 1507146255, "post_id": 46572775, "comment_id": 80099577, "body": "He just typed <code>part something</code> at the GHCi prompt, as per the signature line &quot;In a stmt of an interactive GHCi command: <code>print it</code>.&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 7, "last_activity_date": 1507146406, "creation_date": 1507146406, "answer_id": 46573000, "question_id": 46572775, "link": "https://stackoverflow.com/questions/46572775/why-cant-haskell-function-return-a-list/46573000#46573000", "title": "Why can&#39;t Haskell function return a list", "body": "<p>I can't give a complete answer without seeing the full extent of what you're doing, but here's one definite problem that is almost certainly involved. You write</p>\n\n<pre><code>partin a = [floor a, a-floor a]\n</code></pre>\n\n<p>The type of <code>floor</code> is</p>\n\n<pre><code>floor :: (RealFrac a, Integral b) =&gt; a -&gt; b\n</code></pre>\n\n<p>The type of <code>(-)</code> is</p>\n\n<pre><code>(-) :: Num a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>Since you use <code>a - floor a</code>, you're forcing the type of <code>a</code> to be an instance of <em>both</em> the <code>RealFrac</code> class <em>and</em> the <code>Integral</code> class. However, there is no such type in the standard library (and it doesn't make a lot of sense). As a result, GHC certainly will not be able to select the type for you from its very limited collection of defaults. Things might work out a lot better if you use</p>\n\n<pre><code>partin a = [fromIntegral (floor a), a - fromIntegral (floor a :: Int)]\n</code></pre>\n\n<p>But note that it doesn't really make much sense to have a <em>list</em> here, since you're trying to divide a number into two components of different types. You might be better off with</p>\n\n<pre><code>partin a = (floor a, a - fromIntegral (floor a :: Int))\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6803904, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003810682286/picture?type=large", "display_name": "Elbrus Novruzlu", "link": "https://stackoverflow.com/users/6803904/elbrus-novruzlu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 46573000, "answer_count": 1, "score": 2, "last_activity_date": 1507146406, "creation_date": 1507145508, "last_edit_date": 1507145686, "question_id": 46572775, "link": "https://stackoverflow.com/questions/46572775/why-cant-haskell-function-return-a-list", "title": "Why can&#39;t Haskell function return a list", "body": "<p>What is wrong with that:</p>\n\n<pre><code>partin a = [floor a, a-floor a]\n</code></pre>\n\n<p>Error :</p>\n\n<pre><code>&lt;interactive&gt;:342:1: error:\n    \u2022 Ambiguous type variable \u2018a0\u2019 arising from a use of \u2018print\u2019\n      prevents the constraint \u2018(Show a0)\u2019 from being solved.\n      Probable fix: use a type annotation to specify what \u2018a0\u2019 should be.\n      These potential instances exist:\n        instance Show Ordering -- Defined in \u2018GHC.Show\u2019\n        instance Show Integer -- Defined in \u2018GHC.Show\u2019\n        instance Show a =&gt; Show (Maybe a) -- Defined in \u2018GHC.Show\u2019\n        ...plus 22 others\n        ...plus 16 instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    \u2022 In a stmt of an interactive GHCi command: print it\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 772, "user_id": 4799077, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/864199565080/picture?type=large", "display_name": "Jessie Richardson", "link": "https://stackoverflow.com/users/4799077/jessie-richardson"}, "edited": false, "score": 0, "creation_date": 1507144350, "post_id": 46572392, "comment_id": 80098558, "body": "Thank you! I swear to god I had tried that before but clearly there was something else not working at the time."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 5, "last_activity_date": 1507143966, "creation_date": 1507143966, "answer_id": 46572392, "question_id": 46572291, "link": "https://stackoverflow.com/questions/46572291/how-to-pass-a-function-w-an-argument-to-another-function-in-haskell/46572392#46572392", "title": "How to Pass a Function w/ an Argument to Another Function in Haskell?", "body": "<p>On this line</p>\n\n<pre><code>| input == \"+\" = prompt todos subMenuOptions \"add\"\n</code></pre>\n\n<p>First of all, <code>prompt</code> only takes 2 arguments, and we're passing it three, like the error said.  For the second argument of <code>prompt</code> we want to pass it an <code>IO ()</code> using <code>subMenuOptions</code></p>\n\n<pre><code>subMenuOptions :: [String] -&gt; String -&gt; IO ()\n</code></pre>\n\n<p>which says that if we give it a list of strings and a string, it will give us the <code>IO ()</code> we are looking for.  So:</p>\n\n<pre><code>| input == \"+\" = prompt todos (subMenuOptions todos \"add\")\n</code></pre>\n\n<p>We need the parentheses because </p>\n\n<pre><code>prompt todos subMenuOptions todos \"add\"\n</code></pre>\n\n<p>would mean we are passing 4 arguments to <code>prompt</code>.</p>\n"}], "owner": {"reputation": 772, "user_id": 4799077, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/864199565080/picture?type=large", "display_name": "Jessie Richardson", "link": "https://stackoverflow.com/users/4799077/jessie-richardson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 642, "favorite_count": 0, "accepted_answer_id": 46572392, "answer_count": 1, "score": 3, "last_activity_date": 1507143966, "creation_date": 1507143622, "question_id": 46572291, "link": "https://stackoverflow.com/questions/46572291/how-to-pass-a-function-w-an-argument-to-another-function-in-haskell", "title": "How to Pass a Function w/ an Argument to Another Function in Haskell?", "body": "<p>I am making a simple Haskell todo list and I want to call a function \"prompt\" recursively and show different menu options based on user input. The problem is that upon initial call, prompt should expect to receive a function as one of the arguments that does NOT expect any arguments itself. Any following calls of \"prompt\" may need to call a function that DOES expect an argument passed to the function that is being passed to prompt.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>mainMenuOptions :: IO ()\nmainMenuOptions = do\n    putStrLn \"\"\n    putStrLn \"What would you like to do?\"\n    putStrLn \"\"\n    putStrLn \"OPTIONS\"\n    putStrLn \"\"\n    putStrLn \"'+' : add items    |   '-' : remove items\"\n\nsubMenuOptions ::  [String] -&gt; String -&gt; IO ()\nsubMenuOptions todos operation = do\n    putStrLn \"\"\n    if operation == \"add\"\n        then do putStrLn (\"Type in the TASK you'd like to \" ++ operation ++ \", then hit ENTER\")\n                addListItemOptions todos\n    else do\n        putStrLn (\"Type in the NUMBER of the task you'd like to \" ++ operation ++ \", then hit ENTER\")\n        putStrLn \"('r' : return to the main menu)\"\n\nprompt :: [String] -&gt; IO () -&gt; IO ()\nprompt todos showOptions = do\n    showTasks todos\n    showOptions\n    input &lt;- getLine\n    interpret input todos\n\n\ninterpret :: String -&gt; [String] -&gt; IO ()\ninterpret input todos\n    | input == \"r\" = prompt todos mainMenuOptions\n    | input == \"+\" = prompt todos subMenuOptions \"add\"\n    | input == \"-\" = prompt todos subMenuOptions \"remove\"\n    | otherwise = do\n                    putStrLn \"\"\n                    putStrLn \"SORRY, did not get that! Please enter a valid option.\"\n                    prompt todos mainMenuOptions\n\n\nmain :: IO ()\nmain = do\n    putStrLn \"Haskell ToDo List\"\n    prompt [] mainMenuOptions\n</code></pre>\n\n<p>The error I get when I try to do this is:</p>\n\n<blockquote>\n  <p>Couldn't match expected type \u2018[Char] -> IO ()\u2019\n                    with actual type \u2018IO ()\u2019\n      \u2022 The function \u2018prompt\u2019 is applied to three arguments,\n        but its type \u2018[String] -> IO () -> IO ()\u2019 has only two</p>\n</blockquote>\n"}, {"tags": ["haskell", "wreq"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 1, "creation_date": 1507140484, "post_id": 46571360, "comment_id": 80096424, "body": "Hint: write a function with type <code>User -&gt; [Address] -&gt; EnrichedUser</code>."}], "answers": [{"comments": [{"owner": {"reputation": 7598, "user_id": 2068327, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/mUStx.jpg?s=128&g=1", "display_name": "eddiec", "link": "https://stackoverflow.com/users/2068327/eddiec"}, "edited": false, "score": 0, "creation_date": 1507897603, "post_id": 46574580, "comment_id": 80405807, "body": "Having learnt a bit more about monad transformers <code>MaybeT</code> has proved to be useful to deal with this problem also."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 1, "last_activity_date": 1507152872, "creation_date": 1507152872, "answer_id": 46574580, "question_id": 46571360, "link": "https://stackoverflow.com/questions/46571360/how-should-i-create-a-data-structure-from-multiple-network-requests-in-haskell/46574580#46574580", "title": "How should I create a data structure from multiple network requests in Haskell", "body": "<p>I'm assuming that the type of <code>enrichedUser</code> is supposed to be <code>Maybe EnrichedUser</code> and not <code>Maybe [EnrichedUser]</code>, right?</p>\n\n<p>If so, after extracting the <code>[User]</code> list from <code>users :: Maybe [User]</code>, the problem you're facing is running a monadic action (to fetch the web page) for <em>each</em> <code>User</code>.  There's a handy combinator for this in <code>Control.Monad</code>:</p>\n\n<pre><code>mapM :: (Monad m) =&gt; (a -&gt; m b) -&gt; ([a] -&gt; m [b])\n</code></pre>\n\n<p>which can be specialized in your situation to:</p>\n\n<pre><code>mapM :: (User -&gt; IO EnrichedUser) -&gt; ([User] -&gt; IO [EnrichedUser])\n</code></pre>\n\n<p>This says, if you know how to write a function that takes a <code>User</code> and creates an IO action that will create an <code>EnrichedUser</code>, you can use <code>mapM</code> to turn this into a function that takes a list <code>[User]</code> and creates an IO action to create a whole list <code>[EnrichedUser]</code>.</p>\n\n<p>In your application, I imagine the former function would look something like:</p>\n\n<pre><code>enrich :: User -&gt; IO EnrichedUser\nenrich u = do\n    let opts = ...\n    let url = \"https://www.example.com/users/\" \n              ++ userToUserID u ++ \"/addresses\"\n    r2 &lt;- getWith opts url\n    let Just enrichedUser = decode $ r2 ^. responseBody\n    return enrichedUser\n  where decode = ...\n</code></pre>\n\n<p>and then you can write (in your IO do-block):</p>\n\n<pre><code>r &lt;- getWith opts \"https://www.example.com/users\"\nlet Just users = decode $ r ^. responseBody\nenrichedUsers &lt;- mapM enrich users\n-- here, enrichedUsers :: [EnrichedUser]\n...etc...\n</code></pre>\n\n<p>I've omitted the <code>Maybe</code> processing here for simplicity.  If enriching fails, you probably want to somehow coerce a regular <code>User</code> into a default <code>EnrichedUser</code> anyway, so you'd modify the bottom of the <code>enrich</code> function to read:</p>\n\n<pre><code>let enrichedUser = case decode $ r2 ^. responseBody of\n    Nothing -&gt; defaultEnrichment u\n    Just e  -&gt; e\nreturn enrichedUser\n</code></pre>\n\n<p>and everything else would stay the same.</p>\n"}], "owner": {"reputation": 7598, "user_id": 2068327, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/mUStx.jpg?s=128&g=1", "display_name": "eddiec", "link": "https://stackoverflow.com/users/2068327/eddiec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 46574580, "answer_count": 1, "score": 2, "last_activity_date": 1507373967, "creation_date": 1507140252, "last_edit_date": 1507373967, "question_id": 46571360, "link": "https://stackoverflow.com/questions/46571360/how-should-i-create-a-data-structure-from-multiple-network-requests-in-haskell", "title": "How should I create a data structure from multiple network requests in Haskell", "body": "<p>I'm new to Haskell so apologies in advance for the potentially stupid question.</p>\n\n<p>I'd like to build a data structure that is constructed from two http requests in my application.</p>\n\n<p>My first request gets a basic list of users which I could choose to <code>decode</code> to <code>Maybe [User]</code> </p>\n\n<pre><code> r &lt;- getWith opts \"https://www.example.com/users\"\n let users = decode $ r ^. responseBody :: Maybe [User]\n</code></pre>\n\n<p>But if I'd like to enrich my user data by calling a second endpoint for each of the users that respond by doing something like</p>\n\n<pre><code>r2 &lt;- getWth opts \"https://www.example.com/users/{userid}/addresses\"\nlet enrichedUser = decode $ r2 ^. responseBody :: Maybe EnrichedUser\n</code></pre>\n\n<p>I can't quite piece these parts together at the minute. I'm in a <code>do</code> block thats expecting an <code>IO ()</code> </p>\n\n<p>Any help would be appreciated!</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 299, "user_id": 8703483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/290da4be3d6762921c9b4501ea4f123c?s=128&d=identicon&r=PG&f=1", "display_name": "Stacking For Heap", "link": "https://stackoverflow.com/users/8703483/stacking-for-heap"}, "edited": false, "score": 0, "creation_date": 1507137077, "post_id": 46570429, "comment_id": 80094610, "body": "Please format your code with code block and ask a complete question. What is the problem and what is happening?"}, {"owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "edited": false, "score": 0, "creation_date": 1507137078, "post_id": 46570429, "comment_id": 80094611, "body": "Please improve your question. 1) format the code as a snippet; 2) it is not clear where <code>a</code> in <code>length a</code> comes from; 3) what exactly &quot;unusable&quot; means?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1507137082, "post_id": 46570429, "comment_id": 80094614, "body": "What do you mean with it ended up making <code>ghci</code> unusable?"}, {"owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 0, "creation_date": 1507137464, "post_id": 46570429, "comment_id": 80094808, "body": "I do not understand your formatting concern. The text in this post contains code, which is formatted as code."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1507137603, "post_id": 46570429, "comment_id": 80094881, "body": "after I formatted it :)"}, {"owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 0, "creation_date": 1507137722, "post_id": 46570429, "comment_id": 80094951, "body": "How come it displayed as code in the post preview window?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1507137823, "post_id": 46570429, "comment_id": 80094996, "body": "@MarkNeu: it was definitely not. :) Perhaps when you edited the post the second time it was. (I prepended the lines with code with four whitespace chars)."}], "answers": [{"comments": [{"owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 0, "creation_date": 1507137801, "post_id": 46570670, "comment_id": 80094986, "body": "I thought Haskell was lazy. Why is evaluating the definition?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 3, "creation_date": 1507137906, "post_id": 46570670, "comment_id": 80095055, "body": "@MarkNeu Because you have asked to print it by typing it at the interpreter prompt."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 1, "creation_date": 1507137967, "post_id": 46570670, "comment_id": 80095086, "body": "@MarkNeu At a guess: you intended to write <code>a = [map toLower x | x &lt;- b]</code>. Note the <code>b</code> at the end!"}, {"owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 0, "creation_date": 1507138123, "post_id": 46570670, "comment_id": 80095167, "body": "@n.m. Thank you!"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 5, "creation_date": 1507138180, "post_id": 46570670, "comment_id": 80095196, "body": "@MarkNeu The list comprehension needs to get the first element of <code>a</code>. The first element of <code>a</code> immediately needs the first element of <code>a</code> and so on. Since this is the first step, this never gets the chance to produce any output. This can be contrasted with something like <code>ones = 1 : ones</code>. First you make a list starting with <code>1</code> <i>then</i> you need to recurse, so it is productive."}, {"owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1507219480, "post_id": 46570670, "comment_id": 80133268, "body": "@DavidYoung Yes, but I thought haskell was lazy. Why is it evaluating the definition?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 1, "creation_date": 1507223035, "post_id": 46570670, "comment_id": 80135330, "body": "@MarkNeu This is the same thing you said in the comment I was replying to (pretty much word-for-word), so I&#39;m not fully sure where you are confused... Maybe you could provide some more detail on what is unclear (maybe what you&#39;re expecting vs what&#39;s happening)? I can add, though, that it is not evaluating the <i>definition</i> (the line that says <code>a = [ ... ]</code>), it is evaluating when you just write <code>a</code> (you are asking for the value of <code>a</code>, so evaluation of <code>a</code> must occur). If you <i>only</i> give Haskell the definition, Haskell will not evaluate it."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 4, "last_activity_date": 1507137831, "last_edit_date": 1507137831, "creation_date": 1507137625, "answer_id": 46570670, "question_id": 46570429, "link": "https://stackoverflow.com/questions/46570429/how-do-i-prevent-ghci-from-crashing-from-this/46570670#46570670", "title": "How do I prevent GHCi from &quot;crashing&quot; from this?", "body": "<p>This is fully expected and normal behaviour.</p>\n\n<pre><code> a = [ map toLower x | x &lt;- a ]\n</code></pre>\n\n<p>is a recursive definition of <code>a</code>, where the recursion never ends. Note <code>a</code> at both sides of the equals sign. GHCi is not crashing, it just runs this code for always and always, until you interrupt it by pressing Ctrl-C.</p>\n"}], "owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 46570670, "answer_count": 1, "score": 0, "last_activity_date": 1507137831, "creation_date": 1507136763, "last_edit_date": 1507137277, "question_id": 46570429, "link": "https://stackoverflow.com/questions/46570429/how-do-i-prevent-ghci-from-crashing-from-this", "title": "How do I prevent GHCi from &quot;crashing&quot; from this?", "body": "<p>I tried running this code, and it ended up making GHCi unusable.\nMeaning, the command line (Windows) ended up not responding to any input and simply displaying an empty line.</p>\n\n<pre><code>Prelude&gt; b = [\"Empty\", \"Discrete\", \"Distinct\", \"Defiant\", \"Useful\", \"Good\", \n\"Imperative\", \"Safe\", \"Lawful\", \"Unpresidented\", \"Decadent\", \"Rich\", \n\"Strong\", \"Marvelous\", \"Volatile\", \"Obtuse\", \"Acute\", \"Revolutionary\", \n\"Frank\", \"Regular\"]\nPrelude&gt; length b\n20\nPrelude&gt; import Data.Char\nPrelude Data.Char&gt; a = [ map toLower x | x &lt;- a ]\nPrelude Data.Char&gt; a\n</code></pre>\n\n<p>......</p>\n"}, {"tags": ["haskell", "types", "int", "mismatch"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1507131647, "post_id": 46568726, "comment_id": 80091498, "body": "The list comprehension returns a list by default. Trying to return yet another list inside gives you a list of lists, which is not what you want. I&#39;d rewrite that to avoid the comprehension altogether."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 1878771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5b65b45b81b5873ac5d3e6fa891df5?s=128&d=identicon&r=PG", "display_name": "TropicalOverflow", "link": "https://stackoverflow.com/users/1878771/tropicaloverflow"}, "edited": false, "score": 0, "creation_date": 1507212705, "post_id": 46569475, "comment_id": 80128764, "body": "Thank you very much for the thorough response. I found it quite helpful =^)"}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 5, "last_activity_date": 1507133374, "creation_date": 1507133374, "answer_id": 46569475, "question_id": 46568726, "link": "https://stackoverflow.com/questions/46568726/haskell-type-mismatch-int-and-int/46569475#46569475", "title": "Haskell type mismatch Int and [Int]", "body": "<p>Here's why the mismatch happens.  First, note that a list comprehension that returns a list of type <code>[a]</code> must generate elements of type <code>a</code>, so you need the following to match:</p>\n\n<pre><code>example :: [Int] \n\n--  .-- the final value is \"[Int]\"\n--  |\nexample = [ 2+x*y | x &lt;- [1..10], y &lt;- [1..5], x &lt; y]\n--          ^^^^^\n--            |\n--            `- therefore, this must be \"Int\"\n</code></pre>\n\n<p>In your example, the type signature for <code>tegnPose</code> implies that the list comprehension must return an <code>[Int]</code>, but the expression generating list elements, namely:</p>\n\n<pre><code>if ... then [a] ++ tegnPose c xs else tegnPose c cx\n</code></pre>\n\n<p>is clearly <em>not</em> returning a plain <code>Int</code> the way it's supposed to.</p>\n\n<p>The first error message is indicating that actual type of the subexpression <code>[a] ++ tegnPos c xs</code> which is <code>[Int]</code> does not match the expected type of the result of the entire <code>if .. then .. else</code> expression which should have type <code>Int</code>.</p>\n\n<p>If I understand your question correctly (i.e., return a list of the integer positions of each occurrence of a character in a string so that <code>tegnPose 'a' \"abracadabra\"</code> returns <code>[0,3,5,7,10]</code>, then you should <em>either</em> use recursion <em>or</em> a list comprehension, but not both.</p>\n\n<p>Note that the non-recursive list comprehension:</p>\n\n<pre><code>tegnPose c xs = [a | a &lt;- [0..length xs - 1]\n</code></pre>\n\n<p><em>almost</em> does what you want.  All that's missing is testing the condition to see if the character at position <code>a</code> is a <code>c</code>.  If you don't know about using \"guards\" in list comprehensions, go look it up.</p>\n\n<p>Alternatively, the recursive function without a list comprehension:</p>\n\n<pre><code>tegnPose c (x:xs) = if (x == c) then ??? : tegnPose c xs\n                                else tegnPose c xs\ntegnPose _ [] = []\n</code></pre>\n\n<p>also <em>almost</em> does what you want, except it's not obvious what to put in place of <code>???</code> to return a number indicating the current position.  If you write a recursive version with an extra parameter:</p>\n\n<pre><code>tp n c (x:xs) = if (x == c) then n : tp (???) c xs\n                            else tp (???) c xs\ntp _ _ [] = []\n</code></pre>\n\n<p>with the idea that you could define:</p>\n\n<pre><code>tegnPose c xs = tp 0 c xs\n</code></pre>\n\n<p>then you'd be closer, if only you could figure out what new value for <code>n</code> should go in place of the <code>???</code>.</p>\n\n<p>More standard Haskell solutions might involve things like zips:</p>\n\n<pre><code>&gt; zip [0..] \"abracadabra\"\n[(0,'a'),(1,'b'),(2,'r'),...]\n</code></pre>\n\n<p>and filters:</p>\n\n<pre><code>&gt; filter (\\(i,c) -&gt; c == 'a') $ zip [0..] \"abracadabra\"\n[(0,'a'),(3,'a'),...]\n</code></pre>\n\n<p>and maps:</p>\n\n<pre><code>&gt; map fst $ filter (\\(i,c) -&gt; c == 'a') $ zip [0..] \"abracadabra\"\n[0,3,5,7,10]\n</code></pre>\n\n<p>or looking in <code>Data.List</code> for a function that does what you want:</p>\n\n<pre><code>&gt; elemIndices 'a' \"abracadabra\"\n[0,3,5,7,10]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1507137174, "post_id": 46569761, "comment_id": 80094656, "body": "This does not look simpler to me."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1507138837, "post_id": 46569761, "comment_id": 80095574, "body": "@DanielWagner I have annexed an explanation to my answer."}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 1, "last_activity_date": 1507139923, "last_edit_date": 1507139923, "creation_date": 1507134365, "answer_id": 46569761, "question_id": 46568726, "link": "https://stackoverflow.com/questions/46568726/haskell-type-mismatch-int-and-int/46569761#46569761", "title": "Haskell type mismatch Int and [Int]", "body": "<p>Just for some variety a simpler way of implementing this functionality with a single <code>foldr</code> could be;</p>\n\n<pre><code>import Data.Bool (bool)\ncharIndices :: Char -&gt; String -&gt; [Int]\ncharIndices c = foldr (\\t r -&gt; bool r (fst t : r) (snd t == c)) [] . zip [0..]\n\n*Main&gt; charIndices 't' \"tektronix test and measurement instruments\"\n[0,3,10,13,29,34,40]\n</code></pre>\n\n<p>Explanation:</p>\n\n<p>Type of <code>foldr</code> is <code>Foldable t =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b</code></p>\n\n<p>It takes three parameters;</p>\n\n<ol>\n<li>A function which accepts two parameters</li>\n<li>An initial value of type <code>b</code></li>\n<li>A traversable data type which hold values of type <code>a</code></li>\n</ol>\n\n<p>an returns a single value of type <code>b</code>.</p>\n\n<p>In this particular case our type <code>a</code> value is <code>Char</code> type, which makes <code>t a</code> a <code>String</code> type (due to type signature) and type <code>b</code> value is a list of integers <code>[Int]</code>.</p>\n\n<p>The provided function as the first parameter is <code>(\\t r -&gt; bool r (fst t : r) (snd t == c))</code> which is very simple if you check <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Bool.html\" rel=\"nofollow noreferrer\">Data.bool</a>. <code>bool</code> is a ternary operator of type <code>a -&gt; a -&gt; Bool -&gt; a</code> which takes three arguments. In order they are negative result, positive result and condition. (negative is on the left as usual in Haskell). It checks if the current character is equal to our target character <code>c</code>, if so it returns <code>fst t : r</code> if not <code>r</code> (<code>r</code> means result). And finally <code>t</code> is the current tuple of the fed tuples list. The tuples list is constructed by <code>zip [0..] s</code> where <code>s</code> is not shown in the function definition due to partial application.</p>\n"}], "owner": {"reputation": 11, "user_id": 1878771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5b65b45b81b5873ac5d3e6fa891df5?s=128&d=identicon&r=PG", "display_name": "TropicalOverflow", "link": "https://stackoverflow.com/users/1878771/tropicaloverflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1507139923, "creation_date": 1507131134, "last_edit_date": 1507131473, "question_id": 46568726, "link": "https://stackoverflow.com/questions/46568726/haskell-type-mismatch-int-and-int", "title": "Haskell type mismatch Int and [Int]", "body": "<p>I'm a beginner to Haskell. I'm trying to create a function which has two parameters: a character and a string.\nThis function is supposed to go through the string and check if the character given is in the string, and then return a list of integers representing the position of the characters in the string.</p>\n\n<p>My code is:</p>\n\n<pre><code>tegnPose :: Char -&gt; String -&gt; [Int]\ntegnPose c [] = []\ntegnPose c (x:xs) = [if not (xs !! a == c)\n then [a] ++ tegnPose c xs\n else tegnPose c xs |a &lt;- [0.. length xs - 1]]\n</code></pre>\n\n<p>Which is a recursive function with list comprehension.</p>\n\n<p>The error I get:</p>\n\n<pre><code>Uke4.hs:14:7: error:\n    * Couldn't match expected type `Int' with actual type `[Int]'\n    * In the expression: [a] ++ tegnPose c xs\n      In the expression:\n        if not (xs !! a == c) then [a] ++ tegnPose c xs else tegnPose c xs\n      In the expression:\n        [if not (xs !! a == c) then\n             [a] ++ tegnPose c xs\n         else\n             tegnPose c xs |\n           a &lt;- [0 .. length xs - 1]]\n   |\n14 |  then [a] ++ tegnPose c xs\n   |       ^^^^^^^^^^^^^^^^^^^^\n\nUke4.hs:15:7: error:\n    * Couldn't match expected type `Int' with actual type `[Int]'\n    * In the expression: tegnPose c xs\n      In the expression:\n        if not (xs !! a == c) then [a] ++ tegnPose c xs else tegnPose c xs\n      In the expression:\n        [if not (xs !! a == c) then\n             [a] ++ tegnPose c xs\n         else\n             tegnPose c xs |\n           a &lt;- [0 .. length xs - 1]]\n   |\n15 |  else tegnPose c xs |a &lt;- [0.. length xs - 1]]\n</code></pre>\n\n<p>I don't understand how the mismatch happens, as the recursive function should just run through.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1507136968, "post_id": 46568752, "comment_id": 80094559, "body": "And if you have a choice, <code>Data.Text.toLower</code> should be preferred to <code>Data.Char.toLower</code>, because its behavior is more correct on international texts. For example, <code>Data.Text.toLower &quot;\u0130&quot; = &quot;i\\775&quot;</code> (two output codepoints!) whereas <code>Data.Char.toLower &quot;\u0130&quot; = &quot;i&quot;</code> is just an approximation."}, {"owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 0, "creation_date": 1582791195, "post_id": 46568752, "comment_id": 106900618, "body": "What is &quot;\\755&quot;?"}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": true, "score": 7, "last_activity_date": 1507131196, "creation_date": 1507131196, "answer_id": 46568752, "question_id": 46568661, "link": "https://stackoverflow.com/questions/46568661/how-do-i-correctly-use-tolower-in-haskell/46568752#46568752", "title": "How do I correctly use toLower in Haskell?", "body": "<p>It doesn't work, because the version you tried to use operates on <code>Text</code>, and not <code>String</code>. Those are two distinct types. You have two options at this point:</p>\n\n<p>1) Use <code>toLower</code> from <code>Data.Char</code>; this one operates on a single character, and you can map it over your string:</p>\n\n<pre><code>map toLower \"JhELlo\"\n</code></pre>\n\n<p>2) Convert you string to <code>Data.Text</code> (and optionally back again):</p>\n\n<pre><code>unpack . toLower . pack $ \"JhELlo\"\n</code></pre>\n\n<p>There are actually <a href=\"https://hayoo.fh-wedel.de/?query=toLower\" rel=\"noreferrer\">other versions of <code>toLower</code></a> around; the one in <code>Data.Sequences</code> seems to be polymorphic (so should work on both), but it might require pulling in the <code>mono-traversable</code> package as a dependency.</p>\n"}], "owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2620, "favorite_count": 0, "accepted_answer_id": 46568752, "answer_count": 1, "score": 4, "last_activity_date": 1507131199, "creation_date": 1507130952, "question_id": 46568661, "link": "https://stackoverflow.com/questions/46568661/how-do-i-correctly-use-tolower-in-haskell", "title": "How do I correctly use toLower in Haskell?", "body": "<p>I've recently started to learn Haskell and wanted to convert something to lowercase. I looked up the function \"toLower\", but it doesn't seem to work.</p>\n\n<pre><code>Prelude&gt; import Data.Text\nPrelude Data.Text&gt; toLower \"JhELlo\"\n\n&lt;interactive&gt;:2:9: error:\n    * Couldn't match expected type `Text' with actual type `[Char]'\n    * In the first argument of `toLower', namely `\"JhELlo\"'\n      In the expression: toLower \"JhELlo\"\n      In an equation for `it': it = toLower \"JhELlo\"\nPrelude Data.Text&gt; toLower 'JhELlo'\n\n&lt;interactive&gt;:3:9: error:\n    * Syntax error on 'JhELlo'\n      Perhaps you intended to use TemplateHaskell or TemplateHaskellQuotes\n    * In the Template Haskell quotation 'JhELlo'\nPrelude Data.Text&gt;\n</code></pre>\n"}, {"tags": ["list", "haskell", "tree", "binary-tree"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1507120424, "post_id": 46564896, "comment_id": 80083469, "body": "Before writing it in Haskell, please first explain how you would do it yourself? What steps do you want the program to take to return the leaves?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 7, "creation_date": 1507121717, "post_id": 46564896, "comment_id": 80084367, "body": "<code>[] ++ x ++ y</code> is <code>x ++ y</code>. At what point will <code>treeLeaves</code> return something else than <code>[]</code>?"}, {"owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "edited": false, "score": 5, "creation_date": 1507124435, "post_id": 46564896, "comment_id": 80086412, "body": "The <code>v</code> argument from <code>Node v t1 t2</code> isn&#39;t used in the implementation. Hm, maybe we can either do something with it or use <code>_</code> instead not to be distracted..."}], "answers": [{"tags": [], "owner": {"reputation": 3627, "user_id": 3695939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d75f41bcfc1d3f20c084ec7e87d82012?s=128&d=identicon&r=PG&f=1", "display_name": "moondaisy", "link": "https://stackoverflow.com/users/3695939/moondaisy"}, "is_accepted": false, "score": 6, "last_activity_date": 1507167057, "last_edit_date": 1507167057, "creation_date": 1507129652, "answer_id": 46568231, "question_id": 46564896, "link": "https://stackoverflow.com/questions/46564896/how-to-return-trees-leaves-in-a-list-in-haskell/46568231#46568231", "title": "How to return tree&#39;s leaves in a list in Haskell", "body": "<p>Right now you are missing the important step, which is adding the leaves to your list, and that's why you are always getting an empty list. This <code>[] ++ treeLeaves t1 ++ treeLeaves t2</code> will eventually fall in the <code>Null</code> branch and become <code>[] ++ [] ++ ... ++ []</code> as Zeta commented.</p>\n\n<p>You know you have reached a leaf when the <code>BinaryTree</code> is <code>Node v Null Null</code>. So you need to write a branch for that case too:</p>\n\n<pre><code>treeLeaves :: BinaryTree a -&gt; [a]\ntreeLeaves tree = case tree of\n    Null             -&gt; []\n    Node v Null Null -&gt; v:[]\n    Node _ t1 t2     -&gt; treeLeaves t1 ++ treeLeaves t2\n</code></pre>\n\n<p>As Igor commented you can use <code>_</code> instead of <code>v</code> on the last line because you are not using the element in that node (since it isn't a leaf). </p>\n"}], "owner": {"reputation": 11, "user_id": 8520204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebc078920e7e5c815a4f9bb42dabb41f?s=128&d=identicon&r=PG&f=1", "display_name": "James Raquel", "link": "https://stackoverflow.com/users/8520204/james-raquel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1669, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518519860, "creation_date": 1507120151, "last_edit_date": 1518519860, "question_id": 46564896, "link": "https://stackoverflow.com/questions/46564896/how-to-return-trees-leaves-in-a-list-in-haskell", "title": "How to return tree&#39;s leaves in a list in Haskell", "body": "<p>I have this code so far:</p>\n\n<pre><code>data BinaryTree a  = Null | Node a (BinaryTree a) (BinaryTree a)\n\ntreeLeaves :: BinaryTree a -&gt; [a]\ntreeLeaves tree = case tree of\n    Null         -&gt; []\n    Node v t1 t2 -&gt; [] ++ treeLeaves t1 ++ treeLeaves t2\n</code></pre>\n\n<p>I am not sure what I'm doing wrong. It outputs an empty list.</p>\n"}, {"tags": ["haskell", "lazy-evaluation"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1507124810, "post_id": 46564504, "comment_id": 80086651, "body": "For timing benchmarks, take a look at the criterion library. In particular, you will likely end up using <code>nf</code>. Make sure you start by opening the files and only wrap the <code>quicksort</code> call itself with <code>nf</code>."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1507136526, "post_id": 46570317, "comment_id": 80094341, "body": "And, independently of answering the question as asked, I second @Alec&#39;s recommendation to look at <a href=\"http://hackage.haskell.org/package/criterion\" rel=\"nofollow noreferrer\">criterion</a>."}, {"owner": {"reputation": 239, "user_id": 2882340, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d1f73d60b88e9dff05bdb5d8bfb30f23?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2882340/florian"}, "edited": false, "score": 0, "creation_date": 1507137695, "post_id": 46570317, "comment_id": 80094936, "body": "The pitfall you mention is exactly why I thought my program was flawed. So, if I understand correctly, if I write : &quot;start &lt;- l <code>deepseq</code> getCurrentTime&quot; then &quot;let l&#39; = map quicksort l&quot; and then &quot;end &lt;- l&#39; <code>deepseq</code> getCurrentTime&quot;, will I only measure the time the quicksort algorithm takes, not the time that l is read in the files ?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 239, "user_id": 2882340, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d1f73d60b88e9dff05bdb5d8bfb30f23?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2882340/florian"}, "edited": false, "score": 0, "creation_date": 1507137866, "post_id": 46570317, "comment_id": 80095033, "body": "@Florian Ah, I misunderstood the question! I&#39;m glad I snuck the answer to your actual question in there by accident. =)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 239, "user_id": 2882340, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d1f73d60b88e9dff05bdb5d8bfb30f23?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2882340/florian"}, "edited": false, "score": 0, "creation_date": 1507138034, "post_id": 46570317, "comment_id": 80095121, "body": "@Florian Basically yes. It will measure the time for the <code>quicksort</code> plus the <code>deepseq</code>, but the latter is sort of unavoidable."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1507136367, "creation_date": 1507136367, "answer_id": 46570317, "question_id": 46564504, "link": "https://stackoverflow.com/questions/46564504/how-does-laziness-affect-benchmarking-in-haskell/46570317#46570317", "title": "How does laziness affect benchmarking in Haskell?", "body": "<blockquote>\n  <p>I think that the list l is only evaluated when deepseq is called on the list l'...</p>\n</blockquote>\n\n<p>Correct.</p>\n\n<blockquote>\n  <p>...and that gives a flawed benchmark.</p>\n</blockquote>\n\n<p>Let me make an assumption about what you mean by \"flawed\". I guess what you mean is that <code>getCurrentTime</code> will return a time from before the sort is fully completed. Under that assumption, no, the benchmark is not flawed. I'm not sure I can explain which part of your reasoning is wrong, though, because you don't say why you think the benchmark will be flawed.</p>\n\n<p>However, there is a pitfall to be aware of that I suspect is different from the one you had in mind: you should make sure that the <em>input</em> list is fully evaluated before calling the starting <code>getCurrentTime</code>, thus:</p>\n\n<pre><code>  start &lt;- l `deepseq` getCurrentTime\n</code></pre>\n\n<p>This may or may not matter, depending on exactly how you implemented <code>getListFromFiles</code>.</p>\n"}], "owner": {"reputation": 239, "user_id": 2882340, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d1f73d60b88e9dff05bdb5d8bfb30f23?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2882340/florian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 46570317, "answer_count": 1, "score": 0, "last_activity_date": 1507136367, "creation_date": 1507118932, "question_id": 46564504, "link": "https://stackoverflow.com/questions/46564504/how-does-laziness-affect-benchmarking-in-haskell", "title": "How does laziness affect benchmarking in Haskell?", "body": "<p>This question is related to the following question :\n<a href=\"https://stackoverflow.com/questions/14163072/how-to-force-evaluation-in-haskell\">How to force evaluation in Haskell?</a></p>\n\n<p>I want to benchmark the algorithm quicksort for a list. For this I have made a certain number of files which have random numbers in them.</p>\n\n<p>Here is the relevant part of the code in question :</p>\n\n<pre><code>import System.IO\nimport Data.Time\nimport Control.DeepSeq\n\ngetListFromFiles :: IO [[Int]]\nquicksort :: (Ord a) =&gt; [a] -&gt; [a]\n\nmain = do\n  l &lt;- getListFromFiles\n  start &lt;- getCurrentTime\n  let l' = map quicksort l\n  end &lt;- l' `deepseq` getCurrentTime\n  print (diffUTCTime end start)\n</code></pre>\n\n<p>I do not want to know want to measure the time the program takes to look into the files, just the one that the sorting takes.\nBecause of laziness, I think that the list l is only evaluated when deepseq is called on the list l' and that gives a flawed benchmark. Am I correct ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1507112635, "post_id": 46562276, "comment_id": 80078487, "body": "That is because you ask <code>primes</code> to generate a list of <code>Word8</code> primes. And some operations are proken over the <b>Z_256</b> field."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1507113343, "post_id": 46562276, "comment_id": 80078894, "body": "@WillemVanOnsem Wouldn&#39;t that mean the library is broken for all bounded types? (Broken as in &quot;a pure function entering infinite loop in a finite case&quot;.)"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1507154372, "post_id": 46562276, "comment_id": 80103210, "body": "BTW, <code>(&lt;= maxBound)</code> is always true"}], "answers": [{"comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1507113094, "post_id": 46562598, "comment_id": 80078760, "body": "<a href=\"https://github.com/sebfisch/primes/issues/5\" rel=\"nofollow noreferrer\">I&#39;ve actually filed the bug myself</a>, BTW."}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": true, "score": 10, "last_activity_date": 1507112786, "creation_date": 1507112786, "answer_id": 46562598, "question_id": 46562276, "link": "https://stackoverflow.com/questions/46562276/takewhile-maxbound-word8-primes-hangs/46562598#46562598", "title": "&quot;takeWhile (&lt;= (maxBound :: Word8)) primes&quot; hangs", "body": "<p>Your problem is quite interesting, but it's not in <code>takeWhile</code>; it's in <code>primes</code>:</p>\n\n<p>Since <code>primes</code> is able to return whatever type you want, its implementation probably silently uses that type internally. So, when you ask it to return <code>Word8</code> primes, it fails <em>internally</em>:</p>\n\n<pre><code>\u03bb take 20 (primes :: [Word8])\n[2,3,5,7,11,13,17,19,23,25,29,31,35,37,41,43,47,49,53,55]\n</code></pre>\n\n<p>I suppose a workaround is to use a fixed type for the primes generator (e.g. <code>(primes :: [Int])</code>, and just <code>fromIntegral</code> your limit value. And possibly file a bug to the library as well.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1507148964, "creation_date": 1507148964, "answer_id": 46573638, "question_id": 46562276, "link": "https://stackoverflow.com/questions/46562276/takewhile-maxbound-word8-primes-hangs/46573638#46573638", "title": "&quot;takeWhile (&lt;= (maxBound :: Word8)) primes&quot; hangs", "body": "<p>The actual issue was found by Bartek Banachewicz above. </p>\n\n<p>However, note that the predicate <code>(&lt;= (maxBound :: Word8))</code> is <em>always true</em>.\nIt is equivalent to <code>p</code> where:</p>\n\n<pre><code>p :: Word8 -&gt; Bool\np x = x &lt;= maxBound\n</code></pre>\n\n<p>Now, the important thing is that the <code>x</code> argument here (which is implicit in the original code) is a <code>Word8</code>. So, we are comparing an arbitrary <code>Word8</code> to the maximum number representable in <code>Word8</code>. This is always true!</p>\n\n<p>If you need a numeric type conversion, you have to be explicit. E.g.</p>\n\n<pre><code>takeWhile (&lt;= fromIntegral (maxBound :: Word8)) (primes :: [Int])\n</code></pre>\n\n<p>Now, the implicit <code>x</code> is an <code>Int</code>, and <code>fromIntegral</code> correctly turns <code>256::Word8</code> into <code>256::Int</code>.</p>\n"}], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 46562598, "answer_count": 2, "score": 6, "last_activity_date": 1507148964, "creation_date": 1507111872, "last_edit_date": 1507112224, "question_id": 46562276, "link": "https://stackoverflow.com/questions/46562276/takewhile-maxbound-word8-primes-hangs", "title": "&quot;takeWhile (&lt;= (maxBound :: Word8)) primes&quot; hangs", "body": "<p>Today I was up to find out how many prime numbers there are that fit the bounds of <code>Word8</code>, but this most trivial task gave me an unexpected... <em>absence of result</em>.</p>\n\n<pre><code>\u03bb import Data.Numbers.Primes\n\u03bb import Data.Word\n\u03bb takeWhile (&lt;= (maxBound :: Word8)) primes\n[2,3,5,7,11,13,17,19,23,25,29,31,35,37,41,43,47,49,53,55,59,61,71,73,\n77,79,83,85,89,95,97,101,103,107,109,115,119,121,125,127,133,137,139,\n145,149,151,157,161,163,167,173,175,179,185,187,191,197,199,203,205,\n209,215,217,223,235^CInterrupted.\n</code></pre>\n\n<p>As you may see, not only does this evaluation not terminate, but the numbers yielded are not all prime!</p>\n\n<p>I proceeded to dance around the case:</p>\n\n<pre><code>\u03bb maxBound :: Word8\n255\n\n\u03bb takeWhile (&lt;= 255) primes\n[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,\n97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181\n,191,193,197,199,211,223,227,229,233,239,241,251]\n\n\u03bb takeWhile (&lt;= (maxBound :: Word8)) [1..]\n[1,2,3, {- ..., -} 253,254,255]\n-- This of course works, so I do not present the consecutive\n-- natural numbers inbetween 3 and 253.\n\n\u03bb takeWhile (&lt;= 255) $ take 255 primes\n[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,\n97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181\n,191,193,197,199,211,223,227,229,233,239,241,251]\n\n\u03bb takeWhile (&lt;= (maxBound  :: Word8)) $ take 255 primes\n[2,3,5,7,11,13,17,19,23,25,29,31,35,37,41,43,47,49,53,55,59,61,71,73,\n77,79,83,85,89,95,97,101,103,107,109,115,119,121,125,127,133,137,139,\n145,149,151,157,161,163,167,173,175,179,185,187,191,197,199,203,205,\n209,215,217,223,235^CInterrupted.\n</code></pre>\n\n<p>So, <code>takeWhile</code> only works when we avoid either <code>maxBound</code> or <code>primes</code>.</p>\n\n<p>How am I to interpret these findings?</p>\n\n<hr>\n\n<p>I use the latest stable <code>stack</code> snapshot and <a href=\"http://hackage.haskell.org/package/primes\" rel=\"noreferrer\">this primes library</a>.</p>\n"}, {"tags": ["haskell", "types", "typeerror", "monads", "ghci"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1507112381, "post_id": 46562258, "comment_id": 80078315, "body": "Well since <code>&gt;&gt;</code> already factors out that <code>\\_ -&gt;</code> you do not have to write it explicitly."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8719292, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qI4B5Fbk_Tw/AAAAAAAAAAI/AAAAAAAAATU/0_tXv3XIxYM/photo.jpg?sz=128", "display_name": "The Helpful Bees", "link": "https://stackoverflow.com/users/8719292/the-helpful-bees"}, "edited": false, "score": 0, "creation_date": 1507115887, "post_id": 46562965, "comment_id": 80080403, "body": "Ah thank you! Sorry if this is needing a full question in itself, but what exactly does this achieve then? What purpose does <code>Just 1 &gt;&gt; Just 10</code> serve that just <code>Just 10</code> doesn&#39;t?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13, "user_id": 8719292, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qI4B5Fbk_Tw/AAAAAAAAAAI/AAAAAAAAATU/0_tXv3XIxYM/photo.jpg?sz=128", "display_name": "The Helpful Bees", "link": "https://stackoverflow.com/users/8719292/the-helpful-bees"}, "edited": false, "score": 0, "creation_date": 1507132470, "post_id": 46562965, "comment_id": 80092087, "body": "@TheHelpfulBees, <code>Maybe</code> is probably not the best example for thinking about <code>&gt;&gt;</code>. You might get more out of thinking about what it does for <code>State s</code>, <code>Writer w</code>, or <code>IO</code>. Once you understand the pattern, you&#39;ll be able to see that it applies in a fairly uninteresting way to <code>Either a</code>, its duller cousin <code>Maybe</code>, and even more trivially to <code>Reader e</code> and <code>Identity</code>."}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 2, "last_activity_date": 1507117790, "last_edit_date": 1507117790, "creation_date": 1507114062, "answer_id": 46562965, "question_id": 46562258, "link": "https://stackoverflow.com/questions/46562258/correct-usage-of-in-haskell/46562965#46562965", "title": "Correct Usage of &gt;&gt; in Haskell", "body": "<p><code>(&gt;&gt;=)</code> has type <code>Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b</code>. In your example <code>m</code> is <code>Maybe</code> so you provide a <code>Maybe Int</code> and a function <code>Int -&gt; Maybe Int</code>.</p>\n\n<p><code>(&gt;&gt;)</code> has type <code>Monad m =&gt; m a -&gt; m b -&gt; m b</code> so you need to pass a <code>Maybe b</code> instead of a function which returns a <code>Maybe b</code> e.g.</p>\n\n<pre><code>Just 1 &gt;&gt; Just 10\n</code></pre>\n\n<p>In this case this is the same as <code>Just 10</code> however if the first value is <code>Nothing</code> the result will also be <code>Nothing</code>:</p>\n\n<pre><code>Nothing &gt;&gt; Just 10\n</code></pre>\n\n<p>You will usually use <code>(&gt;&gt;)</code> if the first value represents some effect you want to perform and ignore the result e.g <code>IO</code>.</p>\n\n<pre><code>putStrLn \"Hello world\" &gt;&gt; pure 10 :: IO Int\n</code></pre>\n\n<p>or <code>State</code>: </p>\n\n<pre><code>put \"state\" &gt;&gt; pure 10 :: State String Int\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8719292, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qI4B5Fbk_Tw/AAAAAAAAAAI/AAAAAAAAATU/0_tXv3XIxYM/photo.jpg?sz=128", "display_name": "The Helpful Bees", "link": "https://stackoverflow.com/users/8719292/the-helpful-bees"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 46562965, "answer_count": 1, "score": 1, "last_activity_date": 1507134029, "creation_date": 1507111809, "last_edit_date": 1507134029, "question_id": 46562258, "link": "https://stackoverflow.com/questions/46562258/correct-usage-of-in-haskell", "title": "Correct Usage of &gt;&gt; in Haskell", "body": "<p>Just now being introduced to monads in Haskell and hit something of a roadblock with <code>&gt;&gt;</code>.</p>\n\n<p><code>&gt;&gt;=</code> makes sense to me, as I can get the following out of Prelude:</p>\n\n<pre><code>Prelude&gt; Just 1 &gt;&gt;= (\\ x -&gt; Just (x+1))\nJust 2\n</code></pre>\n\n<p>My understanding is that <code>&gt;&gt;</code> is the same as bind, but only used when the function is constant with regards to its parameter. But when I try to do that in Prelude:</p>\n\n<pre><code>Prelude&gt; Just 1 &gt;&gt; (\\_ -&gt; Just 10)\n\n&lt;interactive&gt;:7:12: error:\n\u2022 Couldn't match expected type \u2018Maybe b\u2019\n              with actual type \u2018t0 -&gt; Maybe Integer\u2019\n\u2022 The lambda expression \u2018\\ _ -&gt; Just 10\u2019 has one argument,\n  but its type \u2018Maybe b\u2019 has none\n  In the second argument of \u2018(&gt;&gt;)\u2019, namely \u2018(\\ _ -&gt; Just 10)\u2019\n  In the expression: Just 1 &gt;&gt; (\\ _ -&gt; Just 10)\n\u2022 Relevant bindings include\n    it :: Maybe b (bound at &lt;interactive&gt;:7:1)\n</code></pre>\n\n<p>I'm very much struggling to decipher this error message... can anyone help with proper usage of <code>&gt;&gt;</code>? And what am I not understanding about it?</p>\n"}, {"tags": ["haskell", "yesod"], "owner": {"reputation": 1791, "user_id": 550026, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a9808a71e03d9b9602aae53622c64d70?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/550026/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1507112791, "creation_date": 1507111426, "last_edit_date": 1507112791, "question_id": 46562123, "link": "https://stackoverflow.com/questions/46562123/splitting-up-yesods-foundation-hs-into-different-modules", "title": "Splitting up Yesod&#39;s Foundation.hs into different modules", "body": "<p>Starting out with the scaffolded Yesod app, Foundation.hs has quite a lot going on.  As my app has grown, I have been trying to split some functionality out into different modules.  For example, the <code>defaultLayout</code> definition, and the related definition of <code>MenuItem</code> types, looks like something that would be better off moved to a separate module.  However, my attempts to do so have been thwarted.</p>\n\n<p>To define menu items as part of the <code>defaultLayout</code> requires importing Foundation to get the route data constructors (ie <code>StaticR</code>, <code>AuthR</code> and my own routes defined in <code>config/routes</code>), and importing Application to get the Yesod instances for the <code>App</code> type.  But Foundation would need to import this module to define <code>defaultLayout</code>!</p>\n\n<p>Is it possible to move this stuff into a separate module?  How do people avoid massive monolithic Foundations?</p>\n"}, {"tags": ["haskell", "category-theory", "catamorphism"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1507108630, "post_id": 46561125, "comment_id": 80075972, "body": "Pick a piece of your type expression, apply the isomorphism <code>a ~ forall b. (a -&gt; b) -&gt; b</code>, voil&#224;."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1507108799, "post_id": 46561125, "comment_id": 80076074, "body": "I&#39;ve written a generator for catamorphisms in template Haskell: <a href=\"https://github.com/KommuSoft/template-fun\" rel=\"nofollow noreferrer\">github.com/KommuSoft/template-fun</a>. It does not all cover all type declarations yet, but that is not a fundamental issue. So afaik catamorphisms can be derived automatically."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1507108825, "post_id": 46561125, "comment_id": 80076094, "body": "@BenjaminHodgson I&#39;m afraid that&#39;s a little too terse for me. I don&#39;t think I understand the suggestion at all."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1507109051, "post_id": 46561125, "comment_id": 80076233, "body": "Sorry, I\u2019ll be clearer. You were asking whether the catamorphism for a given type is unique. I say no, because there are (an infinite number of) identities you can always apply to any type to get a different but isomorphic type. The classic catamorphism <code>foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b</code> is isomorphic to <code>foldr :: (a -&gt; b -&gt; b) -&gt; (forall x. (b -&gt; x) -&gt; x) -&gt; [a] -&gt; b</code>, for example."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1507119273, "post_id": 46561125, "comment_id": 80082569, "body": "I&#39;ve also written a <a href=\"https://github.com/effectfully/Generic/blob/master/Lib/Reflection/Fold.agda\" rel=\"nofollow noreferrer\">fold generator</a> (only in Agda and for higher-order inductive families rather than simple data types). It&#39;s not a hard task unless you consider more interesting data types: nested (like <code>Rose</code> trees), mutually recursive, ones with polymorphic recursion and such."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1507137110, "post_id": 46561125, "comment_id": 80094623, "body": "@user3237465, rose trees aren&#39;t what I&#39;ve usually seen called &quot;nested&quot; datatypes. As I&#39;ve seen it, that term is typically used of non-regular types. You seem to be referring to the fact that a rose tree has a list of rose trees, so the catamorphism needs to <code>fmap</code> itself down to get <code>cataTree :: (a -&gt; [r] -&gt; r) -&gt; Tree a -&gt; r</code>?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1507141022, "post_id": 46561125, "comment_id": 80096720, "body": "@BenjaminHodgson I think I now understand why I&#39;ve seen people write &quot;up to isomorphism&quot;: your proposal clearly gets around my &quot;up to argument reordering&quot; requirement, but is also totally unsatisfying, because of course a value of type <code>forall x. (b -&gt; x) -&gt; x</code> is morally no different from a value of type <code>b</code>, despite being represented differently by GHC."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1507142808, "post_id": 46561125, "comment_id": 80097750, "body": "@amalloy Indeed! In category theory you usually see people talk about objects being unique \u201cup to unique isomorphism\u201d, because you can\u2019t in general talk about equality of objects. And in fact <code>cata</code> <i>is</i> unique up to unique isomorphism, because <code>Fix</code> is the initial object in the category of algebras. <a href=\"https://bartoszmilewski.com/2017/02/28/f-algebras/\" rel=\"nofollow noreferrer\">I\u2019ll leave the full explanation to Bartosz Milewski</a>, who\u2019s better at this than me :)"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1507185324, "post_id": 46561125, "comment_id": 80111360, "body": "@dfeuer, I wasn&#39;t aware &quot;nested&quot; is a proper term. Yes, I meant that <code>fmap</code> thing."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1507138669, "post_id": 46564500, "comment_id": 80095461, "body": "<code>recursion-schemes</code> also has some Template Haskell to let you derive a base functor associated with a recursive type and also instances of <code>Recursive</code> and <code>Corecursive</code>. I&#39;m curious whether the <code>Functor</code>-only thing is very deep, or whether there is a weaker sort of recursion scheme that could make sense for <a href=\"https://hackage.haskell.org/package/invariant\" rel=\"nofollow noreferrer\">exponential functors</a>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1507139417, "post_id": 46564500, "comment_id": 80095849, "body": "And it turns out the answer is yes! <a href=\"http://comonad.com/reader/2008/rotten-bananas/\" rel=\"nofollow noreferrer\">comonad.com/reader/2008/rotten-bananas</a>"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1507142030, "post_id": 46564500, "comment_id": 80097276, "body": "@dfeuer see also <a href=\"https://www.schoolofhaskell.com/user/edwardk/phoas\" rel=\"nofollow noreferrer\">schoolofhaskell.com/user/edwardk/phoas</a>, wherein he rebuilds the HOAS/<code>cata</code> machinery using profunctors, to a much more satisfying outcome"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1611383642, "last_edit_date": 1611383642, "creation_date": 1507118916, "answer_id": 46564500, "question_id": 46561125, "link": "https://stackoverflow.com/questions/46561125/does-each-type-have-a-unique-catamorphism/46564500#46564500", "title": "Does each type have a unique catamorphism?", "body": "<p>The catamorphism associated to a recursive type can be derived mechanically.</p>\n<p>Suppose you have a recursively defined type, having multiple constructors, each one with its own arity. I'll borrow OP's example.</p>\n<pre><code>data X a b f = A Int b\n             | B\n             | C (f a) (X a b f)\n             | D a\n</code></pre>\n<p>Then, we can rewrite the same type by forcing each arity to be one, uncurrying everything. Arity zero (<code>B</code>) becomes one if we add a unit type <code>()</code>.</p>\n<pre><code>data X a b f = A (Int, b)\n             | B ()\n             | C (f a, X a b f)\n             | D a\n</code></pre>\n<p>Then, we can reduce the number of constructors to one, exploiting <code>Either</code> instead of multiple constructors. Below, we just write infix <code>+</code> instead of <code>Either</code> for brevity.</p>\n<pre><code>data X a b f = X ((Int, b) + () + (f a, X a b f) + a)\n</code></pre>\n<p>At the term-level, we know we can rewrite any recursive definition\nas the form <code>x = f x where f w = ...</code>, writing an explicit fixed point equation <code>x = f x</code>. At the type-level, we can use the same method\nto refector recursive types.</p>\n<pre><code>data X a b f   = X (F (X a b f))   -- fixed point equation\ndata F a b f w = F ((Int, b) + () + (f a, w) + a)\n</code></pre>\n<p>Now, we note that we can autoderive a functor instance.</p>\n<pre><code>deriving instance Functor (F a b f)\n</code></pre>\n<p>This is possible because in the original type each recursive reference only occurred in <em>positive</em> position. If this does not hold, making <code>F a b f</code> not a functor, then we can't have a catamorphism.</p>\n<p>Finally, we can write the type of <code>cata</code> as follows:</p>\n<pre><code>cata :: (F a b f w -&gt; w) -&gt; X a b f -&gt; w\n</code></pre>\n<p>Is this the OP's <code>xCata</code> type? It is. We only have to apply a few type isomorphisms. We use the following algebraic laws:</p>\n<pre><code>1) (a,b) -&gt; c ~= a -&gt; b -&gt; c          (currying)\n2) (a+b) -&gt; c ~= (a -&gt; c, b -&gt; c)\n3) ()    -&gt; c ~= c\n</code></pre>\n<p>By the way, it's easy to remember these isomorphisms if we write <code>(a,b)</code> as a product <code>a*b</code>, unit <code>()</code> as<code>1</code>, and <code>a-&gt;b</code> as a power <code>b^a</code>. Indeed they become</p>\n<ol>\n<li><code>c^(a*b) = (c^a)^b</code></li>\n<li><code>c^(a+b) = c^a*c^b</code></li>\n<li><code>c^1 = c</code></li>\n</ol>\n<p>Anyway, let's start to rewrite the <code>F a b f w -&gt; w</code> part, only</p>\n<pre><code>   F a b f w -&gt; w\n=~ (def F)\n   ((Int, b) + () + (f a, w) + a) -&gt; w\n=~ (2)\n   ((Int, b) -&gt; w, () -&gt; w, (f a, w) -&gt; w, a -&gt; w)\n=~ (3)\n   ((Int, b) -&gt; w, w, (f a, w) -&gt; w, a -&gt; w)\n=~ (1)\n   (Int -&gt; b -&gt; w, w, f a -&gt; w -&gt; w, a -&gt; w)\n</code></pre>\n<p>Let's consider the full type now:</p>\n<pre><code>cata :: (F a b f w -&gt; w) -&gt; X a b f -&gt; w\n     ~= (above)\n        (Int -&gt; b -&gt; w, w, f a -&gt; w -&gt; w, a -&gt; w) -&gt; X a b f -&gt; w\n     ~= (1)\n           (Int -&gt; b -&gt; w)\n        -&gt; w\n        -&gt; (f a -&gt; w -&gt; w)\n        -&gt; (a -&gt; w)\n        -&gt; X a b f\n        -&gt; w\n</code></pre>\n<p>Which is indeed (renaming <code>w=r</code>) the wanted type</p>\n<pre><code>xCata :: (Int -&gt; b -&gt; r)\n      -&gt; r\n      -&gt; (f a -&gt; r -&gt; r)\n      -&gt; (a -&gt; r)\n      -&gt; X a b f\n      -&gt; r\n</code></pre>\n<p>The &quot;standard&quot; implementation of <code>cata</code> is</p>\n<pre><code>cata g = wrap . fmap (cata g) . unwrap\n   where unwrap (X y) = y\n         wrap   y = X y\n</code></pre>\n<p>It takes some effort to understand due to its generality, but this is indeed the intended one.</p>\n<hr />\n<p>About automation: yes, this can be automatized, at least in part.\nThere is the package <code>recursion-schemes</code> on hackage which allows\none to write something like</p>\n<pre><code>type X a b f = Fix (F a f b)\ndata F a b f w = ...  -- you can use the actual constructors here\n       deriving Functor\n\n-- use cata here\n</code></pre>\n<p>Example:</p>\n<pre><code>import Data.Functor.Foldable hiding (Nil, Cons)\n\ndata ListF a k = NilF | ConsF a k deriving Functor\ntype List a = Fix (ListF a)\n\n-- helper patterns, so that we can avoid to match the Fix\n-- newtype constructor explicitly    \npattern Nil = Fix NilF\npattern Cons a as = Fix (ConsF a as)\n\n-- normal recursion\nsumList1 :: Num a =&gt; List a -&gt; a\nsumList1 Nil         = 0\nsumList1 (Cons a as) = a + sumList1 as\n\n-- with cata\nsumList2 :: forall a. Num a =&gt; List a -&gt; a\nsumList2 = cata h\n   where\n   h :: ListF a a -&gt; a\n   h NilF        = 0\n   h (ConsF a s) = a + s\n\n-- with LambdaCase\nsumList3 :: Num a =&gt; List a -&gt; a\nsumList3 = cata $ \\case\n   NilF      -&gt; 0\n   ConsF a s -&gt; a + s\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8440, "user_id": 402428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b17015101f2649d332c389337897816b?s=128&d=identicon&r=PG", "display_name": "michid", "link": "https://stackoverflow.com/users/402428/michid"}, "is_accepted": false, "score": 2, "last_activity_date": 1611091491, "last_edit_date": 1611091491, "creation_date": 1561101178, "answer_id": 56698563, "question_id": 46561125, "link": "https://stackoverflow.com/questions/46561125/does-each-type-have-a-unique-catamorphism/56698563#56698563", "title": "Does each type have a unique catamorphism?", "body": "<p>A catamorphism (if it exists) is unique by <a href=\"https://en.wikipedia.org/wiki/Catamorphism#Definition\" rel=\"nofollow noreferrer\">definition</a>. In category theory a catamorphism denotes the unique homomorphism from an initial algebra into some other algebra. To the best of my knowledge in Haskell all catamorphisms exists because Haskell's types form a <a href=\"https://bartoszmilewski.com/2015/03/13/function-types/\" rel=\"nofollow noreferrer\">Cartesian Closed Category</a> where terminal objects, all products, sums and exponentials exist. See also Bartosz Milewski's <a href=\"https://bartoszmilewski.com/2013/06/10/understanding-f-algebras/\" rel=\"nofollow noreferrer\">blog post about F-algebras</a>, which gives a good introduction to the topic.</p>\n"}], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 2, "accepted_answer_id": 46564500, "answer_count": 2, "score": 11, "last_activity_date": 1611383642, "creation_date": 1507108318, "last_edit_date": 1561101206, "question_id": 46561125, "link": "https://stackoverflow.com/questions/46561125/does-each-type-have-a-unique-catamorphism", "title": "Does each type have a unique catamorphism?", "body": "<p>Recently I've finally started to feel like I understand catamorphisms. I wrote some about them in <a href=\"https://stackoverflow.com/a/46555360/625403\">a recent answer</a>, but briefly I would say a catamorphism for a type abstracts over the process of recursively traversing a value of that type, with the pattern matches on that type reified into one function for each constructor the type has. While I would welcome any corrections on this point or on the longer version in the answer of mine linked above, I think I have this more or less down and that is not the subject of this question, just some background.</p>\n\n<p>Once I realized that the functions you pass to a catamorphism correspond exactly to the type's constructors, and the arguments of those functions likewise correspond to the types of those constructors' fields, it all suddenly feels quite mechanical and I don't see where there is any wiggle room for alternate implementations.</p>\n\n<p>For example, I just made up this silly type, with no real concept of what its structure \"means\", and derived a catamorphism for it. I don't see any other way I could define a general-purpose fold over this type:</p>\n\n<pre><code>data X a b f = A Int b\n             | B\n             | C (f a) (X a b f)\n             | D a\n\nxCata :: (Int -&gt; b -&gt; r)\n      -&gt; r\n      -&gt; (f a -&gt; r -&gt; r)\n      -&gt; (a -&gt; r)\n      -&gt; X a b f\n      -&gt; r\nxCata a b c d v = case v of\n  A i x -&gt; a i x\n  B -&gt; b\n  C f x -&gt; c f (xCata a b c d x)\n  D x -&gt; d x\n</code></pre>\n\n<p>My question is, does every type have a unique catamorphism (up to argument reordering)? Or are there counterexamples: types for which no catamorphism can be defined, or types for which two distinct but equally reasonable catamorphisms exist? If there are no counterexamples (i.e., the catamorphism for a type is unique and trivially derivable), is it possible to get GHC to derive some sort of typeclass for me that does this drudgework automatically?</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1507103440, "post_id": 46558398, "comment_id": 80073040, "body": "Indeed I don&#39;t see the point of having a <code>Setup.hs</code> when it&#39;s only the default one anyway (as it is in, like...? probably 99% of all projects)."}], "answers": [{"comments": [{"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1517129745, "post_id": 48484095, "comment_id": 83961974, "body": "The point is removing clutter. For example, if I have an <code>hpack</code>&#39;s <code>package.yaml</code> added to version control, I would not add <code>example.cabal</code> to version control, but rather to an ignore list, because, when someone builds the package with <code>stack</code>, it will be regenerated under the hood. So long as <code>Setup.hs</code> can be regenerated, I will be doing the same for it. I will report further as I have it working."}], "tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 1, "last_activity_date": 1517124003, "creation_date": 1517124003, "answer_id": 48484095, "question_id": 46558398, "link": "https://stackoverflow.com/questions/46558398/will-users-be-diverted-from-a-package-if-its-not-passing-cabal-check-for-cab/48484095#48484095", "title": "Will users be diverted from a package if it&#39;s not passing `cabal check` for `cabal` `1.22` due to the absence of `Setup.hs`?", "body": "<p>If you run <code>cabal sdist</code> on a project without a <code>Setup.hs</code> file, <code>cabal</code> creates one for you -- try it!</p>\n\n<p>As such, there's no point to removing the file, because it will just get regenerated when you package for distribution anyway.</p>\n"}], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 8, "last_activity_date": 1517124003, "creation_date": 1507098763, "last_edit_date": 1517056526, "question_id": 46558398, "link": "https://stackoverflow.com/questions/46558398/will-users-be-diverted-from-a-package-if-its-not-passing-cabal-check-for-cab", "title": "Will users be diverted from a package if it&#39;s not passing `cabal check` for `cabal` `1.22` due to the absence of `Setup.hs`?", "body": "<p><code>stack new</code> usually creates a default <code>Setup.hs</code> file. I removed it from a project and it still builds alright for any <code>lts</code> resolver down to <code>lts-2</code>. It also passes <code>cabal check</code> at least for <code>cabal</code> version <code>1.24</code>. (Though not for <code>cabal</code> <code>1.22</code>.)</p>\n\n<p>Can I conclude from this result that including a default <code>Setup.hs</code> in a project is not trendy anymore and I can drop it? In particular, will many prospective users be diverted from installing the package if it's not passing <code>cabal check</code> for <code>cabal</code> <code>1.22</code>?</p>\n\n<p>P.S. This question is more specific than <a href=\"https://stackoverflow.com/questions/46390981\">the other, similar one</a> in that I want to know, specifically, if the package not passing <code>cabal check</code> for a certain version of <code>cabal</code> due to the absence of an otherwise unnecessary <code>Setup.hs</code> will be counted against that package in some situations, and whether there are any other downsides to not having a <code>Setup.hs</code> in a project, considering the current state of the Haskell ecosystem. Whether a <code>Setup.hs</code> is necessary or useful overall is not a question here.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1507096057, "post_id": 46556310, "comment_id": 80069422, "body": "And, in general, there\u2019s <code>flip</code>."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 1, "last_activity_date": 1507085792, "creation_date": 1507085792, "answer_id": 46556310, "question_id": 46556297, "link": "https://stackoverflow.com/questions/46556297/how-to-write-a-partially-applied-function-for-subtraction-specifying-the-subtrah/46556310#46556310", "title": "How to write a partially applied function for subtraction specifying the subtrahend?", "body": "<p>You'd use <code>subtract</code>, which exists specifically for this purpose:</p>\n\n<pre><code>subtract 1\n</code></pre>\n"}], "owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "closed_date": 1507085794, "accepted_answer_id": 46556310, "answer_count": 1, "score": 0, "last_activity_date": 1507085792, "creation_date": 1507085656, "question_id": 46556297, "link": "https://stackoverflow.com/questions/46556297/how-to-write-a-partially-applied-function-for-subtraction-specifying-the-subtrah", "closed_reason": "Duplicate", "title": "How to write a partially applied function for subtraction specifying the subtrahend?", "body": "<p>I am trying to write a function that decrements by one -- something like what I would expect <code>(-1)</code> to do as a partially applied infix with specified subtrahend. However, written that way <code>ghc</code> appears to read the <code>-</code> not as a subtraction operator but as a negation.</p>\n\n<pre><code>&gt; :t (-1)\n(-1) :: Num a =&gt; a\n</code></pre>\n\n<p>How can I concisely write a decrement operator?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": false, "score": 5, "last_activity_date": 1507074432, "creation_date": 1507074432, "answer_id": 46555049, "question_id": 46554677, "link": "https://stackoverflow.com/questions/46554677/is-it-possible-to-write-pattern-matched-functions-in-pointfree-form/46555049#46555049", "title": "Is it possible to write pattern-matched functions in pointfree form?", "body": "<p>You can\u2019t do it without a little bit of boilerplate, but <code>lens</code> can generate that boilerplate for you, so that\u2019s probably as close as you are going to get.</p>\n\n<p>Using <code>makePrisms</code> from <code>Control.Lens.TH</code> will generate an <code>Iso</code>, which is, essentially, a first-class pattern-match on a single-constructor datatype. Conveniently, <code>Iso</code>s are bidirectional, so you can <code>view</code> them (to get values out, like pattern-matching) and <code>review</code> them (to put a value back in, like using the constructor normally).</p>\n\n<p>Using <code>makePrisms</code> and <code>view</code>, it\u2019s possible to write <code>getSeq</code> in a pointfree way:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\nimport Control.Lens\n\ndata Keypress = Keypress Int Char\nmakePrisms ''Keypress\n\ngetSeq :: Keypress -&gt; [Char]\ngetSeq = uncurry replicate . view _Keypress\n</code></pre>\n\n<p>Is this better? No idea. The pattern-match in your code looks just fine to me, but if you\u2019re using <code>lens</code> already anyway, this version might be more agreeable to you.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 12, "last_activity_date": 1507074465, "creation_date": 1507074465, "answer_id": 46555055, "question_id": 46554677, "link": "https://stackoverflow.com/questions/46554677/is-it-possible-to-write-pattern-matched-functions-in-pointfree-form/46555055#46555055", "title": "Is it possible to write pattern-matched functions in pointfree form?", "body": "<p>As written, no. But you can fix that if you want:</p>\n\n<pre><code>data Keypress = Keypress\n  { count :: Int\n  , char :: Char }\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>getSeq p = replicate (count p) (char p)\n</code></pre>\n\n<p>and that can be converted to</p>\n\n<pre><code>getSeq = replicate &lt;$&gt; count &lt;*&gt; char\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 17, "last_activity_date": 1512775748, "last_edit_date": 1512775748, "creation_date": 1507077161, "answer_id": 46555360, "question_id": 46554677, "link": "https://stackoverflow.com/questions/46554677/is-it-possible-to-write-pattern-matched-functions-in-pointfree-form/46555360#46555360", "title": "Is it possible to write pattern-matched functions in pointfree form?", "body": "<p>It is often useful, especially for recursive data types with multiple constructors, to define a <strong>catamorphism</strong>, a way to fold up a data structure when given one function for each of the possible constructors.</p>\n\n<p>For example, for <code>Bool</code> the catamorphism is</p>\n\n<pre><code>bool :: a -&gt; a -&gt; Bool -&gt; a\nbool x _ False = x\nbool _ y True = y\n</code></pre>\n\n<p>and for <code>Either</code> it is </p>\n\n<pre><code>either :: (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c\neither f g (Left x) = f x\neither f g (Right x) = g x\n</code></pre>\n\n<p>A more advanced catamorphism is the one for lists, which you have probably seen before: <code>foldr</code>!</p>\n\n<pre><code>foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\nfoldr f init [] = init\nfoldr f init (x:xs) = f x (foldr f init xs)\n</code></pre>\n\n<p>We don't usually think of it this way (or at least I don't), but <code>foldr</code> is a catamorphism: it handles pattern-matching and recursively deconstructing the list for you, so long as you provide \"handlers\" for values found in the two constructors of <code>[a]</code>:</p>\n\n<ul>\n<li>One case to handle <code>[]</code>, needing no arguments at all: just a value of type <code>b</code></li>\n<li>One case to handle <code>(x:xs)</code>. This case takes one argument representing <code>x</code>, the head of the list, and one argument representing the result of folding up the tail recursively, a value of type <code>b</code>.</li>\n</ul>\n\n<p>A catamorphism is less exciting for a type with only one constructor, but we can easily define one for your <code>Keypress</code> type:</p>\n\n<pre><code>key :: (Int -&gt; Char -&gt; a) -&gt; Keypress -&gt; a\nkey f (Keypress x c) = f x c\n</code></pre>\n\n<p>In a way, the catamorphism allows you to abstract away the pattern-matching part of the function definition, after which you can just work with functions that don't need to touch the underlying data type directly anymore.</p>\n\n<p>Having defined that generally-useful function once, you can use it many times, to implement any point-free function your heart desires. In your case, you could simply write</p>\n\n<pre><code>getSeq :: Keypress -&gt; [Char]\ngetSeq = key replicate\n</code></pre>\n"}], "owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 1, "accepted_answer_id": 46555360, "answer_count": 3, "score": 9, "last_activity_date": 1512775748, "creation_date": 1507071687, "question_id": 46554677, "link": "https://stackoverflow.com/questions/46554677/is-it-possible-to-write-pattern-matched-functions-in-pointfree-form", "title": "Is it possible to write pattern-matched functions in pointfree form?", "body": "<p>Consider the following Haskell code.</p>\n\n<pre><code>data Keypress = Keypress Int Char\n\ngetSeq :: Keypress -&gt; [Char]\ngetSeq (Keypress i c) = replicate i c\n</code></pre>\n\n<p><strong>Is there any way to write <code>getSeq</code> in pointfree form?</strong></p>\n\n<p><code>getSeq</code>'s definition is so similar to its pattern match that it seems there might be some way to use currying or monads or something to avoid specifying the <code>i</code> and <code>c</code> parameters. However, <a href=\"http://pointfree.io/\" rel=\"noreferrer\">pointfree.io</a> does not resolve a point-free output for <code>getSeq</code>, I think due to the pattern match.</p>\n\n<p>Is it possible?</p>\n"}, {"tags": ["haskell", "tree", "binary-tree"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1507067814, "post_id": 46553608, "comment_id": 80062428, "body": "No it does not expect a tree as input, since <code>Tree</code> is not a constructor here..."}, {"owner": {"reputation": 73, "user_id": 8702185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8e5108dd07336da0fde1fdb3e856f3?s=128&d=identicon&r=PG&f=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/8702185/momo"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1507068488, "post_id": 46553608, "comment_id": 80062655, "body": "Hmm ... So what would be a better input?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1507068580, "post_id": 46553608, "comment_id": 80062688, "body": "What do you mean when you say &quot;random&quot;? What role does <code>build</code> have in tree generation? What type do you expect it to have? You seem to be missing some basics, like the distinction between a type constructor and a data constructor. Perhaps you should take a step back and read some more introductory material?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1507068672, "post_id": 46553608, "comment_id": 80062716, "body": "There&#39;s no such thing as a &quot;n-ary binary tree&quot;. A tree with a branching factor of 2 is a binary tree; a tree with a branching factor of <i>n</i> is an n-ary tree."}, {"owner": {"reputation": 73, "user_id": 8702185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8e5108dd07336da0fde1fdb3e856f3?s=128&d=identicon&r=PG&f=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/8702185/momo"}, "edited": false, "score": 0, "creation_date": 1507069102, "post_id": 46553608, "comment_id": 80062864, "body": "I am sorry for describing it wrong. I didn&#39;t mean n-ary tree. The result of my code should generate a random tree, given a maximum depth.  build is a try to generate a tree with only Lambda-Nodes. Because I want to understand how to generate trees. I know how to implement a Tree in my Structure.  For example: tree = Funktion (Leaf &quot;A&quot;) (Lambda (Leaf &quot;A&quot;))"}, {"owner": {"reputation": 73, "user_id": 8702185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8e5108dd07336da0fde1fdb3e856f3?s=128&d=identicon&r=PG&f=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/8702185/momo"}, "edited": false, "score": 0, "creation_date": 1507072083, "post_id": 46553608, "comment_id": 80063630, "body": "So I managed how to generate a tree only with Lambda. I have done it with list comprehension: build 0 = [Leaf] build n = [Lambda a | a &lt;- build (n-1)] But how can I randomize this now?"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 8702185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8e5108dd07336da0fde1fdb3e856f3?s=128&d=identicon&r=PG&f=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/8702185/momo"}, "edited": false, "score": 0, "creation_date": 1507073515, "post_id": 46554816, "comment_id": 80063934, "body": "thanks, that was what I was looking for. The problem with the random trees is that I want to generate trees. Which randomly decide wether to place a Lambda (unary node) or a Funktion (binary node)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 73, "user_id": 8702185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8e5108dd07336da0fde1fdb3e856f3?s=128&d=identicon&r=PG&f=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/8702185/momo"}, "edited": false, "score": 0, "creation_date": 1507073784, "post_id": 46554816, "comment_id": 80063999, "body": "@P.Barthel, in Haskell, if you want to make random things, you kind of need some context. <i>Why</i> are you trying to make random trees? What are you going to do with them? The answer to <i>how</i> may be radically different depending on <i>why</i>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 73, "user_id": 8702185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8e5108dd07336da0fde1fdb3e856f3?s=128&d=identicon&r=PG&f=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/8702185/momo"}, "edited": false, "score": 0, "creation_date": 1507074252, "post_id": 46554816, "comment_id": 80064099, "body": "Some things to look at are <code>quickcheck</code>, <code>tf-random</code>, and <code>random-fu</code>, but it all really depends on what you&#39;re doing."}, {"owner": {"reputation": 73, "user_id": 8702185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8e5108dd07336da0fde1fdb3e856f3?s=128&d=identicon&r=PG&f=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/8702185/momo"}, "edited": false, "score": 0, "creation_date": 1507075727, "post_id": 46554816, "comment_id": 80064447, "body": "Thanks for the answer. The actual thing I want to create is something called freshness constraints. It&#39;s a topic of the nominal unification. These constraints consist of Lambdas and Functions. I need to create random constraints in which Atoms (thats why the &quot;A&quot; in the Leaf) are bounded by either a Function or a Lambda. But these constraints shouldnt be completely random. They should be limited by a maximum depth."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 73, "user_id": 8702185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8e5108dd07336da0fde1fdb3e856f3?s=128&d=identicon&r=PG&f=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/8702185/momo"}, "edited": false, "score": 0, "creation_date": 1507076215, "post_id": 46554816, "comment_id": 80064541, "body": "@P.Barthel, what the trees <i>mean</i> is not relevant here. The question is really more about how you plan to <i>use</i> the ones you generate randomly. Are you trying to create test cases? Are you trying to implement a <a href=\"https://en.wikipedia.org/wiki/Randomized_algorithm\" rel=\"nofollow noreferrer\">randomized algorithm</a>? Etc.? Do you need a specific random distribution?"}, {"owner": {"reputation": 73, "user_id": 8702185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8e5108dd07336da0fde1fdb3e856f3?s=128&d=identicon&r=PG&f=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/8702185/momo"}, "edited": false, "score": 0, "creation_date": 1507079268, "post_id": 46554816, "comment_id": 80065206, "body": "I have an implemented data structure given which I want to consign the order I got from the trees. A equal possibility distribution is totally fine"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1507072687, "creation_date": 1507072687, "answer_id": 46554816, "question_id": 46553608, "link": "https://stackoverflow.com/questions/46553608/generate-n-ary-binary-tree-in-haskell/46554816#46554816", "title": "Generate n-ary binary tree in haskell", "body": "<p>It sounds like you want something like</p>\n\n<pre><code>build :: Natural       -- ^ Number, n, of Lambda nodes\n      -&gt; a             -- ^ Value, v, to store in the Leaf\n      -&gt; Tree a        -- ^ Lambda^n (Leaf v)\nbuild 0 a = Leaf a\nbuild n a = Lambda (build (n - 1) a)\n</code></pre>\n\n<p>So that <code>build 4 \"A\"</code> will produce</p>\n\n<pre><code>Lambda (Lambda (Lambda (Lambda (Leaf \"A\"))))\n</code></pre>\n\n<p>Unfortunately, the rest of your question (about generating random trees) really requires substantially more context to answer.</p>\n"}, {"tags": [], "owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "is_accepted": false, "score": 0, "last_activity_date": 1507072811, "creation_date": 1507072811, "answer_id": 46554837, "question_id": 46553608, "link": "https://stackoverflow.com/questions/46553608/generate-n-ary-binary-tree-in-haskell/46554837#46554837", "title": "Generate n-ary binary tree in haskell", "body": "<p>You're close - your <code>build</code> function at the moment will always return a <code>Leaf</code>, as the base case of the recursion doesn't <em>do</em> anything with its argument. You don't actually need the argument:</p>\n\n<pre><code>build :: Integer -&gt; Tree String\nbuild 0 = Leaf \"A\"\nbuild n = Lambda $ build (n-1)\n</code></pre>\n\n<p>This would produce what your <code>build</code> function seems to be intending, that is a simple \"tree\" of given depth <code>n</code> composed of a <code>Leaf</code> node and <code>Lambda</code> nodes. Eg:</p>\n\n<pre><code>\u03bb&gt; build 2\nLambda (Lambda (Leaf \"A\"))\n</code></pre>\n\n<hr>\n\n<p>To get your randomly generated tree, you need to look at the <a href=\"https://hackage.haskell.org/package/random-1.1/docs/System-Random.html\" rel=\"nofollow noreferrer\"><code>System.Random</code></a> module.</p>\n\n<p>For example building on the previous, a tree of random height between a given upper and lower bound:</p>\n\n<pre><code>buildRandom :: (Integer, Integer) -&gt; IO (Tree String)\nbuildRandom bounds = randomRIO bounds &gt;&gt;= return . build\n</code></pre>\n\n<p>This can be extended and modified to produce the behaviour you want (a fully random generated tree), but requires knowledge of monads etc., which might take some extra reading.</p>\n"}], "owner": {"reputation": 73, "user_id": 8702185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8e5108dd07336da0fde1fdb3e856f3?s=128&d=identicon&r=PG&f=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/8702185/momo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1507072811, "creation_date": 1507065593, "question_id": 46553608, "link": "https://stackoverflow.com/questions/46553608/generate-n-ary-binary-tree-in-haskell", "title": "Generate n-ary binary tree in haskell", "body": "<p>I try to create random trees from this structure: </p>\n\n<pre><code>data Tree a = Leaf a\n            | Funktion (Tree a) (Tree a)\n            | Lambda (Tree a)\n            deriving (Show)\n</code></pre>\n\n<p>The problem I have is that I don't even know how to generate a tree with the depth of (for example) 2 which only has \"Lambda\" as nodes. If someone could help me with generating this simple tree (depth 2) I could generate them randomly.\nIf I implement a function like this:</p>\n\n<pre><code>build (Tree a) 0 = Leaf \"A\"\nbuild (Tree a) n = build (Lambda a) (n-1)\n</code></pre>\n\n<p>It won't work since the function build itself expects a Tree as input. Actually I need trees which have the nodes Lambda or Funktion, but first of all I need to understand how to generate a simple version of this structure.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1507064790, "post_id": 46553393, "comment_id": 80061293, "body": "<code>circles  = [(radius,area,circumference)|radius &lt;- [1..10], let area = 3.14*radius^2, let circumference = 3.14*radius ]</code>. Note that <code>let ... = ...</code> is not at all the same as <code>... &lt;- ...</code>."}], "answers": [{"tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 2, "last_activity_date": 1507067028, "last_edit_date": 1507067028, "creation_date": 1507065540, "answer_id": 46553598, "question_id": 46553393, "link": "https://stackoverflow.com/questions/46553393/type-error-in-list-comprehension/46553598#46553598", "title": "Type error in list comprehension", "body": "<p>Alec's comment explains the correct answer:</p>\n\n<pre><code>circles = [(radius, area, circumference) |\n             radius &lt;- [1..10],\n             let area = 3.14 * radius ^ 2\n                 circumference = 3.14 * radius]\n</code></pre>\n\n<p>Because <code>... &lt;- ...</code> is not the same as <code>let ... = ...</code>. However it's helpful to understand the error message itself!</p>\n\n<p>All three errors have lines like:</p>\n\n<pre><code>* No instance for (Enum [t0]) arising from the arithmetic sequence `1 .. 10'\n* No instance for (Num [t0]) arising from the literal `1'\n* No instance for (Fractional [t0]) arising from the literal `3.14\n</code></pre>\n\n<p>The second and third errors are the result of Haskell trying to iterate over your literal area and circumference definitions. That's what the left arrow does in a list comp. Both error messages are complaining that it can't find a way to turn the literal into a list, so it can't iterate from it.</p>\n"}], "owner": {"reputation": 21, "user_id": 7410880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/524d339122fc2d6841cfa87ddf5acd5c?s=128&d=identicon&r=PG&f=1", "display_name": "Colin Bernhardt", "link": "https://stackoverflow.com/users/7410880/colin-bernhardt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1507067028, "creation_date": 1507064648, "last_edit_date": 1507064935, "question_id": 46553393, "link": "https://stackoverflow.com/questions/46553393/type-error-in-list-comprehension", "title": "Type error in list comprehension", "body": "<p>I am new to Haskell and I encountered a error like this.</p>\n\n<pre><code>learnHaskell.hs:1:51: error:\n* No instance for (Enum [t0])\n    arising from the arithmetic sequence `1 .. 10'\n* In the expression: [1 .. 10]\n  In a stmt of a list comprehension: radius &lt;- [1 .. 10]\n  In the expression:\n    [(radius, area, circumference) |\n       radius &lt;- [1 .. 10],\n       area &lt;- 3.14 * radius ^ 2,\n       circumference &lt;- 3.14 * radius]\n\nlearnHaskell.hs:1:52: error:\n* No instance for (Num [t0]) arising from the literal `1'\n* In the expression: 1\n  In the expression: [1 .. 10]\n  In a stmt of a list comprehension: radius &lt;- [1 .. 10]\n\nlearnHaskell.hs:1:67: error:\n* No instance for (Fractional [t0]) arising from the literal `3.14'\n* In the first argument of `(*)', namely `3.14'\n  In the expression: 3.14 * radius ^ 2\n  In a stmt of a list comprehension: area &lt;- 3.14 * radius ^ 2\n</code></pre>\n\n<p>I am still new at this. Can someone help me figure out what's wrong.\nThe source code is down below.</p>\n\n<pre><code>circles  = [(radius,area,circumference)|radius &lt;- [1..10],area &lt;- 3.14*radius^2,circumference&lt;-3.14*radius ]\n</code></pre>\n"}, {"tags": ["java", "scala", "haskell", "functional-programming", "kotlin"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1507060992, "post_id": 46552329, "comment_id": 80059455, "body": "I can&#39;t read Kotlin code, but from skimming the problem description, it seems like the central computation you need is <code>Maybe</code>, or possibly <code>Either</code>. If you want to carry around read-only state in an implicit manner (instead of just passing it as an argument), you could use the the <code>Reader</code> monad. This would imply that you&#39;d need to stack <code>Reader</code> on top of <code>Maybe</code>, or the other way around, so you you could consider <code>ReaderT</code> or <code>MaybeT</code> (alternatively <code>EitherT</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1507099048, "last_edit_date": 1507099048, "creation_date": 1507061691, "answer_id": 46552694, "question_id": 46552329, "link": "https://stackoverflow.com/questions/46552329/functional-programming-how-to-carry-on-the-context-for-a-chain-of-validation-ru/46552694#46552694", "title": "Functional programming: How to carry on the context for a chain of validation rules", "body": "<blockquote>\n  <p>Is it Monads as my gut feeling tries to tell me that?</p>\n</blockquote>\n\n<p>I think <code>Monad</code> is too strong a requirement in your case. Your validation functions</p>\n\n<blockquote>\n  <p>fun theFruitIsRed(fruit: Fruit) : Optional&lt; String></p>\n</blockquote>\n\n<p>don't return an useable value when they validate successfully. And a defining characteristic of <code>Monad</code> is being able do decide what future computations to execute based on a previous result. \"If the first validator succeeds returning foo, validate this field, if it succeeds returning bar, validate this other field instead\".</p>\n\n<p>I'm not knowledgeable about Kotlin, but I think you could have a <code>Validator&lt;T&gt;</code> class. It basically would wrap a single validation function for a type <code>T</code> that returned an <code>Optional&lt;String&gt;</code>.</p>\n\n<p>Then you could write a method that combined two validators into a composite validator. The inner function of the composite validator would receive a T, run the first validator, return the error if it fails, if not run the second validator. (If your validators returned some useful result on successful validation, like say non-fatal warnings, you would need to supply an additional function to combine these results.)</p>\n\n<p>The idea its that you would <em>first</em> compose the validators, and only <em>then</em> supply the actual T to get the final result. This compose-before-running approach is used by Java's <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/Comparator.html#thenComparing-java.util.Comparator-\" rel=\"nofollow noreferrer\">Comparator</a>, for example.</p>\n\n<p>Notice that in this solution, even if your functions returned some result on successful validation, those values would not be used to select what <em>validations</em> to do next (though an error would stop the chain). You could combine results using a function but that's it. This \"more rigid\" style of programming is called <code>Applicative</code> in Haskell. All types supporting a <code>Monad</code> interface can be used in an <code>Applicative</code> way, but some types support <code>Applicative</code> without supporting <code>Monad</code>.</p>\n\n<hr>\n\n<p>Another interesting aspect of validators is that they are contravariant on their input type <code>T</code>. This means that you can \"pre-apply\" a function from <code>A</code> to <code>B</code> to a <code>Validator&lt;B&gt;</code>, resulting in a <code>Validator&lt;A&gt;</code> whose type went \"backwards\" compared to the direction of the function. (The <a href=\"http://download.java.net/java/jdk9/docs/api/java/util/stream/Collectors.html#mapping-java.util.function.Function-java.util.stream.Collector-\" rel=\"nofollow noreferrer\"><code>mapping</code></a> function of Java's <code>Collectors</code> class works this way.)</p>\n\n<p>And you can go further down this route by having functions that build a validator for a composite out of validators for their individual parts. (What in Haskell is called <a href=\"http://hackage.haskell.org/package/contravariant-1.4/docs/Data-Functor-Contravariant-Divisible.html\" rel=\"nofollow noreferrer\"><code>Divisible</code></a>.)</p>\n"}, {"tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": false, "score": 3, "last_activity_date": 1507069434, "last_edit_date": 1507069434, "creation_date": 1507062696, "answer_id": 46552942, "question_id": 46552329, "link": "https://stackoverflow.com/questions/46552329/functional-programming-how-to-carry-on-the-context-for-a-chain-of-validation-ru/46552942#46552942", "title": "Functional programming: How to carry on the context for a chain of validation rules", "body": "<p>Since the type of the object being validated can't change (as the object itself shouldn't change), I wouldn't use a monad (or any sort of functor). I'd have a type <code>Validator a err = a -&gt; [err]</code>. If a validator succeeds, it outputs <code>[]</code> (no error). This forms a monoid, where <code>mzero = const []</code> and <code>mappend f g x = f x `mappend` g x</code>. Haskell has this built in as <code>instance Monoid b =&gt; Monoid (a -&gt; b)</code></p>\n\n<p><strong>EDIT</strong>: I appear to have misread the question. @4castle's answer is almost exactly this one but uses <code>Maybe err</code> instead of <code>[err]</code>. Use that.</p>\n\n<pre class=\"lang-scala prettyprint-override\"><code>// Scala, because I'm familiar with it, but it should translate to Kotlin\ncase class Validator[-A, +Err](check: A =&gt; Seq[Err]) {\n  def apply(a: A): Err = check(a)\n  def |+|[AA &gt;: A](that: Validator[A, Err]): Validator[AA, Err]\n  = Validator { a =&gt;\n    this(a) ++ that(a)\n  }\n}\nobject Validator {\n  def success[A, E]: Validator[A, E] = Validator { _ =&gt; Seq() }\n}\n\ntype FruitValidator = Validator[Fruit, String]\nval notTooHeavy: FruitValidator = Validator { fruit =&gt;\n  if(fruit.weight &lt; 500) Seq() else Seq(\"Too heavy\")\n  // Maybe make a helper method for this logic\n}\n\nval isRed: FruitValidator = Validator { fruit =&gt;\n  if (fruit.color == \"red\") Seq() else Seq(\"Not red\")\n}\n\nval compositeRule: FruitValidator = notTooHeavy |+| isRed\n</code></pre>\n\n<p>To use, just call a <code>Validator</code> like <code>compositeRule(Fruit(\"green\", 700))</code>, which returns 2 errors in this case.</p>\n\n<p>To see why the reader monad is inappropriate here, consider what happens if</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type Validator = ReaderT Fruit (Either String) Fruit\nruleA :: Validator\nruleA = ReaderT $ \\fruit -&gt;\n  if color fruit /= \"red\" then Left \"Not red\"\n  else Right fruit\nruleB :: Validator\nruleB = ReaderT $ \\fruit -&gt;\n   if weight fruit &gt;= 500 then Left \"Too heavy\"\n   else Right fruit\nruleC = ruleA &gt;&gt; ruleB\n\ngreenHeavy = Fruit \"green\" 700\n</code></pre>\n\n<p>Both <code>ruleA</code> and <code>ruleB</code> fail for <code>greenHeavy</code>, yet running <code>runReaderT ruleC greenHeavy</code> only produces the first error. This is undesirable: you likely want as many errors as possible revealed per run.</p>\n\n<p>Also, you can \"hijack\" the validation:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>bogusRule :: ReaderT Fruit (Either String) Int\nbogusRule = return 42\n\nruleD = do ruleA\n           ruleB\n           bogusRule -- Validates just fine... then throws away the Fruit so you can't validate further.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 1, "last_activity_date": 1507064113, "last_edit_date": 1507064113, "creation_date": 1507063725, "answer_id": 46553170, "question_id": 46552329, "link": "https://stackoverflow.com/questions/46552329/functional-programming-how-to-carry-on-the-context-for-a-chain-of-validation-ru/46553170#46553170", "title": "Functional programming: How to carry on the context for a chain of validation rules", "body": "<p>To answer generally the question</p>\n\n<blockquote>\n  <p>Now the problem is that somehow I have to carry the fruit context from check to check call.</p>\n</blockquote>\n\n<p>...phrased as...</p>\n\n<blockquote>\n  <p>Given some monad <code>M</code>, how do I chain some <code>M</code> actions while also (implicitly) giving the same \u201ccontext\u201d object to each?</p>\n</blockquote>\n\n<p>The Haskell answer would be to use the <a href=\"http://hackage.haskell.org/package/transformers-0.5.4.0/docs/Control-Monad-Trans-Reader.html#t:ReaderT\" rel=\"nofollow noreferrer\"><code>ReaderT</code> monad transformer</a>. It takes any monad, such as <code>Maybe</code>, and gives you another monad which implicitly passes a \u201cglobal constant\u201d to each action.</p>\n\n<p>Let me rewrite your checkers in Haskell:</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Fruit = Fruit {colour::String, weight::Int}\n\ntheFruitIsRed :: Fruit -&gt; Either String ()\ntheFruitIsRed fruit\n  | colour fruit == \"red\"  = Right ()\n  | otherwise              = Left \"Fruit not red\"\n\nfruitNotTooHeavy :: Fruit -&gt; Either String ()\nfruitNotTooHeavy fruit\n  | weight fruit &lt; 500     = Right ()\n  | otherwise              = Left \"Too heavy\"\n</code></pre>\n\n<p>Note that I've used <code>Either String ()</code> instead of <code>Maybe String</code> because I want <code>String</code> to be the \u201cabort case\u201d, whereas in the <code>Maybe</code> monad it would be the \u201ccarry on\u201d case.</p>\n\n<p>Now, instead of doing</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>checks :: Fruit -&gt; Either String ()\nchecks fruit = do\n    theFruitIsRed fruit\n    fruitNotTooHeavy fruit\n</code></pre>\n\n<p>I can do</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>checks = runReaderT $ do\n    ReaderT theFruitIsRed\n    ReaderT fruitNotTooHeavy\n</code></pre>\n\n<p>Your <code>Result</code> class seems to be essentially a special instantiation of the <code>ReaderT</code> transformer. Not sure if you could implement the exact thing in Kotlin as well.</p>\n"}, {"tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 1, "last_activity_date": 1507064669, "creation_date": 1507064669, "answer_id": 46553404, "question_id": 46552329, "link": "https://stackoverflow.com/questions/46552329/functional-programming-how-to-carry-on-the-context-for-a-chain-of-validation-ru/46553404#46553404", "title": "Functional programming: How to carry on the context for a chain of validation rules", "body": "<p>It sounds like you are looking for an error monad. Its like the <code>Maybe</code> (aka <code>Option</code>) monad, but the error case carries a message.</p>\n\n<p>In Haskell its just the <code>Either</code> type, with the first argument being the type of the error value.</p>\n\n<pre><code>type MyError a = Either String a\n</code></pre>\n\n<p>If you check the <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Either.html\" rel=\"nofollow noreferrer\">Data.Either</a> documentation you will see that <code>Either e</code> is already an instance of Monad, so you don't need to do anything else. You can just write:</p>\n\n<pre><code>notTooHeavy :: Fruit -&gt; MyError ()\nnotTooHeavy fruit = \n    when (weight fruit &gt; 500) $ fail \"Too heavy\"\n</code></pre>\n\n<p>What the monad instance does is stop the computation at the first <code>fail</code>, so you get e.g. <code>Left \"Too heavy\"</code> or <code>Right ()</code>. If you want to accumulate errors then you have to do somthing more complicated.</p>\n\n<p>Other posters have suggested that you don't need monads because your example code has all the functions returning <code>()</code>. While this may be true of your examples, I'm reluctant to generalise that fast. Also since you get the monadic instance automatically with <code>Either</code> it makes sense to just use it.</p>\n"}, {"comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1507068375, "post_id": 46553945, "comment_id": 80062614, "body": "Real cool but what does <code>(First(First, getFirst))</code> mean at the <code>import Data.Monoid </code> stage."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 1, "creation_date": 1507068415, "post_id": 46553945, "comment_id": 80062631, "body": "@Redu &quot;Import the type <code>First</code>, the data constructor <code>First</code>, and the record field <code>getFirst</code>.&quot; The parentheses associate the data constructor and field with the type."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1507068631, "post_id": 46553945, "comment_id": 80062703, "body": "@4castle Why keep only the <code>First</code> error instead of keeping all of them with <code>[]</code>?"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1507069260, "post_id": 46553945, "comment_id": 80062922, "body": "@HTNW The OP said <i>&quot;Also when a function returns an error, the others should not be processed.&quot;</i> but you could get that behavior by using <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Maybe.html#v:catMaybes\" rel=\"nofollow noreferrer\"><code>catMaybes</code></a>."}], "tags": [], "owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "is_accepted": true, "score": 4, "last_activity_date": 1507068004, "last_edit_date": 1507068004, "creation_date": 1507067229, "answer_id": 46553945, "question_id": 46552329, "link": "https://stackoverflow.com/questions/46552329/functional-programming-how-to-carry-on-the-context-for-a-chain-of-validation-ru/46553945#46553945", "title": "Functional programming: How to carry on the context for a chain of validation rules", "body": "<p>You could use/create a monoid wrapper of your <code>Optional</code>/<code>Maybe</code> type such as <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Monoid.html#t:First\" rel=\"nofollow noreferrer\"><code>First</code></a> in Haskell which combines values by returning the first non-Nothing value.</p>\n\n<p>I don't know Kotlin, but in Haskell it would look like this:</p>\n\n<pre><code>import Data.Foldable (foldMap)\nimport Data.Monoid (First(First, getFirst))\n\ndata Fruit = Fruit { color :: String, weight :: Int }\n\ntheFruitIsRed :: Fruit -&gt; Maybe String\ntheFruitIsRed (Fruit \"red\" _) = Nothing\ntheFruitIsRed _               = Just \"Fruit not red\"\n\ntheFruitIsNotTooHeavy :: Fruit -&gt; Maybe String\ntheFruitIsNotTooHeavy (Fruit _ w)\n    | w &lt; 500   = Nothing\n    | otherwise = Just \"Too heavy\"\n\ncheckRules :: Fruit -&gt; Maybe String\ncheckRules = getFirst . foldMap (First .)\n    [ theFruitIsRed\n    , theFruitIsNotTooHeavy\n    ]\n</code></pre>\n\n<p><a href=\"https://ideone.com/4Gk5Rh\" rel=\"nofollow noreferrer\">Ideone Demo</a></p>\n\n<p>Note that I'm taking advantage of the <code>Monoid</code> instance of functions here:</p>\n\n<pre><code>Monoid b =&gt; Monoid (a -&gt; b)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3161, "user_id": 812272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/81e24cd679d414d554df2bde26658fd4?s=128&d=identicon&r=PG", "display_name": "user3001", "link": "https://stackoverflow.com/users/812272/user3001"}, "edited": false, "score": 1, "creation_date": 1507131489, "post_id": 46562093, "comment_id": 80091396, "body": "This is really nice!"}], "tags": [], "owner": {"reputation": 4427, "user_id": 4706743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b05c3b09628ba8955d6d7a188271af?s=128&d=identicon&r=PG&f=1", "display_name": "D3xter", "link": "https://stackoverflow.com/users/4706743/d3xter"}, "is_accepted": false, "score": 2, "last_activity_date": 1507548744, "last_edit_date": 1507548744, "creation_date": 1507111335, "answer_id": 46562093, "question_id": 46552329, "link": "https://stackoverflow.com/questions/46552329/functional-programming-how-to-carry-on-the-context-for-a-chain-of-validation-ru/46562093#46562093", "title": "Functional programming: How to carry on the context for a chain of validation rules", "body": "<p>There are couple of Haskell implementations,\nso let's try to solve it with Kotlin.</p>\n\n<p>First, we start with the Data-Object:</p>\n\n<pre><code>class Fruit(val color: String, val weight: Int)\n</code></pre>\n\n<p>And we need a Type that represents a Fruit and whether an error occurred:</p>\n\n<pre><code>sealed class Result&lt;out E, out O&gt; {\n    data class Error&lt;E&gt;(val e: E) : Result&lt;E, Nothing&gt;()\n\n    data class Ok&lt;O&gt;(val o: O): Result&lt;Nothing, O&gt;()\n}\n</code></pre>\n\n<p>Now lets define the Type of a FruitRule:</p>\n\n<pre><code>typealias FruitRule = (Fruit) -&gt; String?\n</code></pre>\n\n<p>The <code>FruitRule</code> is a function that receives a Fruit-Instance\nand returns <code>null</code> if the rule passed or the error message.</p>\n\n<p>The problem we got here is that <code>FruitRule</code> itself is not composable.\nSo we need a Type that is composable and runs a <code>FruitRule</code> on a <code>Fruit</code></p>\n\n<pre><code>typealias ComposableFruitRule = (Result&lt;String, Fruit&gt;) -&gt; Result&lt;String, Fruit&gt;\n</code></pre>\n\n<p>First, we need a way to create a <code>ComposableFruitRule</code> from a <code>FruitRule</code></p>\n\n<pre><code>fun createComposableRule(f: FruitRule): ComposableFruitRule {\n    return { result: Result&lt;String, Fruit&gt; -&gt;\n\n        if(result is Result.Ok&lt;Fruit&gt;) {\n            val temporaryResult = f(result.o)\n\n            if(temporaryResult is String)\n                Result.Error(temporaryResult)\n            else\n                //We know that the rule passed,\n                //so we can return Result.Ok&lt;Fruit&gt; we received back\n                result\n        } else {\n            result\n        }\n    }\n}\n</code></pre>\n\n<p><code>createComposableFruitRule</code> returns a lambda that first checks whether the provided Result is <code>Result.Ok</code>. If yes, it runs the provided <code>FruitRule</code> on the given <code>Fruit</code> and returns <code>Result.Error</code> if the error message is not null.</p>\n\n<p>Now lets make our <code>ComposableFruitRule</code> composable:</p>\n\n<pre><code>infix fun ComposableFruitRule.composeRules(f: FruitRule): ComposableFruitRule {\n    return { result: Result&lt;String, Fruit&gt; -&gt;\n        val temporaryResult = this(result)\n\n        if(temporaryResult is Result.Ok&lt;Fruit&gt;) {\n            createComposableRule(f)(temporaryResult)\n        } else {\n            temporaryResult\n        }\n    }\n}\n</code></pre>\n\n<p>This infix-function composes a <code>ComposableFruitRule</code> together with a <code>FruitRule</code>, that means first the internal <code>FruitRule</code> is invoked. If there is no error, the <code>FruitRule</code> provided as a parameter is invoked.</p>\n\n<p>So now we are able to compose <code>FruitRules</code> together and afterward just provide a <code>Fruit</code> and check the rules.</p>\n\n<pre><code>fun colorIsRed(fruit: Fruit): String? {\n    return if(fruit.color == \"red\")\n        null\n    else\n        \"Color is not red\"\n}\n\nfun notTooHeavy(fruit: Fruit): String? {\n    return if(fruit.weight &lt; 500)\n        null\n    else\n        \"Fruit too heavy\"\n}\n\nfun main(args: Array&lt;String&gt;) {\n    val ruleChecker = createComposableRule(::colorIsRed) composeRules ::notTooHeavy\n    //We can compose as many rules as we want\n    //e.g. ruleChecker composeRules ::fruitTooOld composeRules ::fruitNotTooLight\n\n    val fruit1 = Fruit(\"blue\", 300)\n    val result1 = ruleChecker(Result.Ok(fruit1))\n    println(result1)\n\n    val fruit2 = Fruit(\"red\", 700)\n    val result2 = ruleChecker(Result.Ok(fruit2))\n    println(result2)\n\n    val fruit3 = Fruit(\"red\", 350)\n    val result3 = ruleChecker(Result.Ok(fruit3))\n    println(result3)\n}\n</code></pre>\n\n<p>The Output of that <code>main</code> is:</p>\n\n<pre><code>Error(e=Color is not red)\nError(e=Fruit too heavy)\nOk(o=Fruit@65b54208)\n</code></pre>\n"}], "owner": {"reputation": 3161, "user_id": 812272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/81e24cd679d414d554df2bde26658fd4?s=128&d=identicon&r=PG", "display_name": "user3001", "link": "https://stackoverflow.com/users/812272/user3001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 819, "favorite_count": 0, "accepted_answer_id": 46553945, "answer_count": 6, "score": 7, "last_activity_date": 1507548744, "creation_date": 1507060279, "question_id": 46552329, "link": "https://stackoverflow.com/questions/46552329/functional-programming-how-to-carry-on-the-context-for-a-chain-of-validation-ru", "title": "Functional programming: How to carry on the context for a chain of validation rules", "body": "<p>I have a set of functions (rules) for validation which take a context as parameter and either return \"Okay\" or an \"Error\" with a message. Basically these could return a <code>Maybe</code> (Haskell) / <code>Optional</code> (Java) type.</p>\n\n<p>In the following I would like to validate properties of a <code>Fruit</code> (the context) and return an error message if the validation failed, otherwise \"Okay\"/Nothing.</p>\n\n<p>Note:\nI would prefer a solution that is purely functional style and stateless/immutable. It is a bit of a Kata, actually.</p>\n\n<p>For my experiments I used Kotlin, but the core problem also applies to any language that supports higher order functions (such as Java and Haskell).\nYou can find a <a href=\"https://try.kotlinlang.org/#/UserProjects/d5hlc3nta19e3i6acgq1fqgj1g/anrp1iip26tp7bel24icf6gqq\" rel=\"noreferrer\" title=\"here\">link to the full source code here</a> and the same at the very bottom.</p>\n\n<p>Given a Fruit class with color and weight, plus some example rules:</p>\n\n<pre><code>data class Fruit(val color:String, val weight:Int)\n\nfun theFruitIsRed(fruit: Fruit) : Optional&lt;String&gt; =\n        if (fruit.color == \"red\") Optional.empty() else Optional.of(\"Fruit not red\")\nfun fruitNotTooHeavy(fruit: Fruit) : Optional&lt;String&gt; =\n            if (fruit.weight &lt; 500) Optional.empty() else Optional.of(\"Too heavy\")\n</code></pre>\n\n<p>Now I would like to chain the rule evaluation using a reference to the respective <em>function</em>, without specifying the context as an argument using a <code>FruitRuleProcessor</code>.\nWhen processing a rule fails, it should not evaluate any of the other rules.</p>\n\n<p>For Example:</p>\n\n<pre><code>fun checkRules(fruit:Fruit) {\n  var res = FruitRuleProcessor(fruit).check(::theFruitIsNotRed).check(::notAnApple).getResult()\n  if (!res.isEmpty()) println(res.get())\n}\n\ndef main(args:Array&lt;String) { \n  // \"Fruit not red\": The fruit has the wrong color and the weight check is thus skipped\n  checkRules(Fruit(\"green\",\"200\"))\n  //  Prints \"Fruit too heavy\": Color is correct, checked weight (too heavy)\n  checkRules(Fruit(\"red\",\"1000\")) \n }\n</code></pre>\n\n<p>I do not care where it failed, only about the result. Also when a function returns an error, the others should not be processed.\nAgain, this pretty much sounds like an <code>Optional</code> Monad.</p>\n\n<p>Now the problem is that somehow I have to carry the <code>fruit</code> context from <code>check</code> to <code>check</code> call.</p>\n\n<p>One solution I tried is to implement a <code>Result</code> class that takes a context as value and has two subclasses <code>RuleError(context:Fruit, message:String)</code> and <code>Okay(context)</code>. The difference to <code>Optional</code> is that now I can wrap around the <code>Fruit</code> context (think <code>T = Fruit</code>)</p>\n\n<pre><code>// T: Type of the context. I tried to generify this a bit.\nsealed class Result&lt;T&gt;(private val context:T) {\n\n    fun isError () = this is RuleError\n\n    fun isOkay() = this is Okay\n\n    // bind\n    infix fun check(f: (T) -&gt; Result&lt;T&gt;) : Result&lt;T&gt; {\n        return if (isError()) this else f(context)\n    }\n\n    class RuleError&lt;T&gt;(context: T, val message: String) : Result&lt;T&gt;(context)\n\n    class Okay&lt;T&gt;(context: T) : Result&lt;T&gt;(context)\n}\n</code></pre>\n\n<p>I think that this looks like a monoid/Monad, with <code>return</code> in the constructor lifting a <code>Fruit</code> into a <code>Result</code> and <code>or</code> being the <code>bind</code>. Although I tried some Scala and Haskell, admittedly I am not so experienced with that.</p>\n\n<p>Now we can change the rules to</p>\n\n<pre><code>fun theFruitIsNotTooHeavy(fruit: Fruit) : Result&lt;Fruit&gt; =\n    if (fruit.weight &lt; 500) Result.Okay(fruit) else Result.RuleError(fruit, \"Too heavy\")\n\nfun theFruitIsRed(fruit: Fruit) : Result&lt;Fruit&gt; =\n    if (fruit.color == \"red\") Result.Okay(fruit) else Result.RuleError(fruit, \"Fruit not red\")\n</code></pre>\n\n<p>which allows to chain checks like intended:</p>\n\n<pre><code>fun checkRules(fruit:Fruit) {\n    val res = Result.Okay(fruit).check(::theFruitIsRed).check(::theFruitIsNotTooHeavy)\n    if (res.isError()) println((res as Result.RuleError).message)\n}\n</code></pre>\n\n<p>// Prints:\nFruit not red\nToo heavy</p>\n\n<p>However this has one major drawback: The <code>Fruit</code> context now becomes part of the validation result, although it is not strictly necessary in there.</p>\n\n<p>So to wrap it up: I'm looking for a way</p>\n\n<ul>\n<li>to carry the <code>fruit</code> context when invoking the functions </li>\n<li>so that I can chain (basically: compose) multiple checks in a row using the the same method</li>\n<li>along with the results of the rule functions <em>without changing the interface</em> of these.</li>\n<li>without side-effects</li>\n</ul>\n\n<p>What functional programming patterns could solve this problem? Is it Monads as my gut feeling tries to tell me that?</p>\n\n<p>I would prefer a solution that can be done in Kotlin or Java 8 (for bonus points), but answers in other languages (e.g. Scala or Haskell) also could be helpful. (It's about the concept, not the language :) )</p>\n\n<p>You can find the full source code from this question in <a href=\"https://try.kotlinlang.org/#/UserProjects/d5hlc3nta19e3i6acgq1fqgj1g/anrp1iip26tp7bel24icf6gqq\" rel=\"noreferrer\" title=\"this fiddle\">this fiddle</a>.</p>\n"}, {"tags": ["haskell", "tree-traversal"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1507059358, "post_id": 46552050, "comment_id": 80058606, "body": "<code>preorder (Blatt x) = [x]</code>"}, {"owner": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1507059505, "post_id": 46552050, "comment_id": 80058693, "body": "thank you, now it says something like: Equations for `preorder&#39; have different numbers of Arguments, how can I avoid this?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1507059632, "post_id": 46552050, "comment_id": 80058762, "body": "No it doesn&#39;t. Not if you have the code you pasted above and replace the problematic base case."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1507059814, "post_id": 46552050, "comment_id": 80058873, "body": "on a side note - get in the habit of adding a type signature to your top level functions sthg like <code>preorder :: Baum a -&gt; [a]</code> - note that your implementation right now does not use any ordering - so the signature might change to sthg. like <code>preorder :: (Ord a) =&gt; Baum a -&gt; [a]</code>"}, {"owner": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "edited": false, "score": 0, "creation_date": 1507059947, "post_id": 46552050, "comment_id": 80058951, "body": "thank you :)) Now i don&#180;t get the right answer, I get something like: &#39;ABC&#39;, but I have to get: [&#39;A&#39;,&#39;B&#39;,&#39;C&#39;]"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1507060030, "post_id": 46552050, "comment_id": 80059000, "body": "<code>&quot;ABC&quot;</code> is the same as <code>[&#39;A&#39;,&#39;B&#39;,&#39;C&#39;]</code> as <code>type String = [Char]</code>."}, {"owner": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "edited": false, "score": 0, "creation_date": 1507060211, "post_id": 46552050, "comment_id": 80059094, "body": "you are right, I have to define it before when I want a [Char], am I right?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1507062294, "post_id": 46552050, "comment_id": 80060115, "body": "no you don&#39;t have to define that - it is already implemented like that. The only special about <code>String</code> is that when you <code>show</code> a <code>String</code> you get the usual representation of a <code>String</code> instead of the &quot;listy&quot; one you are looking for."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1507064261, "post_id": 46552050, "comment_id": 80061007, "body": "@Tikotakatok Try typing <code>[&#39;A&#39;, &#39;B&#39;, &#39;C&#39;]</code> into ghci (or your preferred interpreter). What does it print? Does this surprise you? Why or why not?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1507067668, "post_id": 46552050, "comment_id": 80062378, "body": "Also note that you cannot represent an empty tree using this definition. Typical tree definitions should be able to be empty, so generally this means you should rethink your type."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1507072828, "post_id": 46552050, "comment_id": 80063787, "body": "@epsilonhalbe, why would you need <code>Ord</code> to perform a preorder traversal? That seems very strange."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1507098204, "post_id": 46552050, "comment_id": 80070276, "body": "@dfeuer you are completely right."}], "owner": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507059135, "creation_date": 1507059135, "question_id": 46552050, "link": "https://stackoverflow.com/questions/46552050/implementation-of-tree-traversal-pre-order", "title": "Implementation of tree-traversal: pre-order", "body": "<p>I have to implement a pre-order tree traversation: \nThe result of (Knoten 'A'(Blatt 'B')(Blatt 'C')) have to be ['A','B','C']</p>\n\n<p>This is my Code but there was a mistake I am not able to find:</p>\n\n<pre><code>data Baum a = Blatt a | Knoten a \n                           (Baum a)\n                           (Baum a)\n\npreorder (Blatt () ) = []\npreorder (Knoten a l r) = [a] ++ preorder l ++ preorder r\n</code></pre>\n"}, {"tags": ["haskell", "persistent", "esqueleto"], "answers": [{"comments": [{"owner": {"reputation": 2332, "user_id": 615030, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Yd1uW.png?s=128&g=1", "display_name": "Artyom", "link": "https://stackoverflow.com/users/615030/artyom"}, "edited": false, "score": 0, "creation_date": 1507070998, "post_id": 46552681, "comment_id": 80063346, "body": "Sure, it solves the problem for one particular table (<code>Entry</code>), but I want a solution that would work for any table. I.e. I need <code>updateById :: Key a -&gt; _ -&gt; _</code>, while your function is <code>updateById :: Key Entry -&gt; _ -&gt; _</code>."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 0, "last_activity_date": 1507061628, "creation_date": 1507061628, "answer_id": 46552681, "question_id": 46551936, "link": "https://stackoverflow.com/questions/46551936/update-a-row-with-specific-id-in-esqueleto/46552681#46552681", "title": "Update a row with specific ID in Esqueleto", "body": "<p>I am definitely no expert on esqueleto, but I would guess:</p>\n\n<pre><code>updateById entryId upd = update $ \\entry -&gt; do\n                           upd entry\n                           where_ (entry ^. EntryId ==. val entryId)\n</code></pre>\n\n<p>should solve the problem.</p>\n"}, {"tags": [], "owner": {"reputation": 2332, "user_id": 615030, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Yd1uW.png?s=128&g=1", "display_name": "Artyom", "link": "https://stackoverflow.com/users/615030/artyom"}, "is_accepted": true, "score": 0, "last_activity_date": 1509914347, "creation_date": 1509914347, "answer_id": 47126390, "question_id": 46551936, "link": "https://stackoverflow.com/questions/46551936/update-a-row-with-specific-id-in-esqueleto/47126390#47126390", "title": "Update a row with specific ID in Esqueleto", "body": "<p>For any <code>Entity</code>, <code>^. EntityId</code> can be written as <code>^. persistIdField</code> (the <code>persistIdField</code> field is a method of the <code>PersistEntity</code> class). Thus, your function can be written like this:</p>\n\n<pre><code>updateById\n  :: (E.PersistEntityBackend val ~ E.SqlBackend,\n      MonadIO m, E.PersistEntity val)\n  =&gt; Key val\n  -&gt; (E.SqlExpr (E.Entity val) -&gt; E.SqlQuery a)\n  -&gt; E.SqlWriteT m ()\nupdateById entryId upd = E.update $ \\entry -&gt; do\n  upd entry\n  E.where_ (entry E.^. E.persistIdField ==. E.val entryId)\n</code></pre>\n"}], "owner": {"reputation": 2332, "user_id": 615030, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Yd1uW.png?s=128&g=1", "display_name": "Artyom", "link": "https://stackoverflow.com/users/615030/artyom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 47126390, "answer_count": 2, "score": 1, "last_activity_date": 1509914347, "creation_date": 1507058720, "question_id": 46551936, "link": "https://stackoverflow.com/questions/46551936/update-a-row-with-specific-id-in-esqueleto", "title": "Update a row with specific ID in Esqueleto", "body": "<p>I can change a field of a row with <code>entryId</code> in Esqueleto like this:</p>\n\n<pre><code>  update $ \\entry -&gt; do\n    set entry [ EntryFoo =. val bar ]\n    where_ (entry ^. EntryId ==. val entryId)\n</code></pre>\n\n<p>However, writing it all the time gets annoying. I'd like to be able to write something like this:</p>\n\n<pre><code>  updateById entryId $ \\entry -&gt;\n    set entry [ EntryFoo =. val bar ]\n</code></pre>\n\n<p>I tried to write this helper by myself, but found that I don't know how to write <code>^. EntryId</code> in a generic way (i.e. a way that would work for any entry types). Is it possible? Or am I missing something and <code>updateById</code> already exists in Esqueleto?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1507058011, "post_id": 46551663, "comment_id": 80057969, "body": "A question for a question: what is <code>Ord</code>? Presumably it is defined somewhere in your assignment, and you should include its definition here."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 2, "creation_date": 1507058548, "post_id": 46551663, "comment_id": 80058188, "body": "Are you sure it is <code>Ord</code> not something like maybe <code>Ord a =&gt; (a,a) -&gt; Bool</code>?"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1507059257, "post_id": 46551663, "comment_id": 80058555, "body": "Instead of <code>foldl</code> one could use <code>foldr1 (\\s1 s2 -&gt; bool s2 s1 (length s1 &lt; length s2))</code> though."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1507068931, "post_id": 46551663, "comment_id": 80062787, "body": "Given the updated question, here is a hint. You write <code>if length x &lt; length shortest then ... else ...</code>. What type does <code>(&lt;)</code> have? Do you recognize that type from anywhere?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8716028, "user_type": "registered", "profile_image": "https://graph.facebook.com/630074677180624/picture?type=large", "display_name": "Chenchen Mao", "link": "https://stackoverflow.com/users/8716028/chenchen-mao"}, "edited": false, "score": 0, "creation_date": 1507061253, "post_id": 46552046, "comment_id": 80059569, "body": "I edited the question. Sorry for making you confused."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 3, "user_id": 8716028, "user_type": "registered", "profile_image": "https://graph.facebook.com/630074677180624/picture?type=large", "display_name": "Chenchen Mao", "link": "https://stackoverflow.com/users/8716028/chenchen-mao"}, "edited": false, "score": 0, "creation_date": 1507061413, "post_id": 46552046, "comment_id": 80059651, "body": "That makes more sense.  In context, I would guess that you\u2019ve got something that wraps <code>(length string1, length string2)</code> and passes it to the helper function as a single argument."}], "tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": true, "score": 0, "last_activity_date": 1507061971, "last_edit_date": 1507061971, "creation_date": 1507059124, "answer_id": 46552046, "question_id": 46551663, "link": "https://stackoverflow.com/questions/46551663/what-does-ord-ord-bool-string-string-mean-in-haskell/46552046#46552046", "title": "what does ((Ord, Ord) -&gt; Bool) -&gt; [String] -&gt; String mean in haskell", "body": "<p><code>Ord</code> means something incompatible with that in the <code>Prelude</code>, but ordinarily the type signature you give would be a function with two arguments.  </p>\n\n<p>The first argument has type <code>(Ord, Ord) -&gt; Bool</code>, a function that takes a pair of <code>Ord</code> and returns a <code>Bool</code>.  In context, this might be intended as a generalized comparison function, such as one that compares the lengths of two strings expressed as whatever an <code>Ord</code> is here.  This is unusual, because you would expect something like that to be written like <code>isShorter :: String -&gt; String -&gt; Bool</code>, or maybe <code>isShorter :: [a] -&gt; [a] -&gt; Bool</code>.</p>\n\n<p>The second argument has type <code>[String]</code>, a list of <code>String</code> objects.  The function returns a single <code>String</code>.</p>\n\n<p>However, you haven\u2019t given us enough information to understand what\u2019s going on in this specific assignment.</p>\n\n<p><strong>Edit:</strong> You\u2019ve updated your question so that the type of the first argument is <code>(Int, Int) -&gt; Bool</code> rather than <code>(Ord, Ord) -&gt; Bool</code>, which makes more sense.  This might be a way to wrap a comparison on two arguments, such as the lengths of two strings, for a higher-order function that expects one argument.</p>\n"}], "owner": {"reputation": 3, "user_id": 8716028, "user_type": "registered", "profile_image": "https://graph.facebook.com/630074677180624/picture?type=large", "display_name": "Chenchen Mao", "link": "https://stackoverflow.com/users/8716028/chenchen-mao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 46552046, "answer_count": 1, "score": -2, "last_activity_date": 1507061971, "creation_date": 1507057448, "last_edit_date": 1507061227, "question_id": 46551663, "link": "https://stackoverflow.com/questions/46551663/what-does-ord-ord-bool-string-string-mean-in-haskell", "title": "what does ((Ord, Ord) -&gt; Bool) -&gt; [String] -&gt; String mean in haskell", "body": "<p>I changed this question to make it more clear. shortestStringHelper has type (Int -> Int -> Bool) -> [String] -> String. Note the String may appear as [Char] instead depending on how Haskell feels at the time. This function will look a lot like shortestString and shortestString' but it is more general because it takes a function as an argument (Int -> Int -> Bool). Note: Depending on how you write it, you may get (Int -> Int -> Bool) -> [[a]] -> [a], which is also ok.\nI know how to write the find the shortest string  </p>\n\n<pre><code>shortestString :: [String] -&gt; String\nshortestString  lst = if null lst then \"\" else foldl (\\shortest x -&gt; if length x &lt; length shortest then x else shortest) (head lst) lst\n\nshortestString' :: [String] -&gt; String\nshortestString'  lst = if null lst then \"\" else foldl (\\shortest x -&gt; if length x &lt;= length shortest then x else shortest) (head lst) lst\n</code></pre>\n\n<p>and they work, but I am not sure if I understand this question, and I don't know what does <code>((Ord, Ord) -&gt; Bool)</code> means.</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1507053720, "post_id": 46550689, "comment_id": 80055772, "body": "You should write <code>instance Monad EmptyMonad where</code> (without <code>a</code>)."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1507053769, "post_id": 46550689, "comment_id": 80055792, "body": "Furthermore it should be <code>(EmptyMonad x y) &gt;&gt;= f = EmptyMonad (f x) (y + 1)</code>. (with <code>f</code>), otherwise the types do not match."}, {"owner": {"reputation": 611, "user_id": 3624987, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/483470d4c66ef7a2820e96dc8d6d4172?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/3624987/user1"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1507053907, "post_id": 46550689, "comment_id": 80055861, "body": "I get this error if I follow your suggestion, no idea.  Couldn&#39;t match type \u2018b\u2019 with \u2018EmptyMonad b\u2019       \u2018b\u2019 is a rigid type variable bound by         the type signature for:           (&gt;&gt;=) :: forall a b.                    EmptyMonad a -&gt; (a -&gt; EmptyMonad b) -&gt; EmptyMonad b         at EmptyMonad.hs:18:20"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1507053929, "post_id": 46550689, "comment_id": 80055870, "body": "what if you follow the second suggestion as well?"}, {"owner": {"reputation": 611, "user_id": 3624987, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/483470d4c66ef7a2820e96dc8d6d4172?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/3624987/user1"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1507054045, "post_id": 46550689, "comment_id": 80055936, "body": "I applied both of the suggestions."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 1, "creation_date": 1507056185, "post_id": 46550689, "comment_id": 80057058, "body": "I would advise you to read <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses#kinds-and-some-type-foo\" rel=\"nofollow noreferrer\"><b>Kinds and some type-foo</b></a> and <a href=\"http://learnyouahaskell.com/for-a-few-monads-more#making-monads\" rel=\"nofollow noreferrer\"><b>Making monads</b></a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 5, "creation_date": 1507057294, "post_id": 46550689, "comment_id": 80057589, "body": "As a complete aside to your problems understanding and using Haskell syntax, you are also going to have a semantic problem. Counting binds is not okay in monads; it violates the &quot;<code>return</code> is an identity&quot; law saying that <code>return x &gt;&gt;= f = f x</code>, since there are fewer binds on the right-hand side of the equation. (It seems to be everybody&#39;s first idea for a new monad, though, including mine!)"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1507062331, "post_id": 46550689, "comment_id": 80060135, "body": "See <a href=\"https://stackoverflow.com/questions/4765260/seeking-constructive-criticism-on-monad-implementation\">this question</a> which asks about a &quot;counter monad&quot; also."}], "answers": [{"comments": [{"owner": {"reputation": 611, "user_id": 3624987, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/483470d4c66ef7a2820e96dc8d6d4172?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/3624987/user1"}, "edited": false, "score": 0, "creation_date": 1507055911, "post_id": 46550871, "comment_id": 80056907, "body": "Why can&#39;t I use <code>EmptyMonad fx (y+1)</code> instead of <code>fx {myState = y+1}</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 611, "user_id": 3624987, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/483470d4c66ef7a2820e96dc8d6d4172?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/3624987/user1"}, "edited": false, "score": 2, "creation_date": 1507058664, "post_id": 46550871, "comment_id": 80058265, "body": "@user1 Because <code>fx</code> is an <code>EmptyMonad b</code>, not a <code>b</code>. So <code>EmptyMonad fx (y+1)</code> would be an <code>EmptyMonad (EmptyMonad b)</code> -- a nested monadic value!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 1, "last_activity_date": 1507058377, "last_edit_date": 1507058377, "creation_date": 1507054308, "answer_id": 46550871, "question_id": 46550689, "link": "https://stackoverflow.com/questions/46550689/making-haskell-monads/46550871#46550871", "title": "Making Haskell Monads", "body": "<p>There are two main problems here:</p>\n\n<ul>\n<li>the instance declaration does <em>expect</em> a type of <em>kind</em> <code>* -&gt; *</code>. So for instance <code>[]</code>, <em>not</em> <code>[a]</code>; and</li>\n<li>the bind operator <code>&gt;&gt;=</code> expect an <code>EmptyMonad a</code>, and a function <code>a -&gt; EmptyMonad b</code> and returns an <code>EmptyMonad b</code> element.</li>\n</ul>\n\n<p>So we can fix the problems with the following solution:</p>\n\n<pre><code>instance Monad EmptyMonad where  -- no a after EmptyMonad\n  return x = EmptyMonad x 0\n  (EmptyMonad x y) &gt;&gt;= f = fx {myState = y+1}\n      where fx = f x\n</code></pre>\n\n<p>So here we specify <code>instance Monad EmptyMonad</code> since <code>EmptyMonad</code> has kind <code>* -&gt; *</code>. Furthermore the bind operator will calculate <code>f x</code> and then alter the <code>myState</code> of that instance with <code>y+1</code>.</p>\n\n<p>That being said, nowadays you need to make <code>EmptyMonad</code> an instance of <code>Applicative</code> and <code>Functor</code> as well.</p>\n"}], "owner": {"reputation": 611, "user_id": 3624987, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/483470d4c66ef7a2820e96dc8d6d4172?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/3624987/user1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 46550871, "answer_count": 1, "score": 0, "last_activity_date": 1507058377, "creation_date": 1507053662, "question_id": 46550689, "link": "https://stackoverflow.com/questions/46550689/making-haskell-monads", "title": "Making Haskell Monads", "body": "<p>I'm trying to create a very simple monad in Haskell.\nThe monad does nothing special but holding a counter as state.</p>\n\n<pre><code>module EmptyMonad\n  ( EmptyMonad\n  ) where\n\nimport Control.Monad\n\ndata EmptyMonad a = EmptyMonad\n  { myValue :: a\n  , myState :: Int\n  } deriving (Show)\n\ninstance (Eq a) =&gt; Eq (EmptyMonad a) where\n  EmptyMonad x1 y1 == EmptyMonad x2 y2 = x1 == x2 &amp;&amp; y1 == y2\n\n\ninstance Monad (EmptyMonad a) where\n  return x = EmptyMonad x 0\n  (EmptyMonad x y) &gt;&gt;= f = EmptyMonad x (y + 1)\n</code></pre>\n\n<p>After spending few hours on Monads, I cannot get my head around the error from the compiler:</p>\n\n<pre><code>EmptyMonad.hs:16:10: error:\n    \u2022 Expecting one fewer argument to \u2018Monad EmptyMonad\u2019\n      Expected kind \u2018k0 -&gt; Constraint\u2019,\n        but \u2018Monad EmptyMonad\u2019 has kind \u2018Constraint\u2019\n    \u2022 In the instance declaration for \u2018Monad EmptyMonad a\u2019\nFailed, modules loaded: none.\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack", "servant"], "comments": [{"owner": {"reputation": 6415, "user_id": 1416525, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6f23f148b7241e345a61d193ed205685?s=128&d=identicon&r=PG", "display_name": "cdk", "link": "https://stackoverflow.com/users/1416525/cdk"}, "edited": false, "score": 0, "creation_date": 1507052574, "post_id": 46550071, "comment_id": 80055186, "body": "The issue comes from the last line <code>do print $ bittrex</code> (which should just be <code>print bittrex</code>). You&#39;re trying to print the client generated by Servant (exactly what the error message is telling you), when I think you meant to print the api response <code>test :: Bittrex</code>."}, {"owner": {"reputation": 1, "user_id": 2568473, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f3fc043452d967f7500e52c0942399d2?s=128&d=identicon&r=PG", "display_name": "Jim", "link": "https://stackoverflow.com/users/2568473/jim"}, "reply_to_user": {"reputation": 6415, "user_id": 1416525, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6f23f148b7241e345a61d193ed205685?s=128&d=identicon&r=PG", "display_name": "cdk", "link": "https://stackoverflow.com/users/1416525/cdk"}, "edited": false, "score": 0, "creation_date": 1507054819, "post_id": 46550071, "comment_id": 80056328, "body": "Thank you, I had another data type (data Test = ...) that I removed from the code before putting it here. This confused me. Thank you for responding!"}], "owner": {"reputation": 1, "user_id": 2568473, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f3fc043452d967f7500e52c0942399d2?s=128&d=identicon&r=PG", "display_name": "Jim", "link": "https://stackoverflow.com/users/2568473/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507051124, "creation_date": 1507051124, "question_id": 46550071, "link": "https://stackoverflow.com/questions/46550071/servant-client-query", "title": "Servant Client Query", "body": "<p>I am getting this error: </p>\n\n<pre><code>No instance for (Show (ClientM Bittrex)) arising from a use of \u2018print\n</code></pre>\n\n<p>While building the following code:</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE TypeOperators #-}\n\nmodule Main where\n\nimport Data.Aeson\nimport Data.Proxy\nimport GHC.Generics\nimport Network.HTTP.Client (newManager, defaultManagerSettings)\nimport Servant.API\nimport Servant.Client\n\ndata Bittrex = Bittrex\n  { success :: Bool,\n    message :: String,\n    result :: Inner\n  } deriving (Generic, Show)\n\ninstance FromJSON Bittrex\ninstance ToJSON Bittrex\n\ndata Inner = Inner\n  { bid :: Float,\n    ask :: Float,\n    last :: Float\n  } deriving (Generic, Show)\n\ninstance FromJSON Inner\ninstance ToJSON Inner\n\n--------------------------------------------------------------------------------\n\n-- https://bittrex.com/api/v1.1/public/getticker?market=BTC-LTC\n\ntype BittrexAPI = \"api\" :&gt; \"v1.1\" :&gt; \"public\" :&gt; \"getticker?market=BTC-LTC\" :&gt; Get '[JSON] Bittrex\n\n-----------------------------------------------------------------------------\nbittrexAPI :: Proxy BittrexAPI\nbittrexAPI = Proxy\n\nbittrex = client bittrexAPI\n\nmain :: IO ()\nmain = do\n  manager &lt;- newManager defaultManagerSettings\n  res &lt;- runClientM bittrex (ClientEnv manager (BaseUrl Http \"bittrex.com\" 80 \"\"))\n  case res of\n    Left err -&gt; putStrLn $ \"Error: \" ++ show err\n    Right test -&gt; do\n        print $ bittrex\n</code></pre>\n\n<p>I know the problem is coming from the fact that I have a JSON response with embedded JSON. I'm not sure how to rectify this or more importantly why this is happening. The request link is <code>https://bittrex.com/api/v1.1/public/getticker?market=BTC-LTC</code></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1507087870, "post_id": 46549947, "comment_id": 80067022, "body": "If we look at <code>(+) 1</code>, we have a result with the type of a function. But as a whole, <code>(+) 1 1</code> is a number. Why?"}], "answers": [{"tags": [], "owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "is_accepted": true, "score": 5, "last_activity_date": 1507052741, "last_edit_date": 1507052741, "creation_date": 1507050965, "answer_id": 46550027, "question_id": 46549947, "link": "https://stackoverflow.com/questions/46549947/const-function-of-const-function-in-haskell/46550027#46550027", "title": "const function of const function in haskell", "body": "<p>It evaluates to 5 because <code>const</code> throws away its second argument, and just evaluates to its first. The first argument is 5, so that's what it evaluates to. </p>\n\n<blockquote>\n  <p>Because if we look at the first part, namely the \"const 5\", we would have a result with the type of a function.</p>\n</blockquote>\n\n<p>But that's not all the code, and only looking at the \"first part\" changes the meaning.</p>\n\n<p>If you wrote only:</p>\n\n<pre><code>a = const 5\n</code></pre>\n\n<p>Then <code>a</code> <em>would</em> be a function since you're only partially applying <code>const</code>. In reality though, you're passing <code>const</code> as the second argument to <code>const</code>, fully applying the function, and allowing it to evaluate. </p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1507051028, "creation_date": 1507051028, "answer_id": 46550041, "question_id": 46549947, "link": "https://stackoverflow.com/questions/46549947/const-function-of-const-function-in-haskell/46550041#46550041", "title": "const function of const function in haskell", "body": "<p>You define:</p>\n\n<pre><code>const a x = a\n</code></pre>\n\n<p>this is short for:</p>\n\n<pre><code>const = (\\a -&gt; (\\x -&gt; a))\n</code></pre>\n\n<p>So a function (with one argument <code>a</code>) that results in a function (again with one argument <code>x</code>) that maps to <code>a</code>.</p>\n\n<p>Now if we thus write:</p>\n\n<pre><code>const 5 const\n</code></pre>\n\n<p>we have written implicitly:</p>\n\n<pre><code>(const 5) const\n</code></pre>\n\n<p>If we work out the first <code>const</code>, we see:</p>\n\n<pre><code>   ((\\a -&gt; (\\x -&gt; a)) 5) const\n-&gt; (\\x -&gt; 5) const\n-&gt; 5\n</code></pre>\n\n<p>So your defintion of <code>const</code> simply <em>ignores</em> the second argument. Regardless of what it is (a function, a number, a character, etc.), it will return the first argument (here <code>5</code>), and <code>5</code> has type <code>Num a =&gt; a</code> (it can by any <em>number</em> type).</p>\n\n<p>In case you would have written <code>const 5</code> however, you would obtain:</p>\n\n<pre><code>   const 5\n-&gt; (\\a -&gt; (\\x -&gt; a)) 5\n-&gt; (\\x -&gt; 5)\n</code></pre>\n\n<p>which is a function that takes any type of input <code>x</code>, and maps it on a number <code>5</code>.</p>\n"}], "owner": {"reputation": 23, "user_id": 8715509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d803a8b984ad971157dac86c09ff0f08?s=128&d=identicon&r=PG&f=1", "display_name": "OhBoi", "link": "https://stackoverflow.com/users/8715509/ohboi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "accepted_answer_id": 46550027, "answer_count": 2, "score": 2, "last_activity_date": 1507052741, "creation_date": 1507050614, "question_id": 46549947, "link": "https://stackoverflow.com/questions/46549947/const-function-of-const-function-in-haskell", "title": "const function of const function in haskell", "body": "<p>We have defined the following :</p>\n\n<pre><code>const a x = a\n</code></pre>\n\n<p>Now my question :\nWhy does the defined \"variable\" <strong>a</strong> in the following example evaluate as a <strong>number</strong> with the value 5 ?</p>\n\n<pre><code>a = const 5 const\n</code></pre>\n\n<p>Because if we look at the first part, namely the \"const 5\", we would have a result with the type of a function. But as a whole, the result is a number. Why ?</p>\n"}, {"tags": ["haskell", "compiler-errors"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1507041815, "post_id": 46547208, "comment_id": 80048760, "body": "A program requires an entry point: a monadic function called <code>main</code>."}, {"owner": {"reputation": 4880, "user_id": 2412895, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/p3J02.jpg?s=128&g=1", "display_name": "KarelG", "link": "https://stackoverflow.com/users/2412895/karelg"}, "edited": false, "score": 1, "creation_date": 1507041861, "post_id": 46547208, "comment_id": 80048789, "body": "What you wrote is not really correct. The code isn&#39;t complete (I miss <code>main</code>). Also, please check <a href=\"http://learnyouahaskell.com/syntax-in-functions#let-it-be\" rel=\"nofollow noreferrer\"><i>let it be</i></a>. I suggest to read that book from start."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1507043635, "post_id": 46547803, "comment_id": 80049962, "body": "There&#39;s no need to use <code>show</code> within <code>print</code>: that is already polymorphic on the input type."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1507045299, "post_id": 46547803, "comment_id": 80051024, "body": "<code>print x = putStrLn (show x)</code>, so your code calls <code>show</code> twice."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1507045439, "post_id": 46547803, "comment_id": 80051113, "body": "@leftaroundabout, indeed. <code>print</code> probably shouldn&#39;t even be in the prelude, since it becomes the wrong function as soon as you want to piece together output from multiple values, or add newlines, or whatever. <code>print = putStrLn . show</code>, <code>readLn = readIO =&lt;&lt; getLine</code>, and neither of these convenience functions seems worth the didactic overhead."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1507045859, "post_id": 46547803, "comment_id": 80051395, "body": "@dfeuer I find <code>print</code> too handy to agree with that. In fact I&#39;d be more inclined to say <code>Show</code> and <code>Read</code> shouldn&#39;t be in the prelude. (One should very seldom feel the need to convert anything to/from string, <i>except</i> for the purpose of doing IO with those strings.)"}, {"owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 0, "creation_date": 1507062741, "post_id": 46547803, "comment_id": 80060333, "body": "Thanks, edited the answer and replaced the <code>print</code> with <code>putStrLn</code>."}], "tags": [], "owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "is_accepted": false, "score": 7, "last_activity_date": 1606841690, "last_edit_date": 1606841690, "creation_date": 1507043235, "answer_id": 46547803, "question_id": 46547208, "link": "https://stackoverflow.com/questions/46547208/why-is-my-haskell-code-saying-variable-not-in-scope-main/46547803#46547803", "title": "Why is my Haskell code saying &#39;variable not in scope: main&#39;?", "body": "<p>If you compile a Haskell source there needs to be a <code>main</code> symbol as entry point, just like when compiling e.g. a C program. Also in a compiled file you must skip the <code>let</code>s. E.g.</p>\n<pre><code>squareMe x = x * x\n\nmain = putStrLn . show $ squareMe 4\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 24, "last_activity_date": 1507058051, "last_edit_date": 1507058051, "creation_date": 1507045289, "answer_id": 46548486, "question_id": 46547208, "link": "https://stackoverflow.com/questions/46547208/why-is-my-haskell-code-saying-variable-not-in-scope-main/46548486#46548486", "title": "Why is my Haskell code saying &#39;variable not in scope: main&#39;?", "body": "<p>The Haskell REPL (GHCi) and actual Haskell programs are considerably different.</p>\n\n<p>The reasons for this difference is the goal of the two formats. Firstly, GHCi is a testing area, not a code-running area. However, Haskell source files are meant to run a certain process, which is named <code>main</code>. When you run a source file, the Haskell compiler (usually GHC) looks for the <code>IO</code> action called <code>main</code>, and tries to run it. In this case, there was no <code>main</code>, so it failed.</p>\n\n<p>Secondly, what you typed is not a valid Haskell program, those are declarations that would be fine in GHCi, but not in Haskell source. This would be correct in a source file:</p>\n\n<pre><code>squareMe x = x * x\n\nmyFruit = [\"banana\", \"apple\", \"kiwi\", \"orange\"]\n</code></pre>\n\n<p>Note the lack of <code>let</code>; Haskell source files don't use it to declare things.</p>\n\n<p>Note that on repl.it, this will still complain that <code>main</code> is missing, but you can then refer to <code>squareMe</code> and <code>myFruit</code> in the REPL without worry. In other words, the error will still appear, but it doesn't matter, because you can use whatever you wrote in the file nonetheless.</p>\n\n<p>If you wanted to suppress the warning, you could write the lines:</p>\n\n<pre><code>main :: IO ()    -- This says that main is an IO action.\nmain = return () -- This tells main to do nothing.\n</code></pre>\n\n<p>There are many things you could have the program do instead of this. Here are a couple of examples:</p>\n\n<ul>\n<li><code>main = putStrLn \"No errors!\"</code> Will print <code>No errors!</code> when you run it.</li>\n<li><code>main = print myFruit</code> Will print <code>[\"banana\", \"apple\", \"kiwi\", \"orange\"]</code> when you run it.</li>\n</ul>\n\n<p>Please note that this answer applies mostly to the site repl.it specifically, though in general this is how Haskell programs are structured.</p>\n"}, {"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 0, "last_activity_date": 1507056646, "last_edit_date": 1507056646, "creation_date": 1507055945, "answer_id": 46551296, "question_id": 46547208, "link": "https://stackoverflow.com/questions/46547208/why-is-my-haskell-code-saying-variable-not-in-scope-main/46551296#46551296", "title": "Why is my Haskell code saying &#39;variable not in scope: main&#39;?", "body": "<p>If what you\u2019re writing is more like a library or a set of utility routines than a complete program, you can declare it as a <code>module</code>.  Then GHC will compile it to an object you can link to other programs, and you can also load it in GHCI.  It will not be expected to contain a <code>main</code> routine.</p>\n\n<p>If you save this to a <code>.hs</code> file:</p>\n\n<pre><code>module Example (squareMe) where\n\nsquareMe x = x * x -- Exported to other modules.\nmyFruit = [\"banana\", \"apple\", \"kiwi\", \"orange\"] -- Not exported.\n</code></pre>\n\n<p>Compiling this with GHC will give you a <code>.hi</code> file and a <code>.o</code> file, and running it in GHCI will give you this:</p>\n\n<pre><code>GHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\nOk, modules loaded: Example (sx-modulexmpl.o).\nPrelude Example&gt; squareMe 2\n4\n</code></pre>\n\n<p>You can also compute an expression that references a library from the command line.  <code>ghc -e \"squareMe 2\" Example.hs</code> prints <code>4</code>.</p>\n"}], "owner": {"reputation": 786, "user_id": 2315723, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/MC3f4.jpg?s=128&g=1", "display_name": "branty1970", "link": "https://stackoverflow.com/users/2315723/branty1970"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23452, "favorite_count": 2, "answer_count": 3, "score": 18, "last_activity_date": 1607951801, "creation_date": 1507041457, "last_edit_date": 1507220518, "question_id": 46547208, "link": "https://stackoverflow.com/questions/46547208/why-is-my-haskell-code-saying-variable-not-in-scope-main", "title": "Why is my Haskell code saying &#39;variable not in scope: main&#39;?", "body": "<p>When I type the following in the interactive shell of Haskell on the <a href=\"https://repl.it/languages/haskell\" rel=\"noreferrer\">repl.it</a> website, it works perfectly.</p>\n\n<pre><code>let squareMe x = x * x\nlet myFruit = [\"banana\", \"apple\", \"kiwi\", \"orange\"]\n</code></pre>\n\n<p>But when I type it into a source file and click 'Run' I get the error:</p>\n\n<pre><code>&lt;interactive&gt;:3:1: error:\n    \u2022 Variable not in scope: main\n    \u2022 Perhaps you meant \u2018min\u2019 (imported from Prelude)\n</code></pre>\n\n<p>I've been trying to understand this error and come up with a solution for a couple of hours now and am no nearer to finding a solution or understanding what the error means.</p>\n"}, {"tags": ["haskell", "optparse-applicative"], "answers": [{"tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": true, "score": 5, "last_activity_date": 1507054209, "last_edit_date": 1507054209, "creation_date": 1507036085, "answer_id": 46545361, "question_id": 46542992, "link": "https://stackoverflow.com/questions/46542992/how-to-use-options-with-multiple-values-with-haskells-optparse-applicative/46545361#46545361", "title": "How to use options with multiple values with Haskell&#39;s optparse-applicative", "body": "<p>I think, the problem here is with the default value. Just remove <code>value 1</code> from parser modifiers.</p>\n\n<p>From docs on <a href=\"https://www.stackage.org/haddock/lts-9.6/optparse-applicative/Options-Applicative-Builder.html#v:value\" rel=\"nofollow noreferrer\"><code>value</code></a>:</p>\n\n<blockquote>\n  <p>Note: Because this modifier means the parser will never fail, do not use it with combinators such as some or many, as these combinators continue until a failure occurs. Careless use will thus result in a hang.</p>\n</blockquote>\n"}], "owner": {"reputation": 1722, "user_id": 1593986, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8b55a5d33dee71102db716c72e166974?s=128&d=identicon&r=PG", "display_name": "vidi", "link": "https://stackoverflow.com/users/1593986/vidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 46545361, "answer_count": 1, "score": 2, "last_activity_date": 1507054209, "creation_date": 1507028296, "question_id": 46542992, "link": "https://stackoverflow.com/questions/46542992/how-to-use-options-with-multiple-values-with-haskells-optparse-applicative", "title": "How to use options with multiple values with Haskell&#39;s optparse-applicative", "body": "<p>I have the following Haskell code using optparse-applicative which hangs at runtime. </p>\n\n<pre><code>main :: IO ()\nmain = do\n  printf \"Start...\\n\"\n  args &lt;- execParser $ info args fullDesc\n  printf \"Cmdline args: %s\\n\" (show args)\n\nargs :: Parser [Integer]\nargs = many (option auto\n         (short 'x'\n           &lt;&gt; value 1))\n</code></pre>\n\n<p>The problem is related to the use of <em>many</em> combinator because once I remove it the code runs fine.</p>\n\n<p>Is this a bug or am I doing something wrong? </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "hakyll"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1507013372, "post_id": 46537168, "comment_id": 80031615, "body": "I guess you have deleted the index.html could you list the directory contents and your main.hs"}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1507014086, "post_id": 46537168, "comment_id": 80031934, "body": "I have an index.md, which appears in my root.  I&#39;m expecting      create [&quot;index.md&quot;] $ do       route (setExtension &quot;html&quot;)       compile $ pandocCompiler  to compile the index.md into index.html from the description here: <a href=\"https://jaspervdj.be/hakyll/tutorials/03-rules-routes-compilers.html\" rel=\"nofollow noreferrer\">jaspervdj.be/hakyll/tutorials/03-rules-routes-compilers.html</a>"}], "owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507013475, "creation_date": 1507004488, "last_edit_date": 1507013475, "question_id": 46537168, "link": "https://stackoverflow.com/questions/46537168/hakyll-clean-and-build-still-has-caching-error", "title": "Hakyll clean and build still has caching error", "body": "<p>I execute the following:</p>\n\n<pre><code>$ stack exec site clean\nRemoving _site...\nRemoving _cache...\nRemoving _cache/tmp...\n</code></pre>\n\n<p>And then:</p>\n\n<pre><code>$ stack exec site build\nInitialising...\n  Creating store...\n  Creating provider...\n  Running rules...\nChecking for out-of-date items\nCompiling\n  updated css/default.css\n  updated images/haskell-logo.png\n  [ERROR] Hakyll.Core.Compiler.cached: You are trying to (perhaps indirectly) use `cached` on a non-existing resource: there is no file backing index.html\n</code></pre>\n\n<p>How can I truly clean my hakyll site such that it builds?</p>\n\n<p>(More code here: <a href=\"https://stackoverflow.com/questions/46356263/whats-the-root-of-a-hakyll-site\">What&#39;s the root of a Hakyll site?</a> )</p>\n"}, {"tags": ["haskell", "category-theory"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1506995119, "post_id": 46535925, "comment_id": 80026686, "body": "Somewhat trivially, <code>Arrow cat</code> is enough for this since you can project any function into an <code>Arrow</code>. :)"}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1506996198, "post_id": 46535925, "comment_id": 80026901, "body": "I think that&#39;s the insight I needed Alec, thanks!"}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1507033030, "post_id": 46535925, "comment_id": 80042695, "body": "Actually @Alec, still even with making Category an Arrow I still can&#39;t get it to fit, but I may be missing something."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1507038112, "post_id": 46535925, "comment_id": 80046121, "body": "I think you&#39;re trying to generalise the wrong thing. You certainly can&#39;t map a <code>Functor</code> (an endofunctor on <b>Hask</b>) over an arbitrary category. In general functors can go between different categories, so I&#39;d start by modelling that (<code>class (Category d, Category c) =&gt; CFunctor d c f | f -&gt; d c where cmap :: d a b -&gt; c (f a) (f b)</code>). Monads are always endofunctors, though (<code>class CFunctor c c m =&gt; CMonad c m | m -&gt; c where { creturn :: c a (m a); cjoin :: c (m (m a)) -&gt; c (m a) }</code>). And have a read of <a href=\"https://bartoszmilewski.com/2017/02/06/applicative-functors/\" rel=\"nofollow noreferrer\">bartoszmilewski.com/2017/02/06/applicative-functors</a>"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1507182844, "post_id": 46535925, "comment_id": 80110335, "body": "You might want to look at <a href=\"https://en.wikipedia.org/wiki/Cartesian_closed_category\" rel=\"nofollow noreferrer\">cartesian closed categories</a>, lambda calculus&#39;s main squeeze."}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1506994761, "creation_date": 1506993878, "last_edit_date": 1506994761, "question_id": 46535925, "link": "https://stackoverflow.com/questions/46535925/generalising-applicative-and-monad-to-more-categories", "title": "Generalising Applicative and Monad to more categories", "body": "<p>In Haskell, we've got the functions:</p>\n\n<pre><code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; (f a -&gt; f b)\npure :: Applicative f =&gt; a -&gt; f a\n(&lt;*&gt;) :: Applicative f =&gt; f (a -&gt; b) -&gt; (f a -&gt; f b)\n(=&lt;&lt;) :: Monad f =&gt; (a -&gt; f b) -&gt; (f a -&gt; f b)\n</code></pre>\n\n<p>I can write <code>fmap</code> in terms of <code>pure</code> and <code>(&lt;*&gt;)</code> like so:</p>\n\n<pre><code>fmap x = (&lt;*&gt;) (pure x)\n</code></pre>\n\n<p>I can also write <code>(&lt;*&gt;)</code> in terms of <code>(=&lt;&lt;)</code> and <code>pure</code> like so:</p>\n\n<pre><code>m1 &lt;*&gt; m2 = (\\x -&gt; (\\y -&gt; pure (x y)) =&lt;&lt; m2) =&lt;&lt; m1\n</code></pre>\n\n<p>Noticed earlier I flipped the bind operator from it's usual <code>(&gt;&gt;=)</code> to <code>(=&lt;&lt;)</code>. The reason I did this is because I now want to generalise the functions like so:</p>\n\n<pre><code>fmap :: (Functor f, Category cat) =&gt; cat a b -&gt; cat (f a) (f b)\npure :: (Applicative f, Category cat) =&gt; a -&gt; f a\n(&lt;*&gt;) :: (Applicative f, Category cat) =&gt; f (cat a b) -&gt; cat (f a) (f b)\n(=&lt;&lt;) :: (Monad f, Category cat) =&gt; cat a (f b) -&gt; cat (f a) (f b)\n</code></pre>\n\n<p>Interestingly, I can still write <code>fmap</code> in terms of <code>pure</code> and <code>(&lt;*&gt;)</code> exactly the same as before:</p>\n\n<pre><code>fmap x = (&lt;*&gt;) (pure x)\n</code></pre>\n\n<p>However, I work out how can't write <code>(&lt;*&gt;)</code> in terms of <code>pure</code> and <code>(=&lt;&lt;)</code>. Is it possible? I suspect it isn't, but I also suspect it's possible to write <code>(&lt;*&gt;)</code> in terms of <code>pure</code> and <code>(=&lt;&lt;)</code> for more categories other than ordinary functions. I also suspect to do this my category needs a few extra functions.</p>\n\n<p>So I'm guessing perhaps I need a class and a few instances, like so:</p>\n\n<pre><code>class Category cat =&gt; SpecialCategory cat where\n  ...\n\ninstance SpecialCategory (-&gt;) where\n  ...\n\ninstance SpecialCategory SomeOtherCategory where\n  ...\n</code></pre>\n\n<p>With this approach I should be able to define any special characteristics a category needs to be able to define <code>(&lt;*&gt;)</code> in terms of <code>(=&lt;&lt;)</code> and <code>pure</code>.</p>\n\n<p>What are those characteristics? Or am I completely off track in my approach to making this generalisation?</p>\n"}, {"tags": ["parsing", "haskell", "expression"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1506984911, "post_id": 46534800, "comment_id": 80024359, "body": "Are you sure your input isn&#39;t supposed to be <code>* + 2 3 * 2 - 6 2</code>? This looks like prefix Polish notation."}, {"owner": {"reputation": 77, "user_id": 5838116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/mlwk4.png?s=128&g=1", "display_name": "iIllumination", "link": "https://stackoverflow.com/users/5838116/iillumination"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1506985130, "post_id": 46534800, "comment_id": 80024408, "body": "Yeah,  I posted the wrong code, it&#39;s suppose to be &quot;Sub Expr&quot; and not &quot;Sub Expr Expr&quot;, sorry"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1506985249, "post_id": 46534800, "comment_id": 80024436, "body": "Compare with <a href=\"https://stackoverflow.com/q/46516500/625403\">stackoverflow.com/q/46516500/625403</a> - I think there must be some class somewhere assigning this as an exercise. In which case, the <code>-</code> is supposed to be unary negate, not binary subtract."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1507006178, "post_id": 46534800, "comment_id": 80029143, "body": "@Alec <code>Sum Expr Expr</code> looks right to me. The constructor at issue was <code>Sub</code>, not <code>Sum</code>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1507006243, "post_id": 46534800, "comment_id": 80029167, "body": "@amalloy Yep it does. Foolish me. I kept reading it as <code>Sub Expr Expr</code> that was previously there."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 3, "creation_date": 1507008641, "post_id": 46534800, "comment_id": 80029805, "body": "<a href=\"https://softwareengineering.meta.stackexchange.com/q/6166/19115\">softwareengineering.meta.stackexchange.com/q/6166/19115</a>"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1507015677, "post_id": 46534800, "comment_id": 80032761, "body": "Also your example will be more clear if instead of (6 - 2) you write (6 + (-2)), which is what the input actually represents."}], "answers": [{"comments": [{"owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 2, "creation_date": 1506986997, "post_id": 46534960, "comment_id": 80024869, "body": "A nice introduction into the concepts of monadic parsing is the <a href=\"http://www.cs.nott.ac.uk/~pszgmh/pearl.pdf\" rel=\"nofollow noreferrer\">Functional Pearls Paper</a>"}, {"owner": {"reputation": 77, "user_id": 5838116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/mlwk4.png?s=128&g=1", "display_name": "iIllumination", "link": "https://stackoverflow.com/users/5838116/iillumination"}, "edited": false, "score": 0, "creation_date": 1507092293, "post_id": 46534960, "comment_id": 80068163, "body": "Thanks dude, very helpful! I have put in my almost done code at the top of the page if u are interested. Maybe u can&#39;t give some suggestion to how I can improve the code too :P"}, {"owner": {"reputation": 881859, "user_id": 100297, "user_type": "moderator", "profile_image": "https://www.gravatar.com/avatar/24780fb6df85a943c7aea0402c843737?s=128&d=identicon&r=PG", "display_name": "Martijn Pieters", "link": "https://stackoverflow.com/users/100297/martijn-pieters"}, "reply_to_user": {"reputation": 77, "user_id": 5838116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/mlwk4.png?s=128&g=1", "display_name": "iIllumination", "link": "https://stackoverflow.com/users/5838116/iillumination"}, "edited": false, "score": 0, "creation_date": 1507195215, "post_id": 46534960, "comment_id": 80116778, "body": "@iIllumination: please don&#39;t do that; keep the question post for the question only; if you have a solution (even a partial one), use an answer post for that. I&#39;ve rolled back your edit."}, {"owner": {"reputation": 77, "user_id": 5838116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/mlwk4.png?s=128&g=1", "display_name": "iIllumination", "link": "https://stackoverflow.com/users/5838116/iillumination"}, "edited": false, "score": 0, "creation_date": 1507199754, "post_id": 46534960, "comment_id": 80119878, "body": "ohh, ok, sry, my bad."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 6, "last_activity_date": 1506986472, "last_edit_date": 1506986472, "creation_date": 1506985759, "answer_id": 46534960, "question_id": 46534800, "link": "https://stackoverflow.com/questions/46534800/haskell-parse-expression/46534960#46534960", "title": "Haskell parse expression", "body": "<p>While sophisticated parsing libraries exist for Haskell, and would be great for this task, your input format is simple enough that it's not too imposing to parse by hand, with a recursive function consuming the input and returning both a parsed expression and the remainder of the string to continue parsing.</p>\n\n<p>Here's a skeleton of what it would look like:</p>\n\n<pre><code>parse :: String -&gt; (String, Expr)\nparse (' ':more) = parse more\nparse ('-':more) = let (remainder, e) = parse more\n                   in (remainder, Sub e)\nparse ('+':more) = undefined -- TODO\nparse ('*':more) = undefined -- TODO\nparse s@(num:more) | isDigit num = parseNumber s\nparse s = error (\"unexpected input: \" ++ s)\n\nparseNumber :: String -&gt; (String, Expr)\nparseNumber s = undefined\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 5838116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/mlwk4.png?s=128&g=1", "display_name": "iIllumination", "link": "https://stackoverflow.com/users/5838116/iillumination"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 907, "favorite_count": 0, "accepted_answer_id": 46534960, "answer_count": 1, "score": 0, "last_activity_date": 1507195186, "creation_date": 1506984564, "last_edit_date": 1507195186, "question_id": 46534800, "link": "https://stackoverflow.com/questions/46534800/haskell-parse-expression", "title": "Haskell parse expression", "body": "<p>Hi I got a code like this:</p>\n\n<pre><code>data Digit = Zero | One | Two | Three | Four | Five | Six | Seven | Eight | \n             Nine \n             deriving (Eq, Show)\n\ndata Number = Single Digit | Many Digit Number deriving (Eq, Show)\n\ndata Expr = Lit Number\n          | Sub Expr   \n          | Sum Expr Expr \n          | Mul Expr Expr\n          deriving (Eq, Show)\n</code></pre>\n\n<p>So the idea with this code is to have a string, like <code>* + 2 3 * 2 + 6 - 2</code>, which will be represented as <code>((2 + 3) * (2 * (6 - 2)))</code>, and then use this to put parts of the string in there types. And of course at the end find the result, in this case 40. The problem is that I don't know much about parsing, so I really don't know how I could parse an expression like this. I have seen some simple parsing where strings are been parsed into types, like person or something. But I think this is a bit more complex. If anyone have any suggestions, I would be really interested.</p>\n"}, {"tags": ["haskell", "import"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 2, "creation_date": 1506981855, "post_id": 46534212, "comment_id": 80023480, "body": "Are you familiar with the tool <code>stack</code>, try to build with it it should take care of this issue"}, {"owner": {"reputation": 676, "user_id": 4165235, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f35ee4291fd7978fa3619b278d7a8c04?s=128&d=identicon&r=PG&f=1", "display_name": "Salviati", "link": "https://stackoverflow.com/users/4165235/salviati"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1506982070, "post_id": 46534212, "comment_id": 80023554, "body": "I have not, new to haskell. But I have been looking for something similar for haskell as virtualenv for python. Ty!"}, {"owner": {"reputation": 412, "user_id": 6593641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xVNVQ.jpg?s=128&g=1", "display_name": "madnight", "link": "https://stackoverflow.com/users/6593641/madnight"}, "edited": false, "score": 1, "creation_date": 1506984099, "post_id": 46534212, "comment_id": 80024137, "body": "@Salviati try to use <code>stack</code> follow this guide <a href=\"https://docs.haskellstack.org/en/stable/README/\" rel=\"nofollow noreferrer\">docs.haskellstack.org/en/stable/README</a> to setup a new project with haskells &quot;virtualenv&quot;"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1506984327, "post_id": 46534212, "comment_id": 80024209, "body": "How exactly do you &quot;run Calculator.hs&quot;? What command do you type?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1506984445, "post_id": 46534212, "comment_id": 80024238, "body": "Also, site rules ask that you include any relevant code <i>in the question itself</i> (and not at an offsite resource that could potentially go dead before SO itself does). Luckily in your case a minimal reproducing example should be as short as a single file with the contents <code>import Graphics.UI.Threepenny</code>, so this should be no burden for you -- but just to make sure, you should test that it is so and edit your question appropriately once you have found a minimal reproducing example."}, {"owner": {"reputation": 490, "user_id": 729738, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9c44a00233984264a17e0b9148933e65?s=128&d=identicon&r=PG", "display_name": "Avlin", "link": "https://stackoverflow.com/users/729738/avlin"}, "edited": false, "score": 1, "creation_date": 1600890597, "post_id": 46534212, "comment_id": 113235275, "body": "this is completely awkward for new comers...  1 day spent to install a package"}], "owner": {"reputation": 676, "user_id": 4165235, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f35ee4291fd7978fa3619b278d7a8c04?s=128&d=identicon&r=PG&f=1", "display_name": "Salviati", "link": "https://stackoverflow.com/users/4165235/salviati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 802, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1506980873, "creation_date": 1506980873, "question_id": 46534212, "link": "https://stackoverflow.com/questions/46534212/can-not-find-module-after-installing-it", "title": "Can not find module after installing it", "body": "<p>I am trying to install \"threepenny-gui\", I simply do it by</p>\n\n<pre><code>cabal install threepenny-gui \n</code></pre>\n\n<p>It is a school project that I have to use it and you can find the start code <a href=\"http://www.cse.chalmers.se/edu/year/2017/course/TDA555_Introduktion_Till_Funktionell_Programmering/Code/Lab4/Calculator.zip\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>After I have installed it and run Calculator.hs without changing anything I get the error</p>\n\n<pre><code>ThreepennyPages.hs:13:18:\n    Could not find module \u2018Data.Aeson\u2019\n    Perhaps you meant Data.Version (from base-4.8.2.0)\n    Use -v to see a list of the files searched for.\n\nThreepennyPictures.hs:17:18:\n    Could not find module \u2018Graphics.UI.Threepenny\u2019\n    Use -v to see a list of the files searched for.\n\nThreepennyPictures.hs:18:8:\n    Could not find module \u2018Graphics.UI.Threepenny.Core\u2019\n    Use -v to see a list of the files searched for.\nFailed, modules loaded: none.\n</code></pre>\n\n<p>I read <a href=\"https://wiki.haskell.org/Cabal-Install\" rel=\"nofollow noreferrer\">here</a> in section 4.1 that</p>\n\n<blockquote>\n  <p>This happens when you install a package globally, and the previous packages were installed locally.</p>\n</blockquote>\n\n<p>But does not give any real solution. How should I install it correctly? Have been having similar problems when installing other modules.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1506964270, "post_id": 46530222, "comment_id": 80015361, "body": "Use the <code>(.)</code> operator: <code>octToDec = sum . digitToDec . charToDigit</code>. But your approach is rather inefficient."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1506969211, "post_id": 46530222, "comment_id": 80017828, "body": "Just a very minor observation: I find the name <code>octToDec</code> a bit misleading. IT does take octal digits for input, so the <code>octTo...</code> part is good. It does not produce decimal digits, or digits in any base: it produces the <code>Int</code> value itself, which is not related to <code>...Dec</code> in any way. Perhaps <code>octToInt</code>, <code>parseOct</code>, <code>octToValue</code> could be more appropriate."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1506988962, "post_id": 46530222, "comment_id": 80025341, "body": "Or if you were to write it the more obvious way - <code>octToDec x = sum (digitToDec (charToDigit x)))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "is_accepted": false, "score": 3, "last_activity_date": 1506967733, "creation_date": 1506967733, "answer_id": 46531211, "question_id": 46530222, "link": "https://stackoverflow.com/questions/46530222/work-of-2-functions/46531211#46531211", "title": "Work of 2 functions", "body": "<p>Use the normal function composition operator <code>(.)</code> to compose functions:</p>\n\n<pre><code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n</code></pre>\n\n<p><code>&gt;&gt;=</code> is the monadic bind operator:</p>\n\n<pre><code>(&gt;&gt;=) :: forall a b. m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>The solution to your question is simply:</p>\n\n<pre><code>octToDec = sum . digitToDec . charToDigit\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1506981404, "creation_date": 1506981404, "answer_id": 46534303, "question_id": 46530222, "link": "https://stackoverflow.com/questions/46530222/work-of-2-functions/46534303#46534303", "title": "Work of 2 functions", "body": "<p>Just for practicing purposes another way to implement this functionality could be;</p>\n\n<pre><code>digits :: String -&gt; [Int]\ndigits n | n == \"\" || n == \"0\" = []\n         | otherwise           = ((++) &lt;$&gt; digits . show . (`div` 10) &lt;*&gt; return . (`rem` 10)) . read $ n\n\noct2dec :: String -&gt; Int\noct2dec s = snd . foldr (\\d r -&gt; (1 + (fst r), snd r  + d * 8^(fst r))) (0,0) $ digits s\n\n*Main&gt; oct2dec \"123\"\n83\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8638529"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1506981404, "creation_date": 1506963761, "last_edit_date": 1506977654, "question_id": 46530222, "link": "https://stackoverflow.com/questions/46530222/work-of-2-functions", "title": "Work of 2 functions", "body": "<p>I am converting number from octal to decimal. I get number as <code>[Char]</code>, so I decided to convert it to <code>[Int]</code> first, then I multiply every digit by the corresponding power of 8. Finally, I planned to use <code>sum</code> and get my decimal number. How can I make 2 functions work one by one?</p>\n\n<pre><code>import Data.Char\n\ncharToDigit :: [Char] -&gt; [Int] -- \"123\" -&gt; [1,2,3]\ncharToDigit [] = []\ncharToDigit (x:xs) = digitToInt x : charToDigit xs\n\ndigitToDec :: [Int] -&gt; [Int] -- [1,2,3] -&gt; [64,16,3]\ndigitToDec [] = []\ndigitToDec (x:xs) = x * 8^(length xs) : digitToDec xs\n\noctToDec :: [Char] -&gt; Int\noctToDec (x:xs) = charToDigit (x:xs) &gt;&gt;= digitToDec (x:xs) &gt;&gt;= sum (x:xs) -- \"123\" -&gt; [1,2,3] -&gt; [64,16,3] -&gt; 64+16+3 = 83\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1506958073, "post_id": 46528115, "comment_id": 80011674, "body": "Having never used ghcjs before (and therefore my guesses being a priori suspect), I would guess these are Javascript function names provided by the ghcjs runtime."}, {"owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1507012173, "post_id": 46528115, "comment_id": 80031074, "body": "@Daniel Wagner: One reason why I think your hyothesis is wrong: You can compile Haskell JSaddle programs with GHC and they run in WebkitGtk. So there is no GHCJS involved."}], "answers": [{"tags": [], "owner": {"reputation": 386, "user_id": 946152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/900fe348fc542ba21bf84a69d552829b?s=128&d=identicon&r=PG", "display_name": "Hamish Mackenzie", "link": "https://stackoverflow.com/users/946152/hamish-mackenzie"}, "is_accepted": true, "score": 1, "last_activity_date": 1507025545, "creation_date": 1507025545, "answer_id": 46542187, "question_id": 46528115, "link": "https://stackoverflow.com/questions/46528115/jsaddle-whats-the-magic-of-the-h-prefix-in-the-argument-of-the-jsg1-function/46542187#46542187", "title": "JSaddle - What&#39;s the magic of the h$ prefix in the argument of the jsg1 function", "body": "<p>There's no magic.  The <code>h$</code> prefix is just to avoid clashing with anything likely to be used by other JavaScript libraries.</p>\n\n<p><a href=\"https://github.com/ghcjs/jsaddle/blob/master/jsaddle/jsaddle.cabal#L53\" rel=\"nofollow noreferrer\">These modules</a> are only exposed in the else branch of an <code>if impl(ghcjs)</code> because they are provided by ghcjs-base package when compiling with GHCJS.</p>\n\n<p>When compiling with GHC the two <code>h$</code> functions will be loaded into the JavaScript context along with the other JavaScript needed by jsaddle <a href=\"https://github.com/ghcjs/jsaddle/blob/master/jsaddle/src/Language/Javascript/JSaddle/Run/Files.hs#L457\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 46542187, "answer_count": 1, "score": 1, "last_activity_date": 1507025545, "creation_date": 1506956216, "question_id": 46528115, "link": "https://stackoverflow.com/questions/46528115/jsaddle-whats-the-magic-of-the-h-prefix-in-the-argument-of-the-jsg1-function", "title": "JSaddle - What&#39;s the magic of the h$ prefix in the argument of the jsg1 function", "body": "<p>The functions <a href=\"https://hackage.haskell.org/package/jsaddle-0.9.4.0/docs/Language-Javascript-JSaddle-Object.html#v:jsg\" rel=\"nofollow noreferrer\">jsg</a> \nand <a href=\"https://hackage.haskell.org/package/jsaddle-0.9.4.0/docs/Language-Javascript-JSaddle-Object.html#v:jsg1\" rel=\"nofollow noreferrer\">jsg1</a> \nof the <a href=\"https://hackage.haskell.org/package/jsaddle-0.9.4.0\" rel=\"nofollow noreferrer\">jsaddle</a>\npackage allow to do low level calls to Javascript functions.</p>\n\n<p>The jsaddle package even has some <a href=\"https://hackage.haskell.org/package/jsaddle-0.9.4.0/docs/src/JavaScript-TypedArray-Internal.html#uint8ArrayFrom\" rel=\"nofollow noreferrer\">examples of how to use jsg1</a> eg: </p>\n\n<p><code>uint8ArrayFrom (SomeJSArray a) = SomeTypedArray &lt;$&gt; jsg \"Uint8Array\" ^. js1 \"from\" a</code></p>\n\n<p><code>uint16ArrayFrom (SomeJSArray a) = SomeTypedArray &lt;$&gt; jsg \"Uint16Array\" ^. js1 \"from\" a</code></p>\n\n<p>In both cases, the parameters <em>Uint8Array</em> and <em>Uint16Array</em> are well known global names in Javascript. \nIt's easy to find Javascript documentation about all these names.</p>\n\n<p>The examples of the usage of the function <em>jsg1</em> eg \n<a href=\"https://hackage.haskell.org/package/jsaddle-0.9.4.0/docs/src/GHCJS-Buffer.html#createFromArrayBuffer\" rel=\"nofollow noreferrer\">here</a>\nand <a href=\"https://hackage.haskell.org/package/jsaddle-0.9.4.0/docs/src/GHCJS-Buffer.html#fromByteString\" rel=\"nofollow noreferrer\">here</a>, however, use stange strings\nlike <code>h$wrapBuffer</code> and <code>h$newByteArrayFromBase64String</code>. Googling these strings, specially on <em>h$newByteArrayFromBase64String</em>, does not give any meaningful results.</p>\n\n<p>What is the meaning of the strings in the argument of the <em>jsg1</em> function? Where are they defined? Which other strings are possible as jsg1 arguments?\nIs the <em>h$</em> prefix a convention, that triggers some hidden magic?</p>\n"}, {"tags": ["haskell", "types", "polymorphism"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 6, "creation_date": 1506956903, "post_id": 46527676, "comment_id": 80010909, "body": "Yes, this is exactly what <code>RankNTypes</code> is for."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1506977788, "post_id": 46527676, "comment_id": 80022018, "body": "You could make the signature <code>(...) =&gt; a -&gt; (DX a -&gt; DX a) -&gt; a -&gt; a</code> if you don&#39;t want <code>RankNTypes</code>.  But that would permit nonsense like creating a &quot;differentiable function&quot; <code>\\(DX x x&#39;) -&gt; DX (x^2) 0</code>, so I think the <code>RankNTypes</code> solution is correct."}, {"owner": {"reputation": 1818, "user_id": 1955231, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/100002848311925/picture?type=large", "display_name": "Agnishom Chattopadhyay", "link": "https://stackoverflow.com/users/1955231/agnishom-chattopadhyay"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1507004484, "post_id": 46527676, "comment_id": 80028727, "body": "@luqui thanks, but that does not typecheck in my compiler"}], "answers": [{"tags": [], "owner": {"reputation": 1818, "user_id": 1955231, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/100002848311925/picture?type=large", "display_name": "Agnishom Chattopadhyay", "link": "https://stackoverflow.com/users/1955231/agnishom-chattopadhyay"}, "is_accepted": true, "score": 0, "last_activity_date": 1507430040, "creation_date": 1507430040, "answer_id": 46627021, "question_id": 46527676, "link": "https://stackoverflow.com/questions/46527676/how-to-make-type-variables-less-rigid/46627021#46627021", "title": "How to make type variables less rigid?", "body": "<p>The following type signature makes it work</p>\n\n<pre><code>newtons :: (Num a, Ord a, Fractional a) =&gt; a -&gt; (forall b. (Num b, Ord b, Fractional b) =&gt; b -&gt; b) -&gt; a -&gt; a\n</code></pre>\n\n<p>And I can run things like:</p>\n\n<pre><code>*Main&gt; newtons 0.001 (\\x -&gt; x^2 - 2) 2\n1.4142156862745099\n</code></pre>\n\n<p>So, yes, one reasonable way to fix it is to use <code>Rank2Types</code></p>\n"}], "owner": {"reputation": 1818, "user_id": 1955231, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/100002848311925/picture?type=large", "display_name": "Agnishom Chattopadhyay", "link": "https://stackoverflow.com/users/1955231/agnishom-chattopadhyay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 46627021, "answer_count": 1, "score": 2, "last_activity_date": 1507430040, "creation_date": 1506954880, "last_edit_date": 1507429984, "question_id": 46527676, "link": "https://stackoverflow.com/questions/46527676/how-to-make-type-variables-less-rigid", "title": "How to make type variables less rigid?", "body": "<p>I had been trying to implement automatic differentiation, from this <a href=\"https://www.quora.com/What-are-20-lines-of-code-that-capture-the-essence-of-Haskell-Try-to-follow-standard-Haskell-style-Comments-and-spaces-between-code-do-not-count-as-lines-They-can-also-consist-of-individual-snippets-of-code-but-have-to-add-up-to-20-lines/answer/Tikhon-Jelvis?share=1\" rel=\"nofollow noreferrer\">post</a></p>\n\n<p>Here is what I had, which worked so far:</p>\n\n<pre><code>data DX a = DX { val :: a, dx :: DX a }\n\ninstance Num n =&gt; Num (DX n) where\n  fromInteger x = DX (fromInteger x) 0\n  DX x\u2080 x' + DX y\u2080 y' = DX (x\u2080 + y\u2080) (x' + y')\n  DX x\u2080 x' - DX y\u2080 y' = DX (x\u2080 - y\u2080) (x' - y')\n  x@(DX x\u2080 x') * y@(DX y\u2080 y') = DX (x\u2080 * y\u2080) (x * y' + y * x')\n  signum (DX x\u2080 x') = DX (signum x\u2080) 0\n  abs x@(DX x\u2080 x') = DX (abs x\u2080) (signum x * x')\n\ninstance Fractional n =&gt; Fractional (DX n) where\n  fromRational n = DX (fromRational n) 0\n  x@(DX x\u2080 x') / y@(DX y\u2080 y') =\n    DX (x\u2080 / y\u2080) ((x' * y - x * y') / y ^ 2)\n\ninstance Eq a =&gt; Eq (DX a) where\n  a == b = val a == val b\ninstance Ord a =&gt; Ord (DX a) where\n  compare a b = compare (val a) (val b)\ninstance Show a =&gt; Show (DX a) where\n  show (DX x (DX x' (DX x'' _))) = show [x, x', x'']\n\nvar x = DX x 1\n</code></pre>\n\n<p>And then, I tried to define Newton's Method, which is where I got stuck:</p>\n\n<pre><code>newtons :: (Num a, Fractional a, Ord a) =&gt; a -&gt; (a -&gt; a) -&gt; a -&gt; a\nnewtons eps f guess\n  | abs (f guess) &lt; eps   = guess\n  | otherwise             = newtons eps f newGuess\n    where\n      newGuess              = guess - (x\u2080/x')\n      (DX x\u2080 (DX x' _))     = f (var guess)\n</code></pre>\n\n<p>The error I get is this:</p>\n\n<pre><code>randomStuff.hs:75:34:\n    Couldn't match expected type \u2018a\u2019 with actual type \u2018DX a\u2019\n      \u2018a\u2019 is a rigid type variable bound by\n          the type signature for\n            newtons :: (Num a, Fractional a) =&gt; a -&gt; (a -&gt; a) -&gt; a -&gt; a\n          at randomStuff.hs:69:12\n    Relevant bindings include\n      guess :: a (bound at randomStuff.hs:70:15)\n      f :: a -&gt; a (bound at randomStuff.hs:70:13)\n      eps :: a (bound at randomStuff.hs:70:9)\n      newtons :: a -&gt; (a -&gt; a) -&gt; a -&gt; a (bound at randomStuff.hs:70:1)\n    In the first argument of \u2018f\u2019, namely \u2018(var guess)\u2019\n    In the expression: f (var guess)\n</code></pre>\n\n<p>What I understand of the issue is as follows: I have inferred the given function to be of the type <code>a -&gt; a</code>, and yet, I am trying to use it in the form <code>DX a -&gt; DX a</code>, which it does not permit.</p>\n\n<p>But I should be able to use the same function again somehow because it should work no matter what the type is as long as it is in the typeclass <code>Num</code> and <code>Fractional</code>.</p>\n\n<p>Is my understanding correct? How do I get around this? Do I need Rank2Types?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 1, "creation_date": 1506952091, "post_id": 46526539, "comment_id": 80007574, "body": "Those are no <i>redefinitions</i> of <code>P</code> but a simple pattern match on the result of the call to <code>f</code>."}], "answers": [{"comments": [{"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 1, "creation_date": 1506972166, "post_id": 46527194, "comment_id": 80019216, "body": "You can also desugar this to <code>case</code> statements: <code>P a b &gt;&gt;= f = case f a of P x _ -&gt; case f b of P _ y -&gt; P x y</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 1, "creation_date": 1506993361, "post_id": 46527194, "comment_id": 80026316, "body": "@AntalSpector-Zabusky, not precisely. The given code uses a lazy pattern match, which may or may not be significant."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 9, "last_activity_date": 1506953389, "creation_date": 1506953389, "answer_id": 46527194, "question_id": 46526539, "link": "https://stackoverflow.com/questions/46526539/what-does-one-gain-when-redefining-data-constructors-and-in-place-of-what-expre/46527194#46527194", "title": "What does one gain when redefining data constructors, and in place of what expressions might such a definition be substituted?", "body": "<p>The equation</p>\n\n<pre><code>P x y = z\n</code></pre>\n\n<p>does not define <code>P</code>, only <code>x</code> and <code>y</code>. This is the case in general: only the <code>data</code> and <code>newtype</code> keywords can introduce new constructors. All other equations define only term variables. To disambiguate between the two, constructors always begin with upper case (for the special case of operators, <code>:</code> counts as \"upper case punctuation\") and variables always begin with lower case.</p>\n\n<p>So, the meaning of</p>\n\n<pre><code>P a b &gt;&gt;= f = P x y\n  where P x _ = f a\n        P _ y = f b\n</code></pre>\n\n<p>reads like this:</p>\n\n<ol>\n<li>Define a new function named <code>(&gt;&gt;=)</code>. It is defined when the first argument matches the pattern <code>P a b</code> (binding <code>a</code> and <code>b</code> to the actual values <code>P</code> is applied to in the first argument), and when the second argument matches the pattern <code>f</code> (that is, always, and binding <code>f</code> to the value of that second argument).</li>\n<li>Apply <code>f</code> to <code>a</code>. Make sure the result of this matches the pattern <code>P x _</code> (binding <code>x</code> to the first value <code>P</code> is applied to and throwing away the second).</li>\n<li>Apply <code>f</code> to <code>b</code>. Make sure the result of this matches the pattern <code>P _ y</code> (binding <code>y</code> to the second value <code>P</code> is applied to and throwing away the first).</li>\n<li>Return the value <code>P x y</code>.</li>\n</ol>\n"}], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 46527194, "answer_count": 1, "score": 1, "last_activity_date": 1506953389, "creation_date": 1506951247, "question_id": 46526539, "link": "https://stackoverflow.com/questions/46526539/what-does-one-gain-when-redefining-data-constructors-and-in-place-of-what-expre", "title": "What does one gain when redefining data constructors, and in place of what expressions might such a definition be substituted?", "body": "<p>Reading <a href=\"https://stackoverflow.com/a/13042792/2108477\">this answer</a>, I'm getting puzzled by the very first code fragment:</p>\n\n<pre><code>data Pair a = P a a\n\ninstance Functor Pair where\n  fmap f (P x y) = P (f x) (f y)\n\ninstance Monad Pair where\n  return x = P x x\n\n  P a b &gt;&gt;= f = P x y\n    where P x _ = f a\n          P _ y = f b\n</code></pre>\n\n<p>What I see is the author <strong>redefining a data constructor</strong> <em>two times</em> and <strong><em>applying it to undefined variables</em></strong>.</p>\n\n<p>First off, how does the second of the two definitions of <code>P</code> (those two that are found in the <code>where</code> clause of the <code>instance Monad</code> definition) matter if, as I believe, the first one (whichever we put first) always matches?</p>\n\n<p>Second, according to what syntax rules could the expression <code>P x y</code> get evaluated when there are no expressions for <code>x</code> and <code>y</code> in scope, but rather some kind of a <em>redefinition of a data constructor</em> that <em>happens to mention these variables' names</em>?</p>\n\n<p>Interesting to note that, if I instead write like: </p>\n\n<pre><code>  P a b &gt;&gt;= f = P x y\n    where P u _ = f a\n          P _ v = f b\n</code></pre>\n\n<p>&mdash; substituting <code>u</code> &amp; <code>v</code> for <code>x</code> &amp; <code>y</code> \n&mdash; I will observe an <code>error: Variable not in scope</code> for each of <code>x</code> &amp; <code>y</code>, even though by all sane intuition renaming a bound variable makes no difference.</p>\n"}, {"tags": ["haskell", "recursion-schemes"], "comments": [{"owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "edited": false, "score": 0, "creation_date": 1506974815, "post_id": 46525571, "comment_id": 80020541, "body": "perhaps putting the question at haskell-cafe@haskell.org can help"}, {"owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "edited": false, "score": 0, "creation_date": 1506975311, "post_id": 46525571, "comment_id": 80020820, "body": "see also <a href=\"https://stackoverflow.com/a/37002861/2789312\">stackoverflow.com/a/37002861/2789312</a>"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 1, "creation_date": 1506977880, "post_id": 46525571, "comment_id": 80022055, "body": "<a href=\"https://gist.github.com/danidiaz/e5debcaf531838eb6e2afd3ef3b34d60\" rel=\"nofollow noreferrer\">gist.github.com/danidiaz/e5debcaf531838eb6e2afd3ef3b34d60</a>"}, {"owner": {"reputation": 431, "user_id": 3042847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20812bf59589551344aeae214de49f6a?s=128&d=identicon&r=PG&f=1", "display_name": "xgrommx", "link": "https://stackoverflow.com/users/3042847/xgrommx"}, "edited": false, "score": 1, "creation_date": 1506983266, "post_id": 46525571, "comment_id": 80023921, "body": "This isn&#39;t duplicate. because no example with chrono in <a href=\"https://stackoverflow.com/questions/36851766/histomorphisms-zygomorphisms-and-futumorphisms-specialised-to-lists\" title=\"histomorphisms zygomorphisms and futumorphisms specialised to lists\">stackoverflow.com/questions/36851766/&hellip;</a>"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1507035264, "post_id": 46525571, "comment_id": 80044186, "body": "I&#39;m reopening this question. One can debate the merits of the question on its own, but while it&#39;s similar to the linked question it&#39;s definitely not a duplicate."}], "answers": [{"comments": [{"owner": {"reputation": 431, "user_id": 3042847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20812bf59589551344aeae214de49f6a?s=128&d=identicon&r=PG&f=1", "display_name": "xgrommx", "link": "https://stackoverflow.com/users/3042847/xgrommx"}, "edited": false, "score": 0, "creation_date": 1508442176, "post_id": 46698107, "comment_id": 80622934, "body": "Sorry, but looks like your code doesn&#39;t work. Could you please provide working version?"}, {"owner": {"reputation": 1973, "user_id": 1716999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06a58106c9a1013f1ca791c46579d664?s=128&d=identicon&r=PG", "display_name": "rubystallion", "link": "https://stackoverflow.com/users/1716999/rubystallion"}, "edited": false, "score": 0, "creation_date": 1615039766, "post_id": 46698107, "comment_id": 117571056, "body": "I don&#39;t understand why the histomorphism for Catalan numbers given in that paper is called a bogus solution, even though it gives correct results in Haskell? Why is converting the coinductive argument to the <code>elems</code> function to a simple inductive list bogus? Is it only bogus in languages with stronger type systems like Agda?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8174234"}, "is_accepted": false, "score": 0, "last_activity_date": 1507758647, "creation_date": 1507758647, "answer_id": 46698107, "question_id": 46525571, "link": "https://stackoverflow.com/questions/46525571/an-example-for-chronomorphism/46698107#46698107", "title": "An example for chronomorphism", "body": "<p>Probably the biggest use of chronomorphisms is collapsing a named syntax tree. In particular, you can refer to names that haven't been processed yet as well as names that <em>have</em> already been processed.</p>\n\n<p>Another thing you can do with chronomorphisms is rewrite dynamorphisms! You can read more about dynamorphisms <a href=\"http://citeseerx.ist.psu.edu/viewdoc/download;jsessionid=BA4CCC586864C57099F3D7092439228C?doi=10.1.1.416.2381&amp;rep=rep1&amp;type=pdf\" rel=\"nofollow noreferrer\">here</a>. One of the examples they cite is the Catalan numbers. I've translated it to Haskell below.</p>\n\n<pre><code>import Data.Functor.Foldable\nimport Control.Arrow\nimport Control.Comonad.Cofree\n\ndyna :: (Functor f) =&gt; (f (Cofree f a) -&gt; a) -&gt; (c -&gt; f c) -&gt; c -&gt; a\ndyna a c = extract . h where h = (uncurry (:&lt;)) . (a &amp;&amp;&amp; id) . fmap h . c\n\ncatalan :: Int -&gt; Int\ncatalan = dyna coalgebra project where\n    coalgebra :: ListF Int (Cofree ListF Int) -&gt; Int\n    coalgebra Nil = 1\n    coalgebra (Cons x table) = sum $ zipWith (*) xs (reverse xs)\n        where xs = take x table\n</code></pre>\n\n<p>You might also find <a href=\"http://blog.sumtypeofway.com/recursion-schemes-part-iv-time-is-of-the-essence/\" rel=\"nofollow noreferrer\">this</a> useful. It has an example that uses a futumorphism to build a tree and a catamorphism to tear it down (though this is occluded). Of course, this map is in fact another specialization of the chronomorphism.</p>\n"}], "owner": {"reputation": 431, "user_id": 3042847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20812bf59589551344aeae214de49f6a?s=128&d=identicon&r=PG&f=1", "display_name": "xgrommx", "link": "https://stackoverflow.com/users/3042847/xgrommx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 676, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507758647, "creation_date": 1506947729, "last_edit_date": 1507016230, "question_id": 46525571, "link": "https://stackoverflow.com/questions/46525571/an-example-for-chronomorphism", "title": "An example for chronomorphism", "body": "<p>I don't understand how can I create some example with chronomorphism. \nI know about hylomorphism (<code>cata</code>, <code>ana</code>) also I know about <code>histo</code> and <code>futu</code>.</p>\n\n<p>But I don't realize some example for chronomorphism (maybe some behavior as in Tardis monad).</p>\n\n<p>Also related link <a href=\"https://github.com/ekmett/recursion-schemes/issues/42\" rel=\"nofollow noreferrer\">https://github.com/ekmett/recursion-schemes/issues/42</a></p>\n\n<p>This isn't related with <a href=\"https://stackoverflow.com/questions/36851766/histomorphisms-zygomorphisms-and-futumorphisms-specialised-to-lists\">Histomorphisms, Zygomorphisms and Futumorphisms specialised to lists</a> because doesn't has some example with chronomorphism.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1506940955, "post_id": 46523211, "comment_id": 80001663, "body": "Just tested with a sample repo and it seemed to work fine for me. can you share your cabal and stack file (or your repo if possible) ?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1506942815, "post_id": 46523211, "comment_id": 80002474, "body": "Why do people keep asking this? The whole point of Stack is to use an exact choice of package versions that <i>have been proven to work together everywhere</i>. If you want to select package versions yourself, don&#39;t use Stack, use Cabal-install instead. Of course that has its risks, though not as much anymore <a href=\"http://blog.ezyang.com/2016/05/announcing-cabal-new-build-nix-style-local-builds/\" rel=\"nofollow noreferrer\">with its new Nix-style building mode</a>."}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1506943629, "post_id": 46523211, "comment_id": 80002838, "body": "I use <code>stack</code> because it makes it easy to build and deploy Haskell projects, specially for somebody who is not a <code>cabal</code> or <code>nix</code> expert. However, sometimes I need to use a package that fixes a nasty bug, and I don&#39;t know how to go about it. Does that mean that I have to stop using <code>stack</code>? I don&#39;t know ..."}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1506943723, "post_id": 46523211, "comment_id": 80002889, "body": "@Sibi <a href=\"https://github.com/capitanbatata/sandbox/tree/master/racing-turtles\" rel=\"nofollow noreferrer\">this is the repo</a>. Maybe I&#39;m using a too-old LTS (<code>9.0</code>).?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1506944558, "post_id": 46523211, "comment_id": 80003329, "body": "@DamianNadales Which directory are  you trying to build inside the repo ?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1506944757, "post_id": 46523211, "comment_id": 80003438, "body": "@leftaroundabout The <code>extra-deps</code> is a supported workflow in Stack and I don&#39;t see any problem with it - So this is a valid question. Also, I&#39;m sort of forced to use stack (in preference to Cabal-install) because of it&#39;s other features like <code>--file-watch</code>, docker support and specifying git as an external dependency."}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1506945031, "post_id": 46523211, "comment_id": 80003579, "body": "@Sibi The <code>racing-turtles</code> directory."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1506950759, "post_id": 46523211, "comment_id": 80006765, "body": "This is an error you get when one of your dependencies requires an older version of process."}], "answers": [{"comments": [{"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1506955367, "post_id": 46526900, "comment_id": 80009821, "body": "I missed that one! Thanks. BTW, is there a way to automatically, detect the changes needed to <code>extra-deps</code>. I tried <code>stack solver</code> with no luck..."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 1, "creation_date": 1506958351, "post_id": 46526900, "comment_id": 80011861, "body": "I think <code>Cabal</code> might be some kind of exception. Usually <code>stack solver</code> does the job. It may be worth reporting that issue to stack."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 1, "last_activity_date": 1506952458, "creation_date": 1506952458, "answer_id": 46526900, "question_id": 46523211, "link": "https://stackoverflow.com/questions/46523211/installing-a-package-outside-current-resolver/46526900#46526900", "title": "Installing a package outside current resolver", "body": "<p>As written in the message, the problem is with <a href=\"https://hackage.haskell.org/package/Cabal-1.24.2.0\" rel=\"nofollow noreferrer\"><code>Cabal-1.24.2.0</code> depending on <code>process &lt; 1.5</code></a>.\nAdd <code>Cabal-2.0.0.2</code> to the <code>extra-deps</code>.</p>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 46526900, "answer_count": 1, "score": 2, "last_activity_date": 1506952458, "creation_date": 1506937827, "question_id": 46523211, "link": "https://stackoverflow.com/questions/46523211/installing-a-package-outside-current-resolver", "title": "Installing a package outside current resolver", "body": "<p>I'm using <code>stack</code> <code>lts-9.0</code> snapshot, which includes <code>process-1.4.X</code>. Due to some problems with this version, I would like to use <code>process-1.6.1.0</code>. Adding this version to <code>extra-deps</code> does not seem to be enough:</p>\n\n<pre><code>extra-deps:\n- process-1.6.1.0\n</code></pre>\n\n<p>since this will cause the following error:</p>\n\n<pre><code>Error: While constructing the build plan, the following exceptions were encountered:\n\nIn the dependencies for Cabal-1.24.2.0:\n    process-1.6.1.0 must match &gt;=1.1.0.1 &amp;&amp; &lt;1.5 (latest applicable is 1.4.3.0)\n</code></pre>\n\n<p>What do I need to do in these cases?</p>\n"}, {"tags": ["haskell", "opensuse", "haskell-stack"], "comments": [{"owner": {"reputation": 3295, "user_id": 481528, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2e5b86097f5b890f1f7dc18a07924875?s=128&d=identicon&r=PG", "display_name": "selalerer", "link": "https://stackoverflow.com/users/481528/selalerer"}, "edited": false, "score": 0, "creation_date": 1506917038, "post_id": 46519307, "comment_id": 79992635, "body": "Please provide the output of <code>ldd --version</code>"}, {"owner": {"reputation": 5661, "user_id": 2541276, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/100001587714573/picture?type=large", "display_name": "Rajkumar Natarajan", "link": "https://stackoverflow.com/users/2541276/rajkumar-natarajan"}, "reply_to_user": {"reputation": 3295, "user_id": 481528, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2e5b86097f5b890f1f7dc18a07924875?s=128&d=identicon&r=PG", "display_name": "selalerer", "link": "https://stackoverflow.com/users/481528/selalerer"}, "edited": false, "score": 0, "creation_date": 1506917624, "post_id": 46519307, "comment_id": 79992723, "body": "ldd --version ldd (GNU libc) 2.26 Copyright (C) 2017 Free Software Foundation, Inc. This is free software; see the source for copying conditions.  There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. Written by Roland McGrath and Ulrich Drepper."}, {"owner": {"reputation": 3295, "user_id": 481528, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2e5b86097f5b890f1f7dc18a07924875?s=128&d=identicon&r=PG", "display_name": "selalerer", "link": "https://stackoverflow.com/users/481528/selalerer"}, "edited": false, "score": 0, "creation_date": 1506917783, "post_id": 46519307, "comment_id": 79992746, "body": "So maybe the problem is that you need <code>GLIBC_2.12</code> installed on your machine and not <code>2.26</code>"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1506923087, "post_id": 46519307, "comment_id": 79993934, "body": "How did you install stack ?"}, {"owner": {"reputation": 5661, "user_id": 2541276, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/100001587714573/picture?type=large", "display_name": "Rajkumar Natarajan", "link": "https://stackoverflow.com/users/2541276/rajkumar-natarajan"}, "edited": false, "score": 0, "creation_date": 1506970247, "post_id": 46519307, "comment_id": 80018311, "body": "by using command <code>curl -sSL https:&#47;&#47;get.haskellstack.org&#47; | sh</code> as mentioned in <a href=\"https://docs.haskellstack.org/en/stable/README/\" rel=\"nofollow noreferrer\">docs.haskellstack.org/en/stable/README</a>"}, {"owner": {"reputation": 5661, "user_id": 2541276, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/100001587714573/picture?type=large", "display_name": "Rajkumar Natarajan", "link": "https://stackoverflow.com/users/2541276/rajkumar-natarajan"}, "edited": false, "score": 0, "creation_date": 1506998357, "post_id": 46519307, "comment_id": 80027359, "body": "I was trying to downgrade glib from version 2.26 to 2.12 and unsuccessful :("}], "answers": [{"comments": [{"owner": {"reputation": 5661, "user_id": 2541276, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/100001587714573/picture?type=large", "display_name": "Rajkumar Natarajan", "link": "https://stackoverflow.com/users/2541276/rajkumar-natarajan"}, "edited": false, "score": 0, "creation_date": 1507087638, "post_id": 46554419, "comment_id": 80066973, "body": "I have created issue <a href=\"https://github.com/commercialhaskell/stack/issues/3472\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/3472</a> for this."}, {"owner": {"reputation": 5661, "user_id": 2541276, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/100001587714573/picture?type=large", "display_name": "Rajkumar Natarajan", "link": "https://stackoverflow.com/users/2541276/rajkumar-natarajan"}, "edited": false, "score": 0, "creation_date": 1517780138, "post_id": 46554419, "comment_id": 84223130, "body": "Thanks Employed Russion for your kind suggestion. This issue is fixed now."}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": true, "score": 2, "last_activity_date": 1507070044, "creation_date": 1507070044, "answer_id": 46554419, "question_id": 46519307, "link": "https://stackoverflow.com/questions/46519307/undefined-reference-to-symbol-pthread-setname-npglibc-2-12-haskell-stack-err/46554419#46554419", "title": "undefined reference to symbol &#39;pthread_setname_np@@GLIBC_2.12&#39; Haskell Stack error on OpenSuse42.3", "body": "<blockquote>\n  <p>So maybe the problem is that you need GLIBC_2.12 installed on your machine and not 2.26</p>\n</blockquote>\n\n<p>No, that is <em>not</em> the issue. GLIBC-2.26 most certainly provides the <code>pthread_setname_np@@GLIBC_2.12</code> symbol (see <a href=\"https://stackoverflow.com/a/41093059/50617\">this answer</a> to understand how symbol versioning works).</p>\n\n<p>You can verify that the symbol is indeed available in your GLIBC-2.26 like so:</p>\n\n<pre><code>$ readelf -Ws /lib/x86_64-linux-gnu/libpthread.so.0 | grep pthread_setname_np\n    89: 00000000000113c0   258 FUNC    GLOBAL DEFAULT   13 pthread_setname_np@@GLIBC_2.12\n   704: 00000000000113c0   258 FUNC    GLOBAL DEFAULT   13 pthread_setname_np\n</code></pre>\n\n<p>(Above command was executed on a system with GLIBC-2.19, but you'll get the same output on a system with GLIBC-2.26).</p>\n\n<p>Now to what your <em>real</em> problem is: <code>libHSrts.a(OSThreads.o)</code> <em>references</em> <code>pthread_setname_np</code> (and likely other <code>pthread_*</code> symbols, but you are not linking with <code>-pthread</code> or <code>-lpthread</code> flag.</p>\n\n<p>I don't know where to add this flag to GHC, but once you find that out, your problem will be solved.</p>\n"}], "owner": {"reputation": 5661, "user_id": 2541276, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/100001587714573/picture?type=large", "display_name": "Rajkumar Natarajan", "link": "https://stackoverflow.com/users/2541276/rajkumar-natarajan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3438, "favorite_count": 0, "accepted_answer_id": 46554419, "answer_count": 1, "score": 1, "last_activity_date": 1507083108, "creation_date": 1506916705, "last_edit_date": 1507083108, "question_id": 46519307, "link": "https://stackoverflow.com/questions/46519307/undefined-reference-to-symbol-pthread-setname-npglibc-2-12-haskell-stack-err", "title": "undefined reference to symbol &#39;pthread_setname_np@@GLIBC_2.12&#39; Haskell Stack error on OpenSuse42.3", "body": "<p>I have installed haskell stack and I'm trying to setup ghc for the same. stack version is </p>\n\n<pre><code>stack --version\nVersion 1.5.1, Git revision 600c1f01435a10d127938709556c1682ecfd694e (4861 commits) x86_64 hpack-0.17.1\n</code></pre>\n\n<p>I have updated the ~/.stack/global-project/stack.yaml as below</p>\n\n<pre><code># This is the implicit global project's config file, which is only used when\n# 'stack' is run outside of a real project.  Settings here do _not_ act as\n# defaults for all projects.  To change stack's default settings, edit\n# '/home/rajkumar/.stack/config.yaml' instead.\n#\n# For more information about stack's configuration, see\n# http://docs.haskellstack.org/en/stable/yaml_configuration/\n#\nflags: {}\nextra-package-dbs: []\npackages: []\nextra-deps: []\nresolver: ghc-8.2.1\n</code></pre>\n\n<p>Then I run stack setup command and got the below error -</p>\n\n<pre><code>  stack setup\n  The GHC located at /home/rajkumar/.stack/programs/x86_64-linux/ghc-8.2.1/bin/ghc failed to compile a sanity check. Please see:\n\n  http://docs.haskellstack.org/en/stable/install_and_upgrade/\n\n  for more information. Exception was:\n  Running /home/rajkumar/.stack/programs/x86_64-linux/ghc-8.2.1/bin/ghc /tmp/stack-sanity-check3048/Main.hs -no-user-package-db in directory /tmp/stack-sanity-check3048/ exited with ExitFailure 1\n\n  [1 of 1] Compiling Main             ( /tmp/stack-sanity-check3048/Main.hs, /tmp/stack-sanity-check3048/Main.o )\n  Linking /tmp/stack-sanity-check3048/Main ...\n\n /usr/bin/ld.bfd: /home/rajkumar/.stack/programs/x86_64-linux/ghc-8.2.1/lib64/ghc-8.2.1/rts/libHSrts.a(OSThreads.o): undefined reference to symbol 'pthread_setname_np@@GLIBC_2.12'\n /lib64/libpthread.so.0: error adding symbols: DSO missing from command line\n collect2: error: ld returned 1 exit status\n`gcc' failed in phase `Linker'. (Exit code: 1)\n</code></pre>\n"}, {"tags": ["haskell", "llvm", "ghc", "llvm-ir", "klee"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1506922151, "post_id": 46519221, "comment_id": 79993698, "body": "Like many modern languages, definitions in the language do not translate to identical declarations in bitcode or object files.  Read the .ll and see."}, {"owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 0, "creation_date": 1506931493, "post_id": 46519221, "comment_id": 79997112, "body": "try adding <code>module Main where</code> as the first line of your Haskell file."}, {"owner": {"reputation": 411, "user_id": 7235699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/x7sjr.jpg?s=128&g=1", "display_name": "user7235699", "link": "https://stackoverflow.com/users/7235699/user7235699"}, "reply_to_user": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 0, "creation_date": 1506937630, "post_id": 46519221, "comment_id": 80000235, "body": "@ja Adding module Main did not work"}, {"owner": {"reputation": 9778, "user_id": 598057, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af77229cbfe1a0bff2b5ea064ef3271a?s=128&d=identicon&r=PG", "display_name": "Stanislav Pankevich", "link": "https://stackoverflow.com/users/598057/stanislav-pankevich"}, "edited": false, "score": 0, "creation_date": 1506941964, "post_id": 46519221, "comment_id": 80002092, "body": "Most likely Haskell links the <code>main</code> function into your program when you run it normally. Find a way to either link it in manually or find a way to create your own custom main function. See also: similar problems people had with Rust: <a href=\"https://stackoverflow.com/a/45860092/598057\">stackoverflow.com/a/45860092/598057</a>."}, {"owner": {"reputation": 9778, "user_id": 598057, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af77229cbfe1a0bff2b5ea064ef3271a?s=128&d=identicon&r=PG", "display_name": "Stanislav Pankevich", "link": "https://stackoverflow.com/users/598057/stanislav-pankevich"}, "edited": false, "score": 0, "creation_date": 1506943584, "post_id": 46519221, "comment_id": 80002820, "body": "Also see this: <a href=\"https://stackoverflow.com/questions/9427535/main-function-not-found-in-module-when-using-llvm-bindings-with-haskell?rq=1\" title=\"main function not found in module when using llvm bindings with haskell\">stackoverflow.com/questions/9427535/&hellip;</a>"}, {"owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "edited": false, "score": 0, "creation_date": 1506947572, "post_id": 46519221, "comment_id": 80004970, "body": "<code>ghc</code> complains <code>unrecognised flag: -force-recomp</code>.  It should be replaced by <code>-fforce-recomp</code>."}], "owner": {"reputation": 411, "user_id": 7235699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/x7sjr.jpg?s=128&g=1", "display_name": "user7235699", "link": "https://stackoverflow.com/users/7235699/user7235699"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 419, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1506915942, "creation_date": 1506915942, "question_id": 46519221, "link": "https://stackoverflow.com/questions/46519221/main-function-not-found-in-the-bitcode-file-generated-by-compiling-haskell-with", "title": "Main Function not Found in the Bitcode file generated by compiling haskell with LLVM", "body": "<p>I want to run klee on the .bc file generated by compiling haskell file with ghc frontend and llvm backend.</p>\n\n<p>I have following code in my haskell hello.hs file:</p>\n\n<pre><code>main = putStrLn \"Hello World!\"\n</code></pre>\n\n<p>I compile hello.hs with ghc using following command</p>\n\n<pre><code>ghc -fllvm -keep-llvm-files -force-recomp -hello.hs\n</code></pre>\n\n<p>which generate a hello.ll file along with other files. I then try to compile this .ll file into a .bc file.</p>\n\n<pre><code>llvm-as hello.ll -o hello.bc\n</code></pre>\n\n<p>The problem is when I try to run klee or try to run lli on the the .bc file I get following error</p>\n\n<pre><code>main function not found in module error\n</code></pre>\n\n<p>I am running ghc and llvm on docker. I have version 3.4 of llvm and version 7.6.3 of ghc.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1506889416, "post_id": 46516500, "comment_id": 79987284, "body": "Why would you need to put them in a declaration?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 8, "creation_date": 1506889439, "post_id": 46516500, "comment_id": 79987290, "body": "There is no syntax for grammars, in Haskell as in most other languages. Note that your problem is not syntax, which is relatively easy to learn, but semantics. If you need to <i>represent</i> something close to that calculator language, you could use algebraic data types: it&#39;s a common choice, and allows recursion similarly to the one in grammars. Note that this will represent parse trees, not strings. If your input is a string, you&#39;ll need to write your own parser (not hard, but very challenging fro a beginner)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1506889721, "post_id": 46516500, "comment_id": 79987375, "body": "Anyway, I&#39;d recommend that you take your book / tutorial and see how <code>data</code> declarations work, how to specify the constructors (which do not appear in your grammar), how to pattern match on them, and so on."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1506896545, "post_id": 46516500, "comment_id": 79989010, "body": "Does the exercise say to translate that into Haskell syntax?"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1506890089, "post_id": 46516594, "comment_id": 79987471, "body": "Indeed. Note that if the AST closely follows the OP grammar, literals are essentially nonempty lists of digits, which might increase the number of constructors to be used in the AST. Of course, it would be better to parse literals into <code>Int</code>s and avoid the issue, but since this is an exercise I am unsure about the &quot;intended&quot; solution."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 7, "last_activity_date": 1506889687, "creation_date": 1506889687, "answer_id": 46516594, "question_id": 46516500, "link": "https://stackoverflow.com/questions/46516500/how-to-translate-logical-notation-to-haskell-syntax/46516594#46516594", "title": "How to translate logical notation to Haskell syntax", "body": "<p>Don't confuse a string in the grammar for the AST that represents it. Compare the string</p>\n\n<pre><code>\"+ + 3 4 5\"\n</code></pre>\n\n<p>which is a string in the grammar you've been given with</p>\n\n<pre><code>Plus (Plus (Literal 3) (Literal 4)) (Literal 5)\n</code></pre>\n\n<p>which would be a sensible Haskell value for the AST that <code>String</code> could get parsed to.</p>\n"}, {"tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 1, "last_activity_date": 1506933198, "creation_date": 1506933198, "answer_id": 46522054, "question_id": 46516500, "link": "https://stackoverflow.com/questions/46516500/how-to-translate-logical-notation-to-haskell-syntax/46522054#46522054", "title": "How to translate logical notation to Haskell syntax", "body": "<p>If it is just a exercise about modeling data (without code) the answer consist of adding constructor names to your grammar (and changing literal number to names). Something like</p>\n\n<pre><code>data Num = Zero | One | Two | Three | Four | Five \n         | Six | Seven | Eight | Nine\ndata Int = Single Num | Multiple Num Int\ndata Exp = ExpInt Int | ExpMinus Exp Exp | ExpMul Exp Exp\n         | ExpMul Exp Exp\n</code></pre>\n\n<p>From that, you can write all sort of code, to parse and evaluate expressions.</p>\n"}, {"tags": [], "owner": {"reputation": 83, "user_id": 4325709, "user_type": "registered", "profile_image": "https://graph.facebook.com/100004846143898/picture?type=large", "display_name": "Severi J&#228;&#228;skel&#228;inen", "link": "https://stackoverflow.com/users/4325709/severi-j%c3%a4%c3%a4skel%c3%a4inen"}, "is_accepted": false, "score": 4, "last_activity_date": 1506934595, "last_edit_date": 1506934595, "creation_date": 1506934232, "answer_id": 46522302, "question_id": 46516500, "link": "https://stackoverflow.com/questions/46516500/how-to-translate-logical-notation-to-haskell-syntax/46522302#46522302", "title": "How to translate logical notation to Haskell syntax", "body": "<blockquote>\n  <p>How do I declare type or data(not a variable) for fixed values, namely 0-9?</p>\n</blockquote>\n\n<p>You can define a type, like</p>\n\n<pre><code>data Digit = Zero | One | Two | Three | Four | Five | Six | Seven | Eight | Nine deriving (Eq, Show)\n</code></pre>\n\n<p>This represents the <code>num</code> in your problem. Obviously we cannot use <code>0, 1, 2, 3, ...</code> since they are already interpreted as numbers in Haskell.</p>\n\n<p>Then, you can define</p>\n\n<pre><code>data Number = Single Digit | Many Digit Number deriving (Eq, Show)\n</code></pre>\n\n<p>which is equivalent to <code>int</code> in your problem. This type represents one (<code>Single ...</code>) or more (<code>Many ...</code>) digits, which together make a one decimal number. For example, with these data types a number 361 would be <code>Many Three (Many Six (Single One))</code>.</p>\n\n<blockquote>\n  <p>Also, how can I put symbols like - or + in a declaration?</p>\n</blockquote>\n\n<p>There is no way to put those symbols in type or data declarations. You can use, however, names for the operations, like <code>Sum</code>, <code>Sub</code> and <code>Mul</code>. Then the <code>expr</code> of the grammar of your problem would translate to</p>\n\n<pre><code>data Expr   = Lit Number\n            | Sub Expr Expr\n            | Sum Expr Expr\n            | Mul Expr Expr\n            deriving (Eq, Show)\n</code></pre>\n\n<p>If we would have a string <code>\"+ (- (2 5) (1 3)) 3\"</code>, which represents an expression in the prefix calculator language of your problem , it would be parsed to <code>Sum (Sub (Lit (Many Two (Single Five))) (Lit (Many One (Single Three)))) (Single Three)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 0, "last_activity_date": 1507058337, "last_edit_date": 1507058337, "creation_date": 1507058030, "answer_id": 46551798, "question_id": 46516500, "link": "https://stackoverflow.com/questions/46516500/how-to-translate-logical-notation-to-haskell-syntax/46551798#46551798", "title": "How to translate logical notation to Haskell syntax", "body": "<p>Years ago, I got clever, and I declared my AST type an <code>instance</code> of <code>Num</code>, <code>Eq</code> and <code>Ord</code>, then defined the mathematical and comparison operators for AST expressions, so that <code>expr1 + expr2</code> would yield a valid AST.  Using sevenj\u2019s declarations, this would be written like <code>(+) x y = Sum x y</code>, where the right-hand side is the constructor of an AST expression.  For brevity, <code>one = Lit One</code> and <code>two = Lit Two</code>.  Then you might write <code>one + one == two</code> and the operators would generate your AST with the correct precedence.  Between that and abuse of the <code>let { ... } in ...</code> syntax to allow for arbitrary indentation, I had a way to write ASTs that was almost just the toy imperative language itself, with some boilerplate above, below and on the left.</p>\n\n<p>The TA grading my assignment, though, was not amused, and wrote, \u201cThis is not Haskell!\u201d</p>\n"}], "owner": {"reputation": 163, "user_id": 4176054, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9b3dea5d8110fa3b72db315ea5b9a03e?s=128&d=identicon&r=PG&f=1", "display_name": "Sifu", "link": "https://stackoverflow.com/users/4176054/sifu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1507058337, "creation_date": 1506889014, "question_id": 46516500, "link": "https://stackoverflow.com/questions/46516500/how-to-translate-logical-notation-to-haskell-syntax", "title": "How to translate logical notation to Haskell syntax", "body": "<p>I've recently picked up Haskell at uni and I'm working my way through a set of exercises, here's a snippet of one that I can't make sense of:</p>\n\n<p>\"Consider the following grammar for a simple, prefix calculator language:\"</p>\n\n<pre><code>num ::= 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9\nint ::= num | num int\nexpr ::= int | - expr | + expr expr | * expr expr\n</code></pre>\n\n<p>I'm confused as how to translate this into Haskell syntax (I'm a complete beginner in both Haskell and functional programming, please be gentle)</p>\n\n<p>I suspect that <code>num</code>, <code>int</code> and <code>expr</code> are all, supposedly, types/values that can be declared using <code>data</code> or <code>type</code> and that they impose constraints on the calculator. However I can't make sense of either: How do I declare <code>type</code> or <code>data</code>(not a variable) for fixed values, namely 0-9? Also, how can I put symbols like <code>-</code> or <code>+</code> in a declaration?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 8984, "user_id": 2485966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZj6A.jpg?s=128&g=1", "display_name": "Ruud Helderman", "link": "https://stackoverflow.com/users/2485966/ruud-helderman"}, "edited": false, "score": 2, "creation_date": 1506884619, "post_id": 46515794, "comment_id": 79985876, "body": "What, in your opinion, is supposed to happen if the string contains characters that do not occur in <code>a1</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "edited": false, "score": 3, "creation_date": 1506886719, "post_id": 46515884, "comment_id": 79986474, "body": "Those aren&#39;t the only two possibilities: they might want to propagate a <code>Nothing</code> with <code>(+) &lt;$&gt; lookup c a1 &lt;*&gt; strToInt cs</code>."}], "tags": [], "owner": {"reputation": 1021, "user_id": 8704792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b376a8f499db34625d4b2d172bf0c4e4?s=128&d=identicon&r=PG&f=1", "display_name": "Anson Miu", "link": "https://stackoverflow.com/users/8704792/anson-miu"}, "is_accepted": false, "score": 1, "last_activity_date": 1506884832, "creation_date": 1506884832, "answer_id": 46515884, "question_id": 46515794, "link": "https://stackoverflow.com/questions/46515794/haskell-operate-on-the-return-value-of-a-lookup-call/46515884#46515884", "title": "Haskell operate on the return value of a lookup call", "body": "<p>If the precondition is that the lookup will always be successful, use <code>fromJust :: Maybe a -&gt; a</code> to parse the value - for example, <code>fromJust (lookup c al)</code>.</p>\n\n<p>Otherwise, you will need some 'default' value (e.g. <code>0</code>) to return in case the lookup fails. Then you can use <code>fromMaybe :: a -&gt; Maybe a -&gt; a</code> which takes the default value as the first parameter and parses the value - for example, <code>fromMaybe 0 (lookup c a1)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 2, "last_activity_date": 1506886820, "creation_date": 1506886820, "answer_id": 46516192, "question_id": 46515794, "link": "https://stackoverflow.com/questions/46515794/haskell-operate-on-the-return-value-of-a-lookup-call/46516192#46516192", "title": "Haskell operate on the return value of a lookup call", "body": "<p>In this case, since you're adding values together, and it'd be natural to ignore <code>Nothing</code> values (i.e. treat them as <code>0</code>), you could also write the function using <code>mapMaybe</code>:</p>\n\n<pre><code>import Data.Maybe (mapMaybe)\n\nal :: [(Char, Int)]\nal = [('A', 1), ('B', 2), ('C', 3)]\n\nstrToInt :: String -&gt; Int\nstrToInt = sum . mapMaybe (`lookup` al)\n</code></pre>\n\n<p>GHCi:</p>\n\n<pre><code>*Q46515794&gt; strToInt \"AB\"\n3\n*Q46515794&gt; strToInt \"AC\"\n4\n*Q46515794&gt; strToInt \"ABC\"\n6\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 1, "last_activity_date": 1506887666, "creation_date": 1506887666, "answer_id": 46516306, "question_id": 46515794, "link": "https://stackoverflow.com/questions/46515794/haskell-operate-on-the-return-value-of-a-lookup-call/46516306#46516306", "title": "Haskell operate on the return value of a lookup call", "body": "<p>I guess you have to have control on  your logic. It is not known what you want when the character you provide returns <code>Nothing</code>, this function better return a <code>Maybe</code> type.</p>\n\n<p>If you want to treat <code>Nothing</code>s as <code>0</code> then <code>mapMaybe</code> is one way to go. Or if you want a <code>Maybe</code> type result then...</p>\n\n<pre><code>al :: [(Char, Int)]\nal = [('A', 1), ('B', 2), ('C', 3), ('D', 4)]\n\nstrToInt :: [(Char, Int)] -&gt; String -&gt; Maybe Int\nstrToInt ts cs = foldr (\\c m -&gt; (+) &lt;$&gt; (lookup c ts) &lt;*&gt; m) (Just 0) cs\n\n*Main&gt; strToInt al \"AJN\"\nNothing\n*Main&gt; strToInt al \"ABCD\"\nJust 10\n</code></pre>\n"}], "owner": {"reputation": 340, "user_id": 4346886, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/r5i1C.jpg?s=128&g=1", "display_name": "Adam Griffiths", "link": "https://stackoverflow.com/users/4346886/adam-griffiths"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 931, "favorite_count": 0, "closed_date": 1506888534, "accepted_answer_id": 46516192, "answer_count": 3, "score": 1, "last_activity_date": 1506887666, "creation_date": 1506884318, "question_id": 46515794, "link": "https://stackoverflow.com/questions/46515794/haskell-operate-on-the-return-value-of-a-lookup-call", "closed_reason": "Duplicate", "title": "Haskell operate on the return value of a lookup call", "body": "<p>I have the following code (using lookup from the Haskell Prelude):</p>\n\n<pre><code>al :: [(Char, Int)]\nal = [(\"A\", 1),\n      (\"B\", 2),\n      (\"C\", 3),\n      ...\n ]\n\nstrToInt :: [Char] -&gt; Int\nstrToInt []\n = 0\nstrToInt (c:cs)\n = lookup c al + strToInt cs\n</code></pre>\n\n<p>The problem is I am trying to perform addition on <code>Maybe Int</code> and <code>Int</code> which the compiler will not allow. How can I resolve this issue?</p>\n"}, {"tags": ["windows", "haskell", "gcc", "cabal", "gobject"], "answers": [{"tags": [], "owner": {"reputation": 3411, "user_id": 69663, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aiMZN.png?s=128&g=1", "display_name": "unhammer", "link": "https://stackoverflow.com/users/69663/unhammer"}, "is_accepted": false, "score": 1, "last_activity_date": 1511444321, "creation_date": 1511444321, "answer_id": 47456886, "question_id": 46513880, "link": "https://stackoverflow.com/questions/46513880/haskell-platform-cabal-installation-of-package-haskell-gi-fails-while-link/47456886#47456886", "title": "Haskell Platform / Cabal - Installation of package &#39;haskell-gi&#39; fails while linking due to &#39;undefined references&#39;", "body": "<p>I don't know what the packages are called on Windows, but on Ubuntu I had to install the C libs/headers for GTK and GI separately with</p>\n\n<pre><code>sudo apt install libgirepository1.0-dev \nsudo apt install libgtk-3-dev\n</code></pre>\n\n<p>since <code>cabal</code> (or in my case, <code>stack</code>) did not install these for me (though I got <a href=\"https://github.com/lettier/gifcurry/issues/17#issue-270415699\" rel=\"nofollow noreferrer\">different error messages</a>). </p>\n\n<p>You don't say if you've already done this, but <a href=\"https://www.gtk.org/download/windows.php\" rel=\"nofollow noreferrer\">https://www.gtk.org/download/windows.php</a> says you should</p>\n\n<pre><code>pacman -S mingw-w64-x86_64-gtk3 \npacman -S mingw-w64-x86_64-toolchain base-devel \n</code></pre>\n\n<p>since you've already got MSYS.</p>\n\n<p>It might be helpful if you can post your cabal settings or link to a repo.</p>\n\n<p>(You might also find <a href=\"https://github.com/lettier/movie-monad\" rel=\"nofollow noreferrer\">https://github.com/lettier/movie-monad</a> useful to look at for your project.)</p>\n"}], "owner": {"reputation": 1233, "user_id": 7970829, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OGdYb.png?s=128&g=1", "display_name": "oRole", "link": "https://stackoverflow.com/users/7970829/orole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1511444321, "creation_date": 1506871653, "question_id": 46513880, "link": "https://stackoverflow.com/questions/46513880/haskell-platform-cabal-installation-of-package-haskell-gi-fails-while-link", "title": "Haskell Platform / Cabal - Installation of package &#39;haskell-gi&#39; fails while linking due to &#39;undefined references&#39;", "body": "<p><strong>Background</strong> <br/>\nCurrently, I'm working on a project that deals with Computer Vision. <br/><br/>\nI use .. <br/>\n- Haskell as programming language. <br/>\n- GTK+ for creating the GUI. <br/>\n- FFmpeg to read and extract videos/frames from paths or the webcam.<br/>\n- some algorithms for edge-detection.</p>\n\n<p>I want to .. <br/>\n- render videos (unmodified input video, aswell as the modified output video) to a drawingarea-widget that is part of the GTK-library.</p>\n\n<p><strong>My setup</strong> <br/>\n- Windows 10 - 64 bit <br/>\n- MSYS2 / Mingw32 <br/>\n- Haskell Platform (GHC 8.0.1) <br/>\n- Cabal Version 1.24.0.0 <br/>\n- ffmpeg-light-0.12.0 <br/>\n- gtk-0.14.6</p>\n\n<p><strong>Problem</strong><br/>\nTo render videos with GTK I need to install bindings for GI, so I tried to install the package <strong>'haskell-gi'</strong> but it fails at linking-phase due to <strong>undefined references</strong>.</p>\n\n<p><strong>Example</strong><br/>\nAfter running <code>cabal install haskell-gi</code> i get:<br/></p>\n\n<pre><code>C:\\Users\\Roland\\AppData\\Local\\Temp\\cabal-tmp-1788\\haskell-gi-0.20.3\\dist\\build/libHShaskell-gi-0.20.3-4ylmwt0eEVy4Aeczi0KBpN.a(LibGIRepository.o):fake:(.text+0x19d8): undefined reference to `g_irepository_require'\nC:\\Users\\Roland\\AppData\\Local\\Temp\\cabal-tmp-1788\\haskell-gi-0.20.3\\dist\\build/libHShaskell-gi-0.20.3-4ylmwt0eEVy4Aeczi0KBpN.a(LibGIRepository.o):fake:(.text+0x1f59): undefined reference to `g_typelib_symbol'\nC:\\Users\\Roland\\AppData\\Local\\Temp\\cabal-tmp-1788\\haskell-gi-0.20.3\\dist\\build/libHShaskell-gi-0.20.3-4ylmwt0eEVy4Aeczi0KBpN.a(LibGIRepository.o):fake:(.text+0x26f3): undefined reference to `g_irepository_prepend_search_path'\nC:\\Users\\Roland\\AppData\\Local\\Temp\\cabal-tmp-1788\\haskell-gi-0.20.3\\dist\\build/libHShaskell-gi-0.20.3-4ylmwt0eEVy4Aeczi0KBpN.a(LibGIRepository.o):fake:(.text+0x2bee): undefined reference to `g_base_info_gtype_get_type'\nC:\\Users\\Roland\\AppData\\Local\\Temp\\cabal-tmp-1788\\haskell-gi-0.20.3\\dist\\build/libHShaskell-gi-0.20.3-4ylmwt0eEVy4Aeczi0KBpN.a(LibGIRepository.o):fake:(.text+0x2f2e): undefined reference to `g_irepository_find_by_name'\nC:\\Users\\Roland\\AppData\\Local\\Temp\\cabal-tmp-1788\\haskell-gi-0.20.3\\dist\\build/libHShaskell-gi-0.20.3-4ylmwt0eEVy4Aeczi0KBpN.a(LibGIRepository.o):fake:(.text+0x42c7): undefined reference to `g_struct_info_get_field'\nC:\\Users\\Roland\\AppData\\Local\\Temp\\cabal-tmp-1788\\haskell-gi-0.20.3\\dist\\build/libHShaskell-gi-0.20.3-4ylmwt0eEVy4Aeczi0KBpN.a(LibGIRepository.o):fake:(.text+0x460b): undefined reference to `g_struct_info_get_n_fields'\nC:\\Users\\Roland\\AppData\\Local\\Temp\\cabal-tmp-1788\\haskell-gi-0.20.3\\dist\\build/libHShaskell-gi-0.20.3-4ylmwt0eEVy4Aeczi0KBpN.a(LibGIRepository.o):fake:(.text+0x4775): undefined reference to `g_struct_info_get_size'\nC:\\Users\\Roland\\AppData\\Local\\Temp\\cabal-tmp-1788\\haskell-gi-0.20.3\\dist\\build/libHShaskell-gi-0.20.3-4ylmwt0eEVy4Aeczi0KBpN.a(LibGIRepository.o):fake:(.text+0x4aef): undefined reference to `g_union_info_get_field'\nC:\\Users\\Roland\\AppData\\Local\\Temp\\cabal-tmp-1788\\haskell-gi-0.20.3\\dist\\build/libHShaskell-gi-0.20.3-4ylmwt0eEVy4Aeczi0KBpN.a(LibGIRepository.o):fake:(.text+0x4e33): undefined reference to `g_union_info_get_n_fields'\nC:\\Users\\Roland\\AppData\\Local\\Temp\\cabal-tmp-1788\\haskell-gi-0.20.3\\dist\\build/libHShaskell-gi-0.20.3-4ylmwt0eEVy4Aeczi0KBpN.a(LibGIRepository.o):fake:(.text+0x4f9d): undefined reference to `g_union_info_get_size'\ncollect2.exe: error: ld returned 1 exit status\n`gcc.exe' failed in phase `Linker'. (Exit code: 1)\ncabal: Leaving directory 'C:\\Users\\Roland\\AppData\\Local\\Temp\\cabal-tmp-1788\\haskell-gi-0.20.3'\ncabal: Error: some packages failed to install:\nhaskell-gi-0.20.3 failed during the building phase. The exception was:\nExitFailure 1\n</code></pre>\n\n<p><strong>Note</strong><br/>\nThis undefined references are methods which are defined in .c/.h-files which are part of GObjects' gobject-introspection folder. </p>\n\n<p><strong>What have I tried so far?</strong><br/>\nWhilst installing Gtk2Hs and ffmpeg-light I was facing similar problems but I was able to get rid off by .. <br/>\n- downloading the development-source-files and adding --extra-include-dir or --extra-lib-dir tags to the cabal installation <br/>\n- adding linker flags (pkg-config --libs gobject-introspection-1.0) to the cabal settings <br/>\n- downloading missing libraries and adding them to the PATH <br/>\n- modifying .pc files (that are part of the package-config) <br/></p>\n\n<p>None of the options above worked with <strong>'haskell-gi'</strong>. I also searched SO for related things but that didn't work too.</p>\n\n<p><strong>Question</strong> <br/>\nDoes anyone of you have an idea how to get over this problem? Any help appreciated.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "is_accepted": false, "score": 4, "last_activity_date": 1506854391, "creation_date": 1506854391, "answer_id": 46511569, "question_id": 46511476, "link": "https://stackoverflow.com/questions/46511476/modify-the-parameter-of-a-function-only-once/46511569#46511569", "title": "Modify the parameter of a function only once", "body": "<p>You could wrap the function into an \"entry-point\" function that does the pre-processing of the externally received parameters:</p>\n\n<pre><code> totaltime t route =\n   totaltime' t ((0,0):route)\n   where\n      totaltime' t [x] = 0\n      totaltime' t route = .....\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 0, "creation_date": 1506855753, "post_id": 46511574, "comment_id": 79977480, "body": "Do you really need the empty list case, though? Seems it starts with at least one element (that dummy we added) and shrinks by exactly one each iteration. Of course, maybe we can add the empty case to then avoid the wrapper altogether."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 0, "creation_date": 1506855886, "post_id": 46511574, "comment_id": 79977516, "body": "@Thilo: personally I more fan of constructing functions that handle all possible patterns (one can throw an <code>error &quot;Should not occur&quot;</code>). But simply leave it that way, is imho not a good idea."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1506855898, "post_id": 46511574, "comment_id": 79977517, "body": "I&#39;d be tempted to go further. In the last attempt, there&#39;s no real way to define the empty case, and we don&#39;t even need that. I&#39;d pass the first list element to <code>tt</code> as another argument. E.g. <code>tt t (0,0) l</code> where <code>tt t x [] = 0 ; tt t (x0,_) xys@(...)=...</code>. (Still, the direction is the right one, so +1)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1506862774, "post_id": 46511574, "comment_id": 79979343, "body": "Another option is to use a <code>NonEmpty</code>. This seems clearer than an extra argument, and will likely be optimized away."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 7, "last_activity_date": 1506856169, "last_edit_date": 1506856169, "creation_date": 1506854457, "answer_id": 46511574, "question_id": 46511476, "link": "https://stackoverflow.com/questions/46511476/modify-the-parameter-of-a-function-only-once/46511574#46511574", "title": "Modify the parameter of a function only once", "body": "<p><strong>Short answer</strong>: you can scope the function <code>totaltime</code> into a <code>where</code> clause, and expose another function that prepends the list with <code>(0,0)</code>:</p>\n\n<pre><code>totaltime t l = tt t ((0,0):l)\nwhere tt t [x] = 0\n      tt t route = tbd + tt (t+tbd) (tail(route))\n          where tbd = timebetweendepartures (fst(route!!0)) (fst(route!!1)) t (snd(route!!1))\n</code></pre>\n\n<p>But that being said, the code is quite inelegant and probably unsafe:</p>\n\n<ul>\n<li>you do not define a case for an empty list;</li>\n<li>the case that is used for the empty list is the second clause, where you call <code>!!0</code> and <code>!!1</code> which are functions that are not <em>total</em>.</li>\n</ul>\n\n<p>Furthermore it is not very elegant you call <code>fst</code> and <code>snd</code>. We can introduce patterns in the head of the clause that ususally make it more elegant and easier to understand. We can thus rewrite our <code>tt</code> function to:</p>\n\n<pre><code>tt t [] = ... # create a case for the empty list\ntt t [x] = 0\ntt t ((x0,_):xys@((x1,y1):_)) = tbd + tt (t+tbd) xys\n    where tbd = timebetweendepartures x0 x1 t y1\n</code></pre>\n\n<p>so now we can use it like:</p>\n\n<pre><code>totaltime t l = tt t ((0,0):l)\n    where tt t [] = ... # create a case for the empty list\n          tt t [x] = 0\n          tt t ((x0,_):xys@((x1,y1):_)) = tbd + tt (t+tbd) xys\n              where tbd = timebetweendepartures x0 x1 t y1\n</code></pre>\n\n<p>Of course in this case, it would be impossible to ever handle the empty list, since <code>totaltime</code> prepends <code>(0,0)</code> we have guarantees that the initial call is a call with at least one element, and we perform recursion on the direct tail, so that means that the list decreases with one at a time.</p>\n\n<p>We still can however improve the function by using three arugments: the <code>t</code> variable; the head of the list, the tail of the list, and rewrite it to:</p>\n\n<pre><code>totaltime t = tt t (0,0)\n    where tt _ _ [] = 0\n          tt t (x0,_) (xyh@(x1,y1):xyt) = tbd + tt (t+tbd) xyh xyt\n              where tbd = timebetweendepartures x0 x1 t y1\n</code></pre>\n\n<p>Now the code is syntactically total, and furthermore it can boost efficiency (since we avoid unpacking some parts of the list twice.</p>\n\n<p>We can still improve the code. Notice that we only take the <em>first</em> element of the head of the list (we do not use an <code>y0</code> variable). So we can omit packing and unpackand and rewrite it to:</p>\n\n<pre><code>totaltime t = tt t <b>0</b>\n    where tt _ _ [] = 0\n          tt t <b>x0</b> ((x1,y1):xyt) = tbd + tt (t+tbd) <b>x1</b> xyt\n              where tbd = timebetweendepartures x0 x1 t y1</code></pre>\n\n<p>Now we save on unpacking tuples and it is more clear what we do.</p>\n"}], "owner": {"reputation": 115, "user_id": 4722385, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/458489274306870/picture?type=large", "display_name": "Adyy Pop", "link": "https://stackoverflow.com/users/4722385/adyy-pop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 46511574, "answer_count": 2, "score": 4, "last_activity_date": 1506856169, "creation_date": 1506853639, "question_id": 46511476, "link": "https://stackoverflow.com/questions/46511476/modify-the-parameter-of-a-function-only-once", "title": "Modify the parameter of a function only once", "body": "<p>I started with Haskell a few days ago. \nI have the following piece of code (recursive function):</p>\n\n<pre><code>totaltime t [x] = 0\ntotaltime t route = tbd + totaltime (t+tbd) (tail(route))\n    where tbd = timebetweendepartures (fst(route!!0)) (fst(route!!1)) t (snd(route!!1))\n</code></pre>\n\n<p>\"route\" is a list of tuples, e.g: [(3,1), (1,2), (5,2), (2,1)]</p>\n\n<p>What I'm trying to do, is to add (0,0) to the route before the function even starts doing what it's supposed to do.</p>\n\n<p>So if the parameter route is passed as [(3,1), (1,2), (5,2), (2,1)] then the function should receive it as [(0,0), (3,1), (1,2), (5,2), (2,1)]</p>\n\n<p>I could just do <code>totaltime t ((0,0):route)</code>, but since the function is recursive this won't work as intended. </p>\n\n<p>Ideas are much appreciated!</p>\n"}, {"tags": ["scala", "haskell", "category-theory"], "comments": [{"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 7, "creation_date": 1506846386, "post_id": 46510557, "comment_id": 79975162, "body": "By the way, you can now find a nicely-formatted PDF version of this text <a href=\"https://github.com/hmemcpy/milewski-ctfp-pdf\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 6, "creation_date": 1506846602, "post_id": 46510557, "comment_id": 79975216, "body": "In the first paragraph, Bartosz writes: &quot;A category consists of objects and arrows that go between them.&quot; So no, Bool does not (as you&#39;ve described it) constitute a category - you need to define a category in terms of both objects and arrows. But yes, there are categories in which True and False are the objects, you just also have to specify what arrows you want."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1506851250, "post_id": 46510557, "comment_id": 79976270, "body": "Category theory is arguably one of the most abstract disciplines of mathematics. I&#39;d strongly recommend you get a solid grasp of functional programming first before adventuring in that. Bartosz does a great job in trying to explaining it by making examples using FP. Most other explanations, e.g. as found in Wikipedia or math books, will easily be more abstract, and will make examples from topology, group theory, linear algebra, etc. which will provide no help unless you are already familiar with those."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1506851488, "post_id": 46510557, "comment_id": 79976320, "body": "@chi, where can I find such a book about topology, etc?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1506851775, "post_id": 46510557, "comment_id": 79976405, "body": "@zero_coding To learn all of that you would essentially need to attend a full math bachelor programme, at the very least. You <i>can</i> learn some category theory without that, though. But I can&#39;t really suggest you try until at least basic FP is very clear to you."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1506852004, "post_id": 46510557, "comment_id": 79976466, "body": "If you want a more computer-science-oriented path towards CT you can try some books/papers from <a href=\"https://github.com/steshaw/plt\" rel=\"nofollow noreferrer\">here</a>. There is a <i>lot</i> of material, though!"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1506864824, "post_id": 46510557, "comment_id": 79979875, "body": "You can google up about a zillion definitions of a category, why do you think you will get a better definition here?"}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1506881129, "post_id": 46510557, "comment_id": 79984678, "body": "I found this definition of <i>Category</i> in this post very nice: <a href=\"https://www.reddit.com/r/haskellquestions/comments/73ktlh/what_is_exactly_a_category/\" rel=\"nofollow noreferrer\">reddit.com/r/haskellquestions/comments/73ktlh/&hellip;</a>  Though it&#39;s not simple like <i>explain what is category if I&#39;m 5 year old</i>. But for mathematician or not-so-dumb programmer good enough."}], "answers": [{"tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 0, "last_activity_date": 1506847692, "creation_date": 1506847692, "answer_id": 46510721, "question_id": 46510557, "link": "https://stackoverflow.com/questions/46510557/what-exactly-is-a-category/46510721#46510721", "title": "What exactly is a category?", "body": "<p>If you are talking about <code>Hask</code> category, then no. <code>Hask</code> is the category and the objects are Haskell types. That is, <code>Bool</code> is an object, and <code>True</code>/<code>False</code> aren't even talked about here. The description of Hask can be found on <a href=\"https://wiki.haskell.org/Hask\" rel=\"nofollow noreferrer\">Haskell wiki</a>. There are also talks, that <code>Hask</code> isn't even a proper category, <a href=\"http://math.andrej.com/2016/08/06/hask-is-not-a-category/\" rel=\"nofollow noreferrer\">read this</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 15, "last_activity_date": 1506884707, "creation_date": 1506884707, "answer_id": 46515860, "question_id": 46510557, "link": "https://stackoverflow.com/questions/46510557/what-exactly-is-a-category/46515860#46515860", "title": "What exactly is a category?", "body": "<p>One reason you're getting a lot of potentially confusing answers is that your question is a little like asking:  \"Let's consider a soccer ball.  Is the soccer ball a 'game' with the black and white polygons its 'pieces'?\"</p>\n\n<p>The answer might be @arrowd's answer:  \"No, you've confused the game of soccer (<code>Hask</code>) with its ball (<code>Bool</code>), and the polygons (<code>True</code> and <code>False</code>) don't matter.\"  Or, it might be @freestyle's answer:  \"Yes, we could certainly create a game using the soccer ball and assign one player to the black polygons and the other player the white polygons, but what would the rules be?\"  Or, it might be @Yuval Itzchakov's answer:  \"Formally, a 'game' is a collection of one or more players, zero or more pieces, and a set of rules such that, etc., etc.\"</p>\n\n<p>So, let me add to the confusion with one more (very long) answer, but maybe it will answer your question a little more directly.</p>\n\n<h2>Yes, but it's a boring category</h2>\n\n<p>Instead of talking about the Haskell type <code>Bool</code>, let's just talk about the abstract concept of boolean logic and the boolean values true and false.  Can we form a category with the abstract values \"true\" and \"false\" as the objects?</p>\n\n<p>The answer is definitely yes.  In fact, we can form (infinitely) many such categories.  All we need to do is explain what the \"objects\" are, what the \"arrows\" (sometimes called morphisms) are, and make sure that they obey the formal mathematical rules for categories.</p>\n\n<p>Here is one category:  Let the \"objects\" be \"true\" and \"false\", and let there be two \"arrows\":</p>\n\n<pre><code>true -&gt; true\nfalse -&gt; false\n</code></pre>\n\n<p><strong>Note:</strong> Don't confuse this <code>-&gt;</code> notation with Haskell functions.  These arrows don't \"mean\" anything yet, they are just abstract connections between objects.</p>\n\n<p>Now, I know this is a category because it includes both identity arrows (from an object to itself), and it satisfies the composition property which basically says that if I can follow two arrows from <code>a -&gt; b -&gt; c</code> , then there must be a direct arrow <code>a -&gt; c</code> representing their \"composition\".  (<strong>Again</strong>, when I write <code>a -&gt; b -&gt; c</code>, I'm <strong>not</strong> talking about a function type here -- these are abstract arrows connecting <code>a</code> to <code>b</code> and then <code>b</code> to <code>c</code>.)  Anyway, I don't have enough arrows to worry too much about composition for this category because I don't have any \"paths\" between different objects.  I will call this the \"Discrete Boolean\" category.  I agree that it is mostly useless, just like a game based on the polygons of a soccer ball would be pretty stupid.</p>\n\n<h2>Yes, but it has nothing to do with boolean values</h2>\n\n<p>Here's a slightly more interesting category.  Let the objects be \"true\" and \"false\", and let the arrows be the two identity arrows above plus:</p>\n\n<pre><code>false -&gt; true\n</code></pre>\n\n<p>This is a category, too.  It has all the identity arrows, and it satisfies composition because, ignoring the identity arrows, the only interesting \"path\" I can follow is from \"false\" to \"true\", and there's nowhere else to go, so I still don't really have enough arrows to worry about the composition rule.</p>\n\n<p>There are a couple more categories you could write down here.  See if you can find one.</p>\n\n<p>Unfortunately, these last two categories don't really have anything to do with the properties of boolean logic.  It's true that <code>false -&gt; true</code> looks a little like a <code>not</code> operation, but then how could we explain <code>false -&gt; false</code> or <code>true -&gt; true</code>, and why isn't <code>true -&gt; false</code> there, too?</p>\n\n<p>Ultimately, we could just as easily have called these objects \"foo\" and \"bar\" or \"A\" and \"B\" or not even bothered to name them, and the categories would be just as valid.  So, while <em>technically</em> these are categories with \"true\" and \"false\" as objects, they don't capture anything interesting about boolean logic.</p>\n\n<h2>Quick aside: multiple arrows</h2>\n\n<p>Something I haven't mentioned yet is that categories can contain multiple, distinct arrows between two objects, so there could be two arrows from <code>a</code> to <code>b</code>.  To differentiate them, I might give them names, like:</p>\n\n<pre><code>u : a -&gt; b\nv : a -&gt; b\n</code></pre>\n\n<p>I could even have an arrow <em>separate</em> from the identity from <code>b</code> to itself:</p>\n\n<pre><code>w : b -&gt; b      -- some non-identity arrow\n</code></pre>\n\n<p>The composition rule would have to be satisfied by all the different paths.  So, because there's a path <code>u : a -&gt; b</code> and a path <code>w : b -&gt; b</code> (even though it doesn't \"go\" anywhere else), there would have to be an arrow representing the composition of <code>u</code> followed by <code>w</code> from <code>a -&gt; b</code>.  Its value <em>might</em> be equal to \"u\" again, or it <em>might</em> be \"v\", or it <em>might</em> be some other arrow from <code>a -&gt; b</code>.  Part of describing a category is explaining how all the arrows compose and demonstrating that they obey the category laws (the unit law and the associative law, but let's not worry about those laws here).</p>\n\n<p>Armed with this knowledge, you can create an infinite number of boolean categories just by adding more arrows wherever you want and inventing any rules you'd like about how they should compose, subject to the category laws.</p>\n\n<h2>Sort of, if you use more complicated objects</h2>\n\n<p>Here's a more interesting category that captures some of the \"meaning\" of boolean logic.  It's kind of complicated to explain, so bear with me.</p>\n\n<p>Let the objects be boolean expressions with zero or more boolean variables:</p>\n\n<pre><code>true\nfalse\nnot x\nx and y\n(not (y or false)) and x\n</code></pre>\n\n<p>We'll consider expressions that are \"always the same\" to be the same object, so <code>y or false</code> and <code>y</code> are the same object, since no matter what the value of <code>y</code> is, they have the same boolean value.  That means that the last expression above could have been written <code>(not y) and x</code> instead.</p>\n\n<p>Let the arrows represent the act of setting zero or more boolean variables to specific values.  We'll label these arrows with little annotations, so that the arrow <code>{x=false,y=true}</code> represents the act of setting two variables as indicated.  We'll assume that the settings are applied in order, so the arrow <code>{x=false,x=true}</code> would have the same effect on an expression as <code>{x=false}</code>, even though they're different arrows.  That means that we have arrows like:</p>\n\n<pre><code>{x=false} : not x -&gt; true\n{x=true,y=true} : x and y -&gt; true\n</code></pre>\n\n<p>We also have:</p>\n\n<pre><code>{x=false} : x and y -&gt; false and y  -- or just \"false\", the same thing\n</code></pre>\n\n<p>Technically, the two arrows labelled <code>{x=false}</code> are different arrows.  (They can't be the same arrow because they're arrows between different objects.)  It's very common in category theory to use the same name for different arrows like this if they have the same \"meaning\" or \"interpretation\", like these ones do.</p>\n\n<p>We'll define composition of arrows to be the act of applying the sequence of settings in the first arrow and then applying the settings from the second arrow, so the composition of:</p>\n\n<pre><code>{x=false}: x or y -&gt; y     and    {y=true} : y -&gt; true\n</code></pre>\n\n<p>is the arrow:</p>\n\n<pre><code>{x=false,y=true}: x or y -&gt; true\n</code></pre>\n\n<p>This is a category.  It has identity arrows for every expression, consisting of not setting any variables:</p>\n\n<pre><code>{} : true -&gt; true\n{} : not (x or y) and (u or v) -&gt; not (x or y) and (u or v)\n</code></pre>\n\n<p>It defines composition for every pair of arrows, and the compositions obey the unit and associative laws (again, let's not worry about that detail here).</p>\n\n<p>And, it represents a particular aspect of boolean logic, specifically the act of calculating the value of a boolean expression by substituting boolean values into variables.</p>\n\n<h2>Hey, look!  A Functor!</h2>\n\n<p>It also has a somewhat interesting functor which we might call \"Negate\".  I won't explain what a functor is here.  I'll just say that Negate maps this category to itself by:</p>\n\n<ul>\n<li>taking each object (boolean expression) to its logical negation</li>\n<li>taking each arrow to a new arrow representing the same variable substitutions</li>\n</ul>\n\n<p>So, the arrow:</p>\n\n<pre><code>{a=false} : (not a) and b -&gt; b\n</code></pre>\n\n<p>gets mapped by the Negate functor to:</p>\n\n<pre><code>{a=false} : not ((not a) and b) -&gt; not b\n</code></pre>\n\n<p>or more simply, using the rules of boolean logic:</p>\n\n<pre><code>{a=false} : a or (not b) -&gt; not b\n</code></pre>\n\n<p>which is a valid arrow in the original category.</p>\n\n<p>This functor captures the idea that \"negating a boolean expression\" is equivalent to \"negating its final result\", or maybe more generally that the process of substituting variables in a negated expression has the same structure as doing it to the original expression.  Maybe that's not too exciting, but this is just a long Stack Overflow answer, not a 500-page textbook on Category Theory, right?</p>\n\n<h2><code>Bool</code> as part of the <code>Hask</code> category</h2>\n\n<p>Now, let's switch from talking about abstract boolean categories to your specific question, whether the <code>Bool</code> Haskell <em>type</em> is a category with objects <code>True</code> and <code>False</code>.</p>\n\n<p>The answers above still apply, to the extent that this Haskell type can be used as a model of boolean logic.</p>\n\n<p>However, when people talk about categories in Haskell, they are usually talking about a specific category <code>Hask</code> where:</p>\n\n<ul>\n<li>the objects are types (like <code>Bool</code>, <code>Int</code>, etc.)</li>\n<li>the arrows are Haskell functions (like <code>f :: Int -&gt; Double</code>).  <strong>Finally</strong>, the Haskell syntax and our abstract category syntax coincide -- the Haskell function <code>f</code> can be thought of as an arrow from the object <code>Int</code> to the object <code>Double</code>).</li>\n<li>composition is regular function composition</li>\n</ul>\n\n<p>If we are talking about <em>this</em> category, then the answer to your question is:  no, in the <code>Hask</code> category, <code>Bool</code> is one of the objects, and the arrows are Haskell functions like:</p>\n\n<pre><code>id :: Bool -&gt; Bool\nnot :: Bool -&gt; Bool\n(==0) :: Int -&gt; Bool\n\nfoo :: Bool -&gt; Int\nfoo b = if b then 10 else 15\n</code></pre>\n\n<p>To make things more complicated, the objects <em>also</em> include types of functions, so <code>Bool -&gt; Bool</code> is one of the objects.  One example of an arrow that uses this object is:</p>\n\n<pre><code>and :: Bool -&gt; (Bool -&gt; Bool)\n</code></pre>\n\n<p>which is an arrow from the object <code>Bool</code> to the object <code>Bool -&gt; Bool</code>.</p>\n\n<p>In this scenario, <code>True</code> and <code>False</code> aren't part of the category.  Haskell values for function types, like <code>sqrt</code> or <code>length</code> are part of the category because they're arrows, but <code>True</code> and <code>False</code> are non-function types, so we just leave them out of the definition.</p>\n\n<h2>Category Theory</h2>\n\n<p>Note that this last category, like the first categories we looked at, has absolutely nothing to do with boolean logic, even though <code>Bool</code> is one of the objects.  In fact, in this category, <code>Bool</code> and <code>Int</code> look about the same -- they're just two types that can have arrows leaving or entering them, and you'd never know that <code>Bool</code> was about true and false or that <code>Int</code> represented integers, if you were just looking at the <code>Hask</code> category.</p>\n\n<p>This is a fundamental aspect of category theory.  You use a specific category to study a specific aspect of some system.  Whether or not <code>Bool</code> is a category or a part of category is sort of a vague question.  The better question would be, \"is this particular aspect of <code>Bool</code> that I'm interest in something that can be represented as a useful category?\"</p>\n\n<p>The categories I gave above roughly correspond to these potentially interesting aspects of <code>Bool</code>:</p>\n\n<ul>\n<li>The \"Discrete Boolean\" category represents <code>Bool</code> as a plain mathematical set of two objects, \"true\" and \"false\", with no additional interesting features.</li>\n<li>The \"false -> true\" category represents an ordering of boolean values, <code>false &lt; true</code>, where each arrow represents the operator '&lt;='.</li>\n<li>The boolean expression category represents an evaluation model for simple boolean expressions.</li>\n<li><code>Hask</code> represents the composition of functions whose input and output types may be a boolean type or a functional type involving boolean and other types.</li>\n</ul>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 2, "accepted_answer_id": 46515860, "answer_count": 2, "score": 9, "last_activity_date": 1506884707, "creation_date": 1506846248, "last_edit_date": 1506868289, "question_id": 46510557, "link": "https://stackoverflow.com/questions/46510557/what-exactly-is-a-category", "title": "What exactly is a category?", "body": "<p>I am reading <a href=\"https://bartoszmilewski.com/2014/10/28/category-theory-for-programmers-the-preface/\" rel=\"nofollow noreferrer\">Category Theory for Programmers</a>, and I cannot figure out what exactly a category is.</p>\n\n<p>Let's consider the <code>Bool</code> type. Is <code>Bool</code> a category and <code>True</code> or <code>False</code> are objects (inhabitants)?</p>\n"}, {"tags": ["haskell", "syntax", "guard-clause", "pattern-guards"], "comments": [{"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 3, "creation_date": 1506840367, "post_id": 46509876, "comment_id": 79973955, "body": "I would guess it is equivalen to logical and? But I could imagine, other haskell beginners will have the same question and therefore I thought, it migth be good, to raise this as question on stackoverflow."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1506854044, "post_id": 46509876, "comment_id": 79977002, "body": "even if you knew the answer it&#39;d be good to post this question (possibly together with an answer to it, if that were the case)."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1506857128, "post_id": 46509876, "comment_id": 79977832, "body": "updated <a href=\"https://wiki.haskell.org/Keywords#.2C\" rel=\"nofollow noreferrer\">the wiki</a>."}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 3, "creation_date": 1506843211, "post_id": 46509903, "comment_id": 79974497, "body": "You quoted the definition but seem to have missed the important part: &quot;<b>the bindings that are introduced by a guard ... are in scope in the following guards</b>&quot;. This is of course impossible if you replace all commas with <code>&amp;&amp;</code>s. For example, compare <code>case () of {() | x &lt;- 1, x == 1 -&gt; True}</code> with <code>case () of {() | x &lt;- 1 &amp;&amp; x == 1 -&gt; True}</code>. The code asked about in the original question even includes a use of this feature."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1506844254, "post_id": 46509903, "comment_id": 79974688, "body": "@amalloy Indeed. This feature is not redundant when pattern guards <code>p &lt;- e</code> or lets <code>let x = e</code> are involved. If a guard only uses boolean expressions, then commas can indeed by replaced by <code>&amp;&amp;</code>. I&#39;d say idiomatic Haskell uses <code>&amp;&amp;</code> if possible."}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1506844989, "post_id": 46509903, "comment_id": 79974823, "body": "Ah thank you, yes I was quite careless. Will make the appropriate corrections."}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 1, "creation_date": 1506958306, "post_id": 46509903, "comment_id": 80011829, "body": "I\u2019d say commas in guards are very common.  I use them all the time.  They can be avoided if you use view patterns, but I\u2019m not fond of those."}], "tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": true, "score": 28, "last_activity_date": 1507340899, "last_edit_date": 1507340899, "creation_date": 1506840299, "answer_id": 46509903, "question_id": 46509876, "link": "https://stackoverflow.com/questions/46509876/what-does-a-comma-in-the-guard-syntax-do/46509903#46509903", "title": "What does a comma in the guard syntax do?", "body": "<p>Guards are described in <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-460003.13\" rel=\"nofollow noreferrer\">Haskell 2010 section 3.13, <em>Case Expressions</em></a>\n (that section is about case expressions, not top-level declarations, but presumably the semantics are the same):</p>\n\n<pre><code><i>guards</i>  \u2192  | <i>guard</i><sub>1</sub>, \u2026, <i>guard</i><sub>n</sub>      (<i>n</i> \u2265 1)\n<i>guard</i>   \u2192  <i>pat</i> &lt;- <i>infixexp</i>         (pattern guard)\n        |  let <i>decls</i>               (local declaration)\n        |  <i>infixexp</i>                (boolean guard)</code></pre>\n\n\n\n<blockquote>\n  <p>For each guarded expression, the comma-separated guards are tried sequentially from left to right. If all of them succeed, then the corresponding expression is evaluated in the environment extended with the bindings introduced by the guards. That is, the bindings that are introduced by a guard (either by using a let clause or a pattern guard) are in scope in the following guards and the corresponding expression. If any of the guards fail, then this guarded expression fails and the next guarded expression is tried.</p>\n</blockquote>\n\n<p>In the simple case, the comma serves a role similar to Boolean <em>and</em>. But the comma is more powerful in that each guard can introduce new bindings that are used by the subsequent guards (proceeding from left to right).</p>\n\n<p>Commas in guards are uncommon enough (in my experience, at least) that I'd describe this feature as Haskell trivia -- not at all necessary to writing (or, for the most part, reading) Haskell. I suspect that <em>Haskell Programming from first principles</em> omits it for that reason.</p>\n"}, {"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 2, "last_activity_date": 1506937048, "creation_date": 1506937048, "answer_id": 46523028, "question_id": 46509876, "link": "https://stackoverflow.com/questions/46509876/what-does-a-comma-in-the-guard-syntax-do/46523028#46523028", "title": "What does a comma in the guard syntax do?", "body": "<p>This syntax is not legal in Haskell '98; this was added to the language specification in Haskell 2010. It's part of the \"pattern guards\" language extension.</p>\n\n<p><a href=\"https://prime.haskell.org/wiki/PatternGuards\" rel=\"nofollow noreferrer\">https://prime.haskell.org/wiki/PatternGuards</a></p>\n\n<p>The <em>real</em> usefulness in this is in allowing you to pattern match inside a guard clause. The syntactic change also has the side-effect of allowing you to AND together several Boolean terms using commas.</p>\n\n<p>(I personally really dislike this extension, and I'm a little shocked it made it into the official spec, but there we are...)</p>\n"}], "owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1771, "favorite_count": 1, "accepted_answer_id": 46509903, "answer_count": 2, "score": 32, "last_activity_date": 1507340899, "creation_date": 1506839867, "last_edit_date": 1506856469, "question_id": 46509876, "link": "https://stackoverflow.com/questions/46509876/what-does-a-comma-in-the-guard-syntax-do", "title": "What does a comma in the guard syntax do?", "body": "<p>In a code base I'm reading, I found a function declaration like this (some parts are missing):</p>\n\n<pre><code>filepathNormalise :: BS.ByteString -&gt; BS.ByteString\nfilepathNormalise xs\n    | isWindows, Just (a,xs) &lt;- BS.uncons xs, sep a, Just (b,_) &lt;- BS.uncons xs, sep b\n    = '/' `BS.cons` f xs\n</code></pre>\n\n<p>What does the comma do here?</p>\n\n<p>(Only as a bonus, if someone readily knows this: is this syntax mentioned in <em>Haskell Programming from first principles</em>, and if so, where? As I can't remember reading about it.)</p>\n"}, {"tags": ["haskell", "ghc", "dependent-type"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1506825763, "post_id": 46508490, "comment_id": 79971768, "body": "I have a guess about what&#39;s wrong and how to fix it (add more existentials), but I don&#39;t have grenade installed (and don&#39;t really want to install it just to answer this question). Could you minimize the example so that it doesn&#39;t need grenade? e.g. stub out a definition for <code>Network</code> that has the right kind and give <code>undefined</code> the right type to be an implementation for <code>randomNetwork</code>, or something similar."}, {"owner": {"reputation": 1199, "user_id": 1744344, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1e64cde3a7667b8b2ee69af9a7aea5aa?s=128&d=identicon&r=PG", "display_name": "helq", "link": "https://stackoverflow.com/users/1744344/helq"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1506829082, "post_id": 46508490, "comment_id": 79972211, "body": "Done @DanielWagner, the stub is actually longer than I thought, but it generates the same error. Hope it helps. thx"}], "answers": [{"comments": [{"owner": {"reputation": 1199, "user_id": 1744344, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1e64cde3a7667b8b2ee69af9a7aea5aa?s=128&d=identicon&r=PG", "display_name": "helq", "link": "https://stackoverflow.com/users/1744344/helq"}, "edited": false, "score": 0, "creation_date": 1506860578, "post_id": 46509228, "comment_id": 79978756, "body": "Awesome, thxs. Now I notice that I don&#39;t understand the scope of types, any good resource on this? What about existential types? I don&#39;t get them either. And, what do you mean by CPS? Man, Haskell the only language in which I can dedicate many years of study and it still has surprises :)"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 1199, "user_id": 1744344, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1e64cde3a7667b8b2ee69af9a7aea5aa?s=128&d=identicon&r=PG", "display_name": "helq", "link": "https://stackoverflow.com/users/1744344/helq"}, "edited": false, "score": 0, "creation_date": 1506874263, "post_id": 46509228, "comment_id": 79982674, "body": "@helq CPS refers to &quot;continuation passing style&quot;. The idea there is to have functions of types like <code>... -&gt; (KnownNat n =&gt; n -&gt; r) -&gt; r</code>. The second last argument doesn&#39;t know anything about whatever <code>KnownNat</code> you may have constructed, but it represents a <i>continuation</i> with which you can consume the <code>KnownNat</code> and produce some less annoying result <code>r</code>."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1506894955, "post_id": 46509228, "comment_id": 79988653, "body": "Intuitively, CPS functions have holes in them, capable of computing up to a value of type <code>a</code>, and then needing extra help to compute a <code>r</code> from that, finalizing the computation to <code>f</code>. The hole has type <code>a -&gt; r</code>, so the entire function is <code>(a -&gt; r) -&gt; f</code>. <a href=\"https://stackoverflow.com/q/292274/5684257\">Ref. existentials</a>. Haskell (and many other languages; <a href=\"https://stackoverflow.com/a/46186356/5684257\">ex.</a>) can&#39;t do existentials natively. Haskell emulates it as <code>data D = forall a. Ctor a</code>, generating <code>Ctor :: forall a. a -&gt; D</code>, which &quot;forgets&quot; <code>a</code>, forcing all the users to not care what <code>a</code> is."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1506901460, "post_id": 46509228, "comment_id": 79989942, "body": "I learned most of this stuff by hanging out on <code>freenode.net</code> <code>#haskell</code> and asking questions. People there can&#39;t get enough of talking about this stuff."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 8, "last_activity_date": 1506832902, "last_edit_date": 1506832902, "creation_date": 1506832261, "answer_id": 46509228, "question_id": 46508490, "link": "https://stackoverflow.com/questions/46508490/is-it-possible-to-assign-a-knownnat-at-runtime/46509228#46509228", "title": "Is it possible to assign a KnownNat at runtime?", "body": "<p>Let's think about this line:</p>\n\n<pre><code>net0 &lt;- case sizeHidden of\n    SomeSing (SNat :: Sing n) -&gt;\n        randomNetwork :: IO (Network '[ FullyConnected 75 n, FullyConnected n 1 ] '[ 'D1 75, 'D1 n, 'D1 1 ])\n</code></pre>\n\n<p>What is the type of <code>net0</code>?  It appears to be </p>\n\n<pre><code>Network '[ FullyConnected 75 n, FullyConnected n 1 ] '[ 'D1 75, 'D1 n, 'D1 1 ]\n</code></pre>\n\n<p>However, what is <code>n</code>?  It's not in the environment, because the type environment of <code>main</code> is empty.  And it's not universally quantified either.  That's the problem, <code>n</code> can't refer to anything.  You need to either do all your work with <code>net0</code> inside the environment where <code>n</code> is bound<sup>1</sup>, as in</p>\n\n<pre><code>case sizeHidden of\n   SomeSing (SNat :: Sing n) -&gt; do\n       net0 &lt;- randomNetwork :: IO (Network '[ FullyConnected 75 n, FullyConnected n 1 ] '[ 'D1 75, 'D1 n, 'D1 1 ])\n       print net0\n</code></pre>\n\n<p>or wrap <code>net0</code> in its own existential:</p>\n\n<pre><code>data DogeNet = \n  forall n. KnownNat n =&gt; DogeNet (Network '[ FullyConnected 75 n, FullyConnected n 1 ]\n                                           '[ 'D1 75, 'D1 n, 'D1 1 ])\n\ninstance Show DogeNet where    -- deriving can't handle existentials\n    show (DogeNet n) = show n \n\nmain = do\n    ...\n    net0 &lt;- case sizeHidden of\n        SomeSing (SNat :: Sing n) -&gt;\n            DogeNet &lt;$&gt; (randomNetwork \n                           :: IO (Network '[ FullyConnected 75 n, FullyConnected n 1 ]\n                                          '[ 'D1 75, 'D1 n, 'D1 1 ]))\n    print net0\n</code></pre>\n\n<p><code>randomNetwork</code> still needs a type signature because we need to indicate that we really intend to use the <code>n</code> bound on the previous line, forcing us to write the network spec twice.  But it can be cleaned up with the new <code>TypeApplications</code> extension:</p>\n\n<pre><code>            DogeNet @n &lt;$&gt; randomNetwork\n</code></pre>\n\n<hr>\n\n<p><sup>1</sup> This doesn't make things as impossible as it looks.  You can still pass <code>net0</code> to functions that are universally quantified in <code>n</code>.  It just means that if you ever <em>return</em> a type involving a <em>new</em> type level number, you need to do it by CPS or use an existential like <code>DogeNet</code>.</p>\n"}], "owner": {"reputation": 1199, "user_id": 1744344, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1e64cde3a7667b8b2ee69af9a7aea5aa?s=128&d=identicon&r=PG", "display_name": "helq", "link": "https://stackoverflow.com/users/1744344/helq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 1, "accepted_answer_id": 46509228, "answer_count": 1, "score": 8, "last_activity_date": 1506836755, "creation_date": 1506821979, "last_edit_date": 1506836755, "question_id": 46508490, "link": "https://stackoverflow.com/questions/46508490/is-it-possible-to-assign-a-knownnat-at-runtime", "title": "Is it possible to assign a KnownNat at runtime?", "body": "<p>I've being trying (unsuccessfully) to create an \"object\"* in haskell in runtime with its type defined at runtime using dependent types.</p>\n\n<p>I was following <a href=\"https://blog.jle.im/entry/practical-dependent-types-in-haskell-2.html\" rel=\"noreferrer\">this tutorial on dependent types</a> and what they use to pass a value on runtime is a function that takes a <code>Sing</code> as a parameter and uses pattern matching on the value of <code>Sing</code> to obtain the number on runtime. \nBut I don't have access to any <code>Sing</code> to pattern match.</p>\n\n<p>I thought the code below could work, but what I get is actually pretty disappointing, the compiler tells me that <code>n</code> from the type definition for <code>randomNetwork</code> is not the same <code>n</code> that I captured in the type definition of <code>SNat</code>. </p>\n\n<pre><code>{-# LANGUAGE\n    ScopedTypeVariables, TemplateHaskell, TypeFamilies, GADTs, KindSignatures,\n    TypeOperators, FlexibleContexts, RankNTypes, UndecidableInstances,\n    FlexibleInstances, InstanceSigs, DefaultSignatures, DataKinds,\n    RecordWildCards, StandaloneDeriving, MultiParamTypeClasses #-}\n\nmodule Main where\n\n-- some imports to make the code below main work\nimport Control.Monad.Random\nimport GHC.TypeLits\nimport Data.List\n\n--import Grenade\nimport Data.Singletons\nimport Data.Singletons.TypeLits\n\nmain = do\n  let sizeHidden = toSing (20 :: Integer) :: SomeSing Nat\n\n  net0 &lt;- case sizeHidden of\n            SomeSing (SNat :: Sing n) -&gt;\n              randomNetwork :: IO (Network '[ FullyConnected 75 n, FullyConnected n 1 ] '[ 'D1 75, 'D1 n, 'D1 1 ])\n  --net0 &lt;- randomNetwork :: IO (Network '[ FullyConnected 75 3, FullyConnected 3 1 ] '[ 'D1 75, 'D1 3, 'D1 1 ])\n  print net0\n\n\n-- from Grenade.Core.Network\ndata Network :: [*] -&gt; [Shape] -&gt; * where\n    NNil  :: SingI i\n          =&gt; Network '[] '[i]\n\n    (:~&gt;) :: (SingI i, SingI h, Layer x i h)\n          =&gt; !x\n          -&gt; !(Network xs (h ': hs))\n          -&gt; Network (x ': xs) (i ': h ': hs)\ninfixr 5 :~&gt;\n\ninstance Show (Network '[] '[i]) where\n  show NNil = \"NNil\"\ninstance (Show x, Show (Network xs rs)) =&gt; Show (Network (x ': xs) (i ': rs)) where\n  show (x :~&gt; xs) = show x ++ \"\\n~&gt;\\n\" ++ show xs\n\nclass CreatableNetwork (xs :: [*]) (ss :: [Shape]) where\n  randomNetwork :: MonadRandom m =&gt; m (Network xs ss)\n\ninstance SingI i =&gt; CreatableNetwork '[] '[i] where\n  randomNetwork = return NNil\n\ninstance (SingI i, SingI o, Layer x i o, CreatableNetwork xs (o ': rs)) =&gt; CreatableNetwork (x ': xs) (i ': o ': rs) where\n  randomNetwork = (:~&gt;) &lt;$&gt; createRandom &lt;*&gt; randomNetwork\n\n-- from Grenade.Layers.FullyConnected\ndata FullyConnected i o = FullyConnected\n                        !(FullyConnected' i o)   -- Neuron weights\n                        !(FullyConnected' i o)   -- Neuron momentum\n\ndata FullyConnected' i o = FullyConnected'\n                         !(R o)   -- Bias\n                         !(L o i) -- Activations\n\ninstance Show (FullyConnected i o) where\n  show FullyConnected {} = \"FullyConnected\"\n\ninstance (KnownNat i, KnownNat o) =&gt; UpdateLayer (FullyConnected i o) where\n  type Gradient (FullyConnected i o) = (FullyConnected' i o)\n  runUpdate = undefined\n  createRandom = undefined\n\ninstance (KnownNat i, KnownNat o) =&gt; Layer (FullyConnected i o) ('D1 i) ('D1 o) where\n  type Tape (FullyConnected i o) ('D1 i) ('D1 o) = S ('D1 i)\n  runForwards  = undefined\n  runBackwards = undefined\n\n-- from Grenade.Core.Layer\nclass UpdateLayer x where\n  type Gradient x :: *\n  runUpdate       :: LearningParameters -&gt; x -&gt; Gradient x -&gt; x\n  createRandom    :: MonadRandom m =&gt; m x\n  runUpdates      :: LearningParameters -&gt; x -&gt; [Gradient x] -&gt; x\n  runUpdates rate = foldl' (runUpdate rate)\n\nclass UpdateLayer x =&gt; Layer x (i :: Shape) (o :: Shape) where\n  type Tape x i o :: *\n  runForwards    :: x -&gt; S i -&gt; (Tape x i o, S o)\n  runBackwards   :: x -&gt; Tape x i o -&gt; S o -&gt; (Gradient x, S i)\n\n-- from Grenade.Core.Shape\ndata Shape = D1 Nat\n\ndata S (n :: Shape) where\n  S1D :: ( KnownNat len )\n      =&gt; R len\n      -&gt; S ('D1 len)\n\nderiving instance Show (S n)\n\ninstance KnownNat a =&gt; SingI ('D1 a) where\n  sing = D1Sing sing\n\ndata instance Sing (n :: Shape) where\n  D1Sing :: Sing a -&gt; Sing ('D1 a)\n\n-- from Grenade.Core.LearningParameters\ndata LearningParameters = LearningParameters {\n    learningRate :: Double\n  , learningMomentum :: Double\n  , learningRegulariser :: Double\n  } deriving (Eq, Show)\n\n-- from Numeric.LinearAlgebra.Static\nnewtype Dim (n :: Nat) t = Dim t\n  deriving (Show)\nnewtype R n = R (Dim n [Double])\n  deriving (Show)\nnewtype L m n = L (Dim m (Dim n [[Double]]))\n</code></pre>\n\n<p>How could I define the size of the \"hidden layer\" on runtime (without constructing it by hand)? how could I use the value I captured in runtime at the type level?</p>\n\n<p>Btw, this is the compiling error I get with the code above:</p>\n\n<pre><code>Prelude&gt; :r\n  net0 &lt;- case sizeHidden of\n            SomeSing (SNat :: KnownNat n =&gt; Sing n) -&gt; randomNetwork :: IO (Network '[ FullyConnected 75 3, FullyConnected 3 1 ] '[ 'D1 75, 'D1 3, 'D1 1 ])\n[1 of 1] Compiling Main             ( /home/helq/Downloads/NetworkOnRuntime.hs, interpreted )\n\n/home/helq/Downloads/NetworkOnRuntime.hs:23:15: error:\n    \u2022 Couldn't match type \u2018a0\u2019\n                     with \u2018Network\n                             '[FullyConnected 75 a, FullyConnected a 1] '['D1 75, 'D1 a, 'D1 1]\u2019\n        because type variable \u2018a\u2019 would escape its scope\n      This (rigid, skolem) type variable is bound by\n        a pattern with constructor:\n          SomeSing :: forall k k1 (k2 :: k1) (a :: k). Sing a -&gt; SomeSing k,\n        in a case alternative\n        at /home/helq/Downloads/NetworkOnRuntime.hs:22:13-37\n      Expected type: IO a0\n        Actual type: IO\n                       (Network\n                          '[FullyConnected 75 a, FullyConnected a 1] '['D1 75, 'D1 a, 'D1 1])\n    \u2022 In the expression:\n          randomNetwork ::\n            IO (Network '[FullyConnected 75 n, FullyConnected n 1] '[D1 75,\n                                                                     D1 n,\n                                                                     D1 1])\n      In a case alternative:\n          SomeSing (SNat :: Sing n)\n            -&gt; randomNetwork ::\n                 IO (Network '[FullyConnected 75 n, FullyConnected n 1] '[D1 75,\n                                                                          D1 n,\n                                                                          D1 1])\n      In a stmt of a 'do' block:\n        net0 &lt;- case sizeHidden of {\n                  SomeSing (SNat :: Sing n)\n                    -&gt; randomNetwork ::\n                         IO (Network '[FullyConnected 75 n, FullyConnected n 1] '[D1 75,\n                                                                                  D1 n,\n                                                                                  D1 1]) }\n\n/home/helq/Downloads/NetworkOnRuntime.hs:25:3: error:\n    \u2022 Ambiguous type variable \u2018a0\u2019 arising from a use of \u2018print\u2019\n      prevents the constraint \u2018(Show a0)\u2019 from being solved.\n      Relevant bindings include\n        net0 :: a0 (bound at /home/helq/Downloads/NetworkOnRuntime.hs:21:3)\n      Probable fix: use a type annotation to specify what \u2018a0\u2019 should be.\n      These potential instances exist:\n        instance (Show b, Show a) =&gt; Show (Either a b)\n          -- Defined in \u2018Data.Either\u2019\n        instance Show SomeNat -- Defined in \u2018GHC.TypeLits\u2019\n        instance Show SomeSymbol -- Defined in \u2018GHC.TypeLits\u2019\n        ...plus 31 others\n        ...plus 170 instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    \u2022 In a stmt of a 'do' block: print net0\n      In the expression:\n        do { let sizeHidden = ...;\n             net0 &lt;- case sizeHidden of {\n                       SomeSing (SNat :: Sing n)\n                         -&gt; randomNetwork ::\n                              IO (Network '[FullyConnected 75 n, FullyConnected n 1] '[D1 75,\n                                                                                       D1 n,\n                                                                                       D1 1]) };\n             print net0 }\n      In an equation for \u2018main\u2019:\n          main\n            = do { let sizeHidden = ...;\n                   net0 &lt;- case sizeHidden of { SomeSing (SNat :: Sing n) -&gt; ... };\n                   print net0 }\nFailed, modules loaded: none.\n</code></pre>\n\n<p>*: I know, we call them values (I think)</p>\n"}, {"tags": ["haskell", "haskell-snap-framework"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1506819462, "post_id": 46508231, "comment_id": 79970962, "body": "That doesn&#39;t contain the actual failure message. You&#39;ll need to go further back in the output to find that. Best to include <i>all</i> the output."}, {"owner": {"reputation": 317, "user_id": 5969535, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VfMtY.jpg?s=128&g=1", "display_name": "Nicholas Yang", "link": "https://stackoverflow.com/users/5969535/nicholas-yang"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1506824159, "post_id": 46508231, "comment_id": 79971579, "body": "Very true. Updated with full log"}], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": false, "score": 0, "last_activity_date": 1506828359, "creation_date": 1506828359, "answer_id": 46508939, "question_id": 46508231, "link": "https://stackoverflow.com/questions/46508231/issue-installing-snap-on-macos-sierra/46508939#46508939", "title": "Issue installing Snap on macOS Sierra", "body": "<p>This looks like a bug in Cabal 2 (or potentially GHC 8.2). See <a href=\"https://github.com/haskell/cabal/issues/4728\" rel=\"nofollow noreferrer\">https://github.com/haskell/cabal/issues/4728</a>. I'd recommend sticking to GHC 8.0.2 for the moment with either cabal 1.24 or Stack. I'm the case of Stack, the version won't matter, since it will use the Cabal version shipped with GHC.</p>\n"}, {"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 1, "last_activity_date": 1507270963, "creation_date": 1507270963, "answer_id": 46599487, "question_id": 46508231, "link": "https://stackoverflow.com/questions/46508231/issue-installing-snap-on-macos-sierra/46599487#46599487", "title": "Issue installing Snap on macOS Sierra", "body": "<p>There was an issue with full 8.2.1 binary platform builds that's just been resolved: <a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2017-October/127979.html\" rel=\"nofollow noreferrer\">https://mail.haskell.org/pipermail/haskell-cafe/2017-October/127979.html</a></p>\n\n<p>This was likely an instance of that.</p>\n\n<p>(see also: <a href=\"https://stackoverflow.com/questions/46500732/ghc-cannot-find-libraries-on-fresh-install-of-haskell-platform/46599471#46599471\">GHC cannot find libraries on fresh install of Haskell-Platform</a>)</p>\n"}], "owner": {"reputation": 317, "user_id": 5969535, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VfMtY.jpg?s=128&g=1", "display_name": "Nicholas Yang", "link": "https://stackoverflow.com/users/5969535/nicholas-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 46599487, "answer_count": 2, "score": 1, "last_activity_date": 1507270963, "creation_date": 1506818113, "last_edit_date": 1506824141, "question_id": 46508231, "link": "https://stackoverflow.com/questions/46508231/issue-installing-snap-on-macos-sierra", "title": "Issue installing Snap on macOS Sierra", "body": "<p>I'm having trouble installing the Haskell framework Snap on macOS Sierra. Whenever I install it, I get the following message: </p>\n\n<pre><code>Resolving dependencies...\nConfiguring securemem-0.1.9...\nConfiguring skein-1.0.9.4...\nConfiguring configurator-0.3.0.0...\nConfiguring cryptonite-0.24...\nBuilding configurator-0.3.0.0...\nBuilding securemem-0.1.9...\nBuilding skein-1.0.9.4...\nFailed to install configurator-0.3.0.0\nBuild log ( /Users/nicholas/.cabal/logs/ghc-8.2.1/configurator-0.3.0.0-6dySPcNCURWFswtMXJvzho.log ):\ncabal: Entering directory '/tmp/cabal-tmp-66175/configurator-0.3.0.0'\nConfiguring configurator-0.3.0.0...\nPreprocessing library for configurator-0.3.0.0..\nBuilding library for configurator-0.3.0.0..\n&lt;command line&gt;: cannot satisfy -package-id attoparsec-0.13.2.0-5dp4kBDsiGY4dQpLKbD5rk: \n    attoparsec-0.13.2.0-5dp4kBDsiGY4dQpLKbD5rk is unusable due to shadowed dependencies:\n      scientific-0.3.5.1-L0qYzdp0wpz8rO8gircNSR text-1.2.2.2-EGUst8sqNAZCw1xLPcmcMH\n    (use -v for more information)\ncabal: Leaving directory '/tmp/cabal-tmp-66175/configurator-0.3.0.0'\nConfiguring transformers-base-0.4.4...\nBuilding cryptonite-0.24...\nBuilding transformers-base-0.4.4...\nInstalled securemem-0.1.9\nInstalled transformers-base-0.4.4\nInstalled skein-1.0.9.4\nInstalled cryptonite-0.24\nUpdating documentation index\n/Users/nicholas/Library/Haskell/share/doc/x86_64-osx-ghc-8.2.1/index.html\ncabal: Error: some packages failed to install:\nconfigurator-0.3.0.0-6dySPcNCURWFswtMXJvzho failed during the building phase.\nThe exception was:\nExitFailure 1\nsnap-1.0.0.2-5CZKyA9EY4oLgkpHYCVfnv depends on snap-1.0.0.2 which failed to\ninstall.\n</code></pre>\n\n<p>I'm using the Haskell Platform installed using homebrew (<code>brew cask install haskell-platform</code>), and cabal version 2.0.0.2. I have tried using sudo and deleting my <code>~/.ghc</code> file</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 389, "user_id": 5991927, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f1d70f641cbec039763be0a4d4536895?s=128&d=identicon&r=PG&f=1", "display_name": "humbleCoder", "link": "https://stackoverflow.com/users/5991927/humblecoder"}, "edited": false, "score": 0, "creation_date": 1506816798, "post_id": 46508104, "comment_id": 79970604, "body": "I understand about the silly function names and just wanted to whip this up real quick. I could also do this? <code>set2 :: (Int) -&gt; [Int]</code> <code>set2 x = [y | y &lt;- [1..10], x `mod` y == 0]</code>  <code>divFunc = [x | x &lt;- [1..], length(set2 x) == 10]</code>  <code>realFunc = head divFunc</code>  This way, they only need to call realFunc and not have to do head divFunc? I understand what lcm does but when I was looking at question 5 on Project Euler someone answered it like this: <code>foldr1 lcm[1..20]</code> What does foldr1 do?"}, {"owner": {"reputation": 389, "user_id": 5991927, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f1d70f641cbec039763be0a4d4536895?s=128&d=identicon&r=PG&f=1", "display_name": "humbleCoder", "link": "https://stackoverflow.com/users/5991927/humblecoder"}, "edited": false, "score": 0, "creation_date": 1506816997, "post_id": 46508104, "comment_id": 79970627, "body": "I apologize for the format. I didn&#39;t know how to set new lines."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 389, "user_id": 5991927, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f1d70f641cbec039763be0a4d4536895?s=128&d=identicon&r=PG&f=1", "display_name": "humbleCoder", "link": "https://stackoverflow.com/users/5991927/humblecoder"}, "edited": false, "score": 0, "creation_date": 1506821359, "post_id": 46508104, "comment_id": 79971202, "body": "@humbleCoder I encourage you to try to write this with <code>lcm</code> and explicit recursion; then it will be a lot easier to take a look at the implementation of <code>foldr1</code> and understand what it does."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1506816314, "creation_date": 1506816314, "answer_id": 46508104, "question_id": 46507959, "link": "https://stackoverflow.com/questions/46507959/how-to-stop-a-function-that-going-through-an-infinite-list/46508104#46508104", "title": "How to stop a function that going through an infinite list", "body": "<p>You can use <code>head</code> to get the first element of a list.</p>\n\n<pre><code>&gt; head divFunc\n2520\n</code></pre>\n\n<p>A few other minor comments:</p>\n\n<ol>\n<li>Generally people advise against using <code>head</code> because it fails on empty lists. It's okay in this particular case because the function you are calling it either has an element (in which case <code>head</code> is fine) or thinks infinitely long before producing any useful information (in which case <code>head</code> doesn't make the situation any worse). But beware this function in general; you should always have an argument that it is safe (like the above argument) ready to go before you use it.</li>\n<li><code>divFunc</code> is a funny name. It isn't a function.</li>\n<li>You may like to look at the <code>lcm</code> function.</li>\n</ol>\n"}], "owner": {"reputation": 389, "user_id": 5991927, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f1d70f641cbec039763be0a4d4536895?s=128&d=identicon&r=PG&f=1", "display_name": "humbleCoder", "link": "https://stackoverflow.com/users/5991927/humblecoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 46508104, "answer_count": 1, "score": 2, "last_activity_date": 1506816314, "creation_date": 1506814416, "last_edit_date": 1506814793, "question_id": 46507959, "link": "https://stackoverflow.com/questions/46507959/how-to-stop-a-function-that-going-through-an-infinite-list", "title": "How to stop a function that going through an infinite list", "body": "<p>I'm basically trying to solve the Project Euler's question number 5. I'm trying to find the smallest number that's divisible by 1-10. I have this so far, and I get the correct answer, but it keeps going on, if I don't stop. How do I make it stop once it finds the first number?</p>\n\n<pre><code>set2 :: (Int) -&gt; [Int]\nset2 x = [y | y &lt;- [1..10], x `mod` y == 0]\n\ndivFunc = [x | x &lt;- [1..], length(set2 x) == 10]\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "lazy-evaluation"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 2, "creation_date": 1506808442, "post_id": 46507217, "comment_id": 79969118, "body": "Why not include <code>inverseMass</code> as one of the fields of <code>RigidBody</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1506809281, "post_id": 46507418, "comment_id": 79969283, "body": "Yes, please don&#39;t overcomplicate things and just use lazy evaluation. (Or if you don&#39;t want it lazy, make the field strict)."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1506856202, "post_id": 46507418, "comment_id": 79977591, "body": "@Bergi Well, while lazy evaluation might be the solution for this given approach, my solution also have advantages. For example, if you want to reset some value and explicitly set it to <code>Nothing</code>."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1506856791, "post_id": 46507418, "comment_id": 79977733, "body": "Given the immutability of <code>RigidBody</code> values, I don&#39;t see why you would want to do that though"}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 0, "last_activity_date": 1506808854, "creation_date": 1506808854, "answer_id": 46507418, "question_id": 46507217, "link": "https://stackoverflow.com/questions/46507217/haskell-evaluating-properties-of-a-data-type-only-once-when-first-accessed/46507418#46507418", "title": "Haskell evaluating properties of a data type only once when first accessed?", "body": "<p>You can store <code>inverseMass</code> as <code>Maybe Float</code> inside <code>RigidBody</code>. When <code>inverseMass</code> is <code>Just someMass</code> you just extract this value. If it's <code>Nothing</code> you compute it and store inside <code>RigidBody</code>. The problem is with this <em>store</em> part. Because as you may know objects are immutable in Haskell.</p>\n\n<p>Naive but simple solution would be to return <code>RigidBody</code> after every computation like this:</p>\n\n<pre><code>data RigidBody = RigidBody \n    { rigidBodyMass        :: Float\n    , rigidBodyInverseMass :: Maybe Float }\n\ninverseMass :: RigidBody -&gt; (Float, RigidBody)\ninverseMass b@(RigidBody _ (Just inv)) = (inv, b)\ninverseMass   (RigidBody mass Nothing) = let inv = 1 / mass \n                                         in (inv, RigidBody mass (Just inv))\n</code></pre>\n\n<p>If you have a lot of such fields you may find such approach extremely tedious. And it's not very convenient to write code using such functions. So here is the place where <code>State</code> monad becomes handy. <code>State</code> monad can just keep current <code>RigidBody</code> inside explicit state and update it accordingly through all you stateful computation. Like this:</p>\n\n<pre><code>inverseMass :: State RigidBody Float\ninverseMass = do\n    RigitBody inv maybeInverse &lt;- get\n    case maybeInverse of\n        Just inv -&gt; pure inv\n        Nothing  -&gt; do\n            let inv = 1 / mass\n            put $ RigidBody mass (Just inv)\n            pure inv\n</code></pre>\n\n<p>Later you can just use <code>inverseMass</code> multiple times and only during your first call inverse of mass will be calculated.</p>\n\n<p>You see, in imperative programming languages like C++ state is explicit. You want to update fields of <code>RigidBody</code>. So basically you have some object of type <code>RigidBody</code> which stores some states. Because state is implicit you don't need to specify in your functions that they change fields of <code>RigidBody</code>. In Haskell (and every good programming language) you specify explicitly what is your state and how you will change it. You specify explicitly what objects you want to work with. <code>inverseMass</code> monadic action (or just function if you want) will update your explicit state depending on the current state at the moment of calling this function. This is more or less idiomatic approach in Haskell for such sort of tasks.</p>\n\n<p>Well, another idiomatic solution: just create values of your data type with all fields set to some function calls. Because Haskell is lazy such fields are calculated first time only when they are needed.</p>\n"}, {"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 11, "last_activity_date": 1506809739, "creation_date": 1506809739, "answer_id": 46507520, "question_id": 46507217, "link": "https://stackoverflow.com/questions/46507217/haskell-evaluating-properties-of-a-data-type-only-once-when-first-accessed/46507520#46507520", "title": "Haskell evaluating properties of a data type only once when first accessed?", "body": "<p>As @4castle and @Shersh note, a simple approach would be to include the derived value in the data type:</p>\n\n<pre><code>data RigidBody = RigidBody\n  { m_mass :: Float\n  , m_inverseMass :: Float }\n</code></pre>\n\n<p>and then use a smart constructor to make new <code>RigidBody</code>s:</p>\n\n<pre><code>rigidBody mass = RigidBody mass (1/mass)\n</code></pre>\n\n<p>The expression <code>1/mass</code> will create a thunk for <code>m_inverseMass</code> which, after it is first evaluated, will be available without recalculation, so it provides a sort of auto memoization.</p>\n\n<p>More general transformations, like changing the position and properly updating all the <code>global*</code> fields based on the <code>local*</code> values would be handled in a similar manner.  As a simplified example:</p>\n\n<pre><code>module Rigid where\n\ntype Vec3 = Double  -- just to type check\n\ndata RigidBody = RigidBody\n  { m_mass :: Float\n  , m_inverseMass :: Float\n  , m_pos :: Vec3\n  , m_localCentroid :: Vec3\n  , m_globalCentroid :: Vec3\n  }\n\nrigidBody mass pos centroid =\n  RigidBody mass (1/mass) pos centroid (centroid + pos)\n\nmove body delta =\n  rigidBody (m_mass body)\n            (m_pos body + delta)\n            (m_localCentroid body)\n</code></pre>\n\n<p>In an application that's performance critical, you would want to take steps to introduce strictness in appropriate places so you don't build up huge piles of unevaluated thunks.</p>\n"}], "owner": {"reputation": 500, "user_id": 6030440, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-3k0aSh3Ojgs/AAAAAAAAAAI/AAAAAAAAACg/Yn_hyfPJonk/photo.jpg?sz=128", "display_name": "Austin Garrett", "link": "https://stackoverflow.com/users/6030440/austin-garrett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 46507520, "answer_count": 2, "score": 4, "last_activity_date": 1506809739, "creation_date": 1506807146, "question_id": 46507217, "link": "https://stackoverflow.com/questions/46507217/haskell-evaluating-properties-of-a-data-type-only-once-when-first-accessed", "title": "Haskell evaluating properties of a data type only once when first accessed?", "body": "<p>In imperative/object oriented programming with mutable state, it would be very common and useful to declare a structure such as the following:</p>\n\n<pre><code>struct RigidBody {\n  float m_mass;\n  float m_inverseMass;\n  Mat3 m_localInverseInertiaTensor;\n  Mat3 m_globalInverseInertiaTensor;\n\n  Vec3 m_globalCentroid;\n  Vec3 m_localCentroid;\n\n  Vec3 m_position;\n  Mat3 m_orientation;\n  Vec3 m_linearVelocity;\n  Vec3 m_angularVelocity;\n};\n</code></pre>\n\n<p>Source: <a href=\"http://allenchou.net/2013/12/game-physics-motion-dynamics-implementations/\" rel=\"nofollow noreferrer\">http://allenchou.net/2013/12/game-physics-motion-dynamics-implementations/</a></p>\n\n<p>There are many properties here that are able to be computed directly from others, such as <code>m_inverseMass</code> from <code>m_mass</code>. In a stateless programming language like Haskell, getting derived values is easy enough:</p>\n\n<pre><code>data RigidBody = RigidBody {mass :: Float}\n\ninverseMass :: RigidBody -&gt; Float\ninverseMass body = 1 / mass body\n</code></pre>\n\n<p>But this computes the <code>inverseMass</code> every time we need it, which can get expensive especially in domains where performance is critical, like physics simulation. I've considered memoization, but I wasn't sure if this is a good way of expressing this lazy evaluation of dependent properties, as it seemed to be a complicated solution. How would I store derivative values without having to recompute them?</p>\n"}, {"tags": ["haskell", "ghc", "cabal", "haskell-stack", "ghc-pkg"], "comments": [{"owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "edited": false, "score": 1, "creation_date": 1506810122, "post_id": 46505007, "comment_id": 79969450, "body": "Thanks for the report, I&#39;ve opened this issue: <a href=\"https://github.com/commercialhaskell/stack/issues/3462\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/3462</a>"}, {"owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "reply_to_user": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "edited": false, "score": 0, "creation_date": 1506844658, "post_id": 46505007, "comment_id": 79974759, "body": "@mgsloan Thanks for fixing this! Nonetheless, I&#39;m interested in a solution that also works for cabal-install. Looking at the code of ghc-mod, there probably isn&#39;t really a solution, I think, but I think this situation is really annoying and there should be some kind of package for this (like <code>ghc-paths</code>) if there is no standard among the ecosystem."}, {"owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "reply_to_user": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "edited": false, "score": 0, "creation_date": 1506937545, "post_id": 46505007, "comment_id": 80000183, "body": "@mgsloan So, what would be the best workaround? I dug through the <code>stack</code> source code and looked at how <code>mkGhcPackagePath</code> is called. seems like I have to get a hold on an <code>EnvConfig</code> to call <code>packageDatabaseLocal</code> et al. What would be the easiest way to do so?"}, {"owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "reply_to_user": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "edited": false, "score": 0, "creation_date": 1506938013, "post_id": 46505007, "comment_id": 80000398, "body": "Maybe I&#39;m better off just parsing the result of <code>stack path --ghc-package-path</code>?"}, {"owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "edited": false, "score": 0, "creation_date": 1507354662, "post_id": 46505007, "comment_id": 80185575, "body": "Yeah, parsing that seems like the best approach."}], "answers": [{"tags": [], "owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "is_accepted": true, "score": 0, "last_activity_date": 1511175363, "creation_date": 1511175363, "answer_id": 47390364, "question_id": 46505007, "link": "https://stackoverflow.com/questions/46505007/access-ghc-package-database-in-test-and-benchmark-suite/47390364#47390364", "title": "Access GHC package database in test and benchmark suite", "body": "<p>The proper solution appears to be to use a custom <code>Setup.hs</code> to persist the <a href=\"https://hackage.haskell.org/package/Cabal-2.0.0.2/docs/Distribution-Simple-LocalBuildInfo.html#v:withPackageDB\" rel=\"nofollow noreferrer\"><code>withPackageDB</code></a> field of the <code>LocalBuildInfo</code> after <code>configure</code>.</p>\n\n<p>Lucky me found <a href=\"https://hackage.haskell.org/package/cabal-toolkit\" rel=\"nofollow noreferrer\"><code>cabal-toolkit</code></a>, of which I modified version 0.0.3 to also work with Cabal 1.24 (and GHC 8.0.2) <a href=\"https://github.com/sgraf812/cabal-toolkit/commit/5a083bc6f88673a7cd199b152b39d0a799b28773\" rel=\"nofollow noreferrer\">to be found here</a> until it's merged.</p>\n\n<p>Getting the <code>packageDBFlags</code>/<code>extraPkgConf</code> is just a matter of calling <code>getGHCPackageFlags $(localBuildInfoQ)</code>.</p>\n"}], "owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 47390364, "answer_count": 1, "score": 1, "last_activity_date": 1511175363, "creation_date": 1506790809, "last_edit_date": 1506950326, "question_id": 46505007, "link": "https://stackoverflow.com/questions/46505007/access-ghc-package-database-in-test-and-benchmark-suite", "title": "Access GHC package database in test and benchmark suite", "body": "<p>I have a test suite and a benchmark suite that uses the GHC API to compile modules to Core, so that I don't have to write Core <a href=\"https://hackage.haskell.org/package/ghc-8.2.1/docs/MkCore.html\" rel=\"nofollow noreferrer\">'by hand'</a>.</p>\n\n<p>I'm mostly using <code>stack</code> at this point, where I could just access the <code>GHC_PACKAGE_PATH</code> environment variable in the test suite (<code>stack test</code>) to find a package database which I can feed the GHC API with. Note that it's not so much that I care for any particular db, I just want to have modules from e.g. <code>base</code> available, compiled with a compatible version of GHC (e.g. <a href=\"https://hackage.haskell.org/package/ghc-paths-0.1.0.9/docs/GHC-Paths.html#v:ghc\" rel=\"nofollow noreferrer\"><code>GHC.Paths.ghc</code></a>).</p>\n\n<p>Everything works fine so far, tests are green. Now, if I do the same for the benchmark suite (<code>stack bench</code>), <code>GHC_PACKAGE_PATH</code> doesn't seem to be present at all.</p>\n\n<p>Long story short, what is a reliable way to capture the path to the GHC package database the program was built with? I imagine some messing about with <code>Setup.hs</code> might get me where I want to be.</p>\n\n<hr>\n\n<p>Edit: Here is something to play around with: <a href=\"https://github.com/sgraf812/ghc-package-path\" rel=\"nofollow noreferrer\">https://github.com/sgraf812/ghc-package-path</a></p>\n\n<p><code>stack test</code> prints out the value of <code>GHC_PACKAGE_PATH</code>, whereas <code>stack bench</code> doesn't. An answer to this question should make it so that a path to some appropriate package database is printed out in either case.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 825, "user_id": 962828, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/78c370f00a14fb3bd59dc334082378cd?s=128&d=identicon&r=PG", "display_name": "Ulrar", "link": "https://stackoverflow.com/users/962828/ulrar"}, "edited": false, "score": 0, "creation_date": 1506786581, "post_id": 46504296, "comment_id": 79963038, "body": "Your problem here is that map returns a list of Int, you need to instead sum your digits, then do an actual check. That check will return a Bool, which will satisfy your <code>digits</code> call"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1506786975, "post_id": 46504296, "comment_id": 79963154, "body": "Try to add types, or at least ask your development environment about the types it infers for the functions. For examples, what&#39;s the type of <code>digitToInt</code>?"}, {"owner": {"reputation": 117, "user_id": 7212810, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pNFqk.jpg?s=128&g=1", "display_name": "Wireless", "link": "https://stackoverflow.com/users/7212810/wireless"}, "edited": false, "score": 0, "creation_date": 1506787060, "post_id": 46504296, "comment_id": 79963168, "body": "I see, the thing is, I want to check those which satisfy the condition and then in the end, display how many (from the list) meet the condition and then display which ones."}, {"owner": {"reputation": 117, "user_id": 7212810, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pNFqk.jpg?s=128&g=1", "display_name": "Wireless", "link": "https://stackoverflow.com/users/7212810/wireless"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1506787467, "post_id": 46504296, "comment_id": 79963294, "body": "@MarkSeemann I tried adding types before, like this: <code>digs :: Integral x =&gt; x -&gt; [x] </code>. And this: <code>digits :: Integer -&gt; [Int]</code>. None worked for me, giving the error : The type signature for &#39;digits&#39; lacks an accompanying binding."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1506788142, "post_id": 46504296, "comment_id": 79963515, "body": "It&#39;s hard to follow along when you present what you&#39;ve done as a narrative in the comments here. Please edit your question and show what you&#39;ve tried."}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1506794913, "post_id": 46504296, "comment_id": 79965526, "body": "To write both a type declaration and its definition in GHCi, you have to enter them both at once using multi-line input with the <code>:{</code> and <code>:}</code> commands. See <a href=\"https://stackoverflow.com/a/8443096/402884\">stackoverflow.com/a/8443096/402884</a>"}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 7212810, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pNFqk.jpg?s=128&g=1", "display_name": "Wireless", "link": "https://stackoverflow.com/users/7212810/wireless"}, "edited": false, "score": 0, "creation_date": 1506788519, "post_id": 46504690, "comment_id": 79963631, "body": "Why does it give me this as soon as I type in the first line?:  <code>&lt;interactive&gt;:7:1: error:     Variable not in scope: digits :: a1 -&gt; [a1]</code> Does it have something to do with the fact that I&#39;m just using Prelude?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 117, "user_id": 7212810, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pNFqk.jpg?s=128&g=1", "display_name": "Wireless", "link": "https://stackoverflow.com/users/7212810/wireless"}, "edited": false, "score": 1, "creation_date": 1506788742, "post_id": 46504690, "comment_id": 79963700, "body": "@Wireless In GHCi you need to declare it all at the same time. Use a file instead, or say <code>let (expression); (expression);</code> instead of one at a time."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 117, "user_id": 7212810, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pNFqk.jpg?s=128&g=1", "display_name": "Wireless", "link": "https://stackoverflow.com/users/7212810/wireless"}, "edited": false, "score": 0, "creation_date": 1506788780, "post_id": 46504690, "comment_id": 79963710, "body": "@Wireless Make sure you have the <code>digits</code> function is defined. Have you copied all of the above to the file that you are loading to GHCI..?"}, {"owner": {"reputation": 117, "user_id": 7212810, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pNFqk.jpg?s=128&g=1", "display_name": "Wireless", "link": "https://stackoverflow.com/users/7212810/wireless"}, "edited": false, "score": 0, "creation_date": 1506789000, "post_id": 46504690, "comment_id": 79963788, "body": "I was simply using ghci Prelude, no file, maybe would have been easier with a file from the start, will try it out and come back with feedback later on, thanks :D"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 117, "user_id": 7212810, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pNFqk.jpg?s=128&g=1", "display_name": "Wireless", "link": "https://stackoverflow.com/users/7212810/wireless"}, "edited": false, "score": 0, "creation_date": 1506789468, "post_id": 46504690, "comment_id": 79963917, "body": "@Wireless Just store the above snipped in a file called <code>whatever.hs</code> in a directory and then go to that directory and run <code>stack repl</code>. When you see <code>Prelude&gt;</code> prompt type <code>:load whatever.hs</code>. The prompt changes to <code>*Main&gt;</code> . Then type <code>inac</code>."}, {"owner": {"reputation": 117, "user_id": 7212810, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pNFqk.jpg?s=128&g=1", "display_name": "Wireless", "link": "https://stackoverflow.com/users/7212810/wireless"}, "edited": false, "score": 0, "creation_date": 1506798437, "post_id": 46504690, "comment_id": 79966646, "body": "@Redu tested out right now, working just fine, thanks for the help :D"}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1506788407, "creation_date": 1506788407, "answer_id": 46504690, "question_id": 46504296, "link": "https://stackoverflow.com/questions/46504296/checking-numbers-while-making-list-cant-match-expected-type-bool/46504690#46504690", "title": "Checking numbers while making list: &quot;Can&#39;t match expected type &#39;Bool&#39;&quot;", "body": "<p>You are not checking anything at the guard part of the list comprehension. You may do as follows;</p>\n\n<pre><code>digits :: Integral a =&gt; a -&gt; [a]\ndigits 0 = []\ndigits n = digits (n `div` 10) ++ [n `rem` 10]\n\ninac :: Integral a =&gt; [a]\ninac = [x | x &lt;- [1..99], x `rem` sum (digits x) == 0]]\n\n*Main&gt; inac\n[1,2,3,4,5,6,7,8,9,10,12,18,20,21,24,27,30,36,40,42,45,48,50,54,60,63,70,72,80,81,84,90]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 117, "user_id": 7212810, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pNFqk.jpg?s=128&g=1", "display_name": "Wireless", "link": "https://stackoverflow.com/users/7212810/wireless"}, "edited": false, "score": 0, "creation_date": 1506788882, "post_id": 46504732, "comment_id": 79963739, "body": "I had tried something similar to what you wrote there using <code>mod</code> and it gave me some type of error I can&#39;t recall, I&#39;ll be trying out all of these tips from everyone and come back with feedback later on."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 117, "user_id": 7212810, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pNFqk.jpg?s=128&g=1", "display_name": "Wireless", "link": "https://stackoverflow.com/users/7212810/wireless"}, "edited": false, "score": 0, "creation_date": 1506788970, "post_id": 46504732, "comment_id": 79963772, "body": "@Wireless Why didn&#39;t you mention that in the question? <code>div</code> is almost equivalent to <code>mod</code>, you can look at the docs later. Did it work?"}, {"owner": {"reputation": 117, "user_id": 7212810, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pNFqk.jpg?s=128&g=1", "display_name": "Wireless", "link": "https://stackoverflow.com/users/7212810/wireless"}, "edited": false, "score": 0, "creation_date": 1506789129, "post_id": 46504732, "comment_id": 79963831, "body": "I forgot, since I did lots of different attempts at making it work, still didn&#39;t test it out, currently waiting for my mom since she asked me for a favor, might be a while till I come back with feedback xD"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 2, "creation_date": 1506790767, "post_id": 46504732, "comment_id": 79964309, "body": "<code>div</code> is used for integer division. I think you meant to use <code>rem</code> or <code>mod</code>."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1506794088, "post_id": 46504732, "comment_id": 79965275, "body": "Oh dear, you&#39;re right! What a mistake. I&#39;ll correct that immediately."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 2, "last_activity_date": 1506794106, "last_edit_date": 1506794106, "creation_date": 1506788779, "answer_id": 46504732, "question_id": 46504296, "link": "https://stackoverflow.com/questions/46504296/checking-numbers-while-making-list-cant-match-expected-type-bool/46504732#46504732", "title": "Checking numbers while making list: &quot;Can&#39;t match expected type &#39;Bool&#39;&quot;", "body": "<p>This is the general form of a list comprehension:</p>\n\n<p><code>[ <i>expr</i> | <i>pattern1</i> &lt;- <i>expr1</i>, <i>pattern2</i> &lt;- <i>expr2</i> ..., <i>test1</i> ,<i>test2</i> ... ]</code></p>\n\n<p>That is to say <code>test1</code>, <code>test2</code> etc are all <code>Bools</code>. These are boolean values that are tested to see what goes into the list.</p>\n\n<p>Your expression has a problem:</p>\n\n<pre><code>[x | x &lt;- [1..99], digits x]\n--                 ^^^^^^^^ Here\n</code></pre>\n\n<p>The problem is, <code>digits x</code> isn't a <code>Bool</code>, it's an <code>[Int]</code>. The correct expression would be:</p>\n\n<pre><code>[ x | x &lt;- [1..99], x `rem` sum (digits x) == 0]\n</code></pre>\n\n<p>In English, we would read this as \"All numbers x from 1 to 99 where the digits of x divide x.\"</p>\n\n<p>Your issue was, you were trying to say that a list of digits was a <code>Bool</code>, and GHC didn't understand.</p>\n"}], "owner": {"reputation": 117, "user_id": 7212810, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pNFqk.jpg?s=128&g=1", "display_name": "Wireless", "link": "https://stackoverflow.com/users/7212810/wireless"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1506867868, "creation_date": 1506786002, "last_edit_date": 1506867868, "question_id": 46504296, "link": "https://stackoverflow.com/questions/46504296/checking-numbers-while-making-list-cant-match-expected-type-bool", "title": "Checking numbers while making list: &quot;Can&#39;t match expected type &#39;Bool&#39;&quot;", "body": "<p>So, I just recently started working around with Haskell and I'm trying to make something that makes a list, for example, from [1..99] and checks the numbers that are divisible by the sum of their digits, for example, 63 (6+3 = 9, 63 divides by 9).</p>\n\n<p>I was doing the following:</p>\n\n<pre><code>digits = map digitToInt . show\ninac = [x | x &lt;- [1..99], digits x] -- (testing here)\n</code></pre>\n\n<p>It gave me the following error : </p>\n\n<pre><code>&lt;interactive&gt;:83:38: error:\n    \u2022 Couldn't match expected type \u2018Bool\u2019 with actual type \u2018[Int]\u2019\n    \u2022 In the expression: digits x\n      In a stmt of a list comprehension: digits x\n      In the expression: [x | x &lt;- [1 .. 999], digits x]\n</code></pre>\n\n<p>Thanks in advance, and sorry if this is just a rookie error.</p>\n"}, {"tags": ["haskell", "applicative", "category-theory"], "answers": [{"comments": [{"owner": {"reputation": 785, "user_id": 2047038, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0c861f36ff63edadc0d3dc8d26328e5c?s=128&d=identicon&r=PG", "display_name": "Mahdi Dibaiee", "link": "https://stackoverflow.com/users/2047038/mahdi-dibaiee"}, "edited": false, "score": 0, "creation_date": 1506796601, "post_id": 46504550, "comment_id": 79966084, "body": "Thanks a lot, I ended up proving it backwards by going from the right-hand side to the left-hand side. I didn&#39;t accept your answer as it doesn&#39;t really include the proof, care to share your proof?"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 785, "user_id": 2047038, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0c861f36ff63edadc0d3dc8d26328e5c?s=128&d=identicon&r=PG", "display_name": "Mahdi Dibaiee", "link": "https://stackoverflow.com/users/2047038/mahdi-dibaiee"}, "edited": false, "score": 0, "creation_date": 1506801840, "post_id": 46504550, "comment_id": 79967566, "body": "My proof was the same backwards proof as yours, with a few extra steps at the end similar to @leftroundabout&#39;s eta expansion.  Feel free to accept your own answer as the complete one."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 3, "last_activity_date": 1506789406, "last_edit_date": 1506789406, "creation_date": 1506787547, "answer_id": 46504550, "question_id": 46503793, "link": "https://stackoverflow.com/questions/46503793/applicative-prove-pure-f-x-pure-flip-x-pure-f/46504550#46504550", "title": "Applicative: Prove `pure f &lt;*&gt; x = pure (flip ($)) &lt;*&gt; x &lt;*&gt; pure f`", "body": "<p>The first two steps of your proof look fine, but the last step doesn't.  While the definition of <code>flip</code> allows you to use a law like:</p>\n\n<pre><code>f a b = flip f b a\n</code></pre>\n\n<p>that doesn't mean:</p>\n\n<pre><code>pure f &lt;*&gt; a &lt;*&gt; b = pure (flip f) &lt;*&gt; b &lt;*&gt; a\n</code></pre>\n\n<p>In fact, this is false in general.  Compare the output of these two lines:</p>\n\n<pre><code>pure (+) &lt;*&gt; [1,2,3] &lt;*&gt; [4,5]\npure (flip (+)) &lt;*&gt; [4,5] &lt;*&gt; [1,2,3]\n</code></pre>\n\n<p>If you want a hint, you are going to need to use the original interchange law at some point to prove this variant.</p>\n\n<p>In fact, I found I had to use the homomorphism, interchange, and composition laws to prove this, and part of the proof was pretty tricky, especially getting the sections right --like <code>($ f)</code>, which is different from <code>(($) f)</code>.  It was helpful to have GHCi open to double-check that each step of my proof type checked and gave the right result.  (Your proof above type checks fine; it's just that the last step wasn't justified.)</p>\n\n<pre><code>&gt; let f = sqrt\n&gt; let x = [1,4,9]\n&gt; pure f &lt;*&gt; x\n[1.0,2.0,3.0]\n&gt; pure (flip ($)) &lt;*&gt; x &lt;*&gt; pure f\n[1.0,2.0,3.0]\n&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1506797562, "post_id": 46505868, "comment_id": 79966412, "body": "That last step is straightforward enough with a single eta-expansion, isn&#39;t it? <code>($f) . flip ($) \u2261 \\x -&gt; ($f) $ ($x) \u2261 \\x -&gt; ($x)$f \u2261 \\x -&gt; f $ x \u2261 f</code>."}, {"owner": {"reputation": 785, "user_id": 2047038, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0c861f36ff63edadc0d3dc8d26328e5c?s=128&d=identicon&r=PG", "display_name": "Mahdi Dibaiee", "link": "https://stackoverflow.com/users/2047038/mahdi-dibaiee"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1506797901, "post_id": 46505868, "comment_id": 79966521, "body": "@leftaroundabout Yeah, it should be, I&#39;m actually writing a post on Typoclassopedia with solutions to the exercises, and this explanation is for that post, so I tried to explain piece by piece for anyone struggling to grasp it at first. btw, thanks for the edit, looks much better."}], "tags": [], "owner": {"reputation": 785, "user_id": 2047038, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0c861f36ff63edadc0d3dc8d26328e5c?s=128&d=identicon&r=PG", "display_name": "Mahdi Dibaiee", "link": "https://stackoverflow.com/users/2047038/mahdi-dibaiee"}, "is_accepted": true, "score": 3, "last_activity_date": 1506797366, "last_edit_date": 1506797366, "creation_date": 1506796534, "answer_id": 46505868, "question_id": 46503793, "link": "https://stackoverflow.com/questions/46503793/applicative-prove-pure-f-x-pure-flip-x-pure-f/46505868#46505868", "title": "Applicative: Prove `pure f &lt;*&gt; x = pure (flip ($)) &lt;*&gt; x &lt;*&gt; pure f`", "body": "<p>I ended up proving it backwards:</p>\n\n<pre><code>pure (flip ($)) &lt;*&gt; x &lt;*&gt; pure f\n    = (pure (flip ($)) &lt;*&gt; x) &lt;*&gt; pure f -- &lt;*&gt; is left-associative\n    = pure ($ f) &lt;*&gt; (pure (flip ($)) &lt;*&gt; x) -- interchange\n    = pure (.) &lt;*&gt; pure ($ f) &lt;*&gt; pure (flip ($)) &lt;*&gt; x -- composition\n    = pure (($ f) . (flip ($))) &lt;*&gt; x -- homomorphism\n    = pure (flip ($) f . flip ($)) &lt;*&gt; x -- identical\n    = pure f &lt;*&gt; x\n</code></pre>\n\n<p>Explanation of the last transformation:</p>\n\n<p><code>flip ($)</code> has type <code>a -&gt; (a -&gt; c) -&gt; c</code>, intuitively, it first takes an argument of type <code>a</code>, then a function that accepts that argument, and in the end it calls the function with the first argument. So <code>flip ($) 5</code> takes as argument a function which gets called with <code>5</code> as it's argument. If we pass <code>(+ 2)</code> to <code>flip ($) 5</code>, we get <code>flip ($) 5 (+2)</code> which is equivalent to the expression <code>(+2) $ 5</code>, evaluating to <code>7</code>.</p>\n\n<p><code>flip ($) f</code> is equivalent to <code>\\x -&gt; x $ f</code>, that means, it takes as input a function and calls it with the function <code>f</code> as argument.</p>\n\n<p>The composition of these functions works like this: First <code>flip ($)</code> takes <code>x</code> as it's first argument, and returns a function <code>flip ($) x</code>, this function is awaiting a function as it's last argument, which will be called with <code>x</code> as it's argument. Now this function <code>flip ($) x</code> is passed to <code>flip ($) f</code>, or to write it's equivalent <code>(\\x -&gt; x $ f) (flip ($) x)</code>, this results in the expression <code>(flip ($) x) f</code>, which is equivalent to <code>f $ x</code>. </p>\n\n<p>You can check the type of <code>flip ($) f . flip ($)</code> is something like this (depending on your function <code>f</code>):</p>\n\n<pre><code>\u03bb: let f = sqrt\n\u03bb: :t (flip ($) f) . (flip ($))\n(flip ($) f) . (flip ($)) :: Floating c =&gt; c -&gt; c\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 1, "last_activity_date": 1506798899, "creation_date": 1506798899, "answer_id": 46506203, "question_id": 46503793, "link": "https://stackoverflow.com/questions/46503793/applicative-prove-pure-f-x-pure-flip-x-pure-f/46506203#46506203", "title": "Applicative: Prove `pure f &lt;*&gt; x = pure (flip ($)) &lt;*&gt; x &lt;*&gt; pure f`", "body": "<p>I'd remark that such theorems are, as a rule, a lot less involved when written in mathematical style of a <em>monoidal functor</em>, rather than the applicative version, i.e. with the equivalent class</p>\n\n<pre><code>class Functor f =&gt; Monoidal f where\n  pure :: a -&gt; f a\n  (\u2442) :: f a -&gt; f b -&gt; f (a,b)\n</code></pre>\n\n<p>Then the laws are</p>\n\n<pre><code>id &lt;$&gt; v = v\nf &lt;$&gt; (g &lt;$&gt; v) = f . g &lt;$&gt; v\nf &lt;$&gt; pure x = pure (f x)\nx \u2442 pure y = fmap (,y) x\na\u2442(b\u2442c) = assoc &lt;$&gt; (a\u2442b)\u2442c\n</code></pre>\n\n<p>where <code>assoc ((x,y),z) = (x,(y,z))</code>.</p>\n\n<p>The theorem then reads</p>\n\n<pre><code>pure u \u2442 x = swap &lt;$&gt; x \u2442 pure u\n</code></pre>\n\n<p>Proof:</p>\n\n<pre><code>swap &lt;$&gt; x \u2442 pure u\n    = swap &lt;$&gt; fmap (,u) x\n    = swap . (,u) &lt;$&gt; x\n    = (u,) &lt;$&gt; x\n    = pure u \u2442 x\n</code></pre>\n\n<p>\u25a1</p>\n"}], "owner": {"reputation": 785, "user_id": 2047038, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0c861f36ff63edadc0d3dc8d26328e5c?s=128&d=identicon&r=PG", "display_name": "Mahdi Dibaiee", "link": "https://stackoverflow.com/users/2047038/mahdi-dibaiee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 1, "accepted_answer_id": 46505868, "answer_count": 3, "score": 2, "last_activity_date": 1506798899, "creation_date": 1506782643, "last_edit_date": 1592644375, "question_id": 46503793, "link": "https://stackoverflow.com/questions/46503793/applicative-prove-pure-f-x-pure-flip-x-pure-f", "title": "Applicative: Prove `pure f &lt;*&gt; x = pure (flip ($)) &lt;*&gt; x &lt;*&gt; pure f`", "body": "<p>During my study of <a href=\"https://wiki.haskell.org/Typeclassopedia\" rel=\"nofollow noreferrer\">Typoclassopedia</a> I encountered this proof, but I'm not sure if my proof is correct. The question is:</p>\n<blockquote>\n<p>One might imagine a variant of the interchange law that says something about applying a pure function to an effectful argument. Using the above laws, prove that:</p>\n<p><code>pure f &lt;*&gt; x = pure (flip ($)) &lt;*&gt; x &lt;*&gt; pure f</code></p>\n</blockquote>\n<p>Where &quot;above laws&quot; points to <a href=\"https://wiki.haskell.org/Typeclassopedia#Laws_2\" rel=\"nofollow noreferrer\">Applicative Laws</a>, briefly:</p>\n<pre><code>pure id &lt;*&gt; v = v -- identity law\npure f &lt;*&gt; pure x = pure (f x) -- homomorphism\nu &lt;*&gt; pure y = pure ($ y) &lt;*&gt; u -- interchange\nu &lt;*&gt; (v &lt;*&gt; w) = pure (.) &lt;*&gt; u &lt;*&gt; v &lt;*&gt; w -- composition\n</code></pre>\n<p>My proof is as follows:</p>\n<pre><code>pure f &lt;*&gt; x = pure (($) f) &lt;*&gt; x -- identical\npure f &lt;*&gt; x = pure ($) &lt;*&gt; pure f &lt;*&gt; x -- homomorphism\npure f &lt;*&gt; x = pure (flip ($)) &lt;*&gt; x &lt;*&gt; pure f -- flip arguments\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 785, "user_id": 2047038, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0c861f36ff63edadc0d3dc8d26328e5c?s=128&d=identicon&r=PG", "display_name": "Mahdi Dibaiee", "link": "https://stackoverflow.com/users/2047038/mahdi-dibaiee"}, "edited": false, "score": 0, "creation_date": 1506785155, "post_id": 46503788, "comment_id": 79962617, "body": "What you are trying to do is getting the character code of <code>\\xcd</code> or <code>\\205</code>, and that can be done using <code>fromEnum</code>. Try this: <code>fromEnum (Data.ByteString.Char8.head val_hex)</code>. Let me know if this answers your question."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1506787643, "post_id": 46503788, "comment_id": 79963348, "body": "You can convert ByteStrings in to <code>[Word8]</code> using <code>unpack</code>. After that it&#39;s just a matter of what each <code>Word8</code> means to you."}], "answers": [{"comments": [{"owner": {"reputation": 583, "user_id": 1433387, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a37d86b7d709785662decc035368ad8e?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1433387/andrew"}, "edited": false, "score": 2, "creation_date": 1506865738, "post_id": 46504991, "comment_id": 79980166, "body": "Oh, Gosh! I really didn&#39;t see the difference between ASCII and Word8 interpretations! Thanks a lot for explanation! In my opinion it is hard to infer this from haddock."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 2, "last_activity_date": 1506790720, "creation_date": 1506790720, "answer_id": 46504991, "question_id": 46503788, "link": "https://stackoverflow.com/questions/46503788/read-int-from-bytestring/46504991#46504991", "title": "Read int from bytestring", "body": "<p>The <code>readInt</code> function is intended to read an integer encoded as an ASCII string from a (typically multi-byte) byte string, like this:</p>\n\n<pre><code>&gt; let b = Data.ByteString.Char8.pack \"12345\"\n&gt; b\n\"12345\"\n&gt; Data.ByteString.Char8.readInt b\nJust (12345,\"\")\n&gt; \n</code></pre>\n\n<p>It looks like you want to extract an integer from a single-byte byte string, where the integer is just the value of the byte.  The most straightforward way is probably to use <code>Data.ByteString.head</code>:</p>\n\n<pre><code>&gt; let b = Data.ByteString.Char8.pack \"\\xcd\"\n&gt; Data.ByteString.head b\n205\n&gt; :t Data.ByteString.head b \nData.ByteString.head b :: GHC.Word.Word8\n&gt; \n</code></pre>\n\n<p>Note that this is <code>head</code> from <code>Data.ByteString</code> which returns <code>Word8</code>, not <code>Data.ByteString.Char8.head</code> which returns a <code>Char</code>.  As a general rule, functions in <code>Data.ByteString.Char8</code> treat a byte string as if it's ASCII encoded, while functions in <code>Data.ByteString</code> just treat it as a bunch of bytes with values from 0-255.  Most programs that manipulate byte strings as ASCII will need to use functions from both modules.</p>\n\n<p>Since <code>Data.ByteString.head</code> returns a <code>Word8</code>, you may need to convert it using <code>fromIntegral</code> to the integer type that you want:</p>\n\n<pre><code>&gt; replicate (fromIntegral (Data.ByteString.head b)) '*'\n\"*** ... 205 asterisks ... ***\"\n&gt;\n</code></pre>\n"}], "owner": {"reputation": 583, "user_id": 1433387, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a37d86b7d709785662decc035368ad8e?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1433387/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 761, "favorite_count": 0, "accepted_answer_id": 46504991, "answer_count": 1, "score": 1, "last_activity_date": 1506790720, "creation_date": 1506782629, "question_id": 46503788, "link": "https://stackoverflow.com/questions/46503788/read-int-from-bytestring", "title": "Read int from bytestring", "body": "<p>How can I get Int from the bytestring:</p>\n\n<pre><code>let val_hex = Data.ByteString.Char8.pack \"\\xcd\"\nlet val_dig = Data.ByteString.Char8.pack \"\\205\"\nval_hex == val_dig -- True\nlet maybeInt = Data.ByteString.Char8.readInt val_hex -- gets Nothing\n</code></pre>\n\n<p>So, I want do restore the value, packed to bytestring. i.e. maybeInt should be Maybe (205, \"\")</p>\n"}, {"tags": ["haskell", "types"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 10, "last_activity_date": 1506773823, "creation_date": 1506773823, "answer_id": 46502619, "question_id": 46502513, "link": "https://stackoverflow.com/questions/46502513/error-compiling-could-not-deduce-ord/46502619#46502619", "title": "Error compiling - could not deduce Ord", "body": "<blockquote>\n  <p>It's a floating number, why can't it compare it?</p>\n</blockquote>\n\n<p>No, it is not <em>per se</em> a floating point number. <code>Floating</code> strictly speaking means that you can perform <em>trigometric</em> and <em>hyperbolic</em> functions on it. Whether that means it is a floating point number, is a different aspect (although it is a bit related).</p>\n\n<p>That being said, it thus does <em>not</em> imply that you can compare two elements. This is however not a problem: we can add the typeclass <code>Ord a</code> to it:</p>\n\n<pre><code>nRaizes :: <b>(Floating a, Ord a)</b> =&gt; a -&gt; a -&gt; a -&gt; a\nnRaizes a b c = let r = b^2 - 4 * a * c\n                  in if r &lt; 0\n                     then 0\n                     else\n                         if r == 0\n                         then 1\n                         else 2</code></pre>\n\n<p>But we defined our function too strict. Why do we need trigometric and hyperbolic functions here? Why not define the function over *all possible number representation with <code>Ord</code>? We can thus generalize the function to:</p>\n\n<pre><code>nRaizes :: (<b>Num</b> a, Ord a) =&gt; a -&gt; a -&gt; a -&gt; a\nnRaizes a b c = let r = b^2 - 4 * a * c\n                  in if r &lt; 0\n                     then 0\n                     else\n                         if r == 0\n                         then 1\n                         else 2</code></pre>\n\n<p>Furthermore, although most people like Christmas. Most programmers do not like Christmas-trees as function definitions. Perhaps a more elegant way to do this is with guards instead of <code>if</code>-<code>then</code>-<code>else</code>s:</p>\n\n<pre><code>nRaizes :: (Num a, Ord a) =&gt; a -&gt; a -&gt; a -&gt; a\nnRaizes a b c <b>| r &lt; 0 = 0\n              | r == 0 = 1\n              | otherwise = 2\n    where r = b*b - 4*a*c</b></code></pre>\n\n<p>Finally we produce three possible outputs: <code>0</code>, <code>1</code>, and <code>2</code>. But nothing says that the type of output should be the same as the type of <code>a</code>, <code>b</code> and <code>c</code>. So we can split the type of input and output into:</p>\n\n<pre><code>nRaizes :: (Num a, Ord a<b>, Num b</b>) =&gt; a -&gt; a -&gt; a -&gt; <b>b</b>\nnRaizes a b c | r &lt; 0 = 0\n              | r == 0 = 1\n              | otherwise = 2\n    where r = b*b - 4*a*c</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 7927309, "user_type": "registered", "profile_image": "https://graph.facebook.com/1378053178938566/picture?type=large", "display_name": "Pedro Fernandes", "link": "https://stackoverflow.com/users/7927309/pedro-fernandes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1506843565, "creation_date": 1506772848, "last_edit_date": 1506843565, "question_id": 46502513, "link": "https://stackoverflow.com/questions/46502513/error-compiling-could-not-deduce-ord", "title": "Error compiling - could not deduce Ord", "body": "<pre><code>nRaizes :: Floating a =&gt; a -&gt; a -&gt; a -&gt; a\n  nRaizes a b c = let r = b^2 - 4 * a * c\n                  in if r &lt; 0\n                     then 0\n                     else if r == 0\n                     then 1\n                     else 2\n</code></pre>\n\n<p>So I got this code, where I'm checking for the number of roots of an equation. But when I try to compile it, it gives me this. </p>\n\n<pre><code> Could not deduce (Ord a) arising from a use of \u2018&lt;\u2019\n    from the context (Floating a)\n      bound by the type signature for\n                 nRaizes :: Floating a =&gt; a -&gt; a -&gt; a -&gt; a\n      at Ficha1.hs:29:14-43\n    Possible fix:\n      add (Ord a) to the context of\n        the type signature for nRaizes :: Floating a =&gt; a -&gt; a -&gt; a -&gt; a\n    In the expression: r &lt; 0\n    In the expression: if r &lt; 0 then 0 else if r == 0 then 1 else 2\n    In the expression:\n      let r = b ^ 2 - 4 * a * c\n      in if r &lt; 0 then 0 else if r == 0 then 1 else 2\n\nFicha1.hs:33:32:\n    Could not deduce (Eq a) arising from a use of \u2018==\u2019\n    from the context (Floating a)\n      bound by the type signature for\n                 nRaizes :: Floating a =&gt; a -&gt; a -&gt; a -&gt; a\n      at Ficha1.hs:29:14-43\n    Possible fix:\n      add (Eq a) to the context of\n        the type signature for nRaizes :: Floating a =&gt; a -&gt; a -&gt; a -&gt; a\n    In the expression: r == 0\n    In the expression: if r == 0 then 1 else 2\n    In the expression: if r &lt; 0 then 0 else if r == 0 then 1 else 2\n</code></pre>\n\n<p>Yes, I'm a begginer. I seriously cannot even understand what is wrong. It's a floating number, why can't it compare it? \nI just know it has something to do with the signature, because if I remove it it works</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": true, "score": 5, "last_activity_date": 1506771759, "last_edit_date": 1506771759, "creation_date": 1506768026, "answer_id": 46501936, "question_id": 46501427, "link": "https://stackoverflow.com/questions/46501427/why-doesnt-this-tcp-server-work/46501936#46501936", "title": "Why doesn&#39;t this TCP server work?", "body": "<p><code>listenOn</code> just creates a \"listen socket\" which \"listen\" new connections to your server. You should to use the <code>accept</code> function to obtain new clients, like this:</p>\n\n<pre><code>main :: IO ()\nmain = do\n    sock &lt;- listenOn $ PortNumber 2000\n    (client, _, _) &lt;- accept sock\n    contents &lt;- hGetContents client\n    print contents\n    sClose sock\n</code></pre>\n\n<p>Or use lowlevel the <code>accept</code> function (from the <code>Network.Socket</code> module) to obtain socket:</p>\n\n<pre><code>main :: IO ()\nmain = do\n    sock &lt;- listenOn $ PortNumber 2000\n    (client, _) &lt;- accept sock\n    contents &lt;- recv client 4096\n    print contents\n    sClose client\n    sClose sock\n</code></pre>\n\n<p>If you want to handle more clients you can use <code>forkIO</code> like this:</p>\n\n<pre><code>main :: IO ()\nmain = do\n    sock &lt;- listenOn $ PortNumber 2000\n    forever $ do\n        (client, _) &lt;- accept sock\n        forkIO $ do\n            contents &lt;- recv client 4096\n            print contents\n            sClose client\n</code></pre>\n"}], "owner": {"reputation": 1277, "user_id": 7254635, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/280e5fa5140a804fcd8fd9dfe3198542?s=128&d=identicon&r=PG&f=1", "display_name": "wang kai", "link": "https://stackoverflow.com/users/7254635/wang-kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 46501936, "answer_count": 1, "score": 2, "last_activity_date": 1506771759, "creation_date": 1506763438, "last_edit_date": 1506765623, "question_id": 46501427, "link": "https://stackoverflow.com/questions/46501427/why-doesnt-this-tcp-server-work", "title": "Why doesn&#39;t this TCP server work?", "body": "<p>I wrote this simple tcp server:</p>\n\n<pre><code>import Network\nimport Network.Socket.ByteString\n\nmain :: IO()\nmain = do\n    sock &lt;- listenOn $ PortNumber 2000\n    contents &lt;- recv sock 4096\n    print contents\n</code></pre>\n\n<p>Stack built successfully, so then I ran the server, using telnet to test it, but I got an error:</p>\n\n<p>On linux:</p>\n\n<pre><code>Network.Socket.recvBuf:invalid argument (Transport endpoint is not connected)\n</code></pre>\n\n<p>On windows:</p>\n\n<pre><code>Network.Socket.recvBuf:failed(No error)\n</code></pre>\n\n<p>What's wrong with the program?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 5, "creation_date": 1506762071, "post_id": 46501228, "comment_id": 79956652, "body": "That&#39;s are strange task... for <i>any</i> expression <code>e</code>, you can always obtain an equivalent expression <code>id $ e</code>. That&#39;s certainly not the intended answer, but dumb questions demand dumb answers IMO...  \u2014 Did your teacher also say anything to the end like \u201c<i>without</i> a list comprehension\u201d?"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1506774029, "post_id": 46501428, "comment_id": 79959454, "body": "You may want to point out that the expressions you provide are not equivalent to the OP list comprehension. Or make them equivalent."}], "tags": [], "owner": {"reputation": 825, "user_id": 962828, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/78c370f00a14fb3bd59dc334082378cd?s=128&d=identicon&r=PG", "display_name": "Ulrar", "link": "https://stackoverflow.com/users/962828/ulrar"}, "is_accepted": false, "score": 1, "last_activity_date": 1506769083, "last_edit_date": 1506769083, "creation_date": 1506763445, "answer_id": 46501428, "question_id": 46501228, "link": "https://stackoverflow.com/questions/46501228/how-to-incorporate-in-a-given-expression/46501428#46501428", "title": "How to incorporate $ in a given expression?", "body": "<p>$ just means \"take whatever is on the right, and pass it as argument to the left\".\nSo for example :</p>\n\n<pre><code>map (`mod`7) (take 100 [1..])\nmap (`mod`7) $ take 100 [1..]\n</code></pre>\n\n<p>Those two lines are the same, the $ just means you can avoid the parenthesis around the second call.\nThe take is useless but I didn't have a better idea for a simple example :)</p>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 2, "last_activity_date": 1506768743, "last_edit_date": 1506768743, "creation_date": 1506766994, "answer_id": 46501825, "question_id": 46501228, "link": "https://stackoverflow.com/questions/46501228/how-to-incorporate-in-a-given-expression/46501825#46501825", "title": "How to incorporate $ in a given expression?", "body": "<p><code>($)</code> is in an infix operator with a type signature</p>\n\n<p><code>($) :: (a -&gt; b) -&gt; a -&gt; b</code></p>\n\n<p>which means it takes two parameters, first a function <code>(a -&gt; b)</code> (on the left) which accepts a single parameter, a value of type designated by the type variable <code>a</code>. The second parameter of <code>($)</code> (on the right) is a single value again designated by the type variable <code>a</code>. Then the <code>($)</code> operator simply applies it's second parameter to the first parameter. So for an example <code>(+2) $ 3</code> would give us <code>5</code>.</p>\n\n<p>So if you insist on doing list comprehensions you may do as follows in point-free style;</p>\n\n<pre><code>Prelude&gt; [x|x&lt;-[1..100], (== 0) . mod x $ 7]\n[7,14,21,28,35,42,49,56,63,70,77,84,91,98]\n</code></pre>\n\n<p>or in a more straightforward fashion</p>\n\n<pre><code>Prelude&gt; filter ((==0) . (`mod` 7)) $ take 100 [1..]\n[7,14,21,28,35,42,49,56,63,70,77,84,91,98]\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 8688301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93fe99d15661f583d9f05d5ae589d3ee?s=128&d=identicon&r=PG&f=1", "display_name": "YYGX", "link": "https://stackoverflow.com/users/8688301/yygx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1506769083, "creation_date": 1506761807, "last_edit_date": 1506762247, "question_id": 46501228, "link": "https://stackoverflow.com/questions/46501228/how-to-incorporate-in-a-given-expression", "title": "How to incorporate $ in a given expression?", "body": "<p>I want to write an expression which will give a list that is equal to the list comprehension <code>[x|x&lt;-[1..100], x`mod`7==0]</code>, but I'm asked by my teacher to use <code>$</code> in this program.</p>\n\n<p>So, how could I use <code>$</code> in here?</p>\n\n<p>PS: I'm new to Haskell, so would prefer easy expressions, please.</p>\n"}, {"tags": ["haskell", "cabal", "parsec", "haskell-platform"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1506760332, "post_id": 46500732, "comment_id": 79956213, "body": "Could you try to make a cabal package (<code>cabal init</code>) and build it with cabal or stack (you&#39;ll neet to <code>stack init</code> as well then)"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 4, "creation_date": 1506761536, "post_id": 46500732, "comment_id": 79956525, "body": "I would suggest you to get started with stack: <a href=\"https://haskell-lang.org/get-started\" rel=\"nofollow noreferrer\">haskell-lang.org/get-started</a>"}, {"owner": {"reputation": 717, "user_id": 8454574, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kTiup6qR0Bg/AAAAAAAAAAI/AAAAAAAAARU/PvpHcxcFHqQ/photo.jpg?sz=128", "display_name": "PilotInPyjamas", "link": "https://stackoverflow.com/users/8454574/pilotinpyjamas"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1506763735, "post_id": 46500732, "comment_id": 79957051, "body": "@Sibi Stack works great, and has good documentation for these sorts of issues. I can use <code>stack install parsec</code> to dick around, or for projects, I can add dependencies to the <code>projectName.cabal</code> file."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1507313037, "post_id": 46500732, "comment_id": 80175041, "body": "This was likely an issue with the binary platform builds that&#39;s just been resolved. c.f. <a href=\"https://stackoverflow.com/questions/46508231/issue-installing-snap-on-macos-sierra/46599487#46599487\" title=\"issue installing snap on macos sierra\">stackoverflow.com/questions/46508231/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 1, "last_activity_date": 1517002257, "creation_date": 1517002257, "answer_id": 48469837, "question_id": 46500732, "link": "https://stackoverflow.com/questions/46500732/ghc-cannot-find-libraries-on-fresh-install-of-haskell-platform/48469837#48469837", "title": "GHC cannot find libraries on fresh install of Haskell-Platform", "body": "<p>There was a bug with 8.2.1 binary platform builds, and a new release was cut to fix the issue you encountered.</p>\n\n<p>Details on the bug, and the new release are provided at <a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2017-October/127979.html\" rel=\"nofollow noreferrer\">https://mail.haskell.org/pipermail/haskell-cafe/2017-October/127979.html</a></p>\n"}], "owner": {"reputation": 717, "user_id": 8454574, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kTiup6qR0Bg/AAAAAAAAAAI/AAAAAAAAARU/PvpHcxcFHqQ/photo.jpg?sz=128", "display_name": "PilotInPyjamas", "link": "https://stackoverflow.com/users/8454574/pilotinpyjamas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 498, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1517002257, "creation_date": 1506757938, "question_id": 46500732, "link": "https://stackoverflow.com/questions/46500732/ghc-cannot-find-libraries-on-fresh-install-of-haskell-platform", "title": "GHC cannot find libraries on fresh install of Haskell-Platform", "body": "<p>I'm trying to learn how to use Haskell, but I've run into a little roadblock. I'm using MacOSX 10.12.6 and installed Haskell Platform using:</p>\n\n<pre><code>$ brew cask install haskell-platform\n</code></pre>\n\n<p>with no modifications. When I try to compile a program with <code>parsec</code> imported, Haskell-Platform can't find it:</p>\n\n<pre><code>$ ghc -v test.hs \n...\npackage parsec-3.1.11-DPgnR92AWEaFOaixmwipet is unusable due to shadowed dependencies:\nmtl-2.2.1-19EL8AGBsN3DnnOhrC9xY3 text-1.2.2.2-EGUst8sqNAZCw1xLPcmcMH\n...\ntest.hs:2:1: error:\n    Could not find module \u2018Text.Parsec\u2019\n    Locations searched:\n    Text/Parsec.hs\n    Text/Parsec.lhs\n    Text/Parsec.hsig\n    Text/Parsec.lhsig\n|\n2 | import Text.Parsec\n| ^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>parsec is installed:</p>\n\n<pre><code>$ ghc-pkg list | grep -e 'parsec'\nattoparsec-0.13.2.0\nparsec-3.1.11\n</code></pre>\n\n<p>So I have a few questions: </p>\n\n<ul>\n<li>What does it mean by shadowed dependencies? </li>\n<li>Where does GHC look for libraries?</li>\n<li>Where does GHC look for user libraries vs system wide libraries?</li>\n<li>Can this path be modified?</li>\n</ul>\n"}, {"tags": ["haskell", "cabal", "nix"], "answers": [{"tags": [], "owner": {"reputation": 9137, "user_id": 5171219, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-G5x4vEoGRJc/AAAAAAAAAAI/AAAAAAAAENA/5wwtFtwYH3Q/photo.jpg?sz=128", "display_name": "Emmanuel Rosa", "link": "https://stackoverflow.com/users/5171219/emmanuel-rosa"}, "is_accepted": true, "score": 1, "last_activity_date": 1506773668, "creation_date": 1506773668, "answer_id": 46502601, "question_id": 46499740, "link": "https://stackoverflow.com/questions/46499740/how-to-make-cabal-to-be-found-in-a-straigthforward-nix-pill-8-1-imitation/46502601#46502601", "title": "How to make cabal to be found in a straigthforward nix-pill 8.1 imitation?", "body": "<p>The problem with <code>inherit cabal-install;</code> is that <code>cabal-install</code> is not a valid variable name in BASH. Nix converts the keys in the set provided to <code>derivation</code> into variables in BASH.</p>\n\n<p>Instead of <code>inherit cabal-install;</code> you can do something like <code>cabal_install = cabal-install;</code> and then use <code>cabal_install</code> in your builder.</p>\n"}], "owner": {"reputation": 799, "user_id": 1964881, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/bVDPU.png?s=128&g=1", "display_name": "Gspia", "link": "https://stackoverflow.com/users/1964881/gspia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 46502601, "answer_count": 1, "score": 0, "last_activity_date": 1506773668, "creation_date": 1506747699, "last_edit_date": 1506757023, "question_id": 46499740, "link": "https://stackoverflow.com/questions/46499740/how-to-make-cabal-to-be-found-in-a-straigthforward-nix-pill-8-1-imitation", "title": "How to make cabal to be found in a straigthforward nix-pill 8.1 imitation?", "body": "<p>The cabal isn't found on the following example and the question is, how to correct the example so that cabal is found.</p>\n\n<p>This example is very straigthforward modification of <a href=\"https://nixos.org/nixos/nix-pills/generic-builders.html\" rel=\"nofollow noreferrer\">the nix pill 8.1</a>. On <code>nix-repl</code>, typing <code>:l &lt;nixpkgs&gt;</code> and then <code>\"${cabal-install}\"</code> gives a path to the store where cabal-install is and it contains sub-dirs with bin there containing cabal-executable. I.e.</p>\n\n<pre><code>&gt; /nix/store/pathtocabal-install/bin/cabal -v\ncabal-install version 2.0.0.0\ncompiled using version 2.0.0.2 of the Cabal library\n</code></pre>\n\n<p>Below you should find the files corresponding to the the \"make c\" example.</p>\n\n<p>With them, the</p>\n\n<pre><code>&gt; nix-build hello.nix\n</code></pre>\n\n<p>doesn't work. It first tells to build \"these derivations\" and then says that </p>\n\n<pre><code>hello_builder.sh: line 2: cabal: command not found\n</code></pre>\n\n<p>I'm suspecting that $cabal-install/bin is a wrong way to refer to cabal but on <code>nix-repl</code> its store-path is found. </p>\n\n<p>hello_builder.sh  is even shorter than in the c-example. Note that installation part is still missing (first the builder should be made to find the cabal).</p>\n\n<pre><code>export PATH=\"$coreutils/bin:$ghc/bin:$cabal-install/bin:$binutils/bin\"\ncabal build hello\n</code></pre>\n\n<p>hello.nix - maybe the binutils is not needed. </p>\n\n<pre><code>with (import &lt;nixpkgs&gt; {});\nderivation {\n  name = \"hello\";\n  builder = \"${bash}/bin/bash\";\n  args = [ ./hello_builder.sh ];\n  inherit binutils coreutils ghc cabal-install;\n  src = ./hello.cabal;\n  system = builtins.currentSystem;\n}\n</code></pre>\n\n<p>hello.cabal - in <code>nix-shell</code> with cabal-install and ghc, this works.</p>\n\n<pre><code>name:                hello\nversion:             0.1.0.0\nbuild-type:          Simple\ncabal-version:       &gt;=1.24\n\nexecutable hello\n  main-is:             hello.hs\n  default-language:    Haskell2010\n  build-depends:       base              &gt;=4.9 &amp;&amp; &lt;4.10\n</code></pre>\n\n<p>hello.hs</p>\n\n<pre><code>module Main where\n\nmain :: IO ()\nmain = putStrLn \"Hello there!\"\n</code></pre>\n\n<hr>\n\n<p>Late additions:</p>\n\n<p>By adding <code>echo $PATH</code> to the builder, we can see that the path is not correct. It is <code>/nix/store/...coreutils-8.28/bin:/nix/store...ghc-8.0.2/bin:-install/bin:/nix/store/...binutils-2.28.1/bin</code>. There the <code>$cabal</code> is turned into an empty string and it is not referring to <code>$cabal-install</code>. Thus there is no correct store-path for the cabal-executable.</p>\n\n<p>This answers part of the why-part of the question and how to correct it remains. And the open why-part is, why <code>inherit cabal-install</code> cannot be used here. </p>\n"}, {"tags": ["haskell", "functional-programming", "ghc", "functional-dependencies"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1506721024, "post_id": 46497055, "comment_id": 79949264, "body": "I think the code smell here is maybe your type class. Anytime I see type classes whose methods all take <code>a</code> as the first argument, I get suspicious that someone is trying to shoehorn object oriented classes into Haskell type classes. It probably sounds like you want to put the <code>Bar</code> and <code>Candle</code> constructors under the same ADT."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1506725141, "post_id": 46497055, "comment_id": 79950441, "body": "I think this will quickly descend towards a known <a href=\"https://lukepalmer.wordpress.com/2010/01/24/haskell-antipattern-existential-typeclass/\" rel=\"nofollow noreferrer\">antipattern</a>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1506725372, "post_id": 46497055, "comment_id": 79950488, "body": "Two comments on what&#39;s gone wrong (without proposing a solution). 1. Lists are homogeneous (all elements have the same type), so <code>[emptyCandle, emptyBar]</code> is right out. 2. The type <code>Foo a =&gt; [a]</code> gives the user of this value control over which instance of <code>Foo</code> is chosen; the implementer has to be prepared to produce a list of values of <i>any</i> type which is an instance of <code>Foo</code>, whereas you seem to be thinking that the implementer of this type gets to choose <i>their favorite</i> type which is an instance of <code>Foo</code>."}, {"owner": {"reputation": 203, "user_id": 827415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9c5b6a24d960070ad2cb62b55146ca05?s=128&d=identicon&r=PG", "display_name": "Invoke", "link": "https://stackoverflow.com/users/827415/invoke"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1506728347, "post_id": 46497055, "comment_id": 79951087, "body": "@Alec yes, I agree, I was trying to bring the swift &quot;protocol&quot; style to Haskell, which at some point it has kicked me back saying NO, specially when I had to declare the instance on both sides of the declaration, which seemed weird for me,"}, {"owner": {"reputation": 203, "user_id": 827415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9c5b6a24d960070ad2cb62b55146ca05?s=128&d=identicon&r=PG", "display_name": "Invoke", "link": "https://stackoverflow.com/users/827415/invoke"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1506728399, "post_id": 46497055, "comment_id": 79951100, "body": "@chi I agree with that blog post, here is another very very related to the same topic: <a href=\"http://www.haskellforall.com/2012/05/scrap-your-type-classes.html\" rel=\"nofollow noreferrer\">haskellforall.com/2012/05/scrap-your-type-classes.html</a>"}, {"owner": {"reputation": 203, "user_id": 827415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9c5b6a24d960070ad2cb62b55146ca05?s=128&d=identicon&r=PG", "display_name": "Invoke", "link": "https://stackoverflow.com/users/827415/invoke"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1506728594, "post_id": 46497055, "comment_id": 79951145, "body": "@DanielWagner: my expectation was to have an homogeneous list of type &quot;GenericData&quot; that I can pass along functions, then use their declared &quot;dataParsing&quot; to transform the string into an instance of that object, however that is showing to not behave well at runtime."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1506733914, "post_id": 46497055, "comment_id": 79952071, "body": "To compile it would need to be <code>possibleCandidates = [dataEmptyInstance, dataEmptyInstance]</code>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1506737308, "post_id": 46497055, "comment_id": 79952593, "body": "@Invoke That would be fine. There&#39;s just one problem: <code>GenericData</code> is not a type."}], "answers": [{"comments": [{"owner": {"reputation": 203, "user_id": 827415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9c5b6a24d960070ad2cb62b55146ca05?s=128&d=identicon&r=PG", "display_name": "Invoke", "link": "https://stackoverflow.com/users/827415/invoke"}, "edited": false, "score": 1, "creation_date": 1507050662, "post_id": 46510337, "comment_id": 80054094, "body": "I ended up doing something similar your solution based on this blog post: <a href=\"http://www.haskellforall.com/2012/05/scrap-your-type-classes.html\" rel=\"nofollow noreferrer\">haskellforall.com/2012/05/scrap-your-type-classes.html</a>"}], "tags": [], "owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "is_accepted": false, "score": 2, "last_activity_date": 1506844411, "creation_date": 1506844411, "answer_id": 46510337, "question_id": 46497055, "link": "https://stackoverflow.com/questions/46497055/list-of-a-type-classe-instance/46510337#46510337", "title": "List of a Type Classe instance", "body": "<p>You have a type signature:</p>\n\n<pre><code>possibleCandidates :: GenericData a =&gt; [a]\n</code></pre>\n\n<p>Which you might thing implies that you can put anything in that list as long as it is <code>GenericData</code>. But that is not the way Haskell's type system actually works. The value <code>possibleCandidates</code> can be a list of any type which has a <code>GenericData</code> class but every element of the list must be of the <em>same</em> type.</p>\n\n<p>What the GHC error message is telling you (in its own special way) is that the first element of the list is a <code>Candle</code> so it thinks that the rest of the list should also be of type <code>Candle</code> but the second element is actually a <code>Bar</code>.</p>\n\n<p>Now there are ways to make heterogeneous lists (and other collections) in Haskell, but it is almost never the right thing to do.</p>\n\n<p>One typical solution to this problem is to just merge everything down into one <a href=\"https://wiki.haskell.org/Algebraic_data_type\" rel=\"nofollow noreferrer\">sum data type</a>:</p>\n\n<pre><code>data GenericData = GenericCandle Candle | GenericBar Bar\n</code></pre>\n\n<p>You could even forgo the step of indirection and just put the Candle and Bar data directly into the data structure.</p>\n\n<p>Now instead f a class you just have a datatype and your class functions become normal functions:</p>\n\n<pre><code>dataName :: GenericData -&gt; String\ndataIdentifier :: GenericData -&gt; Double\ndataParsing :: GenericData -&gt; String -&gt; Maybe a\ndataEmptyInstance :: String -&gt; GenericData\n</code></pre>\n\n<p>There are some other more complex ways to make this work, but if a sum data type fits the bill, use it. It is very common for parsers in Haskell to have a large sum data type (usually also recursive) as their result. Take a look at the <a href=\"https://hackage.haskell.org/package/aeson-1.2.2.0/docs/Data-Aeson-Types.html#t:Value\" rel=\"nofollow noreferrer\"><code>Value</code></a> type in <a href=\"https://hackage.haskell.org/package/aeson\" rel=\"nofollow noreferrer\">Aeson</a> the standard JSON library for an example.  </p>\n"}], "owner": {"reputation": 203, "user_id": 827415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9c5b6a24d960070ad2cb62b55146ca05?s=128&d=identicon&r=PG", "display_name": "Invoke", "link": "https://stackoverflow.com/users/827415/invoke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506844411, "creation_date": 1506720020, "last_edit_date": 1506720461, "question_id": 46497055, "link": "https://stackoverflow.com/questions/46497055/list-of-a-type-classe-instance", "title": "List of a Type Classe instance", "body": "<p>I've been playing around with Haskell type classes and I am facing a problem I hope someone could help me to solve. Consider that I come from a Swift background and \"trying\" to port some of protocol oriented knowledge to Haskell code.</p>\n\n<p>Initially I declared a bunch of JSON parsers which had the same structure, just a different implementation:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>data Candle = Candle {\n  mts :: Integer,\n  open :: Double,\n  close :: Double\n}\n\ndata Bar = Bar {\n  mts :: Integer,\n  min :: Double,\n  max :: Double\n}\n</code></pre>\n\n<p>Then I decided to create a \"Class\" that would define their basic operations:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>class GenericData a where\n  dataName :: a -&gt; String\n  dataIdentifier :: a -&gt; Double\n  dataParsing :: a -&gt; String -&gt; Maybe a\n  dataEmptyInstance :: a\n\n\ninstance GenericData Candle where\n  dataName _ = \"Candle\"\n  dataIdentifier = fromInteger . mts\n  dataParsing _ = candleParsing\n  dataEmptyInstance = emptyCandle\n\ninstance GenericData Bar where\n  dataName _ = \"Bar\"\n  dataIdentifier = fromInteger . mts\n  dataParsing _ = barParsing\n  dataEmptyInstance = emptyBar\n</code></pre>\n\n<p>My first code smell was the need to include \"a\" when it was not needed (<code>dataName</code> or <code>dataParsing</code>) but then I proceded.</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>analyzeArguments :: GenericData a =&gt; [] -&gt; [String] -&gt; Maybe (a, [String])\nanalyzeArguments [] _             = Nothing\nanalyzeArguments _ []             = Nothing\nanalyzeArguments name data\n    | name == \"Candles\" = Just (head possibleCandidates, data)\n    | name == \"Bar\" = Just (last possibleRecordCandidates, data)\n    | otherwise  = Nothing\n\npossibleCandidates :: GenericData a =&gt; [a]\npossibleCandidates = [emptyCandle, emptyBar]\n</code></pre>\n\n<p>Now, when I want to select if either instance should be selected to perform parsing, I always get the following error</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>\u2022 Couldn't match expected type \u2018a\u2019 with actual type \u2018Candle\u2019\n  \u2018a\u2019 is a rigid type variable bound by\n    the type signature for:\n      possibleCandidates :: forall a. GenericData a =&gt; [a]\n    at src/GenericRecords.hs:42:29\n</code></pre>\n\n<p>My objective was to create a list of instances of <code>GenericData</code> because other functions depend on that being selected to execute the correct <code>dataParser</code>. I understand this has something to do with the type class checker, the <code>* -&gt; Constraint</code>, but still not finding a way to solve this conflict. I have used several GHC language extensions but none has solved the problem.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7141, "user_id": 1360803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/078e321f88c6fc29e2fa02e377b1c443?s=128&d=identicon&r=PG", "display_name": "Polygnome", "link": "https://stackoverflow.com/users/1360803/polygnome"}, "edited": false, "score": 14, "creation_date": 1506708003, "post_id": 46494499, "comment_id": 79943514, "body": "Well not using <code>Debug.Trace</code> from <b>production</b> code isn&#39;t far fetched. You shouldn&#39;t use <b>debug</b> features in <b>production</b> code in <i>any</i> programming language, unless you absolutely and unequivocally know what you are doing (thats said without knowing the specifics of what you are asking about, I&#39;m not great with haskell - just common sense)."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 7141, "user_id": 1360803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/078e321f88c6fc29e2fa02e377b1c443?s=128&d=identicon&r=PG", "display_name": "Polygnome", "link": "https://stackoverflow.com/users/1360803/polygnome"}, "edited": false, "score": 0, "creation_date": 1506710352, "post_id": 46494499, "comment_id": 79944571, "body": "@Polygnome that should be an answer."}, {"owner": {"reputation": 579, "user_id": 8426314, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101771879690894/picture?type=large", "display_name": "Nathan Wilson", "link": "https://stackoverflow.com/users/8426314/nathan-wilson"}, "reply_to_user": {"reputation": 7141, "user_id": 1360803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/078e321f88c6fc29e2fa02e377b1c443?s=128&d=identicon&r=PG", "display_name": "Polygnome", "link": "https://stackoverflow.com/users/1360803/polygnome"}, "edited": false, "score": 0, "creation_date": 1506710416, "post_id": 46494499, "comment_id": 79944602, "body": "@Polygnome: Indeed.  Perhaps I should have really asked why it&#39;s bad to use <code>unsafePerformIO</code> to log a message from a production build (which is what <code>Debug.Trace</code> does)"}, {"owner": {"reputation": 7141, "user_id": 1360803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/078e321f88c6fc29e2fa02e377b1c443?s=128&d=identicon&r=PG", "display_name": "Polygnome", "link": "https://stackoverflow.com/users/1360803/polygnome"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1506710570, "post_id": 46494499, "comment_id": 79944662, "body": "@HTNW No it shouldn&#39;t be. It might be common sense, but it doesn&#39;t answer the question <i>why</i> it is bad at all."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1506724633, "post_id": 46494499, "comment_id": 79950310, "body": "It&#39;s like debugging with <code>print</code> statements in a lot of languages. It is usually a poor man&#39;s solution: better tools exists."}], "answers": [{"comments": [{"owner": {"reputation": 579, "user_id": 8426314, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101771879690894/picture?type=large", "display_name": "Nathan Wilson", "link": "https://stackoverflow.com/users/8426314/nathan-wilson"}, "edited": false, "score": 0, "creation_date": 1506711431, "post_id": 46494886, "comment_id": 79945067, "body": "Yes of course.  I was merely thinking about the case where <code>foo</code> was an expression that was already evaluated for other reasons, but I didn&#39;t think through the fact that <code>foo</code> could of course throw an error if the expression is only used for the call to <code>trace</code> or would otherwise not be evaluated."}, {"owner": {"reputation": 579, "user_id": 8426314, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101771879690894/picture?type=large", "display_name": "Nathan Wilson", "link": "https://stackoverflow.com/users/8426314/nathan-wilson"}, "edited": false, "score": 0, "creation_date": 1506712717, "post_id": 46494886, "comment_id": 79945692, "body": "but isn&#39;t that just a limitation of <code>trace</code> in general though?  Given what you just said, why even use it in development? But some people <i>do</i> use it because they find it helpful.  Why is the usefulness of <code>trace</code> limited to development and not valid in production?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 579, "user_id": 8426314, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101771879690894/picture?type=large", "display_name": "Nathan Wilson", "link": "https://stackoverflow.com/users/8426314/nathan-wilson"}, "edited": false, "score": 1, "creation_date": 1506712916, "post_id": 46494886, "comment_id": 79945791, "body": "@NathanWilson Often during development we are willing to make small sacrifices (e.g. give up control over printing order) in the name of expedience. It is occasionally useful during development to speed up our understanding of where the code has gone wrong; and in small doses, the problems listed above are less painful. But a large system with <code>trace</code>s scattered throughout would be unmanageable."}, {"owner": {"reputation": 579, "user_id": 8426314, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101771879690894/picture?type=large", "display_name": "Nathan Wilson", "link": "https://stackoverflow.com/users/8426314/nathan-wilson"}, "edited": false, "score": 0, "creation_date": 1506713245, "post_id": 46494886, "comment_id": 79945929, "body": "If you&#39;ll permit me a follow-up question, (I&#39;m realizing my question shouldn&#39;t really be about <code>trace</code> at all, but rather &quot;why is unsafe IO <i>for the purposes of logging</i> considered evil?&quot;):  If you could imagine a function that logged some expression&#39;s value in a more robust way than <code>trace</code>, where it didn&#39;t affect the performance of the thread you&#39;re in, and it processed all messages in order (like with an Actor), but used unsafe IO, would you consider it evil?  It wouldn&#39;t affect any program output, so why bother with <code>IO</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 579, "user_id": 8426314, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101771879690894/picture?type=large", "display_name": "Nathan Wilson", "link": "https://stackoverflow.com/users/8426314/nathan-wilson"}, "edited": false, "score": 0, "creation_date": 1506713553, "post_id": 46494886, "comment_id": 79946063, "body": "@NathanWilson I can&#39;t imagine a function that processed all messages in order, and I suspect that if you can you haven&#39;t yet understood lazy evaluation. I encourage you to read through <a href=\"https://alliance.seas.upenn.edu/~bcpierce/courses/552-2008/resources/awkward.pdf\" rel=\"nofollow noreferrer\">Tackling the Awkward Squad</a> by SPJ; it discusses in some detail why laziness and IO are incompatible."}, {"owner": {"reputation": 579, "user_id": 8426314, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101771879690894/picture?type=large", "display_name": "Nathan Wilson", "link": "https://stackoverflow.com/users/8426314/nathan-wilson"}, "edited": false, "score": 0, "creation_date": 1506714074, "post_id": 46494886, "comment_id": 79946297, "body": "I&#39;m sorry, by &quot;process messages in order&quot; I don&#39;t mean that the messages should be logged in a predefined order, but rather just that the logger won&#39;t trip over itself as per the example you gave in your answer.  So if function <code>f</code> logged something and function <code>g</code> logged something else, it doesn&#39;t matter whether <code>f</code>&#39;s message or <code>g</code>&#39;s message gets logged first, just that one message will be completely logged before starting the next one.  (The logger itself would obviously need IO to do this, but there&#39;s no technical reason why a &quot;pure&quot; caller couldn&#39;t use unsafe IO with the desired effect)"}, {"owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "reply_to_user": {"reputation": 579, "user_id": 8426314, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101771879690894/picture?type=large", "display_name": "Nathan Wilson", "link": "https://stackoverflow.com/users/8426314/nathan-wilson"}, "edited": false, "score": 0, "creation_date": 1506715123, "post_id": 46494886, "comment_id": 79946782, "body": "@NathanWilson What kind of logging are you talking about? The way I use production logs is to write messages before or after certain actions so I can know something about how the execution went. In that case, <code>unsafePerformIO</code>&#39;s lack of order would be pretty bad -- messages would be shuffled or (after a crash) missing. I can see some value in instrumentation though, when you don&#39;t want to determined what happened when during potential failure, but instead just want a count of certain events in a working program."}, {"owner": {"reputation": 579, "user_id": 8426314, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101771879690894/picture?type=large", "display_name": "Nathan Wilson", "link": "https://stackoverflow.com/users/8426314/nathan-wilson"}, "reply_to_user": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1506715328, "post_id": 46494886, "comment_id": 79946892, "body": "@thatotherguy, I&#39;m talking about log messages where you want to inspect the value of some intermediate step of a transformation.  If I have a really complex transformation, and it&#39;s not working correctly for some given input, it helps if I can see what some of the intermediate transformations output.  Of course, order doesn&#39;t matter in that case.  I would hate to make an otherwise pure transformation use IO just so that I can inspect different stages of it."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 579, "user_id": 8426314, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101771879690894/picture?type=large", "display_name": "Nathan Wilson", "link": "https://stackoverflow.com/users/8426314/nathan-wilson"}, "edited": false, "score": 3, "creation_date": 1506718937, "post_id": 46494886, "comment_id": 79948535, "body": "@NathanWilson, <code>trace</code> is just rather fragile and hard to control, and it also does not cause the types to tell you what&#39;s going on (which is something we love about Haskell). Something to consider is putting the transformation in a <code>Writer</code> monad (instead of going all the way to <code>IO</code>).  Then you would have a way to access and transform the intermediate steps programmatically, rather than just printing them to a screen/log.  If you think you&#39;d want that.  Sounds like you&#39;re mainly debugging though, I&#39;d say go nuts.  But once you get your algorithm correct, it&#39;s worth formalizing."}, {"owner": {"reputation": 579, "user_id": 8426314, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101771879690894/picture?type=large", "display_name": "Nathan Wilson", "link": "https://stackoverflow.com/users/8426314/nathan-wilson"}, "edited": false, "score": 0, "creation_date": 1506720480, "post_id": 46494886, "comment_id": 79949076, "body": "@DanielWagner: Thanks for posting that article!  I really appreciate the quote about <code>unsafePerformIO</code>: &quot;Whenever you use it, you are promising the compiler that the timing of this I/O operation, relative to all the other I/O operations of the program, does not matter. You must undertake this proof obligation, because the compiler cannot do it for you; that is what the &#39;unsafe&#39; prefix means,&quot;  which points out that <code>trace</code> is bad specifically in those scenarios for which the timing/order of logs would matter."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 579, "user_id": 8426314, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101771879690894/picture?type=large", "display_name": "Nathan Wilson", "link": "https://stackoverflow.com/users/8426314/nathan-wilson"}, "edited": false, "score": 1, "creation_date": 1506872558, "post_id": 46494886, "comment_id": 79982184, "body": "@NathanWilson, you can write an mtl-style <code>MonadLogger</code> class that only offers a <code>Monad</code> superclass and a <code>logMessage</code> method. Actions with that constraint are &quot;pure except for logging&quot;. You can even offer an instance for <code>Identity</code> that throws the log messages away."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 10, "last_activity_date": 1506709522, "creation_date": 1506709522, "answer_id": 46494886, "question_id": 46494499, "link": "https://stackoverflow.com/questions/46494499/why-is-debug-trace-evil/46494886#46494886", "title": "Why is Debug.Trace evil?", "body": "<p>Of course <code>trace foo bar</code> can throw more errors than <code>bar</code>: it can (will) throw any errors <code>foo</code> throws!</p>\n\n<p>But that's not really the reason to avoid it. The real reason is that you typically want the programmer to have control over the order that output happens. You don't want your debug statement saying \"Foo is happening!\" to interrupt itself and say \"Foo is hapBar is happening!pening!\", for example; and you don't want a latent debugging statement to languish unprinted just because the value it wraps never ended up being needed. The right way to control that order is to admit you are doing <code>IO</code> and reflect that in your type.</p>\n"}, {"comments": [{"owner": {"reputation": 579, "user_id": 8426314, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101771879690894/picture?type=large", "display_name": "Nathan Wilson", "link": "https://stackoverflow.com/users/8426314/nathan-wilson"}, "edited": false, "score": 0, "creation_date": 1506715162, "post_id": 46495390, "comment_id": 79946801, "body": "&quot;Similarly, production code should never rely on the presence of trace messages.&quot;  Agreed.  I understand that the compiler could cause a trace message to show up an indeterminate amount of times (including 0!), but is that really enough reason to not use it in production?  I would consider log messages useful even if their occurrence was indeterminate (and in fact that might even give you insight into whether a value was used or not).  When I&#39;m debugging, the more information I have, the easier I can reach a good conclusion."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 579, "user_id": 8426314, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101771879690894/picture?type=large", "display_name": "Nathan Wilson", "link": "https://stackoverflow.com/users/8426314/nathan-wilson"}, "edited": false, "score": 1, "creation_date": 1506716997, "post_id": 46495390, "comment_id": 79947774, "body": "@NathanWilson From my point of view, you can leave <code>trace</code> in production and log that, if you wish. However, when you read the log, you have to cope with the fact that it is unreliable. That might mislead the programmer in believing something wrong. As long as the programmer is very weary, it should be OK-ish. If possible, I&#39;d rather keep a reliable log, which I can completely trust during debugging."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1506711699, "creation_date": 1506711699, "answer_id": 46495390, "question_id": 46494499, "link": "https://stackoverflow.com/questions/46494499/why-is-debug-trace-evil/46495390#46495390", "title": "Why is Debug.Trace evil?", "body": "<p><code>Debug.Trace.trace</code> breaks referential transparency.</p>\n\n<p>An expression such as <code>let x = e in x+x</code>, by referential tranparency, must be equivalent to <code>e+e</code>, no matter what <code>e</code> is.</p>\n\n<p>However,</p>\n\n<pre><code>let x = trace \"x computed!\" 12\nin x+x\n</code></pre>\n\n<p>will (likely) print the debug message <em>once</em>, while</p>\n\n<pre><code>trace \"x computed!\" 12 + trace \"x computed!\" 12\n</code></pre>\n\n<p>will (likely) print the debug message <em>twice</em>. This should not happen.</p>\n\n<p>The only pragmatic way out of this is to regard the output as a \"side effect we should not depend on\". We already do this in pure code: we disregard observable \"side effects\" such as elapsed time, used space, consumed energy. Pragmatically, we should not rely on an expression to consume exactly <code>1324</code> bytes during evaluation, and write code which breaks after the new compiler is able to optimize that more and save <code>2</code> more bytes. Similarly, production code should never rely on the presence of <code>trace</code> messages.</p>\n\n<p>(Above, I write \"likely\" since this is what I think GHC does at the moment, but in principle another compiler could optimize<code>let x=e in ...</code> by inlining <code>e</code> which would cause multiple <code>trace</code> messages.)</p>\n"}, {"comments": [{"owner": {"reputation": 579, "user_id": 8426314, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101771879690894/picture?type=large", "display_name": "Nathan Wilson", "link": "https://stackoverflow.com/users/8426314/nathan-wilson"}, "edited": false, "score": 0, "creation_date": 1506721195, "post_id": 46496132, "comment_id": 79949325, "body": "Thank you.  This answer probably isn&#39;t the best answer to the <i>stated</i> question (which was about <code>trace</code> when I really should have been asking about <code>unsafePerformIO</code>), but it gave me the information I was seeking."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 6, "last_activity_date": 1506715218, "creation_date": 1506715218, "answer_id": 46496132, "question_id": 46494499, "link": "https://stackoverflow.com/questions/46494499/why-is-debug-trace-evil/46496132#46496132", "title": "Why is Debug.Trace evil?", "body": "<blockquote>\n  <p>I often find it valuable to have a production application log values of interest to help diagnose issues that I am unable to reproduce locally.</p>\n</blockquote>\n\n<p>This can be okayish. For example, GHC can be run with options that turn on various tracing features. The resulting logs may be useful for investigating bugs. That said, the wild nature of the output from \"pure\" code can make it a bit hard to put the various events in a sensible order. For example, <code>-ddump-inlinings</code> and <code>-ddump-rule-rewrites</code> output may be interleaved with other output. So developers have the convenience of working with more \"pure\" code, but at the expense of logs that are trickier to pick through. It's a trade-off.</p>\n"}], "owner": {"reputation": 579, "user_id": 8426314, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101771879690894/picture?type=large", "display_name": "Nathan Wilson", "link": "https://stackoverflow.com/users/8426314/nathan-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "accepted_answer_id": 46496132, "answer_count": 3, "score": 5, "last_activity_date": 1506715218, "creation_date": 1506707849, "question_id": 46494499, "link": "https://stackoverflow.com/questions/46494499/why-is-debug-trace-evil", "title": "Why is Debug.Trace evil?", "body": "<p>I've seen many resources strongly encouraging programmers to not use <code>Debug.Trace</code> from production code because of the lack of referential transparency.  I still don't fully understand the problem though, and can't seem to locate the underlying reason.</p>\n\n<p>My understanding is that tracing <em>cannot</em> alter the output of any expression (though it can in some cases cause expressions to be executed in a different order, or cause an expression to be evaluated that would have otherwise been lazily skipped).  So tracing <em>cannot</em> affect the output of a pure function.  It can't throw any sort of errors.  So why is it fought against so strongly?  (If any of my assumptions above are incorrect, please point it out!).  Is it just a philosophical debate, or a performance thing, or could it actually introduce a bug in some way?</p>\n\n<p>When programming in other, less strict languages, I often find it valuable to have a production application log values of interest to help diagnose issues that I am unable to reproduce locally.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 1, "creation_date": 1506708646, "post_id": 46494494, "comment_id": 79943828, "body": "Have you tried nesting those list comprehensions? The outer one should look like the one in <code>noTwos</code>. Instead of collecting the <code>x</code>s, do a second list comprehension to filter out the <code>2</code>s."}, {"owner": {"reputation": 71, "user_id": 8658248, "user_type": "registered", "profile_image": "https://graph.facebook.com/1512880645455403/picture?type=large", "display_name": "Erik H Nguyen", "link": "https://stackoverflow.com/users/8658248/erik-h-nguyen"}, "reply_to_user": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 0, "creation_date": 1506709986, "post_id": 46494494, "comment_id": 79944404, "body": "hm .. i fail to see where I should put the second list comprehension into"}, {"owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 1, "creation_date": 1506710083, "post_id": 46494494, "comment_id": 79944451, "body": "Something like <code>[ [x | x&lt;-xs, x&#47;=2] | xs&lt;-xss]</code>"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1506715194, "post_id": 46494494, "comment_id": 79946823, "body": "How does <code>noTwos xs = map length [x|x&lt;-xs]</code> really work..?"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1506715542, "post_id": 46494494, "comment_id": 79947020, "body": "Basically <code>filter (&#47;=2) &lt;$&gt; [[1,2,3],[1,2],[2,1,3,4]]</code> should suffice."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1506719245, "post_id": 46494494, "comment_id": 79948676, "body": "<code>[x | x &lt;- xs]</code> is redundant. Write <code>xs</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 825, "user_id": 962828, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/78c370f00a14fb3bd59dc334082378cd?s=128&d=identicon&r=PG", "display_name": "Ulrar", "link": "https://stackoverflow.com/users/962828/ulrar"}, "is_accepted": false, "score": 3, "last_activity_date": 1506722923, "last_edit_date": 1506722923, "creation_date": 1506710498, "answer_id": 46495144, "question_id": 46494494, "link": "https://stackoverflow.com/questions/46494494/filter-out-elements-in-list-of-lists/46495144#46495144", "title": "Filter out elements in list of lists", "body": "<p>This seems to work fine :</p>\n\n<pre><code>map (filter (/= 2)) [[1,2,3],[1,2],[2,1,3,4]]\n</code></pre>\n\n<p>You map over the outer list, and filter each sublist.</p>\n"}, {"tags": [], "owner": {"reputation": 1998, "user_id": 772992, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/f4Gy4.jpg?s=128&g=1", "display_name": "hradecek", "link": "https://stackoverflow.com/users/772992/hradecek"}, "is_accepted": false, "score": 0, "last_activity_date": 1506958508, "last_edit_date": 1506958508, "creation_date": 1506958181, "answer_id": 46528690, "question_id": 46494494, "link": "https://stackoverflow.com/questions/46494494/filter-out-elements-in-list-of-lists/46528690#46528690", "title": "Filter out elements in list of lists", "body": "<p>Alternatively to Ulrar's <code>map . filter</code> version, which is indeed more readable.\nUsing <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-List.html#v:-92--92-\" rel=\"nofollow noreferrer\">List's difference (\\\\)</a> should works too (<em>importing</em> <code>Data.List</code> <em>is needed</em>):</p>\n\n<pre><code>no2s = map (\\\\ [2])\n</code></pre>\n\n<p><em>Note</em>, that this leaves empty lists in case of <code>[...,[2],...]</code></p>\n\n<p>In case you want to get rid of empty lists, just filter them out:</p>\n\n<pre><code>no2s = filter (not . null) . map (\\\\ [2])\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 8658248, "user_type": "registered", "profile_image": "https://graph.facebook.com/1512880645455403/picture?type=large", "display_name": "Erik H Nguyen", "link": "https://stackoverflow.com/users/8658248/erik-h-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 944, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1506958508, "creation_date": 1506707820, "last_edit_date": 1506714489, "question_id": 46494494, "link": "https://stackoverflow.com/questions/46494494/filter-out-elements-in-list-of-lists", "title": "Filter out elements in list of lists", "body": "<p>I want to filter out the number 2 in this list of lists:</p>\n\n<pre><code>myList = [[1,2,3],[1,2],[2,1,3,4]]\n</code></pre>\n\n<p>...so that when I use this length function:</p>\n\n<pre><code>noTwos xs = map length [x|x&lt;-xs]\n</code></pre>\n\n<p>I will get the result <code>[2,1,3]</code>.</p>\n\n<p>I tried with <code>[x|x&lt;-xs, x/=[2] ]</code> but that only filter out the list from <code>[2]</code> as elements,  how do I filter out the 2's in all the sublists?</p>\n"}, {"tags": ["haskell", "conduit", "jsonstream"], "comments": [{"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1506774828, "post_id": 46492603, "comment_id": 79959667, "body": "Your question isn&#39;t very clear."}, {"owner": {"reputation": 825, "user_id": 962828, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/78c370f00a14fb3bd59dc334082378cd?s=128&d=identicon&r=PG", "display_name": "Ulrar", "link": "https://stackoverflow.com/users/962828/ulrar"}, "reply_to_user": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1506777437, "post_id": 46492603, "comment_id": 79960371, "body": "As I said, I&#39;m looking for a way to use parseByteString from json-stream as a Sink for httpSink."}], "answers": [{"comments": [{"owner": {"reputation": 825, "user_id": 962828, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/78c370f00a14fb3bd59dc334082378cd?s=128&d=identicon&r=PG", "display_name": "Ulrar", "link": "https://stackoverflow.com/users/962828/ulrar"}, "edited": false, "score": 0, "creation_date": 1506851112, "post_id": 46510716, "comment_id": 79976239, "body": "I just don&#39;t get it. For example, if a Sink has no downstream, what does httpSink return ? And well, how do I use it. Lost hours trying a lot of ways to put parseByteString in there without success, I just don&#39;t understand how to use httpSink for anything else than printing the body, which is the only example I found."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 1, "creation_date": 1506870343, "post_id": 46510716, "comment_id": 79981532, "body": "The issue is that json-stream has no built in support for Conduit. You would need to get such support added by dealing with the <code>ParseOutput</code> type directly. But connecting these things up isn&#39;t a good first activity with Conduit."}], "tags": [], "owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "is_accepted": false, "score": 0, "last_activity_date": 1506847673, "creation_date": 1506847673, "answer_id": 46510716, "question_id": 46492603, "link": "https://stackoverflow.com/questions/46492603/httpsink-and-parsing-json/46510716#46510716", "title": "httpSink and parsing json", "body": "<p>You wrote:</p>\n\n<blockquote>\n  <p>I read the tutorial about conduits, but I'm clearly not understanding it properly since I can't make that work.</p>\n</blockquote>\n\n<p>&nbsp;</p>\n\n<blockquote>\n  <p>I can't figure out a way to use parseByteString as a Sink for httpSink's second parameter. </p>\n</blockquote>\n\n<p>The problem here is that <code>Sink</code> is just a short hand for a conduit:</p>\n\n<pre><code>type Sink i m r = ConduitM i Void m r\n</code></pre>\n\n<p>A <code>Sink</code> is a kind of conduit that has no downstream component.</p>\n\n<p>Conduits are the solution you need, and I assume that <a href=\"https://github.com/snoyberg/conduit#readme\" rel=\"nofollow noreferrer\">this</a> is the tutorial you read.  If you are not comfortable with some of the concepts in it try asking a specific question about it.</p>\n"}, {"comments": [{"owner": {"reputation": 825, "user_id": 962828, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/78c370f00a14fb3bd59dc334082378cd?s=128&d=identicon&r=PG", "display_name": "Ulrar", "link": "https://stackoverflow.com/users/962828/ulrar"}, "edited": false, "score": 0, "creation_date": 1506888546, "post_id": 46514187, "comment_id": 79987026, "body": "Well I basically don&#39;t understand how that works, but it does ! Thanks a lot for this. Guess I have a lot of reading ahead of me to try and figure out what this does exactly :)"}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 2, "last_activity_date": 1506873688, "creation_date": 1506873688, "answer_id": 46514187, "question_id": 46492603, "link": "https://stackoverflow.com/questions/46492603/httpsink-and-parsing-json/46514187#46514187", "title": "httpSink and parsing json", "body": "<p>I haven't tested this, since I'm honestly not that familiar with the library, but I think this adapter function will make it work with conduit:</p>\n\n<pre><code>module Data.JsonStream.Parser.Conduit\n  ( jsonConduit\n  , JsonStreamException (..)\n  ) where\n\nimport Data.Conduit\nimport Data.JsonStream.Parser\nimport Data.ByteString (ByteString)\nimport Control.Monad.Catch\nimport Data.Typeable\n\njsonConduit\n  :: MonadThrow m\n  =&gt; Parser a\n  -&gt; ConduitM ByteString a m ()\njsonConduit =\n    go . runParser\n  where\n    go (ParseYield x p) = yield x &gt;&gt; go p\n    go (ParseNeedData f) = await &gt;&gt;= maybe\n      (throwM JsonStreamNotEnoughData)\n      (go . f)\n    go (ParseFailed str) = throwM $ JsonStreamException str\n    go (ParseDone bs) = leftover bs\n\ndata JsonStreamException\n  = JsonStreamException !String\n  | JsonStreamNotEnoughData\n  deriving (Show, Typeable)\ninstance Exception JsonStreamException\n</code></pre>\n"}], "owner": {"reputation": 825, "user_id": 962828, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/78c370f00a14fb3bd59dc334082378cd?s=128&d=identicon&r=PG", "display_name": "Ulrar", "link": "https://stackoverflow.com/users/962828/ulrar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 46514187, "answer_count": 2, "score": 1, "last_activity_date": 1506873688, "creation_date": 1506700280, "question_id": 46492603, "link": "https://stackoverflow.com/questions/46492603/httpsink-and-parsing-json", "title": "httpSink and parsing json", "body": "<p>I think this is a bit advanced for me, but my goal would be to get the raw json from an http API, parse a first list from it, do whatever I need to do with that then move on to the next list, and so on. My hope being that this should allow for only one list at a time to be loaded in memory (each list is pretty small, but there are a LOT of lists in the json).\nI tried it with Aeson, and it ate up all the ram and processed endlessly for hours, I ended up having to kill it.</p>\n\n<p>If I understand it correctly, httpSink should be the way to go, with maybe json-stream to do the actual parsing. I read the tutorial about conduits, but I'm clearly not understanding it properly since I can't make that work.</p>\n\n<p>I know how to use parseByteString to decode a ByteString the way I need (at least my tests seem to work), but I can't figure out a way to use parseByteString as a Sink for httpSink's second parameter.\nAm I missing something obvious, or am I mistaken about the way conduit works ?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "types", "type-signature"], "answers": [{"comments": [{"owner": {"reputation": 826, "user_id": 5698202, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HfozP.jpg?s=128&g=1", "display_name": "Abhirath Mahipal", "link": "https://stackoverflow.com/users/5698202/abhirath-mahipal"}, "edited": false, "score": 0, "creation_date": 1506695030, "post_id": 46490708, "comment_id": 79936200, "body": "Makes sense. Thanks"}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 1, "last_activity_date": 1506694454, "creation_date": 1506694454, "answer_id": 46490708, "question_id": 46490606, "link": "https://stackoverflow.com/questions/46490606/type-of-any-in-haskell/46490708#46490708", "title": "Type of any in Haskell?", "body": "<p><code>t a</code> does not represent the predicate and the list. As you've already correctly pointed out before, <code>(a -&gt; Bool)</code> is the predicate. <code>t a</code> just represents the list, except it doesn't have to be a list (that's why it's <code>t a</code> instead of <code>[a]</code>). <code>t</code> can be any Foldable, so it could be <code>[]</code>, but it could also be some other collection type or <code>Maybe</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 826, "user_id": 5698202, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HfozP.jpg?s=128&g=1", "display_name": "Abhirath Mahipal", "link": "https://stackoverflow.com/users/5698202/abhirath-mahipal"}, "edited": false, "score": 0, "creation_date": 1506694893, "post_id": 46490734, "comment_id": 79936121, "body": "Thanks. Aren&#39;t type classes enclosed like <code>(Eq a)</code>?"}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "reply_to_user": {"reputation": 826, "user_id": 5698202, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HfozP.jpg?s=128&g=1", "display_name": "Abhirath Mahipal", "link": "https://stackoverflow.com/users/5698202/abhirath-mahipal"}, "edited": false, "score": 5, "creation_date": 1506694948, "post_id": 46490734, "comment_id": 79936161, "body": "If there is only one typeclass, one can omit the paran.. parenth.. the <code>()</code> thingies in the function signature."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1506695381, "post_id": 46490734, "comment_id": 79936434, "body": "+1 for pointing out that <code>[a]</code> is just a special form for the application of the type constructor <code>[]</code> to the type variable <code>a</code>, which makes replacing the literal value <code>[]</code> with the variable <code>t</code> more understandable."}], "tags": [], "owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "is_accepted": true, "score": 12, "last_activity_date": 1506694545, "creation_date": 1506694545, "answer_id": 46490734, "question_id": 46490606, "link": "https://stackoverflow.com/questions/46490606/type-of-any-in-haskell/46490734#46490734", "title": "Type of any in Haskell?", "body": "<pre><code>any :: Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool\n</code></pre>\n\n<p>Here <code>Foldable t</code> means, that <code>t</code> is an instance of type class <code>Foldable</code>.</p>\n\n<p><code>Foldable</code> is a type class and if type <code>t</code> is an instance of the type class <code>Foldable</code> we know from the <code>t a</code> part of the signature or from the definition of the type class <code>Foldable</code>, that <code>t</code> is actually a type constructor.</p>\n\n<p>So <code>t a</code> is a type and therefore <code>t a -&gt; Bool</code> is a function, that maps a value of type <code>t a</code> to <code>Bool</code>. This function will be closure, which will\napply the predicate to each \"element\" of the value of type <code>t a</code>, until it finds one, that yields <code>True</code> under the predicate or it doesn't find such an element returning either <code>True</code> or <code>False</code> in the respective cases. (The actual implementation might be very different.)</p>\n\n<p>For example <code>[]</code> is an instance of the type class <code>Foldable</code> and therefore <code>t a</code> could be a list of something. In this case, we can also write <code>[a]</code> instead of <code>[] a</code>.</p>\n\n<p>But there are other type constructors, which can be instances of <code>Foldable</code>, for example some kinds of trees.</p>\n"}, {"comments": [{"owner": {"reputation": 826, "user_id": 5698202, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HfozP.jpg?s=128&g=1", "display_name": "Abhirath Mahipal", "link": "https://stackoverflow.com/users/5698202/abhirath-mahipal"}, "edited": false, "score": 0, "creation_date": 1506694854, "post_id": 46490809, "comment_id": 79936099, "body": "The first signature is so readable. Thanks for pointing it out."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 10, "last_activity_date": 1506694782, "creation_date": 1506694782, "answer_id": 46490809, "question_id": 46490606, "link": "https://stackoverflow.com/questions/46490606/type-of-any-in-haskell/46490809#46490809", "title": "Type of any in Haskell?", "body": "<p>It might be helpful to note that <a href=\"http://hackage.haskell.org/package/base-4.7.0.0/docs/Prelude.html#v:any\" rel=\"noreferrer\">until recently, the signature was actually</a></p>\n\n<pre><code>any :: (a -&gt; Bool) -&gt; [a] -&gt; Bool\n</code></pre>\n\n<p>This was generalised during <a href=\"https://wiki.haskell.org/Foldable_Traversable_In_Prelude\" rel=\"noreferrer\">the Foldable Traversable in Prelude proposal</a>: now the container of values need not be a list, but can as well be e.g. an <a href=\"http://hackage.haskell.org/package/vector-0.12.0.1/docs/Data-Vector-Generic.html#t:Vector\" rel=\"noreferrer\">array</a>:</p>\n\n<pre><code>Prelude&gt; import qualified Data.Vector as Arr\nPrelude Arr&gt; :set -XOverloadedLists\nPrelude Arr&gt; let a = [1,2,3] :: Arr.Vector Int\nPrelude Arr&gt; any (&gt;2) a\nTrue\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "is_accepted": false, "score": 2, "last_activity_date": 1506694941, "creation_date": 1506694941, "answer_id": 46490862, "question_id": 46490606, "link": "https://stackoverflow.com/questions/46490606/type-of-any-in-haskell/46490862#46490862", "title": "Type of any in Haskell?", "body": "<p><code>t a</code> isn't separated by a <code>-&gt;</code> because the <code>t a</code> is the instance of foldable, ex: List a, or Tree a.  Let's go back to <code>map</code> for a second. The version you gave is specialized to lists; a more general version (which, as an accident of history, is called <code>fmap</code> in most versions of Haskell) has type <code>fmap :: Functor f =&gt; (a-&gt;b) -&gt; f a -&gt; f b</code>.  Where is your input list in this signature?  It's the <code>f a</code>.  Now, returning to <code>any</code> the <code>t a</code> is the second argument, the instance of Foldable you're folding over, the list or tree or whatever.  </p>\n\n<p>You'll read that all functions in Haskell really have only 1 argument, and we're seeing that here. <code>any</code> takes it's first argument (the predicate) and returns a  function that takes a foldable (the list, tree, etc) and returns a <code>Bool</code>.  </p>\n"}, {"comments": [{"owner": {"reputation": 826, "user_id": 5698202, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HfozP.jpg?s=128&g=1", "display_name": "Abhirath Mahipal", "link": "https://stackoverflow.com/users/5698202/abhirath-mahipal"}, "edited": false, "score": 0, "creation_date": 1506752372, "post_id": 46491125, "comment_id": 79954678, "body": "Makes sense :-)"}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 3, "last_activity_date": 1506695673, "creation_date": 1506695673, "answer_id": 46491125, "question_id": 46490606, "link": "https://stackoverflow.com/questions/46490606/type-of-any-in-haskell/46491125#46491125", "title": "Type of any in Haskell?", "body": "<p>Type signature is a mark up designation of the function indicating the  types to be processed and how the function can be partially applied.</p>\n\n<pre><code>Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool\n</code></pre>\n\n<p>By <code>Foldable t</code> it first says <code>any</code> function can work with any data type which is an instance of Foldable type class.</p>\n\n<p>The first parameter, <code>(a -&gt; Bool)</code> is obviously a function which takes a single element (<code>a</code>) from our foldable data type and returns a <code>Bool</code> type value. It's the the callback of <code>.some(callback)</code> in JavaScript. When you apply this parameter to <code>any</code> you will be returned with a function of type;</p>\n\n<p><code>t a -&gt; Bool</code></p>\n\n<p>Now we are left with a single function which takes only one parameter and returns a <code>Bool</code> type (<code>True</code> or <code>False</code>) value. Again <code>t a</code> is a data type which is a member of the Foldable type class. It can be a <code>[]</code> but a <code>Tree</code> too provided that the data type has <code>foldMap</code> function defined under an instance to Foldable. It's the <code>myArr</code> part in JavaScript's <code>myArr.some(callback)</code> except that it doesn't have to be an array.</p>\n"}], "owner": {"reputation": 826, "user_id": 5698202, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HfozP.jpg?s=128&g=1", "display_name": "Abhirath Mahipal", "link": "https://stackoverflow.com/users/5698202/abhirath-mahipal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 46490734, "answer_count": 5, "score": 3, "last_activity_date": 1506695708, "creation_date": 1506694146, "last_edit_date": 1506695708, "question_id": 46490606, "link": "https://stackoverflow.com/questions/46490606/type-of-any-in-haskell", "title": "Type of any in Haskell?", "body": "<p>I've recently started trying to learn Haskell by reading LearnYouAHaskell and random articles from the internet.</p>\n\n<p>I'm having hard time understanding more sophisticated function types.</p>\n\n<p>Some examples that I understand.</p>\n\n<pre><code>&gt; :t map  \nmap :: (a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>It takes in a function (which takes a and gives out b, i.e a and b can be of different types) and a list of a's and return a list of b's.</p>\n\n<pre><code>&gt; :t fst  \nfst :: (a, b) -&gt; a\n</code></pre>\n\n<p>Takes in a tuple of 2 elements (allows different types) and returns the first one.</p>\n\n<pre><code>&gt; :t any  \n</code></pre>\n\n<p>At a higher level, I understand <code>any</code>. It takes in a function and a list and returns true if any of the list entries return true for that particular function. I've used it in Python and JavaScript as well.</p>\n\n<p><strong>Questions</strong>  </p>\n\n<ul>\n<li><p>I don't understand how does <code>any :: Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool\n</code> translate to the above.  </p>\n\n<ul>\n<li><code>(a -&gt; Bool)</code> is the predicate. Takes in an argument and returns true or false.  </li>\n<li><code>t a -&gt; Bool</code> Bool is the end result of any. According to my understanding t and a represent the predicate and the list. Why aren't they separated by a <code>-&gt;</code></li>\n</ul></li>\n<li><p>How to go about understanding type signatures in general and how to dig deeper so that I can approach them myself?</p></li>\n</ul>\n"}, {"tags": ["haskell", "functor", "category-theory"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1506690508, "post_id": 46489376, "comment_id": 79933458, "body": "I can follow the first examples, but I can not understand the last one for <code>[a]</code>. Can you describe that dependent type you use there?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1506690718, "post_id": 46489376, "comment_id": 79933579, "body": "Further, if <code>T,U :: *-&gt;*</code> are functors isomorphic to <code>T&#39; -&gt; a</code> and <code>U&#39; -&gt; a</code>, their product <code>F a = (T a, F a)</code> is isomorphic to <code>Either T&#39; U&#39; -&gt; a</code>. Hence, you can craft from this many more examples. E.g. <code>F a = (a,a,...)</code> is <code>Either () (Either () ...) -&gt; a</code>"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 6, "creation_date": 1506691352, "post_id": 46489376, "comment_id": 79933943, "body": "Google &quot;Naperian Functor&quot;: Hancock gives them that name, because the domain of the representing function is log_x (f x). By the way, [] is <i>not</i> Naperian, because the length of the list may vary. Vec n is Naperian for each n. Naperian functors are closed under constant unit (Phantom), product, exponentiation (a -&gt;) aka Reader, identity, composition, and greatest fixpoint (Streams are Naperian as they are bound to be infinite). They also have the property that f () (aka the &quot;shape type&quot;) is iso to (). There&#39;s a connection to the Zipper: if f () is iso to (), then log_x (f x) = D f ()."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1506691656, "post_id": 46489376, "comment_id": 79934125, "body": "I feel out of my depth here, so I&#39;m not sure the following helps, but <a href=\"https://hackage.haskell.org/package/adjunctions\" rel=\"nofollow noreferrer\">adjunctions</a> define a <code>Representable</code> type class and some instances."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1506711290, "post_id": 46489376, "comment_id": 79944995, "body": "@chi, oh, there is a typo there. Should be <code>Fin n</code>\u2026 and even then it\u2019s wrong. <code>\u03a3 n, (Fin n -&gt; a)</code> would work, but not  <code>(\u03a3 n, Fin n) -&gt; a)</code> as I wrote initially."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 1, "creation_date": 1506711566, "post_id": 46489376, "comment_id": 79945122, "body": "@pigworker care to turn that into an answer? (Ideally with an explanation of the difference between \u201cnaperian\u201c and \u201crepresentable\u201d.)"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 1, "creation_date": 1506720505, "post_id": 46489376, "comment_id": 79949082, "body": "I might get there. There is no difference between &quot;Naperian&quot; and &quot;Representable&quot;. It&#39;s just a matter of a thing studied under more than one name."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1506720645, "post_id": 46489376, "comment_id": 79949128, "body": "Similarly (and not unrelatedly), what I called <code>Traversable</code> functors are what Girard has been calling &quot;Normal&quot; functors for years. It just took us a while to see that."}, {"owner": {"reputation": 9111, "user_id": 90088, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c018f213204496b4bbf481e7c8e6c15c?s=128&d=identicon&r=PG", "display_name": "Bartosz Milewski", "link": "https://stackoverflow.com/users/90088/bartosz-milewski"}, "edited": false, "score": 0, "creation_date": 1506744967, "post_id": 46489376, "comment_id": 79953677, "body": "There is a Haskell library defining a bunch of <a href=\"https://hackage.haskell.org/package/representable-functors\" rel=\"nofollow noreferrer\">representable functors</a>, courtesy Edward Kmett."}], "answers": [{"comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1519351594, "post_id": 46502280, "comment_id": 84887217, "body": "What is that quote(?) at the start from? If I search google for it, this post is the only result."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1519567615, "post_id": 46502280, "comment_id": 84953529, "body": "I have no idea where it&#39;s from. It&#39;s a very old joke I remember from my childhood."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1519568780, "post_id": 46502280, "comment_id": 84953918, "body": "Well, it&#39;s fantastic.  I&#39;m gonna borrow it for situations where math jokes are appropriate.  Thank you for sharing!"}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": true, "score": 23, "last_activity_date": 1506771041, "creation_date": 1506771041, "answer_id": 46502280, "question_id": 46489376, "link": "https://stackoverflow.com/questions/46489376/which-haskell-functors-are-equivalent-to-the-reader-functor/46502280#46502280", "title": "Which Haskell Functors are equivalent to the Reader functor", "body": "<blockquote>\n  <p>And Noah said unto the animals \"Go forth and multiply!\", but the snakes said\n  \"We cannot multiply, for we are adders.\", so Noah took wood from the Ark and,\n  shaping it, said \"I am building you a table of logs.\".</p>\n</blockquote>\n\n<p>Representable functors are sometimes also called \"Naperian\" functors (it's Peter Hancock's term: Hank's a denizen of the same part of Edinburgh as John Napier, of logarithmic fame) because when <code>F x ~= T -&gt; x</code>, and remembering that, combinatorially, <code>T -&gt; x</code> is \"<code>x</code> to the power <code>T</code>\", we see that <code>T</code> is in some sense <code>Log F</code>.</p>\n\n<p>The first thing to note is that <code>F () ~= T -&gt; () ~= ()</code>. That tells us <em>there is only one shape</em>. Functors which offer us a choice of shape cannot be Naperian, because they don't give a uniform presentation of the positions for data. That means <code>[]</code> is not Naperian, because different-length lists have positions represented by different types. However, an infinite <code>Stream</code> has positions given by the natural numbers.</p>\n\n<p>Correspondingly, given any two <code>F</code> structures, their shapes are bound to match, so they have a sensible <code>zip</code>, giving us the basis for an <code>Applicative F</code> instance.</p>\n\n<p>Indeed, we have</p>\n\n<pre><code>          a  -&gt; p x\n=====================\n  (Log p, a) -&gt;   x\n</code></pre>\n\n<p>making <code>p</code> a right adjoint, so <code>p</code> preserves all limits, hence unit and products in particular, making it a monoidal functor, not just a <em>lax</em> monoidal functor. That is, the alternative presentation of <code>Applicative</code> has operations which are isomorphisms.</p>\n\n<pre><code>unit  :: ()         ~= p ()\nmult  :: (p x, p y) ~= p (x, y)\n</code></pre>\n\n<p>Let's have a type class for the things. I cook it a bit differently from the <code>Representable</code> class.</p>\n\n<pre><code>class Applicative p =&gt; Naperian p where\n  type Log p\n  logTable  :: p (Log p)\n  project   :: p x -&gt; Log p -&gt; x\n  tabulate  :: (Log p -&gt; x) -&gt; p x\n  tabulate f = fmap f logTable\n  -- LAW1: project logTable = id\n  -- LAW2: project px &lt;$&gt; logTable = px\n</code></pre>\n\n<p>We have a type <code>Log f</code>, representing at least some of the positions inside an <code>f</code>; we have a <code>logTable</code>, storing in each position the representative of that position, acting like a 'map of an <code>f</code>' with placenames in each place; we have a <code>project</code> function extracting the data stored at a given position.</p>\n\n<p>The first law tells us that the <code>logTable</code> is accurate for all the positions which are represented. The second law tells us that we have represented <em>all</em> the positions. We may deduce that</p>\n\n<pre><code>tabulate (project px)\n  = {definition}\nfmap (project px) logTable\n  = {LAW2}\npx\n</code></pre>\n\n<p>and that</p>\n\n<pre><code>project (tabulate f)\n  = {definition}\nproject (fmap f logTable)\n  = {free theorem for project}\nf . project logTable\n  = {LAW1}\nf . id\n  = {composition absorbs identity}\nf\n</code></pre>\n\n<p>We could imagine a generic instance for <code>Applicative</code></p>\n\n<pre><code>instance Naperian p =&gt; Applicative p where\n  pure x    = fmap (pure x)                    logTable\n  pf &lt;$&gt; px = fmap (project pf &lt;*&gt; project ps) logTable\n</code></pre>\n\n<p>which is as much as to say that <code>p</code> inherits its own K and S combinators from the usual K and S for functions.</p>\n\n<p>Of course, we have</p>\n\n<pre><code>instance Naperian ((-&gt;) r) where\n  type Log ((-&gt;) r) = r  -- log_x (x^r) = r\n  logTable = id\n  project = ($)\n</code></pre>\n\n<p>Now, all the limit-like constructions preserve Naperianity. <code>Log</code> maps limity things to colimity things: it <em>calculates</em> left adjoints.</p>\n\n<p>We have the terminal object and products.</p>\n\n<pre><code>data K1       x = K1\ninstance Applicative K1 where\n  pure x    = K1\n  K1 &lt;*&gt; K1 = K1\ninstance Functor K1 where fmap = (&lt;*&gt;) . pure\n\ninstance Naperian K1 where\n  type Log K1 = Void -- \"log of 1 is 0\"\n  logTable = K1\n  project K1 nonsense = absurd nonsense\n\ndata (p * q)  x = p x :*: q x\ninstance (Applicative p, Applicative q) =&gt; Applicative (p * q) where\n  pure x = pure x :*: pure x\n  (pf :*: qf) &lt;*&gt; (ps :*: qs) = (pf &lt;*&gt; ps) :*: (qf &lt;*&gt; qs)\ninstance (Functor p, Functor q) =&gt; Functor (p * q) where\n  fmap f (px :*: qx) = fmap f px :*: fmap f qx\n\ninstance (Naperian p, Naperian q) =&gt; Naperian (p * q) where\n  type Log (p * q) = Either (Log p) (Log q)  -- log (p * q) = log p + log q\n  logTable = fmap Left logTable :*: fmap Right logTable\n  project (px :*: qx) (Left i)  = project px i\n  project (px :*: qx) (Right i) = project qx i\n</code></pre>\n\n<p>We have identity and composition.</p>\n\n<pre><code>data I        x = I x\ninstance Applicative I where\n  pure x = I x\n  I f &lt;*&gt; I s = I (f s)\ninstance Functor I where fmap = (&lt;*&gt;) . pure\n\ninstance Naperian I where\n  type Log I = ()    -- log_x x = 1\n  logTable = I ()\n  project (I x) () = x\n\ndata (p &lt;&lt; q) x = C (p (q x))\ninstance (Applicative p, Applicative q) =&gt; Applicative (p &lt;&lt; q) where\n  pure x = C (pure (pure x))\n  C pqf &lt;*&gt; C pqs = C (pure (&lt;*&gt;) &lt;*&gt; pqf &lt;*&gt; pqs)\ninstance (Functor p, Functor q) =&gt; Functor (p &lt;&lt; q) where\n  fmap f (C pqx) = C (fmap (fmap f) pqx)\n\ninstance (Naperian p, Naperian q) =&gt; Naperian (p &lt;&lt; q) where\n  type Log (p &lt;&lt; q) = (Log p, Log q)  -- log (q ^ log p) = log p * log q\n  logTable = C (fmap (\\ i -&gt; fmap (i ,) logTable) logTable)\n  project (C pqx) (i, j) = project (project pqx i) j\n</code></pre>\n\n<p>Naperian functors are closed under <em>greatest</em> fixpoints, with their logarithms being the corresponding <em>least</em> fixpoints. E.g., for streams, we have</p>\n\n<pre><code>log_x (Stream x)\n  =\nlog_x (nu y. x * y)\n  =\nmu log_xy. log_x (x * y)\n  =\nmu log_xy. log_x x + log_x y\n  =\nmu log_xy. 1 + log_xy\n  =\nNat\n</code></pre>\n\n<p>It's a bit fiddly to render that in Haskell without introducing Naperian <em>bifunctors</em> (which have two sets of positions for two sorts of things), or (better) Naperian functors on indexed types (which have indexed positions for indexed things). What's easy, though, and hopefully gives the idea, is the cofree comonad.</p>\n\n<pre><code>data{-codata-} CoFree p x = x :- p (CoFree p x)\n  -- i.e., (I * (p &lt;&lt; CoFree p)) x\ninstance Applicative p =&gt; Applicative (CoFree p) where\n  pure x = x :- pure (pure x)\n  (f :- pcf) &lt;*&gt; (s :- pcs) = f s :- (pure (&lt;*&gt;) &lt;*&gt; pcf &lt;*&gt; pcs)\ninstance Functor p =&gt; Functor (CoFree p) where\n  fmap f (x :- pcx) = f x :- fmap (fmap f) pcx\n\ninstance Naperian p =&gt; Naperian (CoFree p) where\n  type Log (CoFree p) = [Log p]  -- meaning finite lists only\n  logTable = [] :- fmap (\\ i -&gt; fmap (i :) logTable) logTable\n  project (x :- pcx) []       = x\n  project (x :- pcx) (i : is) = project (project pcx i) is\n</code></pre>\n\n<p>We may take <code>Stream = CoFree I</code>, giving</p>\n\n<pre><code>Log Stream = [Log I] = [()] ~= Nat\n</code></pre>\n\n<p>Now, the derivative <code>D p</code> of a functor gives its type of one-hole context, telling us i) the shape of a <code>p</code>, ii) the position of the hole, iii) the data that are not in the hole. If <code>p</code> is Naperian, there is no choice of shape, so putting trivial data in the non-hole positions, we find that we just get the position of the hole.</p>\n\n<pre><code>D p () ~= Log p\n</code></pre>\n\n<p>More on that connection can be found in <a href=\"https://stackoverflow.com/a/45254970/828361\">this answer of mine</a> about tries.</p>\n\n<p>Anyhow, Naperian is indeed a funny local Scottish name for Representable, which are the things for which you can build a table of logs: they are the constructions characterized entirely by projection, offering no choice of 'shape'.</p>\n"}], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 922, "favorite_count": 9, "accepted_answer_id": 46502280, "answer_count": 1, "score": 14, "last_activity_date": 1506771041, "creation_date": 1506690061, "last_edit_date": 1506711355, "question_id": 46489376, "link": "https://stackoverflow.com/questions/46489376/which-haskell-functors-are-equivalent-to-the-reader-functor", "title": "Which Haskell Functors are equivalent to the Reader functor", "body": "<p>Some Haskell functors <code>F a</code> are obviously isomorphic to <code>T -&gt; a</code> for some type <code>T</code>, e.g.</p>\n\n<pre><code>data Pair a = Pair a a            -- isomorphic to Bool -&gt; a\ndata Reader r a = Reader (r -&gt; a) -- isomorphic to r -&gt; a (duh!)\ndata Identity a = Identity a      -- isomorphic to () -&gt; a\ndata Phantom a = Phantom          -- isomorphic to void -&gt; a\n</code></pre>\n\n<p>(These isomorphism are only up to strictness, and considering only finite data structures.)</p>\n\n<p>So in general, how can we characterize functors where this is possible?</p>\n\n<p>And is the question \u201cWhich Haskell Functors are representable?\u201d the same question?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1506691643, "post_id": 46486405, "comment_id": 79934112, "body": "The last sentence, that you&#39;ve mentioned <code>share referentially transparent values between several function calls</code> could you please show an example?"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1506691796, "post_id": 46486405, "comment_id": 79934206, "body": "@zero_coding You have two examples of that in the OP code: <code>b</code> is shared between two calls to <code>putStrLn</code>, as is <code>w</code>."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1506691889, "post_id": 46486405, "comment_id": 79934265, "body": "These two are <code>referentially transparent values</code>."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1506691996, "post_id": 46486405, "comment_id": 79934328, "body": "@zero_coding Yes(?)"}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 3, "last_activity_date": 1506679087, "creation_date": 1506679087, "answer_id": 46486405, "question_id": 46485559, "link": "https://stackoverflow.com/questions/46485559/disable-of-sharing-values/46486405#46486405", "title": "Disable of sharing values", "body": "<p>That quote does seem hard to parse, but here's what I <em>think</em> it means:</p>\n\n<p>When you use <code>&lt;-</code> to refer to the value inside of <code>IO</code>, <code>b</code> and <code>w</code> become <code>String</code> values. <code>String</code> values are pure (referentially transparent), so can be shared.</p>\n\n<p>The ability to share values is a benefit of pure functions and value. While you can't call an impure function from a pure function, you can call a pure function from an impure context, but we don't want the impure context to change the properties of the part of our code that's referentially transparent.</p>\n\n<p>Haskell is lazily evaluated, so you <em>could</em> think that when you call <code>putStrLn b</code> twice, it'd lazily evaluate <code>blah'</code> twice, but it doesn't, because <code>b</code> is bound to the evaluated result of calling <code>putStrLn b</code>, not to <code>putStrLn b</code> itself.</p>\n\n<p>In other words, you can share referentially transparent values between several function calls, and <code>IO</code> doesn't disable that property.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 46486405, "answer_count": 1, "score": 1, "last_activity_date": 1506679182, "creation_date": 1506676306, "last_edit_date": 1506679182, "question_id": 46485559, "link": "https://stackoverflow.com/questions/46485559/disable-of-sharing-values", "title": "Disable of sharing values", "body": "<p>I am reading Haskell book and trying to understand what <code>IO</code> does.</p>\n\n<p>Consider the following example: </p>\n\n<pre><code>import Debug.Trace\nblah :: IO String\nblah = return \"blah\"\nblah' = trace \"outer trace\" blah\n\nwoot :: IO String\nwoot = return (trace \"inner trace\" \"woot\")\n\nmain :: IO ()\nmain = do\n  b &lt;- blah'\n  putStrLn b\n  putStrLn b\n  w &lt;- woot\n  putStrLn w\n  putStrLn w  \n</code></pre>\n\n<p>The output in <em>GHCi:</em></p>\n\n<pre><code>Prelude&gt; main\nouter trace\nblah\nblah\ninner trace\nwoot\nwoot\n</code></pre>\n\n<p>Then the author says:  </p>\n\n<blockquote>\n  <p>We only saw inner and outer emitted once because IO is not\n  intended to disable sharing for values not in IO that happen to be\n  used in the course of running of an IO action.</p>\n</blockquote>\n\n<p>What is the author trying to say?</p>\n"}, {"tags": ["haskell", "ghc", "ffi", "template-haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1506669563, "post_id": 46483241, "comment_id": 79921694, "body": "this sounds a lot like the work mathieu boespflug and his colleagues at tweag.io did with inline-r (and sister projects) have you had a look at their work how they solved these problems?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1506670019, "post_id": 46483241, "comment_id": 79921930, "body": "@epsilonhalbe Yes. Their work especially with <code>inline-java</code> has been really cool. That said, my (very vague and likely incorrect) understanding is that <code>inline-r</code> just calls out to the R interpreter and <code>inline-java</code> calls out to the JVM (albeit with some super cool tricks with byte code). The point remains that neither of these really statically links anything. That&#39;s not a performance price I should have to pay here. In any case, it is a different problem."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1506671029, "post_id": 46483241, "comment_id": 79922453, "body": "I have to admit my understanding of th/ffi is quite limited - so I can&#39;t help with your problem but - <a href=\"https://github.com/fpco?utf8=%E2%9C%93&amp;q=inline\" rel=\"nofollow noreferrer\">github.com/fpco?utf8=%E2%9C%93&amp;q=inline</a> - has something about c/cpp, which <b>is</b> not interpreted (or at least i think so) - maybe it helps"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1506671112, "post_id": 46483241, "comment_id": 79922493, "body": "@epsilonhalbe I mention <code>inline-c</code> in my question. :) C, CPP, and ObjectiveC have a blessed special status in TH via <a href=\"https://hackage.haskell.org/package/template-haskell-2.12.0.0/docs/Language-Haskell-TH-Syntax.html#v:addForeignFile\" rel=\"nofollow noreferrer\"><code>addForeignFile</code></a>. Rust (obviously) doesn&#39;t have that. I wonder if patching GHC to support adding compiled object files as well would be worth it."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1506671217, "post_id": 46483241, "comment_id": 79922566, "body": "shame on me - shame on my cow ;-)"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1506671300, "post_id": 46483241, "comment_id": 79922610, "body": "@epsilonhalbe Not at all. I couldn&#39;t believe it when I realized this. It seems pretty inelegant. Also <a href=\"https://hackage.haskell.org/package/template-haskell-2.12.0.0/docs/Language-Haskell-TH-Syntax.html#t:ForeignSrcLang\" rel=\"nofollow noreferrer\">here</a> are the supported languages."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1506671355, "post_id": 46483241, "comment_id": 79922639, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/155570/discussion-between-epsilonhalbe-and-alec\">continue this discussion in chat</a>."}], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 0, "answer_count": 0, "score": 11, "last_activity_date": 1507014546, "creation_date": 1506667737, "last_edit_date": 1506704660, "question_id": 46483241, "link": "https://stackoverflow.com/questions/46483241/using-template-haskell-to-add-libraries-with-which-to-link", "title": "Using Template Haskell to add libraries with which to link", "body": "<p>I'm currently hacking my way through trying to make quasiquotes for writing Rust code inline in Haskell. I think I have the code generation work done (including things like marshaling Haskell types to and from generated Rust ones). I now have the problem of figuring out how to do all the compilation and linking from within Template Haskell. The pipeline is as follows:</p>\n\n<ol>\n<li>The quasiquote gets parsed</li>\n<li>Source code is generated for\n\n<ul>\n<li>a corresponding Rust function</li>\n<li>Haskell FFI imports</li>\n<li>the Haskell call to the imported function</li>\n</ul></li>\n<li>The Rust code gets compiled into a static library (like <code>rustc --crate-type=staticlib  qq_function.rs -o qq_function.a</code>)</li>\n<li>The Haskell code gets compiled and linked against <code>qq_function.a</code> (and a handful of other libraries like <code>m</code>, <code>c</code>, etc.)</li>\n</ol>\n\n<p><strong>My issue is getting steps 3 and 4 to happen entirely within <code>TemplateHaskell</code></strong>. Here is as far as I've gotten:</p>\n\n<ul>\n<li><a href=\"https://hackage.haskell.org/package/template-haskell-2.12.0.0/docs/Language-Haskell-TH-Syntax.html#v:runIO\" rel=\"noreferrer\"><code>runIO</code></a> can write out the Rust source files that I've generated</li>\n<li><a href=\"https://hackage.haskell.org/package/template-haskell-2.12.0.0/docs/Language-Haskell-TH-Syntax.html#v:addDependentFile\" rel=\"noreferrer\"><code>addDependentFile</code></a> informs GHC that the generated Rust file is a dependency</li>\n<li><a href=\"https://hackage.haskell.org/package/template-haskell-2.12.0.0/docs/Language-Haskell-TH-Syntax.html#v:addForeignFile\" rel=\"noreferrer\"><code>addForeignFile</code></a> regrettably does <em>not</em> work for automatically managing the compilation since Rust is not a supported language (this is the approach <code>inline-c</code> takes since C <em>is</em> a supported language)</li>\n<li><a href=\"https://hackage.haskell.org/package/template-haskell-2.12.0.0/docs/Language-Haskell-TH-Syntax.html#v:runIO\" rel=\"noreferrer\"><code>runIO</code></a> could be used to generate the static Rust library (and delete the Rust source file afterwards) by calling out to <code>rustc</code>.</li>\n</ul>\n\n<p>What is still very much not clear to me is</p>\n\n<ol>\n<li>how I can use Template Haskell to add libraries against which to link and</li>\n<li>how I can use Template Haskell to clean up these generated libraries afterwards?</li>\n</ol>\n\n<h1>EDIT</h1>\n\n<p>I've filed a <a href=\"https://ghc.haskell.org/trac/ghc/ticket/14298#ticket\" rel=\"noreferrer\">GHC feature request</a> related to this.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1506665243, "post_id": 46482145, "comment_id": 79919793, "body": "(Side note: what do you think <code>id</code> does?)"}, {"owner": {"reputation": 259, "user_id": 4548474, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e5ea8283f095b898128b63da9fa0e1e?s=128&d=identicon&r=PG&f=1", "display_name": "Matty", "link": "https://stackoverflow.com/users/4548474/matty"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1506666052, "post_id": 46482145, "comment_id": 79920097, "body": "Now looking at it. I suppose it does nothing. In fact, my actual code doesn&#39;t have it so I don&#39;t know why I added it here."}], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 4548474, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e5ea8283f095b898128b63da9fa0e1e?s=128&d=identicon&r=PG&f=1", "display_name": "Matty", "link": "https://stackoverflow.com/users/4548474/matty"}, "edited": false, "score": 0, "creation_date": 1506695472, "post_id": 46483552, "comment_id": 79936498, "body": "Fantastic. This works great. I think I will adapt it to only set a specific record instead of all records, but this gives me enough to get there."}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 2, "last_activity_date": 1506668908, "creation_date": 1506668908, "answer_id": 46483552, "question_id": 46482145, "link": "https://stackoverflow.com/questions/46482145/haskell-creating-partial-of-custom-data-type-with-variables/46483552#46483552", "title": "Haskell: Creating Partial of Custom Data Type With Variables", "body": "<p>Could you use <a href=\"https://hackage.haskell.org/package/lens\" rel=\"nofollow noreferrer\">lens</a> for that?</p>\n\n<p>You'll need</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>import Control.Lens (makeLenses, (.~))\n</code></pre>\n\n<p>in your module file.</p>\n\n<p>Then, guessing at what <code>Transaction</code> looks like, you could define it like this:</p>\n\n<pre><code>data Transaction = Transaction {\n    _uid :: String\n  , _amount :: String\n  , _user :: String\n  , _description :: String }\n  deriving (Show, Eq)\nmakeLenses ''Transaction\n</code></pre>\n\n<p>This creates lenses called <code>uid</code>, <code>amount</code>, and so on.</p>\n\n<p>You can now simplify the <code>change</code> function to this:</p>\n\n<pre><code>change' :: (Transaction -&gt; Transaction) -&gt; String -&gt; [Transaction] -&gt; IO ()\nchange' l uidValue = mergeData ((uid .~ uidValue) . l) uidValue\n</code></pre>\n\n<p>For testing, I first defined <code>mergeData</code> like this, as it seems to fit the type used in the OP <code>change</code> function:</p>\n\n<pre><code>mergeData :: (Transaction -&gt; Transaction) -&gt; String -&gt; [Transaction] -&gt; IO ()\nmergeData f _ = mapM_ (print . f)\n</code></pre>\n\n<p>Here are some examples:</p>\n\n<pre><code>\u03bb&gt; ts = [Transaction \"1\" \"42\" \"Joan\" \"Foo\", Transaction \"2\" \"1337\" \"Nigel\" \"Bar\"]\n\u03bb&gt; change' (amount .~ \"0\") \"7\" ts\nTransaction {_uid = \"7\", _amount = \"0\", _user = \"Joan\", _description = \"Foo\"}\nTransaction {_uid = \"7\", _amount = \"0\", _user = \"Nigel\", _description = \"Bar\"}\n\u03bb&gt; change' (user .~ \"Jane\") \"7\" ts\nTransaction {_uid = \"7\", _amount = \"42\", _user = \"Jane\", _description = \"Foo\"}\nTransaction {_uid = \"7\", _amount = \"1337\", _user = \"Jane\", _description = \"Bar\"}\n</code></pre>\n\n<p>As you can see, <code>amount .~ \"0\"</code> sets all the <code>_amount</code> labels to <code>\"0\"</code>, and <code>user .~ \"Jane\"</code> sets all <code>_user</code> labels to <code>\"Jane\"</code>. Both expressions have the type <code>Transaction -&gt; Transaction</code>:</p>\n\n<pre><code>\u03bb&gt; :type amount .~ \"0\"\namount .~ \"0\" :: Transaction -&gt; Transaction\n\u03bb&gt; :type user .~ \"Jane\"\nuser .~ \"Jane\" :: Transaction -&gt; Transaction\n</code></pre>\n\n<p>If you don't like the underscores in record labels, you can use <code>makeLensesFor</code> instead of <code>makeLenses</code>.</p>\n"}], "owner": {"reputation": 259, "user_id": 4548474, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e5ea8283f095b898128b63da9fa0e1e?s=128&d=identicon&r=PG&f=1", "display_name": "Matty", "link": "https://stackoverflow.com/users/4548474/matty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 46483552, "answer_count": 1, "score": 2, "last_activity_date": 1506668950, "creation_date": 1506661676, "last_edit_date": 1506668950, "question_id": 46482145, "link": "https://stackoverflow.com/questions/46482145/haskell-creating-partial-of-custom-data-type-with-variables", "title": "Haskell: Creating Partial of Custom Data Type With Variables", "body": "<p>I have a working function that uses guards to determine how to create a copy of a custom data type (in this case <code>Transaction</code>) yet change only one field in doing so. What is the idiomatic way to solve this issue?</p>\n\n<p>If I could use variables as keys in my partials, I could simplify the function to something like the following:</p>\n\n<pre><code>change n val uid list = do\n    let partial x = x {uid = uid, n = val}\n    mergeData partial uid list\n</code></pre>\n\n<p>But I can't seem to find a way to use a variable as a key or call a function common to all guards.</p>\n\n<pre><code>change :: [Char] -&gt; [Char] -&gt; String -&gt; [Transaction] -&gt; IO ()\nchange n val uid list\n    | n == \"amount\" = do\n        let partial x = x {uid = (id uid), amount = (id val)}\n        mergeData partial uid list\n    | n == \"user\" = do\n        let partial x = x {uid = (id uid), user = (id val)}\n        mergeData partial uid list\n    | n == \"category\" = do\n        let partial x = x {uid = (id uid), user = (id val)}\n        mergeData partial uid list\n    | n == \"description\" = do\n        let partial x = x {uid = (id uid), description = (id val)}\n        mergeData partial uid list\n</code></pre>\n\n<p>P. S. <code>mergeData</code> is another function which is creating this copied instance of <code>Transaction</code> with the edited fields.</p>\n"}, {"tags": ["haskell", "code-coverage", "haskell-stack"], "comments": [{"owner": {"reputation": 482, "user_id": 6931261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c4e2b912aeec1888a96026c1fb4311?s=128&d=identicon&r=PG&f=1", "display_name": "ecthiender", "link": "https://stackoverflow.com/users/6931261/ecthiender"}, "edited": false, "score": 0, "creation_date": 1531397681, "post_id": 46481633, "comment_id": 89587378, "body": "Were you able to solve it? I&#39;m facing similar issue and unable to solve it."}, {"owner": {"reputation": 121, "user_id": 8203663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679f61b0be59164a74f2616c21334a34?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8203663/james"}, "reply_to_user": {"reputation": 482, "user_id": 6931261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c4e2b912aeec1888a96026c1fb4311?s=128&d=identicon&r=PG&f=1", "display_name": "ecthiender", "link": "https://stackoverflow.com/users/6931261/ecthiender"}, "edited": false, "score": 0, "creation_date": 1531541479, "post_id": 46481633, "comment_id": 89645508, "body": "I ended up rsyncing my entire codebase to a new directory and running HPC manually. Still within that stack exec environment though. Has worked fine for me since, although I would rather stack worked correctly here."}, {"owner": {"reputation": 482, "user_id": 6931261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c4e2b912aeec1888a96026c1fb4311?s=128&d=identicon&r=PG&f=1", "display_name": "ecthiender", "link": "https://stackoverflow.com/users/6931261/ecthiender"}, "edited": false, "score": 0, "creation_date": 1531549002, "post_id": 46481633, "comment_id": 89646611, "body": "You mean rsyncing the codebase without built code (without .stack-work directory) in a different directory and running hpc? How did you install hpc in that then? How did you get the .tix files? Can you elaborate it a bit pls?"}, {"owner": {"reputation": 121, "user_id": 8203663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679f61b0be59164a74f2616c21334a34?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8203663/james"}, "reply_to_user": {"reputation": 482, "user_id": 6931261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c4e2b912aeec1888a96026c1fb4311?s=128&d=identicon&r=PG&f=1", "display_name": "ecthiender", "link": "https://stackoverflow.com/users/6931261/ecthiender"}, "edited": false, "score": 1, "creation_date": 1531642473, "post_id": 46481633, "comment_id": 89665958, "body": "As in I made a new directory inside my stack project folder structure, and rsynced all my source files into that folder. I stack installed hpc (or maybe it comes by default with GHC?) At which point I just followed the HPC wiki to generate the tix files."}], "answers": [{"tags": [], "owner": {"reputation": 380, "user_id": 1635672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd0c9e0a1fd1b3f1bb3e1184eb01b64?s=128&d=identicon&r=PG", "display_name": "Zhu Jinxuan", "link": "https://stackoverflow.com/users/1635672/zhu-jinxuan"}, "is_accepted": false, "score": 1, "last_activity_date": 1541451707, "creation_date": 1541451707, "answer_id": 53162162, "question_id": 46481633, "link": "https://stackoverflow.com/questions/46481633/how-can-i-generate-a-coverage-overlay-with-hpc-and-stack/53162162#53162162", "title": "How can I generate a coverage overlay with HPC and Stack?", "body": "<p>Replace <code>:</code> with <code>/</code>.  The draft code shall be </p>\n\n<pre><code>module \"hpcTest-0.1.0.0-HnYRxRg1qoiyMKwsCMtby/Lib\" {\n  tick function \"otherFunc\" on line 9;\n}\n</code></pre>\n\n<p>I find that by looking into the tix file <code>stack hpc</code> creates. (lol)</p>\n"}], "owner": {"reputation": 121, "user_id": 8203663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679f61b0be59164a74f2616c21334a34?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8203663/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 1, "answer_count": 1, "score": 7, "last_activity_date": 1541451707, "creation_date": 1506657792, "last_edit_date": 1506671402, "question_id": 46481633, "link": "https://stackoverflow.com/questions/46481633/how-can-i-generate-a-coverage-overlay-with-hpc-and-stack", "title": "How can I generate a coverage overlay with HPC and Stack?", "body": "<p>I have a small/medium sized Haskell codebase for which I'd like to generate a coverage report. By default the coverage report that HPC provides is filled with false negatives (e.g. I use lenses to access most of my record fields, rather than the auto generated ones, which HPC then reports as not covered).</p>\n\n<p>The typical solution to this is to generate some overlay as specified here: <a href=\"https://wiki.haskell.org/Haskell_program_coverage#Hpc_toolkit\" rel=\"noreferrer\">https://wiki.haskell.org/Haskell_program_coverage#Hpc_toolkit</a></p>\n\n<p>When I try to do this with Stack I run into an issue.</p>\n\n<pre><code>$ stack new --resolver=lts-9.5 hpcTest\n</code></pre>\n\n<p>If we edit <code>src/Lib.hs</code> to be:</p>\n\n<pre><code>module Lib\n( someFunc, otherFunc\n) where\n\nsomeFunc :: IO ()\nsomeFunc = putStrLn \"someFunc\"\n\notherFunc :: IO ()\notherFunc = putStrLn \"otherFunc\"\n</code></pre>\n\n<p>and <code>test/spec.hs</code> to be:</p>\n\n<pre><code>import Lib\n\nmain :: IO ()\nmain = someFunc\n</code></pre>\n\n<p>and run <code>stack test --coverage</code></p>\n\n<p>We get a coverage report which is not 100% covered, so if we follow the instructions of the wiki page we get: <code>stack exec hpc -- draft --hpcdir=.stack-work/dist/x86_64-linux/Cabal-1.24.2.0/hpc/ --srcdir=. .stack-work/install/x86_64-linux/lts-9.5/8.0.2/hpc/hpcTest/hpcTest-test/hpcTest-test.tix &gt; myDraft.txt</code></p>\n\n<p>which when we run results in the following in <code>myDraft.txt</code>:</p>\n\n<pre><code>module \"hpcTest-0.1.0.0-HnYRxRg1qoiyMKwsCMtby:Lib\" {\n  tick function \"otherFunc\" on line 9;\n}\n</code></pre>\n\n<p>when we then do the next step and try to generate the overlay <code>stack exec hpc -- overlay --hpcdir=.stack-work/dist/x86_64-linux/Cabal-1.24.2.0/hpc/ --srcdir=. myDraft.txt</code> the process falls over and we get the following error:</p>\n\n<pre><code>hpc: can not find hpcTest-0.1.0.0-HnYRxRg1qoiyMKwsCMtby:Lib in ./.hpc, ./.stack-work/dist/x86_64-linux/Cabal-1.24.2.0/hpc/\nCallStack (from HasCallStack):\n  error, called at libraries/hpc/Trace/Hpc/Mix.hs:122:15 in hpc-0.6.0.3:Trace.Hpc.Mix\n</code></pre>\n\n<p>What am I doing wrong in this process and how can I get this to work?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 4, "creation_date": 1506639130, "post_id": 46479252, "comment_id": 79913754, "body": "I think your obvious solution is correct.  When working with typeclasses, we need to extend our concept of a type from &quot;set-like&quot; to &quot;algebraic-structure-like&quot;.  <code>Compose g f</code> is already an <code>Applicative</code> in one way, and you propose to make it one in a different way.  In this way of thinking, it&#39;s now a different type -- much like we use <code>Sum Int</code> to indicate that we mean to take the <code>Monoid</code> that adds as opposed to the several other possibilities."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1506639592, "post_id": 46479252, "comment_id": 79913878, "body": "Can you say what you mean by &quot;hacky&quot;? Why don&#39;t you like the &quot;roll your own <code>Compose</code>&quot; solution?"}, {"owner": {"reputation": 596, "user_id": 2684007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0dc231525b77cbf9b18251173353c74f?s=128&d=identicon&r=PG&f=1", "display_name": "Simon C", "link": "https://stackoverflow.com/users/2684007/simon-c"}, "edited": false, "score": 0, "creation_date": 1506698685, "post_id": 46479252, "comment_id": 79938569, "body": "The issue might be that I&#39;ve been misconstruing type class parameters. I&#39;ve been reading <code>instance (Applicative f, Applicative g) =&gt; Applicative (Compose f g)</code> as &quot;whenever <code>f</code> and <code>g</code> are <code>Applicative</code>, so is <code>Compose f g</code>. So if either <code>f</code> or <code>g</code> isn&#39;t known to be <code>Applicative</code>, GHC shouldn&#39;t conclude that <code>Compose f g</code> is. Obviously this isn&#39;t what&#39;s happening! But it seems like sensible enough behavior (though maybe it has bad consequences downstream). So perhaps my resistance to &quot;roll your own <code>Compose</code>&quot; is just me being stubborn about my naive understanding of type class parameters."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1507055148, "post_id": 46479252, "comment_id": 80056513, "body": "@SimonC Right. One could definitely imagine a type class system with that behavior, and nothing semantically would go wrong. The problem is that then finding an instance involves a backtracking search, and the committee wanted to avoid that both to avoid forcing a complex implementation (remember, at the time, this was the first type class system in existence and nobody knew how complicated it would be!) and to avoid users discovering deep in a development that long instance searches were causing enormous compilation times."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1506640661, "post_id": 46479463, "comment_id": 79914185, "body": "The <code>Functor</code> instance should probably be the usual derived one for efficiency, I imagine."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1506639486, "creation_date": 1506639486, "answer_id": 46479463, "question_id": 46479252, "link": "https://stackoverflow.com/questions/46479252/rolling-your-own-applicatives-with-data-functor-compose/46479463#46479463", "title": "Rolling your own Applicatives with Data.Functor.Compose", "body": "<p>Generally, if you need a different instance, you need a new type. Should be pretty straightforward; just a few lines of code:</p>\n\n<pre><code>newtype AdjointCompose f g a = AdjointCompose { runAdjointCompose :: f (g a) }\n\ninstance (Functor f, Functor g) =&gt; Functor (AdjointCompose f g) where\n    fmap = liftM\n\ninstance Adjoint f g =&gt; Applicative (AdjointCompose g f) where\n    pure = return\n    (&lt;*&gt;) = ap\n\ninstance Adjoint f g =&gt; Monad (AdjointCompose g f) where\n    -- as in your proposed instance\n</code></pre>\n\n<p>Now you can have your cake and eat it, too: when you want the composition of <code>Applicative</code>s, use <code>Compose</code>, and when you want the <code>Applicative</code> you get from adjointness, use <code>AdjointCompose</code>.</p>\n\n<p>If you want some of the other instances that <code>Compose</code> defines for free, you could write <code>AdjointCompose</code> as a newtype over <code>Compose</code> instead and get them via <code>GeneralizedNewtypeDeriving</code>.</p>\n"}], "owner": {"reputation": 596, "user_id": 2684007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0dc231525b77cbf9b18251173353c74f?s=128&d=identicon&r=PG&f=1", "display_name": "Simon C", "link": "https://stackoverflow.com/users/2684007/simon-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 1, "accepted_answer_id": 46479463, "answer_count": 1, "score": 2, "last_activity_date": 1506639486, "creation_date": 1506638203, "last_edit_date": 1506639295, "question_id": 46479252, "link": "https://stackoverflow.com/questions/46479252/rolling-your-own-applicatives-with-data-functor-compose", "title": "Rolling your own Applicatives with Data.Functor.Compose", "body": "<p>I was playing around with the wonderful answer given <a href=\"https://stackoverflow.com/a/4702513/2684007\">here</a>. I naively expected this to work:</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n\nimport Data.Functor.Compose\nimport Control.Monad\n\nclass (Functor f, Functor g) =&gt; Adjoint f g where\n    counit :: f (g a) -&gt; a\n    unit   :: a -&gt; g (f a)\n\ninstance (Adjoint f g) =&gt; Monad (Compose g f) where\n    return x = Compose $ unit x\n    x &gt;&gt;= f  = Compose . fmap counit . getCompose $ fmap (getCompose . f) x\n</code></pre>\n\n<p>It doesn't, though. I get the following error: </p>\n\n<pre><code>adjoint.hs:10:10: error:\n    \u2022 Could not deduce (Applicative g)\n        arising from the superclasses of an instance declaration\n</code></pre>\n\n<p>Here's what seems to be happening. GHC requires all <code>Monad</code>s to have an <code>Applicative</code> instance, so the compiler goes looking for one for <code>Compose g f</code>.\n <a href=\"https://hackage.haskell.org/package/transformers-0.3.0.0/docs/src/Data-Functor-Compose.html#Compose\" rel=\"nofollow noreferrer\"><code>Data.Functor.Compose</code></a> defines such an instance, but it requires <code>g</code> (and <code>f</code>) to be <code>Applicative</code>:</p>\n\n<pre><code>instance (Applicative f, Applicative g) =&gt; Applicative (Compose f g) where\n    pure x = Compose (pure (pure x))\n    Compose f &lt;*&gt; Compose x = Compose ((&lt;*&gt;) &lt;$&gt; f &lt;*&gt; x)\n</code></pre>\n\n<p>But in the general case, <code>Compose g f</code> can be a <code>Monad</code> (and thereby <code>Applicative</code>) even when <code>g</code> and <code>f</code> aren't both <code>Applicative</code>. The usual example is when <code>f</code> is <code>(,) s</code>, and <code>g</code> is <code>(-&gt;) s</code>. Then <code>Compose g f</code> is the <code>State</code> <code>Monad</code>, even though <code>(,) s</code> isn't (always) <code>Applicative</code>.</p>\n\n<p>This seems a bit suboptimal. For one, it would be nice to use <code>Adjoint</code> to define <code>Monad</code> instances for two <code>Functor</code>s that aren't both <code>Applicative</code>. More generally, though, there are ways for the composition of two <code>Functors</code> to be <code>Applicative</code>, even when one or both of them fails to be. Currently, though, the way that GHC behaves, combined with the way <code>Data.Functor.Compose</code> is set up, <em>precludes you from ever realizing these use cases</em>. If you try to define an <code>Applicative</code> instance for any <code>Compose g f</code>, GHC will complain about a duplicate instance declaration.</p>\n\n<p>The obvious solution is just to roll your own version of <code>Data.Functor.Compose</code> with the <code>Applicative</code> lines scrapped. That's straightforward enough, if a bit hacky. Are there other more principled ways to approach the issue?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 493, "user_id": 6889286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d9b8a4d03d0de0a49eac62a5569c9e?s=128&d=identicon&r=PG&f=1", "display_name": "Kartik Sabharwal", "link": "https://stackoverflow.com/users/6889286/kartik-sabharwal"}, "is_accepted": true, "score": 2, "last_activity_date": 1506641390, "creation_date": 1506641390, "answer_id": 46479702, "question_id": 46478824, "link": "https://stackoverflow.com/questions/46478824/getting-mouse-coordinates-in-haskell-fltk/46479702#46479702", "title": "Getting mouse coordinates in Haskell FLTK", "body": "<p>Glancing through the documentation yielded this page:</p>\n\n<p><a href=\"https://hackage.haskell.org/package/fltkhs-0.5.4.1/docs/Graphics-UI-FLTK-LowLevel-FL.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/fltkhs-0.5.4.1/docs/Graphics-UI-FLTK-LowLevel-FL.html</a></p>\n\n<p>It has a function with the following signature:</p>\n\n<pre><code>getMouse :: IO Position\n</code></pre>\n\n<p>I suppose it's FLTKHS's analogue for get_mouse</p>\n"}], "owner": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 46479702, "answer_count": 1, "score": 0, "last_activity_date": 1506641390, "creation_date": 1506635294, "last_edit_date": 1506635733, "question_id": 46478824, "link": "https://stackoverflow.com/questions/46478824/getting-mouse-coordinates-in-haskell-fltk", "title": "Getting mouse coordinates in Haskell FLTK", "body": "<p>I'm trying to load an image into a fltkhs box widget and do some image processing on it and I'd like to get the coordinates when the mouse click on a point on the image.</p>\n\n<p>I couldn't find any part of fltkhs that can handle mouse events.\nAnyone could give any suggestions?</p>\n"}, {"tags": ["list", "haskell", "recursion", "deadlock", "self-reference"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 6, "creation_date": 1506632185, "post_id": 46478088, "comment_id": 79911488, "body": "Whilst this may be simple for this case, in general you&#39;re asking the compiler to solve the halting problem. But in any case, why would the compiler not represent the list as the code describes it? Returning <code>[1,1]</code> in that example is completely spurious, since, for instance <code>[1,32132132]</code> is equally valid."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 4, "creation_date": 1506633764, "post_id": 46478088, "comment_id": 79912154, "body": "given <code>list = 1 : tail list</code> i.e. <code>list = 1 : t  where  t = tail list</code>, what is <code>t</code>? It&#39;s <code>t = tail list = tail (1 : t) = t</code>. Even from equational reasoning <code>t = t</code> is trivially valid for any value of <code>t</code>, so it really doesn&#39;t say anything about <code>t</code> at all, so there would be no justification  to give it any specific value. Trying to print <code>list</code> could result in <code>[1,***ERROR: black hole detected***</code> or <code>[1,</code> and getting stuck in an infinite loop. Closing the list as <code>[1]</code> would mean <code>t = []</code>, and this too is unjustified (so, wrong thing to do, from equational reasoning standpoint)."}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 2, "creation_date": 1506634398, "post_id": 46478088, "comment_id": 79912397, "body": "<code>list = 1 : tail list</code> doesn&#39;t block anything in haskell, nor ghc haskell..it&#39;s a perfectly valid definition of a value with well-defined operations on it that work and are useful."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1506638837, "post_id": 46478088, "comment_id": 79913665, "body": "Solving recursive equations means taking a least fixed point for a suitable function in some domain. Here least means &quot;least defined&quot;: anything more defined than that essentially involves inventing values out of this air. E.g. solving <code>let (a,b,c,d) = (b,1,d,c)</code> must pick <code>a=b=1</code>, but has infinitely many choices for <code>c,d</code>. Since we can&#39;t solve the halting problem in general, the only sensible choice is <code>c=d=bottom</code> where <code>bottom</code> is non termination/infinite recursion/infinite loop."}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 2, "last_activity_date": 1506717287, "last_edit_date": 1506717287, "creation_date": 1506645515, "answer_id": 46480169, "question_id": 46478088, "link": "https://stackoverflow.com/questions/46478088/haskell-handling-deadlocked-self-referential-lists/46480169#46480169", "title": "Haskell: Handling deadlocked self-referential lists", "body": "<p>Even though <code>list</code> loops forever under GHCi, a proper binary compiled with GHC <em>does</em> detect the loop and signals an error.  If you compile and run:</p>\n\n<pre><code>list = 1 : tail list\nmain = print list\n</code></pre>\n\n<p>it terminates with the error message:</p>\n\n<pre><code>Loop: &lt;&lt;loop&gt;&gt;\n</code></pre>\n\n<p>It does the same thing with your <code>primes</code> examples.</p>\n\n<p>As others have noted, GHC doesn't detect all possible loops.  It if did, then it would solve the Halting Problem, and that would probably make Haskell much more popular.</p>\n\n<p>The reason it returns an error (or \"gets stuck\") instead of returning <code>[1,1]</code> is because the expression:</p>\n\n<pre><code>list = 1 : tail list\n</code></pre>\n\n<p>has well defined semantics in the Haskell language.  These semantics assign it a value, and this value is \"bottom\" (or \"error\" or the symbol <code>_|_</code>), just as surely as the value of <code>head [1,2,3]</code> is <code>1</code>.</p>\n\n<p>(Well, technically, the value of <code>list</code> is <code>1 : _|_</code> which is \"almost bottom\".  This is what @Justin Li was talking about in his comment.  I've tried to give an explanation of why it has this value below.)</p>\n\n<p>Though you may not see the use of a program or an expression that returns bottom and not see the harm in assigning non-bottom semantics to such expressions on the basis that it is \"backwards compatible\", most people in the Haskell community (the language designers, compiler developers, and experienced users) will disagree with you, so don't expect to make much progress with them.</p>\n\n<p>As for the specific new semantics you are proposing, they are unclear.  Why isn't the value of <code>list</code> equal to <code>[1]</code>?  It seems to me that when I am entering the \"generator\" to get element n=1 (zero indexed, so the second element) and evaluate <code>tail list</code>, then the <code>list</code> ending at element n-1=0 is <code>[1]</code> which has tail equal to <code>[]</code>, so I think I should get the following, right?</p>\n\n<pre><code>list = 1 : tail list\n     = 1 : tail [1]   -- use list-so-far\n     = 1 : []\n     = [1]\n</code></pre>\n\n<h2>Why the value is (almost) bottom</h2>\n\n<p>Here's why the value of <code>list</code> is (almost) bottom, according to the semantics of standard Haskell (but see note at the end).</p>\n\n<p>For reference, the definition of <code>tail</code> is, effectively:</p>\n\n<pre><code>tail l = case l of _:xs -&gt; xs\n                   [] -&gt; error \"ack, you dummy!\"\n</code></pre>\n\n<p>Let's try to \"fully\" evaluate <code>list</code> using Haskell semantics:</p>\n\n<pre><code>-- evaluating `list` using definition of `list`\nlist = 1 : tail list\n\n-- evaluating `tail list` using definition of `tail`\nlist = 1 : case list of _:xs -&gt; xs\n                        ...\n-- evaluating case construct requires matching `list` to\n-- a pattern, this requires evaluation of `list` using its defn\nlist = 1 : case (1 : tail list) of _:xs -&gt; xs\n                                   ...\n-- case pattern match succeeds\nlist = 1 : let xs = tail list in xs    -- just to be clear\n     = 1 : tail list\n\n-- awesome, now all we need to do is evaluate:\nlist = 1 : tail list\n-- ummm, Houston, we have a problem\n</code></pre>\n\n<p>and that infinite loop at the end is why the expression is \"almost bottom\".</p>\n\n<p>Note:  There are actually several different sets of Haskell semantics, different methods of calculating the values of Haskell expressions.  The gold standard are the denotational semantics described in @luqui's answer.  The ones I'm using above are, at best, a form of the \"informal semantics\" described in the Haskell report, but they're good enough to get the right answer.</p>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 5, "last_activity_date": 1506652083, "last_edit_date": 1506652083, "creation_date": 1506651724, "answer_id": 46480857, "question_id": 46478088, "link": "https://stackoverflow.com/questions/46478088/haskell-handling-deadlocked-self-referential-lists/46480857#46480857", "title": "Haskell: Handling deadlocked self-referential lists", "body": "<p>Here is a denotational perspective on how <code>list = 1 : \u22a5</code>. </p>\n\n<p>First, a little background.  In Haskell, values are partially ordered by \"definedness\", where values inolving &bot; (\"bottom\") are less-defined than ones without.  So</p>\n\n<ul>\n<li><code>\u22a5</code> is less defined than <code>1 : \u22a5</code> </li>\n<li><code>1 : \u22a5</code> is less defined than <code>1 : 2 : 3 : []</code></li>\n</ul>\n\n<p>But it's a partial order, so</p>\n\n<ul>\n<li><code>1 : \u22a5</code> is <em>not</em> less defined than <code>2 : 3 : \u22a5</code>, nor is it more defined.  </li>\n</ul>\n\n<p>even though the second list is longer.  <code>1 : \u22a5</code> is only less defined than lists that start with 1.   I highly recommend reading about <a href=\"https://en.wikibooks.org/wiki/Haskell/Denotational_semantics\" rel=\"noreferrer\">denotational semantics</a> of Haskell.</p>\n\n<p>Now to your question.  Look at</p>\n\n<pre><code>list = 1 : tail list\n</code></pre>\n\n<p>as an equation to be solved instead of a \"function declaration\".  We rewrite it like this:</p>\n\n<pre><code>list = ((1 :) . tail) list\n</code></pre>\n\n<p>Viewing it this way, we see that <code>list</code> is a <em>fixed point</em> </p>\n\n<pre><code>list = f list\n</code></pre>\n\n<p>where <code>f = (1 :) . tail</code>.  In Haskell semantics, recursive values are solved by finding the <em>least fixed point</em> according to the above ordering.</p>\n\n<p>The way to find this is very simple.  If you start with \u22a5, and then apply the function over and over, and you will find an increasing chain of values.  The point at which the chain stops changing <a href=\"https://en.wikipedia.org/wiki/Fixed-point_theorem\" rel=\"noreferrer\">will be the least fixed point</a>  (technically the it will be the limit of the chain, since it might not ever stop changing). </p>\n\n<p>Starting with \u22a5,</p>\n\n<pre><code>f \u22a5 = ((1 :) . tail) \u22a5 = 1 : tail \u22a5\n</code></pre>\n\n<p>we see that \u22a5 is not already a fixed point because we didn't get \u22a5 out the other end.  So let's try again with what we got out:</p>\n\n<pre><code>f (1 : tail \u22a5) = ((1 :) . tail) (1 : tail \u22a5)\n               = 1 : tail (1 : tail \u22a5)\n               = 1 : tail \u22a5\n</code></pre>\n\n<p>Oh look, it's a fixed point, we got the same thing out that we put in.</p>\n\n<p>The important point here is that it's the <em>least</em> one.  Your solution <code>[1,1] = 1:1:[]</code> is also a fixed point, so it solves the equation:</p>\n\n<pre><code>f (1:1:[]) = ((1 :) . tail) (1:1:[]) \n           = 1 : tail (1:1:[])\n           = 1:1:[]\n</code></pre>\n\n<p>But of course, every list that starts with 1 is a solution, and it's unclear how we should choose between them. However, the one we found by recursion <code>1:\u22a5</code> is less defined than all of them, it delivers no more information than required by the equation, and that is the one that is specified by the language.</p>\n"}], "owner": {"reputation": 87, "user_id": 8682061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebba5ec82c3ed1cc88da2de62fbcf53f?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/8682061/erik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1506717287, "creation_date": 1506631791, "last_edit_date": 1506632185, "question_id": 46478088, "link": "https://stackoverflow.com/questions/46478088/haskell-handling-deadlocked-self-referential-lists", "title": "Haskell: Handling deadlocked self-referential lists", "body": "<p>Is there any useful reason why the GHC allows the following to block forever:</p>\n\n<pre><code>list = 1 : tail list\n</code></pre>\n\n<p>It seems with a bit of sophistication in the list iterator/generator we should be able to do something more useful:</p>\n\n<ol>\n<li>Return <code>error \"Infinitely blocking list\"</code></li>\n<li>Return <code>[1,1]</code></li>\n</ol>\n\n<p>Explaining 2: it seems possible that when entering the generator to get element <code>N</code>, we could then make all self references inside the generator limited to the list but ending at <code>N-1</code> (we notice the <code>read N</code> inside the scope <code>generate N</code> and return the end-of-list). It's a sort of simple deadlock detection using scopes.</p>\n\n<p>Clearly this isn't that useful for the toy example above, but it may allow for more useful/elegant finite, self-referential list definitions, for example:</p>\n\n<pre><code>primes = filter (\\x -&gt; none ((==0).mod x) primes) [2..]\n</code></pre>\n\n<p>Note that either change should only affect list generators that would currently result in an infinite-block, so they seem backward compatible language changes.</p>\n\n<p>Ignoring the GHC-complexity required to make such a change for a moment, would this behavior break any existing language behavior that I am missing? Any other thoughts on the \"elegance\" of this change?</p>\n\n<p>Also see another BFS example that could benefit below. To me, this seems more functional/elegant than some other solutions, since I am only needing to define what a bfsList <em>is</em>, not <em>how</em> to generate it (i.e specifying a terminating condition):</p>\n\n<pre><code>bfs :: (a -&gt; Bool) -&gt; (a -&gt; [a]) -&gt; [a] -&gt; Maybe a\nbfs predf expandf xs = find predf bfsList\n    where bfsList = xs ++ concatMap expandf bfsList\n</code></pre>\n"}, {"tags": ["haskell", "matrix"], "answers": [{"comments": [{"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1506652600, "post_id": 46480924, "comment_id": 79916695, "body": "I actually did try going this route originally, but the band storage matrix, while simpler, really just shifts the problems from one set of corners to the other. It&#39;s harder to see that in this toy example, but you also have to throw away certain indices in the middle of the array as well, not just those at the beginning and edge."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 1, "creation_date": 1506652802, "post_id": 46480924, "comment_id": 79916732, "body": "I&#39;m not sure I understand.  The point of the LAPACK-like storage is that you don&#39;t worry about those things.  There can be unused indexes in either corner."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1506653267, "post_id": 46480924, "comment_id": 79916836, "body": "My problem has been efficiently marching through the acceptable indices. You still have to worry about the unused positions when deciding a formula to maybe between <code>(i,j)</code> pairs and your <code>ix</code> right? I&#39;ll take a closer look at your code tomorrow morning and see if there&#39;s something I&#39;m missing, but I did go down this path before (even looking at the linked page)."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 1, "last_activity_date": 1506653074, "last_edit_date": 1506653074, "creation_date": 1506652260, "answer_id": 46480924, "question_id": 46476312, "link": "https://stackoverflow.com/questions/46476312/how-can-you-quickly-map-the-indices-of-a-banded-matrix-to-a-1-dimensional-array/46480924#46480924", "title": "How can you quickly map the indices of a banded matrix to a 1-dimensional array?", "body": "<p>You might find it more straightforward to \"waste\" a few indexes at the beginning and end of the matrix, and so assign:</p>\n\n<pre><code>  Row         ______________________   _ _\n   0    (0)  |1    2    X    X    X |   |\n   1         |3    4    5    X    X |   4\n   2         |X    6    7    8    X |   |\n   3         |X    X    9   10   11 |  _|_\n             |______________________|\nColumn        0    1    2    3    4 \n</code></pre>\n\n<p>where <code>(0)</code> is an ignored index.</p>\n\n<p>This is similar to the <a href=\"http://www.netlib.org/lapack/lug/node124.html\" rel=\"nofollow noreferrer\">band matrix representation</a> used by the highly respected LAPACK library.</p>\n\n<p>You just need to take care that the unused elements are properly ignored when performing operations where they might affect used elements.  (For example, a fast fill routine can be written without regard to which elements are used or unused; but a matrix multiplication would need to take a little more more care.)</p>\n\n<p>If you take this approach, then the bijections are pretty simple:</p>\n\n<pre><code>import Data.Char\nimport Data.Maybe\n\ntype Index = Int\n\n-- |(row,col) coordinate: (0,0) is top level\ntype Coord = (Int, Int)\n\n-- |Matrix dimensions: (rows, cols, edges) where edges gives\n-- the count of auxiliary diagonals to *each side* of the main\n-- diagonal (i.e., what you call the maximum distance), so the\n-- total band width is 1+2*edges\ntype Dims = (Int, Int, Int)\n\n-- |Get index for (row,col)\nidx :: Dims -&gt; Coord -&gt; Index\nidx (m, n, e) (i, j) = let w = 1+2*e in w*i+(j-i+e)\n\n-- |Get (row,col) for index\nij :: Dims -&gt; Index -&gt; Coord\nij  (m, n, e) idx    = let w = 1+2*e\n                           (i, j') = idx `quotRem` w\n                       in (i, j'+i-e)\n\n--\n-- test code\n--\n\nshowCoords :: Dims -&gt; [(Coord, Char)] -&gt; String\nshowCoords (m, n, _) cs =\n  unlines $\n  for [0..m-1] $ \\i -&gt;\n    for [0..n-1] $ \\j -&gt;\n      fromMaybe '.' $ lookup (i,j) cs\n  where for = flip map\n\ntest :: Dims -&gt; IO ()\ntest dm@(m,n,_) = do\n  putStrLn $ \"Testing \" ++ show dm\n  let idxs = [0..]\n  -- get valid index/coordinates for this matrix\n  let cs = takeWhile (\\(_, (i,j)) -&gt; i&lt;m || j&lt;n)\n           $ filter (\\(_, (i,j)) -&gt; i&gt;=0 &amp;&amp; j&gt;=0)\n           $ map (\\ix -&gt; (ix, ij dm ix)) idxs\n  -- prove the coordinates are right\n  putStr $ showCoords dm (map (\\(ix, (i,j)) -&gt; ((i,j), chr (ord 'A' + ix))) cs)\n  -- prove getIndex inverts getCoord\n  print $ all (\\(ix, (i,j)) -&gt; idx dm (i,j) == ix) cs\n  putStrLn \"\"\n\nmain = do test (4, 5, 1)   -- your example\n          test (3, 8, 2)   -- another example\n</code></pre>\n"}], "owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1506653074, "creation_date": 1506624400, "question_id": 46476312, "link": "https://stackoverflow.com/questions/46476312/how-can-you-quickly-map-the-indices-of-a-banded-matrix-to-a-1-dimensional-array", "title": "How can you quickly map the indices of a banded matrix to a 1-dimensional array?", "body": "<p>This is closely related to a the question: <a href=\"https://stackoverflow.com/questions/14015556/how-to-map-the-indexes-of-a-matrix-to-a-1-dimensional-array-c\">How to map the indexes of a matrix to a 1-dimensional array (C++)?</a>  </p>\n\n<p>I need to assign a reversible index to each non-zero element in a banded matrix.<br>\nIn the normal, full matrix it is easy to do:</p>\n\n<pre><code>           |-------- 5 ---------|\n  Row      ______________________   _ _\n   0      |0    1    2    3    4 |   |\n   1      |5    6    7    8    9 |   4\n   2      |10   11   12   13   14|   |\n   3      |15   16   17   18   19|  _|_\n          |______________________|\nColumn     0    1    2    3    4 \n</code></pre>\n\n<p>To find the array index we just use the following bijective formula: </p>\n\n<pre><code>matrix[ i ][ j ] = array[ i*m + j ]\n</code></pre>\n\n<p>In my case, we have a symmetrically banded matrix with some constraint on distance from the diagonal. For example, the following uses an upper and lower bound of 1: </p>\n\n<pre><code>           |-------- 5 ---------|\n  Row      ______________________   _ _\n   0      |0    1    X    X    X |   |\n   1      |2    3    4    X    X |   4\n   2      |X    5    6    7    X |   |\n   3      |X    X    8    9    10|  _|_\n          |______________________|\nColumn     0    1    2    3    4 \n</code></pre>\n\n<p>In this case, I want to assign an index position to each element within the bandwidth, and ignore everything outside. There are a couple of ways to do this, one of which is to create a list of all the acceptable indices <code>ix's</code>, and then use map lookups to quickly go back and forth between a <code>(row,col)</code> pair and a singular index:</p>\n\n<pre><code>ix's :: [(Int,Int)] -- List of all valid indices \n\nlkup :: Map (Int,Int) Int\nlkup = M.fromList $ zip ix's [0..]\n\nrlkup :: Map Int (Int, Int)\nrlkup = M.fromList $ zip [0..] ix's\n\nfromTup :: (Int, Int) -&gt; Int\nfromTup tup = fromMaybe 0 $ M.lookup tup lkup\n\ntoTup :: Int -&gt; (Int, Int)\ntoTup i = fromMaybe (0,0) $ M.lookup i rlkup\n</code></pre>\n\n<p>For large matrices, this leads to a huge number of map lookups, which causes a bottleneck. Is there a more efficient formula to translate between the valid addresses, <code>k</code>, and <code>(row,col)</code> pairs?</p>\n"}, {"tags": ["haskell", "functional-programming", "frp", "ghcjs", "reflex"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1506631544, "post_id": 46475624, "comment_id": 79911170, "body": "What have you tried? It seems that <code>fan</code> or <code>fanMap</code> would work - what about these functions are you having difficulty with?"}, {"owner": {"reputation": 293, "user_id": 2431984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29e6ef2db775edf8f056584c8c59eee4?s=128&d=identicon&r=PG", "display_name": "Micha\u0142 Adamczyk", "link": "https://stackoverflow.com/users/2431984/micha%c5%82-adamczyk"}, "edited": false, "score": 0, "creation_date": 1506639887, "post_id": 46475624, "comment_id": 79913959, "body": "Using fan or fanMap you seem to have to know exact keys with which you&#39;ll be selecting events. Here the list is dynamic so you can&#39;t know the length - you can&#39;t pull it from the event. So it looks like it all was designed to countermeasure such an idea. Anyway creating multiple request for each element of the list is very unelegant and unefficient. If it&#39;s possible you should change your server API to allow batch requests."}], "owner": {"reputation": 1242, "user_id": 3252252, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/4V81y.jpg?s=128&g=1", "display_name": "Jesuspc", "link": "https://stackoverflow.com/users/3252252/jesuspc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1506621740, "creation_date": 1506621740, "question_id": 46475624, "link": "https://stackoverflow.com/questions/46475624/reflex-sending-multiple-http-requests-for-a-dynamic-list-of-entries-on-event", "title": "Reflex: Sending multiple http requests for a dynamic list of entries on event", "body": "<p>Working with reflex-frp I have a list of entries which contain a text input. I also have a button that on click should trigger n http requests where n is the number of entries, and each request should contain the corresponding text. Therefore I have,</p>\n\n<pre><code>Event t [Text]\n</code></pre>\n\n<p>In order to send the requests I was trying to use</p>\n\n<pre><code>performRequestAsync :: MonadWidget t m =&gt; Event t XhrRequest -&gt; m (Event t XhrResponse)\n</code></pre>\n\n<p>Therefore I need somehow a function that allows me to convert my event of list into a list of events:</p>\n\n<pre><code>Event t [Text] -&gt; [Event t Text]\n</code></pre>\n\n<p>But I am not finding any way to do so. The most promising approach seems to involve the <strong>fan</strong> function and an <strong>EventSelector</strong> but I'm not being able to make much sense of it and there isn't much documentation online. </p>\n\n<p>Is this possible?</p>\n"}, {"tags": ["function", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 0, "creation_date": 1506622129, "post_id": 46475041, "comment_id": 79906428, "body": "<code>dropWhileEnd</code> is in Data.List now."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1506619487, "creation_date": 1506619487, "answer_id": 46475041, "question_id": 46474966, "link": "https://stackoverflow.com/questions/46474966/writing-code-to-reverse-haskell-program/46475041#46475041", "title": "Writing code to reverse Haskell program", "body": "<p>Just use <code>removeX (init xs)</code> instead of <code>init xs &amp;&amp; removeX xs</code>. Haskell is not procedural (you don't write down a sequence of changes to make) but functional (you write down functions that produce new results from old). Haven't read the rest of the code to see if there are other errors, though.</p>\n\n<p>Also consider <code>removeX = reverse . dropWhile ('X'==) . reverse</code> for better efficiency. Lists are singly-linked, so accesses and modifications at the end are relatively expensive.</p>\n"}], "owner": {"reputation": 289, "user_id": 7800841, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8909e2ac4382c623d489fef1e3bc915f?s=128&d=identicon&r=PG&f=1", "display_name": "AdamK", "link": "https://stackoverflow.com/users/7800841/adamk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 46475041, "answer_count": 1, "score": 1, "last_activity_date": 1506619487, "creation_date": 1506619245, "question_id": 46474966, "link": "https://stackoverflow.com/questions/46474966/writing-code-to-reverse-haskell-program", "title": "Writing code to reverse Haskell program", "body": "<p>I have written a program that takes a message as a string and returns an anagram by padding the message with X's as needed such that the string length has exactly 4 factors then essentially rearranges the message as if it had been organized in a grid and read down instead of across.  For example, inputting, \"Haskell\" would return the string, \"HealslkX\".  I have written a program that encodes this anagram, but am having trouble writing a program that can reverse the previous program and decode the anagram, particularly with the removeX function that should remove the X padding.  Here is what I have:</p>\n\n<p>encode:</p>\n\n<pre><code>import Data.List\n\nfactors :: Int -&gt; [Int]\nfactors n = [x | x &lt;- [1..n], n `mod` x == 0]\n\nsplit :: Int -&gt; [a] -&gt; [[a]]\nsplit _ [] = []\nsplit n xs =\n    let (ys, zs) = splitAt n xs\n    in  ys : split n zs\n\nencode :: [Char] -&gt; [Char]\nencode (x:xs) = if (length (factors (length xs))) == 4 then concat \n(transpose (split ((factors (length xs))!!2) xs))\nelse encode (xs ++ ['X'])\n</code></pre>\n\n<p>decode: </p>\n\n<pre><code>import Data.List\n\nfactors :: Int -&gt; [Int]\nfactors n = [x | x &lt;- [1..n], n `mod` x == 0]\n\nsplit :: Int -&gt; [a] -&gt; [[a]]\nsplit _ [] = []\nsplit n xs =\n    let (ys, zs) = splitAt n xs\n    in  ys : split n zs\n\nremoveX :: [a] -&gt; [a]\nremoveX xs = if (last xs) == 'X' then ((init xs) &amp;&amp; removeX xs)\n else xs\n\ndecode :: [Char] -&gt; [Char]\ndecode (x:xs) = removeX (concat (transpose (split ((factors (length xs))!!1) xs)))\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 989, "user_id": 5016244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bdZPE.jpg?s=128&g=1", "display_name": "Theophile Dano", "link": "https://stackoverflow.com/users/5016244/theophile-dano"}, "edited": false, "score": 0, "creation_date": 1506605754, "post_id": 46470480, "comment_id": 79896155, "body": "you are looking for <code>zip</code>"}, {"owner": {"reputation": 58948, "user_id": 857807, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/297e4dba223f5103614030100eab78ca?s=128&d=identicon&r=PG", "display_name": "dcastro", "link": "https://stackoverflow.com/users/857807/dcastro"}, "edited": false, "score": 4, "creation_date": 1506606517, "post_id": 46470480, "comment_id": 79896739, "body": "The examples you posted are both lists of lists, not lists of tuples.."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1506607163, "post_id": 46470480, "comment_id": 79897194, "body": "It&#39;s not entirely clear to me if this question relates to a larger work with parsing JSON, but just in case: are you aware of <a href=\"https://hackage.haskell.org/package/aeson\" rel=\"nofollow noreferrer\">aeson</a>?"}, {"owner": {"reputation": 825, "user_id": 962828, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/78c370f00a14fb3bd59dc334082378cd?s=128&d=identicon&r=PG", "display_name": "Ulrar", "link": "https://stackoverflow.com/users/962828/ulrar"}, "edited": false, "score": 0, "creation_date": 1506609148, "post_id": 46470480, "comment_id": 79898575, "body": "Looks to me like I&#39;m looking for the opposite of zip actually. As for the lists of lists, the first one is the json I have to parse, the second is the result I&#39;m looking for. My problem being that I don&#39;t know how many values each lists will contain on the json side. I know of Aeson but I basically know only how to define simple data with it, not how to parse this without having to define a different data type for each possible number of Floats"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1506610998, "post_id": 46470480, "comment_id": 79899843, "body": "This looks like a <code>transpose</code>."}, {"owner": {"reputation": 825, "user_id": 962828, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/78c370f00a14fb3bd59dc334082378cd?s=128&d=identicon&r=PG", "display_name": "Ulrar", "link": "https://stackoverflow.com/users/962828/ulrar"}, "edited": false, "score": 0, "creation_date": 1506611168, "post_id": 46470480, "comment_id": 79899956, "body": "It does look like what I&#39;m looking for. I&#39;m going to try it, thanks !"}], "answers": [{"tags": [], "owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "is_accepted": false, "score": 3, "last_activity_date": 1506615153, "creation_date": 1506615153, "answer_id": 46473805, "question_id": 46470480, "link": "https://stackoverflow.com/questions/46470480/convert-a-list-of-tuples-to-multiple-lists/46473805#46473805", "title": "Convert a list of tuples to multiple lists", "body": "<p>You can parse the JSON with the <a href=\"https://hackage.haskell.org/package/aeson-1.2.2.0\" rel=\"nofollow noreferrer\"><code>aeson</code></a> package using <a href=\"https://hackage.haskell.org/package/aeson-1.2.2.0/docs/Data-Aeson.html#v:decode\" rel=\"nofollow noreferrer\"><code>decode</code></a>, and then flip the rows and columns of the 2D list with <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Data-List.html#v:transpose\" rel=\"nofollow noreferrer\"><code>transpose</code></a>.</p>\n\n<pre><code>import Data.Aeson (decode)\nimport Data.String (fromString)\nimport Data.List (transpose)\n\nparseFloats :: String -&gt; Maybe [[Float]]\nparseFloats = fmap transpose . decode . fromString\n</code></pre>\n"}], "owner": {"reputation": 825, "user_id": 962828, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/78c370f00a14fb3bd59dc334082378cd?s=128&d=identicon&r=PG", "display_name": "Ulrar", "link": "https://stackoverflow.com/users/962828/ulrar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506615153, "creation_date": 1506605586, "last_edit_date": 1506609903, "question_id": 46470480, "link": "https://stackoverflow.com/questions/46470480/convert-a-list-of-tuples-to-multiple-lists", "title": "Convert a list of tuples to multiple lists", "body": "<p>I'm looking for a way to parse some JSON into something usable.\nI'm getting what's basically a list of X-tuple, for example with three values :</p>\n\n<pre><code>[\n  [1, 323, 985],\n  [98, 21234, 46135]\n]\n</code></pre>\n\n<p>Now I'd like to parse that JSON and convert it to a list of lists. I'm okay with the type being always the same, so I think Float or Double would be the ideal since it should allow to hold any numerical value. Something like [[Float]] would be perfect. In this example that would be :</p>\n\n<pre><code>[[1.0, 98.0], [323.0, 21234.0], [985.0, 46135.0]]\n</code></pre>\n\n<p>This would be easy enough if I knew how many values would be in the document, but I don't, I only know they'll be number (either Int or Float). Is there a way to iterate over the fields of a tuple like you'd map over a list ? I realise that's not what a tuple is supposed to be for, but I have no control over what generates the json, and I'd really like to avoid writing by hand functions for 2-tuples, 3-tuples, 4-tuples ..</p>\n\n<p>Thanks</p>\n\n<p>EDIT : Seems like I'm looking for a generic version of unzip, that would work on any size</p>\n"}, {"tags": ["list", "haskell", "tuples", "list-comprehension"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 6, "last_activity_date": 1506670170, "last_edit_date": 1506670170, "creation_date": 1506605804, "answer_id": 46470565, "question_id": 46470375, "link": "https://stackoverflow.com/questions/46470375/organize-the-sequence-of-tuple-in-a-haskell-list-comprehension/46470565#46470565", "title": "Organize the sequence of tuple in a Haskell List comprehension", "body": "<p>The <em>order</em> of the <code>x &lt;- list</code> statements in list comprehension is important. If you write:</p>\n\n<pre><code>[expr | x &lt;- list1, y &lt;- list2]\n</code></pre>\n\n<p>this is equivalent to a nested for loop with <code>y</code> being the inner loop. So a Python equivalent with loops would be:</p>\n\n<pre><code>for x in list1:\n    for y in list2:\n        expr\n</code></pre>\n\n<p>and thus the inner loop is entirely exhausted before the outer loop picks the next value.</p>\n\n<p>So we need to reorder the statements such that we first pick <code>d</code>, then <code>b</code>, then <code>c</code> and finally <code>a</code>. So that means that we turn:</p>\n\n<pre><code>[(a,b,c,d)| a &lt;- [0,50..200], b &lt;- \"abc\", c &lt;- [True,False], d &lt;-\"AB\"]\n</code></pre>\n\n<p>(I made the lists shorter in notation)</p>\n\n<p>into:</p>\n\n<pre><code>-- [(a,b,c,d)| a &lt;- [0,50..200], b &lt;- \"abc\", c &lt;- [True,False], d &lt;-\"AB\"]\n--             |                  \\_________/_____              |\n--             |                   ________/      \\             |\n--             |                  /                \\            |\n   [(a,b,c,d)| a &lt;- [0,50..200], c &lt;- [True,False], b &lt;- \"abc\", d &lt;- \"AB\"]\n</code></pre>\n\n<p>(the comment is only to visualize the difference)</p>\n\n<p>which generates:</p>\n\n<pre><code>Prelude&gt; [(a,b,c,d)| a &lt;- [0,50..200], c &lt;- [True,False], b &lt;- \"abc\", d &lt;- \"AB\"]\n[(0,'a',True,'A'),\n (0,'a',True,'B'),\n (0,'b',True,'A'),\n (0,'b',True,'B'),\n (0,'c',True,'A'),\n (0,'c',True,'B'),\n (0,'a',False,'A'),\n (0,'a',False,'B'),\n (0,'b',False,'A'),\n (0,'b',False,'B'),\n (0,'c',False,'A'),\n (0,'c',False,'B'),\n (50,'a',True,'A'),\n (50,'a',True,'B'),\n (50,'b',True,'A'),\n (50,'b',True,'B'),\n (50,'c',True,'A'),\n (50,'c',True,'B'),\n (50,'a',False,'A'),\n (50,'a',False,'B'),\n (50,'b',False,'A'),\n (50,'b',False,'B'),\n (50,'c',False,'A'),\n (50,'c',False,'B'),\n (100,'a',True,'A'),\n (100,'a',True,'B'),\n (100,'b',True,'A'),\n (100,'b',True,'B'),\n (100,'c',True,'A'),\n (100,'c',True,'B'),\n (100,'a',False,'A'),\n (100,'a',False,'B'),\n (100,'b',False,'A'),\n (100,'b',False,'B'),\n (100,'c',False,'A'),\n (100,'c',False,'B'),\n (150,'a',True,'A'),\n (150,'a',True,'B'),\n (150,'b',True,'A'),\n (150,'b',True,'B'),\n (150,'c',True,'A'),\n (150,'c',True,'B'),\n (150,'a',False,'A'),\n (150,'a',False,'B'),\n (150,'b',False,'A'),\n (150,'b',False,'B'),\n (150,'c',False,'A'),\n (150,'c',False,'B'),\n (200,'a',True,'A'),\n (200,'a',True,'B'),\n (200,'b',True,'A'),\n (200,'b',True,'B'),\n (200,'c',True,'A'),\n (200,'c',True,'B'),\n (200,'a',False,'A'),\n (200,'a',False,'B'),\n (200,'b',False,'A'),\n (200,'b',False,'B'),\n (200,'c',False,'A'),\n (200,'c',False,'B')]\n</code></pre>\n\n<p>(new lines added to make it easier to verify)</p>\n"}], "owner": {"reputation": 103, "user_id": 8004182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nxpOa.jpg?s=128&g=1", "display_name": "Mostafa_M", "link": "https://stackoverflow.com/users/8004182/mostafa-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1506670170, "creation_date": 1506605238, "last_edit_date": 1506613524, "question_id": 46470375, "link": "https://stackoverflow.com/questions/46470375/organize-the-sequence-of-tuple-in-a-haskell-list-comprehension", "title": "Organize the sequence of tuple in a Haskell List comprehension", "body": "<p>Hello dear Community, </p>\n\n<p>I'm trying organize the sequence of tuple in a Haskell List comprehension.</p>\n\n<p>e.g. I got the following List Comprehension:</p>\n\n<pre><code>[ (a,b,c,d) | a &lt;- [0, 50, 100, 150, 200]\n            , b &lt;- ['a', 'b', 'c']\n            , c &lt;- [True, False]\n            , d &lt;- ['A', 'B']\n            ]\n</code></pre>\n\n<p>and get:</p>\n\n<pre><code>[ (0, 'a', True, 'A'), (0, 'a', True, 'B'), (0, 'a', False, 'A')\n, (0, 'a', False, 'B'), (0, 'b', True, 'A'), (0, 'b', True, 'B')\n, (0, 'b', False, 'A'), (0, 'b', False, 'B'), (0, 'c', True, 'A')\n,(0, 'c', True, 'B'), (0, 'c', False, 'A')..\n</code></pre>\n\n<p>Now I want the sequence like following:</p>\n\n<pre><code>[ (0, 'a', True, 'A'), (0, 'a', True, 'B'), (0, 'b', True, 'A')\n, (0, 'b', True, 'B'), (0, 'c' ,True, 'A'), (0, 'c', True, 'B')\n, (0, 'a', False, 'A'), (0, 'a', False, 'B')..\n</code></pre>\n\n<p>That means: \nFirst a trade off between the capital letters <code>'A'</code> &amp; <code>'B'</code>, then a trade off between the small letters <code>'a'</code>,<code>'b'</code>,<code>'c'</code>, as a penultimate the trade off between the boolean values <code>True</code>, <code>False</code> and finaly the numbers. </p>\n\n<p>Unfortunately I have absolutely no idea how to realize these and i want to know how you can manipulate the sequence of a list with tuple <code>[(a,b,c)]</code>.</p>\n"}, {"tags": ["list", "function", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1506604597, "post_id": 46470096, "comment_id": 79895307, "body": "How would you find the maximum of a list of unrelated numbers without checking every number? There are only two options: (a) either the numbers have some correlation you can exploit; or (b) you can perhaps use an array since this usually is faster to traverse. But in case of (b), it will still take <i>O(n)</i> time."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 7, "creation_date": 1506604657, "post_id": 46470096, "comment_id": 79895346, "body": "How are you generating the list?"}, {"owner": {"reputation": 13772, "user_id": 379311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c993f4f111e6ff3211ccda1b98828253?s=128&d=identicon&r=PG", "display_name": "Yann Vernier", "link": "https://stackoverflow.com/users/379311/yann-vernier"}, "edited": false, "score": 1, "creation_date": 1506606523, "post_id": 46470096, "comment_id": 79896752, "body": "A maximum is a commutative reduction, so you could distribute the job, if you have suitable parallel nodes to work on. But that assumes your huge set of data is already available to be chunked up; if it&#39;s just a list you&#39;re generating lazily then it is still faster to simply consume it. <a href=\"https://stackoverflow.com/questions/4028210/how-do-i-write-a-parallel-reduction-using-strategies-in-haskell\" title=\"how do i write a parallel reduction using strategies in haskell\">stackoverflow.com/questions/4028210/&hellip;</a> might have some clues."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1506613098, "post_id": 46470096, "comment_id": 79901308, "body": "Being associative is enough for the job to be cut up and solved in parallel. No need for commutativity."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 2, "creation_date": 1506621472, "post_id": 46470096, "comment_id": 79906077, "body": "I think you are likely to get a more helpful answer more quickly if you edit your question to include additional detail.  Several comments you made (to an answer that has now been deleted) suggested that the list was in a large text file, and you needed to perform multiple maximum/minimum calculations over various groupings, but none of this information is in the original question.  It would be helpful to see examples of what the records in your file look like and the kinds of &quot;groupings&quot; you are attempting to find mins/maxes for."}, {"owner": {"reputation": 179, "user_id": 8526423, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b3704e90f096e08359ec2b9e26a2fa1?s=128&d=identicon&r=PG&f=1", "display_name": "Sir DK", "link": "https://stackoverflow.com/users/8526423/sir-dk"}, "edited": false, "score": 0, "creation_date": 1506672097, "post_id": 46470096, "comment_id": 79923065, "body": "The question asked just a small part from a bigger work that I&#39;m working with. The reason I do not explain where this ASCII file comes from, groupings and etc. because I think its not necessary. Let say you have a plain list <code>xs = [1..100000000]</code> and we use <code>maximum xs</code> or <code>minimum xs</code>, it will take some time to get the result. I&#39;m just looking if there is a faster way than using those functions."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1506755989, "post_id": 46470096, "comment_id": 79955233, "body": "@SirDK Nope.  Have you compiled with optimization though <code>ghc -O</code>?  That can make a huge difference."}, {"owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 1, "creation_date": 1507016024, "post_id": 46470096, "comment_id": 80032932, "body": "Without further knowledge about the &quot;structure&quot; of the list, there is no way to get around the <code>O(n)</code> complexity of the problem."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8174234"}, "is_accepted": false, "score": 1, "last_activity_date": 1507015206, "creation_date": 1507015206, "answer_id": 46539144, "question_id": 46470096, "link": "https://stackoverflow.com/questions/46470096/haskell-slower-function-as-list-getting-bigger/46539144#46539144", "title": "Haskell :: Slower Function as List Getting Bigger", "body": "<blockquote>\n  <p>I know that this function need to process the entire list to reach its goal and this obviously gets slower as the list gets bigger. </p>\n</blockquote>\n\n<p>Finding a maximum is <code>O(n)</code> in Haskell (and presumably every other language as well). Unless you have some concrete benchmarks and code this seems totally expected. </p>\n"}, {"comments": [{"owner": {"reputation": 13772, "user_id": 379311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c993f4f111e6ff3211ccda1b98828253?s=128&d=identicon&r=PG", "display_name": "Yann Vernier", "link": "https://stackoverflow.com/users/379311/yann-vernier"}, "edited": false, "score": 0, "creation_date": 1514729681, "post_id": 46542239, "comment_id": 83057080, "body": "Haskell&#39;s lists are lisp-style, behaving as possibly infinite singly linked lists. <code>last</code> may be O(n). Extracting the last element of an array is O(1)."}], "tags": [], "owner": {"reputation": 412, "user_id": 6593641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xVNVQ.jpg?s=128&g=1", "display_name": "madnight", "link": "https://stackoverflow.com/users/6593641/madnight"}, "is_accepted": false, "score": 0, "last_activity_date": 1507025747, "creation_date": 1507025747, "answer_id": 46542239, "question_id": 46470096, "link": "https://stackoverflow.com/questions/46470096/haskell-slower-function-as-list-getting-bigger/46542239#46542239", "title": "Haskell :: Slower Function as List Getting Bigger", "body": "<p>Since you need to \"look\" at each value and pick the highest <code>O(n)</code> is the best solution (without any other information that could be used). If you have to perform the function multiple times, then you might want to sort your list (ascending or descending) and use the function <code>head</code> or <code>last</code>, that have a time complexity of <code>O(1)</code>, while haskells <code>sort</code> is a mergesort with <code>O(n log n)</code> worst-case and average-case performance.</p>\n"}], "owner": {"reputation": 179, "user_id": 8526423, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b3704e90f096e08359ec2b9e26a2fa1?s=128&d=identicon&r=PG&f=1", "display_name": "Sir DK", "link": "https://stackoverflow.com/users/8526423/sir-dk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1507025747, "creation_date": 1506604403, "question_id": 46470096, "link": "https://stackoverflow.com/questions/46470096/haskell-slower-function-as-list-getting-bigger", "title": "Haskell :: Slower Function as List Getting Bigger", "body": "<p>I'm working with finding a maximum value of a list (by using <code>maximum</code>) and I know that this function need to process the entire list to reach its goal and this obviously gets slower as the list gets bigger. Unfortunately, my list is huge (hundreds of million).</p>\n\n<p>Is this the only way? Or there are faster ways to do this? I found that Haskell is fast but at this point (getting slower), I'm wondering is there any other option to find the <code>maximum</code>. </p>\n"}, {"tags": ["haskell", "cabal", "nix"], "owner": {"reputation": 799, "user_id": 1964881, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/bVDPU.png?s=128&g=1", "display_name": "Gspia", "link": "https://stackoverflow.com/users/1964881/gspia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 216, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1506747943, "creation_date": 1506603651, "last_edit_date": 1506747943, "question_id": 46469848, "link": "https://stackoverflow.com/questions/46469848/two-cabal-packages-in-a-cabal-project-and-nix-building-both-a-lib-and-its-examp", "title": "Two cabal packages in a cabal.project and nix-building both (a lib and its example prgs)", "body": "<p>I have a haskell lib X having the following file-structure:</p>\n\n<pre><code>X/src/libxfiles.hs\nX/default.nix\nX/shell.nix\nX/libx.nix\nX/libx.cabal\nX/cabal.project\n</code></pre>\n\n<p>and</p>\n\n<pre><code>X/example/lib/exampleCommon.hs\nX/example/ex1/main.hs\nX/example/ex2/main.hs\nX/example/example.cabal\n</code></pre>\n\n<p>cabal.project points to libx.cabal and to example/example.cabal and <code>cabal new-build all</code> works inside nix-shell. The required haskell packages for libx library and example-programs are introduced in the libx.nix -file.</p>\n\n<p>Why this structure? Since the example programs have 99% common code and only a couple of lines that are ui-dependend (webkit2gtk and such). Earlier version had flags and CPP inside the main of example and <code>nix-build</code> produced the lib and example prg in result-directory. On this new setup, the <code>cabal new-build</code>  works ok when the compiler is ghc and my aim is to produce programs with ghc.</p>\n\n<p>Earlier <code>nix-build</code> build the lib and one of its example programs with ghcjs. \nAt the moment, <code>nix-build</code> makes only the lib. Is it somehow possible to tell in the libx.nix or in the default.nix to also build one of the example-programs, say ex1? That is, to tell for the build process to <code>cabal new-build ex1</code> and then install the result just like it installs the lib. </p>\n\n<p>To  use ghcjs, to build the ex1 that is targeted to ghcjs, it is possible to <code>nix-shell --argstr \"compiler\" \"ghcjs\"</code> and then <code>cabal new-configure --ghcjs</code> etc. (So, outside nix-shell, the nix-build -command is not doing all I'd like it do.)</p>\n\n<p>Is it required to make a nix-files into the example-directory? Somehow this does not sound that appealing as the required modules are already given in libx.nix. That is, should I do something like in the answer to <a href=\"https://stackoverflow.com/questions/27968909/how-to-get-cabal-and-nix-work-together\">how to get cabal and nix work together</a>?</p>\n\n<p>Or is there a haskell package in github having similar structure that could work as an example?  </p>\n\n<p>Ideal solution would be that <code>nix-build</code> would build the lib and all its example programs. That would require the use of different building tools (ghc and ghcjs). Thus, maybe the question is, how to make a nix-setup for a multipackage cabal-project where individual packages need different environments including the compilation tools. On ideal world, the default nix-build would build all, and user could parameterize the nix-build to build the chosen example or examples etc. </p>\n\n<p>It appears that the discussions in\n<a href=\"https://github.com/haskell/cabal/issues/4646\" rel=\"nofollow noreferrer\">cabal issue 4646</a> and in <a href=\"https://github.com/NixOS/cabal2nix/issues/286\" rel=\"nofollow noreferrer\">cabal2nix issue 286</a> are possibly related.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "Peter Kiss"}, "edited": false, "score": 0, "creation_date": 1506608334, "post_id": 46471598, "comment_id": 79898281, "body": "Thank you, its working fine. I am sorry for getting stuck on this :P"}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 4, "last_activity_date": 1506604804, "creation_date": 1506604804, "answer_id": 46471598, "question_id": 46471597, "link": "https://stackoverflow.com/questions/46471597/haskell-coding-issue/46471598#46471598", "title": "Haskell coding issue", "body": "<p>You've defined <code>Layer</code> twice, as two different things:</p>\n\n<ul>\n<li>As a <em>data constructor</em> (in <code>data Network = Layer | None</code>)</li>\n<li>As a <em>type alias</em> (in <code>type Layer = (Matrix,Vector,Network)</code>)</li>\n</ul>\n\n<p>Those are not the same.</p>\n\n<p>In the second line in <code>createNetwork</code>, you return a triad (a 3-tuple). While it's equivalent to the type alias <code>Layer</code>, it's not a <code>Network</code>.</p>\n\n<p>You should probably change your type definitions to something like this:</p>\n\n<pre><code>data Network = L Layer | None\n\ntype Layer = (Matrix,Vector,Network)\n</code></pre>\n\n<p>Then you should be able to write something like:</p>\n\n<pre><code>createNetwork :: [Matrix] -&gt; [Vector] -&gt; Network\ncreateNetwork [] _ = None\ncreateNetwork (x:xs) (y:ys) = L (x,y,(createNetwork xs ys))\n</code></pre>\n\n<p>I'm not nearby a Haskell compiler right now, so I can't check, but let me know if that doesn't work, and I'll see what I can do.</p>\n"}], "migrated_from": {"other_site": {"aliases": ["http://computerscience.stackexchange.com"], "markdown_extensions": ["MathJax", "Prettify"], "launch_date": 1439905020, "open_beta_date": 1332272936, "closed_beta_date": 1331060400, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/cs/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/cs/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/cs/Img/apple-touch-icon.png", "audience": "students, researchers and practitioners of computer science", "site_url": "https://cs.stackexchange.com", "api_site_parameter": "cs", "logo_url": "https://cdn.sstatic.net/Sites/cs/Img/logo.png", "name": "Computer Science", "site_type": "main_site"}, "on_date": 1506608717, "question_id": 81816}, "owner": {"user_type": "does_not_exist", "display_name": "Peter Kiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 46471598, "answer_count": 1, "score": 0, "last_activity_date": 1506608717, "creation_date": 1506601185, "question_id": 46471597, "link": "https://stackoverflow.com/questions/46471597/haskell-coding-issue", "title": "Haskell coding issue", "body": "<pre><code>type Matrix = [[Rational]]\n\ntype Vector = [Rational]\n\ndata Network = Layer | None\n\ntype Layer = (Matrix,Vector,Network)\n\ncreateNetwork :: [Matrix] -&gt; [Vector] -&gt; Network\ncreateNetwork [] _ = None\ncreateNetwork (x:xs) (y:ys) = (x,y,(createNetwork xs ys))\n</code></pre>\n\n<p>I dont understand why does this code returns the following error, since a layer is exactly fitting for a Network. It doesn't compile even if i define Network as \nMatrix Vector Network | None</p>\n\n<p>This is the error : </p>\n\n<pre><code>neuro.lhs:17:33: error:\n    * Couldn't match expected type `Network'\n                  with actual type `(Matrix, Vector, Network)'\n    * In the expression: (x, y, (createNetwork xs ys))\n      In an equation for `createNetwork':\n          createNetwork (x : xs) (y : ys) = (x, y, (createNetwork xs ys))\n   |\n17 | &gt; createNetwork (x:xs) (y:ys) = (x,y,(createNetwork xs ys))\n   |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n"}, {"tags": ["r", "haskell", "dll"], "comments": [{"owner": {"reputation": 1250, "user_id": 5169659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5d1ed1be45a5d044e4685ea367bb3e4?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Stanley", "link": "https://stackoverflow.com/users/5169659/mike-stanley"}, "edited": false, "score": 1, "creation_date": 1506600591, "post_id": 46468587, "comment_id": 79892346, "body": "I don&#39;t think this question is answerable with the information you&#39;ve provided. It will relate to some interaction between R and your code (or just your code in general), and you didn&#39;t provide your code."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 1250, "user_id": 5169659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5d1ed1be45a5d044e4685ea367bb3e4?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Stanley", "link": "https://stackoverflow.com/users/5169659/mike-stanley"}, "edited": false, "score": 0, "creation_date": 1506600727, "post_id": 46468587, "comment_id": 79892445, "body": "@MikeStanley That&#39;s possible but the code is huge. Moreover it intensively uses the <code>inline-r</code> library and almost nobody uses this library. It also calls some C functions with the FFI... I understand your remark but maybe someone could have an idea of the cause."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1506600750, "post_id": 46468587, "comment_id": 79892458, "body": "Perhaps you should increase <code>times=2</code> if the results are too variable. Further, the performance issue might be on the Haskell side: are you sure there is no difference between the two Haskell functions, except for the fact that one uses fixed arguments? Try to explicitly let <code>foo2 = foo1 fixedArg1 fixedArg2</code> and see if that matters."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1506600918, "post_id": 46468587, "comment_id": 79892595, "body": "@chi Yes I&#39;m sure. Look at my edit, I have included this piece of the code."}], "answers": [{"comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1506602144, "post_id": 46469046, "comment_id": 79893450, "body": "Aaahh that explains why <code>readXLSXbig</code> <i>is slow the first time I call it</i>. I have a version without <code>unsafe</code> but it is slow like <code>readXLSX</code>."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 3, "creation_date": 1506602860, "post_id": 46469046, "comment_id": 79893966, "body": "So finally the slowness is the true timing :-( Thanks you @chi, now I better understand <code>unsafePerformIO</code>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1506603128, "last_edit_date": 1506603128, "creation_date": 1506601301, "answer_id": 46469046, "question_id": 46468587, "link": "https://stackoverflow.com/questions/46468587/why-this-slowness-of-call-in-r/46469046#46469046", "title": "Why this slowness of .Call in R?", "body": "<p>TL;DR: <code>unsafe</code> stuff is <code>unsafe</code>.</p>\n\n<p>This code</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>readXLSXbig :: SEXP V 'R.Vector\nreadXLSXbig = unsafePerformIO $ do ...\n</code></pre>\n\n<p>declares a <em>constant</em> expression, which will most likely be evaluated only once in the whole program. Each subsequent call after the first one can either re-execute the <code>do ...</code> action, or return the previously computed value without re-executing anything.</p>\n\n<p>Essentially, GHC is caching your whole spreadsheet.</p>\n\n<p><code>unsafePerformIO action</code> tells the compiler that we don't care about when <code>action</code> is run, or how many times it is run, since the IO <code>action</code> will never perform important side effects, and will always return the same result. We are telling the compiler \"I know that this is potentially unsafe, but do it anyway -- I'll take the responsibility\".</p>\n\n<p>As an ugly, ugly fix, you can add a dummy argument and pray that GHC does not cache previous results.</p>\n\n<p>The actual fix would be to remove the <code>unsafe</code> stuff, and return a proper <code>IO (...)</code> type. In this way we do not <em>lie</em> to the compiler, which will do the right thing. The FFI machinery should still make that callable from R.</p>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 46469046, "answer_count": 1, "score": 1, "last_activity_date": 1506603128, "creation_date": 1506599961, "last_edit_date": 1506600885, "question_id": 46468587, "link": "https://stackoverflow.com/questions/46468587/why-this-slowness-of-call-in-r", "title": "Why this slowness of .Call in R?", "body": "<p>I have created a DLL with Haskell. It exports two functions:</p>\n\n<ul>\n<li><p><code>readXLSX</code>: takes as arguments a xlsx file name, a sheet name, and returns the contents of the sheet in a R list</p></li>\n<li><p><code>readXLSXbig</code>: no argument, this is the same function as <code>readXLSX</code> but it always read the sheet named <code>Sheet 1</code> of a file named <code>big.xlsx</code> </p></li>\n</ul>\n\n<p>First, let's try <code>readXLSX</code> on a small file:</p>\n\n<pre><code>&gt; library(readxl)\n&gt; library(microbenchmark)\n&gt; microbenchmark(\n+   readxl = read_xlsx(\"example.xlsx\", \"Sheet1\", col_types=\"list\", col_names=FALSE),\n+   haskell = .Call(\"readXLSX\", \"example.xlsx\", \"Sheet1\"),\n+   times=2\n+ )\nUnit: milliseconds\n    expr      min       lq     mean   median        uq       max neval cld\n  readxl 9.294365 9.294365 9.660375 9.660375 10.026385 10.026385     2   b\n haskell 2.164942 2.164942 2.593681 2.593681  3.022419  3.022419     2  a \n</code></pre>\n\n<p>Well, it is faster than <code>readxl</code> (not surprising because <code>readxl</code> provides more features, and tests for the existence of the file, etc).</p>\n\n<p>Now, let's try on the file <code>big.xlsx</code>, which is bigger:</p>\n\n<pre><code>&gt; microbenchmark(\n+   readxl = read_xlsx(\"big.xlsx\", \"Sheet 1\", col_types=\"list\", col_names=FALSE),\n+   H1 = .Call(\"readXLSXbig\"),\n+   H2 = .Call(\"readXLSX\", \"big.xlsx\", \"Sheet 1\"), \n+   times=2\n+ )\nUnit: milliseconds\n   expr        min         lq       mean     median        uq       max neval cld\n readxl  143.74213  143.74213  144.05025  144.05025  144.3584  144.3584     2  a \n     H1   33.38596   33.38596   68.60333   68.60333  103.8207  103.8207     2  a \n     H2 8845.17038 8845.17038 9149.19542 9149.19542 9453.2205 9453.2205     2   b\n</code></pre>\n\n<p>In fact, the results of this benchmark are quite variable (I don't know why) but I always observe the same behaviour: <code>readXLSXbig</code> is faster than <code>readxl</code> and <code>readXLSX</code> is very slower.</p>\n\n<p>Let me recall that <code>readXLSXbig</code> does exactly the same thing as <code>readXLSX</code>; the only difference is that the file name <code>big.xlsx</code> and the sheet name <code>Sheet 1</code> are already given in <code>readXLSXbig</code>:</p>\n\n<pre><code>readXLSXbig :: SEXP V 'R.Vector\nreadXLSXbig = unsafePerformIO $ do \n  fcellmap &lt;- xlsxSheetToFormattedCellMap \"big.xlsx\" \"Sheet 1\"\n  formattedCellMapToRList fcellmap fcellToCellValue 0\n\nreadXLSX :: SEXP s 'R.String -&gt; SEXP s 'R.String -&gt; SEXP V 'R.Vector\nreadXLSX file sheet = unsafePerformIO $ do \n  fcellmap &lt;- xlsxSheetToFormattedCellMap (fromSEXP file) (fromSEXP sheet)\n  formattedCellMapToRList fcellmap fcellToCellValue 0\n</code></pre>\n\n<p>Why such a difference ? <code>readXLSX</code> takes ~9 seconds on the big file while <code>readXLSXbig</code> takes only ~70 milliseconds. On the small file <code>example.xlsx</code>, we have seen that <code>readXLSX</code> takes &lt;3 milliseconds, therefore there are not 9 seconds wasted to read the file name and the sheet name.</p>\n"}, {"tags": ["haskell", "llvm", "ghc", "llvm-ir"], "answers": [{"comments": [{"owner": {"reputation": 411, "user_id": 7235699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/x7sjr.jpg?s=128&g=1", "display_name": "user7235699", "link": "https://stackoverflow.com/users/7235699/user7235699"}, "edited": false, "score": 0, "creation_date": 1506666311, "post_id": 46475029, "comment_id": 79920191, "body": "I am getting a segmentation fault when I run the hello file (I have tried it many times). Which version of ghc and llvm you are using?"}, {"owner": {"reputation": 411, "user_id": 7235699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/x7sjr.jpg?s=128&g=1", "display_name": "user7235699", "link": "https://stackoverflow.com/users/7235699/user7235699"}, "edited": false, "score": 0, "creation_date": 1506666501, "post_id": 46475029, "comment_id": 79920264, "body": "Also why I am getting &quot; &#39;main&#39; function not found in module&quot; error when I try to run &quot;lli hello.bc&quot;. Is something missing in my .bc file?"}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 2, "last_activity_date": 1506619453, "creation_date": 1506619453, "answer_id": 46475029, "question_id": 46465081, "link": "https://stackoverflow.com/questions/46465081/error-in-compiling-haskell-ll-file-with-llvm-backend/46475029#46475029", "title": "Error in Compiling haskell .ll file with llvm backend", "body": "<p>The <code>llc</code> program doesn't create executables.  It compiles LLVM bytecode to native assembly source (by default) or an object file.  If you run:</p>\n\n<pre><code>llc hello.bc -o hello\n</code></pre>\n\n<p>and then inspect the resulting \"hello\" file with a text editor, you'll see that it's an Intel assembly file, and the syntax errors you're getting are because you're trying to run it as a shell script.</p>\n\n<p>Instead, you can compile the LLVM bytecode directly to an object file:</p>\n\n<pre><code>llc hello.bc -filetype=obj -o hello.o\n</code></pre>\n\n<p>and then try to link it into an executable:</p>\n\n<pre><code>ld hello.o -o hello\n</code></pre>\n\n<p>This will generate a bunch of linkage errors because it needs to be linked with the Haskell runtime.  It turns out that the best way to link in the Haskell runtime is to use <code>ghc</code> itself to do the linking:</p>\n\n<pre><code>ghc hello.o -o hello\n</code></pre>\n\n<p>Note that this command does <em>not</em> actually recompile the Haskell source.  It just does the linking.  If you want to see the linkage commands it runs, use:</p>\n\n<pre><code>ghc -v hello.o -o hello\n</code></pre>\n\n<p>and you'll understand why it's best to leave the linking to <code>ghc</code>!!</p>\n\n<p>Finally, after all this, you should be able to run \"hello\".  The full set of commands is:</p>\n\n<pre><code>$ ghc -fllvm -keep-llvm-files -fforce-recomp hello.hs                                                           \n[1 of 1] Compiling Main             ( hello.hs, hello.o )                                                       \nLinking hello ...\n$ rm hello                                                                                               \n$ llvm-as hello.ll -o hello.bc                                                                                  \n$ llc hello.bc -filetype=obj -o hello.o                                                                         \n$ ghc hello.o -o hello                                                                                          \n$ ./hello                                                                                                       \nHello, world!  \n$\n</code></pre>\n"}], "owner": {"reputation": 411, "user_id": 7235699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/x7sjr.jpg?s=128&g=1", "display_name": "user7235699", "link": "https://stackoverflow.com/users/7235699/user7235699"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1506619453, "creation_date": 1506589189, "question_id": 46465081, "link": "https://stackoverflow.com/questions/46465081/error-in-compiling-haskell-ll-file-with-llvm-backend", "title": "Error in Compiling haskell .ll file with llvm backend", "body": "<p>I want to compile haskell using ghc front-end and llvm back-end.</p>\n\n<p>I have following code in my haskell hello.hs file:</p>\n\n<pre><code>main = putStrLn \"Hello World!\"\n</code></pre>\n\n<p>I compile hello.hs with ghc using following command</p>\n\n<pre><code>ghc -fllvm -keep-llvm-files -force-recomp -hello.hs\n</code></pre>\n\n<p>which generate a hello.ll file along with other files.\nI then try to compile this .ll file into a .bc file.</p>\n\n<pre><code>llvm-as hello.ll -o hello.bc\n</code></pre>\n\n<p>and then this .bc file to executable file </p>\n\n<pre><code>llc hello.bc -o hello\n</code></pre>\n\n<p>which generate an executable file. The problem is when I run this file I found the following error</p>\n\n<pre><code>./hello: line 1: .file: command not found\n./hello: line 2: .section: command not found\n./hello: line 3: .globl: command not found\n./hello: line 4: .align: command not found\n./hello: line 5: .type: command not found\n./hello: line 6: Main_main2_info:: command not found\n./hello: line 8: subq: command not found\n./hello: line 9: syntax error near unexpected token `('\n./hello: line 9: `                 movq                                                                      \n%r13, 112(%rsp)'\n</code></pre>\n\n<p>and when I use lli on .bc file I get</p>\n\n<pre><code>main function not found in module error\n</code></pre>\n\n<p>I am running ghc and llvm on docker. I have version 3.4 of llvm and version 7.6.3 of ghc.</p>\n\n<p>A \"similar\" error occur when I try to to do this on mac. I don't know why I am getting this error.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1506588629, "post_id": 46464897, "comment_id": 79884567, "body": "Please post the full code fragment."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1506588749, "post_id": 46464897, "comment_id": 79884652, "body": "Furthermore this does work in ghci. It simply constructs a function <code>(&amp;)</code>."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1506588975, "post_id": 46464897, "comment_id": 79884795, "body": "I agree with Willem; maybe you forgot a <code>let</code>? <code>let m &amp; n = n m</code>, then <code>5 &amp; (+1)</code> prints 6 as expected."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1506649788, "post_id": 46464897, "comment_id": 79916140, "body": "Someone gave me a formula <code>blah m n = n m</code>. What does <code>blah</code> mean? Answer: It means exactly what is defined by the formula!"}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 6, "creation_date": 1506590423, "post_id": 46464951, "comment_id": 79885808, "body": "BTW (and as Hayoo makes clear), this use of <code>&amp;</code> is actually defined <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Function.html#v:-38-\" rel=\"nofollow noreferrer\">in in the <code>base</code> package, in <code>Data.Function</code></a>. I regularly use this operator even in projects that don&#39;t have any lenses at all."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1506590955, "post_id": 46464951, "comment_id": 79886184, "body": "@leftaroundabout Oh, since 7.10.1. I never noticed :)"}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 6, "last_activity_date": 1506588749, "creation_date": 1506588749, "answer_id": 46464951, "question_id": 46464897, "link": "https://stackoverflow.com/questions/46464897/what-does-mean-in-haskell/46464951#46464951", "title": "What does &quot;&amp;&quot; mean in haskell?", "body": "<p>It's an identifier without any special meaning, so it means whatever you want it to. E.g. in Lens <code>&amp;</code> is used as <code>flip ($)</code> for convenience, like so:</p>\n\n<pre><code>let x = (1,2)\n  &amp; _1 +~ 1\n  &amp; _2 +~ 2\n\n-- x = (2,4)\n</code></pre>\n\n<p>This also fits your definition of <code>m &amp; n = n m</code> (they're equivalent). Any other library can use it for whatever, and if you <a href=\"https://hayoo.fh-wedel.de/?query=%26\" rel=\"noreferrer\">use a better search engine</a>, you'll find numerous ones.</p>\n"}, {"tags": [], "owner": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "is_accepted": true, "score": 1, "last_activity_date": 1506637806, "creation_date": 1506637806, "answer_id": 46479189, "question_id": 46464897, "link": "https://stackoverflow.com/questions/46464897/what-does-mean-in-haskell/46479189#46479189", "title": "What does &quot;&amp;&quot; mean in haskell?", "body": "<p>(&amp;) operator is defined in Data.Function package. To use it in ghci you have to <code>import Data.Function</code></p>\n\n<p>Then you can use it with the meaning given by the formula you posted.</p>\n\n<pre><code>&gt; pi &amp; cos\n-1.0\n</code></pre>\n\n<p>Same as:</p>\n\n<pre><code>&gt; cos pi\n-1.0\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 8688301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93fe99d15661f583d9f05d5ae589d3ee?s=128&d=identicon&r=PG&f=1", "display_name": "YYGX", "link": "https://stackoverflow.com/users/8688301/yygx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 46479189, "answer_count": 2, "score": 3, "last_activity_date": 1506637806, "creation_date": 1506588571, "question_id": 46464897, "link": "https://stackoverflow.com/questions/46464897/what-does-mean-in-haskell", "title": "What does &quot;&amp;&quot; mean in haskell?", "body": "<p>I am new to haskell.\nSomebody gave me a symbol and a formula:\nm &amp; n = n m\nBut \"&amp;\" can't be read by ghci,and we searched the Internet and found no information.\nCould anyone tell me what the &amp; means?</p>\n"}]