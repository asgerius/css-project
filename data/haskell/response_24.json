[{"tags": ["haskell", "matrix", "linear-algebra", "hmatrix"], "comments": [{"owner": {"reputation": 12923, "user_id": 1530508, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fG8z0.png?s=128&g=1", "display_name": "ApproachingDarknessFish", "link": "https://stackoverflow.com/users/1530508/approachingdarknessfish"}, "edited": false, "score": 1, "creation_date": 1435189179, "post_id": 31038827, "comment_id": 50101634, "body": "I don&#39;t know how to solve your main problem, but regarding your last point: the second 3 is inferred from the length of the list. Given a Rx3 matrix with 9 elements, R must equal 3. <code>(&gt;&lt;)</code> will truncate lists to produce matrices of the desired dimension, so <code>(2 &gt;&lt; 2) [1..]</code> evaluates to <code>(2 &gt;&lt; 2) [1,1,1,1]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "edited": false, "score": 0, "creation_date": 1435191781, "post_id": 31039216, "comment_id": 50102271, "body": "are there alternatives for typing \u211d ?"}, {"owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "edited": false, "score": 0, "creation_date": 1435191941, "post_id": 31039216, "comment_id": 50102314, "body": "<code>( 3 &gt;&lt; 3 ) ( [1,2,3,4,5,6,7,8,9 ]:: [Float])  + ( 3 &gt;&lt; 3 ) ([1,2,3,4,5,6,7,8,9 ] :: [Float])</code> seems to work"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "edited": false, "score": 0, "creation_date": 1435191981, "post_id": 31039216, "comment_id": 50102324, "body": "Yeah, my edit. <code>Double</code>, <code>Float</code>, <code>Complex Double</code>, and <code>Complex Float</code> are the ones that should work out of the box."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 4, "last_activity_date": 1435191657, "last_edit_date": 1435191657, "creation_date": 1435191130, "answer_id": 31039216, "question_id": 31038827, "link": "https://stackoverflow.com/questions/31038827/how-to-add-two-matrices-in-haskell/31039216#31039216", "title": "how to add two matrices in haskell", "body": "<p>The problem arises from the difference in type signatures.</p>\n\n<pre><code> matrix :: Int -&gt; [\u211d] -&gt; Matrix \u211d\n (&gt;&lt;) :: Storable a =&gt; Int -&gt; Int -&gt; [a] -&gt; Matrix a\n</code></pre>\n\n<p>So actually <code>matrix 3 [1,2,3,4,5,6,7,8,9 ]</code> has type <code>Matrix \u211d</code> while <code>( 3 &gt;&lt; 3 ) [1,2,3,4,5,6,7,8,9 ]</code> has type <code>(Num a, Foreign.Storable.Storable a) =&gt; Matrix a</code>. Then, the problem is suddenly tractable. Until you specify what <code>a</code> is, you don't know what <code>(+)</code> is, so you can't actually evaluate the sum of the matrix (only produce thunks), hence you can't print it.</p>\n\n<p>A quick fix is to specify the type of your matrix</p>\n\n<pre><code>(3 &gt;&lt; 3) ([1..9] :: [\u211d])  + (3 &gt;&lt; 3) ([1..9] :: [\u211d])\n</code></pre>\n\n<p>which outputs (given the right imports):</p>\n\n<pre><code>(3&gt;&lt;3)\n [  2.0,  4.0,  6.0\n ,  8.0, 10.0, 12.0\n , 14.0, 16.0, 18.0 ]\n</code></pre>\n\n<h3>Some bonus info</h3>\n\n<p>I wanted to do <code>(3 &gt;&lt; 3) ([1..9] :: [Integer]) + (3 &gt;&lt; 3) ([1..9] :: [Integer])</code>, but note that the <code>Num</code> instance of <code>Matrix</code> has <code>(Container Matrix a, Num (Vector a)) =&gt; Num (Matrix a)</code> so we need <code>Vector a</code> to also have a <code>Num</code> instance. However, you can check that <code>Vector Integer</code> does not have a num declaration. Alternatives that work:</p>\n\n<pre><code>Num (Vector Double)  \nNum (Vector Float)   \nNum (Vector (Complex Double))    \nNum (Vector (Complex Float))\n</code></pre>\n"}], "owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1013, "favorite_count": 1, "accepted_answer_id": 31039216, "answer_count": 1, "score": 1, "last_activity_date": 1435191657, "creation_date": 1435188505, "question_id": 31038827, "link": "https://stackoverflow.com/questions/31038827/how-to-add-two-matrices-in-haskell", "title": "how to add two matrices in haskell", "body": "<p>I am trying to use Haskell's Linear Algebra library to compute some eigenvalues, but first I need to try to add matrices first.</p>\n\n<pre><code>import Numeric.LinearAlgebra.Data\nmatrix 3 [1,2,3,4,5,6,7,8,9 ]  + matrix 3 [1,2,3,4,5,6,7,8,9 ] \n\n(3&gt;&lt;3)\n [  2.0,  4.0,  6.0\n ,  8.0, 10.0, 12.0\n , 14.0, 16.0, 18.0 ]\n</code></pre>\n\n<p>However, if I try to represent another way I get error message</p>\n\n<pre><code>( 3 &gt;&lt; 3 ) [1,2,3,4,5,6,7,8,9 ]  + ( 3 &gt;&lt; 3 ) [1,2,3,4,5,6,7,8,9 ] \n\nNo instance for (Element a0) arising from a use of \u2018print\u2019\nThe type variable \u2018a0\u2019 is ambiguous\n</code></pre>\n\n<p>I am not even sure about <code>matrix 3 [1,2,3,4,5,6,7,8,9 ]</code> since I would like to specify that I want a 3 &times; 3 matrix.  Where did the other 3 go?</p>\n"}, {"tags": ["haskell", "cabal", "cabal-install", "c2hs"], "answers": [{"comments": [{"owner": {"reputation": 1237, "user_id": 4521118, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d11ca9b6705ca00f5e59250eda7001b4?s=128&d=identicon&r=PG&f=1", "display_name": "rhaps0dy", "link": "https://stackoverflow.com/users/4521118/rhaps0dy"}, "edited": false, "score": 0, "creation_date": 1435213327, "post_id": 31040704, "comment_id": 50107981, "body": "But isn&#39;t that for exporting the module as if it was a library?"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 1237, "user_id": 4521118, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d11ca9b6705ca00f5e59250eda7001b4?s=128&d=identicon&r=PG&f=1", "display_name": "rhaps0dy", "link": "https://stackoverflow.com/users/4521118/rhaps0dy"}, "edited": false, "score": 1, "creation_date": 1435225823, "post_id": 31040704, "comment_id": 50115576, "body": "No, it&#39;s for telling Cabal about modules which it&#39;s not necessarily able to figure out for itself (which can happen for many valid reasons... not worth diving into here). In this case, Cabal needs to know that it needs to generate the .hs file for GHC."}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 2, "last_activity_date": 1435202770, "creation_date": 1435202770, "answer_id": 31040704, "question_id": 31037692, "link": "https://stackoverflow.com/questions/31037692/cabal-build-with-c2hs-not-finding-chs-module/31040704#31040704", "title": "Cabal build with c2hs not finding .chs module", "body": "<p>You need to add Test to the other-modules field.</p>\n"}], "owner": {"reputation": 1237, "user_id": 4521118, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d11ca9b6705ca00f5e59250eda7001b4?s=128&d=identicon&r=PG&f=1", "display_name": "rhaps0dy", "link": "https://stackoverflow.com/users/4521118/rhaps0dy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 31040704, "answer_count": 1, "score": 1, "last_activity_date": 1435202770, "creation_date": 1435182497, "question_id": 31037692, "link": "https://stackoverflow.com/questions/31037692/cabal-build-with-c2hs-not-finding-chs-module", "title": "Cabal build with c2hs not finding .chs module", "body": "<p>I am trying out c2hs, and wanted to compile a small example of a shared library with Cabal to get started.</p>\n\n<p>I have the following relevant section of the cabal file <code>test.cabal</code>:</p>\n\n<pre><code>executable libtest.so\n  hs-source-dirs:      src\n  main-is:             Dummy.hs\n  other-extensions:    ForeignFunctionInterface\n  build-depends:       base\n  default-language:    Haskell2010\n  ghc-options:         -no-hs-main -threaded\n  build-tools:         c2hs\n</code></pre>\n\n<p>Then the source. <code>src/Dummy.hs</code>:</p>\n\n<pre><code>import Test\n\nmain :: IO ()\nmain = return\n</code></pre>\n\n<p>In the file <code>src/Test.chs</code></p>\n\n<pre><code>{-# LANGUAGE ForeignFunctionInterface #-}\nimport Foreign\nimport Foreign.C\n\nmodule Android where\n</code></pre>\n\n<p>And then when I try to compile (<code>cabal configure &amp;&amp; cabal build -v</code>) I get the following error message:</p>\n\n<pre><code>Component build order: executable 'libtest.so'\ncreating dist/build\ncreating dist/build/autogen\nBuilding test-0.1.0.0...\nPreprocessing executable 'libtest.so' for test-0.1.0.0...\nBuilding executable libtest.so...\ncreating dist/build/libtest.so\ncreating dist/build/libtest.so/libtest.so-tmp\n/opt/ghc/bin/ghc --make -no-link -fbuilding-cabal-package -O -j8 -static\n-outputdir dist/build/libtest.so/libtest.so-tmp -odir dist/build\n/libtest.so/libtest.so-tmp -hidir dist/build/libtest.so/libtest.so-tmp-stubdir\ndist/build/libtest.so/libtest.so-tmp -i -idist/build/libtest.so/libtest.so-tmp\n-isrc -idist/build/autogen -Idist/build/autogen\n-Idist/build/libtest.so/libtest.so-tmp\n-optP-include -optPdist/build/autogen/cabal_macros.h -hide-all-packages\n-package-db dist/package.conf.inplace -package-id\nbase-4.7.0.1-1a55ebc8256b39ccbff004d48b3eb834 -XHaskell2010\nsrc/Dummy.hs -no-hs-main -threaded\n\nsrc/Dummy.hs:1:8:\n    Could not find module \u2018Test\u2019\nUse -v to see a list of the files searched for.\n</code></pre>\n\n<p>Please, can you tell me what the cause of the error is? What am I missing?</p>\n"}, {"tags": ["multithreading", "performance", "haskell", "parallel-processing", "ghc"], "comments": [{"owner": {"reputation": 1044, "user_id": 193424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba6dfa8271fb1cd0c475a2c0626853?s=128&d=identicon&r=PG", "display_name": "Alp Mestanogullari", "link": "https://stackoverflow.com/users/193424/alp-mestanogullari"}, "edited": false, "score": 0, "creation_date": 1435325172, "post_id": 31037585, "comment_id": 50167388, "body": "You might want to try <a href=\"http://jaspervdj.be/posts/2014-02-25-profiteur-ghc-prof-visualiser.html\" rel=\"nofollow noreferrer\">profileur</a> which was written to handle larger event logs."}], "answers": [{"comments": [{"owner": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "edited": false, "score": 0, "creation_date": 1435190562, "post_id": 31038702, "comment_id": 50101967, "body": "Rewrote with <code>BS.reverse</code> as a dummy hash function. This solved no. 1: without <code>+RTS -N</code>, all 4 versions now have the same performance."}, {"owner": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "edited": false, "score": 0, "creation_date": 1435190575, "post_id": 31038702, "comment_id": 50101970, "body": "As for no. 2, I\u2019ve noticed now that run time grows from T to ~2T with repeated runs, then drops back to T literally when the CPU cools down. So, perhaps not a Haskell related issue."}, {"owner": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "edited": false, "score": 0, "creation_date": 1435190587, "post_id": 31038702, "comment_id": 50101975, "body": "Thank you. I will accept this answer tomorrow if nobody chimes in with a better one."}, {"owner": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "edited": false, "score": 0, "creation_date": 1435225207, "post_id": 31038702, "comment_id": 50115179, "body": "Tried on another machine, run times stabilized (although at less than 2x speedup given 4 cores, but I guess that\u2019s another question)."}], "tags": [], "owner": {"reputation": 143, "user_id": 2714494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4bc54ab71e91c4b30a13a005905627?s=128&d=identicon&r=PG&f=1", "display_name": "SimpleGuy", "link": "https://stackoverflow.com/users/2714494/simpleguy"}, "is_accepted": true, "score": 3, "last_activity_date": 1435187726, "creation_date": 1435187726, "answer_id": 31038702, "question_id": 31037585, "link": "https://stackoverflow.com/questions/31037585/why-does-this-haskell-program-perform-strange-when-compiled-with-threaded/31038702#31038702", "title": "Why does this Haskell program perform strange when compiled with -threaded?", "body": "<p>The unexpected performance could be explained by the fact that \"Crypto.Hash.SHA256\" invokes unsafe FFI <a href=\"https://hackage.haskell.org/package/cryptohash-0.11.6/docs/src/Crypto-Hash-SHA256.html#init\" rel=\"nofollow\">code</a>. GHC does not <a href=\"https://wiki.haskell.org/Performance/FFI\" rel=\"nofollow\">guarantee</a> that other Haskell threads will not be blocked during the call to this code. If the threads that par spawns are being blocked by GHC it would cause a lot of contention in your program, which leads to the long run times and inconsistent run time results.</p>\n"}], "owner": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 31038702, "answer_count": 1, "score": 3, "last_activity_date": 1435187726, "creation_date": 1435182054, "question_id": 31037585, "link": "https://stackoverflow.com/questions/31037585/why-does-this-haskell-program-perform-strange-when-compiled-with-threaded", "title": "Why does this Haskell program perform strange when compiled with -threaded?", "body": "<p>Consider the following toy program that brute-forces a password hash by applying character substitutions to dictionary words. The dictionary is traversed sequentially or in parallel, triggered at compile time by the <code>PARMAP</code> symbol.</p>\n\n<pre><code>import qualified Control.Parallel.Strategies as Strat\nimport qualified Crypto.Hash.SHA256 as SHA256\nimport qualified Data.ByteString as BS\nimport qualified Data.ByteString.Base16 as BS.Base16\nimport qualified Data.ByteString.Char8 as BS.Char8\nimport Data.Char (isLower, toUpper)\nimport Data.Maybe (listToMaybe)\n\nvariants :: String -&gt; [String]\nvariants \"\" = [\"\"]\nvariants (c:s) = [c':s' | s' &lt;- variants s, c' &lt;- subst c]\n  where subst 'a' = \"aA@\"\n        subst 'e' = \"eE3\"\n        subst 'i' = \"iI1\"\n        subst 'l' = \"lL1\"\n        subst 'o' = \"oO0\"\n        subst 's' = \"sS$5\"\n        subst 'z' = \"zZ2\"\n        subst x | isLower x = [x, toUpper x]\n        subst x = [x]\n\nmyMap :: (a -&gt; [a]) -&gt; [a] -&gt; [[a]]\n#ifdef PARMAP\nmyMap = Strat.parMap (Strat.evalList Strat.rseq)\n#else\nmyMap = map\n#endif\n\nbruteForce :: [String] -&gt; BS.ByteString -&gt; Maybe String\nbruteForce dictionary hash = listToMaybe $ concat $ myMap match dictionary\n  where match word = [var | var &lt;- variants word,\n                      SHA256.hash (BS.Char8.pack var) == hash]\n\nmain :: IO ()\nmain = do\n  dictionary &lt;- lines `fmap` (readFile \"dictionary.txt\")\n  hash &lt;- (fst . BS.Base16.decode . BS.Char8.pack) `fmap` getLine\n  case bruteForce dictionary hash of\n    Just preimage -&gt; putStrLn preimage\n    Nothing -&gt; return ()\n</code></pre>\n\n<p>I compile this program with and without both <code>PARMAP</code> and <code>-threaded</code>.</p>\n\n<pre><code>$ ghc Brute.hs -cpp -fforce-recomp -Wall -O2 -o brute.seq\n$ ghc Brute.hs -cpp -fforce-recomp -Wall -O2 -DPARMAP -o brute.par\n$ ghc Brute.hs -cpp -fforce-recomp -Wall -O2 -threaded -o brute.seq+th\n$ ghc Brute.hs -cpp -fforce-recomp -Wall -O2 -threaded -DPARMAP -o brute.par+th\n</code></pre>\n\n<p>To run this program, I make a small dictionary and take the last word from it.</p>\n\n<pre><code>$ shuf -n 300 /usr/share/dict/american-english &gt;dictionary.txt\n$ tail -n 1 dictionary.txt \ndesalinates\n$ echo -n 'De$aL1n@teS' | sha256sum\n3c76d2487f8094a8bf4cbb9e7de7624fab48c3d4f82112cb150b35b9a1cb9072  -\n</code></pre>\n\n<p>I run this on a 2-core CPU. No other CPU-intensive processes are running on this machine.</p>\n\n<p>The sequential map version performs as expected.</p>\n\n<pre><code>$ TIMEFORMAT='real %R   user %U   sys %S'\n$ time ./brute.seq &lt;&lt;&lt;3c76d2487f8094a8bf4cbb9e7de7624fab48c3d4f82112cb150b35b9a1cb9072\nDe$aL1n@teS\nreal 39.797   user 39.574   sys 0.156\n$ time ./brute.seq+th &lt;&lt;&lt;3c76d2487f8094a8bf4cbb9e7de7624fab48c3d4f82112cb150b35b9a1cb9072\nDe$aL1n@teS\nreal 44.313   user 44.159   sys 0.088\n$ time ./brute.seq+th +RTS -N &lt;&lt;&lt;3c76d2487f8094a8bf4cbb9e7de7624fab48c3d4f82112cb150b35b9a1cb9072\nDe$aL1n@teS\nreal 44.990   user 44.835   sys 0.876\n</code></pre>\n\n<p>The parallel map version, compiled without <code>-threaded</code>, has the same performance.</p>\n\n<pre><code>$ time ./brute.par &lt;&lt;&lt;3c76d2487f8094a8bf4cbb9e7de7624fab48c3d4f82112cb150b35b9a1cb9072\nDe$aL1n@teS\nreal 39.847   user 39.742   sys 0.056\n</code></pre>\n\n<p>When I combine parallel map with <code>-threaded</code>, but don\u2019t use 2 cores just yet, things start looking strange.</p>\n\n<pre><code>$ time ./brute.par+th &lt;&lt;&lt;3c76d2487f8094a8bf4cbb9e7de7624fab48c3d4f82112cb150b35b9a1cb9072\nDe$aL1n@teS\nreal 58.636   user 73.661   sys 17.717\n</code></pre>\n\n<p>When I use 2 cores, things get stranger yet. Performance now varies wildly from run to run, something the previous versions do not exhibit. Sometimes it is twice as fast as single-core <code>brute.par+th</code>, which is what I expect, seeing as the algorithm is embarrasingly parallel. But sometimes it is even slower than on one core.</p>\n\n<pre><code>$ time ./brute.par+th +RTS -N &lt;&lt;&lt;3c76d2487f8094a8bf4cbb9e7de7624fab48c3d4f82112cb150b35b9a1cb9072\nDe$aL1n@teS\nreal 28.589   user 51.615   sys 2.304\n$ time ./brute.par+th +RTS -N &lt;&lt;&lt;3c76d2487f8094a8bf4cbb9e7de7624fab48c3d4f82112cb150b35b9a1cb9072\nDe$aL1n@teS\nreal 59.149   user 106.255   sys 4.664\n$ time ./brute.par+th +RTS -N &lt;&lt;&lt;3c76d2487f8094a8bf4cbb9e7de7624fab48c3d4f82112cb150b35b9a1cb9072\nDe$aL1n@teS\nreal 49.428   user 87.193   sys 3.816\n</code></pre>\n\n<p>Now I have two questions which may be related.</p>\n\n<ol>\n<li>Why is 1-core <code>brute.par+th</code> so much slower than 1-core <code>brute.par</code>? What\u2019s it doing in those threads? What\u2019s it doing in kernel mode for a whopping 17 seconds?</li>\n<li>Why does the performance of 2-core <code>brute.par+th</code> vary so wildly, instead of being reliably twice the performance of 1-core <code>brute.par+th</code>?</li>\n</ol>\n\n<p>I\u2019m using GHC 7.4.1 and parallel-3.2.0.2. I know I should probably be using newer versions, but this is what I have handy at the moment.</p>\n\n<p>I tried compiling with <code>-rtsopts</code> and disabling threaded GC with <code>+RTS -qg</code>, to no effect.</p>\n\n<p>I tried ThreadScope, but it swapped like crazy and couldn\u2019t load an eventlog even when I used a much smaller dictionary.</p>\n"}, {"tags": ["list", "haskell", "functional-programming", "comparison"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1435178304, "post_id": 31036474, "comment_id": 50097327, "body": "Shouldn&#39;t it be <code>null list = True</code> to match your original implementation?"}, {"owner": {"reputation": 353, "user_id": 3977199, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6bce85208aeb360ce66fabc2cdd7c26?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Dos Reis", "link": "https://stackoverflow.com/users/3977199/luis-dos-reis"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1435178361, "post_id": 31036474, "comment_id": 50097358, "body": "Yes sorry .. typo.. just fixed that, the bug however, persists."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 3, "creation_date": 1435178499, "post_id": 31036474, "comment_id": 50097441, "body": "So you have <code>head list `elem` tail list || allDifferent2 (tail list) = False</code>, which is basically saying &quot;if the first element is somewhere in the list, or if all the rest of the list is full of uniques then return False&quot;.  Are you sure that&#39;s the behavior you want?  You might be able to make it simpler with <code>head list `elem` tail list = allDifferent2 (tail list)</code>, I think that&#39;ll work better for you."}, {"owner": {"reputation": 2569, "user_id": 514040, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/98bb1ee1a1f3d1297acf493776066086?s=128&d=identicon&r=PG", "display_name": "neuronaut", "link": "https://stackoverflow.com/users/514040/neuronaut"}, "edited": false, "score": 2, "creation_date": 1435178699, "post_id": 31036474, "comment_id": 50097532, "body": "If your recursive call to <code>allDifferent2</code> returns True then the guard passes and you then return False which may not be what you want."}], "answers": [{"comments": [{"owner": {"reputation": 353, "user_id": 3977199, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6bce85208aeb360ce66fabc2cdd7c26?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Dos Reis", "link": "https://stackoverflow.com/users/3977199/luis-dos-reis"}, "edited": false, "score": 0, "creation_date": 1435179514, "post_id": 31036741, "comment_id": 50097941, "body": "I copied as you typed it. GHCi throws a Non-exhaustive patterns exception however when I input a list with elements which aren&#39;t unique..    <code>*Main&gt; allDifferent3 [1, 2, 3, 4, 4]</code>                  <code>*** Exception: allDiff.hs:(18,1)-(21,47): Non-exhaustive patterns in function allDifferent3</code>"}, {"owner": {"reputation": 552, "user_id": 4409863, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e96e35d48fcbde43780dd48a3e39b5f0?s=128&d=identicon&r=PG&f=1", "display_name": "Xaphanius", "link": "https://stackoverflow.com/users/4409863/xaphanius"}, "reply_to_user": {"reputation": 353, "user_id": 3977199, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6bce85208aeb360ce66fabc2cdd7c26?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Dos Reis", "link": "https://stackoverflow.com/users/3977199/luis-dos-reis"}, "edited": false, "score": 1, "creation_date": 1435192992, "post_id": 31036741, "comment_id": 50102565, "body": "Indeed. I edited my answer and now it should be ok. I tested the repetition case with [1, 1, 2] (starting with the repeated number) but not with [1, 2, 2]. But now it is right. :)"}], "tags": [], "owner": {"reputation": 552, "user_id": 4409863, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e96e35d48fcbde43780dd48a3e39b5f0?s=128&d=identicon&r=PG&f=1", "display_name": "Xaphanius", "link": "https://stackoverflow.com/users/4409863/xaphanius"}, "is_accepted": false, "score": 1, "last_activity_date": 1435192905, "last_edit_date": 1435192905, "creation_date": 1435178899, "answer_id": 31036741, "question_id": 31036474, "link": "https://stackoverflow.com/questions/31036474/haskell-checking-if-all-list-elements-are-unique/31036741#31036741", "title": "Haskell - Checking if all list elements are unique", "body": "<p>Try this:</p>\n\n<pre><code>allDifferent2::(Eq a) =&gt; [a] -&gt; Bool\nallDifferent2 list\n    | list == []                        = True\n    | (head list) `elem` (tail list)    = False\n    | otherwise = allDifferent2(tail list)\n</code></pre>\n\n<p>If the list is [] you should return True (As @bheklilr said :) )</p>\n\n<p>If the list isn't null, you can verify if the first element is in the tail of the list. If it is, return False. Okay.</p>\n\n<p>But when you say \"if it is in the tail of the list <strong>OR</strong> allDifferent2 (tail list)\" you are killing your function. \"If all the elements are different in this list, return <strong>FALSE</strong>\", and that isn't what you want.</p>\n\n<p><strong>EDIT:</strong> Yeah, it will @Luis. I fixed that by putting that \"otherwise\" there. When I put the guard before the allDifferent2(tail list) it checked if this function returned True. Thus it would work for [1, 1, 2] (my test-case) but not for [1, 2, 2] (similar to your case).</p>\n"}, {"comments": [{"owner": {"reputation": 353, "user_id": 3977199, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6bce85208aeb360ce66fabc2cdd7c26?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Dos Reis", "link": "https://stackoverflow.com/users/3977199/luis-dos-reis"}, "edited": false, "score": 0, "creation_date": 1435180201, "post_id": 31037028, "comment_id": 50098305, "body": "Interesting, what harm is there in using partial functions?"}, {"owner": {"reputation": 353, "user_id": 3977199, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6bce85208aeb360ce66fabc2cdd7c26?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Dos Reis", "link": "https://stackoverflow.com/users/3977199/luis-dos-reis"}, "edited": false, "score": 0, "creation_date": 1435180891, "post_id": 31037028, "comment_id": 50098659, "body": "The final code utilizing guards looks like this: <code>allDifferent3::(Eq a) =&gt; [a] -&gt; Bool allDifferent3 list     | list == []                        = True     | (head list) </code>notElem` (tail list) = allDifferent3 $ tail list     | allDifferent3(tail list)          = False`"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 353, "user_id": 3977199, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6bce85208aeb360ce66fabc2cdd7c26?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Dos Reis", "link": "https://stackoverflow.com/users/3977199/luis-dos-reis"}, "edited": false, "score": 1, "creation_date": 1435180935, "post_id": 31037028, "comment_id": 50098679, "body": "@LuisDosReis If you ever ask for <code>head []</code> or <code>tail []</code>, the whole program aborts (crashes). This does not happen with (exhaustive) pattern matching. (And <code>-Wall</code> helps in detecting non exhaustiveness)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 353, "user_id": 3977199, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6bce85208aeb360ce66fabc2cdd7c26?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Dos Reis", "link": "https://stackoverflow.com/users/3977199/luis-dos-reis"}, "edited": false, "score": 1, "creation_date": 1435181047, "post_id": 31037028, "comment_id": 50098727, "body": "@LuisDosReis In a guard solution, remember you have to add an <code>| otherwise = blah </code> case"}, {"owner": {"reputation": 353, "user_id": 3977199, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6bce85208aeb360ce66fabc2cdd7c26?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Dos Reis", "link": "https://stackoverflow.com/users/3977199/luis-dos-reis"}, "edited": false, "score": 0, "creation_date": 1435181297, "post_id": 31037028, "comment_id": 50098828, "body": "Hm, even when my matches already cover all of the possibilities?."}, {"owner": {"reputation": 353, "user_id": 3977199, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6bce85208aeb360ce66fabc2cdd7c26?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Dos Reis", "link": "https://stackoverflow.com/users/3977199/luis-dos-reis"}, "edited": false, "score": 0, "creation_date": 1435181554, "post_id": 31037028, "comment_id": 50098958, "body": "Edit: Just noticed my code does not cover all possibilities.. Just fed some strings into it and some larger arrays and it throws a non-exhaustive patterns exception.. And as you said adding <code>| otherwise =  False</code> in the end does the trick. Thanks! (Must admit though the <code>case .. of</code> solution is far more elegant and succinct.)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 353, "user_id": 3977199, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6bce85208aeb360ce66fabc2cdd7c26?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Dos Reis", "link": "https://stackoverflow.com/users/3977199/luis-dos-reis"}, "edited": false, "score": 1, "creation_date": 1435182783, "post_id": 31037028, "comment_id": 50099558, "body": "@LuisDosReis If your code ends with a list of guards, the last must be equivalent to <code>otherwise</code>, since it has to catch all the remaining cases. You may use a more complex check, but there&#39;s no real reason to do so."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 353, "user_id": 3977199, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6bce85208aeb360ce66fabc2cdd7c26?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Dos Reis", "link": "https://stackoverflow.com/users/3977199/luis-dos-reis"}, "edited": false, "score": 1, "creation_date": 1435217872, "post_id": 31037028, "comment_id": 50110619, "body": "@LuisDosReis It&#39;s much easier to work with total functions. In fact you can derive theorems from the type of a total function and be sure that it has some property simply looking at the type. If the function is partial this kind of things gets harder, because the function could blow up at any time and you generally cannot easily derive properties as easily. This makes both reasoning and proving correctness much more difficult."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 8, "last_activity_date": 1435179942, "creation_date": 1435179942, "answer_id": 31037028, "question_id": 31036474, "link": "https://stackoverflow.com/questions/31036474/haskell-checking-if-all-list-elements-are-unique/31037028#31037028", "title": "Haskell - Checking if all list elements are unique", "body": "<p>An alternative exploiting <code>notElem</code>:</p>\n\n<pre><code>allDifferent :: (Eq a) =&gt; [a] -&gt; Bool\nallDifferent list = case list of\n    []      -&gt; True\n    (x:xs)  -&gt; x `notElem` xs &amp;&amp; allDifferent xs\n</code></pre>\n\n<p>Minor variant, using pattern matching directly in the equations:</p>\n\n<pre><code>allDifferent :: (Eq a) =&gt; [a] -&gt; Bool\nallDifferent []     = True\nallDifferent (x:xs) = x `notElem` xs &amp;&amp; allDifferent xs\n</code></pre>\n\n<p>I tend to stay away from partial functions like <code>head,tail</code>, so the variants based on guards look worse to me.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1435181744, "post_id": 31037322, "comment_id": 50099048, "body": "I&#39;d suggest <code>comparePairwise (x:xs@(y:_)) = x &#47;= y &amp;&amp; comparePairwise xs ; comparePairwise _ = True</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1435181874, "post_id": 31037322, "comment_id": 50099109, "body": "@chi Agree. It&#39;s more elegant."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1435191339, "post_id": 31037322, "comment_id": 50102167, "body": "The usual approach is <code>comparePairwise xs = and $ zipWith (&#47;=) xs (drop 1 xs)</code>."}, {"owner": {"reputation": 353, "user_id": 3977199, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6bce85208aeb360ce66fabc2cdd7c26?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Dos Reis", "link": "https://stackoverflow.com/users/3977199/luis-dos-reis"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1435192370, "post_id": 31037322, "comment_id": 50102426, "body": "@dfeuer Succinct. The logic isn&#39;t quite clear to a novice like me though. Not a problem however after some research.  Would you be able to judge how this compares performance wise to the above solution?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 353, "user_id": 3977199, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6bce85208aeb360ce66fabc2cdd7c26?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Dos Reis", "link": "https://stackoverflow.com/users/3977199/luis-dos-reis"}, "edited": false, "score": 1, "creation_date": 1435192785, "post_id": 31037322, "comment_id": 50102523, "body": "@Luis Dos Reis The asymptotic time is still linear, so no performance change from algorithmic point of view."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 353, "user_id": 3977199, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6bce85208aeb360ce66fabc2cdd7c26?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Dos Reis", "link": "https://stackoverflow.com/users/3977199/luis-dos-reis"}, "edited": false, "score": 0, "creation_date": 1435196857, "post_id": 31037322, "comment_id": 50103394, "body": "@LuisDosReis, the performance should be okay, but it may allocate more memory than the hand-written version, or maybe less. The best way would be to measure performance."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 1, "creation_date": 1435283678, "post_id": 31037322, "comment_id": 50147489, "body": "However, this is less generic because of the <code>Ord</code> constraint."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1435320141, "post_id": 31037322, "comment_id": 50164037, "body": "@Cactus Well noticed. I wonder if there a way to achieve the same time complexity without ordering relation."}, {"owner": {"reputation": 573, "user_id": 1485641, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/DZfVI.jpg?s=128&g=1", "display_name": "Bruno", "link": "https://stackoverflow.com/users/1485641/bruno"}, "edited": false, "score": 0, "creation_date": 1478326743, "post_id": 31037322, "comment_id": 68118464, "body": "You don&#39;t need to specify that a must have an Eq instance since Ord already include Eq"}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 5, "last_activity_date": 1435196986, "last_edit_date": 1435196986, "creation_date": 1435181056, "answer_id": 31037322, "question_id": 31036474, "link": "https://stackoverflow.com/questions/31036474/haskell-checking-if-all-list-elements-are-unique/31037322#31037322", "title": "Haskell - Checking if all list elements are unique", "body": "<p>I would do this differently. Recursion + <code>elem</code> is <em>O(n\u00b2)</em>. Alternatively you can first sort the list, and then compare elements pairwise. This way the sorting is <em>O(n\u22c5log n)</em>, and the traversal <em>O(n)</em>. So overall <em>O(n\u22c5log n)</em>:</p>\n\n<pre><code>import Data.List\n\nallDifferent :: (Ord a, Eq a) =&gt; [a] -&gt; Bool\nallDifferent = comparePairwise.sort\n\ncomparePairwise :: Eq a =&gt; [a] -&gt; Bool\ncomparePairwise [] = True\ncomparePairwise [_] = True\ncomparePairwise (x:y:xs) \n    | x == y = False\n    | otherwise = comparePairwise (y : xs)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1435249422, "creation_date": 1435249422, "answer_id": 31055743, "question_id": 31036474, "link": "https://stackoverflow.com/questions/31036474/haskell-checking-if-all-list-elements-are-unique/31055743#31055743", "title": "Haskell - Checking if all list elements are unique", "body": "<p>The simplest reasonable idiomatic approach I can think of is</p>\n\n<pre><code>allDifferent :: Ord a =&gt; [a] -&gt; Bool\nallDifferent = pairwiseDifferent . sort\n\npairwiseDifferent :: Eq a =&gt; [a] -&gt; Bool\npairwiseDifferent xs = and $ zipWith (/=) xs (drop 1 xs)\n</code></pre>\n\n<p>For fun with folds,</p>\n\n<pre><code>import Data.Maybe\n\npairwiseDifferent xs = foldr go (const True) xs Nothing\n  where\n    go x k Nothing = k (Just x)\n    go x k (Just prev) = x /= prev &amp;&amp; k (Just x)\n</code></pre>\n\n<p>Another option is to use a <code>Set</code> (some of the strictness annotations may not actually be necessary):</p>\n\n<pre><code>import qualified Data.Set as S\n\nallDifferent xs = foldr go (\\s -&gt; s `seq` True) xs S.empty\n  where\n    go x k s\n       | S.member x s = False\n       | otherwise = k $! S.insert x s\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 2, "last_activity_date": 1435854218, "creation_date": 1435854218, "answer_id": 31189836, "question_id": 31036474, "link": "https://stackoverflow.com/questions/31036474/haskell-checking-if-all-list-elements-are-unique/31189836#31189836", "title": "Haskell - Checking if all list elements are unique", "body": "<p>You can rely on library functions: <code>allDifferent xs = nub xs == xs</code>.</p>\n\n<p>Or, written in point-free notation: <code>allDifferent = uncurry (==) . (nub &amp;&amp;&amp; id)</code>.</p>\n\n<p>Using <a href=\"https://hackage.haskell.org/package/discrimination-0.1/docs/Data-Discrimination.html#v:nub\" rel=\"nofollow\">Data.Discrimination.nub</a>, this happens in <em>O(n)</em> time.</p>\n"}, {"comments": [{"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1546095366, "post_id": 46839283, "comment_id": 94778718, "body": "Works but only when the elements are of type <code>Ord</code>."}], "tags": [], "owner": {"reputation": 6648, "user_id": 464306, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8KCe.png?s=128&g=1", "display_name": "gdejohn", "link": "https://stackoverflow.com/users/464306/gdejohn"}, "is_accepted": false, "score": 1, "last_activity_date": 1510361813, "last_edit_date": 1510361813, "creation_date": 1508449038, "answer_id": 46839283, "question_id": 31036474, "link": "https://stackoverflow.com/questions/31036474/haskell-checking-if-all-list-elements-are-unique/46839283#46839283", "title": "Haskell - Checking if all list elements are unique", "body": "<p>Sort the list, <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Data-List.html#v:group\" rel=\"nofollow noreferrer\"><code>group</code></a> runs of equal elements together, and check if <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:all\" rel=\"nofollow noreferrer\"><code>all</code></a> groups have exactly one element.</p>\n\n<pre><code>import Data.List (group, sort)\n\npairwiseDistinct :: Ord a =&gt; [a] -&gt; Bool\npairwiseDistinct xs = all (\\ys -&gt; null (tail ys)) (group (sort xs))\n</code></pre>\n\n<p>Point-free version:</p>\n\n<pre><code>pairwiseDistinct = all (null . tail) . group . sort\n</code></pre>\n\n<p>This assumes that for any two elements <code>x</code> and <code>y</code>, <code>x == y</code> if and only if <code>compare x y == EQ</code>.</p>\n\n<p><code>tail</code> is fine here because none of the groups will ever be empty, but you can substitute <code>drop 1</code> if you're averse to partial functions.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9950478, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DrvwU3hy_Nw/AAAAAAAAAAI/AAAAAAAAAQo/dS41mWEO3wY/photo.jpg?sz=128", "display_name": "Gon&#231;alo Faria", "link": "https://stackoverflow.com/users/9950478/gon%c3%a7alo-faria"}, "is_accepted": false, "score": 0, "last_activity_date": 1529600969, "creation_date": 1529600969, "answer_id": 50974099, "question_id": 31036474, "link": "https://stackoverflow.com/questions/31036474/haskell-checking-if-all-list-elements-are-unique/50974099#50974099", "title": "Haskell - Checking if all list elements are unique", "body": "<pre><code>allDifferent []    = True\nallDifferent (h:t) = \n                     let (e,(l,r)) = segment h t \n                     in e &amp;&amp; allDifferent l &amp;&amp; allDifferent r\n\nsegment p []     = (True,([],[])))\nsegment p (h:s) \n   | p &gt; h       = let (e,(l,r)) = segment p s in (e,(l,h:r))\n   | p &lt; h       = let (e,(l,r)) = segment p s in (e,(h:l,r))\n   | otherwise   = (False,([],[])))\n</code></pre>\n\n<p>As you can see the structure of this solution is very similar to quickSort.\nIt shares as an intermediate data structure a binary tree and for that reason, the time complexity is extremely similar.</p>\n"}], "owner": {"reputation": 353, "user_id": 3977199, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e6bce85208aeb360ce66fabc2cdd7c26?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Dos Reis", "link": "https://stackoverflow.com/users/3977199/luis-dos-reis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7400, "favorite_count": 0, "accepted_answer_id": 31037028, "answer_count": 7, "score": 5, "last_activity_date": 1529600969, "creation_date": 1435177971, "last_edit_date": 1435183024, "question_id": 31036474, "link": "https://stackoverflow.com/questions/31036474/haskell-checking-if-all-list-elements-are-unique", "title": "Haskell - Checking if all list elements are unique", "body": "<p>I need to compare if all elements of a given list are unique.\n(For the record I am doing so for academic purposes.)</p>\n\n<p>Here is what I have thus far:</p>\n\n<pre><code>allDifferent :: (Eq a) =&gt; [a] -&gt; Bool\nallDifferent list = case list of\n    []      -&gt; True\n    (x:xs)  -&gt; if x `elem` xs then False else allDifferent xs\n</code></pre>\n\n<p>Which works wonderfully!</p>\n\n<p>Now, when I try to do it like this...</p>\n\n<pre><code>allDifferent2 :: (Eq a) =&gt; [a] -&gt; Bool\nallDifferent2 list\n    | null list                                                     = True        \n    | (head list) `elem` (tail list) || allDifferent2 (tail list)  = False\n    | otherwise  \n</code></pre>\n\n<p>It just doesn't work as intended.\nI get the following output from GHCi:</p>\n\n<pre><code>*Main&gt; allDifferent2 [1..4]\nFalse\n*Main&gt; allDifferent2 [1..5]\nTrue\n*Main&gt; allDifferent2 [1..6]\nFalse\n*Main&gt; allDifferent2 [1..7]\nTrue\n</code></pre>\n\n<p>i.e. For every list with an even amount of elements it outputs False and for an odd amount of elements, True.</p>\n\n<p>What am I missing?\nWould anyone care to shine some light?</p>\n"}, {"tags": ["haskell", "polymorphism"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1435173157, "post_id": 31034826, "comment_id": 50094444, "body": "I think your best bet is probably the <code>reflection</code> package (don&#39;t use <code>Given</code> to preserve your sanity)."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1435175130, "post_id": 31034826, "comment_id": 50095516, "body": "I get that <code>WithBehavior</code> is of type <code>String -&gt; WithBehavior</code>.  What is the type of <code>withBehavior</code>? what is <code>makeWithBehavior</code>?  It sort of fell apart at the end with the intended operation falling into undefined and untyped symbols."}, {"owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1435177198, "post_id": 31034826, "comment_id": 50096724, "body": "@dfeuer using <code>data BehaviorWrapper where { BehaviorWrapper :: Behavior b =&gt; b -&gt; BehaviorWrapper }</code> could be made but I want avoid type wrappers :)"}, {"owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1435177671, "post_id": 31034826, "comment_id": 50096972, "body": "@ThomasM.DuBuisson is not real code, <code>withBehavior x</code> construct the application data (<code>WithBehavior</code> containing the final <code>Behavior</code> instance) using some <code>x</code> runtime configuration (eg. sys.args). <code>makeWithBehavior</code> could be directly <code>WithBehavior &quot;fooString&quot; bee</code>. Thk!"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1435177730, "post_id": 31034826, "comment_id": 50097003, "body": "If <code>IBehavior</code> really has only one method... just pass a function to anybody that needs it. You don&#39;t need to &quot;define a class&quot; and then &quot;construct instances of it&quot; just to pass a function around."}, {"owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1435178662, "post_id": 31034826, "comment_id": 50097515, "body": "No @MathematicalOrchid (see <code>class Behavior</code>) I want include a full, configurable, with state, ... behavior selectable at runtime (excuse my poorly explanation)."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1435185937, "post_id": 31034826, "comment_id": 50100732, "body": "Oh look it&#39;s our old friend the <a href=\"https://lukepalmer.wordpress.com/2010/01/24/haskell-antipattern-existential-typeclass/\" rel=\"nofollow noreferrer\">existential typeclass antipattern</a>.  The answerers are right here -- ditch the class, use a record instead.  Your aversion is based on intuition from other languages.  Haskell is quite different. Give it a try and see how it goes."}, {"owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1435215420, "post_id": 31034826, "comment_id": 50109141, "body": "Thank you @luqui I&#39;ll follow your tip"}, {"owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "edited": false, "score": 0, "creation_date": 1435222454, "post_id": 31034826, "comment_id": 50113545, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/21677201/strategy-pattern-in-haskell\">&quot;Strategy Pattern&quot; in Haskell</a>"}], "answers": [{"comments": [{"owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "edited": false, "score": 0, "creation_date": 1435178454, "post_id": 31036235, "comment_id": 50097417, "body": "Excuse me @ReidBarton (and others) is my fault (I explain poorly). Each behavior instance (alternative) has their own context (data type). <code>Database.Persist</code> may be a good example I&#39;m looking for but is too complex to me."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "edited": false, "score": 0, "creation_date": 1435180481, "post_id": 31036235, "comment_id": 50098452, "body": "That doesn&#39;t actually matter. You can add type parameters to <code>Behavior</code> if necessary, or just use the context in the implementation of your <code>Behavior</code> in a way that it does not appear in the type. Type classes provide convenience and coherence, and neither is relevant here when you don&#39;t even know how to write your program at all."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "edited": false, "score": 0, "creation_date": 1435181084, "post_id": 31036235, "comment_id": 50098741, "body": "@josejuan, the better way than the version using GADTs in the edit is the version in my answer or bheklilr&#39;s answer (with the type parameter(s) of <code>Behavior</code> removed, since you do not use them). They are equivalent."}, {"owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "edited": false, "score": 0, "creation_date": 1435215661, "post_id": 31036235, "comment_id": 50109260, "body": "Thank you very much @ReidBarton, both answers are great. I&#39;ll take your way :)"}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 4, "last_activity_date": 1435177292, "creation_date": 1435177292, "answer_id": 31036235, "question_id": 31034826, "link": "https://stackoverflow.com/questions/31034826/select-instance-behavior-at-runtime/31036235#31036235", "title": "Select instance behavior at runtime", "body": "<p>Why are you introducing these types <code>BehaviorA</code>, <code>BehaviorB</code> to dispatch on? It looks like a bad translation from Java unless there is some specific advantage to dispatching based on types rather than values; but it just seems to be causing you problems here.</p>\n\n<p>Instead, how about ditching the type class and just using a record of \"methods\"?</p>\n\n<pre><code>data Behavior a = Behavior { behavior :: IO (), ... }\nbehaviorA = Behavior { behavior = print \"Behavior A!\" }\nbehaviorB = Behavior { behavior = print \"Behavior B!\" }\nselectedBee x = case x of\n                  \"A\" -&gt; behaviorA\n                  \"B\" -&gt; behaviorB\ndata WithBehavior a = WithBehavior { foo :: String\n                                   , bee :: Behavior a }\nrun :: WithBehavior a -&gt; IO ()\nrun (WithBehavior {..}) = print foo &gt;&gt; behavior bee\n</code></pre>\n\n<p>(I'm not sure exactly what you intended with <code>WithBehavior</code>, since your <code>Behavior</code> class lost one of its two arguments somewhere along the way. Maybe you want a universally or existentially quantified type instead.)</p>\n"}, {"comments": [{"owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "edited": false, "score": 0, "creation_date": 1435178197, "post_id": 31036362, "comment_id": 50097265, "body": "Yes @bheklilr I know these direct OOP aproach (and works!) it remember me C-style OOP pattern :D But yours <code>k</code> are the same type (<code>String</code>) and <code>selectBehavior</code> returns only one fixed type (then, with <code>class</code>works well too)"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "edited": false, "score": 0, "creation_date": 1435178654, "post_id": 31036362, "comment_id": 50097514, "body": "@josejuan Correct, if you need it to be more flexible then you&#39;ll have to apply other techniques, I included those data type parameters because you had them in some places in your example code, but not in others.  You will have to return the exact same type there, this is a restriction but not that bad of one, there are ways around it.  However, your main problem here comes from trying to directly translate OOP to FP using typeclasses, and that&#39;s just not what typeclasses are for."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 6, "last_activity_date": 1435177655, "creation_date": 1435177655, "answer_id": 31036362, "question_id": 31034826, "link": "https://stackoverflow.com/questions/31034826/select-instance-behavior-at-runtime/31036362#31036362", "title": "Select instance behavior at runtime", "body": "<p>Why use a typeclass?  Instead, represent the typeclass as a record type, with \"instances\" being values of that type:</p>\n\n<pre><code>data Behavior k a = Behavior\n    { behavior :: IO ()\n    , foo :: k -&gt; a -&gt; Bool\n    }\n\nbehaviorA :: Behavior String Int\nbehaviorA = Behavior\n    { behavior = putStrLn \"Behavior A!\"\n    , foo = \\a b -&gt; length a &lt; b\n    }\n\nbehaviorB :: Behavior String Int\nbehaviorB = Behavior\n    { behavior = putStrLn \"Behavior B!\"\n    , foo = \\a b -&gt; length a &gt; b\n    }\n\nselectBehavior :: String -&gt; Maybe (Behavior String Int)\nselectBehavior \"A\" = Just behaviorA\nselectBehavior \"B\" = Just behaviorB\nselectBehavior _   = Nothing\n\nmain :: IO ()\nmain = do\n    putStrLn \"Which behavior (A or B)?\"\n    selection &lt;- getLine\n    let selected = selectBehavior selection\n    maybe (return ()) behavior selected\n    putStrLn \"What is your name?\"\n    name &lt;- getLine\n    putStrLn \"What is your age?\"\n    age &lt;- readLn  -- Don't use in real code, you should actually parse things\n    maybe (return ()) (\\bhvr -&gt; print $ foo bhvr name age) selected\n</code></pre>\n\n<p>(I haven't compiled this code, but it should work)</p>\n\n<p>Typeclasses are meant to be resolved fully at compile time.  You're trying to force them to be resolved at runtime.  Instead, think about how you're really specifying it in OOP: you have a type and a function that returns some value of that type based on its arguments.  You then call a method on that type.  The only difference is that with the OOP solution the values returned from the selection function don't have the exact type that the function says it should, so you're returning a <code>BehaviorA</code> or <code>BehaviorB</code> instead of an <code>IBehavior</code>.  With Haskell you have to actually return a value that exactly matches the return type.</p>\n\n<p>The only thing that the OOP version lets you do that Haskell doesn't is cast your <code>IBehavior</code> back to a <code>BehaviorA</code> or <code>BehaviorB</code>, and this is often considered unsafe anyway.  If you receive a value whose type is specified by an interface, you should always restrict yourself to only what that interface allows.  Haskell forces this, while OOP uses it merely by convention.  For a more complete explanation of this pattern check out <a href=\"https://lukepalmer.wordpress.com/2010/01/24/haskell-antipattern-existential-typeclass/\" rel=\"noreferrer\">this</a> post.</p>\n"}], "owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 1, "accepted_answer_id": 31036362, "answer_count": 2, "score": 3, "last_activity_date": 1435179903, "creation_date": 1435172443, "last_edit_date": 1435179903, "question_id": 31034826, "link": "https://stackoverflow.com/questions/31034826/select-instance-behavior-at-runtime", "title": "Select instance behavior at runtime", "body": "<p>I'm stuck trying to select one instance from many at runtime. Really is a kind of <code>Backend</code>.</p>\n\n<p>I'm able to do it if I select one instance or other at compile time.</p>\n\n<p><strong>UPDATED</strong> probably I want some similar to <a href=\"https://hackage.haskell.org/package/persistent\" rel=\"nofollow\">Database.Persist</a> (it define a fully behavior but many instances: mongodb, sqlite, postgresql, ...). But is too complex to me.</p>\n\n<p><strong>UPDATED</strong> using <code>GADTs</code> works but I think exist a better way (full code at the bottom).</p>\n\n<p>In some OOP language my problem is more or less</p>\n\n<pre><code>interface IBehavior { void foo(); }\n\nclass AppObject { IBehavior bee; void run(); }\n\n...\n  var app = new AppObject { bee = makeOneOrOtherBehavior(); }\n....\n</code></pre>\n\n<p>I've tried many ways (and lots of extensions :D) but none works.</p>\n\n<p>Informally I want to define one <code>class</code> with certain behavior and use this generic definition into some application, after it, select at runtime one <code>instance</code> from some.</p>\n\n<p>The generic behavior (not real code)</p>\n\n<pre><code>class Behavior k a where\n  behavior :: k -&gt; IO ()\n  foo :: k -&gt; a -&gt; Bool\n  ...\n</code></pre>\n\n<p>(I think <code>k</code> is needed since each <code>instance</code> could need their own context/data; other restrictions like <code>key</code>/<code>value</code> may be exist)</p>\n\n<p>Two instances</p>\n\n<pre><code>data BehaviorA\ninstance Behavior BehaviorA where\n  behavior _ = print \"Behavior A!\"\n\ndata BehaviorB\ninstance Behavior BehaviorB where\n  behavior _ = print \"Behavior B!\"\n</code></pre>\n\n<p>my application use that behavior (here begin the chaos)</p>\n\n<pre><code>data WithBehavior =\n  WithBehavior { foo :: String\n               , bee :: forall b . Behavior b =&gt; b\n               }\n\nrun :: WithBehavior -&gt; IO ()\nrun (WithBehavior {..}) = print foo &gt;&gt; behavior bee\n</code></pre>\n\n<p>I wish select at runtime</p>\n\n<pre><code>selectedBee x = case x of\n                  \"A\" -&gt; makeBehaviorA\n                  \"B\" -&gt; makeBehaviorB\n                  ...\nwithBehavior x = makeWithBehavior (selectedBee x)\n</code></pre>\n\n<p>but I'm lost into a maze of extensions, type dependencies and others :(</p>\n\n<p>I cannot set the proper type for <code>selectedBee</code> function.</p>\n\n<p>Any help will be appreciated! :)</p>\n\n<p>(Using <code>GADTs</code>, but without additional <code>a</code> type parameters!)</p>\n\n<pre><code>{-# LANGUAGE RecordWildCards #-}\n{-# LANGUAGE GADTs #-}\n\nimport System.Environment\nimport Control.Applicative\n\nclass Behavior k where\n  behavior' :: k -&gt; IO ()\n\ndata BehaviorInstance where\n  BehaviorInstance :: Behavior b =&gt; b -&gt; BehaviorInstance\n\nbehavior :: BehaviorInstance -&gt; IO ()\nbehavior (BehaviorInstance b) = behavior' b\n\ndata BehaviorA = BehaviorA\ninstance Behavior BehaviorA where\n  behavior' _ = print \"Behavior A!\"\nmakeBehaviorA :: BehaviorInstance\nmakeBehaviorA = BehaviorInstance BehaviorA\n\ndata BehaviorB = BehaviorB\ninstance Behavior BehaviorB where\n  behavior' _ = print \"Behavior B!\"\nmakeBehaviorB :: BehaviorInstance\nmakeBehaviorB = BehaviorInstance BehaviorB\n\ndata WithBehavior =\n  WithBehavior { foo :: String\n               , bee :: BehaviorInstance\n               }\n\nrun :: WithBehavior -&gt; IO ()\nrun (WithBehavior {..}) = print foo &gt;&gt; behavior bee\n\nmain = do\n  n &lt;- head &lt;$&gt; getArgs\n  let be = case n of\n            \"A\" -&gt; makeBehaviorA\n            _   -&gt; makeBehaviorB\n  run $ WithBehavior \"Foo Message!\" be\n</code></pre>\n"}, {"tags": ["haskell", "cabal", "cabal-install", "package-management", "haskell-stack"], "comments": [{"owner": {"reputation": 28156, "user_id": 1026, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ea331e778d54effc15b5fbc694bc8232?s=128&d=identicon&r=PG", "display_name": "Nickolay", "link": "https://stackoverflow.com/users/1026/nickolay"}, "edited": false, "score": 4, "creation_date": 1525179052, "post_id": 31030438, "comment_id": 87250764, "body": "For those looking to <i>add a dependency</i> (i.e. use another package, like <code>text</code>, in your code): <a href=\"https://lexi-lambda.github.io/blog/2018/02/10/an-opinionated-guide-to-haskell-in-2018/#understanding-stacks-model-and-avoiding-its-biggest-gotcha\" rel=\"nofollow noreferrer\">Understanding stack\u2019s model and avoiding its biggest gotcha: <b>You almost certainly do not want to use <code>stack install</code></b></a>; per <a href=\"https://docs.haskellstack.org/en/stable/GUIDE/#adding-dependencies\" rel=\"nofollow noreferrer\"><code>stack</code> docs</a> you have to hand-edit <code>package.yaml</code> to add the package to the <code>dependencies</code> section."}], "answers": [{"comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 15, "creation_date": 1435202889, "post_id": 31031858, "comment_id": 50104724, "body": "Probably worth adding that <code>stack install hakyll</code> all by itself is probably sufficient to get the desired result."}, {"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 1, "creation_date": 1493050655, "post_id": 31031858, "comment_id": 74235849, "body": "I think it&#39;s worth mentioning that this method is typically only done when the desired version of the package is not present in the selected snapshot. I believe the preferred method of package installation for a project is adding it to the <code>*.cabal</code> file&#39;s <code>build-depends</code>, or running <code>stack install hakyll</code> to test it out first."}], "tags": [], "owner": {"reputation": 479, "user_id": 1050182, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/bfgX0.jpg?s=128&g=1", "display_name": "Yuan Wang", "link": "https://stackoverflow.com/users/1050182/yuan-wang"}, "is_accepted": false, "score": 16, "last_activity_date": 1437155584, "last_edit_date": 1437155584, "creation_date": 1435162806, "answer_id": 31031858, "question_id": 31030438, "link": "https://stackoverflow.com/questions/31030438/how-to-install-a-package-using-stack/31031858#31031858", "title": "How to install a package using stack?", "body": "<p>add hakyll in stack.yaml generated by <code>stack init</code> or <code>stack new</code></p>\n\n<p>yaml file should look like:</p>\n\n<pre><code>flags: {}\npackages:\n  - '.'\nextra-deps:\n  - hakyll-4.7.1.0\nresolver: lts-2.15\n</code></pre>\n\n<p>after that, run <code>stack solver</code> installs it</p>\n\n<p><a href=\"https://github.com/commercialhaskell/stack/wiki/stack.yaml\">https://github.com/commercialhaskell/stack/wiki/stack.yaml</a></p>\n"}, {"comments": [{"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 1, "creation_date": 1477382570, "post_id": 31765988, "comment_id": 67731348, "body": "what about installing packages that are only on hackage but not on stackage? Is the preferred method to install <code>cabal-install</code> or to download the tarball and <code>stack install</code> it?"}, {"owner": {"reputation": 1431, "user_id": 322513, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eeebf109a7781a1414597ad8275ae806?s=128&d=identicon&r=PG", "display_name": "Slaus", "link": "https://stackoverflow.com/users/322513/slaus"}, "edited": false, "score": 1, "creation_date": 1580796160, "post_id": 31765988, "comment_id": 106205296, "body": "I tried <b>stack install accelerate-examples</b> and got huge <b>Error: While constructing the build plan, the following exceptions were encountered</b> which goes recursively when trying to fix it. Couldn&#39;t even google what the stack build plans are."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2913694"}, "is_accepted": false, "score": 54, "last_activity_date": 1549232353, "last_edit_date": 1549232353, "creation_date": 1438461295, "answer_id": 31765988, "question_id": 31030438, "link": "https://stackoverflow.com/questions/31030438/how-to-install-a-package-using-stack/31765988#31765988", "title": "How to install a package using stack?", "body": "<pre><code>stack install hakyll\n</code></pre>\n\n<p><code>stack</code> offers a curated set of packages that won't blow your machine up. If you want to check what packages are available, or exactly what version is supported, or on what version of <code>GHC</code> you can get it, check out <a href=\"https://www.stackage.org/\" rel=\"noreferrer\">https://www.stackage.org/</a>.</p>\n\n<p>For example, you can get <code>hakyll 4.6.9.0</code> right now for both <code>GHC 7.8.4</code> and <code>GHC 7.10.1</code>. Pretty neat. - <a href=\"https://www.stackage.org/lts-2.20/package/hakyll-4.6.9.0\" rel=\"noreferrer\">source</a></p>\n\n<p><strong>EDIT</strong>: I forgot to mention, Yuan Wang's method works for getting the version of <code>hakyll</code> that is not curated into <code>stackage</code>. It's up to you what version you need.</p>\n"}], "owner": {"reputation": 2862, "user_id": 2613769, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/200dde59bd0be1e302c0d89ed34f5081?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/2613769/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30028, "favorite_count": 8, "answer_count": 2, "score": 62, "last_activity_date": 1549232353, "creation_date": 1435158975, "last_edit_date": 1435193721, "question_id": 31030438, "link": "https://stackoverflow.com/questions/31030438/how-to-install-a-package-using-stack", "title": "How to install a package using stack?", "body": "<p>Using cabal, I could install hakyll with the command:</p>\n\n<pre><code>cabal install hakyll\n</code></pre>\n\n<p>How can I do the same thing using stack?</p>\n"}, {"tags": ["haskell", "cabal-install", "bytestring", "aeson"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1435134572, "post_id": 31021393, "comment_id": 50068096, "body": "<code>bytestring</code> is a dependency of <code>aeson</code>. So remove <code>bytestring</code> and install <code>aeson</code> itself."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4223038"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1435135124, "post_id": 31021393, "comment_id": 50068422, "body": "@Sibi, I removed bytestring. Now <code>cabal install aeson</code> will point me to the second error (related to bytestring). Any suggestions?"}, {"owner": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "edited": false, "score": 0, "creation_date": 1435135540, "post_id": 31021393, "comment_id": 50068672, "body": "Try <code>cabal install --reinstall --force-reinstalls aeson</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4223038"}, "reply_to_user": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "edited": false, "score": 0, "creation_date": 1435135906, "post_id": 31021393, "comment_id": 50068897, "body": "@thoferon, that didn&#39;t work. Gives me the second error (related to bytestring)."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1435135994, "post_id": 31021393, "comment_id": 50068945, "body": "How did you remove <code>bytestring</code> ? Can you paste the output of <code>ghc-pkg list</code> ?"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 2, "creation_date": 1435136208, "post_id": 31021393, "comment_id": 50069080, "body": "Did you modify your ~/.cabal/config file with constraints (possibly from a Stackage snapshot)? It looks like you have constraints in place which are incompatible with the GHC version you&#39;re using."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4223038"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1435137118, "post_id": 31021393, "comment_id": 50069690, "body": "@Michael Snoyman, I had  <code>~&#47;.cabal</code> removed, and have not modified anything."}, {"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 3, "creation_date": 1435148769, "post_id": 31021393, "comment_id": 50077576, "body": "Under normal circumstances, <code>cabal</code> does not apply a constraint for <code>bytestring</code> to use an installed instance. This constraint must come from somewhere. Either a cabal config file, or a sandbox, or a command line flag, or ..."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1435163058, "post_id": 31021393, "comment_id": 50088387, "body": "Based on your ghc-pkg output it looks like you&#39;ve been installing packages globally as root. This is a bad idea if you don&#39;t know what you&#39;re doing. You should delete and reinstall GHC completely and then install packages locally as a regular user."}], "answers": [{"tags": [], "owner": {"reputation": 4565, "user_id": 1134885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c428466054762cf7d4b5fb5f4396fa2?s=128&d=identicon&r=PG", "display_name": "NovaDenizen", "link": "https://stackoverflow.com/users/1134885/novadenizen"}, "is_accepted": false, "score": 1, "last_activity_date": 1435171597, "creation_date": 1435171597, "answer_id": 31034564, "question_id": 31021393, "link": "https://stackoverflow.com/questions/31021393/what-can-be-done-to-resolve-this-dependency-issue/31034564#31034564", "title": "What can be done to resolve this dependency issue?", "body": "<p>Where is your constraint (<code>global constraint\nrequires ==0.8.0.2</code>) coming from?</p>\n\n<pre><code>~/prog$ cd\n~$ mkdir sbox\n~$ cd sbox\n~/sbox$ HOME=`pwd`\n~$ export HOME\n~$ cabal install bytestring\nConfig file path source is default config file.\nConfig file /home/novadenizen/sbox/.cabal/config not found.\nWriting default configuration to /home/novadenizen/sbox/.cabal/config\nWarning: The package list for 'hackage.haskell.org' does not exist. Run 'cabal\nupdate' to download it.\ncabal: There is no package named 'bytestring'.\nYou may need to run 'cabal update' to get the latest list of available\npackages.\n~$ cabal update\nDownloading the latest package list from hackage.haskell.org\n~$ cabal install aeson\nResolving dependencies...\nDownloading bytestring-0.10.6.0...\nDownloading dlist-0.7.1.1...\nConfiguring dlist-0.7.1.1...\nDownloading syb-0.5.1...\nDownloading transformers-0.4.3.0...\nConfiguring syb-0.5.1...\nBuilding dlist-0.7.1.1...\nBuilding syb-0.5.1...\nInstalled dlist-0.7.1.1\nConfiguring bytestring-0.10.6.0...\nBuilding bytestring-0.10.6.0...\nConfiguring transformers-0.4.3.0...\nInstalled syb-0.5.1\nBuilding transformers-0.4.3.0...\nInstalled transformers-0.4.3.0\nDownloading mtl-2.2.1...\nDownloading primitive-0.6...\nConfiguring primitive-0.6...\nBuilding primitive-0.6...\nConfiguring mtl-2.2.1...\nInstalled primitive-0.6\nDownloading vector-0.10.12.3...\nBuilding mtl-2.2.1...\nConfiguring vector-0.10.12.3...\nInstalled mtl-2.2.1\nBuilding vector-0.10.12.3...\nInstalled bytestring-0.10.6.0\nDownloading binary-0.7.5.0...\nConfiguring binary-0.7.5.0...\nBuilding binary-0.7.5.0...\nInstalled binary-0.7.5.0\nDownloading text-1.2.1.1...\nConfiguring text-1.2.1.1...\nBuilding text-1.2.1.1...\nInstalled vector-0.10.12.3\nInstalled text-1.2.1.1\nDownloading hashable-1.2.3.2...\nConfiguring hashable-1.2.3.2...\nBuilding hashable-1.2.3.2...\nInstalled hashable-1.2.3.2\nDownloading scientific-0.3.3.8...\nDownloading unordered-containers-0.2.5.1...\nConfiguring scientific-0.3.3.8...\nConfiguring unordered-containers-0.2.5.1...\nBuilding scientific-0.3.3.8...\nBuilding unordered-containers-0.2.5.1...\nInstalled scientific-0.3.3.8\nDownloading attoparsec-0.13.0.0...\nConfiguring attoparsec-0.13.0.0...\nBuilding attoparsec-0.13.0.0...\nInstalled unordered-containers-0.2.5.1\nInstalled attoparsec-0.13.0.0\nDownloading aeson-0.9.0.1...\nConfiguring aeson-0.9.0.1...\nBuilding aeson-0.9.0.1...\nInstalled aeson-0.9.0.1\n~$\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4223038"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1435171597, "creation_date": 1435134205, "last_edit_date": 1435137533, "question_id": 31021393, "link": "https://stackoverflow.com/questions/31021393/what-can-be-done-to-resolve-this-dependency-issue", "title": "What can be done to resolve this dependency issue?", "body": "<p>I'm trying to install <code>aeson</code> after resetting <code>~/.ghc</code> and <code>~/.cabal</code>.</p>\n\n<p><code>cabal install aeson</code> gives me the following error message:</p>\n\n<pre><code>Resolving dependencies...\ncabal: Could not resolve dependencies:\nnext goal: aeson (user goal)\nrejecting: aeson-0.9.0.1, 0.9.0.0, 0.8.1.1, 0.8.1.0 (global constraint\nrequires ==0.8.0.2)\ntrying: aeson-0.8.0.2\nnext goal: bytestring (user goal)\nrejecting: bytestring-0.10.6.0, 0.10.4.1, 0.10.4.0, 0.10.2.0 (global\nconstraint requires installed instance)\nrejecting: bytestring-0.10.0.2/installed-4f9... (conflict: aeson =&gt;\nbytestring&gt;=0.10.4.0)\nrejecting: bytestring-0.10.0.2, 0.10.0.1, 0.10.0.0, 0.9.2.1, 0.9.2.0,\n0.9.1.10, 0.9.1.9, 0.9.1.8, 0.9.1.7, 0.9.1.6, 0.9.1.5, 0.9.1.4, 0.9.1.3,\n0.9.1.2, 0.9.1.1, 0.9.1.0, 0.9.0.4, 0.9.0.3, 0.9.0.2, 0.9.0.1, 0.9 (global\nconstraint requires installed instance)\nDependency tree exhaustively searched.\n</code></pre>\n\n<p>The current version of <code>bytestring</code> package in my system is <code>0.10.2.0</code>. I tried <code>cabal install bytestring --reinstall</code> so that I can have a more recent version of bytestring (thereby solving aeson dependency issue). But that returns a very odd error:</p>\n\n<pre><code>Resolving dependencies...\ncabal: Could not resolve dependencies:\nnext goal: bytestring (user goal)\nrejecting: bytestring-0.10.6.0, 0.10.4.1, 0.10.4.0, 0.10.2.0, 0.10.0.2,\n0.10.0.1, 0.10.0.0, 0.9.2.1, 0.9.2.0, 0.9.1.10, 0.9.1.9, 0.9.1.8, 0.9.1.7,\n0.9.1.6, 0.9.1.5, 0.9.1.4, 0.9.1.3, 0.9.1.2, 0.9.1.1, 0.9.1.0, 0.9.0.4,\n0.9.0.3, 0.9.0.2, 0.9.0.1, 0.9 (global constraint requires installed instance)\nDependency tree exhaustively searched.\n</code></pre>\n\n<p>I can solve the problem by using sandboxes. But I'm interested to know if there is a nicer method resolve the dependency issue.</p>\n\n<hr>\n\n<p><strong>Update</strong>: Following a suggestion, I removed <code>bytestring</code> by <code>ghc-pkg unregister --force bytestring</code>, which broke some packages and am still not able to install aeson.</p>\n\n<p>Following is the output of <code>ghc-pkg list</code> lists: <a href=\"http://lpaste.net/135108\" rel=\"nofollow\">http://lpaste.net/135108</a>.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 12813, "user_id": 40569, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e536b92667e2150c01628f4031974fa2?s=128&d=identicon&r=PG", "display_name": "yogsototh", "link": "https://stackoverflow.com/users/40569/yogsototh"}, "is_accepted": true, "score": 6, "last_activity_date": 1508110156, "last_edit_date": 1508110156, "creation_date": 1435136496, "answer_id": 31022191, "question_id": 31021378, "link": "https://stackoverflow.com/questions/31021378/haskell-http-conduit/31022191#31022191", "title": "Haskell http-conduit", "body": "<p>You certainly simply need to add a User-Agent Header. </p>\n\n<pre><code>simpleHTTPWithUserAgent :: String -&gt; IO ()\nsimpleHTTPWithUserAgent url = do\n    r  &lt;- parseUrl url\n    let request = r {requestHeaders = [(\"User-Agent\",\"HTTP-Conduit\")]}\n    let settings = mkManagerSettings (TLSSettingsSimple True False False) Nothing\n    res &lt;- withManagerSettings settings $ httpLbs request\n    print res\n</code></pre>\n\n<p>You might replace \"HTTP-Conduit\" by a Firefox one.</p>\n"}], "owner": {"reputation": 53, "user_id": 4378046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b21558618afa4372635ba66592f561?s=128&d=identicon&r=PG&f=1", "display_name": "birdlife", "link": "https://stackoverflow.com/users/4378046/birdlife"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 31022191, "answer_count": 1, "score": 2, "last_activity_date": 1508110156, "creation_date": 1435134166, "question_id": 31021378, "link": "https://stackoverflow.com/questions/31021378/haskell-http-conduit", "title": "Haskell http-conduit", "body": "<p>Im using http-conduit to get a web page.</p>\n\n<pre><code>import Network.Connection (TLSSettings (..))\nimport Network.HTTP.Conduit\n\nmain :: IO ()\nmain = do\n    request &lt;- parseUrl \"https://somesites.com\"\n    let settings = mkManagerSettings (TLSSettingsSimple True False False) Nothing\n    res &lt;- withManagerSettings settings $ httpLbs request\n    print res\n</code></pre>\n\n<p>I get this message</p>\n\n<pre><code>statusMessage = \"BadClient\"\n</code></pre>\n\n<p>and i couldn't see the response body</p>\n\n<p>What is wrong here?\nI'm guessing that the server doesn't like non-browser access.\nIs there anyway i can masquerade as a firefox browser for example?</p>\n"}, {"tags": ["haskell", "haskell-wai", "servant"], "comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 1, "creation_date": 1435132507, "post_id": 31020207, "comment_id": 50066930, "body": "For the first one, I think you need to add wai-app-static to the build-depends in your .cabal file."}, {"owner": {"reputation": 1954, "user_id": 110844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4afd458cb202c0a2e566e569f753765?s=128&d=identicon&r=PG", "display_name": "Ecognium", "link": "https://stackoverflow.com/users/110844/ecognium"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1435161968, "post_id": 31020207, "comment_id": 50087622, "body": "Thanks, Michael. I actually I had put the package in the wrong cabal file. So wai-middleware-static works well. I am playing with the code in the linked blog post and I noticed it chains middlewares so decided to use the static middleware. It probably will take me longer to figure out how to use <code>wai-app-static</code> in that context."}, {"owner": {"reputation": 1044, "user_id": 193424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba6dfa8271fb1cd0c475a2c0626853?s=128&d=identicon&r=PG", "display_name": "Alp Mestanogullari", "link": "https://stackoverflow.com/users/193424/alp-mestanogullari"}, "edited": false, "score": 0, "creation_date": 1435245604, "post_id": 31020207, "comment_id": 50130065, "body": "@Ecognium Have you seen <a href=\"https://haskell-servant.github.io/tutorial/server.html#serving-static-files\" rel=\"nofollow noreferrer\">this part</a> of the servant tutorial?"}, {"owner": {"reputation": 1954, "user_id": 110844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4afd458cb202c0a2e566e569f753765?s=128&d=identicon&r=PG", "display_name": "Ecognium", "link": "https://stackoverflow.com/users/110844/ecognium"}, "reply_to_user": {"reputation": 1044, "user_id": 193424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba6dfa8271fb1cd0c475a2c0626853?s=128&d=identicon&r=PG", "display_name": "Alp Mestanogullari", "link": "https://stackoverflow.com/users/193424/alp-mestanogullari"}, "edited": false, "score": 0, "creation_date": 1435249865, "post_id": 31020207, "comment_id": 50133037, "body": "@AlpMestanogullari Yup but I only understood some parts of it. I got the <code>:Raw</code> and <code>serveDirectory</code> parts and since I was building on top of the tutorial, which uses Wai and I tried using it with it directly. I just added <code>:&lt;|&gt; &quot;static&quot; :&gt; Raw</code> and <code>:&lt;|&gt; serveDirectory &quot;&#47;static&quot;</code> and I get the error listed above. May be I need to understand more of the setup to figure out how to integrate with Wai. I tried <code>lifting</code> the serveDirectory call but did not help. I am just guessing at this stage :)"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1435283521, "post_id": 31020207, "comment_id": 50147444, "body": "Can you add a minimal but complete example? The error message suggests that this will need a well-placed <code>lift</code> but it&#39;s hard to tell without being able to look at the whole code."}, {"owner": {"reputation": 1044, "user_id": 193424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba6dfa8271fb1cd0c475a2c0626853?s=128&d=identicon&r=PG", "display_name": "Alp Mestanogullari", "link": "https://stackoverflow.com/users/193424/alp-mestanogullari"}, "edited": false, "score": 0, "creation_date": 1435310138, "post_id": 31020207, "comment_id": 50157956, "body": "@Ecognium I think you&#39;re just using the wrong <code>serveDirectory</code>. The one from <code>Network.Wai.Middleware.Static</code> is actually &quot;lifted&quot; into a proper request handler that&#39;ll serve static files under some directory within <i>servant</i> already. Just do not import <code>Network.Wai.Middleware.Static</code> and simply write <a href=\"https://hackage.haskell.org/package/servant-server-0.4.2/docs/Servant-Utils-StaticFiles.html#v:serveDirectory\" rel=\"nofollow noreferrer\">serveDirectory</a> &quot;/path/to/your/static/dir&quot;. As long as you import <code>Servant</code> or <code>Servant.Utils.StaticFiles</code>, this will work."}, {"owner": {"reputation": 1954, "user_id": 110844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4afd458cb202c0a2e566e569f753765?s=128&d=identicon&r=PG", "display_name": "Ecognium", "link": "https://stackoverflow.com/users/110844/ecognium"}, "reply_to_user": {"reputation": 1044, "user_id": 193424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba6dfa8271fb1cd0c475a2c0626853?s=128&d=identicon&r=PG", "display_name": "Alp Mestanogullari", "link": "https://stackoverflow.com/users/193424/alp-mestanogullari"}, "edited": false, "score": 0, "creation_date": 1435342216, "post_id": 31020207, "comment_id": 50177692, "body": "@AlpMestanogullari @Cactus, here is toned down version of Matt&#39;s code from his blog. <a href=\"https://gist.github.com/anonymous/a99bc6b36ac2db64878e\" rel=\"nofollow noreferrer\">gist.github.com/anonymous/a99bc6b36ac2db64878e</a>. I consolidated all his modules into a single file, removed all the database stuff but did not clean up the extensions/imports. When I run this code I get the above type mismatch error. Please note that this code does not use <code>Network.Wai.Middleware.Static</code> and I am using qualified import of Servant StaticFiles."}, {"owner": {"reputation": 1044, "user_id": 193424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba6dfa8271fb1cd0c475a2c0626853?s=128&d=identicon&r=PG", "display_name": "Alp Mestanogullari", "link": "https://stackoverflow.com/users/193424/alp-mestanogullari"}, "edited": false, "score": 1, "creation_date": 1435396433, "post_id": 31020207, "comment_id": 50191222, "body": "@Ecognium The <code>enter</code> machinery converts your handlers from some monad to another. Your <code>Reader</code>-based server has a <code>Raw</code>  in it for file serving, so <code>enter</code> tries to convert the file-serving thing from <code>ReaderT ...</code> to <code>EitherT ...</code>, which won&#39;t work because <code>serveDirectory</code> doesn&#39;t live in <code>ReaderT</code>. I&#39;m not sure if this is a bug in servant or if it&#39;s really more meaningful to define the file-serving handler separately, apart from all the <code>ReaderT</code> ones. I have notified the other servant devs. <a href=\"https://gist.github.com/anonymous/a99bc6b36ac2db64878e#comment-1481760\" rel=\"nofollow noreferrer\">In the meantime.</a>"}, {"owner": {"reputation": 1954, "user_id": 110844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4afd458cb202c0a2e566e569f753765?s=128&d=identicon&r=PG", "display_name": "Ecognium", "link": "https://stackoverflow.com/users/110844/ecognium"}, "reply_to_user": {"reputation": 1044, "user_id": 193424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba6dfa8271fb1cd0c475a2c0626853?s=128&d=identicon&r=PG", "display_name": "Alp Mestanogullari", "link": "https://stackoverflow.com/users/193424/alp-mestanogullari"}, "edited": false, "score": 0, "creation_date": 1435428177, "post_id": 31020207, "comment_id": 50200142, "body": "@AlpMestanogullari Thank you. Do you mind putting that as the answer and I will accept it? I have not spent much time trying to understand how the whole sever was constructed and was just pattern matching based on what others have done. It has worked ok so far but shows I need to really learn how things work together to make changes to other people&#39;s code."}, {"owner": {"reputation": 1044, "user_id": 193424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba6dfa8271fb1cd0c475a2c0626853?s=128&d=identicon&r=PG", "display_name": "Alp Mestanogullari", "link": "https://stackoverflow.com/users/193424/alp-mestanogullari"}, "edited": false, "score": 1, "creation_date": 1435487850, "post_id": 31020207, "comment_id": 50213039, "body": "@Ecognium Sure, I&#39;ll try and write up a minimal complete answer. For more questions, feel free to drop by the <b>#servant</b> IRC channel on freenode, I would gladly give a shot at some more explanations in real time."}, {"owner": {"reputation": 1044, "user_id": 193424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba6dfa8271fb1cd0c475a2c0626853?s=128&d=identicon&r=PG", "display_name": "Alp Mestanogullari", "link": "https://stackoverflow.com/users/193424/alp-mestanogullari"}, "edited": false, "score": 0, "creation_date": 1438187166, "post_id": 31020207, "comment_id": 51350519, "body": "Note that this is now <a href=\"https://github.com/haskell-servant/servant/issues/157\" rel=\"nofollow noreferrer\">an issue</a> with a very simple solution that should be included in the next release."}], "answers": [{"comments": [{"owner": {"reputation": 1476, "user_id": 700597, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/rWtor.jpg?s=128&g=1", "display_name": "runeks", "link": "https://stackoverflow.com/users/700597/runeks"}, "edited": false, "score": 0, "creation_date": 1473870760, "post_id": 31098944, "comment_id": 66308434, "body": "Thanks a lot for this!"}, {"owner": {"reputation": 75, "user_id": 8019153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cca235a4944c390779143d3261b0bf6?s=128&d=identicon&r=PG&f=1", "display_name": "Adam G\u0142owacki", "link": "https://stackoverflow.com/users/8019153/adam-g%c5%82owacki"}, "edited": false, "score": 0, "creation_date": 1617048151, "post_id": 31098944, "comment_id": 118188136, "body": "The link is broken :-("}, {"owner": {"reputation": 1044, "user_id": 193424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba6dfa8271fb1cd0c475a2c0626853?s=128&d=identicon&r=PG", "display_name": "Alp Mestanogullari", "link": "https://stackoverflow.com/users/193424/alp-mestanogullari"}, "reply_to_user": {"reputation": 75, "user_id": 8019153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cca235a4944c390779143d3261b0bf6?s=128&d=identicon&r=PG&f=1", "display_name": "Adam G\u0142owacki", "link": "https://stackoverflow.com/users/8019153/adam-g%c5%82owacki"}, "edited": false, "score": 1, "creation_date": 1617138804, "post_id": 31098944, "comment_id": 118219377, "body": "@AdamG\u0142owacki Things have changed a bit since that reply, but this is the documentation you&#39;ll want to take a look at, to see how it&#39;s done nowadays: <a href=\"https://docs.servant.dev/en/stable/tutorial/Server.html#using-another-monad-for-your-handlers\" rel=\"nofollow noreferrer\">docs.servant.dev/en/stable/tutorial/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1044, "user_id": 193424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba6dfa8271fb1cd0c475a2c0626853?s=128&d=identicon&r=PG", "display_name": "Alp Mestanogullari", "link": "https://stackoverflow.com/users/193424/alp-mestanogullari"}, "is_accepted": true, "score": 8, "last_activity_date": 1435488602, "creation_date": 1435488602, "answer_id": 31098944, "question_id": 31020207, "link": "https://stackoverflow.com/questions/31020207/serving-static-files-with-servant-wai/31098944#31098944", "title": "Serving Static Files With Servant / Wai", "body": "<p>As described <a href=\"https://haskell-servant.github.io/tutorial/server.html#using-another-monad-for-your-handlers\">in the relevant section of servant's tutorial</a>, the whole deal with <code>enter</code> is to have your request handlers use some monad <code>m</code> (in your case some <code>ReaderT</code> monad) and to provide a way to convert a computation in <code>m</code> to a computation in <em>servant</em>'s standard <code>EitherT ServantErr IO</code> monad.</p>\n\n<p>The problem here though is that you define a bunch of request handlers in <code>ReaderT</code> <strong>and</strong> an additional one to serve static files, and call <code>enter</code> on all of these. The <code>ReaderT</code> handlers are converted to <code>EitherT ...</code> handlers just fine, but <code>enter</code> tries to convert the <code>serveDirectory</code> call from <code>ReaderT ...</code> to <code>EitherT ...</code>. This is of course not going to happen anytime soon, since <code>serveDirectory</code> isn't a computation in <code>ReaderT ...</code> to begin with!</p>\n\n<p><em>servant</em> could arguably just leave <code>serveDirectory</code> alone -- at this point I don't have a definite opinion on whether we should do that or not, or if it's better to just have the file-serving handler be glued separately, to the result of calling <code>enter</code> on all the other endpoints. Here's how this would look like (look for <em>-- NEW</em> to see the changes):</p>\n\n<pre><code>type PersonAPI = \n    \"users\" :&gt; Capture \"name\" String :&gt; Get '[JSON] Person\n   -- NEW: removed Raw from here\n\n-- NEW\ntype WholeAPI = PersonAPI :&lt;|&gt; Raw\n\ntype AppM = ReaderT Config (EitherT ServantErr IO)\n\nuserAPI :: Proxy PersonAPI\nuserAPI = Proxy\n\n-- NEW\nwholeAPI :: Proxy WholeAPI\nwholeAPI = Proxy\n\n-- NEW: changed 'userAPI' to 'wholeAPI'\napp :: Config -&gt; Application\napp cfg = serve wholeAPI (readerServer cfg)\n\nreaderServer :: Config -&gt; Server WholeAPI\nreaderServer cfg = enter (readerToEither cfg) server\n              :&lt;|&gt; S.serveDirectory \"/static\" -- NEW\n\nreaderToEither :: Config -&gt; AppM :~&gt; EitherT ServantErr IO\nreaderToEither cfg = Nat $ \\x -&gt; runReaderT x cfg\n\nserver :: ServerT PersonAPI AppM\nserver = singlePerson\n\nsinglePerson :: String -&gt; AppM Person\nsinglePerson str = do\n    let person = Person { name = \"Joe\", email = \"joe@example.com\" }\n    return person\n</code></pre>\n\n<p>I have brought this topic to the attention of the other servant developers anyway, thanks! We hadn't really thought about the interaction between <code>enter</code> and <code>serveDirectory</code> so far (well, I did not).</p>\n"}], "owner": {"reputation": 1954, "user_id": 110844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4afd458cb202c0a2e566e569f753765?s=128&d=identicon&r=PG", "display_name": "Ecognium", "link": "https://stackoverflow.com/users/110844/ecognium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2556, "favorite_count": 3, "accepted_answer_id": 31098944, "answer_count": 1, "score": 7, "last_activity_date": 1456806936, "creation_date": 1435130434, "last_edit_date": 1456806936, "question_id": 31020207, "link": "https://stackoverflow.com/questions/31020207/serving-static-files-with-servant-wai", "title": "Serving Static Files With Servant / Wai", "body": "<p>I am following this tutorial <a href=\"http://www.parsonsmatt.org/programming/2015/06/07/servant-persistent.html\" rel=\"nofollow\">http://www.parsonsmatt.org/programming/2015/06/07/servant-persistent.html</a> to create APIs through servant. I want to customize the server to serve static files as well but couldn't find a way to do it. </p>\n\n<p>I am using the <code>stack</code> build tool.</p>\n\n<p>I modified the <code>Main.hs</code> file's run to include <code>static</code> (<code>run port $ static $ logger $ app cfg</code>) and I imported <code>Network.Wai.Middleware.Static (static)</code>. I also added <code>wai-middleware-static &gt;=0.7.0 &amp;&amp; &lt; 0.71</code> to my cabal file. </p>\n\n<p><s> When I run <code>stack build</code> I get:  </s> (<strong>Update: This part is totally my error.</strong> I added the the package to the wrong cabal file.. lame. Importing Network.Wai.Middleware.Static works and serves static files. Leaving the error below in case anyone searches for it and finds it useful.)</p>\n\n<pre><code>Could not find module \u2018Network.Wai.Middleware.Static\u2019\nPerhaps you meant\n  Network.Wai.Middleware.Gzip (from wai-extra-3.0.7.1@waiex_GpotceEdscHD6hq9p0wPOJ)\n  Network.Wai.Middleware.Jsonp (from wai-extra-3.0.7.1@waiex_GpotceEdscHD6hq9p0wPOJ)\n  Network.Wai.Middleware.Local (from wai-extra-3.0.7.1@waiex_GpotceEdscHD6hq9p0wPOJ)\n</code></pre>\n\n<p>Next I tried using servant's <code>serveDirectory</code> as follows (simplified): </p>\n\n<pre><code>type  API = \"users\" :&gt; Get   '[JSON]   [Person]\n            :&lt;|&gt; \"static\" :&gt; Raw\nserver = createPerson :&lt;|&gt; serveDirectory \"/static\" \n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>Couldn't match type \u2018IO\u2019 with \u2018EitherT ServantErr IO\u2019\narising from a functional dependency between:\n  constraint \u2018Servant.Server.Internal.Enter.Enter\n                (IO Network.Wai.Internal.ResponseReceived)\n                (AppM :~&gt; EitherT ServantErr IO)\n                (IO Network.Wai.Internal.ResponseReceived)\u2019\n    arising from a use of \u2018enter\u2019\n  instance \u2018Servant.Server.Internal.Enter.Enter\n              (m a) (m :~&gt; n) (n a)\u2019\n    at &lt;no location info&gt;\nIn the expression: enter (readerToEither cfg) server\nIn an equation for \u2018readerServer\u2019:\n    readerServer cfg = enter (readerToEither cfg) server\n</code></pre>\n\n<p>I am a Haskell beginner and I am not familiar with Wai so unsure where to even begin. What changes do I need to make the example code in the Blog post to serve static files?</p>\n\n<p><strong>Edit</strong>: Since the comments get hidden from the default view, I am pasting my last comment here: </p>\n\n<p>Here is toned down version of Matt's <a href=\"http://blog.gist.github.com/anonymous/a99bc6b36ac2db64878e\" rel=\"nofollow\">code</a> from his blog. I consolidated all his modules into a single file, removed all the database stuff but did not clean up the extensions/imports. When I run this code I get the above type mismatch error. Please note that this code does not use Network.Wai.Middleware.Static and I am using qualified import of Servant StaticFiles.</p>\n\n<p>Thanks! </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1435133486, "post_id": 31021121, "comment_id": 50067491, "body": "True, though <code>-XLiberalTypeSynonyms</code> does allow partially applied type synonyms, under some circumstances. Not in this case, however."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1435158544, "post_id": 31021121, "comment_id": 50085092, "body": "Great answer! The <code>type-level lambdas</code> was exactly the type of intuition I was looking for."}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 1, "creation_date": 1435186675, "post_id": 31021121, "comment_id": 50100939, "body": "Type inference is undecidable with type level lambada."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 10, "last_activity_date": 1435219906, "last_edit_date": 1435219906, "creation_date": 1435133350, "answer_id": 31021121, "question_id": 31018528, "link": "https://stackoverflow.com/questions/31018528/composing-type-constructors-like-functions/31021121#31021121", "title": "Composing type constructors like functions", "body": "<blockquote>\n  <p>(I do know that <code>Control.Compose</code> exists, but it simply creates a\n  <code>newtype</code> wrapper - I would like a type synonym).</p>\n</blockquote>\n\n<p>This is not allowed in Haskell. A type synonym must be fully applied: you can't write <code>Compose t t'</code>, only <code>Compose t t' a</code>.</p>\n\n<p>Allowing partially applied type synonyms would lead to type-level lambdas, which makes type inference undecidable, hence the lack of support for it in Haskell.</p>\n\n<hr>\n\n<p>For instance, (enabling all the relevant GHC extensions)</p>\n\n<pre><code>type Compose t t' a = t (t' a)\ndata Proxy (k :: * -&gt; *) = Proxy\n\npr :: Proxy (Compose [] [])\npr = Proxy\n</code></pre>\n\n<p>results in:</p>\n\n<pre><code> Type synonym \u2018Compose\u2019 should have 3 arguments, but has been given 2\n    In the type signature for \u2018pr\u2019: pr :: Proxy (Compose [] [])\n</code></pre>\n\n<p>Similarly,</p>\n\n<pre><code>class C k where f :: k Int -&gt; Int\ninstance C (Compose [] []) where f _ = 6\n</code></pre>\n\n<p>yields:</p>\n\n<pre><code>Type synonym \u2018Compose\u2019 should have 3 arguments, but has been given 2\n    In the instance declaration for \u2018C (Compose [] [])\u2019\n</code></pre>\n\n<p>Here's an example where type synonym partial application <em>is</em> allowed, instead (enabling <code>LiberalTypeSynonyms</code>):</p>\n\n<pre><code>type T k = k Int\ntype S = T (Compose [] [])\n\nbar :: S -&gt; S\nbar = map (map succ)\n</code></pre>\n\n<p>Note however that this works only because after synonym expansion we get a fully applied type <code>[] ([] Int)</code> (i.e., <code>[[Int]]</code>). Roughly, this feature does not allow to do anything which one could have done without it, manually expanding the synonyms.</p>\n"}], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 465, "favorite_count": 1, "accepted_answer_id": 31021121, "answer_count": 1, "score": 8, "last_activity_date": 1435219906, "creation_date": 1435124839, "question_id": 31018528, "link": "https://stackoverflow.com/questions/31018528/composing-type-constructors-like-functions", "title": "Composing type constructors like functions", "body": "<p>I recently came across a situation where I wanted to be able to compose type constructors in an instance declaration. I would have liked to do this:</p>\n\n<pre><code>instance (SomeClass t, SomeClass t') =&gt; SomeClass (t . t') where\n</code></pre>\n\n<p>with <code>(t . t')</code> defined such that <code>(t . t') a = t (t' a)</code> (so <code>t</code> and <code>t'</code> have kind <code>* -&gt; *</code>. We can partially apply type constructors, like functions, so what is the reason we cannot compose them? Also, is there perhaps a workaround for what I was trying to achieve? Perhaps with equality constraints?</p>\n\n<p>(I do know that <a href=\"https://hackage.haskell.org/package/TypeCompose-0.6.7/docs/Control-Compose.html\">Control.Compose</a> exists, but it simply creates a <code>newtype</code> wrapper - I would like a type synonym).</p>\n"}, {"tags": ["haskell", "optimization", "memory-leaks", "ghc"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1435090007, "post_id": 31012133, "comment_id": 50051730, "body": "7.4 is pretty ancient at this point, at least use 7.8 if not 7.10.  To answer this you&#39;re probably going to have to pass <code>-ddump-simpl</code> to get the core output, then go through that to figure out exactly what the difference is."}, {"owner": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1435090376, "post_id": 31012133, "comment_id": 50051926, "body": "@bheklilr Done that. Of course the generated Core is very different, but it\u2019s really hard for a Haskell novice to untangle and so far I haven\u2019t succeeded."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1435091422, "post_id": 31012133, "comment_id": 50052537, "body": "and what happens with -O2 flag?"}, {"owner": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1435091576, "post_id": 31012133, "comment_id": 50052619, "body": "@WillNess Same as with <code>-O</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1435091699, "post_id": 31012133, "comment_id": 50052685, "body": "would running  <code>foldr (\\x-&gt;(* length (subst x))) 1 &quot;redistributables&quot;</code> be satisfactory?"}, {"owner": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1435092010, "post_id": 31012133, "comment_id": 50052863, "body": "@WillNess Thanks for the fold suggestion, but I\u2019m not solving an actual problem here, I\u2019m just playing with the language/runtime and trying to get a sense of what\u2019s going on, so I\u2019d like to find the cause."}, {"owner": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1435092041, "post_id": 31012133, "comment_id": 50052882, "body": "@WillNess <code>-fno-full-laziness</code> does not make a difference."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1435092392, "post_id": 31012133, "comment_id": 50053087, "body": "I get very similar results on 7.10.1."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1435092403, "post_id": 31012133, "comment_id": 50053097, "body": "<code>variants (c:cs) = variants cs &gt;&gt;= \\s-&gt; map (:s) (subst c)</code> ? <code>mapM subst</code> ?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1435092772, "post_id": 31012133, "comment_id": 50053315, "body": "It&#39;s hard to believe it&#39;s not full laziness, but there&#39;s also a difference in list comprehension desugaring depending on whether rules are enabled."}, {"owner": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1435092804, "post_id": 31012133, "comment_id": 50053342, "body": "@WillNess The former does the trick, the latter doesn\u2019t."}, {"owner": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1435093170, "post_id": 31012133, "comment_id": 50053576, "body": "@WillNess @dfeuer Oops, it turns out the relative order of <code>-O</code>  and <code>-fno-full-laziness</code> matters. When I give <code>-O -fno-full-laziness</code>, total memory usage drops back to 2M. Productivity is still only 46% though."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1435093497, "post_id": 31012133, "comment_id": 50053769, "body": "the trick is to cause the recomputation of suffixes, instead of their retention in memory. it&#39;s like with the <code>powerset (x:xs) = map (x:) (powerset xs) ++ powerset xs</code> definition, adding <code>where</code> clause is harmful. (or is it <code>powerset (x:xs) = powerset xs ++ map (x:) (powerset xs) </code> ?)"}, {"owner": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1435095557, "post_id": 31012133, "comment_id": 50054751, "body": "@WillNess Thank you. I can see how full laziness causes this problem. I can now see it in the Core, too. If you post an answer, I will accept. However, with <code>-fno-full-laziness</code> I still have the problem of productivity: the optimized version is 2.7 times slower, with GC copying 70 times more bytes. Would be great if you could comment on that as well. Or should I post it as a separate question?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1435098566, "post_id": 31012133, "comment_id": 50055903, "body": "What do the total allocation numbers look like?"}], "answers": [{"comments": [{"owner": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "edited": false, "score": 1, "creation_date": 1435171680, "post_id": 31014624, "comment_id": 50093557, "body": "Indeed, swapping <code>c&#39; &lt;- subst c</code> with <code>s&#39; &lt;- variants s</code> produces (under <code>-O2</code>) the best result for me: constant space and fast."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 3, "last_activity_date": 1435098721, "creation_date": 1435098721, "answer_id": 31014624, "question_id": 31012133, "link": "https://stackoverflow.com/questions/31012133/why-does-this-haskell-program-leak-space-when-compiled-with-optimizations/31014624#31014624", "title": "Why does this Haskell program leak space when compiled with optimizations?", "body": "<p>The trick is to cause the recomputation of suffixes, instead of their retention in memory. It's like with the </p>\n\n<pre><code>powerset (x:xs) = map (x:) (powerset xs) ++ powerset xs \n</code></pre>\n\n<p>definition, where adding the <code>where</code> clause is harmful (or is it <code>powerset (x:xs) = powerset xs ++ map (x:) (powerset xs)</code> ...?).</p>\n\n<p>In your case, the code to try is <code>mapM subst</code>, or</p>\n\n<pre><code>variants (c:cs) = variants cs &gt;&gt;= \\s-&gt; map (:s) (subst c) \n</code></pre>\n\n<p>You can see that the latter works in the \"opposite direction\" from your list comprehension code, so maybe just</p>\n\n<pre><code>variants (c:s) = [c':s' | s' &lt;- variants s, c' &lt;- subst c]\n</code></pre>\n\n<p>will work, too.</p>\n\n<p>All these are equivalent, so it's a compiler thing. Hopefully someone can provide more specifics about that.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 5, "last_activity_date": 1435108429, "last_edit_date": 1435108429, "creation_date": 1435100124, "answer_id": 31014841, "question_id": 31012133, "link": "https://stackoverflow.com/questions/31012133/why-does-this-haskell-program-leak-space-when-compiled-with-optimizations/31014841#31014841", "title": "Why does this Haskell program leak space when compiled with optimizations?", "body": "<p>You want</p>\n\n<pre><code>variants (c:s) = [c':s' | c' &lt;- subst c, s' &lt;- variants s]\n</code></pre>\n\n<p>to be compiled into an outer loop and an inner loop. But GHC sees that the inner loop does not depend in any way on the outer \"loop counter\". Therefore, the full laziness transformation lifts the inner loop out of the outer loop. One fairly effective trick is to hide the fact that the inner loop is independent. This is done by splitting the inner loop off into a separate function taking a dummy argument, and hiding the dumminess by marking the function as <code>NOINLINE</code>. Then you can call the function with the outer loop counter, and GHC will generally refrain from messing with you.</p>\n"}], "owner": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 1, "accepted_answer_id": 31014841, "answer_count": 2, "score": 6, "last_activity_date": 1435108429, "creation_date": 1435088815, "question_id": 31012133, "link": "https://stackoverflow.com/questions/31012133/why-does-this-haskell-program-leak-space-when-compiled-with-optimizations", "title": "Why does this Haskell program leak space when compiled with optimizations?", "body": "<p>Consider the following toy program that computes all combinations of character substitutions in a word, of the kind often used in passwords.</p>\n\n<pre><code>import Data.Char (isLower, toUpper)\n\nvariants :: String -&gt; [String]\nvariants \"\" = [\"\"]\nvariants (c:s) = [c':s' | c' &lt;- subst c, s' &lt;- variants s]\n  where subst 'a' = \"aA@\"\n        subst 'e' = \"eE3\"\n        subst 'i' = \"iI1\"\n        subst 'l' = \"lL1\"\n        subst 'o' = \"oO0\"\n        subst 's' = \"sS$5\"\n        subst 'z' = \"zZ2\"\n        subst x | isLower x = [x, toUpper x]\n        subst x = [x]\n\nmain :: IO ()\nmain = putStrLn $ show $ length $ variants \"redistributables\"\n</code></pre>\n\n<p>I compile it with and without optimizations:</p>\n\n<pre><code>$ ghc -fforce-recomp -Wall Test.hs -o test0\n[1 of 1] Compiling Main             ( Test.hs, Test.o )\nLinking test0 ...\n\n$ ghc -fforce-recomp -O -Wall Test.hs -o test1\n[1 of 1] Compiling Main             ( Test.hs, Test.o )\nLinking test1 ...\n</code></pre>\n\n<p>Now <code>test0</code> and <code>test1</code> produce the same output, but <code>test1</code> uses much more memory and spends most of its time in garbage collection:</p>\n\n<pre><code>$ ./test0 +RTS -s 2&gt;&amp;1 | grep total\n               2 MB total memory in use (0 MB lost due to fragmentation)\n  Productivity  93.2% of total user, 93.3% of total elapsed\n\n$ ./test1 +RTS -s 2&gt;&amp;1 | grep total\n             188 MB total memory in use (0 MB lost due to fragmentation)\n  Productivity  15.0% of total user, 15.0% of total elapsed\n</code></pre>\n\n<p>Why?</p>\n\n<p>I\u2019m using GHC 7.4.1; I should probably use a newer compiler, but this is what I have handy at the moment, and the fault probably lies with me anyway.</p>\n"}, {"tags": ["haskell", "routes", "yesod"], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 4, "last_activity_date": 1435110451, "creation_date": 1435110451, "answer_id": 31016262, "question_id": 31011940, "link": "https://stackoverflow.com/questions/31011940/yesod-catchall-route/31016262#31016262", "title": "Yesod catchall route", "body": "<p>You can use multi-piece routes, and will likely need overlap checking turned off. This would look like:</p>\n\n<pre><code>!/*Texts HomeR GET\n</code></pre>\n\n<p>For more information, see <a href=\"http://www.yesodweb.com/book/routing-and-handlers#routing-and-handlers_types_of_pieces\" rel=\"nofollow\">the routing chapter</a> of the Yesod book.</p>\n"}], "owner": {"reputation": 1883, "user_id": 988324, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e9a50cfb6dd20efd1198fdafc0b1c11a?s=128&d=identicon&r=PG", "display_name": "Richard Deurwaarder", "link": "https://stackoverflow.com/users/988324/richard-deurwaarder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 31016262, "answer_count": 1, "score": 2, "last_activity_date": 1435110451, "creation_date": 1435088228, "question_id": 31011940, "link": "https://stackoverflow.com/questions/31011940/yesod-catchall-route", "title": "Yesod catchall route", "body": "<p>I'm building a yesod app which consists of two parts. The rest api (yesod) and the client side (angularjs).</p>\n\n<p>Besides being a rest api, yesod also send the initial html to the client to start up angularjs. I have it working like this:</p>\n\n<p>config/routes:</p>\n\n<pre><code>/user GET\n/someOtherEntity GET POST\n/ HomeR GET --route to send the html\n</code></pre>\n\n<p>Handler/Home.hs</p>\n\n<pre><code>getHomeR :: Handler Html                                                                            \ngetHomeR = sendFile typeHtml \"frontend/build/index.html\" \n</code></pre>\n\n<p>As long as the first url is www.mydomain.com/ this works fine, but when I go to www.mydomain/some-angular/route I get a 404 from yesod.</p>\n\n<p>I've tried this:</p>\n\n<pre><code>/#Text HomeR GET\n</code></pre>\n\n<p>This works fine for /my-angular-route, but breaks on /my-angular-route/param. I could add /#Text/#Text I suppose, but surely there's a cleaner way of handling this.</p>\n\n<p>How can I implement some sort of catch all route? So whenever it's not an url which matches a route, it should just call getHomeR.</p>\n"}, {"tags": ["haskell", "recursion", "subsequence"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1435080295, "post_id": 31009249, "comment_id": 50045857, "body": "This function, as you&#39;ve conceived it, cannot be written in Haskell. Try to write the type signature and you&#39;ll see why. You will need to change the representation of the nested result in order to implement it."}, {"owner": {"reputation": 3669, "user_id": 4876946, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5dc4839a7e9466d54f3791122f8f5d75?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4876946/matt"}, "edited": false, "score": 3, "creation_date": 1435080366, "post_id": 31009249, "comment_id": 50045900, "body": "What is the expected output for some example inputs?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5041348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00a1cf915cf4baa974dc2ba1aaa5f473?s=128&d=identicon&r=PG&f=1", "display_name": "Legem", "link": "https://stackoverflow.com/users/5041348/legem"}, "edited": false, "score": 0, "creation_date": 1435081599, "post_id": 31009518, "comment_id": 50046697, "body": "It&#39;s a bit problematic cause i need to write as short code as it&#39;s possible. Maybe there is some way to make n-times long chain of subsequences calls (like <code>subsequences . subsequences . subsequences . </code> ...etc) ?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13, "user_id": 5041348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00a1cf915cf4baa974dc2ba1aaa5f473?s=128&d=identicon&r=PG&f=1", "display_name": "Legem", "link": "https://stackoverflow.com/users/5041348/legem"}, "edited": false, "score": 0, "creation_date": 1435082161, "post_id": 31009518, "comment_id": 50047050, "body": "@Legem, you could make that sort of thing work with fancy things like singletons, but I doubt it&#39;s worth the trouble. Changing result types would be much easier than that."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1435080518, "creation_date": 1435080518, "answer_id": 31009518, "question_id": 31009249, "link": "https://stackoverflow.com/questions/31009249/how-recursively-call-subsequences-in-haskell/31009518#31009518", "title": "How recursively call subsequences in haskell", "body": "<p>If I call your function with 1, it will return a list of lists of elements. If I call it with 2, it will return a list of lists of lists of elements. In a dependently typed language, this would be fine, but Haskell is not dependently typed, so you will need to represent the result in some other way, encoding the depth in the result type.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1435084064, "post_id": 31010337, "comment_id": 50048161, "body": "It&#39;s amazing how much easier polymorphic recursion is to read than to write. It does make certain kinds of things easier to think about though--induction tends to work very well, and parametricity is particularly strong--irrelevant things tend to fuzz out completely."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 5, "last_activity_date": 1435083044, "creation_date": 1435083044, "answer_id": 31010337, "question_id": 31009249, "link": "https://stackoverflow.com/questions/31009249/how-recursively-call-subsequences-in-haskell/31010337#31010337", "title": "How recursively call subsequences in haskell", "body": "<p>I haven't worked with polymorphic recursion much, so I wanted to try this.  Here's what I got:</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n\nimport Data.List (subsequences)\n\n-- Any multiply-nested list such as a, [a], [[a]], [[[a]]], ...\ndata MultiList a\n  = Leaf a\n  | Nest (MultiList [a])\n  deriving (Show, Functor)\n\nrecursive :: Int -&gt; [a] -&gt; MultiList [[a]]\nrecursive 1 list = Leaf (subsequences list)\nrecursive n list = Nest (fmap subsequences (recursive (n-1) list))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": false, "score": 3, "last_activity_date": 1435114056, "last_edit_date": 1435114056, "creation_date": 1435094017, "answer_id": 31013640, "question_id": 31009249, "link": "https://stackoverflow.com/questions/31009249/how-recursively-call-subsequences-in-haskell/31013640#31013640", "title": "How recursively call subsequences in haskell", "body": "<p>It's pretty straightforward with <a href=\"https://hackage.haskell.org/package/singletons\" rel=\"nofollow\">singletons</a>.</p>\n\n<pre><code>{-# LANGUAGE GADTs, DataKinds, TypeFamilies, UndecidableInstances, TemplateHaskell, TypeOperators #-}\n\nimport Data.List\nimport Data.Singletons.TH\nimport Data.Singletons.Prelude\nimport qualified GHC.TypeLits as Lit\n\n$(singletons [d| data Nat = Z | S Nat |])\n\ntype family Nested n a where\n    Nested  Z    a = a\n    Nested (S n) a = [Nested n a]\n\nsubsequenceses :: Sing n -&gt; [a] -&gt; [Nested n a]\nsubsequenceses  SZ     xs = xs\nsubsequenceses (SS sn) xs = subsequences (subsequenceses sn xs)\n\ntype family Lit i where\n    Lit 0 = Z\n    Lit n = S (Lit (n Lit.- 1))\n\ntype SLit n = Sing (Lit n)\n\nmain = print $ subsequenceses (sing :: SLit 2) [1..2]\n</code></pre>\n\n<p><code>subsequenceses (sing :: SLit 0) xs</code> is <code>xs</code></p>\n\n<p><code>subsequenceses (sing :: SLit 1) xs</code> is <code>subsequences xs</code></p>\n\n<p><code>subsequenceses (sing :: SLit 2) xs</code> is <code>subsequences (subsequences xs)</code></p>\n\n<p>and so on.</p>\n"}], "owner": {"reputation": 13, "user_id": 5041348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00a1cf915cf4baa974dc2ba1aaa5f473?s=128&d=identicon&r=PG&f=1", "display_name": "Legem", "link": "https://stackoverflow.com/users/5041348/legem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 31010337, "answer_count": 3, "score": 1, "last_activity_date": 1435114056, "creation_date": 1435079659, "question_id": 31009249, "link": "https://stackoverflow.com/questions/31009249/how-recursively-call-subsequences-in-haskell", "title": "How recursively call subsequences in haskell", "body": "<p>I tried to make recursive function which call the subsequences and I had got some errors.</p>\n\n<p>My Code:</p>\n\n<pre><code>recursive 1 list = subsequences list\nrecursive n list = subsequences (recursive (n-1) list)\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>Occurs check: cannot construct the infinite type: a1 ~ [a1]\n    Expected type: [a1]\n      Actual type: [[a1]]\n\n    Relevant bindings include\n      recursive :: a -&gt; t -&gt; [[a1]] (bound at p.hs:6:1)\n    In the first argument of \u2018subsequences\u2019, namely\n      \u2018(recursive (n - 1) list)\u2019\n    In the expression: subsequences (recursive (n - 1) list)\n</code></pre>\n\n<p>Could you help me to solve this problem or find another way to call subsequences n times?</p>\n\n<p>Sorry for my bad English</p>\n"}, {"tags": ["eclipse", "macos", "haskell", "eclipse-plugin", "eclipse-fp"], "comments": [{"owner": {"reputation": 102407, "user_id": 2670892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4iPV5.png?s=128&g=1", "display_name": "greg-449", "link": "https://stackoverflow.com/users/2670892/greg-449"}, "edited": false, "score": 0, "creation_date": 1435076210, "post_id": 31007784, "comment_id": 50043399, "body": "Look in the .log file in the workspace .metadata directory to see if there is a more detailed message"}, {"owner": {"reputation": 181, "user_id": 2682290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c7303698ff235104615a54de8a8830?s=128&d=identicon&r=PG", "display_name": "Jurgen", "link": "https://stackoverflow.com/users/2682290/jurgen"}, "reply_to_user": {"reputation": 102407, "user_id": 2670892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4iPV5.png?s=128&g=1", "display_name": "greg-449", "link": "https://stackoverflow.com/users/2670892/greg-449"}, "edited": false, "score": 0, "creation_date": 1435076880, "post_id": 31007784, "comment_id": 50043852, "body": "<code>!STACK 0   5 org.osgi.framework.BundleException: Exception in net.sf.eclipsefp.haskell.ui.HaskellUIPlugin.start() of bundle net.sf.eclipsefp.haskell.ui.   6         at org.eclipse.osgi.internal.framework.BundleContextImpl.startA&zwnj;&#8203;ctivator(BundleConte&zwnj;&#8203;xtImpl.java:792)   7         at org.eclipse.osgi.internal.framework.BundleContextImpl.start(&zwnj;&#8203;BundleContextImpl.ja&zwnj;&#8203;va:721)   8         at org.eclipse.osgi.internal.framework.EquinoxBundle.startWorke&zwnj;&#8203;r0(EquinoxBundle.jav&zwnj;&#8203;a:936)   9 &#47;bin&#47;bash: NTRY: command not found</code>  This is what I can see however I have no clue what could be wrong."}, {"owner": {"reputation": 181, "user_id": 2682290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c7303698ff235104615a54de8a8830?s=128&d=identicon&r=PG", "display_name": "Jurgen", "link": "https://stackoverflow.com/users/2682290/jurgen"}, "reply_to_user": {"reputation": 102407, "user_id": 2670892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4iPV5.png?s=128&g=1", "display_name": "greg-449", "link": "https://stackoverflow.com/users/2670892/greg-449"}, "edited": false, "score": 0, "creation_date": 1435077314, "post_id": 31007784, "comment_id": 50044105, "body": "The log file you pointed out is the exact same as the console output in Eclipse. The only line which makes sense where errors are coming from seems to be the &quot;NTRY: command not found&quot; (shouldn&#39;t it be ENTRY? this is what the log shows)."}, {"owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 0, "creation_date": 1435082197, "post_id": 31007784, "comment_id": 50047074, "body": "Are you sure it&#39;s not a PATH issue? See the second question in the faq at <a href=\"http://eclipsefp.github.io/faq.html\" rel=\"nofollow noreferrer\">eclipsefp.github.io/faq.html</a>."}, {"owner": {"reputation": 181, "user_id": 2682290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c7303698ff235104615a54de8a8830?s=128&d=identicon&r=PG", "display_name": "Jurgen", "link": "https://stackoverflow.com/users/2682290/jurgen"}, "edited": false, "score": 0, "creation_date": 1435140080, "post_id": 31007784, "comment_id": 50071765, "body": "JP Moresmau, thank you for your contribution however. I already found that as well. This is my path:  <code>$ echo $PATH &#47;app&#47;halcyon:&#47;app&#47;bin:&#47;app&#47;usr&#47;bin:&#47;app&#47;ghc&#47;bin:&#47;app&#47;cabal&#47;b&zwnj;&#8203;in:&#47;app&#47;sandbox&#47;bin:&zwnj;&#8203;&#47;app&#47;sandbox&#47;usr&#47;bin&zwnj;&#8203;:&#47;usr&#47;local&#47;bin:&#47;usr&zwnj;&#8203;&#47;bin:&#47;bin:&#47;usr&#47;sbin:&zwnj;&#8203;&#47;sbin:&#47;opt&#47;X11&#47;bin </code>  I think it should be correct as I can&#39;t see anything weird here."}], "owner": {"reputation": 181, "user_id": 2682290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c7303698ff235104615a54de8a8830?s=128&d=identicon&r=PG", "display_name": "Jurgen", "link": "https://stackoverflow.com/users/2682290/jurgen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 289, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1488331287, "creation_date": 1435075124, "last_edit_date": 1488331287, "question_id": 31007784, "link": "https://stackoverflow.com/questions/31007784/installation-of-eclipsefp-on-eclipse-luna-mac-os-x-yosemite", "title": "Installation of EclipseFP on Eclipse Luna (Mac OS X Yosemite)", "body": "<p>I'm trying to get EclipseFP (Haskell support, but the original coder stopped maintaining it last month) working on my iMac but everything seems to fail constantly. I've been debugging this for hours now and like most other Haskell stuff there isn't much decent support out there regarding the installation of such tools. I haven't even written a single line of Haskell code yet (apart from some playing around in GHC/GHCI which surprisingly did work)!</p>\n\n<p>I've tried so many things already, different libraries, different solutions, different versions etc. But it seems that everything that has to do with haskell support is just one big clutter of confusion for me and nothing seems to point me in an apparent direction which bothers me since I am an experienced programmer and dealing with command line interfaces, tools and dependencies isn't unknown to me on all sort of platforms for years now.</p>\n\n<p>Even the most relevant topics on StackOverflow or other knowledgebases just won't cut it regarding this topic and I'm starting to feel like dropping the entire Haskell language and just use something which does play nice with the system without such troubles since it is already such a pain in the ass to get the most basic development tools to work, let alone the coding itself...</p>\n\n<p>The things I got:</p>\n\n<ul>\n<li>Mac OSX Yosmite</li>\n<li>GHC</li>\n<li>GHCI</li>\n<li>Cabal (repository)</li>\n<li>Eclipse Luna</li>\n</ul>\n\n<p>I've installed EclipseFP using the <a href=\"http://eclipsefp.github.io/install.html\" rel=\"nofollow\">install instructions</a> which worked out all great. At this point I thought it would just all work without any problems as the plugin installs just fine...</p>\n\n<p>Well, that was not the case of course. I've restarted Eclipse as it requested after installing new plugins. Here is where the trouble begun..</p>\n\n<p>In the following steps I would have to open the Haskell Perspective in Eclipse. Well... guess what.. there was none! After strolling the web I found out that it might have compatibility issues with the old JDK 1.6 which was installed by default on MacOSX. No worries.. I've downloaded Java JDK 1.8, set it up in Eclipse, restarted it. And there the item \"Haskell perpective\" showed up in the list. </p>\n\n<p>After clicking that, and thinking my troubles were over (and I could finally start coding!) nothing happend! I've searched around for a while and found the Eclipse error console which until this day gives me nothing more than:</p>\n\n<pre><code>An error occurred while automatically activating bundle net.sf.eclipsefp.haskell.ui (459).\n\norg.eclipse.e4.core.di.InjectionException: java.lang.RuntimeException: org.eclipse.core.runtime.CoreException: Plug-in net.sf.eclipsefp.haskell.ui was unable to load class net.sf.eclipsefp.haskell.ui.HaskellPerspective.\n</code></pre>\n\n<p>Of course I have tried solving this issue and came across some dependencies which needed to be installed using cabal (BuildWrapper, Scion-Browser and some other essentials). After doing so I still have the same problem and I have no idea where to look for. The only information I can really find are topics which are more than 3/4 years old which share 0 relevance to my exact problem.</p>\n\n<p>I could paste the Java stacktrace here as well which came with the error message, but it doesn't show much useful information anyway other than just basic crashing.</p>\n\n<p>I hope someone can help me  because I would really like to start coding now for a change instead of wasting hours on getting my basic development framework/IDE set up.</p>\n\n<p>Long story short; I'd like to code some Haskell in Eclipse but the development tools just won't install and/or work properly without any notable errors or directions to look for.</p>\n"}, {"tags": ["haskell", "cyclic"], "comments": [{"owner": {"reputation": 67048, "user_id": 388787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f786b1ad349a30e02802ae61b4518fc?s=128&d=identicon&r=PG", "display_name": "Dan D.", "link": "https://stackoverflow.com/users/388787/dan-d"}, "edited": false, "score": 1, "creation_date": 1435074318, "post_id": 31007332, "comment_id": 50042075, "body": "The latter can be converted to the former by the compiler."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1435075260, "post_id": 31007332, "comment_id": 50042724, "body": "Related: <a href=\"http://stackoverflow.com/questions/16632143/why-recursive-let-make-space-effcient\" title=\"why recursive let make space effcient\">stackoverflow.com/questions/16632143/&hellip;</a>. <code>ones&#47;0</code>? Are you coming from Erlang, by any chance? <code>:)</code>"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 67048, "user_id": 388787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f786b1ad349a30e02802ae61b4518fc?s=128&d=identicon&r=PG", "display_name": "Dan D.", "link": "https://stackoverflow.com/users/388787/dan-d"}, "edited": false, "score": 0, "creation_date": 1435075276, "post_id": 31007332, "comment_id": 50042737, "body": "@DanD. at least if you use <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/src/GHC-List.html#repeat\" rel=\"nofollow noreferrer\">the definition in GHC&#39;s prelude</a>. In op&#39;s definition <code>repeat</code> won&#39;t be inlined. I don&#39;t know how the two differ operationally in that case."}, {"owner": {"reputation": 368, "user_id": 4204160, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/62550e8dec6bd6a777fe3c0013b820df?s=128&d=identicon&r=PG&f=1", "display_name": "Marcin", "link": "https://stackoverflow.com/users/4204160/marcin"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1435075526, "post_id": 31007332, "comment_id": 50042925, "body": "@Jubobs Nope, that&#39;s just a notation my teacher uses, so I bet he might ;)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 67048, "user_id": 388787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f786b1ad349a30e02802ae61b4518fc?s=128&d=identicon&r=PG", "display_name": "Dan D.", "link": "https://stackoverflow.com/users/388787/dan-d"}, "edited": false, "score": 2, "creation_date": 1435077661, "post_id": 31007332, "comment_id": 50044274, "body": "Also note that a &quot;cyclic&quot; structure as the one you posted is semantically indistinguishable to its non-cyclyc cousin. They will have different performance, especially in term of memory occupation, but they lead to the same result. Indeed, as @DanD. notes, the compiler could indeed replace one with the other."}], "owner": {"reputation": 368, "user_id": 4204160, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/62550e8dec6bd6a777fe3c0013b820df?s=128&d=identicon&r=PG&f=1", "display_name": "Marcin", "link": "https://stackoverflow.com/users/4204160/marcin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "closed_date": 1435075601, "answer_count": 0, "score": 1, "last_activity_date": 1435074021, "creation_date": 1435074021, "question_id": 31007332, "link": "https://stackoverflow.com/questions/31007332/haskell-cyclic-structure", "closed_reason": "Duplicate", "title": "Haskell cyclic structure", "body": "<p>I have two definitions of <code>ones/0</code>, both resulting in an infinite list of ones:</p>\n\n<pre><code>ones = 1 : ones\n\nones = repeat 1\nrepeat::a-&gt;[a]\nrepeat x = x : repeat x\n</code></pre>\n\n<p>I'm being told that the first one is a cyclic structure, while the second one is not. Is that true? And what does that actually mean/how can I tell whether a structure is cyclic or not?</p>\n"}, {"tags": ["scala", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 3336961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c25dd2cab964d930c275fb725f9c6cf?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Dawle", "link": "https://stackoverflow.com/users/3336961/amit-dawle"}, "edited": false, "score": 0, "creation_date": 1435074481, "post_id": 31007367, "comment_id": 50042174, "body": "Thanks! That helped a lot."}], "tags": [], "owner": {"reputation": 3140, "user_id": 1573825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/998a8344ea5412fcc0009faecb2e60dc?s=128&d=identicon&r=PG", "display_name": "vitalii", "link": "https://stackoverflow.com/users/1573825/vitalii"}, "is_accepted": true, "score": 2, "last_activity_date": 1435074089, "creation_date": 1435074089, "answer_id": 31007367, "question_id": 31006709, "link": "https://stackoverflow.com/questions/31006709/implementing-map-on-a-tree-using-fold/31007367#31007367", "title": "Implementing map on a tree using fold", "body": "<p>Try to write your last line as</p>\n\n<pre><code>def map(tree:Tree[Int])(f:Int=&gt;Int) : Tree[Int] = fold(tree , EmptyTree:Tree[Int])((l,x,r) =&gt; Node(f(x),l,r))\n</code></pre>\n\n<p>Scala's type inference is very limited compared to haskell, in this case it tries to infere type of <code>fold</code> from it's arguments left to right, and incorectly decides that result type of fold should be <code>EmptyTree</code> and not the <code>Tree[Int]</code>. Usually adding auxilary constructor to the companion object of the parent type helps in this situation a bit, for instance in the Option object there's a constructor</p>\n\n<pre><code>def empty[A]: Option[A] \n</code></pre>\n\n<p>which returns the parent type.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1435077241, "creation_date": 1435077241, "answer_id": 31008480, "question_id": 31006709, "link": "https://stackoverflow.com/questions/31006709/implementing-map-on-a-tree-using-fold/31008480#31008480", "title": "Implementing map on a tree using fold", "body": "<p>As an alternative to @vitalii's solution, make the type parameters to <code>fold</code> explicit:</p>\n\n<pre><code>def map(tree: Tree[Int])(f: Int=&gt;Int): Tree[Int] =\n  fold[Int, Tree[Int]](tree, EmptyTree)((l, x, r) =&gt; Node[Int](f(x), l, r))\n  //   ^^^^^^^^^^^^^^\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 3336961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c25dd2cab964d930c275fb725f9c6cf?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Dawle", "link": "https://stackoverflow.com/users/3336961/amit-dawle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 900, "favorite_count": 0, "accepted_answer_id": 31007367, "answer_count": 2, "score": 1, "last_activity_date": 1435077241, "creation_date": 1435072416, "question_id": 31006709, "link": "https://stackoverflow.com/questions/31006709/implementing-map-on-a-tree-using-fold", "title": "Implementing map on a tree using fold", "body": "<p>I am trying to implement a map using fold. I could do so in Haskell </p>\n\n<pre><code> data Tree a = EmptyTree | Node a (Tree a) (Tree a) deriving (Show)\n\n\n foldTree :: Tree a -&gt; b -&gt; (b -&gt; a -&gt; b -&gt; b) -&gt;  b   \n foldTree EmptyTree d _ = d\n foldTree (Node a l r) d f =  f (foldTree l d f)  a  (foldTree r d f)\n\n\n mapTree :: Tree a -&gt; ( a -&gt; b) -&gt; Tree b\n mapTree tree f = foldTree tree EmptyTree (\\l n r -&gt; Node (f n)  l  r)\n</code></pre>\n\n<p>However when I tried to port it to Scala, I am a bit stuck</p>\n\n<pre><code>sealed trait Tree[+A]\ncase object EmptyTree extends Tree[Nothing]\ncase class Node[A](value: A , left: Tree[A], right: Tree[A]) extends Tree[A]\n\n\ndef fold[A, B](t:Tree[A] , z:B)(f:(B,A,B) =&gt; B) : B = t match {\n    case EmptyTree =&gt; z \n    case Node(x,l,r) =&gt; f ( fold( l , z )(f) , x , fold( r , z )(f) )   \n  }\n\n  def map(tree:Tree[Int])(f:Int=&gt;Int) : Tree[Int] = fold(tree , EmptyTree)((l,x,r) =&gt; Node(f(x),l,r))\n</code></pre>\n\n<p>The compiler complains that it is expecting an EmptyTree in function I pass to fold.</p>\n\n<pre><code>fold(tree , EmptyTree)((l,x,r) =&gt; Node(f(x),l,r))\n</code></pre>\n\n<p>The return type for the Map is Tree so I would have expected this to work. Any suggestions ?</p>\n"}, {"tags": ["function", "haskell", "composition"], "comments": [{"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 1, "creation_date": 1435063256, "post_id": 31002702, "comment_id": 50033695, "body": "Whom are you referring to as Asena?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1435063286, "post_id": 31002702, "comment_id": 50033714, "body": "@AaditMShah ... I guess him/herself ;)"}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1435063349, "post_id": 31002702, "comment_id": 50033748, "body": "Oh, the OP&#39;s name is Vucic Asena. Punctuation please."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 5037716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/608f09160b5db7f02bb1198ff51c5fcc?s=128&d=identicon&r=PG&f=1", "display_name": "Vucicasena", "link": "https://stackoverflow.com/users/5037716/vucicasena"}, "edited": false, "score": 0, "creation_date": 1436788208, "post_id": 31002872, "comment_id": 50742643, "body": "Sorry i forgot, i ticked it :) Thanks a lot Carsten!"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 8, "last_activity_date": 1435063045, "last_edit_date": 1435063045, "creation_date": 1435062628, "answer_id": 31002872, "question_id": 31002702, "link": "https://stackoverflow.com/questions/31002702/haskell-function-composition/31002872#31002872", "title": "Haskell function composition", "body": "<p>Ok, let's look just at the types (it's like a puzzle - the types have to fit):</p>\n\n<pre><code>f1 :: Int -&gt; Int\nf2 :: (a -&gt; b) -&gt; [a] -&gt; [b] = (a -&gt; b) -&gt; ([a] -&gt; [b])\n</code></pre>\n\n<p>in order to compose the both you need ones co-domain to be the same as the others domain.</p>\n\n<p>This is because the composition has type:</p>\n\n<pre><code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n</code></pre>\n\n<p>See the <code>b</code> has to fit ;)</p>\n\n<p>So for your <code>f1</code> and <code>f2</code> you would need either <code>Int ~ (a -&gt; b)</code> or <code>Int ~ ([a] -&gt; [b])</code> both of which are not working well (as you found out).</p>\n\n<p><strong>BUT</strong> you kind of have the ability to <strong>apply</strong> <code>f1</code> to <code>f2</code> as <code>f1</code> just fits <code>f2</code> first argument (as you have seen too) - so I am a bit confused why you even want to use composition here.</p>\n\n<h3>remarks</h3>\n\n<p>your functions are a bit strange - I think the usual way to write them would be</p>\n\n<pre><code>f1 x = 2 ^ x\nf2 = map\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>fkomp :: [Int] -&gt; [Int]\nfkomp = map (2^)\n</code></pre>\n\n<p>note that the last one is <strong>not</strong> function-composition but (just as your case) function-application: I apply the function <code>(2^) :: Int -&gt; Int</code> to <code>map :: (Int -&gt; Int) -&gt; [Int] -&gt; [Int]</code> and get a function of type <code>[Int] -&gt; [Int]</code> as the result (if you check the types in GHCi you will see a more generic versions but I think this is a bit more clear)</p>\n"}], "owner": {"reputation": 69, "user_id": 5037716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/608f09160b5db7f02bb1198ff51c5fcc?s=128&d=identicon&r=PG&f=1", "display_name": "Vucicasena", "link": "https://stackoverflow.com/users/5037716/vucicasena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 1, "accepted_answer_id": 31002872, "answer_count": 1, "score": 1, "last_activity_date": 1435511079, "creation_date": 1435062176, "last_edit_date": 1435511079, "question_id": 31002702, "link": "https://stackoverflow.com/questions/31002702/haskell-function-composition", "title": "Haskell function composition", "body": "<p>I've defined a function f1 and f2,so that I can use at the and the function composition (<code>fkomp</code>), which is supposed to use f1 and f2 to calculate <code>2^x</code> by every element in a given List.</p>\n\n<pre><code>f1 :: Int -&gt; Int \nf1 x = product (replicate x 2)\n\nf2 :: (a -&gt; b) -&gt; [a] -&gt; [b]\nf2 f xs = [f x | x &lt;- xs]\n\nfkomp :: [Int] -&gt; [Int]        \nfkomp xs = f2 f1 $ xs \n</code></pre>\n\n<p>It works,but the problem is,that i can't write my code with composition:</p>\n\n<pre><code>fkomp xs = f2.f1 $ xs\n</code></pre>\n\n<p>I've been typing every single combination but it doesn't work with composition.</p>\n\n<p>Could someone lighten my path ?</p>\n\n<p>Thanks a lot</p>\n"}, {"tags": ["haskell", "haskell-lens"], "comments": [{"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 4, "creation_date": 1435064459, "post_id": 31002661, "comment_id": 50034509, "body": "Shouldn&#39;t it be <code>cost = (*) &lt;$&gt; (^. quantity) &lt;*&gt; (^. price)</code>?"}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 4, "creation_date": 1435065223, "post_id": 31002661, "comment_id": 50035098, "body": "You could always create two new operators: <code>f &lt;$&gt;. l = f &lt;$&gt; (^. l)</code> and <code>f &lt;*&gt;. l = f &lt;*&gt; (^. l)</code>. Then your expression becomes <code>cost = (*) &lt;$&gt;. quantity &lt;*&gt;. price</code>."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 1, "creation_date": 1435071103, "post_id": 31002661, "comment_id": 50039765, "body": "It&#39;s not any shorter, but using <code>Control.Lens</code> you can do <code>cost = returnA &amp;&amp;&amp; returnA &gt;&gt;&gt; view (alongside quantity price) &gt;&gt;&gt; uncurry (*)</code>.  The <code>returnA &amp;&amp;&amp; returnA</code> is equivalent to <code>\\a -&gt; (a, a)</code> but more generalized, <code>alongside quantity price :: Lens&#39; (Item, Item) (Double, Double)</code>, then <code>uncurry (*)</code> is pretty self explanatory.  This solution does not scale beyond 2 lenses, though.  For that @AaditMShah&#39;s suggestion is better, but I would prefer <code>^$^</code> and <code>^*^</code> since the <code>^</code> symbol usually indicates a getter in <code>lens</code>, and if you use <code>view</code> instead of <code>^.</code> it&#39;ll have a more general type."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1435072646, "post_id": 31002661, "comment_id": 50040900, "body": "@AaditMShah yes of course. I updated it."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1435072740, "post_id": 31002661, "comment_id": 50040963, "body": "@AaditMShah I also want a lens like which why I start with a <code>to</code>."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 1, "creation_date": 1435073607, "post_id": 31002661, "comment_id": 50041579, "body": "You can&#39;t make <code>cost</code> a lens because a lens must have both a getter and a setter. However, <code>cost</code> only has a getter. To set the cost you need to update both <code>quantity</code> and/or <code>price</code>. Hence, there&#39;s no &quot;correct&quot; way to create a setter for <code>cost</code>. Therefore, <code>cost</code> cannot be a lens. It can only be a function of the type <code>Item -&gt; Double</code> (i.e. a getter)."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 1, "creation_date": 1435074042, "post_id": 31002661, "comment_id": 50041892, "body": "That why i put <code>lens like</code>, not <code>lens</code> ;-)."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1435074405, "post_id": 31002661, "comment_id": 50042125, "body": "@bekhlir I think your solution just give a function <code>Item -&gt; Double</code>. I&#39;m looking for a getter."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1435091888, "post_id": 31002661, "comment_id": 50052799, "body": "A variation on @bheklilr &#39;s suggestion: <code>to (join (,)) . alongside quantity price . to (uncurry (*))</code>"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 10, "creation_date": 1435221942, "post_id": 31002661, "comment_id": 50113216, "body": "Why are you posting answers as comments?"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1438258149, "post_id": 31002661, "comment_id": 51383036, "body": "@Bakuriu to not risk getting down voted I presume ;-)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 3, "creation_date": 1438390387, "post_id": 31002661, "comment_id": 51447787, "body": "@Bakuriu My guess would be that no one believes their answer is better than mb14&#39;s original idea..."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1442461662, "post_id": 31002661, "comment_id": 53094662, "body": "I just stumbled upon <a href=\"http://stackoverflow.com/a/26723075/2751851\">this answer by @danidiaz</a> which suggests <a href=\"http://hackage.haskell.org/package/lens-4.13/docs/Control-Lens-Reified.html\" rel=\"nofollow noreferrer\"><code>Control.Lens.Reified</code></a>: the wrappers for read-only optics there have the instances that you&#39;d expect for a function, so you can do <code>runGetter ((*) &lt;$&gt; Getter quantity &lt;*&gt; Getter price)</code>."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1442508940, "post_id": 31002661, "comment_id": 53120375, "body": "@duplode seems promising, even though it&#39;s much shorter than the <code>to ... view</code> version. What&#39;s annyoing is this <code>to .. view</code> back and forth conversion is crying for an <code>iso</code> but I haven&#39;t figured out how to use it."}], "answers": [{"comments": [{"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1442175933, "post_id": 32553101, "comment_id": 52964292, "body": "I&#39;m trying to combine lenses, because they might not correspond to record accessor, therefore using the primitive getters is out of question. However, I agree <code>view lens</code> is better <code>(^. lens)</code>."}], "tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": false, "score": 2, "last_activity_date": 1442168945, "creation_date": 1442168945, "answer_id": 32553101, "question_id": 31002661, "link": "https://stackoverflow.com/questions/31002661/how-to-combine-lenses-not-compose/32553101#32553101", "title": "How to combine lenses (not compose)", "body": "<p>It just occurred to me that you don't need any special syntax to combine lenses. If you are creating lenses using Template Haskell (which you should be doing) then you already have primitive getters for each field, preceded by an underscore.</p>\n\n<p>Hence, you could use the primitive getters to create your phantom <code>cost</code> getter as follows:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE TemplateHaskell #-}\n\nimport Control.Lens\n\ndata Item = Item { _quantity :: Double\n                 , _price    :: Double\n                 }\n\n$(makeLenses ''Item)\n\ncost :: Getter Item Double\ncost = to $ (*) &lt;$&gt; _quantity &lt;*&gt; _price\n\nitem :: Item\nitem = Item { _quantity = 2, _price = 5.0 }\n\nmain :: IO ()\nmain = print $ view cost item\n</code></pre>\n\n<p>However, if you don't have access to the primitive getters then you could define <code>cost</code> as:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>cost :: Getter Item Double\ncost = to $ (*) &lt;$&gt; view quantity &lt;*&gt; view price\n</code></pre>\n\n<p>Your fingers don't need to move too far away from the home row in order to type out <code>view</code>.</p>\n"}], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 548, "favorite_count": 5, "answer_count": 1, "score": 21, "last_activity_date": 1442168945, "creation_date": 1435062059, "last_edit_date": 1435072607, "question_id": 31002661, "link": "https://stackoverflow.com/questions/31002661/how-to-combine-lenses-not-compose", "title": "How to combine lenses (not compose)", "body": "<p>In haskell without lenses I can do things like :</p>\n\n<pre><code>data Item = Item { quantity :: Double, price ::Double }\n\ncost :: Item -&gt; Double\ncost = (*) &lt;$&gt; quantity &lt;*&gt; price\n</code></pre>\n\n<p>If I use lenses instead how can I do the equivalent ? The best I can do is</p>\n\n<pre><code>cost = to $ (*) &lt;$&gt; (^. quantity) &lt;*&gt; (^. price)\n</code></pre>\n\n<p>Is there a better way ? (of course I want a <code>getter</code> or equivalent)</p>\n"}, {"tags": ["haskell", "haskell-lens"], "comments": [{"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1435062000, "post_id": 31002591, "comment_id": 50032824, "body": "How about <code>u &amp; currentDay %~ (addDays 1 &lt;$&gt;)</code>?"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1435063912, "post_id": 31002591, "comment_id": 50034128, "body": "Indeed, but I&#39;m more interesting in knowing if there is already an operator to do so in the lens library. There are so many and some are hard to grasp."}, {"owner": {"reputation": 2846, "user_id": 4347335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7e6f293a134a5defec74e12cae42cc?s=128&d=identicon&r=PG&f=1", "display_name": "cchalmers", "link": "https://stackoverflow.com/users/4347335/cchalmers"}, "edited": false, "score": 3, "creation_date": 1435066878, "post_id": 31002591, "comment_id": 50036294, "body": "You can use <a href=\"https://hackage.haskell.org/package/lens-4.11/docs/Control-Lens-Setter.html#v:mapped\" rel=\"nofollow noreferrer\">mapped</a>: <code>u &amp; currentDay . mapped %~ addDays 1</code>"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 2846, "user_id": 4347335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7e6f293a134a5defec74e12cae42cc?s=128&d=identicon&r=PG&f=1", "display_name": "cchalmers", "link": "https://stackoverflow.com/users/4347335/cchalmers"}, "edited": false, "score": 0, "creation_date": 1435072918, "post_id": 31002591, "comment_id": 50041101, "body": "@cchalmers Interesting. But there is no (already existing) operator combining <code>mapped</code> and <code>%~</code>.?"}, {"owner": {"reputation": 2846, "user_id": 4347335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7e6f293a134a5defec74e12cae42cc?s=128&d=identicon&r=PG&f=1", "display_name": "cchalmers", "link": "https://stackoverflow.com/users/4347335/cchalmers"}, "edited": false, "score": 0, "creation_date": 1435074643, "post_id": 31002591, "comment_id": 50042269, "body": "@mb14 Not in lens (the setting combinators are <a href=\"https://hackage.haskell.org/package/lens-4.11/docs/Control-Lens-Setter.html#g:4\" rel=\"nofollow noreferrer\">here</a>). But it wouldn&#39;t be too hard to write your own."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 2846, "user_id": 4347335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7e6f293a134a5defec74e12cae42cc?s=128&d=identicon&r=PG&f=1", "display_name": "cchalmers", "link": "https://stackoverflow.com/users/4347335/cchalmers"}, "edited": false, "score": 0, "creation_date": 1435075344, "post_id": 31002591, "comment_id": 50042792, "body": "@cchalmers Ok. I don&#39;t like to reinvent the wheel so I was just checking it wasn&#39;t existing already. <code>mapped</code> is probably what I was looking for in fact. Could you write it as an answer  so I can accept it ?"}], "answers": [{"tags": [], "owner": {"reputation": 2846, "user_id": 4347335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7e6f293a134a5defec74e12cae42cc?s=128&d=identicon&r=PG&f=1", "display_name": "cchalmers", "link": "https://stackoverflow.com/users/4347335/cchalmers"}, "is_accepted": true, "score": 2, "last_activity_date": 1435096518, "creation_date": 1435096518, "answer_id": 31014225, "question_id": 31002591, "link": "https://stackoverflow.com/questions/31002591/is-there-a-lens-operator-to-combine-and-fmap/31014225#31014225", "title": "Is there a lens operator to combine %~ and fmap", "body": "<p>There is no existing operator for this but you could easily define your own:</p>\n\n<pre><code>%$~ :: Functor f =&gt; ASetter s t (f a) (f b) -&gt; (a -&gt; b) -&gt; s -&gt; t\nl %$~ f = over a (fmap f)\n</code></pre>\n\n<p>The standard way to do this is to use the <a href=\"https://hackage.haskell.org/package/lens-4.11/docs/Control-Lens-Setter.html#v:mapped\" rel=\"nofollow\"><code>mapped</code></a> setter:</p>\n\n<pre><code>u &amp; currentDay . mapped %~ addDays 1\n</code></pre>\n\n<p>Since your mapping over a <code>Maybe</code> you could also use <a href=\"https://hackage.haskell.org/package/lens-4.11/docs/Control-Lens-Prism.html#v:_Just\" rel=\"nofollow\"><code>_Just</code></a> prism:</p>\n\n<pre><code>u &amp; currentDay . _Just %~ addDays 1\n</code></pre>\n"}], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 1, "accepted_answer_id": 31014225, "answer_count": 1, "score": 2, "last_activity_date": 1435096518, "creation_date": 1435061854, "question_id": 31002591, "link": "https://stackoverflow.com/questions/31002591/is-there-a-lens-operator-to-combine-and-fmap", "title": "Is there a lens operator to combine %~ and fmap", "body": "<p>I have the following code</p>\n\n<pre><code>u &amp; currentDay %~ fmap (addDays 1)\n</code></pre>\n\n<p><code>currentDay</code> returns a <code>Maybe</code> which is why I need the <code>fmap</code>.\nIs there already an operator to combine <code>%~</code> and <code>fmap</code> (like <code>%~&lt;$&gt;</code> ;-)) or a clever way to do so ?</p>\n"}, {"tags": ["haskell", "bytestring"], "answers": [{"comments": [{"owner": {"reputation": 219, "user_id": 4625247, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/cbHw8.gif?s=128&g=1", "display_name": "Mikhail Puzanov", "link": "https://stackoverflow.com/users/4625247/mikhail-puzanov"}, "edited": false, "score": 0, "creation_date": 1435064473, "post_id": 31003030, "comment_id": 50034521, "body": "Well, in theory that could work, but my intention is the opposite: to reduce the amount of code I have to write. And in some sense &quot;lazy strictString&quot; is a good enough adaptatoin layer already."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 219, "user_id": 4625247, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/cbHw8.gif?s=128&g=1", "display_name": "Mikhail Puzanov", "link": "https://stackoverflow.com/users/4625247/mikhail-puzanov"}, "edited": false, "score": 1, "creation_date": 1435763304, "post_id": 31003030, "comment_id": 50338483, "body": "Have a look at the <a href=\"https://hackage.haskell.org/package/stringable\" rel=\"nofollow noreferrer\">stringable</a> package."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 1, "last_activity_date": 1435063048, "creation_date": 1435063048, "answer_id": 31003030, "question_id": 31000389, "link": "https://stackoverflow.com/questions/31000389/easy-switch-between-lazy-and-strict-bytestring/31003030#31003030", "title": "Easy switch between lazy and strict ByteString", "body": "<p>I would write an adaption layer between your application and these libraries to perform all of the necessary conversions. Design the adaptation layer so that you use your preferred application data types as input and output to those functions.</p>\n\n<p>Once you have chosen your modules the signatures of the library functions are never going to change. That is, you know what kind of string a call to base64 encode will return (by your choice of module.) Therefore, if you need to plumb together two library functions you know exactly what conversions need to be made to fit the two together.</p>\n"}], "owner": {"reputation": 219, "user_id": 4625247, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/cbHw8.gif?s=128&g=1", "display_name": "Mikhail Puzanov", "link": "https://stackoverflow.com/users/4625247/mikhail-puzanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1435063048, "creation_date": 1435055479, "last_edit_date": 1435055965, "question_id": 31000389, "link": "https://stackoverflow.com/questions/31000389/easy-switch-between-lazy-and-strict-bytestring", "title": "Easy switch between lazy and strict ByteString", "body": "<p>I need to work with strict and lazy ByteStrings, because this is the requirement preset by the choice of libraries (some mix of happstack, base64, sha256, hexpat, etc.). After some dancing with \"fromStrict\" and similar I ended up with this:</p>\n\n<pre><code>import qualified Data.ByteString.Char8  as S\nimport qualified Data.ByteString.Lazy.Char8  as L\n\nclass BString s where\n  lazy :: s -&gt; L.ByteString\n  strict :: s -&gt; S.ByteString\n  pack :: String -&gt; s\n  text :: T.Text -&gt; s\n\ninstance BString L.ByteString where\n  lazy = id\n  strict = S.concat . L.toChunks\n  pack = L.pack\n  text = L.fromStrict . TE.encodeUtf8\n\ninstance BString S.ByteString where\n  lazy = L.fromStrict\n  strict = id\n  pack = S.pack\n  text = TE.encodeUtf8 \n</code></pre>\n\n<p>so that I just put \"lazy $\" when the library function in hands requires lazy byte string or \"strict $\" in case of strict version. That works fine, costing an occasional conversion though, but it feels like I've invented bicycle here.</p>\n\n<p>So, the question is if there's a better (shorter, statically typed, more effective) alternative to such code? Is there a library trying to uniform lazy/strict handling? Or maybe I'm doing a wrong thing and it's considered a bad practice (thou shall not convert between lazy and strict or something)?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1435054395, "post_id": 30999929, "comment_id": 50027917, "body": "What has the code you posted to do with the problem you&#39;re asking about?"}, {"owner": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1435054489, "post_id": 30999929, "comment_id": 50027992, "body": "I`m trying to learn haskell and i found that the best way to do it is to see how someone solve a problem."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1435054577, "post_id": 30999929, "comment_id": 50028048, "body": "But the problem you seem to be asking about has nothing to do with IO, nor with subsequences. So what is the point of that code snippet you posted? If you can&#39;t post any useful code attemps yet, please make the problem description exact by posting some example input and output."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1435054579, "post_id": 30999929, "comment_id": 50028049, "body": "@leftaroundabout ... AFAIK it&#39;s some kind of code-golf (see the discussion here: <a href=\"https://stackoverflow.com/questions/30952309/haskell-powerset-function-how-to-avoid-couldnt-match-expected-type-io-t0-wi\" title=\"haskell powerset function how to avoid couldnt match expected type io t0 wi\">stackoverflow.com/questions/30952309/&hellip;</a>) - it&#39;s the last thing the OP still needs ;)"}, {"owner": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1435055234, "post_id": 30999929, "comment_id": 50028473, "body": "@leftaroundabout I`ve eddited the question so You can see what i mean."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1435055371, "post_id": 30999929, "comment_id": 50028586, "body": "So, you want the result of <code>&quot;([1,2,3])&quot;</code> to be <code>&quot;{{}, {1}, {2}, {3}, {1,2}&quot;</code>, or what? I suppose not, but just tell use <i>what</i> you want!"}, {"owner": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "edited": false, "score": 0, "creation_date": 1435055827, "post_id": 30999929, "comment_id": 50028883, "body": "That is exactly what i want ! In the shortest possible version."}, {"owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "edited": false, "score": 0, "creation_date": 1435056351, "post_id": 30999929, "comment_id": 50029202, "body": "@Cosaquee I&#39;ve edited your question to hopefully make it clearer. Can you confirm that that is what you are trying to achieve?"}, {"owner": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "edited": false, "score": 0, "creation_date": 1435056401, "post_id": 30999929, "comment_id": 50029233, "body": "Yes, that is excactly what i want to achive, thank You very much !"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1435070131, "post_id": 30999929, "comment_id": 50038947, "body": "For the future, please try stuff like this yourself, preferrably not by writing entire programs where it&#39;s unclear what going on, but by fiddling around with functions in GHCi (it&#39;s really great for that kind of language-exploring). And first of all, it would probably be a good idea to <a href=\"https://wiki.haskell.org/Books\" rel=\"nofollow noreferrer\">read a book on Haskell</a>; I tend to recommend <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow noreferrer\">LYAH</a>."}], "answers": [{"comments": [{"owner": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "edited": false, "score": 0, "creation_date": 1435056083, "post_id": 31000483, "comment_id": 50029048, "body": "Any way to make it shorter maybe ? I`m a little bit confused how to include reading from stdin now  ?"}, {"owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "reply_to_user": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "edited": false, "score": 0, "creation_date": 1435056106, "post_id": 31000483, "comment_id": 50029059, "body": "@Cosaquee See the edit."}, {"owner": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "edited": false, "score": 0, "creation_date": 1435056633, "post_id": 31000483, "comment_id": 50029371, "body": "That is the best possible answer ! I wish it was shorter but still is super awesome, thank You !"}, {"owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "reply_to_user": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "edited": false, "score": 0, "creation_date": 1435056895, "post_id": 31000483, "comment_id": 50029528, "body": "@Cosaquee Shorter as in &quot;less overall characters typed&quot; or as in &quot;shorter line&quot;?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1435057611, "post_id": 31000483, "comment_id": 50030008, "body": "I think it&#39;s even shorter when you strip the signature and just move <code>fn</code> <i>outside</i> <code>main</code> (maybe <a href=\"https://ghc.haskell.org/trac/haskell-prime/wiki/LambdaCase\" rel=\"nofollow noreferrer\">LambdaCase</a>???)"}, {"owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1435057957, "post_id": 31000483, "comment_id": 50030201, "body": "@Carsten Only <code>case</code> has more cost than all three <code>f</code>s there. But yeah, if it&#39;s a code golf than moving <code>fn</code> out, calling it <code>f</code>, removing signatures and pushing everything together will make it shorter."}, {"owner": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1435058281, "post_id": 31000483, "comment_id": 50030424, "body": "@Carsten less overall characters typed"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1435070420, "post_id": 31000483, "comment_id": 50039210, "body": "If this is a code golf, you could have <code>main=interact$map f.show.subsequences.(`asTypeOf`[0]).read;f &#39;[&#39;=&#39;{&#39;;f &#39;]&#39;=&#39;}&#39;;f c=c</code> (<b>84</b> chars).."}], "tags": [], "owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "is_accepted": true, "score": 4, "last_activity_date": 1435058106, "last_edit_date": 1435058106, "creation_date": 1435055780, "answer_id": 31000483, "question_id": 30999929, "link": "https://stackoverflow.com/questions/30999929/replace-all-with-as-short-as-possible/31000483#31000483", "title": "Replace all [ ] with {} - as short as possible", "body": "<p>All you need is love and to split <code>print</code> into <code>putStrLn . show</code> and then add a simple <code>map</code> in-between which does the conversion:</p>\n\n<pre><code>main :: IO ()\nmain = \n    let fn '[' = '{'\n        fn ']' = '}'\n        fn c   = c\n    in (readLn :: IO [Integer]) &gt;&gt;= putStrLn . map fn . show . subsequences\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/4c3b4b7e5c9ed52f\" rel=\"nofollow\"><kbd>Live demo</kbd></a></p>\n\n<p>The above code, given <code>[1, 2, 3]</code>, will output:</p>\n\n<blockquote>\n  <p><code>{},{1},{2},{1,2},{3},{1,3},{2,3},{1,2,3}}</code></p>\n</blockquote>\n\n<hr>\n\n<p>If this is a code golf, then you could have (<strong>106 characters</strong>):</p>\n\n<pre><code>f '[' = '{';f ']' = '}';f c = c;main = (readLn :: IO [Integer]) &gt;&gt;= putStrLn . map f . show . subsequences\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/e27fbe81364a19cf\" rel=\"nofollow\"><kbd>Live demo</kbd></a></p>\n"}], "owner": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 1, "closed_date": 1435057768, "accepted_answer_id": 31000483, "answer_count": 1, "score": 0, "last_activity_date": 1435058106, "creation_date": 1435054319, "last_edit_date": 1435056245, "question_id": 30999929, "link": "https://stackoverflow.com/questions/30999929/replace-all-with-as-short-as-possible", "closed_reason": "Needs details or clarity", "title": "Replace all [ ] with {} - as short as possible", "body": "<p>Given the code below:</p>\n\n<pre><code>import Data.List; \nmain = (readLn :: IO [Integer]) &gt;&gt;= print . subsequences\n</code></pre>\n\n<p>It takes a list of integers from standard input (for example <code>[1,2,3]</code>) and outputs something like:</p>\n\n<blockquote>\n  <p><code>[[],[1],[2],[1,2],[3],[1,3],[2,3],[1,2,3]]</code></p>\n</blockquote>\n\n<p>I want it to be like this:</p>\n\n<blockquote>\n  <p><code>{},{1},{2},{1,2},{3},{1,3},{2,3},{1,2,3}}</code></p>\n</blockquote>\n\n<p>so my goal is to replace every <code>[</code> and <code>]</code> in the result string with <code>{</code> and <code>}</code> respectively.</p>\n\n<p>How can I achieve this?</p>\n"}, {"tags": ["haskell", "newline"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1435050529, "post_id": 30997720, "comment_id": 50025360, "body": "Why don&#39;t you <i>load</i> the file to Unix-style <code>&quot;\\n&quot;</code>-only? That would certainly make things easier within your program, and the output would also come out right with <code>&quot;\\r\\n&quot;</code>."}, {"owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1435051165, "post_id": 30997720, "comment_id": 50025769, "body": "@leftaroundabout : I did not tell the whole story, but the original text is located in a file in base64 format. I first need to read the BytesStrings from the file, decode them (using Data.ByteString.Base64), then turn them into Text (and I can start to manipulate it). At that stage I could replace all &quot;\\r\\n&quot; to &quot;\\n&quot;. Is that what you suggest?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1435051641, "post_id": 30997720, "comment_id": 50026091, "body": "I would indeed suggest so. It might well lead to all kinds of other trouble if you have Windows-style line endings in the strings in your program."}, {"owner": {"reputation": 84156, "user_id": 916657, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/75bf31b48e75eedfebaa411a76a85155?s=128&d=identicon&r=PG", "display_name": "Niklas B.", "link": "https://stackoverflow.com/users/916657/niklas-b"}, "edited": false, "score": 0, "creation_date": 1435057191, "post_id": 30997720, "comment_id": 50029741, "body": "What leftaroundabout says is of course right, \\r\\n is pretty non-standard and you should get rid of it in your internal representation. I also think letting the OS handle your string coding for output is generally a bad idea, it might lead to other problems too (e.g. strings being encoded as some other coding than UTF-8, BOM vs. no BOM etc.) But that&#39;s just a personal opinion"}], "answers": [{"comments": [{"owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "edited": false, "score": 1, "creation_date": 1435050690, "post_id": 30997912, "comment_id": 50025454, "body": "Thanks. I confirm that the solution openBinaryFile and hPutStr works."}], "tags": [], "owner": {"reputation": 84156, "user_id": 916657, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/75bf31b48e75eedfebaa411a76a85155?s=128&d=identicon&r=PG", "display_name": "Niklas B.", "link": "https://stackoverflow.com/users/916657/niklas-b"}, "is_accepted": false, "score": 10, "last_activity_date": 1435050767, "last_edit_date": 1435050767, "creation_date": 1435048957, "answer_id": 30997912, "question_id": 30997720, "link": "https://stackoverflow.com/questions/30997720/r-n-translated-to-r-r-n-in-haskell/30997912#30997912", "title": "\\r\\n translated to \\r\\r\\n in Haskell", "body": "<p>Your answer is in <a href=\"https://hackage.haskell.org/package/text-1.2.1.1/docs/Data-Text-IO.html\">the docs</a>:</p>\n\n<blockquote>\n  <p>Beginning with GHC 6.12, text I/O is performed using the system or handle's current locale and line ending conventions.</p>\n</blockquote>\n\n<p>Seeing as you do not open the handle yourself, it seems very likely that the library opens the file in text mode, leading to the translation of endline characters by the operating system. What you could do instead is open the file in binary mode using <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/System-IO.html#v:openBinaryFile\"><code>openBinaryFile</code></a> and then use <a href=\"https://hackage.haskell.org/package/text-1.2.1.1/docs/Data-Text-IO.html#v:hPutStr\"><code>Data.Text.hPutStr</code></a> to prevent this.</p>\n\n<p>However, the OS handling your encoding might also not be what you want. Depending on your scenario, encoding/decoding the string explicitly like you do using <code>ByteString</code>s might be the better idea.</p>\n"}], "owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1435050767, "creation_date": 1435048409, "question_id": 30997720, "link": "https://stackoverflow.com/questions/30997720/r-n-translated-to-r-r-n-in-haskell", "title": "\\r\\n translated to \\r\\r\\n in Haskell", "body": "<p>I'm on Windows 7 64-bit.</p>\n\n<p>My program needs to retrieve some text (Utf8 encoded) from an external source, do some things with it, then save it to disk. The original text is using the \"\\r\\n\" sequence to represent newlines (I am happy to keep it that way).</p>\n\n<p><strong>The issue</strong> : When using Data.Text.writeFile each \"\\r\\n\" sequence seems to be translated as \"\\r\\r\\n\", that is every '\\n' is translated to \"\\r\\n\", <em>even when it is already preceded by '\\r' in the original text</em>. I understand that, when writing to a file on Windows OS, '\\n' should be translated to a \"\\r\\n\", when not already preceded by '\\r' , but the translation of \"\\r\\n\" to \"\\r\\r\\n\" does not seem right.</p>\n\n<p>Using ByteString.writeLine applied to the encodeUtf8 version of the text works well though (no extra \"\\r\" inserted inside a \"\\r\\n\" sequence)</p>\n\n<p>A simple example :</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport qualified Data.ByteString as B\nimport qualified Data.Text as T\nimport qualified Data.Text.IO as T (writeFile)\nimport qualified Data.Text.Encoding as T (encodeUtf8)\n\nstr = \"Line 1 is here\\r\\nLine 2 is here\\r\\nLine 3 is here\" :: T.Text\n\nmain = do\n    B.writeFile \"byt.bin\" $ T.encodeUtf8 str\n    T.writeFile \"txt.bin\" str\n</code></pre>\n\n<p>Looking at each file produced by this code with an hex editor, one can see the extra x0D added in front of each x0A in the file produced via the T.writeFile line. </p>\n\n<p>B.writeFile : \n<img src=\"https://i.stack.imgur.com/FfQu3.png\" alt=\"enter image description here\"></p>\n\n<p>T.writeFile :\n<img src=\"https://i.stack.imgur.com/ShlGy.png\" alt=\"enter image description here\"></p>\n\n<p><strong>My question</strong> : What did I do wrong? Is there a way to use T.writeFile on Windows, and not get \"\\r\\n\" translated to \"\\r\\r\\n\"?</p>\n"}, {"tags": ["haskell", "threepenny-gui"], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 4438776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512bdc9775b923e0444553ea5d919854?s=128&d=identicon&r=PG", "display_name": "655321", "link": "https://stackoverflow.com/users/4438776/655321"}, "edited": false, "score": 0, "creation_date": 1435052337, "post_id": 30997521, "comment_id": 50026554, "body": "Oh, this was a fairly easy thing in the end. Just changed <code>bBool</code> to include the <code>UI.checkedChange</code> and it works. Thank you!"}], "tags": [], "owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "is_accepted": true, "score": 4, "last_activity_date": 1435047822, "creation_date": 1435047822, "answer_id": 30997521, "question_id": 30994875, "link": "https://stackoverflow.com/questions/30994875/combining-event-and-an-attribute-in-threepenny-gui/30997521#30997521", "title": "Combining Event and an attribute in threepenny-gui", "body": "<p>This is intentional: The <code>UI.checkedChange</code> event only triggers when the <em>user</em> clicks the checkbox, but <em>not</em> when it is set programmatically. The intention is that the <code>bBool</code> behavior represents the canonical state of the checkbox and the <code>UI.checkedChange</code> event represents request from the user to change it, which may or may not be granted. This allows <a href=\"http://apfelmus.nfshost.com/blog/2012/03/29-frp-three-principles-bidirectional-gui.html\" rel=\"nofollow\">bidirectional dataflow</a> (<a href=\"https://github.com/HeinrichApfelmus/threepenny-gui/blob/master/doc%2Fdesign-widgets.md#three-principles-for-representing-mvc-concepts-with-frp\" rel=\"nofollow\">see also</a>). Admittedly, Threepenny does not strictly follows these ideas just yet.</p>\n\n<p>In your case, I recommend to integrate the <code>UI.checkedChange</code> event into the <code>bBool</code> behavior to represent the \"canonical\" state of the checkbox. If that doesn't work, just hack it up with <code>get UI.checked</code> and <code>Reactive.Threepenny.unsafeMapIO</code>.</p>\n"}], "owner": {"reputation": 195, "user_id": 4438776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512bdc9775b923e0444553ea5d919854?s=128&d=identicon&r=PG", "display_name": "655321", "link": "https://stackoverflow.com/users/4438776/655321"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 30997521, "answer_count": 1, "score": 3, "last_activity_date": 1435047822, "creation_date": 1435038942, "last_edit_date": 1435040379, "question_id": 30994875, "link": "https://stackoverflow.com/questions/30994875/combining-event-and-an-attribute-in-threepenny-gui", "title": "Combining Event and an attribute in threepenny-gui", "body": "<p>I have an <code>Event String</code> which I want to <code>sink</code> into a textarea. This works fine, but now I want to combine the current value of a checkbox selection to this string.</p>\n\n<p>First I did this by using <code>checkedChange</code> of the checkbox which works, but has a problem. If the <code>checked</code> value is sinked to the checkbox, there is no checkedChange-Event and the value shown in the textarea isn't updated properly.</p>\n\n<p>I could read the checkbox selection with <code>get checked</code> but then I run into problems combining <code>Event String</code> and <code>UI Bool</code> (or <code>UI String</code> as the boolean is going to be transformed to a string).</p>\n\n<p>EDIT: To be more precise, I want to do something like</p>\n\n<pre><code>bCombinedValue &lt;- stepper \"\" eCombinedValue\nelement textArea # sink UI.text bCombinedValue\n</code></pre>\n\n<p>where <code>eCombinedValue</code> has the original <code>Event String</code> and the current value of the <code>checked</code> attribute of a checkbox.</p>\n\n<p>I could have</p>\n\n<pre><code>bCheck &lt;- stepper False $ UI.checkedChange checkBox\n</code></pre>\n\n<p>but this fails if I have</p>\n\n<pre><code>element checkBox # sink UI.checked bBool\n</code></pre>\n\n<p>somewhere else (no <code>UI.checkedChange</code>).</p>\n\n<p>I can use <code>show &lt;$&gt; get UI.checked checkBox</code> but then I would have to combine <code>Event String</code> and <code>UI String</code>.</p>\n"}, {"tags": ["haskell", "random"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1435037270, "post_id": 30994484, "comment_id": 50018147, "body": "Generate it once, say in <code>main</code>, and then pass it to every function that needs it.  Or (exactly the same, just a different way of phrasing it) use the <code>Reader [Int]</code> monad."}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 0, "last_activity_date": 1435037480, "creation_date": 1435037480, "answer_id": 30994546, "question_id": 30994484, "link": "https://stackoverflow.com/questions/30994484/haskell-generate-and-use-the-same-random-list/30994546#30994546", "title": "Haskell - generate and use the same random list", "body": "<p>Follow this <a href=\"https://wiki.haskell.org/Examples/Random_list\" rel=\"nofollow\">example</a>. Then, pass <code>rs</code> from <code>main</code> to whatever function needs it.</p>\n\n<p>You can't have a global variable for this without using something like <code>unsafePerformIO</code>, which, as the name indicates, should not be used. The reason is that picking random numbers is an inherently non-deterministic operation, dependent on the outside <code>IO</code> state.</p>\n"}, {"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 2, "last_activity_date": 1435038943, "last_edit_date": 1435038943, "creation_date": 1435038612, "answer_id": 30994781, "question_id": 30994484, "link": "https://stackoverflow.com/questions/30994484/haskell-generate-and-use-the-same-random-list/30994781#30994781", "title": "Haskell - generate and use the same random list", "body": "<p>Here is a simple example (@luqui mentioned) you should be able to generalize to your need:</p>\n\n<pre><code>module Main where\n\nimport Control.Monad (replicateM)\nimport System.Random (randomRIO)\n\nmain :: IO ()\nmain = do\n  randomList &lt;- randomInts 10 (1,6)\n  print randomList\n  let s = myFunUsingRandomList randomList\n  print s\n\nmyFunUsingRandomList :: [Int] -&gt; Int\nmyFunUsingRandomList list = sum list\n\nrandomInts :: Int -&gt; (Int,Int) -&gt; IO [Int]\nrandomInts len bounds = replicateM len $ randomRIO bounds\n</code></pre>\n\n<hr>\n\n<h3>remarks</h3>\n\n<ul>\n<li><code>randomInts</code> is an <code>IO</code>-action that will produce you your random list of integers, you see it's use in the very first line of <code>main</code>s <code>do</code>-block. Once it is used there the list will stay the same.</li>\n<li><code>myFunUsingRandomList</code> is a very simple example (just summing it) of using such a list in a pure fashion - indeed it just expects a list of integers and I just happen to call it with the random list from <code>main</code></li>\n</ul>\n"}], "owner": {"reputation": 12979, "user_id": 126015, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d11472083f0a899276616a936637e67?s=128&d=identicon&r=PG", "display_name": "vondip", "link": "https://stackoverflow.com/users/126015/vondip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 30994781, "answer_count": 2, "score": 1, "last_activity_date": 1435041977, "creation_date": 1435037101, "last_edit_date": 1435041977, "question_id": 30994484, "link": "https://stackoverflow.com/questions/30994484/haskell-generate-and-use-the-same-random-list", "title": "Haskell - generate and use the same random list", "body": "<p>In Haskell, I'd like to generate a random list of <code>Int</code>s and use it throughout my program. My current solution causes the array to be created randomly each time I access/use it. </p>\n\n<p>How can I overcome this problem?</p>\n"}, {"tags": ["haskell", "pug"], "comments": [{"owner": {"reputation": 4190, "user_id": 2110623, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a5f1b5f95d5b3bb75901fb546cd1c52d?s=128&d=identicon&r=PG", "display_name": "aochagavia", "link": "https://stackoverflow.com/users/2110623/aochagavia"}, "edited": false, "score": 0, "creation_date": 1435051984, "post_id": 30993569, "comment_id": 50026319, "body": "Have you tried asking on the haskell reddit or the IRC channel?"}, {"owner": {"reputation": 185, "user_id": 4260020, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o-0pOrbpoSk/AAAAAAAAAAI/AAAAAAAAACY/7IUKswfodtA/photo.jpg?sz=128", "display_name": "Richard Guay", "link": "https://stackoverflow.com/users/4260020/richard-guay"}, "reply_to_user": {"reputation": 4190, "user_id": 2110623, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a5f1b5f95d5b3bb75901fb546cd1c52d?s=128&d=identicon&r=PG", "display_name": "aochagavia", "link": "https://stackoverflow.com/users/2110623/aochagavia"}, "edited": false, "score": 0, "creation_date": 1435131143, "post_id": 30993569, "comment_id": 50066084, "body": "No. I have never used Reddit or IRC. I mostly come here for answers without having to go through a lot of junk."}, {"owner": {"reputation": 4190, "user_id": 2110623, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a5f1b5f95d5b3bb75901fb546cd1c52d?s=128&d=identicon&r=PG", "display_name": "aochagavia", "link": "https://stackoverflow.com/users/2110623/aochagavia"}, "edited": false, "score": 0, "creation_date": 1435133023, "post_id": 30993569, "comment_id": 50067242, "body": "You could give it a try! People on the IRC channel are very friendly and welcoming. Also, I think this question is more suited for that kind of place (as you can see, this question has been put on hold as off-topic, since stack overflow doesn&#39;t like questions that are about recommending libraries)."}, {"owner": {"reputation": 185, "user_id": 4260020, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o-0pOrbpoSk/AAAAAAAAAAI/AAAAAAAAACY/7IUKswfodtA/photo.jpg?sz=128", "display_name": "Richard Guay", "link": "https://stackoverflow.com/users/4260020/richard-guay"}, "reply_to_user": {"reputation": 4190, "user_id": 2110623, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a5f1b5f95d5b3bb75901fb546cd1c52d?s=128&d=identicon&r=PG", "display_name": "aochagavia", "link": "https://stackoverflow.com/users/2110623/aochagavia"}, "edited": false, "score": 1, "creation_date": 1435224748, "post_id": 30993569, "comment_id": 50114910, "body": "I have it on Reddit right now. No one know anything about one."}, {"owner": {"reputation": 4190, "user_id": 2110623, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a5f1b5f95d5b3bb75901fb546cd1c52d?s=128&d=identicon&r=PG", "display_name": "aochagavia", "link": "https://stackoverflow.com/users/2110623/aochagavia"}, "edited": false, "score": 0, "creation_date": 1435225107, "post_id": 30993569, "comment_id": 50115124, "body": "Then I guess you can conclude it doesn&#39;t exist... You are of course welcome to write your own one and publish it. However, this is probably outside the scope of your project :P"}], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 4260020, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o-0pOrbpoSk/AAAAAAAAAAI/AAAAAAAAACY/7IUKswfodtA/photo.jpg?sz=128", "display_name": "Richard Guay", "link": "https://stackoverflow.com/users/4260020/richard-guay"}, "edited": false, "score": 0, "creation_date": 1435130833, "post_id": 30995783, "comment_id": 50065893, "body": "Shakespeare is good, but it doesn&#39;t do Jade translation. I have a server for my site written in go that uses Amber templates (Amber is go&#39;s version of Jade, which is from PHP). Since the site is full of files of that format, I want to create a Haskell server that will serve them just like the go server does. Trying to see if one is better than the other."}], "tags": [], "owner": {"reputation": 460, "user_id": 2940429, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2039ee57d6c309dd6644d5d5f6bb9936?s=128&d=identicon&r=PG&f=1", "display_name": "timbernasley", "link": "https://stackoverflow.com/users/2940429/timbernasley"}, "is_accepted": false, "score": 0, "last_activity_date": 1435042403, "creation_date": 1435042403, "answer_id": 30995783, "question_id": 30993569, "link": "https://stackoverflow.com/questions/30993569/is-there-a-jade-library-for-haskell/30995783#30995783", "title": "Is there a Jade Library for Haskell?", "body": "<p>Did you find <a href=\"http://hackage.haskell.org/package/shakespeare\" rel=\"nofollow\">shakespeare</a> yet? Shakespeare is what the <a href=\"http://www.yesodweb.com/\" rel=\"nofollow\">Yesod Web Framework</a> uses for HTML, CSS and Javascript creation. So i guess it must be usefull.</p>\n"}], "owner": {"reputation": 185, "user_id": 4260020, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o-0pOrbpoSk/AAAAAAAAAAI/AAAAAAAAACY/7IUKswfodtA/photo.jpg?sz=128", "display_name": "Richard Guay", "link": "https://stackoverflow.com/users/4260020/richard-guay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "closed_date": 1435049878, "answer_count": 1, "score": 2, "last_activity_date": 1435131087, "creation_date": 1435031536, "last_edit_date": 1435131087, "question_id": 30993569, "link": "https://stackoverflow.com/questions/30993569/is-there-a-jade-library-for-haskell", "closed_reason": "Not suitable for this site", "title": "Is there a Jade Library for Haskell?", "body": "<p>I have a server for my site written in go that uses <a href=\"https://github.com/eknkc/amber\" rel=\"nofollow\">Amber</a> templates (Amber is go's version of Jade, which is from PHP). Since the site is full of files of that format, I want to create a Haskell server that will serve them just like the go server does. Trying to see if one is better than the other.</p>\n\n<p>I have looked everywhere for a jade package written in Haskell. I have seen questions from people saying they are developing one, but I can not find a finished product. Does anyone know of one? Or, does anyone have an idea how to add something like this to Haskell?</p>\n"}, {"tags": ["haskell", "functional-programming", "frp", "netwire"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1435023251, "post_id": 30992299, "comment_id": 50014391, "body": "The easiest way to get input in and output out of netwire is <a href=\"http://stackoverflow.com/a/25636139/414413\">through the inputs and outputs of the outermost wire</a>."}, {"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1435023342, "post_id": 30992299, "comment_id": 50014407, "body": "The thing is, I am trying to prevent the input from blocking."}], "answers": [{"comments": [{"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1435058257, "post_id": 30994018, "comment_id": 50030406, "body": "Wow, that is a lot of stuff... Do I really need to build a whole framework in order to achieve the goal?"}, {"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1435062142, "post_id": 30994018, "comment_id": 50032941, "body": "I have to say I don&#39;t understand how Netwire works. Especially how the wires and events are related together. Are events just special wires? Or are they signals that pass through wires?"}, {"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1435063913, "post_id": 30994018, "comment_id": 50034130, "body": "I am kind of stuck on trying to dissect <code>(fmap ((:[]) . print) &lt;$&gt; periodic 1 . time)</code>. What is being <code>fmap</code>ed on to what? I am intrigued by the infix operator. Is <code>&lt;$&gt;</code> trying to apply <code>(fmap ((:[]) . print))</code> onto <code>(periodic 1 . time)</code>? If so, then why a function of type <code>f a -&gt; f [IO ()]</code> can be applied on <code>Wire s e m a (Event t)</code>? Is the latter type just the <code>a</code> in the function?"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1435068461, "post_id": 30994018, "comment_id": 50037602, "body": "@CarlDong It&#39;s normal to make a small framework to hook up an FRP library to the outside world. This is also needed in for other FRP libraries; for example, in reactive-banana you build a framework using <a href=\"https://hackage.haskell.org/package/reactive-banana-0.8.1.2/docs/Reactive-Banana-Frameworks.html\" rel=\"nofollow noreferrer\"><code>Reactive.Banana.Frameworks</code></a>"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1435069159, "post_id": 30994018, "comment_id": 50038136, "body": "@CarlDong <code>Events</code> in netwire are just an opaque <code>Maybe</code> type; An <code>Event a</code> is either occurring at this point in time with data <code>a</code> or it isn&#39;t occurring. They are kept opaque for reasons of correctness. <a href=\"http://hub.darcs.net/ertes/netwire#events\" rel=\"nofollow noreferrer\">&quot;This is necessary in order to protect continuous time semantics. You cannot access event values directly.&quot;</a>.You can construct an <code>Event</code> inside a <code>Wire</code> with <code>now</code> and <code>never</code>. <code>Event</code>s expose a <code>Functor</code> instance, so you can <code>fmap</code> on them. There&#39;s nothing special about wires holding events except that you are allowed to use them for switching."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1435069832, "post_id": 30994018, "comment_id": 50038724, "body": "@CarlDong <code>periodic 1 . t</code> has type <code>(HasTime t s, Monad m) =&gt; Wire s e m a (Event t)</code>. It&#39;s a wire of events holding the current time. The events only occur once per second. I want to replace each time <code>t</code> with <code>[print t]</code>; that&#39;s what the function <code>(:[]) . print</code> does. Both the <code>Wire</code> and the <code>Event</code> inside the <code>Wire</code> have <code>Functor</code> instances. The outer <code>fmap</code> (the <code>&lt;$&gt;</code>) modifies what&#39;s held in the <code>Wire</code> replacing <code>Event t</code> with <code>Event [IO ()]</code>. The inner <code>fmap</code> modifies what&#39;s held in the <code>Event</code>, replacing <code>t</code> with <code>[IO ()]</code>. <code>fmap ((:[]) . print) :: Event t -&gt; Event [IO ()]</code>."}, {"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1435071599, "post_id": 30994018, "comment_id": 50040156, "body": "I am trying to understand the structure, and make this approach single threaded. Type problems are quite difficult, though."}, {"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1435085064, "post_id": 30994018, "comment_id": 50048734, "body": "I have to say that although I solved this specific problem, I still don&#39;t know how to use netwire to make any non trivial applications... I may look into reactive-banana too for FRP"}, {"owner": {"reputation": 2567, "user_id": 994206, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/699bacad8f85a069dda312cc29e03baa?s=128&d=identicon&r=PG", "display_name": "Mokosha", "link": "https://stackoverflow.com/users/994206/mokosha"}, "edited": false, "score": 0, "creation_date": 1443568190, "post_id": 30994018, "comment_id": 53544060, "body": "For a (more) non-trivial example, take a look at this <a href=\"https://github.com/Mokosha/HsTetrisAttack\" rel=\"nofollow noreferrer\">example of a Tetris Attack clone</a> I wrote using netwire 5."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 3, "last_activity_date": 1435035383, "last_edit_date": 1435035383, "creation_date": 1435034834, "answer_id": 30994018, "question_id": 30992299, "link": "https://stackoverflow.com/questions/30992299/console-interactivity-in-netwire/30994018#30994018", "title": "Console interactivity in Netwire?", "body": "<p>If you don't want to block on input and output, don't block on input and output. To demonstrate how to hook up netwire to events, we'll make a little framework for running wires. We'll avoid blocking the stepping of the wire by performing all <code>IO</code> in separate threads.</p>\n\n<p>From the <a href=\"http://hub.darcs.net/ertes/netwire\" rel=\"nofollow\">netwire documentation</a>, we are allowed to deconstruct <code>Event</code>s if we are developing a framework.</p>\n\n<blockquote>\n  <p>Netwire does not export the constructors of the <code>Event</code> type by default. If you are a framework developer you can import the <code>Control.Wire.Unsafe.Event</code> module to implement your own events.</p>\n</blockquote>\n\n<p>This lets us see that <a href=\"http://hackage.haskell.org/package/netwire-5.0.1/docs/Control-Wire-Unsafe-Event.html#t:Event\" rel=\"nofollow\"><code>Event</code></a> is just</p>\n\n<pre><code>data Event a = NoEvent | Event a\n</code></pre>\n\n<p>We will make a very simple framework that uses one action in <code>m</code> for input and one for output. It runs an action <code>m (Either e a)</code> to read an action or inhibit. It either runs an action <code>b -&gt; m ()</code> to output or stops when the wire inhibits.</p>\n\n<pre><code>import Control.Wire\nimport Prelude hiding ((.), id)\n\nimport Control.Wire.Unsafe.Event\n\nrun :: (HasTime t s, Monad m) =&gt;\n       m (Either e a) -&gt; (b -&gt; m ()) -&gt;\n       Session m s -&gt; Wire s e m (Event a) (Event b) -&gt; m e\nrun read write = go\n    where\n        go session wire = do\n            (dt, session') &lt;- stepSession session\n            a &lt;- read\n            (wt', wire') &lt;- stepWire wire dt (Event &lt;$&gt; a)\n            case wt' of\n                Left e -&gt; return e\n                Right bEvent -&gt; do\n                    case bEvent of\n                        Event b -&gt; write b\n                        _       -&gt; return ()\n                    go session' wire'\n</code></pre>\n\n<p>We will use this to run an example program that outputs the time every second and stops (inhibits) when the <code>'x'</code> key is pressed.</p>\n\n<pre><code>example :: (HasTime t s, Monad m, Show t) =&gt;\n           Wire s () m (Event [InputEvent]) (Event [OutputEvent])\nexample = switch $\n            (fmap ((:[]) . print) &lt;$&gt; periodic 1 . time)\n            &amp;&amp;&amp;\n            (fmap (const mkEmpty) &lt;$&gt; filterE (any (== KeyPressed 'x')))\n</code></pre>\n\n<p>The input and output events carry multiple events in case more than one event takes place in the same time step. The input events are just pressed character keys. The output events are <code>IO</code> actions.</p>\n\n<pre><code>data InputEvent = KeyPressed Char \n  deriving (Ord, Eq, Read, Show)\ntype OutputEvent = IO ()\n</code></pre>\n\n<p>Our non-blocking IO will run three threads: an input thread, an output thread, and a wire thread. They will communicate with each other by atomically modifying <code>IORef</code>s. This is overkill for an example program (we could have just used <code>hReady</code> when reading) and not enough for a production program (The IO threads will spin waiting on characters and output). In practice polling for events and scheduling output will usually be provided by some other IO framework (OpenGL, a gui toolkit, a game engine, etc).</p>\n\n<pre><code>import Data.IORef\n\ntype IOQueue a = IORef [a]\n\nnewIOQueue :: IO (IOQueue a)\nnewIOQueue = newIORef []\n\nreadIOQueue :: IOQueue a -&gt; IO [a]\nreadIOQueue = flip atomicModifyIORef (\\xs -&gt; ([], reverse xs))\n\nappendIOQueue :: IOQueue a -&gt; [a] -&gt; IO ()\nappendIOQueue que new = atomicModifyIORef que (\\xs -&gt; (reverse new ++ xs, ()))\n</code></pre>\n\n<p>The main thread sets up the queues, spawns the IO threads, runs the wire, and signals the IO threads when the program has stopped.</p>\n\n<pre><code>import Control.Concurrent.MVar\nimport Control.Concurrent.Async\n\nimport Control.Monad.IO.Class\n\nrunKeyboard :: (HasTime t s, MonadIO m) =&gt;\n               Session m s -&gt; Wire s e m (Event [InputEvent]) (Event [OutputEvent]) -&gt; m e\nrunKeyboard session wire = do\n    stopped &lt;- liftIO newEmptyMVar \n    let continue = isEmptyMVar stopped\n    inputEvents  &lt;- liftIO newIOQueue\n    outputEvents &lt;- liftIO newIOQueue\n    inputThread  &lt;- liftIO $ async (readKeyboard continue (appendIOQueue inputEvents .    (:[])))\n    outputThread &lt;- liftIO $ async (runEvents    continue (sequence_ &lt;$&gt; readIOQueue outputEvents))\n    let read  = liftIO $ Right &lt;$&gt; readIOQueue   inputEvents \n    let write = liftIO .           appendIOQueue outputEvents\n    e &lt;- run read write session wire\n    liftIO $ putMVar stopped ()\n    liftIO $ wait inputThread\n    liftIO $ wait outputThread\n    return e\n</code></pre>\n\n<p>The input thread waits for keys, spinning when there is no input ready. It sends <code>KeyPressed</code> events to the queue.</p>\n\n<pre><code>import System.IO\n\nreadKeyboard :: IO Bool -&gt; (InputEvent -&gt; IO ()) -&gt; IO ()\nreadKeyboard continue send = do\n    hSetBuffering stdin NoBuffering\n    while continue $ do\n        ifM (hReady stdin) $ do\n            a &lt;- getChar\n            send (KeyPressed a)\n\nifM :: Monad m =&gt; m Bool -&gt; m a -&gt; m ()\nifM check act = do\n    continue &lt;- check\n    if continue then act &gt;&gt; return () else return ()\n\nwhile :: Monad m =&gt; m Bool -&gt; m a -&gt; m ()\nwhile continue act = go\n    where\n        go = ifM continue loop\n        loop = act &gt;&gt; go\n</code></pre>\n\n<p>The output thread runs the actions it is sent as long as it is instructed to continue (and once more after it is signaled to stop to make sure all the output happens).</p>\n\n<pre><code>runEvents :: IO Bool -&gt; (IO (IO ())) -&gt; IO ()\nrunEvents continue fetch = (while continue $ fetch &gt;&gt;= id) &gt;&gt; fetch &gt;&gt;= id\n</code></pre>\n\n<p>We can run the example program with <code>runKeyboard</code>.</p>\n\n<pre><code>main = runKeyboard clockSession_ example\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "is_accepted": true, "score": 0, "last_activity_date": 1443564120, "last_edit_date": 1495540899, "creation_date": 1443503365, "answer_id": 32836079, "question_id": 30992299, "link": "https://stackoverflow.com/questions/30992299/console-interactivity-in-netwire/32836079#32836079", "title": "Console interactivity in Netwire?", "body": "<p>First, I would point to <a href=\"https://stackoverflow.com/questions/32745934/kleisli-arrow-in-netwire-5\">Kleisli Arrow in Netwire 5?</a>. I came up with that answer after a longggg time of trying to understand Monads and Arrows. <del>I will put a minimal example using Kleisli Wire soon.</del></p>\n\n<p>This program merely echos what the user types, and quits when it hits a <code>q</code>. Though useless, it demonstrates a probably good practice of using Netwire 5.</p>\n\n<pre><code>mkKleisli :: (Monad m, Monoid e) =&gt; (a -&gt; m b) -&gt; Wire s e m a b\nmkKleisli f = mkGen_ $ \\a -&gt; liftM Right $ f a\n</code></pre>\n\n<p>This is the Kleisli wire constructor written in the answer in the post referenced. In summary, this function lifts any Kleisli function <code>a -&gt; m b</code> into <code>Wire s e m a b</code>. This is the core about any I/O we are doing in this program.</p>\n\n<p>Since we are echoing as user types, <code>hGetChar</code> is probably the best choice. Therefore, we lift that into a wire.</p>\n\n<pre><code>inputWire :: Wire s () IO () Char\ninputWire = mkKleisli $ \\_ -&gt; hGetChar stdin\n</code></pre>\n\n<p>Similarly, we use the following wire to output characters on screen.</p>\n\n<pre><code>outputWire :: Wire s () IO Char ()\noutputWire = mkKleisli $ putChar\n</code></pre>\n\n<p>Then to determine when we need to quit, a pure wire is constructed to output <code>True</code> when <code>q</code> is the input (Note that <code>mkSF_</code> can be used instead of <code>arr</code>).</p>\n\n<pre><code>quitWire :: (Monad m, Monoid e) =&gt; Wire s e m Char Bool\nquitWire = arr $ quitNow\n    where \n      quitNow c \n          | c == 'q' || c == 'Q' = True\n          | otherwise = False\n</code></pre>\n\n<p>To actually use the information of quitting, we need to write a special (but really simple) <code>runWire</code> function which runs a wire of type <code>Wire s e m () Bool</code>. When the wire is inhibited or returns false, the function ends.</p>\n\n<pre><code>runWire :: (Monad m) =&gt; Session m s -&gt; Wire s e m () Bool -&gt; m ()\nrunWire s w = do\n  (ds, s') &lt;- stepSession s\n  (quitNow, w') &lt;- stepWire w ds (Right ())\n  case quitNow of\n    Right False -&gt; runWire s' w'\n    _ -&gt; return ()\n</code></pre>\n\n<p>Now, let's put wires together.</p>\n\n<pre><code>mainWire = inputWire &gt;&gt;&gt; (quitWire &amp;&amp;&amp; outputWire) &gt;&gt;&gt; arr (\\(q,_) -&gt; q)\n</code></pre>\n\n<p>Of course we can use the Arrow syntax:</p>\n\n<pre><code>mainWire = proc _ -&gt; do \n  c &lt;- inputWire -&lt; ()\n  q &lt;- quitWire -&lt; c\n  outputWire -&lt; c\n  returnA -&lt; q\n</code></pre>\n\n<p>Not sure if the <code>proc</code> version is faster or not, but in this simple example, both are quite readable.</p>\n\n<p>We get input from <code>inputWire</code>, feed it to both <code>quitWire</code> and <code>outputWire</code> and get a tuple <code>(Bool, ())</code>. Then we take the first one as the final output.</p>\n\n<p>At last, we run everything in <code>main</code>!</p>\n\n<pre><code>main = do \n  hSetEcho stdin False \n  hSetBuffering stdin NoBuffering\n  hSetBuffering stdout NoBuffering \n  runWire clockSession_ mainWire\n</code></pre>\n\n<p>Here comes the final code I used:</p>\n\n<pre><code>{-# LANGUAGE Arrows #-}\n\nmodule Main where\n\nimport Control.Wire\nimport Control.Monad\nimport Control.Arrow\nimport System.IO\nimport Prelude hiding ((.), id)\n\nmkKleisli :: (Monad m, Monoid e) =&gt; (a -&gt; m b) -&gt; Wire s e m a b\nmkKleisli f = mkGen_ $ \\a -&gt; liftM Right $ f a\n\ninputWire :: Wire s () IO () Char\ninputWire = mkKleisli $ \\_ -&gt; hGetChar stdin\n\noutputWire :: Wire s () IO Char ()\noutputWire = mkKleisli $ putChar\n\nquitWire :: (Monad m, Monoid e) =&gt; Wire s e m Char Bool\nquitWire = arr $ quitNow\n    where \n      quitNow c \n          | c == 'q' || c == 'Q' = True\n          | otherwise = False\n\nrunWire :: (Monad m) =&gt; Session m s -&gt; Wire s e m () Bool -&gt; m ()\nrunWire s w = do\n  (ds, s') &lt;- stepSession s\n  (quitNow, w') &lt;- stepWire w ds (Right ())\n  case quitNow of\n    Right False -&gt; runWire s' w'\n    _ -&gt; return ()\n\nmainWire = inputWire &gt;&gt;&gt; (quitWire &amp;&amp;&amp; outputWire) &gt;&gt;&gt; arr (\\(q,_) -&gt; q)\n\nmain = do \n  hSetEcho stdin False \n  hSetBuffering stdin NoBuffering\n  hSetBuffering stdout NoBuffering \n  runWire clockSession_ mainWire\n</code></pre>\n"}], "owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 2, "accepted_answer_id": 32836079, "answer_count": 2, "score": 4, "last_activity_date": 1443564120, "creation_date": 1435021810, "last_edit_date": 1435076790, "question_id": 30992299, "link": "https://stackoverflow.com/questions/30992299/console-interactivity-in-netwire", "title": "Console interactivity in Netwire?", "body": "<p>I am testing with the <code>Netwire</code> haskell library and made it work with a simple <code>time</code> wire:</p>\n\n<pre><code>import Control.Wire\nimport Prelude hiding ((.), id)\n\nimport Control.Monad.IO.Class\nimport Data.Functor.Identity\nimport System.IO\n\nwire :: (HasTime t s) =&gt; Wire s () m a t\nwire = time\n\nrun :: (HasTime t s, MonadIO m, Show b, Show e) =&gt;\n       Session m s -&gt; Wire s e m a b -&gt; m ()\nrun session wire = do\n  (dt, session') &lt;- stepSession session\n  (wt', wire') &lt;- stepWire wire dt $ Right undefined\n  case wt' of\n    -- | Exit\n    Left _ -&gt; return ()\n    Right x -&gt; do\n      liftIO $ do\n        putChar '\\r'\n        putStr $ either (\\ex -&gt; show ex) show wt'\n        hFlush stdout\n        -- Interactivity here?\n        gotInput &lt;- hReady stdin\n        if gotInput then\n          return ()\n          else return ()\n      run session' wire'\n\nmain :: IO ()\n-- main = testWire clockSession_ wire\nmain = run clockSession_ wire\n</code></pre>\n\n<p>Note: the <code>run</code> is basically modified from <code>testWire</code>, so I don't know if it is the correct way to form a network of wires. Part of the code origin from <a href=\"http://todayincode.tumblr.com/post/96914679355/almost-a-netwire-5-tutorial\" rel=\"nofollow\">http://todayincode.tumblr.com/post/96914679355/almost-a-netwire-5-tutorial</a> but that tutorial does not say about events.</p>\n\n<p>Now I am trying to add a bit interactivity to the program. For now, quit the program when any key is pressed. I suppose I should do some event switching. However, I am stuck here because I cannot find a way to either change <code>wire'</code> or switch the behaviour. I tried to read the API document and the source, but I don't see how to actually \"fire\" an Event or using it to switch the wire.</p>\n\n<p>Again, since I am not yet very familiar with Haskell, I may have made some big stupid mistakes here. </p>\n\n<p><strong>Update 1/2</strong></p>\n\n<p>I got my goal working by the following code. The timer stops on any key press. <em>Update 2</em> I managed to separate out <code>pollInput</code> into another <code>IO</code> only function, Yay!</p>\n\n<pre><code>import Control.Wire\nimport Prelude hiding ((.), id)\n\nimport Control.Monad.IO.Class\nimport Data.Functor.Identity\nimport System.IO\n\nwire :: (HasTime t s) =&gt; Wire s () m a t\nwire = time\n\nrun :: (HasTime t s, MonadIO m, Show b, Show e) =&gt;\n       Session m s -&gt; Wire s e m a b -&gt; m ()\nrun session wire = do\n  -- Get input here\n  input &lt;- liftIO $ pollInput\n\n  (dt, session') &lt;- stepSession session\n  (wt', wire') &lt;- stepWire wire dt $ input\n  case wt' of\n    -- | Exit\n    Left _ -&gt; liftIO (putStrLn \"\") &gt;&gt; return ()\n    Right x -&gt; do\n      liftIO $ do\n        putChar '\\r'\n        putStr $ either (\\ex -&gt; show ex) show wt'\n        hFlush stdout\n\n      run session' wire'\n\npollInput :: IO (Either a b)\npollInput =  do\n  gotInput &lt;- hReady stdin\n  if gotInput then\n    return (Left undefined)\n    else return (Right undefined)\n\n\nsetup :: IO ()\nsetup = do\n  hSetBuffering stdin NoBuffering\n  hSetBuffering stdout NoBuffering\n\n\nmain :: IO ()\nmain = do\n  setup\n  run clockSession_ wire\n</code></pre>\n\n<p>However, this raises some further questions. First, is this good practise? <del>Second, what is the type of <code>pollInput</code>? I tried to manually type it out but without success. Automatic type deduction works, though. </del></p>\n\n<p>This is my explanation of how this code works:</p>\n\n<p>First, the user input from console is polled, and after some logic, the \"input\" to wire is generated (poor name choice, but that input generated is the wire input) and passed along the network. Here, I simply pass an inhibition (<code>Left something</code>), and will cause the loop to exit. Of course, when exiting, the program produces a newline to make console look nicer.</p>\n\n<p>(Well, I still don't understand how <code>Event</code> works, though)</p>\n\n<p><strong>Update 3/4</strong></p>\n\n<p>After reading @Cirdec 's answer, and fiddled a lot on my editor, I get this single threaded version without <code>IORef</code>, also quitting on pressing 'x'<em>Update 4</em>: <del>(but  it does not output anything)</del>:</p>\n\n<pre><code>import Control.Wire\nimport Prelude hiding ((.),id)\nimport Control.Wire.Unsafe.Event\nimport System.IO\nimport Control.Monad.IO.Class\n\ndata InputEvent = KeyPressed Char \n                | NoKeyPressed\n                deriving (Ord, Eq, Read, Show)\ntype OutputEvent = IO ()\n\n--- Wires\nexample :: (HasTime t s, Monad m, Show t) =&gt;\n           Wire s () m (Event [InputEvent]) (Event [OutputEvent])\nexample = switch $\n          (fmap ((:[]) . print) &lt;$&gt; periodic 1 . time\n           &amp;&amp;&amp;\n           fmap (const mkEmpty) &lt;$&gt; filterE (any (== KeyPressed 'x'))\n           )\n\nreadKeyboard :: IO (Either e (InputEvent))\nreadKeyboard = do\n  hSetBuffering stdin NoBuffering\n  gotInput &lt;- hReady stdin\n  if gotInput then do\n    c &lt;- getChar\n    return $ Right $ KeyPressed c\n    else return $ Right $ NoKeyPressed\n\noutput :: [OutputEvent] -&gt; IO ()\noutput (x:xs) = id x &gt;&gt; output xs\noutput _ = return ()\n\nrun :: (HasTime t s, MonadIO m) =&gt;\n       Session m s -&gt; Wire s e m (Event [InputEvent]) (Event [OutputEvent]) -&gt; m e\nrun = go\n  where\n    go session wire = do\n      -- | inputEvent :: Event InputEvent\n      inputEvent &lt;- liftIO $ readKeyboard\n      (dt, session') &lt;- stepSession session\n      (wt', wire') &lt;- stepWire wire dt (Event &lt;$&gt; (fmap (:[]) inputEvent))\n      -- (wt', wire') &lt;- stepWire wire dt (Right undefined)\n      case wt' of\n        Left a -&gt; return a\n        Right bEvent -&gt; do\n          case bEvent of\n            Event b -&gt; liftIO $ output b\n            _ -&gt; return ()\n          go session' wire'\n\nmain = do\n  run clockSession_ example\n</code></pre>\n\n<p>I think this is much better than my original, but I am still not completely convinced whether it is good practise or not.</p>\n"}, {"tags": ["haskell", "linker", "linker-errors", "ghc", "cabal"], "answers": [{"tags": [], "owner": {"reputation": 1168, "user_id": 724627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4751b998536f5f1e96faaf75ef1665c3?s=128&d=identicon&r=PG", "display_name": "rofer", "link": "https://stackoverflow.com/users/724627/rofer"}, "is_accepted": false, "score": 2, "last_activity_date": 1444071140, "last_edit_date": 1444071140, "creation_date": 1435019645, "answer_id": 30992018, "question_id": 30991831, "link": "https://stackoverflow.com/questions/30991831/ghc-undefined-reference-to-paths-in-dependency/30992018#30992018", "title": "GHC undefined reference to Paths in dependency", "body": "<p>Looks like I missed something in the documentation for Paths_pkgname</p>\n\n<blockquote>\n  <p>If you decide to import the Paths_pkgname module then it must be\n  listed in the other-modules field just like any other module in your\n  package.</p>\n</blockquote>\n\n<p>Adding Paths_rlglue to my library's other-modules fixed the issue. Hope this saves someone all the time I lost on this.</p>\n"}, {"tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 5, "last_activity_date": 1435019658, "creation_date": 1435019658, "answer_id": 30992021, "question_id": 30991831, "link": "https://stackoverflow.com/questions/30991831/ghc-undefined-reference-to-paths-in-dependency/30992021#30992021", "title": "GHC undefined reference to Paths in dependency", "body": "<p>You need to include the Paths_rlglue module in exposed-modules or other-modules like any other module in your project so that Cabal will link it.</p>\n\n<p>Cabal should be better about telling you what is going on, see <a href=\"https://github.com/haskell/cabal/issues/1746\" rel=\"noreferrer\">https://github.com/haskell/cabal/issues/1746</a>.</p>\n"}], "owner": {"reputation": 1168, "user_id": 724627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4751b998536f5f1e96faaf75ef1665c3?s=128&d=identicon&r=PG", "display_name": "rofer", "link": "https://stackoverflow.com/users/724627/rofer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 2, "accepted_answer_id": 30992021, "answer_count": 2, "score": 3, "last_activity_date": 1444071140, "creation_date": 1435018173, "last_edit_date": 1435018736, "question_id": 30991831, "link": "https://stackoverflow.com/questions/30991831/ghc-undefined-reference-to-paths-in-dependency", "title": "GHC undefined reference to Paths in dependency", "body": "<p>I recently made a cabal package which can be seen <a href=\"https://github.com/rhofour/rlglue-haskell-codec/tree/v0.2.1.1\" rel=\"nofollow\">here</a>\nIt consists of a library and a few small example programs using it. Everything builds and works as expected.</p>\n\n<p>I wanted to build an executable in a new package which uses this library, however I continue to run into a linking error I can't decipher:</p>\n\n<pre><code>/my/path/RandomAgent/.cabal-sandbox/lib/x86_64-linux-ghc-7.8.4/rlglue-0.2.1.1/libHSrlglue-0.2.1.1.a(Agent.o):(.text+0x34f1): undefined reference to `rlgluezm0zi2zi1zi1_Pathszurlglue_version1_closure'\n</code></pre>\n\n<p>collect2: error: ld returned 1 exit status\nTo make things simpler to diagnose I moved one of the examples programs into my new package and discovered even it won't build properly. You can find that version of the executable <a href=\"https://github.com/rhofour/rlglue-random-agent/tree/v0.1.0.0\" rel=\"nofollow\">here</a>.</p>\n\n<p>From this I've concluded that the problem is likely in something I'm doing in my .cabal files, but I can't see what's wrong. The error also seems to refer to the Paths_rlglue module which cabal automatically generates for the first package.</p>\n\n<p>Can anyone help me understand why I'm getting this error?</p>\n"}, {"tags": ["haskell", "recursion", "types", "type-synonyms"], "answers": [{"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1435025556, "post_id": 30991761, "comment_id": 50014942, "body": "Or just <code>data NestedList a = List [NestedList a] | Element a deriving Foldable</code>."}, {"owner": {"reputation": 125, "user_id": 2421116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f32a1587c6c2ee687f83d6ff29ed370f?s=128&d=identicon&r=PG", "display_name": "Iedu", "link": "https://stackoverflow.com/users/2421116/iedu"}, "edited": false, "score": 0, "creation_date": 1435041833, "post_id": 30991761, "comment_id": 50020143, "body": "Indeed, your solution does work with <code>flatten</code>, but this is not what I am trying to achieve. I guess I was not very specific, and I will edit my question. The problem is that I cannot use <code>[[[Int]]]</code> and <code>NestedList Int</code> interchangeably, i.e. call the function with <code>[[[Int]]]</code>. This is why I would like something that works like type synonyms."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 125, "user_id": 2421116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f32a1587c6c2ee687f83d6ff29ed370f?s=128&d=identicon&r=PG", "display_name": "Iedu", "link": "https://stackoverflow.com/users/2421116/iedu"}, "edited": false, "score": 1, "creation_date": 1435042708, "post_id": 30991761, "comment_id": 50020626, "body": "@GeorgeUngureanu I see. I don&#39;t think you will find type synonym <code>Datalist a</code> that will work for <code>[a]</code>, <code>[[a]]</code>, etc. since that would mean that <code>[a] = Datalist a = [[a]]</code> yet this is clearly untrue."}, {"owner": {"reputation": 125, "user_id": 2421116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f32a1587c6c2ee687f83d6ff29ed370f?s=128&d=identicon&r=PG", "display_name": "Iedu", "link": "https://stackoverflow.com/users/2421116/iedu"}, "edited": false, "score": 0, "creation_date": 1435045664, "post_id": 30991761, "comment_id": 50022292, "body": "@Alec: Absolutely! And Haskell does not permit that, indeed. But a function implemented in an applicative manner works perfectly with <code>[a]</code>, <code>[[a]]</code>, etc. I just need to give that function a type signature (while still making sure that the base type is <code>a</code>)"}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 6, "last_activity_date": 1435046192, "last_edit_date": 1435046192, "creation_date": 1435017447, "answer_id": 30991761, "question_id": 30991672, "link": "https://stackoverflow.com/questions/30991672/identifying-recursive-nested-types-in-haskell-like-type-synonyms/30991761#30991761", "title": "Identifying recursive/nested types in Haskell (like type synonyms)", "body": "<p>Are you looking for something like this?</p>\n\n<pre><code>data NestedList a = List [NestedList a] | Element a\n\nflatten :: NestedList a -&gt; [a]\nflatten (Element x) = [x]\nflatten (List xs)   = concatMap flatten xs\n</code></pre>\n\n<h3>EDIT</h3>\n\n<p>As user2407038 has suggested, if you are interested in using the <code>Foldable</code> (include <code>{-# LANGUAGE DeriveFoldable #-}</code> at the top of your file and <code>import Data.Foldable</code>) GHC extension, you can just do this</p>\n\n<pre><code>data NestedList a = List [NestedList a] | Element a deriving (Foldable)\n</code></pre>\n\n<p>And then there is a function called <code>toList</code> already defined in <code>Foldable</code> which will produce the same output as <code>flatten</code> from above.</p>\n\n<h3>EDIT 2</h3>\n\n<p>Here is something else of interest concerning the updated question. Ideally, it would be nice to be able to define an instance of <code>Foldable</code> with</p>\n\n<pre><code>instance (Foldable t, Functor t, Foldable t') =&gt; Foldable (t . t')\n</code></pre>\n\n<p>where <code>(t . t') a</code> is a type synonym for <code>t (t' a)</code> (a sort of type level composition). This obviously doesn't work, and I'm inclined to think there is a logical explanation as to why introducing this would break Haskell in some fundamental way, but I can't think of it. However, there is a package called <a href=\"https://hackage.haskell.org/package/TypeCompose-0.6.7/docs/Control-Compose.html\" rel=\"nofollow\">Control.Compose</a> which defines something almost like that (except for the fact we would like a <code>type</code> synonym as opposed to a <code>newtype</code>).</p>\n\n<pre><code>newtype (g :. f) a = O { unO :: g (f a) }\n</code></pre>\n\n<p>This lets us write the following:</p>\n\n<pre><code>toList $ (O) [[1,2,3,4],[4,5,6]]\ntoList $ (O . O) [[[1],[2,3,4]],[[4],[5,6]]]\ntoList $ (O . O . O) [[[[1]],[[2,3],[4]]],[[[4]],[[5,6]]]]\n</code></pre>\n\n<p>Which is also of interest.</p>\n"}], "owner": {"reputation": 125, "user_id": 2421116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f32a1587c6c2ee687f83d6ff29ed370f?s=128&d=identicon&r=PG", "display_name": "Iedu", "link": "https://stackoverflow.com/users/2421116/iedu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 476, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435096087, "creation_date": 1435016656, "last_edit_date": 1495542139, "question_id": 30991672, "link": "https://stackoverflow.com/questions/30991672/identifying-recursive-nested-types-in-haskell-like-type-synonyms", "title": "Identifying recursive/nested types in Haskell (like type synonyms)", "body": "<h2>Short Question (edited):</h2>\n\n<p>Is it possible to define a function's type signature so that it accepts nested types with arbitrary depth? I am looking for the behaviour of type synonyms (NOT newtype) but identifying nested/recursive types. </p>\n\n<p>For example a function defined as <code>f :: NestedList a -&gt; b</code> should be able to be called with <code>[a]</code>, <code>[[a]]</code>, <code>[[[a]]]</code>... and so on.</p>\n\n<h2>Long Question (original):</h2>\n\n<p>Since it is impossible to use type synonyms in Haskell with recursive types, is there a solution for the following problem?</p>\n\n<p>I need a synonym like <code>NestedList a</code> that would identify <code>[a]</code>, <code>[[a]]</code>, <code>[[[a]]]</code>... and so on, in function type definitions. An example of function needed to be implemented is:</p>\n\n<pre><code>   flatten :: NestedList a -&gt; [a]\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/5994051/is-there-a-function-to-flatten-a-nested-list-of-elements\">This post</a> shows a solution for <code>flatten</code> using the MultiParamTypeClasses language extension, but it does not particularly solve my problem. I need to define functions outside of a class.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p><code>flatten</code> is just an example for a function definition, I am not interested in the function as such. I need a mechanism to define a function with <code>NestedList a</code> and call it with a parameter like <code>[[a]]</code> or <code>[[[a]]]</code>, without the need of an additional type constructor, get methods, etc. As suggested in the title, I need something that behaves like a type synonym on nested lists, mainly for giving type signatures for functions that work on <code>[...[a]...]</code> while making sure the base type is <code>a</code>.</p>\n\n<p>According to Haskell's strong-typed system this is impossible and <a href=\"https://stackoverflow.com/questions/8963376/why-dont-type-synonyms-permit-recursion-in-haskell\">this post</a> sheds some light on the reasons why. I am just asking if there is a macro/synonym like mechanism or workaround, or a language extension that permits me to do that.</p>\n"}, {"tags": ["function", "haskell", "composition", "pointfree"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1435006925, "post_id": 30989610, "comment_id": 50009296, "body": "Try <code>fun = funFoldr . funAdd1 . funSqr</code>"}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1435053887, "post_id": 30989610, "comment_id": 50027594, "body": "Try <code>fun = sum . map ((+1) . join (*))</code> after <code>import Control.Monad (join)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 6, "last_activity_date": 1435049679, "last_edit_date": 1435049679, "creation_date": 1435006887, "answer_id": 30989741, "question_id": 30989610, "link": "https://stackoverflow.com/questions/30989610/how-should-i-define-or-write-my-function-in-haskell-with-function-composition/30989741#30989741", "title": "How should I define or write my function in Haskell with function composition?", "body": "<p>Haskell parsing rules 101: function application binds more tightly than any infix operator. The amount of whitespace does not matter. So</p>\n\n<pre><code>funFoldr.funAdd1.funSqr xs\n   \u2261 funFoldr . funAdd1 . funSqr xs\n   \u2261 funFoldr . funAdd1 . (funSqr xs)\n</code></pre>\n\n<p>Now, <code>funSqr xs</code> is not a function anymore (just the <em>result</em> of applying a function to <code>xs</code>). You can't compose things that aren't functions.</p>\n\n<p>What you meant to try is this, and it does indeed work:</p>\n\n<pre><code>(funFoldr.funAdd1.funSqr) xs\n</code></pre>\n\n<p>More commonly, this is written</p>\n\n<pre><code>funFoldr . funAdd1 . funSqr $ xs\n</code></pre>\n\n<p>or</p>\n\n<pre><code>funFoldr . funAdd1 $ funSqr xs\n</code></pre>\n\n<p>Alternative, you can avoid the <code>funSqr xs</code> grouping if you simply don't mention <code>xs</code>:</p>\n\n<pre><code>fun :: [Int] -&gt; Int\nfun = funFoldr . funAdd1 . funSqr\n</code></pre>\n\n<p>This is called <em>point-free style</em>.</p>\n"}], "owner": {"reputation": 69, "user_id": 5037716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/608f09160b5db7f02bb1198ff51c5fcc?s=128&d=identicon&r=PG&f=1", "display_name": "Vucicasena", "link": "https://stackoverflow.com/users/5037716/vucicasena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1435055240, "creation_date": 1435006352, "last_edit_date": 1435055240, "question_id": 30989610, "link": "https://stackoverflow.com/questions/30989610/how-should-i-define-or-write-my-function-in-haskell-with-function-composition", "title": "How should I define or write my function in Haskell with function composition?", "body": "<p>I defined a function in Haskell,which is supposed to square and then add 1 to all numbers in a given list.I wanted to write that function with function composition but unfortunately it doesn't work with dot beetwen functions but it works when i write my functions with brackets.I don't understand why it doesn't work with dot or rather why doesn't it work with function composition?</p>\n\n<pre><code>square :: Int -&gt; Int\nsquare x = x * x\n\nfunSqr :: [Int] -&gt; [Int]\nfunSqr xs = [(square x) | x &lt;- xs]\n\nfunAdd1 :: [Int] -&gt; [Int]\nfunAdd1 xs = [(x + 1) | x &lt;- xs]\n\nfunFoldr :: [Int] -&gt; Int \nfunFoldr [] = 0\nfunFoldr (x:xs) = x + (funFoldr xs)\n\nfun :: [Int] -&gt; Int\nfun xs = funFoldr(funAdd1(funSqr xs))\n</code></pre>\n\n<p>But</p>\n\n<pre><code>fun :: [Int] -&gt; Int\nfun xs = funFoldr.funAdd1.funSqr xs  --Why on earth doesn't it work ?\nfun xs = funFoldr.funRek xs        --or rather this way?\n</code></pre>\n\n<p>Could someone lighten my path ?</p>\n\n<p>Thanks a lot \nAsena </p>\n"}, {"tags": ["haskell", "monads", "threepenny-gui"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1435002753, "post_id": 30988595, "comment_id": 50007191, "body": "Your <code>do</code> block must contain only one monad (ie either <code>UI</code> or <code>IO</code> but not both). If you want to debug in Haskell, a debugger might be useful."}, {"owner": {"reputation": 12979, "user_id": 126015, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d11472083f0a899276616a936637e67?s=128&d=identicon&r=PG", "display_name": "vondip", "link": "https://stackoverflow.com/users/126015/vondip"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1435003107, "post_id": 30988595, "comment_id": 50007387, "body": "How do I support print then?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1435003199, "post_id": 30988595, "comment_id": 50007436, "body": "You should try to preserve the formatting of your Haskell code in your code blocks. The code in your question has a parse error because there are no spaces before <code>print</code>. One thing that helps is StackOverflow shortcut Ctrl-k. If you highlight a block of text in a question or answer and hit Ctrl-k, it will indent each line by 4 spaces. As far as I know, this shortcut isn&#39;t officially documented anywhere but it&#39;s handy."}], "answers": [{"comments": [{"owner": {"reputation": 12979, "user_id": 126015, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d11472083f0a899276616a936637e67?s=128&d=identicon&r=PG", "display_name": "vondip", "link": "https://stackoverflow.com/users/126015/vondip"}, "edited": false, "score": 0, "creation_date": 1435003322, "post_id": 30988739, "comment_id": 50007511, "body": "The only reason to apply liftio then is to wrap the unused result of print so it won&#39;t shout at me?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 12979, "user_id": 126015, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d11472083f0a899276616a936637e67?s=128&d=identicon&r=PG", "display_name": "vondip", "link": "https://stackoverflow.com/users/126015/vondip"}, "edited": false, "score": 1, "creation_date": 1435003405, "post_id": 30988739, "comment_id": 50007553, "body": "@vondip No. The unused output is <code>()</code>. The type of the IO action is <code>IO ()</code>. In Haskell, IO actions are first-class values, so the value <code>print &quot;debug message 1&quot;</code> is the IO action that prints that message, not <code>()</code>."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 12979, "user_id": 126015, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d11472083f0a899276616a936637e67?s=128&d=identicon&r=PG", "display_name": "vondip", "link": "https://stackoverflow.com/users/126015/vondip"}, "edited": false, "score": 1, "creation_date": 1435003756, "post_id": 30988739, "comment_id": 50007753, "body": "To give another example, if you want to read in a <code>String</code> from <code>stdin</code> inside of <code>UI</code>, you could write: <code>do ... ; someInput &lt;- liftIO  getLine ; ...</code>(note that the type of <code>getLine</code> is <code>IO String</code>). <code>liftIO</code> lifts IO actions."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1435021100, "post_id": 30988739, "comment_id": 50013905, "body": "By the way: if you wanted to print to the console in response to a button click or some other UI event, rather than during the GUI initialisation, you would use either <a href=\"http://hackage.haskell.org/package/threepenny-gui-0.6.0.2/docs/Graphics-UI-Threepenny-Core.html#v:onEvent\" rel=\"nofollow noreferrer\"><code>onEvent</code></a> or <a href=\"http://hackage.haskell.org/package/threepenny-gui-0.6.0.2/docs/Graphics-UI-Threepenny-Core.html#v:on\" rel=\"nofollow noreferrer\"><code>on</code></a>. In that case, the <code>liftIO</code> would appear in the <code>(a -&gt; UI void)</code> callback passed to <code>onEvent</code>/<code>on</code>."}], "tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": true, "score": 5, "last_activity_date": 1441549335, "last_edit_date": 1441549335, "creation_date": 1435003114, "answer_id": 30988739, "question_id": 30988595, "link": "https://stackoverflow.com/questions/30988595/haskell-ui-do-clause-how-to-print/30988739#30988739", "title": "Haskell UI do clause, how to print?", "body": "<p>Based on the types, this is a good application of <a href=\"http://hackage.haskell.org/package/transformers/docs/Control-Monad-IO-Class.html#v:liftIO\" rel=\"nofollow\"><code>liftIO</code></a>. <code>liftIO</code> has a type <code>MonadIO m =&gt; IO a -&gt; m a</code> so it can be used like this:</p>\n\n<pre><code>liftIO (print \"debug message 1\")\n</code></pre>\n\n<p>The type of that expression can be <code>UI ()</code> since <code>UI</code> is an instance of <code>MonadIO</code> and <code>print \"debug message 1\"</code> has the type <code>IO ()</code>.</p>\n"}], "owner": {"reputation": 12979, "user_id": 126015, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d11472083f0a899276616a936637e67?s=128&d=identicon&r=PG", "display_name": "vondip", "link": "https://stackoverflow.com/users/126015/vondip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "accepted_answer_id": 30988739, "answer_count": 1, "score": 3, "last_activity_date": 1441549335, "creation_date": 1435002646, "last_edit_date": 1495541174, "question_id": 30988595, "link": "https://stackoverflow.com/questions/30988595/haskell-ui-do-clause-how-to-print", "title": "Haskell UI do clause, how to print?", "body": "<p>This is a follow up question to <a href=\"https://stackoverflow.com/questions/30981044/haskell-do-clause-with-multiple-monad-types/30987004#30987004\">this</a>. I'm using a graphic library in Haskell called <a href=\"http://hackage.haskell.org/package/threepenny-gui\" rel=\"nofollow noreferrer\">Threepenny-GUI</a>. In this library the main function returns a <a href=\"http://hackage.haskell.org/package/threepenny-gui/docs/Graphics-UI-Threepenny-Core.html#t:UI\" rel=\"nofollow noreferrer\"><code>UI</code></a> monad object. I'm trying to execute a simple print command with no success. What is a right work around to enable printing for debugging purposes.</p>\n\n<p>Code:</p>\n\n<pre><code>main :: IO ()\nmain = startGUI defaultConfig setup\n\nsetup :: Window -&gt; UI ()\nsetup w = do\n\nprint \"debug message 1 \"\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>Couldn't match type \u2018IO\u2019 with \u2018UI\u2019\nExpected type: UI ()\n  Actual type: IO ()\nIn a stmt of a 'do' block: print \"labels and values \"\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1435002483, "post_id": 30988317, "comment_id": 50007055, "body": "So you want to read a list of something from <code>stdin</code>? A list of what? Two things that might be useful: the <code>Read</code> class and <code>readList</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1435002502, "post_id": 30988317, "comment_id": 50007063, "body": "What kind of input do you want to convert? How is it separated? What kind of data it is containing?"}], "answers": [{"comments": [{"owner": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "edited": false, "score": 0, "creation_date": 1435003739, "post_id": 30988564, "comment_id": 50007743, "body": "Thank You, your answer is really usefull ! But can You show me how to make it possible to run this in <a href=\"http://rextester.com/runcode\" rel=\"nofollow noreferrer\">rextester.com/runcode</a> ?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "edited": false, "score": 1, "creation_date": 1435004080, "post_id": 30988564, "comment_id": 50007902, "body": "@Cosaquee Stick <code>import Data.List; main = (readLn :: IO [Integer]) &gt;&gt;= print . subsequences</code> in the code box and <code>[1,2,3]</code> in the input box, then hit &quot;Run&quot;."}, {"owner": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "edited": false, "score": 0, "creation_date": 1435004587, "post_id": 30988564, "comment_id": 50008151, "body": "If i copy this into rextester it always show : Process killed, because it ran longer than 10 seconds. I`m starting to know how IO system is working thanks to your comments !"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "edited": false, "score": 0, "creation_date": 1435005016, "post_id": 30988564, "comment_id": 50008363, "body": "@Cosaquee I get that message if I don&#39;t put anything in the &quot;input&quot; box. Have you done that part?"}, {"owner": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "edited": false, "score": 0, "creation_date": 1435006994, "post_id": 30988564, "comment_id": 50009331, "body": "Any option that i can just type  1 2 3 and it will use it as the input for subsequences ? Now i need to manually type the list."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "edited": false, "score": 0, "creation_date": 1435009813, "post_id": 30988564, "comment_id": 50010567, "body": "@Cosaquee You can write a parser for just about any format you like. Give it a shot yourself; if you get stuck, details about what you tried and why you can&#39;t make progress would be fantastic material for a fresh question. Note that the parsing stage -- turning the <code>String</code> you get from input into an <code>[Integer]</code> to process -- has nothing to do with IO."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1435002534, "creation_date": 1435002534, "answer_id": 30988564, "question_id": 30988317, "link": "https://stackoverflow.com/questions/30988317/haskell-io-read-from-standard-input-directly-to-list/30988564#30988564", "title": "Haskell IO - read from standard input directly to list", "body": "<p>You may write:</p>\n\n<pre><code>main = readLn &gt;&gt;= print . subsequences\n</code></pre>\n\n<p>You will need to nail down the type to be read, for example by having a monomorphic <code>subsequences</code> or by annotating <code>readLn</code>. In ghci:</p>\n\n<pre><code>Data.List&gt; (readLn :: IO [Integer]) &gt;&gt;= print . subsequences\n[1,2,3]\n[[],[1],[2],[1,2],[3],[1,3],[2,3],[1,2,3]]\n</code></pre>\n\n<p>(I typed in the first and second lines -- both followed by enter -- and the third line was the result.)</p>\n\n<p>For more details, you may enjoy one of the excellent resources below:</p>\n\n<ul>\n<li><a href=\"http://blog.sigfpe.com/2007/11/io-monad-for-people-who-simply-dont.html\">The IO Monad for People who Simply Don't Care</a></li>\n<li><a href=\"http://blog.sigfpe.com/2006/08/you-could-have-invented-monads-and.html\">You Could Have Invented Monads (And Maybe You Already Have)</a></li>\n<li><a href=\"https://wiki.haskell.org/All_About_Monads\">All About Monads</a></li>\n</ul>\n"}], "owner": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 637, "favorite_count": 0, "accepted_answer_id": 30988564, "answer_count": 1, "score": 0, "last_activity_date": 1435002943, "creation_date": 1435001620, "last_edit_date": 1435002943, "question_id": 30988317, "link": "https://stackoverflow.com/questions/30988317/haskell-io-read-from-standard-input-directly-to-list", "title": "Haskell IO - read from standard input directly to list", "body": "<p>Haskell IO system is super hard to understand for me so i have question : How to read from standard input to list ? I know that there is function getLine :: IO String and interact. But i do not know how to convert the input to list so I can use it in this three functions : </p>\n\n<pre><code>powerset []     = [[]]\npowerset (x:xs) = xss ++ map (x:) xss\n                               where xss = powerset xs\nmain = print $ powerset([1,2])\n\nimport Control.Monad(filterM)\np = filterM(const[True,False])\nmain = p[1,2]\n\nmain = subsequences([1,2])\n</code></pre>\n\n<p>I want to be able to write 1 2 3 and pass this values to the function. Can you tell/show how to do it ? </p>\n\n<p><strong>Extra question</strong></p>\n\n<p>Haskell is full of magic so i was wondering if it possible to use input directly in the function like this :</p>\n\n<pre><code>main = subsequences(some input magic here)\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 0, "creation_date": 1434999670, "post_id": 30986728, "comment_id": 50005491, "body": "thank you very much. I started with fold + map then I tried to &quot;merge&quot; both. Why do you think is better to keep separated foldl and map? Readability?"}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 1, "creation_date": 1435001146, "post_id": 30986728, "comment_id": 50006292, "body": "Yes, readability. Build your code from simple building blocks, and leave the rest to the compiler. Since GHC 7.10, it should be able to fuse these two functions, so no intermediate list is allocated."}], "tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": true, "score": 4, "last_activity_date": 1434995944, "creation_date": 1434995944, "answer_id": 30986728, "question_id": 30986362, "link": "https://stackoverflow.com/questions/30986362/apply-a-transformation-with-function-inline/30986728#30986728", "title": "apply a transformation with function inline", "body": "<p>The <code>read</code> lambda applies to the first argument and the first argument to the function given to <code>foldl</code> is the accumulator. Those two arguments are the opposite for <code>foldr</code>. So, expanded, it looks like this:</p>\n\n<pre><code>foldl (\\acc element -&gt; (read acc :: Int) + element) 0 [\"10\", \"20\", \"30\"]\n</code></pre>\n\n<p>Since <code>acc</code> is an <code>Int</code>, this doesn't work.</p>\n\n<p>So, with this information in hand, you can do this with <code>foldr</code> since it has the opposite argument order:</p>\n\n<pre><code>foldr ((+) . (read :: String -&gt; Int)) 0 [\"10\",\"20\",\"30\"]\n</code></pre>\n\n<p>If you want an inline <code>foldl</code> version, you can use <code>flip</code> to achieve this.</p>\n\n<p>You could also use <code>map</code> first (everything else being equal, this would be the solution I'd prefer):</p>\n\n<pre><code>foldl (+) 0 $ map (read :: String -&gt; Int) [\"10\",\"20\",\"30\"]\n</code></pre>\n\n<p>Also, <a href=\"https://wiki.haskell.org/Foldr_Foldl_Foldl&#39;\" rel=\"nofollow\">you probably want <code>foldl'</code> instead of <code>foldl</code></a>.</p>\n"}], "owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 30986728, "answer_count": 1, "score": 1, "last_activity_date": 1434995944, "creation_date": 1434994646, "question_id": 30986362, "link": "https://stackoverflow.com/questions/30986362/apply-a-transformation-with-function-inline", "title": "apply a transformation with function inline", "body": "<p>Starting from a simple case of \"fold\" (I used (+) but can be anything else):</p>\n\n<pre><code>Prelude.foldl (+) 0 [10,20,30]\n</code></pre>\n\n<p>is it possible apply an inline transformation similar to (that doesn't work):</p>\n\n<pre><code>Prelude.foldl ((+) . (\\x -&gt; read x :: Int)) 0 [\"10\",\"20\",\"30\"]\n</code></pre>\n\n<p>In case not, is there an alternative to fold, to apply a generic function and inline transformation (apart from using specific functions like 'sum', 'max' etc)?</p>\n"}, {"tags": ["haskell", "ghc", "hackage"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 4, "creation_date": 1434994341, "post_id": 30986185, "comment_id": 50002518, "body": "Yeah I&#39;d recommend <code>haskell-src-exts</code> and then walking the tree.  Just looking for a particular subpattern isn&#39;t too hard..."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1434996265, "post_id": 30986185, "comment_id": 50003569, "body": "It might be harder than that, extensions can be specified in a .cabal file as well, or by another build tool.  In practice you won&#39;t come across that often, but it is technically legal to do so."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1435004805, "post_id": 30986185, "comment_id": 50008245, "body": "Strictness is sometimes described in the documentation for the library (which is something you should read in any case if you plan to use it)."}], "answers": [{"tags": [], "owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "is_accepted": true, "score": 0, "last_activity_date": 1435093434, "creation_date": 1435093434, "answer_id": 31013497, "question_id": 30986185, "link": "https://stackoverflow.com/questions/30986185/how-to-tell-if-a-haskell-sourcecode-has-bang/31013497#31013497", "title": "How to tell if a haskell sourcecode has Bang", "body": "<p>Was able to figure this out with the parsers in Language.Haskell.Exts, which is from haskell-src-exts. Thanks luqui! </p>\n"}], "owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 31013497, "answer_count": 1, "score": 3, "last_activity_date": 1435093434, "creation_date": 1434994051, "question_id": 30986185, "link": "https://stackoverflow.com/questions/30986185/how-to-tell-if-a-haskell-sourcecode-has-bang", "title": "How to tell if a haskell sourcecode has Bang", "body": "<p>Is there any library function that tells if a given .hs file uses strictness annotation? Or do I have to go into the syntax tree? </p>\n"}, {"tags": ["haskell", "cabal", "cabal-install"], "answers": [{"comments": [{"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1434993821, "post_id": 30985989, "comment_id": 50002224, "body": "Hm, which global database?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1434995150, "post_id": 30985989, "comment_id": 50002964, "body": "@jhegedus There is only one. You can see what&#39;s in it with <code>ghc-pkg list --global</code>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 1, "last_activity_date": 1434993333, "creation_date": 1434993333, "answer_id": 30985989, "question_id": 30985679, "link": "https://stackoverflow.com/questions/30985679/is-everything-reinstalled-from-scratch-in-cabal-sandboxes/30985989#30985989", "title": "Is everything reinstalled from scratch in cabal sandboxes?", "body": "<p>Not quite. At the moment, anything in the global package database is also used by sandboxes. I believe future versions of cabal-install will restrict this to a few whitelisted core packages that ship with GHC (and that shouldn't/can't be replaced anyway).</p>\n"}], "owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 1, "accepted_answer_id": 30985989, "answer_count": 1, "score": 2, "last_activity_date": 1434993333, "creation_date": 1434992264, "question_id": 30985679, "link": "https://stackoverflow.com/questions/30985679/is-everything-reinstalled-from-scratch-in-cabal-sandboxes", "title": "Is everything reinstalled from scratch in cabal sandboxes?", "body": "<p>Let's assume the following procedure:</p>\n\n<p><code>cd /home/user/experiment</code></p>\n\n<p><code>git clone https://github.com/ryantrinkle/reflex.git</code></p>\n\n<p><code>cabal sandbox init</code> </p>\n\n<p><code>cabal install --dependencies-only</code> </p>\n\n<p><strong>Question:</strong></p>\n\n<p>At this point what packages will the sandbox in <code>/home/user/experiment</code> contain ? Will it contain the <strong>whole dependency hierarchy tree</strong> of Reflex ?</p>\n\n<p>In other words, if Reflex is the root package then will the whole dependency tree of Reflex be compiled <strong>from scratch</strong>  <strong>independently</strong> of what is installed already in the global package repository of cabal ? </p>\n\n<p>I suspect yes, but I am not sure. </p>\n\n<p>When I execute the above command sequence then the following packages are installed :</p>\n\n<pre><code>[vagrant@localhost reflex]$ cabal install --only-dependencies\nResolving dependencies...\nNotice: installing into a sandbox located at /home/vagrant/reflex\nDownloading dependent-sum-0.2.1.0...\nConfiguring base-orphans-0.3.3...\nDownloading primitive-0.5.4.0...\nConfiguring mtl-2.2.1...\nBuilding base-orphans-0.3.3...\nBuilding mtl-2.2.1...\nInstalled base-orphans-0.3.3\nConfiguring nats-1...\nBuilding nats-1...\nInstalled nats-1\nConfiguring stm-2.4.4...\nConfiguring tagged-0.8.0.1...\nInstalled mtl-2.2.1\nBuilding stm-2.4.4...\nBuilding tagged-0.8.0.1...\nConfiguring text-1.2.1.1...\nInstalled stm-2.4.4\nDownloading ref-tf-0.4...\nConfiguring transformers-compat-0.4.0.4...\nInstalled tagged-0.8.0.1\nBuilding text-1.2.1.1...\nBuilding transformers-compat-0.4.0.4...\nConfiguring dependent-sum-0.2.1.0...\nInstalled transformers-compat-0.4.0.4\nBuilding dependent-sum-0.2.1.0...\nConfiguring primitive-0.5.4.0...\nInstalled dependent-sum-0.2.1.0\nDownloading dependent-map-0.1.1.3...\nBuilding primitive-0.5.4.0...\nInstalled primitive-0.5.4.0\nConfiguring ref-tf-0.4...\nBuilding ref-tf-0.4...\nInstalled ref-tf-0.4\nConfiguring StateVar-1.1.0.0...\nBuilding StateVar-1.1.0.0...\nConfiguring distributive-0.4.4...\nInstalled StateVar-1.1.0.0\nBuilding distributive-0.4.4...\nConfiguring dependent-map-0.1.1.3...\nInstalled distributive-0.4.4\nBuilding dependent-map-0.1.1.3...\nConfiguring vector-0.10.12.3...\nInstalled dependent-map-0.1.1.3\nBuilding vector-0.10.12.3...\nInstalled text-1.2.1.1\nConfiguring hashable-1.2.3.2...\nBuilding hashable-1.2.3.2...\nInstalled hashable-1.2.3.2\nConfiguring unordered-containers-0.2.5.1...\nBuilding unordered-containers-0.2.5.1...\nInstalled unordered-containers-0.2.5.1\nConfiguring semigroups-0.16.2.2...\nBuilding semigroups-0.16.2.2...\nInstalled semigroups-0.16.2.2\nConfiguring void-0.7...\nConfiguring bifunctors-5...\nInstalled vector-0.10.12.3\nBuilding void-0.7...\nBuilding bifunctors-5...\nInstalled void-0.7\nConfiguring contravariant-1.3.1.1...\nBuilding contravariant-1.3.1.1...\nInstalled contravariant-1.3.1.1\nConfiguring comonad-4.2.6...\nInstalled bifunctors-5\nBuilding comonad-4.2.6...\nInstalled comonad-4.2.6\nConfiguring profunctors-5.1.1...\nConfiguring semigroupoids-5.0.0.2...\nBuilding profunctors-5.1.1...\nBuilding semigroupoids-5.0.0.2...\nInstalled profunctors-5.1.1\nInstalled semigroupoids-5.0.0.2\nDownloading these-0.4.1...\nConfiguring these-0.4.1...\nBuilding these-0.4.1...\nInstalled these-0.4.1\n</code></pre>\n\n<p>This seems an awful lot. </p>\n\n<p>Are these exactly the packages contained in the dependency tree of Reflex ? </p>\n\n<p>I suspect yes, but I am not sure, hence this question.</p>\n"}, {"tags": ["haskell", "types", "monoids", "type-variables", "foldable"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1434996595, "post_id": 30986119, "comment_id": 50003747, "body": "Indeed, I&#39;m pretty sure anything that terminates and has the right type is guaranteed by parametricity to be correct. Thanks a lot!"}], "tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": true, "score": 7, "last_activity_date": 1434993800, "creation_date": 1434993800, "answer_id": 30986119, "question_id": 30985070, "link": "https://stackoverflow.com/questions/30985070/how-can-i-express-foldr-in-terms-of-foldmap-for-type-aligned-sequences/30986119#30986119", "title": "How can I express foldr in terms of foldMap for type-aligned sequences?", "body": "<p>I found that this typechecks:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\nmodule FoldableTA where\n\nimport Control.Category\nimport Prelude hiding (id, (.))\n\nclass FoldableTA fm where\n  foldMapTA :: Category h =&gt; (forall b c . a b c -&gt; h b c) -&gt; fm a b d -&gt; h b d\n  foldrTA :: (forall b c d . a c d -&gt; h b c -&gt; h b d) -&gt; h p q -&gt; fm a q r -&gt; h p r\n  foldrTA f z t = appEndoTA (foldMapTA (\\x -&gt; TAEndo (f x)) t) z\n\nnewtype TAEndo h c d = TAEndo { appEndoTA :: forall b. h b c -&gt; h b d  }\n\ninstance Category (TAEndo h) where\n    id = TAEndo id\n    TAEndo f1 . TAEndo f2 = TAEndo (f1 . f2)\n</code></pre>\n\n<p>No idea if it makes any sense, but with so many type indexes around, I doubt that there is much type-checking code that does <em>not</em> make sense.</p>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 1, "accepted_answer_id": 30986119, "answer_count": 1, "score": 10, "last_activity_date": 1435000940, "creation_date": 1434990184, "last_edit_date": 1435000940, "question_id": 30985070, "link": "https://stackoverflow.com/questions/30985070/how-can-i-express-foldr-in-terms-of-foldmap-for-type-aligned-sequences", "title": "How can I express foldr in terms of foldMap for type-aligned sequences?", "body": "<p>I'm playing around with <a href=\"https://hackage.haskell.org/package/type-aligned-0.9.6/docs/Data-TASequence.html\">type-aligned sequences</a>, and in particular I'm messing around with the idea of folding them. A foldable type-aligned sequence looks something like this:</p>\n\n<pre><code>class FoldableTA fm where\n  foldMapTA :: Category h =&gt;\n                (forall b c . a b c -&gt; h b c) -&gt;\n                fm a b d -&gt; h b d\n  foldrTA :: (forall b c d . a c d -&gt; h b c -&gt; h b d) -&gt;\n             h p q -&gt; fm a q r -&gt; h p r\n  foldlTA :: ...\n</code></pre>\n\n<p>It's pretty easy to implement <code>foldrTA</code> in terms of <code>foldMapTA</code> by first using <code>foldMapTA</code> to convert the sequence to a type-aligned list in the naive way (i.e., using the type-aligned list category) and then folding over that list. Unfortunately, this can be quite inefficient because long lists may be prepended to short ones. I've been trying to figure out a way to use a trick similar to the one used in <code>Data.Foldable</code> to define the right and left folds more efficiently, but the types are making me dizzy. <code>Endo</code> does not seem general enough to do the trick, and every step I take in other directions leads me to more type variables than I can keep track of.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 9436, "user_id": 1984384, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e61d31a5f0fa86bf2f1824f0da4cfa49?s=128&d=identicon&r=PG", "display_name": "Tim Bodeit", "link": "https://stackoverflow.com/users/1984384/tim-bodeit"}, "is_accepted": false, "score": 9, "last_activity_date": 1434989496, "last_edit_date": 1495540277, "creation_date": 1434987173, "answer_id": 30984054, "question_id": 30983814, "link": "https://stackoverflow.com/questions/30983814/why-does-the-haskell-show-function-give-me-trouble-here/30984054#30984054", "title": "Why does the Haskell `show ` function give me trouble here?", "body": "<p>You will need to put parentheses around your error message in line 5.</p>\n\n<p>Currently your implementation is equal to this one:</p>\n\n<pre><code>(error \"The array contains fewer than \") ++ show k ++  \"elements\"\n</code></pre>\n\n<p>While you most likely wanted it to do this:</p>\n\n<pre><code>error (\"The array contains fewer than \" ++ show k ++  \"elements\")\n</code></pre>\n\n<p>You can also use the <a href=\"https://stackoverflow.com/questions/940382/haskell-difference-between-dot-and-dollar-sign\">($)</a> syntax like so:</p>\n\n<pre><code>error $ \"The array contains fewer than \" ++ show k ++  \"elements\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "is_accepted": false, "score": 8, "last_activity_date": 1434989139, "last_edit_date": 1434989139, "creation_date": 1434987177, "answer_id": 30984058, "question_id": 30983814, "link": "https://stackoverflow.com/questions/30983814/why-does-the-haskell-show-function-give-me-trouble-here/30984058#30984058", "title": "Why does the Haskell `show ` function give me trouble here?", "body": "<p>According to <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-280003.4\" rel=\"noreferrer\">Haskell Report</a>, <code>f x ++ g y</code> parses as <code>(f x) ++ (g y)</code>. In your case,</p>\n\n<pre><code>error \"The array contains fewer than \" ++ (show k) ++  \"elements\"\n</code></pre>\n\n<p>parses as</p>\n\n<pre><code>(error \"The array contains fewer than \") ++ (show k) ++  \"elements\"\n</code></pre>\n"}], "owner": {"reputation": 12714, "user_id": 505306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TjIHR.png?s=128&g=1", "display_name": "smilingbuddha", "link": "https://stackoverflow.com/users/505306/smilingbuddha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1434989496, "creation_date": 1434986569, "question_id": 30983814, "link": "https://stackoverflow.com/questions/30983814/why-does-the-haskell-show-function-give-me-trouble-here", "title": "Why does the Haskell `show ` function give me trouble here?", "body": "<p>I am just a few days into Haskell and learning it from Learn You a Haskell for a great good. While trying out one of the 99 Haskell problems, I ran into the following error while loading my function into ghci. </p>\n\n<p>The problem asks to write a function <code>elementAt k x</code> which takes a number k, a list x and extracts the <code>kth</code> element of the list x. </p>\n\n<p>Here is my function</p>\n\n<pre><code>elementAt :: Int -&gt; [a] -&gt; a\nelementAt k x\n  | k &lt; 0            = error \"You have passed a negative index\"\n  | null x           = error \"Cannot extract from an empty list\"\n  | (length  x) &lt; k  = error \"The array contains fewer than \" ++ (show k) ++  \"elements\"\nelementAt 0 (x:_)    = x \nelementAt k (_:xs)   = elementAt (k-1) xs \n</code></pre>\n\n<p>On loading this function into ghci I get the error</p>\n\n<pre><code>   Couldn't match expected type `a' with actual type `[Char]'\n     `a' is a rigid type variable bound by\n         the type signature for elementAt :: Int -&gt; [a] -&gt; a at fun.hs:77:14\n   Relevant bindings include\n     x :: [a] (bound at fun.hs:78:13)\n     elementAt :: Int -&gt; [a] -&gt; a (bound at fun.hs:78:1)\n   In the expression:\n     error \"The array contains fewer than \" ++ (show k) ++ \"elements\"\n   In an equation for `elementAt':\n       elementAt k x\n         | k &lt; 0 = error \"You have passed a negative index\"\n         | null x = error \"Cannot extract from an empty list\"\n         | (length x) &lt; k\n         = error \"The array contains fewer than \" ++ (show k) ++ \"elements\"\n</code></pre>\n\n<p>The trouble seems to lie with the way I have used the <code>show</code> function, but I \ndon't see why. On removing the <code>show</code> call the function seems to compile and \nwork perfectly.</p>\n"}, {"tags": ["haskell", "ghc", "cabal"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1434984239, "post_id": 30982195, "comment_id": 49996020, "body": "What is the cabal version you are using ? Can you do <code>cabal update -v3</code>  and show us the logs ? Can you tell us what is in the file <code>~&#47;.cabal&#47;config</code> ?"}, {"owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1434991903, "post_id": 30982195, "comment_id": 50001149, "body": "Thanks Sibi, I just added the details. Interestingly when I just tried cabal update again there was first an error saying permission denied: <code>.cabal&#47;packages&#47;hackage.haskell.org&#47;00-index.tar31207.tmp: permission denied</code> Then after that I got the same error as before"}], "answers": [{"comments": [{"owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "edited": false, "score": 0, "creation_date": 1434997987, "post_id": 30987051, "comment_id": 50004551, "body": "I tried removing both files, but still got the permission denied error, after which the files were recreated"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "edited": false, "score": 0, "creation_date": 1434999966, "post_id": 30987051, "comment_id": 50005655, "body": "Well, you should fix the permissions on that directory then."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 3, "last_activity_date": 1434997115, "creation_date": 1434997115, "answer_id": 30987051, "question_id": 30982195, "link": "https://stackoverflow.com/questions/30982195/cabal-update-local-and-remote-files-match/30987051#30987051", "title": "cabal update: Local and remote files match", "body": "<p>Perhaps you deleted <code>.cabal/packages/hackage.haskell.org/00-index.tar</code>, but not <code>.cabal/packages/hackage.haskell.org/00-index.tar.gz.etag</code>. I can reproduce the behavior you see by doing that.</p>\n\n<p>Probably cabal should be smarter about handling this situation, but in any case I think that removing <code>.cabal/packages/hackage.haskell.org/00-index.tar.gz.etag</code> will get you unstuck.</p>\n"}], "owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1141, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1435069397, "creation_date": 1434982440, "last_edit_date": 1435001862, "question_id": 30982195, "link": "https://stackoverflow.com/questions/30982195/cabal-update-local-and-remote-files-match", "title": "cabal update: Local and remote files match", "body": "<p>When I try cabal update, I get: </p>\n\n<pre><code>Downloading the latest package list from hackage.haskell.org\nSkipping download: Local and remote files match.\nWarning: The package list for 'hackage.haskell.org' does not exist. Run 'cabal\nupdate' to download it.\n</code></pre>\n\n<p>I have run cabal init</p>\n\n<p>cabal update -v3 log:</p>\n\n<pre><code>Downloading the latest package list from hackage.haskell.org\nSending:\nGET /packages/archive/00-index.tar.gz HTTP/1.1\nHost: hackage.haskell.org\nUser-Agent: cabal-install/1.20.0.3 (linux; x86_64)\nIf-None-Match: \"cb3a8478c33cbfb51929818cc8da736d\"\n\nCreating new connection to hackage.haskell.org\nReceived:\nHTTP/1.1 301 Moved Permanently\nServer: nginx/1.6.2\nContent-Type: text/plain; charset=UTF-8\nLocation: /packages/index.tar.gz\nTransfer-Encoding: chunked\nAccept-Ranges: bytes\nDate: Mon, 22 Jun 2015 16:32:03 GMT\nVia: 1.1 varnish\nAge: 0\nConnection: keep-alive\nX-Served-By: cache-jfk1025-JFK\nX-Cache: MISS\nX-Cache-Hits: 0\nX-Timer: S1434990722.961771,VS0,VE54\nContent-Length: 0\n\n301 - redirect\nRedirecting to http://hackage.haskell.org/packages/index.tar.gz ...\nSending:\nGET /packages/index.tar.gz HTTP/1.1\nHost: hackage.haskell.org\nUser-Agent: cabal-install/1.20.0.3 (linux; x86_64)\nIf-None-Match: \"cb3a8478c33cbfb51929818cc8da736d\"\n\nRecovering connection to hackage.haskell.org\nReceived:\nHTTP/1.1 304 Not Modified\nDate: Mon, 22 Jun 2015 16:32:03 GMT\nVia: 1.1 varnish\nCache-Control: public, no-transform, max-age=300\nETag: \"cb3a8478c33cbfb51929818cc8da736d\"\nAge: 0\nConnection: keep-alive\nX-Served-By: cache-jfk1025-JFK\nX-Cache: HIT\nX-Cache-Hits: 1\nX-Timer: S1434990723.030149,VS0,VE145\n\nSkipping download: Local and remote files match.\nReading available packages...\nWarning: The package list for 'hackage.haskell.org' does not exist. Run \n'cabal update' to download it.\n</code></pre>\n\n<p>My Cabal version is 1.20.0.2</p>\n\n<p>The config file looks like <a href=\"https://gist.github.com/anonymous/fda74fa01d3113e0aeab\" rel=\"nofollow\">https://gist.github.com/anonymous/fda74fa01d3113e0aeab</a></p>\n\n<p>stack overflow is annoyingly denying my edit because there is too much code from the log so I'm adding some junk here to make it pass...</p>\n"}, {"tags": ["haskell", "monads", "threepenny-gui"], "comments": [{"owner": {"reputation": 2627, "user_id": 215924, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/db83b716acfe0f3a1de6faa176d63fca?s=128&d=identicon&r=PG&f=1", "display_name": "Squidly", "link": "https://stackoverflow.com/users/215924/squidly"}, "edited": false, "score": 1, "creation_date": 1434979342, "post_id": 30981044, "comment_id": 49992459, "body": "You can&#39;t change monad half way through a do block"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1434985691, "post_id": 30981044, "comment_id": 49997109, "body": "What do you mean that you want to keep on using the IO type? Would <code>liftIO $ do ... a block of IO code ...</code> be what you&#39;re looking for?"}, {"owner": {"reputation": 12979, "user_id": 126015, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d11472083f0a899276616a936637e67?s=128&d=identicon&r=PG", "display_name": "vondip", "link": "https://stackoverflow.com/users/126015/vondip"}, "edited": false, "score": 0, "creation_date": 1435002722, "post_id": 30981044, "comment_id": 50007180, "body": "Following the conclusions from this thread, I&#39;ve opened a new question of how to integrate print. any help would be greatly appreciated - <a href=\"http://stackoverflow.com/questions/30988595/haskell-ui-do-clause-how-to-print\" title=\"haskell ui do clause how to print\">stackoverflow.com/questions/30988595/&hellip;</a>"}, {"owner": {"reputation": 704, "user_id": 962242, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9d9a6af953fc82d6eda347af3296f4a3?s=128&d=identicon&r=PG", "display_name": "DBS", "link": "https://stackoverflow.com/users/962242/dbs"}, "edited": false, "score": 0, "creation_date": 1534604534, "post_id": 30981044, "comment_id": 90769911, "body": "@vondip would you able to say how you used liftIO to convert to UI monad? I have a similar problem: <a href=\"https://stackoverflow.com/questions/51906879/monad-and-monadio-for-custom-type\" title=\"monad and monadio for custom type\">stackoverflow.com/questions/51906879/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 12979, "user_id": 126015, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d11472083f0a899276616a936637e67?s=128&d=identicon&r=PG", "display_name": "vondip", "link": "https://stackoverflow.com/users/126015/vondip"}, "edited": false, "score": 0, "creation_date": 1434980362, "post_id": 30981247, "comment_id": 49993194, "body": "In my case I&#39;m trying to use some random int list and then display it to screen, it&#39;s not clear how to separate the io action to be executed at a later stage then"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1435022608, "post_id": 30981247, "comment_id": 50014245, "body": "<code>UI</code>is an instance of <code>MonadIO</code>, so <code>liftIO</code> is enough to to handle the OP&#39;s issue (cf. <a href=\"http://stackoverflow.com/a/30988739/2751851\">the answer to the follow-up question</a>). <code>liftIOLater</code> is only meant to be used in a handful of trickier cases (e.g. actions that should be ran during GUI initialisation only after the rest of the GUI has been set up)."}], "tags": [], "owner": {"reputation": 245145, "user_id": 1348195, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6dca2295546af21e1cde8e68f2d49bd?s=128&d=identicon&r=PG", "display_name": "Benjamin Gruenbaum", "link": "https://stackoverflow.com/users/1348195/benjamin-gruenbaum"}, "is_accepted": true, "score": 8, "last_activity_date": 1434979778, "last_edit_date": 1592644375, "creation_date": 1434979778, "answer_id": 30981247, "question_id": 30981044, "link": "https://stackoverflow.com/questions/30981044/haskell-do-clause-with-multiple-monad-types/30981247#30981247", "title": "Haskell do clause with multiple monad types", "body": "<p>A <code>do</code> block is for a specific type of monad, you can't just change the type in the middle.</p>\n<p>You can either transform the action or you can nest it inside the <code>do</code>. Most times transformations will be ready for you. You can, for instance have a nested <code>do</code> that works with <code>io</code> and then convert it only at the point of interaction.</p>\n<p>In your case, a <code>liftIOLater</code> function is offered to handle this for you by the ThreePennyUI package.</p>\n<blockquote>\n<p><code>liftIOLater :: IO () -&gt; UI ()</code></p>\n<p>Schedule an IO action to be run later.</p>\n</blockquote>\n<p>In order to perform the converse conversion, you can use <code>runUI</code>:</p>\n<blockquote>\n<p><code>runUI :: Window -&gt; UI a -&gt; IO a</code></p>\n<p>Execute an UI action in a particular browser window. Also runs all scheduled IO action.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "is_accepted": false, "score": 2, "last_activity_date": 1434994337, "last_edit_date": 1434994337, "creation_date": 1434993313, "answer_id": 30985981, "question_id": 30981044, "link": "https://stackoverflow.com/questions/30981044/haskell-do-clause-with-multiple-monad-types/30985981#30985981", "title": "Haskell do clause with multiple monad types", "body": "<p>Under the cover, do is simply syntactic sugar for >>= (bind) and let: </p>\n\n<pre><code>do { x&lt;-e; es } =   e &gt;&gt;= \\x -&gt; do { es }\ndo { e; es }    =   e &gt;&gt; do { es }\ndo { e }        =   e\ndo {let ds; es} =   let ds in do {es} \n</code></pre>\n\n<p>And the type of bind: </p>\n\n<pre><code>(&gt;&gt;=) :: Monad m =&gt; a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>So yeah it only \"supports\" one Monad</p>\n"}, {"tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 5, "last_activity_date": 1434996942, "creation_date": 1434996942, "answer_id": 30987004, "question_id": 30981044, "link": "https://stackoverflow.com/questions/30981044/haskell-do-clause-with-multiple-monad-types/30987004#30987004", "title": "Haskell do clause with multiple monad types", "body": "<p>This is more an extended comment - it doesn't address the main question, but your implementation of <code>shufffle</code>. There are 2 issues with it:</p>\n\n<ol>\n<li>Your implementation is inefficient - <em>O(n^2)</em>.</li>\n<li><code>IO</code> isn't the right type for it - shuffle has no general side effects, it just needs a source of randomness.</li>\n</ol>\n\n<p>For (1) there are several solutions: One is to use <code>Seq</code> and its <a href=\"http://hackage.haskell.org/package/containers-0.5.6.3/docs/Data-Sequence.html#v:index\" rel=\"noreferrer\"><code>index</code></a>, which is <em>O(log n)</em>, which would make <code>shuffle</code> <em>O(n log n)</em>. Or you could use <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Control-Monad-ST.html\" rel=\"noreferrer\"><code>ST</code></a> <a href=\"http://hackage.haskell.org/package/array-0.5.1.0/docs/Data-Array-ST.html\" rel=\"noreferrer\">arrays</a> and one of the <a href=\"https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle\" rel=\"noreferrer\">standard algorithms</a> to get <em>O(n)</em>.</p>\n\n<p>For (2), all you need is threading a random generator, not full power of <code>IO</code>. There is already nice library <a href=\"https://hackage.haskell.org/package/MonadRandom-0.1.5/docs/Control-Monad-Random.html\" rel=\"noreferrer\">MonadRandom</a> that defines a monad (and a type-class) for randomized computations. And another package already provides the <a href=\"https://hackage.haskell.org/package/random-extras-0.3/docs/Control-Monad-Random-Extras.html#v:shuffle\" rel=\"noreferrer\"><code>shuffle</code> function</a>. Since <code>IO</code> is an instance of <code>MonadRandom</code>, you can just use <code>shuffle</code> directly as a replacement for your function.</p>\n"}], "owner": {"reputation": 12979, "user_id": 126015, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d11472083f0a899276616a936637e67?s=128&d=identicon&r=PG", "display_name": "vondip", "link": "https://stackoverflow.com/users/126015/vondip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 785, "favorite_count": 2, "accepted_answer_id": 30981247, "answer_count": 3, "score": 8, "last_activity_date": 1441549055, "creation_date": 1434979218, "last_edit_date": 1441549055, "question_id": 30981044, "link": "https://stackoverflow.com/questions/30981044/haskell-do-clause-with-multiple-monad-types", "title": "Haskell do clause with multiple monad types", "body": "<p>I'm using a graphic library in Haskell called <a href=\"http://hackage.haskell.org/package/threepenny-gui\" rel=\"nofollow\">Threepenny-GUI</a>. In this library the main function returns a <a href=\"http://hackage.haskell.org/package/threepenny-gui-0.6.0.3/docs/Graphics-UI-Threepenny-Core.html#t:UI\" rel=\"nofollow\"><code>UI</code></a> monad object. This causes me much headache as when I attempt to unpack <code>IO</code> values into local variables I receive errors complaining of different monad types.</p>\n\n<p>Here's an example of my problem. This is a slightly modified version of the standard main function, as given by Threepenny-GUI's code example:</p>\n\n<pre><code>main :: IO ()\nmain = startGUI defaultConfig setup\n\nsetup :: Window -&gt; UI ()\nsetup w = do\n\nlabelsAndValues &lt;- shuffle [1..10]\n\nshuffle :: [Int] -&gt; IO [Int]\nshuffle [] = return []\nshuffle xs = do randomPosition &lt;- getStdRandom (randomR (0, length xs - 1))\n                let (left, (a:right)) = splitAt randomPosition xs\n                fmap (a:) (shuffle (left ++ right))\n</code></pre>\n\n<p>Please notice the fifth line:</p>\n\n<pre><code>labelsAndValues &lt;- shuffle [1..10]\n</code></pre>\n\n<p>Which returns the following error:</p>\n\n<pre><code>Couldn't match type \u2018IO\u2019 with \u2018UI\u2019\nExpected type: UI [Int]\n  Actual type: IO [Int]\nIn a stmt of a 'do' block: labelsAndValues &lt;- shuffle [1 .. 10]\n</code></pre>\n\n<p>As to my question, how do I unpack the <code>IO</code> function using the standard arrow notation (<code>&lt;-</code>), and keep on having these variables as <code>IO ()</code> rather than <code>UI ()</code>, so I can easily pass them on to other functions. </p>\n\n<p>Currently, the only solution I found was to use <a href=\"http://hackage.haskell.org/package/transformers-0.4.3.0/docs/Control-Monad-IO-Class.html#v:liftIO\" rel=\"nofollow\"><code>liftIO</code></a>, but this causes conversion to the <code>UI</code> monad type, while I actually want to keep on using the <code>IO</code> type. </p>\n"}, {"tags": ["haskell", "typeclass"], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1434979381, "creation_date": 1434979381, "answer_id": 30981102, "question_id": 30980788, "link": "https://stackoverflow.com/questions/30980788/typeclass-instances-for-another-typeclass-in-haskell/30981102#30981102", "title": "Typeclass instances for another typeclass in haskell", "body": "<p>There is the super-primitive way</p>\n\n<pre><code>{-# LANGUAGE CPP #-}\n\n#define GREETABLE_NUM(n)\\\ninstance Greetable(n) where { hi s = \"Hi number! \" ++ show s }\n\nGREETABLE_NUM(Int)\nGREETABLE_NUM(Double)\n...\n</code></pre>\n\n<p>Essentially the same can be done nicer with Template Haskell, but AFAIK you'll need two modules (one for defining the macro and one for using it), which is probably overkill here.</p>\n\n<p>A perhaps more sensible solution is to simply write</p>\n\n<pre><code>numberHi :: Show n =&gt; n -&gt; String\nnumberHi s = \"Hi number! \" ++ show s\n\ninstance Greetable Int where hi = numberHi\ninstance Greetable Double where hi = numberHi\n...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 1, "last_activity_date": 1434979997, "creation_date": 1434979997, "answer_id": 30981316, "question_id": 30980788, "link": "https://stackoverflow.com/questions/30980788/typeclass-instances-for-another-typeclass-in-haskell/30981316#30981316", "title": "Typeclass instances for another typeclass in haskell", "body": "<p>One another way would be this:</p>\n\n<pre><code>{-#LANGUAGE ScopedTypeVariables#-}\n\nimport Data.Typeable\n\nhi :: (Show a, Typeable a) =&gt; a -&gt; String\nhi x \n  | typeOf x == typeOf (3 :: Int) = \"Hi number!\" ++ show x\n  | typeOf x == typeOf (3.4 :: Double) = \"Hi number!\" ++ show x\n  | typeOf x == typeOf (\"abc\" :: String) = \"Hi string!\" ++ show x\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "edited": false, "score": 0, "creation_date": 1434990975, "post_id": 30984456, "comment_id": 50000578, "body": "This is pretty nice but the point is to also account for future instances of <code>Num</code> Eg we want to greet as number <code>instance Num Matrix ....</code> if it also is an instance of <code>Show</code>."}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": false, "score": 3, "last_activity_date": 1434988393, "creation_date": 1434988393, "answer_id": 30984456, "question_id": 30980788, "link": "https://stackoverflow.com/questions/30980788/typeclass-instances-for-another-typeclass-in-haskell/30984456#30984456", "title": "Typeclass instances for another typeclass in haskell", "body": "<p>This is a good use case for <a href=\"https://downloads.haskell.org/~ghc/7.6.3/docs/html/users_guide/type-class-extensions.html#class-default-signatures\" rel=\"nofollow\">default method signatures</a>.</p>\n\n<pre><code>{-# LANGUAGE DefaultSignatures #-}\n\nclass Greetable g where\n  hi :: g -&gt; String\n  default hi :: Show g =&gt; g -&gt; String \n  hi s = \"Hi number! \" ++ show s \n\ninstance Greetable Float \ninstance Greetable Int \ninstance Greetable Double \ninstance Greetable String where hi s = \"Hi string! \" ++ s\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "is_accepted": false, "score": 1, "last_activity_date": 1435047565, "creation_date": 1435047565, "answer_id": 30997448, "question_id": 30980788, "link": "https://stackoverflow.com/questions/30980788/typeclass-instances-for-another-typeclass-in-haskell/30997448#30997448", "title": "Typeclass instances for another typeclass in haskell", "body": "<p>So all the other answers answers are pretty good and this is not \"proper\" Haskell with the pragmas and all but it actually does exactly what I need:</p>\n\n<pre><code>{-# LANGUAGE UndecidableInstances, FlexibleInstances #-}\n\nclass Greetable g where\n  hi :: g -&gt; String\n\n-- Here i should list all instances of Num\ninstance {-# OVERLAPS #-} (Show n, Num n) =&gt; Greetable n where\n  hi s = \"Hi number! \" ++ show s\n\n\n-- Here is other stuff\ninstance {-# OVERLAPPABLE #-} Greetable String where\n  hi s = \"Hi string! \" ++ s\n</code></pre>\n\n<p>Then in ghci:</p>\n\n<pre><code>\u03bb&gt; hi 1\n\"Hi number! 1\"\n\u03bb&gt; hi \"hello\"\n\"Hi string! hello\"\n\u03bb&gt; hi (1::Float)\n\"Hi number! 1.0\"\n</code></pre>\n\n<p>For further reading see <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/type-class-extensions.html#instance-overlap\" rel=\"nofollow\">overlapping instances</a></p>\n"}], "owner": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1435047565, "creation_date": 1434978418, "last_edit_date": 1435046442, "question_id": 30980788, "link": "https://stackoverflow.com/questions/30980788/typeclass-instances-for-another-typeclass-in-haskell", "title": "Typeclass instances for another typeclass in haskell", "body": "<p>Is there a more concise way to write the following haskell code:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n\nclass Greetable g where\n  hi :: g -&gt; String\n\n-- Here i should list all instances of Num\ninstance Greetable Float where\n  hi s = \"Hi number! \" ++ show s\ninstance Greetable Int where\n  hi s = \"Hi number! \" ++ show s\ninstance Greetable Double where\n  hi s = \"Hi number! \" ++ show s\n-- Etc.\n\n\n-- Here is other stuff\ninstance Greetable String where\n  hi s = \"Hi string! \" ++ s\n</code></pre>\n\n<p>EDIT: I would like the <code>hi</code> function to be able to account for any future instances of the class <code>Num</code>.</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1434977918, "post_id": 30980391, "comment_id": 49991496, "body": "I don&#39;t have any errors with GHC 7.8 and 7.10."}], "answers": [{"tags": [], "owner": {"reputation": 640, "user_id": 949024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d81f9bcedb04a5e043fc9edd218ad83?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/949024/alex"}, "is_accepted": false, "score": 2, "last_activity_date": 1434978123, "creation_date": 1434978123, "answer_id": 30980687, "question_id": 30980391, "link": "https://stackoverflow.com/questions/30980391/how-to-use-ghc-multiparamtypeclass/30980687#30980687", "title": "How to use GHC MultiParamTypeClass", "body": "<p>The code is ambiguous. Specifically we don't know the type of <code>(10.0,10.0)</code>. For example it could be <code>(Double,Double)</code>. It's most general type is <code>(Fractional a,Fractional b) =&gt; (a,b)</code>.</p>\n\n<p>The solution to this is to write</p>\n\n<pre><code>box  ((10.0,10.0) :: Pos) ((100.0,100.0)::Pos)\n</code></pre>\n\n<p>instead and fix the other lines similarly. </p>\n"}, {"comments": [{"owner": {"reputation": 731, "user_id": 7284, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ef479d84dfce074b7681de39aad5f6e?s=128&d=identicon&r=PG", "display_name": "mbrodersen", "link": "https://stackoverflow.com/users/7284/mbrodersen"}, "edited": false, "score": 0, "creation_date": 1435326368, "post_id": 30984939, "comment_id": 50168214, "body": "Using a function dependency is an excellent solution. Thanks!"}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 2, "last_activity_date": 1434989809, "creation_date": 1434989809, "answer_id": 30984939, "question_id": 30980391, "link": "https://stackoverflow.com/questions/30980391/how-to-use-ghc-multiparamtypeclass/30984939#30984939", "title": "How to use GHC MultiParamTypeClass", "body": "<p>This class definition won't work, because the type of <code>clear</code> doesn't mention the type variable <code>p</code>, so it is impossible to instantiate <code>clear</code> with a concrete type. Adding type signatures to <code>box</code> or <code>line</code> won't help - even <code>clear :: IO ()</code> will produce a type error. </p>\n\n<p>This could be fixed by adding a function dependency to your class:</p>\n\n<pre><code>class Monad m =&gt; DrawEnv p m | m -&gt; p where\n</code></pre>\n\n<p>Then the rest of your code compiles. Alternatively, you could split your class into two classes:</p>\n\n<pre><code>class Monad m =&gt; MonadDraw m where \n  putStringLn :: String -&gt; m () \n\n  clear   :: m ()\n  clear = putStringLn \"Clear\"\n\nclass DrawEnv p where\n  box     :: MonadDraw m =&gt; p -&gt; p -&gt; m ()\n  line    :: MonadDraw m =&gt; p -&gt; p -&gt; m ()\n\ninstance (Fractional a, Show a, Fractional b, Show b) =&gt; DrawEnv (a,b) where\n    box     p0 p1   = putStringLn $ \"Box \" ++ show p0 ++ \" \" ++ show p1\n    line    p0 p1   = putStringLn $ \"Line \" ++ show p0 ++ \" \" ++ show p1\n\ndraw :: MonadDraw m =&gt; m () \ndraw = do\n    clear\n    box  (10.0,10.0) (100.0,100.0)\n    line (10.0,10.0) (100.0,50.0)\n</code></pre>\n"}], "owner": {"reputation": 731, "user_id": 7284, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ef479d84dfce074b7681de39aad5f6e?s=128&d=identicon&r=PG", "display_name": "mbrodersen", "link": "https://stackoverflow.com/users/7284/mbrodersen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 30984939, "answer_count": 2, "score": 0, "last_activity_date": 1434989809, "creation_date": 1434977251, "question_id": 30980391, "link": "https://stackoverflow.com/questions/30980391/how-to-use-ghc-multiparamtypeclass", "title": "How to use GHC MultiParamTypeClass", "body": "<p>I am trying to implement a \"DrawEnv\" type class indexed by a point type:</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE TypeSynonymInstances #-}\n\nclass Monad m =&gt; DrawEnv p m where\n    box     :: p -&gt; p -&gt; m ()\n    clear   :: m ()\n    line    :: p -&gt; p -&gt; m ()\n\ntype Pos = (Float,Float)\n\ninstance DrawEnv Pos IO where\n    box     p0 p1   = putStrLn $ \"Box \" ++ show p0 ++ \" \" ++ show p1\n    clear           = putStrLn \"Clear\"\n    line    p0 p1   = putStrLn $ \"Line \" ++ show p0 ++ \" \" ++ show p1\n\ndraw :: DrawEnv Pos m =&gt; m ()\ndraw = do\n    clear\n    box  (10.0,10.0) (100.0,100.0)\n    line (10.0,10.0) (100.0,50.0)\n</code></pre>\n\n<p>However GHC isn't happy:</p>\n\n<pre><code>Could not deduce (DrawEnv (t0, t1) m) arising from a use of `box'\nfrom the context (DrawEnv Pos m)\n  bound by the type signature for draw :: DrawEnv Pos m =&gt; m ()\n  at Code/Interfaces3.hs:63:9-29\nThe type variables `t0', `t1' are ambiguous\nRelevant bindings include\n  draw :: m () (bound at Code/Interfaces3.hs:64:1)\nNote: there is a potential instance available:\n  instance DrawEnv Pos IO -- Defined at Code/Interfaces3.hs:56:10\nIn a stmt of a 'do' block: box (10.0, 10.0) (100.0, 100.0)\nIn the expression:\n  do { clear;\n       box (10.0, 10.0) (100.0, 100.0);\n       line (10.0, 10.0) (100.0, 50.0) }\nIn an equation for `draw':\n    draw\n      = do { clear;\n             box (10.0, 10.0) (100.0, 100.0);\n             line (10.0, 10.0) (100.0, 50.0) }\n</code></pre>\n\n<p>My question is why GHC doesn't accept this given the Pos constraint?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1434951322, "post_id": 30972672, "comment_id": 49976703, "body": "Some mention should be made of the standard higher-kinded approach and perhaps also the MPTC one."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1434951414, "post_id": 30972672, "comment_id": 49976728, "body": "sure - never thought that this should be the default or the only answer ;) - it&#39;s just the one that came to mind first (and is reasonable nice IMO) - if you want I can add something - or you can add your own answer ;)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1434951752, "post_id": 30972672, "comment_id": 49976814, "body": "I think the fact that the higher kinded once is standard Haskell makes it notable, although the other approaches are also solid."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1434951834, "post_id": 30972672, "comment_id": 49976840, "body": "You almost surely want fundeps for the mptc. Bedtime for me though!"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1434951911, "post_id": 30972672, "comment_id": 49976869, "body": "@dfeuer - you posted this just as I was editing the answer ;) (it just took me some time to check the syntax and lookup the link)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1434953025, "post_id": 30972672, "comment_id": 49977242, "body": "@Alec I really did not wish for you do remove your answer! If I had seen that you got this already I would not have included it (I only saw the second answer a few minutes ago)- please consider undeleting yours - I will upvote it as soon as you added those constraints and if you like I will delete the parts mentioning MPTC from mine"}, {"owner": {"reputation": 669, "user_id": 3714434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a65866e8ef0ee97ab4cd4c4ffaadc6?s=128&d=identicon&r=PG&f=1", "display_name": "ibotty", "link": "https://stackoverflow.com/users/3714434/ibotty"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1434958319, "post_id": 30972672, "comment_id": 49979707, "body": "hi @dfeuer, what&#39;s the standard higher-kinded approach? <code>Map</code> and <code>[]</code> have a different kind and I can&#39;t think about an approach using <code>Map k</code> and <code>[]</code> right now that somehow brings the <code>k</code> into scope (without being beyond <code>Haskell2010</code>)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 669, "user_id": 3714434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a65866e8ef0ee97ab4cd4c4ffaadc6?s=128&d=identicon&r=PG&f=1", "display_name": "ibotty", "link": "https://stackoverflow.com/users/3714434/ibotty"}, "edited": false, "score": 0, "creation_date": 1434986724, "post_id": 30972672, "comment_id": 49997859, "body": "@ibotty, I think you&#39;d have to flip <code>Map</code> with a newtype to get the key type on the other side. It&#39;s not as nice as the type family approach."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 9, "last_activity_date": 1434951877, "last_edit_date": 1434951877, "creation_date": 1434951193, "answer_id": 30972672, "question_id": 30972580, "link": "https://stackoverflow.com/questions/30972580/haskell-when-declaring-a-class-how-can-i-use-a-type-variable-that-is-not-immed/30972672#30972672", "title": "Haskell: When declaring a class, how can I use a type variable that is not immediately in the constructors?", "body": "<h2>using <code>TypeFamilies</code></h2>\n\n<p>The problem is that you somehow have to connect <code>b</code> with your collection (the elements in it) - there are several ways to do this but I think a rather nice one is using <a href=\"https://wiki.haskell.org/GHC/Type_families\" rel=\"noreferrer\">TypeFamilies</a>:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n\nmodule Test where\n\nimport qualified Data.Map as Map\nimport qualified Data.Set as Set\n\nclass Memberable a where\n  type ElemT a :: *\n  (&lt;-?) :: (ElemT a) -&gt; a -&gt; Bool\n\ninstance Eq x =&gt; Memberable [x] where\n    type ElemT [x] = x\n    (&lt;-?) = elem\n\ninstance Ord k =&gt; Memberable (Map.Map k v) where\n    type ElemT (Map.Map k v) = k\n    (&lt;-?) = Map.member\n\ninstance Ord x =&gt; Memberable (Set.Set x) where\n    type ElemT (Set.Set x) = x\n    (&lt;-?) = Set.member\n</code></pre>\n\n<p>As you can see I added an additional <code>type</code> <em>member</em> to class that will hold the type of the elements used (so you can use them for your <code>(&lt;-?)</code> in the very next line).</p>\n\n<p>I also added the needed constraints for your instances - those do really come from the used functions like <code>elem</code>, <code>Map.member</code> and <code>Set.member</code>.</p>\n\n<hr>\n\n<h2>using <code>MultiParamTypeClasses</code></h2>\n\n<p>here is the one @dfeuer was hinting at (or so I think):</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FlexibleInstances #-}\n\nmodule Test where\n\nimport qualified Data.Map as Map\nimport qualified Data.Set as Set\n\nclass Memberable e a where\n  (&lt;-?) :: e -&gt; a -&gt; Bool\n\ninstance Eq x =&gt; Memberable x [x] where\n    (&lt;-?) = elem\n\ninstance Ord k =&gt; Memberable k (Map.Map k v) where\n    (&lt;-?) = Map.member\n\ninstance Ord x =&gt; Memberable x (Set.Set x) where\n    (&lt;-?) = Set.member\n</code></pre>\n\n<h3>remark:</h3>\n\n<p>I think with this approach you might want to add this <a href=\"https://wiki.haskell.org/Functional_dependencies\" rel=\"noreferrer\"><code>FunctionalDependency</code></a> too, as you clearly have such a dependency between the collection <code>a</code> and it's elements <code>e</code> here ;)</p>\n\n<pre><code>{-# LANGUAGE FunctionalDependencies #-}\n\nclass Memberable e a | a -&gt; e where\n  (&lt;-?) :: e -&gt; a -&gt; Bool\n</code></pre>\n"}], "owner": {"reputation": 1332, "user_id": 3262785, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XqvLk.jpg?s=128&g=1", "display_name": "sqd", "link": "https://stackoverflow.com/users/3262785/sqd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 30972672, "answer_count": 1, "score": 1, "last_activity_date": 1434951877, "creation_date": 1434950626, "question_id": 30972580, "link": "https://stackoverflow.com/questions/30972580/haskell-when-declaring-a-class-how-can-i-use-a-type-variable-that-is-not-immed", "title": "Haskell: When declaring a class, how can I use a type variable that is not immediately in the constructors?", "body": "<p>I want to define a function, <code>&lt;-?</code> to check whether an element is in a list/set/map.</p>\n\n<pre><code>module Test where\nimport qualified Data.Map as Map\nimport qualified Data.Set as Set\n\nclass Memberable a where\n    (&lt;-?) :: b -&gt; a -&gt; Bool\ninstance Memberable [x] where\n    (&lt;-?) = elem\ninstance Memberable (Map.Map k v) where\n    (&lt;-?) = Map.member\ninstance Memberable (Set.Set x) where\n    (&lt;-?) = Set.member\n</code></pre>\n\n<p>The type variable <code>b</code> in the class declaration should be the type of element I want to check. However, this doesn't work for Haskell.</p>\n\n<pre><code>Test.hs:8:13:\n    Couldn't match type 'b' with 'x'\n      'b' is a rigid type variable bound by\n          the type signature for (&lt;-?) :: b -&gt; [x] -&gt; Bool at Test.hs:8:5\n      'x' is a rigid type variable bound by\n          the instance declaration at Test.hs:7:10\n    Expected type: b -&gt; [x] -&gt; Bool\n      Actual type: b -&gt; [b] -&gt; Bool\n    Relevant bindings include\n      (&lt;-?) :: b -&gt; [x] -&gt; Bool (bound at Test.hs:8:5)\n    In the expression: elem\n    In an equation for '&lt;-?': (&lt;-?) = elem\n</code></pre>\n\n<p>How can I use <code>b</code> in the class declaration, but still make the types coincider?</p>\n"}, {"tags": ["haskell", "hash", "sha1"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1434938069, "post_id": 30970777, "comment_id": 49973682, "body": "To save us some time figuring out your code, what is the <code>main</code> function you used to test &quot;cat&quot;?"}, {"owner": {"reputation": 542, "user_id": 1956587, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e92d52f1c16bcf435ef24f7a474fde04?s=128&d=identicon&r=PG", "display_name": "tolUene", "link": "https://stackoverflow.com/users/1956587/toluene"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1434938353, "post_id": 30970777, "comment_id": 49973725, "body": "@Alec <code>shower $ process $ toBytes &quot;cat&quot;</code>"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1434939402, "post_id": 30970777, "comment_id": 49973941, "body": "Writing tests for those functions which contain a lot of logic might help you figure it out."}], "answers": [{"comments": [{"owner": {"reputation": 542, "user_id": 1956587, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e92d52f1c16bcf435ef24f7a474fde04?s=128&d=identicon&r=PG", "display_name": "tolUene", "link": "https://stackoverflow.com/users/1956587/toluene"}, "edited": false, "score": 0, "creation_date": 1434992590, "post_id": 30971426, "comment_id": 50001553, "body": "Thank you for your answer. I fixed the things you said and a few other things I noticed, and got it working correctly up until (including) the extend step, i.e. before the actual hash function happens but I really am still stuck. My code is here: <a href=\"http://lpaste.net/4913292567711318016\" rel=\"nofollow noreferrer\">lpaste.net/4913292567711318016</a>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 542, "user_id": 1956587, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e92d52f1c16bcf435ef24f7a474fde04?s=128&d=identicon&r=PG", "display_name": "tolUene", "link": "https://stackoverflow.com/users/1956587/toluene"}, "edited": false, "score": 0, "creation_date": 1435016366, "post_id": 30971426, "comment_id": 50012818, "body": "I don&#39;t have time right now to look at this new version, but the <code>hash</code> function is wrong (bad name seeing as that is the inner, compression, function of the SHA-1 hash).  Dropping in a version of <code>hash</code> from another SHA1 implementation results in proper functionality at least for the empty string.  You caught the &#39;c/d&#39; naming and &#39;shift/rotate&#39; issues I had seen earlier."}, {"owner": {"reputation": 542, "user_id": 1956587, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e92d52f1c16bcf435ef24f7a474fde04?s=128&d=identicon&r=PG", "display_name": "tolUene", "link": "https://stackoverflow.com/users/1956587/toluene"}, "edited": false, "score": 0, "creation_date": 1435258834, "post_id": 30971426, "comment_id": 50138240, "body": "I thought that name was appropriate since it is the function that did the actual hashing. I edited the original post with code I updated even more, but I really am still stuck"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 542, "user_id": 1956587, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e92d52f1c16bcf435ef24f7a474fde04?s=128&d=identicon&r=PG", "display_name": "tolUene", "link": "https://stackoverflow.com/users/1956587/toluene"}, "edited": false, "score": 0, "creation_date": 1435262993, "post_id": 30971426, "comment_id": 50140390, "body": "<code>(b .&amp;. c) .|. (complement b .&amp;. c) != (b .&amp;. c) .|. (complement b .&amp;. d)</code>"}, {"owner": {"reputation": 542, "user_id": 1956587, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e92d52f1c16bcf435ef24f7a474fde04?s=128&d=identicon&r=PG", "display_name": "tolUene", "link": "https://stackoverflow.com/users/1956587/toluene"}, "edited": false, "score": 0, "creation_date": 1435263287, "post_id": 30971426, "comment_id": 50140526, "body": "Thank you so much. I can&#39;t believe I didn&#39;t catch that."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 6, "last_activity_date": 1434990668, "last_edit_date": 1434990668, "creation_date": 1434940619, "answer_id": 30971426, "question_id": 30970777, "link": "https://stackoverflow.com/questions/30970777/sha-1-in-haskell-producing-wrong-hashes/30971426#30971426", "title": "SHA-1 in haskell producing wrong hashes", "body": "<p>Oh, another one of these!</p>\n\n<p>Two errors jump out at me immediately:</p>\n\n<pre><code>pad :: B.ByteString -&gt; B.ByteString\npad xs = B.append (add0 $ add1 xs) length64\n  where length64 = encode (fromIntegral (B.length xs) :: Word64)\n</code></pre>\n\n<p>Notice the length you append is supposed to be the bit length, not the byte length.</p>\n\n<pre><code>add1 :: B.ByteString -&gt; B.ByteString\nadd1 = flip B.append (B.singleton 255)\n</code></pre>\n\n<p>Notice <code>255 /= 0b10000000</code> and the pad is supposed to be the later.</p>\n\n<p>In general you debug these by 1) going over the spec again and again. 2) Comparing to another implementation, such as Adam Wick's SHA package, and comparing for equality at as fine grained level as possible.</p>\n\n<p>EDIT: There are two more bugs, basically transcription errors.  Look around a bit and shout if you're still stuck.</p>\n"}], "owner": {"reputation": 542, "user_id": 1956587, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e92d52f1c16bcf435ef24f7a474fde04?s=128&d=identicon&r=PG", "display_name": "tolUene", "link": "https://stackoverflow.com/users/1956587/toluene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 1, "accepted_answer_id": 30971426, "answer_count": 1, "score": 1, "last_activity_date": 1435185519, "creation_date": 1434933819, "last_edit_date": 1435185519, "question_id": 30970777, "link": "https://stackoverflow.com/questions/30970777/sha-1-in-haskell-producing-wrong-hashes", "title": "SHA-1 in haskell producing wrong hashes", "body": "<p>I wrote a program to perform SHA-1 in haskell, and while it does produce hashes, they do not match with the ones produced by other SHA-1 programs</p>\n\n<p>Example: <code>cat</code>\nhashes to: <code>b5be86bc8bccfc24b01b093228ebb96fc92fa804</code> but is supposed to hash to <code>9d989e8d27dc9e0ec3389fc855f142c3d40f0c50</code></p>\n\n<p>My code is:</p>\n\n<pre><code>(old code omitted)\n</code></pre>\n\n<p>I have no idea what is wrong. Can someone tell me where I made a mistake?</p>\n\n<p><strong>Edit:</strong>\nI fixed the stuff that was pointed out, however it is still not working. It works correctly up until the inner loop. \nI cleaned up the code so the functions for the inner loop are available as <code>f1</code>, <code>f2</code> and <code>f3</code>\n<code>cat</code> now interestingly hashes to <code>ebe6c9fa1afa0ef5a0ca80bab251fd41cc29127e</code>.</p>\n\n<p>Code:</p>\n\n<pre><code>import Data.Word\nimport Data.Bits\nimport Data.Char (ord, intToDigit)\nimport Data.Binary (encode, decode)\nimport Numeric (showHex, showIntAtBase)\nimport System.IO (stdin)\nimport Data.Sequence ((&lt;|), (|&gt;))\nimport qualified Data.Sequence as S\nimport qualified Data.ByteString.Lazy as B\ntype Quintuple32 = (Word32, Word32, Word32, Word32, Word32)\n\naddQuintuple (a, b, c, d, e) (f, g, h, i, j) =\n    (a + f, b + g, c + h, d + i, e + j)\n\nshower :: Quintuple32 -&gt; String\nshower (a, b, c, d, e) = concatMap (`showHex` \"\") [a, b, c, d, e]\n\nhash :: Int -&gt; S.Seq Word32 -&gt; Quintuple32 -&gt; Quintuple32\nhash i w h@(a, b, c, d, e)\n    | i &lt; 20 = hash (i + 1) w (newhash (f1 h + k1))\n    | i &lt; 40 = hash (i + 1) w (newhash (f2 h + k2))\n    | i &lt; 60 = hash (i + 1) w (newhash (f3 h + k3))\n    | i &lt; 80 = hash (i + 1) w (newhash (f2 h + k4))\n    | otherwise = h\n  where (k1, k2, k3, k4) = (0x5A827999, 0x6ED9EBA1, 0x8F1BBCDC, 0xCA62C1D6)\n        newhash a' = (rotate a 5 + a' + e + (w `S.index` i), a, rotate b 30, c, d)\n\nf1 :: Quintuple32 -&gt; Word32\nf1 (_, b, c, _, _) = (b .&amp;. c) .|. (complement b .&amp;. c)\n\nf2 :: Quintuple32 -&gt; Word32\nf2 (_, b, c, d, _) = b `xor` c `xor` d\n\nf3 :: Quintuple32 -&gt; Word32\nf3 (_, b, c, d, _) = (b .&amp;. c) .|. (b .&amp;. d) .|. (c .&amp;. d)\n\nstarting :: Quintuple32\nstarting = (0x67452301\n           , 0xEFCDAB89\n           , 0x98BADCFE\n           , 0x10325476\n           , 0xC3D2E1F0)\n\nhasher :: Quintuple32 -&gt; S.Seq Word32 -&gt; Quintuple32\nhasher acc x = addQuintuple acc (hash 0 (extend x) acc)\n\nprocess :: B.ByteString -&gt; Quintuple32\nprocess = foldl hasher starting . chunks . pad\n\nextend :: S.Seq Word32 -&gt; S.Seq Word32\nextend = extend' 16\n\nextend' :: Int -&gt; S.Seq Word32 -&gt; S.Seq Word32\nextend' 80 a = a\nextend' i a = extend' (i + 1) (a |&gt; xored)\n  where xored = rotate ((a `S.index` (i - 3)) `xor`\n                        (a `S.index` (i - 8)) `xor`\n                        (a `S.index` (i - 14)) `xor`\n                        (a `S.index` (i - 16))) 1\n\ntoBytes :: String -&gt; B.ByteString\ntoBytes = B.pack . map (fromIntegral . ord)\n\nsplitEvery n xs\n    | B.null xs = S.empty\n    | otherwise = B.take n xs &lt;| splitEvery n (B.drop n xs)\n\nchunks :: B.ByteString -&gt; [S.Seq Word32]\nchunks xs\n    | B.null xs = []\n    | otherwise = x : chunks (B.drop 64 xs)\n  where x = fmap decode (splitEvery 4 (B.take 64 xs))\n\npad :: B.ByteString -&gt; B.ByteString\npad xs = B.append (add0 $ add1 xs) length64\n  where length64 = encode (fromIntegral (8 * B.length xs) :: Word64)\n\nadd1 :: B.ByteString -&gt; B.ByteString\nadd1 = flip B.append (B.singleton 128)\n\nadd0 :: B.ByteString -&gt; B.ByteString\nadd0 xs\n    | modulo /= 448 = add0 $ B.append xs (B.singleton 0)\n    | otherwise = xs\n  where modulo = (B.length xs * 8) `rem` 512\n</code></pre>\n\n<p>Also, a small question: is something like <code>(a, b) = (8, 9)</code> an acceptable thing to do to set multiple variables?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1434925864, "post_id": 30969962, "comment_id": 49971474, "body": "I can compile it just fine (although the output is not as expected)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1434926861, "post_id": 30969962, "comment_id": 49971695, "body": "@Mephy You have to click &quot;edit&quot; to see the actual code. StackOverflow converts tabs to spaces in code blocks (naughty, naughty!) with tabstops every four columns."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1434926653, "last_edit_date": 1434926653, "creation_date": 1434926262, "answer_id": 30970020, "question_id": 30969962, "link": "https://stackoverflow.com/questions/30969962/haskell-parse-error-on-input/30970020#30970020", "title": "Haskell &quot;parse error on input \u2018=\u2019&quot;", "body": "<p>The Haskell Report specifies that tab characters flesh out text to the next multiple of eight. Your code appears to assume that it gets fleshed out to the next multiple of four. (My best guess. Might also be configured to be five or six, but those settings seem less popular than four.)</p>\n\n<p>See <a href=\"http://dmwit.com/tabs\" rel=\"nofollow\">my page on tabs</a> for ideas on how to safely use tabs in Haskell code; or else do what most other folks do and configure your editor to expand tabs to spaces.</p>\n\n<p>For an example of the style I use, your current code looks like this to the compiler (using <code>&gt;</code> to mark tabs and <code>_</code> for spaces):</p>\n\n<pre><code>splitAtIndex_..._=_...\n&gt;       where_&gt; firstHalfIndexes_=_...\n&gt;       &gt;       &gt;       secondHalfIndexes_=_...\n</code></pre>\n\n<p>I would write it to look like this to the compiler:</p>\n\n<pre><code>splitAtIndex_..._=_...\n&gt;       where_&gt; firstHalfIndexes_=_...\n&gt;       ______&gt; secondHalfIndexes_=_...\n</code></pre>\n\n<p>This also looks correct with four-space tabstops (and indeed any size tabstop):</p>\n\n<pre><code>splitAtIndex_..._=_...\n&gt;   where_&gt; firstHalfIndexes_=_...\n&gt;   ______&gt; secondHalfIndexes_=_...\n</code></pre>\n\n<p>(Actually, I would probably just use one space after <code>where</code> rather than a space and a tab, but that's an aesthetics thing, not really a technical one.)</p>\n"}], "owner": {"reputation": 344, "user_id": 139962, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/06434dc7451d4b65c9639b540bc7d624?s=128&d=identicon&r=PG", "display_name": "JimmyP", "link": "https://stackoverflow.com/users/139962/jimmyp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434926653, "creation_date": 1434925652, "last_edit_date": 1434925953, "question_id": 30969962, "link": "https://stackoverflow.com/questions/30969962/haskell-parse-error-on-input", "title": "Haskell &quot;parse error on input \u2018=\u2019&quot;", "body": "<p>I am doing some haskell exercises to learn the language and I have a syntax error I was hoping someone could help me with:</p>\n\n<pre><code>-- Split a list l at element k into a tuple: The first part up to and including k, the second part after k\n-- For example \"splitAtIndex 3 [1,1,1,2,2,2]\" returns ([1,1,1],[2,2,2])\nsplitAtIndex k l = ([l !! x | x &lt;- firstHalfIndexes], [l !! x | x &lt;- firstHalfIndexes])\n    where   firstHalfIndexes = [0..k-1]\n            secondHalfIndexes = [k..(length l-1)]\n</code></pre>\n\n<p>The syntax error is \"parse error on input \u2018=\u2019\" and seems to be coming from my second where clause, but I can't work out why the first where clause is ok but not the second?</p>\n"}, {"tags": ["haskell", "attoparsec"], "answers": [{"comments": [{"owner": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "edited": false, "score": 0, "creation_date": 1434915069, "post_id": 30968334, "comment_id": 49968473, "body": "Right, with the change you suggest, instead of <code>Right []</code> I get <code>Left &quot;endOfInput&quot;</code>. I remember reading that with <code>attoparsec</code> you don&#39;t get the precise error reporting that you get with the older <code>parsec</code> package. For debugging purposes I guess it&#39;s possible to temporarily remove the <code>endOfInput</code> constraint and see what DOES gets through though. Won&#39;t really help me in this case though, when I hand out the parser to the end user. But I guess I can&#39;t do much. Well, thank you anyway, that&#39;s the answer!"}], "tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": true, "score": 2, "last_activity_date": 1434914073, "creation_date": 1434914073, "answer_id": 30968334, "question_id": 30967878, "link": "https://stackoverflow.com/questions/30967878/attoparsec-succeeding-on-part-of-the-input-instead-of-failing/30968334#30968334", "title": "attoparsec: succeeding on part of the input instead of failing", "body": "<p>Depending on if consuming the whole input should be the property of <code>parseNoteDocument</code> or just the tests, I'd extend one or the other with <a href=\"https://hackage.haskell.org/package/attoparsec-0.10.1.1/docs/Data-Attoparsec-Text.html#v:endOfInput\" rel=\"nofollow\"><code>endOfInput</code></a> or <code>atEnd</code>.</p>\n\n<p>I'd suggest to define a proper <code>Parser</code> for your documents, like</p>\n\n<pre><code>parseNoteDocument' :: Text -&gt; Parsec NoteDocument\nparseNoteDocument' = many parseLine\n</code></pre>\n\n<p>and then define <code>parseNoteDocument</code> in terms of it. Then you can use <code>parseNoteDocument'</code> in the tests by defining a helper that parses a given piece of text using</p>\n\n<pre><code>parseNoteDocument' &lt;* endOfInput\n</code></pre>\n\n<p>to ensure that the whole input is consumed.</p>\n"}], "owner": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 30968334, "answer_count": 1, "score": 0, "last_activity_date": 1434914073, "creation_date": 1434911067, "question_id": 30967878, "link": "https://stackoverflow.com/questions/30967878/attoparsec-succeeding-on-part-of-the-input-instead-of-failing", "title": "attoparsec: succeeding on part of the input instead of failing", "body": "<p>I have an <code>attoparsec</code> parser, and tests for it, what annoys me is that if I comment part of the parser and run the tests, the parser doesn't return <code>Left \"parse error at line ...\"</code> but instead I get <code>Right []</code>.</p>\n\n<p>Note that I'm using <code>parseOnly</code> to make it clear that there'll be no more input.</p>\n\n<p>Otherwise it's nice to get the partially parsed input, it can definitely be useful and I'm glad to have it. However I'd like to be informed that the whole input was not consumed. Maybe to get a character offset of the last consumed letter, or if that's what it  takes, at least an option to be returned <code>Left</code>.</p>\n\n<p>If it's relevant, the parser can be found <a href=\"https://github.com/emmanueltouzery/projectpad/blob/master/src/Notes.hs#L43\" rel=\"nofollow\">there</a>.</p>\n\n<p>If I comment for instance the line:</p>\n\n<pre><code>            &lt;|&gt; PlainText &lt;$&gt; choice (string &lt;$&gt; [\"[\", \"]\", \"*\", \"`\"])\n</code></pre>\n\n<p>And run the tests, I get for instance:</p>\n\n<pre><code>  1) notes parsing tests parses notes properly\n       simple test\n       expected: Right [NormalLine [PlainText \"one line* # hello world\"]]\n        but got: Right []\n</code></pre>\n\n<p>This is from <a href=\"https://github.com/emmanueltouzery/projectpad/blob/master/tests/Tests.hs#L25\" rel=\"nofollow\">that test</a>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1434909492, "post_id": 30967524, "comment_id": 49966680, "body": "the way you wrote it will not compile - is <code>isDigit</code>the same as <code>tokenize</code>? Can you please give us your working code?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1434909617, "post_id": 30967524, "comment_id": 49966710, "body": "aside from my comment a simple <code>tokenize s = [Number $ read s]</code> will do the job for this part (if you expected <code>tokenize &quot;256&quot; = [Number 256]</code>"}, {"owner": {"reputation": 197, "user_id": 4329377, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/--Jf-Vxi9HSQ/AAAAAAAAAAI/AAAAAAAAAzU/r3SujqRJNnc/photo.jpg?sz=128", "display_name": "Walle", "link": "https://stackoverflow.com/users/4329377/walle"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1434910201, "post_id": 30967524, "comment_id": 49966876, "body": "I just edited the code. Guess I&#39;ll have to get rid of the <code>tokenize cs</code> part"}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 4329377, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/--Jf-Vxi9HSQ/AAAAAAAAAAI/AAAAAAAAAzU/r3SujqRJNnc/photo.jpg?sz=128", "display_name": "Walle", "link": "https://stackoverflow.com/users/4329377/walle"}, "edited": false, "score": 0, "creation_date": 1434910891, "post_id": 30967757, "comment_id": 49967119, "body": "Right but if I tried <code>123 + 456</code> wouldn&#39;t it become <code>[123 , +456]</code> ? since the plus size is taken as a string along with <code>456</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 197, "user_id": 4329377, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/--Jf-Vxi9HSQ/AAAAAAAAAAI/AAAAAAAAAzU/r3SujqRJNnc/photo.jpg?sz=128", "display_name": "Walle", "link": "https://stackoverflow.com/users/4329377/walle"}, "edited": false, "score": 0, "creation_date": 1434914192, "post_id": 30967757, "comment_id": 49968220, "body": "@Walle Yes. You still need some recursion as in your posted code, as well as handling <code>+</code> or the other non digit tokens you might have in your language."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1434910320, "creation_date": 1434910320, "answer_id": 30967757, "question_id": 30967524, "link": "https://stackoverflow.com/questions/30967524/verify-multiple-digit-integer-in-haskell/30967757#30967757", "title": "Verify multiple-digit integer in Haskell", "body": "<p>This is a hint:</p>\n\n<pre><code>&gt; import Data.Char\n&gt; span isDigit \"123abc456\"\n(\"123\",\"abc456\")\n</code></pre>\n\n<p><code>span isDigit</code> returns a pair: the longest prefix made by digits only, and the rest of the string.</p>\n"}], "owner": {"reputation": 197, "user_id": 4329377, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/--Jf-Vxi9HSQ/AAAAAAAAAAI/AAAAAAAAAzU/r3SujqRJNnc/photo.jpg?sz=128", "display_name": "Walle", "link": "https://stackoverflow.com/users/4329377/walle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434910320, "creation_date": 1434908903, "last_edit_date": 1434910099, "question_id": 30967524, "link": "https://stackoverflow.com/questions/30967524/verify-multiple-digit-integer-in-haskell", "title": "Verify multiple-digit integer in Haskell", "body": "<p>I'm writing a small tokenizer program to identify each string inputs respectively. However when I tested it with multiple digit number say \"256\" it gives me a string token of [Number 2,Number 5,Number 6] which isn't what I expected.</p>\n\n<pre><code>import Data.Char\ndata Token = Number Integer\n     deriving (Show, Eq)\n\ntokenize :: String -&gt; [Token]\ntokenize (c:cs)\n     | isDigit c = Number (read [c]) : tokenize cs\n     | otherwise = error\n</code></pre>\n\n<p>How do I make <code>isDigit</code> work with integers greater than 9? (has 2 or more digits)</p>\n"}, {"tags": ["haskell", "compiler-errors", "instance", "equality", "typeclass"], "comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 5, "creation_date": 1434906444, "post_id": 30967119, "comment_id": 49965714, "body": "Where is the <code>PartOrd</code> class from and what&#39;s its definition?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1434906606, "post_id": 30967119, "comment_id": 49965765, "body": "<code>EQ</code> and <code>False</code> are of different types: a function can not return both."}, {"owner": {"reputation": 6364, "user_id": 288913, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/902e8cc4ad1dab7e25d3a2dc1eac732f?s=128&d=identicon&r=PG", "display_name": "Sarah", "link": "https://stackoverflow.com/users/288913/sarah"}, "edited": false, "score": 2, "creation_date": 1434906977, "post_id": 30967119, "comment_id": 49965885, "body": "It looks like you&#39;re trying to define a new <code>Eq</code> instance for the PartOrd a type, in which case you probably want something like <code>instance Eq a =&gt; Eq (PartOrd a)</code> or similar."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1434909954, "post_id": 30967119, "comment_id": 49966787, "body": "@user4325010 Show us your definition of <code>PartOrd</code>."}, {"owner": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1434911822, "post_id": 30967119, "comment_id": 49967464, "body": "@ReinHenrichs  edited."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1434914179, "post_id": 30967119, "comment_id": 49968214, "body": "Why did you ask this question instead of commenting on my answer to your previous one? It seems you did not understand it."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1434944242, "post_id": 30967119, "comment_id": 49974976, "body": "Now show us your definitions of <code>bigger</code> and <code>smaller</code>. We are not mind readers."}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 6, "last_activity_date": 1525192465, "last_edit_date": 1525192465, "creation_date": 1434920134, "answer_id": 30969253, "question_id": 30967119, "link": "https://stackoverflow.com/questions/30967119/haskell-is-not-a-visible-method-of-class/30969253#30969253", "title": "Haskell: `==&#39; is not a (visible) method of class", "body": "<p>It isn't clear what you are trying to achieve. Here are some thoughts:</p>\n\n<ol>\n<li><p>When you declare an instance of a class like <code>instance (Eq a) =&gt; PartOrd a</code>, you are expected to provide implementations for the functions in <code>PartOrd a</code> (ie <code>partcmp</code>, not <code>==</code> and <code>/=</code>). The compiler is telling you exactly that: <code>==</code> and <code>/=</code> are in the class <code>Eq</code>, not <code>PartOrd</code>, and you have no business defining functions not in <code>PartOrd</code>. In fact, no matter whether you use <code>==</code>, or <code>=~</code> or <code>/~</code>, the problem persists: <em>you shouldn't be defining anything other that <code>partcmp</code> in <code>instance (Eq a) =&gt; PartOrd a</code></em>. The <code>(Eq a) =&gt;</code> part just says that in these definitions you can assume functions <code>==</code> and <code>/=</code> of type signatures <code>(==), (/=) :: a -&gt; a -&gt; a</code> have been defined.</p></li>\n<li><p>Why are you using lists in the instance declaration? Did you maybe mean to say <code>instance (Eq a) =&gt; PartOrd [a]</code>? If you <em>really</em> meant to say <code>instance (Eq a) =&gt; PartOrd a</code>, you will need to turn on the <code>FlexibleInstances</code> (and maybe something more too...) in GHC. (However, it doesn't really make sense to have <code>instance (Eq a) =&gt; PartOrd a</code>.)</p></li>\n<li><p>Finally, where do the function <code>bigger</code> and <code>smaller</code> come from? You can't use them in <code>class (Eq a) =&gt; PartOrd a</code>, since <code>a</code> is a general type. You would need functions <code>bigger, smaller :: a -&gt; a -&gt; a</code>, in which case you wouldn't even really need the <code>PartOrd</code> class.</p></li>\n</ol>\n"}], "owner": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4270, "favorite_count": 0, "accepted_answer_id": 30969253, "answer_count": 1, "score": 0, "last_activity_date": 1525192465, "creation_date": 1434906286, "last_edit_date": 1525189895, "question_id": 30967119, "link": "https://stackoverflow.com/questions/30967119/haskell-is-not-a-visible-method-of-class", "title": "Haskell: `==&#39; is not a (visible) method of class", "body": "<p>So, when I compile the following piece of code <em>edited</em>:</p>\n\n<pre><code>instance (Eq a) =&gt; PartOrd a where \n        [] == []         = True\n        (x:xs) == (y:ys) = x==y &amp;&amp; xs==ys\n        _ == _           = False\n        xs /= ys         = not (xs == ys)\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>  `==' is not a (visible) method of class 'PartOrd'\n\n  `/=' is not a (visible) method of class 'PartOrd'\nFailed, modules loaded: none.\n</code></pre>\n\n<p>I have looked at <a href=\"https://stackoverflow.com/questions/2299951/how-to-properly-instantiate-classes-in-haskell\">How to properly instantiate classes in Haskell?</a> for some clarifications but even though I wasn`t able to fix it.</p>\n\n<p>Also, is it the same when I use custom-made operators such as <code>=~</code> for <code>==</code> and <code>/~</code> for <code>/=</code>, because I get the same error?</p>\n\n<p><strong>EDIT:</strong> As requested:</p>\n\n<pre><code>class Eq a =&gt; PartOrd a where\n\n   partcmp :: a -&gt; a -&gt; Maybe Ordering \n   partcmp x y = case bigger x y of\n                   True   -&gt; Just LT\n                   False  -&gt; case smaller x y of\n                               True  -&gt; Just GT\n                               False -&gt; case x == y of\n                                          True  -&gt; Just EQ\n                                          False -&gt; Nothing      \n</code></pre>\n"}, {"tags": ["haskell", "containers", "sequence"], "comments": [{"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 1, "creation_date": 1434905295, "post_id": 30966910, "comment_id": 49965385, "body": "@dfeuer would be the expert on Data.Sequence, although I don\u2019t know if I can notify him this way."}, {"owner": {"reputation": 603, "user_id": 2948250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80213caa67149fe0815715367088340a?s=128&d=identicon&r=PG&f=1", "display_name": "Jannis Limperg", "link": "https://stackoverflow.com/users/2948250/jannis-limperg"}, "reply_to_user": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1434977852, "post_id": 30966910, "comment_id": 49991449, "body": "Github issue: <a href=\"https://github.com/haskell/containers/issues/159\" rel=\"nofollow noreferrer\">https://github.com/haskell/containers/issues/159</a>."}], "answers": [{"comments": [{"owner": {"reputation": 603, "user_id": 2948250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80213caa67149fe0815715367088340a?s=128&d=identicon&r=PG&f=1", "display_name": "Jannis Limperg", "link": "https://stackoverflow.com/users/2948250/jannis-limperg"}, "edited": false, "score": 0, "creation_date": 1434976700, "post_id": 30967639, "comment_id": 49990605, "body": "That is a very good point, thank you very much. I shall ask @dfeuer why these definitions are not in the library."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 8, "last_activity_date": 1434910019, "last_edit_date": 1434910019, "creation_date": 1434909699, "answer_id": 30967639, "question_id": 30966910, "link": "https://stackoverflow.com/questions/30966910/why-are-taker-dropr-and-splitatr-missing-from-data-sequence/30967639#30967639", "title": "Why are takeR, dropR and splitAtR missing from Data.Sequence?", "body": "<p><a href=\"http://hackage.haskell.org/package/containers-0.5.6.3/docs/Data-Sequence.html#v:length\"><code>length</code></a> is O(1), so <code>splitAt</code> suffices to define everything you need, in an efficient way.</p>\n\n<pre><code> splitAtR i s = splitAt (length s - i) s\n takeR i s = snd $ splitAtR i s\n dropR i s = fst $ splitAtR i s\n</code></pre>\n\n<p>According to the docs, <code>splitAt</code> costs <code>O(log(min(i,length s-i)))</code>, so by symmetry <code>splitAtR</code> costs the same (just an additional <code>+O(1)</code>, which we can neglect).</p>\n"}], "owner": {"reputation": 603, "user_id": 2948250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80213caa67149fe0815715367088340a?s=128&d=identicon&r=PG&f=1", "display_name": "Jannis Limperg", "link": "https://stackoverflow.com/users/2948250/jannis-limperg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 30967639, "answer_count": 1, "score": 6, "last_activity_date": 1434911637, "creation_date": 1434904857, "last_edit_date": 1434911637, "question_id": 30966910, "link": "https://stackoverflow.com/questions/30966910/why-are-taker-dropr-and-splitatr-missing-from-data-sequence", "title": "Why are takeR, dropR and splitAtR missing from Data.Sequence?", "body": "<p><code>Data.Sequence</code> has <code>takeWhileR</code> and <code>dropWhileR</code> for efficient deconstruction of <code>Seq</code>s from the right. However, <code>takeR</code>, <code>dropR</code> and <code>splitAtR</code> are conspicuously absent. <code>take</code> and <code>drop</code> are implemented in terms of <code>splitAt</code>. So, do finger trees not admit an efficient <code>splitAtR</code> or was this functionality not included for some other reason?</p>\n\n<p>(Separate but somewhat related question: Would a naive <code>dropR</code> implementation in terms of <code>viewR</code> perform decently well?)</p>\n\n<p>This question is based on <a href=\"http://hackage.haskell.org/package/containers-0.5.6.3/docs/Data-Sequence.html\" rel=\"nofollow\"><code>containers-0.5.6.3</code></a>.</p>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": true, "score": 8, "last_activity_date": 1434904452, "creation_date": 1434904452, "answer_id": 30966823, "question_id": 30966530, "link": "https://stackoverflow.com/questions/30966530/memory-consumption-api/30966823#30966823", "title": "Memory consumption API", "body": "<p>You can get the total heap consumption and other stats via <a href=\"http://hackage.haskell.org/package/base/docs/GHC-Stats.html#v:getGCStats\" rel=\"noreferrer\"><code>getGCStats</code></a> in module GHC.Stats, at least if you run your program with <code>+RTS -T</code>.</p>\n"}], "owner": {"reputation": 1057, "user_id": 2979439, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8650f211424be695c8abb2cd364c9e97?s=128&d=identicon&r=PG&f=1", "display_name": "dev1223", "link": "https://stackoverflow.com/users/2979439/dev1223"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 2, "accepted_answer_id": 30966823, "answer_count": 1, "score": 8, "last_activity_date": 1554647701, "creation_date": 1434902800, "last_edit_date": 1554647701, "question_id": 30966530, "link": "https://stackoverflow.com/questions/30966530/memory-consumption-api", "title": "Memory consumption API", "body": "<p>Is there a way to get total heap consumption (and consumption of specific datatypes) in app runtime (GHC)? I'm writing profiler for my interpreter, so I can't use standard ways.</p>\n"}, {"tags": ["haskell", "instance", "show", "typeclass"], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 5, "last_activity_date": 1434898532, "creation_date": 1434898532, "answer_id": 30965865, "question_id": 30965581, "link": "https://stackoverflow.com/questions/30965581/instance-of-show-for-lambda-abstraction-adt/30965865#30965865", "title": "Instance of Show for lambda-abstraction ADT", "body": "<p>Add an instance declaration for the <code>Show</code> class.</p>\n\n<pre><code>instance Show LExpr where\n  show = show'\n</code></pre>\n\n<p>And remove the <code>deriving(Show)</code> part</p>\n\n<pre><code>data LExpr\n    = Variable String         -- variable\n    | Apply LExpr LExpr       -- function application\n    | Lambda String LExpr     -- Lambda abstraction \n    deriving (Eq) \n</code></pre>\n"}], "owner": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 30965865, "answer_count": 1, "score": 1, "last_activity_date": 1435509292, "creation_date": 1434896819, "last_edit_date": 1435509292, "question_id": 30965581, "link": "https://stackoverflow.com/questions/30965581/instance-of-show-for-lambda-abstraction-adt", "title": "Instance of Show for lambda-abstraction ADT", "body": "<p>So, I have already defined the lambda data type as such:</p>\n\n<pre><code>data LExpr\n    = Variable String         -- variable\n    | Apply LExpr LExpr       -- function application\n    | Lambda String LExpr     -- Lambda abstraction \n    deriving (Eq, Show)  \n</code></pre>\n\n<p>Now I want to implement an instance of <code>Show</code> myself. I have already the function <code>show'</code> which does most of the work, but without using instances: </p>\n\n<pre><code> show' :: LExpr -&gt; String\n show' (Variable a) = a\n show' (Apply e1 e2) = \"(\" ++ show' e1 ++ \" \" ++ show' e2 ++ \")\"                   \n show' (Lambda x e) = \"(\u03bb \" ++ x ++ \". \" ++ show' e ++ \")\"    \n</code></pre>\n\n<p>How I can implement it, to get the following output without using explicitly the <code>show'</code> function: </p>\n\n<pre><code>Main&gt; (Apply (Lambda \"x\" (Apply (Variable \"x\") (Variable \"y\"))) (Variable \"z\"))\n((\u03bb x. x y) y)       \n</code></pre>\n"}, {"tags": ["haskell", "yesod", "api-key"], "answers": [{"comments": [{"owner": {"reputation": 1883, "user_id": 988324, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e9a50cfb6dd20efd1198fdafc0b1c11a?s=128&d=identicon&r=PG", "display_name": "Richard Deurwaarder", "link": "https://stackoverflow.com/users/988324/richard-deurwaarder"}, "edited": false, "score": 0, "creation_date": 1434903858, "post_id": 30966508, "comment_id": 49964947, "body": "Thanks for you comment! How would I go about making an extra settings file which get&#39;s overridden for production?"}, {"owner": {"reputation": 1883, "user_id": 988324, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e9a50cfb6dd20efd1198fdafc0b1c11a?s=128&d=identicon&r=PG", "display_name": "Richard Deurwaarder", "link": "https://stackoverflow.com/users/988324/richard-deurwaarder"}, "edited": false, "score": 0, "creation_date": 1434915165, "post_id": 30966508, "comment_id": 49968502, "body": "I used a slightly different approach, I editted the loadAppSettings call in Application.sh to [&quot;/config/secret.yml&quot;, configSettingsYml]. I&#39;m not sure if it gets loaded at compile time this way, but it works just as I want it now. Thanks"}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 2, "last_activity_date": 1434904965, "last_edit_date": 1434904965, "creation_date": 1434902658, "answer_id": 30966508, "question_id": 30964716, "link": "https://stackoverflow.com/questions/30964716/where-to-store-api-keys-and-other-secrets-in-a-yesod-app/30966508#30966508", "title": "Where to store API keys and other &#39;secrets&#39; in a yesod app", "body": "<p>There are many approaches to this, mostly depending on what flavor of devops/hosting your prefer. One option is to put a dummy value in the config file and override it with an environment variable at runtime (see: <a href=\"https://github.com/yesodweb/yesod/wiki/Configuration#overriding-configuration-values-with-environment-variables\" rel=\"nofollow\">https://github.com/yesodweb/yesod/wiki/Configuration#overriding-configuration-values-with-environment-variables</a>). You can also having an extra settings file for production that overrides the values in the default config file, which is how the test suite works. A completely different approach would be to use a system like vault in production and query it for your secure credentials.</p>\n\n<p><strong>EDIT</strong> To spell out one of the approaches:</p>\n\n<ol>\n<li><p>Create a new YAML file with the settings you won't to override, e.g. in <code>config/production.yml</code>:</p>\n\n<pre><code>copyright: This is a copyright notice for production\n</code></pre></li>\n<li><p>When you run the application, pass in a command line argument giving the location of the config file</p></li>\n</ol>\n"}], "owner": {"reputation": 1883, "user_id": 988324, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e9a50cfb6dd20efd1198fdafc0b1c11a?s=128&d=identicon&r=PG", "display_name": "Richard Deurwaarder", "link": "https://stackoverflow.com/users/988324/richard-deurwaarder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 30966508, "answer_count": 1, "score": 2, "last_activity_date": 1434904965, "creation_date": 1434891226, "question_id": 30964716, "link": "https://stackoverflow.com/questions/30964716/where-to-store-api-keys-and-other-secrets-in-a-yesod-app", "title": "Where to store API keys and other &#39;secrets&#39; in a yesod app", "body": "<p>I'm trying out a yesod applications which I will eventually put up on github or similar.</p>\n\n<p>I will use oauth2 with google which means I have to provide an email and secret token. Which I obviously do not want up on github.</p>\n\n<p>What is a good place to store these in a yesod scaffolded application? I'm hoping to store it in a seperate, config/secret.yml for example, so I can put that into the ignore file of git/mercurial and never commit it.</p>\n\n<p>But i can't find out how to include such a file. Or if such a file already is provided by yesod. config/settings.yml seemed possible, but there's entries there which I would like in github.</p>\n\n<p>So my question is, in a yesod scaffolded application. Where can I store secret keys in a way I can easily exclude it from version control systems?</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1434889799, "post_id": 30964246, "comment_id": 49960992, "body": "you have <code>time</code> installed? (which version?) - also can you please add a simple sample code and at least the beginning of the error message? - for me <code>import Data.Time.Format</code> and then <code>defaultTimeLocale</code> (mind the <b>e</b> at the end) works just fine - <i>also</i> what OS are you on?"}], "answers": [{"tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": true, "score": 3, "last_activity_date": 1434893036, "creation_date": 1434893036, "answer_id": 30964999, "question_id": 30964246, "link": "https://stackoverflow.com/questions/30964246/cant-find-defaulttimelocale-in-data-time-format/30964999#30964999", "title": "Can&#39;t find defaultTimeLocale in Data.Time.Format", "body": "<p>For some reason, cabal wasn't using the version I thought it was (1.5) but (1.4) probably from the haskell platform. Uprading fixed the problem. </p>\n"}, {"tags": [], "owner": {"reputation": 375, "user_id": 1991843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aa2dac39155549700e0d3596a84697a?s=128&d=identicon&r=PG", "display_name": "tippenein", "link": "https://stackoverflow.com/users/1991843/tippenein"}, "is_accepted": false, "score": 1, "last_activity_date": 1502133237, "creation_date": 1502133237, "answer_id": 45554174, "question_id": 30964246, "link": "https://stackoverflow.com/questions/30964246/cant-find-defaulttimelocale-in-data-time-format/45554174#45554174", "title": "Can&#39;t find defaultTimeLocale in Data.Time.Format", "body": "<p>For anyone else coming across this answer who wants to write their library with backwards compatible <code>time</code> dependencies, you can use the CPP pragma and an <code>#if</code> to check the minimum version of the time library:</p>\n\n<pre><code>{-# Language CPP #-}\n#if MIN_VERSION_time(1,5,0)\nimport Data.Time.Format (defaultTimeLocale)\n#else\nimport System.Locale (defaultTimeLocale)\n#endif\n</code></pre>\n"}], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 0, "accepted_answer_id": 30964999, "answer_count": 2, "score": 2, "last_activity_date": 1502133237, "creation_date": 1434887862, "last_edit_date": 1434892858, "question_id": 30964246, "link": "https://stackoverflow.com/questions/30964246/cant-find-defaulttimelocale-in-data-time-format", "title": "Can&#39;t find defaultTimeLocale in Data.Time.Format", "body": "<p>According to the <a href=\"https://hackage.haskell.org/package/time-1.5/docs/Data-Time-Format.html\" rel=\"nofollow\">doc</a> on Hackage, <code>Data.Time.Format</code> exposed <code>defaultTimeLocal</code>.\nHowever, when I try to use it, it doesn't exits. </p>\n\n<p>When I look at the code, it doesn't seems to be exposed either (if I generate the doc from the source, I don't see this <code>defaultTimeLocale</code>). Is it because it needs to be compiled with some flags, or is the haddock on hackage just wrong.</p>\n\n<p>Where can I get an instance for <code>TimeLocale</code>?</p>\n\n<h1>Update</h1>\n\n<p>I'm using <code>time</code> version 1.5.0.1 on OSX.\nThe following code</p>\n\n<pre><code>import Data.Time.Format (defaultTimeLocale)\n</code></pre>\n\n<p>errors with </p>\n\n<pre><code>Module \u2018Data.Time.Format\u2019 does not export \u2018defaultTimeLocale\u2019\n</code></pre>\n\n<h1>Update</h1>\n\n<p>In fact I was using version 1.4.2 which doesn't have <code>defaultTimeLocale</code> installed.\nI'm upgrading to 1.5.0.1 ...</p>\n\n<h1>Update</h1>\n\n<p>I deleted my sandbox, rebuild everything. It's workin now.</p>\n"}, {"tags": ["algorithm", "haskell"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1434884550, "post_id": 30963694, "comment_id": 49959511, "body": "You can probably cut down on the combinations massively if you keep the OR of all numbers so far and don&#39;t recurse when a number AND the OR&#39;ed number are non-zero. By using XOR, you re-open paths that you can preclude."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 2, "creation_date": 1434884620, "post_id": 30963694, "comment_id": 49959525, "body": "By the way, your problem sounds like the <a href=\"https://en.wikipedia.org/wiki/Exact_cover\" rel=\"nofollow noreferrer\">exact cover</a>, for which there are non-brute force algorithms."}, {"owner": {"reputation": 846, "user_id": 801620, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b74940e925efb3e2a470987eb7e0f8c8?s=128&d=identicon&r=PG", "display_name": "sigidagi", "link": "https://stackoverflow.com/users/801620/sigidagi"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1434887967, "post_id": 30963694, "comment_id": 49960447, "body": "@M Oehm Thanks for pointing to the right direction - Donald Knuth algorithm X could be a solution. Now only Haskell code is needed."}, {"owner": {"reputation": 51837, "user_id": 2144669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7393f439028063515255b63ed94cfd?s=128&d=identicon&r=PG", "display_name": "David Eisenstat", "link": "https://stackoverflow.com/users/2144669/david-eisenstat"}, "edited": false, "score": 0, "creation_date": 1434891444, "post_id": 30963694, "comment_id": 49961400, "body": "Dancing links probably does not look very nice in Haskell. Doubtless someone has done it anyway."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1434921294, "post_id": 30963694, "comment_id": 49970291, "body": "For what it is worth, here is someone&#39;s solution... <a href=\"https://github.com/jaapterwoerds/algorithmx/blob/master/src/ExactCover.hs\" rel=\"nofollow noreferrer\">github.com/jaapterwoerds/algorithmx/blob/master/src/&hellip;</a>. Not convinced of efficiency though. Definitely no dancing links."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1434921273, "creation_date": 1434921273, "answer_id": 30969402, "question_id": 30963694, "link": "https://stackoverflow.com/questions/30963694/finding-unique-combination-using-recursion/30969402#30969402", "title": "Finding unique combination using recursion", "body": "<p>The <a href=\"http://hackage.haskell.org/package/set-cover\" rel=\"nofollow\">set-cover</a> package provides a solver for this kind of problem.</p>\n"}], "owner": {"reputation": 846, "user_id": 801620, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b74940e925efb3e2a470987eb7e0f8c8?s=128&d=identicon&r=PG", "display_name": "sigidagi", "link": "https://stackoverflow.com/users/801620/sigidagi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 30969402, "answer_count": 1, "score": 1, "last_activity_date": 1434921273, "creation_date": 1434883877, "question_id": 30963694, "link": "https://stackoverflow.com/questions/30963694/finding-unique-combination-using-recursion", "title": "Finding unique combination using recursion", "body": "<p>I have 11 lists (in size ~36) with 64 bit numbers. One combination - one element per list will form a list with 11 elements. I need to find such combination that <code>xor</code> operation of all 11 elements will result magic number (<code>FFFF FFFF FFFF FFFF</code> in hex format). \n'Brutal force' approach using comprehension list to create all possible combination and then iterate until the condition will be reached is not practical: number of possible combinations is huge.</p>\n\n<p>This problem arises when I try to solve 2D puzzle on 8x8 board. There are 11 figures and 64 bit number (in binary form) represents figure shape and position on that board. That's why there are 11 lists with all possible positions for every figure. All figures will fit nicely on the board when there is no intersection between them.</p>\n\n<p>I have imperative programming background, but I have a feeling that Haskell can solve such problem in more readable and understandable way than \"spaghetti\" imperative language solution. </p>\n"}, {"tags": ["haskell", "types", "constraints", "instance"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1434882584, "post_id": 30963327, "comment_id": 49959022, "body": "<i>How do I have to change my code that this works with all numerical types?</i> What does &quot;this&quot; refer to in your sentence, exactly?"}, {"owner": {"reputation": 17, "user_id": 4638907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4d2251d22c4da4ab0f8e546a4f98f1?s=128&d=identicon&r=PG&f=1", "display_name": "Chango", "link": "https://stackoverflow.com/users/4638907/chango"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1434888170, "post_id": 30963327, "comment_id": 49960512, "body": "With my defined instance I am only able to compare types of Int but I want to compare all numerical Types i.e. float, Integer, ..."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1434909219, "post_id": 30963327, "comment_id": 49966585, "body": "This isn&#39;t something you can really do. The Num typeclass doesn&#39;t provide <code>(==)</code>. You can convince GHC to accept a definition of <code>instance Num a =&gt; Eqa a</code> with the right language pragmas but it&#39;s nonsensical and in practice you won&#39;t be able to use it."}], "answers": [{"comments": [{"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 3, "creation_date": 1434908432, "post_id": 30963696, "comment_id": 49966331, "body": "This isn&#39;t a great solution.  First of all, it doesn&#39;t work as written: it requires <code>FlexibleInstances</code> and <code>UndecidableInstances</code>; plus, in modern GHCs, <code>Eq</code> is no longer a superclass of <code>Num</code>, so you need an <code>Eq a</code> constraint too.  More importantly, though, it makes defining other instances of <code>Eqa</code> rather fraught: if we add <code>instance Eqa () where { _ =~ _ = True ; _ &#47;~ _ = False }</code>, then <code>() =~ ()</code> gives us an &quot;Overlapping instances&quot; error, because <code>()</code> <i>could</i> have a <code>Num</code> instance!"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "reply_to_user": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 0, "creation_date": 1434967698, "post_id": 30963696, "comment_id": 49984933, "body": "@AntalS-Z Do you happen to know when (i.e., for which version of GHC) <code>Eq</code> ceased to be a superclass of <code>Num</code>?"}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 2, "creation_date": 1434967870, "post_id": 30963696, "comment_id": 49985032, "body": "@Jubobs: Since GHC 7.4.1.  Here are <a href=\"https://downloads.haskell.org/~ghc/7.4.1/docs/html/users_guide/release-7-4-1.html\" rel=\"nofollow noreferrer\">the GHC 7.4.1 release notes</a>, which says &quot;The <code>Num</code> class no longer has <code>Eq</code> or <code>Show</code> superclasses&quot;; compare <a href=\"https://downloads.haskell.org/~ghc/7.2.1/docs/html/users_guide/release-7-2-1.html\" rel=\"nofollow noreferrer\">the GHC 7.2.1 release notes</a>, which say nothing of the sort.  This is from <a href=\"http://stackoverflow.com/a/19327850/237428\">Ben James&#39;s answer</a> to <a href=\"http://stackoverflow.com/q/19327792/237428\">exactly this question</a>."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "reply_to_user": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 0, "creation_date": 1434968304, "post_id": 30963696, "comment_id": 49985295, "body": "@AntalS-Z Greatly appreciated. Thanks."}], "tags": [], "owner": {"reputation": 490, "user_id": 635669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0408d7a07f6d5460814d9016aef947c?s=128&d=identicon&r=PG", "display_name": "Guiraldelli", "link": "https://stackoverflow.com/users/635669/guiraldelli"}, "is_accepted": false, "score": -1, "last_activity_date": 1434883889, "creation_date": 1434883889, "answer_id": 30963696, "question_id": 30963327, "link": "https://stackoverflow.com/questions/30963327/haskell-instance-type-constraints/30963696#30963696", "title": "Haskell, Instance, Type Constraints", "body": "<p>All you have to do is to bind <code>a</code> to <code>Num a</code> or</p>\n\n<pre><code>instance Num a =&gt; Eqa a where            \n    x=~y = x==y\n    x/~y = x/=y\n</code></pre>\n\n<p>For more information, take a look at <a href=\"http://book.realworldhaskell.org/read/using-typeclasses.html#typeclasses.wellknown.numeric\" rel=\"nofollow\">Numeric Types subsection of Real World Haskell</a> to understand which class is related to each numerical types.</p>\n"}, {"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 2, "last_activity_date": 1434974527, "creation_date": 1434974527, "answer_id": 30979516, "question_id": 30963327, "link": "https://stackoverflow.com/questions/30963327/haskell-instance-type-constraints/30979516#30979516", "title": "Haskell, Instance, Type Constraints", "body": "<p>Why not just write</p>\n\n<pre><code>(=~) :: Num a =&gt; a -&gt; a -&gt; Bool\nx=~y = x==y\n</code></pre>\n\n<p>If you don't actually need the code to be different for different types, why do you need a class at all?</p>\n"}], "owner": {"reputation": 17, "user_id": 4638907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4d2251d22c4da4ab0f8e546a4f98f1?s=128&d=identicon&r=PG&f=1", "display_name": "Chango", "link": "https://stackoverflow.com/users/4638907/chango"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 517, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1434974527, "creation_date": 1434881179, "last_edit_date": 1434881570, "question_id": 30963327, "link": "https://stackoverflow.com/questions/30963327/haskell-instance-type-constraints", "title": "Haskell, Instance, Type Constraints", "body": "<p>I created in Haskell a new class <code>Eqa</code></p>\n\n<pre><code>class Eqa a where\n\n   (=~) :: a -&gt; a -&gt; Bool\n\n   (/~) :: a -&gt; a -&gt; Bool\n</code></pre>\n\n<p>and want to define <code>(=~)</code> same as <code>(==)</code> from the Prelude. So I tried </p>\n\n<pre><code>instance Eqa Int where            \n   x=~y = x==y\n\n   x/~y = x/=y\n</code></pre>\n\n<p>but this only works for <code>Int</code> (of course).\nHow do I have to change my code that this works with all numerical types?</p>\n"}, {"tags": ["haskell", "types", "binding", "dependent-type"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1434933184, "post_id": 30961556, "comment_id": 49972832, "body": "I&#39;ve edited the title of your question to something I feel is more descriptive of what you&#39;re trying to do. If you&#39;re unhappy with my changes, you can always <a href=\"http://stackoverflow.com/posts/30961556/edit\">edit your post</a> to change it back ;)"}], "answers": [{"comments": [{"owner": {"reputation": 1595, "user_id": 2913916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/478cf0ef7b6e6b5233eae232acf258d1?s=128&d=identicon&r=PG&f=1", "display_name": "Code Monkey", "link": "https://stackoverflow.com/users/2913916/code-monkey"}, "edited": false, "score": 0, "creation_date": 1434877856, "post_id": 30962735, "comment_id": 49957899, "body": "Hi Chi - thanks for the response and insight. I had considered that problem where the definition suggested the result vector could be longer than the input vector (which makes no sense as you say), however I didn&#39;t know how to encode it into the type signature. Is this &#39;wrapping&#39; up of the type a common pattern to encode restrictions like this? If so, do you know what it&#39;s called so that I can read up on it?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1595, "user_id": 2913916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/478cf0ef7b6e6b5233eae232acf258d1?s=128&d=identicon&r=PG&f=1", "display_name": "Code Monkey", "link": "https://stackoverflow.com/users/2913916/code-monkey"}, "edited": false, "score": 3, "creation_date": 1434878766, "post_id": 30962735, "comment_id": 49958137, "body": "@CodeMonkey The issue here is that you want some vector type where the length information is statically known, and another one where the length is statically unknown. You can look up &quot;existential types&quot; in Haskell to see the solution I suggested above. Keep also in mind that existential types are often abused, i.e. sometimes they are used instead of more plain and simpler solutions -- so use some judgment before using them everywhere."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1595, "user_id": 2913916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/478cf0ef7b6e6b5233eae232acf258d1?s=128&d=identicon&r=PG&f=1", "display_name": "Code Monkey", "link": "https://stackoverflow.com/users/2913916/code-monkey"}, "edited": false, "score": 3, "creation_date": 1434878901, "post_id": 30962735, "comment_id": 49958167, "body": "@CodeMonkey Further, in dependently typed languages, you can be even more precise, stating something like <code>(exists m . m &lt;= n &amp;&amp; Vector a m)</code> which ensures that the result is shorted than the input list. Encoding this is Haskell is probably doable, but requires a lot of type-level expertise, and depending on the application at hand, may not be worth the effort."}, {"owner": {"reputation": 1595, "user_id": 2913916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/478cf0ef7b6e6b5233eae232acf258d1?s=128&d=identicon&r=PG&f=1", "display_name": "Code Monkey", "link": "https://stackoverflow.com/users/2913916/code-monkey"}, "edited": false, "score": 0, "creation_date": 1434880452, "post_id": 30962735, "comment_id": 49958557, "body": "Hi, thanks again, this makes sense - I&#39;ll check out the existential types. :-)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1434962302, "post_id": 30962735, "comment_id": 49981726, "body": "The completely parametric signature would still make some sense if the result were <code>Maybe (Vector a m)</code>."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1434970372, "post_id": 30962735, "comment_id": 49986488, "body": "@leftaroundabout: With some hard work you could probably make that version of <code>takeWhile</code> compile, but it would be difficult to call it. The calling context would have to statically predict the length of the output vector. Dependent pairs which return a witness to the static property are the canonical way of typing such functions."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 11, "last_activity_date": 1434876635, "last_edit_date": 1434876635, "creation_date": 1434876191, "answer_id": 30962735, "question_id": 30961556, "link": "https://stackoverflow.com/questions/30961556/how-can-i-express-the-type-of-takewhile-for-vectors/30962735#30962735", "title": "How can I express the type of &#39;takeWhile for vectors&#39;?", "body": "<p>The type you suggest can not be implemented, i.e. it is not inhabited:</p>\n\n<pre><code>takeWhileVector :: (a -&gt; Bool) -&gt; Vector a n -&gt; Vector a m\n</code></pre>\n\n<p>Remember that the caller chooses the type variables <code>a,n,m</code>. This means that the caller can use your function as e.g.</p>\n\n<pre><code>takeWhileVector :: (a -&gt; Bool) -&gt; Vector a Z -&gt; Vector a (S Z)\n</code></pre>\n\n<p>which is nonsense, since you can't produce some <code>a</code>s if you got none at the beginning. Even more practically, the caller of this function is not meant to be able to choose how many results to have and pass a completely unrelated function -- that would disagree with the intended semantics of <code>takeWhile</code>.</p>\n\n<p>I guess what you really mean is something like</p>\n\n<pre><code>takeWhileVector :: (a -&gt; Bool) -&gt; Vector a n -&gt; exists m. Vector a m\n</code></pre>\n\n<p>except that <code>exists</code> is not valid Haskell syntax. Instead, you need something like</p>\n\n<pre><code>data SomeVector a where\n   S :: Vector a m -&gt; SomeVector a\n\ntakeWhileVector :: (a -&gt; Bool) -&gt; Vector a n -&gt; SomeVector a\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1434966389, "post_id": 30970671, "comment_id": 49984164, "body": "Minor glitch in <code>lteSucc</code>: <code>ZL,SL,slt</code> are the wrong names, I think."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1434968256, "post_id": 30970671, "comment_id": 49985267, "body": "Well spotted, copy and paste fail on my part! I&#39;ll fix it ;)"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 7, "last_activity_date": 1456077761, "last_edit_date": 1491982276, "creation_date": 1434932797, "answer_id": 30970671, "question_id": 30961556, "link": "https://stackoverflow.com/questions/30961556/how-can-i-express-the-type-of-takewhile-for-vectors/30970671#30970671", "title": "How can I express the type of &#39;takeWhile for vectors&#39;?", "body": "<p>There's no way to statically know the length of the <code>Vec</code> that is returned by <code>takeWhileVec</code>: it depends on the values contained in the <code>Vec</code>, and the function you use. However, what I can do is give you a value which you can pattern-match on to <em>learn</em> the length of the <code>Vec</code>. Enter <a href=\"https://www.cis.upenn.edu/~eir/papers/2012/singletons/paper.pdf\" rel=\"nofollow noreferrer\"><em>singleton values</em></a>.</p>\n\n<pre><code>data Natty n where\n    Zy :: Natty Z  -- pronounced 'zeddy', because I'm a limey\n    Sy :: Natty n -&gt; Natty (S n)  -- pronounced 'essy'\n</code></pre>\n\n<p>For a given <code>n</code> of kind <code>Nat</code>, there is exactly one (non-<code>undefined</code>) value of type <code>Natty n</code>. So if you know something about a <code>Natty</code>, you also know something about its associated type-level <code>Nat</code>.*</p>\n\n<p>Why can't we just use <code>Nat</code> for this purpose? Haskell maintains a separation between values and types. The type-level <code>Nat</code> has no relation, other than a structural similarity, to the value-level <code>Nat</code>: the value <code>S Z</code> has a type of <code>Nat</code>, not <code>S' Z'</code> - so we have to use <code>Natty</code>, a second copy of <code>Nat</code>, to manually tie values and types together. (Real dependently-typed systems such as Agda allow you to reuse the same <code>Nat</code> for both value-level and type-level computations.)</p>\n\n<p><sub>*You can propagate knowledge the other way too, using type classes.</sub></p>\n\n<hr>\n\n<p>The plan is to return the output vector as well as its length as a <code>Natty</code>, with the types arranged in such a way that GHC understands that the <code>Natty</code> does indeed represent its length. You might first consider this variation on the example in your question:</p>\n\n<pre><code>-- takeWhile :: (a -&gt; Bool) -&gt; Vec a n -&gt; (Natty m, Vec a m)\n</code></pre>\n\n<p>But this doesn't say the right thing: we're saying <code>takeWhile</code> can return any <code>m</code> of the caller's choice, which isn't true! It can only return the unique <code>m</code> determined by the function and the input vector. As I mentioned, this is un-knowable at compile-time, so we have to keep the length a secret from the compiler.</p>\n\n<pre><code>data AVec a = forall n. AVec (Natty n) (Vec a n)\n</code></pre>\n\n<p><code>AVec</code> is an <a href=\"https://wiki.haskell.org/Existential_type\" rel=\"nofollow noreferrer\">existential type</a>: <code>n</code> appears on the right-hand side but not the left. This technique allows you to emulate a <a href=\"https://en.wikipedia.org/wiki/Dependent_type#Dependent_pair_type\" rel=\"nofollow noreferrer\"><em>dependent pair type</em></a>: the type of the <code>Vec</code> depends on the value of the <code>Natty</code>. Dependent pairs are useful whenever the static properties of data depend on dynamic information not available at compile-time.</p>\n\n<p>We can write <code>takeWhile</code> straightforwardly now:</p>\n\n<pre><code>takeWhile :: (a -&gt; Bool) -&gt; Vec a n -&gt; AVec a\ntakeWhile f Nil = AVec Zy Nil\ntakeWhile f (x :- xs) = case takeWhile f xs of\n                             AVec n ys -&gt; if f x\n                                          then AVec (Sy n) (x :- ys)\n                                          else AVec Zy Nil\n</code></pre>\n\n<p>We had to throw away static knowledge of the Vector's length, so how do you use an <code>AVec</code> with a function which places static requirements on the length? Because of the way <code>AVec</code> is constructed, we know that the <code>Natty</code> in the left slot represents the length of the vector in the right slot: they both feature the same (existentially hidden) type parameter <code>n</code>. So, by pattern-matching on the <code>Natty</code>, we learn the length of the <code>Vec</code>.</p>\n\n<pre><code>head :: Vec a (S n) -&gt; a\nhead (x :- xs) = x\n\nhead' :: AVec a -&gt; Maybe a\nhead' (AVec Zy Nil) = Nothing\nhead' (AVec (Sy n) xs) = Just (head xs)\n</code></pre>\n\n<p>In this example, we only care whether the vector is longer than one, so pattern matching on <code>Sy</code> is enough to prove to GHC that we should be allowed to use <code>head</code>. (See <a href=\"https://softwareengineering.stackexchange.com/a/276916/103810\">a related answer of mine</a> for a more involved example of proving facts about <code>AVec</code>s.)</p>\n\n<hr>\n\n<p>@chi mentioned a tantalising idea: you might want to show that the vector returned by <code>takeWhile</code> is not longer than the input vector.</p>\n\n<pre><code>takeWhile :: (a -&gt; Bool) -&gt; Vec a n -&gt; AShorterVec a n\n</code></pre>\n\n<p>where <code>AShorterVec</code> is the type of vectors no longer than <code>n</code>. Our challenge is to write down the definition of <code>AShorterVec</code>.</p>\n\n<p>Given two natural numbers, how can you be sure that the first is less-than-or-equal to the second? The relation is inductive. If the left operand is zero, then it's less-than-or-equal to any natural number automatically. Otherwise, a number is less-than-or-equal to another if its predecessor is less-than-or-equal to the other's predecessor. We can encode that as a constructive proof using a GADT.</p>\n\n<pre><code>data LTE n m where\n    ZLte :: LTE Z m\n    SLte :: LTE n m -&gt; LTE (S n) (S m)\n</code></pre>\n\n<p>If <code>n</code> is less than <code>m</code>, you'll be able to come up with a value of <code>LTE n m</code>. If it's not, you can't. This is what the <a href=\"https://en.wikipedia.org/wiki/Curry%E2%80%93Howard_correspondence\" rel=\"nofollow noreferrer\">Curry-Howard isomorphism</a> is all about.</p>\n\n<p>Now we're ready to define <code>AShorterVec</code>: in order to construct a value of <code>AShorterVec a n</code> you need to be able to prove that it's shorter than <code>n</code> by supplying a value of <code>LTE m n</code>. When you pattern-match on the <code>AShorterVec</code> constructor, it gives you the proof back so you can compute with it.</p>\n\n<pre><code>data AShorterVec a n = forall m. AShorterVec (LTE m n) (Vec a m)\n</code></pre>\n\n<p><code>takeWhile</code> compiles with only a minor change: we have to manipulate this proof object.</p>\n\n<pre><code>takeWhile :: (a -&gt; Bool) -&gt; Vec a n -&gt; AShorterVec a n\ntakeWhile f Nil = AShorterVec ZLte Nil\ntakeWhile f (x :- xs) = case takeWhile f xs of\n                             AShorterVec prf ys -&gt; if f x\n                                                   then AShorterVec (SLte prf) (x :- ys)\n                                                   else AShorterVec ZLte Nil\n</code></pre>\n\n<hr>\n\n<p>An alternative way to give a type to <code>takeWhile</code> is to push the upper bound on the length into the return type itself, rather than carrying it around as data. This approach dispenses with any wranglings with <code>Natty</code>, proof terms like <code>LTE</code>, and existential quantifications.</p>\n\n<pre><code>data ShorterVec a n where\n    SNil :: ShorterVec a n\n    SCons :: a -&gt; ShorterVec a n -&gt; ShorterVec a (S n)\n</code></pre>\n\n<p>Once again, <code>ShorterVec a n</code> denotes the set of vectors no longer than <code>n</code>. The structure of <code>ShorterVec</code> is reminiscent of the <a href=\"https://hackage.haskell.org/package/data-fin-0.1.0/docs/Data-Number-Fin-Integer.html\" rel=\"nofollow noreferrer\">finite sets</a>, but translated from the world of naturals into the world of vectors. An empty vector is shorter than any length you care to name; a cons cell increases the smallest valid upper bound by one. Note that the value of <code>n</code> is never fully determined by a value of type <code>ShorterVec</code>, so you can give any valid upper bound to a <code>ShorterVec</code>. These two expressions are both well-typed:</p>\n\n<pre><code>ok1 = SCons 1 (SCons 3 SNil) :: ShorterVec Int (S (S (S Z)))\nok2 = SCons 1 (SCons 3 SNil) :: ShorterVec Int (S (S Z))\n</code></pre>\n\n<p>but this one is not:</p>\n\n<pre><code>-- notOk = SCons 1 (SCons 3 SNil) :: ShorterVec Int (S Z)  -- the vector is longer than our stated upper bound.\n</code></pre>\n\n<p>Using this datatype, you can write a beautifully simple version of <code>takeWhile</code> which looks exactly like the original list version:</p>\n\n<pre><code>takeWhile :: (a -&gt; Bool) -&gt; Vec a n -&gt; ShorterVec a n\ntakeWhile f Nil = SNil\ntakeWhile f (x :- xs) = if f x\n                        then SCons x (takeWhile f xs)\n                        else SNil\n</code></pre>\n\n<p>Relaxing our assumptions about the type has made the function simpler to implement, but you pay the cost of having another type which you need to convert to and from. You can translate from <code>ShorterVec</code> back into the version which used a dependent pair by measuring the length.</p>\n\n<pre><code>toAVec :: ShorterVec a n -&gt; AVec a\ntoAVec SNil = AVec Zy Nil\ntoAVec (SCons x xs) = case toAVec xs of\n                           AVec n ys -&gt; AVec (Sy n) (x :- ys)\n</code></pre>\n\n<hr>\n\n<p>We started out using singletons to tie types and values together, and existential types to wrap up runtime information about data with the data itself. Then, following @chi's idea, we encoded (one part of) the <em>correctness</em> of <code>takeWhile</code> into the type signature using a proof-term. Then we came up with a way to bake the length invariant into the return type directly, dispensing with the need to prove any theorems.</p>\n\n<p>Once you've got the taste of dependently-typed programming on your tongue, it's hard to go back to the old way. Expressive type systems give you at least three advantages: you can write valid programs which other languages would disallow (or force you to duplicate code); you can write more meaningful types for the same functions, making stronger promises; and you can prove the correctness of your programs in a machine-checkable way.</p>\n\n<p>Haskell's not set up for it, though. One problem is that singletons make binding types and values needlessly complex: the <code>Nat</code>-<code>Natty</code> distinction causes an explosion of boilerplate code, most of which I've spared you, to shuffle between the types and values. (Much of this boilerplate can be automated - that's what <a href=\"https://hackage.haskell.org/package/singletons\" rel=\"nofollow noreferrer\">the <code>singletons</code> library</a> gives you.) If we wanted to specify another aspect of the correctness of <code>takeWhile</code> - the fact that all of the output list's elements satisfy the predicate - we'd have to work exclusively with lists of singletons and type-level predicate functions. I also find it tedious to declare a new top-level type every time I want to quantify something existentially (you can write libraries to help with this, though they often result in other boilerplate) - we have the lack of type-level lambdas to thank for that. The other main difficulty is restrictions in what can be promoted to the type-level using <code>DataKinds</code>: GADTs and existential types can't be promoted, so for example you can't have a multi-dimensional array whose shape is expressed statically as a <code>Vec Nat n</code>.\nNo real dependently typed system makes dependent types this difficult to use!</p>\n"}], "owner": {"reputation": 1595, "user_id": 2913916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/478cf0ef7b6e6b5233eae232acf258d1?s=128&d=identicon&r=PG&f=1", "display_name": "Code Monkey", "link": "https://stackoverflow.com/users/2913916/code-monkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 2, "accepted_answer_id": 30962735, "answer_count": 2, "score": 5, "last_activity_date": 1456077761, "creation_date": 1434864474, "last_edit_date": 1434933118, "question_id": 30961556, "link": "https://stackoverflow.com/questions/30961556/how-can-i-express-the-type-of-takewhile-for-vectors", "title": "How can I express the type of &#39;takeWhile for vectors&#39;?", "body": "<p>Haskell beginner here. I've defined the following types:</p>\n\n<pre><code>data Nat = Z | S Nat\ndata Vector a n where\n    Nil :: Vector a Z\n    (:-) :: a -&gt; Vector a n -&gt; Vector a (S n)\ninfixl 5 :-\n</code></pre>\n\n<p>I'm trying to write the function, takeWhileVector which behaves the same as takeWhile does on lists, but on Vectors.</p>\n\n<p>My implementation is as follows:</p>\n\n<pre><code>takeWhileVector :: (a -&gt; Bool) -&gt; Vector a n -&gt; Vector a m\ntakeWhileVector f Nil = Nil\ntakeWhileVector f (x :- xs) = if (f x) then (x :- takeWhileVector f xs) else Nil\n</code></pre>\n\n<p>This doesn't compile and produces the following error:</p>\n\n<pre><code>Could not deduce (m ~ 'S n0)\nfrom the context (n ~ 'S n1)\n  bound by a pattern with constructor\n             :- :: forall a (n :: Nat). a -&gt; Vector a n -&gt; Vector a ('S n),\n           in an equation for \u2018takeWhileVector\u2019\n  at takeWhileVector.hs:69:20-26\n  \u2018m\u2019 is a rigid type variable bound by\n      the type signature for\n        takeWhileVector :: (a -&gt; Bool) -&gt; Vector a n -&gt; Vector a m\n      at takeWhileVector.hs:67:20\nExpected type: Vector a m\n  Actual type: Vector a ('S n0)\nRelevant bindings include\n  takeWhileVector :: (a -&gt; Bool) -&gt; Vector a n -&gt; Vector a m\n    (bound at takeWhileVector.hs:69:1)\nIn the expression: (x :- takeWhileVector f xs)\nIn an equation for \u2018takeWhileVector\u2019:\n    takeWhileVector f (x :- xs) = (x :- takeWhileVector f xs)\n</code></pre>\n\n<p>I would have thought that my type definition for takeWhileVector says the following:</p>\n\n<p>For all types 'a' and 'n's of kind Nat, this function returns a 'Vector a m', where 'm' is kind Nat.</p>\n\n<p>Do I need to change the type signature of takeWhileVector to be more specific so that it shows that the result is Vector a (m :: Nat)?\nOtherwise, how can I change this to have it compile?</p>\n"}, {"tags": ["haskell", "llvm", "ghc"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1434888629, "post_id": 30961498, "comment_id": 49960643, "body": "I don&#39;t understand how you didn&#39;t get a compile-time error (maybe your program is too trivial?) but GHC 7.10.* specifically needs LLVM 3.5.*, not an earlier or later version."}, {"owner": {"reputation": 171, "user_id": 4133743, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2ba4bd0c196057243f4fb27b8ed5792c?s=128&d=identicon&r=PG&f=1", "display_name": "Helix", "link": "https://stackoverflow.com/users/4133743/helix"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1436808180, "post_id": 30961498, "comment_id": 50755854, "body": "Hi. I tried that and it still does not work. Tested it out on a basic factorial function and I get the same error."}], "owner": {"reputation": 171, "user_id": 4133743, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2ba4bd0c196057243f4fb27b8ed5792c?s=128&d=identicon&r=PG&f=1", "display_name": "Helix", "link": "https://stackoverflow.com/users/4133743/helix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1434864142, "creation_date": 1434863693, "last_edit_date": 1434864142, "question_id": 30961498, "link": "https://stackoverflow.com/questions/30961498/llvm-compilation-not-working-with-haskell-on-yosemite", "title": "LLVM compilation not working with Haskell on Yosemite", "body": "<p>I'm trying to use llvm with haskell and I'm getting the error \"illegal hardware instruction\"</p>\n\n<p>Details:</p>\n\n<p>I'm compiling a simple hello world program just to test it out:</p>\n\n<p>Code:</p>\n\n<pre><code>module Main where\n\nmain :: IO ()\nmain = putStrLn \"Hello World\"\n</code></pre>\n\n<p>GHC version 7.10.1, llvm version 3.4.2 (older version because haskell doesn't work at all with 3.6.1). </p>\n\n<p>Command to compile: <code>ghc -O2 --make firstProgram.hs -fllvm -fforce-recomp</code></p>\n\n<p>Exact error with command <code>./firstProgram</code></p>\n\n<p><code>[1]    23665 illegal hardware instruction  ./firstProgram</code></p>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1434874140, "post_id": 30960668, "comment_id": 49957032, "body": "I&#39;m not sure to understand, but it seems you want to open a cursor in the DB, close the connection to the DB, and then continue fetching data from the cursor. If so, how could it possibly work?"}], "answers": [{"comments": [{"owner": {"reputation": 677, "user_id": 662716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7e09655fd68e038c553fd501c69a6161?s=128&d=identicon&r=PG", "display_name": "Victor Denisov", "link": "https://stackoverflow.com/users/662716/victor-denisov"}, "edited": false, "score": 0, "creation_date": 1434957190, "post_id": 30967025, "comment_id": 49979114, "body": "This helped. I originally solved it by putting putStrLn under db as well. Actually mongodb cursors exist even if we close the original connection. The issue turned out to be that when we receive a cursor it has a postponed IO action in it for reading the first batch. When I start draining the cursor it starts executing this action, but by the time I start executing the action the pipe is already closed. So, this behavior is an artifact of mongodb driver for Mongo. Thanks guys!!!"}], "tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": true, "score": 2, "last_activity_date": 1434905647, "creation_date": 1434905647, "answer_id": 30967025, "question_id": 30960668, "link": "https://stackoverflow.com/questions/30960668/haskell-closes-connection-before-reading-the-data/30967025#30967025", "title": "Haskell closes connection before reading the data", "body": "<p>To expand on @chi's comment, you probably want to replace</p>\n\n<pre><code>cur &lt;- db $ M.find $ (M.select [] \"bigCollection\")\n                     {M.limit = 100000, M.batchSize = 100000}\nreturnedDocs &lt;- db $ drainCursor cur\n</code></pre>\n\n<p>by</p>\n\n<pre><code>returnedDocs &lt;- db $ do\n    cur &lt;- M.find $ (M.select [] \"bigCollection\")\n                    {M.limit = 100000, M.batchSize = 100000}\n    drainCursor cur\n</code></pre>\n\n<p>I've never used mongoDB, but I'm quite sure that a database cursor is only usable within the connection in which it was created.</p>\n"}], "owner": {"reputation": 677, "user_id": 662716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7e09655fd68e038c553fd501c69a6161?s=128&d=identicon&r=PG", "display_name": "Victor Denisov", "link": "https://stackoverflow.com/users/662716/victor-denisov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 30967025, "answer_count": 1, "score": 0, "last_activity_date": 1434905647, "creation_date": 1434853127, "question_id": 30960668, "link": "https://stackoverflow.com/questions/30960668/haskell-closes-connection-before-reading-the-data", "title": "Haskell closes connection before reading the data", "body": "<p>I wrote the following program:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE BangPatterns #-}\nimport Control.Exception (bracket)\nimport Control.Monad (forM)\nimport Control.Monad.IO.Class (MonadIO(liftIO))\nimport Data.List.Split (chunksOf)\nimport qualified Database.MongoDB as M\n\nimport qualified Data.Text as T\n\ndb :: M.Action IO a -&gt; IO a\ndb action = do\n    pipe &lt;- M.connect (M.host \"127.0.0.1\")\n    res &lt;- M.access pipe M.master \"haskell\" action\n    M.close pipe\n    return res\n\nmain = do\n    let docs = (flip map) [0..199999] $ \\i -&gt;\n            [\"name\" M.=: (T.pack $ \"name \" ++ (show i))]\n    ids &lt;- forM (chunksOf 50000 docs) $ \\chunk -&gt;\n      db $ M.insertAll \"bigCollection\" chunk\n\n    cur &lt;- db $ M.find $ (M.select [] \"bigCollection\") {M.limit = 100000, M.batchSize = 100000}\n    returnedDocs &lt;- db $ drainCursor cur\n\n    putStrLn $ show $ length returnedDocs\n\ndrainCursor :: M.Cursor -&gt; M.Action IO [M.Document]\ndrainCursor !cur = drainCursor' cur []\n  where\n    drainCursor' cur res  = do\n      batch &lt;- M.nextBatch cur\n      if null batch\n        then return res\n        else drainCursor' cur (res ++ batch)\n</code></pre>\n\n<p>After it inserts all the data it becomes stuck on waiting data from the server. I presume it happens because it closes the connection before reading the data. I tried BangPatterns and seq function, bracket function, but no success. It works only if I keep the connection open(by commenting out M.close). Can someone recommend how I can circumvent this situation?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["haskell", "ghc", "cabal"], "comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 1, "creation_date": 1434856656, "post_id": 30960465, "comment_id": 49954232, "body": "I think that means that your version of cabal is too old for GHC 7.10."}, {"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 1, "creation_date": 1434876880, "post_id": 30960465, "comment_id": 49957662, "body": "Try to <code>cabal install cabal-install</code> and then make sure new version is on the path. You can check version of <code>cabal</code> this way: <code>cabal --version</code>."}, {"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 0, "creation_date": 1434876943, "post_id": 30960465, "comment_id": 49957684, "body": "Don&#39;t forget to refresh package list <code>cabal update</code>."}, {"owner": {"reputation": 375, "user_id": 4232796, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/42912716b8f59e0f6cfd0cbbe6a74bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle McKean", "link": "https://stackoverflow.com/users/4232796/kyle-mckean"}, "edited": false, "score": 1, "creation_date": 1434905772, "post_id": 30960465, "comment_id": 49965521, "body": "I thought this was the error as well but I cant update my cabal because when I run <code>cabal install cabal-install</code> I get the same error as above"}, {"owner": {"reputation": 15004, "user_id": 562906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a15f15ed0023f4177a518b6c15ca4b6?s=128&d=identicon&r=PG", "display_name": "sinelaw", "link": "https://stackoverflow.com/users/562906/sinelaw"}, "edited": false, "score": 0, "creation_date": 1434967663, "post_id": 30960465, "comment_id": 49984911, "body": "Try to move/delete ~/.cabal and ~/.ghc, then run again <code>cabal install cabal-install</code>"}, {"owner": {"reputation": 375, "user_id": 4232796, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/42912716b8f59e0f6cfd0cbbe6a74bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle McKean", "link": "https://stackoverflow.com/users/4232796/kyle-mckean"}, "edited": false, "score": 0, "creation_date": 1434979605, "post_id": 30960465, "comment_id": 49992656, "body": "Tried that same error. Here is the full error report: <a href=\"http://pastebin.com/8kwRgy6s\" rel=\"nofollow noreferrer\">pastebin.com/8kwRgy6s</a>"}, {"owner": {"reputation": 15004, "user_id": 562906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a15f15ed0023f4177a518b6c15ca4b6?s=128&d=identicon&r=PG", "display_name": "sinelaw", "link": "https://stackoverflow.com/users/562906/sinelaw"}, "edited": false, "score": 0, "creation_date": 1434982839, "post_id": 30960465, "comment_id": 49994917, "body": "What&#39;s your cabal version? <code>cabal --version</code>"}, {"owner": {"reputation": 15004, "user_id": 562906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a15f15ed0023f4177a518b6c15ca4b6?s=128&d=identicon&r=PG", "display_name": "sinelaw", "link": "https://stackoverflow.com/users/562906/sinelaw"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1434990861, "post_id": 30960465, "comment_id": 50000524, "body": "As @MichaelSnoyman said, apparently your cabal version is too old to even build the new cabal-install. Upgrade it to &gt;= 1.22"}, {"owner": {"reputation": 375, "user_id": 4232796, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/42912716b8f59e0f6cfd0cbbe6a74bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle McKean", "link": "https://stackoverflow.com/users/4232796/kyle-mckean"}, "edited": false, "score": 0, "creation_date": 1434992836, "post_id": 30960465, "comment_id": 50001713, "body": "when i try to install &gt;= 1.22 it runs into an error where my ghc base is too advanced. <a href=\"http://pastebin.com/wVi50tMk\" rel=\"nofollow noreferrer\">pastebin.com/wVi50tMk</a>"}], "answers": [{"tags": [], "owner": {"reputation": 45036, "user_id": 20774, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3e32e31d4c24c1558abd6567f2ab60ba?s=128&d=identicon&r=PG", "display_name": "James McMahon", "link": "https://stackoverflow.com/users/20774/james-mcmahon"}, "is_accepted": false, "score": 0, "last_activity_date": 1436840183, "creation_date": 1436840183, "answer_id": 31396534, "question_id": 30960465, "link": "https://stackoverflow.com/questions/30960465/cabal-install-and-ghc-7-10-1/31396534#31396534", "title": "cabal-install and ghc 7.10.1", "body": "<p>If you are on Mac OS X and are using homebrew it may be that you installed Cabal through <code>haskell-platform</code> package, which is outdated with no direct upgrade path.</p>\n\n<p>You should uninstall <code>haskell-platform</code> and reinstall Cabal using the <code>cabal-install</code> package.</p>\n"}, {"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1457341361, "creation_date": 1457341361, "answer_id": 35839722, "question_id": 30960465, "link": "https://stackoverflow.com/questions/30960465/cabal-install-and-ghc-7-10-1/35839722#35839722", "title": "cabal-install and ghc 7.10.1", "body": "<p>It could well be you have a newer cabal on your path but can't find it because the old one shadows it. So looking for <code>where cabal</code> may help you resolve that. Barring that, you can download a newer cabal binary from the <a href=\"https://www.haskell.org/cabal/download.html\" rel=\"nofollow\">cabal homepage</a>.</p>\n"}], "owner": {"reputation": 375, "user_id": 4232796, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/42912716b8f59e0f6cfd0cbbe6a74bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle McKean", "link": "https://stackoverflow.com/users/4232796/kyle-mckean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 311, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1457341361, "creation_date": 1434850269, "last_edit_date": 1434967606, "question_id": 30960465, "link": "https://stackoverflow.com/questions/30960465/cabal-install-and-ghc-7-10-1", "title": "cabal-install and ghc 7.10.1", "body": "<p>I just upgraded to ghc 7.10.1 and whenever I try use cabal-install I run into the following error: </p>\n\n<blockquote>\n  <p>ghc: ghc no longer supports single-file style package databases (dist/package.conf.inplace) use 'ghc-pkg init' to create the database with the correct format.</p>\n</blockquote>\n\n<p>How do I fix this?</p>\n"}, {"tags": ["haskell", "lazy-evaluation", "termination"], "comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1434842474, "post_id": 30959741, "comment_id": 49952310, "body": "Your function is lazy, it&#39;s not short-circuited."}, {"owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 10, "creation_date": 1434842613, "post_id": 30959741, "comment_id": 49952343, "body": "&quot;lazy&quot; doesn&#39;t mean &quot;does as little work as possible&quot;. It means &quot;values are not computed until they&#39;re needed&quot;."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 2, "creation_date": 1434842668, "post_id": 30959741, "comment_id": 49952358, "body": "... and they&#39;re needed to be sure that the first case doesn&#39;t match."}, {"owner": {"reputation": 356, "user_id": 4603642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7021dfac2c4ee2d4ec3de779860d5216?s=128&d=identicon&r=PG", "display_name": "Kiuhnm", "link": "https://stackoverflow.com/users/4603642/kiuhnm"}, "reply_to_user": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1434845173, "post_id": 30959741, "comment_id": 49952741, "body": "@rampion But you don&#39;t need to be sure that the first case doesn&#39;t match. That&#39;s the point."}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 4, "creation_date": 1434845253, "post_id": 30959741, "comment_id": 49952753, "body": "Think of the two arguments as &quot;mystery boxes&quot;. The only way Haskell can find out if one of them contains <code>False</code> is by opening the box, or evaluating the arguments. It can&#39;t possibly &quot;guess&quot; which order to do this in!"}, {"owner": {"reputation": 356, "user_id": 4603642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7021dfac2c4ee2d4ec3de779860d5216?s=128&d=identicon&r=PG", "display_name": "Kiuhnm", "link": "https://stackoverflow.com/users/4603642/kiuhnm"}, "edited": false, "score": 0, "creation_date": 1434845255, "post_id": 30959741, "comment_id": 49952754, "body": "@Memphy I don&#39;t think the adjective &quot;short-circuited&quot; makes sense with pure functions."}, {"owner": {"reputation": 356, "user_id": 4603642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7021dfac2c4ee2d4ec3de779860d5216?s=128&d=identicon&r=PG", "display_name": "Kiuhnm", "link": "https://stackoverflow.com/users/4603642/kiuhnm"}, "reply_to_user": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 0, "creation_date": 1434845599, "post_id": 30959741, "comment_id": 49952819, "body": "@Mauris. Yes, it can. All adjacent definitions with the same rhs can be examined in any order. That&#39;s how I know that that expression evaluates to False."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 1, "creation_date": 1434845968, "post_id": 30959741, "comment_id": 49952881, "body": "Kiuhnm: operationally, Haskell is defined as needing to check definitions in order."}, {"owner": {"reputation": 356, "user_id": 4603642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7021dfac2c4ee2d4ec3de779860d5216?s=128&d=identicon&r=PG", "display_name": "Kiuhnm", "link": "https://stackoverflow.com/users/4603642/kiuhnm"}, "reply_to_user": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1434846595, "post_id": 30959741, "comment_id": 49952986, "body": "@rampion I know, but that&#39;s not very smart (and lazy). Imagine that instead of non_term we use long_computation. Haskell would compute the correct result but would do a lot of superfluous computations easily avoidable."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1434850519, "post_id": 30959741, "comment_id": 49953486, "body": "@Kiuhnm There are plenty of cases where you <i>want</i> the patterns to be matched in a certain order and it would be ambiguous otherwise. Probably the majority of the time, in fact."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 6, "creation_date": 1434851881, "post_id": 30959741, "comment_id": 49953627, "body": "You should look into <code>unamb</code>, a parallel computation operator that says &quot;run these two computations and use the result of the first one to terminate without an error.&quot; But basically, lazy evaluation is a specific evaluation strategy-there are others that may be better for your purposes."}, {"owner": {"reputation": 356, "user_id": 4603642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7021dfac2c4ee2d4ec3de779860d5216?s=128&d=identicon&r=PG", "display_name": "Kiuhnm", "link": "https://stackoverflow.com/users/4603642/kiuhnm"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1434886066, "post_id": 30959741, "comment_id": 49959937, "body": "@DavidYoung The extension I proposed doesn&#39;t introduce any ambiguity."}, {"owner": {"reputation": 1426, "user_id": 417377, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1aa2c99d2089ac6753753db614b2ff1a?s=128&d=identicon&r=PG", "display_name": "Martin Capodici", "link": "https://stackoverflow.com/users/417377/martin-capodici"}, "edited": false, "score": 0, "creation_date": 1434938089, "post_id": 30959741, "comment_id": 49973684, "body": "When you say &quot;it is clear that the result is False&quot; you have a birds-eye view that the compiler doesn&#39;t have. You can see that the expression is a constant, however the compiler must treat it like a black box expression. It has no idea which of the two (if any) is an infinite loop. So the best you can do is pick one (left or right) to evaluate first, and if you are lucky you picked the one which isn&#39;t an infinite loop."}, {"owner": {"reputation": 356, "user_id": 4603642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7021dfac2c4ee2d4ec3de779860d5216?s=128&d=identicon&r=PG", "display_name": "Kiuhnm", "link": "https://stackoverflow.com/users/4603642/kiuhnm"}, "reply_to_user": {"reputation": 1426, "user_id": 417377, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1aa2c99d2089ac6753753db614b2ff1a?s=128&d=identicon&r=PG", "display_name": "Martin Capodici", "link": "https://stackoverflow.com/users/417377/martin-capodici"}, "edited": false, "score": 0, "creation_date": 1435319255, "post_id": 30959741, "comment_id": 50163387, "body": "@MartinCapodici As I said again and again, &quot;all adjacent definitions with the same rhs can be examined in any order&quot;. It&#39;s easy to extend Haskell this way. It&#39;s clear to me that Haskell doesn&#39;t do this, but the point is that it could and maybe it should."}, {"owner": {"reputation": 356, "user_id": 4603642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7021dfac2c4ee2d4ec3de779860d5216?s=128&d=identicon&r=PG", "display_name": "Kiuhnm", "link": "https://stackoverflow.com/users/4603642/kiuhnm"}, "reply_to_user": {"reputation": 1426, "user_id": 417377, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1aa2c99d2089ac6753753db614b2ff1a?s=128&d=identicon&r=PG", "display_name": "Martin Capodici", "link": "https://stackoverflow.com/users/417377/martin-capodici"}, "edited": false, "score": 0, "creation_date": 1435324120, "post_id": 30959741, "comment_id": 50166621, "body": "@MartinCapodici A better way would be to tell Haskell explicitly that some definitions must be considered in a round-robin way. Haskell would try to match the first def and give up after just one substitution. Then Haskell would move to the next def. and so on. Then the first def would be considered again. This can be seen as a sort of cooperative multi-tasking. Actually, it&#39;s not so different from <code>unamb</code>..."}, {"owner": {"reputation": 1426, "user_id": 417377, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1aa2c99d2089ac6753753db614b2ff1a?s=128&d=identicon&r=PG", "display_name": "Martin Capodici", "link": "https://stackoverflow.com/users/417377/martin-capodici"}, "edited": false, "score": 0, "creation_date": 1435432611, "post_id": 30959741, "comment_id": 50201563, "body": "Round robin would work. However there is probably a performance trade off there. Question to ask is whether things like TCO would still work. Also will have different behaviour for bottom values. E.g. one of the functions eventually throws an error. How quickly or slowly it does that affects the behaviour of the resulting function."}], "answers": [{"comments": [{"owner": {"reputation": 356, "user_id": 4603642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7021dfac2c4ee2d4ec3de779860d5216?s=128&d=identicon&r=PG", "display_name": "Kiuhnm", "link": "https://stackoverflow.com/users/4603642/kiuhnm"}, "edited": false, "score": 1, "creation_date": 1434847661, "post_id": 30959888, "comment_id": 49953145, "body": "If I understand this correctly, that works only with very specific nonTerm expressions. Therefore, the answer to my question is a resounding NO."}, {"owner": {"reputation": 3116, "user_id": 353187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfdc97f71e1b8c257ae1bbd52989785d?s=128&d=identicon&r=PG", "display_name": "xnyhps", "link": "https://stackoverflow.com/users/353187/xnyhps"}, "edited": false, "score": 1, "creation_date": 1434881644, "post_id": 30959888, "comment_id": 49958825, "body": "With the <code>unamb</code> code, <code>und False (non_term 1)</code> still does not terminate for me in ghci. I suspect because <code>non_term 1</code> is running in a thread that&#39;s locking out the thread that tries to kill it: <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/base/Control-Concurrent.html#g:13\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/latest/docs/html/libraries/base/&hellip;</a>"}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": true, "score": 6, "last_activity_date": 1434853787, "last_edit_date": 1495539828, "creation_date": 1434843241, "answer_id": 30959888, "question_id": 30959741, "link": "https://stackoverflow.com/questions/30959741/haskell-and-laziness/30959888#30959888", "title": "Haskell and laziness", "body": "<p>You can write a complete definition for <code>und</code> that will work on non-terminating expressions... sort of</p>\n\n<p>To make this work, you need your own definition of <code>Bool</code> that makes explicit the delay in any computation:</p>\n\n<pre><code>import Prelude hiding (Bool(..))\ndata Bool = True | False | Delay Bool\n  deriving (Show, Eq)\n</code></pre>\n\n<p>Then whenever you define a value of type <code>Bool</code>, you have to constrain yourself to co-recursion, where the delays are \nmade explicit with the <code>Delay</code> constructor, rather than via recursion, where you have to evaluate a sub-expression\nto find the constructor for the top-level return value.</p>\n\n<p>In this world, a non-terminating value could look like:</p>\n\n<pre><code>nonTerm :: Bool\nnonTerm = Delay nonTerm\n</code></pre>\n\n<p>Then <code>und</code> becomes:</p>\n\n<pre><code>und :: Bool -&gt; Bool -&gt; Bool\nund False y = False\nund x False = False\nund True y  = y\nund x True  = x\nund (Delay x) (Delay y) = Delay $ und x y\n</code></pre>\n\n<p>which works just fine:</p>\n\n<pre><code>\u03bb und True False\nFalse\n\u03bb und False nonTerm\nFalse\n\u03bb und nonTerm False\nFalse\n\u03bb case und nonTerm nonTerm of Delay _ -&gt; \"delayed\" ; _ -&gt; \"not delayed\"\n\"delayed\"\n</code></pre>\n\n<hr>\n\n<p>Following up on <a href=\"https://stackoverflow.com/questions/30959741/haskell-and-laziness/30959888#comment49953627_30959741\">dfeuer's comment</a>, it looks like what you're looking for can be done with <a href=\"http://hackage.haskell.org/package/unamb-0.2.5/docs/Data-Unamb.html#v:unamb\" rel=\"nofollow noreferrer\"><code>unamb</code></a></p>\n\n<pre><code>\u03bb :m +Data.Unamb \n\u03bb let undL False _ = False ; undL _ a = a\n\u03bb let undR _ False = False ; undR a _ = a\n\u03bb let und a b = undL a b `unamb` undR a b\n\u03bb und True False\nFalse\n\u03bb und False False\nFalse\n\u03bb und False True\nFalse\n\u03bb und True True\nTrue\n\u03bb und undefined False\nFalse\n\u03bb und False undefined\nFalse\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 356, "user_id": 4603642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7021dfac2c4ee2d4ec3de779860d5216?s=128&d=identicon&r=PG", "display_name": "Kiuhnm", "link": "https://stackoverflow.com/users/4603642/kiuhnm"}, "edited": false, "score": 0, "creation_date": 1434885856, "post_id": 30961605, "comment_id": 49959883, "body": "&quot;However, computers must always have an order of evaluation.&quot; If I can do it, a computer can too. As I already said, Haskell could examine all adjacent definitions with the same RHS for an easy match and then, if necessary, proceed as usual."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 356, "user_id": 4603642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7021dfac2c4ee2d4ec3de779860d5216?s=128&d=identicon&r=PG", "display_name": "Kiuhnm", "link": "https://stackoverflow.com/users/4603642/kiuhnm"}, "edited": false, "score": 1, "creation_date": 1434986559, "post_id": 30961605, "comment_id": 49997736, "body": "@Kiuhnm, define &quot;easy&quot;. If I replace <code>False</code> in the RHS of the second equation with <code>not True</code>, is it still an &quot;easy match&quot;? If not, then I can no longer replace equals by equals without changing the meaning of the program. I think you will find it difficult to define a language with well-defined, deterministic semantics including general recursion which accepts functions like the one you want to write. In any case, Haskell is not that language and a compiler which performs the evaluations you suggest is not a correct Haskell compiler."}, {"owner": {"reputation": 356, "user_id": 4603642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7021dfac2c4ee2d4ec3de779860d5216?s=128&d=identicon&r=PG", "display_name": "Kiuhnm", "link": "https://stackoverflow.com/users/4603642/kiuhnm"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1435323476, "post_id": 30961605, "comment_id": 50166199, "body": "@ReidBarton I meant an easy match on the LHS. Anyway, we must define what it means for the RHS to be equal. We may explicitly tell Haskell that some definitions can be considered in any order. Haskell will try to match the definitions in a round-robin way by giving up each time after just one substitution. This should work."}], "tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": false, "score": 4, "last_activity_date": 1434865044, "creation_date": 1434865044, "answer_id": 30961605, "question_id": 30959741, "link": "https://stackoverflow.com/questions/30959741/haskell-and-laziness/30961605#30961605", "title": "Haskell and laziness", "body": "<p>Haskell is indeed lazy. Laziness means that an expression is not evaluated unless required. However, laziness doesn't mean that two expressions can be evaluated in an arbitrary order. The order of evaluation of expressions in Haskell matters. For example, consider your <code>und</code> function:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>und :: Bool -&gt; Bool -&gt; Bool\nund False y = False\nund y False = False\n</code></pre>\n\n<p>First, I would like to note that this function is incomplete. The complete function is:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>und :: Bool -&gt; Bool -&gt; Bool\nund False y = False\nund y False = False\nund y True  = True          -- you forgot this case\n</code></pre>\n\n<p>In fact, the <code>und</code> function can be written more succinctly (and more lazily) as follows:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- if the first argument is False then the result is False\n-- otherwise the result is the second argument\n-- note that the second argument is never inspected\n\nund :: Bool -&gt; Bool -&gt; Bool\nund False _ = False\nund _     x = x\n</code></pre>\n\n<p>Anyway, the pattern matching syntax in Haskell is just syntactic sugar for <code>case</code> expressions. For example, your original (incomplete) function would be desugared to (up to alpha equivalence):</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>und :: Bool -&gt; Bool -&gt; Bool\nund x y = case x of False -&gt; False\n                    True  -&gt; case y of False -&gt; False\n                                       True  -&gt; undefined\n</code></pre>\n\n<p>From this we can see:</p>\n\n<ol>\n<li>Your function is incomplete because the last case is <code>undefined</code>.</li>\n<li>Your function evaluates the second argument if the first argument is <code>True</code> even though it doesn't need to. Remember that <code>case</code> expressions always force the evaluation of the expression being inspected.</li>\n<li>Your function first inspects <code>x</code> and then inspects <code>y</code> if <code>x</code> evaluates to <code>True</code>. Hence, there is indeed an explicit order of evaluation here. Note that if <code>x</code> evaluates to <code>False</code> then <code>y</code> is never evaluated (proof that <code>und</code> is indeed lazy).</li>\n</ol>\n\n<p>It is because of this ordering of evaluation that your expression <code>und (non_term 1) False</code> diverges:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>  und (non_term 1) False\n= case non_term 1 of False -&gt; False\n                     True  -&gt; case False of False -&gt; False\n                                            True  -&gt; undefined\n= case non_term 2 of False -&gt; False\n                     True  -&gt; case False of False -&gt; False\n                                            True  -&gt; undefined\n= case non_term 3 of False -&gt; False\n                     True  -&gt; case False of False -&gt; False\n                                            True  -&gt; undefined\n                .\n                .\n                .\n                .\n</code></pre>\n\n<p>If you want, you can create a function which has a different order of evaluation:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>und :: Bool -&gt; Bool -&gt; Bool\nund x y = case y of False -&gt; False\n                    True  -&gt; x     -- note that x is never inspected\n</code></pre>\n\n<p>Now, the expression <code>und (non_term 1) False</code> evaluates to <code>False</code>. However, the expression <code>und False (non_term 1)</code> still diverges. So, your main question is:</p>\n\n<blockquote>\n  <p>Is there a way to implement <code>und</code> (i.e. <code>and</code> in German) <em>correctly</em> (not just partially as above) so that both</p>\n\n<pre><code>und (non_term 1) False\n</code></pre>\n  \n  <p>and</p>\n\n<pre><code>und False (non_term 1)\n</code></pre>\n  \n  <p>return False?</p>\n</blockquote>\n\n<p>The short answer is no. You always need a specific order of evaluation; and depending upon the order of evaluation either <code>und (non_term 1) False</code> or <code>und False (non_term 1)</code> will diverge.</p>\n\n<p>Does this mean that Haskell is wrong/faulty? No. Haskell does the right thing and simply doesn't produce any answer. To a human (who can evaluate both expressions in parallel) it would seem apparent that the result of <code>und (non_term 1) False</code> must be <code>False</code>. However, computers must always have an order of evaluation.</p>\n\n<p>So, what is the actual problem? In my humble opinion the actual problem is either/or:</p>\n\n<ol>\n<li><p>Parallel evaluation. Haskell should evaluate the expression both ways in parallel and choose the one that terminates first:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Unamb (unamb)\n\ntype Endo a = a -&gt; a\n\nbidirectional :: Endo (a -&gt; a -&gt; b)\nbidirectional = unamb &lt;*&gt; flip\n\nund :: Bool -&gt; Bool -&gt; Bool\nund = bidirectional (&amp;&amp;)\n</code></pre></li>\n<li><p>General recursion. In my humble opinion, general recursion is too powerful for most use cases: it allows you to write absurd functions like <code>non_term x = non_term (x + 1)</code>. Such functions are quite useless. If we don't consider such useless functions as inputs then your original <code>und</code> function is a perfectly good function to use (just implement the last case or use <code>&amp;&amp;</code>).</p></li>\n</ol>\n\n<p>Hope that helps.</p>\n"}, {"comments": [{"owner": {"reputation": 356, "user_id": 4603642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7021dfac2c4ee2d4ec3de779860d5216?s=128&d=identicon&r=PG", "display_name": "Kiuhnm", "link": "https://stackoverflow.com/users/4603642/kiuhnm"}, "edited": false, "score": 0, "creation_date": 1434886377, "post_id": 30962621, "comment_id": 49960018, "body": "I upvoted your answer because I appreciate the theoretical explanation but I chose the other answer because he provides an implementation."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 9, "last_activity_date": 1434897008, "last_edit_date": 1434897008, "creation_date": 1434875260, "answer_id": 30962621, "question_id": 30959741, "link": "https://stackoverflow.com/questions/30959741/haskell-and-laziness/30962621#30962621", "title": "Haskell and laziness", "body": "<blockquote>\n  <p>Is there a way to implement und (i.e. and in German) correctly (not\n  just partially as above) so that both</p>\n\n<pre><code>und (non_term 1) False\n</code></pre>\n  \n  <p>and</p>\n\n<pre><code>und False (non_term 1)\n</code></pre>\n  \n  <p>return False?</p>\n</blockquote>\n\n<p>If you're interested in theory, there's a classic theoretical result that states that the function above is <em>impossible</em> in the lazy lambda calculus with recursion (which is called PCF). This was due to Plotkin in 1977. You can find a discussion in the <a href=\"http://www.cl.cam.ac.uk/~gw104/dens.pdf\" rel=\"nofollow\">Winskel's notes on denotational demantics</a> in Chapter 8 \"Full Abstraction\".</p>\n\n<p>Even if the proof is more involved, the key idea here is that the lambda calculus is a <em>sequential</em>, deterministic language. As such, once a lazy binary function is fed two boolean values (possibly bottom ones), it needs to decide which one to evaluate before the other, hence fixing an evaluation order. This will break the symmetry of <code>or</code> and <code>and</code>, since if the chosen argument diverges then the <code>or</code>/<code>and</code> will also diverge.</p>\n\n<p>As others mentioned, in Haskell, there's a library defining <code>unamb</code> through non sequential means, i.e. exploiting some concurrency underneath, hence going outside the power of PCF. With that you can define your parallel <code>or</code> or <code>and</code>.</p>\n"}], "owner": {"reputation": 356, "user_id": 4603642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7021dfac2c4ee2d4ec3de779860d5216?s=128&d=identicon&r=PG", "display_name": "Kiuhnm", "link": "https://stackoverflow.com/users/4603642/kiuhnm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 460, "favorite_count": 0, "accepted_answer_id": 30959888, "answer_count": 3, "score": 6, "last_activity_date": 1434897008, "creation_date": 1434841800, "last_edit_date": 1434842023, "question_id": 30959741, "link": "https://stackoverflow.com/questions/30959741/haskell-and-laziness", "title": "Haskell and laziness", "body": "<p>I've just started to learn Haskell and I was told that Haskell is lazy, i.e. it does as little work as possible in evaluating expressions, but I don't think that's true.</p>\n\n<p>Consider this:</p>\n\n<pre><code>und :: Bool -&gt; Bool -&gt; Bool\nund False y = False\nund y False = False\n\nnon_term x = non_term (x+1)\n</code></pre>\n\n<p>The evaluation of <code>und (non_term 1) False</code> never terminates, but it's clear that the result if False.</p>\n\n<p>Is there a way to implement <code>und</code> (i.e. <code>and</code> in German) <em>correctly</em> (not just partially as above) so that both</p>\n\n<pre><code>und (non_term 1) False\n</code></pre>\n\n<p>and</p>\n\n<pre><code>und False (non_term 1)\n</code></pre>\n\n<p>return False?</p>\n"}, {"tags": ["haskell", "halting-problem"], "comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 10, "creation_date": 1434835745, "post_id": 30959054, "comment_id": 49950830, "body": "A program may enter an infinite loop, not returning either <code>()</code> nor <code>undefined</code>. Then your <code>isUndefined</code> function also enter an infinite loop, not giving any meaningful result, thus it doesn&#39;t answer the halting problem. Remember the halting problem receives a program (function, Turing machine, procedure, whatever) as input, not data."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 1, "creation_date": 1434896876, "post_id": 30959054, "comment_id": 49962874, "body": "Do you mean you solve the halting problem by running a program and wait until it halts ????"}], "answers": [{"comments": [{"owner": {"reputation": 211, "user_id": 3525132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6c3c589bdbd531ca5651f29149eef1ce?s=128&d=identicon&r=PG&f=1", "display_name": "Brrch", "link": "https://stackoverflow.com/users/3525132/brrch"}, "edited": false, "score": 0, "creation_date": 1434897120, "post_id": 30959086, "comment_id": 49962938, "body": "Is unsafe* really the one to blame? Try can print as a result whether the program given halts or not. I thought exceptions should not be caught at all."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 211, "user_id": 3525132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6c3c589bdbd531ca5651f29149eef1ce?s=128&d=identicon&r=PG&f=1", "display_name": "Brrch", "link": "https://stackoverflow.com/users/3525132/brrch"}, "edited": false, "score": 0, "creation_date": 1434897487, "post_id": 30959086, "comment_id": 49963053, "body": "@Brrch Exception catching can only be done in the IO monad, which in acts also acts as a &quot;sin-bin&quot;, collecting most of the warts. Indeed, exceptions are not a terribly elegant mechanism, IMHO, but since their use is limited to the IO monad, it does not break any important properties in the pure (IO-free) part."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 8, "last_activity_date": 1434836292, "last_edit_date": 1434836292, "creation_date": 1434835750, "answer_id": 30959086, "question_id": 30959054, "link": "https://stackoverflow.com/questions/30959054/try-can-decide-when-a-program-halts/30959086#30959086", "title": "&#39;try&#39; can decide when a program halts", "body": "<blockquote>\n  <p>Is Control.Exception.try really breaking things here?</p>\n</blockquote>\n\n<p><code>unsafePerformIO</code> is breaking things here. In GHC, <code>undefined</code> simply raises an exception rather than looping forever (which would be unhelpful). Exceptions are not meant to be caught in pure (non-IO) code -- indeed the type system indeed prevents you to attempt as much. </p>\n\n<p>By using <code>unsafe*</code> functions, you are telling GHC \"ignore everything, I know what I'm doing\", and all the safety belts are now off. Do yourself a favour and pretend that <code>unsafe*</code> stuff does not exist.</p>\n"}], "owner": {"reputation": 211, "user_id": 3525132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6c3c589bdbd531ca5651f29149eef1ce?s=128&d=identicon&r=PG&f=1", "display_name": "Brrch", "link": "https://stackoverflow.com/users/3525132/brrch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 30959086, "answer_count": 1, "score": 2, "last_activity_date": 1434894542, "creation_date": 1434835472, "last_edit_date": 1434894542, "question_id": 30959054, "link": "https://stackoverflow.com/questions/30959054/try-can-decide-when-a-program-halts", "title": "&#39;try&#39; can decide when a program halts", "body": "<p>I have this function:</p>\n\n<pre><code>isUndefined :: () -&gt; Bool    \nisUndefined x = case unsafePerformIO $ (try (return $! x) :: IO (Either SomeException ())) of\n                    Left _ -&gt; True\n                    Right _ -&gt; False\n</code></pre>\n\n<p>then:</p>\n\n<pre><code>isUndefined () = False\nisUndefined undefined = True\n</code></pre>\n\n<p>Solving the halting problem. Of course, this can be extended to other types too.</p>\n\n<p>My question: how is this possible? Is <code>Control.Exception.try</code> really breaking things here?</p>\n"}, {"tags": ["haskell", "statistics", "gsl"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 4910114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420218ded8135c3a75e5b38b4f06e17c?s=128&d=identicon&r=PG&f=1", "display_name": "abourbaki", "link": "https://stackoverflow.com/users/4910114/abourbaki"}, "edited": false, "score": 0, "creation_date": 1434892869, "post_id": 30959420, "comment_id": 49961731, "body": "Thank you : ) From what I understand, this produce the pdf, but not the cdf... Or am I wrong?"}], "tags": [], "owner": {"reputation": 1003, "user_id": 218307, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71349c1b606c549215197f7ec55e2276?s=128&d=identicon&r=PG", "display_name": "jhickner", "link": "https://stackoverflow.com/users/218307/jhickner"}, "is_accepted": false, "score": 1, "last_activity_date": 1434838794, "creation_date": 1434838794, "answer_id": 30959420, "question_id": 30958975, "link": "https://stackoverflow.com/questions/30958975/normal-probability-density-function-gsl-equivalent-in-haskell/30959420#30959420", "title": "Normal probability density function - GSL equivalent in Haskell", "body": "<p>I think the <code>statistics</code> package can do what you want. Take a look <a href=\"https://hackage.haskell.org/package/statistics-0.13.2.3/docs/Statistics-Distribution.html\" rel=\"nofollow\">here</a> for what you can do with a distribution (pdf, etc.) </p>\n\n<p>The <code>ContGen</code> instance should get you random numbers drawn from the distribution. </p>\n\n<p>The normal distribution is <a href=\"https://hackage.haskell.org/package/statistics-0.13.2.3/docs/Statistics-Distribution-Normal.html\" rel=\"nofollow\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 2332, "user_id": 615030, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Yd1uW.png?s=128&g=1", "display_name": "Artyom", "link": "https://stackoverflow.com/users/615030/artyom"}, "is_accepted": true, "score": 2, "last_activity_date": 1434916160, "creation_date": 1434916160, "answer_id": 30968678, "question_id": 30958975, "link": "https://stackoverflow.com/questions/30958975/normal-probability-density-function-gsl-equivalent-in-haskell/30968678#30968678", "title": "Normal probability density function - GSL equivalent in Haskell", "body": "<p>Here's an example which uses <a href=\"http://hackage.haskell.org/package/random-fu\" rel=\"nofollow\">random-fu</a>:</p>\n\n<pre><code>import Data.Random    -- for randomness\nimport Text.Printf    -- for printf\nimport Data.Foldable  -- for the for_ loop\n\n-- pdf and cdf are basically \u201cDistribution -&gt; Double -&gt; Double\u201d\n\nmain = do\n  -- defining normal distribution with mean = 10 and variation = 2\n  let normal = Normal (10 :: Double) 2\n  -- CDF\n  for_ [0..10] $ \\i -&gt;\n    printf \"cdf(%2d): %.4f\\n\" i (cdf normal (fromInteger i))\n  -- PDF\n  putStrLn \"---\"\n  for_ [0..10] $ \\i -&gt;\n    printf \"pdf(%2d): %.4f\\n\" i (pdf normal (fromInteger i))\n</code></pre>\n\n<p>Run it and you'll see the following output:</p>\n\n<pre><code>cdf( 0): 0.0000\ncdf( 1): 0.0000\ncdf( 2): 0.0000\ncdf( 3): 0.0002\ncdf( 4): 0.0013\ncdf( 5): 0.0062\ncdf( 6): 0.0228\ncdf( 7): 0.0668\ncdf( 8): 0.1587\ncdf( 9): 0.3085\ncdf(10): 0.5000\n---\npdf( 0): 0.0000\npdf( 1): 0.0000\npdf( 2): 0.0001\npdf( 3): 0.0004\npdf( 4): 0.0022\npdf( 5): 0.0088\npdf( 6): 0.0270\npdf( 7): 0.0648\npdf( 8): 0.1210\npdf( 9): 0.1760\npdf(10): 0.1995\n</code></pre>\n\n<p>There are 2 important points here:</p>\n\n<ul>\n<li><p><code>Normal</code> is a constructor defining a distribution. There are other distributions, such as <code>Uniform</code>, etc. Distributions have different types, but they all belong to the <code>Distribution</code> class.</p></li>\n<li><p><code>pdf</code> and <code>cdf</code> are class methods, which can operate on many distributions (perhaps not all, but many). The 1st parameter is the distribution and the 2nd \u2013 point at which PDF/CDF should be evaluated.</p></li>\n</ul>\n"}], "owner": {"reputation": 57, "user_id": 4910114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420218ded8135c3a75e5b38b4f06e17c?s=128&d=identicon&r=PG&f=1", "display_name": "abourbaki", "link": "https://stackoverflow.com/users/4910114/abourbaki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 1, "accepted_answer_id": 30968678, "answer_count": 2, "score": 1, "last_activity_date": 1434916160, "creation_date": 1434834966, "question_id": 30958975, "link": "https://stackoverflow.com/questions/30958975/normal-probability-density-function-gsl-equivalent-in-haskell", "title": "Normal probability density function - GSL equivalent in Haskell", "body": "<p>I am trying to find the best way to draw from a normal distribution. I want to be able to use the normal probability density function (and its cumulative) in Haskell.</p>\n\n<p>To put it simply, I want to use the functions on <a href=\"https://www.gnu.org/software/gsl/manual/html_node/The-Gaussian-Distribution.html\" rel=\"nofollow\">this page</a> without using the GSL binding... I am struggling to find the right package. Which one would you say is the best?</p>\n\n<p>Thank you and have a great day!</p>\n"}, {"tags": ["haskell", "recursion", "replicate"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 2, "creation_date": 1434834739, "post_id": 30958914, "comment_id": 49950548, "body": "What do you mean &quot;doesn&#39;t work&quot;? What happens when you run this function?"}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 9, "last_activity_date": 1434834963, "creation_date": 1434834963, "answer_id": 30958974, "question_id": 30958914, "link": "https://stackoverflow.com/questions/30958914/haskell-recursive-replicate-function/30958974#30958974", "title": "Haskell: recursive Replicate function", "body": "<p>You have to put the second case before the first, else it will never get to the second case.</p>\n\n<pre><code>myReplicate :: Int -&gt; a -&gt; [a]\nmyReplicate 0 y = [ ]\nmyReplicate x y = y : myReplicate (x-1) y\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "is_accepted": false, "score": 5, "last_activity_date": 1434842139, "last_edit_date": 1434842139, "creation_date": 1434835482, "answer_id": 30959057, "question_id": 30958914, "link": "https://stackoverflow.com/questions/30958914/haskell-recursive-replicate-function/30959057#30959057", "title": "Haskell: recursive Replicate function", "body": "<p>Your code should generate a warning reading (in GHC, at least):</p>\n\n<pre><code>Pattern match(es) are overlapped\nIn an equation for 'myReplicate': myReplicate 0 y = ...\n</code></pre>\n\n<p>What is happening is that the code tries to match your input against each definition you've written, in the order you've written (top-down). When you write <code>f x = ...</code>, the <code>x</code> variable will always match with any value of the type it represents. If all the bindings in the definition match, then that definition will be used.</p>\n\n<p>In your case, the first definition is <code>myReplicate x y = y : myReplicate (x-1) y</code>. As I said, <code>x</code> and <code>y</code> will match with any value you pass, including <code>0</code> for the <code>x</code> binding. The solution proposed by @Alec shows how you can avoid this problem, by having the most specific pattern written first, and the catch-all pattern written last.</p>\n\n<p>Another solution is using guards:</p>\n\n<pre><code>myReplicate :: Int -&gt; a -&gt; [a]\nmyReplicate x y\n    | x &gt; 0  = y : myReplicate (x-1) y\n    | x == 0 = []\n    | otherwise = [] -- or throw an exception, or use Maybe\n</code></pre>\n\n<p>This way you can write the expressions to be used in any order, if you write the conditions properly (in another words, if the conditions are mutually exclusive). Note the conditions will still be evaluated first from the top, then going down until a condition is true, pretty much like an <code>if ... else if ... else if ... else ...</code> chain in an imperative language.</p>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 12864941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cadf90c6865bbc898bcf15725249a76?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis", "link": "https://stackoverflow.com/users/12864941/alexis"}, "is_accepted": false, "score": 1, "last_activity_date": 1581701053, "last_edit_date": 1581701053, "creation_date": 1581196983, "answer_id": 60131297, "question_id": 30958914, "link": "https://stackoverflow.com/questions/30958914/haskell-recursive-replicate-function/60131297#60131297", "title": "Haskell: recursive Replicate function", "body": "<p>You can use map:</p>\n\n<pre><code>myReplicate :: Int -&gt; a -&gt; [a]\nmyReplicate n x = map (const x) [1..n]\n</code></pre>\n\n<p>You can also use <code>$&gt;</code> from Data.Functor:</p>\n\n<pre><code>import Data.Functor \nmyReplicate :: Int -&gt; a -&gt; [a]\nmyReplicate n x = [1..n] $&gt; x\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5032052, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154053433646164/picture?type=large", "display_name": "Jul", "link": "https://stackoverflow.com/users/5032052/jul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4677, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1581701053, "creation_date": 1434834537, "last_edit_date": 1434846420, "question_id": 30958914, "link": "https://stackoverflow.com/questions/30958914/haskell-recursive-replicate-function", "title": "Haskell: recursive Replicate function", "body": "<p>I'm just getting started with Haskell. I'm trying to create a function that imitates the standard <code>replicate</code> function in Haskell, but using recursion. For example,</p>\n\n<pre><code>Prelude&gt; replicate 3 \"Ha!\"\n[\"Ha!\",\"Ha!\",\"Ha!\"]\n</code></pre>\n\n<p>It should be of type <code>Int -&gt; a -&gt; [a]</code>. So far I have:</p>\n\n<pre><code>myReplicate :: Int -&gt; a -&gt; [a]\nmyReplicate x y = y : myReplicate (x-1) y\nmyReplicate 0 y = [ ]\n</code></pre>\n\n<p>However, my function always generates infinite lists:</p>\n\n<pre><code>Prelude&gt; myReplicate 3 \"Ha!\"\n[\"Ha!\",\"Ha!\",\"Ha!\",\"Ha!\",\"Ha!\",\"Ha!\",\"Ha!\",...\n</code></pre>\n"}, {"tags": ["list", "haskell", "io"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1434833874, "post_id": 30958775, "comment_id": 49950319, "body": "What does your <code>mapM</code> code look like?"}, {"owner": {"reputation": 1224, "user_id": 923104, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/iVJr7.jpg?s=128&g=1", "display_name": "Roshnal", "link": "https://stackoverflow.com/users/923104/roshnal"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1434834164, "post_id": 30958775, "comment_id": 49950385, "body": "@DavidYoung <code>mapM (\\(a, b) -&gt; f a b) lst</code>. <code>lst</code> is the list of tuples I posted above"}], "answers": [{"comments": [{"owner": {"reputation": 1224, "user_id": 923104, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/iVJr7.jpg?s=128&g=1", "display_name": "Roshnal", "link": "https://stackoverflow.com/users/923104/roshnal"}, "edited": false, "score": 0, "creation_date": 1434834460, "post_id": 30958861, "comment_id": 49950468, "body": "It worked! Thanks :) But can you please explain a bit about the use of <code>uncurry</code>? And what exactly is going on behind it and <code>mapM</code>?"}, {"owner": {"reputation": 1224, "user_id": 923104, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/iVJr7.jpg?s=128&g=1", "display_name": "Roshnal", "link": "https://stackoverflow.com/users/923104/roshnal"}, "edited": false, "score": 0, "creation_date": 1434834807, "post_id": 30958861, "comment_id": 49950572, "body": "Got it :) Thanks a lot again, for the answer <i>and</i> the explanation. I wasn&#39;t sure how <code>mapM</code> and <code>uncurry</code> worked, now okay though."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 2, "last_activity_date": 1434834468, "last_edit_date": 1434834468, "creation_date": 1434834241, "answer_id": 30958861, "question_id": 30958775, "link": "https://stackoverflow.com/questions/30958775/mapping-with-io-actions-in-haskell/30958861#30958861", "title": "Mapping with IO actions in Haskell", "body": "<p>Here is a function <code>f'</code> which does what you describe.</p>\n\n<pre><code>f' :: [(String,String)] -&gt; IO [Bool]\nf' = mapM $ uncurry f\n</code></pre>\n\n<p>Let me know if something is unclear! And, just to be clear, here is how you run it:</p>\n\n<pre><code>main = do\n        res &lt;- f' [(\"a.txt\", \"b.txt\"), (\"c.txt\", \"d.txt\")]\n        print res\n</code></pre>\n\n<h3>EDIT</h3>\n\n<p>The function is in pointfree form, so it is equivalent to <code>f' lst = mapM (uncurry f) lst</code>. <code>mapM</code> essentially maps each element of <code>lst</code> using <code>f</code> as the function, and pushes the <code>IO</code> to the outside of the list.</p>\n\n<p><code>uncurry</code> just takes a function of the form <code>a -&gt; b -&gt; c</code> and transforms it into one <code>(a,b) -&gt; c</code>, which is what we want since you have a list of tuples. </p>\n"}], "owner": {"reputation": 1224, "user_id": 923104, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/iVJr7.jpg?s=128&g=1", "display_name": "Roshnal", "link": "https://stackoverflow.com/users/923104/roshnal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "accepted_answer_id": 30958861, "answer_count": 1, "score": 0, "last_activity_date": 1434834468, "creation_date": 1434833617, "question_id": 30958775, "link": "https://stackoverflow.com/questions/30958775/mapping-with-io-actions-in-haskell", "title": "Mapping with IO actions in Haskell", "body": "<p>I have a function that takes two filenames, and reads the contents of those two files into <code>String</code>s, and then returns if they match or not. Here's the function:</p>\n\n<pre><code>f :: String -&gt; String -&gt; IO Bool\nf fileName1 fileName2 = do\n        str1 &lt;- readFile fileName1\n        str2 &lt;- readFile fileName2\n        return (str1 == str2)\n</code></pre>\n\n<p>And if I use it like this from inside <code>main</code>:</p>\n\n<pre><code>main = do\n        res &lt;- f \"A.txt\" \"B.txt\"\n        print res\n</code></pre>\n\n<p>It works and prints either <code>True</code> or <code>False</code>. What I want to do is, apply this function <code>f</code> to a list (of tuples) of filenames. For something like:</p>\n\n<pre><code>[(\"a.txt\", \"b.txt\"), (\"c.txt\", \"d.txt\")]\n</code></pre>\n\n<p>(Assume that <code>a.txt</code> and <code>b.txt</code> have the same content and <code>c.txt</code> and <code>d.txt</code> are different).</p>\n\n<p>I want to transform it (the list of file names) into a <code>Bool</code> list like: <code>[True, False]</code>. I tried using <code>mapM</code>, but that doesn't appear to map anything (when I print the list after using <code>mapM</code>, it prints the same list of tuples).</p>\n\n<p>So my question is: What am I doing wrong, and how can I get a list of <code>Bool</code>s like I mentioned above?</p>\n\n<p>Please go easy on me as I'm still quite new to Haskell and functional programming :)</p>\n"}, {"tags": ["haskell", "wxhaskell"], "answers": [{"tags": [], "owner": {"reputation": 384, "user_id": 4098149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4eff262713ed007414ceb4e35f6b63f5?s=128&d=identicon&r=PG&f=1", "display_name": "Schoon", "link": "https://stackoverflow.com/users/4098149/schoon"}, "is_accepted": false, "score": 2, "last_activity_date": 1447457082, "creation_date": 1447457082, "answer_id": 33703320, "question_id": 30958706, "link": "https://stackoverflow.com/questions/30958706/display-a-full-image-with-wxhaskell/33703320#33703320", "title": "Display a full image with wxHaskell", "body": "<p>You missed a <code>fill</code> before <code>widget imagep</code> with the effect that the panel you paint in the picture doesn't get any surface. And I'd recommend setting an outerSize, too. You might also want to have a look at <a href=\"https://github.com/wxHaskell/wxHaskell/blob/master/samples/wx/ImageViewer.hs\" rel=\"nofollow\">https://github.com/wxHaskell/wxHaskell/blob/master/samples/wx/ImageViewer.hs</a> for inspiration. Good luck!</p>\n\n<pre><code>import Graphics.UI.WX\nimport Graphics.UI.WXCore\n\nmain :: IO ()\nmain = start testimg\n\ntestimg :: IO ()\ntestimg = do\n  f &lt;- frame [text := \"Test Image\"]\n  p &lt;- panel f []\n\n  image &lt;- bitmapCreateFromFile \"landscape.png\"\n  imagep &lt;- panel p [ on paint := onPaint image ]\n\n  set f [ layout:= fill $ container p $ fill $ widget imagep \n        , outerSize := sz 500 500\n        ]\n\n  where\n    onPaint image dc rect = drawBitmap dc image pointZero True []\n</code></pre>\n"}], "owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1447457082, "creation_date": 1434833001, "question_id": 30958706, "link": "https://stackoverflow.com/questions/30958706/display-a-full-image-with-wxhaskell", "title": "Display a full image with wxHaskell", "body": "<p>I am using wxHaskell to display a full image in a window. My code is:</p>\n\n<pre><code>import Graphics.UI.WX\nimport Graphics.UI.WXCore\n\nmain :: IO ()\nmain = start testimg\n\ntestimg :: IO ()\ntestimg = do\n  f &lt;- frame [text := \"Test Image\"]\n  p &lt;- panel f []\n\n  image &lt;- bitmapCreateFromFile \"landscape.png\"\n  imagep &lt;- panel p [ on paint := onPaint image ]\n\n  set f [ layout:= fill $ container p $ widget imagep ]\n\n  where\n    onPaint image dc rect = drawBitmap dc image pointZero True []\n</code></pre>\n\n<p>Anyway when the app runs nothing is displayed (not even the window's borders). How can I make it work?</p>\n"}, {"tags": ["haskell", "leksah", "nixos", "nix"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1434833777, "post_id": 30958505, "comment_id": 49950293, "body": "A breaking change in <a href=\"https://downloads.haskell.org/~ghc/7.10.1/docs/html/users_guide/release-7-10-1.html\" rel=\"nofollow noreferrer\">GHC 7.10</a> - &quot;GHC now checks that all the language extensions required for the inferred type signatures are explicitly enabled&quot; - causes this package to break the build. Either use an older compiler, fix the package yourself, or wait till the maintainer fixes it."}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1434864843, "post_id": 30958505, "comment_id": 49955376, "body": "Many thanks! I thought such breaking changes should not happen in nix derivations."}, {"owner": {"reputation": 5215, "user_id": 133235, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/64798a399a79ed8d34fa83ba0e61c1ac?s=128&d=identicon&r=PG", "display_name": "iElectric", "link": "https://stackoverflow.com/users/133235/ielectric"}, "edited": false, "score": 0, "creation_date": 1434883997, "post_id": 30958505, "comment_id": 49959370, "body": "This is not 14.12, but rather 15.06 in development"}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1434893791, "post_id": 30958505, "comment_id": 49962000, "body": "Sorry and thanks for the clarification."}], "answers": [{"tags": [], "owner": {"reputation": 1484, "user_id": 2541778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930c28082137d9918a90608c665c5af2?s=128&d=identicon&r=PG", "display_name": "Peter Simons", "link": "https://stackoverflow.com/users/2541778/peter-simons"}, "is_accepted": false, "score": 0, "last_activity_date": 1449674493, "last_edit_date": 1449674493, "creation_date": 1447948039, "answer_id": 33808410, "question_id": 30958505, "link": "https://stackoverflow.com/questions/30958505/leksah-in-nixos-14-12-fails-to-install-why/33808410#33808410", "title": "Leksah in NixOS 14.12 - fails to install, why?", "body": "<p>Current versions of <code>Leksah</code> compile successfully in the Nixpkgs <code>master</code> branch, i.e. at <a href=\"http://hydra.cryp.to/build/1410084\" rel=\"nofollow\">http://hydra.cryp.to/build/1410084</a>. The <code>unstable</code> channel will have these updates soon. There are still some problems left to figure out with regard to how to run <code>Leksah</code> successfully on NixOS: <a href=\"https://github.com/NixOS/nixpkgs/pull/10351\" rel=\"nofollow\">https://github.com/NixOS/nixpkgs/pull/10351</a> has more details.</p>\n"}], "owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 307, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1449674493, "creation_date": 1434831694, "last_edit_date": 1434832248, "question_id": 30958505, "link": "https://stackoverflow.com/questions/30958505/leksah-in-nixos-14-12-fails-to-install-why", "title": "Leksah in NixOS 14.12 - fails to install, why?", "body": "<p>Leksah in NixOS 14.12 - unstable channel fails to install, why ?</p>\n\n<pre><code>[demo@nixos:~]$ nix-channel --list\nnixpkgs http://nixos.org/channels/nixpkgs-unstable\n\n[demo@nixos:~]$ nix-env -i leksah\ninstalling \u2018leksah\u2019\nthese derivations will be built:\n  /nix/store/69k8c7mvz64k08z9gabh7gmcn1i265rn-haskell-regex-tdfa-text-1.0.0.2.drv\n  /nix/store/h9dxxnab1sngr2d6g1q9qj0yv35iqyzs-haskell-leksah-0.15.0.1.drv\n  /nix/store/lfjh66d015dkh9kr51h5871c7gqji5na-ghc-7.10.1.drv\n  /nix/store/pdpsxp33mffmq72vhk5ig8bhrrdyq7p2-leksah.drv\nbuilding path(s) \u2018/nix/store/53kxzd2apkijwib78gw4mdlpxs5vllpj-haskell-regex-tdfa-text-1.0.0.2\u2019\nsetupCompilerEnvironmentPhase\nBuild with /nix/store/bc84hdk730zcdm1c9s5yf2ahpvm51lzp-ghc-7.10.1.\nunpacking sources\nunpacking source archive /nix/store/cmrcmadl401k7sjgqwj2dz4b9jqwxnck-regex-tdfa-text-1.0.0.2.tar.gz\nsource root is regex-tdfa-text-1.0.0.2\npatching sources\ncompileBuildDriverPhase\nsetupCompileFlags: -package-db=/tmp/nix-build-haskell-regex-tdfa-text-1.0.0.2.drv-0/package.conf.d -j1 -threaded\n[1 of 1] Compiling Main             ( Setup.lhs, /tmp/nix-build-haskell-regex-tdfa-text-1.0.0.2.drv-0/Main.o )\nLinking Setup ...\nconfiguring\nconfigureFlags: --verbose --prefix=/nix/store/53kxzd2apkijwib78gw4mdlpxs5vllpj-haskell-regex-tdfa-text-1.0.0.2 --libdir=$prefix/lib/$compiler --libsubdir=$pkgid --with-gcc=gcc --package-db=/tmp/nix-build-haskell-regex-tdfa-text-1.0.0.2.drv-0/package.conf.d --ghc-option=-optl=-Wl,-rpath=/nix/store/53kxzd2apkijwib78gw4mdlpxs5vllpj-haskell-regex-tdfa-text-1.0.0.2/lib/ghc-7.10.1/regex-tdfa-text-1.0.0.2 --ghc-option=-j1 --enable-split-objs --disable-library-profiling --enable-shared --enable-library-vanilla --enable-executable-dynamic --enable-tests\nConfiguring regex-tdfa-text-1.0.0.2...\nDependency array -any: using array-0.5.1.0\nDependency base &gt;=3 &amp;&amp; &lt;5: using base-4.8.0.0\nDependency regex-base -any: using regex-base-0.93.2\nDependency regex-tdfa &gt;=1.1.1: using regex-tdfa-1.2.0\nDependency text -any: using text-1.2.1.1\nUsing Cabal-1.22.2.0 compiled by ghc-7.10\nUsing compiler: ghc-7.10.1\nUsing install prefix:\n/nix/store/53kxzd2apkijwib78gw4mdlpxs5vllpj-haskell-regex-tdfa-text-1.0.0.2\nBinaries installed in:\n/nix/store/53kxzd2apkijwib78gw4mdlpxs5vllpj-haskell-regex-tdfa-text-1.0.0.2/bin\nLibraries installed in:\n/nix/store/53kxzd2apkijwib78gw4mdlpxs5vllpj-haskell-regex-tdfa-text-1.0.0.2/lib/ghc-7.10.1/regex-tdfa-text-1.0.0.2\nPrivate binaries installed in:\n/nix/store/53kxzd2apkijwib78gw4mdlpxs5vllpj-haskell-regex-tdfa-text-1.0.0.2/libexec\nData files installed in:\n/nix/store/53kxzd2apkijwib78gw4mdlpxs5vllpj-haskell-regex-tdfa-text-1.0.0.2/share/x86_64-linux-ghc-7.10.1/regex-tdfa-text-1.0.0.2\nDocumentation installed in:\n/nix/store/53kxzd2apkijwib78gw4mdlpxs5vllpj-haskell-regex-tdfa-text-1.0.0.2/share/doc/x86_64-linux-ghc-7.10.1/regex-tdfa-text-1.0.0.2\nConfiguration files installed in:\n/nix/store/53kxzd2apkijwib78gw4mdlpxs5vllpj-haskell-regex-tdfa-text-1.0.0.2/etc\nNo alex found\nUsing ar found on system at:\n/nix/store/yxg5zsjxp1l16xk7r23rayyc18fkxynk-binutils-2.23.1/bin/ar\nNo c2hs found\nNo cpphs found\nUsing gcc version 4.8.4 given by user at:\n/nix/store/ylj1q31a7x3pvcraxk60dyv9y4wmwcrc-gcc-wrapper-4.8.4/bin/gcc\nUsing ghc version 7.10.1 found on system at:\n/nix/store/bc84hdk730zcdm1c9s5yf2ahpvm51lzp-ghc-7.10.1/bin/ghc\nUsing ghc-pkg version 7.10.1 found on system at:\n/nix/store/bc84hdk730zcdm1c9s5yf2ahpvm51lzp-ghc-7.10.1/bin/ghc-pkg\nNo ghcjs found\nNo ghcjs-pkg found\nNo greencard found\nUsing haddock version 2.16.0 found on system at:\n/nix/store/bc84hdk730zcdm1c9s5yf2ahpvm51lzp-ghc-7.10.1/bin/haddock\nNo happy found\nUsing haskell-suite found on system at: haskell-suite-dummy-location\nUsing haskell-suite-pkg found on system at: haskell-suite-pkg-dummy-location\nNo hmake found\nUsing hpc version 0.67 found on system at:\n/nix/store/bc84hdk730zcdm1c9s5yf2ahpvm51lzp-ghc-7.10.1/bin/hpc\nUsing hsc2hs version 0.67 found on system at:\n/nix/store/bc84hdk730zcdm1c9s5yf2ahpvm51lzp-ghc-7.10.1/bin/hsc2hs\nUsing hscolour version 1.22 found on system at:\n/nix/store/g6mfdhbmwm0499n88bnzd32y96gmnfn9-hscolour-1.23/bin/HsColour\nNo jhc found\nUsing ld found on system at:\n/nix/store/ylj1q31a7x3pvcraxk60dyv9y4wmwcrc-gcc-wrapper-4.8.4/bin/ld\nNo lhc found\nNo lhc-pkg found\nNo pkg-config found\nUsing strip version 2.23 found on system at:\n/nix/store/yxg5zsjxp1l16xk7r23rayyc18fkxynk-binutils-2.23.1/bin/strip\nUsing tar found on system at:\n/nix/store/blyc5sprbm85ph2fmksyhrqislp9j0im-gnutar-1.28/bin/tar\nNo uhc found\nbuilding\nBuilding regex-tdfa-text-1.0.0.2...\nPreprocessing library regex-tdfa-text-1.0.0.2...\n[1 of 2] Compiling Text.Regex.TDFA.Text.Lazy ( Text/Regex/TDFA/Text/Lazy.hs, dist/build/Text/Regex/TDFA/Text/Lazy.o )\n\nText/Regex/TDFA/Text/Lazy.hs:77:9:\n    Non type-variable argument\n      in the constraint: Data.Array.Base.IArray a (Int, Int)\n    (Use FlexibleContexts to permit this)\n    When checking that \u2018go\u2019 has the inferred type\n      go :: forall t (a :: * -&gt; * -&gt; *) i.\n            (Functor (a i), Num i, GHC.Arr.Ix i,\n             Data.Array.Base.IArray a (Int, Int), Extract t) =&gt;\n            Int -&gt; t -&gt; [a i (Int, Int)] -&gt; [a i (t, (Int, Int))]\n    In the expression:\n      let\n        go i _ _ | i `seq` False = undefined\n        go _i _t [] = []\n        go i t (x : xs)\n          = let ... in fmap trans x : seq t' (go (off0 + len0) t' xs)\n      in go 0 source (matchAll regex source)\n    In an equation for \u2018matchAllText\u2019:\n        matchAllText regex source\n          = let\n              go i _ _ | i `seq` False = undefined\n              go _i _t [] = ...\n              go i t (x : xs) = ...\n            in go 0 source (matchAll regex source)\nbuilder for \u2018/nix/store/69k8c7mvz64k08z9gabh7gmcn1i265rn-haskell-regex-tdfa-text-1.0.0.2.drv\u2019 failed with exit code 1\ncannot build derivation \u2018/nix/store/lfjh66d015dkh9kr51h5871c7gqji5na-ghc-7.10.1.drv\u2019: 1 dependencies couldn't be built\ncannot build derivation \u2018/nix/store/pdpsxp33mffmq72vhk5ig8bhrrdyq7p2-leksah.drv\u2019: 1 dependencies couldn't be built\nerror: build of \u2018/nix/store/pdpsxp33mffmq72vhk5ig8bhrrdyq7p2-leksah.drv\u2019 failed\n</code></pre>\n"}, {"tags": ["macos", "haskell", "gcc", "cabal", "ghci"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1434830777, "post_id": 30958245, "comment_id": 49949470, "body": "Are you using Homebrew with <code>sudo</code>?"}, {"owner": {"reputation": 135, "user_id": 2980292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3264ddf197a01dd39b9b566b32fc08b?s=128&d=identicon&r=PG&f=1", "display_name": "damorais", "link": "https://stackoverflow.com/users/2980292/damorais"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1434831289, "post_id": 30958245, "comment_id": 49949599, "body": "No... I&#39;ve used only <code>brew install ghc</code>. The problem occurs when I use the installer provided by <a href=\"https://www.haskell.org/downloads/osx\" rel=\"nofollow noreferrer\">haskell.org</a> too."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1434831351, "post_id": 30958245, "comment_id": 49949620, "body": "Try removing that package first (verify that <code>ghc</code> no longer exists) and then installing using Homebrew."}, {"owner": {"reputation": 135, "user_id": 2980292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3264ddf197a01dd39b9b566b32fc08b?s=128&d=identicon&r=PG&f=1", "display_name": "damorais", "link": "https://stackoverflow.com/users/2980292/damorais"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1434831634, "post_id": 30958245, "comment_id": 49949687, "body": "Already did that. First, I&#39;ve tried with homebrew, without success. Then, I&#39;ve tried with the installer. And, after some search, I&#39;ve tried using the Yann Esposito script. In all cases, the sudo problem persists."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1434836227, "post_id": 30958245, "comment_id": 49950946, "body": "Does Homebrew install GHC 7.10 instead of 7.8? That\u2019d be a start."}, {"owner": {"reputation": 135, "user_id": 2980292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3264ddf197a01dd39b9b566b32fc08b?s=128&d=identicon&r=PG&f=1", "display_name": "damorais", "link": "https://stackoverflow.com/users/2980292/damorais"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1434839986, "post_id": 30958245, "comment_id": 49951782, "body": "Yes, it installed the 7.10... But the installer provided by haskell.org that I&#39;ve used contains the 7.8 version. The script that I&#39;ve mentioned also use 7.8 version."}], "answers": [{"comments": [{"owner": {"reputation": 401, "user_id": 3006372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I3cfX.png?s=128&g=1", "display_name": "jbum", "link": "https://stackoverflow.com/users/3006372/jbum"}, "edited": false, "score": 0, "creation_date": 1447539428, "post_id": 31573430, "comment_id": 55199002, "body": "Thanks, I was having the same problem, and this fixed it."}], "tags": [], "owner": {"reputation": 135, "user_id": 2980292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3264ddf197a01dd39b9b566b32fc08b?s=128&d=identicon&r=PG&f=1", "display_name": "damorais", "link": "https://stackoverflow.com/users/2980292/damorais"}, "is_accepted": true, "score": 1, "last_activity_date": 1437597115, "creation_date": 1437597115, "answer_id": 31573430, "question_id": 30958245, "link": "https://stackoverflow.com/questions/30958245/requiring-sudo-to-run-ghci-on-osx/31573430#31573430", "title": "Requiring sudo to run ghci on OSx", "body": "<p>Finally, I've discovered the answer:</p>\n\n<p>The problem is with my DYLD_FALLBACK_LIBRARY_PATH. The value was defined to the directory of my POSTGRESQL bin folder. So, I've appended the recommended values pointed by the man page of dyld (man dyld), reloaded my .bash_profile and now my ghci, cabal and ghc are working smoothly.</p>\n\n<p>The recommended value is:\n    \"$HOME/lib:/usr/local/lib:/lib:/usr/lib\"</p>\n"}], "owner": {"reputation": 135, "user_id": 2980292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3264ddf197a01dd39b9b566b32fc08b?s=128&d=identicon&r=PG&f=1", "display_name": "damorais", "link": "https://stackoverflow.com/users/2980292/damorais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 31573430, "answer_count": 1, "score": 0, "last_activity_date": 1437597115, "creation_date": 1434829933, "question_id": 30958245, "link": "https://stackoverflow.com/questions/30958245/requiring-sudo-to-run-ghci-on-osx", "title": "Requiring sudo to run ghci on OSx", "body": "<p>I've installed the Haskell platform on my OSX (Yosemite).</p>\n\n<p>When I try to execute the ghci, the following error occurs:</p>\n\n<pre><code>GHCi, version 7.8.4: http://www.haskell.org/ghc/  :? for help\n\nLoading package ghc-prim ... linking ... done.\nLoading package integer-gmp ... linking ... done.\nLoading package base ... &lt;command line&gt;: can't load .so/.DLL for: libiconv.dylib (dlopen(libiconv.dylib, 9): image not found)\n</code></pre>\n\n<p>If I execute using sudo (sudo ghci), it runs normally. The same behavior occurs with cabal.</p>\n\n<p>I've tried to install using the default installer, using homebrew and using the script provided by Yann Esposito (<a href=\"http://yannesposito.com/Scratch/en/blog/Safer-Haskell-Install/\" rel=\"nofollow\">http://yannesposito.com/Scratch/en/blog/Safer-Haskell-Install/</a>), without changes in this behavior. Am I missing something?</p>\n"}, {"tags": ["list", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 4554, "user_id": 1385860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94d0e7a0bce722ce5017c9abdf997037?s=128&d=identicon&r=PG", "display_name": "Neil Forrester", "link": "https://stackoverflow.com/users/1385860/neil-forrester"}, "edited": false, "score": 2, "creation_date": 1434823741, "post_id": 30957255, "comment_id": 49947304, "body": "In your list comprehension you&#39;re not using <code>a</code>. Not sure what you&#39;re trying to do exactly, but that doesn&#39;t look right."}, {"owner": {"reputation": 258, "user_id": 1447186, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Rbaro.png?s=128&g=1", "display_name": "Thanasi Poulos", "link": "https://stackoverflow.com/users/1447186/thanasi-poulos"}, "reply_to_user": {"reputation": 4554, "user_id": 1385860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94d0e7a0bce722ce5017c9abdf997037?s=128&d=identicon&r=PG", "display_name": "Neil Forrester", "link": "https://stackoverflow.com/users/1385860/neil-forrester"}, "edited": false, "score": 0, "creation_date": 1434823801, "post_id": 30957255, "comment_id": 49947327, "body": "My mistake, I typoed it. Fixed now."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 6, "creation_date": 1434824002, "post_id": 30957255, "comment_id": 49947397, "body": "Multiple binds (&lt;-) in a list comprehension behave like nested loops, not parallel.  You want to use <code>zip</code>"}, {"owner": {"reputation": 258, "user_id": 1447186, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Rbaro.png?s=128&g=1", "display_name": "Thanasi Poulos", "link": "https://stackoverflow.com/users/1447186/thanasi-poulos"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1434824114, "post_id": 30957255, "comment_id": 49947430, "body": "@luqui, not to be a pain, but care to elaborate slightly? zip will give me back a tuple won&#39;t it?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1434824199, "post_id": 30957255, "comment_id": 49947454, "body": "Yes.  I&#39;m sure you can figure it out."}, {"owner": {"reputation": 258, "user_id": 1447186, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Rbaro.png?s=128&g=1", "display_name": "Thanasi Poulos", "link": "https://stackoverflow.com/users/1447186/thanasi-poulos"}, "edited": false, "score": 0, "creation_date": 1434824390, "post_id": 30957255, "comment_id": 49947516, "body": "Ah yes of course, I&#39;ve done this before. Thanks for the tip!"}], "answers": [{"comments": [{"owner": {"reputation": 258, "user_id": 1447186, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Rbaro.png?s=128&g=1", "display_name": "Thanasi Poulos", "link": "https://stackoverflow.com/users/1447186/thanasi-poulos"}, "edited": false, "score": 0, "creation_date": 1434824411, "post_id": 30957344, "comment_id": 49947520, "body": "Thanks, I had just worked out what luqui was talking about when this popped up!"}], "tags": [], "owner": {"reputation": 4554, "user_id": 1385860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94d0e7a0bce722ce5017c9abdf997037?s=128&d=identicon&r=PG", "display_name": "Neil Forrester", "link": "https://stackoverflow.com/users/1385860/neil-forrester"}, "is_accepted": true, "score": 7, "last_activity_date": 1434824101, "creation_date": 1434824101, "answer_id": 30957344, "question_id": 30957255, "link": "https://stackoverflow.com/questions/30957255/im-having-a-hard-time-with-a-list-comprehension/30957344#30957344", "title": "I&#39;m having a hard time with a list comprehension", "body": "<p>List comprehensions over two variables do not iterate over the two variables simultaneously, but independently (you get all combinations of bound values):</p>\n\n<pre><code>Prelude&gt; [(x, y) | x &lt;- [0..3], y &lt;- [4..6]]\n[(0,4),(0,5),(0,6),(1,4),(1,5),(1,6),(2,4),(2,5),(2,6),(3,4),(3,5),(3,6)]\n</code></pre>\n\n<p>You are therefore sequencing the following operations:</p>\n\n<pre><code>sequence_ [writeArray arr (1, y) 10,\n           writeArray arr (3, y) 10,\n           writeArray arr (2, y) 10,\n           writeArray arr (1, y) 8,\n           writeArray arr (3, y) 8,\n           writeArray arr (2, y) 8,\n           writeArray arr (1, y) 7,\n           writeArray arr (3, y) 7,\n           writeArray arr (2, y) 7]\n</code></pre>\n\n<p>So you're writing all 10s, overwriting them with 8s, and then overwriting them again with 7s.</p>\n\n<p>As luqui suggested in a comment, try this instead:</p>\n\n<pre><code>sequence_ [writeArray arr (x, y) a | (x, a) &lt;- (zip xs as)]\n    where xs = [1,3,2]\n    as = [\"10\", \"8\", \"7\"]\n</code></pre>\n"}], "owner": {"reputation": 258, "user_id": 1447186, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Rbaro.png?s=128&g=1", "display_name": "Thanasi Poulos", "link": "https://stackoverflow.com/users/1447186/thanasi-poulos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 30957344, "answer_count": 1, "score": 4, "last_activity_date": 1434824101, "creation_date": 1434823483, "last_edit_date": 1434823791, "question_id": 30957255, "link": "https://stackoverflow.com/questions/30957255/im-having-a-hard-time-with-a-list-comprehension", "title": "I&#39;m having a hard time with a list comprehension", "body": "<p>I just want a simple explanation, really.\nI have a whole bunch of functions and one of my list comprehensions is behaving very oddly.</p>\n\n<pre><code>sequence_ [writeArray arr (x, y) a | x &lt;- xs, a &lt;- as]\n    where xs = [1,3,2]\n    as = [\"10\", \"8\", \"7\"]\n</code></pre>\n\n<p><code>y</code> is constant (passed in as an argument) and I've cut out a lot of the other functions because they are returning what I am expecting.</p>\n\n<p>Where I have an array that looks like</p>\n\n<pre><code>1,1,1\n1,1,1\n1,1,1\n</code></pre>\n\n<p>I expect to get (for example)</p>\n\n<pre><code>1,1,10\n1,1,8\n1,1,7\n</code></pre>\n\n<p>But instead I get</p>\n\n<pre><code>1,1,7\n1,1,7\n1,1,7\n</code></pre>\n\n<p>Is anyone able to offer any advice?</p>\n"}, {"tags": ["shell", "haskell", "command-line-arguments", "executable"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1434826684, "post_id": 30957147, "comment_id": 49948209, "body": "In the first part, you have an executable named <code>test</code> and in the second part you&#39;re trying to run an executable named <code>testcpp</code>. Is this correct? Also I think you need to read the contents of <code>test.in</code> and then pass that string as the last argument, rather than giving the file name."}, {"owner": {"reputation": 1224, "user_id": 923104, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/iVJr7.jpg?s=128&g=1", "display_name": "Roshnal", "link": "https://stackoverflow.com/users/923104/roshnal"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1434827468, "post_id": 30957147, "comment_id": 49948473, "body": "@DavidYoung Yes, I just provided general examples of what I was trying to do. But as it appears to be confusing, I edited it. As for the second part of your comment, didn&#39;t quite get you. AFAIK, the problem is with running the exec file itself, and not with providing the input arguments."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1434831047, "post_id": 30957147, "comment_id": 49949538, "body": "you can always create a file with a shell script, and run <i>it</i>."}], "answers": [{"comments": [{"owner": {"reputation": 1224, "user_id": 923104, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/iVJr7.jpg?s=128&g=1", "display_name": "Roshnal", "link": "https://stackoverflow.com/users/923104/roshnal"}, "edited": false, "score": 0, "creation_date": 1434828165, "post_id": 30957954, "comment_id": 49948703, "body": "Yes! That worked. Thanks for the answer and the clear explanation :)"}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": true, "score": 5, "last_activity_date": 1434828088, "last_edit_date": 1434828088, "creation_date": 1434827996, "answer_id": 30957954, "question_id": 30957147, "link": "https://stackoverflow.com/questions/30957147/running-executable-files-using-haskell/30957954#30957954", "title": "Running executable files using Haskell", "body": "<p>The <a href=\"http://hackage.haskell.org/package/process-1.2.3.0/docs/System-Process.html#v:readProcess\" rel=\"nofollow\">documentation for <code>readProcess</code></a> says:</p>\n\n<pre><code>readProcess\n  :: FilePath   Filename of the executable (see RawCommand for details)\n  -&gt; [String]   any arguments\n  -&gt; String     standard input\n  -&gt; IO String  stdout\n</code></pre>\n\n<p>When it's asking for <code>standard input</code> it's not asking for a file to read the input from, but the actual contents of standard input for the file.</p>\n\n<p>So you'll need to use <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Prelude.html#v:readFile\" rel=\"nofollow\"><code>readFile</code></a> or the like to get the contents of <code>test.in</code>:</p>\n\n<pre><code>input &lt;- readFile \"test.in\"\nout &lt;- readProcess \"./testcpp\" [] input\n</code></pre>\n"}], "owner": {"reputation": 1224, "user_id": 923104, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/iVJr7.jpg?s=128&g=1", "display_name": "Roshnal", "link": "https://stackoverflow.com/users/923104/roshnal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 813, "favorite_count": 1, "accepted_answer_id": 30957954, "answer_count": 1, "score": 0, "last_activity_date": 1434828088, "creation_date": 1434822775, "last_edit_date": 1434827503, "question_id": 30957147, "link": "https://stackoverflow.com/questions/30957147/running-executable-files-using-haskell", "title": "Running executable files using Haskell", "body": "<p>Say there's a C++ code that I've compiled into an executable using:</p>\n\n<pre><code>g++ test.cpp -o testcpp\n</code></pre>\n\n<p>I can run this using Terminal (I'm using OS X), and provide an input file for processing inside the C++ program, like:</p>\n\n<pre><code>./testcpp &lt; input.txt\n</code></pre>\n\n<p>I was wondering if doing this is possible, from <em>within</em> Haskell. I have heard about the <code>readProcess</code> function in <code>System.Process</code> module. But that only allows for running system shell commands.</p>\n\n<p>Doing this:</p>\n\n<pre><code>out &lt;- readProcess \"testcpp\" [] \"test.in\"\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>out &lt;- readProcess \"testcpp &lt; test.in\" [] \"\"\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>out &lt;- readProcess \"./testcpp &lt; test.in\" [] \"\"\n</code></pre>\n\n<p>throws out this error (or something very similar depending on which one of the above I use):</p>\n\n<pre><code>testcpp: readProcess: runInteractiveProcess: exec: does not exist (No such file or directory)\n</code></pre>\n\n<p>So my question is, whether doing this is possible from Haskell. If so, how and which modules/functions should I use? Thanks.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Ok, so as David suggested, I removed the input arguments and tried running it. Doing this worked:</p>\n\n<pre><code>out &lt;- readProcess \"./testcpp\" [] \"\"\n</code></pre>\n\n<p>But I'm still stuck with providing the input.</p>\n"}, {"tags": ["parsing", "haskell", "parsec"], "comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1434808032, "post_id": 30954447, "comment_id": 49942333, "body": "Please include the actual code that produced the parse error (and also the string input or text file)."}], "answers": [{"tags": [], "owner": {"reputation": 444, "user_id": 1554137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb537e77e97db2071395a0b2a4c8a593?s=128&d=identicon&r=PG", "display_name": "Alexander VoidEx Ruchkin", "link": "https://stackoverflow.com/users/1554137/alexander-voidex-ruchkin"}, "is_accepted": true, "score": 4, "last_activity_date": 1434808967, "creation_date": 1434808967, "answer_id": 30954831, "question_id": 30954447, "link": "https://stackoverflow.com/questions/30954447/unexpected-end-of-input-with-parsec/30954831#30954831", "title": "Unexpected end of input with Parsec", "body": "<p>Your <code>between</code> will never stop, because <code>endBy line endOfLine</code> consumes any line and <code>END\\n</code> too, so it will eat more and more lines until it fails.\nThen your parser tries to consume <code>string \"END\\n\"</code> and fails too, that's why error message mentions <code>\"END\\n\"</code>\nYou must rewrite line parser to fail on <code>END\\n</code>. For example:</p>\n\n<pre><code>parseListing :: Parsec String () [String]\nparseListing = do \n    spaces\n    many $ noneOf \"\\n\"\n    spaces\n    cont &lt;- between begin end $ endBy (notFollowedBy end &gt;&gt; line) endOfLine\n    spaces\n    many $ noneOf \"\\n\"\n    spaces\n    eof\n    return cont\n    where\n        begin = string \"BEGIN\\n\"\n        end = string \"END\\n\"\n</code></pre>\n"}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 0, "accepted_answer_id": 30954831, "answer_count": 1, "score": 2, "last_activity_date": 1434808967, "creation_date": 1434806370, "last_edit_date": 1434808652, "question_id": 30954447, "link": "https://stackoverflow.com/questions/30954447/unexpected-end-of-input-with-parsec", "title": "Unexpected end of input with Parsec", "body": "<p>I try to parse the following text file with series of data between keywords : </p>\n\n<pre><code>many text many text  many text \n\nBEGIN\nT   LISTE2\n1   154\n2   321\n3   519\n4   520\n5   529\n6   426\nEND\n\nmany text  many text  many text\n</code></pre>\n\n<p>By using the following haskell program</p>\n\n<pre><code>import Text.Parsec\nimport Text.Parsec.String\nimport Text.Parsec.Char\nimport Text.Parsec.Combinator\n\nendOfLine :: Parser String\nendOfLine =     try (string \"\\n\") \n            &lt;|&gt; try (string \"\\r\\n\") \n\nline = many $ noneOf \"\\n\"\n\nparseListing = do \n  spaces\n  many $ noneOf \"\\n\"\n  spaces\n  cont &lt;- between (string \"BEGIN\\n\") (string \"END\\n\") $ endBy line endOfLine\n  spaces\n  many $ noneOf \"\\n\"\n  spaces\n  eof\n  return cont\n\nmain :: IO ()\nmain = do\n    file &lt;- readFile (\"test_list.txt\")\n    case parse parseListing \"(stdin)\" file of\n            Left err -&gt; do putStrLn \"!!! Error !!!\"\n                           print err\n            Right resu -&gt; do  putStrLn $  concat resu\n</code></pre>\n\n<p>And when I parse my text file, I get the following error : </p>\n\n<pre><code>\"(stdin)\" (line 16, column 1):\nunexpected end of input\nexpecting \"\\n\", \"\\r\\n\" or \"END\\n\"\n</code></pre>\n\n<p>I'm a newbie with parsing and I don't understand why it fail?\nMy sequence is yet between <code>BEGIN</code> and <code>END</code></p>\n\n<p>Do you know what is wrong with my parser and how to correct it ?</p>\n"}, {"tags": ["haskell", "linker", "docker", "yesod", "dockerfile"], "comments": [{"owner": {"reputation": 191212, "user_id": 147356, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b9506717d24256a090524dd5505d3207?s=128&d=identicon&r=PG", "display_name": "larsks", "link": "https://stackoverflow.com/users/147356/larsks"}, "edited": false, "score": 1, "creation_date": 1434808634, "post_id": 30954365, "comment_id": 49942522, "body": "This doesn&#39;t really look like a docker problem.  It just looks like two libraries you&#39;re trying to use provide the same symbol."}, {"owner": {"reputation": 23, "user_id": 5031207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d711b2eca6ce05c9dc97ec393f93ce1e?s=128&d=identicon&r=PG&f=1", "display_name": "adilipan", "link": "https://stackoverflow.com/users/5031207/adilipan"}, "reply_to_user": {"reputation": 191212, "user_id": 147356, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b9506717d24256a090524dd5505d3207?s=128&d=identicon&r=PG", "display_name": "larsks", "link": "https://stackoverflow.com/users/147356/larsks"}, "edited": false, "score": 0, "creation_date": 1434812015, "post_id": 30954365, "comment_id": 49943558, "body": "Thanks larsks. I actually ran <code>cabal build</code> on the project itself without the Dockerfile and it builds perfectly fine. I don&#39;t get this linking error that I get when using the Dockerfile."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 191212, "user_id": 147356, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b9506717d24256a090524dd5505d3207?s=128&d=identicon&r=PG", "display_name": "larsks", "link": "https://stackoverflow.com/users/147356/larsks"}, "edited": false, "score": 0, "creation_date": 1434826819, "post_id": 30954365, "comment_id": 49948259, "body": "I&#39;m fairly certain @larsks is right, and cabal is just choosing different versions of libraries. I&#39;d recommend using a Stackage snapshot (or building with stack)."}, {"owner": {"reputation": 23, "user_id": 5031207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d711b2eca6ce05c9dc97ec393f93ce1e?s=128&d=identicon&r=PG&f=1", "display_name": "adilipan", "link": "https://stackoverflow.com/users/5031207/adilipan"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1434847851, "post_id": 30954365, "comment_id": 49953173, "body": "Hi @MichaelSnoyman, after tons of fiddling with the yesod scaffolded <code>.cabal</code> file and with stackage I managed to get it working. Thanks for everything."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 5031207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d711b2eca6ce05c9dc97ec393f93ce1e?s=128&d=identicon&r=PG&f=1", "display_name": "adilipan", "link": "https://stackoverflow.com/users/5031207/adilipan"}, "is_accepted": false, "score": 1, "last_activity_date": 1434848180, "creation_date": 1434848180, "answer_id": 30960292, "question_id": 30954365, "link": "https://stackoverflow.com/questions/30954365/docker-yesod-linking-failure/30960292#30960292", "title": "Docker + Yesod Linking Failure", "body": "<p>As @MichaelSnoyman stated, fiddling with stackage and changing the cabal file dependency for yesod-static to <code>== 1.5.0</code> got the container to build. </p>\n"}], "owner": {"reputation": 23, "user_id": 5031207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d711b2eca6ce05c9dc97ec393f93ce1e?s=128&d=identicon&r=PG&f=1", "display_name": "adilipan", "link": "https://stackoverflow.com/users/5031207/adilipan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1434848180, "creation_date": 1434805616, "question_id": 30954365, "link": "https://stackoverflow.com/questions/30954365/docker-yesod-linking-failure", "title": "Docker + Yesod Linking Failure", "body": "<p>I'm trying to make a Dockerized Yesod application, and I've initialized the Yesod project under the directory <code>./my-app</code>. My Dockerfile is as follows:</p>\n\n<pre><code>FROM haskell:7.8\n\nRUN apt-get update &amp;&amp; apt-get install -y libpq5 libpq-dev\nRUN cabal update\n\nADD my-app /opt/my-app\n\nWORKDIR /opt/my-app\n\nRUN cabal sandbox delete\nRUN cabal sandbox init\nRUN cabal install -j --only-dependencies\nRUN cabal build\n\nRUN dist/build/db-import/db-import\n\nEXPOSE 3000\n\nCMD [\"dist/build/my-app/my-app\", \"production\", \"-p\", \"3000\"]\n</code></pre>\n\n<p>When I actually go to run docker, it's able to build all the dependencies, but I get a linker error:</p>\n\n<pre><code>/opt/my-app/.cabal-sandbox/lib/x86_64-linux-ghc-7.8.4/cryptonite-0.3/libHScryptonite-0.3.a(generic.o):(.data+0x0): multiple definition of `gmtab'\n/opt/my-app/.cabal-sandbox/lib/x86_64-linux-ghc-7.8.4/cipher-aes-0.2.10/libHScipher-aes-0.2.10.a(aes_generic.o):(.data+0x0): first defined here\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>I'm not entirely sure what to do here, because I've tried this with <code>haskell:latest</code> and <code>haskell:7.10</code> but I still end up with the same error. I'm not sure whether it's the fact that the specific container OS is Ubuntu or not. I'd love to hear suggestions on the matter.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "cabal", "cabal-install", "nix", "haskell-ng"], "answers": [{"comments": [{"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1434800958, "post_id": 30953616, "comment_id": 49940459, "body": "Many thanks Sibi ! What do you by latest master branch ? Where is it ? You mean git clone git://github.com/nixos/nixpkgs ? Does it matter what channel of nix I am using ?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1434801617, "post_id": 30953616, "comment_id": 49940649, "body": "Yes, that&#39;s the one. Yes, It matters what <code>channel</code> you are using."}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1434801775, "post_id": 30953616, "comment_id": 49940689, "body": "Do I need to use the unstable channel ?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1434803426, "post_id": 30953616, "comment_id": 49941114, "body": "@jhegedus If you want to live on the latest packages."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1450878718, "post_id": 30953616, "comment_id": 56615115, "body": "<i>&quot;in around a week&quot;</i> \u2014 maybe just minutes or hours if you use the latest version (i.e. HEAD) of everything?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1450879186, "post_id": 30953616, "comment_id": 56615411, "body": "@ErikAllik Does it just take hours now ? Feel free to edit the answer, then."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1450880888, "post_id": 30953616, "comment_id": 56616379, "body": "I was asking \u2014 I haven&#39;t tried using Hackage via Nix just yet but thought that was important enough of an aspect to ask here."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1450885164, "post_id": 30953616, "comment_id": 56618937, "body": "@ErikAllik My guess would be no. But you can ask in the nix IRC just to be sure. (I would be interested to know that as well!). But note that any new Haskell package which is not yet in nixpkgs (or even Hackage!) can be easily tried out using the tool <code>cabal2nix</code>. The manual has more details regarding this."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 8, "last_activity_date": 1434801661, "last_edit_date": 1434801661, "creation_date": 1434800792, "answer_id": 30953616, "question_id": 30953382, "link": "https://stackoverflow.com/questions/30953382/what-is-haskellng-what-is-the-difference-between-haskellpackages-and-haskell/30953616#30953616", "title": "What is haskellng? What is the difference between &#39;haskellPackages&#39; and &#39;haskellngPackages&#39;?", "body": "<blockquote>\n  <p>Could someone please explain what haskellng is in a simple, clear way? </p>\n</blockquote>\n\n<p>Well, <code>haskellng</code> is the next generation Nix Haskell package set made for Nix. I think most of the work was done by Peter Simons. But <em>note</em> that in the latest master version, <code>haskellngPackages</code> has been renamed back to <code>haskellPackages</code>. So the difference doesn't matter if you are using living in the unstable channel.</p>\n\n<blockquote>\n  <p>Why does haskellng matter ? Why is it good ? </p>\n</blockquote>\n\n<p>With <code>haskellng</code>, I guess everything is automated. Someone uploads a package to hackage and in around a week, that package derivation is automatically included in the nix haskell package set (undex <code>nixpkgs</code>) by some process (I guess it makes use of <code>cabal2nix</code>).</p>\n\n<blockquote>\n  <p>What is the difference between 'haskellPackages' and 'haskellngPackages' ?</p>\n</blockquote>\n\n<p>In the latest master branch there is no difference between them as explained above.</p>\n\n<blockquote>\n  <p>What is 'haskellPackages' ? Where does it come from ? What is it used for ? </p>\n</blockquote>\n\n<p>It was the eariler infrastructure for Haskell nix packages. It was used for, um, creating and building Haskell packages.</p>\n\n<blockquote>\n  <p>What is the new code ? What was the old code ? Why is the new code it breaking what ?</p>\n</blockquote>\n\n<p>The new code is the <code>haskellngPackages</code>. The old code was <code>haskellPackages</code>. But it doesn't matter now as haskellng has been renamed back to the old name and the old code I guess is removed.</p>\n"}, {"tags": [], "owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "is_accepted": false, "score": 2, "last_activity_date": 1434800832, "last_edit_date": 1495541966, "creation_date": 1434800832, "answer_id": 30953621, "question_id": 30953382, "link": "https://stackoverflow.com/questions/30953382/what-is-haskellng-what-is-the-difference-between-haskellpackages-and-haskell/30953621#30953621", "title": "What is haskellng? What is the difference between &#39;haskellPackages&#39; and &#39;haskellngPackages&#39;?", "body": "<p>I asked this on the #nix channel :</p>\n\n<blockquote>\n  <p>me: Could someone please explain what haskellng is ?\n  <a href=\"https://stackoverflow.com/questions/30953382/what-is-haskellng-what-is-the-difference-between-haskellpackages-and-haskell\">What is haskellng? What is the difference between &#39;haskellPackages&#39; and &#39;haskellngPackages&#39;?</a></p>\n  \n  <p>Fuuzetsu: it no longer matters, it's the default new architecture and\n  the old one doesn't exist </p>\n  \n  <p>Fuuzetsu: we had 2 Haskell architectures for a while and -ng was the\n  new one</p>\n</blockquote>\n"}], "owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 2, "accepted_answer_id": 30953616, "answer_count": 2, "score": 6, "last_activity_date": 1434801661, "creation_date": 1434799234, "last_edit_date": 1495540099, "question_id": 30953382, "link": "https://stackoverflow.com/questions/30953382/what-is-haskellng-what-is-the-difference-between-haskellpackages-and-haskell", "title": "What is haskellng? What is the difference between &#39;haskellPackages&#39; and &#39;haskellngPackages&#39;?", "body": "<p>I have been reading this <a href=\"https://stackoverflow.com/questions/27968909/how-to-get-cabal-and-nix-work-together/27970684#27970684\">StackOverflow</a> post in which we are advised to use the <code>haskellng</code> package set. </p>\n\n<p>I have also read <a href=\"http://lists.science.uu.nl/pipermail/nix-dev/2015-January/015591.html\" rel=\"nofollow noreferrer\">this</a> but I did not understand what <code>haskellng</code> is.</p>\n\n<p>I have read <a href=\"https://iilab.org/news/2015-03-27-nix-osx-haskellng-hakyll.html\" rel=\"nofollow noreferrer\">this</a> too, but I still don't know what <code>haskellng</code> is.</p>\n\n<p>Could someone please explain what <code>haskellng</code> is in a simple, clear way? </p>\n\n<p>Why does <code>haskellng</code> matter ? Why is it good ? </p>\n\n<p>I understand that <code>haskellng</code> is replacing something. But what is that something that it replaces ? Why does that something need to be replaced ?</p>\n\n<p>In <a href=\"http://lists.science.uu.nl/pipermail/nix-dev/2015-January/015591.html\" rel=\"nofollow noreferrer\">this</a> post it is written:</p>\n\n<blockquote>\n  <h2>So I'll never have to update if I don't want to?</h2>\n  \n  <p>My guess is that 'haskellPackages' and 'haskellngPackages' will\n  co-exist for   a while. Personally, I switched to Haskell NG, though,\n  and I won't maintain   any packages in the old hierarchy anymore. I\n  suppose other contributors will   do the same thing. Once you've\n  converted your setup to 'haskellngPackages',   there's no reason to\n  look back, really.</p>\n</blockquote>\n\n<p>What is the difference between 'haskellPackages' and 'haskellngPackages' ?</p>\n\n<p>What is 'haskellPackages' ? Where does it come from ? What is it used for ? </p>\n\n<p>Also in the <a href=\"http://lists.science.uu.nl/pipermail/nix-dev/2015-January/015591.html\" rel=\"nofollow noreferrer\">same</a> post they write:</p>\n\n<blockquote>\n  <h2>Why should I care about this \"new infrastructure\"?</h2>\n  \n  <p>The new code will break evaluation of any Haskell-related\n  configuration you   may have in ~/.nixpkgs/config.nix or\n  /etc/nixos/configuration.nix.</p>\n  \n  <p>Privately generated cabal2nix expressions will cease to compile.</p>\n  \n  <p>Installations that rely on ghc-wrapper finding GHC libraries\n  automatically in   your ~/.nix-profile are obsolete. If you use this\n  approach, you won't be able   to update your profile anymore.</p>\n</blockquote>\n\n<p>What is <strong>the</strong> new code ? What was the old code ? Why is the new code breaking what ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1434792309, "post_id": 30952309, "comment_id": 49938168, "body": "the problem is <code>main = ...</code> - see <code>main</code> has type <code>IO ()</code> - I think you want <code>main = print $ powerset [1,2]</code> instead"}, {"owner": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "edited": false, "score": 0, "creation_date": 1434792481, "post_id": 30952309, "comment_id": 49938228, "body": "That solved the problem, thank You very much ! I have one more question, i want to be able to get input from standard input, how to make it as short as possible ?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1434792664, "post_id": 30952309, "comment_id": 49938280, "body": "see my answer - it&#39;s <code>getLine</code>"}], "answers": [{"comments": [{"owner": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "edited": false, "score": 0, "creation_date": 1434792689, "post_id": 30952391, "comment_id": 49938285, "body": "I know i should do this, but I just want to make it as short as possbile with input from standard input and output"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "edited": false, "score": 0, "creation_date": 1434792717, "post_id": 30952391, "comment_id": 49938293, "body": "I don&#39;t even know <b>what</b> you want to do - so how should I answer this question?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "edited": false, "score": 0, "creation_date": 1434792742, "post_id": 30952391, "comment_id": 49938302, "body": "maybe you are searching for <code>interact</code> ... but I just don&#39;t know"}, {"owner": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "edited": false, "score": 0, "creation_date": 1434792923, "post_id": 30952391, "comment_id": 49938341, "body": "I want to make the shortest possible implementation of powerset function, with input from standard input, output where [] are changed to {}, and it should be able to run on this platform <a href=\"http://rextester.com/runcode\" rel=\"nofollow noreferrer\">rextester.com/runcode</a>."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "edited": false, "score": 0, "creation_date": 1434793053, "post_id": 30952391, "comment_id": 49938376, "body": "so this is some kind of code-golf? In this case go with <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Data-List.html#v:subsequences\" rel=\"nofollow noreferrer\">subsequences</a>, <code>interact</code> ;) - I&#39;m sure there are lots of even more clever and very short snippets out there but I&#39;m not really good with this kind of stuff - I&#39;m usually happy when it works and is more or less readable ;)"}, {"owner": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "edited": false, "score": 0, "creation_date": 1434793559, "post_id": 30952391, "comment_id": 49938529, "body": "Yes, it is something as code-golf if my understanding what golf-code means is good. Subsequences is the answer i think ! In java there is a function replace() when i can replace every [ and ] with { and { }. Is there something simmialr in haskell ?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "edited": false, "score": 0, "creation_date": 1434793738, "post_id": 30952391, "comment_id": 49938578, "body": "yes - for example: <a href=\"https://hackage.haskell.org/package/cgi-3001.2.2.2/docs/Network-CGI-Protocol.html#v:replace\" rel=\"nofollow noreferrer\">replace</a> - you can search for stuff like this using <a href=\"https://www.haskell.org/hoogle/?hoogle=a+-%3E+a+-%3E+%5Ba%5D+-%3E+%5Ba%5D\" rel=\"nofollow noreferrer\">Hoogle</a> or Hayoo ;)  - also note that a simple <code>map</code> should do too (but it might end up not very short)"}, {"owner": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "edited": false, "score": 0, "creation_date": 1434793872, "post_id": 30952391, "comment_id": 49938617, "body": "Thank You very much for help, i know java and python only so functionall programming is something new to me but i start to like it a lot. !"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1434953185, "post_id": 30952391, "comment_id": 49977299, "body": "<code>interact</code> is ... yucky."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 6, "last_activity_date": 1434792825, "last_edit_date": 1434792825, "creation_date": 1434792442, "answer_id": 30952391, "question_id": 30952309, "link": "https://stackoverflow.com/questions/30952309/haskell-powerset-function-how-to-avoid-couldnt-match-expected-type-io-t0-wi/30952391#30952391", "title": "Haskell powerset function - How to avoid Couldn&#39;t match expected type `IO t0&#39; with actual type `[[Integer]]&#39;", "body": "<p>the problem is <code>main = ...</code> </p>\n\n<p><code>main</code> should have type <code>IO ()</code> but you give an expression with type <code>[[Integer]]</code> (as the compiler tells you) - so as I think you want to output the result to the console I think you are looking for <code>print</code></p>\n\n<p>this works for me:</p>\n\n<pre><code>import Control.Monad (filterM)\n\npowerset = filterM (const [True, False])\n\nmain =\n  print $ powerset[1,2]\n</code></pre>\n\n<p>having said this you should add the top-level signatures:</p>\n\n<pre><code>module Main where\n\nimport Control.Monad (filterM)\n\npowerset :: [a] -&gt; [[a]]\npowerset = filterM (const [True, False])\n\nmain :: IO ()\nmain =\n  print $ (powerset [1,2] :: [[Int]])\n</code></pre>\n\n<h3>additional question from comment</h3>\n\n<p>the usual way to get input from <strong>stdin</strong> is <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Prelude.html#v:getLine\" rel=\"noreferrer\"><code>getLine :: IO String</code></a></p>\n"}], "owner": {"reputation": 664, "user_id": 4334928, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/9SmKU.jpg?s=128&g=1", "display_name": "Cosaquee", "link": "https://stackoverflow.com/users/4334928/cosaquee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 30952391, "answer_count": 1, "score": 2, "last_activity_date": 1434935006, "creation_date": 1434791842, "last_edit_date": 1434935006, "question_id": 30952309, "link": "https://stackoverflow.com/questions/30952309/haskell-powerset-function-how-to-avoid-couldnt-match-expected-type-io-t0-wi", "title": "Haskell powerset function - How to avoid Couldn&#39;t match expected type `IO t0&#39; with actual type `[[Integer]]&#39;", "body": "<p>I have a powerset implementation that I'm trying to run here: <a href=\"http://rextester.com/runcode\" rel=\"nofollow\">http://rextester.com/runcode</a>. I'm still getting this error and can't figure out how to make it right. I'm trying to read as much as possible about IO in haskell but it is super hard for me.</p>\n\n<pre><code>import Control.Monad (filterM)\npowerset = filterM (const [True, False])\n\nmain =  powerset[1,2]\n</code></pre>\n"}, {"tags": ["haskell", "lazy-evaluation"], "comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1434788273, "post_id": 30951806, "comment_id": 49937189, "body": "If it weren&#39;t being lazy, it would loop forever <i>without anything being printed</i> (because it would have to calculate the full result before printing any of it and since that&#39;d take forever, nothing could ever be printed)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1434788729, "post_id": 30951806, "comment_id": 49937287, "body": "What were you hoping would happen instead?"}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 0, "creation_date": 1434793415, "post_id": 30951806, "comment_id": 49938489, "body": "You probably meant <code>take 1 $ take 1 $ repeat 1</code> (bdonlan&#39;s answer explains why). It really is lazy."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1434910317, "post_id": 30951806, "comment_id": 49966914, "body": "The result of <code>take 1 $ take 1 $ repeat [1..]</code> <i>is</i> <code>[[1..]]</code>, so ghci is giving you the correct answer."}], "answers": [{"tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": true, "score": 10, "last_activity_date": 1434788168, "creation_date": 1434788168, "answer_id": 30951817, "question_id": 30951806, "link": "https://stackoverflow.com/questions/30951806/why-is-lazy-evaluation-in-haskell-not-being-lazy/30951817#30951817", "title": "Why is lazy evaluation in Haskell &quot;not being lazy&quot;?", "body": "<p><code>take</code> is of type <code>Int -&gt; [a] -&gt; [a]</code>, i.e. it returns a list. It seems you\u2019re looking for <code>head</code>, which returns one element.</p>\n\n<pre><code>head $ head $ repeat [1..]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 204019, "user_id": 36723, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/d5a138149601087e78436b67718578cd?s=128&d=identicon&r=PG", "display_name": "bdonlan", "link": "https://stackoverflow.com/users/36723/bdonlan"}, "is_accepted": false, "score": 6, "last_activity_date": 1434788179, "creation_date": 1434788179, "answer_id": 30951820, "question_id": 30951806, "link": "https://stackoverflow.com/questions/30951806/why-is-lazy-evaluation-in-haskell-not-being-lazy/30951820#30951820", "title": "Why is lazy evaluation in Haskell &quot;not being lazy&quot;?", "body": "<p><code>take 1 $ repeat [1..]</code> returns <code>[[1..]]</code>. And then <code>take 1 [[1..]]</code> returns <code>[[1..]]</code>, a no-op.</p>\n"}], "owner": {"reputation": 27, "user_id": 3517870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e302877a6a385d8276f5b1a2fe6ab181?s=128&d=identicon&r=PG", "display_name": "Qi Ge", "link": "https://stackoverflow.com/users/3517870/qi-ge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 30951817, "answer_count": 2, "score": 1, "last_activity_date": 1434788179, "creation_date": 1434788032, "question_id": 30951806, "link": "https://stackoverflow.com/questions/30951806/why-is-lazy-evaluation-in-haskell-not-being-lazy", "title": "Why is lazy evaluation in Haskell &quot;not being lazy&quot;?", "body": "<p>When I tried the following code in cghi:</p>\n\n<pre><code>take 1 $ take 1 $ repeat [1..]\n</code></pre>\n\n<p>I was expecting the result of <code>1</code> instead of <code>[[1,2,3,4,5,6,7,8,9,10,...</code> printing on my terminal.</p>\n\n<p>Why is lazy evaluation not functioning as I'm hoping under such situation?</p>\n"}, {"tags": ["parsing", "haskell", "parsec", "happy", "alex"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 4, "creation_date": 1434788793, "post_id": 30951752, "comment_id": 49937306, "body": "Parsec is completely agnostic as to whether or not you&#39;re parsing line by line. The format of your data is very easily within the reach of Parsec, which is an industrial-strength parser designed for programming languages (with a far more complex grammar than your example!) Something like <code>parseBlock = between (string &quot;BEGIN\\n&quot;) (string &quot;END\\n&quot;) $ sepBy (char &#39;\\n&#39;) parseSingleLine</code> (where <code>parseSingleLine</code> parses one row of data) would work."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 1, "creation_date": 1434976768, "post_id": 30951752, "comment_id": 49990660, "body": "There is nothing about Parsec which is &quot;line by line&quot;. It should easily be able to handle this."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1436360997, "post_id": 30951752, "comment_id": 50578087, "body": "@BenjaminHodgson I think you meant <code>sepBy parseSingleLine (char &#39;\\n&#39;)</code>."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1436361540, "post_id": 30951752, "comment_id": 50578514, "body": "@JeanJoux Edit your question and specify the data types you want to use as the result(s) of your parser(s) in your example."}], "answers": [{"tags": [], "owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "is_accepted": true, "score": 0, "last_activity_date": 1437117344, "creation_date": 1437117344, "answer_id": 31470313, "question_id": 30951752, "link": "https://stackoverflow.com/questions/30951752/parsing-complex-files-with-parsec/31470313#31470313", "title": "Parsing complex files with Parsec", "body": "<p>The format as you've described wouldn't be hard at all to handle in parsec.</p>\n\n<p>As for learning how to use it: your first step should be to avoid whatever guide gave you the impression that parsec worked line-by-line. I recommend <a href=\"http://book.realworldhaskell.org/read/using-parsec.html\" rel=\"nofollow\" title=\"Chapter 16 of Real World Haskell\">Chapter 16 of Real World Haskell</a> as a good place to get started, and once you're comfortable with the basics the reference material at <a href=\"http://hackage.haskell.org/package/parsec\" rel=\"nofollow\">http://hackage.haskell.org/package/parsec</a> is actually very clear.</p>\n"}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 31470313, "answer_count": 1, "score": 0, "last_activity_date": 1437117344, "creation_date": 1434787702, "question_id": 30951752, "link": "https://stackoverflow.com/questions/30951752/parsing-complex-files-with-parsec", "title": "Parsing complex files with Parsec", "body": "<p>I would like to parse files with several sequences of data (same number of column, same content, ...) with Haskell.\nMy data sequences will be delimited by keywords before and after.</p>\n\n<pre><code>BEGIN\n1   882\n2   809\n3   435\n4   197\n5   229\n6   425\n...\nEND\n\nBEGIN\n1   235 623 684\n2   871 699 557\n3   918 686 49\n4   53  564 906\n5   246 344 501\n6   929 138 474\n...\nEND\n</code></pre>\n\n<p>My problem is that after several tests with Parsec, I have the impression that Parsec is rather made to parse a file <strong>line by line</strong> and not the <strong>whole file</strong>.</p>\n\n<p>Is <strong>Parsec</strong> the right way to make what I want or should I consider an other tool like <strong>Happy</strong> or <strong>Alex</strong> ?</p>\n\n<p>Is there a website (or other ressource) providing examples of parsing complex text files with <strong>Parsec</strong> ?</p>\n\n<hr>\n\n<p><em>Note : The example I give is a <strong>very simple</strong> one. Things would be more tricky in my files with many more keywords and combinations.</em></p>\n"}, {"tags": ["list", "haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1434787504, "post_id": 30951067, "comment_id": 49937028, "body": "Typo. You swapped the &#39;c&#39; and &#39;d&#39;."}], "answers": [{"comments": [{"owner": {"reputation": 2028, "user_id": 3604594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f477ab3e9b8421c16b5c04cb2acc48d1?s=128&d=identicon&r=PG&f=1", "display_name": "paK0", "link": "https://stackoverflow.com/users/3604594/pak0"}, "edited": false, "score": 0, "creation_date": 1434787903, "post_id": 30951595, "comment_id": 49937118, "body": "The catch all was just to get it to run, I removed it in the final version, but I guess this is why I didn&#39;t get a warning about the typo."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1434910470, "post_id": 30951595, "comment_id": 49966963, "body": "Thus it being a bad idea."}], "tags": [], "owner": {"reputation": 1679, "user_id": 1722752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef35ad86b627ba3176b6aea8a184f51c?s=128&d=identicon&r=PG", "display_name": "MigMit", "link": "https://stackoverflow.com/users/1722752/migmit"}, "is_accepted": true, "score": 4, "last_activity_date": 1434786381, "creation_date": 1434786381, "answer_id": 30951595, "question_id": 30951067, "link": "https://stackoverflow.com/questions/30951067/haskell-wont-match-against-a-list/30951595#30951595", "title": "Haskell won&#39;t match against a list", "body": "<p>It should give you at least a warning about function <code>endoceDirect</code>, which, of course, doesn't have anything to do with <code>encodeDirect</code>.</p>\n\n<p>As a side note, the catch-all case is usually a bad idea,</p>\n"}], "owner": {"reputation": 2028, "user_id": 3604594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f477ab3e9b8421c16b5c04cb2acc48d1?s=128&d=identicon&r=PG&f=1", "display_name": "paK0", "link": "https://stackoverflow.com/users/3604594/pak0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 30951595, "answer_count": 1, "score": 0, "last_activity_date": 1434786381, "creation_date": 1434782213, "question_id": 30951067, "link": "https://stackoverflow.com/questions/30951067/haskell-wont-match-against-a-list", "title": "Haskell won&#39;t match against a list", "body": "<p>I want to try out some haskell and started with 99 haskell problems, currently I'm stuck at 13: Run-length encoding of a list (though my question is more general)</p>\n\n<pre><code>--datatype\ndata En a = Multiple (Int, a) | Single a | Empty\n    deriving (Show)\n\n--helper\ngetnum :: (Eq a9) =&gt; [a9] -&gt; Int\ngetnum [] = 0\ngetnum (x:xs)\n    | x == head xs = 1 + getnum xs\n    | otherwise = 1\n\nencodeDirect :: [a] -&gt; [En a]\nendoceDirect xxs@(x:xs)\n    | getnum xxs == 1 = Single x : encodeDirect xs\n    | otherwise = Multiple ((getnum xxs), x) : encodeDirect (drop (getnum xxs) xxs)\nencodeDirect _ = [Empty]\n</code></pre>\n\n<p>This should give me the solution with an [Empty] at the end, but when I call encodeDirect with any kind of list/string from ghci it just falls straight through, and all I get is [Empty].</p>\n\n<p>Why does <code>xxs@(x:xs)</code> not match any list?</p>\n"}, {"tags": ["haskell", "yesod", "typeclass", "persistent"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1434822187, "post_id": 30951060, "comment_id": 49946835, "body": "You could write all the typeclass instances by hand, but it would be simpler to use <a href=\"https://hackage.haskell.org/package/persistent-template-2.1.3.4/docs/Database-Persist-TH.html\" rel=\"nofollow noreferrer\">persistent-template</a> to derive them."}, {"owner": {"reputation": 822, "user_id": 200916, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/68b75a235d71e5dacec3e2778a561775?s=128&d=identicon&r=PG", "display_name": "codygman", "link": "https://stackoverflow.com/users/200916/codygman"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1434843964, "post_id": 30951060, "comment_id": 49952572, "body": "@user2407038 I still need to create an EntityDef for each type right? For instance I don&#39;t see anything that can go from MyType -&gt; PersistEntity MyType in persist-template. Thanks for your help!"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1434850319, "post_id": 30951060, "comment_id": 49953462, "body": "You can use the <code>persistLowerCase</code> quasiquoter to create the <code>EntityDef</code> for each type - the syntax of <code>persistLowerCase</code> is very similar to that of Haskell datatype declarations, so changing your code shouldn&#39;t be hard."}, {"owner": {"reputation": 822, "user_id": 200916, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/68b75a235d71e5dacec3e2778a561775?s=128&d=identicon&r=PG", "display_name": "codygman", "link": "https://stackoverflow.com/users/200916/codygman"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1434880569, "post_id": 30951060, "comment_id": 49958581, "body": "@user2407038 The problem is that it is a libraries code. I was looking for a way to turn the already defined Tweet type into a PersistEntity so I can use the insert function on it."}], "owner": {"reputation": 822, "user_id": 200916, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/68b75a235d71e5dacec3e2778a561775?s=128&d=identicon&r=PG", "display_name": "codygman", "link": "https://stackoverflow.com/users/200916/codygman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1460022990, "creation_date": 1434782110, "last_edit_date": 1460022990, "question_id": 30951060, "link": "https://stackoverflow.com/questions/30951060/persistent-typeclass-instances-for-existing-libraries-adts", "title": "Persistent typeclass instances for existing libraries ADT&#39;s", "body": "<p>I'm trying to insert all data in a <a href=\"https://github.com/himura/twitter-types/blob/master/twitter-types/Web/Twitter/Types.hs#L122\" rel=\"nofollow\"><code>Status</code></a> with Persistent. What is the easiest way for me to make <code>Status</code> (and types within it) instances of <code>Persistent</code>?</p>\n\n<p>I'm going to have to create <code>PersistEntity</code> instances for each one right? Can anyone provide an example of one?</p>\n"}, {"tags": ["haskell", "tying-the-knot"], "comments": [{"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 1, "creation_date": 1434766340, "post_id": 30949430, "comment_id": 49933149, "body": "It&#39;s worth remembering that your link is GHC&#39;s implementation. You could very feasibly write a compiler that implements <code>iterate</code> that way. The people behind GHC simply chose not to."}], "answers": [{"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1434767217, "post_id": 30949550, "comment_id": 49933260, "body": "Thanks. But there is shared structure in, say, <code>iterate (0:) []</code>. Does this <code>iterate</code> handle this case properly?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1434767928, "post_id": 30949550, "comment_id": 49933355, "body": "sometimes sharing is not a gain but a loss, when it causes retention of structure in memory which could otherwise be discarded (when there&#39;s only one consumer, like e.g. <code>print</code>). if that&#39;s the case, recursion is preferable over corecursion."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1434769261, "post_id": 30949550, "comment_id": 49933562, "body": "@WillNess <code>iterate</code> always produces an infinite list. It&#39;s going to always depend on corecursion."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 2, "creation_date": 1434769529, "post_id": 30949550, "comment_id": 49933597, "body": "@user3237465 Yes, <code>iterate (0:) []</code> shares tails. That has nothing to do with tying the knot, though.  It&#39;s just because in <code>iterate f x = x : iterate f (f x)</code>, the variable <code>x</code> is shared between the two uses."}], "tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": true, "score": 11, "last_activity_date": 1437168464, "last_edit_date": 1437168464, "creation_date": 1434766059, "answer_id": 30949550, "question_id": 30949430, "link": "https://stackoverflow.com/questions/30949430/why-doesnt-iterate-from-the-prelude-tie-the-knot/30949550#30949550", "title": "Why doesn&#39;t `iterate` from the Prelude tie the knot?", "body": "<p>Tying the knot like that doesn't appear to increase sharing. </p>\n\n<p>Contrast with:</p>\n\n<pre><code>cycle xs = let x = xs ++ x in x\n</code></pre>\n\n<p>Tying the knot here has the effect of creating a circular linked list in memory.  <code>x</code> is its own tail.  There's a real gain.</p>\n\n<p>Your suggested implementation doesn't increase sharing over the naive implementation. And there's no way for it to do so in the first place - there's no shared structure in something like <code>iterate (+1) 0</code> anyway.</p>\n"}, {"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 3, "last_activity_date": 1434767724, "creation_date": 1434767724, "answer_id": 30949684, "question_id": 30949430, "link": "https://stackoverflow.com/questions/30949430/why-doesnt-iterate-from-the-prelude-tie-the-knot/30949684#30949684", "title": "Why doesn&#39;t `iterate` from the Prelude tie the knot?", "body": "<p>The Prelude definition, which I include below for clarity, has no overhead needed to call map.</p>\n\n<pre><code>iterate f x =  x : iterate f (f x)\n</code></pre>\n\n<p>Just for fun, I made a small quick program to test your <code>iterate</code> vs the Prelude's - just to reduce to normal form <code>take 100000000 $ iterate (+1) 0</code> (this is a list of <code>Int</code>s). I only ran 5 tests, but your version ran for <code>7.833</code> (max <code>7.873</code> min <code>7.667</code>) while the Prelude's was at <code>7.519</code> (max <code>7.591</code> min <code>7.477</code>). I suspect the time difference is the overhead of <code>map</code> getting called.</p>\n\n<p>Second reason is simply: readability.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 6, "last_activity_date": 1434768903, "creation_date": 1434768903, "answer_id": 30949800, "question_id": 30949430, "link": "https://stackoverflow.com/questions/30949430/why-doesnt-iterate-from-the-prelude-tie-the-knot/30949800#30949800", "title": "Why doesn&#39;t `iterate` from the Prelude tie the knot?", "body": "<p>There is no knot tying going on in your version, it just maintains a pointer one notch back on the produced list, to find the input value there for the next iteration. This means that each list cell can't be gc-ed until the next cell is produced. </p>\n\n<p>By contrast, the Prelude's version uses <code>iterate</code>'s call frame for that, and since it's needed only once, a good compiler could reuse that one frame and mutate the value in it, for more optimized operation overall (and list's cells are independent of each other in that case).</p>\n"}], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 30949550, "answer_count": 3, "score": 8, "last_activity_date": 1437168464, "creation_date": 1434764350, "question_id": 30949430, "link": "https://stackoverflow.com/questions/30949430/why-doesnt-iterate-from-the-prelude-tie-the-knot", "title": "Why doesn&#39;t `iterate` from the Prelude tie the knot?", "body": "<p>Why isn't <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/src/GHC-List.html#iterate\"><code>iterate</code></a> defined like</p>\n\n<pre><code>iterate :: (a -&gt; a) -&gt; a -&gt; [a]\niterate f x = xs where xs = x : map f xs\n</code></pre>\n\n<p>in the Prelude?</p>\n"}, {"tags": ["scala", "haskell", "lazy-evaluation", "currying"], "comments": [{"owner": {"reputation": 9225, "user_id": 3248346, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/377f7423a286949201e0aa8cb2257fcc?s=128&d=identicon&r=PG&f=1", "display_name": "M.K.", "link": "https://stackoverflow.com/users/3248346/m-k"}, "edited": false, "score": 0, "creation_date": 1434754537, "post_id": 30948272, "comment_id": 49931116, "body": "why do you want to curry it and make it lazy? Also currying is when you take a function that accepts <b>multiple</b> arguments and translate it into a sequence of functions each of which takes on argument."}, {"owner": {"reputation": 283, "user_id": 2006139, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/63e64168b880d7951df983f3abfd8765?s=128&d=identicon&r=PG", "display_name": "Sebastian Garrido", "link": "https://stackoverflow.com/users/2006139/sebastian-garrido"}, "reply_to_user": {"reputation": 9225, "user_id": 3248346, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/377f7423a286949201e0aa8cb2257fcc?s=128&d=identicon&r=PG&f=1", "display_name": "M.K.", "link": "https://stackoverflow.com/users/3248346/m-k"}, "edited": false, "score": 0, "creation_date": 1434754871, "post_id": 30948272, "comment_id": 49931200, "body": "I&#39;m used to the Haskell paradigms, kinda. It&#39;s mostly a learning exercise."}, {"owner": {"reputation": 9225, "user_id": 3248346, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/377f7423a286949201e0aa8cb2257fcc?s=128&d=identicon&r=PG&f=1", "display_name": "M.K.", "link": "https://stackoverflow.com/users/3248346/m-k"}, "edited": false, "score": 0, "creation_date": 1434755398, "post_id": 30948272, "comment_id": 49931335, "body": "but your function only takes one argument...how do you expect to curry it?"}, {"owner": {"reputation": 283, "user_id": 2006139, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/63e64168b880d7951df983f3abfd8765?s=128&d=identicon&r=PG", "display_name": "Sebastian Garrido", "link": "https://stackoverflow.com/users/2006139/sebastian-garrido"}, "reply_to_user": {"reputation": 9225, "user_id": 3248346, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/377f7423a286949201e0aa8cb2257fcc?s=128&d=identicon&r=PG&f=1", "display_name": "M.K.", "link": "https://stackoverflow.com/users/3248346/m-k"}, "edited": false, "score": 0, "creation_date": 1434757528, "post_id": 30948272, "comment_id": 49931784, "body": "@I.K. Look at the Haskell-like code. It shows that instead of using this we pass the object as a parameter"}], "answers": [{"tags": [], "owner": {"reputation": 9957, "user_id": 722180, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/hoSXr.png?s=128&g=1", "display_name": "bjfletcher", "link": "https://stackoverflow.com/users/722180/bjfletcher"}, "is_accepted": false, "score": 2, "last_activity_date": 1434754881, "creation_date": 1434754881, "answer_id": 30948497, "question_id": 30948272, "link": "https://stackoverflow.com/questions/30948272/writing-lazy-curried-in-scala-with-multiple-parameters/30948497#30948497", "title": "Writing lazy curried in scala with multiple parameters", "body": "<p>Here's a curried function example:</p>\n\n<pre><code>def addToPlayer(c: Circle, p: Player) = ... actual code...\ndef addToPlayer(c: Circle) = p: Player =&gt; addToPlayer(c, p)\n</code></pre>\n\n<p>Then you can do this:</p>\n\n<pre><code>val partial = addToPlayer(c)\nval complete = partial(p)\n</code></pre>\n\n<p>This is lazy because <code>addToPlayer(c, p)</code> isn't run until both parameters are given.</p>\n\n<p>HTH.</p>\n"}, {"tags": [], "owner": {"reputation": 747, "user_id": 4568811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a57f6b9a7464d58fcbf2698ba07be18?s=128&d=identicon&r=PG&f=1", "display_name": "harshtuna", "link": "https://stackoverflow.com/users/4568811/harshtuna"}, "is_accepted": false, "score": 0, "last_activity_date": 1434808368, "creation_date": 1434808368, "answer_id": 30954734, "question_id": 30948272, "link": "https://stackoverflow.com/questions/30948272/writing-lazy-curried-in-scala-with-multiple-parameters/30954734#30954734", "title": "Writing lazy curried in scala with multiple parameters", "body": "<p>maybe this way</p>\n\n<pre><code>def addToPlayer(p: PlayerCircle)(c: Circle): PlayerCircle = c match {\n  case AICircle(_, _, wr) =&gt; p.copy(p.x, p.y, p.r + wr)\n  case _ =&gt; p\n}\n</code></pre>\n"}], "owner": {"reputation": 283, "user_id": 2006139, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/63e64168b880d7951df983f3abfd8765?s=128&d=identicon&r=PG", "display_name": "Sebastian Garrido", "link": "https://stackoverflow.com/users/2006139/sebastian-garrido"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1434808368, "creation_date": 1434753473, "question_id": 30948272, "link": "https://stackoverflow.com/questions/30948272/writing-lazy-curried-in-scala-with-multiple-parameters", "title": "Writing lazy curried in scala with multiple parameters", "body": "<p>I'm writing code for a game as an exercise to learn Scala after getting acquainted with Haskell. I started with an ADT as follows:</p>\n\n<pre><code>sealed class Circle(x: Double, y: Double, r: Double)\n\ncase class PlayerCircle (x: Double, y: Double, r: Double) extends Circle(x, y, r)\n\ncase class AICircle (x: Double, y: Double, r: Double) extends Circle(x, y, r)\n</code></pre>\n\n<p>I'm trying to write a lazy, curried val that does as follows (in Haskell pseudocode):</p>\n\n<pre><code>addToPlayer :: PlayerCircle -&gt; Circle -&gt; PlayerCircle\naddToPlayer (PlayerCircle px py pr) (AICircle _ _ cr) = PlayerCircle px py (pr + cr)\naddToPlayer player _ = player\n</code></pre>\n\n<p>I have the following:</p>\n\n<pre><code>def addToPlayer (wcircle : Circle) : PlayerCircle = wcircle match {\n    case AICircle (_, _, wr) =&gt; copy(this.x, this.y, this.r + wr)\n    case _ =&gt; this\n}\n</code></pre>\n\n<p>What is necessary to make this function curried and lazy?</p>\n\n<p>Edit: I've googled for the answer but haven't found any article of use so please help me with this one.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 4329377, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/--Jf-Vxi9HSQ/AAAAAAAAAAI/AAAAAAAAAzU/r3SujqRJNnc/photo.jpg?sz=128", "display_name": "Walle", "link": "https://stackoverflow.com/users/4329377/walle"}, "edited": false, "score": 0, "creation_date": 1434746188, "post_id": 30946598, "comment_id": 49928282, "body": "I tried erasing &quot;Integer&quot; and now I&#39;m getting Couldn&#39;t match expected type <code>String&#39; against inferred type </code>Char&#39;"}], "tags": [], "owner": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "is_accepted": false, "score": 1, "last_activity_date": 1434745027, "creation_date": 1434745027, "answer_id": 30946598, "question_id": 30946562, "link": "https://stackoverflow.com/questions/30946562/tokenizer-identifier-in-haskell/30946598#30946598", "title": "Tokenizer identifier in Haskell", "body": "<p>When constructing a <code>TNumber</code>, you don't need to (and shouldn't) include the types of each of the constructor's arguments.  Thus, you need to change this:</p>\n\n<pre><code>| isDigit c = TNumber Integer (read c) : tokenize cs\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>| isDigit c = TNumber (read c) : tokenize cs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "is_accepted": true, "score": 2, "last_activity_date": 1434746813, "creation_date": 1434746813, "answer_id": 30947020, "question_id": 30946562, "link": "https://stackoverflow.com/questions/30946562/tokenizer-identifier-in-haskell/30947020#30947020", "title": "Tokenizer identifier in Haskell", "body": "<p>For the <code>Not in scope: data constructor 'Integer'</code> part, the problem is that you have an extra <code>Integer</code> in the line</p>\n\n<pre><code>isDigit c = TNumber Integer (read c) : tokenize cs\n</code></pre>\n\n<p>which should be</p>\n\n<pre><code>isDigit c = TNumber (read [c]) : tokenize cs\n</code></pre>\n\n<p>The <code>[c]</code> part is needed because <code>read</code> has type <code>read :: Read a =&gt; String -&gt; a</code>, and <code>c</code> is a <code>Char</code>, but <code>[c]</code> is a <code>String</code> containing only the char <code>c</code>.</p>\n\n<hr>\n\n<p><code>tokenize \"abc\"</code> is returning <code>[TError, TError, TError]</code> because of your error treatment policy:</p>\n\n<pre><code>| otherwise = TError : tokenize cs\n</code></pre>\n\n<p>This leads us to:</p>\n\n<pre><code>tokenize \"abc\"\n-- c = 'a', cs = \"bc\"\nTError : tokenize \"bc\"\nTError : (TError : tokenize \"c\")\nTError : TError : TError : []\n[TError, TError, TError]\n</code></pre>\n\n<p>if you want to group all of your errors in a single <code>TError</code>, then you should drop all the incorrect input</p>\n\n<pre><code>| otherwise = TError : (dropWhile (\\o -&gt; o == TError) (tokenize cs))\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 4329377, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/--Jf-Vxi9HSQ/AAAAAAAAAAI/AAAAAAAAAzU/r3SujqRJNnc/photo.jpg?sz=128", "display_name": "Walle", "link": "https://stackoverflow.com/users/4329377/walle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 30947020, "answer_count": 2, "score": 0, "last_activity_date": 1434746813, "creation_date": 1434744865, "last_edit_date": 1434746309, "question_id": 30946562, "link": "https://stackoverflow.com/questions/30946562/tokenizer-identifier-in-haskell", "title": "Tokenizer identifier in Haskell", "body": "<p>I'm writing this small program basically to identify each input tokens as operator/parenthesis/int.</p>\n\n<p>However, I encountered a problem stating that </p>\n\n<pre><code>Not in scope: data constructor `Integer'\n</code></pre>\n\n<p>Here's what I have so far (<code>Data.Char</code> only defines <code>isDigit</code>, nothing else)</p>\n\n<pre><code>import Data.Char (isDigit)\ndata Token = TPlus | TTimes | TParenLeft | TParenRight | TNumber Integer | TError\n    deriving (Show, Eq)\n\n\ntokenize :: String -&gt; [Token]\ntokenize [] = []\ntokenize (c:cs)\n    | c == '+' = TPlus : tokenize cs\n    | c == '*' = TTimes : tokenize cs\n    | c == '(' = TParenLeft : tokenize cs\n    | c == ')' = TParenRight : tokenize cs\n    | isDigit c = TNumber Integer (read c) : tokenize cs\n    | otherwise = TError : tokenize cs\n</code></pre>\n\n<p>Some example expected output:</p>\n\n<pre><code>*Main&gt; tokenize \"( 1 + 2 )\"\n</code></pre>\n\n<p>should give</p>\n\n<pre><code>[TParenLeft,TNumber 1,TPlus,TNumber 2,TParenRight]\n</code></pre>\n\n<p>and</p>\n\n<pre><code>*Main&gt; tokenize \"abc\"\n</code></pre>\n\n<p>should expect <code>TError</code>, but I'm getting</p>\n\n<pre><code>[TError,TError,TError]\n</code></pre>\n\n<p>I'd appreciate if anyone could shed some light on these two issues.</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 0, "creation_date": 1434719373, "post_id": 30938041, "comment_id": 49912748, "body": "In the book page, there is a type synonym for AuthID: type AuthId App = Text, which says that AuthId is equivalent to Text. What&#39;s the definition of your UserId?"}, {"owner": {"reputation": 287, "user_id": 3191372, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/jqFzX.jpg?s=128&g=1", "display_name": "Thibaud Dauce", "link": "https://stackoverflow.com/users/3191372/thibaud-dauce"}, "reply_to_user": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 0, "creation_date": 1434791921, "post_id": 30938041, "comment_id": 49938075, "body": "I just edit the main post to add more information"}], "answers": [{"comments": [{"owner": {"reputation": 287, "user_id": 3191372, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/jqFzX.jpg?s=128&g=1", "display_name": "Thibaud Dauce", "link": "https://stackoverflow.com/users/3191372/thibaud-dauce"}, "edited": false, "score": 0, "creation_date": 1434966240, "post_id": 30974740, "comment_id": 49984070, "body": "Thanks a lot for your help. I now have:     Foundation.hs:74:38:         Couldn&#39;t match type \u2018Key User\u2019 with \u2018User\u2019         Expected type: User           Actual type: AuthId App         In the expression: isAdmin         In an equation for \u2018isAuthorized\u2019:             isAuthorized PublishArticleR _ = isAdmin         In the instance declaration for \u2018Yesod App\u2019  I don&#39;t understand what is ident really? The ID from the database? I tried with no success:         Just ident -&gt; case (get ident) of             (User &quot;admin&quot; _) -&gt; Authorized"}, {"owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "reply_to_user": {"reputation": 287, "user_id": 3191372, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/jqFzX.jpg?s=128&g=1", "display_name": "Thibaud Dauce", "link": "https://stackoverflow.com/users/3191372/thibaud-dauce"}, "edited": false, "score": 0, "creation_date": 1434983672, "post_id": 30974740, "comment_id": 49995576, "body": "Ah sorry, there&#39;s a mismatch here. Your User is the full object, while maybeAuthId gives back the ID of the user in the db. That&#39;s what your error means. So you can do it two ways: retrieve the users from the db that have admin rights, and see if the key given back to you is one of them, or read the user from the id when you get it..."}, {"owner": {"reputation": 287, "user_id": 3191372, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/jqFzX.jpg?s=128&g=1", "display_name": "Thibaud Dauce", "link": "https://stackoverflow.com/users/3191372/thibaud-dauce"}, "edited": false, "score": 0, "creation_date": 1435135780, "post_id": 30974740, "comment_id": 50068822, "body": "I don&#39;t find how to get the User from the ID in this function (case in case doesn&#39;t work as I was expected). Why &quot;Just ident -&gt; case (get ident) of (User &quot;admin&quot; _) -&gt; Authorized&quot; don&#39;t work? Thanks"}, {"owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "reply_to_user": {"reputation": 287, "user_id": 3191372, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/jqFzX.jpg?s=128&g=1", "display_name": "Thibaud Dauce", "link": "https://stackoverflow.com/users/3191372/thibaud-dauce"}, "edited": false, "score": 0, "creation_date": 1435136231, "post_id": 30974740, "comment_id": 50069091, "body": "ident and userId are two different things. The userId is the numeric primary key generated by persistent while ident is the user login name. Maybe you need to change your AuthId to be a Text."}], "tags": [], "owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "is_accepted": false, "score": 1, "last_activity_date": 1434984712, "last_edit_date": 1434984712, "creation_date": 1434959984, "answer_id": 30974740, "question_id": 30938041, "link": "https://stackoverflow.com/questions/30938041/yesod-admin-auth-with-browserid-and-the-scaffolded-website/30974740#30974740", "title": "Yesod admin auth with BrowserId and the scaffolded website", "body": "<p><code>maybeAuthId</code> will return an <code>AuthId</code> object if the user is authenticated. In the example from the yesod book, <code>AuthId</code> is only a synonym for <code>Text</code>: it's only a user name. <code>Text</code> objects (and other types that have <code>IsString</code> instances) can be built from string literals, which is why the example code works: Haskell knows how to transform </p>\n\n<blockquote>\n  <p>\"admin\"</p>\n</blockquote>\n\n<p>into a <code>Text</code> object.</p>\n\n<p>You're using a more complex type to represent a logged in User, so you either need to provide a IsString instance for User (which will build a user without a password, say):</p>\n\n<pre><code>instance IsString User where\n   fromString s = User (pack s) \"\"\n</code></pre>\n\n<p>Or, maybe easier, modify your <code>isAdmin</code> function to get the <code>ident</code> part of your <code>User</code> object, something like:</p>\n\n<pre><code> isAdmin = do\n   mu &lt;- maybeAuthId\n   return $ case mu of\n     Nothing -&gt; AuthenticationRequired\n     Just (User ident _) -&gt; case ident of\n       \"admin\" -&gt; Authorized\n       _ -&gt; Unauthorized \"You must be an admin\"\n</code></pre>\n\n<p>EDIT\nI misread your definition of AuthId, I thought it was </p>\n\n<pre><code>type AuthId App = User\n</code></pre>\n\n<p>In fact, what you have is UserID, which are the IDs of your User objects in your database. So you can do two things: precompute the list of IDs of users that have admin privilege and see if the user id maybeAuthId gives you is one of them, or read the User in the db from the given ID and see if he has the rights...</p>\n"}], "owner": {"reputation": 287, "user_id": 3191372, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/jqFzX.jpg?s=128&g=1", "display_name": "Thibaud Dauce", "link": "https://stackoverflow.com/users/3191372/thibaud-dauce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434984712, "creation_date": 1434716556, "last_edit_date": 1434791833, "question_id": 30938041, "link": "https://stackoverflow.com/questions/30938041/yesod-admin-auth-with-browserid-and-the-scaffolded-website", "title": "Yesod admin auth with BrowserId and the scaffolded website", "body": "<p>I'm trying to do a very simple app with Yesod (a blog app) following <a href=\"https://www.youtube.com/watch?v=SadfV-qbVg8\" rel=\"nofollow\">https://www.youtube.com/watch?v=SadfV-qbVg8</a> (I used the scaffolded website)</p>\n\n<p>I want to add a simple authentification to secure the access of the creation of an article.</p>\n\n<p>Following <a href=\"http://www.yesodweb.com/book/authentication-and-authorization\" rel=\"nofollow\">http://www.yesodweb.com/book/authentication-and-authorization</a>, I added:</p>\n\n<pre><code>-- Routes not requiring authentication.\nisAuthorized (AuthR _) _ = return Authorized\nisAuthorized FaviconR _ = return Authorized\nisAuthorized RobotsR _ = return Authorized\nisAuthorized PublishArticleR _ = isAdmin\n-- Default to Authorized for now.\nisAuthorized _ _ = return Authorized\n</code></pre>\n\n<p>My new route is PublishArticleR. The isAdmin function is the same as in the book:</p>\n\n<pre><code>isAdmin = do\n    mu &lt;- maybeAuthId\n    return $ case mu of\n        Nothing -&gt; AuthenticationRequired\n        Just \"admin\" -&gt; Authorized\n        Just _ -&gt; Unauthorized \"You must be an admin\"\n</code></pre>\n\n<p>And it doesn't compile :(</p>\n\n<pre><code>Foundation.hs:76:38:\n    No instance for (IsString UserId) arising from a use of \u2018isAdmin\u2019\n    In the expression: isAdmin\n    In an equation for \u2018isAuthorized\u2019:\n        isAuthorized PublishArticleR _ = isAdmin\n    In the instance declaration for \u2018Yesod App\u2019\n</code></pre>\n\n<p>I don't understand what I'm doing wrong\u2026</p>\n\n<p>Thanks,</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>More information about my AuthId, it's defined like this:</p>\n\n<pre><code>type AuthId App = UserId\n</code></pre>\n\n<p>My model is:</p>\n\n<pre><code>User\n    ident Text\n    password Text Maybe\n    UniqueUser ident\n    deriving Typeable\n</code></pre>\n\n<p>And I want to check if the ident property is equal to something (like my email address for example) to authorize to publish new articles.</p>\n"}, {"tags": ["haskell", "persistence", "acid-state"], "comments": [{"owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 0, "creation_date": 1434718334, "post_id": 30936644, "comment_id": 49912005, "body": "Looking at the source code for Acid-State, you can see how to read the events file to get a list of entries with the update method used and the data, but none of this is exposed in the API."}], "answers": [{"tags": [], "owner": {"reputation": 3116, "user_id": 353187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfdc97f71e1b8c257ae1bbd52989785d?s=128&d=identicon&r=PG", "display_name": "xnyhps", "link": "https://stackoverflow.com/users/353187/xnyhps"}, "is_accepted": false, "score": 2, "last_activity_date": 1434876759, "creation_date": 1434876759, "answer_id": 30962801, "question_id": 30936644, "link": "https://stackoverflow.com/questions/30936644/use-acid-state-like-event-log-in-haskell/30962801#30962801", "title": "Use acid-state like event log in Haskell", "body": "<p>Here's the approach I ended up with:</p>\n\n<p>I was already using a wrapper around <a href=\"https://hackage.haskell.org/package/acid-state-0.12.4/docs/Data-Acid.html#v:update\" rel=\"nofollow\"><code>Data.Acid.update</code></a> (because it's running in a monad with restricted IO) and I realized that the wrapper could store the event to my own log. The <code>UpdateEvent update</code> constraint implies <code>SafeCopy update</code> and with <code>runPut . safePut</code> I can serialize that to a <code>ByteString</code>. However... this is a binary representation, not intended to be humand-readable, and I wanted to be able to review it. I realized that reading the acid-state event log from disk would have the same problem.</p>\n\n<p>So I added <code>Show update</code> to the constraints of my wrapper. At every place that uses the state I added:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE StandaloneDeriving #-}\n\n...\n\n$(makeAcidic ''State ['update])\n\nderiving instance Show Update\n</code></pre>\n\n<p>(StandaloneDeriving might be a little controversial, but it does not cause a problem with orphans here, as it's in the same file.)</p>\n\n<p>In the wrapper I now call <code>show</code> on the update and write the result to my own log file. Of course this loses the atomicity of the update: it is possible the application crashes between the <code>update</code> call and my own logging call, but I'm willing to accept that risk.</p>\n"}], "owner": {"reputation": 3116, "user_id": 353187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfdc97f71e1b8c257ae1bbd52989785d?s=128&d=identicon&r=PG", "display_name": "xnyhps", "link": "https://stackoverflow.com/users/353187/xnyhps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 3, "answer_count": 1, "score": 7, "last_activity_date": 1434876759, "creation_date": 1434712106, "last_edit_date": 1434724830, "question_id": 30936644, "link": "https://stackoverflow.com/questions/30936644/use-acid-state-like-event-log-in-haskell", "title": "Use acid-state like event log in Haskell", "body": "<p>I'm using <a href=\"https://hackage.haskell.org/package/acid-state\" rel=\"nofollow\">acid-state</a> in a project and I quite like it. I like how easy it is to add persistence to plain Haskell datatypes without much boilerplate. </p>\n\n<p>As far as I understand, acid-state keeps a log of events, instead of writing out the entire new state on every update. What I'm looking for is a way for me to review a log of recent changes to the state from within the application, as a (read-only) list. (Something like <code>git log</code>, though I don't need branching or being able to go back to an older commit.)</p>\n\n<p>Of course I can write to my own separate log file with details of all state changes, or even model my data as a list of diffs, but I prefer something that is automatic and allows me to use plain datatypes as much as possible.</p>\n\n<p>Is there a library similar to acid-state, or perhaps some internal functionality of acid-state that I could use for this?</p>\n"}, {"tags": ["haskell", "travis-ci"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1434695973, "post_id": 30931509, "comment_id": 49898379, "body": "The title of the question and the body contradicts one other. Does travis enforce the use of GHC 7.10 or lack support for it?"}, {"owner": {"reputation": 6116, "user_id": 1241368, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7019dabd783b2ecfaf04f5440ebb56df?s=128&d=identicon&r=PG", "display_name": "Mike Izbicki", "link": "https://stackoverflow.com/users/1241368/mike-izbicki"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 2, "creation_date": 1434696372, "post_id": 30931509, "comment_id": 49898601, "body": "Travis lacks support.  The &quot;they&quot; was referring to my projects, not travis."}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 7, "last_activity_date": 1434696381, "creation_date": 1434696381, "answer_id": 30931655, "question_id": 30931509, "link": "https://stackoverflow.com/questions/30931509/when-will-travis-ci-support-ghc-7-10/30931655#30931655", "title": "When will travis-ci support ghc 7.10?", "body": "<p>Using <a href=\"https://github.com/hvr/multi-ghc-travis\">multi-ghc-travis</a>, you can also set up Travis-CI for ghc 7.10 (apart from other versions).</p>\n"}], "owner": {"reputation": 6116, "user_id": 1241368, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7019dabd783b2ecfaf04f5440ebb56df?s=128&d=identicon&r=PG", "display_name": "Mike Izbicki", "link": "https://stackoverflow.com/users/1241368/mike-izbicki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 30931655, "answer_count": 1, "score": 4, "last_activity_date": 1434696381, "creation_date": 1434695849, "question_id": 30931509, "link": "https://stackoverflow.com/questions/30931509/when-will-travis-ci-support-ghc-7-10", "title": "When will travis-ci support ghc 7.10?", "body": "<p>I'd like to use travis-ci on my Haskell projects, but they require the latest version of GHC.</p>\n"}, {"tags": ["haskell", "formatting", "rational-number"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 2, "creation_date": 1434695918, "post_id": 30931369, "comment_id": 49898353, "body": "Converting to a <code>RealFloat</code> using <code>Numeric.fromRat</code> and then showing the float using <code>Numeric.show*Float</code> functions isn&#39;t an option?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1434703339, "post_id": 30931369, "comment_id": 49902505, "body": "Are you sure you <i>need</i> <code>Rational</code>, when you only want a decimal approximation in the end?"}, {"owner": {"reputation": 6116, "user_id": 1241368, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7019dabd783b2ecfaf04f5440ebb56df?s=128&d=identicon&r=PG", "display_name": "Mike Izbicki", "link": "https://stackoverflow.com/users/1241368/mike-izbicki"}, "edited": false, "score": 0, "creation_date": 1434739050, "post_id": 30931369, "comment_id": 49924935, "body": "The decimal approximation is only to make debugging easier.  And I want up to thousands of digits of accuracy."}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 9, "last_activity_date": 1434697260, "creation_date": 1434697260, "answer_id": 30931926, "question_id": 30931369, "link": "https://stackoverflow.com/questions/30931369/how-to-convert-a-rational-into-a-pretty-string/30931926#30931926", "title": "How to convert a Rational into a &quot;pretty&quot; String?", "body": "<p>You can make it. Not elegant, but does the job:</p>\n\n<pre><code>import Numeric\nimport Data.Ratio\n\ndisplay :: Int -&gt; Rational -&gt; String\ndisplay n x = (showFFloat (Just n) $ fromRat x) \"\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6116, "user_id": 1241368, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7019dabd783b2ecfaf04f5440ebb56df?s=128&d=identicon&r=PG", "display_name": "Mike Izbicki", "link": "https://stackoverflow.com/users/1241368/mike-izbicki"}, "edited": false, "score": 0, "creation_date": 1434739000, "post_id": 30938328, "comment_id": 49924912, "body": "If no one comes along with a standard library solution I&#39;ll accept this."}], "tags": [], "owner": {"reputation": 3116, "user_id": 353187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfdc97f71e1b8c257ae1bbd52989785d?s=128&d=identicon&r=PG", "display_name": "xnyhps", "link": "https://stackoverflow.com/users/353187/xnyhps"}, "is_accepted": true, "score": 7, "last_activity_date": 1489849895, "last_edit_date": 1489849895, "creation_date": 1434717408, "answer_id": 30938328, "question_id": 30931369, "link": "https://stackoverflow.com/questions/30931369/how-to-convert-a-rational-into-a-pretty-string/30938328#30938328", "title": "How to convert a Rational into a &quot;pretty&quot; String?", "body": "<p>Here is an arbitrary precision solution that doesn't use floats:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Ratio\n\ndisplay :: Int -&gt; Rational -&gt; String\ndisplay len rat = (if num &lt; 0 then \"-\" else \"\") ++ (shows d (\".\" ++ take len (go next)))\n    where\n        (d, next) = abs num `quotRem` den\n        num = numerator rat\n        den = denominator rat\n\n        go 0 = \"\"\n        go x = let (d, next) = (10 * x) `quotRem` den\n               in shows d (go next)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 7, "last_activity_date": 1434734658, "last_edit_date": 1434734658, "creation_date": 1434734331, "answer_id": 30943807, "question_id": 30931369, "link": "https://stackoverflow.com/questions/30931369/how-to-convert-a-rational-into-a-pretty-string/30943807#30943807", "title": "How to convert a Rational into a &quot;pretty&quot; String?", "body": "<p>Arbitrary precision version that re-uses <a href=\"http://hackage.haskell.org/package/numbers-3000.2.0.1/docs/Data-Number-CReal.html\" rel=\"noreferrer\">library code</a>:</p>\n\n<pre><code>import Data.Number.CReal\n\ndisplay :: Int -&gt; Rational -&gt; String\ndisplay digits num = showCReal digits (fromRational num)\n</code></pre>\n\n<p>I know I've seen a function before that converts rationals into digits in a way that's easier to inspect (i.e. that makes it quite clear where the digits start repeating), but I can't seem to find it now. In any case, it's not hard to write, if that turns out to be a need; you just code up the usual long-division algorithm and watch for divisions you've already done.</p>\n"}, {"tags": [], "owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "is_accepted": false, "score": 1, "last_activity_date": 1434975142, "creation_date": 1434975142, "answer_id": 30979717, "question_id": 30931369, "link": "https://stackoverflow.com/questions/30931369/how-to-convert-a-rational-into-a-pretty-string/30979717#30979717", "title": "How to convert a Rational into a &quot;pretty&quot; String?", "body": "<p>Here's one that I wrote a few weeks ago.  You can specify the number of decimals you want (correctly rounded), or just pass <code>Nothing</code> in which case it will print the full precision, including marking the repeated decimals.</p>\n\n<pre><code>module ShowRational where\nimport Data.List(findIndex, splitAt)\n\n-- | Convert a 'Rational' to a 'String' using the given number of decimals.\n-- If the number of decimals is not given the full precision is showed using (DDD) for repeating digits.\n-- E.g., 13.7/3 is shown as \\\"4.5(6)\\\".\nshowRational :: Maybe Int -&gt; Rational -&gt; String\nshowRational (Just n) r =\n    let d = round (abs r * 10^n)\n        s = show (d :: Integer)\n        s' = replicate (n - length s + 1) '0' ++ s\n        (h, f) = splitAt (length s' - n) s'\n    in  (if r &lt; 0 then \"-\" else \"\") ++ h ++ \".\" ++ f\n-- The length of the repeating digits is related to the totient function of the denominator.\n-- This means that the complexity of computing them is at least as bad as factoring, i.e., it quickly becomes infeasible.\nshowRational Nothing r =\n    let (i, f) = properFraction (abs r) :: (Integer, Rational)\n        si = if r &lt; 0 then \"-\" ++ show i else show i\n        decimals f = loop f [] \"\"\n        loop x fs ds =\n            if x == 0 then\n                ds\n            else\n                case findIndex (x ==) fs of\n                    Just i  -&gt; let (l, r) = splitAt i ds in l ++ \"(\" ++ r ++ \")\"\n                    Nothing -&gt; let (c, f) = properFraction (10 * x) :: (Integer, Rational) in loop f (fs ++ [x]) (ds ++ show c)\n    in  if f == 0 then si else si ++ \".\" ++ decimals f\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7182648, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_ACN5WsFFxk/AAAAAAAAAAI/AAAAAAAAAOg/bmXvyjUjnK4/photo.jpg?sz=128", "display_name": "George Rogers", "link": "https://stackoverflow.com/users/7182648/george-rogers"}, "is_accepted": false, "score": 2, "last_activity_date": 1479569704, "creation_date": 1479569704, "answer_id": 40694661, "question_id": 30931369, "link": "https://stackoverflow.com/questions/30931369/how-to-convert-a-rational-into-a-pretty-string/40694661#40694661", "title": "How to convert a Rational into a &quot;pretty&quot; String?", "body": "<pre><code>import Data.List as L\nimport Data.Ratio\n\ndisplay :: (Integral i, Show i) =&gt; Int -&gt; Ratio i -&gt; String\ndisplay len rat = (if num &lt; 0 then \"-\" else \"\") ++ show ip ++ \".\" ++ L.take len (go (abs num - ip * den))\n  where\n    num = numerator rat\n    den = denominator rat\n    ip  = abs num `quot` den\n\n    go 0 = \"\"\n    go x = shows d (go next)\n      where\n        (d, next) = (10 * x) `quotRem` den\n</code></pre>\n"}], "owner": {"reputation": 6116, "user_id": 1241368, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7019dabd783b2ecfaf04f5440ebb56df?s=128&d=identicon&r=PG", "display_name": "Mike Izbicki", "link": "https://stackoverflow.com/users/1241368/mike-izbicki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1690, "favorite_count": 2, "accepted_answer_id": 30938328, "answer_count": 5, "score": 8, "last_activity_date": 1489849895, "creation_date": 1434695389, "question_id": 30931369, "link": "https://stackoverflow.com/questions/30931369/how-to-convert-a-rational-into-a-pretty-string", "title": "How to convert a Rational into a &quot;pretty&quot; String?", "body": "<p>I want to display some <code>Rational</code> values in their decimal expansion.  That is, instead of displaying <code>3 % 4</code>, I would rather display <code>0.75</code>.  I'd like this function to be of type <code>Int -&gt; Rational -&gt; String</code>.  The first <code>Int</code> is to specify the maximum number of decimal places, since <code>Rational</code> expansions may be non-terminating.</p>\n\n<p><a href=\"https://www.haskell.org/hoogle/?hoogle=Int%20-%3E%20Rational%20-%3E%20String\" rel=\"noreferrer\">Hoogle</a> and the <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Ratio.html\" rel=\"noreferrer\">haddocks for Data.Ratio</a> didn't help me.  Where can I find this function?</p>\n"}, {"tags": ["sockets", "haskell", "network-programming", "io-monad"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 2, "creation_date": 1434693283, "post_id": 30930768, "comment_id": 49897274, "body": "Why are you using <code>foldl</code> instead of <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Control-Monad.html#v:foldM\" rel=\"nofollow noreferrer\"><code>foldM_</code></a>?"}, {"owner": {"reputation": 106969, "user_id": 189179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bab16b3716e0e72b8b1a7741d68f5ee2?s=128&d=identicon&r=PG", "display_name": "Ben James", "link": "https://stackoverflow.com/users/189179/ben-james"}, "edited": false, "score": 4, "creation_date": 1434693855, "post_id": 30930768, "comment_id": 49897500, "body": "What do you mean by &quot;more monadic&quot;?"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1434829448, "post_id": 30930768, "comment_id": 49949079, "body": "I think the <code>foldl1</code> is the culprit for the crash - you cannot usefully left fold over an infinite list, it will loop infinitely or raise an exception, and might run out of memory."}], "answers": [{"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 11, "last_activity_date": 1434693857, "creation_date": 1434693857, "answer_id": 30930970, "question_id": 30930768, "link": "https://stackoverflow.com/questions/30930768/refactor-an-io-recursive-loop-into-a-monad-folding-in-haskell/30930970#30930970", "title": "Refactor an IO recursive loop into a monad folding in Haskell", "body": "<p>The idiomatic way to repeat the same action over and over again forever is <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Monad.html#v:forever\"><code>forever</code></a></p>\n\n<pre><code>serverLoop :: Socket -&gt; IO ()\nserverLoop sock = forever $ do\n    (conn, _) &lt;- accept sock\n    forkIO $ handleConn conn\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 482, "user_id": 1744195, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9611c06ea57e880f5b09538bf96e2d50?s=128&d=identicon&r=PG", "display_name": "Ariel D. Moya Sequeira", "link": "https://stackoverflow.com/users/1744195/ariel-d-moya-sequeira"}, "is_accepted": false, "score": 2, "last_activity_date": 1434726199, "creation_date": 1434726199, "answer_id": 30941423, "question_id": 30930768, "link": "https://stackoverflow.com/questions/30930768/refactor-an-io-recursive-loop-into-a-monad-folding-in-haskell/30941423#30941423", "title": "Refactor an IO recursive loop into a monad folding in Haskell", "body": "<p>I don't know what you mean by \"more monadic\", but your function can be written this way:</p>\n\n<pre><code>serverLoop :: Socket -&gt; IO ()\nserverLoop sock = forever (accept sock &gt;&gt;= forkIO . handleConn . fst)\n</code></pre>\n"}], "owner": {"reputation": 360, "user_id": 4383917, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gD22F.jpg?s=128&g=1", "display_name": "Antoine Catton", "link": "https://stackoverflow.com/users/4383917/antoine-catton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 1, "accepted_answer_id": 30930970, "answer_count": 2, "score": 0, "last_activity_date": 1434726199, "creation_date": 1434692905, "question_id": 30930768, "link": "https://stackoverflow.com/questions/30930768/refactor-an-io-recursive-loop-into-a-monad-folding-in-haskell", "title": "Refactor an IO recursive loop into a monad folding in Haskell", "body": "<p>I writing a tcp server, and here's my main loop method:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>serverLoop :: Socket -&gt; IO ()\nserverLoop sock = do\n    (conn, _) &lt;- accept sock\n    forkIO $ handleConn conn\n    serverLoop sock\n</code></pre>\n\n<p>(Note: <code>handleConn :: Socket -&gt; IO ()</code> is a function specific to my program.)</p>\n\n<p>I would like to refactor that into a more <em>monadic</em> way, here's my tentative:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>serverLoop :: Socket -&gt; IO ()\nserverLoop sock = foldl1 (&gt;&gt;) $ map go $ repeat sock\n     where go sock = (accept sock) &gt;&gt;= (forkIO . handleConn . fst) &gt;&gt; return ()\n</code></pre>\n\n<p>But this makes the program crash as soon as I start sending data through the socket.</p>\n\n<p>Here are my questions: why? what's the fix for that?</p>\n"}, {"tags": ["haskell", "graphics", "gtk"], "answers": [{"comments": [{"owner": {"reputation": 1427, "user_id": 768961, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/704ce2786f18e6142990b68f07e02197?s=128&d=identicon&r=PG", "display_name": "Gregory Crosswhite", "link": "https://stackoverflow.com/users/768961/gregory-crosswhite"}, "edited": false, "score": 0, "creation_date": 1435287872, "post_id": 30931277, "comment_id": 50148478, "body": "Thanks, but I am hoping to avoid drawing the pixels individually."}], "tags": [], "owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "is_accepted": false, "score": 1, "last_activity_date": 1434695068, "creation_date": 1434695068, "answer_id": 30931277, "question_id": 30930511, "link": "https://stackoverflow.com/questions/30930511/how-can-i-show-an-image-from-raw-pixel-data-in-gtk-using-haskell/30931277#30931277", "title": "How can I show an image from raw pixel data in GTK using Haskell?", "body": "<p>I'm sure there's a better way to do this, but I'm not finding it either. You can iterate over all the pixels in the original image using something like <code>forM_ (range ((0,0),(w,h)))</code> and draw them onto a Cairo drawing using something like this: (The Cairo calls are correct but I'm just guessing about the Rasterific functions)</p>\n\n<pre><code>drawPixel color x y = do\n  setSourceRGBA (red color) (green color) (blue color) (alpha color)\n  rectangle x y 1 1\n  paint\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1427, "user_id": 768961, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/704ce2786f18e6142990b68f07e02197?s=128&d=identicon&r=PG", "display_name": "Gregory Crosswhite", "link": "https://stackoverflow.com/users/768961/gregory-crosswhite"}, "edited": false, "score": 0, "creation_date": 1435287841, "post_id": 30933831, "comment_id": 50148461, "body": "Ugh, I don&#39;t really want the overhead of drawing each pixel individually, but thanks!"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 1427, "user_id": 768961, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/704ce2786f18e6142990b68f07e02197?s=128&d=identicon&r=PG", "display_name": "Gregory Crosswhite", "link": "https://stackoverflow.com/users/768961/gregory-crosswhite"}, "edited": false, "score": 0, "creation_date": 1435306774, "post_id": 30933831, "comment_id": 50155982, "body": "The <code>ib_write_pixel</code> function is only doing manipulations on a Haskell array. It&#39;s not like it actually makes a GTK call per pixel. (That really <i>is</i> slow! I&#39;ve tried it...)"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 1427, "user_id": 768961, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/704ce2786f18e6142990b68f07e02197?s=128&d=identicon&r=PG", "display_name": "Gregory Crosswhite", "link": "https://stackoverflow.com/users/768961/gregory-crosswhite"}, "edited": false, "score": 1, "creation_date": 1435306817, "post_id": 30933831, "comment_id": 50156009, "body": "As well, you could try browsing the source code of the module to see what GTK functions it&#39;s actually using, and hence how the pieces &quot;fit together&quot;."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 2, "last_activity_date": 1434703666, "creation_date": 1434703666, "answer_id": 30933831, "question_id": 30930511, "link": "https://stackoverflow.com/questions/30930511/how-can-i-show-an-image-from-raw-pixel-data-in-gtk-using-haskell/30933831#30933831", "title": "How can I show an image from raw pixel data in GTK using Haskell?", "body": "<p>I wrote a package called <a href=\"http://hackage.haskell.org/package/AC-EasyRaster-GTK\" rel=\"nofollow\">AC-EasyRaster-GTK</a> for this exact purpose.</p>\n\n<p>It's a wrapper around gtk2hs. That library gives all the necessary parts, but it's not actually all that easy to figure out. So I wrote a library so I wouldn't have to keep looking this stuff up!</p>\n\n<p><code>ib_new</code> gives you a new image buffer, <code>ib_write_pixel</code> lets you write a pixel, and <code>ib_display</code> will start the GTK event loop, display the bitmap in a window, and block the calling thread until the user clicks close. Sadly, there's no easy way to chuck an entire array at GTK. (It demands a particular pixel order, which varies by platform...)</p>\n"}], "owner": {"reputation": 1427, "user_id": 768961, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/704ce2786f18e6142990b68f07e02197?s=128&d=identicon&r=PG", "display_name": "Gregory Crosswhite", "link": "https://stackoverflow.com/users/768961/gregory-crosswhite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 580, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1434703666, "creation_date": 1434691573, "question_id": 30930511, "link": "https://stackoverflow.com/questions/30930511/how-can-i-show-an-image-from-raw-pixel-data-in-gtk-using-haskell", "title": "How can I show an image from raw pixel data in GTK using Haskell?", "body": "<p>I would like to create an image in Haskell using the Rasterific library and then display that image in a GTK window;  the Rasterific library lets me generate an RBGA-formatted 32-bit pixel depth image, but I am having trouble figuring out how I can take this raw image and display it in a window or drawarea or whatever in GTK.</p>\n\n<p>(I've spent a lot of time looking through the documentation, but I've been having a hard time seeing how to fit the parts together, especially since the Haskell documentation is often non-existent and at some point the cairo library gets involved in a way that's not entirely clear to me.)</p>\n"}, {"tags": ["windows", "haskell", "ghc", "haskell-platform", "cabal-install"], "comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1434696945, "post_id": 30929551, "comment_id": 49898915, "body": "So far <a href=\"https://github.com/fpco/minghc\" rel=\"nofollow noreferrer\">minghc</a> worked for me without issues."}, {"owner": {"reputation": 417, "user_id": 1441998, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8045191674f2225e0a218286aeae4ffd?s=128&d=identicon&r=PG", "display_name": "user1441998", "link": "https://stackoverflow.com/users/1441998/user1441998"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1434697500, "post_id": 30929551, "comment_id": 49899256, "body": "so is HP no longer the way to go on windows?  all the HP libraries are easily cabal installed on minghc?"}, {"owner": {"reputation": 490, "user_id": 635669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0408d7a07f6d5460814d9016aef947c?s=128&d=identicon&r=PG", "display_name": "Guiraldelli", "link": "https://stackoverflow.com/users/635669/guiraldelli"}, "edited": false, "score": 0, "creation_date": 1434732752, "post_id": 30929551, "comment_id": 49921640, "body": "The <code>network</code> library is primary designed for *nix and is known to have problems in Windows environment, one of the main reasons of Haskell Platform for Windows (as I heard). Neil Mitchell, Michael Snoyberg and contributors were &quot;tired&quot; of the Haskell Platform cycle and went for the <a href=\"https://github.com/fpco/minghc\" rel=\"nofollow noreferrer\">minghc</a>, which has as one of the advantages to deal with <code>network</code>. Hence, it is highly recommend to try <code>minghc</code>, although it isn&#39;t the <i>official</i> way (yet)."}, {"owner": {"reputation": 417, "user_id": 1441998, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8045191674f2225e0a218286aeae4ffd?s=128&d=identicon&r=PG", "display_name": "user1441998", "link": "https://stackoverflow.com/users/1441998/user1441998"}, "edited": false, "score": 0, "creation_date": 1434771647, "post_id": 30929551, "comment_id": 49933866, "body": "well after dealing with <a href=\"https://github.com/haskell/cabal/issues/2502\" rel=\"nofollow noreferrer\">github.com/haskell/cabal/issues/2502</a> / <a href=\"https://github.com/haskell/cabal/issues/2525\" rel=\"nofollow noreferrer\">github.com/haskell/cabal/issues/2525</a>, minghc gave the exact same error for <code>hs-bibutils</code> :(  can any of you guys install hs-bibutils on 64 bit windows?"}, {"owner": {"reputation": 417, "user_id": 1441998, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8045191674f2225e0a218286aeae4ffd?s=128&d=identicon&r=PG", "display_name": "user1441998", "link": "https://stackoverflow.com/users/1441998/user1441998"}, "edited": false, "score": 0, "creation_date": 1434772284, "post_id": 30929551, "comment_id": 49933936, "body": "seems to be this? <a href=\"https://ghc.haskell.org/trac/ghc/ticket/9215\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/ticket/9215</a>"}, {"owner": {"reputation": 417, "user_id": 1441998, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8045191674f2225e0a218286aeae4ffd?s=128&d=identicon&r=PG", "display_name": "user1441998", "link": "https://stackoverflow.com/users/1441998/user1441998"}, "edited": false, "score": 0, "creation_date": 1434775148, "post_id": 30929551, "comment_id": 49934395, "body": "well 32 bit worked, after failing to be able to install the latest HaXml, i randomly figured out i could install HaXml-1.23.3.  gah"}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1478642926, "creation_date": 1478642926, "answer_id": 40497281, "question_id": 30929551, "link": "https://stackoverflow.com/questions/30929551/which-unix-compatibility-toolchain-to-use-with-cabal-install-on-windows/40497281#40497281", "title": "Which unix compatibility toolchain to use with cabal install on windows?", "body": "<p>For posterity, new versions of the Haskell Platform for windows (since 8.0.1) allow network to build properly if the cabal file is augmented with a few extra settings as described on the platform website:  <a href=\"https://www.haskell.org/platform/\" rel=\"nofollow noreferrer\">https://www.haskell.org/platform/</a></p>\n\n<pre><code>Modify your cabal config file (you can verify the location by running \"cabal user-config init\") to contain the following lines:\nextra-prog-path: C:\\Program Files\\Haskell Platform\\8.0.1\\msys\\usr\\bin\nextra-lib-dirs: C:\\Program Files\\Haskell Platform\\8.0.1\\mingw\\lib\nextra-include-dirs: C:\\Program Files\\Haskell Platform\\8.\n</code></pre>\n"}], "owner": {"reputation": 417, "user_id": 1441998, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8045191674f2225e0a218286aeae4ffd?s=128&d=identicon&r=PG", "display_name": "user1441998", "link": "https://stackoverflow.com/users/1441998/user1441998"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 563, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1478642926, "creation_date": 1434685279, "question_id": 30929551, "link": "https://stackoverflow.com/questions/30929551/which-unix-compatibility-toolchain-to-use-with-cabal-install-on-windows", "title": "Which unix compatibility toolchain to use with cabal install on windows?", "body": "<p>trying to install <code>BlogLiterately</code> on win7/64.</p>\n\n<ul>\n<li>installed HP 2014.2/64</li>\n<li><code>cabal update</code></li>\n<li><code>cabal install cabal-install</code></li>\n<li>renamed <code>C:\\Program Files\\Haskell Platform\\2014.2.0.0\\lib\\extralibs\\bin\\cabal.exe</code>\nto *.old</li>\n<li><code>cabal update</code></li>\n<li><code>cabal install BlogLiterately</code> fails cuz needs unix toolchain to install new version of <code>network</code></li>\n<li>tried installing <code>mingw</code>, but gave up cuz the package manager that pops up only lists packages with suffix <code>32</code>, i want <code>64</code>, can't tell from <a href=\"http://www.mingw.org/\" rel=\"nofollow\">http://www.mingw.org/</a> if it supports 64 bit.</li>\n<li>tried installing <code>cygwin64</code>, added <code>C:\\cygwin64\\bin</code> to the <em>end</em> of <code>PATH</code>, didn't work, see on internet that people think <code>cygwin</code> doesn't work for ghc so well anymore, even though the original error said <code>cygwin</code> would work</li>\n<li>found <a href=\"http://msys2.github.io/\" rel=\"nofollow\">http://msys2.github.io/</a>, installed it, followed instructions to update with <code>pacman</code> on that page, used <code>Win64 Shell</code></li>\n<li>got error that <code>HsOpenSSL</code> is missing c libs <code>eay32 ssl32</code>, googling says to install <a href=\"http://slproweb.com/products/Win32OpenSSL.html\" rel=\"nofollow\">http://slproweb.com/products/Win32OpenSSL.html</a> then <code>cabal install HsOpenSSL --extra-include-dirs=\"c:/OpenSSL-Win64/include\" --extra-lib-dirs=\"c:/OpenSSL-Win64\"</code> -- this works, but can't find any official looking docs saying i need <code>Win32OpenSSL</code> -- why can't cabal install this for me?</li>\n<li>now <code>cabal install BlogLiterately</code> fails cuz <code>ghc.exe: unable to load package 'hs-bibutils-5.5'</code></li>\n</ul>\n\n<p>the error:</p>\n\n<pre><code>ghc.exe: warning: _stricmp from msvcrt is linked instead of __imp__stricmp\nghc.exe: warning: _stricmp from msvcrt is linked instead of __imp__stricmp\nghc.exe: warning: _atoi64 from msvcrt is linked instead of __imp__atoi64\nghc.exe: warning: toupper from msvcrt is linked instead of __imp_toupper\nghc.exe: warning: _strnicmp from msvcrt is linked instead of __imp__strnicmp\nghc.exe: C:\\Users\\nlab\\AppData\\Roaming\\cabal\\x86_64-windows-ghc-7.8.3\\hs-bibutils-5.5\\HShs-bibutils-5.5.o: unknown symbol `strdup'\n</code></pre>\n\n<p><code>cabal install hs-bibutils --reinstall --force-reinstalls</code> succeeds, but i get the same error when retrying the <code>BlogLiterately</code> install.  i tried moving <code>/c/Program Files/Haskell Platform/2014.2.0.0/mingw/bin</code> to the front of the <code>PATH</code> and again reinstalling <code>hs-bibutils</code>, same result.</p>\n\n<p>what is the right way to do this?!?!  which unix toolchain are we supposed to use, and how are we supposed to configure it?  why isn't it enough that HP includes <code>mingw</code>'s binaries?  gah.</p>\n"}, {"tags": ["haskell", "arrows"], "answers": [{"tags": [], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "is_accepted": false, "score": 1, "last_activity_date": 1434685987, "creation_date": 1434685987, "answer_id": 30929643, "question_id": 30929348, "link": "https://stackoverflow.com/questions/30929348/how-to-parse-a-tree-like-structure-using-parrows/30929643#30929643", "title": "How to parse a tree-like structure using PArrows?", "body": "<p>This is probably not the cleanest answer, but I managed to do it with:</p>\n\n<pre><code>import Text.ParserCombinators.PArrow\nimport Control.Arrow\n\ndata Tree = Node Tree Tree | A | B deriving Show\n\ntext = \"((B A) (A B))\"\n\nfromToken :: Char -&gt; Tree\nfromToken 'A' = A\nfromToken 'B' = B\n\ntoken = anyOf \"AB\" &gt;&gt;&gt; arr fromToken\nnode = arr (uncurry Node) \n    &lt;&lt;&lt; ((char '(' &gt;&gt;&gt; token &lt;+&gt; node)   -- left side\n    &gt;&gt;! white                            -- whitespace\n    &amp;&amp;&amp; ((token &lt;+&gt; node) &gt;&gt;! char ')')) -- right side\n\nmain = print $ runParser node text\n</code></pre>\n\n<p>Mind I'm still working on my arrow familiarity.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1434685987, "creation_date": 1434683746, "question_id": 30929348, "link": "https://stackoverflow.com/questions/30929348/how-to-parse-a-tree-like-structure-using-parrows", "title": "How to parse a tree-like structure using PArrows?", "body": "<p>I'm trying to learn arrows, as well as how PArrows can replace Parsec, but there is an almost nonexistent number of tutorials. I believe we could benefit a lot from simple examples, so, given the binary tree:</p>\n\n<pre><code>data Tree = Node Tree Tree | A | B deriving Show\n</code></pre>\n\n<p>How can PArrow be used to parse a string similar to:</p>\n\n<pre><code>\"((A B) (A (B A)))\" \n</code></pre>\n\n<p>So that it becomes:</p>\n\n<pre><code>Node (Node A B) (Node A (Node B A))\n</code></pre>\n"}, {"tags": ["list", "haskell", "abstract-data-type"], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 5, "last_activity_date": 1434666521, "creation_date": 1434666521, "answer_id": 30926903, "question_id": 30926686, "link": "https://stackoverflow.com/questions/30926686/how-to-search-for-matching-items-in-a-list/30926903#30926903", "title": "How to search for matching items in a list?", "body": "<p>This is fairly straightforward using the <code>filter</code> function:</p>\n\n<pre><code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>It takes a condition to apply to each element of a list, then returns the list of all elements that meet that condition.  In your case, you want to look up what books have been requested by a given person.  You can break this down into two problems:</p>\n\n<ol>\n<li>Find all requests for a given person</li>\n<li>Find all books in a <code>Requisition</code> list</li>\n</ol>\n\n<p>To solve the first, we say</p>\n\n<pre><code>requestsFromPerson :: Database -&gt; String -&gt; Database\nrequestsFromPerson db name = filter matchesName db\n    where\n        matchesName (Req name' item) = name == name'\n</code></pre>\n\n<p>The second step can also be done with <code>filter</code>, but I'm going to let you fill in the implementation</p>\n\n<pre><code>onlyBooks :: Database -&gt; Database\nonlyBooks db = filter ??? db\n</code></pre>\n\n<p>Then you can combine these two:</p>\n\n<pre><code>books db name = onlyBooks (requestsFromPerson db name)\n</code></pre>\n\n<p>So all you have to do is fill in the <code>???</code> for <code>onlyBooks</code> and this should work!  Hint: pattern matching is your friend.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1434672077, "creation_date": 1434672077, "answer_id": 30927848, "question_id": 30926686, "link": "https://stackoverflow.com/questions/30926686/how-to-search-for-matching-items-in-a-list/30927848#30927848", "title": "How to search for matching items in a list?", "body": "<pre><code>books db name = [... | Req n b@(Book _ _) &lt;- db, n==name]\n</code></pre>\n\n<p>With list comprehensions, mismatched items are just skipped over. Patterns may be nested.</p>\n"}], "owner": {"reputation": 29, "user_id": 4963078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4aa64da6727724b058b7aa0cc555e7a3?s=128&d=identicon&r=PG&f=1", "display_name": "litos", "link": "https://stackoverflow.com/users/4963078/litos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1434694022, "creation_date": 1434665449, "last_edit_date": 1434694022, "question_id": 30926686, "link": "https://stackoverflow.com/questions/30926686/how-to-search-for-matching-items-in-a-list", "title": "How to search for matching items in a list?", "body": "<p>I'm doing an exercise to practice for my exam tomorrow.\nThe text tells me to implement a database to a library, to define <code>Item</code>s that can be books or magazines. To each book I save the Name + Author. To each <code>Magazine</code> I save the name:</p>\n\n<pre><code> data Item = Book String String\n      | Magazine String\n      deriving(Show)\n\ndata Requisition = Req String Item\n\ntype Database = [Requisition]\n\nexDB :: Database\nexDB = [Req \"John\" (Book \"PF\" \"HS\"),Req \"Jay\"(Book \"Apple\" \"Steve Jobs\"),Req \"Francis\"(Magazine \"Forbes\")]\n\nbooks :: Database -&gt; String -&gt; [Item]\nbooks db name = {-- what's next?-}\n</code></pre>\n\n<p>Now, I need to create a function named <code>books :: Database -&gt; String -&gt; [Item]</code>, that searches by name on my database and gives me the books that person requested.</p>\n\n<p>how do I do this?</p>\n"}, {"tags": ["haskell", "svg", "haskell-diagrams"], "answers": [{"comments": [{"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "edited": false, "score": 0, "creation_date": 1434718539, "post_id": 30938447, "comment_id": 49912150, "body": "Very unfortunate, and that is what I feared. Editing the document by hand is not really an option in my case because the contents of the bar graph are dynamic (they come from the database), so they could change every time the page is served."}], "tags": [], "owner": {"reputation": 427, "user_id": 918951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/081ba388b15855fa5e5c7e37ab5df39f?s=128&d=identicon&r=PG", "display_name": "Yofe", "link": "https://stackoverflow.com/users/918951/yofe"}, "is_accepted": true, "score": 2, "last_activity_date": 1434717800, "creation_date": 1434717800, "answer_id": 30938447, "question_id": 30925400, "link": "https://stackoverflow.com/questions/30925400/setting-id-and-class-with-the-haskell-diagrams-package/30938447#30938447", "title": "Setting id and class with the haskell diagrams package", "body": "<p>This cannot be done currently in diagrams, although it is something we would like to have in the future. You can get part of the way there using the diagrams-canvas backend, but that only displays on a local host and cannot be embedded into a web page. The only thing I can suggest is to pretty print the svg with the -p command line option and edit the svg by hand.</p>\n"}], "owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 30938447, "answer_count": 1, "score": 5, "last_activity_date": 1434717800, "creation_date": 1434659947, "question_id": 30925400, "link": "https://stackoverflow.com/questions/30925400/setting-id-and-class-with-the-haskell-diagrams-package", "title": "Setting id and class with the haskell diagrams package", "body": "<p>I am working with the <code>diagrams</code> package for haskell, and I am using the SVG backend. I embed the SVG markup directly into an HTML document, so that the graph as a part of a web page. I have built a pretty cool looking bar graph, and I would like to add some basic interactivity to it. For example, when you hover over a bar, I'd like to make the color lighter. Or maybe something would pop up as well. The way that I would like to accomplish this is by setting the <code>class</code> attributes of some of the SVG nodes. Is this possible with the <code>diagrams</code> package? I know that it can target multiple backends and that that <code>class</code> attribute likely has no meaningful counterpart in most of them, but I was wondering if there is nevertheless a way to sneak in backend-specific information. Thanks for any insights that anyone can provide.</p>\n"}, {"tags": ["haskell", "cabal", "cabal-install", "ghcjs"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1434657354, "post_id": 30924448, "comment_id": 49886017, "body": "Upper bounds on base :( Try passing <code>--allow-newer=base</code> to <code>cabal install</code>."}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1434657588, "post_id": 30924448, "comment_id": 49886195, "body": "Thanks, I try. Is there a way to get base-4.7.0.2 ? An older GHC perhaps?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1434657880, "post_id": 30924448, "comment_id": 49886369, "body": "Yes, base-4.7.* is GHC 7.8.*."}, {"owner": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "edited": false, "score": 0, "creation_date": 1434657892, "post_id": 30924448, "comment_id": 49886376, "body": "Base comes prepackaged with GHC so for 4.7.0.2 you will need GHC 7.8.*"}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1434658049, "post_id": 30924448, "comment_id": 49886480, "body": "<code>--allow-newer=base</code> seems to help, at least it compiles"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1456443696, "post_id": 30924448, "comment_id": 58962753, "body": "@ReidBarton since that provided the answer, you should post it as an answer."}], "owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1434656844, "creation_date": 1434656844, "question_id": 30924448, "link": "https://stackoverflow.com/questions/30924448/ghcjs-jquery-is-incompatible-with-base-4-8-0-0-what-to-do", "title": "ghcjs-jquery is incompatible with base-4.8.0.0, what to do?", "body": "<p>ghcjs-jquery is not compatible with base-4.8.0.0, what can one do ?</p>\n\n<p><strong>details</strong>: </p>\n\n<pre><code>joco@vm001:~/Downloads$ git clone https://github.com/ghcjs/ghcjs-jquery.git\nCloning into 'ghcjs-jquery'...\nremote: Counting objects: 142, done.\nremote: Total 142 (delta 0), reused 0 (delta 0), pack-reused 142\nReceiving objects: 100% (142/142), 110.25 KiB | 0 bytes/s, done.\nResolving deltas: 100% (59/59), done.\nChecking connectivity... done.\njoco@vm001:~/Downloads$ ls\nCabal-1.22.3.0          cabal-install-1.22.3.0.tar.gz                 ghcjs            ghcjs-jquery  node-v0.12.4.tar.gz\nCabal-1.22.3.0.tar.gz   ghc-7.10.1                                    ghcjs-dom-hello  ghcjs-prim    regex-tdfa-text-1.0.0.3\ncabal-install-1.22.3.0  ghc-7.10.1-x86_64-unknown-linux-deb7.tar.bz2  ghcjs-examples   node-v0.12.4  regex-tdfa-text-1.0.0.3.tar.gz\njoco@vm001:~/Downloads$ cd ghcjs-jquery/\njoco@vm001:~/Downloads/ghcjs-jquery$ ls\nexample  ghcjs-jquery.cabal  JavaScript  jquery  jsbits  LICENSE  README.md  Setup.hs  util\njoco@vm001:~/Downloads/ghcjs-jquery$ cabal install --ghcjs\nResolving dependencies...\ncabal: Could not resolve dependencies:\ntrying: ghcjs-jquery-0.1.0.0 (user goal)\nnext goal: base (dependency of ghcjs-jquery-0.1.0.0)\nrejecting: base-4.8.0.0/installed-55a... (conflict: ghcjs-jquery =&gt;\nbase==4.7.*)\nrejecting: base-4.8.0.0, 4.7.0.2, 4.7.0.1, 4.7.0.0, 4.6.0.1, 4.6.0.0, 4.5.1.0,\n4.5.0.0, 4.4.1.0, 4.4.0.0, 4.3.1.0, 4.3.0.0, 4.2.0.2, 4.2.0.1, 4.2.0.0,\n4.1.0.0, 4.0.0.0, 3.0.3.2, 3.0.3.1 (global constraint requires installed\ninstance)\nDependency tree exhaustively searched.\njoco@vm001:~/Downloads/ghcjs-jquery$ cabal sandbox init\nWriting a default package environment file to\n/home/joco/Downloads/ghcjs-jquery/cabal.sandbox.config\nCreating a new sandbox at /home/joco/Downloads/ghcjs-jquery/.cabal-sandbox\njoco@vm001:~/Downloads/ghcjs-jquery$ cabal install --ghcjs\nResolving dependencies...\ncabal: Could not resolve dependencies:\ntrying: ghcjs-jquery-0.1.0.0 (user goal)\nnext goal: base (dependency of ghcjs-jquery-0.1.0.0)\nrejecting: base-4.8.0.0/installed-55a... (conflict: ghcjs-jquery =&gt;\nbase==4.7.*)\nrejecting: base-4.8.0.0, 4.7.0.2, 4.7.0.1, 4.7.0.0, 4.6.0.1, 4.6.0.0, 4.5.1.0,\n4.5.0.0, 4.4.1.0, 4.4.0.0, 4.3.1.0, 4.3.0.0, 4.2.0.2, 4.2.0.1, 4.2.0.0,\n4.1.0.0, 4.0.0.0, 3.0.3.2, 3.0.3.1 (global constraint requires installed\ninstance)\nDependency tree exhaustively searched.\n\nNote: when using a sandbox, all packages are required to have consistent\ndependencies. Try reinstalling/unregistering the offending packages or\nrecreating the sandbox.\njoco@vm001:~/Downloads/ghcjs-jquery$ ls\ncabal.sandbox.config  example  ghcjs-jquery.cabal  JavaScript  jquery  jsbits  LICENSE  README.md  Setup.hs  util\njoco@vm001:~/Downloads/ghcjs-jquery$ vi ghcjs-jquery.cabal \njoco@vm001:~/Downloads/ghcjs-jquery$ cabal install base-4.7.0.2\nResolving dependencies...\ncabal: Could not resolve dependencies:\nnext goal: base (user goal)\nrejecting: base-4.8.0.0/installed-1b6..., 4.8.0.0 (global constraint requires\n==4.7.0.2)\nrejecting: base-4.7.0.2 (only already installed instances can be used)\nrejecting: base-4.7.0.1, 4.7.0.0, 4.6.0.1, 4.6.0.0, 4.5.1.0, 4.5.0.0, 4.4.1.0,\n4.4.0.0, 4.3.1.0, 4.3.0.0, 4.2.0.2, 4.2.0.1, 4.2.0.0, 4.1.0.0, 4.0.0.0,\n3.0.3.2, 3.0.3.1 (global constraint requires ==4.7.0.2)\nDependency tree exhaustively searched.\n\nNote: when using a sandbox, all packages are required to have consistent\ndependencies. Try reinstalling/unregistering the offending packages or\nrecreating the sandbox.\njoco@vm001:~/Downloads/ghcjs-jquery$ cabal sandbox init\nWriting a default package environment file to\n/home/joco/Downloads/ghcjs-jquery/cabal.sandbox.config\nCreating a new sandbox at /home/joco/Downloads/ghcjs-jquery/.cabal-sandbox\njoco@vm001:~/Downloads/ghcjs-jquery$ cabal install base-4.7.0.2\nResolving dependencies...\ncabal: Could not resolve dependencies:\nnext goal: base (user goal)\nrejecting: base-4.8.0.0/installed-1b6..., 4.8.0.0 (global constraint requires\n==4.7.0.2)\nrejecting: base-4.7.0.2 (only already installed instances can be used)\nrejecting: base-4.7.0.1, 4.7.0.0, 4.6.0.1, 4.6.0.0, 4.5.1.0, 4.5.0.0, 4.4.1.0,\n4.4.0.0, 4.3.1.0, 4.3.0.0, 4.2.0.2, 4.2.0.1, 4.2.0.0, 4.1.0.0, 4.0.0.0,\n3.0.3.2, 3.0.3.1 (global constraint requires ==4.7.0.2)\nDependency tree exhaustively searched.\n\nNote: when using a sandbox, all packages are required to have consistent\ndependencies. Try reinstalling/unregistering the offending packages or\nrecreating the sandbox.\n\njoco@vm001:~/Downloads/ghcjs-jquery$ ghcjs --version\nThe Glorious Glasgow Haskell Compilation System for JavaScript, version 0.1.0 (GHC 7.10.1)\njoco@vm001:~/Downloads/ghcjs-jquery$ \n</code></pre>\n"}, {"tags": ["macos", "haskell", "yesod"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1434657296, "post_id": 30922707, "comment_id": 49885977, "body": "All the errors are the same, <code>Loading package parsec-3.1.5 ... : can&#39;t load .so&#47;.DLL for: &#47;Library&#47;Haskell&#47;ghc-7.8.3-x86_64&#47;lib&#47;parsec-3.1.5&#47;libHSpars&zwnj;&#8203;ec-3.1.5-ghc7.8.3.dy&zwnj;&#8203;lib (dlopen(&#47;Library&#47;Haskell&#47;ghc-7.8.3-x86_64&#47;lib&#47;parsec-3.1.5&#47;l&zwnj;&#8203;ibHSparsec-3.1.5-ghc&zwnj;&#8203;7.8.3.dylib, 9): Library not loaded: @rpath&#47;libHStext-1.1.0.0-ghc7.8.3.dylib Referenced from: &#47;Library&#47;Haskell&#47;ghc-7.8.3-x86_64&#47;lib&#47;parsec-3.1.5&#47;libHSpars&zwnj;&#8203;ec-3.1.5-ghc7.8.3.dy&zwnj;&#8203;lib Reason: image not found)</code> Looks like an issue with the rpath for parsec, as a workaround you might try globally unregistering and then reinstalling it."}, {"owner": {"reputation": 669, "user_id": 5025261, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/163727f297f2568604d1b626d3631716?s=128&d=identicon&r=PG&f=1", "display_name": "MASL", "link": "https://stackoverflow.com/users/5025261/masl"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1434831850, "post_id": 30922707, "comment_id": 49949743, "body": "The solution I posted is likely not the only one. Others in the Haskell-cafe thread suggested alternative approaches that might work as well. Wrt your comment, all I can say is that initially it fail specifically complaining about shakespeare not being built. That I could confirm myself by explcitly trying to build all its versions &gt;= 2.0.2."}], "owner": {"reputation": 669, "user_id": 5025261, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/163727f297f2568604d1b626d3631716?s=128&d=identicon&r=PG&f=1", "display_name": "MASL", "link": "https://stackoverflow.com/users/5025261/masl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1434831324, "creation_date": 1434651040, "last_edit_date": 1434831324, "question_id": 30922707, "link": "https://stackoverflow.com/questions/30922707/yesod-fails-to-install-in-osx-10-6-8-with-haskell-platform-2014-2-0-0", "title": "Yesod fails to install in OSX 10.6.8 with Haskell Platform 2014.2.0.0", "body": "<p>I can't install yesod.\nDoing a cabal install yesod-bin or cabal install yesod fails because it\nfails to build shakespeare.</p>\n\n<p>I tried with all versions of shapeare >= 2.0, as required by yesod-bin.\nBelow are all outputs.</p>\n\n<p>My environment:</p>\n\n<pre><code>OS X 10.6.8, Xcode 3.2\nHaskell-platform 2014.2.0.0\nghc-7.8.3\ncabal-install 1.22.4.0 using version 1.22.3.0 of the Cabal library.\n</code></pre>\n\n<p>This corresponds to a fresh install of the HP, ghc, and cabal I did\nbefore trying to install yesod.</p>\n\n<p>The developer of Shakespeare suspects that be a bug of HP and suggested I\ntry a clean install of GHC as explained in\n<a href=\"http://www.stackage.org/install#mac-os-x\" rel=\"nofollow\">http://www.stackage.org/install#mac-os-x</a>\nHowever, the bindist available there doesn't work with my OS 10.6.8</p>\n\n<p>I have a large screen output from those trials that you can check on the\nShakespeare github page corresponding to the thread I started there\n<a href=\"https://github.com/yesodweb/shakespeare/issues/156\" rel=\"nofollow\">https://github.com/yesodweb/shakespeare/issues/156</a></p>\n\n<p>If you prefer, I can paste it here as well.</p>\n\n<p>I already looked on the yesodweb page, sent a mail to the Haskell mailing list, to the Shakespeare developer and googled around. Anybody here that faced (and solved?) this same issue? or that could reproduce it? </p>\n\n<p>I also asked the Shakespeare developer for help on hack a fix on that library. Not sure yet if that is an easy task though. Still waiting for his reply on that.</p>\n\n<p>Thanks in advance.\nMA</p>\n\n<p>EDIT: Solved! </p>\n\n<p>The quickstart from the yesod site wouldn't work as I said at the beginning of this thread because the shakespeare package didn't get built.\nThat's because those steps suggest installing yesod-bin globally and only\nafterwards start the sandbox.\nReversing those steps does the work.\nMore concretely, what I did was </p>\n\n<pre><code>mkdir yesod\ncd yesod\nwget https :// www.stackage.org/lts/cabal.config\ncabal update\ncabal install alex happy (actually I had these already installed)\ncabal sandbox init\ncabal install network \ncabal install primitive-0.6 (idem)\ncabal install yesod-bin\n</code></pre>\n\n<p>And at this point shakespeare built fine and yesod got installed. I went then further and did</p>\n\n<pre><code>export PATH=./.cabal-sandbox/bin/:$PATH\n</code></pre>\n\n<p>in order to get yesod running:</p>\n\n<pre><code>yesod init --bare\ncabal install -j --enable-tests --max-backjumps=-1 --reorder-goal (probably not necessary; followed blindly init's suggestion)\ncabal install --run-tests\nyesod devel\n</code></pre>\n\n<p>That lead to a minor configuring of FirstWebServer-0.0.0..., which triggered a recompile of a few libraries and a rebuild of the application and finally a working Welcome Yesod page at localhost:3000</p>\n\n<p>More details on the Haskell-cafe mailing list under the thread\nhttps: // mail.haskell.org/pipermail/haskell-cafe/2015-June/120192.html</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1434641283, "post_id": 30916038, "comment_id": 49876382, "body": "Probably when <code>print</code> is called? since your first print shows no time elapsed for the line <code>r &lt;- evaluate (runEval test)</code> and 0.83s for <code>print r</code>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1434645192, "post_id": 30916038, "comment_id": 49878833, "body": "When you use <code>evaluate</code>, you evaluate the argument to <a href=\"https://wiki.haskell.org/Weak_head_normal_form\" rel=\"nofollow noreferrer\">weak head normal form</a>. The expressing <code>(x,y)</code> is already in WHNF, so there is nothing to evaluate! Since you haven&#39;t demanded the values of <code>x</code> and <code>y</code> themselves yet, they won&#39;t be evaluated. Then the call to <code>print</code> forces the evaluation of <code>x</code> and <code>y</code> to normal form, which in turn sparks the parallel computation you expect."}, {"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1434649549, "post_id": 30916038, "comment_id": 49881401, "body": "@user2407038 - thanks. Care to post for credit?  I think it deserves an answer post, not a comment alone."}], "answers": [{"comments": [{"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1434767906, "post_id": 30920402, "comment_id": 49933351, "body": "From the above book&#39;s link: <code>The evaluate function is like a seq in the IO monad: it evaluates its argument to weak head normal form and then returns it:</code>. I interpret that to mean that, when calling <code>evaluate (runEval test)</code>, it gets evaluated to weak head normal form. I don&#39;t understand how that means that <code>rpar (fib 35)</code> and <code>rpar (fib 36)</code> are running in the background as a result of the call to <code>evaluate</code>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1434772840, "post_id": 30920402, "comment_id": 49934006, "body": "@KevinMeredith Let me know if the edit answers your question fully."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 5, "last_activity_date": 1434772704, "last_edit_date": 1495542598, "creation_date": 1434643386, "answer_id": 30920402, "question_id": 30916038, "link": "https://stackoverflow.com/questions/30916038/understanding-eval-monads-rpar/30920402#30920402", "title": "Understanding Eval Monad&#39;s `rpar`", "body": "<p>Here's my guess, but I can't seem to replicate this on my laptop, too many imports I'd have to get from cabal.</p>\n\n<pre><code>test1 = do\n  x &lt;- rpar (fib 36)\n  y &lt;- rpar (fib 35)\n  return (x,y)\n</code></pre>\n\n<p>In this, you spark the evaluation of <code>(fib 36)</code> and <code>(fib 35)</code> in parallel, but you don't wait for them - you just return <code>(x,y)</code> immediately, while <code>x</code> and <code>y</code> are still evaluating. Then, we you get to <code>print r</code>, you are forced to wait until <code>x</code> and <code>y</code> finish evaluating.</p>\n\n<p>In theory, the following code should force <code>test1</code> to wait until <code>x</code> and <code>y</code> have finished evaluating before returning them.</p>\n\n<pre><code>test1 = do\n  x &lt;- rpar (fib 36)\n  y &lt;- rpar (fib 35)\n  rseq x\n  rseq y\n  return (x,y)\n</code></pre>\n\n<p>Then, running this should give you approximately</p>\n\n<pre><code>$ ./rpar 1 +RTS -N2\ntime: 0.83s\n(24157817,14930352)\ntime: 0.83s\n</code></pre>\n\n<p>hopefully...</p>\n\n<h2>EDIT</h2>\n\n<p>Finally got back to my machine, replicated the condition, and my suggested code gives the expected result. However, the OP raises another good question: if <code>evaluate</code> only evaluates to the WHNF, why does it even end up doing work before print is called?</p>\n\n<p>The answer is in the <a href=\"https://hackage.haskell.org/package/parallel-3.1.0.1/docs/src/Control-Parallel-Strategies.html#Eval\" rel=\"nofollow noreferrer\">monad definition</a> of <code>Control.Parallel.Strategies</code> - in other words, it isn't <code>evaluate</code> that pushes the evaluation of <code>x</code> and <code>y</code>, but <code>runEval</code>. The <code>Eval</code> monad is strict in the first argument: in <code>x &gt;&gt;= f</code> it will evaluate <code>x</code> (please check out <a href=\"https://stackoverflow.com/questions/11831156/how-does-the-bind-operator-for-eval-in-control-parallel-strategies-evaluate-its\">this question</a> before continuing). Then, de-sugaring <code>test1</code> gives:</p>\n\n<pre><code>test1 = (rpar (fib 36)) &gt;&gt;= (\\x -&gt; \n        (rpar (fib 35)) &gt;&gt;= (\\y -&gt;\n        (rseq x)        &gt;&gt;= (\\_ -&gt;\n        (rseq y)        &gt;&gt;= (\\_ -&gt;\n        return (x,y)))))\n</code></pre>\n\n<p>Then, since <code>rpar</code> only \"sparks\" evaluation, it uses <a href=\"https://hackage.haskell.org/package/parallel-2.2.0.1/docs/Control-Parallel.html\" rel=\"nofollow noreferrer\"><code>par</code></a> (which begins the evaluation of the first argument but immediately returns the second) and immediately returns <code>Done</code>, however, <a href=\"https://hackage.haskell.org/package/parallel-2.2.0.1/docs/Control-Parallel.html\" rel=\"nofollow noreferrer\"><code>rseq</code></a> (like <code>seq</code>, but strict only in the first argument) does not return <code>Done</code> until its argument is actually evaluated (to WHNF). Hence, without the <code>rseq</code> calls, you have know that <code>x</code> and <code>y</code> have begun to be evaluated but no assurance that they have finished, but with those calls, you know both <code>x</code> and <code>y</code> are also evaluated before <code>return</code> is called on them.</p>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 430, "favorite_count": 1, "answer_count": 1, "score": 8, "last_activity_date": 1434772704, "creation_date": 1434632337, "question_id": 30916038, "link": "https://stackoverflow.com/questions/30916038/understanding-eval-monads-rpar", "title": "Understanding Eval Monad&#39;s `rpar`", "body": "<p>Looking at the following example from <a href=\"http://chimera.labs.oreilly.com/books/1230000000929/ch02.html#sec_par-rpar-rseq\" rel=\"noreferrer\">Parallel and Concurrent Programming in Haskell</a>:</p>\n\n<pre><code>main = do\n  [n] &lt;- getArgs\n  let test = [test1,test2,test3,test4] !! (read n - 1) \n  t0 &lt;- getCurrentTime\n  r &lt;- evaluate (runEval test)\n  printTimeSince t0\n  print r\n  printTimeSince t0\n\n\ntest1 = do\n  x &lt;- rpar (fib 36)\n  y &lt;- rpar (fib 35)\n  return (x,y)\n</code></pre>\n\n<p>The book shows its compilation:</p>\n\n<pre><code> $ ghc -O2 rpar.hs -threaded\n</code></pre>\n\n<p>And then running the above test:</p>\n\n<pre><code>$ ./rpar 1 +RTS -N2\ntime: 0.00s\n(24157817,14930352)\ntime: 0.83s\n</code></pre>\n\n<p>If I understand correctly, the Eval Monad (using <code>rpar</code>) results in both <code>fib 36</code> and <code>fib 35</code> being computed in parallel.</p>\n\n<p>Does the actual work, i.e. computing the function <code>fib ...</code>  occur when calling <code>(runEval test)</code>? Or perhaps <code>evaluate ...</code> is required? Or, finally, perhaps it gets computed when calling <code>print r</code> to evaluate it entirely?</p>\n\n<p>It's not clear to me <strong>when</strong> the actual work gets performed for <code>rpar</code>. </p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1434625455, "post_id": 30913145, "comment_id": 49864293, "body": "<a href=\"https://www.fpcomplete.com/blog/2015/06/announcing-first-public-beta-stack\" rel=\"nofollow noreferrer\">fpcomplete.com/blog/2015/06/announcing-first-public-beta-sta&zwnj;&#8203;ck</a> (in short it kindof replaces <code>cabal-install</code> and uses stackage as much as possible - there might be some back-integration into cabal-install at some point and I think the community is not sure if this is a good thing or not, because it might split the community)"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1434629848, "post_id": 30913145, "comment_id": 49867315, "body": "AFAIU stack is handy to quickly work on an existing project. If you start something from scratch, you will certainly have to use cabal."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1508605183, "post_id": 30913145, "comment_id": 80678850, "body": "@mb14 That&#39;s not the case. You can use stack to start projects from scratch. In fact, stack templates provides an easy way to do that."}, {"owner": {"reputation": 8440, "user_id": 402428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b17015101f2649d332c389337897816b?s=128&d=identicon&r=PG", "display_name": "michid", "link": "https://stackoverflow.com/users/402428/michid"}, "edited": false, "score": 0, "creation_date": 1592165730, "post_id": 30913145, "comment_id": 110320683, "body": "See this short article for a good overview: <a href=\"https://www.scs.stanford.edu/16wi-cs240h/labs/stack.html\" rel=\"nofollow noreferrer\">scs.stanford.edu/16wi-cs240h/labs/stack.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1434652624, "post_id": 30918708, "comment_id": 49883151, "body": "Apart from <code>cabal</code>, their source code seem to be also using <code>docker</code>. Although I don&#39;t know if they use that yet."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1434655142, "post_id": 30918708, "comment_id": 49884681, "body": "@Sibi Yes, it looks like you can optionally throw stuff into Docker, and it&#39;s meant to work. I haven&#39;t looked at it much further..."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 11, "last_activity_date": 1434638922, "creation_date": 1434638922, "answer_id": 30918708, "question_id": 30913145, "link": "https://stackoverflow.com/questions/30913145/what-is-the-difference-between-cabal-and-stack/30918708#30918708", "title": "What is the difference between Cabal and Stack?", "body": "<p>From what I can glean from the FAQ, it seems that Stack uses the Cabal library, but not the <code>cabal.exe</code> binary (more correctly known as cabal-install). It looks like the aim of the project is automatic sandboxing and avoidance of dependency hell.</p>\n\n<p>In other words, it uses the same Cabal package structure, it just provides a different front-end for managing this stuff. (I think!)</p>\n"}, {"comments": [{"owner": {"reputation": 747, "user_id": 6933270, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7AdXs.jpg?s=128&g=1", "display_name": "William Rusnack", "link": "https://stackoverflow.com/users/6933270/william-rusnack"}, "edited": false, "score": 0, "creation_date": 1579179874, "post_id": 30922706, "comment_id": 105684207, "body": "Has there been any changes since cabal 3 has been released?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 747, "user_id": 6933270, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7AdXs.jpg?s=128&g=1", "display_name": "William Rusnack", "link": "https://stackoverflow.com/users/6933270/william-rusnack"}, "edited": false, "score": 1, "creation_date": 1584065213, "post_id": 30922706, "comment_id": 107329069, "body": "@WilliamRusnack Yes, there have. Primarily, the default Cabal workflow now incorporates dependency conflict avoidance, though the strategy it uses to do so is noticeably different from Stack&#39;s. (@Sibi: I have taken the liberty to update your answer so that it better reflect where things stand these days.)"}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 87, "last_activity_date": 1589798514, "last_edit_date": 1589798514, "creation_date": 1434651038, "answer_id": 30922706, "question_id": 30913145, "link": "https://stackoverflow.com/questions/30913145/what-is-the-difference-between-cabal-and-stack/30922706#30922706", "title": "What is the difference between Cabal and Stack?", "body": "<blockquote>\n  <p>Is stack a replacement for Cabal? </p>\n</blockquote>\n\n<p>Yes and No.</p>\n\n<blockquote>\n  <p>In which cases should I use Stack instead of Cabal? What can Stack do that Cabal can't?</p>\n</blockquote>\n\n<p>Stack uses the curated stackage packages by <em>default</em>. That being so, any dependencies are known to build together, avoiding version conflict problems (which, back when they were commonplace in the Haskell experience, used to be known as \"cabal hell\"). Recent versions of Cabal also have measures in place to prevent conflict. Still, setting up a reproducible build configuration in which you know exactly what will be pulled from the repositories is more straightforward with Stack. Note that there is also provision for using non stackage packages, so you are good to go even if a package isn't present in the stackage snapshot.</p>\n\n<p>Personally, I like Stack and would recommend every Haskell developers to use it. Their development is <em>fast</em>. And it has a <strong>much</strong> better UX. And there are things which Stack does which Cabal yet doesn't provide:</p>\n\n<ul>\n<li>Stack even downloads GHC for you and keeps it in an isolated location.</li>\n<li>Docker support (which is very convenient for deploying your Haskell applications)</li>\n<li><a href=\"https://docs.haskellstack.org/en/stable/GUIDE/#script-interpreter\" rel=\"noreferrer\">Reproducible Haskell script</a>: You can pinpoint version of a package and can get guarantee that it will always execute without any problem. (<a href=\"https://www.haskell.org/cabal/users-guide/nix-local-build.html#cabal-v2-run\" rel=\"noreferrer\">Cabal also has a script feature</a>, but fully ensuring reproducibility with it is not quite as straightforward.) </li>\n<li>Ability to do <code>stack build --fast --file-watch</code>. This will automatically rebuild if you change the local files present. Using it along with <code>--pedantic</code> option is a deal-breaker for me.</li>\n<li>Stack supports creating projects using <a href=\"https://github.com/commercialhaskell/stack-templates\" rel=\"noreferrer\">templates</a>. It also supports your own custom templates.</li>\n<li>Stack has built-in <a href=\"https://github.com/sol/hpack\" rel=\"noreferrer\">hpack</a> support in it. It provides an alternative (IMO, a better) way of writing cabal files using yaml file which is more widely used in the industry.</li>\n<li>Intero has a smooth experience <a href=\"https://github.com/commercialhaskell/intero/blob/master/TOOLING.md\" rel=\"noreferrer\">when working with Stack</a>.</li>\n</ul>\n\n<p>There is a nice blog post explaining the difference: <a href=\"https://www.fpcomplete.com/blog/2015/06/why-is-stack-not-cabal\" rel=\"noreferrer\">Why is Stack not Cabal?</a> While Cabal has, in the intervening years since that post, evolved so as to overcome some of the issues discussed there, the discussion of the design goals and philosophy behind Stack remains relevant.</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 39, "last_activity_date": 1584360731, "last_edit_date": 1584360731, "creation_date": 1488660454, "answer_id": 42601219, "question_id": 30913145, "link": "https://stackoverflow.com/questions/30913145/what-is-the-difference-between-cabal-and-stack/42601219#42601219", "title": "What is the difference between Cabal and Stack?", "body": "<p>In what follows, I will refer to the two tools being compared as <em>cabal-install</em> and <em>stack</em>. In particular, I will use <em>cabal-install</em> to avoid confusion with the <em>Cabal</em> library, which is common infrastructure used by both tools.</p>\n\n<p>Broadly speaking, we can say <em>cabal-install</em> and <em>stack</em> are frontends to <em>Cabal</em>. Both tools make it possible to build Haskell projects whose sets of dependencies might conflict with each other within the confines of a single system. The key difference between them lies in how they address this goal:</p>\n\n<ul>\n<li><p>By default, <em>cabal-install</em> will, when asked to build a project, look at the dependencies specified in its <code>.cabal</code> file and use a dependency solver to figure out a set of packages and package versions that satisfy it. This set is drawn from <a href=\"http://hackage.haskell.org/\" rel=\"noreferrer\">Hackage</a> as a whole -- all packages and all versions, past and present. Once a feasible build plan is found, the chosen version of the dependencies will be installed and indexed in a database somewhere in <code>~/.cabal</code>. Version conflicts between dependencies are avoided by indexing the installed packages according to their versions (as well as other relevant configuration options), so that different projects can retrieve the dependency versions they need without stepping on each other's toes. This arrangement is what the <em>cabal-install</em> documentation means by <a href=\"https://www.haskell.org/cabal/users-guide/nix-local-build.html#how-it-works\" rel=\"noreferrer\">\"Nix-style local builds\"</a>.</p></li>\n<li><p>When asked to build a project, <em>stack</em> will, rather than going to Hackage, look at the <code>resolver</code> field of <a href=\"https://docs.haskellstack.org/en/stable/yaml_configuration/\" rel=\"noreferrer\"><code>stack.yaml</code></a>. In the default workflow, that field specifies a <a href=\"https://www.stackage.org/\" rel=\"noreferrer\">Stackage</a> <em>snapshot</em>, which is a subset of Hackage packages with <em>fixed</em> versions that are known to be mutually compatible. <em>stack</em> will then attempt to satisfy the dependencies specified in the <code>.cabal</code> file (or possibly <a href=\"https://docs.haskellstack.org/en/stable/faq/#does-stack-support-the-hpack-specification\" rel=\"noreferrer\">the <code>project.yaml</code> file</a> -- different format, same role) using only what is provided by the snapshot. Packages installed from each snapshot are registered in separate databases, which do not interfere with each other.</p></li>\n</ul>\n\n<p>We might say that the <em>stack</em> approach trades some setup flexibility for straightforwardness when it comes to specifying a build configuration. In particular, if you know that your project uses, say, the LTS 15.3 snapshot, you can go to <a href=\"https://www.stackage.org/lts-15.3\" rel=\"noreferrer\">its Stackage page</a> and know, at a glance, the versions of any dependency <em>stack</em> might pull from Stackage. That said, both tools offer features that go beyond the basic workflows so that, by and large, each can do all that the other does (albeit possibly in a less convenient manner). For instance, there are ways to <a href=\"https://www.haskell.org/cabal/users-guide/nix-local-build.html#cabal-v2-freeze\" rel=\"noreferrer\">freeze exact versions of a known good build configuration</a> and to <a href=\"https://www.haskell.org/cabal/users-guide/nix-local-build.html#cfg-field-index-state\" rel=\"noreferrer\">solve dependencies with an old state of Hackage</a> with <em>cabal-install</em>, and it is possible to <a href=\"https://docs.haskellstack.org/en/stable/yaml_configuration/#extra-deps\" rel=\"noreferrer\">require non-Stackage dependencies or override snapshot package versions</a> while using <em>stack</em>.</p>\n\n<p>Lastly, another difference between <em>cabal-install</em> and <em>stack</em> which is big enough to be worth mentioning in this overview is that <em>stack</em> aims at providing a complete build environment, with features such as <a href=\"https://docs.haskellstack.org/en/stable/faq/#i-already-have-ghc-installed-can-i-still-use-stack\" rel=\"noreferrer\">automatic GHC installation management</a> and <a href=\"https://docs.haskellstack.org/en/stable/docker_integration/\" rel=\"noreferrer\">Docker integration</a>. In contrast, <em>cabal-install</em> is meant to be orthogonal to other parts of the ecosystem, and so it doesn't attempt to provide this sort of feature (in particular, GHC versions have to be installed and managed separately, be it through Linux distro packages, the <a href=\"https://www.haskell.org/platform/#windows\" rel=\"noreferrer\">Haskell Platform Core</a> in Windows, or <a href=\"https://www.haskell.org/ghcup/\" rel=\"noreferrer\">the ghcup tool</a>).</p>\n"}], "owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31189, "favorite_count": 29, "accepted_answer_id": 30922706, "answer_count": 3, "score": 123, "last_activity_date": 1589798514, "creation_date": 1434624177, "last_edit_date": 1488660551, "question_id": 30913145, "link": "https://stackoverflow.com/questions/30913145/what-is-the-difference-between-cabal-and-stack", "title": "What is the difference between Cabal and Stack?", "body": "<p>Yesterday I learnt about a new Haskell tool called <a href=\"https://github.com/commercialhaskell/stack\" rel=\"noreferrer\">Stack</a>. At the first blush, it looks like it does much the same job as Cabal. So, what is the difference between them? Is stack a replacement for Cabal? In which cases should I use Stack instead of Cabal? What can Stack do that Cabal can't?</p>\n"}, {"tags": ["haskell", "syntax", "infix-notation", "applicative", "infix-operator"], "answers": [{"comments": [{"owner": {"reputation": 4530, "user_id": 94687, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/ef249e4381c9d55297cddc4bd5b5c3c2?s=128&d=identicon&r=PG", "display_name": "imz -- Ivan Zakharyaschev", "link": "https://stackoverflow.com/users/94687/imz-ivan-zakharyaschev"}, "edited": false, "score": 1, "creation_date": 1434620097, "post_id": 30911380, "comment_id": 49860698, "body": "Thanks for this smart observation!"}, {"owner": {"reputation": 4530, "user_id": 94687, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/ef249e4381c9d55297cddc4bd5b5c3c2?s=128&d=identicon&r=PG", "display_name": "imz -- Ivan Zakharyaschev", "link": "https://stackoverflow.com/users/94687/imz-ivan-zakharyaschev"}, "edited": false, "score": 0, "creation_date": 1434620970, "post_id": 30911380, "comment_id": 49861349, "body": "Well, I meant bringing the other Functor instance into consideration. Perhaps, &quot;observation&quot; is not a good word for this."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1434746387, "post_id": 30911380, "comment_id": 49928368, "body": "Moral of the story: (&lt;$&gt;) = (.) for the function Functor."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1434746667, "post_id": 30911380, "comment_id": 49928491, "body": "The <code>(&lt;$&gt;)</code> function for the function functor composes a function before a function which functions as the functor, whose <code>Functor</code> instance has the <code>(&lt;$&gt;)</code> function defined as the <code>(.)</code> function, whose function is to take a function and yield a function which takes a function and gives a function that functions like both functions composed together."}, {"owner": {"reputation": 4530, "user_id": 94687, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/ef249e4381c9d55297cddc4bd5b5c3c2?s=128&d=identicon&r=PG", "display_name": "imz -- Ivan Zakharyaschev", "link": "https://stackoverflow.com/users/94687/imz-ivan-zakharyaschev"}, "edited": false, "score": 0, "creation_date": 1436288139, "post_id": 30911380, "comment_id": 50543723, "body": "The same explanation for a code that mysteriously type-checks (not sure whether that code is additionally wrong or still equivalent to what was intended): <a href=\"http://stackoverflow.com/q/9753389/94687\"><code>forever putStrLn &quot;Hello, infinity&quot;</code></a>"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 21, "last_activity_date": 1436521263, "last_edit_date": 1436521263, "creation_date": 1434619330, "answer_id": 30911380, "question_id": 30911093, "link": "https://stackoverflow.com/questions/30911093/why-is-f-g-x-equivalent-to-f-g-x-although-is-not-right-assoc/30911380#30911380", "title": "Why is f &lt;$&gt; g &lt;$&gt; x equivalent to (f . g) &lt;$&gt; x although &lt;$&gt; is not right-associative?", "body": "<blockquote>\n  <p>Why is <code>f &lt;$&gt; g &lt;$&gt; x</code> equivalent to <code>(f . g) &lt;$&gt; x</code>?</p>\n</blockquote>\n\n<p>This isn't so much a functor-thing as a Haskell-thing. The reason it works is that functions are functors. Both <code>&lt;$&gt;</code> operators work in different functors!</p>\n\n<p><code>f &lt;$&gt; g</code> is in fact <em>the same</em> as <code>f . g</code>, so the equivalence you're asking about is rather more trivial than <code>f &lt;$&gt; (g &lt;$&gt; x) \u2261 f . g &lt;$&gt; x</code>.</p>\n"}], "owner": {"reputation": 4530, "user_id": 94687, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/ef249e4381c9d55297cddc4bd5b5c3c2?s=128&d=identicon&r=PG", "display_name": "imz -- Ivan Zakharyaschev", "link": "https://stackoverflow.com/users/94687/imz-ivan-zakharyaschev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "accepted_answer_id": 30911380, "answer_count": 1, "score": 12, "last_activity_date": 1436521263, "creation_date": 1434618560, "last_edit_date": 1495539829, "question_id": 30911093, "link": "https://stackoverflow.com/questions/30911093/why-is-f-g-x-equivalent-to-f-g-x-although-is-not-right-assoc", "title": "Why is f &lt;$&gt; g &lt;$&gt; x equivalent to (f . g) &lt;$&gt; x although &lt;$&gt; is not right-associative?", "body": "<p>Why is <code>f &lt;$&gt; g &lt;$&gt; x</code> equivalent to <code>(f . g) &lt;$&gt; x</code> although <code>&lt;$&gt;</code> is not right-associative?</p>\n\n<p>(This kind of equivalence is valid in <a href=\"https://stackoverflow.com/q/3030675/94687\">a popular idiom</a> with plain <code>$</code>, but currently <code>$</code> is right-associative!)</p>\n\n<p><code>&lt;*&gt;</code> has the same associativity and precedence as <code>&lt;$&gt;</code>, but behaves differently!</p>\n\n<p>Example:</p>\n\n<pre><code>Prelude Control.Applicative&gt; (show . show) &lt;$&gt; Just 3\nJust \"\\\"3\\\"\"\nPrelude Control.Applicative&gt; show &lt;$&gt; show &lt;$&gt; Just 3\nJust \"\\\"3\\\"\"\nPrelude Control.Applicative&gt; pure show &lt;*&gt; pure show &lt;*&gt; Just 3\n\n&lt;interactive&gt;:12:6:\n    Couldn't match type `[Char]' with `a0 -&gt; b0'\n    Expected type: (a1 -&gt; String) -&gt; a0 -&gt; b0\n      Actual type: (a1 -&gt; String) -&gt; String\n    In the first argument of `pure', namely `show'\n    In the first argument of `(&lt;*&gt;)', namely `pure show'\n    In the first argument of `(&lt;*&gt;)', namely `pure show &lt;*&gt; pure show'\nPrelude Control.Applicative&gt; \nPrelude Control.Applicative&gt; :i (&lt;$&gt;)\n(&lt;$&gt;) :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n    -- Defined in `Data.Functor'\ninfixl 4 &lt;$&gt;\nPrelude Control.Applicative&gt; :i (&lt;*&gt;)\nclass Functor f =&gt; Applicative f where\n  ...\n  (&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b\n  ...\n    -- Defined in `Control.Applicative'\ninfixl 4 &lt;*&gt;\nPrelude Control.Applicative&gt; \n</code></pre>\n\n<p>From the definition of <code>&lt;$&gt;</code>, I would expect <code>show &lt;$&gt; show &lt;$&gt; Just 3</code> to fail, too.</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1434616946, "post_id": 30908892, "comment_id": 49858538, "body": "Theoretically, <code>foldr</code> is the most general list eliminator, but one hardly wants to use it in all cases. In your example, I&#39;d write <code>map foo (tails list)</code> and do the splitting by hand, or even <code>[ f x xs | (x:xs) &lt;- tails list ]</code> which handles the empty tail case more gracefully."}], "answers": [{"comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1434635968, "post_id": 30910100, "comment_id": 49872178, "body": "Well.  With the exception that <code>[]</code> can&#39;t be an instance of <code>Comonad</code>. But Edward Kmett has a <a href=\"https://hackage.haskell.org/package/semigroupoids-5.0.0.2/docs/Data-Functor-Extend.html\" rel=\"nofollow noreferrer\">package including comonad-without-extract</a>."}], "tags": [], "owner": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "is_accepted": false, "score": 6, "last_activity_date": 1434615793, "last_edit_date": 1495541670, "creation_date": 1434615793, "answer_id": 30910100, "question_id": 30908892, "link": "https://stackoverflow.com/questions/30908892/recursion-scheme-in-haskell-for-repeatedly-breaking-datatypes-into-head-and-t/30910100#30910100", "title": "Recursion scheme in Haskell for repeatedly breaking datatypes into &quot;head&quot; and &quot;tail&quot; and yielding a structure of results", "body": "<p>What you are asking for is a <strong>comonad</strong>. This may sound scarier than <em>monad</em>, but is a simpler concept (YMMV).</p>\n\n<p>Comonads are Functors with additional structure:</p>\n\n<pre><code>class Functor w =&gt; Comonad w where\n    extract :: w a -&gt; a\n    duplicate :: w a -&gt; w (w a)\n    extend :: (w a -&gt; b) -&gt; w a -&gt; w b\n</code></pre>\n\n<p>(<code>extend</code>and <code>duplicate</code> can be defined in terms of each other)\nand laws similar to the monad laws:</p>\n\n<pre><code>duplicate . extract = id\nduplicate . fmap extract = id\nduplicate . duplicate = fmap duplicate . duplicate\n</code></pre>\n\n<p>Specifically, the signature <code>(a -&gt; [a] -&gt; b)</code> takes non-empty Lists of type <code>a</code>. The usual type <code>[a]</code> is not an instance of a comonad, but the non-empty lists are:</p>\n\n<pre><code>data NE a = T a | a :. NE a deriving Functor\n\ninstance Comonad NE where\n   extract (T x) = x\n   extract (x :. _) = x\n   duplicate z@(T _) = T z\n   duplicate z@(_ :. xs) = z :. duplicate xs\n</code></pre>\n\n<p>The comonad laws allow only this instance for non-empty lists (actually a second one).</p>\n\n<p>Your function then becomes</p>\n\n<pre><code>extend (take 3 . drop 1 . toList)\n</code></pre>\n\n<p>Where <code>toList :: NE a -&gt; [a]</code> is obvious.\nThis is worse than the original, but extend can be written as <code>=&gt;&gt;</code> which is simpler if applied repeatedly.</p>\n\n<p>For further information, you may start at <a href=\"https://stackoverflow.com/q/8428554/412549\">What is the Comonad typeclass in Haskell?</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": true, "score": 3, "last_activity_date": 1434638831, "creation_date": 1434638831, "answer_id": 30918671, "question_id": 30908892, "link": "https://stackoverflow.com/questions/30908892/recursion-scheme-in-haskell-for-repeatedly-breaking-datatypes-into-head-and-t/30918671#30918671", "title": "Recursion scheme in Haskell for repeatedly breaking datatypes into &quot;head&quot; and &quot;tail&quot; and yielding a structure of results", "body": "<p>This looks like a special case of a (jargon here but it can help with googling) paramorphism, a generalisation of <a href=\"https://en.wikipedia.org/wiki/Primitive_recursive_function\" rel=\"nofollow\">primitive recursion</a> to all initial algebras.</p>\n\n<h2>Reimplementing ListCase</h2>\n\n<p>Let's have a look at how to reimplement your function using such a combinator. First we define the notion of paramorphism: a recursion principle where not only the result of the recursive call is available but also the entire substructure this call was performed on:</p>\n\n<p>The type of <code>paraList</code> tells me that in the <code>(:)</code> case, I will have access to the head, the tail and the value of the recursive call on the tail and that I need to provide a value for the base case.</p>\n\n<pre><code>module ListCase where\n\nparaList :: (a -&gt; [a] -&gt; b -&gt; b) -- cons\n            -&gt; b                 -- nil\n            -&gt; [a] -&gt; b          -- resulting function on lists\nparaList c n []       = n\nparaList c n (x : xs) = c x xs $ paraList c n xs\n</code></pre>\n\n<p>We can now give an alternative definition of <code>listCase</code>:</p>\n\n<pre><code>listCase' :: (a -&gt; [a] -&gt; b) -&gt; [a] -&gt; [b]\nlistCase' c = paraList (\\ x xs tl -&gt; c x xs : tl) []\n</code></pre>\n\n<h2>Considering the general case</h2>\n\n<p>In the general case, we are interested in building a definition of paramorphism for all data structures defined as the fixpoint of a (strictly positive) functor. We use the traditional fixpoint operator:</p>\n\n<pre><code>newtype Fix f = Fix { unFix :: f (Fix f) }\n</code></pre>\n\n<p>This builds an inductive structure layer by layer. The layers have an <code>f</code> shape which maybe better grasped by recalling the definition of <code>List</code> using this formalism. A layer is either <code>Nothing</code> (we're done!) or <code>Just (head, tail)</code>:</p>\n\n<pre><code>newtype ListF a as = ListF { unListF :: Maybe (a, as) }\ntype List a = Fix (ListF a)\n\nnil :: List a\nnil = Fix $ ListF $ Nothing\n\ncons :: a -&gt; List a -&gt; List a\ncons = curry $ Fix . ListF .Just\n</code></pre>\n\n<p>Now that we have this general framework, we can define para generically for all <code>Fix f</code> where <code>f</code> is a functor:</p>\n\n<pre><code>para :: Functor f =&gt; (f (Fix f, b) -&gt; b) -&gt; Fix f -&gt; b\npara alg = alg . fmap (\\ rec -&gt; (rec, para alg rec)) . unFix\n</code></pre>\n\n<p>Of course, <code>ListF a</code> is a functor. Meaning we could use <code>para</code> to reimplement <code>paraList</code> and <code>listCase</code>.</p>\n\n<pre><code>instance Functor (ListF a) where fmap f = ListF . fmap (fmap f) . unListF\n\nparaList' :: (a -&gt; List a -&gt; b -&gt; b) -&gt; b -&gt; List a -&gt; b\nparaList' c n = para $ maybe n (\\ (a, (as, b)) -&gt; c a as b) . unListF\n\nlistCase'' :: (a -&gt; List a -&gt; b) -&gt; List a -&gt; List b\nlistCase'' c = paraList' (\\ x xs tl -&gt; cons (c x xs) tl) nil\n</code></pre>\n\n<p>You can implement a simple bijection <code>toList</code>, <code>fromList</code> to test it if you want. I could not be bothered to reimplement <code>take</code> so it's pretty ugly:</p>\n\n<pre><code>toList :: [a] -&gt; List a\ntoList = foldr cons nil\n\nfromList :: List a -&gt; [a]\nfromList = paraList' (\\ x _ tl -&gt; x : tl) []\n\n*ListCase&gt; fmap fromList . fromList . listCase'' (\\ _ as -&gt; toList $ take 3 $ fromList as). toList $ [1..5]\n[[2,3,4],[3,4,5],[4,5],[5],[]]\n</code></pre>\n"}], "owner": {"reputation": 617, "user_id": 2036930, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5611c46bb33e051bf692b69cf4411377?s=128&d=identicon&r=PG", "display_name": "statusfailed", "link": "https://stackoverflow.com/users/2036930/statusfailed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 1, "accepted_answer_id": 30918671, "answer_count": 2, "score": 1, "last_activity_date": 1434638831, "creation_date": 1434611995, "question_id": 30908892, "link": "https://stackoverflow.com/questions/30908892/recursion-scheme-in-haskell-for-repeatedly-breaking-datatypes-into-head-and-t", "title": "Recursion scheme in Haskell for repeatedly breaking datatypes into &quot;head&quot; and &quot;tail&quot; and yielding a structure of results", "body": "<p>In Haskell, I recently found the following function useful:</p>\n\n<pre><code>listCase :: (a -&gt; [a] -&gt; b) -&gt; [a] -&gt; [b]\nlistCase f [] = []\nlistCase f (x:xs) = f x xs : listCase f xs\n</code></pre>\n\n<p>I used it to generate sliding windows of size 3 from a list, like this:</p>\n\n<pre><code>*Main&gt; listCase (\\_ -&gt; take 3) [1..5]\n[[2,3,4],[3,4,5],[4,5],[5],[]]\n</code></pre>\n\n<p>Is there a more general recursion scheme which captures this pattern? More specifically, that allows you to generate a some structure of results by repeatedly breaking data into a \"head\" and \"tail\"?</p>\n"}, {"tags": ["haskell", "game-engine", "frp", "arrows", "netwire"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1434603385, "post_id": 30905930, "comment_id": 49851492, "body": "Haskell isn&#39;t any other language you&#39;ve used.  Function calls don&#39;t use the stack.  And <code>IO</code> isn&#39;t a function anyway.  You need new mental models - the ones you&#39;ve got are leading you astray."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1434604675, "post_id": 30905930, "comment_id": 49851932, "body": "I would not suggest that adventure game as a model. The code appears to be insufficiently structured and nearly unreadable."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1434605226, "post_id": 30905930, "comment_id": 49852156, "body": "Tail recursion isn&#39;t as central to memory behavior in Haskell as it tends to be in call-by-value languages. A closer mental model of what you&#39;re after is tail recursion modulo cons, a less common scheme, but Haskell&#39;s actual operational semantics is based on &quot;graph reduction&quot;. The best way to think about it is probably to reduce expressions by hand, working always from the outside in."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1434605955, "post_id": 30905930, "comment_id": 49852430, "body": "Your game is basically a big while loop. Write the loop body - the function that implements the logic of the game - and the rest is trivial. You should certainly leverage the power of StateT and other monad transformers. Say your <code>body</code> function has type <code>ExceptT String (StateT GameState IO) ()</code> - the StateT for game logic, ExceptT for exiting, IO for, well, IO - then your entire game will be <code>Control.Monad.forever body</code>."}, {"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1434623677, "post_id": 30905930, "comment_id": 49863112, "body": "So even it is not tail recursion, I don&#39;t need to worry about stack overflow?"}, {"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1434624546, "post_id": 30905930, "comment_id": 49863693, "body": "But according to <a href=\"https://wiki.haskell.org/Stack_overflow\" rel=\"nofollow noreferrer\">wiki.haskell.org/Stack_overflow</a> , it seems that I still can get stack overflow if I don&#39;t use tail recursion. How would I implement the &quot;while loop&quot; in Haskell?"}, {"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1434625991, "post_id": 30905930, "comment_id": 49864628, "body": "@Carl I tested it and apparently looping without tail recursion does cost stack. I think the last function call is <code>(&gt;&gt;=)</code> instead of <code>guessSession</code>, right?"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1434632417, "post_id": 30905930, "comment_id": 49869239, "body": "Expressions whose evaluation requires evaluating a deeply-nested graph cost stack space.  You can create those with or without tail recursion. You can also create expressions that don&#39;t require evaluating deeply-nested graphs with or without tail recursion.  The point is that it&#39;s a red herring. Haskell code just doesn&#39;t work the way you think."}, {"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1434633128, "post_id": 30905930, "comment_id": 49869828, "body": "After reading more about how haskell works, I understand now. I will also try make one using <code>State</code>, if possible."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1434644028, "post_id": 30918377, "comment_id": 49878230, "body": "The lazy version is less well-behaved in general, so the strict one should be used unless there&#39;s a good reason to use the lazy. The strictness comes not from dirty tricks with <code>seq</code> but from plain pattern matching."}], "tags": [], "owner": {"reputation": 1521, "user_id": 365807, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8c9db2824164d60fe55d2b0c1c361f20?s=128&d=identicon&r=PG", "display_name": "Fraser", "link": "https://stackoverflow.com/users/365807/fraser"}, "is_accepted": false, "score": 2, "last_activity_date": 1434638194, "creation_date": 1434638194, "answer_id": 30918377, "question_id": 30905930, "link": "https://stackoverflow.com/questions/30905930/what-can-be-a-minimal-example-of-game-written-in-haskell/30918377#30918377", "title": "What can be a minimal example of game written in Haskell?", "body": "<p>Your problem is that you're using the lazy version of the StateT transformer, which builds up a massive thunk from the repeated <code>modify</code>s (because they are never fully evaluated). If you import <code>Control.Monad.State.Strict</code> instead, it will probably work fine without any overflows.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443738610, "post_id": 32897603, "comment_id": 53624722, "body": "Is there really no better way to figure out what keys are down? I&#39;d have expected that sort of thing to be in a library."}, {"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443738837, "post_id": 32897603, "comment_id": 53624795, "body": "But since I am using SDL, so I have to make some functions"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443739952, "post_id": 32897603, "comment_id": 53625091, "body": "It appears that <code>mkSW_</code> should <i>probably</i> use <code>accumE</code> along with one of the switchers from <code>Control.Wire.Switch</code>, but I&#39;ve never used Netwire. Anyway, nice job putting this whole thing together with explanations."}, {"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443740425, "post_id": 32897603, "comment_id": 53625214, "body": "<code>mkSW_</code> is a custom function for constructing stateful wires, while <code>accumE</code> works on events. I don&#39;t think I need switchers for this simple &quot;game&quot; though."}], "tags": [], "owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "is_accepted": true, "score": 3, "last_activity_date": 1443741140, "last_edit_date": 1495540950, "creation_date": 1443737267, "answer_id": 32897603, "question_id": 30905930, "link": "https://stackoverflow.com/questions/30905930/what-can-be-a-minimal-example-of-game-written-in-haskell/32897603#32897603", "title": "What can be a minimal example of game written in Haskell?", "body": "<h1>Foreword</h1>\n\n<p>After 3 months of digging through numerous websites and trying out some small projects, I finally get to implement a minimalistic game (or is it?), in a very, very different way. This example exists merely to demonstrate one possible structure of a game written in Haskell, and should easily be extended to handle more complex logic and gameplay.</p>\n\n<p>Full code and tutorial available on <a href=\"https://github.com/carldong/HMovePad-Tutorial\" rel=\"nofollow noreferrer\">https://github.com/carldong/HMovePad-Tutorial</a></p>\n\n<h1>Abstract</h1>\n\n<p>This mini game has only one rectangle, which the player can move left and right by pressing Left and Right key, and that is the whole \"game\".</p>\n\n<p>The game is implemented using <code>netwire-5.0.1</code>, with <code>SDL</code> handling graphics. If I understand correctly, the architecture is fully functional reactive. Almost everything is implemented by Arrow composition, with only one function exposed in <code>IO</code>. Therefore, I expect the reader to have basic understanding of the Arrow syntax of Haskell, since it is used extensively.</p>\n\n<p>The implementation order of this game is chosen to make debugging easy, and the implementation itself is chosen to demonstrate different usage of <code>netwire</code> as much as possible.</p>\n\n<p>Continuous time semantic is used for I/O, but discrete events are used to handle game events within the game logic.</p>\n\n<h1>Set up SDL</h1>\n\n<p>The very first step is to make sure SDL works. The source is simple:</p>\n\n<pre><code>module Main where\n\nimport qualified Graphics.UI.SDL as SDL\n\nmain :: IO ()\nmain = do\n  SDL.init [SDL.InitEverything]\n  w &lt;- SDL.setVideoMode 800 600 32 [SDL.SWSurface]\n  s &lt;- SDL.createRGBSurfaceEndian [SDL.SWSurface] 800 600 32 \n  SDL.fillRect s (Just testRect) (SDL.Pixel 0xFFFFFFFF)\n  SDL.blitSurface s (Nothing) w (Nothing) \n  SDL.flip w\n  testLoop\n  SDL.quit\n      where\n        testLoop = testLoop\n        testRect = SDL.Rect 350 500 100 50\n</code></pre>\n\n<p>If everything works, there should be a white rectangle appearing on the bottom of the window appearing. Note that clicking the <code>x</code> will not close the window. It has to be closed by <code>Ctrl-C</code> or killing.</p>\n\n<h1>Set up Output Wires</h1>\n\n<p>Since we do not want to implement all the way to the last step and find that nothing can be drawn on screen, we are doing the output part first.</p>\n\n<p>We need the Arrows syntax:</p>\n\n<pre><code>{-# LANGUAGE Arrows #-}\n</code></pre>\n\n<p>Also, we need to import some stuff:</p>\n\n<pre><code>import Prelude hiding ((.), id)\nimport Control.Wire\nimport Control.Arrow\nimport Control.Monad\nimport Data.Monoid\nimport qualified Graphics.UI.SDL as SDL\n</code></pre>\n\n<p>We need to understand how to construct Kleisli Wires: <a href=\"https://stackoverflow.com/questions/32745934/kleisli-arrow-in-netwire-5\">Kleisli Arrow in Netwire 5?</a>. A basic structure of a interactive program using Kleisli Wires is shown in this example: <a href=\"https://stackoverflow.com/questions/30992299/console-interactivity-in-netwire\">Console interactivity in Netwire?</a>. To construct a Kleisli Wire from anything with type <code>a -&gt; m b</code>, we need:</p>\n\n<pre><code>mkKleisli :: (Monad m, Monoid e) =&gt; (a -&gt; m b) -&gt; Wire s e m a b\nmkKleisli f = mkGen_ $ \\a -&gt; liftM Right $ f a\n</code></pre>\n\n<p>Then, since I did not get <code>trace</code> to work under Arrow processes, a debug wire is made to print objects to console:</p>\n\n<pre><code>wDebug :: (Show a, Monoid e) =&gt; Wire s e IO a ()\nwDebug = mkKleisli $ \\a -&gt; putStrLn $ show a\n</code></pre>\n\n<p>Now it is time to write some functions to be lifted into wires. For output, we need a function that returns a <code>SDL.Surface</code> with proper rectangle drawn given the X coordinate of the pad:</p>\n\n<pre><code>padSurf :: SDL.Surface\n            -&gt; Int\n            -&gt; IO SDL.Surface\npadSurf surf x' = do\n  let rect' = SDL.Rect x' 500 100 50\n  clipRect &lt;- SDL.getClipRect surf\n  SDL.fillRect surf (Just clipRect) (SDL.Pixel 0x00000000)\n  SDL.fillRect surf (Just rect') (SDL.Pixel 0xFFFFFFFF)\n  return surf\n</code></pre>\n\n<p>Be careful, this function does destructive updates. The surface passed in will be blitted onto the window surface later.</p>\n\n<p>Now we have the surface. The output wire is then trivil:</p>\n\n<pre><code>wTestOutput :: SDL.Surface -&gt; Wire s () IO () SDL.Surface\nwTestOutput surf = mkKleisli $ \\_ -&gt; testPad\n    where\n      testPad = padSurf surf 350\n</code></pre>\n\n<p>Then, we put wires together, and play with them a bit:</p>\n\n<pre><code>gameWire :: SDL.Surface \n         -&gt; Wire s () IO () SDL.Surface\ngameWire w = proc _ -&gt; do\n               finalSurf &lt;- wTestOutput w -&lt; ()\n               wDebug -&lt; \"Try a debug message\"\n               returnA -&lt; finalSurf\n</code></pre>\n\n<p>Finally, we change <code>main</code> and drive the wires properly:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  SDL.init [SDL.InitEverything]\n  w &lt;- SDL.setVideoMode 800 600 32 [SDL.SWSurface]\n  s &lt;- SDL.createRGBSurfaceEndian [SDL.SWSurface] 800 600 32 \n  run w (countSession_ 1) $ gameWire w\n  SDL.quit\n\nrun ::SDL.Surface -&gt;  Session IO s -&gt; Wire s () IO () SDL.Surface -&gt; IO ()\nrun mainSurf s w  = do\n  (ds, s') &lt;- stepSession s\n  (eSrcSurf, w') &lt;- stepWire w ds (Right ())\n  case eSrcSurf of \n    Right srcSurf -&gt; do \n                  SDL.blitSurface srcSurf (Nothing) mainSurf (Nothing)\n                  SDL.flip mainSurf\n                  SDL.delay 30\n                  run mainSurf s' w'\n    _ -&gt; return ()\n</code></pre>\n\n<p>Note that if you like, you can also make another wire to handle the main window surface too (and it is easy and better than my current implementation), but I was too late and lazy to add that. Check out the interactive example I mentioned above to see how simple <code>run</code> can get (it can get even simpler if inhibition is used instead of <code>quitWire</code> in that example).</p>\n\n<p>When the program is run, its appearance should be the same as before.</p>\n\n<p>Here is the complete code:</p>\n\n<pre><code>{-|\n  01-OutputWires.hs: This step, the output wires are constructed first for\n  easy debugging\n-}\n\n{-# LANGUAGE Arrows #-}\n\nmodule Main where\n\nimport Prelude hiding ((.), id)\nimport Control.Wire\nimport Control.Arrow\nimport Control.Monad\nimport Data.Monoid\nimport qualified Graphics.UI.SDL as SDL\n\n{- Wire Utilities -}\n\n-- | Make a Kleisli wire\nmkKleisli :: (Monad m, Monoid e) =&gt; (a -&gt; m b) -&gt; Wire s e m a b\nmkKleisli f = mkGen_ $ \\a -&gt; liftM Right $ f a\n\n-- | The debug wire\nwDebug :: (Show a, Monoid e) =&gt; Wire s e IO a ()\nwDebug = mkKleisli $ \\a -&gt; putStrLn $ show a\n\n{- Functions to be lifted -}\n\npadSurf :: SDL.Surface\n            -- ^ Previous state of surface \n            -&gt; Int\n            -- ^ X'\n            -- | New state\n            -&gt; IO SDL.Surface\npadSurf surf x' = do\n  let rect' = SDL.Rect x' 500 100 50\n  clipRect &lt;- SDL.getClipRect surf\n  SDL.fillRect surf (Just clipRect) (SDL.Pixel 0x00000000)\n  SDL.fillRect surf (Just rect') (SDL.Pixel 0xFFFFFFFF)\n  return surf\n\n\n{- Wires -}\n\nwTestOutput :: SDL.Surface -&gt; Wire s () IO () SDL.Surface\nwTestOutput surf = mkKleisli $ \\_ -&gt; testPad\n    where\n      testPad = padSurf surf 350\n\n\n-- | This is the main game wire\ngameWire :: SDL.Surface \n         -- ^ The main surface (i.e. the window)\n         -&gt; Wire s () IO () SDL.Surface\ngameWire w = proc _ -&gt; do\n               finalSurf &lt;- wTestOutput w -&lt; ()\n               wDebug -&lt; \"Try a debug message\"\n               returnA -&lt; finalSurf\n\nmain :: IO ()\nmain = do\n  SDL.init [SDL.InitEverything]\n  w &lt;- SDL.setVideoMode 800 600 32 [SDL.SWSurface]\n  s &lt;- SDL.createRGBSurfaceEndian [SDL.SWSurface] 800 600 32 \n  run w (countSession_ 1) $ gameWire w\n  SDL.quit\n\nrun ::SDL.Surface -&gt;  Session IO s -&gt; Wire s () IO () SDL.Surface -&gt; IO ()\nrun mainSurf s w  = do\n  (ds, s') &lt;- stepSession s\n  (eSrcSurf, w') &lt;- stepWire w ds (Right ())\n  case eSrcSurf of \n    Right srcSurf -&gt; do \n                  SDL.blitSurface srcSurf (Nothing) mainSurf (Nothing)\n                  SDL.flip mainSurf\n                  SDL.delay 30\n                  run mainSurf s' w'\n    _ -&gt; return ()\n</code></pre>\n\n<h1>Input Wires</h1>\n\n<p>In this section, we are going to construct wires that gets player input into the program.</p>\n\n<p>Since we will use discrete events in the logic part, we need a data type for game events:</p>\n\n<pre><code>data GameEvent = MoveR\n               | MoveL\n               | NoEvent\n                 deriving (Show, Eq)\n-- | Make it Monoid so that game events can be combined \n-- (Only applicable in this \"game\"!)\ninstance Monoid GameEvent where\n    mempty = NoEvent\n    -- | Simultaneously moving left and right is just nothing\n    MoveR `mappend` MoveL = NoEvent\n    MoveL `mappend` MoveR = NoEvent\n    -- | NoEvent is the identity\n    NoEvent `mappend` x = x\n    x `mappend` NoEvent = x\n    x `mappend` y \n        -- | Make sure identical events return same events\n        | x == y = x\n        -- | Otherwise, no event\n        | otherwise = NoEvent\n</code></pre>\n\n<p>As comment suggested, the <code>Monoid</code> instance only applies for this particular game since it has only two opposite operations: left and right.</p>\n\n<p>First, we will poll events from SDL:</p>\n\n<pre><code>pollEvents :: [SDL.Event] -&gt; IO (Either () ([SDL.Event]))\npollEvents es = do\n  e &lt;- SDL.pollEvent\n  case e of \n    SDL.NoEvent -&gt; return $ Right es\n    SDL.Quit -&gt; return $ Left ()\n    _ -&gt; pollEvents $ e:es\n</code></pre>\n\n<p>Obviously enough, this function polls events from SDL as a list, and inhibits when the <code>Quit</code> event is received.</p>\n\n<p>Next, we need to check whether an event is a keyboard event:</p>\n\n<pre><code>isKeyEvent :: SDL.Event -&gt; Bool\nisKeyEvent (SDL.KeyDown k) = True\nisKeyEvent (SDL.KeyUp k) = True\nisKeyEvent _ = False\n</code></pre>\n\n<p>We will have a list of keys that are currently pressed, and it should update when a keyboard event occurs. In short, when a key is down, insert that key into the list, and vice versa:</p>\n\n<pre><code>keyStatus :: [SDL.Keysym] -&gt; [SDL.Event] -&gt; [SDL.Keysym]\nkeyStatus keysDown (e:es) = \n    case e of\n      -- | If a KeyDown is detected, add key to list\n      SDL.KeyDown k -&gt; keyStatus (k:keysDown) es\n      -- | If a KeyUp is detected, remove key from list\n      SDL.KeyUp k -&gt; keyStatus (filter (/= k) keysDown) es\n      _ -&gt; keyStatus keysDown es\nkeyStatus keysDown [] = keysDown\n</code></pre>\n\n<p>Next, we write a function to convert a keyboard event to a game event:</p>\n\n<pre><code>toGameEv :: SDL.Keysym -&gt; GameEvent\ntoGameEv (SDL.Keysym SDL.SDLK_RIGHT _ _) = MoveR\ntoGameEv (SDL.Keysym SDL.SDLK_LEFT _ _) = MoveL\ntoGameEv _ = NoEvent\n</code></pre>\n\n<p>We fold on the game events and get a single event (really, really, game specific!):</p>\n\n<pre><code>fireGameEv :: [SDL.Keysym] -&gt; GameEvent\nfireGameEv ks = foldl mappend NoEvent $ fmap toGameEv ks\n</code></pre>\n\n<p>Now we can start making wires.</p>\n\n<p>First, we need a wire that polls events:</p>\n\n<pre><code>wPollEvents :: Wire s () IO () [SDL.Event]\nwPollEvents = mkGen_ $ \\_ -&gt; pollEvents []\n</code></pre>\n\n<p>Note that <code>mkKleisli</code> makes wire that does not inhibit, but we want inhibition in this wire since the program should quit when it is supposed to. Therefore, we use <code>mkGen_</code> here.</p>\n\n<p>Then, we need to filter the events. First, make a helper function that makes a continuous time filter wire:</p>\n\n<pre><code>mkFW_ :: (Monad m, Monoid e) =&gt; (a -&gt; Bool) -&gt; Wire s e m [a] [a]\nmkFW_ f = mkSF_ $ filter f \n</code></pre>\n\n<p>Use <code>mkFW_</code> to make a filter:</p>\n\n<pre><code>wKeyEvents :: (Monad m, Monoid e) =&gt; Wire s e m [SDL.Event] [SDL.Event]\nwKeyEvents = mkFW_ isKeyEvent\n</code></pre>\n\n<p>Then, we need another convenient function to make a stateful wire from a stateful function of type <code>b -&gt; a -&gt; b</code>:</p>\n\n<pre><code>mkSW_ :: (Monad m, Monoid e) =&gt; b -&gt; (b-&gt;a-&gt;b) -&gt; Wire s e m a b\nmkSW_ b0 f = mkSFN $ g b0\n    where\n      g b0 a = let b1 = f b0 a in \n               (b1, mkSW_ b1 f)\n</code></pre>\n\n<p>Next, construct a stateful wire that remembers all key status:</p>\n\n<pre><code>wKeyStatus :: (Monad m, Monoid e) =&gt; Wire s e m [SDL.Event] [SDL.Keysym]\nwKeyStatus = mkSW_ empty keyStatus\n</code></pre>\n\n<p>The last piece of wire segment fires the game event:</p>\n\n<pre><code>wFireGameEv :: (Monad m, Monoid e) =&gt; Wire s e m [SDL.Keysym] (GameEvent)\nwFireGameEv = arr fireGameEv\n</code></pre>\n\n<p>To actively fire discrete events (netwire events) that contain game events, we need to hack netwire a bit (I think it is still quite incomplete) since it does not provide a wire that always fires events:</p>\n\n<pre><code>always :: (Monad m, Monoid e) =&gt; Wire s e m a (Event a)\nalways = mkSFN $ \\x -&gt; (WE.Event x, always)\n</code></pre>\n\n<p>Comparing to the implementation of <code>now</code>, the only difference is <code>never</code> and <code>always</code>.</p>\n\n<p>Finally, a big wire that combines all input wires above:</p>\n\n<pre><code>wGameInput :: Wire s () IO () (Event GameEvent)\nwGameInput = proc _ -&gt; do\n               ge &lt;- wFireGameEv &lt;&lt;&lt; wKeyStatus\n                     &lt;&lt;&lt; wKeyEvents &lt;&lt;&lt; wPollEvents -&lt; ()\n               e &lt;- always -&lt; ge\n               -- Debug!\n               case e of \n                 WE.NoEvent -&gt; wDebug -&lt; \"No Event?!!\"\n                 WE.Event g -&gt; wDebug -&lt; \"Game Event: \" ++ show g\n               -- End Debug\n               returnA -&lt; e\n</code></pre>\n\n<p>An example of debugging is also shown in this wire.</p>\n\n<p>To interface with the main program, modify <code>gameWire</code> to use the input:</p>\n\n<pre><code>gameWire w = proc _ -&gt; do\n               ev &lt;- wGameInput -&lt; ()\n               finalSurf &lt;- wTestOutput w -&lt; ()\n               returnA -&lt; finalSurf\n</code></pre>\n\n<p>Nothing else needs to be changed. Well, interesting, isn't it?</p>\n\n<p>When the program is run, the console gives a lot of output showing the current game events being fired. Try pressing left and right, and their combinations and see whether the behavior is expected. Of course, the rectangle will not move.</p>\n\n<p>Here is a huge block of code:</p>\n\n<pre><code>{-|\n  02-InputWires.hs: This step, input wires are constructed and\n  debugged by using wDebug\n-}\n\n{-# LANGUAGE Arrows #-}\n\nmodule Main where\n\nimport Prelude hiding ((.), id)\nimport Control.Wire\nimport Control.Arrow\nimport Control.Monad\nimport Data.Monoid\nimport qualified Graphics.UI.SDL as SDL\nimport qualified Control.Wire.Unsafe.Event as WE\n\n{- Data types -}\n-- | The unified datatype of game events \ndata GameEvent = MoveR\n               | MoveL\n               | NoEvent\n                 deriving (Show, Eq)\n-- | Make it Monoid so that game events can be combined \n-- (Only applicable in this \"game\"!)\ninstance Monoid GameEvent where\n    mempty = NoEvent\n    -- | Simultaneously moving left and right is just nothing\n    MoveR `mappend` MoveL = NoEvent\n    MoveL `mappend` MoveR = NoEvent\n    -- | NoEvent is the identity\n    NoEvent `mappend` x = x\n    x `mappend` NoEvent = x\n    x `mappend` y \n        -- | Make sure identical events return same events\n        | x == y = x\n        -- | Otherwise, no event\n        | otherwise = NoEvent\n\n{- Wire Utilities -}\n\n-- | Make a stateless filter wire\nmkFW_ :: (Monad m, Monoid e) =&gt; (a -&gt; Bool) -&gt; Wire s e m [a] [a]\nmkFW_ f = mkSF_ $ filter f \n\n-- -- | Make a stateful wire from a chained stateful function and initial value\n-- -- The function (a -&gt; b -&gt; a) takes in an old state /a/, and returns state \n-- -- transition function (b -&gt; a). \nmkSW_ :: (Monad m, Monoid e) =&gt; b -&gt; (b-&gt;a-&gt;b) -&gt; Wire s e m a b\nmkSW_ b0 f = mkSFN $ g b0\n    where\n      g b0 a = let b1 = f b0 a in \n               (b1, mkSW_ b1 f)\n\n-- | Make a Kleisli wire\nmkKleisli :: (Monad m, Monoid e) =&gt; (a -&gt; m b) -&gt; Wire s e m a b\nmkKleisli f = mkGen_ $ \\a -&gt; liftM Right $ f a\n\n-- | The debug wire\nwDebug :: (Show a, Monoid e) =&gt; Wire s e IO a ()\nwDebug = mkKleisli $ \\a -&gt; putStrLn $ show a\n\n-- | The \"always\" wire\nalways :: (Monad m, Monoid e) =&gt; Wire s e m a (Event a)\nalways = mkSFN $ \\x -&gt; (WE.Event x, always)\n\n{- Functions to be lifted -}\n\n-- | This is the pad surface whose X coordinate can be updated\npadSurf :: SDL.Surface\n            -- ^ Previous state of surface \n            -&gt; Int\n            -- ^ X'\n            -- | New state\n            -&gt; IO SDL.Surface\npadSurf surf x' = do\n  let rect' = SDL.Rect x' 500 100 50\n  clipRect &lt;- SDL.getClipRect surf\n  SDL.fillRect surf (Just clipRect) (SDL.Pixel 0x00000000)\n  SDL.fillRect surf (Just rect') (SDL.Pixel 0xFFFFFFFF)\n  return surf\n\n\n-- | The function to poll events and add to a list of events\npollEvents :: [SDL.Event] -&gt; IO (Either () ([SDL.Event]))\npollEvents es = do\n  e &lt;- SDL.pollEvent\n  case e of \n    SDL.NoEvent -&gt; return $ Right es\n    SDL.Quit -&gt; return $ Left ()\n    _ -&gt; pollEvents $ e:es\n\n-- | Checks whether one SDL.Event is a keyboard event\nisKeyEvent :: SDL.Event -&gt; Bool\nisKeyEvent (SDL.KeyDown k) = True\nisKeyEvent (SDL.KeyUp k) = True\nisKeyEvent _ = False\n\n-- | The raw function to process key status from events\nkeyStatus :: [SDL.Keysym] -&gt; [SDL.Event] -&gt; [SDL.Keysym]\nkeyStatus keysDown (e:es) = \n    case e of\n      -- | If a KeyDown is detected, add key to list\n      SDL.KeyDown k -&gt; keyStatus (k:keysDown) es\n      -- | If a KeyUp is detected, remove key from list\n      SDL.KeyUp k -&gt; keyStatus (filter (/= k) keysDown) es\n      _ -&gt; keyStatus keysDown es\n-- | If all events are processed, return\nkeyStatus keysDown [] = keysDown\n\n-- | Convert a SDL Keysym into \"standard\" game events\ntoGameEv :: SDL.Keysym -&gt; GameEvent\ntoGameEv (SDL.Keysym SDL.SDLK_RIGHT _ _) = MoveR\ntoGameEv (SDL.Keysym SDL.SDLK_LEFT _ _) = MoveL\ntoGameEv _ = NoEvent\n\n-- | Combine all game events to get one single firing\nfireGameEv :: [SDL.Keysym] -&gt; GameEvent\nfireGameEv ks = foldl mappend NoEvent $ fmap toGameEv ks\n\n\n\n{- Wires -}\n\n-- | The Kleisli wire to poll events\nwPollEvents :: Wire s () IO () [SDL.Event]\nwPollEvents = mkGen_ $ \\_ -&gt; pollEvents []\n\n-- | A stateless wire that filters out keyboard events\nwKeyEvents :: (Monad m, Monoid e) =&gt; Wire s e m [SDL.Event] [SDL.Event]\nwKeyEvents = mkFW_ isKeyEvent\n\n-- | A stateful wire to keep track of key status\nwKeyStatus :: (Monad m, Monoid e) =&gt; Wire s e m [SDL.Event] [SDL.Keysym]\nwKeyStatus = mkSW_ empty keyStatus\n\n-- | A wire to fire game events from SDL events\nwFireGameEv :: (Monad m, Monoid e) =&gt; Wire s e m [SDL.Keysym] (GameEvent)\nwFireGameEv = arr fireGameEv\n\n-- | This is the connected wire for the entire game input\nwGameInput :: Wire s () IO () (Event GameEvent)\nwGameInput = proc _ -&gt; do\n               ge &lt;- wFireGameEv &lt;&lt;&lt; wKeyStatus\n                     &lt;&lt;&lt; wKeyEvents &lt;&lt;&lt; wPollEvents -&lt; ()\n               e &lt;- always -&lt; ge\n               -- Debug!\n               case e of \n                 WE.NoEvent -&gt; wDebug -&lt; \"No Event?!!\"\n                 WE.Event g -&gt; wDebug -&lt; \"Game Event: \" ++ show g\n               -- End Debug\n               returnA -&lt; e\n\n-- | The wire to test output\nwTestOutput :: SDL.Surface -&gt; Wire s () IO () SDL.Surface\nwTestOutput surf = mkKleisli $ \\_ -&gt; testPad\n    where\n      testPad = padSurf surf 350\n\n\n-- | This is the main game wire\ngameWire :: SDL.Surface \n         -- ^ The main surface (i.e. the window)\n         -&gt; Wire s () IO () SDL.Surface\ngameWire w = proc _ -&gt; do\n               ev &lt;- wGameInput -&lt; ()\n               finalSurf &lt;- wTestOutput w -&lt; ()\n               returnA -&lt; finalSurf\n\nmain :: IO ()\nmain = do\n  SDL.init [SDL.InitEverything]\n  w &lt;- SDL.setVideoMode 800 600 32 [SDL.SWSurface]\n  s &lt;- SDL.createRGBSurfaceEndian [SDL.SWSurface] 800 600 32 \n  run w (countSession_ 1) $ gameWire w\n  SDL.quit\n\nrun ::SDL.Surface -&gt;  Session IO s -&gt; Wire s () IO () SDL.Surface -&gt; IO ()\nrun mainSurf s w  = do\n  (ds, s') &lt;- stepSession s\n  (eSrcSurf, w') &lt;- stepWire w ds (Right ())\n  case eSrcSurf of \n    Right srcSurf -&gt; do \n                  SDL.blitSurface srcSurf (Nothing) mainSurf (Nothing)\n                  SDL.flip mainSurf\n                  SDL.delay 30\n                  run mainSurf s' w'\n    _ -&gt; return ()\n</code></pre>\n\n<h1>\"Game\" Logic --- Finally putting everything together!</h1>\n\n<p>First, we write an integrating function of the X position of the pad:</p>\n\n<pre><code>padDX :: Int -&gt; GameEvent -&gt; Int\npadDX x0 e \n    | x &gt; 700 = 700\n    | x &lt; 0 = 0\n    | otherwise = x\n    where\n      x = x0 + go e\n      go MoveR = dx\n      go MoveL = -dx\n      go _ = 0\n      dx = 15\n</code></pre>\n\n<p>I hard coded everything, but those are not important for this minimalistic example. It should be straightforward.</p>\n\n<p>Then, we create the wire that represents the current position of the pad:</p>\n\n<pre><code>wPadX :: (Monad m, Monoid e) =&gt; Wire s e m (Event GameEvent) Int\nwPadX = accumE padDX 400 &gt;&gt;&gt; hold\n</code></pre>\n\n<p><code>hold</code> holds at the latest value of a stream of discrete event.</p>\n\n<p>Next, we put all logic things in a big logic wire:</p>\n\n<pre><code>wGameLogic :: Wire s () IO (Event GameEvent) Int\nwGameLogic = proc ev -&gt; do\n               x' &lt;- wPadX -&lt; ev\n               returnA -&lt; x'\n</code></pre>\n\n<p>Since we have one state about the X coordinate, we need to modify the output wire:</p>\n\n<pre><code>wGameOutput :: SDL.Surface -&gt; Wire s () IO Int SDL.Surface\nwGameOutput surf = mkKleisli $ testPad\n    where\n      testPad = padSurf surf \n</code></pre>\n\n<p>Finally, we chain everything in the <code>gameWire</code>:</p>\n\n<pre><code>gameWire w = proc _ -&gt; do\n               ev &lt;- wGameInput -&lt; ()\n               x &lt;- wGameLogic -&lt; ev\n               finalSurf &lt;- wGameOutput w -&lt; x\n               returnA -&lt; finalSurf\n</code></pre>\n\n<p>Nothing needs to be changed in <code>main</code> and <code>run</code>. Wow!</p>\n\n<p>And this is it! Run it and you shou be able to move the rectangle left and right!</p>\n\n<p>A GIGANTIC block of code (I am curious how long will a C++ program that does the same thing be):</p>\n\n<pre><code>{-|\n  03-GameLogic.hs: The final product!\n-}\n\n{-# LANGUAGE Arrows #-}\n\nmodule Main where\n\nimport Prelude hiding ((.), id)\nimport Control.Wire\nimport Control.Arrow\nimport Control.Monad\nimport Data.Monoid\nimport qualified Graphics.UI.SDL as SDL\nimport qualified Control.Wire.Unsafe.Event as WE\n\n{- Data types -}\n-- | The unified datatype of game events \ndata GameEvent = MoveR\n               | MoveL\n               | NoEvent\n                 deriving (Show, Eq)\n-- | Make it Monoid so that game events can be combined \n-- (Only applicable in this \"game\"!)\ninstance Monoid GameEvent where\n    mempty = NoEvent\n    -- | Simultaneously moving left and right is just nothing\n    MoveR `mappend` MoveL = NoEvent\n    MoveL `mappend` MoveR = NoEvent\n    -- | NoEvent is the identity\n    NoEvent `mappend` x = x\n    x `mappend` NoEvent = x\n    x `mappend` y \n        -- | Make sure identical events return same events\n        | x == y = x\n        -- | Otherwise, no event\n        | otherwise = NoEvent\n\n{- Wire Utilities -}\n\n-- | Make a stateless filter wire\nmkFW_ :: (Monad m, Monoid e) =&gt; (a -&gt; Bool) -&gt; Wire s e m [a] [a]\nmkFW_ f = mkSF_ $ filter f \n\n-- -- | Make a stateful wire from a chained stateful function and initial value\n-- -- The function (a -&gt; b -&gt; a) takes in an old state /a/, and returns state \n-- -- transition function (b -&gt; a). \nmkSW_ :: (Monad m, Monoid e) =&gt; b -&gt; (b-&gt;a-&gt;b) -&gt; Wire s e m a b\nmkSW_ b0 f = mkSFN $ g b0\n    where\n      g b0 a = let b1 = f b0 a in \n               (b1, mkSW_ b1 f)\n\n-- | Make a Kleisli wire\nmkKleisli :: (Monad m, Monoid e) =&gt; (a -&gt; m b) -&gt; Wire s e m a b\nmkKleisli f = mkGen_ $ \\a -&gt; liftM Right $ f a\n\n-- | The debug wire\nwDebug :: (Show a, Monoid e) =&gt; Wire s e IO a ()\nwDebug = mkKleisli $ \\a -&gt; putStrLn $ show a\n\n-- | The \"always\" wire\nalways :: (Monad m, Monoid e) =&gt; Wire s e m a (Event a)\nalways = mkSFN $ \\x -&gt; (WE.Event x, always)\n\n{- Functions to be lifted -}\n\n-- | This is the pad surface whose X coordinate can be updated\npadSurf :: SDL.Surface\n            -- ^ Previous state of surface \n            -&gt; Int\n            -- ^ X'\n            -- | New state\n            -&gt; IO SDL.Surface\npadSurf surf x' = do\n  let rect' = SDL.Rect x' 500 100 50\n  clipRect &lt;- SDL.getClipRect surf\n  SDL.fillRect surf (Just clipRect) (SDL.Pixel 0x00000000)\n  SDL.fillRect surf (Just rect') (SDL.Pixel 0xFFFFFFFF)\n  return surf\n\n\n-- | The function to poll events and add to a list of events\npollEvents :: [SDL.Event] -&gt; IO (Either () ([SDL.Event]))\npollEvents es = do\n  e &lt;- SDL.pollEvent\n  case e of \n    SDL.NoEvent -&gt; return $ Right es\n    SDL.Quit -&gt; return $ Left ()\n    _ -&gt; pollEvents $ e:es\n\n-- | Checks whether one SDL.Event is a keyboard event\nisKeyEvent :: SDL.Event -&gt; Bool\nisKeyEvent (SDL.KeyDown k) = True\nisKeyEvent (SDL.KeyUp k) = True\nisKeyEvent _ = False\n\n-- | The raw function to process key status from events\nkeyStatus :: [SDL.Keysym] -&gt; [SDL.Event] -&gt; [SDL.Keysym]\nkeyStatus keysDown (e:es) = \n    case e of\n      -- | If a KeyDown is detected, add key to list\n      SDL.KeyDown k -&gt; keyStatus (k:keysDown) es\n      -- | If a KeyUp is detected, remove key from list\n      SDL.KeyUp k -&gt; keyStatus (filter (/= k) keysDown) es\n      _ -&gt; keyStatus keysDown es\n-- | If all events are processed, return\nkeyStatus keysDown [] = keysDown\n\n-- | Convert a SDL Keysym into \"standard\" game events\ntoGameEv :: SDL.Keysym -&gt; GameEvent\ntoGameEv (SDL.Keysym SDL.SDLK_RIGHT _ _) = MoveR\ntoGameEv (SDL.Keysym SDL.SDLK_LEFT _ _) = MoveL\ntoGameEv _ = NoEvent\n\n-- | Combine all game events to get one single firing\nfireGameEv :: [SDL.Keysym] -&gt; GameEvent\nfireGameEv ks = foldl mappend NoEvent $ fmap toGameEv ks\n\n-- | The integrator of X position of pad\npadDX :: Int -&gt; GameEvent -&gt; Int\npadDX x0 e \n    | x &gt; 700 = 700\n    | x &lt; 0 = 0\n    | otherwise = x\n    where\n      x = x0 + go e\n      go MoveR = dx\n      go MoveL = -dx\n      go _ = 0\n      dx = 15\n\n{- Wires -}\n\n-- | The Kleisli wire to poll events\nwPollEvents :: Wire s () IO () [SDL.Event]\nwPollEvents = mkGen_ $ \\_ -&gt; pollEvents []\n\n-- | A stateless wire that filters out keyboard events\nwKeyEvents :: (Monad m, Monoid e) =&gt; Wire s e m [SDL.Event] [SDL.Event]\nwKeyEvents = mkFW_ isKeyEvent\n\n-- | A stateful wire to keep track of key status\nwKeyStatus :: (Monad m, Monoid e) =&gt; Wire s e m [SDL.Event] [SDL.Keysym]\nwKeyStatus = mkSW_ empty keyStatus\n\n-- | A wire to fire game events from SDL events\nwFireGameEv :: (Monad m, Monoid e) =&gt; Wire s e m [SDL.Keysym] (GameEvent)\nwFireGameEv = arr fireGameEv\n\n-- | This is the connected wire for the entire game input\nwGameInput :: Wire s () IO () (Event GameEvent)\nwGameInput = proc _ -&gt; do\n               ge &lt;- wFireGameEv &lt;&lt;&lt; wKeyStatus\n                     &lt;&lt;&lt; wKeyEvents &lt;&lt;&lt; wPollEvents -&lt; ()\n               e &lt;- always -&lt; ge\n               returnA -&lt; e\n\n-- | The stateful wire of X position of pad\nwPadX :: (Monad m, Monoid e) =&gt; Wire s e m (Event GameEvent) Int\nwPadX = accumE padDX 400 &gt;&gt;&gt; hold\n\n-- | This is the connected wire for the entire game logic\nwGameLogic :: Wire s () IO (Event GameEvent) Int\nwGameLogic = proc ev -&gt; do\n               x' &lt;- wPadX -&lt; ev\n               returnA -&lt; x'\n\n-- | The wire of output\nwGameOutput :: SDL.Surface -&gt; Wire s () IO Int SDL.Surface\nwGameOutput surf = mkKleisli $ testPad\n    where\n      testPad = padSurf surf \n\n\n-- | This is the main game wire\ngameWire :: SDL.Surface \n         -- ^ The main surface (i.e. the window)\n         -&gt; Wire s () IO () SDL.Surface\ngameWire w = proc _ -&gt; do\n               ev &lt;- wGameInput -&lt; ()\n               x &lt;- wGameLogic -&lt; ev\n               finalSurf &lt;- wGameOutput w -&lt; x\n               returnA -&lt; finalSurf\n\nmain :: IO ()\nmain = do\n  SDL.init [SDL.InitEverything]\n  w &lt;- SDL.setVideoMode 800 600 32 [SDL.SWSurface]\n  s &lt;- SDL.createRGBSurfaceEndian [SDL.SWSurface] 800 600 32 \n  run w (countSession_ 1) $ gameWire w\n  SDL.quit\n\nrun ::SDL.Surface -&gt;  Session IO s -&gt; Wire s () IO () SDL.Surface -&gt; IO ()\nrun mainSurf s w  = do\n  (ds, s') &lt;- stepSession s\n  (eSrcSurf, w') &lt;- stepWire w ds (Right ())\n  case eSrcSurf of \n    Right srcSurf -&gt; do \n                  SDL.blitSurface srcSurf (Nothing) mainSurf (Nothing)\n                  SDL.flip mainSurf\n                  SDL.delay 30\n                  run mainSurf s' w'\n    _ -&gt; return ()\n</code></pre>\n"}], "owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1964, "favorite_count": 6, "accepted_answer_id": 32897603, "answer_count": 2, "score": 5, "last_activity_date": 1443741993, "creation_date": 1434597611, "last_edit_date": 1495542336, "question_id": 30905930, "link": "https://stackoverflow.com/questions/30905930/what-can-be-a-minimal-example-of-game-written-in-haskell", "title": "What can be a minimal example of game written in Haskell?", "body": "<p><strong>Update after three months</strong></p>\n\n<p>I have an answer below using <code>netwire-5.0.1</code> + <code>sdl</code>, in a structure of Functional Reactive Programming using Arrows and Kleisli Arrows for I/O. Though too simple to be called a \"game\", it should be very composible and very extendable.</p>\n\n<p><strong>Original</strong> </p>\n\n<p>I am just learning Haskell, and trying to make a small game out of it. However, I would like to see what structure a small(canonical) text game can be. I also try to keep the code as pure as possible. I am now struggling to understand how to implement:</p>\n\n<ol>\n<li>The main loop. There is an example here <a href=\"https://stackoverflow.com/questions/19285691/how-do-i-write-a-game-loop-in-haskell\">How do I write a game loop in Haskell?</a> but it seems that the accepted answer is not tail recursive. I am not exactly sure whether this matters. In my understanding, the memory usage will grow, right?</li>\n<li>State transition. I think this is quite related to the first one, though. I tried a bit using <code>State</code>, and something in <a href=\"http://www.gamedev.net/page/resources/_/technical/game-programming/haskell-game-object-design-or-how-functions-can-get-you-apples-r3204\" rel=\"nofollow noreferrer\">http://www.gamedev.net/page/resources/_/technical/game-programming/haskell-game-object-design-or-how-functions-can-get-you-apples-r3204</a> , but although individual components may work and update in finite steps, I don't see how it can be used in an infinite loop.</li>\n</ol>\n\n<p>If possible, I would like to see a minimal example which basically:</p>\n\n<ol>\n<li>Asks the player to input something, repeatedly</li>\n<li>When some condition is met, change state</li>\n<li>When some other contition is met, exit</li>\n<li>Theoretically can run for infinite time without blowing the memory</li>\n</ol>\n\n<p>I don't have any postable code because I cannot get the very basic stuff. Any other material/examples I found on the web either use some other libraries, like <code>SDL</code> or <code>GTK</code> to drive events. The only one written totally in Haskell I found is <a href=\"http://jpmoresmau.blogspot.com/2006/11/my-first-haskell-adventure-game.html\" rel=\"nofollow noreferrer\">http://jpmoresmau.blogspot.com/2006/11/my-first-haskell-adventure-game.html</a> , but that one does not look like a tail recursion in its main loop too(Again, I don't know if it matters).</p>\n\n<p>Or, probably Haskell is not intended to do things like this? Or probably I should put the <code>main</code> in C?</p>\n\n<p><em>Edit 1</em></p>\n\n<p>So I modified a small example in <a href=\"https://wiki.haskell.org/Simple_StateT_use\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Simple_StateT_use</a> and made it even simpler(and it does not meet my criteria):</p>\n\n<pre><code>module Main where\nimport Control.Monad.State\n\nmain = do \n  putStrLn \"I'm thinking of a number between 1 and 100, can you guess it?\"\n  guesses &lt;- execStateT (guessSession answer) 0\n  putStrLn $ \"Success in \" ++ (show guesses) ++ \" tries.\"\n  where\n    answer = 10\n\nguessSession :: Int -&gt; StateT Int IO ()\nguessSession answer =\n    do gs &lt;- lift getLine    -- get guess from user\n       let g = read gs       -- convert to number\n       modify (+1)           -- increment number of guesses\n       case g of\n         10 -&gt; do lift $ putStrLn \"Right\"\n         _ -&gt; do lift $ putStrLn \"Continue\"\n                 guessSession answer\n</code></pre>\n\n<p>However, it will eventually overflow the memory. I tested with</p>\n\n<pre><code>bash prompt$ yes 1 | ./Test-Game\n</code></pre>\n\n<p>and the memory usage starts growing linearly.</p>\n\n<p><em>Edit 2</em></p>\n\n<p>OK, I found <a href=\"https://stackoverflow.com/questions/13782222/haskell-recursion-and-memory-usage\">Haskell recursion and memory usage</a> and gained some understanding about the \"stack\"... So is there anything wrong about my testing method?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1434598710, "post_id": 30905923, "comment_id": 49850276, "body": "Why should <code>IO ()</code> need to adhere the type? Why shouldn&#39;t <code>IO Int</code> conform the constraint? Note that the desugared version of your <code>do</code> block uses <code>&gt;&gt;=</code> <b>and</b> <code>&gt;&gt;</code>. Also note that intermediate types aren&#39;t really important for the result type here, e.g. <code>f = const 3 . words . show</code> has type <code>(Show a, Num b) =&gt; a -&gt; b</code>, although <code>words</code> has type <code>String -&gt; [String]</code>."}], "answers": [{"tags": [], "owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "is_accepted": false, "score": 1, "last_activity_date": 1434598709, "creation_date": 1434598709, "answer_id": 30906062, "question_id": 30905923, "link": "https://stackoverflow.com/questions/30905923/io-monad-example/30906062#30906062", "title": "IO Monad Example", "body": "<p><code>do { a &lt;- x; print a; return 500 }</code> is equivalent to <code>(return 100 :: Int) &gt;&gt;= print &gt;&gt; return 500</code>.</p>\n\n<p>The signature for <code>&gt;&gt;</code> is <code>(&gt;&gt;) :: Monad m =&gt; m a -&gt; m b -&gt; m b</code>, which is in sync with what is seen.</p>\n"}, {"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 3, "last_activity_date": 1434598771, "creation_date": 1434598771, "answer_id": 30906066, "question_id": 30905923, "link": "https://stackoverflow.com/questions/30905923/io-monad-example/30906066#30906066", "title": "IO Monad Example", "body": "<p>The code you posted desugars into the following.</p>\n\n<pre><code>x &gt;&gt;= (\\a -&gt;\nprint a &gt;&gt;\nreturn 500)\n</code></pre>\n\n<p>Or, expanding out the definition of <code>(&gt;&gt;)</code></p>\n\n<pre><code>x       &gt;&gt;= (\\a -&gt;\nprint a &gt;&gt;= (\\_ -&gt;\nreturn 500))\n</code></pre>\n\n<p>Then, you can see that in the different calls to <code>(&gt;&gt;=)</code>, the types <code>a</code> and <code>b</code> are not necessarily the same. Say <code>(&gt;&gt;=) :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b</code>.</p>\n\n<ul>\n<li><p>in the first call: <code>x</code> has type <code>IO Int</code>, <code>\\a -&gt; print a &gt;&gt;= (\\_ -&gt; return 500)</code> has type <code>Num c =&gt; Int -&gt; IO c</code>, so the <code>a</code> in our type signature for <code>(&gt;&gt;=)</code> is <code>Int</code>, and the <code>b</code> is <code>c</code> (with the <code>Num</code> restriction).</p></li>\n<li><p>in the second call: <code>print a</code> has type <code>IO ()</code>, and <code>\\_ -&gt; return 500</code> has type <code>Num c =&gt; () -&gt; IO c</code> (the <code>()</code> part is inferred from trying to match the signature of <code>(&gt;&gt;=)</code>)  so the <code>a</code> in our type signature for <code>(&gt;&gt;=)</code> is <code>()</code>, and the <code>b</code> is <code>c</code> (still with the <code>Num</code> restriction).</p></li>\n</ul>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 1, "accepted_answer_id": 30906066, "answer_count": 2, "score": 0, "last_activity_date": 1434598838, "creation_date": 1434597555, "last_edit_date": 1434598838, "question_id": 30905923, "link": "https://stackoverflow.com/questions/30905923/io-monad-example", "title": "IO Monad Example", "body": "<p>Consider the following <code>IO</code> code:</p>\n\n<pre><code>ghci&gt; let x = return 100 :: IO Int\n\nghci&gt; :t do { a &lt;- x; print a; return 500 }\ndo { a &lt;- x; print a; return 500 } :: Num b =&gt; IO b\n</code></pre>\n\n<p>My understanding of do notation/bind is that the following signature will be enforced by the compiler:</p>\n\n<pre><code>ghci&gt; :t (&gt;&gt;=)\n(&gt;&gt;=) :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>In the above example, my understanding is: </p>\n\n<ul>\n<li><code>x</code> has type <code>IO Int</code></li>\n<li><code>print a</code> has type <code>IO ()</code></li>\n<li><code>return 500</code> has type <code>Num b =&gt; IO b</code></li>\n</ul>\n\n<p>It seems to me that <code>IO ()</code> does not conform to the type, <code>Num b =&gt; IO b</code>. Additionally, <code>IO Int</code> does not conform to <code>Num b =&gt; IO b</code>, as I understand.</p>\n\n<p>If this observation is valid, then why does this code compile? Must not each line, i.e. <code>&gt;&gt;=</code>, conform to <code>m b</code>, where <code>m</code> equals IO and <code>b</code> equals <code>Num b =&gt; b</code>?</p>\n"}, {"tags": ["ubuntu", "haskell", "vim", "ubuntu-14.04", "cabal"], "comments": [{"owner": {"reputation": 28343, "user_id": 1890567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NSohE.png?s=128&g=1", "display_name": "FDinoff", "link": "https://stackoverflow.com/users/1890567/fdinoff"}, "edited": false, "score": 2, "creation_date": 1434600108, "post_id": 30905864, "comment_id": 49850597, "body": "You should check your path. You seem to have multiple versions installed and the wrong one is being picked up first."}, {"owner": {"reputation": 50682, "user_id": 117700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1a350b4a18da2ffab7bde4bc753909bd?s=128&d=identicon&r=PG", "display_name": "Alex Gordon", "link": "https://stackoverflow.com/users/117700/alex-gordon"}, "reply_to_user": {"reputation": 28343, "user_id": 1890567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NSohE.png?s=128&g=1", "display_name": "FDinoff", "link": "https://stackoverflow.com/users/1890567/fdinoff"}, "edited": false, "score": 0, "creation_date": 1434653488, "post_id": 30905864, "comment_id": 49883640, "body": "@FDinoff can you elaborate please? sorry, beginner here"}, {"owner": {"reputation": 28343, "user_id": 1890567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NSohE.png?s=128&g=1", "display_name": "FDinoff", "link": "https://stackoverflow.com/users/1890567/fdinoff"}, "edited": false, "score": 0, "creation_date": 1434654023, "post_id": 30905864, "comment_id": 49883955, "body": "The PATH variable tells the shell where to look for executables. Its a colon separated list of directories and the shell looks in each directory for the executable it is trying to execute. To see what the path is currently set to you can run <code>echo $PATH</code>. The first executable found is the one that is run. If you run <code>which -a cabal</code> you should be able to see all a list of all executables named cabal in your path. One of them should be the correct version. If only one shows up you might need to add the directory contacting the updated cabal to the beginning of your path variable."}, {"owner": {"reputation": 50682, "user_id": 117700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1a350b4a18da2ffab7bde4bc753909bd?s=128&d=identicon&r=PG", "display_name": "Alex Gordon", "link": "https://stackoverflow.com/users/117700/alex-gordon"}, "reply_to_user": {"reputation": 28343, "user_id": 1890567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NSohE.png?s=128&g=1", "display_name": "FDinoff", "link": "https://stackoverflow.com/users/1890567/fdinoff"}, "edited": false, "score": 0, "creation_date": 1434674108, "post_id": 30905864, "comment_id": 49892540, "body": "thank you. the output of echo path is: /home/me/google-cloud-sdk/bin:/.cabal/bin:/usr/local/sbin:/u&zwnj;&#8203;sr/local/bin:/usr/sb&zwnj;&#8203;in:/usr/bin:/sbin:/b&zwnj;&#8203;in:/usr/games:/usr/l&zwnj;&#8203;ocal/games  and the output of which -a cabal is /usr/bin/cabal...apologies i don&#39;t really understand what you&#39;re suggesting"}, {"owner": {"reputation": 28343, "user_id": 1890567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NSohE.png?s=128&g=1", "display_name": "FDinoff", "link": "https://stackoverflow.com/users/1890567/fdinoff"}, "edited": false, "score": 0, "creation_date": 1434675298, "post_id": 30905864, "comment_id": 49892791, "body": "Is there a specific reason you don&#39;t want to update the installed version with <code>cabal install cabal cabal-install</code>? (Or update it through your package manager?)"}, {"owner": {"reputation": 50682, "user_id": 117700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1a350b4a18da2ffab7bde4bc753909bd?s=128&d=identicon&r=PG", "display_name": "Alex Gordon", "link": "https://stackoverflow.com/users/117700/alex-gordon"}, "reply_to_user": {"reputation": 28343, "user_id": 1890567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NSohE.png?s=128&g=1", "display_name": "FDinoff", "link": "https://stackoverflow.com/users/1890567/fdinoff"}, "edited": false, "score": 0, "creation_date": 1434682043, "post_id": 30905864, "comment_id": 49894304, "body": "as you can see, the package manager&#39;s latest version is 1.16 <a href=\"http://pix.toile-libre.org/upload/original/1434681895.png\" rel=\"nofollow noreferrer\">pix.toile-libre.org/upload/original/1434681895.png</a> , regarding running cabal install, please see the end of my post, as i&#39;ve posted an edit"}], "answers": [{"tags": [], "owner": {"reputation": 28343, "user_id": 1890567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NSohE.png?s=128&g=1", "display_name": "FDinoff", "link": "https://stackoverflow.com/users/1890567/fdinoff"}, "is_accepted": true, "score": 1, "last_activity_date": 1434683562, "creation_date": 1434683562, "answer_id": 30929327, "question_id": 30905864, "link": "https://stackoverflow.com/questions/30905864/issues-with-installing-newer-cabal-version-for-haskell-vim-now/30929327#30929327", "title": "issues with installing newer cabal version for haskell vim now", "body": "<p>Your <code>$PATH</code> variable seems to be broken. In a comment you said it was </p>\n\n<pre><code>/home/me/google-cloud-sdk/bin:/.cabal/bin:/usr/local/sbin:/usr/local/bin:/usr/sb\u200c\u200bin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games \n</code></pre>\n\n<p>This means that your shell (assumed to be bash) will look in the following directories </p>\n\n<pre><code>/home/me/google-cloud-sdk/bin\n/.cabal/bin\n/usr/local/sbin\n/usr/local/bin\n/usr/sb\u200c\u200bin\n/usr/bin\n/sbin\n/bin\n/usr/games\n/usr/local/games \n</code></pre>\n\n<p>when looking for executable. If you look at the second item in your path it is <code>/.cabal/bin</code>. It should be <code>$HOME/.cabal/bin</code> (where <code>$HOME</code> is your home directory)</p>\n\n<p>Most likely your <code>~/.bash_profile</code> has a line that looks something like</p>\n\n<pre><code>PATH=\"/.cabal/bin:$PATH\"\n</code></pre>\n\n<p>you should add a <code>$HOME</code> to the above so that the PATH variable is set properly.</p>\n\n<pre><code>PATH=\"$HOME/.cabal/bin:$PATH\"\n</code></pre>\n\n<p>Before your shell was looking for cabal in <code>/.cabal/bin/cabal</code> however it isn't there.</p>\n\n<hr>\n\n<p>Other information on PATH: <a href=\"http://www.linfo.org/path_env_var.html\" rel=\"nofollow\">http://www.linfo.org/path_env_var.html</a></p>\n"}], "owner": {"reputation": 50682, "user_id": 117700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1a350b4a18da2ffab7bde4bc753909bd?s=128&d=identicon&r=PG", "display_name": "Alex Gordon", "link": "https://stackoverflow.com/users/117700/alex-gordon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 30929327, "answer_count": 1, "score": 3, "last_activity_date": 1434683562, "creation_date": 1434597018, "last_edit_date": 1434682084, "question_id": 30905864, "link": "https://stackoverflow.com/questions/30905864/issues-with-installing-newer-cabal-version-for-haskell-vim-now", "title": "issues with installing newer cabal version for haskell vim now", "body": "<p>I would like to install this vim plugin: <a href=\"https://github.com/begriffs/haskell-vim-now\" rel=\"nofollow\">https://github.com/begriffs/haskell-vim-now</a></p>\n\n<p>When trying to run the suggested installation script:</p>\n\n<pre><code>curl -o - https://raw.githubusercontent.com/begriffs/haskell-vim-now/master/install.sh | bash\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>--- Cabal version 1.18 or later is required. Aborting.\n</code></pre>\n\n<p>I then try to install a newer version of cabal:</p>\n\n<pre><code>me@me:~/Downloads/cabal-install-1.22.6.0$ ./bootstrap.sh\n</code></pre>\n\n<p>The response I get:</p>\n\n<pre><code>Installed cabal-install-1.22.4.0\n</code></pre>\n\n<p>But when getting the version:</p>\n\n<pre><code>cabal --version\n\ncabal-install version 1.16.0.2\nusing version 1.16.0 of the Cabal library \n</code></pre>\n\n<p><strong>How do I get this plugin running? <a href=\"https://github.com/begriffs/haskell-vim-now\" rel=\"nofollow\">https://github.com/begriffs/haskell-vim-now</a></strong></p>\n\n<p><strong>edit:</strong> I've left out an important piece of information. when running:</p>\n\n<pre><code>cabal install cabal cabal-install\n</code></pre>\n\n<p>I get the following output</p>\n\n<pre><code>Installing executable(s) in /home/me/.cabal/bin\nInstalled cabal-install-1.22.4.0\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 1, "last_activity_date": 1434597387, "last_edit_date": 1495542598, "creation_date": 1434597387, "answer_id": 30905902, "question_id": 30905805, "link": "https://stackoverflow.com/questions/30905805/understanding-seq-with-example/30905902#30905902", "title": "Understanding `seq` with Example", "body": "<p>Same problem as your <a href=\"https://stackoverflow.com/questions/30899003/evaluating-list-to-weak-head-normal-form\">last question earlier today</a>. The type of x is <code>Num a =&gt; a</code> (just try <code>:t x</code> in GHCi). You can't evaluate this until it is clear what <code>a</code> is. <strong>There is no way of determining which <code>(+)</code> function should be used without knowing what <code>a</code> is, so <code>x</code> can't be evaluated past a thunk</strong>. If <code>a</code> is <code>Int</code>, GHCi will call a different <code>(+)</code> function than if <code>a</code> is <code>Integer</code>. </p>\n\n<p>For example, if you do <code>let x = 100 + 2 :: Integer</code> instead, then everything works like you expect it too. You get <code>x = _</code> before the call to <code>seq</code> and <code>x = 102</code> after. </p>\n\n<p>The confusing bit is that if you just throw in <code>x</code> into GHCi, it'll give you back <code>102</code>. This is because GHCi specializes the type <code>a</code> from <code>x :: Num a =&gt; a</code> to <code>Integer</code>, allowing it to evaluate the value, then print it. But that has no effect on <code>x</code>.</p>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "closed_date": 1434597625, "answer_count": 1, "score": 0, "last_activity_date": 1434597387, "creation_date": 1434596556, "question_id": 30905805, "link": "https://stackoverflow.com/questions/30905805/understanding-seq-with-example", "closed_reason": "Duplicate", "title": "Understanding `seq` with Example", "body": "<p>I'm trying to understand <code>seq</code> with the following example:</p>\n\n<pre><code>Prelude&gt; let x = 100 + 2\n</code></pre>\n\n<p><code>sprint</code>-ing the value of <code>x</code> shows <code>_</code> since it has not been evaluated.</p>\n\n<pre><code>Prelude&gt; :sprint x\nx = _\n</code></pre>\n\n<p>Let's, as I understand <code>seq</code>, evaluate <code>x</code>.</p>\n\n<pre><code>Prelude&gt; seq x ()\n()\n</code></pre>\n\n<p>Now, let's check the value of <code>x</code>.</p>\n\n<pre><code>Prelude&gt; :sprint x\nx = _\n</code></pre>\n\n<p>Why hasn't <code>x</code> been evaluated to <code>102</code> after calling <code>seq x ()</code>?</p>\n"}, {"tags": ["haskell", "gloss"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1434606242, "post_id": 30905186, "comment_id": 49852535, "body": "Did you read what the compiler told you? <code>package gloss-1.8.1.2-... is unusable due to missing or recursive dependencies</code>. The simplest solution is to delete your package database and try again."}, {"owner": {"reputation": 1129, "user_id": 1800854, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qycfQ.png?s=128&g=1", "display_name": "Mo Beigi", "link": "https://stackoverflow.com/users/1800854/mo-beigi"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1434620606, "post_id": 30905186, "comment_id": 49861075, "body": "@user2407038 What do you mean by delete package database? I&#39;ve reinstalled gloss multiple times as well as installed a lot of other packages. Updated <code>cabal</code> and reinstalled it too with no luck."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1434644544, "post_id": 30905186, "comment_id": 49878515, "body": "Reinstalling gloss by itself won&#39;t work, since other packages are broken as well. If you are using the Haskell platform, it is probably easiest to reinstall that; otherwise, use <code>ghc-pkg unregister</code> on <i>all</i> of the broken packages, then <code>cabal install gloss</code>."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1434656587, "post_id": 30905186, "comment_id": 49885536, "body": "This is the problem: <code>package OpenGL-2.8.0.0-344e8603ffa2fe942e6526830661f0ee is shadowed by package OpenGL-2.8.0.0-965a1de4ba5cd960ad85db9941a93722</code> You probably installed some other package with <code>--force-install</code>, and it broke OpenGL."}, {"owner": {"reputation": 1129, "user_id": 1800854, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qycfQ.png?s=128&g=1", "display_name": "Mo Beigi", "link": "https://stackoverflow.com/users/1800854/mo-beigi"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1434681265, "post_id": 30905186, "comment_id": 49894118, "body": "@user2407038 Using ghc-pkg unregister on OpenGL-2.8.0.0 resolved the issue. OpenGL-2.8.0.0 doesnt even appear on ghc-pkg list anymore but gloss is working."}, {"owner": {"reputation": 1129, "user_id": 1800854, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qycfQ.png?s=128&g=1", "display_name": "Mo Beigi", "link": "https://stackoverflow.com/users/1800854/mo-beigi"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1435316718, "post_id": 30905186, "comment_id": 50161818, "body": "@user2407038 Post that as the answer and i&#39;ll accept it."}], "owner": {"reputation": 1129, "user_id": 1800854, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qycfQ.png?s=128&g=1", "display_name": "Mo Beigi", "link": "https://stackoverflow.com/users/1800854/mo-beigi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1956, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1517004388, "creation_date": 1434591894, "last_edit_date": 1517004388, "question_id": 30905186, "link": "https://stackoverflow.com/questions/30905186/haskell-could-not-find-module-graphics-gloss", "title": "Haskell Could not find module &#39;Graphics.Gloss&#39;", "body": "<p>I'm trying to run a simple Gloss program in Haskell on Xubuntu 14.04.\nNow i've run the same program before with no issues on the same machine a while ago but it seems like its no longer working. Apparently it thinks Gloss is not installed when it is.</p>\n\n<p>I've tried a lot of things with no luck.</p>\n\n<p>Error when trying to compile program:</p>\n\n<pre><code>MyProg.hs:2:8:\n    Could not find module `Graphics.Gloss'\n    Use -v to see a list of the files searched for.\n</code></pre>\n\n<p>When using -v flag:</p>\n\n<pre><code>Glasgow Haskell Compiler, Version 7.6.3, stage 2 booted by GHC version 7.6.3\nUsing binary package database: /usr/lib/ghc/package.conf.d/package.cache\nUsing binary package database: /home/myuser/.ghc/x86_64-linux-7.6.3/package.conf.d/package.cache\npackage GLUT-2.4.0.0-31a913db9728fc0bba038e31af3ad274 is unusable due to missing or recursive dependencies:\n  OpenGL-2.8.0.0-344e8603ffa2fe942e6526830661f0ee\npackage OpenGL-2.8.0.0-344e8603ffa2fe942e6526830661f0ee is shadowed by package OpenGL-2.8.0.0-965a1de4ba5cd960ad85db9941a93722\npackage gloss-1.8.1.2-eb3652fd7115ec4d025ca235f1e1d64d is unusable due to missing or recursive dependencies:\n  GLUT-2.4.0.0-31a913db9728fc0bba038e31af3ad274 OpenGL-2.8.0.0-344e8603ffa2fe942e6526830661f0ee\npackage gloss-raster-1.8.1.2-fd045cd6d26cf5909eb1793d4659a1f3 is unusable due to missing or recursive dependencies:\n  gloss-1.8.1.2-eb3652fd7115ec4d025ca235f1e1d64d\nhiding package HTTP-4000.2.8 to avoid conflict with later version HTTP-4000.2.19\nhiding package Cabal-1.16.0 to avoid conflict with later version Cabal-1.22.4.0\nhiding package binary-0.5.1.1 to avoid conflict with later version binary-0.6.4.0\nhiding package network-2.4.1.2 to avoid conflict with later version network-2.6.2.0\nhiding package parallel-3.2.0.3 to avoid conflict with later version parallel-3.2.0.6\nhiding package GLURaw-1.3.0.0 to avoid conflict with later version GLURaw-1.4.0.2\nhiding package binary-0.6.4.0 to avoid conflict with later version binary-0.7.4.0\nwired-in package ghc-prim mapped to ghc-prim-0.3.0.0-d5221a8c8a269b66ab9a07bdc23317dd\nwired-in package integer-gmp mapped to integer-gmp-0.5.0.0-2f15426f5b53fe4c6490832f9b20d8d7\nwired-in package base mapped to base-4.6.0.1-8aa5d403c45ea59dcd2c39f123e27d57\nwired-in package rts mapped to builtin_rts\nwired-in package template-haskell mapped to template-haskell-2.8.0.0-a3012803fde1dc362e555b35a1a78e6d\nwired-in package dph-seq not found.\nwired-in package dph-par not found.\nHsc static flags: -static\n*** Chasing dependencies:\nChasing modules from: *MyProg.hs\n\nMyProg.hs:2:8:\n    Could not find module `Graphics.Gloss'\n    Locations searched:\n      Graphics/Gloss.hs\n      Graphics/Gloss.lhs\n*** Deleting temp files:\nDeleting: \n*** Deleting temp dirs:\nDeleting: \n</code></pre>\n\n<p>What seems to be the issue? (The machine has not changed at all since the program last worked fine, I had installed and used Gloss successfully then).</p>\n"}]